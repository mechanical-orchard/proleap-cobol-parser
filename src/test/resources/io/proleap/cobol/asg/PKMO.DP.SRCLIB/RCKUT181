000100******************************************************************00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000300******************************************************************00030001
000400                                                                  00040001
000500 PROGRAM-ID.    RCKUT181.                                         00050001
000600 AUTHOR.        DENISE HAHN                                       00060001
000700 INSTALLATION.  KOHLS.                                            00070001
000800 DATE-WRITTEN   JULY, 2021.                                       00080001
000900 DATE-COMPILED.                                                   00090001
001000                                                                  00100001
001100******************************************************************00110001
001200* THIS PROGRAM WILL SPLIT THE ASN FILE BEING FED INTO THE         00120001
001300* PACKSLIP CREATE PROCESS.                                        00130001
001400*                                                                 00140001
001410* THIS PROGRAM WILL SPLIT THE INPUT FILE INTO 2 SEPARATE FILES.   00141001
001420* - IT WILL READ THE RECORD TO SEE IF IT IS FOR A DC              00142001
001430*   IF IT IS NOT FOR A DC - RECORD WILL BE WRITTEN TO NO CHANGES  00143001
001440*   FILE.                                                         00144001
001450*                                                                 00145001
001460* - IF IT IS FOR A DC, THEN IT WILL CHECK THE PO TO SEE IF IT IS  00146001
001470*   A BULK PO                                                     00147001
001480*   IF IT IS A BULK PO IT WILL BE WRITTEN TO THE 2ND FILE FOR     00148001
001490*   THE BULK ASN - TO BE CHECKED FURTHER IF THEY NEED TO BE       00149001
001491*   SPLIT DUE TO CARTONS WITH MULTI-SKU'S (RCKUT182)              00149101
001492*                                                                 00149201
001493*   ALL OTHER RECORDS WILL BE WITTEN TO THE NO CHANGES FILE       00149301
001494*                                                                 00149401
001495*                                                                 00149501
001496* ADDED PARM ASNSPT TO BE USE TO TURN OFF THE SPLIT FUNCTIONALITY 00149601
001497*  - Y - WE WILL SPLIT THE DC BULK TO A SEPARATE FILE             00149701
001498*  - N - WE WILL "NOT" SPLIT DC BULK TO A SEPARATE FILE           00149801
001499*                                                                 00149901
001500*  11/4/2021 -  ADDED AN ADDITIONAL SPLIT FOR SEPHORS PLUS        00150002
001501*  NEW PARM HAS BEEN ADDED TO THE BEGINNING OF THE CODE.          00150102
001502*  PARM:  SPHASN                                                  00150202
001503*  THIS PARM IS BY OPER (821), DATE RANGE, AC/IN & Y/N            00150302
001504*  IF THERE IS AN ACTIVE ROW FOR THE OPER THEN THE ASN WILL BE    00150402
001505*  WRITTEN TO A SEPARATE FILE.                                    00150502
001506*  THIS CHECK WILL BE DONE "BEFORE" THE DC BULK ASN CHECK         00150602
001510******************************************************************00151001
001520                                                                  00152001
001530******************************************************************00153001
001540 ENVIRONMENT DIVISION.                                            00154001
001550******************************************************************00155001
001560                                                                  00156001
001570 CONFIGURATION SECTION.                                           00157001
001580                                                                  00158001
001590 SOURCE-COMPUTER.        IBM-3090.                                00159001
001600 OBJECT-COMPUTER.        IBM-3090.                                00160001
001700                                                                  00170001
001800 INPUT-OUTPUT SECTION.                                            00180001
001900                                                                  00190001
002000 FILE-CONTROL.                                                    00200001
002100                                                                  00210001
002200     SELECT INPUT-FILE                                            00220001
002300        ASSIGN TO INP01.                                          00230001
002400                                                                  00240001
002500     SELECT  ASN-NO-CHANGES-FILE                                  00250001
002600        ASSIGN TO OUT01.                                          00260001
002700                                                                  00270001
002800     SELECT  ASN-BULK-ORDER-FILE                                  00280001
002900        ASSIGN TO OUT02.                                          00290001
003000                                                                  00300001
003010     SELECT  ASN-SEPHORA-FILE                                     00301002
003020        ASSIGN TO OUT03.                                          00302002
003030                                                                  00303002
003100                                                                  00310001
003200******************************************************************00320001
003300 DATA DIVISION.                                                   00330001
003400******************************************************************00340001
003500                                                                  00350001
003600 FILE SECTION.                                                    00360001
003700                                                                  00370001
003800                                                                  00380001
003900 FD  INPUT-FILE                                                   00390001
004000     LABEL RECORDS ARE STANDARD                                   00400001
004100     RECORDING MODE IS F                                          00410001
004200     BLOCK CONTAINS 0 RECORDS                                     00420001
004300     RECORD CONTAINS 600 CHARACTERS.                              00430001
004400                                                                  00440001
004500 01  ASN-INPUT-RECORD            PIC  X(600).                     00450001
004600                                                                  00460001
004610                                                                  00461001
004620 FD  ASN-NO-CHANGES-FILE                                          00462001
004630     LABEL RECORDS ARE STANDARD                                   00463001
004640     RECORDING MODE IS F                                          00464001
004650     BLOCK CONTAINS 0 RECORDS                                     00465001
004660     RECORD CONTAINS 600 CHARACTERS.                              00466001
004670                                                                  00467001
004680 01  ASN-NO-CHANGE-RECORD        PIC  X(600).                     00468001
004690                                                                  00469001
004691                                                                  00469101
004692 FD  ASN-BULK-ORDER-FILE                                          00469201
004693     RECORDING MODE IS F                                          00469301
004694     LABEL RECORDS ARE STANDARD                                   00469401
004695     RECORD CONTAINS 1100 CHARACTERS.                             00469501
004696                                                                  00469601
004697 01  ASN-BULK-ORDER-RECORD       PIC  X(1100).                    00469701
004698                                                                  00469801
004699                                                                  00469901
004700 FD  ASN-SEPHORA-FILE                                             00470002
004701     LABEL RECORDS ARE STANDARD                                   00470102
004702     RECORDING MODE IS F                                          00470202
004703     BLOCK CONTAINS 0 RECORDS                                     00470302
004704     RECORD CONTAINS 600 CHARACTERS.                              00470402
004705                                                                  00470502
004706 01  ASN-SEPHORA-RECORD          PIC  X(600).                     00470602
004707                                                                  00470702
004708                                                                  00470802
004710                                                                  00471001
004800******************************************************************00480001
004900 WORKING-STORAGE SECTION.                                         00490001
005000******************************************************************00500001
005100*-----------------------------------------------------------------00510001
005200*                                                                 00520001
005300*-----------------------------------------------------------------00530001
005400 01  ABEND-CODE                     PIC S9(04) VALUE +0           00540001
005500                                               COMP SYNC.         00550001
005600                                                                  00560001
005700*-----------------------------------------------------------------00570001
005800* DB2 KEYS                                                        00580003
005900*-----------------------------------------------------------------00590001
006000 01  DK-DB2-KEYS.                                                 00600003
006100     05  DK-OPER-UNT-ID             PIC  S9(4) COMP.              00610003
006200     05  DK-STR-NBR                 PIC  S9(4) COMP.              00620016
006300                                                                  00630001
006310*-----------------------------------------------------------------00631003
006320* PROGRAM CONSTANTS                                               00632003
006330*-----------------------------------------------------------------00633003
006340 01  PC-PROGRAM-CONSTANTS.                                        00634003
006350     05  PC-CURRENT-PROGRAM-NAME    PIC  X(08) VALUE              00635003
006360         'RCKUT181'.                                              00636003
006370                                                                  00637003
006400*-----------------------------------------------------------------00640001
006500* PROGRAM SWITCHES                                                00650001
006600*-----------------------------------------------------------------00660001
006700 01  PS-PROGRAM-SWITCHES.                                         00670001
006800     05  PS-END-OF-FILE-SW          PIC  X(01) VALUE 'N'.         00680001
006900         88  PS-END-OF-FILE                    VALUE 'Y'.         00690001
007000         88  PS-END-OF-FILE-NO                 VALUE 'N'.         00700001
007100     05  PS-ERROR-SW                PIC  X(01) VALUE 'N'.         00710001
007200         88  PS-ERROR                          VALUE 'Y'.         00720001
007300         88  PS-ERROR-NO                       VALUE 'N'.         00730001
007400     05  PS-RETAIL-DC-SW            PIC  X(01) VALUE 'N'.         00740001
007500         88  PS-RETAIL-DC                      VALUE 'Y'.         00750001
007600         88  PS-RETAIL-DC-NO                   VALUE 'N'.         00760001
007700     05  PS-PO-BULK-SW              PIC  X(01) VALUE 'N'.         00770001
007800         88  PS-PO-BULK                        VALUE 'Y'.         00780001
007900         88  PS-PO-BULK-NO                     VALUE 'N'.         00790001
008000     05  PS-DETAIL-CREATED-SW       PIC  X(01) VALUE 'Y'.         00800001
008100         88  PS-DETAIL-CREATED                 VALUE 'Y'.         00810001
008200         88  PS-DETAIL-NOT-CREATED             VALUE 'N'.         00820001
008300     05  PS-SPLIT-DC-BULK-ASN-SW    PIC  X(01) VALUE 'N'.         00830001
008310         88  PS-SPLIT-DC-BULK-ASN              VALUE 'Y'.         00831001
008320         88  PS-SPLIT-DC-BULK-ASN-NO           VALUE 'N'.         00832001
008321     05  PS-SEPHORA-ASN-SW          PIC  X(01) VALUE 'N'.         00832103
008322         88  PS-SEPHORA-ASN                    VALUE 'Y'.         00832203
008323         88  PS-SEPHORA-ASN-NO                 VALUE 'N'.         00832303
008330                                                                  00833001
008340*-----------------------------------------------------------------00834001
008350* PROGRAM VARIABLES                                               00835001
008360*-----------------------------------------------------------------00836001
008370                                                                  00837001
008380 01  PV-PROGRAM-VARIABLES.                                        00838001
008390     05  PV-CURRENT-TMST             PIC  X(26)  VALUE SPACES.    00839001
008400     05  PV-CURRENT-TMST-R REDEFINES PV-CURRENT-TMST.             00840001
008500         10  PV-CURRENT-DATE         PIC  X(10).                  00850001
008600         10  FILLER                  PIC  X(01).                  00860001
008700         10  PV-CURRENT-TIME         PIC  X(08).                  00870001
008800         10  FILLER                  PIC  X(07).                  00880001
008900     05  PV-READ-COUNT               PIC  9(09)  VALUE ZEROS.     00890001
009000     05  PV-HDR-RDC-COUNT            PIC  9(09)  VALUE ZEROS.     00900001
009100     05  PV-HDR-NOT-RDC-COUNT        PIC  9(09)  VALUE ZEROS.     00910001
009200     05  PV-HDR-RDC-NOT-BULK-COUNT   PIC  9(09)  VALUE ZEROS.     00920001
009201     05  PV-HDR-SEPH-COUNT           PIC  9(09)  VALUE ZEROS.     00920105
009300     05  PV-HEADER-COUNT             PIC  9(09)  VALUE ZEROS.     00930001
009301     05  PV-DETAIL-COUNT             PIC  9(09)  VALUE ZEROS.     00930101
009302     05  PV-CARTON-COUNT             PIC  9(09)  VALUE ZEROS.     00930201
009303     05  PV-HDR-OUT01-COUNT          PIC  9(09)  VALUE ZEROS.     00930301
009304     05  PV-DTL-OUT01-COUNT          PIC  9(09)  VALUE ZEROS.     00930401
009305     05  PV-CRTN-OUT01-COUNT         PIC  9(09)  VALUE ZEROS.     00930501
009306     05  PV-HDR-OUT02-COUNT          PIC  9(09)  VALUE ZEROS.     00930601
009307     05  PV-DTL-OUT02-COUNT          PIC  9(09)  VALUE ZEROS.     00930701
009308     05  PV-CRTN-OUT02-COUNT         PIC  9(09)  VALUE ZEROS.     00930801
009309     05  PV-HDR-OUT03-COUNT          PIC  9(09)  VALUE ZEROS.     00930902
009310     05  PV-DTL-OUT03-COUNT          PIC  9(09)  VALUE ZEROS.     00931002
009311     05  PV-CRTN-OUT03-COUNT         PIC  9(09)  VALUE ZEROS.     00931102
009312     05  PV-SSCC-COUNT               PIC  9(09)  VALUE ZEROS.     00931201
009313     05  PV-ASN-DTL-NO-CARTONS-CNT   PIC  9(09)  VALUE ZEROS.     00931301
009320     05  PV-RDC-NOT-BULK-COUNT       PIC  9(09)  VALUE ZEROS.     00932001
009330     05  PV-OUT01-RDC-NOT-BULK-COUNT PIC  9(09)  VALUE ZEROS.     00933001
009340     05  PV-OUT01-COUNT              PIC  9(09)  VALUE ZEROS.     00934001
009350     05  PV-OUT02-COUNT              PIC  9(09)  VALUE ZEROS.     00935001
009351     05  PV-OUT03-COUNT              PIC  9(09)  VALUE ZEROS.     00935102
009352     05  PV-DISP-OPER                PIC  ZZZ9   VALUE ZEROS.     00935206
009360                                                                  00936001
009370     05  PV-SUB                     PIC S9(04)  VALUE ZERO        00937001
009380                                                 COMP SYNC.       00938001
009390                                                                  00939001
009400     05  PV-DISP-COUNT              PIC  ZZZ,ZZZ,ZZ9              00940001
009410                                                VALUE ZEROS.      00941001
009420     05  PV-DISP-SQLCODE            PIC  -999   VALUE ZEROS.      00942001
009430     05  PV-DISP-LOC                PIC  ZZZ9   VALUE ZEROS.      00943001
009440                                                                  00944001
009450     05  PV-PREV-OPERATING-COMPANY  PIC  X(02)  VALUE SPACES.     00945001
009460     05  PV-PREV-DIST-CNTR          PIC  9(04)  VALUE ZEROES.     00946001
009470     05  PV-PREV-EDI-VEND-ID        PIC  9(09)  VALUE ZEROS.      00947001
009480     05  PV-PREV-CARRIER-SCAC-CODE  PIC  X(04)  VALUE SPACES.     00948001
009490     05  PV-PREV-BILL-OF-LADING-NBR PIC  X(30)  VALUE SPACES.     00949001
009500     05  PV-PREV-PO-NBR             PIC  9(09)  VALUE ZEROS.      00950001
009510     05  PV-PREV-STORE-NBR          PIC  9(04)  VALUE ZEROS.      00951001
009520     05  PV-PREV-PO-LINE-NBR        PIC  X(04)  VALUE SPACES.     00952001
009521     05  PV-CHECK-SEPHORA-DEPT      PIC  X(01)  VALUE SPACES.     00952104
009522     05  PV-LOC-TYP-CDE             PIC  X(02)  VALUE SPACES.     00952217
009523     05  PV-DEFAULT-PRO-NBR         PIC  X(25)  VALUE SPACES.     00952327
009530                                                                  00953001
009540     05  PV-PARAGRAPH-NAME          PIC  X(30) VALUE SPACES.      00954001
009550     05  PV-DB2-OPERATION-ATTEMPTED PIC  X(30) VALUE SPACES.      00955001
009560                                                                  00956001
009570*-----------------------------------------------------------------00957001
009580*  INPUT/OUTPUT OUT01 RECORD LAYOUT                               00958001
009590*-----------------------------------------------------------------00959001
009600     COPY RCRD001.                                                00960001
009700                                                                  00970001
009800*-----------------------------------------------------------------00980001
009900*  OUT01 RECORD LAYOUT                                            00990001
010000*-----------------------------------------------------------------01000001
010100     COPY RCRD109.                                                01010001
010200                                                                  01020001
010300*-----------------------------------------------------------------01030001
010400*  DB2 FORMATTED MESSAGE AREA                                     01040001
010500*-----------------------------------------------------------------01050001
010600     COPY DPWS004.                                                01060001
010700                                                                  01070001
010800*-----------------------------------------------------------------01080001
010900*  XLT_LOC                                                        01090001
011000*-----------------------------------------------------------------01100001
011100     EXEC SQL                                                     01110001
011200          INCLUDE XLT00010                                        01120001
011300     END-EXEC.                                                    01130001
011400                                                                  01140001
011500*-----------------------------------------------------------------01150001
011600*  TPURCHS                                                        01160001
011700*-----------------------------------------------------------------01170001
011800     EXEC SQL                                                     01180001
011900          INCLUDE TPURCHS                                         01190001
012000     END-EXEC.                                                    01200001
012100                                                                  01210001
012200*-----------------------------------------------------------------01220001
012300*  TKRPRPM                                                        01230001
012400*-----------------------------------------------------------------01240001
012500     EXEC SQL                                                     01250001
012600          INCLUDE TKRPRPM                                         01260001
012700     END-EXEC.                                                    01270001
012800                                                                  01280001
012900*-----------------------------------------------------------------01290001
013000*  COMMUNICATIONS AREA FOR DB2                                    01300001
013100*-----------------------------------------------------------------01310001
013200     EXEC SQL                                                     01320001
013300          INCLUDE SQLCA                                           01330001
013400     END-EXEC.                                                    01340001
013500                                                                  01350001
013600                                                                  01360001
013700******************************************************************01370001
013800 PROCEDURE DIVISION.                                              01380001
013900******************************************************************01390001
014000                                                                  01400001
014100                                                                  01410001
014200*-----------------------------------------------------------------01420001
014300* 0000-PROGRAM-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE     01430001
014400*      PROGRAM.                                                   01440001
014500*-----------------------------------------------------------------01450001
014600 0000-PROGRAM-MAINLINE.                                           01460001
014700                                                                  01470001
014800     DISPLAY ' '.                                                 01480001
014900     DISPLAY ' RCKUT181 - START'.                                 01490008
015000                                                                  01500001
015100     EXEC SQL                                                     01510001
015200          SELECT CURRENT TIMESTAMP                                01520001
015300            INTO :PV-CURRENT-TMST                                 01530001
015400            FROM SYSIBM.SYSDUMMY1                                 01540001
015500     END-EXEC.                                                    01550001
015600                                                                  01560001
015700     DISPLAY ' CURR-TMST: ' PV-CURRENT-TMST                       01570001
015800             ' DATE-TIME: ' PV-CURRENT-DATE                       01580001
015900             ' - '          PV-CURRENT-TIME.                      01590001
016000                                                                  01600001
016100     SET PS-END-OF-FILE-NO TO TRUE.                               01610001
016200                                                                  01620001
016300     OPEN INPUT  INPUT-FILE                                       01630001
016400          OUTPUT ASN-NO-CHANGES-FILE                              01640001
016500          OUTPUT ASN-BULK-ORDER-FILE                              01650002
016510          OUTPUT ASN-SEPHORA-FILE.                                01651002
016600                                                                  01660001
016700     PERFORM 3200-CHECK-SPLIT-PROCESSING.                         01670001
016800     DISPLAY ' '.                                                 01680001
016900     DISPLAY ' SPLIT DC-BULK TO SEPARATE FILE - PARM ASNSPT: '    01690001
017000              PS-SPLIT-DC-BULK-ASN-SW.                            01700001
017100     DISPLAY ' '.                                                 01710001
017101                                                                  01710127
017110     PERFORM 3500-GET-DEFAULT-PRO-NBR.                            01711027
017120     DISPLAY ' '.                                                 01712027
017130     DISPLAY ' NON BULK - DEFAULT PRO NUMBER  - PARM PRODFT: '    01713027
017140              PV-DEFAULT-PRO-NBR.                                 01714027
017150     DISPLAY ' '.                                                 01715027
017160                                                                  01716027
017200     PERFORM 8000-READ-INPUT.                                     01720001
017300                                                                  01730001
017400     IF PS-END-OF-FILE                                            01740001
017500        DISPLAY '*                                            *'  01750001
017600        DISPLAY '* NO ASNS TO PROCESS - EMPTY FILE            *'  01760001
017700        DISPLAY '*                                            *'  01770001
017800     ELSE                                                         01780001
017810*                                                                 01781002
017830         PERFORM 3400-SEPHORA-ASN                                 01783002
017831         IF  PS-SEPHORA-ASN                                       01783102
017832             ADD  1                TO  PV-HDR-SEPH-COUNT          01783202
017840         ELSE                                                     01784002
017870*                                                                 01787002
017900             PERFORM 3000-RETAIL-DC                               01790002
018000             IF  PS-RETAIL-DC                                     01800002
018100                 ADD  1            TO  PV-HDR-RDC-COUNT           01810002
018200                 PERFORM 3100-CHECK-PO-BULK                       01820002
018300             ELSE                                                 01830002
018400                 ADD  1            TO  PV-HDR-NOT-RDC-COUNT       01840002
018500             END-IF                                               01850002
018510                                                                  01851002
018511*                                                                 01851102
018530         END-IF                                                   01853002
018550*                                                                 01855002
018600         MOVE RC001-DIST-CNTR  TO  PV-PREV-DIST-CNTR              01860001
018700         MOVE RC001-PO-NBR     TO  PV-PREV-PO-NBR                 01870001
018800         MOVE RC001-PO-LINE-NBR TO  PV-PREV-PO-LINE-NBR           01880001
018900         PERFORM 2000-PROCESS-FILE                                01890001
019000             UNTIL PS-END-OF-FILE                                 01900001
019100                OR PS-ERROR                                       01910001
019200     END-IF.                                                      01920001
019300                                                                  01930001
019400     CLOSE INPUT-FILE                                             01940001
019500           ASN-NO-CHANGES-FILE                                    01950001
019600           ASN-BULK-ORDER-FILE                                    01960002
019610           ASN-SEPHORA-FILE.                                      01961002
019700                                                                  01970001
019800     DISPLAY ' '                                                  01980001
019900     MOVE PV-READ-COUNT                  TO  PV-DISP-COUNT        01990001
020000     DISPLAY ' RECORDS READ:           '     PV-DISP-COUNT        02000001
020100     DISPLAY ' '                                                  02010001
020200                                                                  02020001
020300     MOVE PV-HEADER-COUNT                TO  PV-DISP-COUNT        02030001
020400     DISPLAY ' HEADER COUNT:           '     PV-DISP-COUNT        02040001
020500                                                                  02050001
020600     MOVE PV-DETAIL-COUNT                TO  PV-DISP-COUNT        02060001
020700     DISPLAY ' DETAIL COUNT:           '     PV-DISP-COUNT        02070001
020800                                                                  02080001
020900     MOVE PV-CARTON-COUNT                TO  PV-DISP-COUNT        02090001
021000     DISPLAY ' CARTON COUNT:           '     PV-DISP-COUNT        02100001
021100                                                                  02110001
021200     DISPLAY ' '                                                  02120001
021300     DISPLAY '* OUT01 - NON RETAIL DC AND NON-BULK --- RCRD001'.  02130001
021400                                                                  02140001
021500     MOVE PV-HDR-OUT01-COUNT             TO  PV-DISP-COUNT        02150001
021600     DISPLAY ' HDR OUT01 COUNT:        '     PV-DISP-COUNT        02160001
021700                                                                  02170001
021800     MOVE PV-DTL-OUT01-COUNT             TO  PV-DISP-COUNT        02180001
021900     DISPLAY ' DTL OUT01 COUNT:        '     PV-DISP-COUNT        02190001
022000                                                                  02200001
022100     MOVE PV-CRTN-OUT01-COUNT            TO PV-DISP-COUNT         02210001
022200     DISPLAY ' CRTN OUT01 COUNT:       '    PV-DISP-COUNT         02220001
022300     DISPLAY ' '                                                  02230001
022400                                                                  02240001
022500     MOVE PV-OUT01-COUNT                 TO PV-DISP-COUNT         02250001
022600     DISPLAY ' TOTAL OUT01 COUNT:      '    PV-DISP-COUNT         02260001
022700     DISPLAY ' '                                                  02270001
022800                                                                  02280001
022900     DISPLAY '* RDC - BULK ASN ONLY TO BE CONVERTED TO RCRD109'.  02290001
023000                                                                  02300001
023100     MOVE PV-HDR-OUT02-COUNT             TO  PV-DISP-COUNT        02310001
023200     DISPLAY ' HDR COUNT:              '     PV-DISP-COUNT        02320001
023300                                                                  02330001
023400     MOVE PV-DTL-OUT02-COUNT             TO  PV-DISP-COUNT        02340001
023500     DISPLAY ' DTL COUNT:              '     PV-DISP-COUNT        02350001
023600                                                                  02360001
023700     MOVE PV-CRTN-OUT02-COUNT            TO PV-DISP-COUNT         02370001
023800     DISPLAY ' CRTN COUNT:             '    PV-DISP-COUNT         02380001
023900     DISPLAY ' '                                                  02390001
024000                                                                  02400001
024100                                                                  02410001
024200     DISPLAY ' '                                                  02420001
024300     DISPLAY '* OUT02 - INDIVIDUAL SSCC RECORDS --- RCRD109'.     02430001
024400                                                                  02440001
024500     MOVE PV-SSCC-COUNT                  TO PV-DISP-COUNT         02450001
024600     DISPLAY ' SSCC COUNT:             '    PV-DISP-COUNT         02460001
024700                                                                  02470001
024800     MOVE PV-ASN-DTL-NO-CARTONS-CNT      TO PV-DISP-COUNT         02480001
024900     DISPLAY ' ASN DTL NOT CARTONS:    '    PV-DISP-COUNT         02490001
025000                                                                  02500001
025100     MOVE PV-OUT02-COUNT                 TO PV-DISP-COUNT         02510001
025200     DISPLAY ' OUT02 COUNT:            '    PV-DISP-COUNT         02520001
025300     DISPLAY ' '                                                  02530001
025400                                                                  02540001
025410     DISPLAY '* OUT03 - SEPHORA ASN - FORMAT RCRD001      '.      02541008
025420                                                                  02542002
025430     MOVE PV-HDR-OUT03-COUNT             TO  PV-DISP-COUNT        02543002
025440     DISPLAY ' HDR COUNT:              '     PV-DISP-COUNT        02544002
025450                                                                  02545002
025460     MOVE PV-DTL-OUT03-COUNT             TO  PV-DISP-COUNT        02546002
025470     DISPLAY ' DTL COUNT:              '     PV-DISP-COUNT        02547002
025480                                                                  02548002
025490     MOVE PV-CRTN-OUT03-COUNT            TO PV-DISP-COUNT         02549002
025491     DISPLAY ' CRTN COUNT:             '    PV-DISP-COUNT         02549102
025492     DISPLAY ' '                                                  02549202
025493                                                                  02549302
025500     DISPLAY ' RCKUT181 - END'.                                   02550001
025600     DISPLAY ' '.                                                 02560001
025700                                                                  02570001
025800     STOP RUN.                                                    02580001
025900                                                                  02590001
026000                                                                  02600001
026100*-----------------------------------------------------------------02610001
026200*  PROCESS ASN INPUT FILE                                         02620001
026300*-----------------------------------------------------------------02630001
026400 2000-PROCESS-FILE.                                               02640001
026440                                                                  02644018
026500                                                                  02650001
026600*                                                                 02660001
026700* CHECK IF ASN IS THE SAME AS PREVIOUS ASN                        02670001
026800*                                                                 02680001
026900*    IF THE ASN MATCHES THE PREVIOUS ASN                          02690001
027000*       IF PREVIOUS NOT RETAIL DC - WRITE TO OUT01 FILE           02700001
027100*       IF PREVIOUS RETAIL DC - AND PO IS NOT BULK                02710001
027200*                                 - WRITE TO OUT01 FILE           02720001
027300*       IF PREVIOUS RETAIL DC - AND BULK                          02730001
027400*                                 - WRITE TO OUT02 FILE           02740001
027500*                                                                 02750001
027600     IF  RC001-DIST-CNTR       =  PV-PREV-DIST-CNTR               02760001
027610*                                                                 02761002
027621         IF  PS-SEPHORA-ASN                                       02762127
027622             IF  RC001-CARTON-IND = ' '                           02762212
027623                 DISPLAY ' '                                      02762312
027624                 DISPLAY 'SEPHORA ASN:  ' RC001-DIST-CNTR         02762412
027625                         '  '             RC001-ASNHDR-NBR        02762512
027626                         '   PO:'         RC001-PO-NBR            02762613
027627             END-IF                                               02762713
027628             PERFORM 8300-WRITE-OUT03                             02762813
027629         ELSE                                                     02762913
027640*                                                                 02764002
027700             IF  PS-RETAIL-DC-NO                                  02770002
027800                 PERFORM 8100-WRITE-OUT01                         02780002
027900             ELSE                                                 02790002
028000                 IF  RC001-PO-NBR  =  PV-PREV-PO-NBR              02800002
028100                     CONTINUE                                     02810002
028200                 ELSE                                             02820002
028300                     PERFORM 3100-CHECK-PO-BULK                   02830002
028400                 END-IF                                           02840002
028500                                                                  02850001
028600                 IF  PS-PO-BULK-NO  OR                            02860002
028700                     PS-SPLIT-DC-BULK-ASN-NO                      02870002
028800                     ADD  1   TO  PV-OUT01-RDC-NOT-BULK-COUNT     02880002
028900                     PERFORM 8100-WRITE-OUT01                     02890002
029000                 ELSE                                             02900002
029100                     PERFORM 4000-SPLIT-OFF-SSCC                  02910002
029200                 END-IF                                           02920002
029300             END-IF                                               02930002
029310         END-IF                                                   02931002
029400     ELSE                                                         02940001
029401*                                                                 02940102
029410         PERFORM 3400-SEPHORA-ASN                                 02941002
029411         IF  PS-SEPHORA-ASN                                       02941102
029412             PERFORM 8300-WRITE-OUT03                             02941202
029413         ELSE                                                     02941302
029430*                                                                 02943002
029500             PERFORM 3000-RETAIL-DC                               02950002
029600             IF  PS-RETAIL-DC                                     02960002
029700                 PERFORM 3100-CHECK-PO-BULK                       02970002
029800             END-IF                                               02980002
029900             IF  PS-RETAIL-DC-NO  OR                              02990002
030000                 PS-SPLIT-DC-BULK-ASN-NO                          03000002
030100                 PERFORM 8100-WRITE-OUT01                         03010002
030200             ELSE                                                 03020002
030300                 IF  PS-PO-BULK-NO                                03030002
030400                     PERFORM 8100-WRITE-OUT01                     03040002
030500                 ELSE                                             03050002
030600                     PERFORM 4000-SPLIT-OFF-SSCC                  03060002
030700                 END-IF                                           03070002
030800             END-IF                                               03080002
030810         END-IF                                                   03081002
030900     END-IF.                                                      03090001
031000                                                                  03100001
031100     PERFORM 8000-READ-INPUT.                                     03110001
031200                                                                  03120001
031300     IF  PS-RETAIL-DC  AND                                        03130001
031400         PS-PO-BULK    AND                                        03140001
031500         PS-SPLIT-DC-BULK-ASN                                     03150001
031600         IF  RC001-CARTON-IND  =  SPACES  AND                     03160001
031700             PS-DETAIL-NOT-CREATED                                03170001
031800             PERFORM 4320-ASN-DTL-NO-CARTONS                      03180001
031900             ELSE                                                 03190001
032000             IF  RC001-CARTON-IND  =  'N'  AND                    03200001
032100                 RC001-PO-NBR      =  PV-PREV-PO-NBR  AND         03210001
032200                 RC001-PO-LINE-NBR NOT = PV-PREV-PO-LINE-NBR AND  03220001
032300                 PV-PREV-PO-LINE-NBR NOT = '0000'  AND            03230001
032400                 PS-DETAIL-NOT-CREATED                            03240001
032500                 PERFORM 4320-ASN-DTL-NO-CARTONS                  03250001
032600             END-IF                                               03260001
032700         END-IF                                                   03270001
032800     END-IF.                                                      03280001
032900                                                                  03290001
033000                                                                  03300001
033100                                                                  03310001
033200*-----------------------------------------------------------------03320001
033300*  CHECK IF ASN IS FOR A RETAIL DC                                03330001
033400*-----------------------------------------------------------------03340001
033500 3000-RETAIL-DC.                                                  03350001
033600                                                                  03360001
033700     SET   PS-RETAIL-DC-NO  TO  TRUE.                             03370001
033800     MOVE  RC001-DIST-CNTR  TO  XLT00010-LOC-NBR.                 03380001
033900                                                                  03390001
034000     EXEC SQL                                                     03400001
034100          SELECT LOC_TYP_CDE                                      03410001
034200            INTO :XLT00010-LOC-TYP-CDE                            03420001
034300            FROM XLT_LOC                                          03430001
034400           WHERE LOC_NBR           =  :XLT00010-LOC-NBR           03440001
034500             AND LOC_TYP_CDE       =  'DC'                        03450001
034600             AND E_BUS_IND         =  'N'                         03460001
034700             AND CLO_DTE          >=  CURRENT DATE                03470001
034800            WITH  UR                                              03480001
034900     END-EXEC.                                                    03490001
035000                                                                  03500001
035010     EVALUATE TRUE                                                03501001
035020         WHEN SQLCODE = +0                                        03502001
035030             SET PS-RETAIL-DC      TO  TRUE                       03503001
035040             MOVE RC001-DIST-CNTR  TO  PV-PREV-DIST-CNTR          03504001
035050             DISPLAY ' '                                          03505001
035060             DISPLAY 'RETAIL DC:    ' RC001-DIST-CNTR             03506001
035061                                                                  03506116
035071         WHEN SQLCODE = +100                                      03507101
035072             SET PS-RETAIL-DC-NO   TO  TRUE                       03507201
035073             MOVE RC001-DIST-CNTR  TO  PV-PREV-DIST-CNTR          03507301
035074             DISPLAY ' '                                          03507401
035075             DISPLAY 'NOT RETAIL DC:' RC001-DIST-CNTR             03507501
035076                                                                  03507601
035077         WHEN SQLWARN0 NOT = SPACES                               03507701
035078         WHEN SQLCODE < +0                                        03507801
035079         WHEN SQLCODE > +0                                        03507901
035080             SET PS-RETAIL-DC-NO   TO  TRUE                       03508001
035081             DISPLAY ' '                                          03508101
035082             DISPLAY 'SQL ERROR:    ' RC001-ASN-TRANSCRIPTION-KEY 03508201
035083                                                                  03508301
035084             MOVE SQLCODE          TO  PV-DISP-SQLCODE            03508401
035085             MOVE XLT00010-LOC-NBR TO  PV-DISP-LOC                03508501
035086             SET PS-ERROR          TO  TRUE                       03508601
035087             DISPLAY '******************************************' 03508701
035088             DISPLAY '*ABEND                                   *' 03508801
035089             DISPLAY '*PROGRAM   = RCKUT181                    *' 03508901
035090             DISPLAY '*DB2 OPER  = SELECT ON XLT_LOC           *' 03509001
035091             DISPLAY '*PARAGRAPH = 3000-RETAIL-DC              *' 03509101
035092             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                03509201
035093             DISPLAY '*LOC_NBR = ' PV-DISP-LOC                    03509301
035094             DISPLAY '******************************************' 03509401
035095             PERFORM 9100-SQL-ABEND                               03509501
035096     END-EVALUATE.                                                03509601
035097                                                                  03509701
035098                                                                  03509801
035159*-----------------------------------------------------------------03515901
035160*  CHECK IF PO IS A BULK                                          03516001
035161*-----------------------------------------------------------------03516101
035162 3100-CHECK-PO-BULK.                                              03516201
035168                                                                  03516801
035169     SET   PS-PO-BULK-NO    TO  TRUE.                             03516901
035170     MOVE  RC001-PO-NBR     TO  PURCHS-PO-NBR.                    03517001
035171                                                                  03517101
035172     EXEC SQL                                                     03517201
035173          SELECT PKGNG_CDE                                        03517301
035174            INTO :PURCHS-PKGNG-CDE                                03517401
035175            FROM TPURCHS                                          03517501
035176           WHERE PO_NBR            =  :PURCHS-PO-NBR              03517601
035177             AND VER_STATUS_CDE    =  'A'                         03517701
035178             AND PKGNG_CDE         =  'B'                         03517801
035179            WITH  UR                                              03517901
035180     END-EXEC.                                                    03518001
035181                                                                  03518101
035182     EVALUATE TRUE                                                03518201
035183         WHEN SQLCODE = +0                                        03518301
035184             SET PS-PO-BULK        TO  TRUE                       03518401
035185             MOVE RC001-PO-NBR     TO  PV-PREV-PO-NBR             03518501
035186             MOVE ZEROES           TO  PV-PREV-PO-LINE-NBR        03518601
035187             DISPLAY 'BULK PO:      ' RC001-PO-NBR                03518701
035188                                                                  03518816
035189             PERFORM 3110-STORE-IS-RETAIL-DC                      03518916
035190                                                                  03519016
035191                                                                  03519101
035192         WHEN SQLCODE = +100                                      03519201
035193             SET PS-PO-BULK-NO     TO  TRUE                       03519301
035194             MOVE RC001-PO-NBR     TO  PV-PREV-PO-NBR             03519401
035195             MOVE ZEROES           TO  PV-PREV-PO-LINE-NBR        03519501
035196             DISPLAY 'NOT BULK PO:  ' RC001-PO-NBR                03519601
035197                                                                  03519701
035198         WHEN SQLWARN0 NOT = SPACES                               03519801
035199         WHEN SQLCODE < +0                                        03519901
035200         WHEN SQLCODE > +0                                        03520001
035201             SET PS-PO-BULK-NO     TO  TRUE                       03520101
035202             DISPLAY ' '                                          03520201
035203             DISPLAY 'SQL ERROR:    ' RC001-ASN-TRANSCRIPTION-KEY 03520301
035204                                                                  03520401
035205             MOVE SQLCODE          TO  PV-DISP-SQLCODE            03520501
035206             SET PS-ERROR          TO  TRUE                       03520601
035207             DISPLAY '******************************************' 03520701
035208             DISPLAY '*ABEND                                   *' 03520801
035209             DISPLAY '*PROGRAM   = RCKUT181                    *' 03520901
035210             DISPLAY '*DB2 OPER  = SELECT ON TPURCHS           *' 03521001
035211             DISPLAY '*PARAGRAPH = 3100-CHECK-PO-BULK          *' 03521101
035212             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                03521201
035213             DISPLAY '*PO-NBR  = ' RC001-PO-NBR                   03521301
035214             DISPLAY '******************************************' 03521401
035215             PERFORM 9100-SQL-ABEND                               03521501
035216     END-EVALUATE.                                                03521601
035217                                                                  03521701
035218                                                                  03521801
035219*-----------------------------------------------------------------03521916
035220*  CHECK IF STORE IS FOR A RETAIL DC                              03522016
035221*-----------------------------------------------------------------03522116
035222 3110-STORE-IS-RETAIL-DC.                                         03522216
035228                                                                  03522816
035229     MOVE  RC001-STORE-NBR  TO  DK-STR-NBR.                       03522916
035230                                                                  03523016
035231     EXEC SQL                                                     03523116
035232          SELECT LOC_TYP_CDE                                      03523216
035233            INTO :PV-LOC-TYP-CDE                                  03523316
035234            FROM XLT_LOC                                          03523416
035235           WHERE LOC_NBR           =  :DK-STR-NBR                 03523516
035236             AND LOC_TYP_CDE       =  'DC'                        03523616
035237             AND E_BUS_IND         =  'N'                         03523716
035238             AND CLO_DTE          >=  CURRENT DATE                03523816
035239            WITH  UR                                              03523916
035240     END-EXEC.                                                    03524016
035241                                                                  03524116
035242     EVALUATE TRUE                                                03524216
035243         WHEN SQLCODE = +0                                        03524316
035244             DISPLAY ' '                                          03524416
035245             DISPLAY 'RETAIL DC:    ' RC001-DIST-CNTR             03524516
035246                     'STORE NBR:    ' RC001-STORE-NBR             03524616
035247                                                                  03524716
035248         WHEN SQLCODE = +100                                      03524816
035249             SET PS-PO-BULK-NO     TO  TRUE                       03524916
035250             MOVE RC001-PO-NBR     TO  PV-PREV-PO-NBR             03525016
035251             MOVE ZEROES           TO  PV-PREV-PO-LINE-NBR        03525116
035252                                                                  03525216
035253             DISPLAY 'BULK ASN STORE NOT RDC - CANT BE SPLIT'     03525316
035254             DISPLAY 'NOT BULK PO:  ' RC001-PO-NBR    '   '       03525416
035255                     'RETAIL DC:    ' RC001-DIST-CNTR '   '       03525516
035256                     'STORE NBR:    ' RC001-STORE-NBR             03525616
035257                                                                  03525716
035258         WHEN SQLWARN0 NOT = SPACES                               03525816
035259         WHEN SQLCODE < +0                                        03525916
035260         WHEN SQLCODE > +0                                        03526016
035261             SET PS-PO-BULK-NO     TO  TRUE                       03526116
035262             DISPLAY ' '                                          03526216
035263             DISPLAY 'SQL ERROR:    ' RC001-ASN-TRANSCRIPTION-KEY 03526316
035264                                                                  03526416
035265             MOVE SQLCODE          TO  PV-DISP-SQLCODE            03526516
035266             SET PS-ERROR          TO  TRUE                       03526616
035267             DISPLAY '******************************************' 03526716
035268             DISPLAY '*ABEND                                   *' 03526816
035269             DISPLAY '*PROGRAM   = RCKUT181                    *' 03526916
035270             DISPLAY '*DB2 OPER  = SELECT ON TPURCHS           *' 03527016
035271             DISPLAY '*PARAGRAPH = 3110-STORE-IS-RETAIL-DC     *' 03527116
035272             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                03527216
035273             DISPLAY '*PO-NBR  = ' RC001-PO-NBR                   03527316
035274             DISPLAY '******************************************' 03527416
035280             PERFORM 9100-SQL-ABEND                               03528016
035287     END-EVALUATE.                                                03528716
035288                                                                  03528816
035289                                                                  03528916
035290*-----------------------------------------------------------------03529001
035291*  CHECK IF DC BULK ASN WILL BE SPLIT TO A SEPARATE FILE          03529101
035292*-----------------------------------------------------------------03529201
035293 3200-CHECK-SPLIT-PROCESSING.                                     03529301
035299                                                                  03529901
035300     SET  PS-SPLIT-DC-BULK-ASN-NO   TO  TRUE.                     03530001
035301                                                                  03530101
035302     EXEC SQL                                                     03530201
035303          SELECT  FUNC_TXT                                        03530301
035304            INTO :KRPRPM-FUNC-TXT                                 03530401
035305            FROM  TKRPRPM                                         03530501
035306           WHERE  LOC_ID            = 90                          03530601
035307             AND  SYS_PRC_FUNC_CDE  = 'ASNSPT'                    03530701
035308             AND  FUNC_PRC_STAT_CDE = 'AC'                        03530801
035309             AND  INTFC_SYS_CDE     = 'ASN'                       03530901
035310             AND  FUNC_BEG_TMST    <= CURRENT TIMESTAMP           03531001
035311             AND  FUNC_END_TMST    >= CURRENT TIMESTAMP           03531101
035312     END-EXEC.                                                    03531201
035313                                                                  03531301
035314     EVALUATE TRUE                                                03531401
035315         WHEN SQLCODE = +0                                        03531501
035316              IF  KRPRPM-FUNC-TXT  = 'Y'                          03531601
035317                  SET  PS-SPLIT-DC-BULK-ASN    TO  TRUE           03531701
035318              ELSE                                                03531801
035319                  SET  PS-SPLIT-DC-BULK-ASN-NO TO  TRUE           03531901
035320              END-IF                                              03532001
035321                                                                  03532101
035322         WHEN SQLCODE = +100                                      03532201
035323              SET  PS-SPLIT-DC-BULK-ASN-NO   TO  TRUE             03532301
035324                                                                  03532401
035325         WHEN SQLWARN0 NOT = SPACES                               03532501
035326         WHEN SQLCODE < +0                                        03532601
035327         WHEN SQLCODE > +0                                        03532701
035328              SET  PS-SPLIT-DC-BULK-ASN-NO   TO  TRUE             03532801
035329              DISPLAY ' '                                         03532901
035330              DISPLAY 'SQL ERROR:    ' RC001-ASN-TRANSCRIPTION-KEY03533001
035331                                                                  03533101
035332              MOVE SQLCODE          TO  PV-DISP-SQLCODE           03533201
035333              SET PS-ERROR          TO  TRUE                      03533301
035334             DISPLAY '******************************************' 03533401
035335             DISPLAY '*ABEND                                   *' 03533501
035336             DISPLAY '*PROGRAM   = RCKUT181                    *' 03533601
035337             DISPLAY '*DB2 OPER  = SELECT ON TKRPRPM ASNSPT    *' 03533701
035338             DISPLAY '*PARAGRAPH = 3200-CHECK-SPLIT-PROCESSING *' 03533801
035339             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                03533901
035340             DISPLAY '******************************************' 03534001
035341             PERFORM 9100-SQL-ABEND                               03534101
035342     END-EVALUATE.                                                03534201
035343                                                                  03534301
035344                                                                  03534401
035345*-----------------------------------------------------------------03534502
035346*  CHECK IF ASN IS FOR A SEPHORA OPER                             03534602
035347*-----------------------------------------------------------------03534702
035348 3400-SEPHORA-ASN.                                                03534802
035354                                                                  03535402
035355     SET  PS-SEPHORA-ASN-NO         TO  TRUE.                     03535502
035356     MOVE RC001-DIST-CNTR           TO  DK-OPER-UNT-ID.           03535605
035357                                                                  03535702
035358     EXEC SQL                                                     03535802
035359          SELECT  FUNC_TXT                                        03535902
035360            INTO :PV-CHECK-SEPHORA-DEPT                           03536002
035361            FROM  TKRPRPM                                         03536102
035362           WHERE  LOC_ID            = :DK-OPER-UNT-ID             03536202
035363             AND  SYS_PRC_FUNC_CDE  = 'SPHASN'                    03536302
035364             AND  FUNC_PRC_STAT_CDE = 'AC'                        03536402
035365             AND  INTFC_SYS_CDE     = 'ASN'                       03536502
035366             AND  FUNC_BEG_TMST    <= CURRENT TIMESTAMP           03536602
035367             AND  FUNC_END_TMST    >= CURRENT TIMESTAMP           03536702
035368     END-EXEC.                                                    03536802
035369                                                                  03536902
035370     EVALUATE TRUE                                                03537002
035371         WHEN SQLCODE = +0                                        03537102
035372              IF  PV-CHECK-SEPHORA-DEPT  = 'Y'                    03537202
035373                  SET  PS-SEPHORA-ASN          TO  TRUE           03537302
035374                  MOVE RC001-DIST-CNTR  TO  PV-PREV-DIST-CNTR     03537409
035375                  DISPLAY ' '                                     03537509
035376                  DISPLAY 'SEPHORA LOCATION: ' RC001-DIST-CNTR    03537615
035377              ELSE                                                03537714
035378                  SET  PS-SEPHORA-ASN-NO       TO  TRUE           03537814
035379              END-IF                                              03537914
035380                                                                  03538014
035381         WHEN SQLCODE = +100                                      03538114
035382              SET  PS-SEPHORA-ASN-NO         TO  TRUE             03538214
035383                                                                  03538314
035384         WHEN SQLWARN0 NOT = SPACES                               03538414
035385         WHEN SQLCODE < +0                                        03538514
035386         WHEN SQLCODE > +0                                        03538614
035387              SET  PS-SEPHORA-ASN-NO         TO  TRUE             03538714
035388              MOVE DK-OPER-UNT-ID            TO  PV-DISP-OPER     03538814
035389              DISPLAY ' '                                         03538914
035390              DISPLAY 'SQL ERROR:    ' RC001-ASN-TRANSCRIPTION-KEY03539014
035391              DISPLAY 'OPER:         ' PV-DISP-OPER               03539114
035392                                                                  03539214
035393              MOVE SQLCODE          TO  PV-DISP-SQLCODE           03539314
035394              SET PS-ERROR          TO  TRUE                      03539414
035395             DISPLAY '******************************************' 03539514
035396             DISPLAY '*ABEND                                   *' 03539614
035397             DISPLAY '*PROGRAM   = RCKUT181                    *' 03539714
035398             DISPLAY '*DB2 OPER  = SELECT ON TKRPRPM SPHASN    *' 03539814
035399             DISPLAY '*PARAGRAPH = 3400-SEPHORA-ASN            *' 03539914
035400             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                03540014
035401             DISPLAY '******************************************' 03540114
035402             PERFORM 9100-SQL-ABEND                               03540214
035403     END-EVALUATE.                                                03540314
035404                                                                  03540414
035405                                                                  03540527
035406*-----------------------------------------------------------------03540627
035407*  GET THE DEFAULT PRO NUMBER FOR NON-BULK PO'S                   03540727
035408*-----------------------------------------------------------------03540827
035409 3500-GET-DEFAULT-PRO-NBR.                                        03540927
035412                                                                  03541227
035413     MOVE SPACES  TO  PV-DEFAULT-PRO-NBR.                         03541327
035414                                                                  03541427
035415     EXEC SQL                                                     03541527
035416          SELECT  FUNC_TXT                                        03541627
035417            INTO :KRPRPM-FUNC-TXT                                 03541727
035418            FROM  TKRPRPM                                         03541827
035419           WHERE  LOC_ID            = 90                          03541927
035420             AND  SYS_PRC_FUNC_CDE  = 'PRODFT'                    03542027
035421             AND  FUNC_PRC_STAT_CDE = 'AC'                        03542127
035422             AND  INTFC_SYS_CDE     = 'KHL'                       03542227
035423             AND  FUNC_BEG_TMST    <= CURRENT TIMESTAMP           03542327
035424             AND  FUNC_END_TMST    >= CURRENT TIMESTAMP           03542427
035425     END-EXEC.                                                    03542527
035426                                                                  03542627
035427     EVALUATE TRUE                                                03542727
035428         WHEN SQLCODE = +0                                        03542827
035429              MOVE KRPRPM-FUNC-TXT  TO  PV-DEFAULT-PRO-NBR        03542927
035434                                                                  03543427
035435         WHEN SQLCODE = +100                                      03543527
035436              MOVE SPACES           TO  PV-DEFAULT-PRO-NBR        03543627
035437                                                                  03543727
035438         WHEN SQLWARN0 NOT = SPACES                               03543827
035439         WHEN SQLCODE < +0                                        03543927
035440         WHEN SQLCODE > +0                                        03544027
035441              SET  PS-SPLIT-DC-BULK-ASN-NO   TO  TRUE             03544127
035443              DISPLAY 'SQL ERROR:    ' RC001-ASN-TRANSCRIPTION-KEY03544327
035444                                                                  03544427
035445              MOVE SQLCODE          TO  PV-DISP-SQLCODE           03544527
035446              SET PS-ERROR          TO  TRUE                      03544627
035447             DISPLAY '******************************************' 03544727
035448             DISPLAY '*ABEND                                   *' 03544827
035449             DISPLAY '*PROGRAM   = RCKUT181                    *' 03544927
035450             DISPLAY '*DB2 OPER  = SELECT ON TKRPRPM ASNSPT    *' 03545027
035451             DISPLAY '*PARAGRAPH = 3500-GET-DEFAULT-PRO-NBR    *' 03545127
035452             DISPLAY '*SQLCODE = ' PV-DISP-SQLCODE                03545227
035453             DISPLAY '******************************************' 03545327
035454             PERFORM 9100-SQL-ABEND                               03545427
035455     END-EVALUATE.                                                03545527
035456                                                                  03545627
035459                                                                  03545927
035460*----------------------------------------------------------------*03546026
035461* SPLIT THE ASN FILE TO ONLY WRITE OUT THE CARTON RECORDS        *03546126
035462*                                                                *03546226
035463* ASN - HEADER - RC001-CARTON-IND = BLANK                        *03546326
035464* ASN - DETAIL - RC001-CARTON-IND = N                            *03546426
035465* ASN - CARTON - RC001-CARTON-IND = Y                            *03546526
035466*                THERE ARE UP TO 10 CARTONS (SSCC) PER CARTON    *03546626
035467*                RECORD.  EACH CARTON WILL BE WRITTEN OUT        *03546726
035468*                SEPARATELY.                                     *03546826
035469*----------------------------------------------------------------*03546926
035470 4000-SPLIT-OFF-SSCC.                                             03547026
035471                                                                  03547114
035472     IF  RC001-CARTON-IND  =  SPACES                              03547214
035473         ADD  1  TO  PV-HDR-OUT02-COUNT                           03547314
035474         PERFORM 4100-HEADER-RECORD                               03547414
035475         MOVE RC001-PO-LINE-NBR TO PV-PREV-PO-LINE-NBR            03547524
035476         SET  PS-DETAIL-NOT-CREATED  TO  TRUE                     03547614
035477     ELSE                                                         03547714
035478         IF  RC001-CARTON-IND  =  'N'                             03547814
035479             ADD  1  TO  PV-DTL-OUT02-COUNT                       03547914
035480             PERFORM 4200-DETAIL-RECORD                           03548014
035481             SET  PS-DETAIL-NOT-CREATED  TO  TRUE                 03548114
035482             MOVE RC001-PO-LINE-NBR TO PV-PREV-PO-LINE-NBR        03548214
035483         ELSE                                                     03548314
035484             IF  RC001-CARTON-IND  =  'Y'                         03548414
035485                 ADD  1  TO  PV-CRTN-OUT02-COUNT                  03548514
035486                 PERFORM 4300-CARTON-RECORD                       03548614
035487                 SET  PS-DETAIL-CREATED  TO  TRUE                 03548714
035488             END-IF                                               03548814
035489         END-IF                                                   03548914
035490     END-IF.                                                      03549001
035491                                                                  03549101
035492                                                                  03549201
035493*----------------------------------------------------------------*03549301
035494* HEADER RECORD INFORMATION                                      *03549401
035495*----------------------------------------------------------------*03549501
035496 4100-HEADER-RECORD.                                              03549601
035497                                                                  03549701
035498     MOVE SPACES  TO  RC109-ASN-TRANSCRIPTION-RECORD.             03549801
035499                                                                  03549901
035500     MOVE ZEROES  TO  RC109-DIST-CNTR                             03550001
035501                      RC109-EDI-VEND-ID                           03550101
035502                      RC109-PO-NBR                                03550201
035503                      RC109-STORE-NBR                             03550301
035504                      RC109-SEQUENCE-NBR                          03550401
035505                      RC109-DEPT-NBR                              03550501
035506                      RC109-BUYER-NBR                             03550601
035507                      RC109-DATE-SHIPPED                          03550701
035508                      RC109-PO-DATE                               03550801
035509                      RC109-REQ-SHIP-DATE                         03550901
035510                      RC109-CANCEL-DATE                           03551001
035511                      RC109-CANCEL-EXT-DATE                       03551101
035512                      RC109-AD-DATE                               03551201
035513                      RC109-CARR-VEND-ID                          03551301
035514                      RC109-SHIPMENT-WEIGHT                       03551401
035515                      RC109-CARTON-CNT-STORE                      03551501
035516                      RC109-CARTON-CNT-PO                         03551601
035517                      RC109-CARTON-CNT-SHPMT                      03551701
035518                      RC109-ISA-NBR                               03551801
035519                      RC109-DIST-PACK-QTY                         03551901
035520                      RC109-UPC-NBR                               03552001
035521                      RC109-UNIT-COST                             03552101
035522                      RC109-UNIT-RETAIL                           03552201
035523                      RC109-QTY-ORDERED                           03552301
035524                      RC109-QTY-SHIPPED                           03552401
035525                      RC109-QTY-SHIPPED-VAR                       03552501
035526                      RC109-PR-CHG-EFF-DAYS                       03552601
035527                      RC109-CARTON-NBR                            03552701
035528                      RC109-CARTON-QTY                            03552801
035529                      RC109-CTN-UPC.                              03552901
035530                                                                  03553001
035531     MOVE SPACES  TO  RC109-OPERATING-COMPANY                     03553101
035532                      RC109-CARRIER-SCAC-CODE                     03553201
035533                      RC109-BILL-OF-LADING-NBR                    03553301
035534                      RC109-PO-LINE-NBR                           03553401
035535                      RC109-CARTON-IND                            03553501
035536                      RC109-ASNHDR-NBR                            03553601
035537                      RC109-EDI-VEND-NAME                         03553701
035538                      RC109-ORIG-BOL-NBR                          03553801
035539                      RC109-SEQ-NBR-IND                           03553901
035540                      RC109-DEPT-DESC                             03554001
035541                      RC109-BUYER-NAME                            03554101
035542                      RC109-ANALYST-NAME                          03554201
035543                      RC109-CARRIER-NAME                          03554301
035544                      RC109-PRO-NBR                               03554401
035545                      RC109-TRAILER-NBR                           03554501
035546                      RC109-SHIP-WEIGHT-UM                        03554601
035547                      RC109-SPECIAL-INSTR-1                       03554701
035548                      RC109-SPECIAL-INSTR-2                       03554801
035549                      RC109-SPECIAL-INSTR-3                       03554901
035550                      RC109-ASNORD-EARLY-LTE-CDE                  03555001
035551                      RC109-ASNORD-MTCH-PO-CDE                    03555101
035552                      RC109-VENDOR-TRSCP-IND                      03555201
035553                      RC109-LINE-ERROR-IND                        03555301
035554                      RC109-CONT-NBR                              03555401
035555                      RC109-MAN-SEG-IND                           03555501
035556                      RC109-CARR-AUTH-ID                          03555601
035557                      RC109-HDR-FILLER                            03555701
035558                      RC109-SKU-DEPT-NBR                          03555801
035559                      RC109-SKU-CLASS-NBR                         03555901
035560                      RC109-SKU-SEQ-NBR                           03556001
035561                      RC109-UPC-DESC                              03556101
035562                      RC109-VENDOR-STYLE                          03556201
035563                      RC109-SIZE                                  03556301
035564                      RC109-COLOR                                 03556401
035565                      RC109-QTY-ORDERED-UM                        03556501
035566                      RC109-QTY-SHIPPED-UM                        03556601
035567                      RC109-ASDTPL-ALLOC-IND                      03556701
035568                      RC109-ASDTPL-MATCH-IND                      03556801
035569                      RC109-ASDTPL-PR-DISC-IND                    03556901
035570                      RC109-ASDTPL-PR-VAR-IND                     03557001
035571                      RC109-SKU-NBR                               03557101
035572                      RC109-DTL-FILLER                            03557201
035573                      RC109-CRTN-UNIQUE-SW                        03557301
035574                      RC109-CARTON-FIL                            03557401
035575                      RC109-ASN-DATE                              03557501
035576                      RC109-ASN-TIME.                             03557601
035577                                                                  03557701
035578     MOVE RC001-OPERATING-COMPANY  TO RC109-OPERATING-COMPANY.    03557801
035579     MOVE RC001-DIST-CNTR          TO RC109-DIST-CNTR.            03557901
035580     MOVE RC001-EDI-VEND-ID        TO RC109-EDI-VEND-ID.          03558001
035581     MOVE RC001-CARRIER-SCAC-CODE  TO RC109-CARRIER-SCAC-CODE.    03558101
035582     MOVE RC001-BILL-OF-LADING-NBR TO RC109-BILL-OF-LADING-NBR.   03558201
035583     MOVE RC001-PO-NBR             TO RC109-PO-NBR.               03558301
035584     MOVE RC001-STORE-NBR          TO RC109-STORE-NBR.            03558401
035585     MOVE RC001-PO-LINE-NBR        TO RC109-PO-LINE-NBR.          03558501
035586     MOVE RC001-SEQUENCE-NBR       TO RC109-SEQUENCE-NBR.         03558601
035587     MOVE RC001-CARTON-IND         TO RC109-CARTON-IND.           03558701
035588     MOVE RC001-ASNHDR-NBR         TO RC109-ASNHDR-NBR.           03558801
035589     MOVE RC001-EDI-VEND-NAME      TO RC109-EDI-VEND-NAME.        03558901
035590     MOVE RC001-ORIG-BOL-NBR       TO RC109-ORIG-BOL-NBR.         03559001
035591     MOVE RC001-SEQ-NBR-IND        TO RC109-SEQ-NBR-IND.          03559101
035592     MOVE RC001-DEPT-NBR           TO RC109-DEPT-NBR.             03559201
035593     MOVE RC001-DEPT-DESC          TO RC109-DEPT-DESC.            03559301
035594     MOVE RC001-BUYER-NBR          TO RC109-BUYER-NBR.            03559401
035595     MOVE RC001-BUYER-NAME         TO RC109-BUYER-NAME.           03559501
035596     MOVE RC001-ANALYST-NAME       TO RC109-ANALYST-NAME.         03559601
035597     MOVE RC001-DATE-SHIPPED       TO RC109-DATE-SHIPPED.         03559701
035598     MOVE RC001-PO-DATE            TO RC109-PO-DATE.              03559801
035599     MOVE RC001-REQ-SHIP-DATE      TO RC109-REQ-SHIP-DATE.        03559901
035600     MOVE RC001-CANCEL-DATE        TO RC109-CANCEL-DATE.          03560001
035601     MOVE RC001-CANCEL-EXT-DATE    TO RC109-CANCEL-EXT-DATE.      03560101
035602     MOVE RC001-AD-DATE            TO RC109-AD-DATE.              03560201
035603     MOVE RC001-CARR-VEND-ID       TO RC109-CARR-VEND-ID.         03560301
035604     MOVE RC001-CARRIER-NAME       TO RC109-CARRIER-NAME.         03560401
035605     MOVE RC001-PRO-NBR            TO RC109-PRO-NBR.              03560501
035606     MOVE RC001-TRAILER-NBR        TO RC109-TRAILER-NBR.          03560601
035607     MOVE RC001-SHIPMENT-WEIGHT    TO RC109-SHIPMENT-WEIGHT.      03560701
035608     MOVE RC001-SHIP-WEIGHT-UM     TO RC109-SHIP-WEIGHT-UM.       03560801
035609     MOVE RC001-CARTON-CNT-STORE   TO RC109-CARTON-CNT-STORE.     03560901
035610     MOVE RC001-CARTON-CNT-PO      TO RC109-CARTON-CNT-PO.        03561001
035611     MOVE RC001-CARTON-CNT-SHPMT   TO RC109-CARTON-CNT-SHPMT.     03561101
035612     MOVE RC001-SPECIAL-INSTR-1    TO RC109-SPECIAL-INSTR-1.      03561201
035613     MOVE RC001-SPECIAL-INSTR-2    TO RC109-SPECIAL-INSTR-2.      03561301
035614     MOVE RC001-SPECIAL-INSTR-3    TO RC109-SPECIAL-INSTR-3.      03561401
035615     MOVE RC001-ASNORD-EARLY-LTE-CDE                              03561501
035616                                   TO RC109-ASNORD-EARLY-LTE-CDE. 03561601
035617     MOVE RC001-ASNORD-MTCH-PO-CDE TO RC109-ASNORD-MTCH-PO-CDE.   03561701
035618     MOVE RC001-VENDOR-TRSCP-IND   TO RC109-VENDOR-TRSCP-IND.     03561801
035619     MOVE RC001-LINE-ERROR-IND     TO RC109-LINE-ERROR-IND.       03561901
035620     MOVE RC001-CONT-NBR           TO RC109-CONT-NBR.             03562001
035621     MOVE ZEROES                   TO RC109-ISA-NBR.              03562101
035622     MOVE RC001-MAN-SEG-IND        TO RC109-MAN-SEG-IND.          03562201
035623     MOVE RC001-CARR-AUTH-ID       TO RC109-CARR-AUTH-ID.         03562301
035624     MOVE RC001-HDR-FILLER         TO RC109-HDR-FILLER.           03562401
035625                                                                  03562501
035626                                                                  03562601
035627*----------------------------------------------------------------*03562701
035628* DETAIL RECORD INFORMATION                                      *03562801
035629*----------------------------------------------------------------*03562901
035630 4200-DETAIL-RECORD.                                              03563001
035631                                                                  03563118
035632     MOVE RC001-SKU-DEPT-NBR       TO RC109-SKU-DEPT-NBR.         03563218
035633     MOVE RC001-SKU-CLASS-NBR      TO RC109-SKU-CLASS-NBR.        03563318
035634     MOVE RC001-SKU-SEQ-NBR        TO RC109-SKU-SEQ-NBR.          03563418
035635     MOVE RC001-DIST-PACK-QTY      TO RC109-DIST-PACK-QTY.        03563518
035636     MOVE RC001-UPC-NBR            TO RC109-UPC-NBR.              03563618
035637     MOVE RC001-UPC-DESC           TO RC109-UPC-DESC.             03563718
035638     MOVE RC001-VENDOR-STYLE       TO RC109-VENDOR-STYLE.         03563818
035639     MOVE RC001-SIZE               TO RC109-SIZE.                 03563918
035640     MOVE RC001-COLOR              TO RC109-COLOR.                03564018
035641     MOVE RC001-UNIT-COST          TO RC109-UNIT-COST.            03564118
035642     MOVE RC001-UNIT-RETAIL        TO RC109-UNIT-RETAIL.          03564218
035643     MOVE RC001-QTY-ORDERED        TO RC109-QTY-ORDERED.          03564318
035644     MOVE RC001-QTY-ORDERED-UM     TO RC109-QTY-ORDERED-UM.       03564418
035645     MOVE RC001-QTY-SHIPPED        TO RC109-QTY-SHIPPED.          03564518
035646     MOVE RC001-QTY-SHIPPED-UM     TO RC109-QTY-SHIPPED-UM.       03564618
035647     MOVE RC001-QTY-SHIPPED-VAR    TO RC109-QTY-SHIPPED-VAR.      03564718
035648     MOVE RC001-PR-CHG-EFF-DAYS    TO RC109-PR-CHG-EFF-DAYS.      03564818
035649     MOVE RC001-ASDTPL-ALLOC-IND   TO RC109-ASDTPL-ALLOC-IND.     03564918
035650     MOVE RC001-ASDTPL-MATCH-IND   TO RC109-ASDTPL-MATCH-IND.     03565018
035651     MOVE RC001-ASDTPL-PR-DISC-IND TO RC109-ASDTPL-PR-DISC-IND.   03565118
035652     MOVE RC001-ASDTPL-PR-VAR-IND  TO RC109-ASDTPL-PR-VAR-IND.    03565218
035653     MOVE RC001-SKU-NBR            TO RC109-SKU-NBR.              03565318
035654     MOVE RC001-DTL-FILLER         TO RC109-DTL-FILLER.           03565418
035655                                                                  03565518
035656                                                                  03565618
035657*----------------------------------------------------------------*03565718
035658* CARTON RECORDS                                                 *03565818
035659*----------------------------------------------------------------*03565918
035660 4300-CARTON-RECORD.                                              03566018
035661                                                                  03566118
035662     PERFORM 4310-PROCESS-ASN-CARTONS                             03566218
035663             VARYING PV-SUB                                       03566318
035664                FROM 1 BY 1                                       03566418
035665               UNTIL PV-SUB > 10 OR                               03566518
035666                     RC001-CARTON-NBR(PV-SUB) = 0.                03566618
035667                                                                  03566718
035668                                                                  03566818
035669 4310-PROCESS-ASN-CARTONS.                                        03566918
035670                                                                  03567018
035671     MOVE RC001-PO-LINE-NBR        TO RC109-PO-LINE-NBR.          03567118
035672     MOVE RC001-CARTON-NBR(PV-SUB) TO RC109-CARTON-NBR.           03567218
035673     MOVE RC001-CARTON-QTY(PV-SUB) TO RC109-CARTON-QTY.           03567318
035674     MOVE RC001-CTN-UPC(PV-SUB)    TO RC109-CTN-UPC.              03567418
035675     MOVE SPACE                    TO RC109-CRTN-UNIQUE-SW.       03567518
035676     MOVE RC001-CARTON-FIL(PV-SUB) TO RC109-CARTON-FIL.           03567618
035677     MOVE PV-CURRENT-DATE          TO RC109-ASN-DATE.             03567718
035678     MOVE PV-CURRENT-TIME          TO RC109-ASN-TIME.             03567818
035679                                                                  03567918
035680     PERFORM 8200-WRITE-OUT02.                                    03568018
035700     ADD  1  TO  PV-SSCC-COUNT.                                   03570001
035800                                                                  03580001
035900                                                                  03590001
036000*----------------------------------------------------------------*03600001
036100* BULK ASN - HAS HEADER & DETAIL - NO CARTON RECORDS             *03610001
036110*----------------------------------------------------------------*03611001
036120 4320-ASN-DTL-NO-CARTONS.                                         03612001
036130                                                                  03613001
036140     MOVE PV-PREV-PO-LINE-NBR      TO RC109-PO-LINE-NBR           03614001
036150     MOVE ZEROES                   TO RC109-CARTON-NBR            03615001
036160                                      RC109-CARTON-QTY            03616001
036170                                      RC109-CTN-UPC.              03617001
036180     MOVE SPACE                    TO RC109-CRTN-UNIQUE-SW        03618001
036190                                      RC109-CARTON-FIL.           03619001
036200     MOVE PV-CURRENT-DATE          TO RC109-ASN-DATE.             03620001
036300     MOVE PV-CURRENT-TIME          TO RC109-ASN-TIME.             03630001
036400                                                                  03640001
036500     PERFORM 8200-WRITE-OUT02.                                    03650001
036600     ADD  1  TO  PV-ASN-DTL-NO-CARTONS-CNT.                       03660001
036700                                                                  03670001
036800                                                                  03680001
036900*----------------------------------------------------------------*03690001
037000* READ INPUT ASN FILE                                            *03700001
037100*----------------------------------------------------------------*03710001
037200 8000-READ-INPUT.                                                 03720001
037300                                                                  03730001
037400     READ  INPUT-FILE                                             03740001
037500           INTO  RC001-ASN-TRANSCRIPTION-RECORD                   03750001
037600           AT END                                                 03760001
037700                 SET PS-END-OF-FILE  TO  TRUE                     03770001
037800           NOT AT END                                             03780001
037900                 ADD 1  TO  PV-READ-COUNT                         03790001
038000                 IF  RC001-CARTON-IND  =  SPACES                  03800001
038100                     ADD 1  TO  PV-HEADER-COUNT                   03810001
038200                 END-IF                                           03820001
038300                 IF  RC001-CARTON-IND  =  'N'                     03830001
038400                     ADD 1  TO  PV-DETAIL-COUNT                   03840001
038500                 END-IF                                           03850001
038600                 IF  RC001-CARTON-IND  =  'Y'                     03860001
038700                     ADD 1  TO  PV-CARTON-COUNT                   03870001
038800                 END-IF                                           03880001
038900     END-READ.                                                    03890001
039000                                                                  03900001
039100                                                                  03910001
039200                                                                  03920001
039300*----------------------------------------------------------------*03930001
039400* OUTPUT FILE 1 - NOT RETAIL DC & NOT BULK                       *03940001
039500*----------------------------------------------------------------*03950001
039600 8100-WRITE-OUT01.                                                03960001
039700                                                                  03970001
039701*                                                                 03970127
039702*  IF THE PO IS NOT BULK, AND DC BULK PO'S ARE BEING SPLIT TO     03970227
039703*  ANOTHER FILE, AND THIS IS HEADER RECORD,  AND THE PRO NBR      03970327
039704*  IS BLANK - POPULATE THE PRO NUMBER TO BE THE DEFAULT VALUE.    03970427
039705*                                                                 03970527
039780                                                                  03978027
039800     IF  RC001-CARTON-IND  =  SPACES                              03980001
039900         ADD  1  TO  PV-HDR-OUT01-COUNT                           03990001
039910         IF  PS-PO-BULK-NO                AND                     03991028
039920             PS-SPLIT-DC-BULK-ASN         AND                     03992028
039940             RC001-PRO-NBR             =  SPACES                  03994028
039950             MOVE  PV-DEFAULT-PRO-NBR  TO  RC001-PRO-NBR          03995028
039960         END-IF                                                   03996028
040000     ELSE                                                         04000001
040100         IF  RC001-CARTON-IND  =  'N'                             04010001
040200             ADD  1  TO  PV-DTL-OUT01-COUNT                       04020001
040300         ELSE                                                     04030001
040400             IF  RC001-CARTON-IND  =  'Y'                         04040001
040500                 ADD  1  TO  PV-CRTN-OUT01-COUNT                  04050001
040600             END-IF                                               04060001
040700         END-IF                                                   04070001
040800     END-IF.                                                      04080001
040900                                                                  04090001
041000     WRITE ASN-NO-CHANGE-RECORD                                   04100001
041100           FROM  RC001-ASN-TRANSCRIPTION-RECORD.                  04110001
041200                                                                  04120001
041300     ADD  1  TO  PV-OUT01-COUNT.                                  04130001
041400                                                                  04140001
041500                                                                  04150001
041600*----------------------------------------------------------------*04160001
041700* OUTPUT FILE 2 - RETAIL DC & BULK                               *04170001
041800*----------------------------------------------------------------*04180001
041900 8200-WRITE-OUT02.                                                04190001
042000                                                                  04200001
042100     WRITE ASN-BULK-ORDER-RECORD                                  04210001
042200           FROM  RC109-ASN-TRANSCRIPTION-RECORD.                  04220001
042300                                                                  04230001
042400     ADD  1  TO  PV-OUT02-COUNT.                                  04240001
042500                                                                  04250001
042600                                                                  04260001
042610*----------------------------------------------------------------*04261002
042620* OUTPUT FILE 3 - SEPHORA ASN                                    *04262002
042630*----------------------------------------------------------------*04263002
042640 8300-WRITE-OUT03.                                                04264002
042650                                                                  04265002
042660     IF  RC001-CARTON-IND  =  SPACES                              04266002
042670         ADD  1  TO  PV-HDR-OUT03-COUNT                           04267002
042680     ELSE                                                         04268002
042690         IF  RC001-CARTON-IND  =  'N'                             04269002
042691             ADD  1  TO  PV-DTL-OUT03-COUNT                       04269102
042692         ELSE                                                     04269202
042693             IF  RC001-CARTON-IND  =  'Y'                         04269302
042694                 ADD  1  TO  PV-CRTN-OUT03-COUNT                  04269402
042695             END-IF                                               04269502
042696         END-IF                                                   04269602
042697     END-IF.                                                      04269702
042698                                                                  04269802
042699     WRITE ASN-SEPHORA-RECORD                                     04269902
042700           FROM  RC001-ASN-TRANSCRIPTION-RECORD.                  04270002
042701                                                                  04270102
042702     ADD  1  TO  PV-OUT03-COUNT.                                  04270202
042703                                                                  04270302
042704                                                                  04270402
042710*-----------------------------------------------------------------04271001
042800*  PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    04280001
042900*  ERROR OR WARNING CODE OCCURS.                                  04290001
043000*-----------------------------------------------------------------04300001
043100 9100-SQL-ABEND.                                                  04310001
043200                                                                  04320001
043300     DISPLAY '9100-SQL-ABEND'.                                    04330001
043400     DISPLAY '** ABEND     **'.                                   04340001
043500     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        04350001
043600     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              04360001
043700     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION-ATTEMPTED.     04370001
043800                                                                  04380001
043900******************************************************************04390001
044000* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    04400001
044100* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         04410001
044200* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     04420001
044300* FORMAT.                                                         04430001
044400******************************************************************04440001
044500     COPY DPPD004.                                                04450001
044600                                                                  04460001
044700     MOVE +4013                  TO ABEND-CODE.                   04470001
044800     CALL 'ILBOABN0' USING ABEND-CODE.                            04480001
044900                                                                  04490001
