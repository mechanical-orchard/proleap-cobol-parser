000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             SUKRF508.                                00050000
000600 AUTHOR.                 MICHAEL WALTERS.                         00060000
000700 INSTALLATION.           KOHLS.                                   00070000
000800 DATE-WRITTEN            SEPTEMBER, 1997.                         00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200* THIS PROGRAM DISPLAYS THE CARTON AUDIT ASSOCIATE LOCATION       00120000
001300* SCREEN.                                                         00130000
001400******************************************************************00140000
263968*---------------------------------------------------------------* 00141005
263968* CHANGED 11/16/2021    BY JIM HUNTER      WR: CHG0263968         00142005
263968* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00143005
263968* MAKING THE CALL DYNAMIC VS STATIC.                              00144005
263968*---------------------------------------------------------------* 00145005
001500                                                                  00150000
001600******************************************************************00160000
001700 ENVIRONMENT DIVISION.                                            00170000
001800******************************************************************00180000
001900                                                                  00190000
002000******************************************************************00200000
002100 DATA DIVISION.                                                   00210000
002200******************************************************************00220000
002300                                                                  00230000
002400******************************************************************00240000
002500 WORKING-STORAGE SECTION.                                         00250000
002600******************************************************************00260000
002700 01  CA-COMMAREA.                                                 00270000
002800     COPY SUWS006.                                                00280004
002900    05  CA-PROGRAM-COMMAREA.                                      00290000
003000         10  CA-SELECTION-X              PIC  X(01)  VALUE SPACES.00300000
003100         10  CA-SELECTION  REDEFINES  CA-SELECTION-X              00310000
003200                                         PIC  9(01).              00320000
003300             88  CA-VALID-SELECTION      VALUE 1, 2, 3.           00330000
003400             88  CA-RECV-SELECTION       VALUE 1.                 00340000
003500             88  CA-FLAT-SELECTION       VALUE 2.                 00350000
003600             88  CA-SHIP-SELECTION       VALUE 3.                 00360000
003700                                                                  00370000
003800 01  DK-DB2-KEYS.                                                 00380000
003900     05  DK-OPER-UNT-ID                  PIC S9(04) COMP.         00390000
004000*                                                                 00400000
004100 01  PC-PROGRAM-CONSTANTS.                                        00410000
004200     05  PC-LOGON-TRAN-ID                PIC  X(04)  VALUE 'Z028'.00420000
004300     05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)  VALUE        00430000
004400         'SUKRF508'.                                              00440000
004500     05  PC-NEXT-PROGRAM                 PIC  X(08)  VALUE        00450000
004600         'SUKRF509'.                                              00460000
004700     05  PC-REPORT-PRINT-PGM             PIC  X(08)  VALUE        00470000
004800         'SUKRF523'.                                              00480000
004900     05  PC-RETURN-PGM                   PIC  X(08)  VALUE        00490000
005000         'SUKRF500'.                                              00500000
005100     05  PC-CURRENT-TRANID               PIC  X(04)  VALUE 'S508'.00510000
005110     05  PC-TRANS-UNAVAILABLE-MSG   PIC X(19) VALUE               00511002
005120                                           'TRANS NOT AVAILABLE'. 00512002
005200                                                                  00520000
005300                                                                  00530000
005400 01  PS-PROGRAM-SWITCHES.                                         00540000
005500     05  PS-ACCESS-ALLOWED-IND           PIC  X(01)  VALUE 'N'.   00550000
005600         88  PS-NO-ACCESS-ALLOWED                    VALUE 'N'.   00560000
005700         88  PS-ACCESS-ALLOWED                       VALUE 'Y'.   00570000
005800     05  PS-DC-CHECK-IND                 PIC  X(01)  VALUE 'N'.   00580000
005900         88  PS-NOT-A-DC                             VALUE 'N'.   00590000
006000         88  PS-A-DC                                 VALUE 'Y'.   00600000
006100                                                                  00610000
006200 01  PV-PROGRAM-VARIABLES.                                        00620000
006300     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE ZERO   00630000
006400                                                     COMP SYNC.   00640000
006500     05  PV-SYSID                        PIC  X(04)  VALUE SPACE. 00650000
006600     05  PV-MESSAGE-AREA                 PIC  X(19)  VALUE SPACE. 00660000
006700     05  PV-CICS-RESPONSE                PIC S9(08)  VALUE ZEROS  00670000
006800                                                     COMP SYNC.   00680000
006900     05  PV-TRANSFER-PROGRAM             PIC  X(08)  VALUE SPACE. 00690000
007000     05  PV-OPER-UNT-ID                  PIC S9(04)  VALUE ZEROS  00700000
007100                                                     COMP.        00710000
007200     05  PV-FCLTY-ID                     PIC S9(04)  VALUE ZEROS  00720000
007300                                                     COMP.        00730000
007400     05  PV-TS-ITEM                      PIC S9(04)  VALUE ZERO   00740000
007500                                                     COMP.        00750000
007600     05  PV-SIGN-ON-INFO-LENGTH          PIC S9(04)  VALUE ZERO   00760000
007700                                                     COMP SYNC.   00770000
007800*                                                                 00780000
007900 01  TS-TEMP-STORAGE-QUEUE-INFO.                                  00790000
008000     05  TS-INFO-QUEUE-NAME.                                      00800000
008100         10  TS-INFO-QUEUE-TERMINAL      PIC  X(04)  VALUE SPACE. 00810000
008200         10  FILLER                      PIC  X(04)  VALUE 'INFO'.00820000
008300                                                                  00830000
008400*                                                                 00840000
008500*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA                00850000
008600*                                                                 00860000
008700     COPY DPWS013.                                                00870004
008800                                                                  00880000
008900*                                                                 00890000
009000*    COPY BOOK FOR THE CICSAUTH SUBROUTINE                        00900000
009100*                                                                 00910000
009200     COPY DPWS008.                                                00920004
009300                                                                  00930000
009400*                                                                 00940000
009500*  SENDING/RECEIVING AREA FOR THE NUMERIC EDIT ROUTINE (DPKUT100) 00950000
009600*                                                                 00960000
009700     COPY DPWS010I.                                               00970004
009800                                                                  00980000
009900*                                                                 00990000
010000*  GENERATED DSECT FOR THE SUKM508 MAPSET                         01000000
010100*                                                                 01010000
010200     COPY SUKM508.                                                01020000
010300                                                                  01030000
010400*                                                                 01040000
010500*  KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST   01050000
010600*                                                                 01060000
010700     COPY DPWS015.                                                01070004
010800                                                                  01080000
010810*----------------------------------------------------------------*01081001
010820* HELP SCREEN COMMAREA                                            01082001
010830     COPY PCWS192.                                                01083001
010840*----------------------------------------------------------------*01084001
010850* HELP SCREEN WORK AREA                                           01085001
010860     COPY PCWS188.                                                01086001
010870                                                                  01087001
010900*                                                                 01090000
011000*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      01100000
011100*                                                                 01110000
011200     COPY DFHAID.                                                 01120000
011300                                                                  01130000
011400*                                                                 01140000
011500*  TEMPORARY STORAGE QUEUE LAYOUT FOR LOGON/UNIT RELATED          01150000
011600*  INFORMATION CAPTURED BY THE NAVIGATOR AT LOGON TIME            01160000
011700*                                                                 01170000
011800     COPY DPWS026.                                                01180004
011900                                                                  01190000
012000*                                                                 01200000
012100*  COPY BOOK CONTAINING ERROR/WARNING/INFORMATIONAL MESSAGES      01210000
012200*  TO BE DISPLAYED ON THE LRT                                     01220000
012300*                                                                 01230000
012400     COPY SUWS005.                                                01240004
012500                                                                  01250000
012600*                                                                 01260000
012700*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE LOGISTICS DOMAIN   01270004
012710*  LOCATION MASTER TABLE                                          01271004
012800*                                                                 01280000
012900     EXEC SQL                                                     01290000
013000         INCLUDE XLT00010                                         01300004
013100     END-EXEC.                                                    01310000
013200                                                                  01320000
013300*                                                                 01330000
013400*  COMMUNICATIONS AREA FOR DB2                                    01340000
013500*                                                                 01350000
013600     EXEC SQL                                                     01360000
013700         INCLUDE SQLCA                                            01370000
013800     END-EXEC.                                                    01380000
013900                                                                  01390000
014000                                                                  01400000
014100******************************************************************01410000
014200 LINKAGE SECTION.                                                 01420000
014300******************************************************************01430000
014400 01  DFHCOMMAREA.                                                 01440000
014500     05  FILLER                         OCCURS  1 TO 4072 TIMES   01450000
014600                                        DEPENDING ON EIBCALEN.    01460000
014700         10  FILLER                     PIC X.                    01470000
014800                                                                  01480000
014900                                                                  01490000
015000******************************************************************01500000
015100 PROCEDURE DIVISION.                                              01510000
015200******************************************************************01520000
015300 0000-PROGRAM-MAINLINE.                                           01530000
015400     MOVE DFHCOMMAREA  TO  CA-COMMAREA.                           01540000
015500     MOVE LOW-VALUES   TO  SU508AI.                               01550000
015600                                                                  01560000
015700     EVALUATE TRUE                                                01570000
015710****************************************************************  01571003
015720* DPKRF278 IS THE PGM FOR THE HELP SCREEN.                        01572003
015730****************************************************************  01573003
015740         WHEN EIBTRNID = 'Z278'                                   01574003
015750             MOVE DFHCOMMAREA          TO PC192-COMMAREA          01575003
015760             MOVE PC192-HOST-SAVE-AREA TO CA-COMMAREA             01576003
015770             SET SU006-PROCESS-SCREEN  TO TRUE                    01577003
015780             MOVE SU006-OPER-UNT-ID-X TO AOPRUNTO                 01578003
015790             PERFORM 8000-SEND-MAP                                01579003
015791             PERFORM 8200-RETURN-TRANID                           01579103
015792                                                                  01579203
015800         WHEN EIBCALEN = ZERO                                     01580000
015900         WHEN EIBAID = DFHCLEAR                                   01590000
016000         WHEN SU006-INITIALIZE-SCREEN                             01600000
016100             INITIALIZE SU006-APPL-COMMAREA                       01610000
016200             INITIALIZE CA-PROGRAM-COMMAREA                       01620000
016300*            IF THE OPER-UNT-ID IS ALREADY FULL, DON'T RESET IT   01630000
016400             IF SU006-OPER-UNT-ID-X > SPACES                      01640000
016500                 CONTINUE                                         01650000
016600             ELSE                                                 01660000
016700                 PERFORM 1000-FIND-SYSTEM-ID                      01670000
016800                 PERFORM 1100-FIND-LOGON-INFO                     01680000
016900             END-IF                                               01690000
017000             MOVE SU006-OPER-UNT-ID-X TO AOPRUNTO                 01700000
017100             SET SU006-PROCESS-SCREEN  TO  TRUE                   01710000
017200             PERFORM 8000-SEND-MAP                                01720000
017300             PERFORM 8200-RETURN-TRANID                           01730000
017400                                                                  01740000
017500         WHEN EIBAID = DFHENTER                                   01750000
017600             PERFORM 1200-RECEIVE-MAP                             01760000
017700             PERFORM 1300-EDIT-SELECTION                          01770000
017800             PERFORM 2000-PROCESS-SELECTION                       01780000
017900                                                                  01790000
018000         WHEN EIBAID = DFHPF3                                     01800000
018100             MOVE PC-RETURN-PGM         TO  PV-TRANSFER-PROGRAM   01810000
018200             PERFORM 2100-XCTL-TO-SELECTED-PROGRAM                01820000
018300                                                                  01830000
018301         WHEN EIBAID = DFHPF1                                     01830101
018302              PERFORM 1400-HELP-SCREEN                            01830201
018303                                                                  01830301
018400         WHEN EIBAID = DFHPF4                                     01840000
018500             PERFORM 1200-RECEIVE-MAP                             01850000
018600             PERFORM 1300-EDIT-SELECTION                          01860000
018700             MOVE PC-REPORT-PRINT-PGM   TO  PV-TRANSFER-PROGRAM   01870000
018800             PERFORM 2100-XCTL-TO-SELECTED-PROGRAM                01880000
018900                                                                  01890000
019000         WHEN OTHER                                               01900000
019100             MOVE PM-UNRECOGNIZED-PF-KEY-MSG  TO  AMSGLNO         01910000
019200             PERFORM 8100-SEND-DATA-ONLY                          01920000
019300             PERFORM 8200-RETURN-TRANID                           01930000
019400                                                                  01940000
019500     END-EVALUATE.                                                01950000
019600                                                                  01960000
019700     GOBACK.                                                      01970000
019800*                                                                 01980000
019900 1000-FIND-SYSTEM-ID.                                             01990000
020000     EXEC CICS                                                    02000000
020100         INQUIRE                                                  02010000
020200             TRANSACTION   (PC-LOGON-TRAN-ID)                     02020000
020300             REMOTESYSTEM  (PV-SYSID)                             02030000
020400             RESP          (PV-CICS-RESPONSE)                     02040000
020500     END-EXEC.                                                    02050000
020600                                                                  02060000
020700     EVALUATE TRUE                                                02070000
020800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 02080000
020900             CONTINUE                                             02090000
021000         WHEN OTHER                                               02100000
021100             MOVE '1000-FIND-SYSTEM-ID'                           02110000
021200                 TO DP013-PARAGRAPH                               02120000
021300             MOVE 'UNABLE TO DETERMINE SYSTEM ID'                 02130000
021400                 TO DP013-MESSAGE-TEXT (1)                        02140000
021500             SET DP013-CICS-ABEND      TO  TRUE                   02150000
021600             SET DP013-NO-ROLLBACK     TO  TRUE                   02160000
021700             PERFORM 9999-WRITE-CICS-LOG-MSG                      02170000
021800             MOVE PM-CICS-FATAL-ERROR-MSG                         02180000
021900                                       TO  AMSGLNO                02190000
022000             SET SU006-PROCESS-SCREEN  TO  TRUE                   02200000
022100             PERFORM 8100-SEND-DATA-ONLY                          02210000
022200             PERFORM 8200-RETURN-TRANID                           02220000
022300     END-EVALUATE.                                                02230000
022400*                                                                 02240000
022500 1100-FIND-LOGON-INFO.                                            02250000
022600     MOVE LENGTH OF DP026-SIGN-ON-INFO                            02260000
022700                    TO  PV-SIGN-ON-INFO-LENGTH.                   02270000
022800     MOVE EIBTRMID  TO  TS-INFO-QUEUE-TERMINAL.                   02280000
022900     MOVE +1        TO  PV-TS-ITEM.                               02290000
023000                                                                  02300000
023100     IF PV-SYSID = SPACES                                         02310000
023200         EXEC CICS                                                02320000
023300             READQ TS                                             02330000
023400                 QUEUE  (TS-INFO-QUEUE-NAME)                      02340000
023500                 ITEM   (PV-TS-ITEM)                              02350000
023600                 INTO   (DP026-SIGN-ON-INFO)                      02360000
023700                 RESP   (PV-CICS-RESPONSE)                        02370000
023800         END-EXEC                                                 02380000
023900     ELSE                                                         02390000
024000         EXEC CICS                                                02400000
024100             READQ TS                                             02410000
024200                 QUEUE   (TS-INFO-QUEUE-NAME)                     02420000
024300                 SYSID   (PV-SYSID)                               02430000
024400                 ITEM    (PV-TS-ITEM)                             02440000
024500                 INTO    (DP026-SIGN-ON-INFO)                     02450000
024600                 LENGTH  (PV-SIGN-ON-INFO-LENGTH)                 02460000
024700                 RESP    (PV-CICS-RESPONSE)                       02470000
024800         END-EXEC                                                 02480000
024900     END-IF.                                                      02490000
025000                                                                  02500000
025100     EVALUATE TRUE                                                02510000
025200         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 02520000
025300             MOVE DP026-LOCATION-NBR                              02530004
025400                                  TO  SU006-OPER-UNT-ID           02540000
025500                                      SU006-DFLT-OPER-UNT-ID      02550000
025600             MOVE DP026-USERID    TO  SU006-USERID                02560000
025700         WHEN OTHER                                               02570000
025800             MOVE '1100-FIND-LOGON-INFO'                          02580000
025900                 TO DP013-PARAGRAPH                               02590000
026000             MOVE 'UNABLE TO READ LOGON TSQ'                      02600000
026100                 TO DP013-MESSAGE-TEXT (1)                        02610000
026200             SET DP013-CICS-ABEND     TO TRUE                     02620000
026300             SET DP013-NO-ROLLBACK    TO TRUE                     02630000
026400             PERFORM 9999-WRITE-CICS-LOG-MSG                      02640000
026500             MOVE PM-SYSTEM-ERROR-MSG TO AMSGLNO                  02650000
026600             SET SU006-PROCESS-SCREEN TO TRUE                     02660000
026700             PERFORM 8100-SEND-DATA-ONLY                          02670000
026800             PERFORM 8200-RETURN-TRANID                           02680000
026900     END-EVALUATE.                                                02690000
027000*                                                                 02700000
027100 1200-RECEIVE-MAP.                                                02710000
027200     EXEC CICS                                                    02720000
027300         RECEIVE                                                  02730000
027400             MAP     ('SU508A')                                   02740000
027500             MAPSET  ('SUKM508')                                  02750000
027600             RESP    (PV-CICS-RESPONSE)                           02760000
027700     END-EXEC.                                                    02770000
027800                                                                  02780000
027900     EVALUATE TRUE                                                02790000
028000         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 02800000
028100              PERFORM 1210-RECEIVE-SCREEN-FIELDS                  02810000
028200         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                02820000
028300              CONTINUE                                            02830000
028400         WHEN OTHER                                               02840000
028500              MOVE '1200-RECEIVE-MAP'                             02850000
028600                                     TO DP013-PARAGRAPH           02860000
028700              MOVE 'UNABLE TO RECEIVE MAP'                        02870000
028800                                     TO DP013-MESSAGE-TEXT (1)    02880000
028900              SET DP013-LOGIC-ABEND  TO TRUE                      02890000
029000              SET DP013-NO-ROLLBACK  TO TRUE                      02900000
029100              PERFORM 9999-WRITE-CICS-LOG-MSG                     02910000
029200     END-EVALUATE.                                                02920000
029300*                                                                 02930000
029400 1210-RECEIVE-SCREEN-FIELDS.                                      02940000
029500                                                                  02950000
029600     IF  ASELECTL > ZERO                                          02960000
029700         MOVE ASELECTI  TO  CA-SELECTION-X                        02970000
029800     END-IF.                                                      02980000
029900*                                                                 02990000
030000     IF  AOPRUNTL > ZERO                                          03000000
030100         MOVE AOPRUNTI  TO  SU006-OPER-UNT-ID-X                   03010000
030200     END-IF.                                                      03020000
030300**************************************************************    03030000
030400* EDIT ALL ENTERABLE FIELDS (OPERATING UNIT ID, AND SELECT)  *    03040000
030500**************************************************************    03050000
030600 1300-EDIT-SELECTION.                                             03060000
030700                                                                  03070000
030800*    CHECK TO MAKE SURE THE ENTERED OPERATING UNIT ID IS NUMERIC  03080000
030900*    AND THAT IT POINTS TO A DC                                   03090000
031000     MOVE SU006-OPER-UNT-ID-X        TO DP010I-UNEDITED-FIELD.    03100000
031100     MOVE 4                            TO DP010I-MAXIMUM-DIGITS.  03110000
031200     MOVE 0                            TO DP010I-MAXIMUM-DECIMALS.03120000
031300     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     03130000
031400                                                                  03140000
263968     CALL DP010I-NUMERIC-EDIT-ROUTINE                             03151005
263968          USING DP010I-NUMERIC-EDIT-AREA.                         03152005
031600                                                                  03160000
031700     IF  DP010I-ERROR-DETECTED                                    03170000
031800         MOVE PM-NUMERIC-VALUE-REQUIRED-MSG                       03180000
031900                                     TO AMSGLNO                   03190000
032000         PERFORM 8100-SEND-DATA-ONLY                              03200000
032100         PERFORM 8200-RETURN-TRANID                               03210000
032200     ELSE                                                         03220000
032300         MOVE DP010I-NUMERIC-FIELD   TO SU006-OPER-UNT-ID         03230000
032400         PERFORM 3000-CHECK-OPER-UNT-ID                           03240000
032500         IF PS-NOT-A-DC                                           03250000
032600             MOVE PM-NOT-A-DC-MSG    TO AMSGLNO                   03260000
032700             PERFORM 8100-SEND-DATA-ONLY                          03270000
032800             PERFORM 8200-RETURN-TRANID                           03280000
032900         END-IF                                                   03290000
033000     END-IF.                                                      03300000
033100                                                                  03310000
033200                                                                  03320000
033300*    CHECK TO MAKE SURE THE SELECTED OPTION IS NUMERIC, AND THAT  03330000
033400*    IT IS A VALID SELECTION FOR THIS SCREEN...HOWEVER...         03340000
033500     MOVE CA-SELECTION-X             TO DP010I-UNEDITED-FIELD.    03350000
033600     MOVE 1                          TO DP010I-MAXIMUM-DIGITS.    03360000
033700     MOVE 0                          TO DP010I-MAXIMUM-DECIMALS.  03370000
033800     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     03380000
033900                                                                  03390000
263968     CALL DP010I-NUMERIC-EDIT-ROUTINE                             03401005
263968          USING DP010I-NUMERIC-EDIT-AREA.                         03402005
034100                                                                  03410000
034200     IF  DP010I-ERROR-DETECTED                                    03420000
034300         MOVE PM-NUMERIC-VALUE-REQUIRED-MSG                       03430000
034400                                     TO AMSGLNO                   03440000
034500         PERFORM 8100-SEND-DATA-ONLY                              03450000
034600         PERFORM 8200-RETURN-TRANID                               03460000
034700     ELSE                                                         03470000
034800         MOVE DP010I-NUMERIC-FIELD   TO CA-SELECTION              03480000
034900     END-IF.                                                      03490000
035000                                                                  03500000
035100     EVALUATE TRUE                                                03510000
035200        WHEN  CA-RECV-SELECTION                                   03520000
035300            SET SU006-RECV-PRCS-AREA TO TRUE                      03530000
035400        WHEN  CA-FLAT-SELECTION                                   03540000
035500            SET SU006-FLAT-PRCS-AREA TO TRUE                      03550000
035600        WHEN  CA-SHIP-SELECTION                                   03560000
035700            SET SU006-SHIP-PRCS-AREA TO TRUE                      03570000
035800        WHEN OTHER                                                03580000
035900            MOVE DP015-UNP-NUM-BRT-MDT                            03590000
036000                                     TO  ASELECTA                 03600000
036100            MOVE PM-INVALID-SELECTION-MSG                         03610000
036200                                     TO  AMSGLNO                  03620000
036300            PERFORM 8100-SEND-DATA-ONLY                           03630000
036400            PERFORM 8200-RETURN-TRANID                            03640000
036500     END-EVALUATE.                                                03650000
036510                                                                  03651001
036520                                                                  03652001
036530 1400-HELP-SCREEN.                                                03653001
036540     MOVE 'DPKRF278'                  TO PV-TRANSFER-PROGRAM      03654001
036550     MOVE 'SUKRF508'                  TO PC192-PROGRAM-NAME       03655001
036560     COPY PCPD188.                                                03656001
036570     MOVE PC188-DISPLAY-DATE          TO PC192-DISPLAY-DATE.      03657001
036580     PERFORM 4200-XCTL-TO-HELP.                                   03658001
036590                                                                  03659001
036600*                                                                 03660000
036700**************************************************************    03670000
036800* ALL DATA HAS PASSED THE EDITS, CONTINUE ON WITH PROCESSING *    03680000
036900**************************************************************    03690000
037000 2000-PROCESS-SELECTION.                                          03700000
037100     MOVE PC-NEXT-PROGRAM            TO PV-TRANSFER-PROGRAM.      03710000
037200     PERFORM 2100-XCTL-TO-SELECTED-PROGRAM.                       03720000
037300*                                                                 03730000
037400*                                                                 03740000
037500*                                                                 03750000
037600 2100-XCTL-TO-SELECTED-PROGRAM.                                   03760000
037700     SET SU006-INITIALIZE-SCREEN   TO  TRUE.                      03770000
037800     MOVE LENGTH OF CA-COMMAREA    TO  PV-COMMAREA-LENGTH.        03780000
037900     MOVE PC-CURRENT-PROGRAM-NAME  TO  SU006-LAST-PROGRAM.        03790000
038000                                                                  03800000
038100     EXEC CICS                                                    03810000
038200         XCTL                                                     03820000
038300             PROGRAM   (PV-TRANSFER-PROGRAM)                      03830000
038400             COMMAREA  (CA-COMMAREA)                              03840000
038500             LENGTH    (PV-COMMAREA-LENGTH)                       03850000
038600             RESP      (PV-CICS-RESPONSE)                         03860000
038700     END-EXEC.                                                    03870000
038800                                                                  03880000
038900     EVALUATE TRUE                                                03890000
039000         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 03900000
039100              CONTINUE                                            03910000
039200         WHEN OTHER                                               03920000
039300              MOVE '2100-XCTL-TO-SELECTED-PROGRAM'                03930000
039400                                     TO DP013-PARAGRAPH           03940000
039500              MOVE 'UNABLE TO XCTL THE FOLLOWING PROGRAM: '       03950000
039600                                     TO DP013-MESSAGE-TEXT (1)    03960000
039700              MOVE PV-TRANSFER-PROGRAM                            03970000
039800                                     TO DP013-MESSAGE-TEXT (2)    03980000
039900              SET DP013-CICS-ABEND   TO TRUE                      03990000
040000              SET DP013-NO-ROLLBACK  TO TRUE                      04000000
040100              PERFORM 9999-WRITE-CICS-LOG-MSG                     04010000
040200              MOVE PM-TRANS-NOT-AVAILABLE-MSG                     04020000
040300                                     TO AMSGLNO                   04030000
040400              SET SU006-PROCESS-SCREEN TO TRUE                    04040000
040500              PERFORM 8100-SEND-DATA-ONLY                         04050000
040600              PERFORM 8200-RETURN-TRANID                          04060000
040700     END-EVALUATE.                                                04070000
040800****************************************************************  04080000
040900* 3000-CHECK-OPER-UNT-ID                                       *  04090000
041000*      CHECK THE USER ENTERED OPER UNIT ID TO MAKE SURE IT IS  *  04100000
041100*      A VALID OPER UNIT ID FOR A DC                           *  04110000
041200****************************************************************  04120000
041300 3000-CHECK-OPER-UNT-ID.                                          04130000
041400     INITIALIZE DCLXLT00010.                                      04140004
041500     MOVE SU006-OPER-UNT-ID   TO  DK-OPER-UNT-ID.                 04150000
041600                                                                  04160000
041700     EXEC SQL                                                     04170000
041800         SELECT  LOC_NBR                                          04180004
041900           INTO  :XLT00010-LOC-NBR                                04190004
042000           FROM  XLT_LOC                                          04200004
042100          WHERE  LOC_NBR           =  :DK-OPER-UNT-ID             04210004
042200            AND  LOC_TYP_CDE       =  'DC'                        04220004
042300     END-EXEC.                                                    04230000
042400                                                                  04240000
042500     EVALUATE TRUE                                                04250000
042600         WHEN SQLCODE = ZERO                                      04260000
042700             SET PS-A-DC          TO TRUE                         04270000
042800         WHEN SQLCODE = +100                                      04280000
042900             SET PS-NOT-A-DC      TO TRUE                         04290000
043000         WHEN SQLWARN0 NOT = SPACES                               04300000
043100         WHEN SQLCODE < ZERO                                      04310000
043200         WHEN SQLCODE > ZERO                                      04320000
043300             MOVE '3000-CHECK-OPER-UNT-ID'                        04330000
043400                 TO DP013-PARAGRAPH                               04340000
043500             MOVE 'SELECT OF XLT_LOC TABLE'                       04350004
043600                 TO DP013-MESSAGE-TEXT (1)                        04360000
043700             MOVE SU006-OPER-UNT-ID-X                             04370000
043800                 TO DP013-MESSAGE-TEXT (2)                        04380000
043900             MOVE SQLCA            TO DP013-SQLCA                 04390000
044000             MOVE 'XLT_LOC'        TO DP013-DB2-TABLE-NAME (1)    04400004
044100             SET DP013-DB2-ABEND   TO TRUE                        04410000
044200             SET DP013-NO-ROLLBACK TO TRUE                        04420000
044300             PERFORM 9999-WRITE-CICS-LOG-MSG                      04430000
044400             MOVE PM-DB2-FATAL-ERROR-MSG TO AMSGLNO               04440000
044500             MOVE -1                     TO  AOPRUNTL             04450000
044600             PERFORM 8100-SEND-DATA-ONLY                          04460000
044700             PERFORM 8200-RETURN-TRANID                           04470000
044800     END-EVALUATE.                                                04480000
044900*                                                                 04490000
044901 4200-XCTL-TO-HELP.                                               04490101
044902                                                                  04490201
044903     MOVE LENGTH OF PC192-COMMAREA    TO PV-COMMAREA-LENGTH.      04490301
044904     SET  SU006-INITIALIZE-SCREEN     TO TRUE.                    04490401
044905     MOVE CA-COMMAREA                 TO PC192-HOST-SAVE-AREA.    04490501
044906                                                                  04490601
044907     EXEC CICS                                                    04490701
044908         XCTL                                                     04490801
044909             PROGRAM   (PV-TRANSFER-PROGRAM)                      04490901
044910             COMMAREA  (PC192-COMMAREA)                           04491001
044911             LENGTH    (PV-COMMAREA-LENGTH)                       04491101
044912             RESP      (PV-CICS-RESPONSE)                         04491201
044913     END-EXEC.                                                    04491301
044914                                                                  04491401
044915     EVALUATE TRUE                                                04491501
044916         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 04491601
044917              CONTINUE                                            04491701
044918         WHEN OTHER                                               04491801
044919             MOVE '4200-XCTL-TO-HELP '                            04491901
044920                 TO DP013-PARAGRAPH                               04492001
044921             MOVE 'SUKRF508 - UNABLE TO XCTL TO PROGRAM: '        04492101
044922                 TO DP013-MESSAGE-TEXT (1)                        04492201
044923             MOVE PV-TRANSFER-PROGRAM                             04492301
044924                 TO DP013-MESSAGE-TEXT (2)                        04492401
044925             SET DP013-CICS-ABEND  TO TRUE                        04492501
044926             SET DP013-ROLLBACK TO TRUE                           04492601
044927             PERFORM 9999-WRITE-CICS-LOG-MSG                      04492701
044928             MOVE PC-TRANS-UNAVAILABLE-MSG TO AMSGLNO             04492801
044929             SET SU006-PROCESS-SCREEN TO TRUE                     04492901
044930             PERFORM 8000-SEND-MAP                                04493001
044931             PERFORM 8200-RETURN-TRANID                           04493101
044932     END-EVALUATE.                                                04493201
044940*                                                                 04494001
045000 8000-SEND-MAP.                                                   04500000
045100     EXEC CICS                                                    04510000
045200         SEND                                                     04520000
045300             MAP     ('SU508A')                                   04530000
045400             MAPSET  ('SUKM508')                                  04540000
045500             ERASE                                                04550000
045600             RESP    (PV-CICS-RESPONSE)                           04560000
045700     END-EXEC.                                                    04570000
045800                                                                  04580000
045900     EVALUATE TRUE                                                04590000
046000         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 04600000
046100             CONTINUE                                             04610000
046200         WHEN OTHER                                               04620000
046300             MOVE '8000-SEND-MAP'   TO DP013-PARAGRAPH            04630000
046400             MOVE 'UNABLE TO SEND MAP'                            04640000
046500                                    TO DP013-MESSAGE-TEXT (1)     04650000
046600             SET DP013-CICS-ABEND   TO TRUE                       04660000
046700             SET DP013-NO-ROLLBACK  TO TRUE                       04670000
046800             PERFORM 9999-WRITE-CICS-LOG-MSG                      04680000
046900     END-EVALUATE.                                                04690000
047000*                                                                 04700000
047100 8100-SEND-DATA-ONLY.                                             04710000
047200     MOVE -1 TO ASELECTL.                                         04720000
047300                                                                  04730000
047400     EXEC CICS                                                    04740000
047500         SEND                                                     04750000
047600             MAP       ('SU508A')                                 04760000
047700             MAPSET    ('SUKM508')                                04770000
047800             CURSOR                                               04780000
047900             DATAONLY                                             04790000
048000             RESP      (PV-CICS-RESPONSE)                         04800000
048100     END-EXEC.                                                    04810000
048200                                                                  04820000
048300     EVALUATE TRUE                                                04830000
048400         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 04840000
048500             CONTINUE                                             04850000
048600         WHEN OTHER                                               04860000
048700             MOVE '8100-SEND-DATA-ONLY'                           04870000
048800                                    TO DP013-PARAGRAPH            04880000
048900             MOVE 'UNABLE TO SEND DATA'                           04890000
049000                                    TO DP013-MESSAGE-TEXT (1)     04900000
049100             SET DP013-CICS-ABEND   TO TRUE                       04910000
049200             SET DP013-NO-ROLLBACK  TO TRUE                       04920000
049300             PERFORM 9999-WRITE-CICS-LOG-MSG                      04930000
049400     END-EVALUATE.                                                04940000
049500*                                                                 04950000
049600 8200-RETURN-TRANID.                                              04960000
049700     MOVE LENGTH OF CA-COMMAREA  TO  PV-COMMAREA-LENGTH.          04970000
049800                                                                  04980000
049900     EXEC CICS                                                    04990000
050000         RETURN                                                   05000000
050100             TRANSID   (PC-CURRENT-TRANID)                        05010000
050200             COMMAREA  (CA-COMMAREA)                              05020000
050300             LENGTH    (PV-COMMAREA-LENGTH)                       05030000
050400             RESP      (PV-CICS-RESPONSE)                         05040000
050500     END-EXEC.                                                    05050000
050600                                                                  05060000
050700     EVALUATE TRUE                                                05070000
050800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 05080000
050900             CONTINUE                                             05090000
051000         WHEN OTHER                                               05100000
051100             MOVE '8200-RETURN-TRANID'                            05110000
051200                                    TO DP013-PARAGRAPH            05120000
051300             MOVE 'UNABLE TO RETURN TO TRANID'                    05130000
051400                                    TO DP013-MESSAGE-TEXT (1)     05140000
051500             SET DP013-CICS-ABEND   TO TRUE                       05150000
051600             SET DP013-NO-ROLLBACK  TO TRUE                       05160000
051700             PERFORM 9999-WRITE-CICS-LOG-MSG                      05170000
051800     END-EVALUATE.                                                05180000
051900*                                                                 05190000
052000*                                                                 05200000
052100 9999-WRITE-CICS-LOG-MSG.                                         05210000
052200     MOVE PC-CURRENT-PROGRAM-NAME    TO DP013-PROGRAM.            05220000
052300     MOVE DFHEIBLK                   TO DP013-DFHEIBLK.           05230000
052400     INITIALIZE DP013-SRC-TASK-NUMBER                             05240000
052500                DP013-STACK.                                      05250000
052600     SET DP013-LINK-RETURN           TO TRUE.                     05260000
052700                                                                  05270000
052800     EXEC CICS                                                    05280000
052900         LINK                                                     05290000
053000             PROGRAM   (DP013-NAME)                               05300000
053100             COMMAREA  (DP013-PARAMETERS)                         05310000
053200             LENGTH    (DP013-LENGTH)                             05320000
053300     END-EXEC.                                                    05330000
