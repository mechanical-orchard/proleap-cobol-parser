000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400 PROGRAM-ID.             TMKRP024.                                00040000
000500 AUTHOR.                 THERESE RAMSEYER.                        00050000
000600 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00060000
000700 DATE-WRITTEN            DECEMBER, 2004.                          00070000
000800***************************************************************** 00080000
000900***************************************************************** 00090000
001000*  THIS PROGRAM WILL PRINT A REPORT OF FLOWBACK ORDERS          * 00100000
001100*  ALLOCATED DURING A SPECIFIC TIME FRAME.                      * 00110000
001200***************************************************************** 00120000
001300* CHANGE HISTORY:                                                *00121000
001300*    CHANGES                                                     *00122000
001300*     MADE BY: VENKATSUBBU (COGNIZANT)                           *00123000
001300*     DATE:    10/14/2014                                        *00124000
001300*                                                                *00125000
001300*      CHANGES THRU OUT THE PROGRAM TO INCREASE THE SIZE OF PO#  *00126000
001300*      FROM 7 DIGITS TO 8 DIGITS. TAGGED WITH *TV 10/14/2014     *00127000
001300*                                                                *00127199
001300*      INCREASED # OF DC"S TO 30 FROM 15  *CLP 12/15/14          *00127299
001100******************************************************************00128000
001300***************************************************************** 00130000
001400 ENVIRONMENT DIVISION.                                            00140000
001500 CONFIGURATION SECTION.                                           00150000
001600***************************************************************** 00160000
001700 SOURCE-COMPUTER.        IBM-3090.                                00170000
001800 OBJECT-COMPUTER.        IBM-3090.                                00180000
001900                                                                  00190000
002000 INPUT-OUTPUT SECTION.                                            00200000
002100 FILE-CONTROL.                                                    00210000
002200*                                                                 00220000
002300     SELECT EXTRACT-FILE                                          00230000
002400         ASSIGN TO INP01.                                         00240000
002410     SELECT TIMESTAMP-FILE                                        00241000
002420         ASSIGN TO INP02.                                         00242000
002500                                                                  00250000
002600     SELECT FLOWBACK-REPORT                                       00260000
002700         ASSIGN TO RPT01.                                         00270000
002710                                                                  00271000
002800*                                                                 00280000
002900***************************************************************** 00290000
003000 DATA DIVISION.                                                   00300000
003100 FILE SECTION.                                                    00310000
003200***************************************************************** 00320000
003300 FD  EXTRACT-FILE                                                 00330000
003400     LABEL RECORDS ARE STANDARD                                   00340000
003500     RECORDING MODE IS F                                          00350000
003600     BLOCK CONTAINS 0 RECORDS                                     00360000
003700     RECORD CONTAINS 200 CHARACTERS.                              00370000
003800 01  EXTRACT-RECORD                  PIC X(200).                  00380000
003801                                                                  00380100
003810 FD  TIMESTAMP-FILE                                               00381000
003820     LABEL RECORDS ARE STANDARD                                   00382000
003830     RECORDING MODE IS F                                          00383000
003840     BLOCK CONTAINS 0 RECORDS                                     00384000
003850     RECORD CONTAINS 26 CHARACTERS.                               00385000
003860 01  TIMESTAMP-RECORD                PIC X(26).                   00386000
003900                                                                  00390000
004000 FD  FLOWBACK-REPORT                                              00400000
004100     RECORDING MODE IS F                                          00410000
004200     BLOCK CONTAINS 0  RECORDS.                                   00420000
004300 01  FLOWBACK-RECORD                 PIC X(132).                  00430000
004400*                                                                 00440000
004500                                                                  00450000
004600 WORKING-STORAGE SECTION.                                         00460000
004700*                                                                 00470000
004800 01  PREVIOUS-RECORD.                                             00480000
004900     05  WS-HOLD-PREV-RECORD         PIC X(01)    VALUE SPACE.    00490000
005000         88  WS-TRAILR-TOTAL-NEEDED               VALUE 'Y'.      00500000
005100         88  WS-NO-TRAILR-TOTAL                   VALUE 'N'.      00510000
005200                                                                  00520000
005300 01  PROGRAM-SWITCHES.                                            00530000
005310     05  PS-END-OF-ACT-DC-CSR-IND    PIC X(01)     VALUE 'N'.     00531000
005320         88  PS-END-OF-ACT-DC-CSR                  VALUE 'Y'.     00532000
005330         88  PS-NOT-END-OF-ACT-DC-CSR              VALUE 'N'.     00533000
005400     05  PS-END-OF-EXTRACT-SW        PIC  X(01)    VALUE 'N'.     00540000
005500         88  PS-END-OF-EXTRACT                     VALUE 'Y'.     00550000
005600         88  PS-PROCESS-EXTRACT                    VALUE 'N'.     00560000
005610     05  PS-END-OF-DATA-SW           PIC  X(01)    VALUE 'N'.     00561000
005620         88  PS-NO-DATA                            VALUE 'Y'.     00562000
005700     05  PS-VALID-DC-SW              PIC  X(01)    VALUE 'N'.     00570000
005800         88  PS-VALID-DC                           VALUE 'Y'.     00580000
005900         88  PS-INVALID-DC                         VALUE 'N'.     00590000
006000     05  PS-FIRST-PASS-SW            PIC  X(01)    VALUE 'Y'.     00600000
006100         88  PS-NOT-FIRST-PASS                     VALUE 'N'.     00610000
006200     05  PS-FIRST-DETAIL-REC-SW      PIC  X(01)    VALUE 'N'.     00620000
006300         88  PS-FIRST-DETAIL-REC                   VALUE 'Y'.     00630000
006400         88  PS-NOT-FIRST-DETAIL-REC               VALUE 'N'.     00640000
006500     05  PS-HEADER-ONLY-REC-SW       PIC  X(01)    VALUE 'N'.     00650000
006600         88  PS-HEADER-ONLY-REC                    VALUE 'Y'.     00660000
006700         88  PS-NOT-HEADER-ONLY-REC                VALUE 'N'.     00670000
007100*                                                                 00710000
007200 01  PC-CONSTANTS.                                                00720000
007300     05  PC-LOCATION-MODULE          PIC X(08) VALUE 'XLKUT071'.  00730000
007301     05  PC-CURRENT-PROGRAM-NAME     PIC X(08) VALUE 'TMKRP024'.  00730100
007310     05  PC-M                        PIC X(01) VALUE 'M'.         00731000
007320     05  PC-I                        PIC X(01) VALUE 'I'.         00732000
007330     05  PC-FBP                      PIC X(03) VALUE 'FBP'.       00733000
007340     05  PC-STAR                     PIC X(01) VALUE '*'.         00734000
007400     05  PC-1                        PIC S9(03)    VALUE +1       00740000
007500                                                   COMP-3.        00750000
007600     05  PC-2                        PIC S9(03)    VALUE +2       00760000
007700                                                   COMP-3.        00770000
007800     05  PC-6                        PIC S9(03)    VALUE +6       00780000
007900                                                   COMP-3.        00790000
008000     05  PC-55                       PIC S9(03)    VALUE +55      00800000
008100                                                   COMP-3.        00810000
008200     05  PC-60                       PIC S9(03)    VALUE +60      00820000
008300                                                   COMP-3.        00830000
008400     05  PC-TMKRP024                 PIC  X(08)    VALUE          00840000
008500         'TMKRP024'.                                              00850000
008600     05  PC-REPORT-NBR               PIC  9(01)    VALUE 1.       00860000
008700     05  PC-ENROUTE                  PIC  X(10)   VALUE 'ENROUTE'.00870000
008800     05  PC-ENRT                     PIC  X(04)    VALUE 'ENRT'.  00880000
008900     05  PC-HERE                     PIC  X(04)    VALUE 'HERE'.  00890000
009000     05  PC-RECEIVE-TOTAL            PIC  X(07)    VALUE          00900000
009100         'ONHAND'.                                                00910000
009200     05  PC-ENROUTE-TOTAL            PIC  X(07)    VALUE          00920000
009300         'ENROUTE'.                                               00930000
009400     05  PC-PACK-BY-STORE            PIC  X(07)   VALUE 'PBS    '.00940000
009500     05  PC-FULLCASE                 PIC  X(07)   VALUE 'FCSE   '.00950000
009600     05  PC-PACK-TO-LIGHT            PIC  X(07)   VALUE 'P2L    '.00960000
009700     05  PC-FULLCASE-P2L             PIC  X(07)   VALUE 'FCS&P2L'.00970000
009800                                                                  00980000
009900 01 PC-PROGRAM-VARIABLES.                                         00990000
009910     05  SUB1                        PIC 9(3)      VALUE 0.       00991000
009920     05  PV-DC-CNT                   PIC 9(3)      VALUE 0.       00992000
010000     05  PV-LINE-SUB                 PIC S9(03)    VALUE ZERO     01000000
010100                                                   COMP-3.        01010000
010200     05  PV-LINE-CNT                 PIC S9(03)    VALUE ZERO     01020000
010300                                                   COMP-3.        01030000
010400     05  PV-PAGE-CNT                 PIC S9(04)    VALUE ZERO     01040000
010500                                                   COMP-3.        01050000
010600     05  PV-VENDOR-COUNT             PIC S9(04)    VALUE ZERO     01060000
010700                                                   COMP-3.        01070000
010800     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     01080000
010900                                                   COMP SYNC.     01090000
010910     05  PV-TROUBLE-REASON-S9        PIC  S9(4) COMP VALUE ZERO.  01091000
011000     05  PV-RECEIVER-STATUS          PIC  X(04)    VALUE SPACES.  01100000
011100     05  PV-CURRENT-OPER             PIC  9(04)    VALUE ZERO.    01110000
011500     05  PV-SAVE-DATE                PIC  X(10)    VALUE SPACES.  01150000
011600     05  PV-SAVE-PRE-RECEIVED-IND    PIC  X(01)    VALUE SPACES.  01160000
011700         88  PV-SAVE-PRE-RECEIVED                    VALUE 'Y'.   01170000
011800     05  PV-SAVE-PROCESS             PIC  X(06)    VALUE SPACES.  01180000
011900     05  PV-SAVE-CURR-OPER           PIC  9(04)    VALUE ZERO.    01190000
012000     05  PV-SAVE-CURR-FCLTY          PIC  9(04)    VALUE ZERO.    01200000
012100     05  PV-DATE-CARTON-QTY          PIC  9(09)    VALUE ZERO.    01210000
012200     05  PV-DATE-ITEM-QTY            PIC  9(09)    VALUE ZERO.    01220000
012300     05  PV-TRAILR-SCAC-ID           PIC  X(04)    VALUE SPACES.  01230000
012400     05  PV-TRAILR-VEH-NBR           PIC  X(10)    VALUE SPACES.  01240000
012500     05  PV-TRAILR-CARTON-QTY        PIC  9(09)    VALUE ZERO.    01250000
012600     05  PV-TRAILR-ITEM-QTY          PIC  9(09)    VALUE ZERO.    01260000
012700     05  PV-RECEIVED-CARTON-QTY      PIC  9(09)    VALUE ZERO.    01270000
012800     05  PV-RECEIVED-ITEM-QTY        PIC  9(09)    VALUE ZERO.    01280000
012900     05  PV-PROCESS-CARTON-QTY       PIC  9(09)    VALUE ZERO.    01290000
013000     05  PV-PROCESS-ITEM-QTY         PIC  9(09)    VALUE ZERO.    01300000
013100     05  PV-GRAND-CARTON-QTY         PIC  9(09)    VALUE ZERO.    01310000
013200     05  PV-GRAND-ITEM-QTY           PIC  9(09)    VALUE ZERO.    01320000
013400     05  PV-SAVE-PO                  PIC S9(09)    VALUE ZERO.    01340000
013500     05  PV-SAVE-RECEIVER            PIC  9(03)    VALUE ZERO.    01350000
013600     05  PV-DATE-DDMMYY.                                          01360000
013700         10  PV-DATE-DD              PIC  X(02).                  01370000
013800         10  PV-DATE-SLASH-1         PIC  X(01).                  01380000
013900         10  PV-DATE-MM              PIC  X(02).                  01390000
014000         10  PV-DATE-SLASH-2         PIC  X(01).                  01400000
014100         10  PV-DATE-YY              PIC  X(04).                  01410000
014200     05  PV-TODAYS-DATE.                                          01420000
014300         10  PV-TODAYS-DATE-YY       PIC  9(02)    VALUE ZERO.    01430000
014400         10  PV-TODAYS-DATE-MM       PIC  9(02)    VALUE ZERO.    01440000
014500         10  PV-TODAYS-DATE-DD       PIC  9(02)    VALUE ZERO.    01450000
014600     05  PV-TODAYS-TIME.                                          01460000
014700         10  PV-TODAYS-TIME-HH       PIC  9(02)    VALUE ZERO.    01470000
014800         10  PV-TODAYS-TIME-MM       PIC  9(02)    VALUE ZERO.    01480000
014900         10  PV-TODAYS-TIME-SS       PIC  9(02)    VALUE ZERO.    01490000
015000         10  FILLER                  PIC  9(02)    VALUE ZERO.    01500000
015100     05  PV-FORMAT-DATE.                                          01510000
015200         10  PV-FORMAT-DATE-MM       PIC  X(02)    VALUE SPACES.  01520000
015300         10  FILLER                  PIC  X(01)    VALUE '/'.     01530000
015400         10  PV-FORMAT-DATE-DD       PIC  X(02)    VALUE SPACES.  01540000
015500         10  FILLER                  PIC  X(01)    VALUE '/'.     01550000
015600         10  PV-FORMAT-DATE-YYYY     PIC  X(04)    VALUE SPACES.  01560000
015700     05  PV-SAVE-ASSIGN-TOT-QTY      PIC S9(07)    VALUE ZERO.    01570000
015710     05  PV-ABEND-PARAGRAPH              PIC  X(30)  VALUE SPACE. 01571000
015720     05  PV-DB2-OPERATION-ATTEMPTED      PIC  X(30)  VALUE SPACE. 01572000
015721     05  PV-START-TIMESTAMP          PIC X(26)     VALUE SPACES.  01572100
015722     05  PV-END-TIMESTAMP            PIC X(26)     VALUE SPACES.  01572200
015723     05  PV-FBP-IND                  PIC X(01)     VALUE SPACES.  01572300
015730******************************************************************01573000
015740* IF WE HAVE MORE THAN 10 DIST CENTERS, BUMP THE NUMBER OF OCCURS 01574000
015750* UP.                                                             01575000
015780******************************************************************01578000
015790                                                                  01579000
015791 01  PV-DC-TABLE.                                                 01579100
      *CLP 12/15/14                                                     01579299
015792     05  PV-DC-NBRS                  OCCURS 30 TIMES.             01579399
015793         10  PV-TBL-DC-NBR           PIC 9(4)   VALUE 0.          01579400
015794         10  PV-TBL-DC-NAME          PIC X(40)  VALUE SPACES.     01579500
015798         10  PV-TBL-TOT-RCVRS        PIC 9(07)  VALUE 0.          01579800
015799         10  PV-TBL-TOT-CARTONS      PIC 9(07)  VALUE 0.          01579900
015800         10  PV-TBL-TOT-UNITS        PIC 9(07)  VALUE 0.          01580000
015810                                                                  01581000
015811 01  WS-TOTAL-TOTALS.                                             01581100
015820     05  TOTAL-TOT-RCVRS             PIC 9(09) VALUE 0.           01582000
015830     05  TOTAL-TOT-CARTONS           PIC 9(09) VALUE 0.           01583000
015840     05  TOTAL-TOT-UNITS             PIC 9(09) VALUE 0.           01584000
015850                                                                  01585000
015900 01 WS-SORT-FIELDS.                                               01590000
016000     05  SORT-FIELD-FORMAT1.                                      01600000
016100         10  PO-NUMBER-1                 PIC  9(08) VALUE ZEROS.  01610000
016200         10  RECEIVER-SEQUENCE-NUMBER-1  PIC  9(03) VALUE ZEROS.  01620000
016300         10  FILLER-1                    PIC  X(14) VALUE SPACE.  01630000
016400                                                                  01640000
016500     05  SORT-FIELD-FORMAT2.                                      01650000
016600         10  SCAC-2                      PIC  X(04) VALUE SPACE.  01660000
016700         10  TRAILER-NUMBER-2            PIC  X(10) VALUE SPACE.  01670000
016800         10  PO-NUMBER-2                 PIC  9(08) VALUE ZERO.   01680000
016900         10  RECEIVER-SEQUENCE-NUMBER-2  PIC  9(03) VALUE ZERO.   01690000
017000                                                                  01700000
017010******************************************************************01701000
017020* EXTRACT LAYOUT                                                  01702000
017030******************************************************************01703000
017100     COPY TMRD008.                                                01710000
017200                                                                  01720000
017210******************************************************************01721000
017220*  COPY BOOK FOR DB2 FORMATTED MESSAGE AREA                       01722000
017230******************************************************************01723000
017240     COPY DPWS004.                                                01724000
017250                                                                  01725000
017300******************************************************************01730000
017400* COMMAREA FOR XLKUT071 - LOCATION MODULE                         01740000
017500******************************************************************01750000
017600     COPY XLWS071.                                                01760000
017700                                                                  01770000
017800******************************************************************01780000
017900*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               01790000
018000******************************************************************01800000
018100     COPY DPWS132O.                                               01810000
018200*                                                                 01820000
018300 01  HEADING-LINES.                                               01830000
018400     05  HEADING-LINE-1.                                          01840000
018500         10  FILLER                  PIC  X(09)    VALUE          01850000
018600             'LOCATION '.                                         01860000
018700         10  HL1-OPER-UNIT           PIC  X(05).                  01870000
018800         10  HL1-PROCESS             PIC  X(06).                  01880000
019000         10  FILLER                  PIC  X(11)    VALUE SPACES.  01900000
019200         10  FILLER                  PIC  X(29)    VALUE          01920000
019300                                  'FLOWBACK RECEIVERS ALLOCATED '.01930000
019400         10  HL1-ALLOC-BEG-DATE      PIC  X(10)    VALUE SPACES.  01940000
019500         10  FILLER                  PIC  X(01)    VALUE SPACES.  01950000
019600         10  HL1-ALLOC-BEG-TIME      PIC  X(08)    VALUE SPACES.  01960000
019700         10  FILLER                  PIC  X(01)    VALUE SPACES.  01970000
019710         10  FILLER                  PIC  X(02)    VALUE 'TO'.    01971000
019720         10  FILLER                  PIC  X(01)    VALUE SPACES.  01972000
019730         10  HL1-ALLOC-END-DATE      PIC  X(10)    VALUE SPACES.  01973000
019740         10  FILLER                  PIC  X(01)    VALUE SPACES.  01974000
019800         10  HL1-ALLOC-END-TIME      PIC  X(08)    VALUE SPACES.  01980000
019900*** FLOWBACK ORDERS ALLOCATED MM/DD/YYYY XX.XX.XX TO              01990000
019910***                     MM/DD/YYYY XX.XX.XX                       01991000
020000*                                                                 02000000
020100     05  HEADING-LINE-2.                                          02010000
020200         10  FILLER                  PIC  X(09)    VALUE          02020000
020300             'PROCESS  '.                                         02030000
020400         10  FILLER                  PIC  X(10)    VALUE          02040000
020500             'RECEIVED  '.                                        02050000
020600         10  FILLER                  PIC  X(06)    VALUE          02060000
020700             'CREATE'.                                            02070000
020800         10  FILLER                  PIC  X(04)    VALUE SPACES.  02080000
020900         10  FILLER                  PIC  X(02)    VALUE          02090000
021000             'PO'.                                                02100000
021000*TV 10/14/2014 CHANGE STARTS                                      02101000
021100         10  FILLER                  PIC  X(04)    VALUE SPACES.  02110000
 21000*TV 10/14/2014 CHANGE ENDS                                        02111000
021200         10  FILLER                  PIC  X(03)    VALUE          02120000
021300             'REC'.                                               02130000
021400         10  FILLER                  PIC  X(01)    VALUE SPACES.  02140000
021500         10  FILLER                  PIC  X(04)    VALUE          02150000
021600             'PACK'.                                              02160000
021700         10  FILLER                  PIC  X(02)    VALUE SPACES.  02170000
021800         10  FILLER                  PIC  X(04)    VALUE          02180000
021900             'LINE'.                                              02190000
022000         10  FILLER                  PIC  X(09)    VALUE SPACES.  02200000
022100         10  FILLER                  PIC  X(06)    VALUE          02210000
022200             'VENDOR'.                                            02220000
022300         10  FILLER                  PIC  X(10)    VALUE SPACES.  02230000
022400         10  FILLER                  PIC  X(04)    VALUE          02240000
022500             'DPT '.                                              02250000
022600         10  FILLER                  PIC  X(06)    VALUE          02260000
022700             'SEASN '.                                            02270000
022800         10  FILLER                  PIC  X(08)    VALUE          02280000
022900             'TROUBLE '.                                          02290000
023000         10  FILLER                  PIC  X(04)    VALUE          02300000
023100             'CODE'.                                              02310000
023200         10  FILLER                  PIC  X(03)    VALUE SPACES.  02320000
023300         10  FILLER                  PIC  X(07)    VALUE          02330000
023400             'CARTONS'.                                           02340000
021000*TV 10/14/2014 CHANGE STARTS                                      02341000
023500         10  FILLER                  PIC  X(01)    VALUE SPACES.  02350000
021000*TV 10/14/2014 CHANGE ENDS                                        02351000
023600         10  FILLER                  PIC  X(05)    VALUE          02360000
023700             'PKSL '.                                             02370000
023800         10  FILLER                  PIC  X(06)    VALUE          02380000
023900             'ITEM  '.                                            02390000
024000         10  FILLER                  PIC  X(04)    VALUE          02400000
024100             'PRCS'.                                              02410000
024200         10  FILLER                  PIC  X(04)    VALUE SPACES.  02420000
024300*                                                                 02430000
024400     05  HEADING-LINE-3.                                          02440000
024500         10  FILLER                  PIC  X(09)    VALUE          02450000
024600             ' AREA    '.                                         02460000
024700         10  FILLER                  PIC  X(10)    VALUE          02470000
024800             '  DATE    '.                                        02480000
024900         10  FILLER                  PIC  X(04)    VALUE          02490000
025000             ' FOR'.                                              02500000
021000*TV 10/14/2014 CHANGE STARTS                                      02501000
025100         10  FILLER                  PIC  X(16)    VALUE SPACES.  02510000
021000*TV 10/14/2014 CHANGE ENDS                                        02511000
025200         10  FILLER                  PIC  X(04)    VALUE          02520000
025300             'TYPE'.                                              02530000
025400         10  FILLER                  PIC  X(02)    VALUE SPACES.  02540000
025500         10  FILLER                  PIC  X(03)    VALUE          02550000
025600             'LOC'.                                               02560000
025700         10  FILLER                  PIC  X(11)    VALUE SPACES.  02570000
025800         10  FILLER                  PIC  X(04)    VALUE          02580000
025900             'NAME'.                                              02590000
026000         10  FILLER                  PIC  X(16)    VALUE SPACES.  02600000
026100         10  FILLER                  PIC  X(05)    VALUE          02610000
026200             'SET'.                                               02620000
026800*TV 10/14/2014 CHANGE STARTS                                      02621000
026300         10  FILLER                  PIC  X(26)    VALUE SPACES.  02630000
026800*TV 10/14/2014 CHANGE ENDS                                        02631000
026400         10  FILLER                  PIC  X(03)    VALUE          02640000
026500             'QTY'.                                               02650000
026600         10  FILLER                  PIC  X(06)    VALUE SPACES.  02660000
026700         10  FILLER                  PIC  X(02)    VALUE          02670000
026800             'CD'.                                                02680000
026900         10  FILLER                  PIC  X(09)    VALUE SPACES.  02690000
027000*                                                                 02700000
027100 01  MISCELLANEOUS-LINES.                                         02710000
027200     05  END-OF-REPORT-LINE.                                      02720000
027300         10  FILLER                  PIC  X(44)    VALUE SPACES.  02730000
027400         10  FILLER                  PIC  X(45)    VALUE          02740000
027500             '*******   E N D   O F   R E P O R T   *******'.     02750000
027600         10  FILLER                  PIC  X(43)    VALUE SPACES.  02760000
027700     05  NO-DATA-TO-REPORT-LINE.                                  02770000
027800         10  FILLER                  PIC  X(40)    VALUE SPACES.  02780000
027900         10  FILLER                  PIC  X(52)    VALUE          02790000
028000         '*******  N O   D A T A   T O   R E P O R T   *******'.  02800000
028100         10  FILLER                  PIC  X(40)    VALUE SPACES.  02810000
028200*                                                                 02820000
028300 01  DETAIL-LINES.                                                02830000
028400     05  DETAIL-LINE1.                                            02840000
028500         10  DL1-PROCESS-AREA        PIC  X(06)    VALUE SPACES.  02850000
028600         10  FILLER                  PIC  X(02)    VALUE SPACES.  02860000
028700         10  DL1-RECEIVED-DATE       PIC  X(10)    VALUE SPACES.  02870000
028800         10  FILLER                  PIC  X(02)    VALUE SPACES.  02880000
028900         10  DL1-OPER-UNIT           PIC  X(04)    VALUE SPACES.  02890000
029000         10  FILLER                  PIC  X(02)    VALUE SPACES.  02900000
029000*TV 10/14/2014 CHANGE STARTS                                      02901000
029100         10  DL1-PO                  PIC  ZZZZZZZ9  VALUE ZERO.   02910000
029000*TV 10/14/2014 CHANGE ENDS                                        02911000
029200         10  FILLER                  PIC  X(01)    VALUE SPACES.  02920000
029300         10  DL1-REC-SEQ             PIC  9(03)    VALUE ZERO.    02930000
029400         10  DL1-PKGNG-CDE-IND       PIC  X(01)    VALUE SPACES.  02940000
029500         10  DL1-PACK-TYPE           PIC  X(05)    VALUE SPACES.  02950000
029600         10  FILLER                  PIC  X(01)    VALUE SPACES.  02960000
029700         10  DL1-LINE                PIC  X(07)    VALUE SPACES.  02970000
029800         10  FILLER                  PIC  X(01)    VALUE SPACES.  02980000
029900         10  DL1-VENDOR              PIC  X(20)    VALUE SPACES.  02990000
030000         10  FILLER                  PIC  X(01)    VALUE SPACES.  03000000
030100         10  DL1-DEPT                PIC  X(03)    VALUE SPACES.  03010000
030200         10  FILLER                  PIC  X(01)    VALUE SPACES.  03020000
030300         10  DL1-SEASET              PIC  X(06)    VALUE SPACES.  03030000
030400         10  FILLER                  PIC  X(01)    VALUE SPACES.  03040000
030500         10  DL1-TROUBLE             PIC  X(13)    VALUE SPACES.  03050000
030600         10  FILLER                  PIC  X(01)    VALUE SPACES.  03060000
030700         10  DL1-CARTON-CNT          PIC  ZZZZZZ9  VALUE ZERO.    03070000
030700*TV 10/14/2014 CHANGE STARTS                                      03071000
030800         10  FILLER                  PIC  X(03)    VALUE SPACES.  03080000
030700*TV 10/14/2014 CHANGE ENDS                                        03081000
030900         10  DL1-PACKSLIP-QTY        PIC  ZZZZZZZ  VALUE ZERO.    03090000
031000         10  FILLER                  PIC  X(02)    VALUE SPACES.  03100000
031100         10  DL1-PROCESS-IND         PIC  X(07)    VALUE SPACES.  03110000
031200         10  FILLER                  PIC  X(06)    VALUE SPACES.  03120000
031300                                                                  03130000
031400 01  TOTAL-LINES.                                                 03140000
031500     05  TOTAL-LINE-1.                                            03150000
031600         10  FILLER                  PIC  X(81)    VALUE SPACES.  03160000
031700         10  TL1-TRAILR-SCAC-ID      PIC  X(04)    VALUE SPACES.  03170000
031800         10  FILLER                  PIC  X(01)    VALUE SPACES.  03180000
031900         10  TL1-TRAILR-VEH-NBR      PIC  X(10)    VALUE SPACES.  03190000
032000         10  FILLER                  PIC  X(02)    VALUE SPACES.  03200000
032100         10  TL1-TRAILR-CARTON-QTY   PIC  ZZZZZZ9.                03210000
032200         10  FILLER                  PIC  X(04)    VALUE SPACES.  03220000
032300         10  TL1-TRAILR-ITEM-QTY     PIC  ZZZZZZZ.                03230000
032400         10  FILLER                  PIC  X(09)    VALUE SPACES.  03240000
032500         10  FILLER                  PIC  X(07)    VALUE          03250000
032600              'TRAILR '.                                          03260000
032700                                                                  03270000
032800     05  TOTAL-LINE-2.                                            03280000
032800*TV 10/14/2014 CHANGE STARTS                                      03281000
032900         10  FILLER                  PIC  X(99)    VALUE SPACES.  03290000
032800*TV 10/14/2014 CHANGE ENDS                                        03291000
033000         10  TL2-DATE-CARTON-QTY     PIC  ZZZZZZ9.                03300000
033000*TV 10/14/2014 CHANGE STARTS                                      03301000
033100         10  FILLER                  PIC  X(03)    VALUE SPACES.  03310000
033000*TV 10/14/2014 CHANGE ENDS                                        03311000
033200         10  TL2-DATE-ITEM-QTY       PIC  ZZZZZZZ.                03320000
033300         10  FILLER                  PIC  X(09)    VALUE SPACES.  03330000
033400         10  FILLER                  PIC  X(07)    VALUE          03340000
033500              'DATE   '.                                          03350000
033600                                                                  03360000
033700     05  TOTAL-LINE-3.                                            03370000
033700*TV 10/14/2014 CHANGE STARTS                                      03371000
033800         10  FILLER                  PIC  X(99)    VALUE SPACES.  03380000
033700*TV 10/14/2014 CHANGE ENDS                                        03381000
033900         10  TL3-RECEIVED-CARTON-QTY PIC  ZZZZZZ9.                03390000
033700*TV 10/14/2014 CHANGE STARTS                                      03391000
034000         10  FILLER                  PIC  X(03)    VALUE SPACES.  03400000
033700*TV 10/14/2014 CHANGE ENDS                                        03401000
034100         10  TL3-RECEIVED-ITEM-QTY   PIC  ZZZZZZZ.                03410000
034200         10  FILLER                  PIC  X(09)    VALUE SPACES.  03420000
034300         10  TL3-RECEIVED-TOTAL-DESC PIC  X(07)    VALUE SPACES.  03430000
034400                                                                  03440000
034500     05  TOTAL-LINE-4.                                            03450000
034500*TV 10/14/2014 CHANGE STARTS                                      03451000
034600         10  FILLER                  PIC  X(99)    VALUE SPACES.  03460000
034500*TV 10/14/2014 CHANGE ENDS                                        03461000
034700         10  TL4-PROCESS-CARTON-QTY  PIC  ZZZZZZ9.                03470000
034500*TV 10/14/2014 CHANGE STARTS                                      03471000
034800         10  FILLER                  PIC  X(03)    VALUE SPACES.  03480000
034500*TV 10/14/2014 CHANGE ENDS                                        03481000
034900         10  TL4-PROCESS-ITEM-QTY    PIC  ZZZZZZZ.                03490000
035000         10  FILLER                  PIC  X(09)    VALUE SPACES.  03500000
035100         10  FILLER                  PIC  X(07)    VALUE          03510000
035200              'AREA   '.                                          03520000
035300                                                                  03530000
035400     05  TOTAL-LINE-5.                                            03540000
035400*TV 10/14/2014 CHANGE STARTS                                      03541000
035500         10  FILLER                  PIC  X(99)    VALUE SPACES.  03550000
035400*TV 10/14/2014 CHANGE ENDS                                        03551000
035600         10  TL5-GRAND-CARTON-QTY    PIC  ZZZZZZ9.                03560000
035400*TV 10/14/2014 CHANGE STARTS                                      03561000
035700         10  FILLER                  PIC  X(03)    VALUE SPACES.  03570000
035400*TV 10/14/2014 CHANGE ENDS                                        03571000
035800         10  TL5-GRAND-ITEM-QTY      PIC  ZZZZZZZ.                03580000
035900         10  FILLER                  PIC  X(09)    VALUE SPACES.  03590000
036000         10  FILLER                  PIC  X(07)    VALUE          03600000
036100              'FINAL  '.                                          03610000
036101                                                                  03610200
036110     05  CS-HEADING1.                                             03611000
036120         10  FILLER                  PIC  X(01)    VALUE SPACES.  03612000
036140         10  FILLER                  PIC  X(19)    VALUE          03614000
036150             'CORPORATE SUMMARY'.                                 03615000
036160         10  FILLER                  PIC  X(112)   VALUE SPACES.  03616000
036224     05  CS-HEADING2.                                             03622400
036225         10  FILLER                  PIC  X(32)    VALUE SPACES.  03622500
036226         10  FILLER                  PIC  X(05)    VALUE          03622600
036227             'TOTAL'.                                             03622700
036228         10  FILLER                  PIC  X(09)    VALUE SPACES.  03622800
036229         10  FILLER                  PIC  X(05)    VALUE          03622900
036230             'TOTAL'.                                             03623000
036231         10  FILLER                  PIC  X(09)    VALUE SPACES.  03623100
036232         10  FILLER                  PIC  X(05)    VALUE          03623200
036233             'TOTAL'.                                             03623300
036234         10  FILLER                  PIC  X(15)    VALUE SPACES.  03623400
036235     05  CS-HEADING3.                                             03623500
036238         10  FILLER                  PIC  X(01)    VALUE SPACES.  03623800
036239         10  FILLER                  PIC  X(02)    VALUE          03623900
036240             'DC'.                                                03624000
036241         10  FILLER                  PIC  X(29)    VALUE SPACES.  03624100
036242         10  FILLER                  PIC  X(09)    VALUE          03624200
036250             'RECEIVERS'.                                         03625000
036260         10  FILLER                  PIC  X(05)    VALUE SPACES.  03626000
036270         10  FILLER                  PIC  X(07)    VALUE          03627000
036271             'CARTONS'.                                           03627100
036272         10  FILLER                  PIC  X(07)    VALUE SPACES.  03627200
036273         10  FILLER                  PIC  X(05)    VALUE          03627300
036274             'UNITS'.                                             03627400
036275         10  FILLER                  PIC  X(15)    VALUE SPACES.  03627500
036276     05  CS-DETAIL1.                                              03627600
036277         10  CS-DTL1-DC-NBR          PIC  ZZ99.                   03627700
036278         10  FILLER                  PIC  X(05)    VALUE SPACES.  03627800
036279         10  CS-DTL1-DC-NAME         PIC  X(20).                  03627900
036280         10  FILLER                  PIC  X(01)    VALUE SPACES.  03628000
036281         10  CS-DTL1-TOT-RCVRS       PIC  Z,ZZZ,ZZ9.              03628100
036282         10  FILLER                  PIC  X(03)    VALUE SPACES.  03628200
036283         10  CS-DTL1-TOT-CARTONS     PIC  Z,ZZZ,ZZ9.              03628300
036284         10  FILLER                  PIC  X(03)    VALUE SPACES.  03628400
036285         10  CS-DTL1-TOT-UNITS       PIC  Z,ZZZ,ZZ9.              03628500
036286         10  FILLER                  PIC  X(05)    VALUE SPACES.  03628600
036287     05  CS-TOTAL.                                                03628700
036289         10  FILLER                  PIC  X(08)    VALUE SPACES.  03628900
036290         10  FILLER                  PIC  X(06)    VALUE 'TOTALS'.03629000
036291         10  FILLER                  PIC  X(15)    VALUE SPACES.  03629100
036292         10  CS-TOT-RCVRS            PIC  ZZ,ZZZ,ZZ9.             03629200
036293         10  FILLER                  PIC  X(02)    VALUE SPACES.  03629300
036294         10  CS-TOT-CARTONS          PIC  ZZ,ZZZ,ZZ9.             03629400
036295         10  FILLER                  PIC  X(02)    VALUE SPACES.  03629500
036296         10  CS-TOT-UNITS            PIC  ZZ,ZZZ,ZZ9.             03629600
036297         10  FILLER                  PIC  X(05)    VALUE SPACES.  03629700
036300                                                                  03630000
036900                                                                  03690000
037000*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE LOGISTICS          03700000
037100*  LOCATION TABLE                                                 03710000
037200*  (XLT_LOC)                                                      03720000
037300*                                                                 03730000
037400     EXEC SQL                                                     03740000
037500          INCLUDE XLT00010                                        03750000
037600     END-EXEC.                                                    03760000
037700                                                                  03770000
037800*                                                                 03780000
037900*    DB2 AREA FOR COMMUNICATIONS                                  03790000
038000                                                                  03800000
038100     EXEC SQL                                                     03810000
038200          INCLUDE SQLCA                                           03820000
038300     END-EXEC.                                                    03830000
038400                                                                  03840000
038500*    DB2 AREA FOR COMMUNICATIONS AREA2                            03850000
038600                                                                  03860000
038700     COPY SQLCA2.                                                 03870000
038800*                                                                 03880000
038810******************************************************************03881000
038820*  CURSOR FOR LOADING THE ACTIVE DIST CENTERS IN AN INTERNAL TABLE03882000
038830******************************************************************03883000
038840     EXEC SQL                                                     03884000
038850         DECLARE ACTIVE_DC_CSR CURSOR FOR                         03885000
038860         SELECT LOC_NBR,                                          03886000
038870                LOC_NM                                            03887000
038880         FROM   XLT_LOC                                           03888000
038890         WHERE LOC_TYP_CDE = 'DC'                                 03889000
038891           AND CLO_DTE > CURRENT DATE                             03889100
038892        ORDER BY LOC_NBR                                          03889200
038893     END-EXEC.                                                    03889300
038894                                                                  03889400
038900 PROCEDURE DIVISION.                                              03890000
039000******************************************************************03900000
039100**  THIS IS THE MAIN DRIVER FOR THE PROGRAM.                      03910000
039200******************************************************************03920000
039300 0000-MAINLINE-PROCESSING.                                        03930000
039400     OPEN INPUT  EXTRACT-FILE.                                    03940000
039500     OPEN OUTPUT FLOWBACK-REPORT.                                 03950000
039510     OPEN I-O    TIMESTAMP-FILE.                                  03951000
039600                                                                  03960000
039700     SET PS-FIRST-DETAIL-REC TO TRUE.                             03970000
039800     PERFORM 2200-READ-EXTRACT.                                   03980000
039810     IF PS-END-OF-EXTRACT                                         03981000
039820        SET PS-NO-DATA TO TRUE                                    03982000
039830     END-IF.                                                      03983000
039900     MOVE TM008-SORT-FIELD     TO SORT-FIELD-FORMAT2.             03990000
040000     MOVE SCAC-2               TO PV-TRAILR-SCAC-ID.              04000000
040100     MOVE TRAILER-NUMBER-2     TO PV-TRAILR-VEH-NBR.              04010000
040200     IF TM008-HEADER-RECORD                                       04020000
040300         SET PS-HEADER-ONLY-REC TO TRUE                           04030000
040400     END-IF.                                                      04040000
040500     PERFORM 1000-INITIALIZATION.                                 04050000
040600                                                                  04060000
040700     PERFORM 2000-PROCESS-EXTRACT                                 04070000
040800         UNTIL PS-END-OF-EXTRACT                                  04080000
040900     IF PS-NO-DATA                                                04090000
040910        CONTINUE                                                  04091000
040920     ELSE                                                         04092000
041000        IF PS-NOT-HEADER-ONLY-REC                                 04100000
041100            PERFORM 8500-TRAILER-TOTAL                            04110000
041200            PERFORM 8600-DATE-TOTAL                               04120000
041300            PERFORM 8800-RECEIVING-TOTAL                          04130000
041400            PERFORM 9000-PROCESS-TOTAL                            04140000
041500            PERFORM 9200-PROCESS-GRAND-TOTAL                      04150000
041600        ELSE                                                      04160000
041700            WRITE FLOWBACK-RECORD                                 04170000
041800              FROM NO-DATA-TO-REPORT-LINE                         04180000
041900                AFTER ADVANCING 2 LINES                           04190000
042000        END-IF                                                    04200000
042010                                                                  04201000
042100        WRITE FLOWBACK-RECORD                                     04210000
042200          FROM END-OF-REPORT-LINE                                 04220000
042300            AFTER ADVANCING 2 LINES                               04230000
042310                                                                  04231000
042400        PERFORM 9700-CREATE-CORP-SUM                              04240000
042410     END-IF.                                                      04241000
042420     REWRITE TIMESTAMP-RECORD FROM PV-END-TIMESTAMP.              04242000
042430                                                                  04243000
042500     CLOSE EXTRACT-FILE.                                          04250000
042600     CLOSE FLOWBACK-REPORT.                                       04260000
042610     CLOSE TIMESTAMP-FILE.                                        04261000
042700                                                                  04270000
042800     GOBACK.                                                      04280000
042900                                                                  04290000
043100 1000-INITIALIZATION.                                             04310000
043200******************************************************************04320000
043300**  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               04330000
043400******************************************************************04340000
043500                                                                  04350000
043600     ACCEPT PV-TODAYS-DATE                                        04360000
043700       FROM DATE.                                                 04370000
043800*                                                                 04380000
043900     ACCEPT PV-TODAYS-TIME                                        04390000
044000       FROM TIME.                                                 04400000
044100*                                                                 04410000
044110     READ TIMESTAMP-FILE INTO PV-START-TIMESTAMP.                 04411000
044120                                                                  04412000
044200     MOVE PC-REPORT-NBR          TO DP132O-REPORT-NUMBER.         04420000
044300     MOVE PV-TODAYS-DATE-MM      TO DP132O-RUN-MONTH.             04430000
044400     MOVE PV-TODAYS-DATE-DD      TO DP132O-RUN-DAY.               04440000
044500     MOVE PV-TODAYS-DATE-YY      TO DP132O-RUN-YEAR.              04450000
044600*                                                                 04460000
044700     MOVE PV-TODAYS-TIME-HH      TO DP132O-RUN-HOUR.              04470000
044800     MOVE PV-TODAYS-TIME-MM      TO DP132O-RUN-MINUTE.            04480000
044900     MOVE PC-TMKRP024            TO DP132O-PROGRAM-NAME.          04490000
045000*                                                                 04500000
045010     EXEC SQL                                                     04501000
045020         SET :PV-END-TIMESTAMP = CURRENT TIMESTAMP                04502000
045030     END-EXEC.                                                    04503000
045050     MOVE PV-START-TIMESTAMP(1:4) TO PV-FORMAT-DATE-YYYY          04505000
045051     MOVE PV-START-TIMESTAMP(6:2) TO PV-FORMAT-DATE-MM            04505100
045052     MOVE PV-START-TIMESTAMP(9:2) TO PV-FORMAT-DATE-DD            04505200
045053     MOVE PV-FORMAT-DATE          TO HL1-ALLOC-BEG-DATE.          04505300
045055     MOVE PV-START-TIMESTAMP(12:8)                                04505500
045060                               TO HL1-ALLOC-BEG-TIME.             04506000
045061     MOVE PV-END-TIMESTAMP(1:4)   TO PV-FORMAT-DATE-YYYY          04506100
045063     MOVE PV-END-TIMESTAMP(6:2)   TO PV-FORMAT-DATE-MM            04506300
045064     MOVE PV-END-TIMESTAMP(9:2)   TO PV-FORMAT-DATE-DD            04506400
045065     MOVE PV-FORMAT-DATE          TO HL1-ALLOC-END-DATE.          04506500
045066     MOVE PV-END-TIMESTAMP(12:8)                                  04506600
045067                               TO HL1-ALLOC-END-TIME.             04506700
045090     IF PS-NO-DATA                                                04509000
045091        PERFORM 8200-WRITE-TOP-LINE                               04509100
045092                                                                  04509200
045093        MOVE '0000'   TO HL1-OPER-UNIT                            04509300
045094        MOVE 'NODATA' TO HL1-PROCESS                              04509400
045095                                                                  04509500
045096        WRITE FLOWBACK-RECORD                                     04509600
045097          FROM HEADING-LINE-1                                     04509700
045098            AFTER ADVANCING 3 LINES                               04509800
045099                                                                  04509900
045100         WRITE FLOWBACK-RECORD                                    04510000
045101           FROM NO-DATA-TO-REPORT-LINE                            04510100
045102             AFTER ADVANCING 2 LINES                              04510200
045103     ELSE                                                         04510300
045110        MOVE TM008-CURRENT-OPER   TO HL1-OPER-UNIT                04511000
045200                                     PV-SAVE-CURR-OPER            04520000
045300        MOVE TM008-PROCESS-AREA   TO HL1-PROCESS                  04530000
045400                                     PV-SAVE-PROCESS              04540000
045700        MOVE TM008-CURRENT-OPER TO PV-CURRENT-OPER                04570000
045900        PERFORM 2300-VALIDATE-OPER-UNIT                           04590000
046000        IF PS-VALID-DC                                            04600000
046100            PERFORM 8000-WRITE-REPORT-HEADERS                     04610000
046200        END-IF                                                    04620000
046201                                                                  04620100
046210        INITIALIZE PV-DC-TABLE                                    04621000
046220                   WS-TOTAL-TOTALS                                04622000
046230                                                                  04623000
046240        PERFORM 9300-OPEN-ACTIVE-DC-CSR                           04624000
046250        PERFORM 9400-PROCESS-ACTIVE-DC-CSR                        04625000
046252           UNTIL PS-END-OF-ACT-DC-CSR                             04625200
046260        PERFORM 9500-CLOSE-ACTIVE-DC-CSR                          04626000
046270     END-IF.                                                      04627000
046300                                                                  04630000
046400*                                                                 04640000
046500 2000-PROCESS-EXTRACT.                                            04650000
046600******************************************************************04660000
046700*  THIS IS THE MAIN CONTROLLING PARAGRAPH FOR PROCESSING THE     *04670000
046800*  PROCESS AREA CURRENT ON HAND REPORT                           *04680000
046900******************************************************************04690000
047000     IF (TM008-CURRENT-OPER NOT = PV-SAVE-CURR-OPER)              04700000
047300         MOVE TM008-CURRENT-OPER TO PV-CURRENT-OPER               04730000
047500         PERFORM 2300-VALIDATE-OPER-UNIT                          04750000
047600         IF PS-VALID-DC                                           04760000
047700             IF  PV-LINE-CNT > PC-55                              04770000
047800                 PERFORM 8000-WRITE-REPORT-HEADERS                04780000
047900             END-IF                                               04790000
048000             IF  PS-NOT-FIRST-DETAIL-REC                          04800000
048100                 IF PS-NOT-HEADER-ONLY-REC                        04810000
048200                     PERFORM 8500-TRAILER-TOTAL                   04820000
048300                     PERFORM 8600-DATE-TOTAL                      04830000
048400                     PERFORM 8800-RECEIVING-TOTAL                 04840000
048500                     PERFORM 9000-PROCESS-TOTAL                   04850000
048600                     PERFORM 9200-PROCESS-GRAND-TOTAL             04860000
048700                     WRITE FLOWBACK-RECORD                        04870000
048800                       FROM END-OF-REPORT-LINE                    04880000
048900                         AFTER ADVANCING 2 LINES                  04890000
049000                     MOVE TM008-SORT-FIELD TO                     04900000
049100                          SORT-FIELD-FORMAT2                      04910000
049200                     MOVE SCAC-2           TO                     04920000
049300                          PV-TRAILR-SCAC-ID                       04930000
049400                     MOVE TRAILER-NUMBER-2 TO                     04940000
049500                          PV-TRAILR-VEH-NBR                       04950000
049600                 ELSE                                             04960000
049700                     WRITE FLOWBACK-RECORD                        04970000
049800                       FROM NO-DATA-TO-REPORT-LINE                04980000
049900                         AFTER ADVANCING 2 LINES                  04990000
050000                     WRITE FLOWBACK-RECORD                        05000000
050100                       FROM END-OF-REPORT-LINE                    05010000
050200                         AFTER ADVANCING 2 LINES                  05020000
050300                 END-IF                                           05030000
050400             ELSE                                                 05040000
050500                 IF PS-HEADER-ONLY-REC                            05050000
050600                     WRITE FLOWBACK-RECORD                        05060000
050700                       FROM NO-DATA-TO-REPORT-LINE                05070000
050800                         AFTER ADVANCING 2 LINES                  05080000
050900                     WRITE FLOWBACK-RECORD                        05090000
051000                       FROM END-OF-REPORT-LINE                    05100000
051100                         AFTER ADVANCING 2 LINES                  05110000
051200                 END-IF                                           05120000
051300             END-IF                                               05130000
051400             MOVE TM008-PROCESS-AREA   TO PV-SAVE-PROCESS         05140000
051500             MOVE TM008-PRE-RECEIVED-IND                          05150000
051600                                    TO PV-SAVE-PRE-RECEIVED-IND   05160000
051700             IF TM008-PRE-RECEIVED                                05170000
051800                 MOVE PC-ENROUTE       TO DL1-RECEIVED-DATE       05180000
051900                 MOVE PC-ENRT          TO PV-RECEIVER-STATUS      05190000
052000                 MOVE TM008-REC-DATE   TO PV-SAVE-DATE            05200000
052100             ELSE                                                 05210000
052200                 MOVE TM008-REC-DATE   TO PV-DATE-DDMMYY          05220000
052300                                          PV-SAVE-DATE            05230000
052400                 MOVE '/'              TO PV-DATE-SLASH-1         05240000
052500                 MOVE '/'              TO PV-DATE-SLASH-2         05250000
052600                 MOVE PV-DATE-DDMMYY   TO DL1-RECEIVED-DATE       05260000
052700                 MOVE PC-HERE          TO PV-RECEIVER-STATUS      05270000
052800             END-IF                                               05280000
052900             MOVE TM008-CURRENT-OPER   TO HL1-OPER-UNIT           05290000
053000                                          PV-SAVE-CURR-OPER       05300000
053100             MOVE TM008-PROCESS-AREA   TO HL1-PROCESS             05310000
053200                                          PV-SAVE-PROCESS         05320000
053300*DMB         MOVE TM008-CURRENT-FCLTY  TO HL1-FACILITY            05330000
053400*DMB                                      PV-SAVE-CURR-FCLTY      05340000
053500             MOVE 0                    TO PV-PAGE-CNT             05350000
053600             PERFORM 8000-WRITE-REPORT-HEADERS                    05360000
053700             IF TM008-DETAIL-RECORD                               05370000
053800                 PERFORM 2100-WRITE-REPORT                        05380000
053900             END-IF                                               05390000
054000         END-IF                                                   05400000
054100         IF TM008-HEADER-RECORD                                   05410000
054200             SET PS-HEADER-ONLY-REC TO TRUE                       05420000
054300         ELSE                                                     05430000
054400             SET PS-NOT-HEADER-ONLY-REC TO TRUE                   05440000
054500         END-IF                                                   05450000
054600     END-IF.                                                      05460000
054700                                                                  05470000
054800     IF PS-END-OF-EXTRACT                                         05480000
054900         CONTINUE                                                 05490000
055000     ELSE                                                         05500000
055100     IF PS-VALID-DC AND                                           05510000
055200        PS-NOT-HEADER-ONLY-REC                                    05520000
055300         PERFORM 2100-WRITE-REPORT                                05530000
055400     ELSE                                                         05540000
055500         IF PS-PROCESS-EXTRACT                                    05550000
055600             MOVE TM008-TRAILER-TOTAL-CDE                         05560000
055700                        TO WS-HOLD-PREV-RECORD                    05570000
055800             PERFORM 2200-READ-EXTRACT                            05580000
055900         END-IF                                                   05590000
056000     END-IF                                                       05600000
056100     END-IF.                                                      05610000
056200                                                                  05620000
056300 2100-WRITE-REPORT.                                               05630000
056400                                                                  05640000
056500     MOVE TM008-SORT-FIELD TO SORT-FIELD-FORMAT2.                 05650000
056600                                                                  05660000
056700     IF PS-NOT-FIRST-PASS AND                                     05670000
056800        PS-NOT-FIRST-DETAIL-REC                                   05680000
056900         IF  PV-LINE-CNT > PC-55                                  05690000
057000             PERFORM 8000-WRITE-REPORT-HEADERS                    05700000
057100         END-IF                                                   05710000
057200                                                                  05720000
057300         IF TM008-CURRENT-OPER NOT = PV-SAVE-CURR-OPER            05730000
057400             PERFORM 8500-TRAILER-TOTAL                           05740000
057500             PERFORM 8600-DATE-TOTAL                              05750000
057600             PERFORM 8800-RECEIVING-TOTAL                         05760000
057700             PERFORM 9000-PROCESS-TOTAL                           05770000
057800             PERFORM 9200-PROCESS-GRAND-TOTAL                     05780000
057900             WRITE FLOWBACK-RECORD                                05790000
058000                 FROM END-OF-REPORT-LINE                          05800000
058100                     AFTER ADVANCING 2 LINES                      05810000
058101*MJMCHG*                                                          05810100
058110             MOVE TM008-CURRENT-OPER   TO HL1-OPER-UNIT           05811000
058120                                          PV-SAVE-CURR-OPER       05812000
058200             PERFORM 8000-WRITE-REPORT-HEADERS                    05820000
058300         ELSE                                                     05830000
058400         IF TM008-PROCESS-AREA NOT = PV-SAVE-PROCESS              05840000
058500             PERFORM 8500-TRAILER-TOTAL                           05850000
058600             PERFORM 8600-DATE-TOTAL                              05860000
058700             PERFORM 8800-RECEIVING-TOTAL                         05870000
058800             PERFORM 9000-PROCESS-TOTAL                           05880000
058900*DMB 04/01                                                        05890000
059000             MOVE TM008-PROCESS-AREA   TO HL1-PROCESS             05900000
059100                                          PV-SAVE-PROCESS         05910000
059200*DMB 04/01                                                        05920000
059300             PERFORM 8000-WRITE-REPORT-HEADERS                    05930000
059400         ELSE                                                     05940000
059500             IF TM008-PRE-RECEIVED-IND NOT =                      05950000
059600                                         PV-SAVE-PRE-RECEIVED-IND 05960000
059700                 PERFORM 8500-TRAILER-TOTAL                       05970000
059800                 PERFORM 8600-DATE-TOTAL                          05980000
059900                 PERFORM 8800-RECEIVING-TOTAL                     05990000
060000             ELSE                                                 06000000
060100                 IF TM008-REC-DATE NOT = PV-SAVE-DATE             06010000
060200                     PERFORM 8500-TRAILER-TOTAL                   06020000
060300                     PERFORM 8600-DATE-TOTAL                      06030000
060400                 ELSE                                             06040000
060500                     IF SCAC-2 NOT = PV-TRAILR-SCAC-ID            06050000
060600                     OR  TRAILER-NUMBER-2 NOT = PV-TRAILR-VEH-NBR 06060000
060700                         PERFORM 8500-TRAILER-TOTAL               06070000
060800                     END-IF                                       06080000
060900                 END-IF                                           06090000
061000             END-IF                                               06100000
061100         END-IF                                                   06110000
061200     ELSE                                                         06120000
061300         SET PS-NOT-FIRST-PASS                                    06130000
061400             PS-NOT-FIRST-DETAIL-REC TO TRUE                      06140000
061500     END-IF.                                                      06150000
061600     MOVE TM008-PROCESS-AREA   TO DL1-PROCESS-AREA                06160000
061700                                  PV-SAVE-PROCESS.                06170000
061800     MOVE TM008-PRE-RECEIVED-IND                                  06180000
061900                               TO PV-SAVE-PRE-RECEIVED-IND.       06190000
062000     IF TM008-PRE-RECEIVED                                        06200000
062100         MOVE PC-ENROUTE       TO DL1-RECEIVED-DATE               06210000
062200         MOVE PC-ENRT          TO PV-RECEIVER-STATUS              06220000
062300         MOVE TM008-REC-DATE   TO PV-SAVE-DATE                    06230000
062400     ELSE                                                         06240000
062500         MOVE TM008-REC-DATE   TO PV-DATE-DDMMYY                  06250000
062600                                  PV-SAVE-DATE                    06260000
062700         MOVE '/'              TO PV-DATE-SLASH-1                 06270000
062800         MOVE '/'              TO PV-DATE-SLASH-2                 06280000
062900         MOVE PV-DATE-DDMMYY   TO DL1-RECEIVED-DATE               06290000
063000         MOVE PC-HERE          TO PV-RECEIVER-STATUS              06300000
063100     END-IF.                                                      06310000
063200     MOVE TM008-LOGICAL-OPER   TO DL1-OPER-UNIT.                  06320000
063300     MOVE TM008-PO-NBR         TO DL1-PO.                         06330000
063400     MOVE TM008-REC-SEQ-NBR    TO DL1-REC-SEQ.                    06340000
063410     MOVE TM008-PACK-TYPE      TO DL1-PACK-TYPE.                  06341000
063500     MOVE TM008-LNE-LOC-CDE    TO DL1-LINE.                       06350000
063600     MOVE TM008-VNDR-NME       TO DL1-VENDOR.                     06360000
063700     MOVE TM008-DEPT-NBR       TO DL1-DEPT.                       06370000
063810*     CHECK TRECEIV.PKGNG_CDE (M OR I) AND SEASET 1:3 (FBP)      *06381000
063820*     WHICH WILL INDICATE AN ASTERISK IN FRONT OF PACK_TYPE      *06382000
063830     IF TM008-PKGNG-CDE = (PC-M OR PC-I)                          06383000
063840     AND TM008-SEASET-NM (1:3) = PC-FBP                           06384000
063850       MOVE '*' TO PV-FBP-IND                                     06385000
063860     ELSE                                                         06386000
063870       MOVE ' ' TO PV-FBP-IND                                     06387000
063880     END-IF                                                       06388000
064000     STRING PV-FBP-IND DELIMITED BY SIZE                          06400000
064100            TM008-SEASET-NM DELIMITED BY SIZE                     06410000
064300            INTO DL1-SEASET.                                      06430000
064301                                                                  06430100
064310     STRING TM008-UNRESOLVED-TROUBLE DELIMITED BY SIZE            06431000
064320            TM008-MULTI-TROUBLE DELIMITED BY SIZE                 06432000
064330            ' ' DELIMITED BY SIZE                                 06433000
064340            TM008-LATEST-TROUBLE DELIMITED BY SIZE                06434000
064350            INTO DL1-TROUBLE.                                     06435000
064400     MOVE TM008-CART-CNT       TO DL1-CARTON-CNT.                 06440000
064500                                                                  06450000
064600     MOVE SCAC-2               TO PV-TRAILR-SCAC-ID.              06460000
064700     MOVE TRAILER-NUMBER-2     TO PV-TRAILR-VEH-NBR.              06470000
064800                                                                  06480000
064900     IF TM008-TRAILER-TOTAL-CDE = 'Y'                             06490000
065000        ADD TM008-CART-CNT     TO PV-TRAILR-CARTON-QTY            06500000
065100        ADD TM008-PKSL-ITM-QTY TO PV-TRAILR-ITEM-QTY              06510000
065200     END-IF                                                       06520000
065201                                                                  06520100
065202*     CHECK TRECEIV.PKGNG_CDE (M OR I) AND SEASET 1:3 (FBP)      *06520200
065203*     WHICH WILL INDICATE AN ASTERISK IN FRONT OF PACK_TYPE      *06520300
065204     IF TM008-PKGNG-CDE = 'B'                                     06520400
065210     AND TM008-SEASET-NM (1:3) = PC-FBP                           06521000
065211     AND TM008-STORE-COUNT-NOT-ONE                                06521100
065212        MOVE PC-STAR TO DL1-PKGNG-CDE-IND                         06521200
065220     END-IF.                                                      06522000
065300                                                                  06530000
065400     ADD TM008-CART-CNT        TO PV-DATE-CARTON-QTY              06540000
065500                                  PV-RECEIVED-CARTON-QTY          06550000
065600                                  PV-PROCESS-CARTON-QTY           06560000
065700                                  PV-GRAND-CARTON-QTY.            06570000
065800     MOVE TM008-PKSL-ITM-QTY   TO DL1-PACKSLIP-QTY.               06580000
065900     ADD TM008-PKSL-ITM-QTY    TO PV-DATE-ITEM-QTY                06590000
066000                                  PV-RECEIVED-ITEM-QTY            06600000
066100                                  PV-PROCESS-ITEM-QTY             06610000
066200                                  PV-GRAND-ITEM-QTY.              06620000
066201                                                                  06620100
066210     PERFORM 9600-SEARCH-DC-TOTALS                                06621000
066220                                                                  06622000
066300     EVALUATE TRUE                                                06630000
066400     WHEN TM008-PACK-BY-STORE                                     06640000
066500         MOVE PC-PACK-BY-STORE TO DL1-PROCESS-IND                 06650000
066600     WHEN TM008-FULLCASE                                          06660000
066700         MOVE PC-FULLCASE      TO DL1-PROCESS-IND                 06670000
066800     WHEN TM008-PACK-TO-LIGHT                                     06680000
066900         MOVE PC-PACK-TO-LIGHT TO DL1-PROCESS-IND                 06690000
067000     WHEN TM008-FULLCASE-P2L                                      06700000
067100         MOVE PC-FULLCASE-P2L  TO DL1-PROCESS-IND                 06710000
067200     WHEN OTHER                                                   06720000
067300         MOVE SPACES           TO DL1-PROCESS-IND                 06730000
067400     END-EVALUATE.                                                06740000
067500     IF  PV-LINE-CNT > PC-60                                      06750000
067600         PERFORM 8000-WRITE-REPORT-HEADERS                        06760000
067700     END-IF                                                       06770000
067800     PERFORM 8400-WRITE-DETAIL-LINES                              06780000
067900     MOVE TM008-TRAILER-TOTAL-CDE                                 06790000
068000                     TO WS-HOLD-PREV-RECORD                       06800000
068100     IF PS-END-OF-EXTRACT                                         06810000
068200        CONTINUE                                                  06820000
068300     ELSE                                                         06830000
068400         PERFORM 2200-READ-EXTRACT                                06840000
068500     END-IF.                                                      06850000
068600                                                                  06860000
068730 2200-READ-EXTRACT.                                               06873000
068800     READ EXTRACT-FILE INTO TM008-RECEIVER-EXT-RECORD             06880000
068900        AT END                                                    06890000
069000           SET PS-END-OF-EXTRACT TO TRUE.                         06900000
069010                                                                  06901000
069100                                                                  06910000
069200 2300-VALIDATE-OPER-UNIT.                                         06920000
069300******************************************************************06930000
069400* XLT_LOC (XLT00010) REPLACES TSTR000 TABLE                       06940000
069500* CALL LOCATION MODULE XLKUT071                                   06950000
069600******************************************************************06960000
069700                                                                  06970000
069800     INITIALIZE XL071-COMMAREA-REC.                               06980000
069900     MOVE PV-CURRENT-OPER            TO XL071-LOCATION-NUMBER.    06990000
070000                                                                  07000000
070100     CALL PC-LOCATION-MODULE  USING XL071-COMMAREA-REC.           07010000
070200                                                                  07020000
070300        IF XL071-LOC-TYP-CDE = 'DC'                               07030000
070400           SET PS-VALID-DC             TO TRUE                    07040000
070500        ELSE                                                      07050000
070600           SET PS-INVALID-DC           TO TRUE                    07060000
070700        END-IF.                                                   07070000
070800                                                                  07080000
070900*                                                                 07090000
071000 8000-WRITE-REPORT-HEADERS.                                       07100000
071100******************************************************************07110000
071200*  PRINT THE HEADING FOR THE FIRST PAGE OF AN ASN.  SEBSEQUENT   *07120000
071300*  PAGES FOR THE SAME ASN DO NOT REPEAT ALL OF THE HEADING INFO. *07130000
071400******************************************************************07140000
071500     PERFORM 8200-WRITE-TOP-LINE.                                 07150000
071600*                                                                 07160000
071700     WRITE FLOWBACK-RECORD                                        07170000
071800       FROM HEADING-LINE-1                                        07180000
071900         AFTER ADVANCING 3 LINES.                                 07190000
072000*                                                                 07200000
072100     WRITE FLOWBACK-RECORD                                        07210000
072200       FROM HEADING-LINE-2                                        07220000
072300         AFTER ADVANCING 2 LINES.                                 07230000
072400*                                                                 07240000
072500     WRITE FLOWBACK-RECORD                                        07250000
072600       FROM HEADING-LINE-3                                        07260000
072700         AFTER ADVANCING 1 LINES.                                 07270000
072800*                                                                 07280000
072900     MOVE 7               TO PV-LINE-CNT.                         07290000
073000     MOVE PC-2            TO PV-LINE-SUB.                         07300000
073100*                                                                 07310000
073200*                                                                 07320000
073300 8200-WRITE-TOP-LINE.                                             07330000
073400******************************************************************07340000
073500*     WRITES HEADER LINES 0 AND 1 WHEN MORE THAN ONE PAGE IS     *07350000
073600*     NEEDED FOR AN ASN NUMBER.                                  *07360000
073700******************************************************************07370000
073800     ADD 1                        TO PV-PAGE-CNT.                 07380000
073900*                                                                 07390000
074000     MOVE PV-PAGE-CNT             TO DP132O-PAGE-NUMBER.          07400000
074100*                                                                 07410000
074200     WRITE FLOWBACK-RECORD                                        07420000
074300       FROM DP132O-STANDRD-HEADER-132-COLS                        07430000
074400         AFTER ADVANCING PAGE.                                    07440000
074500*                                                                 07450000
074600*                                                                 07460000
074700 8400-WRITE-DETAIL-LINES.                                         07470000
074800******************************************************************07480000
074900*     WRITES THE DETAIL LINE INFORMATION.                        *07490000
075000******************************************************************07500000
075100     WRITE FLOWBACK-RECORD                                        07510000
075200       FROM DETAIL-LINE1                                          07520000
075300       AFTER ADVANCING PV-LINE-SUB LINES.                         07530000
075400                                                                  07540000
075900     ADD PV-LINE-SUB                 TO PV-LINE-CNT.              07590000
076000     MOVE PC-1                       TO PV-LINE-SUB.              07600000
076100                                                                  07610000
080200                                                                  08020000
081000 8500-TRAILER-TOTAL.                                              08100000
081100******************************************************************08110000
081200*     WRITES THE TRAILER TOTAL LINE                              *08120000
081300******************************************************************08130000
081400     IF WS-HOLD-PREV-RECORD = 'Y'                                 08140000
081500        MOVE PV-TRAILR-SCAC-ID      TO TL1-TRAILR-SCAC-ID         08150000
081600        MOVE PV-TRAILR-VEH-NBR      TO TL1-TRAILR-VEH-NBR         08160000
081700        MOVE PV-TRAILR-CARTON-QTY   TO TL1-TRAILR-CARTON-QTY      08170000
081800        MOVE PV-TRAILR-ITEM-QTY     TO TL1-TRAILR-ITEM-QTY        08180000
081900                                                                  08190000
082000        WRITE FLOWBACK-RECORD                                     08200000
082100          FROM TOTAL-LINE-1                                       08210000
082200            AFTER ADVANCING 2 LINES                               08220000
082300                                                                  08230000
082400     ADD PC-2                        TO PV-LINE-CNT               08240000
082500     MOVE PC-2                       TO PV-LINE-SUB               08250000
082600     MOVE ZERO                       TO PV-TRAILR-CARTON-QTY      08260000
082700                                        PV-TRAILR-ITEM-QTY        08270000
082800     ELSE                                                         08280000
082900       NEXT SENTENCE                                              08290000
083000     END-IF.                                                      08300000
083100 8600-DATE-TOTAL.                                                 08310000
083200******************************************************************08320000
083300*     WRITES THE DATE TOTAL LINE                                 *08330000
083400******************************************************************08340000
083500     MOVE PV-DATE-CARTON-QTY     TO TL2-DATE-CARTON-QTY.          08350000
083600     MOVE PV-DATE-ITEM-QTY       TO TL2-DATE-ITEM-QTY.            08360000
083700     WRITE FLOWBACK-RECORD                                        08370000
083800       FROM TOTAL-LINE-2                                          08380000
083900         AFTER ADVANCING 2 LINES.                                 08390000
084000                                                                  08400000
084100     ADD PC-2                        TO PV-LINE-CNT.              08410000
084200     MOVE PC-2                       TO PV-LINE-SUB.              08420000
084300     MOVE ZERO                       TO PV-DATE-CARTON-QTY        08430000
084400                                        PV-DATE-ITEM-QTY.         08440000
084500*                                                                 08450000
084600 8800-RECEIVING-TOTAL.                                            08460000
084700******************************************************************08470000
084800*     WRITES THE RECEIVED TOTAL LINE                             *08480000
084900******************************************************************08490000
085000     IF  PV-SAVE-PRE-RECEIVED                                     08500000
085100         MOVE PC-ENROUTE-TOTAL   TO TL3-RECEIVED-TOTAL-DESC       08510000
085200     ELSE                                                         08520000
085300         MOVE PC-RECEIVE-TOTAL   TO TL3-RECEIVED-TOTAL-DESC       08530000
085400     END-IF.                                                      08540000
085500     MOVE PV-RECEIVED-CARTON-QTY TO TL3-RECEIVED-CARTON-QTY.      08550000
085600     MOVE PV-RECEIVED-ITEM-QTY   TO TL3-RECEIVED-ITEM-QTY.        08560000
085700     WRITE FLOWBACK-RECORD                                        08570000
085800       FROM TOTAL-LINE-3                                          08580000
085900         AFTER ADVANCING 2 LINES.                                 08590000
086000                                                                  08600000
086100     ADD PC-2                        TO PV-LINE-CNT.              08610000
086200     MOVE PC-2                       TO PV-LINE-SUB.              08620000
086300     MOVE ZERO                       TO PV-RECEIVED-CARTON-QTY    08630000
086400                                        PV-RECEIVED-ITEM-QTY.     08640000
086500                                                                  08650000
086600 9000-PROCESS-TOTAL.                                              08660000
086700******************************************************************08670000
086800*     WRITES THE PROCESS TOTAL LINE                              *08680000
086900******************************************************************08690000
087000     MOVE PV-PROCESS-CARTON-QTY  TO TL4-PROCESS-CARTON-QTY.       08700000
087100     MOVE PV-PROCESS-ITEM-QTY    TO TL4-PROCESS-ITEM-QTY.         08710000
087200     WRITE FLOWBACK-RECORD                                        08720000
087300       FROM TOTAL-LINE-4                                          08730000
087400         AFTER ADVANCING 2 LINES.                                 08740000
087500                                                                  08750000
087600     ADD PC-2                        TO PV-LINE-CNT.              08760000
087700     MOVE PC-2                       TO PV-LINE-SUB.              08770000
087800     MOVE ZERO                       TO PV-PROCESS-CARTON-QTY     08780000
087900                                        PV-PROCESS-ITEM-QTY.      08790000
088000                                                                  08800000
088100 9200-PROCESS-GRAND-TOTAL.                                        08810000
088200******************************************************************08820000
088300*     WRITES THE GRAND TOTAL LINE                                *08830000
088400******************************************************************08840000
088500     MOVE PV-GRAND-CARTON-QTY    TO TL5-GRAND-CARTON-QTY.         08850000
088600     MOVE PV-GRAND-ITEM-QTY      TO TL5-GRAND-ITEM-QTY.           08860000
088700     WRITE FLOWBACK-RECORD                                        08870000
088800       FROM TOTAL-LINE-5                                          08880000
088900         AFTER ADVANCING 2 LINES.                                 08890000
089000                                                                  08900000
089100     ADD PC-2                        TO PV-LINE-CNT.              08910000
089200     MOVE PC-2                       TO PV-LINE-SUB.              08920000
089300     MOVE ZERO                       TO PV-GRAND-CARTON-QTY       08930000
089400                                        PV-GRAND-ITEM-QTY.        08940000
089500                                                                  08950000
089501******************************************************************08950100
089502*  OPEN ACTIVE DC CURSOR                                          08950200
089503******************************************************************08950300
089504 9300-OPEN-ACTIVE-DC-CSR.                                         08950400
089505                                                                  08950500
089510     EXEC SQL                                                     08951000
089511         OPEN ACTIVE_DC_CSR                                       08951100
089512     END-EXEC.                                                    08951200
089513                                                                  08951300
089514     EVALUATE TRUE                                                08951400
089515         WHEN SQLCODE = +0                                        08951500
089516             CONTINUE                                             08951600
089517         WHEN SQLWARN NOT = SPACE                                 08951700
089518         WHEN SQLCODE NOT = +0                                    08951800
089519             MOVE '9300-OPEN-ACTIVE-DC-CSR'                       08951900
089520                                   TO PV-ABEND-PARAGRAPH          08952000
089521            PERFORM 9100-SQL-ABEND                                08952100
089522     END-EVALUATE.                                                08952200
089523                                                                  08952300
089524******************************************************************08952400
089525*  FETCHS ACTIVE DC CSR                                           08952500
089526******************************************************************08952600
089527 9400-PROCESS-ACTIVE-DC-CSR.                                      08952700
089528                                                                  08952800
089533     EXEC SQL                                                     08953300
089534         FETCH ACTIVE_DC_CSR                                      08953400
089535         INTO  :XLT00010-LOC-NBR,                                 08953500
089536               :XLT00010-LOC-NM                                   08953600
089537     END-EXEC.                                                    08953700
089538                                                                  08953800
089539     EVALUATE TRUE                                                08953900
089540        WHEN SQLCODE = +0                                         08954000
089541           ADD 1 TO PV-DC-CNT                                     08954100
      *CLP 12/15/14                                                     08954299
089542           IF PV-DC-CNT = 30                                      08954399
089543              DISPLAY 'TABLE OVERFLOW ERROR FOR # OF DC"S'        08954499
089546           ELSE                                                   08954600
089547               MOVE XLT00010-LOC-NBR                              08954700
089548                 TO PV-TBL-DC-NBR (PV-DC-CNT)                     08954800
089549               MOVE XLT00010-LOC-NM                               08954900
089550                 TO PV-TBL-DC-NAME (PV-DC-CNT)                    08955000
089551           END-IF                                                 08955100
089552         WHEN SQLCODE = +100                                      08955200
089554            SET PS-END-OF-ACT-DC-CSR TO TRUE                      08955400
089555         WHEN SQLWARN NOT = SPACE                                 08955500
089556         WHEN SQLCODE NOT = +0                                    08955600
089557            MOVE '9400-PROCESS-ACTIVE-DC-CSR'                     08955700
089558                                   TO PV-ABEND-PARAGRAPH          08955800
089559            PERFORM 9100-SQL-ABEND                                08955900
089560     END-EVALUATE.                                                08956000
089561                                                                  08956100
089562******************************************************************08956200
089563*  CLOSES ACTIVE DC CSR                                           08956300
089564******************************************************************08956400
089565 9500-CLOSE-ACTIVE-DC-CSR.                                        08956500
089566                                                                  08956600
089570     EXEC SQL                                                     08957000
089571         CLOSE ACTIVE_DC_CSR                                      08957100
089572     END-EXEC.                                                    08957200
089573                                                                  08957300
089574     EVALUATE TRUE                                                08957400
089575         WHEN SQLCODE = +0                                        08957500
089576             CONTINUE                                             08957600
089577         WHEN SQLWARN NOT = SPACE                                 08957700
089578         WHEN SQLCODE NOT = +0                                    08957800
089579             MOVE '9500-CLOSE-ACTIVE-DC-CSR'                      08957900
089580                                   TO PV-ABEND-PARAGRAPH          08958000
089581             PERFORM 9100-SQL-ABEND                               08958100
089582     END-EVALUATE.                                                08958200
089583                                                                  08958300
089584******************************************************************08958400
089585* FOR EACH RECEIVER, ADD COUNTS TO TOTAL TABLE                    08958500
089586******************************************************************08958600
089587                                                                  08958700
089588 9600-SEARCH-DC-TOTALS.                                           08958800
089589                                                                  08958900
      *CLP 12/15/14                                                     08959099
089590     PERFORM                                                      08959100
089591        VARYING SUB1 FROM 1 BY 1                                  08959200
089592        UNTIL SUB1 > 30                                           08959399
089593        IF PV-TBL-DC-NBR(SUB1) = TM008-LOGICAL-OPER               08959400
089594           ADD 1 TO PV-TBL-TOT-RCVRS(SUB1)                        08959500
089595           ADD TM008-CART-CNT TO PV-TBL-TOT-CARTONS(SUB1)         08959600
089596           ADD TM008-PKSL-ITM-QTY TO PV-TBL-TOT-UNITS(SUB1)       08959700
089597        END-IF                                                    08959800
089598     END-PERFORM.                                                 08959900
089599                                                                  08960000
089601******************************************************************08960100
089602* CREATE CORPORATE SUMMARY                                        08960200
089603******************************************************************08960300
089604                                                                  08960400
089605 9700-CREATE-CORP-SUM.                                            08960500
089606                                                                  08960600
089607     MOVE 1 TO PV-PAGE-CNT.                                       08960700
089608                                                                  08960800
089609     MOVE PV-PAGE-CNT TO DP132O-PAGE-NUMBER.                      08960900
089610                                                                  08961000
089611     WRITE FLOWBACK-RECORD                                        08961100
089612       FROM DP132O-STANDRD-HEADER-132-COLS                        08961200
089613         AFTER ADVANCING PAGE.                                    08961300
089614                                                                  08961400
089615     WRITE FLOWBACK-RECORD                                        08961500
089616       FROM CS-HEADING1                                           08961600
089617         AFTER ADVANCING 3 LINES.                                 08961700
089618                                                                  08961800
089619     WRITE FLOWBACK-RECORD                                        08961900
089620       FROM CS-HEADING2                                           08962000
089621         AFTER ADVANCING 2 LINES.                                 08962100
089622                                                                  08962200
089623     WRITE FLOWBACK-RECORD                                        08962300
089624       FROM CS-HEADING3                                           08962400
089625         AFTER ADVANCING 1 LINES.                                 08962500
089626                                                                  08962600
      *CLP 12/15/14                                                     08962799
089627     PERFORM                                                      08962800
089628        VARYING SUB1 FROM 1 BY 1                                  08962900
089629        UNTIL SUB1 > 30 OR PV-TBL-DC-NBR(SUB1) = 0                08963099
089630        MOVE PV-TBL-DC-NBR(SUB1) TO CS-DTL1-DC-NBR                08963100
089631        MOVE PV-TBL-DC-NAME(SUB1) TO CS-DTL1-DC-NAME              08963200
089632        MOVE PV-TBL-TOT-RCVRS(SUB1) TO CS-DTL1-TOT-RCVRS          08963300
089633        ADD PV-TBL-TOT-RCVRS(SUB1) TO TOTAL-TOT-RCVRS             08963400
089634        MOVE PV-TBL-TOT-CARTONS(SUB1) TO CS-DTL1-TOT-CARTONS      08963500
089635        ADD PV-TBL-TOT-CARTONS(SUB1) TO TOTAL-TOT-CARTONS         08963600
089636        MOVE PV-TBL-TOT-UNITS(SUB1) TO CS-DTL1-TOT-UNITS          08963700
089637        ADD PV-TBL-TOT-UNITS(SUB1) TO TOTAL-TOT-UNITS             08963800
089638                                                                  08963900
089639        WRITE FLOWBACK-RECORD                                     08964000
089640          FROM CS-DETAIL1                                         08964100
089641            AFTER ADVANCING 1 LINES                               08964200
089642     END-PERFORM.                                                 08964300
089643                                                                  08964400
089644     MOVE TOTAL-TOT-RCVRS TO CS-TOT-RCVRS.                        08964500
089645     MOVE TOTAL-TOT-CARTONS TO CS-TOT-CARTONS.                    08964600
089646     MOVE TOTAL-TOT-UNITS TO CS-TOT-UNITS.                        08964700
089647                                                                  08964800
089648     WRITE FLOWBACK-RECORD                                        08964900
089649       FROM CS-TOTAL                                              08965000
089650         AFTER ADVANCING 2 LINES.                                 08965100
089651                                                                  08965200
089652******************************************************************08965300
089653*  PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    08965400
089654*  ERROR OR WARNING CODE OCCURS.                                  08965500
089655******************************************************************08965600
089656 9100-SQL-ABEND.                                                  08965700
089657     DISPLAY '9100-SQL-ABEND'.                                    08965800
089658     DISPLAY '** ABEND     **'.                                   08965900
089659     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        08966000
089660     DISPLAY '** PARAGRAPH ** = ' PV-ABEND-PARAGRAPH.             08966100
089661     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION-ATTEMPTED.     08966200
089662                                                                  08966300
089663******************************************************************08966400
089664* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    08966500
089665* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         08966600
089666* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     08966700
089667* FORMAT.                                                         08966800
089668******************************************************************08966900
089669     COPY DPPD004.                                                08967000
089670                                                                  08967100
089671     MOVE +4013                  TO PV-ABEND-CODE.                08967200
089672     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         08967300
089680                                                                  08968000
091400******************************************************************09140000
091500*         E N D   O F    P R O G R A M                            09150000
091600******************************************************************09160000
