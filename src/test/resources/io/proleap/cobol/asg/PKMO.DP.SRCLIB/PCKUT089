000100******************************************************************00010004
000200 IDENTIFICATION DIVISION.                                         00020004
000300******************************************************************00030004
000400                                                                  00040004
000500 PROGRAM-ID.    PCKUT089.                                         00050004
000600 AUTHOR.        BRENDA ROCKWELL.                                  00060004
000700 INSTALLATION.  KOHLS.                                            00070004
000800 DATE-WRITTEN   DECEMBER 2009.                                    00080004
000900 DATE-COMPILED.                                                   00090004
001000                                                                  00100004
001100******************************************************************00110004
001200******************************************************************00120004
001300* THIS PROGRAM WILL READ A FILE OF TRANSCRIBED NON PACK BY STORE *00130004
001400* RECEIVERS ATTACHED TO ARRIVED TRAILERS. THE PROGRAM WILL       *00140004
001500* DETERMINE THE CASEPACK SPLIT LABEL QUANTITIES FOR BOTH UCC128  *00150004
001600* AND NON 128 ORDERS AND WRITE TO AN OUTPUT FILE.                *00160004
001700******************************************************************00170004
001800***************************************************************** 00180004
001900*  CHANGE LOG.                                                    00190004
002000*  DATE         CHANGED BY      DESC                              00200004
002100*  -----------  -------------- ---------------------------------- 00210004
002200*  10/07/2011   S. ANDERSON    EFC OPTIMIZATION AND HOLIDAY PREP  00220004
002300*               (CODEWORKS)     - ADDITIONAL DATA NEEDED FOR      00230004
002400*                                 SUMMARY REPORTS                 00240004
002500*                              PROJ ID:   3253                    00250004
002600*                              WR/IR#:   WR40392                  00260004
002700*  RECOMPILE TO PICK UP CHANGES TO COPY PCRD068                   00270004
002701***************************************************************** 00270109
002710*  CHANGE LOG.                                                    00271005
002720*  DATE         CHANGED BY      DESC                              00272005
002730*  -----------  -------------- ---------------------------------- 00273005
002740*  07/27/2017   COGNIZANT      MODIFIED PROGRAM TO IMPROVE ITS    00274005
002750*                              EFFICIENCY.                        00275005
002760*                                 SUMMARY REPORTS                 00276005
002780*                              WR/IR#:   CHG0172949               00278005
002800***************************************************************** 00280004
002900******************************************************************00290004
003000 ENVIRONMENT DIVISION.                                            00300004
003100******************************************************************00310004
003200 CONFIGURATION SECTION.                                           00320004
003300 SOURCE-COMPUTER.        IBM-3090.                                00330004
003400 OBJECT-COMPUTER.        IBM-3090.                                00340004
003500                                                                  00350004
003600 INPUT-OUTPUT SECTION.                                            00360004
003700 FILE-CONTROL.                                                    00370004
003800                                                                  00380004
003900     SELECT INPUT-FILE                                            00390004
004000         ASSIGN TO INP01.                                         00400004
004100                                                                  00410004
004200     SELECT OUTPUT-FILE1                                          00420004
004300         ASSIGN TO OUT01.                                         00430004
004400                                                                  00440004
004500******************************************************************00450004
004600 DATA DIVISION.                                                   00460004
004700******************************************************************00470004
004800                                                                  00480004
004900******************************************************************00490004
005000 FILE SECTION.                                                    00500004
005100******************************************************************00510004
005200 FD  INPUT-FILE                                                   00520004
005300     RECORDING MODE IS F                                          00530004
005400     LABEL RECORDS ARE STANDARD                                   00540004
005500     BLOCK CONTAINS 0 RECORDS                                     00550004
005600     DATA RECORD IS INPUT-RECORD.                                 00560004
005700                                                                  00570004
005800 01  INPUT-RECORD              PIC  X(400).                       00580004
005900                                                                  00590004
006000 FD  OUTPUT-FILE1                                                 00600004
006100     RECORDING MODE IS F                                          00610004
006200     LABEL RECORDS ARE STANDARD                                   00620004
006300     BLOCK CONTAINS 0 RECORDS                                     00630004
006400     DATA RECORD IS OUTPUT-RECORD1.                               00640004
006500                                                                  00650004
006600 01  OUTPUT-RECORD1            PIC  X(400).                       00660004
006700                                                                  00670004
006800******************************************************************00680004
006900 WORKING-STORAGE SECTION.                                         00690004
007000******************************************************************00700004
007100 01  PS-PROGRAM-SWITCHES.                                         00710004
007200     05  PS-EOF-INPUT-SW              PIC X(01)  VALUE 'N'.       00720004
007300         88  PS-EOF-INPUT                        VALUE 'Y'.       00730004
007400         88  PS-NOT-EOF-INPUT                    VALUE 'N'.       00740004
007500     05  PS-OUTPUT-RECORD-TYPE        PIC X(01)  VALUE ' '.       00750004
007600         88  PS-JOB0100-RECORD                   VALUE 'J'.       00760004
007700         88  PS-WMS0102-RECORD                   VALUE 'W'.       00770004
007800         88  PS-EMP0101-RECORD                   VALUE 'E'.       00780004
007900     05  PS-DISTHD-DWNLD-SW           PIC X(01)  VALUE 'N'.       00790004
008000         88  PS-DISTHD-DWNLD-YES                 VALUE 'Y'.       00800004
008100         88  PS-DISTHD-DWNLD-NO                  VALUE 'N'.       00810004
008200     05  PS-LNE-UCC128-DATA-IND       PIC  X(01) VALUE 'N'.       00820004
008300         88  PS-LNE-UCC128-DATA-YES              VALUE 'Y'.       00830004
008400         88  PS-LNE-UCC128-DATA-NO               VALUE 'N'.       00840004
008500     05  PS-LNE-TROUBLE-IND           PIC  X(01) VALUE 'N'.       00850004
008600         88  PS-LNE-TROUBLE-YES                  VALUE 'Y'.       00860004
008700         88  PS-LNE-TROUBLE-NO                   VALUE 'N'.       00870004
008800     05  PS-UCC128-CRTN-MLT-LNE-SW    PIC  X(01)  VALUE  'N'.     00880004
008900         88  PS-UCC128-CRTN-MLT-LNE-NO            VALUE  'N'.     00890004
009000         88  PS-UCC128-CRTN-MLT-LNE               VALUE  'Y'.     00900004
009100     05  PS-OTPK-TRANS-ERROR-SW       PIC  X(01)  VALUE  'N'.     00910004
009200         88  PS-OTPK-TRANS-ERROR-YES              VALUE  'Y'.     00920004
009300         88  PS-OTPK-TRANS-ERROR-NO               VALUE  'N'.     00930004
009400     05  PS-EOF-TRECDIS-CURSOR-SW     PIC  X(01)  VALUE  'N'.     00940004
009500         88  PS-EOF-TRECDIS-CURSOR                VALUE  'Y'.     00950004
009600         88  PS-NOT-EOF-TRECDIS-CURSOR            VALUE  'N'.     00960004
009700     05  PS-FULLCASES-USED-SW           PIC  X(01)  VALUE  'N'.   00970004
009800         88  PS-FULLCASES-ALL-NOT-USED              VALUE  'N'.   00980004
009900         88  PS-FULLCASES-ALL-USED                  VALUE  'Y'.   00990004
010000                                                                  01000004
010100 01  PC-PROGRAM-CONSTANTS.                                        01010004
010200     05  PC-PROGRAM-NAME              PIC X(08) VALUE 'PCKUT089'. 01020004
010300     05  PC-UCC128-CALC-PGM           PIC X(08) VALUE 'PCKUT719'. 01030004
010400     05  PC-MAX-RETRIES           PIC S9(04) VALUE +3 COMP.       01040004
010500                                                                  01050004
010600 01  PV-PROGRAM-VARIABLES.                                        01060004
010700     05  PV-RECORDS-READ              PIC 9(09)  VALUE ZERO.      01070004
010800     05  PV-RECORDS-WRITTEN           PIC 9(09)  VALUE ZERO.      01080004
010900     05  PV-RETRY-COUNTER             PIC S9(04) VALUE 0 COMP.    01090004
011000     05  PV-PICKED                    PIC 9(05) VALUE ZEROS.      01100004
011100     05  PV-LEFTOVER                  PIC 9(05) VALUE ZEROS.      01110004
011200     05  PV-THROWS                    PIC 9(05) VALUE ZEROS.      01120004
011300     05  PV-REMAINDER                 PIC 9(05) VALUE ZEROS.      01130004
011400     05  PV-SAVE-DC                   PIC 9(04) VALUE ZEROS.      01140004
011500     05  PV-TROUBLE-COUNT             PIC S9(09) COMP.            01150004
011600     05  PV-DISPLAY-PO-NBR            PIC 9(09) VALUE ZEROS.      01160004
011700     05  PV-DISPLAY-RCVR-SEQ          PIC 9(04) VALUE ZEROS.      01170004
011800     05  PV-DISPLAY-LINE-NBR          PIC 9(04) VALUE ZEROS.      01180004
011900     05  PV-DISPLAY-OPER-UNT-ID       PIC 9(04) VALUE ZEROS.      01190004
012000     05  PV-DISPLAY-SEQ-NBR           PIC 9(04) VALUE ZEROS.      01200004
012100     05  PV-DISPLAY-DEPT-NBR          PIC 9(04) VALUE ZEROS.      01210004
012200     05  PV-DISPLAY-MAJ-CL-NBR        PIC 9(04) VALUE ZEROS.      01220004
012300     05  PV-DISPLAY-TRIP-ID           PIC 9(09) VALUE ZEROS.      01230004
012400     05  PV-DISPLAY-SHIP-UNT-ID       PIC 9(18) VALUE ZEROS.      01240004
012500     05  PV-WORK-TMST                 PIC X(26).                  01250004
012600     05  PV-MOD-NBR.                                              01260004
012700         10  FILLER                   PIC X(03) VALUE 'MOD'.      01270004
012800         10  PV-MOD-NBR-4-8           PIC X(05) VALUE SPACES.     01280004
012900     05  PV-ASSIGNMENT.                                           01290004
013000         10  PV-ASSIGNMENT-1-10       PIC X(10) VALUE SPACES.     01300004
013100         10  PV-ASSIGNMENT-11-15      PIC 9(05) VALUE ZEROS.      01310004
013200     05  PV-ASGMT-NBR-TXT.                                        01320004
013300         10 FILLER                    PIC X(04) VALUE SPACES.     01330004
013400         10 PV-ASGMT-NBR-TXT-5-10     PIC X(06) VALUE SPACES.     01340004
013500     05  PV-TOTAL-UNITS               PIC  9(09) VALUE 0.         01350004
013600     05  PV-SUM-UNITS                 PIC S9(09) VALUE 0 COMP.    01360004
013700     05  PV-SUM-CARTONS               PIC S9(09) VALUE 0 COMP.    01370004
013800     05  PV-SUM-PICKED                PIC S9(09) VALUE 0 COMP.    01380004
013900     05  PV-PO-NBR                    PIC 9(09) VALUE ZEROS.      01390004
014000     05  PV-REC-SEQ                   PIC 9(03) VALUE ZEROS.      01400004
014100     05  PV-PO-LNE-NBR                PIC 9(03) VALUE ZEROS.      01410004
014200     05  PV-PACK-TYPE                 PIC X.                      01420004
014300     05  PV-NEW-COUNT-FIELD           PIC  S9(9) COMP.            01430006
014400*    05  PV-TOT-PREPK-INPK-UNTS       PIC  S9(9) COMP.            01440006
014500*                                                                 01450004
014600     05  PV-UCC128-CRTN-CNT           PIC S9(09)  COMP.           01460004
014700     05  PV-UCC128-TOT-UNTS           PIC S9(09)  COMP.           01470004
014800     05  PV-UCC128-TOT-OTPK-QTYS      PIC S9(09)  COMP.           01480004
014900     05  PV-UCC128-OTPK-QTY           PIC S9(09)V COMP-3.         01490004
015000     05  PV-UCC128-LINES-PER-CRTN        PIC S9(09)V COMP-3.      01500004
015100     05  PV-TRANSCRIBE-SUM               PIC S9(09)  COMP.        01510004
015200     05  PV-PROCESS-QTY                  PIC  9(05)  VALUE ZEROES.01520004
015300     05  PV-CARTON-COUNT-CALC            PIC  9(04).              01530004
015400     05  PV-CARTON-COUNT-REM             PIC  9(04).              01540004
015500     05  PV-EXPTED-ITM-QTY               PIC S9(09)  COMP.        01550004
015600     05  PV-QUOTIENT                     PIC S9(09)  COMP.        01560004
015700     05  PV-P2L-QUOTIENT                 PIC S9(09)  COMP.        01570004
015800     05  PV-EXPT-REMAINDER               PIC S9(09)  COMP.        01580004
015900     05  PV-TOT-REMAINDER                PIC S9(09)  COMP.        01590004
016000     05  PV-P2L-LNE-TOTAL                PIC S9(09)  COMP.        01600004
016100     05  PV-SHIP-LNE-TOTAL               PIC S9(09)  COMP.        01610004
016200     05  PV-FULL-CASE-SHIP-TOTAL         PIC S9(09)  COMP.        01620004
016300     05  PV-P2L-REMAINDER                PIC S9(09)  COMP.        01630004
016400     05  PV-FCSE-INPK-REMAINDER          PIC S9(09)  COMP.        01640004
016500     05  PV-TOTAL-CARTON-COUNT           PIC S9(09)  COMP.        01650004
016600                                                                  01660004
016700     05  PV-STR-P2L-UNT-QTY              PIC S9(09)  COMP.        01670004
016800     05  PV-STR-FCSE-UNT-QTY             PIC S9(09)  COMP.        01680004
016900     05  PV-STR-INPK-UNT-QTY             PIC S9(09)  COMP.        01690004
017000     05  PV-STR-ACTL-UNT-QTY             PIC S9(09)  COMP.        01700004
017100     05  PV-PREPK-OTPK-QTY               PIC 9(04).               01710004
017200                                                                  01720004
017300     05  PV-PREV-OPER-UNT-ID             PIC S9(04)  COMP.        01730004
017400                                                                  01740004
017500     05  PV-HANG-COUNT                  PIC S9(09)  COMP.         01750004
017600     05  PV-FOLD-COUNT                  PIC S9(09)  COMP.         01760004
017700     05  PV-COMMODITY-COUNT             PIC S9(09)  COMP.         01770004
017800     05  PV-OTHER-COUNT                 PIC S9(09)  COMP.         01780004
017900     05  PV-P2L-ZONE                    PIC X(14).                01790004
018000         88 PV-COMMODITY                 VALUE 'COMMODITY     '.  01800004
018100         88 PV-HANG-FOLD                 VALUE 'HANG/FOLD     '.  01810004
018200         88 PV-HANG-COMMODITY            VALUE 'HANG/COMMODITY'.  01820004
018300     05  PV-P2L-ZN-PRES-OTHER           PIC X(01).                01830004
018400         88 PV-COUNT-AS-HANG                   VALUE 'H'.         01840004
018500         88 PV-COUNT-AS-FOLD                   VALUE 'F'.         01850004
018600         88 PV-HANG-AS-COMMODITY               VALUE 'C'.         01860004
018700     05  PV-HANGER-IND                PIC X(01).                  01870004
018800         88 PV-HANGER-AGREEMENT                  VALUE 'Y'.       01880004
018900                                                                  01890004
019000                                                                  01900004
019100                                                                  01910004
019200                                                                  01920004
019300                                                                  01930004
019400 01  PV-ABEND-FIELDS.                                             01940004
019500     05  PV-ABEND-CODE                PIC  S9(4) VALUE +0         01950004
019600                                                 COMP SYNC.       01960004
019700     05  PV-SQLCODE                   PIC  Z(08)9-.               01970004
019800     05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.    01980004
019900     05  PV-ABEND-OPERATION           PIC  X(50) VALUE SPACES.    01990004
020000     05  PV-ABEND-STRUCTURE-1         PIC  X(08) VALUE SPACES.    02000004
020100     05  PV-ABEND-STRUCTURE-2         PIC  X(08) VALUE SPACES.    02010004
020200     05  PV-DB2-OPERATION-MESSAGE-1   PIC  X(79) VALUE SPACES.    02020004
020300     05  PV-DB2-OPERATION-MESSAGE-2   PIC  X(79) VALUE SPACES.    02030004
020400     05  PV-DB2-OPERATION-MESSAGE-3   PIC  X(79) VALUE SPACES.    02040004
020500     05  PV-DB2-TABLE-NAME            PIC X(12)  VALUE SPACE.     02050004
020600                                                                  02060004
020700 01  DN-NULL-INDICATORS.                                          02070004
020800     05  DN-NULL-IND-VEH              PIC S9(04)    VALUE ZERO    02080004
020900                                                     COMP SYNC.   02090004
021000     05  DN-NULL-IND-FCSE             PIC S9(04)    VALUE ZERO    02100004
021100                                                     COMP SYNC.   02110004
021200     05  DN-NULL-IND-P2L              PIC S9(04)    VALUE ZERO    02120004
021300                                                     COMP SYNC.   02130004
021400     05  DN-NULL-FCSE-SPLT            PIC S9(04)    VALUE ZERO    02140004
021500                                                     COMP SYNC.   02150004
021600     05  DN-NULL-P2L-SPLT             PIC S9(04)    VALUE ZERO    02160004
021700                                                     COMP SYNC.   02170004
021800 01  DK-DB-KEYS.                                                  02180004
021900     05 DK-TRIP-ID                    PIC S9(09) COMP.            02190004
022000     05 DK-SHIP-UNT-ID                PIC S9(18) COMP-3.          02200004
022100     05 DK-DEPT-NBR                   PIC S9(04) COMP.            02210004
022200     05 DK-MAJ-CL-NBR                 PIC S9(04) COMP.            02220004
022300     05 DK-PO-NBR                     PIC S9(09) COMP.            02230004
022400     05 DK-REC-SEQ-NBR                PIC S9(09) COMP.            02240004
022500     05 DK-PO-LNE-NBR                 PIC S9(09) COMP.            02250004
022600     05 DK-PO-LNE-NBR-TEMP            PIC S9(09) COMP.            02260004
022700     05 DK-OPER-UNT-ID                PIC S9(04) COMP.            02270004
022800     05 DK-DOOR-NUMBER                PIC X(04).                  02280004
022900     05 DK-PACK-ID                    PIC  S9(4) COMP.            02290004
023000     05 DK-PREPK-ID                   PIC  S9(4) COMP.            02300004
023100     05 PV-FUNC-QTY                   PIC S9(09) COMP.            02310004
023200                                                                  02320004
023300******************************************************************02330004
023400*  DB2 FORMATTED MESSAGE AREA                                     02340004
023500******************************************************************02350004
023600     COPY DPWS004.                                                02360004
023700*                                                                 02370004
023800******************************************************************02380004
023900*  COPY TO UCC128 LABEL CALCULATION MODULE                        02390004
024000******************************************************************02400004
024100     COPY PCWS251.                                                02410004
024200*                                                                 02420004
024300******************************************************************02430004
024400*  COPYBOOK PCRD068                                               02440004
024500******************************************************************02450004
024600     COPY PCRD068.                                                02460004
024700*                                                                 02470004
024800******************************************************************02480004
024900*    TKRPRPM TABLE                                                02490004
025000******************************************************************02500004
025100     EXEC SQL                                                     02510004
025200          INCLUDE TKRPRPM                                         02520004
025300     END-EXEC.                                                    02530004
025400*                                                                 02540004
025500******************************************************************02550004
025600*    TSHPTPO TABLE                                                02560004
025700******************************************************************02570004
025800     EXEC SQL                                                     02580004
025900          INCLUDE TSHPTPO                                         02590004
026000     END-EXEC.                                                    02600004
026100                                                                  02610004
026200******************************************************************02620004
026300*    TRECITM TABLE                                                02630004
026400******************************************************************02640004
026500     EXEC SQL                                                     02650004
026600          INCLUDE TRECITM                                         02660004
026700     END-EXEC.                                                    02670004
026800                                                                  02680004
026900******************************************************************02690004
027000*    TSHIPMT TABLE                                                02700004
027100******************************************************************02710004
027200     EXEC SQL                                                     02720004
027300          INCLUDE TSHIPMT                                         02730004
027400     END-EXEC.                                                    02740004
027500                                                                  02750004
027600******************************************************************02760004
027700*    TVHTRIP TABLE                                                02770004
027800******************************************************************02780004
027900     EXEC SQL                                                     02790004
028000          INCLUDE TVHTRIP                                         02800004
028100     END-EXEC.                                                    02810004
028200                                                                  02820004
028300******************************************************************02830004
028400*   TRECEIV TABLE                                                 02840004
028500******************************************************************02850004
028600     EXEC SQL                                                     02860004
028700          INCLUDE TRECEIV                                         02870004
028800     END-EXEC.                                                    02880004
028900                                                                  02890004
029000******************************************************************02900004
029100*   TRECDIS TABLE                                                 02910004
029200******************************************************************02920004
029300     EXEC SQL                                                     02930004
029400          INCLUDE TRECDIS                                         02940004
029500     END-EXEC.                                                    02950004
029600                                                                  02960004
029700******************************************************************02970004
029800*    TPURCHS TABLE                                                02980004
029900******************************************************************02990004
030000     EXEC SQL                                                     03000004
030100          INCLUDE TPURCHS                                         03010004
030200     END-EXEC.                                                    03020004
030300                                                                  03030004
030400******************************************************************03040004
030500*    TPURItM TABLE                                                03050004
030600******************************************************************03060004
030700     EXEC SQL                                                     03070004
030800          INCLUDE TPURItM                                         03080004
030900     END-EXEC.                                                    03090004
031000                                                                  03100004
031100******************************************************************03110004
031200*    TINPKSU TABLE                                                03120004
031300******************************************************************03130004
031400     EXEC SQL                                                     03140004
031500          INCLUDE TINPKSU                                         03150004
031600     END-EXEC.                                                    03160004
031700                                                                  03170004
031800******************************************************************03180004
031900*    TPKSLIP TABLE                                                03190004
032000******************************************************************03200004
032100     EXEC SQL                                                     03210004
032200          INCLUDE TPKSLIP                                         03220004
032300     END-EXEC.                                                    03230004
032400                                                                  03240004
032500******************************************************************03250004
032600*    TSHUUPC TABLE                                                03260004
032700******************************************************************03270004
032800     EXEC SQL                                                     03280004
032900          INCLUDE TSHUUPC                                         03290004
033000     END-EXEC.                                                    03300004
033100                                                                  03310004
033200******************************************************************03320004
033300*    TDISTHD TABLE                                                03330004
033400******************************************************************03340004
033500     EXEC SQL                                                     03350004
033600          INCLUDE TDISTHD                                         03360004
033700     END-EXEC.                                                    03370004
033800                                                                  03380004
033900******************************************************************03390004
034000*    XLT_SKU TABLE                                                03400004
034100******************************************************************03410004
034200     EXEC SQL                                                     03420004
034300          INCLUDE XLT00003                                        03430004
034400     END-EXEC.                                                    03440004
034500                                                                  03450004
034600******************************************************************03460004
034700*    XLT_LOC TABLE                                                03470004
034800******************************************************************03480004
034900     EXEC SQL                                                     03490004
035000          INCLUDE XLT00010                                        03500004
035100     END-EXEC.                                                    03510004
035200******************************************************************03520004
035300*    XLT_VND_STYL TABLE                                           03530004
035400******************************************************************03540004
035500     EXEC SQL                                                     03550004
035600          INCLUDE XLT00004                                        03560004
035700     END-EXEC.                                                    03570004
035800                                                                  03580004
035900******************************************************************03590004
036000*  SQL AND COBOL DECLARATIONS FOR THE MB-MERCHANDISE AREA TABLE   03600004
036100******************************************************************03610004
036200     EXEC SQL                                                     03620004
036300          INCLUDE TMDSEAR                                         03630004
036400     END-EXEC.                                                    03640004
036500                                                                  03650004
036600*-----------------------------------------------------------------03660004
036700*  SQL AND COBOL DECLARATIONS FOR THE MB-MERCHANDISE DEPT TABLE   03670004
036800*-----------------------------------------------------------------03680004
036900     EXEC SQL                                                     03690004
037000          INCLUDE TMDSEDP                                         03700004
037100     END-EXEC.                                                    03710004
037200                                                                  03720004
037300******************************************************************03730004
037400*    TTRBNTF TABLE                                                03740004
037500******************************************************************03750004
037600     EXEC SQL                                                     03760004
037700          INCLUDE TTRBNTF                                         03770004
037800     END-EXEC.                                                    03780004
037900                                                                  03790004
038000******************************************************************03800004
038100*    TTRBRSN TABLE                                                03810004
038200******************************************************************03820004
038300     EXEC SQL                                                     03830004
038400          INCLUDE TTRBRSN                                         03840004
038500     END-EXEC.                                                    03850004
038600                                                                  03860004
038700******************************************************************03870004
038800*    TTRBRCN TABLE                                                03880004
038900******************************************************************03890004
039000     EXEC SQL                                                     03900004
039100          INCLUDE TTRBRCN                                         03910004
039200     END-EXEC.                                                    03920004
039300                                                                  03930004
039400                                                                  03940004
039500******************************************************************03950004
039600*    WST_INTGRTN_TYP TABLE                                        03960004
039700******************************************************************03970004
039800     EXEC SQL                                                     03980004
039900          INCLUDE WST00008                                        03990004
040000     END-EXEC.                                                    04000004
040100                                                                  04010004
040200                                                                  04020004
040300******************************************************************04030004
040400*    WST_ATTR_DEFN  TABLE                                         04040004
040500******************************************************************04050004
040600     EXEC SQL                                                     04060004
040700          INCLUDE WST00009                                        04070004
040800     END-EXEC.                                                    04080004
040900                                                                  04090004
041000                                                                  04100004
041100******************************************************************04110004
041200*    WST_ATTR_ELEM TABLE                                          04120004
041300******************************************************************04130004
041400     EXEC SQL                                                     04140004
041500          INCLUDE WST00010                                        04150004
041600     END-EXEC.                                                    04160004
041700                                                                  04170004
041800                                                                  04180004
041900******************************************************************04190004
042000*  COMMUNICATIONS AREA FOR DB2                                    04200004
042100******************************************************************04210004
042200     EXEC SQL                                                     04220004
042300          INCLUDE SQLCA                                           04230004
042400     END-EXEC.                                                    04240004
042500                                                                  04250004
042600*---------------------------------------------------------------* 04260004
042700*   TRECDIS CURSOR - DETERMINE P2L & SHIP LABEL QTYS            * 04270004
042800*---------------------------------------------------------------* 04280004
042900     EXEC SQL                                                     04290004
043000          DECLARE TRECDIS_CSR CURSOR FOR                          04300004
043100              SELECT  A.STR_NBR                                   04310004
043200                     ,A.EXPTED_ITM_QTY                            04320004
043300                     ,B.LOC_TYP_CDE                               04330004
043400                FROM  TRECDIS A                                   04340004
043500                     ,XLT_LOC B                                   04350004
043600               WHERE  A.ORD_NBR        = :DK-PO-NBR               04360004
043700                 AND  A.REC_SEQ_NBR    = :DK-REC-SEQ-NBR          04370004
043800                 AND  A.ORD_LNE_NBR    = :DK-PO-LNE-NBR           04380004
043900                 AND  A.EXPTED_ITM_QTY > 0                        04390004
044000                 AND  A.STR_NBR        = B.LOC_NBR                04400004
044100            GROUP BY  A.STR_NBR                                   04410004
044200                     ,A.EXPTED_ITM_QTY                            04420004
044300                     ,B.LOC_TYP_CDE                               04430004
044400           WITH UR                                                04440004
044500     END-EXEC.                                                    04450004
044600                                                                  04460004
044700                                                                  04470004
044800******************************************************************04480004
044900 PROCEDURE DIVISION.                                              04490004
045000******************************************************************04500004
045100 0000-PROGRAM-MAINLINE.                                           04510004
045200                                                                  04520004
045300                                                                  04530004
045400     OPEN INPUT  INPUT-FILE                                       04540004
045500          OUTPUT OUTPUT-FILE1.                                    04550004
045600                                                                  04560004
045700     INITIALIZE OUTPUT-RECORD1.                                   04570004
045800                                                                  04580004
045900                                                                  04590004
046000     PERFORM 1000-READ-INPUT-FILE.                                04600004
046100                                                                  04610004
046200     PERFORM 2000-PROCESS-INPUT-FILE                              04620004
046300         UNTIL PS-EOF-INPUT.                                      04630004
046400                                                                  04640004
046500     PERFORM 9000-EOJ.                                            04650004
046600                                                                  04660004
046700     STOP RUN.                                                    04670004
046800                                                                  04680004
046900******************************************************************04690004
047000* READS RECORD FROM THE INPUT FILE                                04700004
047100******************************************************************04710004
047200 1000-READ-INPUT-FILE.                                            04720004
047300     MOVE '1000-READ-INPUT-FILE.'      TO  PV-ABEND-PARAGRAPH.    04730004
047400                                                                  04740004
047500     READ INPUT-FILE                                              04750004
047600          INTO PC068-RECORD-LAYOUT                                04760004
047700            AT END                                                04770004
047800               SET PS-EOF-INPUT     TO TRUE                       04780004
047900                                                                  04790004
048000            NOT AT END                                            04800004
048100               SET PS-NOT-EOF-INPUT TO TRUE                       04810004
048200               ADD +1 TO PV-RECORDS-READ                          04820004
048300     END-READ.                                                    04830004
048400                                                                  04840004
048500******************************************************************04850004
048600* PROCESS INPUT RECORDS                                          *04860004
048700******************************************************************04870004
048800 2000-PROCESS-INPUT-FILE.                                         04880004
048900     MOVE '2000-PROCESS-INPUT-FILE.'   TO PV-ABEND-PARAGRAPH.     04890004
049000                                                                  04900004
049100     MOVE PC068-PO-NBR             TO DK-PO-NBR.                  04910004
049200     MOVE PC068-REC-SEQ-NBR        TO DK-REC-SEQ-NBR.             04920004
049300     MOVE PC068-PO-LNE-NBR         TO DK-PO-LNE-NBR.              04930004
049400     MOVE PC068-PACK-ID            TO DK-PACK-ID.                 04940004
049500     PERFORM 2500-CHECK-DISTHD-DWNLD.                             04950004
049600     IF PS-DISTHD-DWNLD-YES                                       04960004
049700        PERFORM 8000-LOAD-OUTPUT-DATA                             04970004
049800        PERFORM 8900-WRITE-OUTPUT-RECORD                          04980004
049900     ELSE                                                         04990004
050000        PERFORM 2590-PROCESS-FOR-UCC128-DATA                      05000004
050100        PERFORM 4000-GET-TRANSCRIBE                               05010004
050200        PERFORM 4100-GET-OUTER-PK-QTY                             05020004
050300** GB 5/12/12                                                     05030004
050400        if RECITM-CASE-PACK-QTY = 0                               05040004
050500           MOVE XLT00003-OUTR-PK-QTY TO RECITM-CASE-PACK-QTY      05050004
050600        END-IF                                                    05060004
050700** GB 5/12/12                                                     05070004
050800        PERFORM 3200-GET-TROUBLE-COUNT                            05080004
050900        IF PS-LNE-TROUBLE-YES                                     05090004
051000           PERFORM 3300-CHECK-LINE-TROUBLE                        05100004
051100        END-IF                                                    05110004
051200        IF PS-LNE-UCC128-DATA-YES                                 05120004
051300           PERFORM 3000-CALL-UCC128-LBL-CALC                      05130004
051400        END-IF                                                    05140004
051500                                                                  05150004
051600        IF PS-LNE-UCC128-DATA-NO                                  05160004
051700           PERFORM 5000-NO-128-CHECK-TRNSCRBD                     05170004
051800           IF PS-OTPK-TRANS-ERROR-NO                              05180004
051900              PERFORM 5100-NO-128-CRTN-CALC                       05190004
052000           END-IF                                                 05200004
052100        END-IF                                                    05210004
052200                                                                  05220004
052300        PERFORM 8000-LOAD-OUTPUT-DATA                             05230004
052400        PERFORM 8900-WRITE-OUTPUT-RECORD                          05240004
052500     END-IF.                                                      05250004
052600                                                                  05260004
052700     PERFORM 1000-READ-INPUT-FILE.                                05270004
052800                                                                  05280004
052900******************************************************************05290004
053000* CHECK IF THE PO RCVR HAS ALREADY BEEN DOWNLOADED               *05300004
053100******************************************************************05310004
053200 2500-CHECK-DISTHD-DWNLD.                                         05320004
053300                                                                  05330004
053400      MOVE '2500-CHECK-DISTHD-DWNLD '   TO PV-ABEND-PARAGRAPH.    05340004
053500                                                                  05350004
053600      EXEC SQL                                                    05360004
053700          SELECT                                                  05370004
053800                  TOT_CART_CNT                                    05380004
053900                , P2L_CART_CNT                                    05390004
054000                , FCSE_CART_CNT                                   05400004
054100                , UCC128_DAT_USG_CDE                              05410004
054200                , INPK_UNT_QTY                                    05420004
054300                , OTPK_UNT_QTY                                    05430004
054400           INTO                                                   05440004
054500                 :DISTHD-TOT-CART-CNT                             05450004
054600                ,:DISTHD-P2L-CART-CNT                             05460004
054700                ,:DISTHD-FCSE-CART-CNT                            05470004
054800                ,:DISTHD-UCC128-DAT-USG-CDE                       05480004
054900                ,:DISTHD-INPK-UNT-QTY                             05490004
055000                ,:DISTHD-OTPK-UNT-QTY                             05500004
055100           FROM  TDISTHD                                          05510004
055200                                                                  05520004
055300           WHERE ORD_NBR        = :DK-PO-NBR                      05530004
055400            AND  RCVR_SEQ_NBR   = :DK-REC-SEQ-NBR                 05540004
055500            AND  ORD_LNE_NBR    = :DK-PO-LNE-NBR                  05550004
055600            AND  TOT_CART_CNT   > 0                               05560004
055700            AND  CRE_USR_ID NOT IN ('TRLRUNLD','HOTCMPLT')        05570004
055800           WITH UR                                                05580004
055900      END-EXEC                                                    05590004
056000                                                                  05600004
056100      EVALUATE TRUE                                               05610004
056200        WHEN SQLCODE = ZERO                                       05620004
056300             SET PS-DISTHD-DWNLD-YES TO TRUE                      05630004
056400             IF DISTHD-UCC128-DAT-USG-CDE = 'U'                   05640004
056500                SET PS-LNE-UCC128-DATA-YES TO TRUE                05650004
056600             END-IF                                               05660004
056700        WHEN SQLCODE = +100                                       05670004
056800             SET PS-DISTHD-DWNLD-NO TO TRUE                       05680004
056900        WHEN SQLWARN0 NOT = SPACES                                05690004
057000        WHEN SQLCODE NOT = ZERO                                   05700004
057100          MOVE DK-PO-NBR            TO PV-DISPLAY-PO-NBR          05710004
057200          MOVE DK-REC-SEQ-NBR       TO PV-DISPLAY-RCVR-SEQ        05720004
057300          MOVE DK-PO-LNE-NBR        TO PV-DISPLAY-LINE-NBR        05730004
057400          STRING ' PO/RCVR/LNE '         DELIMITED BY SIZE        05740004
057500                  PV-DISPLAY-PO-NBR      DELIMITED BY SIZE        05750004
057600                  '/'                    DELIMITED BY SIZE        05760004
057700                  PV-DISPLAY-RCVR-SEQ    DELIMITED BY SIZE        05770004
057800                  '/'                    DELIMITED BY SIZE        05780004
057900                  PV-DISPLAY-LINE-NBR    DELIMITED BY SIZE        05790004
058000                                 INTO PV-DB2-OPERATION-MESSAGE-2  05800004
058100          MOVE SQLCODE               TO PV-SQLCODE                05810004
058200          MOVE 'CHECK PREV CSEPK DOWLOAD '                        05820004
058300                                    TO PV-DB2-OPERATION-MESSAGE-1 05830004
058400          MOVE 'TDISTHD '     TO PV-DB2-TABLE-NAME                05840004
058500          PERFORM 9999-SQL-ABEND                                  05850004
058600      END-EVALUATE.                                               05860004
058700                                                                  05870004
058800******************************************************************05880004
058900* CHECK IF THE PO RCVR HAS UCC128 DATA                           *05890004
059000******************************************************************05900004
059100 2590-PROCESS-FOR-UCC128-DATA.                                    05910004
059200                                                                  05920004
059300      MOVE '2590-PROCESS-FOR-UCC128-DATA' TO PV-ABEND-PARAGRAPH.  05930004
059400                                                                  05940004
059500      SET PS-LNE-UCC128-DATA-NO TO TRUE.                          05950004
059600      PERFORM 2600-CHECK-UCC128-CRTN-DATA                         05960004
059700      IF PS-LNE-UCC128-DATA-YES                                   05970004
059800         PERFORM 2700-CHECK-UCC128-QTY-DATA                       05980004
059900      END-IF.                                                     05990004
060000*     IF PS-LNE-UCC128-DATA-YES                                   06000004
060100*       IF PC068-BULK-TYPE                                        06010004
060200*           MOVE ZEROES TO PV-UCC128-LINES-PER-CRTN               06020004
060300*           PERFORM 2800-CHECK-CRTN-MLT-LNES                      06030004
060400*           IF  PV-UCC128-LINES-PER-CRTN  >  1                    06040004
060500*               SET PS-LNE-UCC128-DATA-NO TO TRUE                 06050004
060600*           END-IF                                                06060004
060700*       END-IF                                                    06070004
060800*     END-IF.                                                     06080004
060900                                                                  06090004
061000 2600-CHECK-UCC128-CRTN-DATA.                                     06100004
061100                                                                  06110004
061200      MOVE '2600-CHECK-UCC128-CRTN-DATA'                          06120004
061300                                 TO PV-ABEND-PARAGRAPH            06130004
061400                                                                  06140004
061500      EXEC SQL                                                    06150004
061600          SELECT COUNT(DISTINCT C.SHIPT_UNT_ID)                   06160004
061700            INTO :PV-UCC128-CRTN-CNT                              06170004
061800            FROM TPKSLIP A                                        06180004
061900                ,TINPKSU B                                        06190004
062000                ,TSHUUPC C                                        06200004
062100           WHERE A.PO_NBR        = :DK-PO-NBR                     06210004
062200             AND A.REC_SEQ_NBR   = :DK-REC-SEQ-NBR                06220004
062300             AND A.VER_STAT_CDE  = 'A'                            06230004
062400             AND A.PKSL_STAT_CDE = 'AC'                           06240004
062500             AND B.PO_NBR        = A.PO_NBR                       06250004
062600             AND B.SEQ_NBR       = A.SEQ_NBR                      06260004
062700             AND C.SHIPT_UNT_ID  = B.SHIPT_UNT_ID                 06270004
062800             AND C.TRN_NBR       = A.PO_NBR                       06280004
062900             AND C.TRN_LNE_NBR   = :DK-PO-LNE-NBR                 06290004
063000           WITH UR                                                06300004
063100      END-EXEC.                                                   06310004
063200                                                                  06320004
063300                                                                  06330004
063400      EVALUATE TRUE                                               06340004
063500        WHEN SQLCODE = ZERO                                       06350004
063600           IF PV-UCC128-CRTN-CNT  >  0                            06360004
063700              SET PS-LNE-UCC128-DATA-YES TO TRUE                  06370004
063800              MOVE PV-UCC128-CRTN-CNT TO PC251-TOTAL-CARTONS      06380004
063900           ELSE                                                   06390004
064000              MOVE ZEROES             TO PC251-TOTAL-CARTONS      06400004
064100              SET PS-LNE-UCC128-DATA-NO TO TRUE                   06410004
064200           END-IF                                                 06420004
064300        WHEN SQLCODE = +100                                       06430009
064310        WHEN SQLCODE = -305                                       06431009
064400             SET  PS-LNE-UCC128-DATA-NO TO  TRUE                  06440004
064500             MOVE ZEROES             TO PC251-TOTAL-CARTONS       06450004
064600        WHEN SQLWARN0 NOT = SPACES                                06460004
064700        WHEN SQLCODE NOT = ZERO                                   06470004
064800          MOVE DK-PO-NBR            TO PV-DISPLAY-PO-NBR          06480004
064900          MOVE DK-REC-SEQ-NBR       TO PV-DISPLAY-RCVR-SEQ        06490004
065000          MOVE DK-PO-LNE-NBR        TO PV-DISPLAY-LINE-NBR        06500004
065100          STRING ' PO/RCVR/LNE '         DELIMITED BY SIZE        06510004
065200                  PV-DISPLAY-PO-NBR      DELIMITED BY SIZE        06520004
065300                  '/'                    DELIMITED BY SIZE        06530004
065400                  PV-DISPLAY-RCVR-SEQ    DELIMITED BY SIZE        06540004
065500                  '/'                    DELIMITED BY SIZE        06550004
065600                  PV-DISPLAY-LINE-NBR    DELIMITED BY SIZE        06560004
065700                                 INTO PV-DB2-OPERATION-MESSAGE-2  06570004
065800          MOVE SQLCODE               TO PV-SQLCODE                06580004
065900          MOVE 'SELECT SHUUPC CRTN COUNT'                         06590004
066000                                    TO PV-DB2-OPERATION-MESSAGE-1 06600004
066100          MOVE 'TINPKSU '     TO PV-DB2-TABLE-NAME                06610004
066200          PERFORM 9999-SQL-ABEND                                  06620004
066300      END-EVALUATE.                                               06630004
066400******************************************************************06640004
066500 2700-CHECK-UCC128-QTY-DATA.                                      06650004
066600      MOVE '2700-CHECK-UCC128-QTY-DATA '                          06660004
066700                                 TO PV-ABEND-PARAGRAPH            06670004
066800      EXEC SQL                                                    06680004
066900          SELECT SUM(C.SHPD_QTY)                                  06690004
067000            INTO :PV-UCC128-TOT-UNTS                              06700004
067100            FROM TPKSLIP A                                        06710004
067200                ,TINPKSU B                                        06720004
067300                ,TSHUUPC C                                        06730004
067400           WHERE A.PO_NBR        = :DK-PO-NBR                     06740004
067500             AND A.REC_SEQ_NBR   = :DK-REC-SEQ-NBR                06750004
067600             AND A.VER_STAT_CDE  = 'A'                            06760004
067700             AND A.PKSL_STAT_CDE = 'AC'                           06770004
067800             AND B.PO_NBR        = A.PO_NBR                       06780004
067900             AND B.SEQ_NBR       = A.SEQ_NBR                      06790004
068000             AND C.SHIPT_UNT_ID  = B.SHIPT_UNT_ID                 06800004
068100             AND C.TRN_NBR       = A.PO_NBR                       06810004
068200             AND C.TRN_LNE_NBR   = :DK-PO-LNE-NBR                 06820004
068300           WITH UR                                                06830004
068400      END-EXEC.                                                   06840004
068500                                                                  06850004
068600      EVALUATE TRUE                                               06860004
068700        WHEN SQLCODE = ZERO                                       06870004
068800             SET  PS-LNE-UCC128-DATA-YES TO  TRUE                 06880004
068900        WHEN SQLCODE = +100                                       06890009
068910        WHEN SQLCODE = -305                                       06891009
069000             SET  PS-LNE-UCC128-DATA-NO TO  TRUE                  06900004
069100        WHEN SQLWARN0 NOT = SPACES                                06910004
069200        WHEN SQLCODE NOT = ZERO                                   06920004
069300          MOVE DK-PO-NBR            TO PV-DISPLAY-PO-NBR          06930004
069400          MOVE DK-REC-SEQ-NBR       TO PV-DISPLAY-RCVR-SEQ        06940004
069500          MOVE DK-PO-LNE-NBR        TO PV-DISPLAY-LINE-NBR        06950004
069600          STRING ' PO/RCVR/LNE '         DELIMITED BY SIZE        06960004
069700                  PV-DISPLAY-PO-NBR      DELIMITED BY SIZE        06970004
069800                  '/'                    DELIMITED BY SIZE        06980004
069900                  PV-DISPLAY-RCVR-SEQ    DELIMITED BY SIZE        06990004
070000                  '/'                    DELIMITED BY SIZE        07000004
070100                  PV-DISPLAY-LINE-NBR    DELIMITED BY SIZE        07010004
070200                                 INTO PV-DB2-OPERATION-MESSAGE-2  07020004
070300          MOVE SQLCODE               TO PV-SQLCODE                07030004
070400          MOVE 'SELECT SHUUPC SHPD QTY'                           07040004
070500                                    TO PV-DB2-OPERATION-MESSAGE-1 07050004
070600          MOVE 'TINPKSU '     TO PV-DB2-TABLE-NAME                07060004
070700          PERFORM 9999-SQL-ABEND                                  07070004
070800      END-EVALUATE.                                               07080004
070900******************************************************************07090004
071000 3000-CALL-UCC128-LBL-CALC.                                       07100004
071100     MOVE '3000-CALL-UCC128-LBL-CALC ' TO PV-ABEND-PARAGRAPH.     07110004
071200                                                                  07120004
071300     MOVE PC068-PO-NBR              TO PC251-PO-NBR.              07130004
071400     MOVE PC068-REC-SEQ-NBR         TO PC251-RCVR-SEQ-NBR.        07140004
071500     MOVE PC068-PO-LNE-NBR          TO PC251-PO-LNE-NBR.          07150004
071600     MOVE PC068-PACK-ID             TO PC251-PREPK-ID.            07160004
071700     MOVE PC068-OPER-UNT-ID         TO PC251-OPER-UNT-ID          07170004
071800                                       DK-OPER-UNT-ID.            07180004
071900     MOVE RECITM-INNR-PACK-QTY      TO PC251-INPK-UNT-QTY.        07190004
072000     MOVE PC068-DEPT-NBR            TO PC251-DEPT-NBR.            07200004
072100     MOVE PC068-MAJ-CL-NBR          TO PC251-CL-NBR.              07210004
072200     MOVE XLT00003-SKU-NBR          TO PC251-SKU.                 07220004
072300     MOVE RECITM-PREPK-RATO-QTY     TO PC251-PREPK-RATIO.         07230004
072400     MOVE 1                         TO PC251-MOD-NBR.             07240004
072500     MOVE PC068-PKG-TYPE            TO PC251-PKGNG-CD.            07250004
072600                                                                  07260004
072700     PERFORM 5650-SELECT-CRE-LABEL                                07270004
072800                                                                  07280004
072900     SET  PC251-PRT-SHUFFLED        TO TRUE.                      07290004
073000     SET  PC251-CREATE-BOTH         TO TRUE.                      07300004
073100     IF PC068-INNER-PREPK OR PC068-MULTI-PREPK                    07310004
073200        SET PC251-PRE-PACK-ORDER TO TRUE                          07320004
073300        PERFORM 4200-GET-TOT-PREPK-UNTS                           07330004
073400     END-IF                                                       07340004
073500                                                                  07350004
073600     CALL PC-UCC128-CALC-PGM  USING PC251-FIELDS.                 07360004
073700                                                                  07370004
073800     EVALUATE TRUE                                                07380004
073900       WHEN PC251-SUCCESSFUL                                      07390004
074000           PERFORM 3100-VALIDATE-LBL-CALC-CALL                    07400004
074100       WHEN OTHER                                                 07410004
074200        MOVE DK-PO-NBR            TO PV-DISPLAY-PO-NBR            07420004
074300        MOVE DK-REC-SEQ-NBR       TO PV-DISPLAY-RCVR-SEQ          07430004
074400        MOVE DK-PO-LNE-NBR        TO PV-DISPLAY-LINE-NBR          07440004
074500        STRING ' PO/RCVR/LNE '         DELIMITED BY SIZE          07450004
074600                PV-DISPLAY-PO-NBR      DELIMITED BY SIZE          07460004
074700                '/'                    DELIMITED BY SIZE          07470004
074800                PV-DISPLAY-RCVR-SEQ    DELIMITED BY SIZE          07480004
074900                '/'                    DELIMITED BY SIZE          07490004
075000                PV-DISPLAY-LINE-NBR    DELIMITED BY SIZE          07500004
075100                               INTO PV-DB2-OPERATION-MESSAGE-2    07510004
075200        MOVE PC251-ERROR-PARA-NBR  TO PV-ABEND-PARAGRAPH          07520004
075300        MOVE PC251-SQL-CODE        TO PV-SQLCODE                  07530004
075400        MOVE 'CALL TO UCC128 CALC PGM '                           07540004
075500                                  TO PV-DB2-OPERATION-MESSAGE-1   07550004
075600        MOVE PC251-ERROR-TABLE-NME                                07560004
075700                            TO PV-DB2-TABLE-NAME                  07570004
075800        PERFORM 9998-CALLED-MOD-ABEND                             07580004
075900     END-EVALUATE.                                                07590004
076000******************************************************************07600004
076100 3100-VALIDATE-LBL-CALC-CALL.                                     07610004
076200                                                                  07620004
076300     MOVE '3100-VALIDATE-LBL-CALC-CALL' TO PV-ABEND-PARAGRAPH.    07630004
076400                                                                  07640004
076500     IF PC251-PRE-PACK-ORDER                                      07650004
076600        IF  PC251-PREPK-UCC128-NO                                 07660004
076700            SET  PS-LNE-UCC128-DATA-NO TO TRUE                    07670004
076800        END-IF                                                    07680004
076900     ELSE                                                         07690004
077000        IF PC251-MULT-OTPK                                        07700004
077100          SET  PS-LNE-UCC128-DATA-NO TO TRUE                      07710004
077200        END-IF                                                    07720004
077300     END-IF                                                       07730004
077400                                                                  07740004
077500       IF PS-LNE-UCC128-DATA-NO                                   07750004
077600          PERFORM 4150-CALCULATE-PROCESS-QTY                      07760004
077700       ELSE                                                       07770004
077800          IF (PV-TRANSCRIBE-SUM NOT = PV-UCC128-TOT-UNTS)         07780004
077900             SET PS-LNE-UCC128-DATA-NO TO TRUE                    07790004
078000             MOVE 'T'   TO PC068-UCC128-IND                       07800004
078100          END-IF                                                  07810004
078200       END-IF.                                                    07820004
078300                                                                  07830004
078400******************************************************************07840004
078500* CHECK FOR RECEIVER LEVEL TROUBLE                               *07850004
078600******************************************************************07860004
078700 3200-GET-TROUBLE-COUNT.                                          07870004
078800                                                                  07880004
078900      MOVE '3200-GET-TROUBLE-COUNT'                               07890004
079000                                 TO PV-ABEND-PARAGRAPH            07900004
079100                                                                  07910004
079200      EXEC SQL                                                    07920004
079300           SELECT A.PO_NBR                                        07930005
079400             INTO :PV-TROUBLE-COUNT                               07940004
079500             FROM TTRBNTF A                                       07950004
079600                 ,TTRBRSN C                                       07960004
079700            WHERE A.PO_NBR       =  :DK-PO-NBR                    07970004
079800              AND A.REC_SEQ_NBR  =  :DK-REC-SEQ-NBR               07980004
079900              AND A.RESOLVED_IND IN ('N','I','R')                 07990004
080000              AND A.TRBL_RSN_CDE = C.TRBL_RSN_CDE                 08000004
080100              AND C.NOTIF_IND    =  'T'                           08010004
080200              AND NOT EXISTS                                      08020004
080300                 ( SELECT *                                       08030004
080400                   FROM  TTRBRCN B                                08040004
080500                   WHERE B.RPT_PGM_NM  = 'PCKCS701'               08050004
080600                     AND A.TRBL_RSN_CDE  =  B.TRBL_RSN_CDE )      08060004
080700           FETCH FIRST 1 ROW ONLY                                 08070005
080800           WITH UR                                                08080004
080900      END-EXEC.                                                   08090004
081000                                                                  08100004
081100      EVALUATE TRUE                                               08110004
081200        WHEN SQLCODE = ZERO                                       08120004
081300           IF PV-TROUBLE-COUNT  >  0                              08130004
081400              SET PS-LNE-TROUBLE-YES TO TRUE                      08140004
081500              MOVE PC068-TOT-CTN-CNT TO PC068-TRBLE-CTN-LINE      08150004
081600           ELSE                                                   08160004
081700              MOVE ZEROES            TO PC068-TRBLE-CTN-LINE      08170004
081800              SET PS-LNE-TROUBLE-NO  TO TRUE                      08180004
081900           END-IF                                                 08190004
082000        WHEN SQLCODE = -305                                       08200004
082010        WHEN SQLCODE = +100                                       08201007
082100             SET  PS-LNE-TROUBLE-NO  TO TRUE                      08210004
082200             MOVE ZEROES             TO PC068-TRBLE-CTN-LINE      08220004
082300        WHEN SQLWARN0 NOT = SPACES                                08230004
082400        WHEN SQLCODE NOT = ZERO                                   08240004
082500          MOVE DK-PO-NBR            TO PV-DISPLAY-PO-NBR          08250004
082600          MOVE DK-REC-SEQ-NBR       TO PV-DISPLAY-RCVR-SEQ        08260004
082700          MOVE DK-PO-LNE-NBR        TO PV-DISPLAY-LINE-NBR        08270004
082800          STRING ' PO/RCVR/LNE '         DELIMITED BY SIZE        08280004
082900                  PV-DISPLAY-PO-NBR      DELIMITED BY SIZE        08290004
083000                  '/'                    DELIMITED BY SIZE        08300004
083100                  PV-DISPLAY-RCVR-SEQ    DELIMITED BY SIZE        08310004
083200                  '/'                    DELIMITED BY SIZE        08320004
083300                  PV-DISPLAY-LINE-NBR    DELIMITED BY SIZE        08330004
083400                                 INTO PV-DB2-OPERATION-MESSAGE-2  08340004
083500          MOVE SQLCODE               TO PV-SQLCODE                08350004
083600          MOVE 'SELECT TROUBLE COUNT'                             08360004
083700                                    TO PV-DB2-OPERATION-MESSAGE-1 08370004
083800          MOVE 'TTRBNTF '     TO PV-DB2-TABLE-NAME                08380004
083900          PERFORM 9999-SQL-ABEND                                  08390004
084000      END-EVALUATE.                                               08400004
084100                                                                  08410004
084200******************************************************************08420004
084300* CHECK FOR TROUBLE AT THE LINE LEVEL                            *08430004
084400******************************************************************08440004
084500 3300-CHECK-LINE-TROUBLE.                                         08450004
084600                                                                  08460004
084700      MOVE '3300-CHECK-LINE-TROUBLE'                              08470004
084800                                 TO PV-ABEND-PARAGRAPH            08480004
084900                                                                  08490004
085000     IF PC068-INNER-PREPK OR PC068-MULTI-PREPK                    08500004
085100        MOVE ZERO          TO DK-PO-LNE-NBR-TEMP                  08510004
085200        MOVE PC068-PACK-ID TO DK-PREPK-ID                         08520004
085300     ELSE                                                         08530004
085400        MOVE DK-PO-LNE-NBR TO DK-PO-LNE-NBR-TEMP                  08540004
085500        MOVE ZERO          TO DK-PREPK-ID                         08550004
085600     END-IF                                                       08560004
085700                                                                  08570004
085800      EXEC SQL                                                    08580004
085900           SELECT   A.PO_NBR                                      08590005
086000             INTO   :PV-TROUBLE-COUNT                             08600004
086100             FROM   TTRBNTF A                                     08610004
086200                   ,TTRBRSN B                                     08620004
086300            WHERE   A.PO_NBR         = :DK-PO-NBR                 08630004
086400              AND   A.REC_SEQ_NBR    = :DK-REC-SEQ-NBR            08640004
086500              AND ((A.PO_LNE_NBR     = :DK-PO-LNE-NBR-TEMP        08650004
086600              AND   B.TRBL_LVL_IND  <> 'M')                       08660004
086700               OR  (A.PREPK_ID       = :DK-PREPK-ID               08670004
086800              AND   B.TRBL_LVL_IND   = 'M'))                      08680004
086900              AND   A.RESOLVED_IND  NOT IN ('A')                  08690004
087000              AND   A.TRBL_RSN_CDE   = B.TRBL_RSN_CDE             08700004
087100              AND   B.NOTIF_IND    =  'T'                         08710004
087200           FETCH FIRST 1 ROW ONLY                                 08720006
087300           WITH UR                                                08730004
087400      END-EXEC.                                                   08740004
087500                                                                  08750004
087600      EVALUATE TRUE                                               08760004
087700        WHEN SQLCODE = ZERO                                       08770004
087800           IF PV-TROUBLE-COUNT  >  0                              08780004
087900              MOVE PC068-TOT-CTN-CNT TO PC068-TRBLE-CTN-LINE      08790004
088000           ELSE                                                   08800004
088100              MOVE ZEROES            TO PC068-TRBLE-CTN-LINE      08810004
088200           END-IF                                                 08820004
088300        WHEN SQLCODE = -305                                       08830004
088310        WHEN SQLCODE = +100                                       08831008
088400             MOVE ZEROES             TO PC068-TRBLE-CTN-LINE      08840008
088500        WHEN SQLWARN0 NOT = SPACES                                08850004
088600        WHEN SQLCODE NOT = ZERO                                   08860004
088700          MOVE DK-PO-NBR            TO PV-DISPLAY-PO-NBR          08870004
088800          MOVE DK-REC-SEQ-NBR       TO PV-DISPLAY-RCVR-SEQ        08880004
088900          MOVE DK-PO-LNE-NBR        TO PV-DISPLAY-LINE-NBR        08890004
089000          STRING ' PO/RCVR/LNE '         DELIMITED BY SIZE        08900004
089100                  PV-DISPLAY-PO-NBR      DELIMITED BY SIZE        08910004
089200                  '/'                    DELIMITED BY SIZE        08920004
089300                  PV-DISPLAY-RCVR-SEQ    DELIMITED BY SIZE        08930004
089400                  '/'                    DELIMITED BY SIZE        08940004
089500                  PV-DISPLAY-LINE-NBR    DELIMITED BY SIZE        08950004
089600                                 INTO PV-DB2-OPERATION-MESSAGE-2  08960004
089700          MOVE SQLCODE               TO PV-SQLCODE                08970004
089800          MOVE 'SELECT TROUBLE COUNT'                             08980004
089900                                    TO PV-DB2-OPERATION-MESSAGE-1 08990004
090000          MOVE 'TTRBNTF '     TO PV-DB2-TABLE-NAME                09000004
090100          PERFORM 9999-SQL-ABEND                                  09010004
090200      END-EVALUATE.                                               09020004
090300                                                                  09030004
090400******************************************************************09040004
090500 4000-GET-TRANSCRIBE.                                             09050004
090600     MOVE '4000-GET-TRANSCRIBE  '                                 09060004
090700                                 TO PV-ABEND-PARAGRAPH            09070004
090800                                                                  09080004
090900     EXEC SQL                                                     09090004
091000        SELECT  SUM(EXPTED_ITM_QTY)                               09100004
091100          INTO :PV-TRANSCRIBE-SUM                                 09110004
091200          FROM  TRECDIS                                           09120004
091300      WHERE ORD_NBR        = :DK-PO-NBR                           09130004
091400        AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR                      09140004
091500        AND ORD_LNE_NBR    = :DK-PO-LNE-NBR                       09150004
091600           WITH UR                                                09160004
091700     END-EXEC.                                                    09170004
091800                                                                  09180004
091900     EVALUATE TRUE                                                09190004
092000       WHEN SQLCODE = ZERO                                        09200004
092100            CONTINUE                                              09210004
092200       WHEN SQLCODE = +100                                        09220004
092300       WHEN SQLCODE = -305                                        09230004
092400            MOVE ZEROES TO PV-TRANSCRIBE-SUM                      09240004
092500       WHEN SQLWARN0 NOT = SPACES                                 09250004
092600       WHEN SQLCODE NOT = ZERO                                    09260004
092700          MOVE DK-PO-NBR            TO PV-DISPLAY-PO-NBR          09270004
092800          MOVE DK-REC-SEQ-NBR       TO PV-DISPLAY-RCVR-SEQ        09280004
092900          MOVE DK-PO-LNE-NBR        TO PV-DISPLAY-LINE-NBR        09290004
093000         STRING ' PO/RCVR/LNE '         DELIMITED BY SIZE         09300004
093100                 PV-DISPLAY-PO-NBR      DELIMITED BY SIZE         09310004
093200                 '/'                    DELIMITED BY SIZE         09320004
093300                 PV-DISPLAY-RCVR-SEQ    DELIMITED BY SIZE         09330004
093400                 '/'                    DELIMITED BY SIZE         09340004
093500                 PV-DISPLAY-LINE-NBR    DELIMITED BY SIZE         09350004
093600                                INTO PV-DB2-OPERATION-MESSAGE-2   09360004
093700         MOVE SQLCODE               TO PV-SQLCODE                 09370004
093800         MOVE 'SELECT TRANSCRIBED QTY '                           09380004
093900                                   TO PV-DB2-OPERATION-MESSAGE-1  09390004
094000         MOVE 'TRECDIS '     TO PV-DB2-TABLE-NAME                 09400004
094100         PERFORM 9999-SQL-ABEND                                   09410004
094200     END-EVALUATE.                                                09420004
094300******************************************************************09430004
094400 4100-GET-OUTER-PK-QTY.                                           09440004
094500     MOVE '4100-GET-OUTER-PK-QTY'                                 09450004
094600                                 TO PV-ABEND-PARAGRAPH            09460004
094700                                                                  09470004
094800                                                                  09480004
094900     EXEC SQL                                                     09490004
095000        SELECT  A.ITM_NBR                                         09500004
095100              , A.CASE_PACK_QTY                                   09510004
095200              , A.PREPK_RATO_QTY                                  09520004
095300              , A.INNR_PACK_QTY                                   09530004
095400              , B.SKU_NBR                                         09540004
095500              , B.OUTR_PK_QTY                                     09550004
095600          INTO :RECITM-ITM-NBR                                    09560004
095700             , :RECITM-CASE-PACK-QTY                              09570004
095800             , :RECITM-PREPK-RATO-QTY                             09580004
095900             , :RECITM-INNR-PACK-QTY                              09590004
096000             , :XLT00003-SKU-NBR                                  09600004
096100             , :XLT00003-OUTR-PK-QTY                              09610004
096200          FROM  TRECITM A                                         09620004
096300             ,  XLT_SKU B                                         09630004
096400      WHERE A.ORD_NBR        = :DK-PO-NBR                         09640004
096500        AND A.REC_SEQ_NBR    = :DK-REC-SEQ-NBR                    09650004
096600        AND A.ORD_LNE_NBR    = :DK-PO-LNE-NBR                     09660004
096700        AND A.VER_STATUS_CDE = 'A'                                09670004
096800        AND A.ITM_NBR        = B.ITM_NBR                          09680004
096900           WITH UR                                                09690004
097000     END-EXEC.                                                    09700004
097100                                                                  09710004
097200     EVALUATE TRUE                                                09720004
097300       WHEN SQLCODE = ZERO                                        09730004
097400            CONTINUE                                              09740004
097500       WHEN SQLCODE = +100                                        09750004
097600       WHEN SQLCODE = -305                                        09760004
097700            MOVE ZEROES TO PV-TRANSCRIBE-SUM                      09770004
097800                           RECITM-CASE-PACK-QTY                   09780004
097900                           RECITM-INNR-PACK-QTY                   09790004
098000       WHEN SQLWARN0 NOT = SPACES                                 09800004
098100       WHEN SQLCODE NOT = ZERO                                    09810004
098200          MOVE DK-PO-NBR            TO PV-DISPLAY-PO-NBR          09820004
098300          MOVE DK-REC-SEQ-NBR       TO PV-DISPLAY-RCVR-SEQ        09830004
098400          MOVE DK-PO-LNE-NBR        TO PV-DISPLAY-LINE-NBR        09840004
098500         STRING ' PO/RCVR/LNE '         DELIMITED BY SIZE         09850004
098600                 PV-DISPLAY-PO-NBR      DELIMITED BY SIZE         09860004
098700                 '/'                    DELIMITED BY SIZE         09870004
098800                 PV-DISPLAY-RCVR-SEQ    DELIMITED BY SIZE         09880004
098900                 '/'                    DELIMITED BY SIZE         09890004
099000                 PV-DISPLAY-LINE-NBR    DELIMITED BY SIZE         09900004
099100                                INTO PV-DB2-OPERATION-MESSAGE-2   09910004
099200         MOVE SQLCODE               TO PV-SQLCODE                 09920004
099300         MOVE 'SELECT TRANSCRIBED QTY '                           09930004
099400                                   TO PV-DB2-OPERATION-MESSAGE-1  09940004
099500         MOVE 'TRECITM '     TO PV-DB2-TABLE-NAME                 09950004
099600         PERFORM 9999-SQL-ABEND                                   09960004
099700     END-EVALUATE.                                                09970004
099800******************************************************************09980004
099900 4150-CALCULATE-PROCESS-QTY.                                      09990004
100000                                                                  10000004
100100     MOVE '4150-CALCULATE-PROCESS-QTY ' TO PV-ABEND-PARAGRAPH.    10010004
100200                                                                  10020004
100300     IF PC068-INNER-PREPK OR PC068-MULTI-PREPK                    10030004
100400       IF RECITM-CASE-PACK-QTY > 0                                10040004
100500        COMPUTE PV-PREPK-OTPK-QTY    =                            10050004
100600                RECITM-CASE-PACK-QTY  *                           10060004
100700                RECITM-PREPK-RATO-QTY                             10070004
100800     END-IF                                                       10080004
100900                                                                  10090004
101000     IF RECITM-CASE-PACK-QTY > 0 AND                              10100004
101100        PV-UCC128-CRTN-CNT   > 0                                  10110004
101200           MULTIPLY  PV-UCC128-CRTN-CNT                           10120004
101300                 BY  RECITM-CASE-PACK-QTY                         10130004
101400               GIVING  PV-PROCESS-QTY                             10140004
101500     END-IF                                                       10150004
101600                                                                  10160004
101700     IF PV-TRANSCRIBE-SUM = PV-PROCESS-QTY                        10170004
101800        CONTINUE                                                  10180004
101900     ELSE                                                         10190004
102000                                                                  10200004
102100       MOVE  ZEROES  TO  PV-CARTON-COUNT-CALC                     10210004
102200                         PV-CARTON-COUNT-REM                      10220004
102300                                                                  10230004
102400       IF  RECITM-CASE-PACK-QTY      >  0                         10240004
102500           DIVIDE  PV-TRANSCRIBE-SUM                              10250004
102600              BY  RECITM-CASE-PACK-QTY                            10260004
102700           GIVING  PV-CARTON-COUNT-CALC                           10270004
102800                   REMAINDER PV-CARTON-COUNT-REM                  10280004
102900           END-DIVIDE                                             10290004
103000                                                                  10300004
103100           IF  PV-CARTON-COUNT-REM  >  +0                         10310004
103200               MOVE PV-UCC128-CRTN-CNT TO PC251-P2L-LBL-CNT       10320004
103300           ELSE                                                   10330004
103400               MOVE PV-CARTON-COUNT-CALC TO PC251-TOTAL-CARTONS   10340004
103500                                            PC251-FCSE-LBL-CNT    10350004
103600           END-IF                                                 10360004
103700                                                                  10370004
103800       END-IF                                                     10380004
103900     END-IF.                                                      10390004
104000                                                                  10400004
104100 4200-GET-TOT-PREPK-UNTS.                                         10410004
104200     MOVE '4200-GET-TOT-PREPK-UNTS'                               10420004
104300                                 TO PV-ABEND-PARAGRAPH            10430004
104400                                                                  10440004
104500                                                                  10450004
104600     EXEC SQL                                                     10460004
104700         SELECT count(*)                                          10470006
104800           INTO :PV-NEW-COUNT-FIELD                               10480006
104900           FROM TRECITM                                           10490004
105000          WHERE ORD_NBR      =  :DK-PO-NBR                        10500004
105100            AND REC_SEQ_NBR  =  :DK-REC-SEQ-NBR                   10510004
105200            AND PREPK_ID     =  :DK-PACK-ID                       10520004
105300           FETCH FIRST 1 ROW ONLY                                 10530005
105400           WITH UR                                                10540004
105500     END-EXEC.                                                    10550004
105600                                                                  10560004
105700     EVALUATE TRUE                                                10570004
105800       WHEN SQLCODE = ZERO                                        10580004
105900            CONTINUE                                              10590004
106000       WHEN SQLCODE = +100                                        10600004
106100       WHEN SQLCODE = -305                                        10610004
106200            MOVE ZEROES TO PV-TRANSCRIBE-SUM                      10620004
106300       WHEN SQLWARN0 NOT = SPACES                                 10630004
106400       WHEN SQLCODE NOT = ZERO                                    10640004
106500          MOVE DK-PO-NBR            TO PV-DISPLAY-PO-NBR          10650004
106600          MOVE DK-REC-SEQ-NBR       TO PV-DISPLAY-RCVR-SEQ        10660004
106700          MOVE DK-PO-LNE-NBR        TO PV-DISPLAY-LINE-NBR        10670004
106800         STRING ' PO/RCVR/LNE '         DELIMITED BY SIZE         10680004
106900                 PV-DISPLAY-PO-NBR      DELIMITED BY SIZE         10690004
107000                 '/'                    DELIMITED BY SIZE         10700004
107100                 PV-DISPLAY-RCVR-SEQ    DELIMITED BY SIZE         10710004
107200                 '/'                    DELIMITED BY SIZE         10720004
107300                 PV-DISPLAY-LINE-NBR    DELIMITED BY SIZE         10730004
107400                                INTO PV-DB2-OPERATION-MESSAGE-2   10740004
107500         MOVE SQLCODE               TO PV-SQLCODE                 10750004
107600         MOVE 'SELECT TRANSCRIBED QTY '                           10760004
107700                                   TO PV-DB2-OPERATION-MESSAGE-1  10770004
107800         MOVE 'TRECITM '     TO PV-DB2-TABLE-NAME                 10780004
107900         PERFORM 9999-SQL-ABEND                                   10790004
108000     END-EVALUATE.                                                10800004
108100******************************************************************10810004
108200******************************************************************10820004
108300 5000-NO-128-CHECK-TRNSCRBD.                                      10830004
108400******************************************************************10840004
108500**WHEN NO UCC128 DATA EXISTS AND THE TRANSCRIBED QTY IS NOT      *10850004
108600**DIVISIBLE BY THE OUTER PACK THIS IS A CSEPK SPLIT ERROR        *10860004
108700**FOR PLANNING PURPOSES THE LINE WILL NOT ERROR OUT AND THE      *10870004
108800**PV-CARTON-COUNT-CALC +1 WILL BE USED                           *10880004
108900******************************************************************10890004
109000                                                                  10900004
109100     MOVE '5000-NO-128-CHECK-TRNSCRBD ' TO PV-ABEND-PARAGRAPH.    10910004
109200                                                                  10920004
109300                                                                  10930004
109400     IF PC068-INNER-PREPK OR PC068-MULTI-PREPK                    10940004
109500        COMPUTE PV-PREPK-OTPK-QTY    =                            10950004
109600                RECITM-CASE-PACK-QTY  *                           10960004
109700                RECITM-PREPK-RATO-QTY                             10970004
109800     END-IF                                                       10980004
109900                                                                  10990004
110000     IF PV-PREPK-OTPK-QTY    = 0                                  11000004
110100        PERFORM 5600-SELECT-AVG-QTY-PARM                          11010004
110200     END-IF                                                       11020004
110300                                                                  11030004
110400     DIVIDE  PV-TRANSCRIBE-SUM                                    11040004
110500         BY  RECITM-CASE-PACK-QTY                                 11050004
110600     GIVING  PV-CARTON-COUNT-CALC                                 11060004
110700                 REMAINDER PV-CARTON-COUNT-REM                    11070004
110800                                                                  11080004
110900     IF PV-CARTON-COUNT-REM > 0                                   11090004
111000        SET PS-OTPK-TRANS-ERROR-YES TO TRUE                       11100004
111100        ADD +1   TO PV-CARTON-COUNT-CALC                          11110004
111200        MOVE PV-CARTON-COUNT-CALC TO PC251-FCSE-LBL-CNT           11120004
111300                                     PC251-TOTAL-CARTONS          11130004
111400        MOVE +0                   TO PC251-P2L-LBL-CNT            11140004
111500     ELSE                                                         11150004
111600        SET PS-OTPK-TRANS-ERROR-NO  TO TRUE                       11160004
111700     END-IF.                                                      11170004
111800                                                                  11180004
111900                                                                  11190004
112000 5100-NO-128-CRTN-CALC.                                           11200004
112100     MOVE '5100-NO-128-CRTN-CALC  ' TO PV-ABEND-PARAGRAPH.        11210004
112200                                                                  11220004
112300     MOVE ZEROES TO                                               11230004
112400                       PV-QUOTIENT                                11240004
112500                       PV-EXPT-REMAINDER                          11250004
112600                       PV-TOT-REMAINDER                           11260004
112700                       PV-SHIP-LNE-TOTAL                          11270004
112800                       PV-FULL-CASE-SHIP-TOTAL                    11280004
112900                       PV-P2L-QUOTIENT                            11290004
113000                       PV-P2L-LNE-TOTAL.                          11300004
113100                                                                  11310004
113200     SET PS-NOT-EOF-TRECDIS-CURSOR TO TRUE.                       11320004
113300     PERFORM 5200-OPEN-TRECDIS-CURSOR.                            11330004
113400     PERFORM 5300-FETCH-TRECDIS-CURSOR                            11340004
113500           UNTIL PS-EOF-TRECDIS-CURSOR.                           11350004
113600     PERFORM 5400-CLOSE-TRECDIS-CURSOR.                           11360004
113700                                                                  11370004
113800                                                                  11380004
113900*----------------------------------------------------------------*11390004
114000*                                                                *11400004
114100*----------------------------------------------------------------*11410004
114200 5200-OPEN-TRECDIS-CURSOR.                                        11420004
114300                                                                  11430004
114400      MOVE '5200-OPEN-TRECDIS-CURSOR' TO PV-ABEND-PARAGRAPH.      11440004
114500                                                                  11450004
114600      EXEC SQL                                                    11460004
114700           OPEN TRECDIS_CSR                                       11470004
114800      END-EXEC.                                                   11480004
114900                                                                  11490004
115000 5300-FETCH-TRECDIS-CURSOR.                                       11500004
115100     MOVE '5300-FETCH-TRECDIS-CURSOR' TO PV-ABEND-PARAGRAPH.      11510004
115200                                                                  11520004
115300     EXEC SQL                                                     11530004
115400          FETCH TRECDIS_CSR                                       11540004
115500           INTO :XLT00010-LOC-NBR                                 11550004
115600              , :RECDIS-EXPTED-ITM-QTY                            11560004
115700              , :XLT00010-LOC-TYP-CDE                             11570004
115800     END-EXEC.                                                    11580004
115900                                                                  11590004
116000     EVALUATE TRUE                                                11600004
116100         WHEN SQLCODE = ZERO                                      11610004
116200            PERFORM 5350-CALCULATE-LBL-QTY                        11620004
116300         WHEN SQLCODE = +100                                      11630004
116400            PERFORM 5360-TOTAL-NON-128-CRTNS                      11640004
116500            SET PS-EOF-TRECDIS-CURSOR TO TRUE                     11650004
116600     END-EVALUATE.                                                11660004
116700                                                                  11670004
116800 5350-CALCULATE-LBL-QTY.                                          11680004
116900                                                                  11690004
117000     MOVE '5350-CALCULATE-LBL-QTY ' TO PV-ABEND-PARAGRAPH.        11700004
117100                                                                  11710004
117200     SET  PS-FULLCASES-ALL-NOT-USED  TO  TRUE.                    11720004
117300     MOVE  ZEROES  TO  PV-STR-P2L-UNT-QTY                         11730004
117400                       PV-STR-FCSE-UNT-QTY                        11740004
117500                       PV-STR-INPK-UNT-QTY                        11750004
117600                       PV-STR-ACTL-UNT-QTY                        11760004
117700                       PV-FCSE-INPK-REMAINDER.                    11770004
117800                                                                  11780004
117900                                                                  11790004
118000                                                                  11800004
118100                                                                  11810004
118200*                                                                 11820004
118300* DETERMINE IF ALLOCATION CAN BE FILLED BY FULLCASE.              11830004
118400*                                                                 11840004
118500                                                                  11850004
118600     IF PS-FULLCASES-ALL-NOT-USED  AND                            11860004
118700        RECITM-CASE-PACK-QTY > 0 and                              11870004
118800        RECDIS-EXPTED-ITM-QTY >  0                                11880004
118900         DIVIDE  RECDIS-EXPTED-ITM-QTY                            11890004
119000             BY  RECITM-CASE-PACK-QTY                             11900004
119100         GIVING  PV-QUOTIENT                                      11910004
119200                 REMAINDER PV-EXPT-REMAINDER                      11920004
119300         END-DIVIDE                                               11930004
119400     ELSE                                                         11940004
119500         MOVE  ZEROES  TO  PV-QUOTIENT                            11950004
119600         MOVE  RECDIS-EXPTED-ITM-QTY  TO  PV-EXPT-REMAINDER       11960004
119700     END-IF.                                                      11970004
119800                                                                  11980004
119900                                                                  11990004
120000     IF  PV-QUOTIENT  =  ZEROES                                   12000004
120100         MOVE RECDIS-EXPTED-ITM-QTY TO  PV-EXPT-REMAINDER         12010004
120200     ELSE                                                         12020004
120300         ADD   PV-QUOTIENT  TO  PV-SHIP-LNE-TOTAL                 12030004
120400                                PV-FULL-CASE-SHIP-TOTAL           12040004
120500                                                                  12050004
120600         MULTIPLY  PV-QUOTIENT                                    12060004
120700               BY  RECITM-CASE-PACK-QTY                           12070004
120800           GIVING  PV-STR-FCSE-UNT-QTY                            12080004
120900     END-IF.                                                      12090004
121000                                                                  12100004
121100                                                                  12110004
121200     IF  PV-EXPT-REMAINDER  >  ZEROES                             12120004
121300             MOVE PV-EXPT-REMAINDER  TO  PV-FCSE-INPK-REMAINDER   12130004
121400     END-IF.                                                      12140004
121500                                                                  12150004
121600     ADD  PV-FCSE-INPK-REMAINDER  TO  PV-TOT-REMAINDER.           12160004
121700                                                                  12170004
121800 5360-TOTAL-NON-128-CRTNS.                                        12180004
121900                                                                  12190004
122000      MOVE '5360-TOTAL-NON-128-CRTNS'  TO PV-ABEND-PARAGRAPH.     12200004
122100      IF PV-EXPT-REMAINDER > 0                                    12210004
122200                  DIVIDE  PV-TOT-REMAINDER                        12220004
122300                      BY  RECITM-CASE-PACK-QTY                    12230004
122400                  GIVING  PV-P2L-QUOTIENT                         12240004
122500                  REMAINDER PV-P2L-REMAINDER                      12250004
122600                  END-DIVIDE                                      12260004
122700      END-IF                                                      12270004
122800                                                                  12280004
122900                                                                  12290004
123000      MOVE  PV-P2L-QUOTIENT          TO  PV-P2L-LNE-TOTAL         12300004
123100      MOVE  PV-P2L-LNE-TOTAL         TO  PC251-P2L-LBL-CNT        12310004
123200                                                                  12320004
123300      MOVE  PV-FULL-CASE-SHIP-TOTAL  TO  PC251-FCSE-LBL-CNT       12330004
123400      COMPUTE PV-TOTAL-CARTON-COUNT =                             12340004
123500              PV-P2L-LNE-TOTAL +  PV-FULL-CASE-SHIP-TOTAL         12350004
123600      MOVE  PV-TOTAL-CARTON-COUNT    TO  PC251-TOTAL-CARTONS.     12360004
123700                                                                  12370004
123800                                                                  12380004
123900 5400-CLOSE-TRECDIS-CURSOR.                                       12390004
124000      MOVE '5400-CLOSE-TRECDIS-CURSOR' TO PV-ABEND-PARAGRAPH.     12400004
124100      EXEC SQL                                                    12410004
124200          CLOSE TRECDIS_CSR                                       12420004
124300      END-EXEC.                                                   12430004
124400                                                                  12440004
124500*-----------------------------------------------------------------12450004
124600* SELECT STORE ZONE FOR P2L CARTONS                               12460004
124700*-----------------------------------------------------------------12470004
124800 5500-SELECT-STORE-ZONE.                                          12480004
124900     MOVE '5500-SELECT-STORE-ZONE ' TO PV-ABEND-PARAGRAPH.        12490004
125000                                                                  12500004
125100     EXEC SQL                                                     12510004
125200         SELECT C.STR_ZN_ID                                       12520004
125300           INTO :MDSEDP-STR-ZN-ID                                 12530004
125400           FROM TPURCHS A,                                        12540004
125500                TMDSEAR B,                                        12550004
125600                TMDSEDP C                                         12560004
125700          WHERE A.PO_NBR         = :DK-PO-NBR                     12570004
125800            AND A.VER_STATUS_CDE = 'A'                            12580004
125900            AND A.DEPT_NBR       = B.DEPT_NBR                     12590004
126000            AND B.MDSELV_CDE     = 'DPT'                          12600004
126100            AND B.OPERCO_NBR     = '03'                           12610004
126200            AND (B.STRT_DTE     <= CURRENT DATE  AND              12620004
126300                 B.END_DTE      >  CURRENT DATE)                  12630004
126400            AND B.MDSEAR_DKEY    = C.MDSEAR_DKEY                  12640004
126500           WITH UR                                                12650004
126600     END-EXEC                                                     12660004
126700                                                                  12670004
126800     EVALUATE TRUE                                                12680004
126900       WHEN SQLCODE = ZERO                                        12690004
127000            CONTINUE                                              12700004
127100       WHEN SQLCODE = +100                                        12710004
127200            MOVE SPACES TO MDSEDP-STR-ZN-ID                       12720004
127300       WHEN SQLWARN0 NOT = SPACES                                 12730004
127400       WHEN SQLCODE NOT = ZERO                                    12740004
127500          MOVE DK-PO-NBR            TO PV-DISPLAY-PO-NBR          12750004
127600          MOVE DK-REC-SEQ-NBR       TO PV-DISPLAY-RCVR-SEQ        12760004
127700          MOVE DK-PO-LNE-NBR        TO PV-DISPLAY-LINE-NBR        12770004
127800         STRING ' PO/RCVR/LNE '         DELIMITED BY SIZE         12780004
127900                 PV-DISPLAY-PO-NBR      DELIMITED BY SIZE         12790004
128000                 '/'                    DELIMITED BY SIZE         12800004
128100                 PV-DISPLAY-RCVR-SEQ    DELIMITED BY SIZE         12810004
128200                 '/'                    DELIMITED BY SIZE         12820004
128300                 PV-DISPLAY-LINE-NBR    DELIMITED BY SIZE         12830004
128400                                INTO PV-DB2-OPERATION-MESSAGE-2   12840004
128500         MOVE SQLCODE               TO PV-SQLCODE                 12850004
128600         MOVE 'SELECT STORE ZONE  '                               12860004
128700                                   TO PV-DB2-OPERATION-MESSAGE-1  12870004
128800         MOVE 'TMDSEDP '     TO PV-DB2-TABLE-NAME                 12880004
128900         PERFORM 9999-SQL-ABEND                                   12890004
129000     END-EVALUATE.                                                12900004
129100                                                                  12910004
129200                                                                  12920004
129300*-----------------------------------------------------------------12930004
129400* DETERMINE HOW THE DC IS SET UP TO PROCESS FREIGHT IN P2L       *12940004
129500* DMH ADDED 6/25/12 - WR-40826                                   *12950004
129600*                                                                 12960004
129700*** CHECK HOW DC IS PROCESSING P2L FREIGHT                        12970004
129800***       HANG/FOLD   (COMBINE ZONES: CHILD, MENS,JRS, WOMEN)     12980004
129900***       HANG/COMMODITY                                          12990004
130000***       COMMODITY                                               13000004
130100*** IF HANG/FOLD OR HANG/COMMODITY THE DEFAULT STORE ZONE TO      13010004
130200*** TO BE DISPLAYED WOULD BE FOR WHATEVER ZONE WOULD HAVE THE     13020004
130300*** MOST LINES:                                                   13030004
130400*** EX: RECEIVER HAS 5 LINES. 3 LINES ARE HANG 2 LINES ARE FOLD   13040004
130500***     THE DEFAULT STORE ZONE WOULD BE HANG                      13050004
130600*                                                                 13060004
130700*                                                                 13070004
130800*   1.  COUNT THE NUMBER OF RCVR LINES WITH HANG PRESENTATION     13080004
130900*   2.  COUNT THE NUMBER OF RCVR LINES WITH FOLD PRESENTATION     13090004
131000*   3.  COUNT THE NUMBER OF RCVR LINES WITH OTHER PRESENTATION    13100004
131100*   4.  GET GOH_IND (GOODS ON HAND FROM RECEIVER)                 13110004
131200*       Y=VENDOR HANG AGREEMENT   N=NO VENDOR HANG AGREEMENT      13120004
131300*                                                                 13130004
131400*   IF DC IS PROCESSING P2L AS HANG/FOLD  AND                     13140004
131500*      STORE ZONE FOR RECEIVER = CHILD, JRS, MENS, WOMEN          13150004
131600*          IF GOH-IND = Y    ADD OTHER-COUNT TO HANG-COUNT        13160004
131700*          IF GOH-IND = N    ADD OTHER-COUNT TO FOLD-COUNT        13170004
131800*      IF HANG-COUNT >  FOLD-COUNT =====  STORE-ZONE HANG         13180004
131900*         ELSE                                                    13190004
132000*      STORE-ZONE FOR P2L WILL BE FOLD                            13200004
132100*                                                                 13210004
132200* ELSE                                                            13220004
132300*                                                                 13230004
132400*   IF DC IS PROCESSING P2L AS HANG/COMMODITY AND                 13240004
132500*      STORE ZONE FOR RECEIVER = CHILD, JRS, MENS, WOMEN          13250004
132600*          IF GOH-IND = Y    ADD OTHER-COUNT TO HANG-COUNT        13260004
132700*          IF GOH-IND = N    ADD OTHER-COUNT TO COMMODITY-COUNT   13270004
132800*      IF HANG-COUNT >  COMMODITY-COUNT =====  STORE-ZONE HANG    13280004
132900*         ELSE                                                    13290004
133000*      STORE-ZONE FOR P2L WILL BE COMMODITY                       13300004
133100*                                                                 13310004
133200*-----------------------------------------------------------------13320004
133300 5510-DC-P2L-PROCESSING.                                          13330004
133400                                                                  13340004
133500*                                                                 13350004
133600***  how is DC processing store zones in P2L?                     13360004
133700*                                                                 13370004
133800     PERFORM 5515-CHECK-P2L-ZONES.                                13380004
133900                                                                  13390004
134000*                                                                 13400004
134100*** which store zones are able to be processed as Hang/Fold       13410004
134200*** initially set up as CHILD, MENS, JRS, WOMEN                   13420004
134300*                                                                 13430004
134400     IF  PV-HANG-FOLD       OR                                    13440004
134500         PV-HANG-COMMODITY                                        13450004
134600         PERFORM 5520-CHECK-HANG-FOLD                             13460004
134700     END-IF.                                                      13470004
134800                                                                  13480004
134900*                                                                 13490004
135000*** if DC is processing Store Zones as Hang/Fold, determine if    13500004
135100*** there is a vendor agreement for hangers                       13510004
135200*                                                                 13520004
135300     IF  PV-HANG-FOLD       OR                                    13530004
135400         PV-HANG-COMMODITY                                        13540004
135500         PERFORM 5523-CHECK-HANG-AGREEMENT                        13550004
135600     END-IF.                                                      13560004
135700                                                                  13570004
135800*                                                                 13580004
135900*** count how many lines on the rcvr have hang presentation       13590004
136000*                                                                 13600004
136100     IF  PV-HANG-FOLD       OR                                    13610004
136200         PV-HANG-COMMODITY                                        13620004
136300         PERFORM 5525-COUNT-HANG                                  13630004
136400     END-IF.                                                      13640004
136500                                                                  13650004
136600*                                                                 13660004
136700*** count how many lines on the rcvr have fold presentation       13670004
136800*                                                                 13680004
136900     IF  PV-HANG-FOLD                                             13690004
137000         PERFORM 5530-COUNT-FOLD                                  13700004
137100     END-IF.                                                      13710004
137200                                                                  13720004
137300*                                                                 13730004
137400*** count how many lines on the receiver have items commodity     13740004
137500*                                                                 13750004
137600     IF  PV-HANG-COMMODITY                                        13760004
137700         PERFORM 5535-COUNT-COMMODITY                             13770004
137800     END-IF.                                                      13780004
137900                                                                  13790004
138000*                                                                 13800004
138100* count how many lines on the rcvr not h/f presentation           13810004
138200*                                                                 13820004
138300     IF  PV-HANG-FOLD                                             13830004
138400         PERFORM 5540-COUNT-OTHER                                 13840004
138500     END-IF.                                                      13850004
138600                                                                  13860004
138700*                                                                 13870004
138800* DC PROCESSING P2L AS HANG/FOLD                                  13880004
138900* VENDOR HANGER AGREEMENT (GOH-IND = Y) ADD OTHER TO HANG-COUNT   13890004
139000*                                                                 13900004
139100* DC PROCESSING P2L AS HANG/FOLD                                  13910004
139200* VENDOR HANGER AGREEMENT (GOH-IND = N) ADD OTHER TO FOLD-COUNT   13920004
139300*                                                                 13930004
139400     IF  PV-HANG-FOLD                                             13940004
139500         IF  PV-HANGER-AGREEMENT                                  13950004
139600             ADD  PV-OTHER-COUNT  TO  PV-HANG-COUNT               13960004
139700             MOVE ZEROES          TO  PV-OTHER-COUNT              13970004
139800         ELSE                                                     13980004
139900             ADD  PV-OTHER-COUNT  TO  PV-FOLD-COUNT               13990004
140000             MOVE ZEROES          TO  PV-OTHER-COUNT              14000004
140100         END-IF                                                   14010004
140200     END-IF.                                                      14020004
140300                                                                  14030004
140400*                                                                 14040004
140500* DC PROCESSING P2L AS HANG/COMMODITY                             14050004
140600* VENDOR HANGER AGREEMENT (GOH-IND = Y) ADD OTHER TO HANG-COUNT   14060004
140700*                                                                 14070004
140800     IF  PV-HANG-COMMODITY                                        14080004
140900         IF  PV-HANGER-AGREEMENT                                  14090004
141000             ADD  PV-OTHER-COUNT  TO  PV-HANG-COUNT               14100004
141100             MOVE ZEROES          TO  PV-OTHER-COUNT              14110004
141200         END-IF                                                   14120004
141300     END-IF.                                                      14130004
141400                                                                  14140004
141500*                                                                 14150004
141600***  IF  DC IS PROCESSING P2L AS HANG/FOLD                        14160004
141700***       IF  HANG-COUNT >=  FOLD COUNT                           14170004
141800***           STORE ZONE WILL BE "HANG"                           14180004
141900***       OHERWISE                                                14190004
142000***           STORE ZONE WILL BE "FOLD"                           14200004
142100*                                                                 14210004
142200     IF  PV-HANG-FOLD                                             14220004
142300                                                                  14230004
142400         IF  PV-HANG-COUNT  >  PV-FOLD-COUNT  OR                  14240004
142500             PV-HANG-COUNT  =  PV-FOLD-COUNT                      14250004
142600             MOVE  'HANG'  TO  PC068-STORE-ZONE                   14260004
142700         ELSE                                                     14270004
142800             MOVE  'FOLD'  TO  PC068-STORE-ZONE                   14280004
142900         END-IF                                                   14290004
143000     END-IF.                                                      14300004
143100                                                                  14310004
143200*                                                                 14320004
143300***  IF  DC IS PROCESSING P2L AS HANG/COMMODITY                   14330004
143400***       IF  HANG-COUNT >=  COMMODITY COUNT                      14340004
143500***           STORE ZONE WILL BE "HANG"                           14350004
143600***       OHERWISE                                                14360004
143700***           STORE ZONE WILL BE COMMODITY                        14370004
143800*                                                                 14380004
143900     IF  PV-HANG-COMMODITY                                        14390004
144000         IF  PV-HANG-COUNT  >  PV-COMMODITY-COUNT  OR             14400004
144100             PV-HANG-COUNT  =  PV-COMMODITY-COUNT                 14410004
144200             MOVE  'HANG'  TO  PC068-STORE-ZONE                   14420004
144300         END-IF                                                   14430004
144400     END-IF.                                                      14440004
144500                                                                  14450004
144600                                                                  14460004
144700*----------------------------------------------------------------*14470004
144800* CHECK TO SEE HOW THE DC IS PROCESSING PACK-TO-LIGHT FREIGHT    *14480004
144900*        HANG/FOLD -OR- HANG/COMMODITY -OR- COMMODITY            *14490004
145000* DMH ADDED 6/26/12                                              *14500004
145100*----------------------------------------------------------------*14510004
145200 5515-CHECK-P2L-ZONES.                                            14520004
145300                                                                  14530004
145400     MOVE  PC068-OPER-UNT-ID  TO  DK-OPER-UNT-ID.                 14540004
145500                                                                  14550004
145600     EXEC SQL                                                     14560004
145700          SELECT  FUNC_TXT                                        14570004
145800            INTO :PV-P2L-ZONE                                     14580004
145900            FROM  TKRPRPM                                         14590004
146000           WHERE  LOC_ID            = :DK-OPER-UNT-ID             14600004
146100             AND  SYS_PRC_FUNC_CDE  = 'P2LZON'                    14610004
146200             AND  INTFC_SYS_CDE     = 'KHL'                       14620004
146300             AND  FUNC_PRC_STAT_CDE = 'AC'                        14630004
146400             AND  FUNC_BEG_TMST    <=  CURRENT TIMESTAMP          14640004
146500             AND  FUNC_END_TMST    >=  CURRENT TIMESTAMP          14650004
146600           WITH UR                                                14660004
146700     END-EXEC                                                     14670004
146800                                                                  14680004
146900     EVALUATE TRUE                                                14690004
147000         WHEN SQLCODE = +0                                        14700004
147100              CONTINUE                                            14710004
147200         WHEN SQLCODE = +100                                      14720004
147300              SET  PV-COMMODITY     TO  TRUE                      14730004
147400         WHEN SQLWARN0 NOT = SPACES                               14740004
147500         WHEN SQLCODE NOT = ZERO                                  14750004
147600              MOVE DK-PO-NBR            TO PV-DISPLAY-PO-NBR      14760004
147700              MOVE DK-REC-SEQ-NBR       TO PV-DISPLAY-RCVR-SEQ    14770004
147800              MOVE DK-PO-LNE-NBR        TO PV-DISPLAY-LINE-NBR    14780004
147900              STRING ' PO/RCVR/LNE '                              14790004
148000                       PV-DISPLAY-PO-NBR                          14800004
148100                     '/'                                          14810004
148200                       PV-DISPLAY-RCVR-SEQ                        14820004
148300                     '/'                                          14830004
148400                       PV-DISPLAY-LINE-NBR    DELIMITED BY SIZE   14840004
148500                                 INTO PV-DB2-OPERATION-MESSAGE-2  14850004
148600              MOVE SQLCODE               TO PV-SQLCODE            14860004
148700              MOVE 'CHECK P2L ZONE SETUP'                         14870004
148800                                   TO PV-DB2-OPERATION-MESSAGE-1  14880004
148900              MOVE 'TKRPRPM '     TO PV-DB2-TABLE-NAME            14890004
149000             PERFORM 9999-SQL-ABEND                               14900004
149100     END-EVALUATE.                                                14910004
149200                                                                  14920004
149300                                                                  14930004
149400*----------------------------------------------------------------*14940004
149500* CHECK TO SEE IF THE DEFAULT STORE ZONE IS ONE OF THE ZONES     *14950004
149600* SETUP FOR HANG/FOLD OR HANG/COMMODITY                          *14960004
149700* DMH ADDED 6/26/12                                              *14970004
149800*----------------------------------------------------------------*14980004
149900 5520-CHECK-HANG-FOLD.                                            14990004
150000                                                                  15000004
150100     EXEC SQL                                                     15010004
150200          SELECT                                                  15020004
150300                   E.ATTR_ELEM_TXT  AS STORE_ZONE                 15030004
150400            INTO :WST00010-ATTR-ELEM-TXT                          15040004
150500            FROM                                                  15050004
150600                   WST_INTGRTN_TYP  A                             15060004
150700               ,   WST_ATTR_DEFN    B                             15070004
150800               ,   WST_ATTR_ELEM    C                             15080004
150900               ,   WST_ATTR_ELEM    D                             15090004
151000               ,   WST_ATTR_ELEM    E                             15100004
151100               ,   WST_ATTR_ELEM    F                             15110004
151200               ,   WST_ATTR_ELEM    G                             15120004
151300            WHERE                                                 15130004
151400                  A.INTGRTN_TYP_CDE   = 'P2LHNGFLD'               15140004
151500              AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE         15150004
151600              AND B.ATTR_DEFN_SEQ_NBR = 1                         15160004
151700              AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE         15170004
151800              AND C.ATTR_DEFN_SEQ_NBR = 1                         15180004
151900              AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE         15190004
152000              AND D.ATTR_DEFN_SEQ_NBR = 2                         15200004
152100              AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE         15210004
152200              AND E.ATTR_DEFN_SEQ_NBR = 3                         15220004
152300              AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE         15230004
152400              AND F.ATTR_DEFN_SEQ_NBR = 4                         15240004
152500              AND B.INTGRTN_TYP_CDE   = G.INTGRTN_TYP_CDE         15250004
152600              AND G.ATTR_DEFN_SEQ_NBR = 5                         15260004
152700              AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR       15270004
152800              AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR       15280004
152900              AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR       15290004
153000              AND C.ATTR_ELEM_SEQ_NBR = G.ATTR_ELEM_SEQ_NBR       15300004
153100              AND C.ATTR_ELEM_NBR     =  90                       15310004
153200              AND D.ATTR_ELEM_TXT     = 'P2L'                     15320004
153300              AND F.ATTR_ELEM_TMST   <=  CURRENT TIMESTAMP        15330004
153400              AND G.ATTR_ELEM_TMST   >=  CURRENT TIMESTAMP        15340004
153500              AND E.ATTR_ELEM_TXT     = :MDSEDP-STR-ZN-ID         15350004
153600           WITH UR                                                15360004
153700     END-EXEC.                                                    15370004
153800                                                                  15380004
153900     EVALUATE TRUE                                                15390004
154000         WHEN SQLCODE = +0                                        15400004
154100              CONTINUE                                            15410004
154200         WHEN SQLCODE = +100                                      15420004
154300              SET  PV-COMMODITY     TO  TRUE                      15430004
154400         WHEN SQLWARN0 NOT = SPACES                               15440004
154500         WHEN SQLCODE NOT = ZERO                                  15450004
154600              MOVE DK-PO-NBR            TO PV-DISPLAY-PO-NBR      15460004
154700              MOVE DK-REC-SEQ-NBR       TO PV-DISPLAY-RCVR-SEQ    15470004
154800              MOVE DK-PO-LNE-NBR        TO PV-DISPLAY-LINE-NBR    15480004
154900              STRING ' PO/RCVR/LNE '                              15490004
155000                       PV-DISPLAY-PO-NBR                          15500004
155100                     '/'                                          15510004
155200                       PV-DISPLAY-RCVR-SEQ                        15520004
155300                     '/'                                          15530004
155400                       PV-DISPLAY-LINE-NBR    DELIMITED BY SIZE   15540004
155500                                 INTO PV-DB2-OPERATION-MESSAGE-2  15550004
155600              MOVE SQLCODE               TO PV-SQLCODE            15560004
155700              MOVE 'CHECK IF STR ZNE SETUP FOR HANG/FOLD'         15570004
155800                                   TO PV-DB2-OPERATION-MESSAGE-1  15580004
155900              MOVE 'WST00010'     TO PV-DB2-TABLE-NAME            15590004
156000             PERFORM 9999-SQL-ABEND                               15600004
156100                                                                  15610004
156200     END-EVALUATE.                                                15620004
156300                                                                  15630004
156400                                                                  15640004
156500*----------------------------------------------------------------*15650004
156600* CHECK TO SEE if there is a Hanger Agreement for this reciever  *15660004
156700* DMH ADDED 6/26/12                                              *15670004
156800*----------------------------------------------------------------*15680004
156900 5523-CHECK-HANG-AGREEMENT.                                       15690004
157000                                                                  15700004
157100     EXEC SQL                                                     15710004
157200          SELECT  GOH_IND                                         15720004
157300            INTO :PV-HANGER-IND                                   15730004
157400            FROM TRECEIV                                          15740004
157500           WHERE ORD_NBR           = :DK-PO-NBR                   15750004
157600             AND REC_SEQ_NBR       = :DK-REC-SEQ-NBR              15760004
157700            WITH UR                                               15770004
157800     END-EXEC.                                                    15780004
157900                                                                  15790004
158000     EVALUATE TRUE                                                15800004
158100         WHEN SQLCODE = +0                                        15810004
158200              CONTINUE                                            15820004
158300         WHEN SQLCODE = +100                                      15830004
158400              CONTINUE                                            15840004
158500         WHEN SQLWARN0 NOT = SPACES                               15850004
158600         WHEN SQLCODE NOT = ZERO                                  15860004
158700              MOVE DK-PO-NBR            TO PV-DISPLAY-PO-NBR      15870004
158800              MOVE DK-REC-SEQ-NBR       TO PV-DISPLAY-RCVR-SEQ    15880004
158900              MOVE DK-PO-LNE-NBR        TO PV-DISPLAY-LINE-NBR    15890004
159000              STRING ' PO/RCVR/LNE '                              15900004
159100                       PV-DISPLAY-PO-NBR                          15910004
159200                     '/'                                          15920004
159300                       PV-DISPLAY-RCVR-SEQ                        15930004
159400                     '/'                                          15940004
159500                       PV-DISPLAY-LINE-NBR    DELIMITED BY SIZE   15950004
159600                                 INTO PV-DB2-OPERATION-MESSAGE-2  15960004
159700              MOVE SQLCODE               TO PV-SQLCODE            15970004
159800              MOVE 'GET HANGER AGREEMENT FOR THE RECEIVER'        15980004
159900                                   TO PV-DB2-OPERATION-MESSAGE-1  15990004
160000              MOVE 'TRECEIV '     TO PV-DB2-TABLE-NAME            16000004
160100             PERFORM 9999-SQL-ABEND                               16010004
160200                                                                  16020004
160300     END-EVALUATE.                                                16030004
160400                                                                  16040004
160500                                                                  16050004
160600                                                                  16060004
160700                                                                  16070004
160800                                                                  16080004
160900*----------------------------------------------------------------*16090004
161000* CHECK TO SEE WHICH ZONE HAS MORE LINES.  THAT WILL BECOME THE  *16100004
161100* DEFAULT FOR THIS ORDER  --- COUNTS THE NUMBER OF HANG LINES    *16110004
161200* DMH ADDED 6/26/12                                              *16120004
161300*----------------------------------------------------------------*16130004
161400 5525-COUNT-HANG.                                                 16140004
161500                                                                  16150004
161600     EXEC SQL                                                     16160004
161700          SELECT COUNT(*)                                         16170004
161800            INTO :PV-HANG-COUNT                                   16180004
161900            FROM TRECITM A                                        16190004
162000                ,TPURITM B                                        16200004
162100                ,XLT_SKU C                                        16210004
162200                ,XLT_VND_STYL D                                   16220004
162300           WHERE A.ORD_NBR           = :DK-PO-NBR                 16230004
162400             AND A.REC_SEQ_NBR       = :DK-REC-SEQ-NBR            16240004
162500             AND A.ORD_NBR           = B.PO_NBR                   16250004
162600             AND A.ORD_LNE_NBR       = B.APP_PO_LNE_NBR           16260004
162700             AND A.VER_STATUS_CDE    = 'A'                        16270004
162800             AND A.PO_VER_NBR        = B.VER_NBR                  16280004
162900             AND B.ITM_NBR           = C.ITM_NBR                  16290004
163000             AND C.STYL_ID           = D.STYL_ID                  16300004
163100             AND D.HNG_FOLD_DESC     = 'HANG'                     16310004
163200           WITH UR                                                16320004
163300     END-EXEC.                                                    16330004
163400                                                                  16340004
163500     EVALUATE TRUE                                                16350004
163600         WHEN SQLCODE = +0                                        16360004
163700              CONTINUE                                            16370004
163800         WHEN SQLCODE = +100                                      16380004
163900              MOVE ZERO              TO  PV-HANG-COUNT            16390004
164000         WHEN SQLWARN0 NOT = SPACES                               16400004
164100         WHEN SQLCODE NOT = ZERO                                  16410004
164200              MOVE DK-PO-NBR            TO PV-DISPLAY-PO-NBR      16420004
164300              MOVE DK-REC-SEQ-NBR       TO PV-DISPLAY-RCVR-SEQ    16430004
164400              MOVE DK-PO-LNE-NBR        TO PV-DISPLAY-LINE-NBR    16440004
164500              STRING ' PO/RCVR/LNE '                              16450004
164600                       PV-DISPLAY-PO-NBR                          16460004
164700                     '/'                                          16470004
164800                       PV-DISPLAY-RCVR-SEQ                        16480004
164900                     '/'                                          16490004
165000                       PV-DISPLAY-LINE-NBR    DELIMITED BY SIZE   16500004
165100                                 INTO PV-DB2-OPERATION-MESSAGE-2  16510004
165200              MOVE SQLCODE               TO PV-SQLCODE            16520004
165300              MOVE 'COUNT THE NUMBER OF LINE FOR HANG  '          16530004
165400                                   TO PV-DB2-OPERATION-MESSAGE-1  16540004
165500              MOVE 'TRECITM TPURITM XLT00003  XLT00004 '          16550004
165600                                   TO PV-DB2-OPERATION-MESSAGE-2  16560004
165700              MOVE 'TRECITM '     TO PV-DB2-TABLE-NAME            16570004
165800             PERFORM 9999-SQL-ABEND                               16580004
165900                                                                  16590004
166000     END-EVALUATE.                                                16600004
166100                                                                  16610004
166200                                                                  16620004
166300*----------------------------------------------------------------*16630004
166400* CHECK TO SEE WHICH ZONE HAS MORE LINES.  THAT WILL BECOME THE  *16640004
166500* DEFAULT FOR THIS ORDER  --- COUNTS THE NUMBER OF FOLD LINES    *16650004
166600* DMH ADDED 6/26/12                                              *16660004
166700*----------------------------------------------------------------*16670004
166800 5530-COUNT-FOLD.                                                 16680004
166900                                                                  16690004
167000     EXEC SQL                                                     16700004
167100          SELECT COUNT(*)                                         16710004
167200            INTO :PV-FOLD-COUNT                                   16720004
167300            FROM TRECITM A                                        16730004
167400                ,TPURITM B                                        16740004
167500                ,XLT_SKU C                                        16750004
167600                ,XLT_VND_STYL D                                   16760004
167700           WHERE A.ORD_NBR           = :DK-PO-NBR                 16770004
167800             AND A.REC_SEQ_NBR       = :DK-REC-SEQ-NBR            16780004
167900             AND A.ORD_NBR           = B.PO_NBR                   16790004
168000             AND A.ORD_LNE_NBR       = B.APP_PO_LNE_NBR           16800004
168100             AND A.VER_STATUS_CDE    = 'A'                        16810004
168200             AND A.PO_VER_NBR        = B.VER_NBR                  16820004
168300             AND B.ITM_NBR           = C.ITM_NBR                  16830004
168400             AND C.STYL_ID           = D.STYL_ID                  16840004
168500             AND D.HNG_FOLD_DESC     = 'FOLD'                     16850004
168600           WITH UR                                                16860004
168700     END-EXEC.                                                    16870004
168800                                                                  16880004
168900     EVALUATE TRUE                                                16890004
169000         WHEN SQLCODE = +0                                        16900004
169100              CONTINUE                                            16910004
169200         WHEN SQLCODE = +100                                      16920004
169300              MOVE ZERO              TO  PV-HANG-COUNT            16930004
169400         WHEN SQLWARN0 NOT = SPACES                               16940004
169500         WHEN SQLCODE NOT = ZERO                                  16950004
169600              MOVE DK-PO-NBR            TO PV-DISPLAY-PO-NBR      16960004
169700              MOVE DK-REC-SEQ-NBR       TO PV-DISPLAY-RCVR-SEQ    16970004
169800              MOVE DK-PO-LNE-NBR        TO PV-DISPLAY-LINE-NBR    16980004
169900              STRING ' PO/RCVR/LNE '                              16990004
170000                       PV-DISPLAY-PO-NBR                          17000004
170100                     '/'                                          17010004
170200                       PV-DISPLAY-RCVR-SEQ                        17020004
170300                     '/'                                          17030004
170400                       PV-DISPLAY-LINE-NBR    DELIMITED BY SIZE   17040004
170500                                 INTO PV-DB2-OPERATION-MESSAGE-2  17050004
170600              MOVE SQLCODE               TO PV-SQLCODE            17060004
170700              MOVE 'COUNT THE NUMBER OF LINE FOR FOLD  '          17070004
170800                                   TO PV-DB2-OPERATION-MESSAGE-1  17080004
170900              MOVE 'TRECITM TPURITM XLT00003  XLT00004 '          17090004
171000                                   TO PV-DB2-OPERATION-MESSAGE-2  17100004
171100              MOVE 'TRECITM '     TO PV-DB2-TABLE-NAME            17110004
171200             PERFORM 9999-SQL-ABEND                               17120004
171300                                                                  17130004
171400     END-EVALUATE.                                                17140004
171500                                                                  17150004
171600                                                                  17160004
171700*----------------------------------------------------------------*17170004
171800* CHECK TO SEE WHICH ZONE HAS MORE LINES.  THAT WILL BECOME THE  *17180004
171900* DEFAULT FOR THIS ORDER  --- COUNTS THE NUMBER OF <> HANG LINES *17190004
172000* DMH ADDED 6/26/12                                              *17200004
172100*----------------------------------------------------------------*17210004
172200 5535-COUNT-COMMODITY.                                            17220004
172300                                                                  17230004
172400     EXEC SQL                                                     17240004
172500          SELECT COUNT(*)                                         17250004
172600            INTO :PV-COMMODITY-COUNT                              17260004
172700            FROM TRECITM A                                        17270004
172800                ,TPURITM B                                        17280004
172900                ,XLT_SKU C                                        17290004
173000                ,XLT_VND_STYL D                                   17300004
173100           WHERE A.ORD_NBR           = :DK-PO-NBR                 17310004
173200             AND A.REC_SEQ_NBR       = :DK-REC-SEQ-NBR            17320004
173300             AND A.ORD_NBR           = B.PO_NBR                   17330004
173400             AND A.ORD_LNE_NBR       = B.APP_PO_LNE_NBR           17340004
173500             AND A.VER_STATUS_CDE    = 'A'                        17350004
173600             AND A.PO_VER_NBR        = B.VER_NBR                  17360004
173700             AND B.ITM_NBR           = C.ITM_NBR                  17370004
173800             AND C.STYL_ID           = D.STYL_ID                  17380004
173900             AND D.HNG_FOLD_DESC    <> 'HANG'                     17390004
174000           WITH UR                                                17400004
174100     END-EXEC.                                                    17410004
174200                                                                  17420004
174300     EVALUATE TRUE                                                17430004
174400         WHEN SQLCODE = +0                                        17440004
174500              CONTINUE                                            17450004
174600         WHEN SQLCODE = +100                                      17460004
174700              MOVE ZERO              TO  PV-HANG-COUNT            17470004
174800         WHEN SQLWARN0 NOT = SPACES                               17480004
174900         WHEN SQLCODE NOT = ZERO                                  17490004
175000              MOVE DK-PO-NBR            TO PV-DISPLAY-PO-NBR      17500004
175100              MOVE DK-REC-SEQ-NBR       TO PV-DISPLAY-RCVR-SEQ    17510004
175200              MOVE DK-PO-LNE-NBR        TO PV-DISPLAY-LINE-NBR    17520004
175300              STRING ' PO/RCVR/LNE '                              17530004
175400                       PV-DISPLAY-PO-NBR                          17540004
175500                     '/'                                          17550004
175600                       PV-DISPLAY-RCVR-SEQ                        17560004
175700                     '/'                                          17570004
175800                       PV-DISPLAY-LINE-NBR    DELIMITED BY SIZE   17580004
175900                                 INTO PV-DB2-OPERATION-MESSAGE-2  17590004
176000              MOVE SQLCODE               TO PV-SQLCODE            17600004
176100              MOVE 'COUNT THE NUMBER OF LINE FOR COMMODITY'       17610004
176200                                   TO PV-DB2-OPERATION-MESSAGE-1  17620004
176300              MOVE 'TRECITM TPURITM XLT00003  XLT00004 '          17630004
176400                                   TO PV-DB2-OPERATION-MESSAGE-2  17640004
176500              MOVE 'TRECITM '     TO PV-DB2-TABLE-NAME            17650004
176600             PERFORM 9999-SQL-ABEND                               17660004
176700                                                                  17670004
176800     END-EVALUATE.                                                17680004
176900                                                                  17690004
177000                                                                  17700004
177100*----------------------------------------------------------------*17710004
177200* CHECK TO SEE HOW MANY LINES HAVE SOMETHING OTHER THAN HANG OR  *17720004
177300* FOLD                                                           *17730004
177400* DMH ADDED 6/26/12                                              *17740004
177500*----------------------------------------------------------------*17750004
177600 5540-COUNT-OTHER.                                                17760004
177700                                                                  17770004
177800     EXEC SQL                                                     17780004
177900          SELECT COUNT(*)                                         17790004
178000            INTO :PV-OTHER-COUNT                                  17800004
178100            FROM TRECITM A                                        17810004
178200                ,TPURITM B                                        17820004
178300                ,XLT_SKU C                                        17830004
178400                ,XLT_VND_STYL D                                   17840004
178500           WHERE A.ORD_NBR            =  :DK-PO-NBR               17850004
178600             AND A.REC_SEQ_NBR        =  :DK-REC-SEQ-NBR          17860004
178700             AND A.ORD_NBR            =  B.PO_NBR                 17870004
178800             AND A.ORD_LNE_NBR        =  B.APP_PO_LNE_NBR         17880004
178900             AND A.VER_STATUS_CDE     =  'A'                      17890004
179000             AND A.PO_VER_NBR         =  B.VER_NBR                17900004
179100             AND B.ITM_NBR            =  C.ITM_NBR                17910004
179200             AND C.STYL_ID            =  D.STYL_ID                17920004
179300             AND NOT D.HNG_FOLD_DESC IN ('FOLD', 'HANG')          17930004
179400           WITH UR                                                17940004
179500     END-EXEC.                                                    17950004
179600                                                                  17960004
179700     EVALUATE TRUE                                                17970004
179800         WHEN SQLCODE = +0                                        17980004
179900              CONTINUE                                            17990004
180000         WHEN SQLCODE = +100                                      18000004
180100              MOVE ZERO              TO  PV-OTHER-COUNT           18010004
180200         WHEN SQLWARN0 NOT = SPACES                               18020004
180300         WHEN SQLCODE NOT = ZERO                                  18030004
180400              MOVE DK-PO-NBR            TO PV-DISPLAY-PO-NBR      18040004
180500              MOVE DK-REC-SEQ-NBR       TO PV-DISPLAY-RCVR-SEQ    18050004
180600              MOVE DK-PO-LNE-NBR        TO PV-DISPLAY-LINE-NBR    18060004
180700              STRING ' PO/RCVR/LNE '                              18070004
180800                       PV-DISPLAY-PO-NBR                          18080004
180900                     '/'                                          18090004
181000                       PV-DISPLAY-RCVR-SEQ                        18100004
181100                     '/'                                          18110004
181200                       PV-DISPLAY-LINE-NBR    DELIMITED BY SIZE   18120004
181300                                 INTO PV-DB2-OPERATION-MESSAGE-2  18130004
181400              MOVE SQLCODE               TO PV-SQLCODE            18140004
181500              MOVE 'COUNT THE NUMBER OF LINE NON H/F      '       18150004
181600                                   TO PV-DB2-OPERATION-MESSAGE-1  18160004
181700              MOVE 'TRECITM TPURITM XLT00003  XLT00004 '          18170004
181800                                   TO PV-DB2-OPERATION-MESSAGE-2  18180004
181900              MOVE 'TRECITM '     TO PV-DB2-TABLE-NAME            18190004
182000             PERFORM 9999-SQL-ABEND                               18200004
182100     END-EVALUATE.                                                18210004
182200                                                                  18220004
182300                                                                  18230004
182400*                                                                 18240004
182500*** DMH END 6/25/12                                               18250004
182600*                                                                 18260004
182700                                                                  18270004
182800                                                                  18280004
182900*-----------------------------------------------------------------18290004
183000* SELECT PARM FOR AVERAGE OUTER PACK QTY                          18300004
183100*-----------------------------------------------------------------18310004
183200 5600-SELECT-AVG-QTY-PARM.                                        18320004
183300                                                                  18330004
183400     MOVE '5600-SELECT-AVG-QTY-PARM' TO PV-ABEND-PARAGRAPH.       18340004
183500                                                                  18350004
183600     EXEC SQL                                                     18360004
183700          SELECT FUNC_QTY                                         18370004
183800          INTO  :KRPRPM-FUNC-QTY                                  18380004
183900          FROM   TKRPRPM                                          18390004
184000          WHERE  SYS_PRC_FUNC_CDE  = 'OUTAVG'                     18400004
184100            AND  INTFC_SYS_CDE     = 'DLX'                        18410004
184200            AND  FUNC_PRC_STAT_CDE = 'AC'                         18420004
184300            AND  LOC_ID            =  090                         18430004
184400           WITH UR                                                18440004
184500     END-EXEC                                                     18450004
184600                                                                  18460004
184700     EVALUATE TRUE                                                18470004
184800       WHEN SQLCODE = ZERO                                        18480004
184900            MOVE KRPRPM-FUNC-QTY TO RECITM-CASE-PACK-QTY          18490004
185000       WHEN SQLWARN0 NOT = SPACES                                 18500004
185100       WHEN SQLCODE NOT = ZERO                                    18510004
185200          MOVE DK-PO-NBR            TO PV-DISPLAY-PO-NBR          18520004
185300          MOVE DK-REC-SEQ-NBR       TO PV-DISPLAY-RCVR-SEQ        18530004
185400          MOVE DK-PO-LNE-NBR        TO PV-DISPLAY-LINE-NBR        18540004
185500         STRING ' PO/RCVR/LNE '         DELIMITED BY SIZE         18550004
185600                 PV-DISPLAY-PO-NBR      DELIMITED BY SIZE         18560004
185700                 '/'                    DELIMITED BY SIZE         18570004
185800                 PV-DISPLAY-RCVR-SEQ    DELIMITED BY SIZE         18580004
185900                 '/'                    DELIMITED BY SIZE         18590004
186000                 PV-DISPLAY-LINE-NBR    DELIMITED BY SIZE         18600004
186100                                INTO PV-DB2-OPERATION-MESSAGE-2   18610004
186200         MOVE SQLCODE               TO PV-SQLCODE                 18620004
186300         MOVE 'SELECT STORE ZONE  '                               18630004
186400                                   TO PV-DB2-OPERATION-MESSAGE-1  18640004
186500         MOVE 'TMDSEDP '     TO PV-DB2-TABLE-NAME                 18650004
186600         PERFORM 9999-SQL-ABEND                                   18660004
186700     END-EVALUATE.                                                18670004
186800                                                                  18680004
186900*-----------------------------------------------------------------18690004
187000* SELECT PARM TO CREATE VIRTUAL LABELS CONTROLLED BY DC           18700004
187100*-----------------------------------------------------------------18710004
187200 5650-SELECT-CRE-LABEL.                                           18720004
187300                                                                  18730004
187400     MOVE '5650-SELECT-CRE-LABEL ' TO PV-ABEND-PARAGRAPH.         18740004
187500                                                                  18750004
187600     EXEC SQL                                                     18760004
187700          SELECT LOC_ID                                           18770004
187800          INTO  :KRPRPM-LOC-ID                                    18780004
187900          FROM   TKRPRPM                                          18790004
188000          WHERE  SYS_PRC_FUNC_CDE  = 'LBLCRE'                     18800004
188100            AND  INTFC_SYS_CDE     = 'KHL'                        18810004
188200            AND  FUNC_PRC_STAT_CDE = 'AC'                         18820004
188300            AND  FUNC_TXT          =  'Y'                         18830004
188400            AND  LOC_ID            =  :DK-OPER-UNT-ID             18840004
188500           WITH UR                                                18850004
188600     END-EXEC                                                     18860004
188700                                                                  18870004
188800     EVALUATE TRUE                                                18880004
188900       WHEN SQLCODE = ZERO                                        18890004
189000            SET PC251-FUNC-CRE-VRTL-LBL TO TRUE                   18900004
189100       WHEN SQLCODE = +100                                        18910004
189200            SET PC251-FUNC-LBL-CALC     TO TRUE                   18920004
189300       WHEN SQLWARN0 NOT = SPACES                                 18930004
189400       WHEN SQLCODE NOT = ZERO                                    18940004
189500          MOVE DK-PO-NBR            TO PV-DISPLAY-PO-NBR          18950004
189600          MOVE DK-REC-SEQ-NBR       TO PV-DISPLAY-RCVR-SEQ        18960004
189700          MOVE DK-PO-LNE-NBR        TO PV-DISPLAY-LINE-NBR        18970004
189800         STRING ' PO/RCVR/LNE '         DELIMITED BY SIZE         18980004
189900                 PV-DISPLAY-PO-NBR      DELIMITED BY SIZE         18990004
190000                 '/'                    DELIMITED BY SIZE         19000004
190100                 PV-DISPLAY-RCVR-SEQ    DELIMITED BY SIZE         19010004
190200                 '/'                    DELIMITED BY SIZE         19020004
190300                 PV-DISPLAY-LINE-NBR    DELIMITED BY SIZE         19030004
190400                                INTO PV-DB2-OPERATION-MESSAGE-2   19040004
190500         MOVE SQLCODE               TO PV-SQLCODE                 19050004
190600         MOVE 'SELECT DC CREATE LABELS'                           19060004
190700                                   TO PV-DB2-OPERATION-MESSAGE-1  19070004
190800         MOVE 'TKRPRPM '     TO PV-DB2-TABLE-NAME                 19080004
190900         PERFORM 9999-SQL-ABEND                                   19090004
191000     END-EVALUATE.                                                19100004
191100                                                                  19110004
191200 8000-LOAD-OUTPUT-DATA.                                           19120004
191300     MOVE '8000-LOAD-OUTPUT-DATA ' TO PV-ABEND-PARAGRAPH.         19130004
191400                                                                  19140004
191500     IF PS-DISTHD-DWNLD-YES                                       19150004
191600        MOVE DISTHD-TOT-CART-CNT  TO PC068-TOT-CTN-CNT            19160004
191700        MOVE DISTHD-P2L-CART-CNT  TO PC068-P2L-CTN-CNT            19170004
191800        MOVE DISTHD-FCSE-CART-CNT TO PC068-XDCK-CTN-CNT           19180004
191900**gb 4/20/12 beg                                                  19190004
192000        MOVE DISTHD-INPK-UNT-QTY  TO PC068-INPK-QTY               19200004
192100        MOVE DISTHD-OTPK-UNT-QTY  TO PC068-OTPK-QTY               19210004
192200**gb 4/20/12 end                                                  19220004
192300        SET PC068-CASEPK-IND-USED TO TRUE                         19230004
192400     ELSE                                                         19240004
192500        MOVE SPACE                TO PC068-CASEPK-IND             19250004
192600        MOVE PC251-TOTAL-CARTONS  TO PC068-TOT-CTN-CNT            19260004
192700        MOVE PC251-P2L-LBL-CNT    TO PC068-P2L-CTN-CNT            19270004
192800        MOVE PC251-FCSE-LBL-CNT   TO PC068-XDCK-CTN-CNT           19280004
192900     END-IF.                                                      19290004
193000***                                                               19300004
193100     IF PV-TROUBLE-COUNT  >  0                                    19310004
193200        MOVE PC068-TOT-CTN-CNT TO PC068-TRBLE-CTN-LINE            19320004
193300     END-IF.                                                      19330004
193400                                                                  19340004
193500     IF PS-LNE-UCC128-DATA-YES                                    19350004
193600        SET PC068-UCC128-IND-USED TO TRUE                         19360004
193700**gb 4/20/12 beg                                                  19370004
193800        IF PS-DISTHD-DWNLD-NO                                     19380004
193900           IF PC251-OTPK-UNT-QTY  > 0                             19390004
194000              MOVE PC251-OTPK-UNT-QTY TO PC068-OTPK-QTY           19400004
194100              MOVE PC251-INPK-UNT-QTY TO PC068-INPK-QTY           19410004
194200           ELSE                                                   19420004
194300              IF PV-TRANSCRIBE-SUM > 0                            19430004
194400                 MOVE RECITM-INNR-PACK-QTY TO PC068-INPK-QTY      19440004
194500                 MOVE RECITM-CASE-PACK-QTY TO PC068-OTPK-QTY      19450004
194600              ELSE                                                19460004
194700                 MOVE ZEROES               TO PC068-OTPK-QTY      19470004
194800                                              PC068-INPK-QTY      19480004
194900              END-IF                                              19490004
195000           END-IF                                                 19500004
195100        END-IF                                                    19510004
195200     ELSE                                                         19520004
195300        IF PV-TRANSCRIBE-SUM > 0                                  19530004
195400           MOVE RECITM-INNR-PACK-QTY TO PC068-INPK-QTY            19540004
195500           MOVE RECITM-CASE-PACK-QTY TO PC068-OTPK-QTY            19550004
195600        ELSE                                                      19560004
195700           MOVE ZEROES               TO PC068-OTPK-QTY            19570004
195800                                        PC068-INPK-QTY            19580004
195900        END-IF                                                    19590004
196000     END-IF.                                                      19600004
196100                                                                  19610004
196200     IF PC068-P2L-CTN-CNT  > 0                                    19620004
196300        SET PC068-P2L-CRTNS TO  TRUE                              19630004
196400        PERFORM 5500-SELECT-STORE-ZONE                            19640004
196500        MOVE MDSEDP-STR-ZN-ID TO PC068-STORE-ZONE                 19650004
196600*                                                                 19660004
196700*** dmh begin - 6/25/12 - WR040826                                19670004
196800*                                                                 19680004
196900        PERFORM 5510-DC-P2L-PROCESSING                            19690004
197000*                                                                 19700004
197100*** dmh end   - 6/25/12 - WR040826                                19710004
197200*                                                                 19720004
197300     END-IF.                                                      19730004
197400******************************************************************19740004
197500* WRITES THE APPROPRIATE OUTPUT RECORDS                          *19750004
197600******************************************************************19760004
197700 8900-WRITE-OUTPUT-RECORD.                                        19770004
197800     MOVE '8900-WRITE-OUTPUT-RECORD.'  TO PV-ABEND-PARAGRAPH.     19780004
197900                                                                  19790004
198000      WRITE OUTPUT-RECORD1                                        19800004
198100           FROM PC068-RECORD-LAYOUT                               19810004
198200                                                                  19820004
198300      ADD  1  TO  PV-RECORDS-WRITTEN.                             19830004
198400                                                                  19840004
198500 9000-EOJ.                                                        19850004
198600                                                                  19860004
198700     CLOSE INPUT-FILE                                             19870004
198800           OUTPUT-FILE1.                                          19880004
198900                                                                  19890004
199000     DISPLAY ' RECORDS READ    = ' PV-RECORDS-READ                19900004
199100     DISPLAY ' RECORDS WRITTEN = ' PV-RECORDS-WRITTEN.            19910004
199200                                                                  19920004
199300******************************************************************19930004
199400* ABEND PROCEDURE                                                *19940004
199500******************************************************************19950004
199600 9998-CALLED-MOD-ABEND.                                           19960004
199700     DISPLAY '** ABEND           ** = SQLABEND'.                  19970004
199800     DISPLAY '** PROGRAM         ** = ' PC-UCC128-CALC-PGM.       19980004
199900     DISPLAY '** PARAGRAPH       ** = ' PV-ABEND-PARAGRAPH.       19990004
200000     DISPLAY '** TABLE AFFECTED  ** = ' PV-DB2-TABLE-NAME.        20000004
200100     DISPLAY '** OPERATION       ** = ' PV-DB2-OPERATION-MESSAGE-120010004
200200     DISPLAY '**                 ** = ' PV-DB2-OPERATION-MESSAGE-220020004
200300     DISPLAY '** SQLCODE         ** = ' PV-SQLCODE.               20030004
200400     COPY DPPD004.                                                20040004
200500     MOVE +4013                  TO PV-ABEND-CODE.                20050004
200600     CALL 'ILBOABN0'   USING PV-ABEND-CODE.                       20060004
200700                                                                  20070004
200800******************************************************************20080004
200900* ABEND PROCEDURE                                                *20090004
201000******************************************************************20100004
201100 9999-SQL-ABEND.                                                  20110004
201200     DISPLAY '** ABEND           ** = SQLABEND'.                  20120004
201300     DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.          20130004
201400     DISPLAY '** PARAGRAPH       ** = ' PV-ABEND-PARAGRAPH.       20140004
201500     DISPLAY '** TABLE AFFECTED  ** = ' PV-DB2-TABLE-NAME.        20150004
201600     DISPLAY '** OPERATION       ** = ' PV-DB2-OPERATION-MESSAGE-120160004
201700     DISPLAY '**                 ** = ' PV-DB2-OPERATION-MESSAGE-220170004
201800     DISPLAY '** SQLCODE         ** = ' PV-SQLCODE.               20180004
201900     COPY DPPD004.                                                20190004
202000     MOVE +4013                  TO PV-ABEND-CODE.                20200004
202100     CALL 'ILBOABN0'   USING PV-ABEND-CODE.                       20210004
202200                                                                  20220004
