000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    XLKUT920.                                         00020000
000300 AUTHOR.        RON KRIER.                                        00030000
000400 INSTALLATION.  KOHLS.                                            00040000
000500 DATE-WRITTEN   SEPTEMBER, 2014,                                  00050000
000600 DATE-COMPILED.                                                   00060000
000700                                                                  00070000
000800* ************************************************************** *00080000
000900* * XLKUT920 - CHECK RMS ONLY SKU ERRORS AGAINST LEGACY PO     * *00090000
001000* *            TABLES TO SEE IF THE PO/SKU IS IN LEGACY.       * *00100000
001100* *                                                            * *00110000
001200* * PURPOSE:                                                   * *00120000
001300* * DUE TO ISSUES WITH PO'S BEING EXTRACTED FROM RMS PO FOR    * *00130000
001400* * THE DATA INTEGRITY PROCESS BUT NOT UPDATED IN LEGACY SO    * *00140000
001500* * NOT PULLED ON THE LEGACY SIDE FOR THE DATA INTEGRITY       * *00150000
001600* * PROCESS, WE ARE USING THIS PROGRAM TO LOOK AT THE RMS      * *00160000
001700* * ONLY SKU MESSAGES TO CHECK IF THE SKU IS IN FACT ON THE    * *00170000
001800* * LEGACY PO AND IF NOT, THEN CALLING THAT OUT IN THIS        * *00180000
001900* * PROGRAM SO THAT WE CAN DO SOME FURTHER FOLLOW UP AND       * *00190000
002000* * GET THE DATA PUSHED IF NEEDED.                             * *00200000
002100* *                                                            * *00210000
002200* ************************************************************** *00220000
002300 ENVIRONMENT DIVISION.                                            00230000
002400 CONFIGURATION SECTION.                                           00240000
002500 SOURCE-COMPUTER.        IBM-3090.                                00250000
002600 OBJECT-COMPUTER.        IBM-3090.                                00260000
002700                                                                  00270000
002800 INPUT-OUTPUT SECTION.                                            00280000
002900 FILE-CONTROL.                                                    00290000
003000                                                                  00300000
003100     SELECT INPUT-FILE                    ASSIGN TO IN01.         00310000
003200     SELECT OUTPUT-FILE                   ASSIGN TO OUT01.        00320017
003200     SELECT OUTPUT-PO-COUNT-FILE          ASSIGN TO OUT02.        00321042
003300                                                                  00330000
003400******************************************************************00340000
003500 DATA DIVISION.                                                   00350000
003600 FILE SECTION.                                                    00360000
003700                                                                  00370000
003800 FD  INPUT-FILE                                                   00380000
003900     RECORDING MODE IS F                                          00390000
004000     LABEL RECORDS ARE STANDARD                                   00400000
004100     BLOCK CONTAINS 0 RECORDS.                                    00410000
004200 01  INPUT-RECORD                    PIC  X(830).                 00420000
004300                                                                  00430000
004400 FD  OUTPUT-FILE                                                  00440017
004500     RECORDING MODE IS F                                          00450000
004600     LABEL RECORDS ARE STANDARD                                   00460000
004700     BLOCK CONTAINS 0 RECORDS.                                    00470000
004800 01  OUTPUT-RECORD               PIC  X(80).                      00480017
004300                                                                  00490013
004400 FD  OUTPUT-PO-COUNT-FILE                                         00491042
004500     RECORDING MODE IS F                                          00492042
004600     LABEL RECORDS ARE STANDARD                                   00493042
004700     BLOCK CONTAINS 0 RECORDS.                                    00494042
004800 01  OUTPUT-PO-SKU-COUNT-RECORD     PIC  X(80).                   00495044
004300                                                                  00496042
                                                                        00500013
004900                                                                  00510000
005000                                                                  00520000
005100                                                                  00530000
005200 WORKING-STORAGE SECTION.                                         00540000
005300                                                                  00550000
005400 01  PC-PROGRAM-CONSTANTS.                                        00560000
005500     05  PC-CURRENT-PROGRAM-NAME     PIC X(08) VALUE 'XLKUT920'.  00570000
005600     05  PC-PGM-PROGRESS-DESC.                                    00580000
005700         10  PC-ORD-SKU-ADD          PIC X(20) VALUE              00590000
005800             'ORD_SKU_ADD         '.                              00600000
005900     05  PC-ABEND-INFO.                                           00610000
006000         10  PC-ABEND                PIC X(11) VALUE              00620000
006100                                               '** ABEND **'.     00630000
006200         10  PC-ABEND-MSG-PARA       PIC X(15) VALUE              00640000
006300                                               '- PARA       : '. 00650000
006400         10  PC-ABEND-MSG-DISPLAY-PARA                            00660000
006500                                     PIC X(15) VALUE              00670000
006600                                               '  CALLED PARA: '. 00680000
006700         10  PC-ABEND-MSG-NUMBER     PIC X(15) VALUE              00690000
006800                                               '  FOR ABEND# : '. 00700000
006900         10  PC-ABEND-MSG-DESC       PIC X(15) VALUE              00710000
007000                                               '- ERROR IS   : '. 00720000
007100         10  PC-ABEND-MSG-INDENT-15  PIC X(15) VALUE SPACES.      00730000
007200         10  PC-ABEND-MSG-ACTION     PIC X(15) VALUE              00740000
007300                                               '- ACTION     : '. 00750000
007400     05  PC-HOW-OFTEN-TO-DISPLAY     PIC 9(9)  VALUE 5000.        00760000
007500                                                                  00770000
007600 01  PS-PROGRAM-SWITCHES.                                         00780000
007700     05  PS-INPUT-EOF-SW             PIC X(01) VALUE 'N'.         00790000
007800         88  PS-INPUT-EOF                      VALUE 'Y'.         00800000
007900         88  PS-INPUT-NOT-EOF                  VALUE 'N'.         00810000
008000     05  PS-CURSOR-HAS-DATA-SW       PIC X(01) VALUE 'N'.         00820000
008100         88  PS-CURSOR-HAS-DATA                VALUE 'Y'.         00830000
008200         88  PS-CURSOR-HAS-NO-DATA             VALUE 'N'.         00840000
008300     05  PS-TABLE-LOOP-DONE-SW       PIC X(01) VALUE 'N'.         00850000
008400         88  PS-TABLE-LOOP-DONE                VALUE 'Y'.         00860000
008500         88  PS-TABLE-LOOP-NOT-DONE            VALUE 'N'.         00870000
008600     05  PS-OPEN-SW                  PIC X(01) VALUE 'N'.         00880000
008700         88  PS-OPEN-DID-WORK                  VALUE 'Y'.         00890000
008800         88  PS-OPEN-DID-NOT-WORK              VALUE 'N'.         00900000
008900     05  PS-PO-ON-TPURCHS-SW         PIC X(01) VALUE 'Y'.         00910000
009000         88  PS-PO-ON-TPURCHS                  VALUE 'Y'.         00920000
009100         88  PS-PO-NOT-ON-TPURCHS              VALUE 'N'.         00930000
009200     05  PS-PO-PREV-PACK-PO-SW       PIC X(01) VALUE 'N'.         00940009
009300         88  PS-PO-NOT-PREV-PACK-PO            VALUE 'N'.         00950009
009400         88  PS-PO-PREV-PACK-PO                VALUE 'Y'.         00960009
009500     05  PS-PO-SKU-ON-TPURITM-SW     PIC X(01) VALUE 'Y'.         00970009
009600         88  PS-PO-SKU-ON-TPURITM              VALUE 'Y'.         00980009
009700         88  PS-PO-SKU-NOT-ON-TPURITM          VALUE 'N'.         00990009
009800     05  PS-PO-ON-TPOPRPK-SW         PIC X(01) VALUE 'Y'.         01000000
009900         88  PS-PO-ON-TPOPRPK                  VALUE 'Y'.         01010000
010000         88  PS-PO-NOT-ON-TPOPRPK              VALUE 'N'.         01020000
010100     05  PS-SKU-ON-XLT-SKU-SW        PIC X(01) VALUE 'Y'.         01030000
010200         88  PS-SKU-ON-XLT-SKU                 VALUE 'Y'.         01040000
010300         88  PS-SKU-NOT-ON-XLT-SKU             VALUE 'N'.         01050000
010400     05  PS-SKU-ON-XLT-PK-SW         PIC X(01) VALUE 'Y'.         01060000
010500         88  PS-SKU-ON-XLT-PK                  VALUE 'Y'.         01070000
010600         88  PS-SKU-NOT-ON-XLT-PK              VALUE 'N'.         01080000
010700     05  PS-PO-IS-PREPACK-SW         PIC X(01) VALUE 'Y'.         01090000
010800         88  PS-PO-IS-PREPACK                  VALUE 'Y'.         01100000
010900         88  PS-PO-IS-NOT-PREPACK              VALUE 'N'.         01110000
011000     05  PS-PO-IS-UPDATED-SW         PIC X(01) VALUE 'Y'.         01120000
011100         88  PS-PO-IS-UPDATED                  VALUE 'Y'.         01130000
011200         88  PS-PO-IS-NOT-UPDATED              VALUE 'N'.         01140000
011300     05  PS-SKU-TBL-SW               PIC X(04) VALUE 'SKU '.      01150012
011400         88  PS-SKU-ON-XLT-SKU-TBL             VALUE 'SKU '.      01160012
011500         88  PS-SKU-ON-XLT-PK-TBL              VALUE 'PACK'.      01170012
011600         88  PS-SKU-ON-BOTH-TBL                VALUE 'BOTH'.      01180012
011700         88  PS-SKU-NOT-FOUND                  VALUE 'NFND'.      01190012
011800                                                                  01200000
011300     05  PS-FIRST-RECORD-SW          PIC X(01) VALUE 'N'.         01210041
010800         88  PS-FIRST-RECORD-YES               VALUE 'Y'.         01220041
010900         88  PS-FIRST-RECORD-NO                VALUE 'N'.         01230041
011800                                                                  01240041
011900 01  PV-PROGRAM-VARIABLES.                                        01250000
012000     05  PV-PO-NBR-COMP              PIC S9(9) VALUE 0 COMP.      01260000
012100     05  PV-PO-NBR-NUM               PIC  9(8) VALUE 0.           01270000
012200     05  PV-PREV-PO-NBR              PIC  9(8) VALUE 0.           01280000
012200     05  PV-PREV-PO-PKGNG-CDE        PIC  X(1) VALUE SPACE.       01290033
012300     05  PV-INPUT-READ               PIC  9(9) VALUE 0.           01300000
012400     05  PV-INPUT-CHECK-CNT          PIC  9(9) VALUE 0.           01310003
012500     05  PV-OUTPUT-WRITTEN           PIC  9(9) VALUE 0.           01320000
           05  PV-OUTPUT-PO-COUNT          PIC  9(9) VALUE 0.           01321064
           05  PV-OUTPUT-SKU-COUNT         PIC  9(9) VALUE 0.           01322044
           05  PV-OUTPUT-LIMIT             PIC  9(9) VALUE 0.           01340061
012600     05  PV-DISPLAY-FIELD            PIC  9(9) VALUE 0.           01360000
012700     05  PV-DISPLAY-FIELD2           PIC  9(9) VALUE 0.           01370001
012600     05  PV-DISPLAY-REC              PIC  Z(8)9 VALUE ZERO.       01371072
012800     05  PV-RECS-WITH-MATCHES-CNT    PIC  9(9) VALUE 0.           01380000
012900     05  PV-TABLE-ROW-SELECT-CNT     PIC  9(9) VALUE 0.           01390000
013000     05  PV-EXTRACT-WRITTEN-CNT      PIC  9(9) VALUE 0.           01400000
013100                                                                  01410000
013200     05  PV-CC-TIMESTAMP             PIC X(26) VALUE SPACES.      01420000
013300     05  PV-PARAGRAPH-NAME           PIC X(30) VALUE SPACES.      01430000
013400     05  PV-DB2-OPERATION-MSG-1      PIC X(79) VALUE SPACES.      01440000
013500     05  PV-DB2-TABLE-NAME           PIC X(18) VALUE SPACES.      01450000
013600     05  PV-DISPLAY-NTH-MULTIPLE     PIC 9(9)  VALUE 0.           01460000
013700     05  PV-DISPLAY-NTH-REMAINDER    PIC 9(9)  VALUE 0.           01470000
013800     05  PV-SQLCODE                  PIC +999  VALUE ZERO.        01480000
013900                                                                  01490000
014000     05  PV-TMST                     PIC X(26) VALUE SPACES.      01500000
014100     05  PV-TIMESTAMP-DETAIL                                      01510000
014200         REDEFINES                                                01520000
014300         PV-TMST.                                                 01530000
014400         10  PV-TIMESTAMP-19.                                     01540000
014500             15  PV-TMS-DATE.                                     01550000
014600                 20  PV-TMS-YEAR.                                 01560000
014700                     25  PV-TMS-CC   PIC X(02).                   01570000
014800                     25  PV-TMS-YY   PIC X(02).                   01580000
014900                 20  FILLER          PIC X(01).                   01590000
015000                 20  PV-TMS-MONTH    PIC X(02).                   01600000
015100                 20  FILLER          PIC X(01).                   01610000
015200                 20  PV-TMS-DAY      PIC X(02).                   01620000
015300             15  FILLER              PIC X(01).                   01630000
015400             15  PV-TMS-HOUR         PIC X(02).                   01640000
015500             15  FILLER              PIC X(01).                   01650000
015600             15  PV-TMS-MINUTE       PIC X(02).                   01660000
015700             15  FILLER              PIC X(01).                   01670000
015800             15  PV-TMS-SECOND       PIC X(02).                   01680000
015900         10  FILLER                  PIC X(01).                   01690000
016000         10  PV-TMS-MSECOND          PIC X(06).                   01700000
016100                                                                  01710000
016200 01  OR-OUTPUT-RECORD.                                            01720000
016300     05  OR-PO-NBR                   PIC  9(08)      VALUE ZERO.  01730000
016400     05  FILLER                      PIC  X(1)       VALUE ','.   01740025
           05  OR-PO-TYPE                  PIC  X(1)       VALUE SPACE. 01750019
016400     05  FILLER                      PIC  X(1)       VALUE ','.   01760025
016500     05  OR-SKU-NBR                  PIC  9(08)      VALUE ZERO.  01770000
016600     05  FILLER                      PIC  X(1)       VALUE ','.   01780025
016700     05  OR-SKU-TYPE                 PIC  X(01)      VALUE SPACE. 01790000
016800         88  OR-SKU-TYPE-PACK                        VALUE 'P'.   01800000
016900         88  OR-SKU-TYPE-SELLING                     VALUE 'S'.   01810000
017000         88  OR-SKU-TYPE-UNKNOWN                     VALUE 'U'.   01820000
017100     05  FILLER                      PIC  X(1)       VALUE ','.   01830025
           05  OR-PO-TEXT                  PIC  X(30)      VALUE SPACE. 01840023
           05  OR-PO-TEXT-PACK             PIC  X(20)      VALUE SPACE. 01850022
    00     05  FILLER                      PIC  X(07)      VALUE SPACE. 01860025
017800                                                                  01870000
016200 01  OR-OUTPUT-PO-RECORD.                                         01880017
016300     05  OR-PO-NBR-PO                PIC  9(08)      VALUE ZERO.  01890020
016400     05  FILLER                      PIC  X(1)       VALUE ','.   01900025
016400     05  FILLER                      PIC  X(1)       VALUE SPACE. 01910027
016400     05  FILLER                      PIC  X(1)       VALUE ','.   01920027
016400     05  FILLER                      PIC  X(8)       VALUE SPACE. 01930027
016400     05  FILLER                      PIC  X(1)       VALUE ','.   01940027
016400     05  FILLER                      PIC  X(1)       VALUE SPACE. 01950027
016400     05  FILLER                      PIC  X(1)       VALUE ','.   01960027
016500     05  OR-PO-TEXT-PO               PIC  X(30)      VALUE ZERO.  01970020
016600     05  FILLER                      PIC  X(28)      VALUE SPACE. 01980025
017800                                                                  01990017
007292 01  PV-OUTPUT-SKU-COUNT-RECORD.                                  02036044
007293     05  PV-SKU-COUNT-MESSAGE        PIC X(27)       VALUE        02037045
007294                               "TOTAL NO OF SKU'S MISSING :".     02038057
016600     05  PV-TOTAL-SKU-COUNT          PIC ZZZZ9     VALUE SPACE.   02038151
016600     05  FILLER                      PIC  X(48)      VALUE SPACE. 02039045
                                                                        02039144
017900 01  DK-DATA-KEY-FIELDS.                                          02060000
018000     05  DK-PO-NBR                   PIC  S9(9) COMP    VALUE 0.  02070000
018100     05  DK-SKU-NBR                  PIC  S9(8)V COMP-3 VALUE 0.  02080000
018200                                                                  02090000
 18300 01  DM-DISPLAY-MESSAGE.                                          02100025
018400     05  DM-01-10.                                                02110000
018500         10  DM-PROGRAM              PIC X(08) VALUE SPACE.       02120000
018600         10  FILLER                  PIC X(02) VALUE ': '.        02130000
018700     05  DM-11-80.                                                02140000
018800         10  FILLER                  PIC X(37) VALUE              02150000
018900                        'SELECT ROWS MATCHING PO DRIVER FILE, '.  02160000
019000         10  FILLER                  PIC X(30) VALUE              02170000
019100                        'CREATING TRECDIS EXTRACT FILE.'.         02180000
019200         10  FILLER                  PIC X(01) VALUE SPACE.       02190000
019300         10  FILLER                  PIC X(01) VALUE ALL '*'.     02200000
019400     05  DM-81-120.                                               02210000
019500         10  FILLER                  PIC X(40) VALUE ALL '*'.     02220000
019600                                                                  02230000
019700 01  DP-DISPLAY-PROGRESS-MSG.                                     02240000
019800     05  DP-PROGRAM                  PIC X(08) VALUE SPACE.       02250000
019900     05  FILLER                      PIC X(02) VALUE SPACE.       02260000
020000     05  DP-STATUS-DESCRIPTION       PIC X(10) VALUE SPACE.       02270000
020100     05  FILLER                      PIC X(04) VALUE ' AT '.      02280000
020200     05  DP-TIMESTAMP-19             PIC X(19) VALUE SPACE.       02290000
020300     05  FILLER                      PIC X(03) VALUE '.  '.       02300000
020400     05  FILLER                      PIC X(03) VALUE              02310000
020500                                         'IN:'.                   02320000
020600     05  DP-IN-CNT                   PIC ZZZ,ZZZ,ZZ9              02330000
020700                                               VALUE ZERO.        02340000
020800     05  FILLER                      PIC X(02) VALUE ', '.        02350000
020900     05  FILLER                      PIC X(14) VALUE              02360000
021000                                         'ROWS SELECTED:'.        02370000
021100     05  DP-ROWS-SELECTED-CNT        PIC ZZZ,ZZZ,ZZ9              02380000
021200                                               VALUE ZERO.        02390000
021300     05  FILLER                      PIC X(02) VALUE ', '.        02400000
021400     05  FILLER                      PIC X(04) VALUE              02410000
021500                                         'OUT:'.                  02420000
021600     05  DP-OUT-CNT                  PIC ZZZ,ZZZ,ZZ9              02430000
021700                                               VALUE ZERO.        02440000
021800     05  FILLER                      PIC X(01) VALUE '.'.         02450000
021900                                                                  02460000
022000 01  ABEND-CODE                      PIC S9(04)                   02470000
022100                                               VALUE ZEROES       02480000
022200                                               COMP SYNC.         02490000
022300                                                                  02500000
022400*---------------------------------------------------------------* 02510003
022500*  INPUT FILE LAYOUT                                              02520003
022600*---------------------------------------------------------------* 02530003
022700 01  WS-XLRD023-RECORD.                                           02540004
022800     COPY XLRD023.                                                02550003
022900                                                                  02560003
023000*---------------------------------------------------------------* 02570000
023100*  DB2 FORMATTED MESSAGE AREA                                     02580000
023200*---------------------------------------------------------------* 02590000
023300     COPY DPWS004.                                                02600000
023400                                                                  02610000
023500                                                                  02620000
023600*---------------------------------------------------------------* 02630000
023700*    DB2 AREA FOR TPURCHS                                       * 02640000
023800*---------------------------------------------------------------* 02650000
023900     EXEC SQL                                                     02660000
024000          INCLUDE TPURCHS                                         02670000
024100     END-EXEC.                                                    02680000
024200                                                                  02690000
024300*---------------------------------------------------------------* 02700000
024400*    DB2 AREA FOR TPURITM                                       * 02710000
024500*---------------------------------------------------------------* 02720000
024600     EXEC SQL                                                     02730000
024700          INCLUDE TPURITM                                         02740000
024800     END-EXEC.                                                    02750000
024900                                                                  02760000
025000*---------------------------------------------------------------* 02770000
025100*    DB2 AREA FOR TPOPRPK                                       * 02780000
025200*---------------------------------------------------------------* 02790000
025300     EXEC SQL                                                     02800000
025400          INCLUDE TPOPRPK                                         02810000
025500     END-EXEC.                                                    02820000
025600                                                                  02830000
025700*---------------------------------------------------------------* 02840000
025800*    DB2 AREA FOR XLT_PK                                        * 02850000
025900*---------------------------------------------------------------* 02860000
026000     EXEC SQL                                                     02870000
026100          INCLUDE XLT00007                                        02880000
026200     END-EXEC.                                                    02890000
026300                                                                  02900000
026400*---------------------------------------------------------------* 02910000
026500*    DB2 AREA FOR XLT_SKU                                       * 02920000
026600*---------------------------------------------------------------* 02930000
026700     EXEC SQL                                                     02940000
026800          INCLUDE XLT00003                                        02950000
026900     END-EXEC.                                                    02960000
171410*---------------------------------------------------------------* 02961061
171410*  DB2 TABLE DECLARATION - PARM TABLE                             02962061
171410*      (TKRPRPM)                                                  02963061
171410*---------------------------------------------------------------* 02964061
171410     EXEC SQL                                                     02965061
171410          INCLUDE TKRPRPM                                         02966061
171410     END-EXEC.                                                    02967061
027000                                                                  02970000
027100*---------------------------------------------------------------* 02980000
027200*    DB2 AREA FOR COMMUNICATIONS                                * 02990000
027300*---------------------------------------------------------------* 03000000
027400     EXEC SQL                                                     03010000
027500          INCLUDE SQLCA                                           03020000
027600     END-EXEC.                                                    03030000
027700                                                                  03040000
027800 PROCEDURE DIVISION.                                              03050000
027900                                                                  03060000
028000 0000-PROGRAM-MAINLINE.                                           03070000
028100                                                                  03080000
028200     PERFORM 1000-INITIALIZE.                                     03090000
028300                                                                  03100000
028400     PERFORM 2000-PROCESS-INPUT-FILE                              03110000
028500         UNTIL PS-INPUT-EOF.                                      03120000
                                                                        03130035
           IF PV-OUTPUT-SKU-COUNT >= 1                                  03172044
           MOVE PV-OUTPUT-SKU-COUNT TO PV-TOTAL-SKU-COUNT               03172144
           WRITE OUTPUT-PO-SKU-COUNT-RECORD FROM                        03172244
028600                  PV-OUTPUT-SKU-COUNT-RECORD                      03172346
           END-IF.                                                      03173044
028700     CLOSE INPUT-FILE.                                            03180001
028800     CLOSE OUTPUT-FILE.                                           03190017
028800     CLOSE OUTPUT-PO-COUNT-FILE.                                  03191042
028900                                                                  03200000
           PERFORM 9100-GET-PARM-VALUE                                  03210062
           IF PV-OUTPUT-WRITTEN >= PV-OUTPUT-LIMIT                      03220062
              MOVE 4008 TO RETURN-CODE                                  03230038
              DISPLAY 'TODAY PO DISCREPANCY COUNT IS MORE THAN 100 '    03231066
              'WHICH IS ABNORMAL,HENCE FORCE ABENDING THE JOB TO '      03232066
              'UNDERSTAND THE REASON FOR THE HUGE DISCREPANCY.CHECK '   03233066
              'WITH RMS TEAM AND UPON CONFIRMATION, RUN THE'            03234067
              'SUCCESSOR MFT JOB TO REPROCESS THE MESSAGES.'            03235067
           END-IF.                                                      03240038
029000     MOVE PV-INPUT-READ TO PV-DISPLAY-REC                         03260072
029100     DISPLAY 'INPUT RECORDS READ:      ' PV-DISPLAY-REC           03270072
029200     MOVE PV-OUTPUT-WRITTEN TO PV-DISPLAY-REC                     03280072
029300     DISPLAY 'OUTPUT RECORDS WRITTEN:  ' PV-DISPLAY-REC           03290072
           MOVE PV-OUTPUT-PO-COUNT TO PV-DISPLAY-REC                    03290172
           DISPLAY "TOTLA NO OF PO'S COMPLETELY MISSING IN LEGACY : "   03291069
                             PV-DISPLAY-REC                             03291172
           MOVE PV-TOTAL-SKU-COUNT  TO PV-DISPLAY-REC                   03291272
           DISPLAY "TOTAL NO OF SKU'S MISSING : "  PV-DISPLAY-REC       03292072
029400                                                                  03300068
029500     STOP RUN.                                                    03310000
029600                                                                  03320000
029700                                                                  03330000
029800* ************************************************************** *03340000
029900* * INITIALIZATIONS                                            * *03350000
030000* ************************************************************** *03360000
030100 1000-INITIALIZE.                                                 03370000
030200                                                                  03380000
030300     OPEN  INPUT  INPUT-FILE.                                     03390000
030400     OPEN  OUTPUT OUTPUT-FILE.                                    03400017
030400     OPEN  OUTPUT OUTPUT-PO-COUNT-FILE.                           03401042
030600     PERFORM 9050-READ-INPUT-FILE.                                03410000
030700                                                                  03420000
030800 2000-PROCESS-INPUT-FILE.                                         03430003
030900                                                                  03440000
031000     IF  XL023-XXT-PO-SKU                                         03450000
031100         IF  XL023-ON-RMS-ONLY                                    03460000
031200             PERFORM 2100-PROCESS-SKU-DATA                        03470000
031300         ELSE                                                     03480000
031400             NEXT SENTENCE                                        03490005
031500         END-IF                                                   03500000
031600     ELSE                                                         03510000
031700         IF  XL023-XXT-PO-PK-SKU                                  03520000
031800             IF  XL023-ON-RMS-ONLY                                03530000
031900                 PERFORM 2200-PROCESS-PACK-SKU-DATA               03540000
032000             ELSE                                                 03550000
032100                 NEXT SENTENCE                                    03560000
032200             END-IF                                               03570000
032300         ELSE                                                     03580000
032400             NEXT SENTENCE                                        03590000
032500         END-IF                                                   03600000
032600     END-IF.                                                      03610000
032700                                                                  03620000
032800     PERFORM 9050-READ-INPUT-FILE.                                03630000
032900                                                                  03640000
014010******************************************************************03650025
014110******************************************************************03660025
014112                                                                  03670025
033000 2100-PROCESS-SKU-DATA.                                           03680000
033100                                                                  03690000
033200     IF  XL023-SK-PO-NBR-RMS = PV-PREV-PO-NBR                     03700000
               MOVE PV-PREV-PO-PKGNG-CDE TO OR-PO-TYPE                  03710033
033400     ELSE                                                         03720000
033500         MOVE XL023-SK-PO-NBR-RMS TO                              03730000
033600              PV-PREV-PO-NBR                                      03740000
033700              DK-PO-NBR                                           03750000
033800         SET PS-PO-NOT-ON-TPURCHS TO TRUE                         03760000
033900         SET PS-PO-NOT-PREV-PACK-PO TO TRUE                       03770009
034000         PERFORM 3200-CHECK-TPURCHS                               03780000
034100         IF  PS-PO-ON-TPURCHS                                     03790009
034200             IF  PURCHS-PKGNG-CDE = 'B'                           03800009
034300             OR  PURCHS-PKGNG-CDE = ' '                           03810009
034400             OR  PURCHS-PKGNG-CDE = 'C'                           03820009
034500                 PERFORM 3300-CHECK-TPURCHS-PREV-PACK             03830009
034600             END-IF                                               03840009
034700         END-IF                                                   03850009
034800     END-IF.                                                      03860009
034900                                                                  03870000
035000     MOVE XL023-SK-SKU-NBR-RMS TO DK-SKU-NBR.                     03880000
035100     SET PS-SKU-NOT-ON-XLT-SKU TO TRUE.                           03890000
035200     SET PS-SKU-NOT-FOUND TO TRUE.                                03900008
035300     PERFORM 3600-CHECK-XLT-SKU.                                  03910000
035400                                                                  03920000
035500*    SET PS-SKU-NOT-ON-XLT-PK TO TRUE.                            03930008
035600*    PERFORM 4000-CHECK-XLT-PK.                                   03940008
035700                                                                  03950000
035800     IF  PS-PO-ON-TPURCHS                                         03960009
035900         IF  PURCHS-PKGNG-CDE = 'B'                               03970009
036000         OR  PURCHS-PKGNG-CDE = ' '                               03980009
036100         OR  PURCHS-PKGNG-CDE = 'C'                               03990009
036200             SET PS-PO-SKU-NOT-ON-TPURITM TO TRUE                 04000009
036300             PERFORM 4400-CHECK-TPURITM-NON-PACK                  04010009
036400         END-IF                                                   04020009
036500     END-IF.                                                      04030009
036600*        ELSE                                                     04040009
036700*            PERFORM 4800-CHECK-TPURITM-PACK                      04050009
036800                                                                  04060000
036900 2200-PROCESS-PACK-SKU-DATA.                                      04070000
037000                                                                  04080000
037100                                                                  04090003
037200 3200-CHECK-TPURCHS.                                              04100000
037300                                                                  04110000
037400     INITIALIZE DCLTPURCHS.                                       04120000
037500                                                                  04130000
037600     EXEC SQL                                                     04140000
037700         SELECT PO_NBR                                            04150000
037800               ,RMS_PO_UPD_TMST                                   04160000
037900               ,PKGNG_CDE                                         04170000
038000           INTO :PURCHS-PO-NBR,                                   04180000
038100                :PURCHS-RMS-PO-UPD-TMST,                          04190000
038200                :PURCHS-PKGNG-CDE                                 04200000
038300           FROM TPURCHS                                           04210000
038400          WHERE PO_NBR         =  :DK-PO-NBR                      04220000
038500            AND VER_STATUS_CDE =  'A'                             04230000
038600     END-EXEC                                                     04240000
038700                                                                  04250000
038800     EVALUATE TRUE                                                04260000
038900         WHEN SQLCODE = +0                                        04270000
039000              SET PS-PO-ON-TPURCHS TO TRUE                        04280000
                    MOVE PURCHS-PKGNG-CDE TO OR-PO-TYPE                 04290029
               MOVE PURCHS-PKGNG-CDE TO PV-PREV-PO-PKGNG-CDE            04300037
039100         WHEN SQLCODE = +100                                      04310000
039200              MOVE DK-PO-NBR TO PV-DISPLAY-FIELD                  04320000
039300              DISPLAY 'PO NOT IN LEGACY:  ' PV-DISPLAY-FIELD      04330000
039400              MOVE 'U' TO PURCHS-PKGNG-CDE                        04340000
                    MOVE 'PO NOT IN LEGACY'                             04350017
                            TO OR-PO-TEXT-PO                            04360021
057000              PERFORM 5500-FORMAT-OUTPUT                          04370015
039500         WHEN SQLCODE = -904                                      04380000
039600         WHEN SQLCODE = -911                                      04390000
039700         WHEN SQLCODE = -913                                      04400000
039800         WHEN SQLWARN0 NOT EQUAL SPACE                            04410000
039900         WHEN SQLCODE  NOT EQUAL ZERO                             04420000
040000              MOVE '3200-CHECK-TPURCHS'                           04430000
040100                                 TO PV-PARAGRAPH-NAME             04440000
040200              MOVE 'SELECT TO TPURCHS'                            04450000
040300                                 TO PV-DB2-OPERATION-MSG-1        04460000
040400              MOVE 'TPURCHS'     TO PV-DB2-TABLE-NAME             04470000
040500              PERFORM 9999-DB2-ABEND                              04480000
040600     END-EVALUATE.                                                04490000
040700                                                                  04500009
040800                                                                  04510009
040900 3300-CHECK-TPURCHS-PREV-PACK.                                    04520009
    00                                                                  04530023
 41100     INITIALIZE DCLTPURCHS.                                       04540023
041200                                                                  04550009
041300     EXEC SQL                                                     04560009
041400         SELECT VER_STATUS_CDE                                    04570009
041500           INTO :PURCHS-VER-STATUS-CDE                            04580030
041600           FROM TPURCHS                                           04590009
 41700          WHERE PO_NBR         =  :DK-PO-NBR                      04600030
041800            AND NOT VER_STATUS_CDE =  'A'                         04610009
041900            AND PKGNG_CDE IN ('M', 'I')                           04620009
042000     END-EXEC                                                     04630009
042100                                                                  04640009
042200     EVALUATE TRUE                                                04650009
042300         WHEN SQLCODE = +0                                        04660009
042400         WHEN SQLCODE = -811                                      04670009
042500              SET PS-PO-PREV-PACK-PO TO TRUE                      04680009
042600         WHEN SQLCODE = +100                                      04690011
042700              CONTINUE                                            04700011
042800         WHEN SQLCODE = -904                                      04710009
042900         WHEN SQLCODE = -911                                      04720009
043000         WHEN SQLCODE = -913                                      04730009
043100         WHEN SQLWARN0 NOT EQUAL SPACE                            04740009
043200         WHEN SQLCODE  NOT EQUAL ZERO                             04750009
043300              MOVE '3300-CHECK-TPURCHS-PREV-PACK'                 04760009
043400                                 TO PV-PARAGRAPH-NAME             04770009
043500              MOVE 'SELECT TO TPURCHS'                            04780009
043600                                 TO PV-DB2-OPERATION-MSG-1        04790009
043700              MOVE 'TPURCHS'     TO PV-DB2-TABLE-NAME             04800009
043800              PERFORM 9999-DB2-ABEND                              04810009
043900     END-EVALUATE.                                                04820009
044000                                                                  04830009
044100 3600-CHECK-XLT-SKU.                                              04840000
044200                                                                  04850000
044300     INITIALIZE DCLXLT00003.                                      04860000
044400                                                                  04870000
044500     EXEC SQL                                                     04880000
044600         SELECT INTR_UPC_ID                                       04890000
044700           INTO :XLT00003-INTR-UPC-ID                             04900000
044800           FROM XLT_SKU                                           04910000
044900          WHERE SKU_NBR        =  :DK-SKU-NBR                     04920000
045000     END-EXEC                                                     04930000
045100                                                                  04940000
045200     EVALUATE TRUE                                                04950000
045300         WHEN SQLCODE = +0                                        04960000
045400         WHEN SQLCODE = -811                                      04970000
045500              SET PS-SKU-ON-XLT-SKU TO TRUE                       04980000
045600              SET PS-SKU-ON-XLT-SKU-TBL TO TRUE                   04990008
045700              SET PS-SKU-NOT-ON-XLT-PK TO TRUE                    05000008
045800              PERFORM 4000-CHECK-XLT-PK                           05010008
045900              IF  PS-SKU-NOT-ON-XLT-PK                            05020008
046000                  NEXT SENTENCE                                   05030008
046100              ELSE                                                05040008
046200                  SET PS-SKU-ON-BOTH-TBL TO TRUE                  05050008
046300                  MOVE DK-SKU-NBR TO PV-DISPLAY-FIELD             05060008
046400                  MOVE DK-PO-NBR TO PV-DISPLAY-FIELD2             05070008
046500                  DISPLAY 'SKU ON BOTH XLT_SKU AND XLT_PK: '      05080008
046600                      PV-DISPLAY-FIELD                            05090008
046700                      ' FOR PO: ' PV-DISPLAY-FIELD2               05100008
046800                      ' (' PURCHS-PKGNG-CDE ')'                   05110008
046900              END-IF                                              05120008
047000         WHEN SQLCODE = +100                                      05130000
047100              IF  XL023-XXT-PO-SKU                                05140000
047200                  SET PS-SKU-NOT-ON-XLT-PK TO TRUE                05150008
047300                  PERFORM 4000-CHECK-XLT-PK                       05160008
047400                  IF  PS-SKU-NOT-ON-XLT-PK                        05170008
047500                      MOVE DK-SKU-NBR TO PV-DISPLAY-FIELD         05180008
047600                      MOVE DK-PO-NBR TO PV-DISPLAY-FIELD2         05190008
047700                      DISPLAY 'SKU NOT ON XLT_SKU OR XLT_PK: '    05200008
047800                          PV-DISPLAY-FIELD                        05210008
047900                          ' FOR PO: ' PV-DISPLAY-FIELD2           05220007
048000                          ' (' PURCHS-PKGNG-CDE ')'               05230007
                            MOVE 'SKU NOT ON XLT_SKU OR XLT_PK'         05240018
                                    TO OR-PO-TEXT                       05250018
                            PERFORM 5600-FORMAT-OUTPUT                  05260018
048100                  ELSE                                            05270008
048200                      SET PS-SKU-ON-BOTH-TBL TO TRUE              05280008
048300                  END-IF                                          05290008
048400              END-IF                                              05300008
048500         WHEN SQLCODE = -904                                      05310000
048600         WHEN SQLCODE = -911                                      05320000
048700         WHEN SQLCODE = -913                                      05330000
048800         WHEN SQLWARN0 NOT EQUAL SPACE                            05340000
048900         WHEN SQLCODE  NOT EQUAL ZERO                             05350000
049000              MOVE '3600-CHECK-XLT-SKU'                           05360000
049100                                 TO PV-PARAGRAPH-NAME             05370000
049200              MOVE 'SELECT TO XLT_SKU'                            05380000
049300                                 TO PV-DB2-OPERATION-MSG-1        05390000
049400              MOVE 'XLT_SKU'     TO PV-DB2-TABLE-NAME             05400000
049500              PERFORM 9999-DB2-ABEND                              05410000
049600     END-EVALUATE.                                                05420000
049700                                                                  05430000
049800 4000-CHECK-XLT-PK.                                               05440000
049900                                                                  05450000
050000     INITIALIZE DCLXLT00007.                                      05460000
050100                                                                  05470000
050200     EXEC SQL                                                     05480000
050300         SELECT LAST_UPD_TMST                                     05490000
050400           INTO :XLT00007-LAST-UPD-TMST                           05500000
050500           FROM XLT_PK                                            05510000
050600          WHERE PK_SKU_NBR     =  :DK-SKU-NBR                     05520002
050700     END-EXEC                                                     05530000
050800                                                                  05540000
050900     EVALUATE TRUE                                                05550000
051000         WHEN SQLCODE = +0                                        05560000
051100         WHEN SQLCODE = -811                                      05570000
051200              SET PS-SKU-ON-XLT-PK TO TRUE                        05580000
051300              SET PS-SKU-ON-XLT-PK-TBL TO TRUE                    05590008
051400         WHEN SQLCODE = +100                                      05600000
051500              IF  XL023-XXT-PO-PK-SKU                             05610000
051600                  MOVE DK-SKU-NBR TO PV-DISPLAY-FIELD             05620000
051700                  DISPLAY 'SKU NOT ON XLT_PK: ' PV-DISPLAY-FIELD  05630000
051800              END-IF                                              05640000
051900         WHEN SQLCODE = -904                                      05650000
052000         WHEN SQLCODE = -911                                      05660000
052100         WHEN SQLCODE = -913                                      05670000
052200         WHEN SQLWARN0 NOT EQUAL SPACE                            05680000
052300         WHEN SQLCODE  NOT EQUAL ZERO                             05690000
052400              MOVE '4000-CHECK-XLT-PK'                            05700000
052500                                 TO PV-PARAGRAPH-NAME             05710000
052600              MOVE 'SELECT TO XLT_PK'                             05720000
052700                                 TO PV-DB2-OPERATION-MSG-1        05730000
052800              MOVE 'XLT_PK'      TO PV-DB2-TABLE-NAME             05740000
052900              PERFORM 9999-DB2-ABEND                              05750000
053000     END-EVALUATE.                                                05760000
053100                                                                  05770000
053200 4400-CHECK-TPURITM-NON-PACK.                                     05780001
053300                                                                  05790000
053400     INITIALIZE DCLTPURITM.                                       05800000
053500                                                                  05810000
053600     EXEC SQL                                                     05820000
053700         SELECT PO_LNE_NBR                                        05830000
053800           INTO :PURITM-PO-LNE-NBR                                05840000
053900           FROM TPURITM                                           05850001
054000          WHERE PO_NBR         =  :DK-PO-NBR                      05860001
054100            AND RMS_PO_SKU_NBR =  :DK-SKU-NBR                     05870001
054200            AND PO_PREPK_ID = 0                                   05880001
054300     END-EXEC                                                     05890001
054400                                                                  05900001
054500     EVALUATE TRUE                                                05910001
054600         WHEN SQLCODE = +0                                        05920001
054700         WHEN SQLCODE = -811                                      05930001
054800              SET PS-PO-SKU-ON-TPURITM TO TRUE                    05940009
054900         WHEN SQLCODE = +100                                      05950001
055000              IF  XL023-XXT-PO-SKU                                05960001
055100                  IF  PS-PO-PREV-PACK-PO                          05970009
055200                      MOVE DK-PO-NBR  TO PV-DISPLAY-FIELD         05980009
055300                      MOVE DK-SKU-NBR TO PV-DISPLAY-FIELD2        05990009
055400                      DISPLAY 'SKU NOT ON PO:  PO '               06000009
055500                              PV-DISPLAY-FIELD                    06010009
055600                              ' (' PURCHS-PKGNG-CDE ') '          06020009
055700                              ' SKU: ' PV-DISPLAY-FIELD2          06030009
055800                              ' (' PS-SKU-TBL-SW ')'              06040012
055900                              ' PO WAS PREVIOUSLY A PACK PO'      06050009
                            MOVE 'SKU NOT ON PO' TO OR-PO-TEXT          06060018
                            MOVE 'PO WAS PREV PK' TO OR-PO-TEXT-PACK    06070018
                            MOVE OR-PO-TYPE TO PURCHS-PKGNG-CDE         06080031
056000                  ELSE                                            06090009
056100                      MOVE DK-PO-NBR  TO PV-DISPLAY-FIELD         06100009
056200                      MOVE DK-SKU-NBR TO PV-DISPLAY-FIELD2        06110009
056300                      DISPLAY 'SKU NOT ON PO:  PO '               06120009
056400                              PV-DISPLAY-FIELD                    06130009
056500                              ' (' PURCHS-PKGNG-CDE ') '          06140009
056600                              ' SKU: ' PV-DISPLAY-FIELD2          06150009
056700                              ' (' PS-SKU-TBL-SW ')'              06160012
                            MOVE 'SKU NOT ON PO' TO OR-PO-TEXT          06170018
                            MOVE OR-PO-TYPE TO PURCHS-PKGNG-CDE         06180031
056800                  END-IF                                          06190010
056900              END-IF                                              06200001
057000              PERFORM 5600-FORMAT-OUTPUT                          06210001
057100         WHEN SQLCODE = -904                                      06220001
057200         WHEN SQLCODE = -911                                      06230001
057300         WHEN SQLCODE = -913                                      06240001
057400         WHEN SQLWARN0 NOT EQUAL SPACE                            06250001
057500         WHEN SQLCODE  NOT EQUAL ZERO                             06260001
057600              MOVE '4400-CHECK-TPURITM-NON-PACK'                  06270001
057700                                 TO PV-PARAGRAPH-NAME             06280001
057800              MOVE 'SELECT TO TPURITM'                            06290001
057900                                 TO PV-DB2-OPERATION-MSG-1        06300001
058000              MOVE 'TPURITM'     TO PV-DB2-TABLE-NAME             06310001
058100              PERFORM 9999-DB2-ABEND                              06320001
058200     END-EVALUATE.                                                06330001
058300                                                                  06340000
058400 5600-FORMAT-OUTPUT.                                              06350001
058500                                                                  06360001
058600     MOVE DK-PO-NBR TO OR-PO-NBR.                                 06370001
058700     MOVE DK-SKU-NBR TO OR-SKU-NBR.                               06380001
058800     IF  PS-SKU-ON-XLT-SKU                                        06390001
058900         MOVE 'S' TO OR-SKU-TYPE                                  06400001
059000     ELSE                                                         06410001
059100         IF  PS-SKU-ON-XLT-PK                                     06420001
059200             MOVE 'P' TO OR-SKU-TYPE                              06430001
059300         ELSE                                                     06440001
059400             MOVE 'U' TO OR-SKU-TYPE                              06450001
059500         END-IF                                                   06460001
059600     END-IF.                                                      06470001
059700                                                                  06480001
059800     MOVE PURCHS-PKGNG-CDE TO OR-PO-TYPE.                         06490020
059900                                                                  06500003
060500                                                                  06510001
                                                                        06560041
060600     WRITE OUTPUT-RECORD FROM OR-OUTPUT-RECORD.                   06570017
060700     ADD +1 TO PV-OUTPUT-WRITTEN.                                 06580001
           ADD +1 TO PV-OUTPUT-SKU-COUNT.                               06581044
060800                                                                  06590001
058400 5500-FORMAT-OUTPUT.                                              06600013
058500                                                                  06610013
058600     MOVE DK-PO-NBR TO OR-PO-NBR-PO.                              06620021
059900                                                                  06630013
060500                                                                  06640013
                                                                        06690041
060600     WRITE OUTPUT-RECORD FROM OR-OUTPUT-PO-RECORD.                06700017
060700     ADD +1 TO PV-OUTPUT-WRITTEN.                                 06710013
           ADD +1 TO PV-OUTPUT-PO-COUNT.                                06711044
                                                                        06720041
060800                                                                  06780041
060900                                                                  06790013
061000 9050-READ-INPUT-FILE.                                            06800000
061100                                                                  06810000
061200     READ INPUT-FILE                                              06820000
061300          INTO XL023-COMPARE-RECORD                               06830000
061400          AT END                                                  06840000
061500              SET PS-INPUT-EOF TO TRUE.                           06850000
           INITIALIZE OR-OUTPUT-RECORD.                                 06860017
           INITIALIZE OR-OUTPUT-PO-RECORD.                              06870017
061600                                                                  06880000
061700     IF PS-INPUT-EOF                                              06890000
061800         CONTINUE                                                 06900000
061900     ELSE                                                         06910000
062000         ADD +1 TO PV-INPUT-READ                                  06920003
062100                   PV-INPUT-CHECK-CNT                             06930000
062200         IF  PV-INPUT-CHECK-CNT = 2000                            06940000
062300             MOVE PV-INPUT-READ TO                                06950003
062400                  DP-OUT-CNT                                      06960000
062500             DISPLAY 'PROGRAM PROGRESS READS: '                   06970000
062600                     DP-OUT-CNT                                   06980000
062700             MOVE +0 TO PV-INPUT-CHECK-CNT                        06990000
062800         END-IF                                                   07000000
062900     END-IF.                                                      07010000
063000                                                                  07020000
063100                                                                  07030000
171410******************************************************************07031061
171410* 9100-GET-PARM-VALUE.                                           *07032061
171410*  RETRIEVE THE PO LIM VALUE FROM THE PARM TABLE.                *07033061
171410******************************************************************07034061
171410 9100-GET-PARM-VALUE.                                             07035061
171410                                                                  07036061
171410     MOVE ZERO    TO KRPRPM-FUNC-QTY.                             07037061
171410                                                                  07038061
171410     EXEC SQL                                                     07039061
171410          SELECT FUNC_QTY                                         07039161
171410            INTO :KRPRPM-FUNC-QTY                                 07039261
171410            FROM TKRPRPM                                          07039361
171410           WHERE LOC_ID            = 90                           07039461
171410             AND SYS_PRC_FUNC_CDE  = 'XLPO'                       07039565
171410             AND INTFC_SYS_CDE     = 'KHL'                        07039661
171410             AND FUNC_PRC_STAT_CDE = 'AC'                         07039761
171410             AND (CURRENT_DATE BETWEEN DATE(FUNC_BEG_TMST)        07039861
171410                                   AND DATE(FUNC_END_TMST))       07039961
171410           WITH UR                                                07040061
171410     END-EXEC.                                                    07040161
171410                                                                  07040261
171410     EVALUATE TRUE                                                07040361
171410         WHEN SQLCODE = ZERO                                      07040461
171410         WHEN SQLCODE = +100                                      07040561
171410              MOVE KRPRPM-FUNC-QTY  TO PV-OUTPUT-LIMIT            07040661
171410                                                                  07041061
171410         WHEN SQLWARN0 NOT = SPACES                               07041161
171410         WHEN SQLCODE NOT = ZERO                                  07041261
171410         WHEN SQLCODE NOT = +100                                  07041361
171410         WHEN SQLCODE NOT = -811                                  07041461
057600              MOVE '9100-GET-PARM-VALUE'                          07041561
057700                                 TO PV-PARAGRAPH-NAME             07041661
057800              MOVE 'SELECT TO TKRPRPM'                            07041761
057900                                 TO PV-DB2-OPERATION-MSG-1        07041861
058000              MOVE 'TKRPRPM'     TO PV-DB2-TABLE-NAME             07041961
058100              PERFORM 9999-DB2-ABEND                              07042061
171410     END-EVALUATE.                                                07044361
063200* ************************************************************** *07045000
063300* * DISPLAY INFORMATION NEEDED FOR DEBUGGING/MAINTENANCE/SUPPORT *07050000
063400* * AND CCLSOE THE ABEND PROCESSOR IN THE EVENT THAT AN        * *07060038
063500* * SQL ERROR OR WARNING CODE OCCURS.                          * *07070000
063600* ************************************************************** *07080000
063700 9999-DB2-ABEND.                                                  07090000
063800                                                                  07100000
063900     DISPLAY PC-CURRENT-PROGRAM-NAME                              07110000
064000             ' 9999-DB2-ABEND'.                                   07120000
064100     DISPLAY PC-CURRENT-PROGRAM-NAME                              07130000
064200             ' ** ABEND           **'.                            07140000
064300     DISPLAY PC-CURRENT-PROGRAM-NAME                              07150000
064400             ' ** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.       07160000
064500     DISPLAY PC-CURRENT-PROGRAM-NAME                              07170000
064600             ' ** TABLES AFFECTED ** = ' PV-DB2-TABLE-NAME.       07180000
064700     DISPLAY PC-CURRENT-PROGRAM-NAME                              07190000
064800             ' ** OPERATION       ** = ' PV-DB2-OPERATION-MSG-1.  07200000
064900                                                                  07210000
065000     DISPLAY PC-CURRENT-PROGRAM-NAME                              07220000
065100             ' ** SQLCODE         ** = ' SQLCODE.                 07230000
065200     MOVE SQLCODE TO PV-SQLCODE.                                  07240000
065300     DISPLAY PC-CURRENT-PROGRAM-NAME                              07250000
065400             ' ** PV-SQLCODE      ** = ' PV-SQLCODE '.'.          07260000
065500                                                                  07270000
065600     DISPLAY PC-CURRENT-PROGRAM-NAME                              07280000
065700             ' ** SQLWARN0        ** = ' SQLWARN0 '.'.            07290000
065800                                                                  07300000
065900                                                                  07310000
066000*----------------------------------------------------------------*07320000
066100* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-   *07330000
066200* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE        *07340000
066300* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE    *07350000
066400* FORMAT.                                                        *07360000
066500*----------------------------------------------------------------*07370000
066600     COPY DPPD004.                                                07380000
066700                                                                  07390000
066800                                                                  07400000
066900*----------------------------------------------------------------*07410000
067000* CALL ABEND                                                     *07420000
067100*----------------------------------------------------------------*07430000
067200     MOVE +4013                  TO ABEND-CODE.                   07440000
067300     CALL 'ILBOABN0' USING ABEND-CODE.                            07450000
067400*                                                                 07460000
