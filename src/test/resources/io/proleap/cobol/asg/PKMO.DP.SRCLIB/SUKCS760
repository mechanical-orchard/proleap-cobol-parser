000100*-----------------------*                                         00010004
000200 IDENTIFICATION DIVISION.                                         00020004
000300*-----------------------*                                         00030004
000400 PROGRAM-ID.    SUKCS760.                                         00040004
000500 AUTHOR.        LYNN MCADAMS.                                     00050004
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060004
000700 DATE-WRITTEN.  AUGUST, 2003.                                     00070004
000800 DATE-COMPILED.                                                   00080004
000900*----------------------------------------------------------------*00090004
001000*    S760 - FREE ASTRAY EXCEPTIONS CRITERIA SPECIFICATION        *00100004
001100*                                                                *00110004
001200*    THIS PROGRAM ALLOWS THE USER TO ENTER DATA TO BE USED BY    *00120004
001300*    SUBSEQUENT PROGRAMS TO CREATE A LIST.                       *00130004
001400*----------------------------------------------------------------*00140004
001410*----------------------------------------------------------------*00141099
001420*    CHANGES                                                     *00142099
001430*    MADE BY: CHERI PARMLEY                                      *00143099
001440*    DATE:    09/25/2014                                         *00144099
001450*                                                                *00145099
001460*    CHANGES THRU OUT THE PROGRAM TO INCREASE THE SIZE OF PO#    *00146099
001470*    FROM 7 DIGITS TO 8 DIGITS. TAGGED WITH *CLP 09/25/2014      *00147099
001480*                                                                *00148099
001490*----------------------------------------------------------------*00149099
263968* CHANGED 11/15/2021    BY JIM HUNTER      WR: CHG0263968         00149299
263968* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00149399
263968* MAKING THE CALL DYNAMIC VS STATIC.                              00149499
001130*                                                                 00149599
001110* CHANGED 01/09/2023    BY JEAN KURK       WR: CHG0278099         00149699
001120* CHANGE CALL OF DPKCS030 TO BE DYNAMIC                           00149799
263968*---------------------------------------------------------------* 00149899
001500 ENVIRONMENT DIVISION.                                            00150004
001600 DATA DIVISION.                                                   00160004
001700                                                                  00170004
001800 WORKING-STORAGE SECTION.                                         00180004
001900                                                                  00190004
002000 01  DK-DB2-KEYS.                                                 00200004
002100     05  DK-OPER-UNT-ID            PIC S9(04) COMP VALUE +0.      00210004
002200     05  DK-FCLTY-ID               PIC S9(04) COMP VALUE +0.      00220004
002300     05  DK-SCAC-ID                PIC  X(04)  VALUE SPACES.      00230099
002400     05  DK-TRIP-ID                PIC S9(09)  VALUE +0 COMP.     00240004
002500     05  DK-TRIP-STATUS            PIC  X(02)  VALUE SPACES.      00250004
002600     05  DK-TRLR-NBR               PIC  X(10)  VALUE SPACES.      00260099
002610*CLP 09/25/2014                                                   00261099
002700     05  DK-PO-NBR                 PIC S9(08)  VALUE +0 COMP.     00270099
002800     05  DK-REC-SEQ-NBR            PIC S9(09)  VALUE +0 COMP.     00280004
002900     05  DK-SERIAL-SHIP-CDE        PIC S9(18)V COMP-3.            00290004
003000     05  DK-SERIAL-SHIP-CDE-NUM    PIC S9(18)  COMP-3.            00300099
003100                                                                  00310099
003200 01  PV-PROGRAM-VARIABLES.                                        00320004
003300     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     00330099
003400                                                     COMP SYNC.   00340099
003500     05  PV-CICS-RESP                    PIC S9(09)  VALUE ZEROES 00350099
003600                                                     COMP SYNC.   00360099
003700     05  PV-USER-LOCATION                PIC  9(04) VALUE ZEROES. 00370099
003800     05  PV-COUNT-SEQ              PIC S9(09)  VALUE ZEROES       00380099
003900                                               COMP.              00390099
004000     05  PV-SUB1                         PIC S9(4) COMP SYNC.     00400099
004100     05  PV-SUB2                         PIC S9(4) COMP SYNC.     00410099
004200                                                                  00420099
004300     05  PV-INPUT-FIELD                  PIC X(18).               00430099
004400     05  FILLER REDEFINES PV-INPUT-FIELD.                         00440099
004500         10  PV-INPUT-BYTES OCCURS 18 TIMES.                      00450099
004600             15  PV-IN-BYTE              PIC X(01).               00460099
004700                                                                  00470099
004800     05  PV-OUTPUT-FIELD                 PIC X(18).               00480099
004900     05  FILLER REDEFINES PV-OUTPUT-FIELD.                        00490099
005000         10  PV-OUTPUT-BYTE OCCURS 18 TIMES.                      00500099
005100             15  PV-OUT-BYTE             PIC X(01).               00510099
005200                                                                  00520099
005300     05  PV-CURRENT-DATE           PIC  X(10)  VALUE SPACES.      00530099
005400     05  PV-CURRENT-DATE-R REDEFINES PV-CURRENT-DATE.             00540099
005500         10  PV-CURRENT-YY         PIC  9(04).                    00550099
005600         10  FILLER                PIC  X(01).                    00560099
005700         10  PV-CURRENT-MM         PIC  9(02).                    00570099
005800         10  FILLER                PIC  X(01).                    00580099
005900         10  PV-CURRENT-DD         PIC  9(02).                    00590099
006000                                                                  00600099
006100     05  PV-DEFAULT-FROM-DATE      PIC  X(10)  VALUE SPACES.      00610099
006200     05  PV-DEFAULT-DATE-R REDEFINES PV-DEFAULT-FROM-DATE.        00620099
006300         10  PV-DFLT-YY            PIC  9(04).                    00630099
006400         10  FILLER                PIC  X(01).                    00640099
006500         10  PV-DFLT-MM            PIC  9(02).                    00650099
006600         10  FILLER                PIC  X(01).                    00660099
006700         10  PV-DFLT-DD            PIC  9(02).                    00670099
006800                                                                  00680099
006900     05  PV-CURR-DATE-HOLD.                                       00690099
007000         10  PV-CURR-YY            PIC  9(04)  VALUE ZEROES.      00700099
007100         10  PV-CURR-MM            PIC  9(02)  VALUE ZEROES.      00710099
007200         10  PV-CURR-DD            PIC  9(02)  VALUE ZEROES.      00720099
007300                                                                  00730099
007400     05  PV-FROM-DATE-HOLD.                                       00740099
007500         10  PV-FROM-YY            PIC  9(04)  VALUE ZEROES.      00750099
007600         10  PV-FROM-MM            PIC  9(02)  VALUE ZEROES.      00760099
007700         10  PV-FROM-DD            PIC  9(02)  VALUE ZEROES.      00770099
007800                                                                  00780099
007900     05  PV-TO-DATE-HOLD.                                         00790099
008000         10  PV-TO-YY              PIC  9(04)  VALUE ZEROES.      00800099
008100         10  PV-TO-MM              PIC  9(02)  VALUE ZEROES.      00810099
008200         10  PV-TO-DD              PIC  9(02)  VALUE ZEROES.      00820099
008300                                                                  00830099
008400     05  PV-CICS-MSG-AREA          PIC X(100)  VALUE SPACES.      00840099
008500     05  PV-DISP-SSCC              PIC 9(18)   VALUE ZEROES.      00850099
008600     05  PV-DISP-OPER              PIC 9(04)   VALUE ZEROES.      00860099
008700     05  PV-DISP-TRIP              PIC 9(09)   VALUE ZEROES.      00870099
008710*CLP 09/25/2014                                                   00871099
008800     05  PV-DISP-PO                PIC 9(08)   VALUE ZEROES.      00880099
008900     05  PV-DISP-RCVR              PIC 9(04)   VALUE ZEROES.      00890099
009000                                                                  00900099
009100 01  DN-DB2-NULL-INDICATORS.                                      00910099
009200     05  DN-VEH-NBR                 PIC S9(04) COMP VALUE ZEROES. 00920099
009300                                                                  00930099
009400*-----------------------------------------------------------      00940099
009500*  SYSTEM MESSAGES                                                00950099
009600*-----------------------------------------------------------      00960099
009700*   00005 = INVALID VALUE                                         00970099
009800*   00007 = REQUIRED ENTRY                                        00980099
009900*   00008 = MUST BE NUMERIC                                       00990099
010000*   00009 = INVALID DATE                                          01000099
010100*   00330 = ENTRY OF A FIELD REQUIRED FOR FUNCTION SELECTED       01010099
010200*   00395 = "FROM" DATE MUST BE LESS THAN OR EQUAL TO THE "TO" DAT01020099
010300*   00726 = PURCHASE ORDER NOT FOUND                              01030099
010400*   00743 = TRIP DOES NOT EXIST                                   01040099
010500*   00955 = WRONG OPERATING UNIT/FACILITY FOR THIS RECEIVER       01050099
010600*   00973 = ONLY ONE MAY BE SELECTED                              01060099
010700*   01245 = PO NUMBER AND RECEIVER REQUIRED                       01070099
010800*   01551 = SCAC/TRAILER OR TRIP ID ARE REQUIRED FOR USE OF THIS F01080099
010900*   01698 = ONE MUST BE SELECTED                                  01090099
011000*   02479 = RECEIVER SEQUENCE NUMBER MUST BE GREATER THAN ZERO    01100099
011100*   02572 = INVALID VALUE - OPER UNIT ID MUST BE A DC LOCATI      01110099
011200*   02613 = INVALID TRAILER SERIAL NUMBER                         01120099
011300                                                                  01130099
011400 01  PC-PROGRAM-CONSTANTS.                                        01140099
011500     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE  'SU760A'.   01150099
011600     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE  'SUKM760 '. 01160099
011700     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE  'SUKCS760'. 01170099
011800     05  PC-CALENDAR-MODULE        PIC  X(08)  VALUE  'DPKUT500'. 01180099
011900     05  PC-LOCATION-MODULE        PIC  X(08)  VALUE  'XLKUT071'. 01190099
012000     05  PC-1                      PIC  X(04)  VALUE  '   1'.     01200099
012100     05  PC-03                     PIC  X(02)  VALUE  '03'.       01210099
012200     05  PC-DC                     PIC  X(02)  VALUE  'DC'.       01220099
012300     05  PC-TSYMSG-NUMBERS.                                       01230099
012400         10  PC-TSYMSG-00005       PIC  9(05)  VALUE  00005.      01240099
012500         10  PC-TSYMSG-00007       PIC  9(05)  VALUE  00007.      01250099
012600         10  PC-TSYMSG-00008       PIC  9(05)  VALUE  00008.      01260099
012700         10  PC-TSYMSG-00009       PIC  9(05)  VALUE  00009.      01270099
012800         10  PC-TSYMSG-00050       PIC  9(05)  VALUE  00050.      01280099
012900         10  PC-TSYMSG-00051       PIC  9(05)  VALUE  00051.      01290099
013000         10  PC-TSYMSG-00330       PIC  9(05)  VALUE  00330.      01300099
013100         10  PC-TSYMSG-00395       PIC  9(05)  VALUE  00395.      01310099
013200         10  PC-TSYMSG-00726       PIC  9(05)  VALUE  00726.      01320099
013300         10  PC-TSYMSG-00743       PIC  9(05)  VALUE  00743.      01330099
013400         10  PC-TSYMSG-00955       PIC  9(05)  VALUE  00955.      01340099
013500         10  PC-TSYMSG-00973       PIC  9(05)  VALUE  00973.      01350099
013600         10  PC-TSYMSG-01245       PIC  9(05)  VALUE  01245.      01360099
013700         10  PC-TSYMSG-01551       PIC  9(05)  VALUE  01551.      01370099
013800         10  PC-TSYMSG-01698       PIC  9(05)  VALUE  01698.      01380099
013900         10  PC-TSYMSG-02479       PIC  9(05)  VALUE  02479.      01390099
014000         10  PC-TSYMSG-02572       PIC  9(05)  VALUE  02572.      01400099
014100         10  PC-TSYMSG-02613       PIC  9(05)  VALUE  02613.      01410099
014200*                                                                 01420099
014300     05  PC-S                      PIC  X(01)  VALUE  'S'.        01430099
014400     05  PC-X                      PIC  X(01)  VALUE  'X'.        01440099
014500                                                                  01450099
014600 01  PS-PROGRAM-SWITCHES.                                         01460099
014700     05  PS-ERROR-SW               PIC  X(01)  VALUE  'N'.        01470099
014800         88  PS-ERROR                          VALUE  'Y'.        01480099
014900         88  PS-NO-ERROR                       VALUE  'N'.        01490099
015000     05  PS-SCAC-EXISTS-SW         PIC  X(01)  VALUE  'N'.        01500099
015100         88  PS-SCAC-EXISTS                    VALUE  'Y'.        01510099
015200         88  PS-SCAC-DOESNT-EXIST              VALUE  'N'.        01520099
015300     05  PS-TRAILER-EXISTS-SW      PIC  X(01)  VALUE  'N'.        01530099
015400         88  PS-TRAILER-EXISTS                 VALUE  'Y'.        01540099
015500         88  PS-TRAILER-DOESNT-EXIST           VALUE  'N'.        01550099
015600     05  PS-TRIP-EXISTS-SW         PIC  X(01)  VALUE  'N'.        01560099
015700         88  PS-TRIP-EXISTS                    VALUE  'Y'.        01570099
015800         88  PS-TRIP-DOESNT-EXIST              VALUE  'N'.        01580099
015900     05  PS-PO-EXISTS-SW           PIC  X(01)  VALUE  'N'.        01590099
016000         88  PS-PO-EXISTS                      VALUE  'Y'.        01600099
016100         88  PS-PO-DOESNT-EXIST                VALUE  'N'.        01610099
016200     05  PS-RECEIVER-EXISTS-SW     PIC  X(01)  VALUE  'N'.        01620099
016300         88  PS-RECEIVER-EXISTS                VALUE  'Y'.        01630099
016400         88  PS-RECEIVER-DOESNT-EXIST          VALUE  'N'.        01640099
016500     05  PS-SHIP-CDE-EXISTS-SW     PIC  X(01)  VALUE  'N'.        01650099
016600         88  PS-SHIP-CDE-EXISTS                VALUE  'Y'.        01660099
016700         88  PS-SHIP-CDE-DOESNT-EXIST          VALUE  'N'.        01670099
016800     05  PS-TRIP-OPER-ERROR-SW     PIC  X(01)  VALUE  'N'.        01680099
016900         88  PS-TRIP-OPER-ERROR-YES            VALUE  'Y'.        01690099
017000         88  PS-TRIP-OPER-ERROR-NO             VALUE  'N'.        01700099
017100                                                                  01710099
017200 01  PM-PROGRAM-MESSAGES.                                         01720099
017300     05  PM-ABEND-INFO-A.                                         01730099
017400         10  FILLER                PIC X(15)   VALUE              01740099
017500                                   'DP020-SRC-AID: '.             01750099
017600         10  PM-A-SRC-AID          PIC X(02)   VALUE  SPACES.     01760099
017700         10  FILLER                PIC X(19)   VALUE              01770099
017800                                   '. DP020-FK-ACTION: '.         01780099
017900         10  PM-A-FK-ACTION        PIC X(01)   VALUE  SPACES.     01790099
018000         10  FILLER                PIC X(22)   VALUE              01800099
018100                                   '. DP020-FK-DISPN-IND: '.      01810099
018200         10  PM-A-FK-DISPN         PIC X(01)   VALUE  SPACES.     01820099
018300         10  FILLER                PIC X(01)   VALUE '.'.         01830099
018400         10  FILLER                PIC X(19)   VALUE SPACES.      01840099
018500                                                                  01850099
018600*----------------------------------------------------------------*01860099
018700*    MAP LAYOUT                                                  *01870099
018800*----------------------------------------------------------------*01880099
018900     COPY SUKM760.                                                01890099
019000                                                                  01900099
019100*----------------------------------------------------------------*01910099
019200*    ATTRIBUTE SETTINGS COPYBOOK.                                *01920099
019300*----------------------------------------------------------------*01930099
019400     COPY DPWS015.                                                01940099
019500                                                                  01950099
019600*----------------------------------------------------------------*01960099
019700*    FUNCTION KEYS COPYBOOK                                      *01970099
019800*----------------------------------------------------------------*01980099
019900     COPY DPWS016.                                                01990099
020000                                                                  02000099
020100*----------------------------------------------------------------*02010099
020200*    CALENDAR ROUTINE                                            *02020099
020300*----------------------------------------------------------------*02030099
020400     COPY DPWS500.                                                02040099
020500                                                                  02050099
020600******************************************************************02060099
020700** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **02070099
020800** SUB-ROUTINE (DPKUT100).                                      **02080099
020900******************************************************************02090099
021000     COPY DPWS010I.                                               02100099
021100                                                                  02110099
021200******************************************************************02120099
021400** PARAMETERS FOR CALLING CICS ARCHITECTURE API                 **02140099
021500******************************************************************02150099
021600     COPY DPWS030.                                                02160099
021600     COPY DPWS930.                                                02161099
021700                                                                  02170099
021800******************************************************************02180099
021900** THE COPY BOOK FOR XLKUT071 - LOCATION HIERARCHY "BLACK BOX"  **02190099
022000******************************************************************02200099
022100     COPY XLWS071.                                                02210099
022200                                                                  02220099
022300***************************************************************** 02230099
022400*    STANDARD COMMAREA.                                           02240099
022500***************************************************************** 02250099
022600     COPY DPWS020.                                                02260099
022700     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02270099
022800                                                                  02280099
022900***************************************************************** 02290099
023000*    INTER-APPLICATION COMMAREA.                                  02300099
023100***************************************************************** 02310099
023200         10  INTER-APPL-COMM-AREA PIC X(200).                     02320099
023300     COPY SUWS046.                                                02330099
023400     COPY SUWS002.                                                02340099
023500***************************************************************** 02350099
023600*    SPECIFIC COMMMAREA FOR DSKCS601.                             02360099
023700***************************************************************** 02370099
023800         10  ASC-SPECIFIC-COMMAREA.                               02380099
023900             15  ASC-LIST-KEYS.                                   02390099
024000                 20  ASC-KEY-OPER-UNT-ID             PIC S9(04)   02400099
024100                                                     COMP.        02410099
024200                 20  ASC-KEY-FCLTY-ID                PIC S9(04)   02420099
024300                                                     COMP.        02430099
024400                 20  ASC-KEY-TRIP-ID                 PIC S9(09)   02440099
024500                                                     COMP-3.      02450099
024600             15  ASC-OPER-UNT-ID             PIC  X(04).          02460099
024700             15  ASC-OPER-UNT-ID-N REDEFINES ASC-OPER-UNT-ID      02470099
024800                                             PIC  Z(04).          02480099
024900             15  ASC-OPER-UNT-ID-9 REDEFINES ASC-OPER-UNT-ID      02490099
025000                                             PIC  9(04).          02500099
025100             15  ASC-FCLTY-NME               PIC  X(25).          02510099
025200             15  ASC-FCLTY-ID                PIC  X(04).          02520099
025300             15  ASC-FCLTY-ID-N REDEFINES ASC-FCLTY-ID            02530099
025400                                             PIC  Z(04).          02540099
025500             15  ASC-SCAC                    PIC  X(04).          02550099
025600             15  ASC-TRAILER                 PIC  X(10).          02560099
025700             15  ASC-TRAILER-N REDEFINES ASC-TRAILER              02570099
025800                                             PIC  Z(10).          02580099
025900             15  ASC-TRIP-ID                 PIC  X(09).          02590099
026000             15  ASC-TRIP-ID-N REDEFINES ASC-TRIP-ID              02600099
026100                                             PIC  Z(09).          02610099
026110*CLP 09/25/2014                                                   02611099
026200             15  ASC-PO-NBR                  PIC  X(08).          02620099
026300             15  ASC-PO-NBR-N REDEFINES ASC-PO-NBR                02630099
026400                                             PIC  Z(08).          02640099
026500             15  ASC-REC-SEQ-NBR             PIC  X(4).           02650099
026600             15  ASC-REC-SEQ-NBR-N REDEFINES                      02660099
026700                         ASC-REC-SEQ-NBR     PIC  Z(4).           02670099
026800             15  ASC-SERIAL-SHIP-CDE         PIC  X(18).          02680099
026900             15  ASC-SERIAL-SHIP-CDE-N REDEFINES                  02690099
027000                 ASC-SERIAL-SHIP-CDE         PIC  9(18).          02700099
027100                                                                  02710099
027200             15  ASC-SEL-1                   PIC  X(01).          02720099
027300             15  ASC-CURR-DATE.                                   02730099
027400                 20  ASC-CURR-MM             PIC  X(02).          02740099
027500                 20  ASC-CURR-DD             PIC  X(02).          02750099
027600                 20  ASC-CURR-YY             PIC  X(04).          02760099
027700             15  ASC-SEL-2                   PIC  X(01).          02770099
027800             15  ASC-FROM-DATE.                                   02780099
027900                 20  ASC-FROM-MM             PIC  X(02).          02790099
028000                 20  ASC-FROM-DD             PIC  X(02).          02800099
028100                 20  ASC-FROM-YY             PIC  X(04).          02810099
028200             15  ASC-TO-DATE.                                     02820099
028300                 20  ASC-TO-MM               PIC  X(02).          02830099
028400                 20  ASC-TO-DD               PIC  X(02).          02840099
028500                 20  ASC-TO-YY               PIC  X(04).          02850099
028600                                                                  02860099
028700             15  ASC-LIST-SEQ-IND            PIC  X(01).          02870099
028800                 88  ASC-SCAC-TRLR-SEQ       VALUE 'S'.           02880099
028900                 88  ASC-DATE-ASC-SEQ        VALUE 'A'.           02890099
029000                 88  ASC-DATE-DES-SEQ        VALUE 'D'.           02900099
029100             15  ASC-SEQ-1                   PIC  X(01).          02910099
029200             15  ASC-SEQ-2                   PIC  X(01).          02920099
029300             15  ASC-SEQ-3                   PIC  X(01).          02930099
029400                                                                  02940099
029500             15  ASC-LIST-VALID-ENTRY        PIC  X(01).          02950099
029600                 88  ASC-LIST-SEQ-VALID      VALUE 'X'.           02960099
029610*CLP 09/25/2014                                                   02961099
029700             15  FILLER                      PIC  X(43).          02970099
029800                                                                  02980099
029900*----------------------------------------------------------------*02990099
030000*    ABEND PROCESSING COPYBOOK.                                  *03000099
030100*----------------------------------------------------------------*03010099
030200     COPY DPWS013.                                                03020099
030300                                                                  03030099
030400*----------------------------------------------------------------*03040099
030500*    DB2 AREA FOR EXTERNAL ENTITY TABLE                          *03050099
030600*----------------------------------------------------------------*03060099
030700     EXEC SQL                                                     03070099
030800          INCLUDE TEXTENT                                         03080099
030900     END-EXEC.                                                    03090099
031000                                                                  03100099
031100*----------------------------------------------------------------*03110099
031200*    DB2 AREA FOR TRIP TABLE                                     *03120099
031300*----------------------------------------------------------------*03130099
031400     EXEC SQL                                                     03140099
031500          INCLUDE TVHTRIP                                         03150099
031600     END-EXEC.                                                    03160099
031700                                                                  03170099
031800*----------------------------------------------------------------*03180099
031900*    DB2 AREA FOR TRIP STATUS TABLE                              *03190099
032000*----------------------------------------------------------------*03200099
032100     EXEC SQL                                                     03210099
032200          INCLUDE TTRIPST                                         03220099
032300     END-EXEC.                                                    03230099
032400                                                                  03240099
032500*----------------------------------------------------------------*03250099
032600*    DB2 AREA FOR SHIP UNIT TABLE                                *03260099
032700*----------------------------------------------------------------*03270099
032800     EXEC SQL                                                     03280099
032900          INCLUDE TSHPUNT                                         03290099
033000     END-EXEC.                                                    03300099
033100                                                                  03310099
033200*----------------------------------------------------------------*03320099
033300*    DB2 AREA FOR VEHICLE TABLE                                  *03330099
033400*----------------------------------------------------------------*03340099
033500     EXEC SQL                                                     03350099
033600          INCLUDE TVEHICL                                         03360099
033700     END-EXEC.                                                    03370099
033800                                                                  03380099
033900*----------------------------------------------------------------*03390099
034000*    DB2 AREA FOR SHIPMENT PO TABLE                               03400099
034100*----------------------------------------------------------------*03410099
034200     EXEC SQL                                                     03420099
034300          INCLUDE TSHPTPO                                         03430099
034400     END-EXEC.                                                    03440099
034500                                                                  03450099
034600*----------------------------------------------------------------*03460099
034700*    DB2 AREA FOR RECEIV   TABLE                                  03470099
034800*----------------------------------------------------------------*03480099
034900     EXEC SQL                                                     03490099
035000          INCLUDE TRECEIV                                         03500099
035100     END-EXEC.                                                    03510099
035200                                                                  03520099
035300*-----------------------------------------------------------------03530099
035400*  PARM TABLE                                                     03540099
035500*-----------------------------------------------------------------03550099
035600     EXEC SQL                                                     03560099
035700          INCLUDE TKRPRPM                                         03570099
035800     END-EXEC.                                                    03580099
035900                                                                  03590099
036000*--------------------------------------------------------------   03600099
036100*  COMMUNICATION AREAS FOR DB2                                    03610099
036200*--------------------------------------------------------------   03620099
036300     EXEC SQL                                                     03630099
036400         INCLUDE SQLCA                                            03640099
036500     END-EXEC.                                                    03650099
036600                                                                  03660099
036700*----------------------------------------------------------------*03670099
036800 LINKAGE SECTION.                                                 03680099
036900                                                                  03690099
037000 01  DFHCOMMAREA.                                                 03700099
037100     05  FILLER                         OCCURS  1 TO 4072 TIMES   03710099
037200                                        DEPENDING ON EIBCALEN.    03720099
037300         10  FILLER                     PIC X.                    03730099
037400                                                                  03740099
037500                                                                  03750099
037600 PROCEDURE DIVISION.                                              03760099
037700***************************************************************** 03770099
037800** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 03780099
037900** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 03790099
038000** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 03800099
038100**                                                             ** 03810099
038200** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 03820099
038300** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 03830099
038400***************************************************************** 03840099
038500 0000-MAIN-MODULE.                                                03850099
038600     INITIALIZE DP030-CICS-API-FIELDS.                            03860099
038700     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       03870099
038800     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          03880099
038900     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         03890099
039000     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       03900099
039100     MOVE LENGTH OF SU760AI        TO DP030-MAP-LENGTH (1).       03910099
039200     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     03920099
039300     PERFORM 0001-CALL-CICS-ARCH-API.                             03930099
039400*                                                                 03940099
039500     PERFORM 1000-CONTROL-PROCESSING                              03950099
039600*                                                                 03960099
039700     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     03970099
039800     PERFORM 0001-CALL-CICS-ARCH-API.                             03980099
039900                                                                  03990099
040000 0001-CALL-CICS-ARCH-API.                                         04000099
040100*    CALL 'DPKCS030' USING DFHEIBLK                               04010099
040100     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      04011099
040200                           DFHCOMMAREA                            04020099
040300                           DP030-CICS-API-FIELDS                  04030099
040400                           DP020-STANDARD-COMMAREA                04040099
040500                           SU760AI.                               04050099
040600*                                                                 04060099
040700     IF  DP030-RC-CALL-SUCCESSFUL                                 04070099
040800         CONTINUE                                                 04080099
040900     ELSE                                                         04090099
041000         SET DP013-NO-ROLLBACK                                    04100099
041100             DP013-XCTL-DISPLAY-RESTART                           04110099
041200             DP013-CICS-ABEND      TO TRUE                        04120099
041300         MOVE 'BEFORE 0000-MAIN-MODULE'                           04130099
041400                                   TO DP013-PARAGRAPH             04140099
041500*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX04150099
041600*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      04160099
041500         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O04161099
041600-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      04162099
041700         MOVE DP030-RETURN-CODE                                   04170099
041800                                   TO DP013-MESSAGE-TEXT (3)      04180099
041900         PERFORM DP013-0000-PROCESS-ABEND                         04190099
042000     END-IF.                                                      04200099
042100                                                                  04210099
042200*----------------------------------------------------------------*04220099
042300*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *04230099
042400*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *04240099
042500*----------------------------------------------------------------*04250099
042600                                                                  04260099
042700 1000-CONTROL-PROCESSING.                                         04270099
042800                                                                  04280099
042900     EVALUATE TRUE                                                04290099
043000         WHEN DP020-NEXT-ACT-INITIAL                              04300099
043100         WHEN DP020-NEXT-ACT-RETURN                               04310099
043200             INITIALIZE ASC-SPECIFIC-COMMAREA                     04320099
043300             MOVE DP020-LOCATION-NBR TO PV-USER-LOCATION          04330099
043400             MOVE PV-USER-LOCATION TO ASC-OPER-UNT-ID             04340099
043500                                      ASC-KEY-OPER-UNT-ID         04350099
043600                                      DK-OPER-UNT-ID              04360099
043700             MOVE 1                TO ASC-FCLTY-ID-N              04370099
043800                                      ASC-KEY-FCLTY-ID            04380099
043900             PERFORM 3030-CALL-LOCATION-MODULE                    04390099
044000             PERFORM 4000-BUILD-INITIAL-PANEL                     04400099
044100                                                                  04410099
044200                                                                  04420099
044300         WHEN DP020-NEXT-ACT-READ-MAP                             04430099
044400             PERFORM 2000-FKEY-PROCESSING                         04440099
044500                                                                  04450099
044600         WHEN OTHER                                               04460099
044700             SET DP013-LOGIC-ABEND                                04470099
044800                 DP013-NO-ROLLBACK TO TRUE                        04480099
044900             MOVE '1000-CONTROL-PROCESSING'                       04490099
045000                                   TO  DP013-PARAGRAPH            04500099
045100             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   04510099
045200                                   TO  DP013-MESSAGE-TEXT(1)      04520099
045300             MOVE DP020-NEXT-APPL-ACTIVITY                        04530099
045400                                   TO DP013-MESSAGE-TEXT(2)       04540099
045500             PERFORM DP013-0000-PROCESS-ABEND                     04550099
045600     END-EVALUATE.                                                04560099
045700                                                                  04570099
045800*----------------------------------------------------------------*04580099
045900* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*04590099
046000* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*04600099
046100* EDITS.                                                         *04610099
046200*----------------------------------------------------------------*04620099
046300                                                                  04630099
046400 2000-FKEY-PROCESSING.                                            04640099
046500                                                                  04650099
046600     EVALUATE TRUE                                                04660099
046700                                                                  04670099
046800         WHEN DP020-SRC-AID = DP016-CLEAR                         04680099
046900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   04690099
047000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 04700099
047100                                                                  04710099
047200         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     04720099
047300             INITIALIZE ASC-SPECIFIC-COMMAREA                     04730099
047400             MOVE DP020-LOCATION-NBR TO PV-USER-LOCATION          04740099
047500             MOVE PV-USER-LOCATION TO ASC-OPER-UNT-ID             04750099
047600                                      ASC-KEY-OPER-UNT-ID         04760099
047700                                      DK-OPER-UNT-ID              04770099
047800             MOVE 1                TO ASC-FCLTY-ID-N              04780099
047900                                      ASC-KEY-FCLTY-ID            04790099
048000             PERFORM 3200-RESET-ATTRIBUTES                        04800099
048100             PERFORM 4000-BUILD-INITIAL-PANEL                     04810099
048200                                                                  04820099
048300         WHEN OTHER                                               04830099
048400             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 04840099
048500             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   04850099
048600                                                                  04860099
048700             IF  PS-NO-ERROR                                      04870099
048800                 SET DP030-CONTINUE-GO TO TRUE                    04880099
048900                 PERFORM 2100-CHECK-FUNCTION-KEY                  04890099
049000             ELSE                                                 04900099
049100                 SET DP030-OVERRIDE-GO TO TRUE                    04910099
049200             END-IF                                               04920099
049300     END-EVALUATE.                                                04930099
049400                                                                  04940099
049500******************************************************************04950099
049600** ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED     **04960099
049700** FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED **04970099
049800** FROM THE CICS ARCHITECTURE API.                              **04980099
049900******************************************************************04990099
050000 2100-CHECK-FUNCTION-KEY.                                         05000099
050100                                                                  05010099
050200     EVALUATE TRUE                                                05020099
050300                                                                  05030099
050400* ENTER                                                           05040099
050500         WHEN DP020-SRC-AID = DP016-ENTER                         05050099
050600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 05060099
050700                                                                  05070099
050800******************                                                05080099
050900*F17 PKSLPLST - -SERIAL-SHIP CDE REQUIRED                         05090099
051000*PACKSLIP LIST SCREEN (RCKCS213)                                  05100099
051100******************                                                05110099
051200*                                                                 05120099
051300         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              05130099
051400             IF ASC-SERIAL-SHIP-CDE-N > 0                         05140099
051500                 MOVE ASC-SERIAL-SHIP-CDE-N  TO SU046-SHIPT-UNT-ID05150099
051600             ELSE                                                 05160099
051700                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  05170099
051800                 SET DP020-MSG-FATAL         TO TRUE              05180099
051900                 SET DP030-OVERRIDE-GO       TO TRUE              05190099
052000                 MOVE DP015-UNP-NUM-BRT-MDT  TO ASERSHPA          05200099
052100                 MOVE DP015-REVERSE          TO ASERSHPH          05210099
052200                 MOVE DP015-RED              TO ASERSHPC          05220099
052300                 MOVE -1                     TO ASERSHPL          05230099
052400                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              05240099
052500             END-IF                                               05250099
052600                                                                  05260099
052700*                                                                 05270099
052800*************                                                     05280099
052900*F22 CTNDTLST -SERIAL-SHIP CDE REQUIRED                           05290099
053000*CARTON DETAIL LIST SCREEN (SUKCS554)                             05300099
053100*************                                                     05310099
053200         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              05320099
053300             IF ASC-SERIAL-SHIP-CDE  = SPACES OR ZEROES           05330099
053400                 INITIALIZE SU002-INTER-APPL-COMMAREA             05340099
053500                 SET PS-ERROR                                     05350099
053600                     DP020-MSG-FATAL  TO TRUE                     05360099
053700                 MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER         05370099
053800                 MOVE DP015-UNP-ALP-BRT-OFF                       05380099
053900                                      TO ASERSHPA                 05390099
054000                 MOVE DP015-RED       TO ASERSHPC                 05400099
054100                 MOVE DP015-REVERSE   TO ASERSHPH                 05410099
054200                 MOVE -1              TO ASERSHPL                 05420099
054300                 SET DP030-SET-CURSOR-APPL-1                      05430099
054400                                      TO TRUE                     05440099
054500                 SET DP030-OVERRIDE-GO TO TRUE                    05450099
054600             ELSE                                                 05460099
054700                 PERFORM 2110-PREPARE-INTER-APPL-COMM             05470099
054800             END-IF                                               05480099
054900                                                                  05490099
055000*************                                                     05500099
055100*F23 PORCVLST                                                     05510099
055200*UNRESOLVED FREE ASTRAY SCREEN (SUKCS761)                         05520099
055300*************                                                     05530099
055400         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              05540099
055500         IF ASC-SCAC > SPACES        OR                           05550099
055600            ASC-TRAILER > SPACES     OR                           05560099
055700            ASC-TRIP-ID > ZEROES     OR                           05570099
055800            ASC-PO-NBR > SPACES      OR                           05580099
055900            ASC-REC-SEQ-NBR > SPACES OR                           05590099
056000            ASC-SERIAL-SHIP-CDE > ZEROES                          05600099
056100                                                                  05610099
056200             IF PS-TRAILER-EXISTS OR PS-TRIP-EXISTS OR            05620099
056300*               (PS-PO-EXISTS AND PS-RECEIVER-EXISTS)             05630099
056400                (PS-PO-EXISTS OR PS-RECEIVER-EXISTS)              05640099
056500                PERFORM 2110-PREPARE-INTER-APPL-COMM              05650099
056600             ELSE                                                 05660099
056700                IF PS-PO-EXISTS OR                                05670099
056800                   PS-RECEIVER-EXISTS                             05680099
056900                     INITIALIZE SU046-INTER-APPL-COMMAREA         05690099
057000                     SET PS-ERROR                                 05700099
057100                         DP020-MSG-FATAL  TO TRUE                 05710099
057200                     MOVE PC-TSYMSG-01245 TO DP020-MSG-NUMBER     05720099
057300                     MOVE DP015-UNP-ALP-BRT-OFF                   05730099
057400                                          TO APOA                 05740099
057500                                             ARCVRA               05750099
057600                                                                  05760099
057700                     MOVE DP015-RED       TO APOC                 05770099
057800                                             ARCVRC               05780099
057900                                                                  05790099
058000                     MOVE DP015-REVERSE   TO APOH                 05800099
058100                                             ARCVRH               05810099
058200                                                                  05820099
058300                     MOVE -1              TO APOL                 05830099
058400                     SET DP030-SET-CURSOR-APPL-1                  05840099
058500                                          TO TRUE                 05850099
058600                     SET DP030-OVERRIDE-GO TO TRUE                05860099
058700                ELSE                                              05870099
058800                     IF PS-SCAC-EXISTS OR                         05880099
058900                        ASC-TRAILER > SPACES                      05890099
059000                        INITIALIZE SU046-INTER-APPL-COMMAREA      05900099
059100                        SET PS-ERROR                              05910099
059200                            DP020-MSG-FATAL  TO TRUE              05920099
059300                        MOVE PC-TSYMSG-01551 TO DP020-MSG-NUMBER  05930099
059400                        MOVE DP015-UNP-ALP-BRT-OFF                05940099
059500                                             TO ASCACA            05950099
059600                                                ATRLRA            05960099
059700                        MOVE DP015-RED       TO ASCACC            05970099
059800                                                ATRLRC            05980099
059900                        MOVE DP015-REVERSE   TO ASCACH            05990099
060000                                                ATRLRH            06000099
060100                        MOVE -1              TO ASCACL            06010099
060200                        SET DP030-SET-CURSOR-APPL-1               06020099
060300                                             TO TRUE              06030099
060400                        SET DP030-OVERRIDE-GO TO TRUE             06040099
060500                     ELSE                                         06050099
060600                        INITIALIZE SU046-INTER-APPL-COMMAREA      06060099
060700                        SET PS-ERROR                              06070099
060800                            DP020-MSG-FATAL  TO TRUE              06080099
060900                        MOVE PC-TSYMSG-00330 TO DP020-MSG-NUMBER  06090099
061000                        MOVE DP015-UNP-ALP-BRT-OFF                06100099
061100                                             TO ATRIPA            06110099
061200                                                ASCACA            06120099
061300                                                ATRLRA            06130099
061400                                                APOA              06140099
061500                                                ARCVRA            06150099
061600                        MOVE DP015-RED       TO ATRIPC            06160099
061700                                                ASCACC            06170099
061800                                                ATRLRC            06180099
061900                                                APOC              06190099
062000                                                ARCVRC            06200099
062100                        MOVE DP015-REVERSE   TO ATRIPH            06210099
062200                                                ASCACH            06220099
062300                                                ATRLRH            06230099
062400                                                APOH              06240099
062500                                                ARCVRH            06250099
062600                        MOVE -1              TO ASCACL            06260099
062700                        SET DP030-SET-CURSOR-APPL-1               06270099
062800                                             TO TRUE              06280099
062900                        SET DP030-OVERRIDE-GO TO TRUE             06290099
063000                     END-IF                                       06300099
063100                END-IF                                            06310099
063200             END-IF                                               06320099
063300         ELSE                                                     06330099
063400            PERFORM 2110-PREPARE-INTER-APPL-COMM                  06340099
063500         END-IF                                                   06350099
063600     END-EVALUATE.                                                06360099
063700                                                                  06370099
063800******************************************************************06380099
063900** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **06390099
064000** INTER-APPLICATION COMMAREA.                                  **06400099
064100******************************************************************06410099
064200 2110-PREPARE-INTER-APPL-COMM.                                    06420099
064300     EVALUATE TRUE                                                06430099
064400                                                                  06440099
064500       WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)                06450099
064600          INITIALIZE SU046-OPER-UNT-ID                            06460099
064700                     SU046-FCLTY-ID                               06470099
064800                     SU046-FCLTY-NME                              06480099
064900                     SU046-SCAC                                   06490099
065000                     SU046-TRLR-NBR                               06500099
065100                     SU046-TRIP-ID                                06510099
065200                     SU046-PO-NBR                                 06520099
065300                     SU046-REC-SEQ-NBR                            06530099
065400                     SU046-SHIPT-UNT-ID                           06540099
065500                     SU046-CURR-DATE                              06550099
065600                     SU046-FROM-DATE                              06560099
065700                     SU046-TO-DATE                                06570099
065800                     SU046-LIST-SEQ-IND                           06580099
065900                                                                  06590099
066000          MOVE ASC-KEY-OPER-UNT-ID          TO SU046-OPER-UNT-ID  06600099
066100          MOVE ASC-KEY-FCLTY-ID             TO SU046-FCLTY-ID     06610099
066200          MOVE ASC-FCLTY-NME                TO SU046-FCLTY-NME    06620099
066300          MOVE ASC-SCAC                     TO SU046-SCAC         06630099
066400          MOVE ASC-TRAILER                  TO SU046-TRLR-NBR     06640099
066500          MOVE ASC-TRIP-ID                  TO SU046-TRIP-ID      06650099
066600          MOVE ASC-PO-NBR                   TO SU046-PO-NBR       06660099
066700          MOVE ASC-REC-SEQ-NBR              TO SU046-REC-SEQ-NBR  06670099
066800          MOVE ASC-SERIAL-SHIP-CDE-N        TO SU046-SHIPT-UNT-ID 06680099
066900          MOVE ASC-CURR-DATE                TO SU046-CURR-DATE    06690099
067000          MOVE ASC-FROM-DATE                TO SU046-FROM-DATE    06700099
067100          MOVE ASC-TO-DATE                  TO SU046-TO-DATE      06710099
067200          MOVE ASC-LIST-SEQ-IND             TO SU046-LIST-SEQ-IND 06720099
067300                                                                  06730099
067400       WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)                06740099
067500          INITIALIZE SU002-INTER-APPL-COMMAREA                    06750099
067600          MOVE ASC-KEY-OPER-UNT-ID          TO SU002-OPER-UNT-ID  06760099
067700          MOVE ASC-KEY-FCLTY-ID             TO SU002-FCLTY-ID     06770099
067800          MOVE ASC-FCLTY-NME                TO SU002-FCLTY-NME    06780099
067900          MOVE ASC-SCAC                     TO SU002-SCAC         06790099
068000          MOVE ASC-TRAILER                  TO SU002-TRLR-NBR     06800099
068100          MOVE ASC-TRIP-ID                  TO SU002-TRIP-ID      06810099
068200          MOVE ASC-PO-NBR                   TO SU002-PO-NBR       06820099
068300          MOVE ASC-REC-SEQ-NBR              TO SU002-REC-SEQ-NBR  06830099
068400          MOVE ASC-SERIAL-SHIP-CDE-N        TO SU002-SHIPT-UNT-ID 06840099
068500     END-EVALUATE.                                                06850099
068600/                                                                 06860099
068700*----------------------------------------------------------------*06870099
068800* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*06880099
068900* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *06890099
069000* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *06900099
069100*----------------------------------------------------------------*06910099
069200                                                                  06920099
069300 2200-MOVE-SCREEN-TO-COMMAREA.                                    06930099
069400                                                                  06940099
069500     IF  AOPERL > ZERO                                            06950099
069600         MOVE AOPERI               TO ASC-OPER-UNT-ID             06960099
069700     ELSE                                                         06970099
069800         IF  AOPERF = DP015-ERASE-EOF                             06980099
069900             MOVE ZERO             TO ASC-OPER-UNT-ID-N           06990099
070000                                      ASC-KEY-OPER-UNT-ID         07000099
070100         END-IF                                                   07010099
070200     END-IF.                                                      07020099
070300                                                                  07030099
070400     IF  AFCLTYL > ZERO                                           07040099
070500         MOVE AFCLTYI              TO ASC-FCLTY-ID                07050099
070600     ELSE                                                         07060099
070700         IF  AFCLTYF = DP015-ERASE-EOF                            07070099
070800             MOVE ZERO             TO ASC-FCLTY-ID-N              07080099
070900                                      ASC-KEY-FCLTY-ID            07090099
071000         END-IF                                                   07100099
071100     END-IF.                                                      07110099
071200                                                                  07120099
071300     IF  ASCACL > ZERO                                            07130099
071400         MOVE ASCACI               TO ASC-SCAC                    07140099
071500     ELSE                                                         07150099
071600         IF  ASCACF = DP015-ERASE-EOF                             07160099
071700             MOVE SPACES           TO ASC-SCAC                    07170099
071800         END-IF                                                   07180099
071900     END-IF.                                                      07190099
072000                                                                  07200099
072100     IF  ATRLRL > ZERO                                            07210099
072200         MOVE ATRLRI               TO ASC-TRAILER                 07220099
072300     ELSE                                                         07230099
072400         IF  ATRLRF = DP015-ERASE-EOF                             07240099
072500             MOVE SPACES           TO ASC-TRAILER                 07250099
072600         END-IF                                                   07260099
072700     END-IF.                                                      07270099
072800                                                                  07280099
072900     IF  ATRIPL > ZERO                                            07290099
073000         MOVE ATRIPI               TO ASC-TRIP-ID                 07300099
073100     ELSE                                                         07310099
073200         IF  ATRIPF = DP015-ERASE-EOF                             07320099
073300             MOVE ZERO             TO ASC-TRIP-ID-N               07330099
073400                                      ASC-KEY-TRIP-ID             07340099
073500         END-IF                                                   07350099
073600     END-IF.                                                      07360099
073700                                                                  07370099
073800     IF  APOL   > ZERO                                            07380099
073900         MOVE APOI                 TO ASC-PO-NBR                  07390099
074000     ELSE                                                         07400099
074100         IF  APOF = DP015-ERASE-EOF                               07410099
074200             MOVE ZERO             TO ASC-PO-NBR-N                07420099
074300         END-IF                                                   07430099
074400     END-IF.                                                      07440099
074500                                                                  07450099
074600     IF  ARCVRL     > ZERO                                        07460099
074700         MOVE ARCVRI               TO ASC-REC-SEQ-NBR             07470099
074800     ELSE                                                         07480099
074900         IF  ARCVRF = DP015-ERASE-EOF                             07490099
075000             MOVE ZERO             TO ASC-REC-SEQ-NBR-N           07500099
075100         END-IF                                                   07510099
075200     END-IF.                                                      07520099
075300                                                                  07530099
075400* SERIAL SHIP CODE (INBOUND IS 18 DIGITS)                         07540099
075500     IF  ASERSHPL > ZERO                                          07550099
075600         MOVE ASERSHPI          TO ASC-SERIAL-SHIP-CDE            07560099
075700     ELSE                                                         07570099
075800         IF ASERSHPF = DP015-ERASE-EOF                            07580099
075900             MOVE SPACES        TO ASC-SERIAL-SHIP-CDE            07590099
076000         END-IF                                                   07600099
076100     END-IF.                                                      07610099
076200                                                                  07620099
076300* CURRENT DATE SELECTION                                          07630099
076400                                                                  07640099
076500     IF  ASEL1L  > ZERO                                           07650099
076600         MOVE ASEL1I               TO ASC-SEL-1                   07660099
076700         IF ASEL1I > SPACES                                       07670099
076800            SET SU046-SEL-CURR-DATE   TO TRUE                     07680099
076900         END-IF                                                   07690099
077000     ELSE                                                         07700099
077100         IF ASEL1F = DP015-ERASE-EOF                              07710099
077200             MOVE SPACES           TO ASC-SEL-1                   07720099
077300         END-IF                                                   07730099
077400     END-IF.                                                      07740099
077500********                                                          07750099
077600     IF  ACURRMML  > ZERO                                         07760099
077700         MOVE ACURRMMI             TO ASC-CURR-MM                 07770099
077800     ELSE                                                         07780099
077900         IF ACURRMMF = DP015-ERASE-EOF                            07790099
078000             MOVE SPACES           TO ASC-CURR-MM                 07800099
078100         END-IF                                                   07810099
078200     END-IF.                                                      07820099
078300                                                                  07830099
078400     IF  ACURRDDL  > ZERO                                         07840099
078500         MOVE ACURRDDI             TO ASC-CURR-DD                 07850099
078600     ELSE                                                         07860099
078700         IF ACURRDDF = DP015-ERASE-EOF                            07870099
078800             MOVE SPACES           TO ASC-CURR-DD                 07880099
078900         END-IF                                                   07890099
079000     END-IF.                                                      07900099
079100                                                                  07910099
079200     IF  ACURRYYL  > ZERO                                         07920099
079300         MOVE ACURRYYI             TO ASC-CURR-YY                 07930099
079400     ELSE                                                         07940099
079500         IF ACURRYYF = DP015-ERASE-EOF                            07950099
079600             MOVE SPACES           TO ASC-CURR-YY                 07960099
079700         END-IF                                                   07970099
079800     END-IF.                                                      07980099
079900                                                                  07990099
080000* DATE RANGE SELECTION                                            08000099
080100                                                                  08010099
080200     IF  ASEL2L  > ZERO                                           08020099
080300         MOVE ASEL2I               TO ASC-SEL-2                   08030099
080400         IF ASEL2I > SPACES                                       08040099
080500            SET SU046-SEL-DATE-RNGE   TO TRUE                     08050099
080600         END-IF                                                   08060099
080700     ELSE                                                         08070099
080800         IF ASEL2F = DP015-ERASE-EOF                              08080099
080900             MOVE SPACES           TO ASC-SEL-2                   08090099
081000         END-IF                                                   08100099
081100     END-IF.                                                      08110099
081200                                                                  08120099
081300     IF  AFDTMML   > ZERO                                         08130099
081400         MOVE AFDTMMI              TO ASC-FROM-MM                 08140099
081500     ELSE                                                         08150099
081600         IF  AFDTMMF = DP015-ERASE-EOF                            08160099
081700             MOVE SPACES           TO ASC-FROM-MM                 08170099
081800         END-IF                                                   08180099
081900     END-IF.                                                      08190099
082000                                                                  08200099
082100     IF  AFDTDDL   > ZERO                                         08210099
082200         MOVE AFDTDDI              TO ASC-FROM-DD                 08220099
082300     ELSE                                                         08230099
082400         IF  AFDTDDF = DP015-ERASE-EOF                            08240099
082500             MOVE SPACES           TO ASC-FROM-DD                 08250099
082600         END-IF                                                   08260099
082700     END-IF.                                                      08270099
082800                                                                  08280099
082900     IF  AFDTYYL   > ZERO                                         08290099
083000         MOVE AFDTYYI              TO ASC-FROM-YY                 08300099
083100     ELSE                                                         08310099
083200         IF  AFDTYYF = DP015-ERASE-EOF                            08320099
083300             MOVE SPACES           TO ASC-FROM-YY                 08330099
083400         END-IF                                                   08340099
083500     END-IF.                                                      08350099
083600                                                                  08360099
083700     IF  ATDTMML   > ZERO                                         08370099
083800         MOVE ATDTMMI              TO ASC-TO-MM                   08380099
083900     ELSE                                                         08390099
084000         IF  ATDTMMF = DP015-ERASE-EOF                            08400099
084100             MOVE SPACES           TO ASC-TO-MM                   08410099
084200         END-IF                                                   08420099
084300     END-IF.                                                      08430099
084400                                                                  08440099
084500     IF  ATDTDDL   > ZERO                                         08450099
084600         MOVE ATDTDDI              TO ASC-TO-DD                   08460099
084700     ELSE                                                         08470099
084800         IF  ATDTDDF = DP015-ERASE-EOF                            08480099
084900             MOVE SPACES           TO ASC-TO-DD                   08490099
085000         END-IF                                                   08500099
085100     END-IF.                                                      08510099
085200                                                                  08520099
085300     IF  ATDTYYL   > ZERO                                         08530099
085400         MOVE ATDTYYI              TO ASC-TO-YY                   08540099
085500     ELSE                                                         08550099
085600         IF  ATDTYYF = DP015-ERASE-EOF                            08560099
085700             MOVE SPACES           TO ASC-TO-YY                   08570099
085800         END-IF                                                   08580099
085900     END-IF.                                                      08590099
086000                                                                  08600099
086100******************************                                    08610099
086200*LIST SEQUENCE                                                    08620099
086300     IF  ASCACTRLL > ZERO                                         08630099
086400         MOVE ASCACTRLI TO ASC-SEQ-1                              08640099
086500         IF ASCACTRLI > SPACES                                    08650099
086600            SET SU046-SCAC-TRLR-SEQ TO TRUE                       08660099
086700         END-IF                                                   08670099
086800     ELSE                                                         08680099
086900         IF ASCACTRLF = DP015-ERASE-EOF                           08690099
087000            MOVE SPACES    TO ASC-SEQ-1                           08700099
087100         END-IF                                                   08710099
087200     END-IF.                                                      08720099
087300                                                                  08730099
087400     IF  ACREDTEAL > ZERO                                         08740099
087500         MOVE ACREDTEAI TO ASC-SEQ-2                              08750099
087600         IF ACREDTEAI > SPACES                                    08760099
087700            SET SU046-DATE-ASC-SEQ TO TRUE                        08770099
087800         END-IF                                                   08780099
087900     ELSE                                                         08790099
088000         IF ACREDTEAF = DP015-ERASE-EOF                           08800099
088100            MOVE SPACES    TO ASC-SEQ-2                           08810099
088200         END-IF                                                   08820099
088300     END-IF.                                                      08830099
088400                                                                  08840099
088500     IF  ACREDTEDL > ZERO                                         08850099
088600         MOVE ACREDTEDI TO ASC-SEQ-3                              08860099
088700         IF ACREDTEDI > SPACES                                    08870099
088800            SET SU046-DATE-DES-SEQ TO TRUE                        08880099
088900         END-IF                                                   08890099
089000     ELSE                                                         08900099
089100         IF ACREDTEDF = DP015-ERASE-EOF                           08910099
089200            MOVE SPACES    TO ASC-SEQ-3                           08920099
089300         END-IF                                                   08930099
089400     END-IF.                                                      08940099
089500                                                                  08950099
089600************************************************************      08960099
089700*----------------------------------------------------------------*08970099
089800* ENSURE THE DATA IS CORRECT.  NOTE THAT IN A CRITERIA SPECIFI-  *08980099
089900* CATION SCREEN ONLY MINIMAL EDITS ARE DONE.  EDITS RELATED TO   *08990099
090000* A SPECIFIC SCREEN THAT THE USER IS GOING TO (LOCAL-GO) ARE DONE*09000099
090100* IN THE DESTINATION PROGRAM, NOT HERE.                          *09010099
090200*----------------------------------------------------------------*09020099
090300                                                                  09030099
090400 3000-EDIT-DATA-IN-COMMAREA.                                      09040099
090500     PERFORM 3200-RESET-ATTRIBUTES.                               09050099
090510     PERFORM 3005-EDIT-SERIAL-SHIP-CODE.                          09051099
090600                                                                  09060099
090700     IF  ASC-OPER-UNT-ID NOT = SPACES                             09070099
090800         MOVE ASC-OPER-UNT-ID    TO DP010I-UNEDITED-FIELD         09080099
090900         MOVE LENGTH OF ASC-OPER-UNT-ID                           09090099
091000                                 TO DP010I-MAXIMUM-DIGITS         09100099
091100         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       09110099
091200         SET DP010I-NEGATIVE-NOT-ALLOWED                          09120099
091300                                 TO TRUE                          09130099
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         09141099
263968              USING DP010I-NUMERIC-EDIT-AREA                      09142099
091500         IF  DP010I-ERROR-DETECTED                                09150099
091600             SET PS-ERROR                                         09160099
091700                 DP020-MSG-FATAL TO TRUE                          09170099
091800             MOVE PC-TSYMSG-00008                                 09180099
091900                                 TO DP020-MSG-NUMBER              09190099
092000             MOVE DP015-UNP-ALP-BRT-OFF                           09200099
092100                                 TO AOPERA                        09210099
092200             MOVE DP015-RED      TO AOPERC                        09220099
092300             MOVE DP015-REVERSE  TO AOPERH                        09230099
092400             MOVE -1             TO AOPERL                        09240099
092500             SET DP030-SET-CURSOR-APPL-1                          09250099
092600                                 TO TRUE                          09260099
092700         ELSE                                                     09270099
092800             MOVE DP010I-NUMERIC-FIELD                            09280099
092900                                 TO ASC-OPER-UNT-ID-N             09290099
093000                                    ASC-KEY-OPER-UNT-ID           09300099
093100                                    DK-OPER-UNT-ID                09310099
093200             MOVE ASC-OPER-UNT-ID  TO AOPERO                      09320099
093300             PERFORM 3020-VALIDATE-OPER-UNT-ID                    09330099
093400             IF  PS-ERROR                                         09340099
093500                 SET DP020-MSG-FATAL         TO TRUE              09350099
093600                 MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER  09360099
093700                 MOVE DP015-UNP-ALP-BRT-OFF  TO AOPERA            09370099
093800                 MOVE DP015-RED              TO AOPERC            09380099
093900                 MOVE DP015-REVERSE          TO AOPERH            09390099
094000                 MOVE -1                     TO AOPERL            09400099
094100                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              09410099
094200             END-IF                                               09420099
094300         END-IF                                                   09430099
094400     ELSE                                                         09440099
094500         SET PS-ERROR                                             09450099
094600             DP020-MSG-FATAL         TO TRUE                      09460099
094700         MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER          09470099
094800         MOVE DP015-UNP-ALP-BRT-OFF  TO AOPERA                    09480099
094900         MOVE DP015-RED              TO AOPERC                    09490099
095000         MOVE DP015-REVERSE          TO AOPERH                    09500099
095100         MOVE -1                     TO AOPERL                    09510099
095200         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      09520099
095300     END-IF.                                                      09530099
095400                                                                  09540099
095500     IF  ASC-FCLTY-ID NOT = SPACES                                09550099
095600         MOVE ASC-FCLTY-ID       TO DP010I-UNEDITED-FIELD         09560099
095700         MOVE LENGTH OF ASC-FCLTY-ID                              09570099
095800                                 TO DP010I-MAXIMUM-DIGITS         09580099
095900         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       09590099
096000         SET DP010I-NEGATIVE-NOT-ALLOWED                          09600099
096100                                 TO TRUE                          09610099
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         09621099
263968              USING DP010I-NUMERIC-EDIT-AREA                      09622099
096300         IF  DP010I-ERROR-DETECTED                                09630099
096400             SET PS-ERROR                                         09640099
096500                 DP020-MSG-FATAL TO TRUE                          09650099
096600             MOVE PC-TSYMSG-00008                                 09660099
096700                                 TO DP020-MSG-NUMBER              09670099
096800             MOVE DP015-UNP-ALP-BRT-OFF                           09680099
096900                                 TO AFCLTYA                       09690099
097000             MOVE DP015-RED      TO AFCLTYC                       09700099
097100             MOVE DP015-REVERSE  TO AFCLTYH                       09710099
097200             MOVE -1             TO AFCLTYL                       09720099
097300             SET DP030-SET-CURSOR-APPL-1                          09730099
097400                                 TO TRUE                          09740099
097500         ELSE                                                     09750099
097600             MOVE DP010I-NUMERIC-FIELD                            09760099
097700                                 TO ASC-FCLTY-ID-N                09770099
097800                                    ASC-KEY-FCLTY-ID              09780099
097900                                    DK-FCLTY-ID                   09790099
098000             MOVE ASC-FCLTY-ID   TO AFCLTYO                       09800099
098100             IF  ASC-FCLTY-ID-N NOT = PC-1                        09810099
098200                 SET PS-ERROR                                     09820099
098300                     DP020-MSG-FATAL     TO TRUE                  09830099
098400                 MOVE PC-TSYMSG-00005    TO DP020-MSG-NUMBER      09840099
098500                 MOVE DP015-UNP-ALP-BRT-OFF                       09850099
098600                                         TO AFCLTYA               09860099
098700                 MOVE DP015-RED          TO AFCLTYC               09870099
098800                 MOVE DP015-REVERSE      TO AFCLTYH               09880099
098900                 MOVE -1                 TO AFCLTYL               09890099
099000                 SET DP030-SET-CURSOR-APPL-1                      09900099
099100                                         TO TRUE                  09910099
099200             ELSE                                                 09920099
099300                 MOVE ASC-FCLTY-NME      TO AFDESCO               09930099
099400             END-IF                                               09940099
099500         END-IF                                                   09950099
099600     ELSE                                                         09960099
099700         SET PS-ERROR                                             09970099
099800             DP020-MSG-FATAL         TO TRUE                      09980099
099900         MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER          09990099
100000         MOVE DP015-UNP-ALP-BRT-OFF  TO AFCLTYA                   10000099
100100         MOVE DP015-RED              TO AFCLTYC                   10010099
100200         MOVE DP015-REVERSE          TO AFCLTYH                   10020099
100300         MOVE -1                     TO AFCLTYL                   10030099
100400         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      10040099
100500     END-IF.                                                      10050099
100600                                                                  10060099
100700*WHEN GOING TO PACKSLIP LIST OR CARTON DETAIL LIST SCREEN,        10070099
100800*ENTRY OF SERIAL SHIP CDE IS REQUIRED.                            10080099
100900     EVALUATE TRUE                                                10090099
101000       WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)                10100099
101100       WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)                10110099
101200         IF ASC-SCAC > SPACES        OR                           10120099
101300            ASC-TRAILER > SPACES     OR                           10130099
101400            ASC-TRIP-ID > ZEROES     OR                           10140099
101500            ASC-PO-NBR > SPACES      OR                           10150099
101600            ASC-REC-SEQ-NBR > SPACES                              10160099
101700            INITIALIZE SU046-INTER-APPL-COMMAREA                  10170099
101800            SET PS-ERROR                                          10180099
101900                DP020-MSG-FATAL  TO TRUE                          10190099
102000            MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER              10200099
102100            MOVE DP015-UNP-ALP-BRT-OFF  TO ASERSHPA               10210099
102200            MOVE DP015-RED              TO ASERSHPC               10220099
102300            MOVE DP015-REVERSE          TO ASERSHPH               10230099
102400            MOVE -1                     TO ASERSHPL               10240099
102500            SET DP030-SET-CURSOR-APPL-1                           10250099
102600                                 TO TRUE                          10260099
102700            SET DP030-OVERRIDE-GO TO TRUE                         10270099
102800         ELSE                                                     10280099
102900*           PERFORM 3005-EDIT-SERIAL-SHIP-CODE                    10290099
103000                                                                  10300099
103100            IF PS-NO-ERROR                                        10310099
103200               PERFORM 3005A-VALIDATE-SERIAL-SHIP                 10320099
103300            END-IF                                                10330099
103400         END-IF                                                   10340099
103500                                                                  10350099
103600*WHEN GOING TO THE FREE ASTRAY LIST SCREEN,                       10360099
103700*ENTRY OF ONE OF THE FOLLOWING COMBINATIONS IS REQUIRED:          10370099
103800*OPER UNT ID, FCLTY ID                                            10380099
103900*OPER UNT ID, FCLTY ID, CURRENT DATE OR DATE RANGE                10390099
104000*OPER UNT ID, FCLTY ID, SCAC, TRAILER                             10400099
104100*TRIP ID                                                          10410099
104200*PO, OPER UNT ID, CURRENT DATE OR DATE RANGE                      10420099
104300*PO, REC SEQ NBR                                                  10430099
104400*CURRENT DATE                                                     10440099
104500*CURRENT DATE OR DATE RANGE                                       10450099
104600                                                                  10460099
104700       WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)                10470099
104800       WHEN DP020-SRC-AID = DP016-ENTER                           10480099
104900       IF PS-NO-ERROR                                             10490099
105000         IF ASC-SCAC > SPACES                                     10500099
105100             MOVE ASC-SCAC         TO DK-SCAC-ID                  10510099
105200             PERFORM 3100-VALIDATE-SCAC-CDE                       10520099
105300             IF PS-SCAC-EXISTS                                    10530099
105400                 IF ASC-TRAILER > SPACES                          10540099
105500                     MOVE ASC-TRAILER      TO DK-TRLR-NBR         10550099
105600                     PERFORM 3050-VALIDATE-TRAILER                10560099
105700                     IF PS-TRAILER-EXISTS                         10570099
105800                         PERFORM 3010-GET-TRIP-ID                 10580099
105900                     ELSE                                         10590099
106000                         SET PS-ERROR                             10600099
106100                           DP020-MSG-FATAL  TO TRUE               10610099
106200                           MOVE PC-TSYMSG-00743                   10620099
106300                                  TO DP020-MSG-NUMBER             10630099
106400                           MOVE DP015-UNP-ALP-BRT-OFF             10640099
106500                                              TO AOPERA           10650099
106600                                                 ASCACA           10660099
106700                                                 ATRLRA           10670099
106800                                                 ATRIPA           10680099
106900                           MOVE DP015-RED     TO AOPERC           10690099
107000                                                 ASCACC           10700099
107100                                                 ATRLRC           10710099
107200                                                 ATRIPC           10720099
107300                           MOVE DP015-REVERSE TO AOPERH           10730099
107400                                                 ASCACH           10740099
107500                                                 ATRLRH           10750099
107600                                                 ATRIPH           10760099
107700                           MOVE -1            TO ATRIPL           10770099
107800                           SET DP030-SET-CURSOR-APPL-1            10780099
107900                                              TO TRUE             10790099
108000                     END-IF                                       10800099
108100                 ELSE                                             10810099
108200                     INITIALIZE SU046-INTER-APPL-COMMAREA         10820099
108300                     SET PS-ERROR                                 10830099
108400                         DP020-MSG-FATAL  TO TRUE                 10840099
108500                     MOVE PC-TSYMSG-01551 TO DP020-MSG-NUMBER     10850099
108600                     MOVE DP015-UNP-ALP-BRT-OFF                   10860099
108700                                          TO ASCACA               10870099
108800                                             ATRLRA               10880099
108900                     MOVE DP015-RED       TO ASCACC               10890099
109000                                             ATRLRC               10900099
109100                     MOVE DP015-REVERSE   TO ASCACH               10910099
109200                                             ATRLRH               10920099
109300                     MOVE -1              TO ASCACL               10930099
109400                     SET DP030-SET-CURSOR-APPL-1                  10940099
109500                                          TO TRUE                 10950099
109600                     SET DP030-OVERRIDE-GO TO TRUE                10960099
109700                 END-IF                                           10970099
109800             ELSE                                                 10980099
109900                 SET PS-ERROR                                     10990099
110000                   DP020-MSG-FATAL  TO TRUE                       11000099
110100                 MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER         11010099
110200                 MOVE DP015-UNP-ALP-BRT-OFF                       11020099
110300                                      TO ASCACA                   11030099
110400                 MOVE DP015-RED       TO ASCACC                   11040099
110500                 MOVE DP015-REVERSE   TO ASCACH                   11050099
110600                 MOVE -1              TO ASCACL                   11060099
110700                 SET DP030-SET-CURSOR-APPL-1                      11070099
110800                                      TO TRUE                     11080099
110900             END-IF                                               11090099
111000         ELSE                                                     11100099
111100           IF ASC-TRAILER > SPACES AND ASC-SCAC > SPACES          11110099
111200                   MOVE ASC-TRAILER TO DK-TRLR-NBR                11120099
111300                   PERFORM 3055-VALIDATE-TRAILER                  11130099
111400                   IF PS-TRAILER-EXISTS                           11140099
111500                       CONTINUE                                   11150099
111600                   ELSE                                           11160099
111700                       SET PS-ERROR                               11170099
111800                           DP020-MSG-FATAL     TO TRUE            11180099
111900                       MOVE PC-TSYMSG-02613    TO DP020-MSG-NUMBER11190099
112000                       MOVE DP015-UNP-ALP-BRT-OFF                 11200099
112100                                               TO ATRLRA          11210099
112200                       MOVE DP015-RED          TO ATRLRC          11220099
112300                       MOVE DP015-REVERSE      TO ATRLRH          11230099
112400                       MOVE -1                 TO ATRLRL          11240099
112500                       SET DP030-SET-CURSOR-APPL-1                11250099
112600                                               TO TRUE            11260099
112700                       MOVE ZERO               TO ASC-TRAILER-N   11270099
112800                                                  ASC-TRAILER     11280099
112900                   END-IF                                         11290099
113000           ELSE                                                   11300099
113100             IF  ASC-TRIP-ID > SPACES                             11310099
113200                 MOVE ASC-TRIP-ID        TO DP010I-UNEDITED-FIELD 11320099
113300                 MOVE LENGTH OF ASC-TRIP-ID                       11330099
113400                                         TO DP010I-MAXIMUM-DIGITS 11340099
113500                 MOVE ZERO                                        11350099
113600                                    TO DP010I-MAXIMUM-DECIMALS    11360099
113700                 SET DP010I-NEGATIVE-NOT-ALLOWED                  11370099
113800                                         TO TRUE                  11380099
263968                 CALL DP010I-NUMERIC-EDIT-ROUTINE                 11391099
263968                     USING DP010I-NUMERIC-EDIT-AREA               11392099
114000                 IF  DP010I-ERROR-DETECTED                        11400099
114100                     SET PS-ERROR                                 11410099
114200                         DP020-MSG-FATAL TO TRUE                  11420099
114300                     MOVE PC-TSYMSG-00008                         11430099
114400                                         TO DP020-MSG-NUMBER      11440099
114500                     MOVE DP015-UNP-ALP-BRT-OFF                   11450099
114600                                         TO ATRIPA                11460099
114700                   MOVE DP015-RED      TO ATRIPC                  11470099
114800                   MOVE DP015-REVERSE  TO ATRIPH                  11480099
114900                   MOVE -1             TO ATRIPL                  11490099
115000                   SET DP030-SET-CURSOR-APPL-1                    11500099
115100                                       TO TRUE                    11510099
115200                 ELSE                                             11520099
115300                     MOVE DP010I-NUMERIC-FIELD                    11530099
115400                                         TO ASC-TRIP-ID-N         11540099
115500                                            ASC-KEY-TRIP-ID       11550099
115600                                            DK-TRIP-ID            11560099
115700                     MOVE ASC-TRIP-ID    TO ATRIPO                11570099
115800                                                                  11580099
115900                     PERFORM 3040-VALIDATE-TRIP                   11590099
116000                     IF PS-TRIP-EXISTS                            11600099
116100                         CONTINUE                                 11610099
116200                     ELSE                                         11620099
116300                         SET PS-ERROR                             11630099
116400                             DP020-MSG-FATAL     TO TRUE          11640099
116500                         MOVE PC-TSYMSG-00743                     11650099
116600                                           TO DP020-MSG-NUMBER    11660099
116700                         MOVE DP015-UNP-ALP-BRT-OFF               11670099
116800                                                 TO ATRIPA        11680099
116900                         MOVE DP015-RED          TO ATRIPC        11690099
117000                         MOVE DP015-REVERSE      TO ATRIPH        11700099
117100                         MOVE -1                 TO ATRIPL        11710099
117200                         SET DP030-SET-CURSOR-APPL-1              11720099
117300                                                 TO TRUE          11730099
117400                          MOVE ZERO             TO ASC-TRIP-ID-N  11740099
117500                                                   ASC-KEY-TRIP-ID11750099
117600                     END-IF                                       11760099
117700             ELSE                                                 11770099
117800               IF  ASC-PO-NBR > SPACES                            11780099
117900                   MOVE ASC-PO-NBR                                11790099
118000                                    TO DP010I-UNEDITED-FIELD      11800099
118100                   MOVE LENGTH OF ASC-PO-NBR                      11810099
118200                                     TO DP010I-MAXIMUM-DIGITS     11820099
118300                   MOVE ZERO         TO DP010I-MAXIMUM-DECIMALS   11830099
118400                   SET DP010I-NEGATIVE-NOT-ALLOWED                11840099
118500                                           TO TRUE                11850099
263968                   CALL DP010I-NUMERIC-EDIT-ROUTINE               11871099
263968                        USING DP010I-NUMERIC-EDIT-AREA            11872099
118800                   IF  DP010I-ERROR-DETECTED                      11880099
118900                       SET PS-ERROR                               11890099
119000                       DP020-MSG-FATAL TO TRUE                    11900099
119100                       MOVE PC-TSYMSG-00008                       11910099
119200                                           TO DP020-MSG-NUMBER    11920099
119300                       MOVE DP015-UNP-ALP-BRT-OFF                 11930099
119400                                           TO APOA                11940099
119500                       MOVE DP015-RED      TO APOC                11950099
119600                       MOVE DP015-REVERSE  TO APOH                11960099
119700                       MOVE -1             TO APOL                11970099
119800                       SET DP030-SET-CURSOR-APPL-1                11980099
119900                                           TO TRUE                11990099
120000                   ELSE                                           12000099
120100                       MOVE DP010I-NUMERIC-FIELD                  12010099
120200                                           TO ASC-PO-NBR-N        12020099
120300                                              DK-PO-NBR           12030099
120400                       PERFORM 3070-VALIDATE-PO-NBR               12040099
120500                       IF  SQLCODE = +100                         12050099
120600                           SET PS-ERROR                           12060099
120700                               DP020-MSG-FATAL TO TRUE            12070099
120800                           MOVE PC-TSYMSG-00726                   12080099
120900                                       TO DP020-MSG-NUMBER        12090099
121000                           MOVE DP015-UNP-ALP-BRT-OFF             12100099
121100                                               TO APOA            12110099
121200                           MOVE DP015-RED      TO APOC            12120099
121300                           MOVE DP015-REVERSE  TO APOH            12130099
121400                           MOVE -1             TO APOL            12140099
121500                           SET DP030-SET-CURSOR-APPL-1            12150099
121600                                               TO TRUE            12160099
121700                           MOVE ASC-PO-NBR     TO APOO            12170099
121800                       ELSE                                       12180099
121900                           IF ASC-KEY-OPER-UNT-ID =               12190099
122000                                     RECEIV-CURR-OPER-UNT-ID      12200099
122100                               CONTINUE                           12210099
122200                           ELSE                                   12220099
122300                               SET PS-ERROR                       12230099
122400                                   DP020-MSG-FATAL TO TRUE        12240099
122500                               MOVE PC-TSYMSG-00955               12250099
122600                                          TO DP020-MSG-NUMBER     12260099
122700                               MOVE DP015-UNP-ALP-BRT-OFF         12270099
122800                                                   TO AOPERA      12280099
122900                               MOVE DP015-RED      TO AOPERC      12290099
123000                               MOVE DP015-REVERSE  TO AOPERH      12300099
123100                               MOVE -1             TO AOPERL      12310099
123200                               SET DP030-SET-CURSOR-APPL-1        12320099
123300                                                   TO TRUE        12330099
123400                           END-IF                                 12340099
123500                       END-IF                                     12350099
123600                   END-IF                                         12360099
123700                                                                  12370099
123800                   IF PS-PO-EXISTS                                12380099
123900                      IF ASC-REC-SEQ-NBR NOT = SPACES             12390099
124000                           MOVE ASC-REC-SEQ-NBR                   12400099
124100                                       TO DP010I-UNEDITED-FIELD   12410099
124200                           MOVE LENGTH OF ASC-REC-SEQ-NBR         12420099
124300                                       TO DP010I-MAXIMUM-DIGITS   12430099
124400                           MOVE ZERO TO DP010I-MAXIMUM-DECIMALS   12440099
124500                           SET DP010I-NEGATIVE-NOT-ALLOWED        12450099
124600                                                  TO TRUE         12460099
263968                           CALL DP010I-NUMERIC-EDIT-ROUTINE       12481099
263968                                USING DP010I-NUMERIC-EDIT-AREA    12482099
124900                           IF  DP010I-ERROR-DETECTED              12490099
125000                               SET PS-ERROR                       12500099
125100                                   DP020-MSG-FATAL TO TRUE        12510099
125200                               MOVE PC-TSYMSG-00008               12520099
125300                                          TO DP020-MSG-NUMBER     12530099
125400                               MOVE DP015-UNP-ALP-BRT-OFF         12540099
125500                                                     TO ARCVRA    12550099
125600                               MOVE DP015-RED        TO ARCVRC    12560099
125700                               MOVE DP015-REVERSE    TO ARCVRH    12570099
125800                               MOVE -1               TO ARCVRL    12580099
125900                               SET DP030-SET-CURSOR-APPL-1        12590099
126000                                                   TO TRUE        12600099
126100                           ELSE                                   12610099
126200                               MOVE DP010I-NUMERIC-FIELD          12620099
126300                                          TO ASC-REC-SEQ-NBR-N    12630099
126400                                             DK-REC-SEQ-NBR       12640099
126500                               SET PS-RECEIVER-EXISTS TO TRUE     12650099
126600                           END-IF                                 12660099
126700                      END-IF                                      12670099
126800                      IF ASC-REC-SEQ-NBR = 0                      12680099
126900                         SET PS-ERROR                             12690099
127000                         DP020-MSG-FATAL TO TRUE                  12700099
127100                         MOVE PC-TSYMSG-02479                     12710099
127200                                          TO DP020-MSG-NUMBER     12720099
127300                         MOVE DP015-UNP-ALP-BRT-OFF               12730099
127400                                                 TO ARCVRA        12740099
127500                         MOVE DP015-RED          TO ARCVRC        12750099
127600                         MOVE DP015-REVERSE      TO ARCVRH        12760099
127700                         MOVE -1                 TO ARCVRL        12770099
127800                         SET DP030-SET-CURSOR-APPL-1              12780099
127900                                                 TO TRUE          12790099
128000                      ELSE                                        12800099
128100                          CONTINUE                                12810099
128200                      END-IF                                      12820099
128300                   END-IF                                         12830099
128400               ELSE                                               12840099
128500                 IF ASC-OPER-UNT-ID > SPACES AND                  12850099
128600                    ASC-FCLTY-ID    > SPACES AND                  12860099
128700                    ASC-SCAC        = SPACES AND                  12870099
128800                    ASC-TRAILER     = SPACES AND                  12880099
128900                    ASC-TRIP-ID     = SPACES AND                  12890099
129000                    ASC-PO-NBR      = SPACES AND                  12900099
129100                    ASC-REC-SEQ-NBR = SPACES                      12910099
129200                    CONTINUE                                      12920099
129300                 END-IF                                           12930099
129400               END-IF                                             12940099
129500             END-IF                                               12950099
129600           END-IF                                                 12960099
129700         END-IF                                                   12970099
129800       END-IF                                                     12980099
129900     END-EVALUATE.                                                12990099
130000                                                                  13000099
130100*-----------------------------------------------------------------13010099
130200* VALIDATE DATE SELECTION ENTERED - MUST ENTER 'S' OR 'X'         13020099
130300*-----------------------------------------------------------------13030099
130400     IF ASC-SEL-1 = PC-S OR PC-X OR SPACES                        13040099
130500        CONTINUE                                                  13050099
130600     ELSE                                                         13060099
130700        SET PS-ERROR                                              13070099
130800        DP020-MSG-FATAL             TO TRUE                       13080099
130900        MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER           13090099
131000        MOVE DP015-UNP-ALP-BRT-OFF  TO ASEL1A                     13100099
131100        MOVE DP015-RED              TO ASEL1C                     13110099
131200        MOVE DP015-REVERSE          TO ASEL1H                     13120099
131300        MOVE -1                     TO ASEL1L                     13130099
131400        SET DP030-SET-CURSOR-APPL-1 TO TRUE                       13140099
131500     END-IF                                                       13150099
131600                                                                  13160099
131700     IF ASC-SEL-2 = PC-S OR PC-X OR SPACES                        13170099
131800        CONTINUE                                                  13180099
131900     ELSE                                                         13190099
132000        SET PS-ERROR                                              13200099
132100        DP020-MSG-FATAL             TO TRUE                       13210099
132200        MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER           13220099
132300        MOVE DP015-UNP-ALP-BRT-OFF  TO ASEL2A                     13230099
132400        MOVE DP015-RED              TO ASEL2C                     13240099
132500        MOVE DP015-REVERSE          TO ASEL2H                     13250099
132600        MOVE -1                     TO ASEL2L                     13260099
132700        SET DP030-SET-CURSOR-APPL-1 TO TRUE                       13270099
132800     END-IF                                                       13280099
132900                                                                  13290099
133000*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *13300099
133100*  VALIDATE THE DATE THE ASSOCIATE ENTERS.                       *13310099
133200*- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *13320099
133300     IF PS-NO-ERROR                                               13330099
133400        IF SU046-DATE-SELECTED = 'C'                              13340099
133500            PERFORM 3105-VALIDATE-CURR-DATE                       13350099
133600        END-IF                                                    13360099
133700                                                                  13370099
133800        IF SU046-DATE-SELECTED = 'R'                              13380099
133900            PERFORM 3106-VALIDATE-FROM-TO                         13390099
134000        END-IF                                                    13400099
134100     END-IF.                                                      13410099
134200                                                                  13420099
134300*-----------------------------------------------------------------13430099
134400* MAKE SURE THAT ONLY ONE OPTION IS SELECTED                      13440099
134500* BOTH OPTIONS CAN BE BLANK                                       13450099
134600*-----------------------------------------------------------------13460099
134700     IF  PS-NO-ERROR                                              13470099
134800         IF  ASC-SEL-1  > SPACES AND ASC-SEL-2 > SPACES           13480099
134900             SET PS-ERROR                                         13490099
135000                 DP020-MSG-FATAL         TO TRUE                  13500099
135100             MOVE PC-TSYMSG-00973        TO DP020-MSG-NUMBER      13510099
135200             MOVE DP015-UNP-ALP-BRT-OFF  TO ASEL1A                13520099
135300                                            ASEL2A                13530099
135400             MOVE DP015-RED              TO ASEL1C                13540099
135500                                            ASEL2C                13550099
135600             MOVE DP015-REVERSE          TO ASEL1H                13560099
135700                                            ASEL2H                13570099
135800             MOVE -1                     TO ASEL1L                13580099
135900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  13590099
136000         END-IF                                                   13600099
136100                                                                  13610099
136200*-----------------------------------------------------------------13620099
136300*IF CURRENT DATE OPTION IS SELECTED, DATE IS REQUIRED             13630099
136400*-----------------------------------------------------------------13640099
136500         IF ASC-SEL-1 = PC-S AND ASC-CURR-DATE = SPACES           13650099
136600             SET PS-ERROR                                         13660099
136700                 DP020-MSG-FATAL         TO TRUE                  13670099
136800             MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER      13680099
136900             MOVE DP015-UNP-ALP-BRT-OFF  TO ACURRMMA              13690099
137000                                            ACURRDDA              13700099
137100                                            ACURRYYA              13710099
137200             MOVE DP015-RED              TO ACURRMMC              13720099
137300                                            ACURRDDC              13730099
137400                                            ACURRYYC              13740099
137500             MOVE DP015-REVERSE          TO ACURRMMH              13750099
137600                                            ACURRDDH              13760099
137700                                            ACURRYYH              13770099
137800             MOVE -1                     TO ACURRMML              13780099
137900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  13790099
138000         END-IF                                                   13800099
138100                                                                  13810099
138200*-----------------------------------------------------------------13820099
138300*IF DATE RANGE OPTION IS SELECTED, TO AND FROM DATE REQUIRED      13830099
138400*-----------------------------------------------------------------13840099
138500         IF ASC-SEL-2 = PC-S AND                                  13850099
138600            (ASC-FROM-DATE = SPACES OR ASC-TO-DATE = SPACES)      13860099
138700             SET PS-ERROR                                         13870099
138800                 DP020-MSG-FATAL         TO TRUE                  13880099
138900             MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER      13890099
139000             MOVE DP015-UNP-ALP-BRT-OFF  TO AFDTMMA               13900099
139100                                            AFDTDDA               13910099
139200                                            AFDTYYA               13920099
139300                                            ATDTMMA               13930099
139400                                            ATDTDDA               13940099
139500                                            ATDTYYA               13950099
139600             MOVE DP015-RED              TO AFDTMMC               13960099
139700                                            AFDTDDC               13970099
139800                                            AFDTYYC               13980099
139900                                            ATDTMMC               13990099
140000                                            ATDTDDC               14000099
140100                                            ATDTYYC               14010099
140200             MOVE DP015-REVERSE          TO AFDTMMH               14020099
140300                                            AFDTDDH               14030099
140400                                            AFDTYYH               14040099
140500                                            ATDTMMH               14050099
140600                                            ATDTDDH               14060099
140700                                            ATDTYYH               14070099
140800             MOVE -1                     TO AFDTMML               14080099
140900             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  14090099
141000         END-IF                                                   14100099
141100     END-IF.                                                      14110099
141200                                                                  14120099
141300*-----------------------------------------------------------------14130099
141400* VALIDATE LIST SEQUENCE ENTERED - MUST ENTER 'S' OR 'X'          14140099
141500*-----------------------------------------------------------------14150099
141600     IF ASC-SEQ-1 = PC-S OR PC-X OR SPACES                        14160099
141700        CONTINUE                                                  14170099
141800     ELSE                                                         14180099
141900        SET PS-ERROR                                              14190099
142000        DP020-MSG-FATAL             TO TRUE                       14200099
142100        MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER           14210099
142200        MOVE DP015-UNP-ALP-BRT-OFF  TO ASCACTRLA                  14220099
142300        MOVE DP015-RED              TO ASCACTRLC                  14230099
142400        MOVE DP015-REVERSE          TO ASCACTRLH                  14240099
142500        MOVE -1                     TO ASCACTRLL                  14250099
142600        SET DP030-SET-CURSOR-APPL-1 TO TRUE                       14260099
142700     END-IF                                                       14270099
142800                                                                  14280099
142900     IF ASC-SEQ-2 = PC-S OR PC-X OR SPACES                        14290099
143000        CONTINUE                                                  14300099
143100     ELSE                                                         14310099
143200        SET PS-ERROR                                              14320099
143300        DP020-MSG-FATAL             TO TRUE                       14330099
143400        MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER           14340099
143500        MOVE DP015-UNP-ALP-BRT-OFF  TO ACREDTEAA                  14350099
143600        MOVE DP015-RED              TO ACREDTEAC                  14360099
143700        MOVE DP015-REVERSE          TO ACREDTEAH                  14370099
143800        MOVE -1                     TO ACREDTEAL                  14380099
143900        SET DP030-SET-CURSOR-APPL-1 TO TRUE                       14390099
144000     END-IF                                                       14400099
144100                                                                  14410099
144200     IF ASC-SEQ-3 = PC-S OR PC-X OR SPACES                        14420099
144300        CONTINUE                                                  14430099
144400     ELSE                                                         14440099
144500        SET PS-ERROR                                              14450099
144600        DP020-MSG-FATAL             TO TRUE                       14460099
144700        MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER           14470099
144800        MOVE DP015-UNP-ALP-BRT-OFF  TO ACREDTEDA                  14480099
144900        MOVE DP015-RED              TO ACREDTEDC                  14490099
145000        MOVE DP015-REVERSE          TO ACREDTEDH                  14500099
145100        MOVE -1                     TO ACREDTEDL                  14510099
145200        SET DP030-SET-CURSOR-APPL-1 TO TRUE                       14520099
145300     END-IF                                                       14530099
145400                                                                  14540099
145500*    IF  ASC-SEQ-1 > SPACES                                       14550099
145600*        IF  PS-NO-ERROR                                          14560099
145700*            IF  ASC-LIST-SEQ-VALID                               14570099
145800*                CONTINUE                                         14580099
145900*            ELSE                                                 14590099
146000*                SET PS-ERROR                                     14600099
146100*                DP020-MSG-FATAL             TO TRUE              14610099
146200*                MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER  14620099
146300*                MOVE DP015-UNP-ALP-BRT-OFF  TO ASCACTRLA         14630099
146400*                MOVE DP015-RED              TO ASCACTRLC         14640099
146500*                MOVE DP015-REVERSE          TO ASCACTRLH         14650099
146600*                MOVE -1                     TO ASCACTRLL         14660099
146700*                SET DP030-SET-CURSOR-APPL-1 TO TRUE              14670099
146800*            END-IF                                               14680099
146900*        END-IF                                                   14690099
147000*    END-IF.                                                      14700099
147100*                                                                 14710099
147200*    IF  ASC-SEQ-2 > SPACES                                       14720099
147300*        IF  PS-NO-ERROR                                          14730099
147400*            IF  ASC-LIST-SEQ-VALID                               14740099
147500*                CONTINUE                                         14750099
147600*            ELSE                                                 14760099
147700*                SET PS-ERROR                                     14770099
147800*                DP020-MSG-FATAL             TO TRUE              14780099
147900*                MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER  14790099
148000*                MOVE DP015-UNP-ALP-BRT-OFF  TO ACREDTEAA         14800099
148100*                MOVE DP015-RED              TO ACREDTEAC         14810099
148200*                MOVE DP015-REVERSE          TO ACREDTEAH         14820099
148300*                MOVE -1                     TO ACREDTEAL         14830099
148400*                SET DP030-SET-CURSOR-APPL-1 TO TRUE              14840099
148500*            END-IF                                               14850099
148600*        END-IF                                                   14860099
148700*    END-IF.                                                      14870099
148800*                                                                 14880099
148900*    IF  ASC-SEQ-3 > SPACES                                       14890099
149000*        IF  PS-NO-ERROR                                          14900099
149100*            IF  ASC-LIST-SEQ-VALID                               14910099
149200*                CONTINUE                                         14920099
149300*            ELSE                                                 14930099
149400*                SET PS-ERROR                                     14940099
149500*                DP020-MSG-FATAL             TO TRUE              14950099
149600*                MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER  14960099
149700*                MOVE DP015-UNP-ALP-BRT-OFF  TO ACREDTEDA         14970099
149800*                MOVE DP015-RED              TO ACREDTEDC         14980099
149900*                MOVE DP015-REVERSE          TO ACREDTEDH         14990099
150000*                MOVE -1                     TO ACREDTEDL         15000099
150100*                SET DP030-SET-CURSOR-APPL-1 TO TRUE              15010099
150200*            END-IF                                               15020099
150300*        END-IF                                                   15030099
150400*    END-IF.                                                      15040099
150500*                                                                 15050099
150600*-----------------------------------------------------------------15060099
150700* LIST SEQUENCE DEFAULTS TO WHAT IS IN PARM TABLE FOR THE DC      15070099
150800*                                                                 15080099
150900* MAKE SURE THAT ONLY ONE LIST SEQUENCE IS SELECTED               15090099
151000* AT LEAST ONE MUST BE SELECTED                                   15100099
151100*-----------------------------------------------------------------15110099
151200     IF  PS-NO-ERROR                                              15120099
151300         INITIALIZE PV-COUNT-SEQ                                  15130099
151400                                                                  15140099
151500         IF  ASC-SEQ-1 > SPACES                                   15150099
151600             ADD 1 TO PV-COUNT-SEQ                                15160099
151700         END-IF                                                   15170099
151800                                                                  15180099
151900         IF ASC-SEQ-2 > SPACES                                    15190099
152000             ADD 1 TO PV-COUNT-SEQ                                15200099
152100         END-IF                                                   15210099
152200                                                                  15220099
152300         IF ASC-SEQ-3 > SPACES                                    15230099
152400             ADD 1 TO PV-COUNT-SEQ                                15240099
152500         END-IF                                                   15250099
152600                                                                  15260099
152700         EVALUATE TRUE                                            15270099
152800           WHEN PV-COUNT-SEQ = 0                                  15280099
152900              SET PS-ERROR                                        15290099
153000                  DP020-MSG-FATAL         TO TRUE                 15300099
153100              MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER     15310099
153200              MOVE DP015-UNP-ALP-BRT-OFF  TO ASCACTRLA            15320099
153300                                             ACREDTEAA            15330099
153400                                             ACREDTEDA            15340099
153500              MOVE DP015-RED              TO ASCACTRLC            15350099
153600                                             ACREDTEAC            15360099
153700                                             ACREDTEDC            15370099
153800              MOVE DP015-REVERSE          TO ASCACTRLH            15380099
153900                                             ACREDTEAH            15390099
154000                                             ACREDTEDH            15400099
154100              MOVE -1                     TO ASCACTRLL            15410099
154200              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 15420099
154300                                                                  15430099
154400           WHEN PV-COUNT-SEQ > 1                                  15440099
154500              SET PS-ERROR                                        15450099
154600                  DP020-MSG-FATAL         TO TRUE                 15460099
154700              MOVE PC-TSYMSG-00973        TO DP020-MSG-NUMBER     15470099
154800              MOVE DP015-UNP-ALP-BRT-OFF  TO ASCACTRLA            15480099
154900                                             ACREDTEAA            15490099
155000                                             ACREDTEDA            15500099
155100              MOVE DP015-RED              TO ASCACTRLC            15510099
155200                                             ACREDTEAC            15520099
155300                                             ACREDTEDC            15530099
155400              MOVE DP015-REVERSE          TO ASCACTRLH            15540099
155500                                             ACREDTEAH            15550099
155600                                             ACREDTEDH            15560099
155700              MOVE -1                     TO ASCACTRLL            15570099
155800              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 15580099
155900                                                                  15590099
156000           WHEN OTHER                                             15600099
156100             IF ASC-SEQ-1 > SPACES                                15610099
156200                SET ASC-SCAC-TRLR-SEQ  TO TRUE                    15620099
156300             END-IF                                               15630099
156400             IF ASC-SEQ-2 > SPACES                                15640099
156500                SET ASC-DATE-ASC-SEQ   TO TRUE                    15650099
156600             END-IF                                               15660099
156700             IF ASC-SEQ-3 > SPACES                                15670099
156800                SET ASC-DATE-DES-SEQ   TO TRUE                    15680099
156900             END-IF                                               15690099
157000         END-EVALUATE                                             15700099
157100     END-IF.                                                      15710099
157200                                                                  15720099
157300*----------------------------------------------------------------*15730099
157400 3005-EDIT-SERIAL-SHIP-CODE.                                      15740099
157500                                                                  15750099
157600     MOVE ASC-SERIAL-SHIP-CDE TO PV-INPUT-FIELD.                  15760099
157700     MOVE SPACES              TO PV-OUTPUT-FIELD.                 15770099
157800     MOVE +18                 TO PV-SUB2.                         15780099
157900                                                                  15790099
158000     PERFORM                                                      15800099
158100       VARYING PV-SUB1 FROM 18 BY -1                              15810099
158200         UNTIL PV-SUB1 = ZERO OR PS-ERROR                         15820099
158300                                                                  15830099
158400         IF PV-IN-BYTE (PV-SUB1) > SPACES                         15840099
158500             IF PV-IN-BYTE (PV-SUB1) NUMERIC                      15850099
158600                 MOVE PV-IN-BYTE (PV-SUB1)                        15860099
158700                   TO PV-OUT-BYTE (PV-SUB2)                       15870099
158800                 SUBTRACT 1 FROM PV-SUB2                          15880099
158900             ELSE                                                 15890099
159000                 SET PS-ERROR                                     15900099
159100                     DP020-MSG-FATAL         TO TRUE              15910099
159200                 MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER  15920099
159300                 MOVE DP015-UNP-ALP-BRT-OFF  TO ASERSHPA          15930099
159400                 MOVE DP015-RED              TO ASERSHPC          15940099
159500                 MOVE DP015-REVERSE          TO ASERSHPH          15950099
159600                 MOVE -1                     TO ASERSHPL          15960099
159700                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              15970099
159800              END-IF                                              15980099
159900         END-IF                                                   15990099
160000                                                                  16000099
160100     END-PERFORM.                                                 16010099
160200                                                                  16020099
160300     IF PS-NO-ERROR                                               16030099
160400         INSPECT PV-OUTPUT-FIELD                                  16040099
160500           REPLACING ALL SPACES BY ZEROES                         16050099
160600                                                                  16060099
160700         MOVE PV-OUTPUT-FIELD TO ASC-SERIAL-SHIP-CDE-N            16070099
160800     END-IF.                                                      16080099
160900                                                                  16090099
161000*---------------------------------------------------------------* 16100099
161100*  VALIDATE SERIAL SHIP CODE NUMBER                               16110099
161200*---------------------------------------------------------------* 16120099
161300 3005A-VALIDATE-SERIAL-SHIP.                                      16130099
161400     MOVE ASC-SERIAL-SHIP-CDE     TO DK-SERIAL-SHIP-CDE           16140099
161500                                                                  16150099
161600     MOVE DK-SERIAL-SHIP-CDE      TO DK-SERIAL-SHIP-CDE-NUM.      16160099
161700                                                                  16170099
161800     EXEC SQL                                                     16180099
161900              SELECT  SHIPT_UNT_ID                                16190099
162000                INTO  :SHPUNT-SHIPT-UNT-ID                        16200099
162100                FROM  TSHPUNT                                     16210099
162200               WHERE  SHIPT_UNT_ID = :DK-SERIAL-SHIP-CDE-NUM      16220099
162300     END-EXEC.                                                    16230099
162400                                                                  16240099
162500     EVALUATE TRUE                                                16250099
162600         WHEN SQLCODE = +0                                        16260099
162700         WHEN SQLCODE = -811                                      16270099
162800              CONTINUE                                            16280099
162900         WHEN SQLCODE = +100                                      16290099
163000              SET PS-ERROR                                        16300099
163100                  DP020-MSG-FATAL         TO TRUE                 16310099
163200              MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER     16320099
163300              MOVE DP015-UNP-ALP-BRT-OFF  TO ASERSHPA             16330099
163400              MOVE DP015-RED              TO ASERSHPC             16340099
163500              MOVE DP015-REVERSE          TO ASERSHPH             16350099
163600              MOVE -1                     TO ASERSHPL             16360099
163700              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 16370099
163800         WHEN OTHER                                               16380099
163900              MOVE DK-OPER-UNT-ID         TO PV-DISP-OPER         16390099
164000              MOVE DK-SERIAL-SHIP-CDE-NUM TO PV-DISP-SSCC         16400099
164100              STRING  ' SUKCS760- 3005A- '      DELIMITED BY SIZE 16410099
164200                      ' OPER-'                  DELIMITED BY SIZE 16420099
164300                      PV-DISP-OPER              DELIMITED BY SIZE 16430099
164400                      ' SSCC-'                  DELIMITED BY SIZE 16440099
164500                      PV-DISP-SSCC              DELIMITED BY SIZE 16450099
164600                                     INTO PV-CICS-MSG-AREA        16460099
164700                                                                  16470099
164800              PERFORM 9900-WRITE-CICS-LOG                         16480099
164900                                                                  16490099
165000              MOVE '3005A-VALIDATE-SERIAL-SHIP '                  16500099
165100                                      TO DP013-PARAGRAPH          16510099
165200              MOVE 'VERIFY SERIAL SHIP NUMBER'                    16520099
165300                                  TO DP013-MESSAGE-TEXT (1)       16530099
165400              MOVE DK-SERIAL-SHIP-CDE-NUM                         16540099
165500                                  TO DP013-MESSAGE-TEXT (2)       16550099
165600              MOVE SQLCA   TO DP013-SQLCA                         16560099
165700              MOVE 'TSHPUNT' TO DP013-DB2-TABLE-NAME (1)          16570099
165800              SET DP013-DB2-ABEND                                 16580099
165900                  DP013-XCTL-DISPLAY-RESTART TO TRUE              16590099
166000              PERFORM DP013-0000-PROCESS-ABEND                    16600099
166100     END-EVALUATE.                                                16610099
166200                                                                  16620099
166300******************************************************************16630099
166400 3010-GET-TRIP-ID.                                                16640099
166500                                                                  16650099
166600     EXEC SQL                                                     16660099
166700          SELECT DISTINCT                                         16670099
166800                 B.STATUS_DTE                                     16680099
166900               , B.TRIP_ID                                        16690099
167000            INTO :TRIPST-STATUS-DTE                               16700099
167100               , :TRIPST-TRIP-ID                                  16710099
167200          FROM   TVHTRIP A                                        16720099
167300                ,TTRIPST B                                        16730099
167400                ,TVEHICL C                                        16740099
167500          WHERE A.OWNER_SCAC_ID = :DK-SCAC-ID                     16750099
167600            AND A.VEH_NBR       = :DK-TRLR-NBR                    16760099
167700            AND B.OPER_UNT_ID   = :DK-OPER-UNT-ID                 16770099
167800            AND B.FCLTY_ID      = :DK-FCLTY-ID                    16780099
167900            AND A.TRIP_ID = B.TRIP_ID                             16790099
168000            AND B.TRIP_ID = C.CURR_TRIP_ID                        16800099
168100            AND B.STATUS_DTE =                                    16810099
168200                  (SELECT MAX(D.STATUS_DTE)                       16820099
168300                     FROM TTRIPST D                               16830099
168400                    WHERE D.TRIP_ID       = A.TRIP_ID)            16840099
168500     END-EXEC                                                     16850099
168600                                                                  16860099
168700     EVALUATE TRUE                                                16870099
168800         WHEN SQLCODE = +0                                        16880099
168900              MOVE TRIPST-TRIP-ID TO ASC-TRIP-ID                  16890099
169000         WHEN SQLCODE = -305                                      16900099
169100         WHEN SQLCODE = +100                                      16910099
169200         WHEN SQLCODE = -904                                      16920099
169300         WHEN SQLCODE = -913                                      16930099
169400              CONTINUE                                            16940099
169500         WHEN OTHER                                               16950099
169600           MOVE DK-OPER-UNT-ID         TO PV-DISP-OPER            16960099
169700           STRING  ' SUKCS760- 3010-  '      DELIMITED BY SIZE    16970099
169800                   ' OPER-'                  DELIMITED BY SIZE    16980099
169900                   PV-DISP-OPER              DELIMITED BY SIZE    16990099
170000                   ' SCAC-'                  DELIMITED BY SIZE    17000099
170100                   DK-SCAC-ID                DELIMITED BY SIZE    17010099
170200                   ' TRLR-'                  DELIMITED BY SIZE    17020099
170300                   DK-TRLR-NBR               DELIMITED BY SIZE    17030099
170400                                  INTO PV-CICS-MSG-AREA           17040099
170500                                                                  17050099
170600              PERFORM 9900-WRITE-CICS-LOG                         17060099
170700              MOVE '3010-GET-TRIP-ID'                             17070099
170800                              TO DP013-PARAGRAPH                  17080099
170900              MOVE 'SCAC ID -'                                    17090099
171000                              TO DP013-MESSAGE-TEXT (1)           17100099
171100              MOVE  DK-SCAC-ID                                    17110099
171200                               TO DP013-MESSAGE-TEXT (2)          17120099
171300              MOVE 'TRLR NBR - '                                  17130099
171400                               TO DP013-MESSAGE-TEXT (3)          17140099
171500              MOVE  DK-TRLR-NBR                                   17150099
171600                               TO DP013-MESSAGE-TEXT (4)          17160099
171700              MOVE SQLCA      TO DP013-SQLCA                      17170099
171800              MOVE 'TVHTRIP ' TO DP013-DB2-TABLE-NAME (1)         17180099
171900              MOVE 'TTRIPST ' TO DP013-DB2-TABLE-NAME (2)         17190099
172000              MOVE 'TVEHICL ' TO DP013-DB2-TABLE-NAME (3)         17200099
172100              SET DP013-DB2-ABEND                                 17210099
172200                  DP013-XCTL-DISPLAY-RESTART                      17220099
172300                              TO TRUE                             17230099
172400              PERFORM DP013-0000-PROCESS-ABEND                    17240099
172500     END-EVALUATE.                                                17250099
172600                                                                  17260099
172700*----------------------------------------------------------------*17270099
172800*  CHECK THE OPER UNIT TABLE TO VERIFY THE OPER UNIT             *17280099
172900*  ENTERED ON THE MAP IS VALID.                                  *17290099
173000*                                                                *17300099
173100*  CALL MODULE TO GET DC LOCATION DESCRIPTION.                   *17310099
173200*----------------------------------------------------------------*17320099
173300 3020-VALIDATE-OPER-UNT-ID.                                       17330099
173400                                                                  17340099
173800     INITIALIZE XL071-COMMAREA-REC.                               17380099
173900     MOVE DK-OPER-UNT-ID  TO XL071-LOCATION-NUMBER.               17390099
174000                                                                  17400099
174100     CALL PC-LOCATION-MODULE  USING                               17410099
174200                                    DFHEIBLK                      17420099
174300                                    XL071-COMMAREA                17430099
174400                                    XL071-COMMAREA-REC.           17440099
174500                                                                  17450099
174600                                                                  17460099
174700     IF XL071-LOC-TYP-CDE NOT = 'DC'                              17470099
174800         SET PS-ERROR TO TRUE                                     17480099
174900     ELSE                                                         17490099
175000         IF XL071-LOC-NOT-FOUND                                   17500099
175100             SET PS-ERROR TO TRUE                                 17510099
175200         ELSE                                                     17520099
175300             IF XL071-BAD-DB2-RETURN                              17530099
175400                 MOVE '3020-VALIDATE-OPER-UNT-ID'                 17540099
175500                                         TO DP013-PARAGRAPH       17550099
175600                 MOVE 'VALIDATE OPER UNIT'                        17560099
175700                                         TO DP013-MESSAGE-TEXT (1)17570099
175800                 MOVE XL071-SQLCA    TO SQLCA                     17580099
175900                 MOVE SQLCA          TO DP013-SQLCA               17590099
176000                 MOVE 'XLT00010'     TO DP013-DB2-TABLE-NAME (1)  17600099
176100                 SET DP013-DB2-ABEND TO TRUE                      17610099
176200                 SET DP013-XCTL-DISPLAY-RESTART TO TRUE           17620099
176300                 PERFORM DP013-0000-PROCESS-ABEND                 17630099
176400             END-IF                                               17640099
176500         END-IF                                                   17650099
176600     END-IF.                                                      17660099
176700                                                                  17670099
176800****************************************************************  17680099
176900* CALL LOCATION MODULE TO GET DC LOCATION DESCRIPTION          *  17690099
177000****************************************************************  17700099
177100 3030-CALL-LOCATION-MODULE.                                       17710099
177200* HIERARCY DOMAIN TABLE XL00010                                   17720099
177300                                                                  17730099
177400     INITIALIZE XL071-COMMAREA-REC.                               17740099
177500     MOVE DK-OPER-UNT-ID             TO XL071-LOCATION-NUMBER.    17750099
177600                                                                  17760099
177700     CALL PC-LOCATION-MODULE  USING DFHEIBLK                      17770099
177800                                    XL071-COMMAREA                17780099
177900                                    XL071-COMMAREA-REC.           17790099
178000                                                                  17800099
178100     IF XL071-NO-ERRORS                                           17810099
178200         MOVE XL071-LOC-NM           TO ASC-FCLTY-NME             17820099
178300     ELSE                                                         17830099
178400         MOVE 'STORE NAME NOT FOUND' TO ASC-FCLTY-NME             17840099
178500     END-IF.                                                      17850099
178600                                                                  17860099
178700                                                                  17870099
178800******************************************************************17880099
178900*CHECK THE TRIP TABLE TO VERIFY THE TRIP ENTERED ON THE MAP IS ***17890099
179000*VALID                                                         ***17900099
179100******************************************************************17910099
179200 3040-VALIDATE-TRIP.                                              17920099
179300                                                                  17930099
179400     EXEC SQL                                                     17940099
179500          SELECT  TRIP_ID                                         17950099
179600               ,  OWNER_SCAC_ID                                   17960099
179700               ,  VEH_NBR                                         17970099
179800            INTO :TRIPST-TRIP-ID                                  17980099
179900               , :VHTRIP-OWNER-SCAC-ID                            17990099
180000               , :VHTRIP-VEH-NBR :DN-VEH-NBR                      18000099
180100          FROM   TVHTRIP                                          18010099
180200          WHERE  TRIP_ID        = :DK-TRIP-ID                     18020099
180300     END-EXEC.                                                    18030099
180400                                                                  18040099
180500     EVALUATE TRUE                                                18050099
180600         WHEN SQLCODE = +0                                        18060099
180700             SET PS-TRIP-EXISTS TO TRUE                           18070099
180800             MOVE VHTRIP-OWNER-SCAC-ID TO ASC-SCAC                18080099
180900             MOVE ASC-SCAC             TO ASCACO                  18090099
181000             IF DN-VEH-NBR = -1                                   18100099
181100                MOVE SPACES            TO ASC-TRAILER             18110099
181200             ELSE                                                 18120099
181300                MOVE VHTRIP-VEH-NBR    TO ASC-TRAILER             18130099
181400             END-IF                                               18140099
181500             MOVE ASC-TRAILER          TO ATRLRO                  18150099
181600         WHEN SQLCODE = +100                                      18160099
181700             CONTINUE                                             18170099
181800         WHEN OTHER                                               18180099
181900               MOVE DK-OPER-UNT-ID         TO PV-DISP-OPER        18190099
182000               MOVE DK-TRIP-ID             TO PV-DISP-TRIP        18200099
182100               STRING  ' SUKCS760- 3040-  '      DELIMITED BY SIZE18210099
182200                       ' OPER-'                  DELIMITED BY SIZE18220099
182300                       PV-DISP-OPER              DELIMITED BY SIZE18230099
182400                       ' TRIP-'                  DELIMITED BY SIZE18240099
182500                       PV-DISP-TRIP              DELIMITED BY SIZE18250099
182600                                      INTO PV-CICS-MSG-AREA       18260099
182700                                                                  18270099
182800              PERFORM 9900-WRITE-CICS-LOG                         18280099
182900              MOVE '3040-VALIDATE-TRIP'                           18290099
183000                              TO DP013-PARAGRAPH                  18300099
183100              MOVE 'TRIP ID - '                                   18310099
183200                              TO DP013-MESSAGE-TEXT (1)           18320099
183300              MOVE DK-TRIP-ID                                     18330099
183400                              TO DP013-MESSAGE-TEXT (2)           18340099
183500              MOVE SQLCA      TO DP013-SQLCA                      18350099
183600              MOVE 'TVHTRIP ' TO DP013-DB2-TABLE-NAME (1)         18360099
183700              MOVE 'TTRIPST ' TO DP013-DB2-TABLE-NAME (2)         18370099
183800              SET DP013-DB2-ABEND                                 18380099
183900                  DP013-XCTL-DISPLAY-RESTART                      18390099
184000                              TO TRUE                             18400099
184100              PERFORM DP013-0000-PROCESS-ABEND                    18410099
184200     END-EVALUATE.                                                18420099
184300                                                                  18430099
184400*----------------------------------------------------------------*18440099
184500*  CHECK THE VEHICLE TRIP TABLE AND TRIP STATUS TABLE TO VERIFY  *18450099
184600*  THE TRAILER ENTERED ON THE MAP IS VALID                       *18460099
184700*----------------------------------------------------------------*18470099
184800 3050-VALIDATE-TRAILER.                                           18480099
184900                                                                  18490099
185000     EXEC SQL                                                     18500099
185100          SELECT B.TRIP_ID                                        18510099
185200            INTO :TRIPST-TRIP-ID                                  18520099
185300          FROM   TVHTRIP A                                        18530099
185400                ,TTRIPST B                                        18540099
185500          WHERE A.OWNER_SCAC_ID = :DK-SCAC-ID                     18550099
185600            AND A.VEH_NBR       = :DK-TRLR-NBR                    18560099
185700            AND B.OPER_UNT_ID   = :DK-OPER-UNT-ID                 18570099
185800            AND B.FCLTY_ID      = :DK-FCLTY-ID                    18580099
185900            AND A.TRIP_ID = B.TRIP_ID                             18590099
186000     END-EXEC.                                                    18600099
186100                                                                  18610099
186200     EVALUATE TRUE                                                18620099
186300         WHEN SQLCODE = +0                                        18630099
186400         WHEN SQLCODE = -811                                      18640099
186500             SET PS-TRAILER-EXISTS TO TRUE                        18650099
186600         WHEN SQLCODE = +100                                      18660099
186700              CONTINUE                                            18670099
186800         WHEN OTHER                                               18680099
186900               MOVE DK-OPER-UNT-ID         TO PV-DISP-OPER        18690099
187000               STRING  ' SUKCS760- 3050-  '      DELIMITED BY SIZE18700099
187100                       ' OPER-'                  DELIMITED BY SIZE18710099
187200                       PV-DISP-OPER              DELIMITED BY SIZE18720099
187300                       ' SCAC-'                  DELIMITED BY SIZE18730099
187400                       DK-SCAC-ID                DELIMITED BY SIZE18740099
187500                       ' TRLR-'                  DELIMITED BY SIZE18750099
187600                       DK-TRLR-NBR               DELIMITED BY SIZE18760099
187700                                      INTO PV-CICS-MSG-AREA       18770099
187800                                                                  18780099
187900              PERFORM 9900-WRITE-CICS-LOG                         18790099
188000              MOVE '3050-VALIDATE-TRAILER'                        18800099
188100                              TO DP013-PARAGRAPH                  18810099
188200              MOVE 'SCAC ID '                                     18820099
188300                              TO DP013-MESSAGE-TEXT (1)           18830099
188400              MOVE DK-SCAC-ID                                     18840099
188500                              TO DP013-MESSAGE-TEXT (2)           18850099
188600              MOVE 'TRLR NBR - '                                  18860099
188700                              TO DP013-MESSAGE-TEXT (3)           18870099
188800              MOVE DK-TRLR-NBR                                    18880099
188900                              TO DP013-MESSAGE-TEXT (4)           18890099
189000              MOVE SQLCA      TO DP013-SQLCA                      18900099
189100              MOVE 'TVHTRIP ' TO DP013-DB2-TABLE-NAME (1)         18910099
189200              MOVE 'TTRIPST ' TO DP013-DB2-TABLE-NAME (2)         18920099
189300              MOVE 'TVEHICL ' TO DP013-DB2-TABLE-NAME (3)         18930099
189400              SET DP013-DB2-ABEND                                 18940099
189500                  DP013-XCTL-DISPLAY-RESTART                      18950099
189600                              TO TRUE                             18960099
189700              PERFORM DP013-0000-PROCESS-ABEND                    18970099
189800     END-EVALUATE.                                                18980099
189900                                                                  18990099
190000*----------------------------------------------------------------*19000099
190100*  CHECK THE VEHICLE TRIP TABLE AND TRIP STATUS TABLE TO VERIFY  *19010099
190200*  THE TRAILER ENTERED ON THE MAP IS VALID                       *19020099
190300*  *** USE WHEN ONLY THE TRAILER IS ENTERED.                     *19030099
190400*----------------------------------------------------------------*19040099
190500 3055-VALIDATE-TRAILER.                                           19050099
190600                                                                  19060099
190700     EXEC SQL                                                     19070099
190800          SELECT  TRIP_ID                                         19080099
190900               ,  OWNER_SCAC_ID                                   19090099
191000               ,  VEH_NBR                                         19100099
191100            INTO :TRIPST-TRIP-ID                                  19110099
191200               , :VHTRIP-OWNER-SCAC-ID                            19120099
191300               , :VHTRIP-VEH-NBR :DN-VEH-NBR                      19130099
191400          FROM   TVHTRIP                                          19140099
191500          WHERE  VEH_NBR        = :DK-TRLR-NBR                    19150099
191600            AND  OWNER_SCAC_ID  = :DK-SCAC-ID                     19160099
191700     END-EXEC.                                                    19170099
191800                                                                  19180099
191900     EVALUATE TRUE                                                19190099
192000         WHEN SQLCODE = +0                                        19200099
192100             SET PS-TRAILER-EXISTS TO TRUE                        19210099
192200             MOVE VHTRIP-OWNER-SCAC-ID TO ASC-SCAC                19220099
192300             MOVE ASC-SCAC             TO ASCACO                  19230099
192400             IF DN-VEH-NBR = -1                                   19240099
192500                MOVE SPACES            TO ASC-TRAILER             19250099
192600             ELSE                                                 19260099
192700                MOVE VHTRIP-VEH-NBR    TO ASC-TRAILER             19270099
192800             END-IF                                               19280099
192900             MOVE ASC-TRAILER          TO ATRLRO                  19290099
193000             MOVE TRIPST-TRIP-ID       TO ASC-TRIP-ID             19300099
193100             MOVE ASC-TRIP-ID          TO ATRIPO                  19310099
193200         WHEN SQLCODE = +100                                      19320099
193300             CONTINUE                                             19330099
193400         WHEN OTHER                                               19340099
193500               MOVE DK-OPER-UNT-ID         TO PV-DISP-OPER        19350099
193600               STRING  ' SUKCS760- 3055-  '      DELIMITED BY SIZE19360099
193700                       ' OPER-'                  DELIMITED BY SIZE19370099
193800                       PV-DISP-OPER              DELIMITED BY SIZE19380099
193900                       ' SCAC-'                  DELIMITED BY SIZE19390099
194000                       DK-SCAC-ID                DELIMITED BY SIZE19400099
194100                       ' TRLR-'                  DELIMITED BY SIZE19410099
194200                       DK-TRLR-NBR               DELIMITED BY SIZE19420099
194300                                      INTO PV-CICS-MSG-AREA       19430099
194400                                                                  19440099
194500              PERFORM 9900-WRITE-CICS-LOG                         19450099
194600              MOVE '3055-VALIDATE-TRAILER'                        19460099
194700                              TO DP013-PARAGRAPH                  19470099
194800              MOVE 'SCAC ID - '                                   19480099
194900                              TO DP013-MESSAGE-TEXT (1)           19490099
195000              MOVE DK-SCAC-ID                                     19500099
195100                              TO DP013-MESSAGE-TEXT (2)           19510099
195200              MOVE 'TRLR NBR - '                                  19520099
195300                              TO DP013-MESSAGE-TEXT (3)           19530099
195400              MOVE DK-TRLR-NBR                                    19540099
195500                              TO DP013-MESSAGE-TEXT (4)           19550099
195600              MOVE SQLCA      TO DP013-SQLCA                      19560099
195700              MOVE 'TVHTRIP ' TO DP013-DB2-TABLE-NAME (1)         19570099
195800              SET DP013-DB2-ABEND                                 19580099
195900                  DP013-XCTL-DISPLAY-RESTART                      19590099
196000                              TO TRUE                             19600099
196100              PERFORM DP013-0000-PROCESS-ABEND                    19610099
196200     END-EVALUATE.                                                19620099
196300                                                                  19630099
196400*----------------------------------------------------------------*19640099
196500*  CHECK THE EXTERNAL ENTERPRISE TABLE TO VERIFY THE SCAC CODE   *19650099
196600*  ENTERED IS VALID.                                             *19660099
196700*----------------------------------------------------------------*19670099
196800 3060-VALIDATE-SHIP-CDE.                                          19680099
196900                                                                  19690099
197000     EXEC SQL                                                     19700099
197100            SELECT  DISTINCT                                      19710099
197200                    SHIPT_UNT_ID                                  19720099
197300             INTO  :SHPUNT-SHIPT-UNT-ID                           19730099
197400             FROM  TSHPUNT                                        19740099
197500             WHERE  SHIPT_UNT_ID = :DK-SERIAL-SHIP-CDE            19750099
197600               AND  ACTV_IND     = 'A'                            19760099
197700     END-EXEC.                                                    19770099
197800                                                                  19780099
197900     EVALUATE TRUE                                                19790099
198000         WHEN SQLCODE = +0                                        19800099
198100         WHEN SQLCODE = -811                                      19810099
198200             SET PS-SHIP-CDE-EXISTS       TO TRUE                 19820099
198300         WHEN SQLCODE = +100                                      19830099
198400             SET PS-SHIP-CDE-DOESNT-EXIST TO TRUE                 19840099
198500         WHEN OTHER                                               19850099
198600               MOVE DK-OPER-UNT-ID         TO PV-DISP-OPER        19860099
198700               MOVE DK-SERIAL-SHIP-CDE-NUM TO PV-DISP-SSCC        19870099
198800               STRING  ' SUKCS760- 3060-  '      DELIMITED BY SIZE19880099
198900                       ' OPER-'                  DELIMITED BY SIZE19890099
199000                       PV-DISP-OPER              DELIMITED BY SIZE19900099
199100                       ' SSCC-'                  DELIMITED BY SIZE19910099
199200                       PV-DISP-SSCC              DELIMITED BY SIZE19920099
199300                                      INTO PV-CICS-MSG-AREA       19930099
199400                                                                  19940099
199500             PERFORM 9900-WRITE-CICS-LOG                          19950099
199600             MOVE '3060-VALIDATE-SHIP-CDE'                        19960099
199700                             TO DP013-PARAGRAPH                   19970099
199800             MOVE 'SERIAL SHIP CDE - '                            19980099
199900                             TO DP013-MESSAGE-TEXT (1)            19990099
200000             MOVE DK-SERIAL-SHIP-CDE                              20000099
200100                             TO DP013-MESSAGE-TEXT (2)            20010099
200200             MOVE SQLCA      TO DP013-SQLCA                       20020099
200300             MOVE 'TSHPUNT'  TO DP013-DB2-TABLE-NAME (1)          20030099
200400             SET DP013-DB2-ABEND                                  20040099
200500                             TO TRUE                              20050099
200600             SET DP013-XCTL-DISPLAY-RESTART                       20060099
200700                             TO TRUE                              20070099
200800             PERFORM DP013-0000-PROCESS-ABEND                     20080099
200900     END-EVALUATE.                                                20090099
201000                                                                  20100099
201100******************************************************************20110099
201200* VALIDATE PO NUMBER FROM TSHPTPO                                 20120099
201300******************************************************************20130099
201400 3070-VALIDATE-PO-NBR.                                            20140099
201500                                                                  20150099
201600     IF PS-RECEIVER-EXISTS                                        20160099
201700         EXEC SQL                                                 20170099
201800            SELECT  DISTINCT                                      20180099
201900                    ORD_NBR                                       20190099
202000                   ,REC_SEQ_NBR                                   20200099
202100                   ,CURR_OPER_UNT_ID                              20210099
202200              INTO  :RECEIV-ORD-NBR                               20220099
202300                   ,:RECEIV-REC-SEQ-NBR                           20230099
202400                   ,:RECEIV-CURR-OPER-UNT-ID                      20240099
202500              FROM  TRECEIV                                       20250099
202600             WHERE  ORD_NBR     = :DK-PO-NBR                      20260099
202700             AND    REC_SEQ_NBR = :DK-REC-SEQ-NBR                 20270099
202800         END-EXEC                                                 20280099
202900      ELSE                                                        20290099
203000           MOVE ASC-KEY-OPER-UNT-ID TO RECEIV-CURR-OPER-UNT-ID    20300099
203100         EXEC SQL                                                 20310099
203200            SELECT  DISTINCT                                      20320099
203300                    PO_NBR                                        20330099
203400              INTO :SHPTPO-PO-NBR                                 20340099
203500              FROM  TSHPTPO                                       20350099
203600             WHERE  PO_NBR = :DK-PO-NBR                           20360099
203700         END-EXEC                                                 20370099
203800      END-IF                                                      20380099
203900                                                                  20390099
204000         EVALUATE TRUE                                            20400099
204100             WHEN SQLCODE = +0                                    20410099
204200                 SET PS-PO-EXISTS TO TRUE                         20420099
204300             WHEN SQLCODE = +100                                  20430099
204400             WHEN SQLCODE = -811                                  20440099
204500             WHEN SQLCODE = -904                                  20450099
204600             WHEN SQLCODE = -913                                  20460099
204700                 CONTINUE                                         20470099
204800             WHEN OTHER                                           20480099
204900               MOVE DK-OPER-UNT-ID         TO PV-DISP-OPER        20490099
205000               MOVE DK-PO-NBR              TO PV-DISP-PO          20500099
205100               MOVE DK-REC-SEQ-NBR         TO PV-DISP-RCVR        20510099
205200               STRING  ' SUKCS760- 3070-  '      DELIMITED BY SIZE20520099
205300                       ' OPER-'                  DELIMITED BY SIZE20530099
205400                       PV-DISP-OPER              DELIMITED BY SIZE20540099
205500                       ' PO-'                    DELIMITED BY SIZE20550099
205600                       PV-DISP-PO                DELIMITED BY SIZE20560099
205700                       ' RCVR-'                  DELIMITED BY SIZE20570099
205800                       PV-DISP-RCVR              DELIMITED BY SIZE20580099
205900                                      INTO PV-CICS-MSG-AREA       20590099
206000                                                                  20600099
206100                 PERFORM 9900-WRITE-CICS-LOG                      20610099
206200                 MOVE '3070-VALIDATE-PO-NBR'                      20620099
206300                                 TO DP013-PARAGRAPH               20630099
206400                 MOVE 'PO NBR -   '                               20640099
206500                                 TO DP013-MESSAGE-TEXT (1)        20650099
206600                 MOVE DK-PO-NBR                                   20660099
206700                                 TO DP013-MESSAGE-TEXT (2)        20670099
206800                 MOVE SQLCA      TO DP013-SQLCA                   20680099
206900                 MOVE 'TSHPTPO'  TO DP013-DB2-TABLE-NAME (1)      20690099
207000                 SET DP013-DB2-ABEND                              20700099
207100                                 TO TRUE                          20710099
207200                 SET DP013-XCTL-DISPLAY-RESTART                   20720099
207300                                 TO TRUE                          20730099
207400                 PERFORM DP013-0000-PROCESS-ABEND                 20740099
207500         END-EVALUATE.                                            20750099
207600                                                                  20760099
207700*----------------------------------------------------------------*20770099
207800*  CHECK THE EXTERNAL ENTERPRISE TABLE TO VERIFY THE SCAC CODE   *20780099
207900*  ENTERED IS VALID.                                             *20790099
208000*----------------------------------------------------------------*20800099
208100 3100-VALIDATE-SCAC-CDE.                                          20810099
208200                                                                  20820099
208300     EXEC SQL                                                     20830099
208400        SELECT  A.SCAC_CDE                                        20840099
208500          INTO :EXTENT-SCAC-CDE                                   20850099
208600          FROM  TEXTENT A                                         20860099
208700         WHERE  A.SCAC_CDE    = :DK-SCAC-ID                       20870099
208800           AND  A.CARRIER_IND = 'Y'                               20880099
208810         WITH UR                                                  20881099
208900     END-EXEC.                                                    20890099
209000                                                                  20900099
209100     EVALUATE TRUE                                                20910099
209200         WHEN SQLCODE = +0                                        20920099
209300         WHEN SQLCODE = -811                                      20930099
209400             SET PS-SCAC-EXISTS       TO TRUE                     20940099
209500         WHEN SQLCODE = +100                                      20950099
209600             SET PS-SCAC-DOESNT-EXIST TO TRUE                     20960099
209700         WHEN OTHER                                               20970099
209800               MOVE DK-OPER-UNT-ID         TO PV-DISP-OPER        20980099
209900               STRING  ' SUKCS760- 3100-  '      DELIMITED BY SIZE20990099
210000                       ' OPER-'                  DELIMITED BY SIZE21000099
210100                       PV-DISP-OPER              DELIMITED BY SIZE21010099
210200                       ' SCAC-'                  DELIMITED BY SIZE21020099
210300                       DK-SCAC-ID                DELIMITED BY SIZE21030099
210400                                      INTO PV-CICS-MSG-AREA       21040099
210500                                                                  21050099
210600             PERFORM 9900-WRITE-CICS-LOG                          21060099
210700             MOVE '3100-VALIDATE-SCAC-CDE'                        21070099
210800                             TO DP013-PARAGRAPH                   21080099
210900             MOVE 'SCAC ID '                                      21090099
211000                             TO DP013-MESSAGE-TEXT (1)            21100099
211100             MOVE DK-SCAC-ID                                      21110099
211200                             TO DP013-MESSAGE-TEXT (2)            21120099
211300             MOVE SQLCA      TO DP013-SQLCA                       21130099
211400             MOVE 'TEXTENT'  TO DP013-DB2-TABLE-NAME (1)          21140099
211500             SET DP013-DB2-ABEND                                  21150099
211600                             TO TRUE                              21160099
211700             SET DP013-XCTL-DISPLAY-RESTART                       21170099
211800                             TO TRUE                              21180099
211900             PERFORM DP013-0000-PROCESS-ABEND                     21190099
212000     END-EVALUATE.                                                21200099
212100                                                                  21210099
212200*----------------------------------------------------------------*21220099
212300*  VALIDATE THE CURRENT DATE ENTERED BY THE ASSOCIATE             21230099
212400*----------------------------------------------------------------*21240099
212500 3105-VALIDATE-CURR-DATE.                                         21250099
212600     MOVE  ASC-CURR-MM  TO  PV-CURR-MM.                           21260099
212700     MOVE  ASC-CURR-DD  TO  PV-CURR-DD.                           21270099
212800     MOVE  ASC-CURR-YY  TO  PV-CURR-YY.                           21280099
212900                                                                  21290099
213000                                                                  21300099
213100         INITIALIZE DPG51 DPG52 DPG53                             21310099
213200                    DPG54 DPG55 DPG56                             21320099
213300         SET  DPG51-ACTUAL-CALENDAR-ONLY                          21330099
213400              DPG51-DO-NOT-INCR-DECR-DATE                         21340099
213500                                    TO TRUE                       21350099
213600*            'CCYYMMDD'                                           21360099
213700         SET  DPG52-LK-DTE-ISO                                    21370099
213800                                    TO TRUE                       21380099
213900         MOVE PV-CURR-DATE-HOLD     TO DPG52-LK-DATE-INPUT        21390099
214000         CALL PC-CALENDAR-MODULE USING DPG51 DPG52 DPG53          21400099
214100                                       DPG54 DPG55 DPG56          21410099
214200         IF (DPG54-DATE-INVALID  OR                               21420099
214300             DPG54-SEVERE-ERROR)                                  21430099
214400             SET PS-ERROR                                         21440099
214500                 DP020-MSG-FATAL       TO TRUE                    21450099
214600             MOVE PC-TSYMSG-00009      TO DP020-MSG-NUMBER        21460099
214700             MOVE DP015-UNP-ALP-BRT-OFF                           21470099
214800                                       TO ACURRMMA                21480099
214900                                          ACURRDDA                21490099
215000                                          ACURRYYA                21500099
215100             MOVE DP015-RED            TO ACURRMMC                21510099
215200                                          ACURRDDC                21520099
215300                                          ACURRYYC                21530099
215400             MOVE DP015-REVERSE        TO ACURRMMH                21540099
215500                                          ACURRDDH                21550099
215600                                          ACURRYYH                21560099
215700             MOVE -1                   TO ACURRMML                21570099
215800             SET DP030-SET-CURSOR-APPL-1                          21580099
215900                                       TO TRUE                    21590099
216000         END-IF.                                                  21600099
216100                                                                  21610099
216200*----------------------------------------------------------------*21620099
216300*  VALIDATE THE FROM AND TO DATE RANGE ENTERED BY THE ASSOCIATE   21630099
216400*----------------------------------------------------------------*21640099
216500 3106-VALIDATE-FROM-TO.                                           21650099
216600     MOVE  ASC-FROM-MM  TO  PV-FROM-MM.                           21660099
216700     MOVE  ASC-FROM-DD  TO  PV-FROM-DD.                           21670099
216800     MOVE  ASC-FROM-YY  TO  PV-FROM-YY.                           21680099
216900                                                                  21690099
217000     MOVE  ASC-TO-MM    TO  PV-TO-MM.                             21700099
217100     MOVE  ASC-TO-DD    TO  PV-TO-DD.                             21710099
217200     MOVE  ASC-TO-YY    TO  PV-TO-YY.                             21720099
217300                                                                  21730099
217400     IF  PV-TO-DATE-HOLD  >=  PV-FROM-DATE-HOLD                   21740099
217500         CONTINUE                                                 21750099
217600     ELSE                                                         21760099
217700*DATE RANGE IS INVALID                                            21770099
217800         SET PS-ERROR                                             21780099
217900         DP020-MSG-FATAL             TO TRUE                      21790099
218000         MOVE PC-TSYMSG-00395        TO DP020-MSG-NUMBER          21800099
218100         MOVE DP015-UNP-ALP-BRT-OFF  TO AFDTMMA                   21810099
218200                                        AFDTDDA                   21820099
218300                                        AFDTYYA                   21830099
218400                                        ATDTMMA                   21840099
218500                                        ATDTDDA                   21850099
218600                                        ATDTYYA                   21860099
218700         MOVE DP015-RED              TO AFDTMMC                   21870099
218800                                        AFDTDDC                   21880099
218900                                        AFDTYYC                   21890099
219000                                        ATDTMMC                   21900099
219100                                        ATDTDDC                   21910099
219200                                        ATDTYYC                   21920099
219300         MOVE DP015-REVERSE          TO AFDTMMH                   21930099
219400                                        AFDTDDH                   21940099
219500                                        AFDTYYH                   21950099
219600                                        ATDTMMH                   21960099
219700                                        ATDTDDH                   21970099
219800                                        ATDTYYH                   21980099
219900         MOVE -1                     TO AFDTMML                   21990099
220000         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      22000099
220100     END-IF.                                                      22010099
220200                                                                  22020099
220300     IF  PS-NO-ERROR                                              22030099
220400         INITIALIZE DPG51 DPG52 DPG53                             22040099
220500                    DPG54 DPG55 DPG56                             22050099
220600         SET  DPG51-ACTUAL-CALENDAR-ONLY                          22060099
220700              DPG51-DO-NOT-INCR-DECR-DATE                         22070099
220800                                    TO TRUE                       22080099
220900*            'CCYYMMDD'                                           22090099
221000         SET  DPG52-LK-DTE-ISO                                    22100099
221100                                    TO TRUE                       22110099
221200         MOVE PV-FROM-DATE-HOLD     TO DPG52-LK-DATE-INPUT        22120099
221300         CALL PC-CALENDAR-MODULE USING DPG51 DPG52 DPG53          22130099
221400                                       DPG54 DPG55 DPG56          22140099
221500         IF (DPG54-DATE-INVALID  OR                               22150099
221600             DPG54-SEVERE-ERROR)                                  22160099
221700             SET PS-ERROR                                         22170099
221800                 DP020-MSG-FATAL       TO TRUE                    22180099
221900             MOVE PC-TSYMSG-00009      TO DP020-MSG-NUMBER        22190099
222000             MOVE DP015-UNP-ALP-BRT-OFF                           22200099
222100                                       TO AFDTMMA                 22210099
222200                                          AFDTDDA                 22220099
222300                                          AFDTYYA                 22230099
222400             MOVE DP015-RED            TO AFDTMMC                 22240099
222500                                          AFDTDDC                 22250099
222600                                          AFDTYYC                 22260099
222700             MOVE DP015-REVERSE        TO AFDTMMH                 22270099
222800                                          AFDTDDH                 22280099
222900                                          AFDTYYH                 22290099
223000             MOVE -1                   TO AFDTMML                 22300099
223100             SET DP030-SET-CURSOR-APPL-1                          22310099
223200                                       TO TRUE                    22320099
223300         END-IF                                                   22330099
223400                                                                  22340099
223500         INITIALIZE DPG51 DPG52 DPG53                             22350099
223600                    DPG54 DPG55 DPG56                             22360099
223700         SET  DPG51-ACTUAL-CALENDAR-ONLY                          22370099
223800              DPG51-DO-NOT-INCR-DECR-DATE                         22380099
223900                                    TO TRUE                       22390099
224000*            'CCYYMMDD'                                           22400099
224100             SET  DPG52-LK-DTE-ISO                                22410099
224200                                    TO TRUE                       22420099
224300         MOVE PV-TO-DATE-HOLD       TO DPG52-LK-DATE-INPUT        22430099
224400         CALL PC-CALENDAR-MODULE USING DPG51 DPG52 DPG53          22440099
224500                                       DPG54 DPG55 DPG56          22450099
224600         IF (DPG54-DATE-INVALID                                   22460099
224700         OR  DPG54-SEVERE-ERROR)                                  22470099
224800             SET PS-ERROR                                         22480099
224900                 DP020-MSG-FATAL       TO TRUE                    22490099
225000             MOVE PC-TSYMSG-00009      TO DP020-MSG-NUMBER        22500099
225100             MOVE DP015-UNP-ALP-BRT-OFF                           22510099
225200                                       TO ATDTMMA                 22520099
225300                                          ATDTDDA                 22530099
225400                                          ATDTYYA                 22540099
225500             MOVE DP015-RED            TO ATDTMMC                 22550099
225600                                          ATDTDDC                 22560099
225700                                          ATDTYYC                 22570099
225800             MOVE DP015-REVERSE        TO ATDTMMH                 22580099
225900                                          ATDTDDH                 22590099
226000                                          ATDTYYH                 22600099
226100             MOVE -1                   TO ATDTMML                 22610099
226200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  22620099
226300         END-IF                                                   22630099
226400     END-IF.                                                      22640099
226500                                                                  22650099
226600 3150-LIST-SEQUENCE.                                              22660099
226700     EXEC SQL                                                     22670099
226800          SELECT FUNC_TXT                                         22680099
226900          INTO  :KRPRPM-FUNC-TXT                                  22690099
227000          FROM   TKRPRPM                                          22700099
227100          WHERE  SYS_PRC_FUNC_CDE  = 'FALTSQ'                     22710099
227200            AND  LOC_ID            = :DK-OPER-UNT-ID              22720099
227300            AND  INTFC_SYS_CDE     = 'KHL'                        22730099
227400            AND  FUNC_PRC_STAT_CDE = 'AC'                         22740099
227500            WITH UR                                               22750099
227600     END-EXEC.                                                    22760099
227700                                                                  22770099
227800     EVALUATE TRUE                                                22780099
227900        WHEN SQLCODE = +0                                         22790099
228000            CONTINUE                                              22800099
228100        WHEN OTHER                                                22810099
228200            MOVE DK-OPER-UNT-ID         TO PV-DISP-OPER           22820099
228300            STRING  ' SUKCS760- 3150-  '      DELIMITED BY SIZE   22830099
228400                    ' OPER-'                  DELIMITED BY SIZE   22840099
228500                    PV-DISP-OPER              DELIMITED BY SIZE   22850099
228600                                   INTO PV-CICS-MSG-AREA          22860099
228700                                                                  22870099
228800            PERFORM 9900-WRITE-CICS-LOG                           22880099
228900            SET PS-ERROR    TO TRUE                               22890099
229000            MOVE '3150-LIST-SEQUENCE'  TO DP013-PARAGRAPH         22900099
229100            MOVE 'OPER UNT ID ' TO DP013-MESSAGE-TEXT (1)         22910099
229200            MOVE  DK-OPER-UNT-ID                                  22920099
229300                                TO DP013-MESSAGE-TEXT (2)         22930099
229400            MOVE SQLCA   TO DP013-SQLCA                           22940099
229500            MOVE 'TKRPRPM ' TO DP013-DB2-TABLE-NAME (1)           22950099
229600            SET DP013-DB2-ABEND                                   22960099
229700                DP013-XCTL-DISPLAY-RESTART TO TRUE                22970099
229800            PERFORM DP013-0000-PROCESS-ABEND                      22980099
229900     END-EVALUATE.                                                22990099
230000                                                                  23000099
230100******************************************************************23010099
230200** MOVE THE DEFAULT ATTRIBUTES TO ALL OF THE OPEN FIELDS ON THE **23020099
230300** MAP.                                                         **23030099
230400******************************************************************23040099
230500 3200-RESET-ATTRIBUTES.                                           23050099
230600     MOVE DP015-UNP-ALP-NOR-MDT    TO AOPERA                      23060099
230700                                      AFCLTYA                     23070099
230800                                      ASCACA                      23080099
230900                                      ATRLRA                      23090099
231000                                      ATRIPA                      23100099
231100                                      APOA                        23110099
231200                                      ARCVRA                      23120099
231300                                      ASERSHPA                    23130099
231400                                      ASEL1A                      23140099
231500                                      ASCACTRLA                   23150099
231600                                      ACREDTEAA                   23160099
231700                                      ACREDTEDA.                  23170099
231800     MOVE DP015-UNP-NUM-NOR-MDT    TO ACURRMMA                    23180099
231900                                      ACURRDDA                    23190099
232000                                      ACURRYYA.                   23200099
232100     MOVE DP015-UNP-ALP-NOR-OFF    TO AFDTMMA                     23210099
232200                                      AFDTDDA                     23220099
232300                                      AFDTYYA                     23230099
232400                                      ATDTMMA                     23240099
232500                                      ATDTDDA                     23250099
232600                                      ATDTYYA                     23260099
232700                                      ASEL2A.                     23270099
232800     MOVE DP015-GREEN              TO AOPERC                      23280099
232900                                      AFCLTYC                     23290099
233000                                      ASCACC                      23300099
233100                                      ATRLRC                      23310099
233200                                      ATRIPC                      23320099
233300                                      APOC                        23330099
233400                                      ARCVRC                      23340099
233500                                      ASERSHPC                    23350099
233600                                      ACURRMMC                    23360099
233700                                      ACURRDDC                    23370099
233800                                      ACURRYYC                    23380099
233900                                      AFDTMMC                     23390099
234000                                      AFDTDDC                     23400099
234100                                      AFDTYYC                     23410099
234200                                      ATDTMMC                     23420099
234300                                      ATDTDDC                     23430099
234400                                      ATDTYYC                     23440099
234500                                      ASEL1C                      23450099
234600                                      ASEL2C                      23460099
234700                                      ASCACTRLC                   23470099
234800                                      ACREDTEAC                   23480099
234900                                      ACREDTEDC.                  23490099
235000     MOVE DP015-UNDERLINE          TO AOPERH                      23500099
235100                                      AFCLTYH                     23510099
235200                                      ASCACH                      23520099
235300                                      ATRLRH                      23530099
235400                                      ATRIPH                      23540099
235500                                      APOH                        23550099
235600                                      ARCVRH                      23560099
235700                                      ASERSHPH                    23570099
235800                                      ACURRMMH                    23580099
235900                                      ACURRDDH                    23590099
236000                                      ACURRYYH                    23600099
236100                                      AFDTMMH                     23610099
236200                                      AFDTDDH                     23620099
236300                                      AFDTYYH                     23630099
236400                                      ATDTMMH                     23640099
236500                                      ATDTDDH                     23650099
236600                                      ATDTYYH                     23660099
236700                                      ASCACTRLH                   23670099
236800                                      ACREDTEAH                   23680099
236900                                      ACREDTEDH                   23690099
237000                                      ASEL1H                      23700099
237100                                      ASEL2H.                     23710099
237200     MOVE SPACES                   TO AMSGLNO.                    23720099
237300                                                                  23730099
237400*----------------------------------------------------------------*23740099
237500*  POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 *23750099
237600*  IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL, MOVE   *23760099
237700*  IT HERE.                                                      *23770099
237800*----------------------------------------------------------------*23780099
237900 4000-BUILD-INITIAL-PANEL.                                        23790099
238000     SET DP030-SET-CURSOR-APPL-1   TO TRUE                        23800099
238100     MOVE -1                       TO ASCACL.                     23810099
238200                                                                  23820099
238300     MOVE SPACE                    TO ASCACO                      23830099
238400                                      ATRLRO.                     23840099
238500     MOVE ZEROES                   TO ATRIPO                      23850099
238600                                      APOO                        23860099
238700                                      ARCVRO                      23870099
238800                                      ASERSHPO.                   23880099
238900                                                                  23890099
239000     MOVE ASC-OPER-UNT-ID          TO AOPERO.                     23900099
239100     MOVE ASC-FCLTY-ID             TO AFCLTYO.                    23910099
239200     MOVE ASC-FCLTY-NME            TO AFDESCO.                    23920099
239300                                                                  23930099
239400     MOVE -1                       TO ASEL1L.                     23940099
239500     MOVE PC-S                     TO ASEL1O.                     23950099
239600                                                                  23960099
239700     MOVE SPACE                    TO ASEL2O.                     23970099
239800                                                                  23980099
239900                                                                  23990099
240000     EXEC SQL                                                     24000099
240100        SET :PV-CURRENT-DATE = CURRENT DATE                       24010099
240200     END-EXEC                                                     24020099
240300                                                                  24030099
240400     MOVE PV-CURRENT-MM            TO ACURRMMO                    24040099
240500                                      ASC-CURR-MM                 24050099
240600     MOVE PV-CURRENT-DD            TO ACURRDDO                    24060099
240700                                      ASC-CURR-DD                 24070099
240800     MOVE PV-CURRENT-YY            TO ACURRYYO                    24080099
240900                                      ASC-CURR-YY                 24090099
241000                                                                  24100099
241100     PERFORM 4200-GET-DFLT-FROM-DATE.                             24110099
241200     MOVE PV-DFLT-MM               TO AFDTMMO                     24120099
241300                                      ASC-FROM-MM                 24130099
241400     MOVE PV-DFLT-DD               TO AFDTDDO                     24140099
241500                                      ASC-FROM-DD                 24150099
241600     MOVE PV-DFLT-YY               TO AFDTYYO                     24160099
241700                                      ASC-FROM-YY                 24170099
241800                                                                  24180099
241900     MOVE PV-CURRENT-MM            TO ATDTMMO                     24190099
242000                                      ASC-TO-MM                   24200099
242100     MOVE PV-CURRENT-DD            TO ATDTDDO                     24210099
242200                                      ASC-TO-DD                   24220099
242300     MOVE PV-CURRENT-YY            TO ATDTYYO                     24230099
242400                                      ASC-TO-YY                   24240099
242500                                                                  24250099
242600*SELECT ON TKRPRPM TABLE                                          24260099
242700                                                                  24270099
242800     PERFORM 3150-LIST-SEQUENCE                                   24280099
242900     IF KRPRPM-FUNC-TXT = 'SCAC/TRLR'                             24290099
243000        MOVE PC-X                     TO ASCACTRLO                24300099
243100     ELSE                                                         24310099
243200        MOVE SPACES                   TO ASCACTRLO                24320099
243300     END-IF                                                       24330099
243400                                                                  24340099
243500     IF KRPRPM-FUNC-TXT = 'DATE ASC'                              24350099
243600        MOVE PC-X                     TO ACREDTEAO                24360099
243700     ELSE                                                         24370099
243800        MOVE SPACES                   TO ACREDTEAO                24380099
243900     END-IF                                                       24390099
244000                                                                  24400099
244100     IF KRPRPM-FUNC-TXT = 'DATE DESC'                             24410099
244200        MOVE PC-X                     TO ACREDTEDO                24420099
244300     ELSE                                                         24430099
244400        MOVE SPACES                   TO ACREDTEDO                24440099
244500     END-IF.                                                      24450099
244600                                                                  24460099
244700*----------------------------------------------------------------*24470099
244800*       GET DEFAULT FROM DATE                                     24480099
244900*----------------------------------------------------------------*24490099
245000 4200-GET-DFLT-FROM-DATE.                                         24500099
245100     EXEC SQL                                                     24510099
245200         SELECT CURRENT DATE - FUNC_QTY DAYS                      24520099
245300           INTO   :PV-DEFAULT-FROM-DATE                           24530099
245400           FROM  TKRPRPM                                          24540099
245500          WHERE LOC_ID            = :DK-OPER-UNT-ID               24550099
245600            AND INTFC_SYS_CDE     = 'KHL'                         24560099
245700            AND SYS_PRC_FUNC_CDE  = 'DVTDAY'                      24570099
245800            AND FUNC_PRC_STAT_CDE = 'AC'                          24580099
245900      END-EXEC.                                                   24590099
246000                                                                  24600099
246100      EVALUATE TRUE                                               24610099
246200         WHEN SQLCODE = +0                                        24620099
246300             CONTINUE                                             24630099
246400         WHEN OTHER                                               24640099
246500               MOVE DK-OPER-UNT-ID         TO PV-DISP-OPER        24650099
246600               STRING  ' SUKCS760- 4200-  '      DELIMITED BY SIZE24660099
246700                       ' OPER-'                  DELIMITED BY SIZE24670099
246800                       PV-DISP-OPER              DELIMITED BY SIZE24680099
246900                                      INTO PV-CICS-MSG-AREA       24690099
247000                                                                  24700099
247100             PERFORM 9900-WRITE-CICS-LOG                          24710099
247200             SET PS-ERROR    TO TRUE                              24720099
247300             MOVE '4200-GET-DFLT-FROM-DATE ' TO DP013-PARAGRAPH   24730099
247400             MOVE 'OPER UNT ID ' TO DP013-MESSAGE-TEXT (1)        24740099
247500             MOVE DK-OPER-UNT-ID                                  24750099
247600                                 TO DP013-MESSAGE-TEXT (2)        24760099
247700             MOVE SQLCA   TO DP013-SQLCA                          24770099
247800             MOVE 'TKRPRPM ' TO DP013-DB2-TABLE-NAME (1)          24780099
247900             SET DP013-DB2-ABEND                                  24790099
248000                 DP013-XCTL-DISPLAY-RESTART TO TRUE               24800099
248100             PERFORM DP013-0000-PROCESS-ABEND                     24810099
248200     END-EVALUATE.                                                24820099
248300                                                                  24830099
248400*----------------------------------------------------------------*24840099
248500*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *24850099
248600*----------------------------------------------------------------*24860099
248700 4400-MOVE-COMMAREA-TO-SCREEN.                                    24870099
248800     MOVE ASC-OPER-UNT-ID          TO AOPERO.                     24880099
248900     MOVE ASC-FCLTY-ID             TO AFCLTYO.                    24890099
249000     MOVE ASC-FCLTY-NME            TO AFDESCO.                    24900099
249100     MOVE ASC-SCAC                 TO ASCACO.                     24910099
249200     MOVE ASC-TRAILER              TO ATRLRO.                     24920099
249300     MOVE ASC-TRIP-ID              TO ATRIPO.                     24930099
249400     MOVE ASC-PO-NBR               TO APOO.                       24940099
249500     MOVE ASC-REC-SEQ-NBR          TO ARCVRO.                     24950099
249600     MOVE ASC-SERIAL-SHIP-CDE-N    TO ASERSHPO.                   24960099
249700                                                                  24970099
249800     IF ASC-SEL-1 > SPACES                                        24980099
249900        MOVE SPACE                 TO ASEL2O                      24990099
250000     END-IF.                                                      25000099
250100                                                                  25010099
250200     IF ASC-SEL-2 > SPACES                                        25020099
250300        MOVE SPACE                 TO ASEL1O                      25030099
250400     END-IF.                                                      25040099
250500                                                                  25050099
250600     PERFORM 3150-LIST-SEQUENCE.                                  25060099
250700     IF KRPRPM-FUNC-TXT = 'SCAC/TRLR'                             25070099
250800        IF ASC-SEQ-1 > SPACES                                     25080099
250900           MOVE SPACE              TO ACREDTEAO                   25090099
251000                                      ACREDTEDO                   25100099
251100        END-IF                                                    25110099
251200     END-IF                                                       25120099
251300                                                                  25130099
251400     IF KRPRPM-FUNC-TXT = 'DATE ASC'                              25140099
251500        IF ASC-SEQ-2 > SPACES                                     25150099
251600           MOVE SPACE              TO ASCACTRLO                   25160099
251700                                      ACREDTEDO                   25170099
251800        END-IF                                                    25180099
251900     END-IF                                                       25190099
252000                                                                  25200099
252100     IF KRPRPM-FUNC-TXT = 'DATE DESC'                             25210099
252200        IF ASC-SEQ-3 > SPACES                                     25220099
252300           MOVE SPACE              TO ASCACTRLO                   25230099
252400                                      ACREDTEAO                   25240099
252500        END-IF                                                    25250099
252600     END-IF.                                                      25260099
252700                                                                  25270099
252800*----------------------------------------------------------------*25280099
252900*    ABEND PROCESSOR MODULE                                      *25290099
253000*----------------------------------------------------------------*25300099
253100     COPY DPPD013.                                                25310099
253200                                                                  25320099
253300 9900-WRITE-CICS-LOG.                                             25330099
253400                                                                  25340099
253500     MOVE LENGTH OF PV-CICS-MSG-AREA                              25350099
253600          TO PV-COMMAREA-LENGTH                                   25360099
253700                                                                  25370099
253800     EXEC CICS                                                    25380099
253900         WRITEQ TD                                                25390099
254000             QUEUE  ('CSSL')                                      25400099
254100             FROM   (PV-CICS-MSG-AREA)                            25410099
254200             LENGTH (PV-COMMAREA-LENGTH)                          25420099
254300             RESP   (PV-CICS-RESP)                                25430099
254400     END-EXEC.                                                    25440099
254500                                                                  25450099
254600     MOVE SPACES TO PV-CICS-MSG-AREA.                             25460099
254700*                                                                 25470099
