000100***************************************************************** 00010020
000200 IDENTIFICATION DIVISION.                                         00020020
000300***************************************************************** 00030020
000400                                                                  00040020
000500 PROGRAM-ID.             PCKRP006.                                00050020
000600 AUTHOR.                 LARRY SCHLEICHER - STRATAGEM.            00060020
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070020
000800 DATE-WRITTEN            OCTOBER, 1996                            00080020
000900 DATE-COMPILED.                                                   00090020
001000***************************************************************** 00100020
001100***************************************************************** 00110020
001200*                                                               * 00120020
001300*  THIS PROGRAM WILL PRINT THE RECEIVERS OLDER THAN MM/DD/YY    * 00130020
001400*  REPORT.                                                      * 00140020
001500***************************************************************** 00150020
001600*  CHANGED 09/26/14 BY DAVID WELLER                             * 00160020
001700*   CHG0098147 PO-NBR EXPANSION TO 8 DIGITS.                    * 00170020
001800*  CHANGED MM/DD/YY BY XXXXXXXXXXX                              * 00180020
001900*   WR# XXXX XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX * 00190020
002000*                                                               * 00200020
002100***************************************************************** 00210020
002200***************************************************************** 00220020
002300 ENVIRONMENT DIVISION.                                            00230020
002400***************************************************************** 00240020
002500                                                                  00250020
002600 CONFIGURATION SECTION.                                           00260020
002700                                                                  00270020
002800 SOURCE-COMPUTER.        IBM-3090.                                00280020
002900 OBJECT-COMPUTER.        IBM-3090.                                00290020
003000                                                                  00300020
003100 INPUT-OUTPUT SECTION.                                            00310020
003200                                                                  00320020
003300 FILE-CONTROL.                                                    00330020
003400*                                                                 00340020
003500     SELECT EXTRACT-FILE                                          00350020
003600         ASSIGN TO INP01.                                         00360020
003700                                                                  00370020
003800     SELECT PC-RECEIVERS-OLDER-THAN-RPT                           00380020
003900         ASSIGN TO RPT01.                                         00390020
004000*                                                                 00400020
004100***************************************************************** 00410020
004200 DATA DIVISION.                                                   00420020
004300***************************************************************** 00430020
004400*                                                                 00440020
004500 FILE SECTION.                                                    00450020
004600*                                                                 00460020
004700 FD  EXTRACT-FILE                                                 00470020
004800     LABEL RECORDS ARE STANDARD                                   00480020
004900     RECORDING MODE IS F                                          00490020
005000     BLOCK CONTAINS 0 RECORDS                                     00500020
005010*** PRB0064829 START                                              00501021
005100*    RECORD CONTAINS 150 CHARACTERS.                              00510021
005200*01  EXTRACT-RECORD                  PIC X(150).                  00520021
005210     RECORD CONTAINS 200 CHARACTERS.                              00521021
005220 01  EXTRACT-RECORD                  PIC X(200).                  00522021
005230*** PRB0064829 END                                                00523021
005300                                                                  00530020
005400 FD  PC-RECEIVERS-OLDER-THAN-RPT                                  00540020
005500     RECORDING MODE IS F                                          00550020
005600     BLOCK CONTAINS 0  RECORDS.                                   00560020
005700 01  PC-RECEIVERS-OLDER-THAN-RECORD  PIC  X(132).                 00570020
005800*                                                                 00580020
005900                                                                  00590020
006000 WORKING-STORAGE SECTION.                                         00600020
006100*                                                                 00610020
006200 01  PROGRAM-SWITCHES.                                            00620020
006300     05  PS-END-OF-EXTRACT-SW        PIC  X(01)    VALUE 'N'.     00630020
006400         88  PS-END-OF-EXTRACT                     VALUE 'Y'.     00640020
006500         88  PS-PROCESS-EXTRACT                    VALUE 'N'.     00650020
006600     05  PS-VALID-DC-SW              PIC  X(01)    VALUE 'N'.     00660020
006700         88  PS-VALID-DC                           VALUE 'Y'.     00670020
006800         88  PS-INVALID-DC                         VALUE 'N'.     00680020
006900     05  PS-FIRST-PASS-SW            PIC  X(01)    VALUE 'Y'.     00690020
007000         88  PS-NOT-FIRST-PASS                     VALUE 'N'.     00700020
007100     05  PS-FIRST-DETAIL-REC-SW      PIC  X(01)    VALUE 'N'.     00710020
007200         88  PS-FIRST-DETAIL-REC                   VALUE 'Y'.     00720020
007300         88  PS-NOT-FIRST-DETAIL-REC               VALUE 'N'.     00730020
007400     05  PS-HEADER-ONLY-REC-SW       PIC  X(01)    VALUE 'N'.     00740020
007500         88  PS-HEADER-ONLY-REC                    VALUE 'Y'.     00750020
007600         88  PS-NOT-HEADER-ONLY-REC                VALUE 'N'.     00760020
007700*                                                                 00770020
007800 01  PC-CONSTANTS.                                                00780020
007900     05  PC-1                        PIC S9(03)    VALUE +1       00790020
008000                                                   COMP-3.        00800020
008100     05  PC-2                        PIC S9(03)    VALUE +2       00810020
008200                                                   COMP-3.        00820020
008300     05  PC-6                        PIC S9(03)    VALUE +6       00830020
008400                                                   COMP-3.        00840020
008500     05  PC-55                       PIC S9(03)    VALUE +55      00850020
008600                                                   COMP-3.        00860020
008700     05  PC-60                       PIC S9(03)    VALUE +60      00870020
008800                                                   COMP-3.        00880020
008900     05  PC-PCKRP006                 PIC  X(08)    VALUE          00890020
009000         'PCKRP006'.                                              00900020
009100     05  PC-REPORT-NBR               PIC  9(01)    VALUE 1.       00910020
009200     05  PC-ENROUTE                  PIC  X(10)   VALUE 'ENROUTE'.00920020
009300     05  PC-ENRT                     PIC  X(04)    VALUE 'ENRT'.  00930020
009400     05  PC-HERE                     PIC  X(04)    VALUE 'HERE'.  00940020
009500*                                                                 00950020
009600 01  PV-MISC-FIELDS.                                              00960020
009700     05  PV-LINE-SUB                 PIC S9(03)    VALUE ZERO     00970020
009800                                                   COMP-3.        00980020
009900     05  PV-LINE-CNT                 PIC S9(03)    VALUE ZERO     00990020
010000                                                   COMP-3.        01000020
010100     05  PV-PAGE-CNT                 PIC S9(04)    VALUE ZERO     01010020
010200                                                   COMP-3.        01020020
010300     05  PV-VENDOR-COUNT             PIC S9(04)    VALUE ZERO     01030020
010400                                                   COMP-3.        01040020
010500     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     01050020
010600                                                   COMP SYNC.     01060020
010700     05  PV-RECEIVER-STATUS          PIC  X(04)    VALUE SPACES.  01070020
010800     05  PV-CURRENT-OPER             PIC  9(04)    VALUE ZERO.    01080020
010900*LMM     10  FILLER                  PIC  X(01)    VALUE SPACES.  01090020
011000*        10  PV-CURRENT-OPER-3       PIC  X(03)    VALUE SPACES.  01100020
011100*    05  PV-CURRENT-OPER-X-3         PIC  X(03)    VALUE SPACES.  01110020
011200     05  PV-SAVE-CURR-OPER           PIC  9(04)    VALUE ZERO.    01120020
011300     05  PV-SAVE-CURR-FCLTY          PIC  9(04)    VALUE ZERO.    01130020
011400     05  PV-CARTON-QTY               PIC  9(09)    VALUE ZERO.    01140020
011500     05  PV-ITEM-QTY                 PIC  9(09)    VALUE ZERO.    01150020
011600     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  01160020
011700     05  PV-SAVE-PO                  PIC S9(09)    VALUE ZERO.    01170020
011800     05  PV-SAVE-RECEIVER            PIC  9(03)    VALUE ZERO.    01180020
011900     05  PV-DATE-DDMMYY.                                          01190020
012000         10  PV-DATE-DD              PIC  X(02).                  01200020
012100         10  PV-DATE-SLASH-1         PIC  X(01).                  01210020
012200         10  PV-DATE-MM              PIC  X(02).                  01220020
012300         10  PV-DATE-SLASH-2         PIC  X(01).                  01230020
012400         10  PV-DATE-YY              PIC  X(04).                  01240020
012500     05  PV-TODAYS-DATE.                                          01250020
012600         10  PV-TODAYS-DATE-YY       PIC  9(02)    VALUE ZERO.    01260020
012700         10  PV-TODAYS-DATE-MM       PIC  9(02)    VALUE ZERO.    01270020
012800         10  PV-TODAYS-DATE-DD       PIC  9(02)    VALUE ZERO.    01280020
012900     05  PV-TODAYS-TIME.                                          01290020
013000         10  PV-TODAYS-TIME-HH       PIC  9(02)    VALUE ZERO.    01300020
013100         10  PV-TODAYS-TIME-MM       PIC  9(02)    VALUE ZERO.    01310020
013200         10  PV-TODAYS-TIME-SS       PIC  9(02)    VALUE ZERO.    01320020
013300         10  FILLER                  PIC  9(02)    VALUE ZERO.    01330020
013400     05  PV-FORMAT-DATE.                                          01340020
013500         10  PV-FORMAT-DATE-MM       PIC  X(02)    VALUE SPACES.  01350020
013600         10  FILLER                  PIC  X(01)    VALUE '/'.     01360020
013700         10  PV-FORMAT-DATE-DD       PIC  X(02)    VALUE SPACES.  01370020
013800         10  FILLER                  PIC  X(01)    VALUE '/'.     01380020
013900         10  PV-FORMAT-DATE-YYYY     PIC  X(04)    VALUE SPACES.  01390020
014000     05  PV-SAVE-ASSIGN-TOT-QTY      PIC S9(07)    VALUE ZERO     01400020
014100                                                   COMP-3.        01410020
014200     05  PV-RECEIVER-EXT-DATE.                                    01420020
014300         10  PV-EXT-DATE             PIC  X(08).                  01430020
014400         10  FILLER                  PIC  X(142).                 01440020
014500*                                                                 01450020
014600                                                                  01460020
014700     COPY TMRD001.                                                01470020
014800                                                                  01480020
014900     COPY PCRD002.                                                01490020
015000                                                                  01500020
015100 EJECT                                                            01510020
015200*                                                                 01520020
015300*-----------------------------------------------------------------01530020
015400* COMMAREA FOR XLKUT071 - LOCATION MODULE                         01540020
015500*-----------------------------------------------------------------01550020
015600     COPY XLWS071.                                                01560020
015700                                                                  01570020
015800*                                                                 01580020
015900******************************************************************01590020
016000*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               01600020
016100******************************************************************01610020
016200     COPY DPWS132O.                                               01620020
016300*                                                                 01630020
016400*                                                                 01640020
016500 01  HEADING-LINES.                                               01650020
016600     05  HEADING-LINE-1.                                          01660020
016700         10  FILLER                  PIC  X(09)    VALUE          01670020
016800             'LOCATION '.                                         01680020
016900         10  HL1-OPER-UNIT           PIC  X(05).                  01690020
017000         10  HL1-FACILITY            PIC  X(04).                  01700020
017100         10  FILLER                  PIC  X(32)    VALUE SPACES.  01710020
017200         10  FILLER                  PIC  X(21)    VALUE          01720020
017300             'RECEIVERS OLDER THAN '.                             01730020
017400         10  HL1-DATE                PIC  X(08).                  01740020
017500         10  FILLER                  PIC  X(53)    VALUE SPACES.  01750020
017600*                                                                 01760020
017700     05  HEADING-LINE-2.                                          01770020
017800         10  FILLER                  PIC  X(03)    VALUE SPACES.  01780020
017900         10  FILLER                  PIC  X(07)    VALUE          01790020
018000             'PROCESS'.                                           01800020
018100         10  FILLER                  PIC  X(03)    VALUE SPACES.  01810020
018200         10  FILLER                  PIC  X(08)    VALUE          01820020
018300             'RECEIVED'.                                          01830020
018400         10  FILLER                  PIC  X(07)    VALUE SPACES.  01840020
018500         10  FILLER                  PIC  X(03)    VALUE          01850020
018600             'PO'.                                                01860020
018700         10  FILLER                  PIC  X(03)    VALUE SPACES.  01870020
018800*** PRB0064829 START                                              01880021
018801*        10  FILLER                  PIC  X(03)    VALUE          01880121
018810         10  FILLER                  PIC  X(04)    VALUE          01881021
018900             ' REC'.                                              01890021
019000*        10  FILLER                  PIC  X(12)    VALUE SPACES.  01900021
019010         10  FILLER                  PIC  X(11)    VALUE SPACES.  01901021
019020*** PRB0064829 END                                                01902021
019100         10  FILLER                  PIC  X(06)    VALUE          01910020
019200             'VENDOR'.                                            01920020
019300         10  FILLER                  PIC  X(11)    VALUE SPACES.  01930020
019400         10  FILLER                  PIC  X(09)    VALUE          01940020
019500             'PKSL ITEM'.                                         01950020
019600         10  FILLER                  PIC  X(03)    VALUE SPACES.  01960020
019700         10  FILLER                  PIC  X(07)    VALUE          01970020
019800             'CARTONS'.                                           01980020
019900         10  FILLER                  PIC  X(03)    VALUE SPACES.  01990020
020000         10  FILLER                  PIC  X(04)    VALUE          02000020
020100             'DEPT'.                                              02010020
020200         10  FILLER                  PIC  X(02)    VALUE SPACES.  02020020
020300         10  FILLER                  PIC  X(11)    VALUE          02030020
020400             'CREATED FOR'.                                       02040020
020500         10  FILLER                  PIC  X(02)    VALUE SPACES.  02050020
020600         10  FILLER                  PIC  X(12)    VALUE          02060020
020700             'TROUBLE CODE'.                                      02070020
020800         10  FILLER                  PIC  X(13)    VALUE SPACES.  02080020
020900*                                                                 02090020
021000     05  HEADING-LINE-3.                                          02100020
021100         10  FILLER                  PIC  X(04)    VALUE SPACES.  02110020
021200         10  FILLER                  PIC  X(04)    VALUE          02120020
021300             'AREA'.                                              02130020
021400         10  FILLER                  PIC  X(07)    VALUE SPACES.  02140020
021500         10  FILLER                  PIC  X(04)    VALUE          02150020
021600             'DATE'.                                              02160020
021700         10  FILLER                  PIC  X(30)    VALUE SPACES.  02170020
021800         10  FILLER                  PIC  X(04)    VALUE          02180020
021900             'NAME'.                                              02190020
022000         10  FILLER                  PIC  X(16)    VALUE SPACES.  02200022
022100         10  FILLER                  PIC  X(03)    VALUE          02210020
022200             'QTY'.                                               02220020
022300         10  FILLER                  PIC  X(60)    VALUE SPACES.  02230022
022400*                                                                 02240020
022500 01  MISCELLANEOUS-LINES.                                         02250020
022600     05  END-OF-REPORT-LINE.                                      02260020
022700         10  FILLER                  PIC  X(44)    VALUE SPACES.  02270020
022800         10  FILLER                  PIC  X(45)    VALUE          02280020
022900             '*******   E N D   O F   R E P O R T   *******'.     02290020
023000         10  FILLER                  PIC  X(43)    VALUE SPACES.  02300020
023100     05  NO-DATA-TO-REPORT-LINE.                                  02310020
023200         10  FILLER                  PIC  X(40)    VALUE SPACES.  02320020
023300         10  FILLER                  PIC  X(52)    VALUE          02330020
023400         '*******  N O   D A T A   T O   R E P O R T   *******'.  02340020
023500         10  FILLER                  PIC  X(40)    VALUE SPACES.  02350020
023600*                                                                 02360020
023700 01  DETAIL-LINES.                                                02370020
023800     05  DETAIL-LINE1.                                            02380020
023900         10  FILLER                  PIC  X(03)    VALUE SPACES.  02390020
024000         10  DL1-PROCESS-AREA        PIC  X(06)    VALUE SPACES.  02400020
024100         10  FILLER                  PIC  X(03)    VALUE SPACES.  02410020
024200         10  DL1-RECEIVED-DATE       PIC  X(10)    VALUE SPACES.  02420020
024300         10  FILLER                  PIC  X(02)    VALUE SPACES.  02430020
024400         10  DL1-PO                  PIC  ZZZZZZZ9  VALUE ZERO.   02440020
024500         10  FILLER                  PIC  X(02)    VALUE SPACES.  02450020
024510*** PRB0064829 START                                              02451021
024600*        10  DL1-REC-SEQ             PIC  9(03)    VALUE ZERO.    02460021
024601*        10  FILLER                  PIC  X(02)    VALUE SPACES.  02460121
024610         10  DL1-REC-SEQ             PIC  9(04)    VALUE ZERO.    02461021
024710         10  FILLER                  PIC  X(01)    VALUE SPACES.  02471021
024720*** PRB0064829 END                                                02472021
024800         10  DL1-VENDOR              PIC  X(25)    VALUE SPACES.  02480020
024900         10  FILLER                  PIC  X(04)    VALUE SPACES.  02490020
025000         10  DL1-PACKSLIP-QTY        PIC  ZZZZZZ9  VALUE ZERO.    02500020
025100         10  FILLER                  PIC  X(03)    VALUE SPACES.  02510020
025200         10  DL1-CARTON-CNT          PIC  ZZZZZZ9  VALUE ZERO.    02520020
025300         10  FILLER                  PIC  X(04)    VALUE SPACES.  02530020
025400         10  DL1-DEPT                PIC  X(03)    VALUE SPACES.  02540020
025500         10  FILLER                  PIC  X(03)    VALUE SPACES.  02550020
025600         10  DL1-OPER-UNIT           PIC  X(04)    VALUE SPACES.  02560020
025700         10  FILLER                  PIC  X(01)    VALUE SPACES.  02570020
025800         10  DL1-FACILITY            PIC  X(04)    VALUE SPACES.  02580020
025900         10  FILLER                  PIC  X(03)    VALUE SPACES.  02590020
026000         10  DL1-TROUBLE             PIC  X(13)    VALUE SPACES.  02600020
026100         10  FILLER                  PIC  X(12)    VALUE SPACES.  02610020
026200                                                                  02620020
026300 01  TOTAL-LINES.                                                 02630020
026400     05  TOTAL-LINE-1.                                            02640020
026500         10  FILLER                  PIC  X(58)    VALUE SPACES.  02650020
026600         10  TL1-TOTAL               PIC  X(08)    VALUE          02660020
026700              'TOTAL:  '.                                         02670020
026800         10  TL1-ITEM-QTY            PIC  ZZZZZZZZ9.              02680020
026900         10  FILLER                  PIC  X(01)    VALUE SPACES.  02690020
027000         10  TL1-CARTON-QTY          PIC  ZZZZZZZZ9.              02700020
027100         10  FILLER                  PIC  X(47)    VALUE SPACES.  02710020
027200                                                                  02720020
027300                                                                  02730020
027400*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE LOGISTICS          02740020
027500*  LOCATION TABLE                                                 02750020
027600*  (XLT_LOC)                                                      02760020
027700*                                                                 02770020
027800     EXEC SQL                                                     02780020
027900          INCLUDE XLT00010                                        02790020
028000     END-EXEC.                                                    02800020
028100                                                                  02810020
028200*                                                                 02820020
028300*    DB2 AREA FOR COMMUNICATIONS                                  02830020
028400                                                                  02840020
028500     EXEC SQL                                                     02850020
028600          INCLUDE SQLCA                                           02860020
028700     END-EXEC.                                                    02870020
028800                                                                  02880020
028900*    DB2 AREA FOR COMMUNICATIONS AREA2                            02890020
029000                                                                  02900020
029100     COPY SQLCA2.                                                 02910020
029200                                                                  02920020
029300*                                                                 02930020
029400 PROCEDURE DIVISION.                                              02940020
029500*                                                                 02950020
029600 0000-MAINLINE-PROCESSING.                                        02960020
029700******************************************************************02970020
029800**  THIS IS THE MAIN DRIVER FOR THE PROGRAM.                      02980020
029900******************************************************************02990020
030000     OPEN INPUT  EXTRACT-FILE                                     03000020
030100          OUTPUT PC-RECEIVERS-OLDER-THAN-RPT.                     03010020
030200*                                                                 03020020
030300     SET PS-FIRST-DETAIL-REC TO TRUE.                             03030020
030400     PERFORM 2200-READ-EXTRACT.                                   03040020
030500     PERFORM 1000-INITIALIZATION.                                 03050020
030600*                                                                 03060020
030700     PERFORM 2000-PROCESS-EXTRACT                                 03070020
030800         UNTIL PS-END-OF-EXTRACT.                                 03080020
030900*                                                                 03090020
031000     IF PS-NOT-HEADER-ONLY-REC                                    03100020
031100         PERFORM 8600-TOTAL                                       03110020
031200     ELSE                                                         03120020
031300         WRITE PC-RECEIVERS-OLDER-THAN-RECORD                     03130020
031400           FROM NO-DATA-TO-REPORT-LINE                            03140020
031500             AFTER ADVANCING 2 LINES                              03150020
031600     END-IF.                                                      03160020
031700     WRITE PC-RECEIVERS-OLDER-THAN-RECORD                         03170020
031800       FROM END-OF-REPORT-LINE                                    03180020
031900         AFTER ADVANCING 2 LINES.                                 03190020
032000*                                                                 03200020
032100     CLOSE EXTRACT-FILE                                           03210020
032200           PC-RECEIVERS-OLDER-THAN-RPT.                           03220020
032300*                                                                 03230020
032400     GOBACK.                                                      03240020
032500*                                                                 03250020
032600*                                                                 03260020
032700 1000-INITIALIZATION.                                             03270020
032800******************************************************************03280020
032900**  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               03290020
033000******************************************************************03300020
033100                                                                  03310020
033200     ACCEPT PV-TODAYS-DATE                                        03320020
033300       FROM DATE.                                                 03330020
033400*                                                                 03340020
033500     ACCEPT PV-TODAYS-TIME                                        03350020
033600       FROM TIME.                                                 03360020
033700*                                                                 03370020
033800     MOVE PC-REPORT-NBR          TO DP132O-REPORT-NUMBER.         03380020
033900     MOVE PV-TODAYS-DATE-MM      TO DP132O-RUN-MONTH.             03390020
034000     MOVE PV-TODAYS-DATE-DD      TO DP132O-RUN-DAY.               03400020
034100     MOVE PV-TODAYS-DATE-YY      TO DP132O-RUN-YEAR.              03410020
034200*                                                                 03420020
034300     MOVE PV-TODAYS-TIME-HH      TO DP132O-RUN-HOUR.              03430020
034400     MOVE PV-TODAYS-TIME-MM      TO DP132O-RUN-MINUTE.            03440020
034500     MOVE PC-PCKRP006            TO DP132O-PROGRAM-NAME.          03450020
034600*                                                                 03460020
034700     MOVE PC002-RECEIVER-EXT-RECORD                               03470020
034800                             TO PV-RECEIVER-EXT-DATE              03480020
034900     MOVE PV-EXT-DATE        TO HL1-DATE.                         03490020
035000     PERFORM 2200-READ-EXTRACT.                                   03500020
035100     IF PC002-HEADER-RECORD                                       03510020
035200         SET PS-HEADER-ONLY-REC TO TRUE                           03520020
035300     END-IF.                                                      03530020
035400     MOVE PC002-CURRENT-OPER   TO HL1-OPER-UNIT                   03540020
035500                                  PV-SAVE-CURR-OPER.              03550020
035600     MOVE PC002-CURRENT-FCLTY  TO HL1-FACILITY                    03560020
035700                                  PV-SAVE-CURR-FCLTY.             03570020
035800     MOVE PC002-CURRENT-OPER TO PV-CURRENT-OPER.                  03580020
035900*    MOVE PV-CURRENT-OPER-3  TO PV-CURRENT-OPER-X-3.              03590020
036000     PERFORM 2300-VALIDATE-OPER-UNIT.                             03600020
036100     IF PS-VALID-DC                                               03610020
036200         PERFORM 8000-WRITE-REPORT-HEADERS                        03620020
036300     END-IF.                                                      03630020
036400                                                                  03640020
036500*                                                                 03650020
036600 2000-PROCESS-EXTRACT.                                            03660020
036700******************************************************************03670020
036800*  THIS IS THE MAIN CONTROLLING PARAGRAPH FOR PROCESSING THE     *03680020
036900*  PROCESS AREA CURRENT ON HAND REPORT                           *03690020
037000******************************************************************03700020
037100     IF (PC002-CURRENT-OPER NOT = PV-SAVE-CURR-OPER) OR           03710020
037200        (PC002-CURRENT-FCLTY NOT = PV-SAVE-CURR-FCLTY)            03720020
037300         MOVE PC002-CURRENT-OPER TO PV-CURRENT-OPER               03730020
037400*        MOVE PV-CURRENT-OPER-3  TO PV-CURRENT-OPER-X-3           03740020
037500         PERFORM 2300-VALIDATE-OPER-UNIT                          03750020
037600         IF PS-VALID-DC                                           03760020
037700             IF  PV-LINE-CNT > PC-55                              03770020
037800                 PERFORM 8000-WRITE-REPORT-HEADERS                03780020
037900             END-IF                                               03790020
038000             IF  PS-NOT-FIRST-DETAIL-REC                          03800020
038100                 IF PS-NOT-HEADER-ONLY-REC                        03810020
038200                     PERFORM 8600-TOTAL                           03820020
038300                     WRITE PC-RECEIVERS-OLDER-THAN-RECORD         03830020
038400                       FROM END-OF-REPORT-LINE                    03840020
038500                         AFTER ADVANCING 2 LINES                  03850020
038600                 ELSE                                             03860020
038700                     WRITE PC-RECEIVERS-OLDER-THAN-RECORD         03870020
038800                       FROM NO-DATA-TO-REPORT-LINE                03880020
038900                         AFTER ADVANCING 2 LINES                  03890020
039000                     WRITE PC-RECEIVERS-OLDER-THAN-RECORD         03900020
039100                       FROM END-OF-REPORT-LINE                    03910020
039200                         AFTER ADVANCING 2 LINES                  03920020
039300                 END-IF                                           03930020
039400             ELSE                                                 03940020
039500                 IF PS-HEADER-ONLY-REC                            03950020
039600                     WRITE PC-RECEIVERS-OLDER-THAN-RECORD         03960020
039700                       FROM NO-DATA-TO-REPORT-LINE                03970020
039800                         AFTER ADVANCING 2 LINES                  03980020
039900                     WRITE PC-RECEIVERS-OLDER-THAN-RECORD         03990020
040000                       FROM END-OF-REPORT-LINE                    04000020
040100                         AFTER ADVANCING 2 LINES                  04010020
040200                 END-IF                                           04020020
040300             END-IF                                               04030020
040400             MOVE PC002-CURRENT-OPER   TO HL1-OPER-UNIT           04040020
040500                                          PV-SAVE-CURR-OPER       04050020
040600             MOVE PC002-CURRENT-FCLTY  TO HL1-FACILITY            04060020
040700                                          PV-SAVE-CURR-FCLTY      04070020
040800             PERFORM 8000-WRITE-REPORT-HEADERS                    04080020
040900             IF PC002-DETAIL-RECORD                               04090020
041000                 PERFORM 2100-WRITE-REPORT                        04100020
041100             END-IF                                               04110020
041200         END-IF                                                   04120020
041300         IF PC002-HEADER-RECORD                                   04130020
041400             SET PS-HEADER-ONLY-REC TO TRUE                       04140020
041500         ELSE                                                     04150020
041600             SET PS-NOT-HEADER-ONLY-REC TO TRUE                   04160020
041700         END-IF                                                   04170020
041800     END-IF.                                                      04180020
041900                                                                  04190020
042000     IF PS-END-OF-EXTRACT                                         04200020
042100        CONTINUE                                                  04210020
042200     ELSE                                                         04220020
042300        IF PS-VALID-DC AND                                        04230020
042400           PS-NOT-HEADER-ONLY-REC                                 04240020
042500            PERFORM 2100-WRITE-REPORT                             04250020
042600        ELSE                                                      04260020
042700            IF PS-PROCESS-EXTRACT                                 04270020
042800                PERFORM 2200-READ-EXTRACT                         04280020
042900            END-IF                                                04290020
043000        END-IF                                                    04300020
043100     END-IF.                                                      04310020
043200                                                                  04320020
043300 2100-WRITE-REPORT.                                               04330020
043400     IF PS-NOT-FIRST-PASS AND                                     04340020
043500        PS-NOT-FIRST-DETAIL-REC                                   04350020
043600         IF  PV-LINE-CNT > PC-55                                  04360020
043700             PERFORM 8000-WRITE-REPORT-HEADERS                    04370020
043800         END-IF                                                   04380020
043900     ELSE                                                         04390020
044000         SET PS-NOT-FIRST-PASS                                    04400020
044100             PS-NOT-FIRST-DETAIL-REC TO TRUE                      04410020
044200     END-IF.                                                      04420020
044300     MOVE PC002-PROCESS-AREA   TO DL1-PROCESS-AREA.               04430020
044400     MOVE PC002-REC-DATE   TO PV-DATE-DDMMYY.                     04440020
044500     MOVE '/'              TO PV-DATE-SLASH-1.                    04450020
044600     MOVE '/'              TO PV-DATE-SLASH-2.                    04460020
044700     MOVE PV-DATE-DDMMYY   TO DL1-RECEIVED-DATE.                  04470020
044800     MOVE PC002-PO-NBR         TO DL1-PO.                         04480020
044900     MOVE PC002-REC-SEQ-NBR    TO DL1-REC-SEQ.                    04490020
045000     MOVE PC002-VNDR-NME       TO DL1-VENDOR.                     04500020
045100     MOVE PC002-PKSL-ITM-QTY   TO DL1-PACKSLIP-QTY.               04510020
045200     ADD PC002-PKSL-ITM-QTY    TO PV-ITEM-QTY.                    04520020
045300     MOVE PC002-CART-CNT       TO DL1-CARTON-CNT.                 04530020
045400     ADD PC002-CART-CNT        TO PV-CARTON-QTY.                  04540020
045500     MOVE PC002-DEPT-NBR       TO DL1-DEPT.                       04550020
045600     MOVE PC002-LOGICAL-OPER   TO DL1-OPER-UNIT.                  04560020
045700     MOVE PC002-LOGICAL-FCLTY  TO DL1-FACILITY.                   04570020
045800     STRING PC002-UNRESOLVED-TROUBLE DELIMITED BY SIZE            04580020
045900            PC002-MULTI-TROUBLE DELIMITED BY SIZE                 04590020
046000            ' ' DELIMITED BY SIZE                                 04600020
046100            PC002-LATEST-TROUBLE DELIMITED BY SIZE                04610020
046200            INTO DL1-TROUBLE.                                     04620020
046300     IF  PV-LINE-CNT > PC-60                                      04630020
046400         PERFORM 8000-WRITE-REPORT-HEADERS                        04640020
046500     END-IF                                                       04650020
046600     PERFORM 8400-WRITE-DETAIL-LINES                              04660020
046700     PERFORM 2200-READ-EXTRACT.                                   04670020
046800                                                                  04680020
046900 2200-READ-EXTRACT.                                               04690020
047000     READ EXTRACT-FILE INTO PC002-RECEIVER-EXT-RECORD             04700020
047100        AT END                                                    04710020
047200           SET PS-END-OF-EXTRACT TO TRUE.                         04720020
047300                                                                  04730020
047400 2300-VALIDATE-OPER-UNIT.                                         04740020
047500******************************************************************04750020
047600* XLT_LOC (XLT00010)                                              04760020
047700* CALL LOCATION MODULE XLKUT071                                   04770020
047800******************************************************************04780020
047900                                                                  04790020
048000     INITIALIZE XL071-COMMAREA-REC.                               04800020
048100     MOVE PV-CURRENT-OPER            TO XL071-LOCATION-NUMBER.    04810020
048200                                                                  04820020
048300     CALL XL071-LOCATION-MODULE  USING XL071-COMMAREA-REC.        04830020
048400                                                                  04840020
048500        IF XL071-LOC-TYP-CDE = 'DC'                               04850020
048600           SET PS-VALID-DC             TO TRUE                    04860020
048700        ELSE                                                      04870020
048800           SET PS-INVALID-DC           TO TRUE                    04880020
048900        END-IF.                                                   04890020
049000                                                                  04900020
049100*                                                                 04910020
049200 8000-WRITE-REPORT-HEADERS.                                       04920020
049300******************************************************************04930020
049400*  PRINT THE HEADING FOR THE FIRST PAGE OF AN ASN.  SEBSEQUENT   *04940020
049500*  PAGES FOR THE SAME ASN DO NOT REPEAT ALL OF THE HEADING INFO. *04950020
049600******************************************************************04960020
049700     PERFORM 8200-WRITE-TOP-LINE.                                 04970020
049800*                                                                 04980020
049900     WRITE PC-RECEIVERS-OLDER-THAN-RECORD                         04990020
050000       FROM HEADING-LINE-1                                        05000020
050100         AFTER ADVANCING 2 LINE.                                  05010020
050200*                                                                 05020020
050300     WRITE PC-RECEIVERS-OLDER-THAN-RECORD                         05030020
050400       FROM HEADING-LINE-2                                        05040020
050500         AFTER ADVANCING 2 LINES.                                 05050020
050600*                                                                 05060020
050700     WRITE PC-RECEIVERS-OLDER-THAN-RECORD                         05070020
050800       FROM HEADING-LINE-3                                        05080020
050900         AFTER ADVANCING 1 LINES.                                 05090020
051000*                                                                 05100020
051100     MOVE PC-6            TO PV-LINE-CNT.                         05110020
051200     MOVE PC-2            TO PV-LINE-SUB.                         05120020
051300*                                                                 05130020
051400*                                                                 05140020
051500 8200-WRITE-TOP-LINE.                                             05150020
051600******************************************************************05160020
051700*     WRITES HEADER LINES 0 AND 1 WHEN MORE THAN ONE PAGE IS     *05170020
051800*     NEEDED FOR AN ASN NUMBER.                                  *05180020
051900******************************************************************05190020
052000     ADD 1                        TO PV-PAGE-CNT.                 05200020
052100*                                                                 05210020
052200     MOVE PV-PAGE-CNT             TO DP132O-PAGE-NUMBER.          05220020
052300*                                                                 05230020
052400     WRITE PC-RECEIVERS-OLDER-THAN-RECORD                         05240020
052500       FROM DP132O-STANDRD-HEADER-132-COLS                        05250020
052600         AFTER ADVANCING PAGE.                                    05260020
052700*                                                                 05270020
052800*                                                                 05280020
052900 8400-WRITE-DETAIL-LINES.                                         05290020
053000******************************************************************05300020
053100*     WRITES THE DETAIL LINE INFORMATION.                        *05310020
053200******************************************************************05320020
053300     WRITE PC-RECEIVERS-OLDER-THAN-RECORD                         05330020
053400       FROM DETAIL-LINE1                                          05340020
053500         AFTER ADVANCING PV-LINE-SUB LINES.                       05350020
053600*                                                                 05360020
053700     ADD PV-LINE-SUB                 TO PV-LINE-CNT.              05370020
053800     MOVE PC-1                       TO PV-LINE-SUB.              05380020
053900 8600-TOTAL.                                                      05390020
054000******************************************************************05400020
054100*     WRITES THE DATE TOTAL LINE                                 *05410020
054200******************************************************************05420020
054300     MOVE PV-CARTON-QTY          TO TL1-CARTON-QTY.               05430020
054400     MOVE PV-ITEM-QTY            TO TL1-ITEM-QTY.                 05440020
054500     WRITE PC-RECEIVERS-OLDER-THAN-RECORD                         05450020
054600       FROM TOTAL-LINE-1                                          05460020
054700         AFTER ADVANCING 2 LINES.                                 05470020
054800                                                                  05480020
054900     ADD PC-2                        TO PV-LINE-CNT.              05490020
055000     MOVE PC-2                       TO PV-LINE-SUB.              05500020
055100     MOVE ZERO                       TO PV-CARTON-QTY             05510020
055200                                        PV-ITEM-QTY.              05520020
055300                                                                  05530020
055400******************************************************************05540020
055500*     SQL WARNING OR ERROR PROCESSING                            *05550020
055600*                                                                *05560020
055700******************************************************************05570020
055800                                                                  05580020
055900*                                                                 05590020
056000 Z999-SQL-ERROR.                                                  05600020
056100*---------------                                                  05610020
056200                                                                  05620020
056300     MOVE SQLCODE    TO SQLCODE2.                                 05630020
056400     MOVE SQLERRD(3) TO SQLERRD3.                                 05640020
056500     DISPLAY '** ABEND **       ** = SQLERROR'.                   05650020
056600     DISPLAY '** PROGRAM        ** = PCKRP006'.                   05660020
056700     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  05670020
056800     DISPLAY '** SQLERRM        ** = ' SQLERRM.                   05680020
056900     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  05690020
057000     MOVE +4013 TO PV-ABEND-CODE.                                 05700020
057100     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         05710020
057200*                                                                 05720020
