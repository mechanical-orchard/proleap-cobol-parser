000100***************************************************************** 00010058
000200 IDENTIFICATION DIVISION.                                         00020058
000300***************************************************************** 00030058
000400                                                                  00040058
000500 PROGRAM-ID.             SUKRP051.                                00050058
000600 AUTHOR.                 DAN HINTZ.                               00060058
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070058
000800 DATE-WRITTEN            FEBRUARY  2015.                          00080058
000900 DATE-COMPILED.                                                   00090058
001000***************************************************************** 00100058
001100***************************************************************** 00110058
001200*  THIS PROGRAM WILL CREATE THE LISTING OF TRAILERS THAT HAVE   * 00120058
001300*  BEEN CLOSED AT THE DC'S BUT HAVE NOT BEEN SHIPPED.           * 00130058
001600***************************************************************** 00160058
001700*  CHANGED MM/DD/YY BY XXXXXXXXXXX                              * 00170058
001800*   WR# XXXX XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX * 00180058
002000***************************************************************** 00200058
002100***************************************************************** 00210058
002200 ENVIRONMENT DIVISION.                                            00220058
002300***************************************************************** 00230058
002400                                                                  00240058
002500 CONFIGURATION SECTION.                                           00250058
002600                                                                  00260058
002700 SOURCE-COMPUTER.        IBM-3090.                                00270058
002800 OBJECT-COMPUTER.        IBM-3090.                                00280058
002900                                                                  00290058
003000 INPUT-OUTPUT SECTION.                                            00300058
003100                                                                  00310058
003200 FILE-CONTROL.                                                    00320058
003300*                                                                 00330058
004300     SELECT SU-CLOSED-TRLR-RPT-FILE                               00430058
004400         ASSIGN TO RPT01.                                         00440058
004500*                                                                 00450058
004600***************************************************************** 00460058
004700 DATA DIVISION.                                                   00470058
004800***************************************************************** 00480058
004900*                                                                 00490058
005000 FILE SECTION.                                                    00500058
      *                                                                         
006200*                                                                 00620058
006300*                                                                 00630058
006400 FD  SU-CLOSED-TRLR-RPT-FILE                                      00640058
006500     RECORDING MODE IS F                                          00650058
006600     BLOCK CONTAINS 0  RECORDS.                                   00660058
006700 01  SU-CLOSED-TRLR-RPT-RECORD          PIC  X(132).                      
006800*                                                                 00680058
007400                                                                  00740058
007500 WORKING-STORAGE SECTION.                                         00750058
007600*                                                                 00760058
007700 01  PROGRAM-SWITCHES.                                            00770058
007800     05  PS-END-OF-CLSD-TRLRS-CSR-SW    PIC X(01)    VALUE 'N'.           
007900         88  PS-END-OF-CLSD-TRLRS-CSR                VALUE 'Y'.           
008000         88  PS-NOT-END-OF-CLSD-TRLRS-CSR            VALUE 'N'.           
009600*                                                                 00960058
009700 01  PC-CONSTANTS.                                                00970058
011400     05  PC-MAX-REPORT-LINES         PIC S9(04)    VALUE +65              
011500                                                   COMP SYNC.             
009800     05  PC-1                        PIC S9(03)    VALUE +1       00980058
009900                                                   COMP-3.        00990058
010400     05  PC-6                        PIC S9(01)    VALUE +6.      01040058
011400     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          01140058
011500         'SUKRP051'.                                              01150058
013000     05  PC-DEFAULT-TMST             PIC  X(26)    VALUE          01300058
013100         '9999-09-09-09.09.09.999999'.                            01310058
013400     05  PC-BLANK-LINE               PIC  X(132)   VALUE SPACES.  01340058
013500     05  PC-REPORT-NBR               PIC  9(01)    VALUE 1.       01350058
013600*                                                                 01360058
011900 01  PV-ABEND-FIELDS.                                                     
012000     05  PV-ABEND-CODE               PIC S9(04)    VALUE +0               
012100                                                   COMP SYNC.             
012200     05  PV-ABEND-PROGRAM            PIC  X(08)    VALUE                  
                                                         'SUKRP051'.            
010900     05  PV-SQLCODE                  PIC S9(9)     VALUE ZERO.            
011000     05  PV-DISPLAY-SQLCODE          PIC -------999.                      
012300     05  PV-ABEND-PARAGRAPH          PIC  X(50)    VALUE SPACES.          
012400     05  PV-ABEND-OPERATION          PIC  X(51)    VALUE SPACES.          
012500     05  PV-ABEND-TABLE-1            PIC  X(08)    VALUE SPACES.          
012600     05  PV-ABEND-TABLE-2            PIC  X(08)    VALUE SPACES.          
012700     05  PV-ABEND-TABLE-3            PIC  X(08)    VALUE SPACES.          
013100                                                                          
013700 01  PV-MISC-FIELDS.                                              01370058
013800     05  PV-LINE-CNT                 PIC S9(03)    VALUE ZERO     01380058
013900                                                   COMP-3.        01390058
014000     05  PV-PAGE-CNT                 PIC S9(05)    VALUE ZERO     01400058
014100                                                   COMP-3.        01410058
014000     05  PV-CLOSED-TRAILER-CNT       PIC S9(05)    VALUE ZERO     01400058
014100                                                   COMP-3.        01410058
016600     05  PV-DISPLAY-COUNT            PIC  ZZ,ZZ9.                         
016600     05  PV-OTBND-STAT-DATE          PIC  X(10)    VALUE SPACES.  01660058
016600     05  PV-OTBND-STAT-TIME          PIC  X(08)    VALUE SPACES.  01660058
016300     05  PV-TODAYS-DATE.                                                  
016400         10  PV-TODAYS-DATE-YY       PIC  9(02)    VALUE ZERO.            
016500         10  PV-TODAYS-DATE-MM       PIC  9(02)    VALUE ZERO.            
016600         10  PV-TODAYS-DATE-DD       PIC  9(02)    VALUE ZERO.            
016700     05  PV-TODAYS-TIME.                                                  
016800         10  PV-TODAYS-TIME-HH       PIC  9(02)    VALUE ZERO.            
016900         10  PV-TODAYS-TIME-MM       PIC  9(02)    VALUE ZERO.            
017000         10  PV-TODAYS-TIME-SS       PIC  9(02)    VALUE ZERO.            
017100         10  FILLER                  PIC  9(02)    VALUE ZERO.            
021900*                                                                 02190058
024300******************************************************************02390058
024400*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               02400058
024500******************************************************************02410058
024600     COPY DPWS132O.                                               02420058
024700*                                                                 02430058
024800*                                                                 02440058
024900 01  HEADING-LINES.                                               02450058
025000     05  HEADING-LINE-0.                                          02460058
025100         10  FILLER                  PIC  X(55)    VALUE SPACES.  02470058
025200         10  FILLER                  PIC  X(22)    VALUE          02480058
025300             'CLOSED TRAILERS REPORT'.                            02490058
025400         10  FILLER                  PIC  X(55)    VALUE SPACES.  02500058
025500*                                                                 02510058
034300*                                                                 03390058
034400     05  HEADING-LINE-1.                                          03400058
034500         10  FILLER                  PIC  X(79)    VALUE SPACES.  03410058
034600         10  FILLER                  PIC  X(06)    VALUE          03420058
034700             'CLOSED'.                                            03430058
034800         10  FILLER                  PIC  X(06)    VALUE SPACES.  03440058
034900         10  FILLER                  PIC  X(06)    VALUE          03450058
035000             'CLOSED'.                                            03460058
036000         10  FILLER                  PIC  X(35)    VALUE SPACES.  03560058
036100*                                                                 03570058
036200     05  HEADING-LINE-2.                                          03580058
036300         10  FILLER                  PIC  X(37)    VALUE SPACES.  03590058
036400         10  FILLER                  PIC  X(02)    VALUE 'DC'.    03600058
036600         10  FILLER                  PIC  X(03)    VALUE SPACES.  03620058
036700         10  FILLER                  PIC  X(05)    VALUE 'STORE'. 03630058
036900         10  FILLER                  PIC  X(04)    VALUE SPACES.  03650058
037000         10  FILLER                  PIC  X(04)    VALUE 'SCAC'.  03660058
037200         10  FILLER                  PIC  X(04)    VALUE SPACES.  03680058
037300         10  FILLER                  PIC  X(11)    VALUE          03690058
037400             'TRAILER NBR'.                                       03700058
037500         10  FILLER                  PIC  X(11)    VALUE SPACES.  03710058
037600         10  FILLER                  PIC  X(04)    VALUE 'DATE'.  03720058
037800         10  FILLER                  PIC  X(08)    VALUE SPACES.  03740058
037900         10  FILLER                  PIC  X(04)    VALUE 'TIME'.  03750058
039000         10  FILLER                  PIC  X(35)    VALUE SPACES.  03860058
039100*                                                                 03870058
039200*                                                                 03880058
039300 01  MISCELLANEOUS-LINES.                                         03890058
039400     05  NO-DATA-LINE.                                            03900058
039500         10  FILLER                  PIC  X(44)    VALUE SPACES.  03910058
039600         10  FILLER                  PIC  X(46)    VALUE          03920058
039700             '**** NO CLOSED TRAILER INFORMATION EXISTS ****'.    03930058
039800         10  FILLER                  PIC  X(43)    VALUE SPACES.  03940058
039900     05  END-OF-REPORT-LINE.                                      03950058
040000         10  FILLER                  PIC  X(44)    VALUE SPACES.  03960058
040100         10  FILLER                  PIC  X(45)    VALUE          03970058
040200             '*******   E N D   O F   R E P O R T   *******'.     03980058
040300         10  FILLER                  PIC  X(43)    VALUE SPACES.  03990058
040400*                                                                 04000058
040500 01  DETAIL-LINES.                                                04010058
040600     05  DETAIL-LINE1.                                            04020058
040700         10  FILLER                  PIC  X(35)    VALUE SPACES.  04030058
040800         10  DL1-DC-NBR              PIC  ZZZ9     VALUE ZEROS.   04040058
040900         10  FILLER                  PIC  X(04)    VALUE SPACES.  04050058
041000         10  DL1-STORE-NBR           PIC  ZZZ9     VALUE ZEROS.   04060058
040900         10  FILLER                  PIC  X(04)    VALUE SPACES.  04050058
041000         10  DL1-SCAC                PIC  X(04)    VALUE SPACES.  04060058
041100         10  FILLER                  PIC  X(04)    VALUE SPACES.  04070058
041200         10  DL1-TRAILER-NBR         PIC  X(12)    VALUE SPACES.  04080058
041800         10  FILLER                  PIC  X(04)    VALUE SPACES.  04140058
041900         10  DL1-CLOSED-DATE         PIC  X(10)    VALUE SPACES.  04150058
042000         10  FILLER                  PIC  X(04)    VALUE SPACES.  04160058
042100         10  DL1-CLOSED-TIME         PIC  X(08)    VALUE SPACES.  04170058
043100         10  FILLER                  PIC  X(35)    VALUE SPACES.  04270058
043200                                                                  04280058
000242******************************************************************        
000243*  DB2 FORMATTED MESSAGE AREA                                             
000244******************************************************************        
000245     COPY DPWS004.                                                        
000246                                                                          
044500*                                                                 04410058
044600*  COPY BOOK FOR THE OUTBOUND TRAILER TRIP STATUS TABLE (TSUOBTS) 04420058
044700*                                                                 04430058
044800     EXEC SQL                                                     04440058
044900          INCLUDE TSUOBTS                                         04450058
045000     END-EXEC.                                                    04460058
045400*                                                                 04500058
045200*  COPY BOOK FOR THE OUTBOUND TRAILER TRIP TABLE (TSUOBTR)        04480058
045400*                                                                 04500058
045500     EXEC SQL                                                     04510058
045600          INCLUDE TSUOBTR                                         04520058
045700     END-EXEC.                                                    04530058
045800*                                                                 04540058
045900*  COPY BOOK FOR THE TRAILER DEFINITION TABLE (TCNTRID)           04550058
046100*                                                                 04570058
046200     EXEC SQL                                                     04580058
046300          INCLUDE TCNTRID                                         04590058
046400     END-EXEC.                                                    04600058
046100*                                                                 04570058
048300 EJECT                                                            04850058
046100*                                                                 04570058
048400*  DB2 COMMUNICATION AREA                                         04860058
048500*                                                                 04870058
048600     EXEC SQL                                                     04880058
048700         INCLUDE SQLCA                                            04890058
048800     END-EXEC.                                                    04900058
046100*                                                                 04570058
048900 EJECT                                                            04910058
046100*                                                                 04570058
049000*  DB2 COMMUNICATION AREA2                                        04920058
049100*                                                                 04930058
049200     COPY SQLCA2.                                                 04940058
049300                                                                  04950058
049400 EJECT                                                            04960058
049500                                                                  04970058
021600******************************************************************        
021700*  CLOSED TRAILERS CURSOR                                        *        
021800******************************************************************        
021900     EXEC SQL                                                             
022000          DECLARE CLSD-TRLRS-CSR CURSOR FOR                               
                SELECT B.ORGN_OPER_UNT_ID                                       
                     , B.DEST_OPER_UNT_ID                                       
                     , C.SCAC_CDE                                               
                     , C.TRLR_ID                                                
                     , DATE(A.OTBND_STAT_TMST)                                  
                     , TIME(A.OTBND_STAT_TMST)                                  
                  FROM TSUOBTS A                                                
                     , TSUOBTR B                                                
                     , TCNTRID C                                                
                 WHERE A.TRIP_STAT_CDE   = 'DC'                                 
                   AND B.OTBND_TRIP_ID   = A.OTBND_TRIP_ID                      
                   AND B.DOOR_TYP_CDE    = 'SH'                                 
                   AND A.OTBND_STAT_TMST =                                      
                      (SELECT MAX(D.OTBND_STAT_TMST)                            
                         FROM TSUOBTS D                                         
                        WHERE D.OTBND_TRIP_ID = A.OTBND_TRIP_ID)                
                          AND C.TRLR_SRL_NBR  = B.TRLR_SRL_NBR                  
              ORDER BY B.ORGN_OPER_UNT_ID                                       
                     , B.DEST_OPER_UNT_ID                                       
024300         WITH UR                                                          
024400     END-EXEC.                                                            
024510*                                                                         
049600 PROCEDURE DIVISION.                                              04980058
049700*                                                                 04990058
049800 0000-MAINLINE-PROCESSING.                                        05000058
049900******************************************************************05010058
050000**  THIS IS THE MAIN DRIVER FOR THE PROGRAM.                      05020058
050100******************************************************************05030058
025400     PERFORM 1000-INITIALIZE.                                             
                                                                                
025310     SET PS-NOT-END-OF-CLSD-TRLRS-CSR TO TRUE.                            
025320                                                                          
025400     PERFORM 2000-OPEN-CLSD-TRLRS-CSR.                                    
025500                                                                          
025510     PERFORM 2100-FETCH-CLSD-TRLRS-CSR.                                   
025520                                                                          
025600     PERFORM 2200-PROCESS-CSR                                             
025700       UNTIL  PS-END-OF-CLSD-TRLRS-CSR.                                   
025800                                                                          
025900     PERFORM 2300-CLOSE-CLSD-TRLRS-CSR.                                   
056500                                                                  05670058
053700     IF  PV-CLOSED-TRAILER-CNT = 0                                05390058
               WRITE SU-CLOSED-TRLR-RPT-RECORD                              0539
                 FROM NO-DATA-LINE                                          0540
                   AFTER ADVANCING 2 LINES                                  0541
053700     END-IF.                                                              
056500                                                                  05670058
053700     WRITE SU-CLOSED-TRLR-RPT-RECORD                              05390058
053800       FROM END-OF-REPORT-LINE                                    05400058
053900         AFTER ADVANCING 2 LINES.                                 05410058
054000*                                                                 05420058
           CLOSE SU-CLOSED-TRLR-RPT-FILE.                                       
055400*                                                                 05560058
055400     DISPLAY '***********************************'.                       
055400     DISPLAY '** SUKRP051 TOTALS               **'.                       
055400     MOVE PV-CLOSED-TRAILER-CNT TO PV-DISPLAY-COUNT.              05560058
055400     DISPLAY '** TOTAL CLOSED TRAILERS: ' PV-DISPLAY-COUNT ' **'. 05560058
055400     DISPLAY '***********************************'.                       
055400*                                                                 05560058
055300     GOBACK.                                                      05550058
055400*                                                                 05560058
027030 1000-INITIALIZE.                                                         
049900******************************************************************05010058
050000**  THIS IS WHERE THE HEADING VALUES ARE INITIALIZED              05020058
050100******************************************************************05030058
046600     ACCEPT PV-TODAYS-DATE                                                
046700       FROM DATE.                                                         
046800*                                                                         
046900     ACCEPT PV-TODAYS-TIME                                                
047000       FROM TIME.                                                         
047100*                                                                         
050500     OPEN OUTPUT SU-CLOSED-TRLR-RPT-FILE.                         05070058
                                                                                
047200     MOVE PC-REPORT-NBR      TO DP132O-REPORT-NUMBER.                     
047300     MOVE PV-TODAYS-DATE-MM  TO DP132O-RUN-MONTH.                         
047400     MOVE PV-TODAYS-DATE-DD  TO DP132O-RUN-DAY.                           
047500     MOVE PV-TODAYS-DATE-YY  TO DP132O-RUN-YEAR.                          
047600*                                                                         
047700     MOVE PV-TODAYS-TIME-HH  TO DP132O-RUN-HOUR.                          
047800     MOVE PV-TODAYS-TIME-MM  TO DP132O-RUN-MINUTE.                        
047900     MOVE PC-CURRENT-PROGRAM-NAME                                         
                                   TO DP132O-PROGRAM-NAME.                      
027500                                                                          
027500     PERFORM 8000-WRITE-REPORT-HEADERS.                                   
027500                                                                          
027500                                                                          
027030 2000-OPEN-CLSD-TRLRS-CSR.                                                
109600******************************************************************10990058
109700*     OPEN THE CLSD-TRLRS-CSR CURSOR                             *11000058
109800******************************************************************11010058
027600     EXEC SQL                                                             
027700         OPEN CLSD-TRLRS-CSR                                              
027800     END-EXEC.                                                            
027900                                                                          
028000     EVALUATE TRUE                                                        
028100         WHEN SQLWARN0 NOT = SPACE                                        
028200         WHEN SQLCODE < ZERO                                              
028300         WHEN SQLCODE > ZERO                                              
027100             MOVE '2000-OPEN-CLSD-TRLRS-CSR'                              
027200                                            TO PV-ABEND-PARAGRAPH         
027400             MOVE 'OPEN THE CLSD-TRLRS-CSR' TO PV-ABEND-OPERATION         
012500             MOVE 'TUSOBTS'                 TO PV-ABEND-TABLE-1           
012600             MOVE 'TSUOBTR'                 TO PV-ABEND-TABLE-2           
012700             MOVE 'TCNTRID'                 TO PV-ABEND-TABLE-3           
028400             PERFORM 9100-SQL-ABEND                                       
028500         WHEN SQLCODE = ZERO                                              
028600             CONTINUE                                                     
028700     END-EVALUATE.                                                        
028800                                                                          
028810                                                                          
028900 2100-FETCH-CLSD-TRLRS-CSR.                                               
109600******************************************************************10990058
109700*     FETCH A ROW FROM THE CLSD-TRLRS-CSR CURSOR                 *11000058
109800******************************************************************11010058
029500     INITIALIZE DCLTSUOBTR                                                
029500                DCLTCNTRID                                                
029500                PV-OTBND-STAT-DATE                                        
029500                PV-OTBND-STAT-TIME.                                       
029700                                                                          
029800     EXEC SQL                                                             
029900         FETCH  CLSD-TRLRS-CSR                                            
                INTO  :SUOBTR-ORGN-OPER-UNT-ID                                  
                    , :SUOBTR-DEST-OPER-UNT-ID                                  
                    , :CNTRID-SCAC-CDE                                          
                    , :CNTRID-TRLR-ID                                           
                    , :PV-OTBND-STAT-DATE                                       
                    , :PV-OTBND-STAT-TIME                                       
031000     END-EXEC.                                                            
031100                                                                          
031200     EVALUATE TRUE                                                        
031300         WHEN SQLCODE = +100                                              
031400             SET PS-END-OF-CLSD-TRLRS-CSR    TO TRUE                      
031500         WHEN SQLWARN0 NOT = SPACE                                        
031600         WHEN SQLCODE < ZERO                                              
031700         WHEN SQLCODE > ZERO                                              
027100             MOVE '2100-FETCH-CLSD-TRLRS-CSR'                             
027200                                             TO PV-ABEND-PARAGRAPH        
027400             MOVE 'FETCH THE CLSD-TRLRS-CSR' TO PV-ABEND-OPERATION        
012500             MOVE 'TUSOBTS'                  TO PV-ABEND-TABLE-1          
012600             MOVE 'TSUOBTR'                  TO PV-ABEND-TABLE-2          
012700             MOVE 'TCNTRID'                  TO PV-ABEND-TABLE-3          
031800             PERFORM 9100-SQL-ABEND                                       
031900         WHEN SQLCODE = ZERO                                              
032000             CONTINUE                                                     
032100     END-EVALUATE.                                                        
032200                                                                          
032400                                                                          
033210 2200-PROCESS-CSR.                                                        
109600******************************************************************10990058
109700*     PROCESS THE ROW FROM THE CLSD_TRLRS-CSR CURSOR.  MOVE THE  *11000058
109700*     DATA FETCHED FROM THE CURSOR TO THE DETAIL LINE.  WRITE    *11000058
109700*     DETAIL LINE OF THE REPORT.                                 *11000058
109800******************************************************************11010058
033400                                                                          
040800     ADD +1                       TO PV-CLOSED-TRAILER-CNT.               
040800     MOVE SUOBTR-ORGN-OPER-UNT-ID TO DL1-DC-NBR.                          
041000     MOVE SUOBTR-DEST-OPER-UNT-ID TO DL1-STORE-NBR.                       
041200     MOVE CNTRID-SCAC-CDE         TO DL1-SCAC.                            
041900     MOVE CNTRID-TRLR-ID          TO DL1-TRAILER-NBR.                     
           MOVE PV-OTBND-STAT-DATE      TO DL1-CLOSED-DATE.                     
042100     MOVE PV-OTBND-STAT-TIME      TO DL1-CLOSED-TIME.                     
034000                                                                          
038510     PERFORM 8400-WRITE-DETAIL-LINES.                                     
038510                                                                          
038510     PERFORM 2100-FETCH-CLSD-TRLRS-CSR.                                   
038520                                                                          
038530                                                                          
038600 2300-CLOSE-CLSD-TRLRS-CSR.                                               
109600******************************************************************10990058
109700*     CLOSE THE CLSD-TRLRS-CSR                                   *11000058
109800******************************************************************11010058
038700     MOVE '2300-CLOSE-CLSD-TRLRS-CSR'                                     
038800         TO PV-ABEND-PARAGRAPH.                                           
038900     MOVE 'CLOSE THE CLSD-TRLRS-CSR'                                      
039000         TO PV-ABEND-OPERATION.                                           
039100                                                                          
039200     EXEC SQL                                                             
039300         CLOSE CLSD-TRLRS-CSR                                             
039400     END-EXEC.                                                            
039500                                                                          
039600     EVALUATE TRUE                                                        
039700         WHEN SQLWARN0 NOT = SPACE                                        
039800         WHEN SQLCODE < ZERO                                              
039900         WHEN SQLCODE > ZERO                                              
027100             MOVE '2300-CLOSE-CLSD-TRLRS-CSR'                             
027200                                             TO PV-ABEND-PARAGRAPH        
027400             MOVE 'CLOSE THE CLSD-TRLRS-CSR' TO PV-ABEND-OPERATION        
012500             MOVE 'TUSOBTS'                  TO PV-ABEND-TABLE-1          
012600             MOVE 'TSUOBTR'                  TO PV-ABEND-TABLE-2          
012700             MOVE 'TCNTRID'                  TO PV-ABEND-TABLE-3          
040000             PERFORM 9100-SQL-ABEND                                       
040100         WHEN SQLCODE = ZERO                                              
040200             CONTINUE                                                     
040300     END-EVALUATE.                                                        
040400                                                                          
040500                                                                          
104000 8000-WRITE-REPORT-HEADERS.                                       10430058
104100******************************************************************10440058
104200*  PRINT THE HEADING FOR THE REPORT.                             *10450058
104300******************************************************************10460058
104400     PERFORM 8200-WRITE-TOP-LINE.                                 10470058
104500*                                                                 10480058
104600     WRITE SU-CLOSED-TRLR-RPT-RECORD                              10490058
104700       FROM HEADING-LINE-0                                        10500058
104800         AFTER ADVANCING 1 LINE.                                  10510058
104900*                                                                 10520058
105000     WRITE SU-CLOSED-TRLR-RPT-RECORD                              10530058
105100       FROM HEADING-LINE-1                                        10540058
105200         AFTER ADVANCING 2 LINES.                                 10550058
105300*                                                                 10560058
105400     WRITE SU-CLOSED-TRLR-RPT-RECORD                              10570058
105500       FROM HEADING-LINE-2                                        10580058
105600         AFTER ADVANCING 1 LINE.                                  10590058
105700*                                                                 10600058
107400     WRITE SU-CLOSED-TRLR-RPT-RECORD                              10770058
107500       FROM PC-BLANK-LINE                                         10780058
107600         AFTER ADVANCING 1 LINE.                                  10790058
107700*                                                                 10800058
107800     MOVE PC-6                    TO PV-LINE-CNT.                 10810058
107900*                                                                 10820058
108000*                                                                 10830058
108100 8200-WRITE-TOP-LINE.                                             10840058
108200******************************************************************10850058
108300*     WRITES HEADER LINES 0 AND 1 WHEN MORE THAN ONE PAGE IS     *10860058
108400*     NEEDED FOR AN ASN NUMBER.                                  *10870058
108500******************************************************************10880058
108600     ADD 1                        TO PV-PAGE-CNT.                 10890058
108800     MOVE PV-PAGE-CNT             TO DP132O-PAGE-NUMBER.          10910058
108900*                                                                 10920058
109000     WRITE SU-CLOSED-TRLR-RPT-RECORD                              10930058
109100       FROM DP132O-STANDRD-HEADER-132-COLS                        10940058
109200         AFTER ADVANCING PAGE.                                    10950058
109300*                                                                 10960058
109400*                                                                 10970058
109500 8400-WRITE-DETAIL-LINES.                                         10980058
109600******************************************************************10990058
109700*     WRITES THE DETAIL LINE INFORMATION.                        *11000058
109800******************************************************************11010058
105500     IF  PV-LINE-CNT > PC-MAX-REPORT-LINES                                
105600          PERFORM 8000-WRITE-REPORT-HEADERS                               
106100     END-IF.                                                              
106200*                                                                         
109900     WRITE SU-CLOSED-TRLR-RPT-RECORD                              11020058
110000       FROM DETAIL-LINE1                                          11030058
110100         AFTER ADVANCING 1 LINE.                                  11040058
110200*                                                                 11050058
110300     ADD +1                          TO PV-LINE-CNT.              11060058
110400*                                                                 11070058
110500*                                                                 11080058
053000 9100-SQL-ABEND.                                                          
053100******************************************************************        
053200*  PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL            
053300*  ERROR OR WARNING CODE OCCURS.                                          
053400******************************************************************        
089700                                                                          
089700     MOVE SQLCODE    TO PV-SQLCODE.                                       
089800     MOVE PV-SQLCODE TO PV-DISPLAY-SQLCODE.                               
089700                                                                          
053500     DISPLAY '9100-SQL-ABEND'.                                            
053600     DISPLAY '** ABEND          **'.                                      
053700     DISPLAY '** PROGRAM        ** = ' PC-CURRENT-PROGRAM-NAME.           
053800     DISPLAY '** PARAGRAPH      ** = ' PV-ABEND-PARAGRAPH.                
053900     DISPLAY '** OPERATION      ** = ' PV-ABEND-OPERATION.                
053900     DISPLAY '** TABLE(S)       ** = ' PV-ABEND-TABLE-1.                  
053900     DISPLAY '**                ** = ' PV-ABEND-TABLE-2.                  
053900     DISPLAY '**                ** = ' PV-ABEND-TABLE-3.                  
111800     DISPLAY '** SQLCODE        ** = ' PV-DISPLAY-SQLCODE.        11210058
112000     DISPLAY '** SQLERRM        ** = ' SQLERRM.                   11230058
112100     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  11240058
054000                                                                          
054100******************************************************************        
054200* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-            
054300* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE                 
054400* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE             
054500* FORMAT.                                                                 
054600******************************************************************        
054700     COPY DPPD004.                                                        
054800                                                                          
054900     MOVE +4013                  TO PV-ABEND-CODE.                        
055000     CALL 'ILBOABN0' USING PV-ABEND-CODE.                                 
055100*9100-EXIT.                                                               
