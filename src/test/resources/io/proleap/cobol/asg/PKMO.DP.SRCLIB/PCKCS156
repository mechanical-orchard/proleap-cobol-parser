000100 IDENTIFICATION DIVISION.                                         00010015
000200 PROGRAM-ID.    PCKCS156.                                         00020015
000300 AUTHOR.        BETH A. BILSKI.                                   00030015
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040015
000500 DATE-WRITTEN.  12-30-93.                                         00050015
000600 DATE-COMPILED.                                                   00060015
000700                                                                  00070015
000800*---------------------------------------------------------------* 00080015
000900*    E156 - WORK ORDER RECEIVER ITEM LIST PROGRAM               * 00090053
001000*                                                               * 00100015
001100*    THIS PROGRAM GENERATES A LIST OF RECEIPT ITEMS FOR A       * 00110015
001200*    RECEIVER.                                                  * 00120015
001300*                                                               * 00130015
001400*---------------------------------------------------------------* 00140015
001500* MAINTENANCE:                                                  * 00150015
001600* 6/16/94 - MOVED A +0 TO PV-VERIFY-ITM-QTY IF THERE IS NO      * 00160015
001700*           TRECDIS ROWS TO SUM                                 * 00170015
001800*           B.BILSKI     IR-97                                  * 00180015
001900* 8/09/95 - IF SQLCODE = -913, -911, -904, PUT THE MESSAGE TO   * 00190015
002000*           SCREEN INSTEAD OF ABENDING THE TRANSACTION.         * 00200015
002100*           H.KIM        913-ABENDING-PROBLEM                   * 00210015
002200*---------------------------------------------------------------* 00220015
002210* DATE  11/04/2021                                                00221050
002220*            - CHANGE CALL OF 'DPKUT100' TO                     * 00222050
002230*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 00223050
002240*              MAKING THE CALL DYNAMIC VS STATIC                * 00224050
002250*     MADE BY: GERMAN BANDA            WR/IR #: CHG0264232        00225051
002251*---------------------------------------------------------------- 00225152
002252* DATE  11/07/2022                                              * 00225253
002253*            - ADD COPYBOOK DPWS930                             * 00225353
002254*              CHANGE CALL TO DPWS030 FROM STATIC TO            * 00225453
002255*              DYNAMIC.                                         * 00225553
002256*     MADE BY: BOB MCASEY              WR/IR #: CHG0277910      * 00225653
002260*-----------------------------------------------------------------00226050
002300/                                                                 00230015
002400 ENVIRONMENT DIVISION.                                            00240015
002500                                                                  00250015
002600 DATA DIVISION.                                                   00260015
002700                                                                  00270015
002800 WORKING-STORAGE SECTION.                                         00280015
002900                                                                  00290015
003000 01  DK-DB2-KEYS.                                                 00300015
003100*    REQUIRED FIELDS                                              00310015
003200     05  DK-ORD-NBR                     PIC S9(09)  COMP.         00320015
003300     05  DK-RCVR-SEQ-NBR                PIC S9(09)  COMP.         00330015
003400     05  DK-WORK-ORD-SEQ-NBR            PIC S9(04)  COMP.         00340015
003500     05  DK-LINE-NBR                    PIC S9(04)  COMP.         00350015
003600     05  DK-OPR-ID                      PIC S9(04)  COMP.         00360015
003700     05  DK-FACT                        PIC S9(04)  COMP.         00370015
003800*    OPTIONAL FIELDS                                              00380015
003900     05  DK-STAT-CDE-AP                 PIC  X(02)  VALUE 'AP'.   00390015
004000     05  DK-STAT-CDE-AC                 PIC  X(02)  VALUE 'AC'.   00400015
004100     05  DK-STAT-CDE-CM                 PIC  X(02)  VALUE 'CM'.   00410015
004200     05  DK-STAT-CDE-ACTIVE             PIC  X(01)  VALUE 'A'.    00420015
004300     05  DK-STR-NBR-B                   PIC S9(04)  COMP          00430015
004400                                                    VALUE +0.     00440015
004500     05  DK-STR-NBR-E                   PIC S9(04)  COMP          00450015
004600                                                    VALUE +9999.  00460015
004601     05  DK-PREPK-ID                    PIC S9(04)  VALUE ZEROS   00460116
004610                                                    COMP.         00461016
004700                                                                  00470015
004800 01  PC-PROGRAM-CONSTANTS.                                        00480015
004900     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00490015
005000                                                    'PC156A  '.   00500015
005100     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00510015
005200                                                    'PCKM156 '.   00520015
005300     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00530015
005400                                                    'PCKCS156'.   00540015
005500     05  PC-AUDIT-RTN                   PIC  X(08)  VALUE         00550015
005600                                                    'RCKCS290'.   00560015
005700     05  PC-AUDIT-RTN-LENGTH            PIC S9(04)  VALUE  +300   00570015
005800                                                    COMP SYNC.    00580015
005900     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00590015
006000     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00600015
006100     05  PC-INTER-APPL-CODES.                                     00610015
006200         10 PC-INTER-APPL-CRIT-SPEC     PIC  X(01)  VALUE '1'.    00620015
006300         10 PC-INTER-APPL-LIST          PIC  X(01)  VALUE '5'.    00630015
006400         10 PC-INTER-APPL-PKSL-CRIT     PIC  X(01)  VALUE 'C'.    00640015
006500         10 PC-INTER-APPL-PKSL-LIST     PIC  X(01)  VALUE 'P'.    00650015
006600     05  PC-WORK-ORDER-DIST-SHEET       PIC  9(03)  VALUE 001.    00660015
006700     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +9      00670015
006800                                                    COMP SYNC.    00680015
006900     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00690015
007000                                                    COMP SYNC.    00700015
007100     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00710015
007200                                                    +1000000      00720015
007300                                                    COMP-3.       00730015
007400     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +7      00740015
007500                                                    COMP SYNC.    00750015
007600     05  PC-INACTIVE                    PIC  X(01)  VALUE 'I'.    00760015
007700     05  PC-A                           PIC  X(01)  VALUE 'A'.    00770015
007800     05  PC-R                           PIC  X(01)  VALUE 'R'.    00780015
007900     05  PC-T                           PIC  X(01)  VALUE 'T'.    00790015
008000     05  PC-Y                           PIC  X(01)  VALUE 'Y'.    00800015
008100     05  PC-M                           PIC  X(01)  VALUE 'M'.    00810016
008110     05  PC-N                           PIC  X(01)  VALUE 'N'.    00811016
008200     05  PC-I                           PIC  X(01)  VALUE 'I'.    00820015
008300     05  PC-VE                          PIC  X(02)  VALUE 'VE'.   00830015
008400     05  PC-CM                          PIC  X(02)  VALUE 'CM'.   00840015
008500     05  PC-IP                          PIC  X(02)  VALUE 'IP'.   00850015
008600     05  PC-DB2-DEFAULT-DATE            PIC  X(26)  VALUE         00860015
008700         '9999-09-09-09.09.09.999999'.                            00870015
008800     05  PC-DEF-DATE                    PIC  X(10)  VALUE         00880015
008900         '9999-09-09'.                                            00890015
009000                                                                  00900015
009100     05  PC-TSYMSG-NUMBERS.                                       00910015
009200         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  00920015
009300         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  00930015
009400         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  00940015
009500         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  00950015
009600         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  00960015
009700         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  00970015
009800         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  00980015
009900         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  00990015
010000         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01000015
010100         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01010015
010200         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01020015
010300         10  PC-TSYMSG-00115            PIC  9(05)  VALUE 00115.  01030015
010400         10  PC-TSYMSG-00118            PIC  9(05)  VALUE 00118.  01040015
010500         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01050015
010600         10  PC-TSYMSG-00354            PIC  9(05)  VALUE 00354.  01060015
010700*            DELETE PENDING, PRESS F2 TO CONFIRM                  01070015
010800         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  01080015
010900         10  PC-TSYMSG-00883            PIC  9(05)  VALUE 00883.  01090015
011000*  P.O. NUMBER REQUIRED                                           01100015
011100         10  PC-TSYMSG-00736            PIC  9(05)  VALUE 00736.  01110015
011200*  RECEIVER SEQUENCE NBR REQUIRED                                 01120015
011300         10  PC-TSYMSG-00737            PIC  9(05)  VALUE 00737.  01130015
011400*  THIS TRANSACTION WAS ALREADY VERIFIED, UPDATES ARE NOT ALLOWED 01140015
011500         10  PC-TSYMSG-01230            PIC  9(05)  VALUE 01230.  01150015
011600                                                                  01160015
011700 01  PS-PROGRAM-SWITCHES.                                         01170015
011800     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01180015
011900         88  PS-NO-ERROR                            VALUE 'Y'.    01190015
012000         88  PS-ERROR                               VALUE 'N'.    01200015
012100     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01210015
012200         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01220015
012300         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01230015
012400     05  PS-VERIFIED-RECEIVER-SW        PIC  X(01)  VALUE 'N'.    01240015
012500         88  PS-VERIFIED-RECEIVER                   VALUE 'Y'.    01250015
012600     05  PS-DATA-OK-SW                  PIC  X(01)  VALUE 'N'.    01260015
012700         88  PS-DATA-OK                             VALUE 'Y'.    01270015
012800         88  PS-DATA-NOT-OK                         VALUE 'N'.    01280015
012900     05  PS-UPDATE-SW                   PIC  X(01)  VALUE 'N'.    01290015
013000         88  PS-NO-UPDATES-DONE                     VALUE 'N'.    01300015
013100         88  PS-UPDATES-DONE                        VALUE 'Y'.    01310015
013200                                                                  01320015
013300 01  PV-PROGRAM-VARIABLES.                                        01330015
013400     05  PV-SUB                         PIC S9(04)  VALUE +0      01340015
013500                                                    COMP SYNC.    01350015
013600     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      01360015
013700                                                    COMP SYNC.    01370015
013800     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      01380015
013900                                                    COMP-3.       01390015
014000     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      01400015
014100                                                    COMP-3.       01410015
014200     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      01420015
014300                                                    COMP-3.       01430015
014400     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      01440015
014500                                                    COMP-3.       01450015
014600     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      01460015
014700                                                    COMP SYNC.    01470015
014800     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01480015
014900                                                    COMP SYNC.    01490015
015000     05  PV-ITEM                        PIC S9(04)  VALUE +0      01500015
015100                                                    COMP SYNC.    01510015
015200     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      01520015
015300                                                    COMP SYNC.    01530015
015400     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      01540015
015500                                                    COMP SYNC.    01550015
015600     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      01560015
015700                                                    COMP SYNC.    01570015
015800     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      01580015
015900                                                    COMP SYNC.    01590015
016000     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      01600015
016100                                                    COMP SYNC.    01610015
016200     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01620015
016300                                                    COMP SYNC.    01630015
016400     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01640015
016500                                                    COMP SYNC.    01650015
016600     05  PV-DB2-COUNT                   PIC S9(09)  VALUE +0      01660015
016700                                                    COMP-3.       01670015
016800     05  PV-WO-STOP-COUNT               PIC S9(04)  VALUE +0      01680015
016900                                                    COMP.         01690015
017000     05  PV-NULL-IND                    PIC S9(4)   VALUE +0      01700015
017100                                                    COMP.         01710015
017200     05  PV-UNRSLVD-TRBL-COUNT          PIC S9(09)  VALUE ZERO    01720015
017300                                                    COMP-3.       01730015
017400     05  PV-RSLVD-TRBL-COUNT            PIC S9(09)  VALUE ZERO    01740015
017500                                                    COMP-3.       01750015
017600     05  PV-AP-VERIFY-ITM-QTY           PIC S9(05)  VALUE +0      01760015
017700                                                    COMP.         01770015
017800     05  PV-ACTL-CART-CNT               PIC S9(09)  VALUE +0      01780015
017900                                                    COMP.         01790015
018000     05  PV-DUMMY-TMST                  PIC  X(26)  VALUE         01800015
018100         '9999-09-09-09.09.09.999999'.                            01810015
018200     05  PV-KEY-LINE-NBR               PIC S9(04)  COMP.          01820023
018300     05  PV-SKU                        PIC X(08).                 01830023
018400     05  PV-DEPT                       PIC X(03).                 01840022
018700     05  PV-CLASS                      PIC X(02).                 01870022
019100     05  PV-NBR-WORK-ORDS              PIC ZZZ9.                  01910015
019200     05  PV-CRE-TMST.                                             01920015
019300         10  FILLER                     PIC X(02).                01930015
019400         10  PV-CRE-YY                  PIC X(02).                01940015
019500         10  FILLER                     PIC X(01).                01950015
019600         10  PV-CRE-MM                  PIC X(02).                01960015
019700         10  FILLER                     PIC X(01).                01970015
019800         10  PV-CRE-DD                  PIC X(02).                01980015
019900         10  FILLER                     PIC X(01).                01990015
020000         10  PV-CRE-HRS                 PIC X(02).                02000015
020100         10  FILLER                     PIC X(01).                02010015
020200         10  PV-CRE-MIN                 PIC X(02).                02020015
020300         10  FILLER                     PIC X(10).                02030015
020400     05  PV-CREATE-DTE.                                           02040015
020500         10  PV-CREATE-MM               PIC X(02).                02050015
020600         10  FILLER                     PIC X(01) VALUE '/'.      02060015
020700         10  PV-CREATE-DD               PIC X(02).                02070015
020800         10  FILLER                     PIC X(01) VALUE '/'.      02080015
020900         10  PV-CREATE-YY               PIC X(02).                02090015
021000     05  PV-CREATE-TME.                                           02100015
021100         10  PV-CREATE-HRS              PIC X(02).                02110015
021200         10  FILLER                     PIC X(01) VALUE ':'.      02120015
021300         10  PV-CREATE-MIN              PIC X(02).                02130015
021310     05  PV-DISPLAY-SKU-NBR             PIC X(08).                02131020
021400                                                                  02140015
021500*---------------------------------------------------------------* 02150015
021600*   THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   * 02160015
021700*   THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           * 02170015
021800*   APPLICATION-SPECIFIC COMMAREA.                              * 02180015
021900*---------------------------------------------------------------* 02190015
022000 01  LQW-LIST-QUEUE-WORK-AREA.                                    02200015
022100     05  LQW-BLOCK-MODIFIED             PIC X(01)   VALUE SPACE.  02210015
022200     05  LQW-ITEM-ENTRIES               OCCURS 9 TIMES            02220015
022300                                        INDEXED BY LQW-IDX.       02230015
022400         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       02240015
022500         10  LQW-TEMP-SELECTED-SW       PIC X(01).                02250015
022600         10  LQW-SELECTED-SW            PIC X(01).                02260015
022700             88  LQW-SELECT                         VALUE 'S'.    02270015
022800             88  LQW-DESELECT                       VALUE ' '.    02280015
022900         10  LQW-ACTION                 PIC X(3).                 02290015
023000         10  LQW-LINE-NUMBER            PIC 9(4).                 02300015
023400         10  LQW-CL                     PIC X(02).                02340038
023500         10  LQW-NIS-SKU                PIC X(08).                02350038
023700         10  LQW-SKU-DESC               PIC X(25).                02370015
023800         10  LQW-ITM-NBR                PIC S9(15)V               02380015
023900                                            COMP-3.               02390015
024000         10  LQW-VER-NBR                PIC S9(09)                02400015
024100                                            COMP.                 02410015
024200         10  LQW-STATUS                 PIC X(2).                 02420015
024300         10  LQW-OTR                    PIC 9(5).                 02430015
024400         10  LQW-PS-ITEM                PIC 9(5).                 02440015
024500         10  LQW-DETAIL-ITEM            PIC 9(5).                 02450015
024600         10  LQW-VERIFY-ITEM            PIC 9(5).                 02460015
024700         10  LQW-CREATE-DTE             PIC X(8).                 02470015
024800         10  LQW-CREATE-TME             PIC X(5).                 02480015
024900         10  LQW-NBR-WKORDS             PIC 9(4).                 02490015
025000         10  LQW-WKORD-CART-QTY         PIC 9(5).                 02500015
025100         10  LQW-PURITM-UNT-QTY         PIC S9(09)                02510015
025200                                            COMP.                 02520015
025300         10  LQW-PURITM-UNT-RTL-PR-AMT  PIC S9(06)V99             02530015
025400                                            COMP-3.               02540015
025500         10  LQW-PURITM-GP-RTL-AMT      PIC S9(05)V99             02550015
025600                                            COMP-3.               02560015
025700         10  LQW-PURITM-GP-QTY          PIC S9(04)                02570015
025800                                            COMP.                 02580015
025900         10  LQW-PURITM-VEND-STYL-NAME  PIC X(08).                02590015
026000         10  LQW-LINE-TRBL-SW           PIC X(01).                02600015
026100                                                                  02610015
026200/                                                                 02620015
026300*---------------------------------------------------------------* 02630015
026400*  RECORD LAYOUT FOR THE LIST SELECTION TEMP STORAGE QUEUE.     * 02640015
026500*---------------------------------------------------------------* 02650015
026600                                                                  02660015
026700     COPY PCWS016.                                                02670015
026800/                                                                 02680032
026900*---------------------------------------------------------------* 02690015
027000*  RECORD LAYOUT FOR THE PACKSLIP SELECTION TEMP STORAGE QUEUE. * 02700015
027100*---------------------------------------------------------------* 02710015
027200                                                                  02720015
027300     COPY RCWS013.                                                02730015
027400                                                                  02740015
027500/                                                                 02750015
027600*---------------------------------------------------------------* 02760015
027700*  RECORD LAYOUT 'INSERT AUDIT MODULE'  RCKCS290                * 02770015
027800*---------------------------------------------------------------* 02780015
027900                                                                  02790015
028000     COPY RCWS031.                                                02800015
028100                                                                  02810015
028200/                                                                 02820015
028300*---------------------------------------------------------------* 02830015
028400*    MAP LAYOUT                                                 * 02840015
028500*---------------------------------------------------------------* 02850015
028600                                                                  02860015
028700     COPY PCKM156.                                                02870015
028800/                                                                 02880015
028900 01  MR-OCCURS-LAYOUT                   REDEFINES  PC156AO.       02890015
029100     05  FILLER                         PIC X(132).               02910041
029200     05  MR-SCROLL-AREA                 OCCURS 09 TIMES.          02920015
029300         10  MR-SELECTL                 PIC S9(04) COMP.          02930015
029400         10  MR-SELECTA                 PIC  X(01).               02940015
029500         10  MR-SELECTC                 PIC  X(01).               02950015
029600         10  MR-SELECTH                 PIC  X(01).               02960015
029700         10  MR-SELECT                  PIC  X(01).               02970015
029800                                                                  02980015
029900         10  MR-LINEL                   PIC S9(04) COMP.          02990015
030000         10  MR-LINEA                   PIC  X(01).               03000015
030100         10  MR-LINEC                   PIC  X(01).               03010015
030200         10  MR-LINEH                   PIC  X(01).               03020015
030300         10  MR-LINE.                                             03030015
030400             15  MR-LINE-N              PIC  ZZZ9.                03040015
030500                                                                  03050015
030600         10  MR-CLSL                    PIC S9(04) COMP.          03060022
030700         10  MR-CLSA                    PIC  X(01).               03070022
030800         10  MR-CLSC                    PIC  X(01).               03080022
030900         10  MR-CLSH                    PIC  X(01).               03090022
031000         10  MR-CLS                     PIC  X(02).               03100022
031010                                                                  03101022
031020         10  MR-SKUL                    PIC S9(04) COMP.          03102022
031030         10  MR-SKUA                    PIC  X(01).               03103022
031040         10  MR-SKUC                    PIC  X(01).               03104022
031050         10  MR-SKUH                    PIC  X(01).               03105022
031060         10  MR-SKU                     PIC  X(08).               03106022
031070                                                                  03107022
031100                                                                  03110015
031200         10  MR-STATUSL                 PIC S9(04) COMP.          03120015
031300         10  MR-STATUSA                 PIC  X(01).               03130015
031400         10  MR-STATUSC                 PIC  X(01).               03140015
031500         10  MR-STATUSH                 PIC  X(01).               03150015
031600         10  MR-STATUS                  PIC  X(02).               03160015
031700                                                                  03170015
031800         10  MR-OTRL                    PIC S9(04) COMP.          03180015
031900         10  MR-OTRA                    PIC  X(01).               03190015
032000         10  MR-OTRC                    PIC  X(01).               03200015
032100         10  MR-OTRH                    PIC  X(01).               03210015
032200         10  MR-OTR                     PIC  X(05).               03220015
032300                                                                  03230015
032400         10  MR-PSL                     PIC S9(04) COMP.          03240015
032500         10  MR-PSA                     PIC  X(01).               03250015
032600         10  MR-PSC                     PIC  X(01).               03260015
032700         10  MR-PSH                     PIC  X(01).               03270015
032800         10  MR-PS.                                               03280015
032900             15  MR-PS-N                PIC  ZZZZ9.               03290015
033000                                                                  03300015
033100         10  MR-DETAIL-ITEML            PIC S9(04) COMP.          03310015
033200         10  MR-DETAIL-ITEMA            PIC  X(01).               03320015
033300         10  MR-DETAIL-ITEMC            PIC  X(01).               03330015
033400         10  MR-DETAIL-ITEMH            PIC  X(01).               03340015
033500         10  MR-DETAIL-ITEM.                                      03350015
033600             15  MR-DETAIL-ITEM-N       PIC  ZZZZ9.               03360015
033700                                                                  03370015
033800         10  MR-VERIFY-ITEML            PIC S9(04) COMP.          03380015
033900         10  MR-VERIFY-ITEMA            PIC  X(01).               03390015
034000         10  MR-VERIFY-ITEMC            PIC  X(01).               03400015
034100         10  MR-VERIFY-ITEMH            PIC  X(01).               03410015
034200         10  MR-VERIFY-ITEM.                                      03420015
034300             15  MR-VERIFY-ITEM-N       PIC  ZZZZ9.               03430015
034400                                                                  03440015
034500         10  MR-CREATE-DATEL            PIC S9(04) COMP.          03450015
034600         10  MR-CREATE-DATEA            PIC  X(01).               03460015
034700         10  MR-CREATE-DATEC            PIC  X(01).               03470015
034800         10  MR-CREATE-DATE-H           PIC  X(01).               03480015
034900         10  MR-CREATE-DATE             PIC  X(08).               03490015
035000                                                                  03500015
035100         10  MR-CREATE-TIMEL            PIC S9(04) COMP.          03510015
035200         10  MR-CREATE-TIMEA            PIC  X(01).               03520015
035300         10  MR-CREATE-TIMEC            PIC  X(01).               03530015
035400         10  MR-CREATE-TIME-H           PIC  X(01).               03540015
035500         10  MR-CREATE-TIME             PIC  X(05).               03550015
035600                                                                  03560015
035700         10  MR-NBR-WORK-ORDSL          PIC S9(04) COMP.          03570015
035800         10  MR-NBR-WORK-ORDSA          PIC  X(01).               03580015
035900         10  MR-NBR-WORK-ORDSC          PIC  X(01).               03590015
036000         10  MR-NBR-WORK-ORDSH          PIC  X(01).               03600015
036100         10  MR-NBR-WORK-ORDS.                                    03610015
036200             15  MR-NBR-WORK-ORDS-N     PIC  ZZZ9.                03620015
036300                                                                  03630015
036400         10  MR-CART-QTYL               PIC S9(04) COMP.          03640015
036500         10  MR-CART-QTYA               PIC  X(01).               03650015
036600         10  MR-CART-QTYC               PIC  X(01).               03660015
036700         10  MR-CART-QTYH               PIC  X(01).               03670015
036800         10  MR-CART-QTY.                                         03680015
036900             15  MR-CART-QTY-N          PIC  ZZZZ9.               03690015
037000     EJECT                                                        03700015
037100*---------------------------------------------------------------* 03710015
037200*    ATTRIBUTE SETTINGS COPYBOOK.                               * 03720015
037300*---------------------------------------------------------------* 03730015
037400                                                                  03740015
037500     COPY DPWS015.                                                03750015
037600                                                                  03760015
037700*---------------------------------------------------------------* 03770015
037800*    FUNCTION KEYS COPYBOOK.                                    * 03780015
037900*---------------------------------------------------------------* 03790015
038000                                                                  03800015
038100     COPY DPWS016.                                                03810015
038200                                                                  03820015
038300*---------------------------------------------------------------* 03830015
038400*    NUMERIC EDIT LAYOUT.                                       * 03840015
038500*---------------------------------------------------------------* 03850015
038600                                                                  03860015
038700     COPY DPWS010I.                                               03870015
038800                                                                  03880015
038900/                                                                 03890015
039000*---------------------------------------------------------------* 03900015
039100*    PARAMETERS FOR CALLING CICS ARCHITECTURE API (DPKCS030).   * 03910015
039200*---------------------------------------------------------------* 03920015
039300                                                                  03930015
039400     COPY DPWS030.                                                03940015
039410     COPY DPWS930.                                                03941053
039500                                                                  03950015
039600/                                                                 03960015
039610*---------------------------------------------------------------* 03961020
039620*    LOGISTICS DOMAIN ITEM ACCESS MODULE COPYBOOK.              * 03962044
039630*---------------------------------------------------------------* 03963020
039640                                                                  03964020
039650     COPY XLWS001.                                                03965020
039660                                                                  03966020
039670/                                                                 03967020
039700*---------------------------------------------------------------* 03970015
039800*    STANDARD COMMAREA.                                         * 03980015
039900*---------------------------------------------------------------* 03990015
040000                                                                  04000015
040100     COPY DPWS020.                                                04010015
040200     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04020015
040300                                                                  04030015
040400*---------------------------------------------------------------* 04040015
040500* INTER-APPLICATION COMMAREA.                                   * 04050015
040600* RCWS012 - INTER-APPLICATION COMMAREA FROM THE PACK SLIP UPDT  * 04060015
040700* RCWS015 - INTER-APPLICATION COMMAREA FROM THE PACK SLIP LIST  * 04070015
040800*---------------------------------------------------------------* 04080015
040900                                                                  04090015
041000         10  INTER-APPL-COMM-AREA       PIC X(200).               04100015
041100     COPY PCWS000.                                                04110015
041200                                                                  04120015
041300     COPY RCWS012.                                                04130015
041400     COPY RCWS015.                                                04140015
041500*---------------------------------------------------------------* 04150015
041600*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 04160015
041700*---------------------------------------------------------------* 04170015
041800         10  ASC-SPECIFIC-COMMAREA.                               04180015
041900             15  ASC-LIST-KEYS.                                   04190015
042000                 20  ASC-PO-NBR             PIC 9(08).            04200015
042100                 20  ASC-REC-SEQ-NBR        PIC 9(03).            04210015
042200                 20  ASC-STAT               PIC X(02).            04220015
042300                 20  ASC-OPR-ID             PIC ZZZ9.             04230015
042400                 20  ASC-FACT               PIC ZZZ9.             04240015
042500             15  ASC-OTHER-TOP-OF-SCREEN-DATA.                    04250015
042600                 20  ASC-TRECEIV-DATA.                            04260015
042700                     25  ASC-TRECEIV-EXPTED-CART-CNT  PIC 9(5).   04270015
042800                     25  ASC-TRECEIV-ACTL-CART-CNT    PIC 9(5).   04280015
043000                     25  ASC-TPURCHS-DEPT-NBR         PIC X(3).   04300020
043100                     25  ASC-TPURITM-CL-NBR           PIC X(2).   04310020
043300                     25  ASC-TPURITM-SKU-DESC         PIC X(25).  04330015
043400                     25  ASC-TPURITM-VEND-STYL-NAME   PIC X(20).  04340015
043500             15  ASC-BLOCK-ENTRIES      OCCURS 2 TIMES.           04350015
043600                 20  ASC-BLOCK-MODIFIED-SW                        04360015
043700                                        PIC X(01).                04370015
043800                     88  ASC-BLOCK-NOT-MODIFIED    VALUE 'N'.     04380015
043900                     88  ASC-BLOCK-MODIFIED        VALUE 'Y'.     04390015
044000                                                                  04400015
044100                 20  ASC-ITEM-ARRAY.                              04410015
044200                     25  ASC-ITEM-ENTRIES OCCURS 9 TIMES.         04420015
044300                         30  ASC-LIST-ITEM-NUMBER                 04430015
044400                                        PIC S9(09) COMP-3.        04440015
044500                         30  ASC-TEMP-SELECTED-SW                 04450015
044600                                        PIC X(01).                04460015
044700                             88  ASC-VALID-SELECT  VALUE ' '      04470015
044800                                                         'S'      04480015
044900                                                         'B'      04490015
045000                                                         'E'.     04500015
045100                       88  ASC-TEMP-NO-SELECT                     04510024
045200                                             VALUE ' '.           04520024
045300                             88  ASC-TEMP-SELECT   VALUE 'S'.     04530015
045400                             88  ASC-TEMP-BEGIN    VALUE 'B'.     04540015
045500                             88  ASC-TEMP-END      VALUE 'E'.     04550015
045600                         30  ASC-SELECTED-SW                      04560015
045700                                        PIC X(01).                04570015
045800                             88  ASC-NO-SELECT     VALUE ' '.     04580015
045900                             88  ASC-SELECT        VALUE 'S'.     04590015
046000                             88  ASC-BEGIN         VALUE 'B'.     04600015
046100                             88  ASC-END           VALUE 'E'.     04610015
046200                         30  ASC-ACTION            PIC X(03).     04620015
046300                         30  ASC-LINE-NUMBER       PIC 9(04).     04630015
046700                         30  ASC-CLASS             PIC X(02).     04670038
046800                         30  ASC-NIS-SKU           PIC X(08).     04680038
047000                         30  ASC-SKU-DESC          PIC X(25).     04700015
047100                         30  ASC-ITM-NBR           PIC S9(15)V    04710015
047200                                                       COMP-3.    04720015
047300                         30  ASC-VER-NBR           PIC S9(09)     04730015
047400                                                       COMP.      04740015
047500                         30  ASC-STATUS            PIC X(2).      04750015
047600                         30  ASC-OTR               PIC X(5).      04760015
047700                         30  ASC-PS-ITEM           PIC ZZZZ9.     04770015
047800                         30  ASC-DETAIL-ITEM       PIC ZZZZ9.     04780015
047900                         30  ASC-VERIFY-ITEM       PIC ZZZZ9.     04790015
048000                         30  ASC-CREATE-DTE        PIC X(8).      04800015
048100                         30  ASC-CREATE-TME        PIC X(5).      04810015
048200                         30  ASC-NBR-WKORDS        PIC 9(04).     04820015
048300                         30  ASC-WKORD-CART-QTY    PIC ZZZZ9.     04830015
048400                         30  ASC-FIELDS-TO-BE-PASSED.             04840015
048500                             35  ASC-PURITM-UNT-QTY               04850015
048600                                                   PIC S9(09)     04860015
048700                                                       COMP.      04870015
048800                             35  ASC-PURITM-UNT-RTL-PR-AMT        04880015
048900                                                   PIC S9(06)V99  04890015
049000                                                       COMP-3.    04900015
049100                             35  ASC-PURITM-GP-RTL-AMT            04910015
049200                                                   PIC S9(05)V99  04920015
049300                                                       COMP-3.    04930015
049400                             35  ASC-PURITM-GP-QTY PIC S9(04)     04940015
049500                                                       COMP.      04950015
049600                             35  ASC-PURITM-VEND-STYL-NAME        04960015
049700                                                   PIC X(08).     04970015
049800                         30  ASC-LINE-TRBL-SW                     04980015
049900                                        PIC X(01).                04990015
050000                             88  ASC-LINE-IN-TROUBLE  VALUE 'Y'.  05000015
050100                             88  ASC-LINE-DISTRO-TRBL VALUE 'D'.  05010015
050200                                                                  05020015
050300             15  ASC-BLK-SUB            PIC S9(04) COMP SYNC.     05030015
050400             15  ASC-ITEM-SUB           PIC S9(04) COMP SYNC.     05040015
050500             15  ASC-SEL-SUB            PIC S9(04) COMP.          05050015
050600             15  ASC-SEL-ITEM           PIC S9(04) COMP.          05060015
050700             15  ASC-NUMBER-OF-ITEMS-READ                         05070015
050800                                        PIC S9(09) COMP-3.        05080015
050900             15  ASC-NUMBER-OF-SELECTED-ITEMS                     05090015
051000                                        PIC S9(09) COMP-3.        05100015
051100             15  ASC-NUMBER-OF-TS-ITEMS PIC S9(05) COMP-3.        05110015
051200             15  ASC-ITEMS-DISPLAYED    PIC S9(03) COMP-3.        05120015
051300             15  ASC-ITEM-AT-TOP-OF-PANEL                         05130015
051400                                        PIC S9(09) COMP-3.        05140015
051500             15  ASC-ITEM-AT-BOT-OF-PANEL                         05150015
051600                                        PIC S9(09) COMP-3.        05160015
051700             15  ASC-HIGHEST-BLOCK-WRITTEN                        05170015
051800                                        PIC S9(04) COMP SYNC.     05180015
051900             15  ASC-START-OF-SELECTED-RANGE                      05190015
052000                                        PIC S9(09) COMP-3.        05200015
052100             15  ASC-END-OF-SELECTED-RANGE                        05210015
052200                                        PIC S9(09) COMP-3.        05220015
052300             15  ASC-ITEMS-LEFT-INDICATOR                         05230015
052400                                        PIC X(01).                05240015
052500                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     05250015
052600                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     05260015
052700             15  ASC-TEMP-QUEUE-UPDATE-SW                         05270015
052800                                        PIC X(01).                05280015
052900                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     05290015
053000                 88  ASC-UPDATE-TSQ2               VALUE '2'.     05300015
053100                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     05310015
053200             15  ASC-LIST-QUEUE-NAME.                             05320015
053300                 20  ASC-LIST-TERM-ID   PIC X(04).                05330015
053400                 20  ASC-LIST-TASK-NUMBER                         05340015
053500                                        PIC S9(05) COMP-3.        05350015
053600                 20  ASC-LIST-SEQ       PIC 9(01).                05360015
053700             15  ASC-SEL-QUEUE-NAME-IN   PIC X(08).               05370015
053800             15  ASC-SEL-QUEUE-NAME-OUT.                          05380015
053900                 20  ASC-SEL-TERM-ID-OUT PIC X(04).               05390015
054000                 20  ASC-SEL-TASK-NUMBER-OUT                      05400015
054100                                         PIC S9(05) COMP-3.       05410015
054200                 20  ASC-SEL-SEQ-OUT     PIC 9(01).               05420015
054300                                                                  05430015
054400             15  ASC-START-ITEM-REQUEST.                          05440015
054500                 20  ASC-START-ITEM-REQUEST-N  PIC 9(07).         05450015
054600             15  ASC-USE-SELECTION-QUEUE-IND   PIC X(01).         05460015
054700                 88  ASC-USE-SELECTION-QUEUE   VALUE 'Y'.         05470015
054800             15  ASC-HOLD-INTER-APPL           PIC X(200).        05480015
054900             15  ASC-INTER-APPL-CODE-IND       PIC X(01).         05490015
055000                 88 ASC-INTER-APPL-PKSL-LIST   VALUE 'P'.         05500015
055100             15  ASC-TROUB-STATUS              PIC X(11).         05510015
055200             15  ASC-DELETED-REQUESTED-SW      PIC X(01).         05520015
055300                 88  ASC-DELETED-REQUESTED     VALUE 'Y'.         05530015
055400/                                                                 05540015
055500*---------------------------------------------------------------* 05550015
055600*    ABEND PROCESSING COPYBOOK.                                 * 05560015
055700*---------------------------------------------------------------* 05570015
055800                                                                  05580015
055900     COPY DPWS013.                                                05590015
056000                                                                  05600015
056100/                                                                 05610015
056200*---------------------------------------------------------------* 05620015
056300*    OPEN TO RECEIVE COPYBOOK.                                  * 05630015
056400*---------------------------------------------------------------* 05640015
056500                                                                  05650015
056600     COPY PCWS020.                                                05660015
056700/                                                                 05670015
056800*---------------------------------------------------------------* 05680015
056900*    DB2 AREA FOR THE WORK ORDER TABLE                          * 05690015
057000*---------------------------------------------------------------* 05700015
057100     EXEC SQL                                                     05710015
057200          INCLUDE TWRKORD                                         05720015
057300     END-EXEC.                                                    05730015
057400                                                                  05740015
057500*---------------------------------------------------------------* 05750015
057600*    DB2 AREA FOR THE WORK ORDER INSTRUCTION TABLE              * 05760015
057700*---------------------------------------------------------------* 05770015
057800     EXEC SQL                                                     05780015
057900          INCLUDE TWKORIN                                         05790015
058000     END-EXEC.                                                    05800015
058100                                                                  05810015
059000*---------------------------------------------------------------* 05900015
059100*    DB2 AREA FOR THE RECEIVER                                  * 05910015
059200*---------------------------------------------------------------* 05920015
059300     EXEC SQL                                                     05930015
059400          INCLUDE TRECEIV                                         05940015
059500     END-EXEC.                                                    05950015
059600                                                                  05960015
059700/                                                                 05970015
059800*---------------------------------------------------------------* 05980015
059900*    DB2 AREA FOR THE PURCHASE ORDER TABLE                      * 05990015
060000*---------------------------------------------------------------* 06000015
060100     EXEC SQL                                                     06010015
060200          INCLUDE TPURCHS                                         06020015
060300     END-EXEC.                                                    06030015
060400                                                                  06040015
060500/                                                                 06050015
060600*----------------------------------------------------------------*06060015
060700*    DB2 DCLGEN FOR THE TROUBLE NOTIFICATION TABLE                06070015
060800*----------------------------------------------------------------*06080015
060900     EXEC SQL                                                     06090015
061000          INCLUDE TTRBNTF                                         06100015
061100     END-EXEC.                                                    06110015
061200                                                                  06120015
061300/                                                                 06130015
061400*----------------------------------------------------------------*06140015
061500*    DB2 DCLGEN FOR THE TROUBLE REASON TABLE                      06150015
061600*----------------------------------------------------------------*06160015
061700     EXEC SQL                                                     06170015
061800          INCLUDE TTRBRSN                                         06180015
061900     END-EXEC.                                                    06190015
062000                                                                  06200015
062100/                                                                 06210015
062200*---------------------------------------------------------------* 06220015
062300*    DB2 AREA FOR COMMUNICATIONS                                * 06230015
062400*---------------------------------------------------------------* 06240015
062500     EXEC SQL                                                     06250015
062600          INCLUDE SQLCA                                           06260015
062700     END-EXEC.                                                    06270015
062800                                                                  06280015
062900/                                                                 06290015
063000*---------------------------------------------------------------* 06300015
063100*  CURSOR TO LIST TPURITM                                       * 06310015
063200*---------------------------------------------------------------* 06320015
063300                                                                  06330015
063400     EXEC SQL                                                     06340015
063500          DECLARE TRECITM1-CSR CURSOR FOR                         06350046
063600           SELECT ORD_NBR                                         06360015
063700                 ,ORD_LNE_NBR                                     06370015
063800                 ,DTL_CK_ITM_QTY                                  06380015
063900                 ,PKSL_ITM_QTY                                    06390015
064000                 ,CRE_TMST                                        06400015
064010                 ,PREPK_ID                                        06401016
064100           FROM   TRECITM                                         06410015
064200           WHERE  ORD_NBR        = :DK-ORD-NBR                    06420015
064300             AND REC_SEQ_NBR     = :DK-RCVR-SEQ-NBR               06430015
064400             AND OPER_UNT_ID     = :DK-OPR-ID                     06440015
064500             AND FCLTY_ID        = :DK-FACT                       06450015
064600             AND  VER_STATUS_CDE = 'A'                            06460015
064700         ORDER BY ORD_LNE_NBR                                     06470015
064800     END-EXEC.                                                    06480015
064900                                                                  06490015
065000                                                                  06500015
065100*---------------------------------------------------------------* 06510015
065200*    ZEROLINE UPDATE CURSOR.                                    * 06520015
065300*---------------------------------------------------------------* 06530015
065400                                                                  06540015
065500     EXEC SQL                                                     06550015
065600          DECLARE ZEROLINE CURSOR                                 06560015
065700          FOR  SELECT                                             06570015
065800               ORD_NBR                                            06580015
065900              ,RCVR_SEQ_NBR                                       06590015
066000              ,ORD_LNE_NBR                                        06600015
066100              ,WORK_ORD_SEQ_NBR                                   06610015
066200              ,OPER_UNT_ID                                        06620015
066300              ,FCLTY_ID                                           06630015
066400              ,WO_INSTR_SEQ_NBR                                   06640015
066500              ,CRE_TMST                                           06650015
066600              ,VER_STATUS_CDE                                     06660015
066700              ,CRE_UID_ID                                         06670015
066800              ,OPER_ID                                            06680015
066900              ,FCLTY_AREA_ID                                      06690015
067000              ,PRC_FCLTY_AREA_ID                                  06700015
067100              ,EXPTED_CART_CNT                                    06710015
067200              ,ACTL_CART_CNT                                      06720015
067300              ,ALLOC_IND                                          06730015
067400              ,REPACK_IND                                         06740015
067500              ,STRT_TMST                                          06750015
067600              ,STOP_TMST                                          06760015
067700              ,SCREEN_SEQ_NBR                                     06770015
067800              ,LNE_LOC_CDE                                        06780015
067900              ,REC_SEL_IND                                        06790015
068000          FROM                                                    06800015
068100               TWKORIN                                            06810015
068200          WHERE                                                   06820015
068300               ORD_NBR          =  :DK-ORD-NBR                    06830015
068400          AND  RCVR_SEQ_NBR     =  :DK-RCVR-SEQ-NBR               06840015
068500          AND  ORD_LNE_NBR      =  0                              06850015
068600          AND  OPER_UNT_ID      =  :DK-OPR-ID                     06860015
068700          AND  FCLTY_ID         =  :DK-FACT                       06870015
068800          AND  VER_STATUS_CDE   =  :PC-A                          06880015
068900          AND  STOP_TMST        >  :PV-DUMMY-TMST                 06890015
069000          FOR UPDATE OF                                           06900015
069100               REC_SEL_IND                                        06910015
069200             , STOP_TMST                                          06920015
069300             , STRT_TMST                                          06930015
069400             , CRE_UID_ID                                         06940015
069500      END-EXEC.                                                   06950015
069600/                                                                 06960015
069700                                                                  06970015
069800     COPY DPWS276.                                                06980015
069900/                                                                 06990015
070000 LINKAGE SECTION.                                                 07000015
070100                                                                  07010015
070200 01  DFHCOMMAREA.                                                 07020015
070300     05  FILLER                         OCCURS  1 TO 4072 TIMES   07030015
070400                                        DEPENDING ON EIBCALEN.    07040015
070500         10  FILLER                     PIC X.                    07050015
070600                                                                  07060015
070700/                                                                 07070015
070800 PROCEDURE DIVISION.                                              07080015
070900*---------------------------------------------------------------* 07090015
071000*   THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. * 07100015
071100*   FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  * 07110015
071200*   PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. * 07120015
071300*---------------------------------------------------------------* 07130015
071400 0000-MAIN-MODULE.                                                07140015
071500                                                                  07150015
071600     INITIALIZE DP030-CICS-API-FIELDS.                            07160015
071700                                                                  07170015
071800     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       07180015
071900     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          07190015
072000     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         07200015
072100                                                                  07210015
072200     SET DP030-RECEIVE-APPL-MAP                                   07220015
072300         DP030-OVERRIDE-APPL-ERROR TO TRUE.                       07230015
072400                                                                  07240015
072500     MOVE LENGTH OF PC156AI        TO DP030-MAP-LENGTH (1).       07250015
072600     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     07260015
072700                                                                  07270015
072800     PERFORM 0001-CALL-CICS-ARCH-API.                             07280015
072900     PERFORM 1000-CONTROL-PROCESSING                              07290015
073000                                                                  07300015
073100     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     07310015
073200     PERFORM 0001-CALL-CICS-ARCH-API.                             07320015
073300                                                                  07330015
073400*---------------------------------------------------------------* 07340015
073500*   THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   * 07350015
073600*   AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         * 07360015
073700*---------------------------------------------------------------* 07370015
073800 0001-CALL-CICS-ARCH-API.                                         07380015
073900*    CALL 'DPKCS030' USING DFHEIBLK                               07390053
073910     CALL DP930-CICS-ARCH-API                                     07391053
073920                     USING DFHEIBLK                               07392053
074000                           DFHCOMMAREA                            07400015
074100                           DP030-CICS-API-FIELDS                  07410015
074200                           DP020-STANDARD-COMMAREA                07420015
074300                           PC156AI.                               07430015
074400                                                                  07440015
074500     IF  DP030-RC-CALL-SUCCESSFUL OR                              07450015
074600         DP030-RC-APPL-ERROR                                      07460015
074700         CONTINUE                                                 07470015
074800     ELSE                                                         07480015
074900         SET DP013-NO-ROLLBACK                                    07490015
075000             DP013-XCTL-DISPLAY-RESTART                           07500015
075100             DP013-CICS-ABEND      TO TRUE                        07510015
075200         MOVE '0001-CALL-CICS-ARCH-API'                           07520015
075300                                   TO DP013-PARAGRAPH             07530015
075400*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX07540053
075500*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      07550053
075510         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O07551053
075520-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      07552053
075600         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      07560015
075700         PERFORM DP013-0000-PROCESS-ABEND                         07570015
075800     END-IF.                                                      07580015
075900                                                                  07590015
076000*----------------------------------------------------------------*07600015
076100* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *07610015
076200* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *07620015
076300*                                                                *07630015
076400* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *07640015
076500*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *07650015
076600*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *07660015
076700*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *07670015
076800*----------------------------------------------------------------*07680015
076900                                                                  07690015
077000 1000-CONTROL-PROCESSING.                                         07700015
077100                                                                  07710015
077200     EVALUATE TRUE                                                07720015
077300         WHEN DP020-NEXT-ACT-INITIAL                              07730015
077400             INITIALIZE ASC-SPECIFIC-COMMAREA                     07740015
077500             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            07750015
077600                                      ASC-SEL-TERM-ID-OUT         07760015
077700             MOVE DP020-SRC-TASK-NUMBER                           07770015
077800                                   TO ASC-LIST-TASK-NUMBER        07780015
077900                                      ASC-SEL-TASK-NUMBER-OUT     07790015
078000             MOVE PC-LIST-QUEUE-SEQ                               07800015
078100                                   TO ASC-LIST-SEQ                07810015
078200             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ-OUT             07820015
078300             PERFORM 1100-PROCESS-INTER-APPL-COMM                 07830015
078400             IF  PS-COMMAREA-NOT-VALID                            07840015
078500                 SET DP020-MSG-FATAL                              07850015
078600                     DP020-NEXT-ACT-APPL-ERROR TO TRUE            07860015
078700             ELSE                                                 07870015
078800                 MOVE INTER-APPL-COMM-AREA                        07880015
078900                                   TO ASC-HOLD-INTER-APPL         07890015
079000                 PERFORM 4000-BUILD-INITIAL-PANEL                 07900015
079100             END-IF                                               07910015
079200                                                                  07920015
079300         WHEN DP020-NEXT-ACT-READ-MAP                             07930015
079400             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        07940015
079500                                   TO PV-TOP-ITEM                 07950015
079600             PERFORM 2000-PROCESS-PANEL                           07960015
079700                                                                  07970015
079800         WHEN DP020-NEXT-ACT-RETURN                               07980015
079900              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       07990015
080000                                   TO PV-TOP-ITEM                 08000015
080100              MOVE ZERO            TO ASC-ITEM-AT-TOP-OF-PANEL    08010015
080200              MOVE ASC-HOLD-INTER-APPL                            08020015
080300                                TO INTER-APPL-COMM-AREA           08030015
080400              PERFORM 2050-DELETE-LIST-QUEUE                      08040015
080500              PERFORM 4000-BUILD-INITIAL-PANEL                    08050015
080600                                                                  08060015
080700         WHEN OTHER                                               08070015
080800             SET DP013-LOGIC-ABEND TO TRUE                        08080015
080900             SET DP013-NO-ROLLBACK TO TRUE                        08090015
081000             MOVE '1000-CONTROL-PROCESSING'                       08100015
081100                                   TO DP013-PARAGRAPH             08110015
081200             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    08120015
081300                                   TO DP013-MESSAGE-TEXT(1)       08130015
081400             PERFORM DP013-0000-PROCESS-ABEND                     08140015
081500     END-EVALUATE.                                                08150015
081600                                                                  08160015
081700/                                                                 08170015
081800*----------------------------------------------------------------*08180015
081900* MOVE DATA PASSED THROUGH THE INTER-APPL COMMAREA               *08190015
082000*----------------------------------------------------------------*08200015
082100                                                                  08210015
082200 1100-PROCESS-INTER-APPL-COMM.                                    08220015
082300                                                                  08230015
082400*----------------------------------------------------------------*08240015
082500* NOTE - IT'S "PC" STANDARD TO DENOTE LIST-TO-LIST ENTRY BY A    *08250015
082600*        '5' IN DP020-INT-APPL-FORMAT-IND.                       *08260015
082700*----------------------------------------------------------------*08270015
082800     SET PS-COMMAREA-VALID          TO TRUE.                      08280015
082900     MOVE SPACE                     TO ASC-START-ITEM-REQUEST.    08290015
083000     MOVE DP020-INT-APPL-FORMAT-IND TO ASC-INTER-APPL-CODE-IND.   08300015
083100                                                                  08310015
083200     EVALUATE DP020-INT-APPL-FORMAT-IND                           08320015
083300                                                                  08330015
083400         WHEN PC-INTER-APPL-CRIT-SPEC                             08340015
083500                                                                  08350015
083600**           THIS PROGRAM ASSUMES THAT INTER-APPL FIELDS ARE      08360015
083700**           PROPERLY INITIALIZED...                              08370015
083800             IF  PC000-PO-NBR-N      = ZEROES                     08380015
083900                 MOVE PC-TSYMSG-00736  TO DP020-MSG-NUMBER        08390015
084000                 SET PS-ERROR                                     08400015
084100                     PS-COMMAREA-NOT-VALID                        08410015
084200                     DP020-MSG-FATAL   TO TRUE                    08420015
084300             END-IF                                               08430015
084400             IF  PC000-REC-SEQ-NBR-N = ZEROES                     08440015
084500                 MOVE PC-TSYMSG-00737  TO DP020-MSG-NUMBER        08450015
084600                 SET PS-ERROR                                     08460015
084700                     PS-COMMAREA-NOT-VALID                        08470015
084800                     DP020-MSG-FATAL   TO TRUE                    08480015
084900             END-IF                                               08490015
085000             IF  PS-NO-ERROR                                      08500015
085100                 MOVE PC000-PO-NBR-N          TO                  08510015
085200                      ASC-PO-NBR                                  08520015
085300                      DK-ORD-NBR                                  08530015
085400                 MOVE PC000-REC-SEQ-NBR-N     TO                  08540015
085500                      ASC-REC-SEQ-NBR                             08550015
085600                      DK-RCVR-SEQ-NBR                             08560015
085700                 MOVE PC000-OPERATING-UNIT-ID TO                  08570015
085800                      ASC-OPR-ID                                  08580015
085900                      DK-OPR-ID                                   08590015
086000                 MOVE PC000-FACILITY-ID       TO                  08600015
086100                      ASC-FACT                                    08610015
086200                      DK-FACT                                     08620015
086300             END-IF                                               08630015
086400                                                                  08640015
086500         WHEN PC-INTER-APPL-LIST                                  08650015
086600              SET ASC-USE-SELECTION-QUEUE                         08660015
086700                                   TO TRUE                        08670015
086800              MOVE PC000-NUMBER-OF-SELECTED-ITEMS                 08680015
086900                                   TO ASC-NUMBER-OF-SELECTED-ITEMS08690015
087000              MOVE PC000-NUMBER-OF-TS-ITEMS                       08700015
087100                                   TO ASC-NUMBER-OF-TS-ITEMS      08710015
087200              MOVE PC000-SEL-QUEUE-NAME                           08720015
087300                                   TO ASC-SEL-QUEUE-NAME-IN       08730015
087400              PERFORM 1120-PREPARE-LIST-ENTRY                     08740015
087500                                                                  08750015
087600         WHEN PC-INTER-APPL-PKSL-LIST                             08760015
087700              SET ASC-USE-SELECTION-QUEUE                         08770015
087800                                   TO TRUE                        08780015
087900              MOVE RC015-NUMBER-OF-SELECTED-ITEMS                 08790015
088000                                   TO ASC-NUMBER-OF-SELECTED-ITEMS08800015
088100              MOVE RC015-NUMBER-OF-TS-ITEMS                       08810015
088200                                   TO ASC-NUMBER-OF-TS-ITEMS      08820015
088300              MOVE RC015-SEL-QUEUE-NAME                           08830015
088400                                   TO ASC-SEL-QUEUE-NAME-IN       08840015
088500              PERFORM 1130-PREPARE-PKSL-LIST-ENTRY                08850015
088600                                                                  08860015
088700         WHEN PC-INTER-APPL-PKSL-CRIT                             08870015
088800             IF  RC012-REC-SEQ-NBR = ZEROES                       08880015
088900                 MOVE PC-TSYMSG-00737   TO DP020-MSG-NUMBER       08890015
089000                 SET PS-ERROR                                     08900015
089100                     PS-COMMAREA-NOT-VALID                        08910015
089200                     DP020-MSG-FATAL    TO TRUE                   08920015
089300             ELSE                                                 08930015
089400                 MOVE RC012-PO-NBR      TO ASC-PO-NBR             08940015
089500                                           DK-ORD-NBR             08950015
089600                 MOVE RC012-REC-SEQ-NBR TO ASC-REC-SEQ-NBR        08960015
089700                                           DK-RCVR-SEQ-NBR        08970015
089800                 MOVE RC012-OPER-UNT-ID TO ASC-OPR-ID             08980015
089900                                           DK-OPR-ID              08990015
090000                 MOVE RC012-FCLTY-ID    TO ASC-FACT               09000015
090100                                           DK-FACT                09010015
090200             END-IF                                               09020015
090300                                                                  09030015
090400     END-EVALUATE.                                                09040015
090500                                                                  09050015
090600*----------------------------------------------------------------*09060015
090700*  ENTRY IS FROM A LIST. GET THE KEYS FROM THE TEMP STORAGE      *09070015
090800*  QUEUE PASSED FROM THE LIST.                                   *09080015
090900*----------------------------------------------------------------*09090015
091000                                                                  09100015
091100 1120-PREPARE-LIST-ENTRY.                                         09110015
091200      MOVE PC016-MAX-ITEMS         TO ASC-SEL-SUB.                09120015
091300      MOVE ZERO                    TO ASC-SEL-ITEM.               09130015
091400      PERFORM 2300-GET-NEXT-RECORD.                               09140015
091500                                                                  09150015
091600*----------------------------------------------------------------*09160015
091700*  ENTRY IS FROM PACK SLIP LIST. GET THE KEYS FROM THE TEMP      *09170015
091800*  STORAGE QUEUE PASSED FROM THE LIST.                           *09180015
091900*----------------------------------------------------------------*09190015
092000                                                                  09200015
092100 1130-PREPARE-PKSL-LIST-ENTRY.                                    09210015
092200                                                                  09220015
092300      MOVE RC013-MAX-ITEMS         TO ASC-SEL-SUB.                09230015
092400      MOVE ZERO                    TO ASC-SEL-ITEM.               09240015
092500      PERFORM 2400-GET-NEXT-PKSL-RECORD.                          09250015
092600                                                                  09260015
092700/                                                                 09270015
092800*----------------------------------------------------------------*09280015
092900* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *09290015
093000* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *09300015
093100* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *09310015
093200* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *09320015
093300* FUNCTION KEYS CAN GET THIS FAR.                                *09330015
093400*----------------------------------------------------------------*09340015
093500                                                                  09350015
093600 2000-PROCESS-PANEL.                                              09360015
093700     EVALUATE TRUE                                                09370015
093800         WHEN DP020-SRC-AID = DP016-CLEAR                         09380015
093900             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    09390015
094000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   09400015
094100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09410015
094200                                                                  09420015
094300         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    09430015
094400             PERFORM 2050-DELETE-LIST-QUEUE                       09440015
094500             PERFORM 4000-BUILD-INITIAL-PANEL                     09450015
094600                                                                  09460015
094700         WHEN DP020-FK-DESELECT (DP020-SRC-AID)                   09470015
094800             PERFORM 2140-DESELECT-ALL-ITEMS                      09480015
094900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09490015
095000                                                                  09500015
095100         WHEN DP020-FK-SELECT-ALL (DP020-SRC-AID)                 09510015
095200              PERFORM 2150-SELECT-ALL-ITEMS                       09520015
095300              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                09530015
095400                                                                  09540015
095500         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             09550015
095600             IF ASC-USE-SELECTION-QUEUE                           09560015
095700                 PERFORM 6200-DEL-LIST-QUEUE                      09570015
095800                 IF ASC-INTER-APPL-PKSL-LIST                      09580015
095900                     PERFORM 2400-GET-NEXT-PKSL-RECORD            09590015
096000                 ELSE                                             09600015
096100                     PERFORM 2300-GET-NEXT-RECORD                 09610015
096200                 END-IF                                           09620015
096300                 PERFORM 4000-BUILD-INITIAL-PANEL                 09630015
096400                 PERFORM 3200-RESET-ATTRIBUTES                    09640015
096500             ELSE                                                 09650015
096600*                --- BOTTOM OF LIST ---                           09660015
096700                 MOVE PC-TSYMSG-00070                             09670015
096800                                   TO DP020-MSG-NUMBER            09680015
096900                 SET DP020-MSG-INFORMATIONAL                      09690015
097000                                   TO TRUE                        09700015
097100             END-IF                                               09710015
097200                                                                  09720015
097300         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             09730015
097400             IF ASC-USE-SELECTION-QUEUE                           09740015
097500                 PERFORM 6200-DEL-LIST-QUEUE                      09750015
097600                 IF ASC-INTER-APPL-PKSL-LIST                      09760015
097700                     PERFORM 2410-GET-PREV-PKSL-RECORD            09770015
097800                 ELSE                                             09780015
097900                     PERFORM 2310-GET-PREV-RECORD                 09790015
098000                 END-IF                                           09800015
098100                 PERFORM 4000-BUILD-INITIAL-PANEL                 09810015
098200                 PERFORM 3200-RESET-ATTRIBUTES                    09820015
098300             ELSE                                                 09830015
098400*                --- TOP OF LIST ---                              09840015
098500                 MOVE PC-TSYMSG-00069                             09850015
098600                                   TO DP020-MSG-NUMBER            09860015
098700                 SET DP020-MSG-INFORMATIONAL                      09870015
098800                                   TO TRUE                        09880015
098900             END-IF                                               09890015
099000         WHEN OTHER                                               09900015
099100             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 09910015
099200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   09920015
099300             IF  PS-NO-ERROR                                      09930015
099400                 SET DP030-CONTINUE-GO TO TRUE                    09940015
099500                 PERFORM 2100-CHECK-FUNCTION-KEY                  09950015
099600             ELSE                                                 09960015
099700                 SET DP030-OVERRIDE-GO TO TRUE                    09970015
099800             END-IF                                               09980015
099900     END-EVALUATE.                                                09990015
100000                                                                  10000015
100100/                                                                 10010015
100200*----------------------------------------------------------------*10020015
100300*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *10030015
100400*----------------------------------------------------------------*10040015
100500 2050-DELETE-LIST-QUEUE.                                          10050015
100600                                                                  10060015
100700     EXEC CICS                                                    10070015
100800         DELETEQ TS                                               10080015
100900           QUEUE (ASC-LIST-QUEUE-NAME)                            10090015
101000            RESP (PV-CICS-RESP)                                   10100015
101100     END-EXEC.                                                    10110015
101200                                                                  10120015
101300     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       10130015
101400        (PV-CICS-RESP = DFHRESP(QIDERR))                          10140015
101500         CONTINUE                                                 10150015
101600     ELSE                                                         10160015
101700         SET DP013-CICS-ABEND      TO TRUE                        10170015
101800         SET DP013-NO-ROLLBACK     TO TRUE                        10180015
101900                                                                  10190015
102000         MOVE '2050-DELETE-LIST-QUEUE'                            10200015
102100                                   TO DP013-PARAGRAPH             10210015
102200         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    10220015
102300                                   TO DP013-MESSAGE-TEXT (1)      10230015
102400         PERFORM DP013-0000-PROCESS-ABEND                         10240015
102500     END-IF.                                                      10250015
102600                                                                  10260015
102700     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  10270015
102800                                                                  10280015
102900/                                                                 10290015
103000*----------------------------------------------------------------*10300015
103100* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*10310015
103200* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *10320015
103300* CICS ARCHITECTURE API.                                         *10330015
103400*----------------------------------------------------------------*10340015
103500 2100-CHECK-FUNCTION-KEY.                                         10350015
103600                                                                  10360015
103700     EVALUATE TRUE                                                10370015
103800         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              10380015
103900         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              10390015
104000         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              10400015
104100         WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)              10410015
104200         WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)              10420015
104300         WHEN DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)              10430015
104400         WHEN DP020-FK-LOCAL-FUNC-08 (DP020-SRC-AID)              10440015
104500         WHEN DP020-FK-LOCAL-FUNC-09 (DP020-SRC-AID)              10450015
104600             IF  ASC-NUMBER-OF-SELECTED-ITEMS = 0                 10460015
104700                 SET DP030-OVERRIDE-GO                            10470015
104800                                   TO TRUE                        10480015
104900                 MOVE PC-TSYMSG-00057                             10490015
105000                                   TO DP020-MSG-NUMBER            10500015
105100                 SET DP020-MSG-WARNING                            10510015
105200                                   TO TRUE                        10520015
105300             ELSE                                                 10530015
105400                 PERFORM 5000-PREPARE-SEL-QUEUE                   10540015
105500                 IF  PC000-NUMBER-OF-SELECTED-ITEMS = 0           10550015
105600                     IF PS-VERIFIED-RECEIVER                      10560015
105700                         SET DP030-OVERRIDE-GO                    10570015
105800                                           TO TRUE                10580015
105900                         MOVE PC-TSYMSG-00883                     10590015
106000                                           TO DP020-MSG-NUMBER    10600015
106100                         SET DP020-MSG-WARNING                    10610015
106200                                           TO TRUE                10620015
106300                     ELSE                                         10630015
106400                         SET DP030-OVERRIDE-GO                    10640015
106500                                           TO TRUE                10650015
106600                         MOVE PC-TSYMSG-00883                     10660015
106700                                           TO DP020-MSG-NUMBER    10670015
106800                         SET DP020-MSG-WARNING                    10680015
106900                                           TO TRUE                10690015
107000                 ELSE                                             10700015
107100                     PERFORM 7000-FORMAT-COMMAREA                 10710015
107200                 END-IF                                           10720015
107300             END-IF                                               10730015
107400                                                                  10740015
107500* FUNC-01 IS DELETE PROCESSING                                    10750015
107600         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              10760015
107700             IF  ASC-NUMBER-OF-SELECTED-ITEMS = 0                 10770015
107800                 SET DP030-OVERRIDE-GO                            10780015
107900                                   TO TRUE                        10790015
108000                 MOVE PC-TSYMSG-00057                             10800015
108100                                   TO DP020-MSG-NUMBER            10810015
108200                 SET DP020-MSG-WARNING                            10820015
108300                                   TO TRUE                        10830015
108400             ELSE                                                 10840015
108500                 SET ASC-DELETED-REQUESTED TO TRUE                10850015
108600                 MOVE PC-TSYMSG-00354                             10860015
108700                                   TO DP020-MSG-NUMBER            10870015
108800                 SET DP020-MSG-INFORMATIONAL                      10880015
108900                                   TO TRUE                        10890015
109000             END-IF                                               10900015
109100*                                                                 10910015
109200*    CONFIRM USED ONLY FOR DELETE FUNCTION.                       10920015
109300*                                                                 10930015
109400         WHEN DP020-FK-CONFIRM(DP020-SRC-AID)                     10940015
109500             IF ASC-DELETED-REQUESTED                             10950015
109600                 IF  ASC-NUMBER-OF-SELECTED-ITEMS = 0             10960015
109700                     SET DP030-OVERRIDE-GO                        10970015
109800                                       TO TRUE                    10980015
109900                     MOVE PC-TSYMSG-00057                         10990015
110000                                       TO DP020-MSG-NUMBER        11000015
110100                     SET DP020-MSG-WARNING                        11010015
110200                                       TO TRUE                    11020015
110300                 ELSE                                             11030015
110400                     PERFORM 5000-PREPARE-SEL-QUEUE               11040015
110500                     IF PS-NO-ERROR                               11050015
110600                         MOVE PC-TSYMSG-00115  TO DP020-MSG-NUMBER11060015
110700                         SET DP020-MSG-INFORMATIONAL              11070015
110800                                           TO TRUE                11080015
110900                     END-IF                                       11090015
111000                     PERFORM 2050-DELETE-LIST-QUEUE               11100015
111100                     PERFORM 4000-BUILD-INITIAL-PANEL             11110015
111200                 END-IF                                           11120015
111300             ELSE                                                 11130015
111400                 MOVE PC-TSYMSG-00118  TO DP020-MSG-NUMBER        11140015
111500                 SET DP020-MSG-INFORMATIONAL                      11150015
111600                                       TO TRUE                    11160015
111700             END-IF                                               11170015
111800                                                                  11180015
111900         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  11190015
112000             MOVE +1               TO PV-TOP-ITEM                 11200015
112100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11210015
112200             PERFORM 3200-RESET-ATTRIBUTES                        11220015
112300                                                                  11230015
112400         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   11240015
112500             PERFORM 2110-BROWSE-BACKWARD                         11250015
112600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11260015
112700             PERFORM 3200-RESET-ATTRIBUTES                        11270015
112800                                                                  11280015
112900         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   11290015
113000             PERFORM 2120-BROWSE-FORWARD                          11300015
113100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11310015
113200             PERFORM 3200-RESET-ATTRIBUTES                        11320015
113300                                                                  11330015
113400         WHEN DP020-SRC-AID = DP016-ENTER                         11340015
113500             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   11350015
113600             IF  PS-ERROR                                         11360015
113700                 CONTINUE                                         11370015
113800             ELSE                                                 11380015
113900                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11390015
114000             END-IF                                               11400015
114100                                                                  11410015
114200         WHEN OTHER                                               11420015
114300             PERFORM 2050-DELETE-LIST-QUEUE                       11430015
114400             PERFORM 4000-BUILD-INITIAL-PANEL                     11440015
114500             PERFORM 3200-RESET-ATTRIBUTES                        11450015
114600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11460015
114700     END-EVALUATE.                                                11470015
114800                                                                  11480015
114900/                                                                 11490015
115000*----------------------------------------------------------------*11500015
115100*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *11510015
115200*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *11520015
115300*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *11530015
115400*    MESSAGE.                                                    *11540015
115500*----------------------------------------------------------------*11550015
115600                                                                  11560015
115700 2110-BROWSE-BACKWARD.                                            11570015
115800                                                                  11580015
115900     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    11590015
116000         GIVING PV-TOP-ITEM.                                      11600015
116100                                                                  11610015
116200     IF  ((PV-TOP-ITEM < +1)                                      11620015
116300       OR (PV-TOP-ITEM = +1))                                     11630015
116400         MOVE +1                   TO PV-TOP-ITEM                 11640015
116500*        -- TOP OF LIST --                                        11650015
116600         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            11660015
116700         SET DP020-MSG-INFORMATIONAL                              11670015
116800                                   TO TRUE                        11680015
116900     END-IF.                                                      11690015
117000                                                                  11700015
117100/                                                                 11710015
117200*----------------------------------------------------------------*11720015
117300*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *11730015
117400*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *11740015
117500*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *11750015
117600*----------------------------------------------------------------*11760015
117700                                                                  11770015
117800 2120-BROWSE-FORWARD.                                             11780015
117900                                                                  11790015
118000     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              11800015
118100         GIVING PV-TOP-ITEM.                                      11810015
118200                                                                  11820015
118300     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   11830015
118400         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            11840015
118500                                   TO PV-TOP-ITEM                 11850015
118600*        -- BOTTOM OF LIST --                                     11860015
118700         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            11870015
118800         SET DP020-MSG-INFORMATIONAL                              11880015
118900                                   TO TRUE                        11890015
119000     ELSE                                                         11900015
119100         COMPUTE PV-BOTTOM-ITEM =                                 11910015
119200             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 11920015
119300         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            11930015
119400*            -- BOTTOM OF LIST --                                 11940015
119500             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            11950015
119600             SET DP020-MSG-INFORMATIONAL                          11960015
119700                                   TO TRUE                        11970015
119800         END-IF                                                   11980015
119900     END-IF.                                                      11990015
120000                                                                  12000015
120100/                                                                 12010015
120200*----------------------------------------------------------------*12020015
120300*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *12030015
120400*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *12040015
120500*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *12050015
120600*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *12060015
120700*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *12070015
120800*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *12080015
120900*----------------------------------------------------------------*12090015
121000                                                                  12100015
121100 2130-CHECK-FOR-JUMP-BROWSE.                                      12110015
121200                                                                  12120015
121300     SET PS-NO-ERROR               TO TRUE.                       12130015
121400     IF (ASC-START-ITEM-REQUEST = SPACE)                          12140015
121500         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            12150015
121600                                   TO PV-TOP-ITEM                 12160015
121700     ELSE                                                         12170015
121800         MOVE ASC-START-ITEM-REQUEST                              12180015
121900                                   TO DP010I-UNEDITED-FIELD       12190015
122000         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       12200015
122100         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     12210015
122200         SET DP010I-NEGATIVE-NOT-ALLOWED                          12220015
122300                                   TO TRUE                        12230015
122410         CALL DP010I-NUMERIC-EDIT-ROUTINE                         12241049
122420                         USING DP010I-NUMERIC-EDIT-AREA           12242049
122500                                                                  12250015
122600         IF  NOT DP010I-ERROR-DETECTED                            12260015
122700             MOVE DP010I-NUMERIC-FIELD                            12270015
122800                                   TO ASC-START-ITEM-REQUEST-N    12280015
122900             IF  ASC-START-ITEM-REQUEST-N > ZERO                  12290015
123000                 IF  ASC-START-ITEM-REQUEST-N >                   12300015
123100                                          ASC-NUMBER-OF-ITEMS-READ12310015
123200                     MOVE SPACE TO ASC-START-ITEM-REQUEST         12320015
123300                     COMPUTE PV-TOP-ITEM =                        12330015
123400                             ASC-NUMBER-OF-ITEMS-READ             12340015
123500                             - PC-ITEMS-PER-PANEL + 1             12350015
123600                     IF  PV-TOP-ITEM < +1                         12360015
123700                         MOVE +1   TO PV-TOP-ITEM                 12370015
123800                         MOVE PC-TSYMSG-00070                     12380015
123900                                   TO DP020-MSG-NUMBER            12390015
124000                         SET DP020-MSG-INFORMATIONAL              12400015
124100                                   TO TRUE                        12410015
124200                     END-IF                                       12420015
124300                 ELSE                                             12430015
124400                     MOVE ASC-START-ITEM-REQUEST-N                12440015
124500                                   TO PV-TOP-ITEM                 12450015
124600                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      12460015
124700                     COMPUTE PV-BOTTOM-ITEM =                     12470015
124800                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     12480015
124900                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ12490015
125000*                        -- BOTTOM OF LIST --                     12500015
125100                         MOVE PC-TSYMSG-00070                     12510015
125200                                   TO DP020-MSG-NUMBER            12520015
125300                         SET DP020-MSG-INFORMATIONAL              12530015
125400                                   TO TRUE                        12540015
125500                     END-IF                                       12550015
125600                 END-IF                                           12560015
125700             ELSE                                                 12570015
125800*                --- VALUE OUT OF RANGE ----                      12580015
125900                 MOVE PC-TSYMSG-00101                             12590015
126000                                   TO DP020-MSG-NUMBER            12600015
126100                 MOVE -1           TO ASTRTITL                    12610015
126200                 SET DP030-SET-CURSOR-APPL-1                      12620015
126300                                   TO TRUE                        12630015
126400                 MOVE DP015-REVERSE                               12640015
126500                                   TO ASTRTITH                    12650015
126600                 MOVE DP015-RED    TO ASTRTITC                    12660015
126700                 MOVE DP015-UNP-NUM-BRT-MDT                       12670015
126800                                   TO ASTRTITA                    12680015
126900                 SET DP020-MSG-FATAL                              12690015
127000                                   TO TRUE                        12700015
127100                 SET PS-ERROR      TO TRUE                        12710015
127200             END-IF                                               12720015
127300                                                                  12730015
127400         ELSE                                                     12740015
127500             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            12750015
127600             MOVE -1               TO ASTRTITL                    12760015
127700             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  12770015
127800             MOVE DP015-REVERSE    TO ASTRTITH                    12780015
127900             MOVE DP015-RED        TO ASTRTITC                    12790015
128000             MOVE DP015-UNP-NUM-BRT-MDT                           12800015
128100                                   TO ASTRTITA                    12810015
128200             SET DP020-MSG-FATAL   TO TRUE                        12820015
128300             SET PS-ERROR          TO TRUE                        12830015
128400         END-IF                                                   12840015
128500     END-IF.                                                      12850015
128600                                                                  12860015
128700/                                                                 12870015
128800*----------------------------------------------------------------*12880015
128900*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *12890015
129000*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *12900015
129100*----------------------------------------------------------------*12910015
129200 2140-DESELECT-ALL-ITEMS.                                         12920015
129300                                                                  12930015
129400     MOVE +1                       TO ASC-BLK-SUB.                12940015
129500                                                                  12950015
129600     PERFORM 2141-CLEAR-SELECTED-INDS                             12960015
129700         VARYING ASC-ITEM-SUB                                     12970015
129800         FROM 1 BY 1                                              12980015
129900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 12990015
130000                                                                  13000015
130100     ADD +1                        TO ASC-BLK-SUB.                13010015
130200                                                                  13020015
130300     PERFORM 2141-CLEAR-SELECTED-INDS                             13030015
130400         VARYING ASC-ITEM-SUB                                     13040015
130500         FROM 1 BY 1                                              13050015
130600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 13060015
130700                                                                  13070015
130800     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               13080015
130900                                   TO PV-LIST-ITEM-NUMBER.        13090015
131000                                                                  13100015
131100     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            13110015
131200         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    13120015
131300                                                                  13130015
131400     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     13140015
131500        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      13150015
131600         MOVE +1                   TO ASC-BLK-SUB                 13160015
131700                                                                  13170015
131800         PERFORM 5100-WRITE-TEMP-STORAGE                          13180015
131900                                                                  13190015
132000         MOVE +1                   TO PV-BLOCK-NUMBER             13200015
132100                                                                  13210015
132200         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         13220015
132300             PV-FIRST-BLOCK-IN-ARRAY - 1                          13230015
132400                                                                  13240015
132500         PERFORM                                                  13250015
132600             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       13260015
132700                                                                  13270015
132800             PERFORM 4410-READ-TEMP-STORAGE                       13280015
132900                                                                  13290015
133000             PERFORM 2141-CLEAR-SELECTED-INDS                     13300015
133100                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 13310015
133200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          13320015
133300                                                                  13330015
133400             PERFORM 5100-WRITE-TEMP-STORAGE                      13340015
133500                                                                  13350015
133600             ADD +1                TO PV-BLOCK-NUMBER             13360015
133700                                                                  13370015
133800         END-PERFORM                                              13380015
133900                                                                  13390015
134000         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         13400015
134100             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     13410015
134200                                                                  13420015
134300         PERFORM                                                  13430015
134400             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       13440015
134500                   ASC-HIGHEST-BLOCK-WRITTEN                      13450015
134600                                                                  13460015
134700             MOVE PV-NEXT-BLOCK-IN-ARRAY                          13470015
134800                                   TO PV-BLOCK-NUMBER             13480015
134900                                                                  13490015
135000             PERFORM 4410-READ-TEMP-STORAGE                       13500015
135100                                                                  13510015
135200             PERFORM 2141-CLEAR-SELECTED-INDS                     13520015
135300                 VARYING ASC-ITEM-SUB                             13530015
135400                 FROM 1 BY 1                                      13540015
135500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          13550015
135600                                                                  13560015
135700             PERFORM 5100-WRITE-TEMP-STORAGE                      13570015
135800                                                                  13580015
135900             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      13590015
136000                                                                  13600015
136100         END-PERFORM                                              13610015
136200                                                                  13620015
136300         MOVE PV-FIRST-BLOCK-IN-ARRAY                             13630015
136400                                   TO PV-BLOCK-NUMBER             13640015
136500                                                                  13650015
136600         PERFORM 4410-READ-TEMP-STORAGE                           13660015
136700     END-IF.                                                      13670015
136800                                                                  13680015
136900                                                                  13690015
137000     MOVE +0                       TO ASC-NUMBER-OF-SELECTED-ITEMS13700015
137100     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.13710015
137200     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  13720015
137300                                                                  13730015
137400     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        13740015
137500                                                                  13750015
137600/                                                                 13760015
137700*----------------------------------------------------------------*13770015
137800*    MARK EACH ITEM AS BEING NOT SELECTED.                       *13780015
137900*----------------------------------------------------------------*13790015
138000                                                                  13800015
138100 2141-CLEAR-SELECTED-INDS.                                        13810015
138200                                                                  13820015
138300     IF  ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)          13830015
138400             NOT EQUAL ZERO                                       13840015
138500         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          13850015
138600             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          13860015
138700                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    13870015
138800                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  13880015
138900                                   TO TRUE                        13890015
139000         END-IF                                                   13900015
139100     END-IF.                                                      13910015
139200                                                                  13920015
139300/                                                                 13930015
139400*----------------------------------------------------------------*13940015
139500*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *13950015
139600*  FOR ALL ITEMS.                                                *13960015
139700*----------------------------------------------------------------*13970015
139800                                                                  13980015
139900 2150-SELECT-ALL-ITEMS.                                           13990015
140000                                                                  14000015
140100     MOVE +1                       TO ASC-BLK-SUB.                14010015
140200                                                                  14020015
140300     PERFORM 2151-SET-SELECTED-INDS                               14030015
140400         VARYING ASC-ITEM-SUB                                     14040015
140500         FROM 1 BY 1                                              14050015
140600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 14060015
140700                                                                  14070015
140800     ADD +1                        TO ASC-BLK-SUB.                14080015
140900                                                                  14090015
141000     PERFORM 2151-SET-SELECTED-INDS                               14100015
141100         VARYING ASC-ITEM-SUB                                     14110015
141200         FROM 1 BY 1                                              14120015
141300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 14130015
141400                                                                  14140015
141500     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               14150015
141600                                   TO PV-LIST-ITEM-NUMBER.        14160015
141700                                                                  14170015
141800     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            14180015
141900         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    14190015
142000                                                                  14200015
142100     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     14210015
142200        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    14220015
142300         MOVE +1                   TO ASC-BLK-SUB                 14230015
142400                                                                  14240015
142500         PERFORM 5100-WRITE-TEMP-STORAGE                          14250015
142600                                                                  14260015
142700         MOVE +1                   TO PV-BLOCK-NUMBER             14270015
142800                                                                  14280015
142900         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         14290015
143000             PV-FIRST-BLOCK-IN-ARRAY - 1                          14300015
143100                                                                  14310015
143200         PERFORM                                                  14320015
143300             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       14330015
143400                                                                  14340015
143500             PERFORM 4410-READ-TEMP-STORAGE                       14350015
143600                                                                  14360015
143700             PERFORM 2151-SET-SELECTED-INDS                       14370015
143800                 VARYING ASC-ITEM-SUB                             14380015
143900                 FROM 1 BY 1                                      14390015
144000                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          14400015
144100                                                                  14410015
144200             PERFORM 5100-WRITE-TEMP-STORAGE                      14420015
144300                                                                  14430015
144400             ADD +1                TO PV-BLOCK-NUMBER             14440015
144500         END-PERFORM                                              14450015
144600                                                                  14460015
144700         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         14470015
144800             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     14480015
144900                                                                  14490015
145000         PERFORM                                                  14500015
145100             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       14510015
145200                   ASC-HIGHEST-BLOCK-WRITTEN                      14520015
145300                                                                  14530015
145400             MOVE PV-NEXT-BLOCK-IN-ARRAY                          14540015
145500                                   TO PV-BLOCK-NUMBER             14550015
145600                                                                  14560015
145700             PERFORM 4410-READ-TEMP-STORAGE                       14570015
145800                                                                  14580015
145900             PERFORM 2151-SET-SELECTED-INDS                       14590015
146000                 VARYING ASC-ITEM-SUB                             14600015
146100                 FROM 1 BY 1                                      14610015
146200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          14620015
146300                                                                  14630015
146400             PERFORM 5100-WRITE-TEMP-STORAGE                      14640015
146500                                                                  14650015
146600             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      14660015
146700         END-PERFORM                                              14670015
146800                                                                  14680015
146900         MOVE PV-FIRST-BLOCK-IN-ARRAY                             14690015
147000                                   TO PV-BLOCK-NUMBER             14700015
147100                                                                  14710015
147200         PERFORM 4410-READ-TEMP-STORAGE                           14720015
147300     END-IF.                                                      14730015
147400                                                                  14740015
147500     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             14750015
147600          ASC-NUMBER-OF-SELECTED-ITEMS.                           14760015
147700                                                                  14770015
147800     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        14780015
147900                                                                  14790015
148000/                                                                 14800015
148100*----------------------------------------------------------------*14810015
148200*    MARK EACH ITEM AS BEING SELECTED.                           *14820015
148300*----------------------------------------------------------------*14830015
148400                                                                  14840015
148500 2151-SET-SELECTED-INDS.                                          14850015
148600                                                                  14860015
148700     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           14870015
148800             NOT EQUAL ZERO                                       14880015
148900         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             14890015
149000             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             14900015
149100                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        14910015
149200                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  14920015
149300                                   TO TRUE                        14930015
149400         END-IF                                                   14940015
149500     END-IF.                                                      14950015
149600                                                                  14960015
149700/                                                                 14970015
149800*----------------------------------------------------------------*14980015
149900*  MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE     *14990015
150000*  SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM.  *15000015
150100*----------------------------------------------------------------*15010015
150200 2200-MOVE-SCREEN-TO-COMMAREA.                                    15020015
150300                                                                  15030015
150400     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             15040015
150500     MOVE +1                       TO PV-SUB.                     15050015
150600                                                                  15060015
150700     PERFORM 3100-SET-SUBSCRIPTS.                                 15070015
150800                                                                  15080015
150900     IF  ASTRTITL > ZERO                                          15090015
151000         MOVE ASTRTITI             TO ASC-START-ITEM-REQUEST      15100015
151100     ELSE                                                         15110015
151200         IF  ASTRTITF = DP015-ERASE-EOF                           15120015
151300             INITIALIZE ASC-START-ITEM-REQUEST                    15130015
151400         END-IF                                                   15140015
151500     END-IF.                                                      15150015
151600                                                                  15160015
151700     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          15170015
151800         VARYING PV-SUB                                           15180015
151900         FROM 1 BY 1                                              15190015
152000         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      15200015
152100                                                                  15210015
152200/                                                                 15220015
152300*----------------------------------------------------------------*15230015
152400*  MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA *15240015
152500*----------------------------------------------------------------*15250015
152600 2210-MOVE-LINES-TO-COMMAREA.                                     15260015
152700                                                                  15270015
152800     IF  MR-SELECTL (PV-SUB) > ZERO                               15280015
152900         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     15290015
153000                                   TO TRUE                        15300015
153100         MOVE MR-SELECT (PV-SUB)   TO ASC-TEMP-SELECTED-SW        15310015
153200                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      15320015
153300     ELSE                                                         15330015
153400         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                15340015
153500             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE         15350015
153600             MOVE SPACE            TO ASC-TEMP-SELECTED-SW        15360015
153700                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      15370015
153800         END-IF                                                   15380015
153900     END-IF.                                                      15390015
154000                                                                  15400015
154100     ADD +1                        TO ASC-ITEM-SUB.               15410015
154200                                                                  15420015
154300     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        15430015
154400         ADD +1                    TO ASC-BLK-SUB                 15440015
154500         MOVE +1                   TO ASC-ITEM-SUB                15450015
154600     END-IF.                                                      15460015
154700                                                                  15470015
154800/                                                                 15480015
154900******************************************************************15490015
155000* GET THE KEYS OF THE NEXT SELECTED OBJECT FROM THE              *15500015
155100* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *15510015
155200******************************************************************15520015
155300 2300-GET-NEXT-RECORD.                                            15530015
155400                                                                  15540015
155500     ADD +1                        TO ASC-SEL-SUB.                15550015
155600     IF ASC-SEL-SUB > PC016-MAX-ITEMS                             15560015
155700         ADD +1                    TO ASC-SEL-ITEM                15570015
155800         MOVE +1                   TO ASC-SEL-SUB                 15580015
155900     END-IF.                                                      15590015
156000     IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                 15600015
156100         PERFORM 9100-READ-SEL-QUEUE                              15610015
156200         IF PC016-ITEM (ASC-SEL-SUB) > ZERO                       15620015
156300             INITIALIZE ASC-LIST-KEYS                             15630015
156400             MOVE PC016-PO-NBR-N(ASC-SEL-SUB)      TO ASC-PO-NBR  15640015
156500                                                      DK-ORD-NBR  15650015
156600             MOVE PC016-REC-SEQ-NBR-N(ASC-SEL-SUB) TO             15660015
156700                  ASC-REC-SEQ-NBR                                 15670015
156800                  DK-RCVR-SEQ-NBR                                 15680015
156900             MOVE PC016-OPER-UNT-ID  (ASC-SEL-SUB) TO             15690015
157000                  ASC-OPR-ID                                      15700015
157100                  DK-OPR-ID                                       15710015
157200             MOVE PC016-FCLTY-ID     (ASC-SEL-SUB) TO             15720015
157300                  ASC-FACT                                        15730015
157400                  DK-FACT                                         15740015
157500             SET PC016-INQ (ASC-SEL-SUB)           TO TRUE        15750015
157600             PERFORM 9200-REWRITE-LIST-QUEUE                      15760015
157700         ELSE                                                     15770015
157800             SUBTRACT +1 FROM ASC-SEL-SUB                         15780015
157900*            --- BOTTOM OF LIST ---                               15790015
158000             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            15800015
158100             SET DP020-MSG-INFORMATIONAL                          15810015
158200                                   TO TRUE                        15820015
158300         END-IF                                                   15830015
158400     ELSE                                                         15840015
158500         SUBTRACT +1 FROM ASC-SEL-ITEM                            15850015
158600         MOVE PC016-MAX-ITEMS      TO ASC-SEL-SUB                 15860015
158700         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            15870015
158800         SET DP020-MSG-INFORMATIONAL                              15880015
158900                                   TO TRUE                        15890015
159000     END-IF.                                                      15900015
159100                                                                  15910015
159200/                                                                 15920015
159300******************************************************************15930015
159400* GET THE KEYS OF THE PREVIOUS SELECTED OBJECT FROM THE          *15940015
159500* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *15950015
159600******************************************************************15960015
159700 2310-GET-PREV-RECORD.                                            15970015
159800                                                                  15980015
159900     SUBTRACT +1 FROM ASC-SEL-SUB.                                15990015
160000     IF ASC-SEL-SUB < +1                                          16000015
160100         SUBTRACT +1 FROM ASC-SEL-ITEM                            16010015
160200         MOVE PC016-MAX-ITEMS      TO ASC-SEL-SUB                 16020015
160300     END-IF.                                                      16030015
160400                                                                  16040015
160500     IF ASC-SEL-ITEM > ZERO                                       16050015
160600         PERFORM 9100-READ-SEL-QUEUE                              16060015
160700         INITIALIZE ASC-LIST-KEYS                                 16070015
160800         MOVE PC016-PO-NBR-N(ASC-SEL-SUB)      TO ASC-PO-NBR      16080015
160900         MOVE PC016-REC-SEQ-NBR-N(ASC-SEL-SUB) TO                 16090015
161000              ASC-REC-SEQ-NBR                                     16100015
161100         MOVE PC016-OPER-UNT-ID  (ASC-SEL-SUB) TO ASC-OPR-ID      16110015
161200                                                  DK-OPR-ID       16120015
161300         MOVE PC016-FCLTY-ID     (ASC-SEL-SUB) TO ASC-FACT        16130015
161400                                                  DK-FACT         16140015
161500     ELSE                                                         16150015
161600         MOVE +1                   TO ASC-SEL-ITEM                16160015
161700                                      ASC-SEL-SUB                 16170015
161800*        --- TOP OF LIST ---                                      16180015
161900         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            16190015
162000         SET DP020-MSG-INFORMATIONAL                              16200015
162100                                   TO TRUE                        16210015
162200     END-IF.                                                      16220015
162300                                                                  16230015
162400/                                                                 16240015
162500******************************************************************16250015
162600* GET THE KEYS OF THE NEXT SELECTED PACKSLIP OBJECT FROM THE     *16260015
162700* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *16270015
162800******************************************************************16280015
162900 2400-GET-NEXT-PKSL-RECORD.                                       16290015
163000                                                                  16300015
163100     ADD +1                        TO ASC-SEL-SUB.                16310015
163200     IF ASC-SEL-SUB > RC013-MAX-ITEMS                             16320015
163300         ADD +1                    TO ASC-SEL-ITEM                16330015
163400         MOVE +1                   TO ASC-SEL-SUB                 16340015
163500     END-IF.                                                      16350015
163600     IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                 16360015
163700         PERFORM 9300-READ-PKSL-SEL-QUEUE                         16370015
163800         IF RC013-ITEM (ASC-SEL-SUB) > ZERO                       16380015
163900             INITIALIZE ASC-LIST-KEYS                             16390015
164000             MOVE RC015-PO-NBR                     TO ASC-PO-NBR  16400015
164100                                                      DK-ORD-NBR  16410015
164200             MOVE RC013-REC-SEQ-NBR  (ASC-SEL-SUB) TO             16420015
164300                  ASC-REC-SEQ-NBR                                 16430015
164400                  DK-RCVR-SEQ-NBR                                 16440015
164500             MOVE RC015-OPER-UNT-ID                TO             16450015
164600                  ASC-OPR-ID                                      16460015
164700                  DK-OPR-ID                                       16470015
164800             MOVE RC015-FCLTY-ID                   TO             16480015
164900                  ASC-FACT                                        16490015
165000                  DK-FACT                                         16500015
165100             SET RC013-INQ (ASC-SEL-SUB)           TO TRUE        16510015
165200             PERFORM 9400-REWRITE-PKSL-LIST-QUEUE                 16520015
165300         ELSE                                                     16530015
165400             SUBTRACT +1 FROM ASC-SEL-SUB                         16540015
165500*            --- BOTTOM OF LIST ---                               16550015
165600             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            16560015
165700             SET DP020-MSG-INFORMATIONAL                          16570015
165800                                   TO TRUE                        16580015
165900         END-IF                                                   16590015
166000     ELSE                                                         16600015
166100         SUBTRACT +1 FROM ASC-SEL-ITEM                            16610015
166200         MOVE RC013-MAX-ITEMS      TO ASC-SEL-SUB                 16620015
166300         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            16630015
166400         SET DP020-MSG-INFORMATIONAL                              16640015
166500                                   TO TRUE                        16650015
166600     END-IF.                                                      16660015
166700                                                                  16670015
166800/                                                                 16680015
166900******************************************************************16690015
167000* GET THE KEYS OF THE PREVIOUS SELECTED PACK SLIP OBJECT FROM THE*16700015
167100* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *16710015
167200******************************************************************16720015
167300 2410-GET-PREV-PKSL-RECORD.                                       16730015
167400                                                                  16740015
167500     SUBTRACT +1 FROM ASC-SEL-SUB.                                16750015
167600     IF ASC-SEL-SUB < +1                                          16760015
167700         SUBTRACT +1 FROM ASC-SEL-ITEM                            16770015
167800         MOVE RC013-MAX-ITEMS      TO ASC-SEL-SUB                 16780015
167900     END-IF.                                                      16790015
168000                                                                  16800015
168100     IF ASC-SEL-ITEM > ZERO                                       16810015
168200         PERFORM 9300-READ-PKSL-SEL-QUEUE                         16820015
168300         INITIALIZE ASC-LIST-KEYS                                 16830015
168400         MOVE RC015-PO-NBR                     TO ASC-PO-NBR      16840015
168500         MOVE RC013-REC-SEQ-NBR  (ASC-SEL-SUB) TO                 16850015
168600              ASC-REC-SEQ-NBR                                     16860015
168700         MOVE RC015-OPER-UNT-ID                TO ASC-OPR-ID      16870015
168800                                                  DK-OPR-ID       16880015
168900         MOVE RC015-FCLTY-ID                   TO ASC-FACT        16890015
169000                                                  DK-FACT         16900015
169100     ELSE                                                         16910015
169200         MOVE +1                   TO ASC-SEL-ITEM                16920015
169300                                      ASC-SEL-SUB                 16930015
169400*        --- TOP OF LIST ---                                      16940015
169500         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            16950015
169600         SET DP020-MSG-INFORMATIONAL                              16960015
169700                                   TO TRUE                        16970015
169800     END-IF.                                                      16980015
169900                                                                  16990015
170000/                                                                 17000015
170100*----------------------------------------------------------------*17010015
170200*  EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE       *17020015
170300*  COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY).  *17030015
170400*----------------------------------------------------------------*17040015
170500 3000-EDIT-DATA-IN-COMMAREA.                                      17050015
170600                                                                  17060015
170700     SET PS-NO-ERROR               TO TRUE.                       17070015
170800                                                                  17080015
170900     PERFORM 3200-RESET-ATTRIBUTES.                               17090015
171000                                                                  17100015
171100     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     17110015
171200**                                                                17120015
171300* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              17130015
171400* EDITTING IS DONE FROM THE BOTTOM UP.                            17140015
171500**                                                                17150015
171600     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       17160015
171700         ASC-ITEMS-DISPLAYED - 1.                                 17170015
171800                                                                  17180015
171900     PERFORM 3100-SET-SUBSCRIPTS.                                 17190015
172000     PERFORM 3300-EDIT-SELECTIONS                                 17200015
172100         VARYING PV-SUB                                           17210015
172200         FROM PV-SUB BY -1                                        17220015
172300         UNTIL PV-SUB < +1.                                       17230015
172400                                                                  17240015
172500/                                                                 17250015
172600*----------------------------------------------------------------*17260015
172700*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *17270015
172800*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*17280015
172900*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *17290015
173000*                                                                *17300015
173100*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *17310015
173200*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *17320015
173300*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *17330015
173400*    US IN THE 2ND BLOCK OF THE ARRAY.                           *17340015
173500*----------------------------------------------------------------*17350015
173600                                                                  17360015
173700 3100-SET-SUBSCRIPTS.                                             17370015
173800                                                                  17380015
173900     COMPUTE ASC-ITEM-SUB =                                       17390015
174000         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        17400015
174100                                                                  17410015
174200     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         17420015
174300         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            17430015
174400                                                                  17440015
174500         MOVE PC-MAX-BLOCKS-IN-ARRAY                              17450015
174600                                   TO ASC-BLK-SUB                 17460015
174700     ELSE                                                         17470015
174800         MOVE +1                   TO ASC-BLK-SUB                 17480015
174900     END-IF.                                                      17490015
175000                                                                  17500015
175100*----------------------------------------------------------------*17510015
175200*  RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.      *17520015
175300*----------------------------------------------------------------*17530015
175400                                                                  17540015
175500 3200-RESET-ATTRIBUTES.                                           17550015
175600                                                                  17560015
175700     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   17570015
175800     MOVE DP015-GREEN              TO ASTRTITC.                   17580015
175900     MOVE DP015-UNDERLINE          TO ASTRTITH.                   17590015
176000                                                                  17600015
176100     IF DP020-NEXT-ACT-RETURN                                     17610015
176200     OR DP020-NEXT-ACT-READ-MAP                                   17620015
176300        PERFORM                                                   17630015
176400            VARYING PV-SUB                                        17640015
176500            FROM 1 BY 1                                           17650015
176600            UNTIL PV-SUB > ASC-ITEMS-DISPLAYED                    17660015
176700            MOVE DP015-UNP-ALP-NOR-OFF                            17670015
176800                                      TO MR-SELECTA (PV-SUB)      17680015
176900            MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)      17690015
177000            MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)      17700015
177100        END-PERFORM                                               17710015
177200     ELSE                                                         17720015
177300        PERFORM                                                   17730015
177400            VARYING PV-SUB                                        17740015
177500            FROM 1 BY 1                                           17750015
177600            UNTIL PV-SUB > PC-ITEMS-PER-PANEL                     17760015
177700            MOVE DP015-UNP-ALP-NOR-OFF                            17770015
177800                                      TO MR-SELECTA (PV-SUB)      17780015
177900            MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)      17790015
178000            MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)      17800015
178100        END-PERFORM                                               17810015
178200     END-IF.                                                      17820015
178300                                                                  17830015
178400/                                                                 17840015
178500*----------------------------------------------------------------*17850015
178600*  EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS     *17860015
178700*  WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'    *17870015
178800*  IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR     *17880015
178900*  WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.              *17890015
179000*----------------------------------------------------------------*17900015
179100 3300-EDIT-SELECTIONS.                                            17910015
179200                                                                  17920015
179300     EVALUATE TRUE                                                17930015
179400         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     17940015
179500             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         17950015
179600                 CONTINUE                                         17960015
179700                                                                  17970015
179800         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         17980015
179900             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        17990015
180000                 ADD +1            TO ASC-NUMBER-OF-SELECTED-ITEMS18000015
180100                 MOVE ASC-TEMP-SELECTED-SW                        18010015
180200                                     (ASC-BLK-SUB ASC-ITEM-SUB)   18020015
180300                                   TO ASC-SELECTED-SW             18030015
180400                                     (ASC-BLK-SUB ASC-ITEM-SUB)   18040015
180500             END-IF                                               18050015
180600                                                                  18060015
180700         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     18070015
180800                 = SPACE                                          18080015
180900             EVALUATE TRUE                                        18090015
181000                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       18100015
181100                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS18110015
181200                     MOVE SPACE    TO ASC-SELECTED-SW             18120015
181300                                     (ASC-BLK-SUB ASC-ITEM-SUB)   18130015
181400                                                                  18140015
181500                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        18150015
181600                     MOVE ZERO     TO ASC-START-OF-SELECTED-RANGE 18160015
181700                     MOVE SPACE    TO ASC-SELECTED-SW             18170015
181800                                     (ASC-BLK-SUB ASC-ITEM-SUB)   18180015
181900                                                                  18190015
182000                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          18200015
182100                     MOVE ZERO     TO ASC-END-OF-SELECTED-RANGE   18210015
182200                     MOVE SPACE    TO ASC-SELECTED-SW             18220015
182300                                     (ASC-BLK-SUB ASC-ITEM-SUB)   18230015
182400             END-EVALUATE                                         18240015
182500                                                                  18250015
182600         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           18260015
182700             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            18270015
182800                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    18280015
182900             END-IF                                               18290015
183000             PERFORM 3310-EDIT-RANGE                              18300015
183100                                                                  18310015
183200         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             18320015
183300             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            18330015
183400                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    18340015
183500             END-IF                                               18350015
183600             PERFORM 3310-EDIT-RANGE                              18360015
183700                                                                  18370015
183800         WHEN OTHER                                               18380015
183900             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            18390015
184000             SET DP020-MSG-FATAL   TO TRUE                        18400015
184100             MOVE -1               TO MR-SELECTL (PV-SUB)         18410015
184200             SET DP030-SET-CURSOR-APPL-1                          18420015
184300                                   TO TRUE                        18430015
184400             MOVE DP015-RED        TO MR-SELECTC (PV-SUB)         18440015
184500             MOVE DP015-REVERSE    TO MR-SELECTH (PV-SUB)         18450015
184600             SET PS-ERROR          TO TRUE                        18460015
184700             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            18470015
184800                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     18480015
184900                 MOVE SPACE        TO ASC-SELECTED-SW             18490015
185000                                     (ASC-BLK-SUB ASC-ITEM-SUB)   18500015
185100             END-IF                                               18510015
185200     END-EVALUATE.                                                18520015
185300                                                                  18530015
185400     SUBTRACT +1 FROM PV-ITEM-IN-USE.                             18540015
185500     SUBTRACT +1 FROM ASC-ITEM-SUB.                               18550015
185600                                                                  18560015
185700     IF  ASC-ITEM-SUB < 1                                         18570015
185800         SUBTRACT +1 FROM ASC-BLK-SUB                             18580015
185900         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                18590015
186000     END-IF.                                                      18600015
186100                                                                  18610015
186200*----------------------------------------------------------------*18620015
186300*  IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A       *18630015
186400*  RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1     *18640015
186500*  ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) *18650015
186600*  THE ENDING.                                                   *18660015
186700*----------------------------------------------------------------*18670015
186800 3310-EDIT-RANGE.                                                 18680015
186900                                                                  18690015
187000     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                18700015
187100         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   18710015
187200             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)18720015
187300                                   TO ASC-SELECTED-SW             18730015
187400                                        (ASC-BLK-SUB ASC-ITEM-SUB)18740015
187500             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 18750015
187600         ELSE                                                     18760015
187700             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     18770015
187800                 CONTINUE                                         18780015
187900             ELSE                                                 18790015
188000*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        18800015
188100                 MOVE PC-TSYMSG-00054                             18810015
188200                                   TO DP020-MSG-NUMBER            18820015
188300                 SET DP020-MSG-FATAL                              18830015
188400                                   TO TRUE                        18840015
188500                 MOVE -1           TO MR-SELECTL (PV-SUB)         18850015
188600                 SET DP030-SET-CURSOR-APPL-1                      18860015
188700                                   TO TRUE                        18870015
188800                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         18880015
188900                 MOVE DP015-UNDERLINE                             18890015
189000                                   TO MR-SELECTH (PV-SUB)         18900015
189100                 SET PS-ERROR      TO TRUE                        18910015
189200             END-IF                                               18920015
189300         END-IF                                                   18930015
189400     ELSE                                                         18940015
189500         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     18950015
189600             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 18960015
189700                                   TO ASC-SELECTED-SW             18970015
189800                                     (ASC-BLK-SUB ASC-ITEM-SUB)   18980015
189900             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   18990015
190000         ELSE                                                     19000015
190100             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       19010015
190200                 CONTINUE                                         19020015
190300             ELSE                                                 19030015
190400*                -- ONLY ONE END-OF-RANGE ALLOWED --              19040015
190500                 MOVE PC-TSYMSG-00055                             19050015
190600                                   TO DP020-MSG-NUMBER            19060015
190700                 SET DP020-MSG-FATAL                              19070015
190800                                   TO TRUE                        19080015
190900                 MOVE -1           TO MR-SELECTL (PV-SUB)         19090015
191000                 SET DP030-SET-CURSOR-APPL-1                      19100015
191100                                   TO TRUE                        19110015
191200                 SET PS-ERROR      TO TRUE                        19120015
191300             END-IF                                               19130015
191400         END-IF                                                   19140015
191500     END-IF.                                                      19150015
191600                                                                  19160015
191700/                                                                 19170015
191800*----------------------------------------------------------------*19180015
191900*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *19190015
192000*    INITIALIZE ALL COUNTERS AND FLAGS.                          *19200015
192100*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *19210015
192200*    DISPLAY THE PANEL TO USER.                                  *19220015
192300*----------------------------------------------------------------*19230015
192400                                                                  19240015
192500 4000-BUILD-INITIAL-PANEL.                                        19250015
192600                                                                  19260015
192700     INITIALIZE ASC-BLOCK-ENTRIES (1)                             19270015
192800                ASC-BLOCK-ENTRIES (2).                            19280015
192900                                                                  19290015
193000     MOVE +1                       TO ASC-BLK-SUB.                19300015
193100                                                                  19310015
193200     SET ASC-ITEMS-LEFT-ON-DB      TO TRUE.                       19320015
193300                                                                  19330015
193400     MOVE +0                       TO ASC-ITEM-SUB                19340015
193500                                      ASC-NUMBER-OF-ITEMS-READ    19350015
193600                                      ASC-NUMBER-OF-SELECTED-ITEMS19360015
193700                                      ASC-HIGHEST-BLOCK-WRITTEN   19370015
193800                                      ASC-START-OF-SELECTED-RANGE 19380015
193900                                      ASC-END-OF-SELECTED-RANGE   19390015
194000                                      ASC-ITEM-AT-TOP-OF-PANEL.   19400015
194100     PERFORM 4100-PREPARE-CURSOR.                                 19410015
194200     PERFORM 4355-GET-TRECEIV-INFO.                               19420015
194300     EVALUATE TRUE                                                19430015
194400         WHEN SQLCODE = +100                                      19440015
194500              CONTINUE                                            19450015
194600         WHEN SQLCODE = +0                                        19460015
194700              PERFORM 4360-GET-TPURCHS-INFO                       19470015
194800              EVALUATE TRUE                                       19480015
194900                  WHEN SQLCODE = +100                             19490015
195000                       CONTINUE                                   19500015
195100                  WHEN SQLCODE = +0                               19510015
195200                       MOVE RECEIV-STATUS-CDE                     19520015
195300                               TO ASC-STAT                        19530015
195400                       MOVE RECEIV-EXPTED-CART-CNT                19540015
195500                               TO ASC-TRECEIV-EXPTED-CART-CNT     19550015
195600                       MOVE RECEIV-ACTL-CART-CNT                  19560015
195700                               TO ASC-TRECEIV-ACTL-CART-CNT       19570015
195710                       MOVE PURCHS-DEPT-NBR                       19571037
195720                               TO ASC-TPURCHS-DEPT-NBR            19572037
195800                       PERFORM 4200-TROUBLE-DESC                  19580015
195900                       PERFORM 4100-PREPARE-CURSOR                19590015
196000                       PERFORM 4200-CALC-OPEN-TO-REC              19600015
196100                       PERFORM 4010-OPEN-CURSOR                   19610015
196200                       PERFORM 4300-READ-ITEMS-FROM-DB            19620015
196300                       PERFORM 4020-CLOSE-CURSOR                  19630015
196400              END-EVALUATE                                        19640015
196500     END-EVALUATE.                                                19650015
196600                                                                  19660015
196700     MOVE +1                       TO PV-TOP-ITEM.                19670015
196800                                                                  19680015
196900     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          19690015
197000         SET DP020-NEXT-ACT-APPL-ERROR                            19700015
197100                                   TO TRUE                        19710015
197200         SET DP020-MSG-FATAL       TO TRUE                        19720015
197300         MOVE PC-TSYMSG-00050      TO DP020-MSG-NUMBER            19730015
197400     ELSE                                                         19740015
197500         MOVE -1                   TO MR-SELECTL (1)              19750015
197600         SET DP030-SET-CURSOR-APPL-1                              19760015
197700                                   TO TRUE                        19770015
197800         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     19780015
197900     END-IF.                                                      19790015
198000                                                                  19800015
198100/                                                                 19810015
198200*----------------------------------------------------------------*19820015
198300* OPEN THE SHIPMENT CURSOR                                       *19830015
198400*----------------------------------------------------------------*19840015
198500                                                                  19850015
198600 4010-OPEN-CURSOR.                                                19860015
198700                                                                  19870015
198800                                                                  19880015
198900         EXEC SQL                                                 19890015
199000             OPEN TRECITM1-CSR                                    19900046
199100         END-EXEC                                                 19910015
199200                                                                  19920015
199300                                                                  19930015
199400         EVALUATE TRUE                                            19940015
199500             WHEN SQLCODE = +0                                    19950015
199600                  CONTINUE                                        19960015
199700             WHEN SQLCODE = -904                                  19970015
199800             WHEN SQLCODE = -911                                  19980015
199900             WHEN SQLCODE = -913                                  19990015
200000                  PERFORM 9900-SOFT-ABORT                         20000015
200100             WHEN SQLWARN0 NOT = SPACE                            20010015
200200             WHEN SQLCODE  NOT = +0                               20020015
200300                  MOVE '4010-OPEN-CURSOR'                         20030015
200400                                   TO DP013-PARAGRAPH             20040015
200500                  MOVE 'OPEN CURSOR'                              20050015
200600                                   TO DP013-MESSAGE-TEXT (1)      20060015
200700                  MOVE SQLCA       TO DP013-SQLCA                 20070015
200800                  MOVE 'TPURITM'   TO DP013-DB2-TABLE-NAME (1)    20080015
200900                  SET DP013-DB2-ABEND                             20090015
201000                                   TO TRUE                        20100015
201100                  PERFORM DP013-0000-PROCESS-ABEND                20110015
201200         END-EVALUATE.                                            20120015
201300/                                                                 20130015
201400*----------------------------------------------------------------*20140015
201500* CLOSE THE SHIPMENT CURSOR                                      *20150015
201600*----------------------------------------------------------------*20160015
201700                                                                  20170015
201800 4020-CLOSE-CURSOR.                                               20180015
201900                                                                  20190015
202000     EXEC SQL                                                     20200015
202100          CLOSE TRECITM1-CSR                                      20210046
202200     END-EXEC.                                                    20220015
202300                                                                  20230015
202400     EVALUATE TRUE                                                20240015
202500         WHEN SQLCODE = +0                                        20250015
202600              CONTINUE                                            20260015
202700         WHEN SQLCODE = -904                                      20270015
202800         WHEN SQLCODE = -911                                      20280015
202900         WHEN SQLCODE = -913                                      20290015
203000              PERFORM 9900-SOFT-ABORT                             20300015
203100         WHEN SQLWARN0 NOT = SPACE                                20310015
203200         WHEN SQLCODE  NOT = +0                                   20320015
203300              MOVE '4020-CLOSE-CURSOR'                            20330015
203400                                   TO DP013-PARAGRAPH             20340015
203500              MOVE 'CLOSE CURSOR'  TO DP013-MESSAGE-TEXT (1)      20350015
203600              MOVE SQLCA           TO DP013-SQLCA                 20360015
203700              MOVE 'TPURITM'       TO DP013-DB2-TABLE-NAME (1)    20370015
203800              SET DP013-DB2-ABEND  TO TRUE                        20380015
203900              PERFORM DP013-0000-PROCESS-ABEND                    20390015
204000     END-EVALUATE.                                                20400015
204100                                                                  20410015
204200/                                                                 20420015
204300*----------------------------------------------------------------*20430015
204400*    DEPENDING ON WHAT WAS PASSED IN THE COMMAREA, SETUP THE     *20440015
204500*    DB2 KEYS IN PREPARATION FOR THE OPEN CURSROR.               *20450015
204600*----------------------------------------------------------------*20460015
204700                                                                  20470015
204800 4100-PREPARE-CURSOR.                                             20480015
204900                                                                  20490015
205000     MOVE ASC-PO-NBR       TO DK-ORD-NBR                          20500015
205100     MOVE ASC-REC-SEQ-NBR  TO DK-RCVR-SEQ-NBR.                    20510015
205200     MOVE ASC-OPR-ID       TO DK-OPR-ID                           20520015
205300     MOVE ASC-FACT         TO DK-FACT.                            20530015
205400                                                                  20540015
205500/                                                                 20550015
205600 4200-TROUBLE-DESC.                                               20560015
205700                                                                  20570015
205800     EXEC SQL                                                     20580015
205900         SELECT B.TRBL_SHT_DESC                                   20590015
206000         INTO :TRBRSN-TRBL-SHT-DESC                               20600015
206100         FROM  TTRBNTF A                                          20610015
206200              ,TTRBRSN B                                          20620015
206300         WHERE A.PO_NBR               = :DK-ORD-NBR               20630015
206400               AND A.REC_SEQ_NBR      = :DK-RCVR-SEQ-NBR          20640015
206500               AND A.RESOLVED_IND    IN (:PC-N, :PC-I)            20650015
206600               AND PO_LNE_NBR         = 0                         20660015
206610               AND PREPK_ID           = 0                         20661018
206700               AND A.TRBL_RSN_CDE     = B.TRBL_RSN_CDE            20670015
206800     END-EXEC                                                     20680015
206900                                                                  20690015
207000     EVALUATE TRUE                                                20700015
207100         WHEN SQLCODE = +0                                        20710015
207200             MOVE TRBRSN-TRBL-SHT-DESC TO ASC-TROUB-STATUS        20720015
207300         WHEN SQLCODE = -811                                      20730015
207400             STRING TRBRSN-TRBL-SHT-DESC '*'                      20740015
207500                 DELIMITED BY SIZE                                20750015
207600                 INTO ASC-TROUB-STATUS                            20760015
207700         WHEN SQLCODE = +100                                      20770015
207800             MOVE SPACES                   TO ASC-TROUB-STATUS    20780015
207900         WHEN SQLCODE = -904                                      20790015
208000         WHEN SQLCODE = -911                                      20800015
208100         WHEN SQLCODE = -913                                      20810015
208200             PERFORM 9900-SOFT-ABORT                              20820015
208300                                                                  20830015
208400         WHEN SQLWARN0 NOT = SPACE                                20840015
208500         WHEN SQLCODE < ZERO                                      20850015
208600         WHEN SQLCODE > ZERO                                      20860015
208700             MOVE '4200-TROUBLE-DESC'                             20870015
208800                             TO DP013-PARAGRAPH                   20880015
208900             MOVE 'SELECT ON TTRBNTF/TTRBRSN'                     20890015
209000                             TO DP013-MESSAGE-TEXT (1)            20900015
209100             MOVE SQLCA          TO DP013-SQLCA                   20910015
209200             MOVE 'TTRBNTF'      TO DP013-DB2-TABLE-NAME (1)      20920015
209300             MOVE 'TTRBRSN'      TO DP013-DB2-TABLE-NAME (2)      20930015
209400             SET DP013-DB2-ABEND                                  20940015
209500                             TO TRUE                              20950015
209600             SET DP013-XCTL-DISPLAY-RESTART                       20960015
209700                             TO TRUE                              20970015
209800             PERFORM DP013-0000-PROCESS-ABEND                     20980015
209900     END-EVALUATE.                                                20990015
210000/                                                                 21000015
210100*----------------------------------------------------------------*21010015
210200*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *21020015
210300*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *21030015
210400*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *21040015
210500*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *21050015
210600*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *21060015
210700*                                                                *21070015
210800*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *21080015
210900*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *21090015
211000*    UPON INITIALIZATION.                                        *21100015
211100*----------------------------------------------------------------*21110015
211200                                                                  21120015
211300 4200-CALC-OPEN-TO-REC.                                           21130015
211400                                                                  21140015
211500     SET DP276-LINE-LEVEL-OTR                                     21150015
211600         DP276-RECEIVER-OTR      TO TRUE                          21160015
211700                                                                  21170015
211800     INITIALIZE DP276-KEYS                                        21180015
211900     MOVE DK-ORD-NBR             TO DP276-PO-NBR                  21190015
212000     MOVE PURITM-PO-LNE-NBR      TO DP276-PO-LNE-NBR              21200015
212100     MOVE DK-RCVR-SEQ-NBR        TO DP276-REC-SEQ-NBR             21210015
212200     MOVE DK-OPR-ID              TO DP276-OPER-UNT-ID             21220015
212300     MOVE DK-FACT                TO DP276-FCLTY-ID                21230015
212400                                                                  21240015
212500     COPY DPPD276.                                                21250015
212600                                                                  21260015
212700/                                                                 21270015
212800 4300-READ-ITEMS-FROM-DB.                                         21280015
212900                                                                  21290015
213000     PERFORM                                                      21300015
213100         VARYING PV-READ-COUNT                                    21310015
213200         FROM 1 BY 1                                              21320015
213300         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    21330015
213400            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         21340015
213500                                                                  21350015
213600         PERFORM 4310-FETCH                                       21360015
213700                                                                  21370015
213800         IF  ASC-ITEMS-LEFT-ON-DB                                 21380015
213900             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                21390015
214000                 ADD +1            TO ASC-ITEM-SUB                21400015
214100             ELSE                                                 21410015
214200                 ADD +1            TO ASC-BLK-SUB                 21420015
214300                 MOVE +1           TO ASC-ITEM-SUB                21430015
214400                                                                  21440015
214500                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         21450015
214600                     MOVE +1       TO ASC-BLK-SUB                 21460015
214700                     SET ASC-BLOCK-MODIFIED (1)                   21470015
214800                                   TO TRUE                        21480015
214900                     PERFORM 5100-WRITE-TEMP-STORAGE              21490015
215000                     MOVE ASC-BLOCK-ENTRIES                       21500015
215100                               (PC-MAX-BLOCKS-IN-ARRAY)           21510015
215200                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 21520015
215300                     ADD +1        TO ASC-BLK-SUB                 21530015
215400                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   21540015
215500                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      21550015
215600                                   TO TRUE                        21560015
215700                 END-IF                                           21570015
215800             END-IF                                               21580015
215900             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    21590015
216000             MOVE ASC-NUMBER-OF-ITEMS-READ                        21600015
216100                                   TO ASC-LIST-ITEM-NUMBER        21610015
216200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  21620015
216300             MOVE RECITM-ORD-LNE-NBR    TO ASC-LINE-NUMBER        21630015
216400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  21640015
216500                                           DK-LINE-NBR            21650015
216600             MOVE RECITM-DTL-CK-ITM-QTY TO ASC-DETAIL-ITEM        21660015
216700                                   (ASC-BLK-SUB ASC-ITEM-SUB)     21670015
216800             MOVE RECITM-PKSL-ITM-QTY   TO ASC-PS-ITEM            21680015
216900                                   (ASC-BLK-SUB ASC-ITEM-SUB)     21690015
217000             MOVE RECITM-CRE-TMST       TO PV-CRE-TMST            21700015
217010             MOVE RECITM-PREPK-ID       TO DK-PREPK-ID            21701016
217100             MOVE PV-CRE-YY             TO PV-CREATE-YY           21710015
217200             MOVE PV-CRE-MM             TO PV-CREATE-MM           21720015
217300             MOVE PV-CRE-DD             TO PV-CREATE-DD           21730015
217400             MOVE PV-CRE-HRS            TO PV-CREATE-HRS          21740015
217500             MOVE PV-CRE-MIN            TO PV-CREATE-MIN          21750015
217600             MOVE PV-CREATE-DTE         TO ASC-CREATE-DTE         21760015
217700                                   (ASC-BLK-SUB ASC-ITEM-SUB)     21770015
217800             MOVE PV-CREATE-TME         TO ASC-CREATE-TME         21780015
217900                                   (ASC-BLK-SUB ASC-ITEM-SUB)     21790015
218000             PERFORM 4320-GET-TPURITM-INFO                        21800015
218020             PERFORM 4321-CALL-CICS-API-ARCH                      21802036
218090                                                                  21809024
218100             MOVE PURCHS-DEPT-NBR       TO ASC-TPURCHS-DEPT-NBR   21810033
218200             MOVE PURITM-CL-NBR         TO ASC-CLASS              21820042
218210                                      (ASC-BLK-SUB ASC-ITEM-SUB)  21821042
218400             MOVE PURITM-SKU-DESC       TO ASC-SKU-DESC           21840015
218500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  21850015
218600             MOVE PURITM-ITM-NBR        TO ASC-ITM-NBR            21860015
218700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  21870015
218800             MOVE PURITM-VER-NBR        TO ASC-VER-NBR            21880024
218900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  21890015
219200             MOVE PURITM-VEND-STYL-NAME TO                        21920015
219300                                       ASC-PURITM-VEND-STYL-NAME  21930015
219400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  21940015
219500             MOVE PURITM-UNT-QTY        TO ASC-PURITM-UNT-QTY     21950015
219600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  21960015
219700             MOVE PURITM-UNT-RTL-PR-AMT TO                        21970015
219800                                       ASC-PURITM-UNT-RTL-PR-AMT  21980015
219900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  21990015
220000             MOVE PURITM-GP-RTL-AMT     TO ASC-PURITM-GP-RTL-AMT  22000015
220100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22010015
220200             MOVE PURITM-GP-QTY         TO ASC-PURITM-GP-QTY      22020015
220300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22030015
220400                                                                  22040015
220500*      GET OPEN TO RECEIVE TOTALS                                 22050015
220600             MOVE DK-LINE-NBR           TO DP276-SEARCH-NBR       22060015
220700             PERFORM 4210-SEARCH-OTR                              22070015
220800             MOVE DP276-OTR-OUT-X TO ASC-OTR                      22080015
220900                                   (ASC-BLK-SUB ASC-ITEM-SUB)     22090015
221000                                                                  22100015
221100             PERFORM 4330-GET-VERIFY-QTY                          22110015
221200             MOVE PV-AP-VERIFY-ITM-QTY  TO                        22120015
221300                 ASC-VERIFY-ITEM   (ASC-BLK-SUB ASC-ITEM-SUB)     22130015
221400             MOVE +0 TO PV-DB2-COUNT                              22140015
221500             PERFORM 4340-GET-NBR-WORK-ORDS                       22150015
221600             MOVE PV-DB2-COUNT TO                                 22160015
221700                 ASC-NBR-WKORDS    (ASC-BLK-SUB ASC-ITEM-SUB)     22170015
221800             IF PV-DB2-COUNT > 0                                  22180015
221900                 PERFORM 4380-SELECT-TWRKORD-DATA                 22190015
222000                 IF PV-DB2-COUNT > 0                              22200015
222100                                                                  22210015
222200                     MOVE PC-IP             TO ASC-STATUS         22220015
222300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 22230015
222400                 ELSE                                             22240015
222500                     MOVE PC-CM             TO ASC-STATUS         22250015
222600                                       (ASC-BLK-SUB ASC-ITEM-SUB) 22260015
222700                 END-IF                                           22270015
222800             ELSE                                                 22280015
222900                 MOVE PC-IP             TO ASC-STATUS             22290015
223000                                   (ASC-BLK-SUB ASC-ITEM-SUB)     22300015
223100             END-IF                                               22310015
223200             PERFORM 4350-GET-WRKORD-CART-QTY                     22320015
223300             IF  SQLCODE = +0                                     22330015
223400                 MOVE PV-ACTL-CART-CNT TO ASC-WKORD-CART-QTY      22340015
223500                                   (ASC-BLK-SUB ASC-ITEM-SUB)     22350015
223600             ELSE                                                 22360015
223700                 MOVE +0               TO ASC-WKORD-CART-QTY      22370015
223800                                   (ASC-BLK-SUB ASC-ITEM-SUB)     22380015
223900             END-IF                                               22390015
224000                                                                  22400015
224100             IF ASC-STAT NOT = PC-VE                              22410015
224200                 PERFORM 4370-FIND-LINE-TROUBLE                   22420015
224300                 EVALUATE TRUE                                    22430015
224400                     WHEN PV-UNRSLVD-TRBL-COUNT > ZERO            22440015
224500                         SET ASC-LINE-IN-TROUBLE                  22450015
224600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22460015
224700                                   TO TRUE                        22470015
224800                     WHEN PV-RSLVD-TRBL-COUNT > ZERO              22480015
224900                         SET ASC-LINE-DISTRO-TRBL                 22490015
225000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22500015
225100                                   TO TRUE                        22510015
225200                 END-EVALUATE                                     22520015
225300             END-IF                                               22530015
225400         END-IF                                                   22540015
225500     END-PERFORM.                                                 22550015
225600                                                                  22560015
225700     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          22570015
225800         MOVE +1                   TO ASC-BLK-SUB                 22580015
225900         PERFORM 5100-WRITE-TEMP-STORAGE                          22590015
226000         ADD +1                    TO ASC-BLK-SUB                 22600015
226100         PERFORM 5100-WRITE-TEMP-STORAGE                          22610015
226200                                                                  22620015
226300         MOVE 1                    TO ASC-BLK-SUB                 22630015
226400                                      PV-BLOCK-NUMBER             22640015
226500         PERFORM 4410-READ-TEMP-STORAGE                           22650015
226600         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             22660015
226700             MOVE 2                TO ASC-BLK-SUB                 22670015
226800                                      PV-BLOCK-NUMBER             22680015
226900             PERFORM 4410-READ-TEMP-STORAGE                       22690015
227000         END-IF                                                   22700015
227100     END-IF.                                                      22710015
227200                                                                  22720015
227300/                                                                 22730015
227400*----------------------------------------------------------------*22740015
227500*    FETCH A TPURITM ROW                                         *22750015
227600*----------------------------------------------------------------*22760015
227700                                                                  22770015
227800 4310-FETCH.                                                      22780015
227900                                                                  22790015
228000     EXEC SQL                                                     22800015
228100         FETCH TRECITM1-CSR                                       22810047
228200            INTO :RECITM-ORD-NBR                                  22820015
228300                ,:RECITM-ORD-LNE-NBR                              22830015
228400                ,:RECITM-DTL-CK-ITM-QTY                           22840015
228500                ,:RECITM-PKSL-ITM-QTY                             22850015
228600                ,:RECITM-CRE-TMST                                 22860015
228610                ,:RECITM-PREPK-ID                                 22861016
228700     END-EXEC.                                                    22870015
228800                                                                  22880015
228900     EVALUATE TRUE                                                22890015
229000         WHEN SQLCODE = +0                                        22900015
229100              CONTINUE                                            22910015
229200                                                                  22920015
229300         WHEN SQLCODE = +100                                      22930015
229400              SET ASC-NO-ITEMS-LEFT-ON-DB                         22940015
229500                                   TO TRUE                        22950015
229600         WHEN SQLCODE = -904                                      22960015
229700         WHEN SQLCODE = -911                                      22970015
229800         WHEN SQLCODE = -913                                      22980015
229900              PERFORM 9900-SOFT-ABORT                             22990015
230000                                                                  23000015
230100         WHEN SQLWARN0 NOT = SPACE                                23010015
230200         WHEN SQLCODE < +0                                        23020015
230300         WHEN SQLCODE > +0                                        23030015
230400              MOVE '4310-FETCH'                                   23040015
230500                                   TO DP013-PARAGRAPH             23050015
230600              MOVE 'FETCH TPURITM CURSOR'                         23060015
230700                                   TO DP013-MESSAGE-TEXT (1)      23070015
230800              MOVE SQLCA           TO DP013-SQLCA                 23080015
230900              MOVE 'TPURITM'       TO DP013-DB2-TABLE-NAME (1)    23090015
231000              SET DP013-DB2-ABEND  TO TRUE                        23100015
231100              PERFORM DP013-0000-PROCESS-ABEND                    23110015
231200     END-EVALUATE.                                                23120015
231300                                                                  23130015
231400/                                                                 23140015
231500 4320-GET-TPURITM-INFO.                                           23150015
231600                                                                  23160015
231700         EXEC SQL                                                 23170015
231800              SELECT PO_NBR                                       23180015
231900                    ,VER_NBR                                      23190015
232000                    ,ITM_NBR                                      23200020
232100                    ,CL_NBR                                       23210015
232200                    ,ITM_NBR                                      23220015
232300                    ,SKU_DESC                                     23230015
232400                    ,APP_PO_LNE_NBR                               23240015
232500                    ,VEND_STYL_NAME                               23250015
232600                    ,UNT_QTY                                      23260015
232700                    ,UNT_RTL_PR_AMT                               23270015
232800                    ,GP_RTL_AMT                                   23280015
232900                    ,GP_QTY                                       23290015
233000                    ,PO_LNE_NBR                                   23300015
233100              INTO :PURITM-PO-NBR                                 23310015
233200                  ,:PURITM-VER-NBR                                23320015
233300                  ,:PURITM-ITM-NBR                                23330020
233400                  ,:PURITM-CL-NBR                                 23340015
233500                  ,:PURITM-ITM-NBR                                23350015
233600                  ,:PURITM-SKU-DESC                               23360015
233700                  ,:PURITM-APP-PO-LNE-NBR                         23370015
233800                  ,:PURITM-VEND-STYL-NAME                         23380015
233900                  ,:PURITM-UNT-QTY                                23390015
234000                  ,:PURITM-UNT-RTL-PR-AMT                         23400015
234100                  ,:PURITM-GP-RTL-AMT                             23410015
234200                  ,:PURITM-GP-QTY                                 23420015
234300                  ,:PURITM-PO-LNE-NBR                             23430015
234400              FROM   TPURITM                                      23440015
234500              WHERE  PO_NBR         = :DK-ORD-NBR                 23450015
234600                AND  APP_PO_LNE_NBR = :DK-LINE-NBR                23460015
234700                AND  VER_STATUS_CDE = 'A'                         23470015
234800                                                                  23480015
234900         END-EXEC                                                 23490015
235000                                                                  23500015
235100         EVALUATE TRUE                                            23510015
235200             WHEN SQLCODE = +0                                    23520015
235300             WHEN SQLCODE = +100                                  23530015
235400                  CONTINUE                                        23540015
235500             WHEN SQLCODE = -904                                  23550015
235600             WHEN SQLCODE = -911                                  23560015
235700             WHEN SQLCODE = -913                                  23570015
235800                  PERFORM 9900-SOFT-ABORT                         23580015
235900                                                                  23590015
236000             WHEN SQLWARN0 NOT = SPACES                           23600015
236100             WHEN SQLCODE < +0                                    23610015
236200             WHEN SQLCODE > +0                                    23620015
236300                  MOVE '4320-GET-TRECITM-INFO'                    23630015
236400                                  TO DP013-PARAGRAPH              23640015
236500                  MOVE 'UNSUCCESSFUL SELECT ON TRECITM'           23650015
236600                                  TO DP013-MESSAGE-TEXT (1)       23660015
236700                  MOVE SQLCA      TO DP013-SQLCA                  23670015
236800                  MOVE 'TRECITM ' TO DP013-DB2-TABLE-NAME (1)     23680015
236900                  SET DP013-DB2-ABEND                             23690015
237000                      DP013-XCTL-DISPLAY-RESTART                  23700015
237100                                  TO TRUE                         23710015
237200                  PERFORM DP013-0000-PROCESS-ABEND                23720015
237300         END-EVALUATE.                                            23730015
237400                                                                  23740015
237500/                                                                 23750015
237600*----------------------------------------------------------------*23760015
237700*    ITEM ACCESS MODULE XLKUT001                                 *23770020
237800*----------------------------------------------------------------*23780015
237801 4321-CALL-CICS-API-ARCH.                                         23780120
237802                                                                  23780220
237804                                                                  23780420
237805      INITIALIZE XL001-ITEM-COMMAREA                              23780520
237806                                                                  23780620
237807      MOVE PURITM-ITM-NBR   TO XL001-KEY-ITM-NBR.                 23780720
237808                                                                  23780820
237809      SET  XL001-BY-ITEM                                          23780920
237810           XL001-SELECT-SKU TO TRUE.                              23781020
237811                                                                  23781120
237812      CALL XL001-VSM-PGM USING  DFHEIBLK                          23781220
237813                                XL001-COMMAREA                    23781320
237814                                XL001-ITEM-COMMAREA.              23781420
237815                                                                  23781520
237816      EVALUATE TRUE                                               23781620
237817                                                                  23781720
237818          WHEN XL001-SUCCESSFUL                                   23781820
237819               MOVE XL001-SKU-NBR   TO ASC-NIS-SKU                23781938
237820                                      (ASC-BLK-SUB ASC-ITEM-SUB)  23782038
237821                                                                  23782138
237822          WHEN XL001-SQL-ERROR                                    23782220
237823               IF XL001-SKU-SQLCODE = +100                        23782320
237824                  MOVE '00000000'      TO ASC-NIS-SKU             23782438
237825                                      (ASC-BLK-SUB ASC-ITEM-SUB)  23782538
237826               ELSE                                               23782620
237827                  MOVE XL001-SKU-NBR TO PV-DISPLAY-SKU-NBR        23782720
237828                  MOVE '4321-CALL-CICS-API-ARCH'                  23782820
237829                                  TO DP013-PARAGRAPH              23782920
237830                  MOVE 'UNSUCCESSFUL SELECT ON XLV SKU'           23783020
237831                                  TO DP013-MESSAGE-TEXT (1)       23783120
237832                  STRING 'XL VIEW ERROR PARA- '                   23783220
237833                                  DELIMITED BY SIZE               23783320
237834                  XL001-ERROR-PARAGRAPH-NBR DELIMITED BY SIZE     23783420
237835                                  INTO DP013-MESSAGE-TEXT (2)     23783520
237836                  STRING 'SKU NUMBER : ' DELIMITED BY SIZE        23783620
237837                      PV-DISPLAY-SKU-NBR DELIMITED BY SIZE        23783720
237838                                  INTO DP013-MESSAGE-TEXT (3)     23783820
237839                  MOVE XL001-SKU-SQLCODE TO DP013-SQLCA           23783920
237840                  MOVE 'XLV_SKU'  TO DP013-DB2-TABLE-NAME (1)     23784020
237841                  SET DP013-DB2-ABEND                             23784120
237842                      DP013-XCTL-DISPLAY-RESTART                  23784220
237843                                  TO TRUE                         23784320
237844                  PERFORM DP013-0000-PROCESS-ABEND                23784420
237845               END-IF                                             23784520
237846               WHEN XL001-INVALID-ACCESS                          23784620
237847                  MOVE 'ACCESS INFO FOR XLKUT001 INCORRECT'       23784720
237848                                     TO DP013-PARAGRAPH           23784820
237849                  MOVE 'UNSUCCESSFUL SELECT ON XLV_SKU'           23784920
237850                                     TO DP013-MESSAGE-TEXT (1)    23785020
237851                  MOVE SQLCA         TO DP013-SQLCA               23785120
237852                  MOVE 'XLV_SKU'     TO DP013-DB2-TABLE-NAME (1)  23785220
237853                  SET DP013-DB2-ABEND                             23785320
237854                      DP013-XCTL-DISPLAY-RESTART                  23785420
237855                                     TO TRUE                      23785520
237856                                                                  23785620
237857                  PERFORM DP013-0000-PROCESS-ABEND                23785720
237858             WHEN OTHER                                           23785820
237859                  MOVE '4321-CALL-CICS-API-ARCH'                  23785920
237860                                     TO DP013-PARAGRAPH           23786020
237861                  MOVE 'UNSUCCESSFUL SELECT ON XLV_SKU'           23786120
237862                                     TO DP013-MESSAGE-TEXT (1)    23786220
237863                  MOVE SQLCA         TO DP013-SQLCA               23786320
237864                  MOVE 'XLV_SKU'     TO DP013-DB2-TABLE-NAME (1)  23786420
237865                  SET DP013-DB2-ABEND                             23786520
237866                      DP013-XCTL-DISPLAY-RESTART                  23786620
237867                                     TO TRUE                      23786720
237868                                                                  23786820
237869                  PERFORM DP013-0000-PROCESS-ABEND                23786920
237870             END-EVALUATE.                                        23787020
237875/                                                                 23787520
237876*----------------------------------------------------------------*23787620
237877*    GET SKU, SKU DESC, AND VENDOR STYLE FROM TPURCHS/TPURITM    *23787720
237880*----------------------------------------------------------------*23788020
237900 4330-GET-VERIFY-QTY.                                             23790015
238000                                                                  23800015
238100         EXEC SQL                                                 23810015
238200              SELECT SUM(AP_VERIFY_ITM_QTY)                       23820015
238300                INTO :PV-AP-VERIFY-ITM-QTY                        23830015
238400                FROM TRECDIS                                      23840015
238500               WHERE ORD_NBR           = :DK-ORD-NBR              23850015
238600                 AND ORD_LNE_NBR       = :DK-LINE-NBR             23860015
238700                 AND REC_SEQ_NBR       = :DK-RCVR-SEQ-NBR         23870015
238900         END-EXEC                                                 23890015
239000                                                                  23900015
239100         EVALUATE TRUE                                            23910015
239200             WHEN SQLCODE = ZERO                                  23920015
239300                  CONTINUE                                        23930015
239400             WHEN SQLCODE = -904                                  23940015
239500             WHEN SQLCODE = -911                                  23950015
239600             WHEN SQLCODE = -913                                  23960015
239700                  PERFORM 9900-SOFT-ABORT                         23970015
239800             WHEN SQLCODE = +100                                  23980015
239900             WHEN SQLCODE = -305                                  23990015
240000                  MOVE +0  TO PV-AP-VERIFY-ITM-QTY                24000015
240100             WHEN SQLWARN0 NOT EQUAL SPACE                        24010015
240200             WHEN SQLCODE NOT EQUAL ZERO                          24020015
240300                  MOVE '4330-GET-VERIFY-QTY'                      24030015
240400                                   TO DP013-PARAGRAPH             24040015
240500                  MOVE 'SELECT TRECDIS'                           24050015
240600                                   TO DP013-MESSAGE-TEXT (1)      24060015
240700                  MOVE SQLCA       TO DP013-SQLCA                 24070015
240800                  SET DP013-DB2-ABEND                             24080015
240900                                   TO TRUE                        24090015
241000                  PERFORM DP013-0000-PROCESS-ABEND                24100015
241100         END-EVALUATE.                                            24110015
241200                                                                  24120015
241300/                                                                 24130015
241400 4340-GET-NBR-WORK-ORDS.                                          24140015
241500                                                                  24150015
241600         EXEC SQL                                                 24160015
241700              SELECT COUNT(*)                                     24170015
241800                INTO :PV-DB2-COUNT                                24180015
241900                FROM TWRKORD                                      24190015
242000               WHERE ORD_NBR          = :DK-ORD-NBR               24200015
242100                 AND RCVR_SEQ_NBR     = :DK-RCVR-SEQ-NBR          24210015
242200                 AND ORD_LNE_NBR      = :DK-LINE-NBR              24220015
242300                 AND OPER_UNT_ID      = :DK-OPR-ID                24230015
242400                 AND FCLTY_ID         = :DK-FACT                  24240015
242500                 AND VER_STATUS_CDE   = 'A'                       24250015
242600         END-EXEC                                                 24260015
242700                                                                  24270015
242800         EVALUATE TRUE                                            24280015
242900             WHEN SQLCODE = +0                                    24290015
243000             WHEN SQLCODE = +100                                  24300015
243100                  CONTINUE                                        24310015
243200             WHEN SQLCODE = -904                                  24320015
243300             WHEN SQLCODE = -911                                  24330015
243400             WHEN SQLCODE = -913                                  24340015
243500                  PERFORM 9900-SOFT-ABORT                         24350015
243600                                                                  24360015
243700             WHEN SQLWARN0 NOT = SPACES                           24370015
243800             WHEN SQLCODE < +0                                    24380015
243900             WHEN SQLCODE > +0                                    24390015
244000                  MOVE '4340-GET-NBR-WORK-ORDS'                   24400015
244100                                  TO DP013-PARAGRAPH              24410015
244200                  MOVE 'UNSUCCESSFUL SELECT ON TWRKORD TABLE'     24420015
244300                                  TO DP013-MESSAGE-TEXT (1)       24430015
244400                  MOVE SQLCA      TO DP013-SQLCA                  24440015
244500                  MOVE 'TWRKORD ' TO DP013-DB2-TABLE-NAME (1)     24450015
244600                  SET DP013-DB2-ABEND                             24460015
244700                      DP013-XCTL-DISPLAY-RESTART                  24470015
244800                                  TO TRUE                         24480015
244900                  PERFORM DP013-0000-PROCESS-ABEND                24490015
245000         END-EVALUATE.                                            24500015
245100                                                                  24510015
245200/                                                                 24520015
245300 4350-GET-WRKORD-CART-QTY.                                        24530015
245400                                                                  24540015
245500         EXEC SQL                                                 24550015
245600              SELECT SUM(ACTL_CART_CNT)                           24560015
245700                INTO :PV-ACTL-CART-CNT                            24570015
245800                FROM TWRKORD                                      24580015
245900               WHERE ORD_NBR           = :DK-ORD-NBR              24590015
246000                 AND ORD_LNE_NBR       = :DK-LINE-NBR             24600015
246100                 AND RCVR_SEQ_NBR      = :DK-RCVR-SEQ-NBR         24610015
246200                 AND OPER_UNT_ID       = :DK-OPR-ID               24620015
246300                 AND FCLTY_ID          = :DK-FACT                 24630015
246400                 AND VER_STATUS_CDE    = 'A'                      24640015
246500         END-EXEC                                                 24650015
246600                                                                  24660015
246700         EVALUATE TRUE                                            24670015
246800             WHEN SQLCODE = ZERO                                  24680015
246900             WHEN SQLCODE = +100                                  24690015
247000             WHEN SQLCODE = -305                                  24700015
247100                  CONTINUE                                        24710015
247200             WHEN SQLCODE = -904                                  24720015
247300             WHEN SQLCODE = -911                                  24730015
247400             WHEN SQLCODE = -913                                  24740015
247500                  PERFORM 9900-SOFT-ABORT                         24750015
247600             WHEN SQLWARN0 NOT EQUAL SPACE                        24760015
247700             WHEN SQLCODE NOT EQUAL ZERO                          24770015
247800                  MOVE '4350-GET-WRKORD-CART-QTY'                 24780015
247900                                   TO DP013-PARAGRAPH             24790015
248000                  MOVE 'SELECT TRECDIS'                           24800015
248100                                   TO DP013-MESSAGE-TEXT (1)      24810015
248200                  MOVE SQLCA       TO DP013-SQLCA                 24820015
248300                  SET DP013-DB2-ABEND                             24830015
248400                                   TO TRUE                        24840015
248500                  PERFORM DP013-0000-PROCESS-ABEND                24850015
248600         END-EVALUATE.                                            24860015
248700/                                                                 24870015
248800*----------------------------------------------------------------*24880015
248900*    GET TRECEIV INFO FOR THE TOP OF THE SCREEN                  *24890015
249000*----------------------------------------------------------------*24900015
249100 4355-GET-TRECEIV-INFO.                                           24910015
249200                                                                  24920015
249300         EXEC SQL                                                 24930015
249400              SELECT ORD_NBR                                      24940015
249500                    ,REC_SEQ_NBR                                  24950015
249600                    ,STATUS_CDE                                   24960015
249700                    ,EXPTED_CART_CNT                              24970015
249800                    ,ACTL_CART_CNT                                24980015
249900              INTO   :RECEIV-ORD-NBR                              24990015
250000                    ,:RECEIV-REC-SEQ-NBR                          25000015
250100                    ,:RECEIV-STATUS-CDE                           25010015
250200                    ,:RECEIV-EXPTED-CART-CNT                      25020015
250300                    ,:RECEIV-ACTL-CART-CNT                        25030015
250400                                                                  25040015
250500              FROM  TRECEIV                                       25050015
250600              WHERE ORD_NBR        = :DK-ORD-NBR                  25060015
250700                AND REC_SEQ_NBR    = :DK-RCVR-SEQ-NBR             25070015
250800                AND OPER_UNT_ID    = :DK-OPR-ID                   25080015
250900                AND FCLTY_ID       = :DK-FACT                     25090015
251000                AND VER_STATUS_CDE = 'A'                          25100015
251100         END-EXEC                                                 25110015
251200                                                                  25120015
251300         EVALUATE TRUE                                            25130015
251400             WHEN SQLCODE = +0                                    25140015
251500             WHEN SQLCODE = +100                                  25150015
251600                  CONTINUE                                        25160015
251700             WHEN SQLCODE = -904                                  25170015
251800             WHEN SQLCODE = -911                                  25180015
251900             WHEN SQLCODE = -913                                  25190015
252000                  PERFORM 9900-SOFT-ABORT                         25200015
252100                                                                  25210015
252200             WHEN SQLWARN0 NOT = SPACES                           25220015
252300             WHEN SQLCODE < +0                                    25230015
252400             WHEN SQLCODE > +0                                    25240015
252500                  MOVE '4355-GET-TRECIEV-INFO'                    25250015
252600                                  TO DP013-PARAGRAPH              25260015
252700                  MOVE 'UNSUCCESSFUL SELECT ON TRECEIV'           25270015
252800                                  TO DP013-MESSAGE-TEXT (1)       25280015
252900                  MOVE SQLCA      TO DP013-SQLCA                  25290015
253000                  MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (1)     25300015
253100                  SET DP013-DB2-ABEND                             25310015
253200                      DP013-XCTL-DISPLAY-RESTART                  25320015
253300                                  TO TRUE                         25330015
253400                  PERFORM DP013-0000-PROCESS-ABEND                25340015
253500         END-EVALUATE.                                            25350015
253600/                                                                 25360015
253700*----------------------------------------------------------------*25370015
253800*    GET TPURCHS INFO FOR THE TOP OF THE SCREEN                  *25380015
253900*----------------------------------------------------------------*25390015
254000 4360-GET-TPURCHS-INFO.                                           25400015
254100                                                                  25410015
254200         EXEC SQL                                                 25420015
254300              SELECT PO_NBR                                       25430015
254400                    ,DEPT_NBR                                     25440015
254500              INTO   :PURCHS-PO-NBR                               25450015
254600                    ,:PURCHS-DEPT-NBR                             25460015
254700                                                                  25470015
254800              FROM  TPURCHS                                       25480015
254900              WHERE PO_NBR         = :DK-ORD-NBR                  25490015
255000                AND VER_STATUS_CDE = 'A'                          25500015
255100         END-EXEC                                                 25510015
255200                                                                  25520015
255300         EVALUATE TRUE                                            25530015
255400             WHEN SQLCODE = +0                                    25540015
255500             WHEN SQLCODE = +100                                  25550015
255600                  CONTINUE                                        25560015
255700             WHEN SQLCODE = -904                                  25570015
255800             WHEN SQLCODE = -911                                  25580015
255900             WHEN SQLCODE = -913                                  25590015
256000                  PERFORM 9900-SOFT-ABORT                         25600015
256100                                                                  25610015
256200             WHEN SQLWARN0 NOT = SPACES                           25620015
256300             WHEN SQLCODE < +0                                    25630015
256400             WHEN SQLCODE > +0                                    25640015
256500                  MOVE '4360-GET-TPURCHS-INFO'                    25650015
256600                                  TO DP013-PARAGRAPH              25660015
256700                  MOVE 'UNSUCCESSFUL SELECT ON TPURCHS'           25670015
256800                                  TO DP013-MESSAGE-TEXT (1)       25680015
256900                  MOVE SQLCA      TO DP013-SQLCA                  25690015
257000                  MOVE 'TPURCHS ' TO DP013-DB2-TABLE-NAME (1)     25700015
257100                  SET DP013-DB2-ABEND                             25710015
257200                      DP013-XCTL-DISPLAY-RESTART                  25720015
257300                                  TO TRUE                         25730015
257400                  PERFORM DP013-0000-PROCESS-ABEND                25740015
257500         END-EVALUATE.                                            25750015
257600/                                                                 25760015
257700 4370-FIND-LINE-TROUBLE.                                          25770015
257800     MOVE ZERO                    TO PV-UNRSLVD-TRBL-COUNT        25780015
257900                                     PV-RSLVD-TRBL-COUNT          25790015
258000     EXEC SQL                                                     25800015
258100         SELECT COUNT(*)                                          25810015
258200         INTO :PV-UNRSLVD-TRBL-COUNT                              25820015
258300         FROM TTRBNTF A                                           25830015
258310             ,TTRBRSN B                                           25831016
258400         WHERE   A.PO_NBR           =  :DK-ORD-NBR                25840016
258500           AND   A.REC_SEQ_NBR      =  :DK-RCVR-SEQ-NBR           25850016
258600           AND ((A.PO_LNE_NBR       =  :DK-LINE-NBR               25860016
258610           AND   B.TRBL_LVL_IND      <> :PC-M)                    25861016
258620           OR   (A.PREPK_ID         =  :DK-PREPK-ID               25862016
258630           AND   B.TRBL_LVL_IND      =  :PC-M))                   25863017
258700           AND   A.RESOLVED_IND    IN (:PC-N, :PC-I)              25870016
258710           AND   A.TRBL_RSN_CDE     =  B.TRBL_RSN_CDE             25871016
258800     END-EXEC                                                     25880015
258900                                                                  25890015
259000     EVALUATE TRUE                                                25900015
259100         WHEN SQLCODE = ZERO                                      25910015
259200         WHEN SQLCODE = +100                                      25920015
259300             CONTINUE                                             25930015
259400         WHEN SQLCODE = -904                                      25940015
259500         WHEN SQLCODE = -911                                      25950015
259600         WHEN SQLCODE = -913                                      25960015
259700              PERFORM 9900-SOFT-ABORT                             25970015
259800                                                                  25980015
259900         WHEN SQLWARN0 NOT = SPACE                                25990015
260000         WHEN SQLCODE < ZERO                                      26000015
260100         WHEN SQLCODE > ZERO                                      26010015
260200             MOVE '4370-FIND-LINE-TROUBLE'                        26020015
260300                             TO DP013-PARAGRAPH                   26030015
260400             MOVE 'SELECT ON TTRBNTF'                             26040015
260500                             TO DP013-MESSAGE-TEXT (1)            26050015
260600             MOVE SQLCA          TO DP013-SQLCA                   26060015
260700             MOVE 'TTRBNTF'      TO DP013-DB2-TABLE-NAME (1)      26070015
260800             SET DP013-DB2-ABEND                                  26080015
260900                             TO TRUE                              26090015
261000             SET DP013-XCTL-DISPLAY-RESTART                       26100015
261100                             TO TRUE                              26110015
261200             PERFORM DP013-0000-PROCESS-ABEND                     26120015
261300     END-EVALUATE.                                                26130015
261400                                                                  26140015
261500     IF PV-UNRSLVD-TRBL-COUNT = ZERO AND SQLCODE = ZERO OR +100   26150015
261600         EXEC SQL                                                 26160015
261700             SELECT COUNT(*)                                      26170015
261800             INTO :PV-RSLVD-TRBL-COUNT                            26180015
261900             FROM TTRBNTF A                                       26190015
262000                , TTRBRSN B                                       26200015
262100             WHERE   A.PO_NBR        =  :DK-ORD-NBR               26210016
262200               AND   A.REC_SEQ_NBR   =  :DK-RCVR-SEQ-NBR          26220016
262300               AND ((A.PO_LNE_NBR    =  :DK-LINE-NBR              26230016
262310               AND   B.TRBL_LVL_IND   <> :PC-M)                   26231016
262320               OR   (A.PREPK_ID      =  :DK-PREPK-ID              26232016
262330               AND   B.TRBL_LVL_IND   =  :PC-M))                  26233017
262400               AND   A.RESOLVED_IND  =  :PC-R                     26240016
262500               AND   A.TRBL_RSN_CDE  =  B.TRBL_RSN_CDE            26250016
262600               AND   B.NOTIF_IND     =  :PC-T                     26260016
262700         END-EXEC                                                 26270015
262800                                                                  26280015
262900         EVALUATE TRUE                                            26290015
263000             WHEN SQLCODE = ZERO                                  26300015
263100             WHEN SQLCODE = +100                                  26310015
263200                 CONTINUE                                         26320015
263300             WHEN SQLCODE = -904                                  26330015
263400             WHEN SQLCODE = -911                                  26340015
263500             WHEN SQLCODE = -913                                  26350015
263600                  PERFORM 9900-SOFT-ABORT                         26360015
263700                                                                  26370015
263800             WHEN SQLWARN0 NOT = SPACE                            26380015
263900             WHEN SQLCODE < ZERO                                  26390015
264000             WHEN SQLCODE > ZERO                                  26400015
264100                 MOVE '4370-FIND-LINE-TROUBLE'                    26410015
264200                                 TO DP013-PARAGRAPH               26420015
264300                 MOVE 'SELECT ON TTRBNTF - TTRBRSN'               26430015
264400                                 TO DP013-MESSAGE-TEXT (1)        26440015
264500                 MOVE SQLCA      TO DP013-SQLCA                   26450015
264600                 MOVE 'TTRBNTF'  TO DP013-DB2-TABLE-NAME (1)      26460015
264700                 MOVE 'TTRBRSN'  TO DP013-DB2-TABLE-NAME (2)      26470015
264800                 SET DP013-DB2-ABEND                              26480015
264900                                 TO TRUE                          26490015
265000                 SET DP013-XCTL-DISPLAY-RESTART                   26500015
265100                                 TO TRUE                          26510015
265200                 PERFORM DP013-0000-PROCESS-ABEND                 26520015
265300         END-EVALUATE                                             26530015
265400     END-IF.                                                      26540015
265500/                                                                 26550015
265600 4380-SELECT-TWRKORD-DATA.                                        26560015
265700     MOVE +0 TO PV-DB2-COUNT.                                     26570015
265800     EXEC SQL                                                     26580015
265900         SELECT COUNT(*)                                          26590015
266000         INTO   :PV-DB2-COUNT                                     26600015
266100         FROM   TWRKORD                                           26610015
266200         WHERE  ORD_NBR        = :DK-ORD-NBR                      26620015
266300           AND  RCVR_SEQ_NBR   = :DK-RCVR-SEQ-NBR                 26630015
266400           AND  ORD_LNE_NBR    = :DK-LINE-NBR                     26640015
266500           AND  OPER_UNT_ID    = :DK-OPR-ID                       26650015
266600           AND  FCLTY_ID       = :DK-FACT                         26660015
266700           AND  VER_STATUS_CDE = 'A'                              26670015
266800           AND  STAT_CDE       ^= :PC-CM                          26680015
266900     END-EXEC.                                                    26690015
267000                                                                  26700015
267100     EVALUATE TRUE                                                26710015
267200         WHEN SQLCODE = +0                                        26720015
267300              CONTINUE                                            26730015
267400                                                                  26740015
267500         WHEN SQLWARN0 NOT = SPACES                               26750015
267600         WHEN SQLCODE < +0                                        26760015
267700         WHEN SQLCODE > +0                                        26770015
267800              MOVE '4380-SELECT-TWRKORD-DATA'                     26780015
267900                              TO DP013-PARAGRAPH                  26790015
268000              MOVE 'UNSUCCESSFUL SELECT ON TWRKORD TABLE'         26800015
268100                              TO DP013-MESSAGE-TEXT (1)           26810015
268200              MOVE SQLCA      TO DP013-SQLCA                      26820015
268300              MOVE 'TWRKORD ' TO DP013-DB2-TABLE-NAME (1)         26830015
268400              SET DP013-DB2-ABEND                                 26840015
268500                  DP013-XCTL-DISPLAY-RESTART                      26850015
268600                              TO TRUE                             26860015
268700              PERFORM DP013-0000-PROCESS-ABEND                    26870015
268800     END-EVALUATE.                                                26880015
268900                                                                  26890015
269000*----------------------------------------------------------------*26900015
269100* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *26910015
269200*----------------------------------------------------------------*26920015
269300                                                                  26930015
269400 4400-MOVE-COMMAREA-TO-SCREEN.                                    26940015
269500                                                                  26950015
269600     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             26960015
269700         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          26970015
269800         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          26980015
269900             MOVE +1               TO ASC-BLK-SUB                 26990015
270000             PERFORM 5100-WRITE-TEMP-STORAGE                      27000015
270100             ADD +1                TO ASC-BLK-SUB                 27010015
270200             PERFORM 5100-WRITE-TEMP-STORAGE                      27020015
270300             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             27030015
270400                 GIVING PV-BLOCK-NUMBER                           27040015
270500                 REMAINDER PV-REMAINDER                           27050015
270600             IF  PV-REMAINDER > ZERO                              27060015
270700                 ADD +1            TO PV-BLOCK-NUMBER             27070015
270800             END-IF                                               27080015
270900             MOVE +1               TO ASC-BLK-SUB                 27090015
271000             PERFORM 4410-READ-TEMP-STORAGE                       27100015
271100             ADD +1                TO ASC-BLK-SUB                 27110015
271200                                      PV-BLOCK-NUMBER             27120015
271300             PERFORM 4410-READ-TEMP-STORAGE                       27130015
271400     END-IF.                                                      27140015
271500                                                                  27150015
271600     MOVE +1                       TO ASC-BLK-SUB.                27160015
271700                                                                  27170015
271800     COMPUTE ASC-ITEM-SUB =                                       27180015
271900         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              27190015
272000         + PC-ITEMS-PER-PANEL).                                   27200015
272100                                                                  27210015
272200     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        27220015
272300         ADD +1                    TO ASC-BLK-SUB                 27230015
272400         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            27240015
272500     END-IF.                                                      27250015
272600                                                                  27260015
272700     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           27270015
272800         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                27280015
272900                                                                  27290015
273000     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        27300015
273100     PERFORM 4420-FORMAT-LIST-LINES                               27310015
273200         VARYING PV-SUB                                           27320015
273300         FROM PC-ITEMS-PER-PANEL BY -1                            27330015
273400         UNTIL PV-SUB < +1.                                       27340015
273500                                                                  27350015
273600     COMPUTE ASC-ITEMS-DISPLAYED =                                27360015
273700         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          27370015
273800                                                                  27380015
273900     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    27390015
274000                                      ASTRTITO.                   27400015
274100                                                                  27410015
274200     MOVE ASC-PO-NBR                   TO APONBRO.                27420015
274300     MOVE ASC-REC-SEQ-NBR              TO ASEQNBRO.               27430015
274400     MOVE ASC-STAT                     TO ASTATO.                 27440015
274500     MOVE ASC-OPR-ID                   TO AOPUNTO.                27450015
274600     MOVE ASC-FACT                     TO AFACTYO.                27460015
274700                                                                  27470015
274800                                                                  27480015
274900     MOVE ASC-TRECEIV-EXPTED-CART-CNT  TO AEXQTYO.                27490015
274910     MOVE PURCHS-DEPT-NBR              TO ADEPTO.                 27491037
275000     MOVE ASC-TRECEIV-ACTL-CART-CNT    TO AACQTYO.                27500015
275100     MOVE ASC-TROUB-STATUS             TO ATRBLO.                 27510015
275200                                                                  27520015
275300                                                                  27530015
275400     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    27540015
275500     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    27550015
275600     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            27560015
275700                                   TO ASELITO.                    27570015
275800                                                                  27580015
275900     IF  DP020-MSG-NUMBER-X = SPACE                               27590015
276000         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  27600015
276100*            --- MORE ITEMS TO DISPLAY ----                       27610015
276200             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            27620015
276300             SET DP020-MSG-INFORMATIONAL                          27630015
276400                                   TO TRUE                        27640015
276500         END-IF                                                   27650015
276600     END-IF.                                                      27660015
276700                                                                  27670015
276800*----------------------------------------------------------------*27680015
276900*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *27690015
277000*----------------------------------------------------------------*27700015
277100                                                                  27710015
277200 4410-READ-TEMP-STORAGE.                                          27720015
277300                                                                  27730015
277400     EXEC CICS                                                    27740015
277500         READQ TS                                                 27750015
277600             QUEUE (ASC-LIST-QUEUE-NAME)                          27760015
277700             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               27770015
277800             ITEM  (PV-BLOCK-NUMBER)                              27780015
277900             RESP  (PV-CICS-RESP)                                 27790015
278000     END-EXEC.                                                    27800015
278100                                                                  27810015
278200     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       27820015
278300       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     27830015
278400         CONTINUE                                                 27840015
278500     ELSE                                                         27850015
278600         SET DP013-CICS-ABEND      TO TRUE                        27860015
278700         SET DP013-NO-ROLLBACK     TO TRUE                        27870015
278800         MOVE '4410-READ-TEMP-STORAGE'                            27880015
278900                                   TO DP013-PARAGRAPH             27890015
279000         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      27900015
279100                                   TO DP013-MESSAGE-TEXT(1)       27910015
279200         PERFORM DP013-0000-PROCESS-ABEND                         27920015
279300     END-IF.                                                      27930015
279400                                                                  27940015
279500     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)                      27950015
279600                                   TO TRUE.                       27960015
279700                                                                  27970015
279800     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         27980015
279900         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               27990015
280000     END-IF.                                                      28000015
280100                                                                  28010015
280200/                                                                 28020015
280300*----------------------------------------------------------------*28030015
280400*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *28040015
280500*----------------------------------------------------------------*28050015
280600                                                                  28060015
280700 4420-FORMAT-LIST-LINES.                                          28070015
280800                                                                  28080015
280900     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      28090015
281000         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                28100015
281100         MOVE DP015-ASK-DRK-OFF    TO MR-SELECTA (PV-SUB)         28110015
281200         MOVE SPACES               TO MR-SELECT  (PV-SUB)         28120015
281300         MOVE SPACES               TO MR-SKU              (PV-SUB)28130015
281400                                      MR-STATUS           (PV-SUB)28140015
281410                                      MR-CLS              (PV-SUB)28141036
281500                                      MR-CREATE-DATE      (PV-SUB)28150015
281600                                      MR-CREATE-TIME      (PV-SUB)28160015
281700                                      MR-LINE             (PV-SUB)28170015
281800                                      MR-OTR              (PV-SUB)28180015
281900                                      MR-PS               (PV-SUB)28190015
282000                                      MR-DETAIL-ITEM      (PV-SUB)28200015
282100                                      MR-VERIFY-ITEM      (PV-SUB)28210015
282200                                      MR-NBR-WORK-ORDS    (PV-SUB)28220015
282300                                      MR-CART-QTY         (PV-SUB)28230015
282400     ELSE                                                         28240015
282500         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      28250015
282600                                                   > SPACE        28260015
282700             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 28270015
282800                                   TO MR-SELECT (PV-SUB)          28280015
282900         ELSE                                                     28290015
283000             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      28300015
283100                                   TO MR-SELECT (PV-SUB)          28310015
283200         END-IF                                                   28320015
283300                                                                  28330015
283400         IF  DP030-SET-CURSOR-TRAILER                             28340015
283500             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)28350015
283600                 > SPACE)                                         28360015
283700               OR (PV-SUB = 1))                                   28370015
283800                SET DP030-SET-CURSOR-APPL-1 TO TRUE               28380015
283900                MOVE -1            TO MR-SELECTL (PV-SUB)         28390015
284000             END-IF                                               28400015
284100         END-IF                                                   28410015
284200                                                                  28420015
284300         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           28430015
284400             MOVE ASC-LINE-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)      28440015
284500                                 TO MR-LINE-N (PV-SUB)            28450015
284600             MOVE ASC-NIS-SKU (ASC-BLK-SUB ASC-ITEM-SUB)          28460038
284700                                 TO MR-SKU (PV-SUB)               28470015
284800             MOVE ASC-STATUS (ASC-BLK-SUB ASC-ITEM-SUB)           28480015
284900                                 TO MR-STATUS (PV-SUB)            28490015
284910             MOVE ASC-CLASS (ASC-BLK-SUB ASC-ITEM-SUB)            28491036
284920                                 TO MR-CLS    (PV-SUB)            28492036
285000             IF ASC-STATUS (ASC-BLK-SUB ASC-ITEM-SUB) NOT = PC-VE 28500015
285100             EVALUATE TRUE                                        28510015
285200                 WHEN ASC-LINE-IN-TROUBLE                         28520015
285300                               (ASC-BLK-SUB ASC-ITEM-SUB)         28530015
285400                     MOVE DP015-YELLOW                            28540015
285500                                 TO MR-STATUSC (PV-SUB)           28550015
285600                 WHEN ASC-LINE-DISTRO-TRBL                        28560015
285700                               (ASC-BLK-SUB ASC-ITEM-SUB)         28570015
285800                    MOVE DP015-PINK                               28580015
285900                                 TO MR-STATUSC (PV-SUB)           28590015
286000                 WHEN OTHER                                       28600015
286100                     MOVE DP015-BLUE                              28610015
286200                                 TO MR-STATUSC (PV-SUB)           28620015
286300             END-EVALUATE                                         28630015
286400             END-IF                                               28640015
286500                                                                  28650015
286600             MOVE ASC-OTR (ASC-BLK-SUB ASC-ITEM-SUB)              28660015
286700                                 TO MR-OTR (PV-SUB)               28670015
286800                                                                  28680015
286900             MOVE ASC-PS-ITEM (ASC-BLK-SUB ASC-ITEM-SUB)          28690015
287000                                 TO MR-PS (PV-SUB)                28700015
287100             MOVE ASC-DETAIL-ITEM (ASC-BLK-SUB ASC-ITEM-SUB)      28710015
287200                                 TO MR-DETAIL-ITEM (PV-SUB)       28720015
287300             MOVE ASC-VERIFY-ITEM (ASC-BLK-SUB ASC-ITEM-SUB)      28730015
287400                                 TO MR-VERIFY-ITEM (PV-SUB)       28740015
287500             MOVE ASC-CREATE-DTE (ASC-BLK-SUB ASC-ITEM-SUB)       28750015
287600                                 TO MR-CREATE-DATE (PV-SUB)       28760015
287700             MOVE ASC-CREATE-TME (ASC-BLK-SUB ASC-ITEM-SUB)       28770015
287800                                 TO MR-CREATE-TIME (PV-SUB)       28780015
287900             MOVE ASC-NBR-WKORDS (ASC-BLK-SUB ASC-ITEM-SUB)       28790015
288000                                 TO PV-NBR-WORK-ORDS              28800015
288100             MOVE PV-NBR-WORK-ORDS                                28810015
288200                                 TO MR-NBR-WORK-ORDS (PV-SUB)     28820015
288300             MOVE ASC-WKORD-CART-QTY (ASC-BLK-SUB ASC-ITEM-SUB)   28830015
288400                                 TO MR-CART-QTY (PV-SUB)          28840015
288500         END-IF                                                   28850015
288600     END-IF.                                                      28860015
288700                                                                  28870015
288800     SUBTRACT +1 FROM ASC-ITEM-SUB.                               28880015
288900                                                                  28890015
289000     IF  ASC-ITEM-SUB < + 1                                       28900015
289100         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                28910015
289200         MOVE +1                   TO ASC-BLK-SUB                 28920015
289300     END-IF.                                                      28930015
289400                                                                  28940015
289500*----------------------------------------------------------------*28950015
289600*  IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF    *28960015
289700*  RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,       *28970015
289800*  ISSUE A WARNING.                                              *28980015
289900*----------------------------------------------------------------*28990015
290000 4430-CHECK-FOR-BEGIN-AND-END.                                    29000015
290100                                                                  29010015
290200     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       29020015
290300         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     29030015
290400*            -- NO END-OF-RANGE SPECFIED ---                      29040015
290500             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            29050015
290600             SET DP020-MSG-WARNING TO TRUE                        29060015
290700             PERFORM 4431-POSITION-AT-WARNING                     29070015
290800         END-IF                                                   29080015
290900     ELSE                                                         29090015
291000         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     29100015
291100*            -- NO BEGINNING-OF-RANGE SPECFIED ---                29110015
291200             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            29120015
291300             SET DP020-MSG-WARNING TO TRUE                        29130015
291400             PERFORM 4431-POSITION-AT-WARNING                     29140015
291500         END-IF                                                   29150015
291600     END-IF.                                                      29160015
291700                                                                  29170015
291800*----------------------------------------------------------------*29180015
291900*  ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,   *29190015
292000*  DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE    *29200015
292100*  IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND         *29210015
292200*  POSITION THE CURSOR THERE.                                    *29220015
292300*----------------------------------------------------------------*29230015
292400 4431-POSITION-AT-WARNING.                                        29240015
292500                                                                  29250015
292600     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 29260015
292700                    - PV-TOP-ITEM + 1.                            29270015
292800                                                                  29280015
292900     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      29290015
293000         CONTINUE                                                 29300015
293100     ELSE                                                         29310015
293200         SET DP030-SET-CURSOR-APPL-1                              29320015
293300                                   TO TRUE                        29330015
293400         MOVE -1                   TO MR-SELECTL (PV-SUB)         29340015
293500         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         29350015
293600         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         29360015
293700     END-IF.                                                      29370015
293800                                                                  29380015
293900     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   29390015
294000                    - PV-TOP-ITEM + 1.                            29400015
294100                                                                  29410015
294200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      29420015
294300         CONTINUE                                                 29430015
294400     ELSE                                                         29440015
294500         SET DP030-SET-CURSOR-APPL-1                              29450015
294600                                   TO TRUE                        29460015
294700         MOVE -1                   TO MR-SELECTL (PV-SUB)         29470015
294800         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         29480015
294900         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         29490015
295000     END-IF.                                                      29500015
295100                                                                  29510015
295200/                                                                 29520015
295300*----------------------------------------------------------------*29530015
295400* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *29540015
295500* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *29550015
295600* FOR THE SELECTED ITEMS QUEUE.                                  *29560015
295700*                                                                *29570015
295800* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *29580015
295900* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *29590015
296000* THE ARRAY IS FULL.                                             *29600015
296100*----------------------------------------------------------------*29610015
296200                                                                  29620015
296300 5000-PREPARE-SEL-QUEUE.                                          29630015
296400                                                                  29640015
296500     MOVE +1                       TO ASC-BLK-SUB.                29650015
296600     PERFORM 5100-WRITE-TEMP-STORAGE.                             29660015
296700     ADD +1                        TO ASC-BLK-SUB.                29670015
296800     PERFORM 5100-WRITE-TEMP-STORAGE.                             29680015
296900                                                                  29690015
297000     MOVE ASC-SEL-QUEUE-NAME-OUT   TO PC000-SEL-QUEUE-NAME.       29700015
297100     PERFORM 6010-DELETE-SEL-QUEUE.                               29710015
297200                                                                  29720015
297300                                                                  29730015
297400     SET ASC-UPDATE-TSQ        TO TRUE.                           29740015
297500     SET PC016-IDX             TO 1.                              29750015
297600     MOVE ZERO                 TO PC000-NUMBER-OF-TS-ITEMS        29760015
297700                         PC000-NUMBER-OF-SELECTED-ITEMS.          29770015
297800     INITIALIZE PC016-SELECTED-ITEM-ARRAY.                        29780015
297900                                                                  29790015
298000     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           29800015
298100             VARYING PV-ITEM                                      29810015
298200             FROM 1 BY 1                                          29820015
298300             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     29830015
298400     IF  PC016-IDX > 1                                            29840015
298500         PERFORM 5205-WRITE-SEL-QUEUE                             29850015
298600         ADD +1                TO PC000-NUMBER-OF-TS-ITEMS        29860015
298700     END-IF.                                                      29870015
298800                                                                  29880015
298900/                                                                 29890015
299000*----------------------------------------------------------------*29900015
299100*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *29910015
299200*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *29920015
299300*----------------------------------------------------------------*29930015
299400                                                                  29940015
299500 5100-WRITE-TEMP-STORAGE.                                         29950015
299600                                                                  29960015
299700     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     29970015
299800                                   TO PV-LIST-ITEM-NUMBER.        29980015
299900     COMPUTE PV-BLOCK-NUMBER =                                    29990015
300000         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    30000015
300100                                                                  30010015
300200     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             30020015
300300     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             30030015
300400         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      30040015
300500             PERFORM 5105-REWRITE-ASC-LISTQ                       30050015
300600         END-IF                                                   30060015
300700     ELSE                                                         30070015
300800         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       30080015
300900         ASC-HIGHEST-BLOCK-WRITTEN + 1                            30090015
301000         PERFORM 5110-WRITE-ASC-LISTQ                             30100015
301100         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   30110015
301200     END-IF.                                                      30120015
301300                                                                  30130015
301400     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)                      30140015
301500                                   TO TRUE.                       30150015
301600                                                                  30160015
301700/                                                                 30170015
301800*----------------------------------------------------------------*30180015
301900*  REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-     *30190015
302000*  SPECIFIC COMMAREA.                                            *30200015
302100*----------------------------------------------------------------*30210015
302200 5105-REWRITE-ASC-LISTQ.                                          30220015
302300                                                                  30230015
302400     EXEC CICS                                                    30240015
302500         WRITEQ TS                                                30250015
302600             QUEUE (ASC-LIST-QUEUE-NAME)                          30260015
302700             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               30270015
302800             ITEM  (PV-BLOCK-NUMBER)                              30280015
302900             REWRITE                                              30290015
303000             RESP  (PV-CICS-RESP)                                 30300015
303100     END-EXEC.                                                    30310015
303200                                                                  30320015
303300     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           30330015
303400         CONTINUE                                                 30340015
303500     ELSE                                                         30350015
303600         SET DP013-CICS-ABEND      TO TRUE                        30360015
303700         SET DP013-NO-ROLLBACK     TO TRUE                        30370015
303800         MOVE '5105-REWRITE-ASC-LISTQ'                            30380015
303900                                   TO DP013-PARAGRAPH             30390015
304000         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     30400015
304100                                   TO DP013-MESSAGE-TEXT(1)       30410015
304200         PERFORM DP013-0000-PROCESS-ABEND                         30420015
304300     END-IF.                                                      30430015
304400                                                                  30440015
304500/                                                                 30450015
304600*----------------------------------------------------------------*30460015
304700*  WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-       *30470015
304800*  SPECIFIC COMMAREA.                                            *30480015
304900*----------------------------------------------------------------*30490015
305000 5110-WRITE-ASC-LISTQ.                                            30500015
305100                                                                  30510015
305200     EXEC CICS                                                    30520015
305300         WRITEQ TS                                                30530015
305400             QUEUE (ASC-LIST-QUEUE-NAME)                          30540015
305500             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               30550015
305600             ITEM  (PV-BLOCK-NUMBER)                              30560015
305700             RESP  (PV-CICS-RESP)                                 30570015
305800     END-EXEC.                                                    30580015
305900                                                                  30590015
306000     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      30600015
306100         SET DP013-CICS-ABEND      TO TRUE                        30610015
306200         SET DP013-NO-ROLLBACK     TO TRUE                        30620015
306300         MOVE '5110-WRITE-ASC-LISTQ'                              30630015
306400                                   TO DP013-PARAGRAPH             30640015
306500         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           30650015
306600                                   TO DP013-MESSAGE-TEXT(1)       30660015
306700         PERFORM DP013-0000-PROCESS-ABEND                         30670015
306800     END-IF.                                                      30680015
306900                                                                  30690015
307000/                                                                 30700015
307100*----------------------------------------------------------------*30710015
307200* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *30720015
307300* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *30730015
307400*----------------------------------------------------------------*30740015
307500                                                                  30750015
307600 5200-FILL-SEL-QUEUE-RECORD.                                      30760015
307700                                                                  30770015
307800     PERFORM 6112-READ-LIST-QUEUE.                                30780015
307900                                                                  30790015
308000     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       30800015
308100         PERFORM                                                  30810015
308200         VARYING LQW-IDX                                          30820015
308300         FROM 1 BY 1                                              30830015
308400         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            30840015
308500           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          30850015
308600                                                                  30860015
308700             IF  (LQW-SELECT (LQW-IDX))                           30870015
308800                 IF  (LQW-NBR-WKORDS (LQW-IDX) > 0)               30880015
308900                   AND (DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID))    30890015
309000                     SET PS-VERIFIED-RECEIVER TO TRUE             30900015
309100                 ELSE                                             30910015
309200                 ADD +1 TO PC000-NUMBER-OF-SELECTED-ITEMS         30920015
309300                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              30930015
309400                                    TO PC016-ITEM (PC016-IDX)     30940015
309500                 MOVE SPACE         TO PC016-ACTION-SW (PC016-IDX)30950015
309600                 MOVE ASC-OPR-ID    TO PC016-OPER-UNT-ID          30960015
309700                                                       (PC016-IDX)30970015
309800                                       DK-OPR-ID                  30980015
309900                 MOVE ASC-FACT      TO PC016-FCLTY-ID             30990015
310000                                                       (PC016-IDX)31000015
310100                                       DK-FACT                    31010015
310200                 MOVE ASC-PO-NBR    TO PC016-PO-NBR-N  (PC016-IDX)31020015
310300                                       DK-ORD-NBR                 31030015
310400                 MOVE ASC-REC-SEQ-NBR                             31040015
310500                                    TO PC016-REC-SEQ-NBR-N        31050015
310600                                                       (PC016-IDX)31060015
310700                                       DK-RCVR-SEQ-NBR            31070015
310800                 MOVE LQW-LINE-NUMBER (LQW-IDX)                   31080015
310900                                    TO PC016-LINE-NBR-N           31090015
311000                                                       (PC016-IDX)31100015
311100                                       DK-LINE-NBR                31110015
311200                 IF DP020-FK-CONFIRM(DP020-SRC-AID)               31120015
311300                     IF ASC-STAT = 'VE'                           31130015
311400                         MOVE PC-TSYMSG-01230  TO DP020-MSG-NUMBER31140015
311500                         SET DP020-MSG-FATAL                      31150015
311600                             PS-ERROR      TO TRUE                31160015
311700                     ELSE                                         31170015
311800                         PERFORM 7100-DELETE-PROCESS              31180015
311900                     END-IF                                       31190015
312000                 ELSE                                             31200015
312100                 MOVE ASC-TPURCHS-DEPT-NBR                        31210040
312200                                    TO PC016-DEPT                 31220015
312300                                                       (PC016-IDX)31230015
312400                 MOVE LQW-CL          (LQW-IDX)                   31240015
312500                                    TO PC016-CL                   31250015
312600                                                       (PC016-IDX)31260015
313000                 MOVE LQW-SKU-DESC    (LQW-IDX)                   31300015
313100                                    TO PC016-SKU-DESC             31310015
313200                                                       (PC016-IDX)31320015
313300                 MOVE LQW-ITM-NBR     (LQW-IDX)                   31330015
313400                                    TO PC016-ITM-NBR              31340015
313500                                                       (PC016-IDX)31350015
313600                 MOVE LQW-VER-NBR     (LQW-IDX)                   31360015
313700                                    TO PC016-VER-NBR              31370015
313800                                                       (PC016-IDX)31380015
313900                 MOVE LQW-DETAIL-ITEM (LQW-IDX)                   31390015
314000                                    TO PC016-DTL-CK-ITM-QTY       31400015
314100                                                       (PC016-IDX)31410015
314200                 MOVE LQW-PS-ITEM     (LQW-IDX)                   31420015
314300                                    TO PC016-PKSL-ITM-QTY         31430015
314400                                                       (PC016-IDX)31440015
314500                 MOVE LQW-PURITM-VEND-STYL-NAME        (LQW-IDX)  31450015
314600                                    TO PC016-VEND-STYL-NAME       31460015
314700                                                       (PC016-IDX)31470015
314800                 MOVE LQW-PURITM-UNT-QTY               (LQW-IDX)  31480015
314900                                    TO PC016-UNT-QTY   (PC016-IDX)31490015
315000                 MOVE LQW-PURITM-UNT-RTL-PR-AMT        (LQW-IDX)  31500015
315100                                    TO PC016-UNT-RTL-PR-AMT       31510015
315200                                                       (PC016-IDX)31520015
315300                 MOVE LQW-PURITM-GP-RTL-AMT            (LQW-IDX)  31530015
315400                                    TO PC016-GP-RTL-AMT(PC016-IDX)31540015
315500                 MOVE LQW-PURITM-GP-QTY                (LQW-IDX)  31550015
315600                                    TO PC016-GP-QTY    (PC016-IDX)31560015
315700                 MOVE PC-Y          TO PC016-MRKG-APRON-REQ-IND   31570015
315800                                                       (PC016-IDX)31580015
315900                 SET PC016-IDX UP BY 1                            31590015
316000                 IF  PC016-IDX > PC016-MAX-ITEMS                  31600015
316100                     PERFORM 5205-WRITE-SEL-QUEUE                 31610015
316200                     ADD +1        TO PC000-NUMBER-OF-TS-ITEMS    31620015
316300                     INITIALIZE PC016-SELECTED-ITEM-ARRAY         31630015
316400                     SET PC016-IDX TO 1                           31640015
316500                 END-IF                                           31650015
316600                 END-IF                                           31660015
316700                 END-IF                                           31670015
316800             END-IF                                               31680015
316900         END-PERFORM                                              31690015
317000     END-IF.                                                      31700015
317100                                                                  31710015
317200     MOVE PV-ITEM TO PV-SAVE-ITEM.                                31720015
317300     PERFORM 6111-WRITE-LIST-QUEUE.                               31730015
317400                                                                  31740015
317500*----------------------------------------------------------------*31750015
317600*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *31760015
317700*----------------------------------------------------------------*31770015
317800                                                                  31780015
317900 5205-WRITE-SEL-QUEUE.                                            31790015
318000                                                                  31800015
318100     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            31810015
318200                                   TO PC016-SELECTED-ITEMS.       31820015
318300                                                                  31830015
318400     EXEC CICS                                                    31840015
318500          WRITEQ TS                                               31850015
318600              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      31860015
318700              FROM  (PC016-TS-SEL-REC)                            31870015
318800              ITEM  (PV-SEL-QUEUE-ITEM)                           31880015
318900              RESP  (PV-CICS-RESP)                                31890015
319000     END-EXEC.                                                    31900015
319100                                                                  31910015
319200     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          31920015
319300         CONTINUE                                                 31930015
319400     ELSE                                                         31940015
319500         SET DP013-CICS-ABEND      TO TRUE                        31950015
319600         SET DP013-NO-ROLLBACK     TO TRUE                        31960015
319700         MOVE '5205-WRITE-SEL-QUEUE'                              31970015
319800                                   TO DP013-PARAGRAPH             31980015
319900         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          31990015
320000                                   TO DP013-MESSAGE-TEXT(1)       32000015
320100         PERFORM DP013-0000-PROCESS-ABEND                         32010015
320200     END-IF.                                                      32020015
320300/                                                                 32030015
320400*----------------------------------------------------------------*32040015
320500*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *32050015
320600*----------------------------------------------------------------*32060015
320700 6010-DELETE-SEL-QUEUE.                                           32070015
320800                                                                  32080015
320900     EXEC CICS                                                    32090015
321000         DELETEQ TS                                               32100015
321100             QUEUE (ASC-SEL-QUEUE-NAME-OUT)                       32110015
321200             RESP  (PV-CICS-RESP)                                 32120015
321300     END-EXEC.                                                    32130015
321400                                                                  32140015
321500     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      32150015
321600         (PV-CICS-RESP = DFHRESP(QIDERR)))                        32160015
321700         CONTINUE                                                 32170015
321800     ELSE                                                         32180015
321900         SET DP013-CICS-ABEND      TO TRUE                        32190015
322000         SET DP013-NO-ROLLBACK     TO TRUE                        32200015
322100         MOVE '6010-DELETE-SEL-QUEUE'                             32210015
322200                                   TO DP013-PARAGRAPH             32220015
322300         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         32230015
322400                                   TO DP013-MESSAGE-TEXT (1)      32240015
322500         PERFORM DP013-0000-PROCESS-ABEND                         32250015
322600     END-IF.                                                      32260015
322700/                                                                 32270015
322800*----------------------------------------------------------------*32280015
322900*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *32290015
323000*----------------------------------------------------------------*32300015
323100                                                                  32310015
323200 6111-WRITE-LIST-QUEUE.                                           32320015
323300                                                                  32330015
323400     EXEC CICS                                                    32340015
323500         WRITEQ TS                                                32350015
323600             QUEUE (ASC-LIST-QUEUE-NAME)                          32360015
323700             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     32370015
323800             ITEM  (PV-SAVE-ITEM)                                 32380015
323900             REWRITE                                              32390015
324000             RESP  (PV-CICS-RESP)                                 32400015
324100     END-EXEC.                                                    32410015
324200                                                                  32420015
324300     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          32430015
324400         CONTINUE                                                 32440015
324500     ELSE                                                         32450015
324600         SET DP013-CICS-ABEND      TO TRUE                        32460015
324700         SET DP013-NO-ROLLBACK     TO TRUE                        32470015
324800         MOVE '6111-WRITE-LIST-QUEUE'                             32480015
324900                                   TO DP013-PARAGRAPH             32490015
325000         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  32500015
325100                                   TO DP013-MESSAGE-TEXT(1)       32510015
325200         PERFORM DP013-0000-PROCESS-ABEND                         32520015
325300     END-IF.                                                      32530015
325400                                                                  32540015
325500/                                                                 32550015
325600*----------------------------------------------------------------*32560015
325700*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*32570015
325800*----------------------------------------------------------------*32580015
325900                                                                  32590015
326000 6112-READ-LIST-QUEUE.                                            32600015
326100                                                                  32610015
326200     EXEC CICS                                                    32620015
326300         READQ TS                                                 32630015
326400             QUEUE (ASC-LIST-QUEUE-NAME)                          32640015
326500             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     32650015
326600             ITEM  (PV-ITEM)                                      32660015
326700             RESP  (PV-CICS-RESP)                                 32670015
326800     END-EXEC.                                                    32680015
326900                                                                  32690015
327000     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          32700015
327100         CONTINUE                                                 32710015
327200     ELSE                                                         32720015
327300         SET DP013-CICS-ABEND      TO TRUE                        32730015
327400         SET DP013-NO-ROLLBACK     TO TRUE                        32740015
327500         MOVE '6112-READ-LIST-QUEUE'                              32750015
327600                                   TO DP013-PARAGRAPH             32760015
327700         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    32770015
327800                                   TO DP013-MESSAGE-TEXT(1)       32780015
327900         PERFORM DP013-0000-PROCESS-ABEND                         32790015
328000     END-IF.                                                      32800015
328100                                                                  32810015
328200/                                                                 32820015
328300******************************************************************32830015
328400* DELETE THE LIST QUEUE WHEN PREV-SEL OR NEXT-SEL WAS ENTERED.   *32840015
328500******************************************************************32850015
328600 6200-DEL-LIST-QUEUE.                                             32860015
328700                                                                  32870015
328800     EXEC CICS                                                    32880015
328900         DELETEQ TS                                               32890015
329000             QUEUE (ASC-LIST-QUEUE-NAME)                          32900015
329100             RESP  (PV-CICS-RESP)                                 32910015
329200     END-EXEC.                                                    32920015
329300                                                                  32930015
329400     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      32940015
329500        (PV-CICS-RESP = DFHRESP(QIDERR)))                         32950015
329600         CONTINUE                                                 32960015
329700     ELSE                                                         32970015
329800        SET DP013-CICS-ABEND       TO TRUE                        32980015
329900        SET DP013-NO-ROLLBACK      TO TRUE                        32990015
330000        MOVE '6200-DEL-LIST-QUEUE' TO DP013-PARAGRAPH             33000015
330100        MOVE 'ERROR TRYING TO DELETE LIST TS QUEUE'               33010015
330200                                   TO DP013-MESSAGE-TEXT (1)      33020015
330300        PERFORM DP013-0000-PROCESS-ABEND                          33030015
330400     END-IF.                                                      33040015
330500                                                                  33050015
330600/                                                                 33060015
330700 7000-FORMAT-COMMAREA.                                            33070015
330800                                                                  33080015
330900     IF ASC-BLOCK-MODIFIED-SW(1) = 'Y'                            33090015
331000        MOVE 1                   TO PV-BLOCK-NUMBER               33100015
331100     ELSE                                                         33110015
331200        MOVE 2                   TO PV-BLOCK-NUMBER               33120015
331300     END-IF.                                                      33130015
331400                                                                  33140015
331500     MOVE ASC-OPR-ID             TO PC000-OPERATING-UNIT-ID       33150015
331600     MOVE ASC-FACT               TO PC000-FACILITY-ID             33160015
331700     MOVE ASC-PO-NBR             TO PC000-PO-NBR-N                33170015
331800     MOVE ASC-REC-SEQ-NBR        TO PC000-REC-SEQ-NBR-N           33180015
331900     MOVE PC-WORK-ORDER-DIST-SHEET                                33190015
332000                                 TO PC000-REPORT-ID.              33200015
332100                                                                  33210015
332200     PERFORM VARYING PV-SUB FROM 1 BY 1                           33220015
332300             UNTIL PV-SUB > PC-ITEMS-PER-PANEL                    33230015
332400         IF ASC-SELECTED-SW  (PV-BLOCK-NUMBER PV-SUB) = 'S'       33240015
332500            MOVE ASC-LINE-NUMBER       (PV-BLOCK-NUMBER PV-SUB)   33250015
332600                                 TO PC000-LINE-NBR-N              33260015
332700**-->       ** UPON THE 1ST HIT, END THE LOOP BY BUMPING UP PV-SUB33270015
332800            COMPUTE PV-SUB = PC-ITEMS-PER-PANEL + 1               33280015
332900         END-IF                                                   33290015
333000     END-PERFORM.                                                 33300015
333100                                                                  33310015
333200/                                                                 33320015
333300 7100-DELETE-PROCESS.                                             33330015
333400                                                                  33340015
333500     PERFORM 7110-DELETE-TWRKORD.                                 33350015
333600     PERFORM 7120-DELETE-TWKORIN.                                 33360015
333700*    PERFORM 7130-DELETE-TWOSTAL.                                 33370048
333800     PERFORM 7200-COUNT-TWKORIN.                                  33380015
333900     IF  PV-DB2-COUNT EQUAL ZERO                                  33390015
334000         PERFORM 7300-COMPLETE-RECEIVER                           33400015
334100         PERFORM 7400-COUNT-ZEROLINE-INSTR                        33410015
334200         IF  PV-WO-STOP-COUNT > ZERO                              33420015
334300             PERFORM 7500-SELECT-ZEROLINE-WRKORD                  33430015
334400             PERFORM 7600-UPDATE-WKORIN-DATES                     33440015
334500         END-IF                                                   33450015
334600     END-IF.                                                      33460015
334700                                                                  33470015
334800/                                                                 33480015
334900/                                                                 33490015
335000*----------------------------------------------------------------*33500015
335100*    "DELETE" THE CURRENT TWRKORD ROW - MAKE INACTIVE.           *33510015
335200*----------------------------------------------------------------*33520015
335300                                                                  33530015
335400 7110-DELETE-TWRKORD.                                             33540015
335500                                                                  33550015
335600     EXEC SQL                                                     33560015
335700          UPDATE                                                  33570015
335800                TWRKORD                                           33580015
335900          SET   VER_STATUS_CDE     =  :PC-INACTIVE                33590015
336000              , CRE_UID_ID         =  :PC-CURRENT-PROGRAM-NAME    33600015
336100          WHERE                                                   33610015
336200                ORD_NBR            =  :DK-ORD-NBR                 33620015
336300          AND   ORD_LNE_NBR        =  :DK-LINE-NBR                33630015
336400          AND   RCVR_SEQ_NBR       =  :DK-RCVR-SEQ-NBR            33640015
336500          AND   OPER_UNT_ID        =  :DK-OPR-ID                  33650015
336600          AND   FCLTY_ID           =  :DK-FACT                    33660015
336700          AND   VER_STATUS_CDE     =  :PC-A                       33670015
336800     END-EXEC.                                                    33680015
336900                                                                  33690015
337000     EVALUATE TRUE                                                33700015
337100         WHEN SQLCODE = ZERO                                      33710015
337200         WHEN SQLCODE = +100                                      33720015
337300              CONTINUE                                            33730015
337400         WHEN SQLWARN0 NOT = SPACE                                33740015
337500         WHEN SQLCODE NOT = ZERO                                  33750015
337600              MOVE '7110-DELETE-TWRKORD'                          33760015
337700                               TO DP013-PARAGRAPH                 33770015
337800              MOVE 'UPDATE TWRKORD STATUS CODE, UID; TO INACTIVE' 33780015
337900                               TO DP013-MESSAGE-TEXT (1)          33790015
338000              MOVE SQLCA       TO DP013-SQLCA                     33800015
338100              MOVE 'TWRKORD'   TO DP013-DB2-TABLE-NAME (1)        33810015
338200              SET DP013-DB2-ABEND                                 33820015
338300                               TO TRUE                            33830015
338400              PERFORM DP013-0000-PROCESS-ABEND                    33840015
338500     END-EVALUATE.                                                33850015
338600/                                                                 33860015
338700*----------------------------------------------------------------*33870015
338800*    "DELETE" THE CURRENT TWKORIN ROW - MAKE INACTIVE.           *33880015
338900*----------------------------------------------------------------*33890015
339000                                                                  33900015
339100 7120-DELETE-TWKORIN.                                             33910015
339200                                                                  33920015
339300     EXEC SQL                                                     33930015
339400          UPDATE                                                  33940015
339500                TWKORIN                                           33950015
339600          SET   VER_STATUS_CDE     =  :PC-INACTIVE                33960015
339700              , CRE_UID_ID         =  :PC-CURRENT-PROGRAM-NAME    33970015
339800          WHERE                                                   33980015
339900                ORD_NBR            =  :DK-ORD-NBR                 33990015
340000          AND   ORD_LNE_NBR        =  :DK-LINE-NBR                34000015
340100          AND   RCVR_SEQ_NBR       =  :DK-RCVR-SEQ-NBR            34010015
340200          AND   OPER_UNT_ID        =  :DK-OPR-ID                  34020015
340300          AND   FCLTY_ID           =  :DK-FACT                    34030015
340400          AND   VER_STATUS_CDE     =  :PC-A                       34040015
340500     END-EXEC.                                                    34050015
340600                                                                  34060015
340700     EVALUATE TRUE                                                34070015
340800         WHEN SQLCODE = ZERO                                      34080015
340900         WHEN SQLCODE = +100                                      34090015
341000              CONTINUE                                            34100015
341100         WHEN SQLWARN0 NOT = SPACE                                34110015
341200         WHEN SQLCODE NOT = ZERO                                  34120015
341300              MOVE '7120-DELETE-TWKORIN'                          34130015
341400                               TO DP013-PARAGRAPH                 34140015
341500              MOVE 'UPDATE TWKORIN STATUS CODE, UID; TO INACTIVE' 34150015
341600                               TO DP013-MESSAGE-TEXT (1)          34160015
341700              MOVE SQLCA       TO DP013-SQLCA                     34170015
341800              MOVE 'TWKORIN'   TO DP013-DB2-TABLE-NAME (1)        34180015
341900              SET DP013-DB2-ABEND                                 34190015
342000                               TO TRUE                            34200015
342100              PERFORM DP013-0000-PROCESS-ABEND                    34210015
342200     END-EVALUATE.                                                34220015
342300/                                                                 34230015
342400*----------------------------------------------------------------*34240015
342500*    "DELETE" THE CURRENT TWOSTAL ROW - MAKE INACTIVE.           *34250015
342600*----------------------------------------------------------------*34260015
342700                                                                  34270015
342800*7130-DELETE-TWOSTAL.                                             34280048
342900*                                                                 34290048
343000*    EXEC SQL                                                     34300048
343100*         UPDATE                                                  34310048
343200*               TWOSTAL                                           34320048
343300*         SET   VER_STATUS_CDE     =  :PC-INACTIVE                34330048
343400*             , CRE_UID_ID         =  :PC-CURRENT-PROGRAM-NAME    34340048
343500*         WHERE                                                   34350048
343600*               ORD_NBR            =  :DK-ORD-NBR                 34360048
343700*         AND   ORD_LNE_NBR        =  :DK-LINE-NBR                34370048
343800*         AND   RCVR_SEQ_NBR       =  :DK-RCVR-SEQ-NBR            34380048
343900*         AND   OPER_UNT_ID        =  :DK-OPR-ID                  34390048
344000*         AND   FCLTY_ID           =  :DK-FACT                    34400048
344100*         AND   VER_STATUS_CDE     =  :PC-A                       34410048
344200*    END-EXEC.                                                    34420048
344300                                                                  34430015
344400*    EVALUATE TRUE                                                34440048
344500*        WHEN SQLCODE = ZERO                                      34450048
344600*        WHEN SQLCODE = +100                                      34460048
344700*             CONTINUE                                            34470048
344800*        WHEN SQLWARN0 NOT = SPACE                                34480048
344900*        WHEN SQLCODE NOT = ZERO                                  34490048
345000*             MOVE '7130-DELETE-TWOSTAL'                          34500048
345100*                              TO DP013-PARAGRAPH                 34510048
345200*             MOVE 'UPDATE TWOSTAL STATUS CODE, UID; TO INACTIVE' 34520048
345300*                              TO DP013-MESSAGE-TEXT (1)          34530048
345400*             MOVE SQLCA       TO DP013-SQLCA                     34540048
345500*             MOVE 'TWOSTAL'   TO DP013-DB2-TABLE-NAME (1)        34550048
345600*             SET DP013-DB2-ABEND                                 34560048
345700*                              TO TRUE                            34570048
345800*             PERFORM DP013-0000-PROCESS-ABEND                    34580048
345900*    END-EVALUATE.                                                34590048
346000*                                                                 34600048
346100*----------------------------------------------------------------*34610015
346200*    SEE IF THERE ARE ANY OTHER ORDERS TO COMPLETE.              *34620015
346300*----------------------------------------------------------------*34630015
346400                                                                  34640015
346500 7200-COUNT-TWKORIN.                                              34650015
346600                                                                  34660015
346700     MOVE ZERO            TO PV-DB2-COUNT.                        34670015
346800     EXEC SQL                                                     34680015
346900          SELECT                                                  34690015
347000                COUNT(*)                                          34700015
347100          INTO                                                    34710015
347200                :PV-DB2-COUNT :PV-NULL-IND                        34720015
347300          FROM                                                    34730015
347400                TWKORIN                                           34740015
347500          WHERE                                                   34750015
347600                ORD_NBR            =  :DK-ORD-NBR                 34760015
347700            AND RCVR_SEQ_NBR       =  :DK-RCVR-SEQ-NBR            34770015
347800            AND OPER_UNT_ID        =  :DK-OPR-ID                  34780015
347900            AND FCLTY_ID           =  :DK-FACT                    34790015
348000            AND ORD_LNE_NBR        >  0                           34800015
348100            AND VER_STATUS_CDE     =  :PC-A                       34810015
348200            AND STOP_TMST          =  :PC-DB2-DEFAULT-DATE        34820015
348300     END-EXEC.                                                    34830015
348400                                                                  34840015
348500     EVALUATE TRUE                                                34850015
348600         WHEN SQLCODE = ZERO                                      34860015
348700         WHEN SQLCODE = +100                                      34870015
348800              CONTINUE                                            34880015
348900         WHEN SQLCODE = -904                                      34890015
349000         WHEN SQLCODE = -911                                      34900015
349100         WHEN SQLCODE = -913                                      34910015
349200              PERFORM 9900-SOFT-ABORT                             34920015
349300         WHEN SQLWARN0 NOT = SPACE                                34930015
349400         WHEN SQLCODE NOT = ZERO                                  34940015
349500              MOVE '7200-COUNT-TWKORIN'                           34950015
349600                               TO DP013-PARAGRAPH                 34960015
349700              MOVE 'COUNT NUMBER OF WORK ORDERS NOT COMPLETE'     34970015
349800                               TO DP013-MESSAGE-TEXT (1)          34980015
349900              MOVE SQLCA       TO DP013-SQLCA                     34990015
350000              MOVE 'TRECITM '  TO DP013-DB2-TABLE-NAME (1)        35000015
350100              SET DP013-DB2-ABEND                                 35010015
350200                               TO TRUE                            35020015
350300              PERFORM DP013-0000-PROCESS-ABEND                    35030015
350400     END-EVALUATE.                                                35040015
350500/                                                                 35050015
350600*----------------------------------------------------------------*35060015
350700*    SET THE STATUS CODE TO COMPLETE FOR THIS RECEIVER.          *35070015
350800*    RATHER THAN JUST UPDATING THE "CURRENT" ROW, WE MUST        *35080015
350900*    SET THE VER_STATUS_CODE TO INACTIVE, AND INSERT A NEW       *35090015
351000*    ROW WITH THE PROPER STATUS CODE.                            *35100015
351100*----------------------------------------------------------------*35110015
351200                                                                  35120015
351300 7300-COMPLETE-RECEIVER.                                          35130015
351400                                                                  35140015
351500     PERFORM 7310-LINK-AUDIT-MODULE.                              35150015
351600     PERFORM 7320-UPDATE-TRECEIV.                                 35160015
351700/                                                                 35170015
351800*----------------------------------------------------------------*35180015
351900*    LINK TO AUDIT MODULE * RCKCS290                             *35190015
352000*----------------------------------------------------------------*35200015
352100                                                                  35210015
352200 7310-LINK-AUDIT-MODULE.                                          35220015
352300                                                                  35230015
352400     MOVE 'V'              TO RC031-TABLE-TO-AUDIT.               35240015
352500     MOVE 'B'              TO RC031-AUD-TYP-CDE.                  35250015
352600     MOVE 'U'              TO RC031-AUD-FUNC-CDE.                 35260015
352700     MOVE DK-OPR-ID        TO RC031-OPER-UNT-ID.                  35270015
352800     MOVE DK-FACT          TO RC031-FCLTY-ID.                     35280015
352900     MOVE DK-ORD-NBR       TO RC031-PO-NBR.                       35290015
353000     MOVE DK-RCVR-SEQ-NBR  TO RC031-REC-SEQ-NBR.                  35300015
353100                                                                  35310015
353200     EXEC CICS                                                    35320015
353300          LINK PROGRAM  (PC-AUDIT-RTN)                            35330015
353400          COMMAREA (RC031-FIELDS)                                 35340015
353500          LENGTH   (PC-AUDIT-RTN-LENGTH)                          35350015
353600     END-EXEC.                                                    35360015
353700                                                                  35370015
353800     EVALUATE TRUE                                                35380015
353900         WHEN RC031-CALL-SUCCESSFUL                               35390015
354000             CONTINUE                                             35400015
354100         WHEN RC031-TRECEIV-REC-NOT-FOUND                         35410015
354200              SET PS-DATA-NOT-OK    TO TRUE                       35420015
354300         WHEN OTHER                                               35430015
354400             MOVE '7310-LINK-AUDIT-MODULE'                        35440015
354500                                 TO DP013-PARAGRAPH               35450015
354600             MOVE 'UNSUCCESSFUL CALL TO AUDIT RTN'                35460015
354700                                 TO DP013-MESSAGE-TEXT (1)        35470015
354800             MOVE RC031-RETURN-DESC                               35480015
354900                                 TO DP013-MESSAGE-TEXT (2)        35490015
355000             MOVE RC031-SQLCA    TO DP013-SQLCA                   35500015
355100             SET DP013-DB2-ABEND                                  35510015
355200                 DP013-XCTL-DISPLAY-RESTART                       35520015
355300                                 TO TRUE                          35530015
355400             PERFORM DP013-0000-PROCESS-ABEND                     35540015
355500     END-EVALUATE.                                                35550015
355600/                                                                 35560015
355700*----------------------------------------------------------------*35570015
355800*    CHANGE THE CURRENT ROW TO NOT ACTIVE.                       *35580015
355900*----------------------------------------------------------------*35590015
356000                                                                  35600015
356100 7320-UPDATE-TRECEIV.                                             35610015
356200                                                                  35620015
356300     EXEC SQL                                                     35630015
356400          UPDATE                                                  35640015
356500                TRECEIV                                           35650015
356600          SET   STATUS_CDE         =  :PC-CM                      35660015
356700               ,VER_STATUS_CDE     =  :PC-A                       35670015
356800               ,UPD_TMST           =  CURRENT TIMESTAMP           35680015
356900               ,UPD_UID            =  :DP020-USERID               35690015
357000               ,UPD_PGM_ID         =  :PC-CURRENT-PROGRAM-NAME    35700015
357100          WHERE                                                   35710015
357200                ORD_NBR            =  :DK-ORD-NBR                 35720015
357300          AND   REC_SEQ_NBR        =  :DK-RCVR-SEQ-NBR            35730015
357400          AND   OPER_UNT_ID        =  :DK-OPR-ID                  35740015
357500          AND   FCLTY_ID           =  :DK-FACT                    35750015
357600          AND   VER_STATUS_CDE     =  :PC-A                       35760015
357700     END-EXEC.                                                    35770015
357800                                                                  35780015
357900     EVALUATE TRUE                                                35790015
358000         WHEN SQLCODE = ZERO                                      35800015
358100              CONTINUE                                            35810015
358200         WHEN SQLCODE = -904                                      35820015
358300         WHEN SQLCODE = -911                                      35830015
358400         WHEN SQLCODE = -913                                      35840015
358500              SET PS-UPDATES-DONE TO TRUE                         35850015
358600              PERFORM 9900-SOFT-ABORT                             35860015
358700         WHEN SQLWARN0 NOT = SPACE                                35870015
358800         WHEN SQLCODE NOT = ZERO                                  35880015
358900              MOVE '7532-UPDATE-TRECEIV'                          35890015
359000                               TO DP013-PARAGRAPH                 35900015
359100              MOVE 'UPDATE TRECEIV STATUS CODE'                   35910015
359200                               TO DP013-MESSAGE-TEXT (1)          35920015
359300              MOVE SQLCA       TO DP013-SQLCA                     35930015
359400              MOVE 'TRECEIV '  TO DP013-DB2-TABLE-NAME (1)        35940015
359500              SET DP013-DB2-ABEND                                 35950015
359600                               TO TRUE                            35960015
359700              PERFORM DP013-0000-PROCESS-ABEND                    35970015
359800     END-EVALUATE.                                                35980015
359900                                                                  35990015
360000 7400-COUNT-ZEROLINE-INSTR.                                       36000015
360100                                                                  36010015
360200     MOVE ZERO            TO PV-WO-STOP-COUNT.                    36020015
360300     EXEC SQL                                                     36030015
360400          SELECT                                                  36040015
360500                COUNT(*)                                          36050015
360600          INTO                                                    36060015
360700                :PV-WO-STOP-COUNT :PV-NULL-IND                    36070015
360800          FROM                                                    36080015
360900                TWKORIN                                           36090015
361000          WHERE                                                   36100015
361100                ORD_NBR            =  :DK-ORD-NBR                 36110015
361200          AND   ORD_LNE_NBR        =  0                           36120015
361300          AND   RCVR_SEQ_NBR       =  :DK-RCVR-SEQ-NBR            36130015
361400          AND   OPER_UNT_ID        =  :DK-OPR-ID                  36140015
361500          AND   FCLTY_ID           =  :DK-FACT                    36150015
361600          AND   VER_STATUS_CDE     =  :PC-A                       36160015
361700          AND   DATE(STOP_TMST)    =  DATE(:PC-DEF-DATE)          36170015
361800     END-EXEC.                                                    36180015
361900                                                                  36190015
362000     EVALUATE TRUE                                                36200015
362100         WHEN SQLCODE = ZERO                                      36210015
362200         WHEN SQLCODE = +100                                      36220015
362300              CONTINUE                                            36230015
362400         WHEN SQLCODE = -904                                      36240015
362500         WHEN SQLCODE = -911                                      36250015
362600         WHEN SQLCODE = -913                                      36260015
362700              PERFORM 9900-SOFT-ABORT                             36270015
362800         WHEN SQLWARN0 NOT = SPACE                                36280015
362900         WHEN SQLCODE NOT = ZERO                                  36290015
363000              MOVE '7400-COUNT-ZEROLINE-INSTR'                    36300015
363100                               TO DP013-PARAGRAPH                 36310015
363200              MOVE 'COUNT NUMBER OF 0 LINE INSTR NOT COMPLETE'    36320015
363300                               TO DP013-MESSAGE-TEXT (1)          36330015
363400              MOVE SQLCA       TO DP013-SQLCA                     36340015
363500              MOVE 'TWKORIN '  TO DP013-DB2-TABLE-NAME (1)        36350015
363600              SET DP013-DB2-ABEND                                 36360015
363700                               TO TRUE                            36370015
363800              PERFORM DP013-0000-PROCESS-ABEND                    36380015
363900     END-EVALUATE.                                                36390015
364000/                                                                 36400015
364100 7500-SELECT-ZEROLINE-WRKORD.                                     36410015
364200                                                                  36420015
364300     EXEC SQL                                                     36430015
364400          SELECT                                                  36440015
364500                ACTL_CART_CNT                                     36450015
364600          INTO                                                    36460015
364700               :WRKORD-ACTL-CART-CNT                              36470015
364800          FROM                                                    36480015
364900                TWRKORD                                           36490015
365000          WHERE                                                   36500015
365100                ORD_NBR            =  :DK-ORD-NBR                 36510015
365200          AND   ORD_LNE_NBR        =  0                           36520015
365300          AND   RCVR_SEQ_NBR       =  :DK-RCVR-SEQ-NBR            36530015
365400          AND   WORK_ORD_SEQ_NBR   =  :DK-WORK-ORD-SEQ-NBR        36540015
365500          AND   OPER_UNT_ID        =  :DK-OPR-ID                  36550015
365600          AND   FCLTY_ID           =  :DK-FACT                    36560015
365700          AND   VER_STATUS_CDE     =  :PC-A                       36570015
365800     END-EXEC.                                                    36580015
365900                                                                  36590015
366000     EVALUATE TRUE                                                36600015
366100         WHEN SQLCODE = ZERO                                      36610015
366200              CONTINUE                                            36620015
366300         WHEN SQLCODE = -904                                      36630015
366400         WHEN SQLCODE = -911                                      36640015
366500         WHEN SQLCODE = -913                                      36650015
366600              PERFORM 9900-SOFT-ABORT                             36660015
366700         WHEN SQLCODE = +100                                      36670015
366800              SET PS-DATA-NOT-OK    TO TRUE                       36680015
366900         WHEN SQLWARN0 NOT = SPACE                                36690015
367000         WHEN SQLCODE NOT = ZERO                                  36700015
367100              MOVE '7500-SELECT-ZEROLINE-WRKORD'                  36710015
367200                               TO DP013-PARAGRAPH                 36720015
367300              MOVE 'SELECT TWRKORD'                               36730015
367400                               TO DP013-MESSAGE-TEXT (1)          36740015
367500              MOVE SQLCA       TO DP013-SQLCA                     36750015
367600              MOVE 'TWRKORD'   TO DP013-DB2-TABLE-NAME (1)        36760015
367700              SET DP013-DB2-ABEND                                 36770015
367800                               TO TRUE                            36780015
367900              PERFORM DP013-0000-PROCESS-ABEND                    36790015
368000     END-EVALUATE.                                                36800015
368100/                                                                 36810015
368200*----------------------------------------------------------------*36820015
368300*    STEP THROUGH ALL ROWS RETURNED FROM THE CURSOR.             *36830015
368400*    UPDATE THE TWRKORD ROW TO COMPLETE.                         *36840015
368500*----------------------------------------------------------------*36850015
368600                                                                  36860015
368700 7600-UPDATE-WKORIN-DATES.                                        36870015
368800                                                                  36880015
368900     PERFORM 7610-OPEN-WKORIN-CSR.                                36890015
369000     IF  SQLCODE EQUAL ZERO                                       36900015
369100         PERFORM 7620-PROCESS-WKORIN-UPDATES                      36910015
369200             UNTIL SQLCODE NOT EQUAL ZERO                         36920015
369300         PERFORM 7650-CLOSE-WKORIN-CSR                            36930015
369400         MOVE DK-LINE-NBR       TO PV-KEY-LINE-NBR                36940015
369500         MOVE ZERO              TO DK-LINE-NBR                    36950015
369600         PERFORM 7660-COMPLETE-WORK-ORDER                         36960015
369700         MOVE PV-KEY-LINE-NBR   TO DK-LINE-NBR                    36970015
369800     END-IF.                                                      36980015
369900                                                                  36990015
370000/                                                                 37000015
370100*----------------------------------------------------------------*37010015
370200*    HERE WE OPEN THE ZEROLINE CURSOR.                           *37020015
370300*----------------------------------------------------------------*37030015
370400                                                                  37040015
370500 7610-OPEN-WKORIN-CSR.                                            37050015
370600                                                                  37060015
370700     EXEC SQL                                                     37070015
370800          OPEN ZEROLINE                                           37080015
370900     END-EXEC.                                                    37090015
371000                                                                  37100015
371100     EVALUATE TRUE                                                37110015
371200         WHEN SQLCODE = ZERO                                      37120015
371300         WHEN SQLCODE = +100                                      37130015
371400              CONTINUE                                            37140015
371500         WHEN SQLCODE = -904                                      37150015
371600         WHEN SQLCODE = -911                                      37160015
371700         WHEN SQLCODE = -913                                      37170015
371800              PERFORM 9900-SOFT-ABORT                             37180015
371900         WHEN SQLWARN0 NOT = SPACES                               37190015
372000         WHEN SQLCODE < ZERO                                      37200015
372100         WHEN SQLCODE > ZERO                                      37210015
372200             MOVE '7610-OPEN-WKORIN-CSR'                          37220015
372300                                   TO DP013-PARAGRAPH             37230015
372400             MOVE 'OPEN ZEROLINE CURSOR - '                       37240015
372500                                   TO DP013-MESSAGE-TEXT (1)      37250015
372600             MOVE SQLCA        TO DP013-SQLCA                     37260015
372700             MOVE 'TWKORIN '   TO DP013-DB2-TABLE-NAME (1)        37270015
372800                 SET DP013-DB2-ABEND                              37280015
372900                     DP013-XCTL-DISPLAY-RESTART TO TRUE           37290015
373000                 PERFORM DP013-0000-PROCESS-ABEND                 37300015
373100     END-EVALUATE.                                                37310015
373200/                                                                 37320015
373300*----------------------------------------------------------------*37330015
373400*    FETCH, UPDATE, AND INSERT.                                  *37340015
373500*----------------------------------------------------------------*37350015
373600                                                                  37360015
373700 7620-PROCESS-WKORIN-UPDATES.                                     37370015
373800                                                                  37380015
373900     PERFORM 7630-FETCH-ZEROLINE.                                 37390015
374000     IF  SQLCODE EQUAL ZERO                                       37400015
374100         IF  WKORIN-STRT-TMST GREATER PV-DUMMY-TMST               37410015
374200             EXEC SQL                                             37420015
374300                  SET :WKORIN-STRT-TMST = CURRENT TIMESTAMP       37430015
374400             END-EXEC                                             37440015
374500         END-IF                                                   37450015
374600         EXEC SQL                                                 37460015
374700              SET :WKORIN-STOP-TMST = CURRENT TIMESTAMP           37470015
374800         END-EXEC                                                 37480015
374900         PERFORM 7640-UPDATE-ZEROLINE                             37490015
375000     END-IF.                                                      37500015
375100                                                                  37510015
375200 7630-FETCH-ZEROLINE.                                             37520015
375300                                                                  37530015
375400     EXEC SQL                                                     37540015
375500          FETCH                                                   37550015
375600                ZEROLINE                                          37560015
375700          INTO                                                    37570015
375800               :WKORIN-ORD-NBR                                    37580015
375900             , :WKORIN-RCVR-SEQ-NBR                               37590015
376000             , :WKORIN-ORD-LNE-NBR                                37600015
376100             , :WKORIN-WORK-ORD-SEQ-NBR                           37610015
376200             , :WKORIN-OPER-UNT-ID                                37620015
376300             , :WKORIN-FCLTY-ID                                   37630015
376400             , :WKORIN-WO-INSTR-SEQ-NBR                           37640015
376500             , :WKORIN-CRE-TMST                                   37650015
376600             , :WKORIN-VER-STATUS-CDE                             37660015
376700             , :WKORIN-CRE-UID-ID                                 37670015
376800             , :WKORIN-OPER-ID                                    37680015
376900             , :WKORIN-FCLTY-AREA-ID                              37690015
377000             , :WKORIN-PRC-FCLTY-AREA-ID                          37700015
377100             , :WKORIN-EXPTED-CART-CNT                            37710015
377200             , :WKORIN-ACTL-CART-CNT                              37720015
377300             , :WKORIN-ALLOC-IND                                  37730015
377400             , :WKORIN-REPACK-IND                                 37740015
377500             , :WKORIN-STRT-TMST                                  37750015
377600             , :WKORIN-STOP-TMST                                  37760015
377700             , :WKORIN-SCREEN-SEQ-NBR                             37770015
377800             , :WKORIN-LNE-LOC-CDE                                37780015
377900             , :WKORIN-REC-SEL-IND                                37790015
378000     END-EXEC.                                                    37800015
378100                                                                  37810015
378200     EVALUATE TRUE                                                37820015
378300         WHEN SQLCODE = ZERO                                      37830015
378400         WHEN SQLCODE = +100                                      37840015
378500              CONTINUE                                            37850015
378600         WHEN SQLCODE = -904                                      37860015
378700         WHEN SQLCODE = -911                                      37870015
378800         WHEN SQLCODE = -913                                      37880015
378900              PERFORM 9900-SOFT-ABORT                             37890015
379000         WHEN SQLWARN0 NOT = SPACE                                37900015
379100         WHEN SQLCODE NOT = ZERO                                  37910015
379200              MOVE '7630-FETCH-ZEROLINE'                          37920015
379300                               TO DP013-PARAGRAPH                 37930015
379400              MOVE 'FETCH ZEROLINE CUROSR'                        37940015
379500                               TO DP013-MESSAGE-TEXT (1)          37950015
379600              MOVE SQLCA       TO DP013-SQLCA                     37960015
379700              MOVE 'TWKORIN '  TO DP013-DB2-TABLE-NAME (1)        37970015
379800              SET DP013-DB2-ABEND                                 37980015
379900                               TO TRUE                            37990015
380000              PERFORM DP013-0000-PROCESS-ABEND                    38000015
380100     END-EVALUATE.                                                38010015
380200/                                                                 38020015
380300 7640-UPDATE-ZEROLINE.                                            38030015
380400                                                                  38040015
380500     EXEC SQL                                                     38050015
380600          UPDATE TWKORIN                                          38060015
380700          SET   STOP_TMST         =  :WKORIN-STOP-TMST            38070015
380800              , STRT_TMST         =  :WKORIN-STRT-TMST            38080015
380900              , CRE_UID_ID        =  :PC-CURRENT-PROGRAM-NAME     38090015
381000          WHERE                                                   38100015
381100                CURRENT OF ZEROLINE                               38110015
381200     END-EXEC.                                                    38120015
381300                                                                  38130015
381400     EVALUATE TRUE                                                38140015
381500         WHEN SQLCODE = ZERO                                      38150015
381600              CONTINUE                                            38160015
381700         WHEN SQLCODE = -904                                      38170015
381800         WHEN SQLCODE = -911                                      38180015
381900         WHEN SQLCODE = -913                                      38190015
382000              SET PS-UPDATES-DONE TO TRUE                         38200015
382100              PERFORM 9900-SOFT-ABORT                             38210015
382200         WHEN SQLWARN0 NOT = SPACE                                38220015
382300         WHEN SQLCODE NOT = ZERO                                  38230015
382400              MOVE '7057-UPDATE-ZEROLINE'                         38240015
382500                               TO DP013-PARAGRAPH                 38250015
382600              MOVE 'UPDATE START/STOP TIMESTAMPS'                 38260015
382700                               TO DP013-MESSAGE-TEXT (1)          38270015
382800              MOVE SQLCA       TO DP013-SQLCA                     38280015
382900              MOVE 'TWKORIN '  TO DP013-DB2-TABLE-NAME (1)        38290015
383000              SET DP013-DB2-ABEND                                 38300015
383100                               TO TRUE                            38310015
383200              PERFORM DP013-0000-PROCESS-ABEND                    38320015
383300     END-EVALUATE.                                                38330015
383400/                                                                 38340015
383500 7650-CLOSE-WKORIN-CSR.                                           38350015
383600                                                                  38360015
383700     EXEC SQL                                                     38370015
383800          CLOSE ZEROLINE                                          38380015
383900     END-EXEC.                                                    38390015
384000                                                                  38400015
384100     EVALUATE TRUE                                                38410015
384200         WHEN SQLCODE = ZERO                                      38420015
384300         WHEN SQLCODE = +100                                      38430015
384400              CONTINUE                                            38440015
384500         WHEN SQLCODE = -904                                      38450015
384600         WHEN SQLCODE = -911                                      38460015
384700         WHEN SQLCODE = -913                                      38470015
384800              PERFORM 9900-SOFT-ABORT                             38480015
384900         WHEN SQLWARN0 NOT = SPACES                               38490015
385000         WHEN SQLCODE < ZERO                                      38500015
385100         WHEN SQLCODE > ZERO                                      38510015
385200              MOVE '7650-CLOSE-WKORIN-CSR'                        38520015
385300                                   TO DP013-PARAGRAPH             38530015
385400              MOVE 'CLOSE ZEROLINE CURSOR - '                     38540015
385500                                   TO DP013-MESSAGE-TEXT (1)      38550015
385600              MOVE SQLCA       TO DP013-SQLCA                     38560015
385700              MOVE 'TWKORIN '  TO DP013-DB2-TABLE-NAME (1)        38570015
385800              SET DP013-DB2-ABEND                                 38580015
385900                     DP013-XCTL-DISPLAY-RESTART TO TRUE           38590015
386000              PERFORM DP013-0000-PROCESS-ABEND                    38600015
386100     END-EVALUATE.                                                38610015
386200/                                                                 38620015
386300*----------------------------------------------------------------*38630015
386400*    SET THE STATUS CODE TO COMPLETE FOR THIS WORK ORDER.        *38640015
386500*    RATHER THAN JUST UPDATING THE "CURRENT" ROW, WE MUST        *38650015
386600*    SET THE VER_STATUS_CODE TO INACTIVE, AND INSERT A NEW       *38660015
386700*    ROW WITH THE PROPER STATUS CODE.                            *38670015
386800*----------------------------------------------------------------*38680015
386900                                                                  38690015
387000 7660-COMPLETE-WORK-ORDER.                                        38700015
387100                                                                  38710015
387200     PERFORM 7670-UPDATE-TWRKORD.                                 38720015
387300/                                                                 38730015
387400*----------------------------------------------------------------*38740015
387500*    CHANGE THE CURRENT ROW TO NOT ACTIVE.                       *38750015
387600*----------------------------------------------------------------*38760015
387700                                                                  38770015
387800 7670-UPDATE-TWRKORD.                                             38780015
387900                                                                  38790015
388000     EXEC SQL                                                     38800015
388100          UPDATE                                                  38810015
388200                TWRKORD                                           38820015
388300          SET   STAT_CDE           =  :PC-CM                      38830015
388400              , CRE_UID_ID         =  :PC-CURRENT-PROGRAM-NAME    38840015
388500          WHERE                                                   38850015
388600                ORD_NBR            =  :DK-ORD-NBR                 38860015
388700          AND   ORD_LNE_NBR        =  :DK-LINE-NBR                38870015
388800          AND   RCVR_SEQ_NBR       =  :DK-RCVR-SEQ-NBR            38880015
388900          AND   WORK_ORD_SEQ_NBR   =  :DK-WORK-ORD-SEQ-NBR        38890015
389000          AND   OPER_UNT_ID        =  :DK-OPR-ID                  38900015
389100          AND   FCLTY_ID           =  :DK-FACT                    38910015
389200          AND   VER_STATUS_CDE     =  :PC-A                       38920015
389300     END-EXEC.                                                    38930015
389400                                                                  38940015
389500     EVALUATE TRUE                                                38950015
389600         WHEN SQLCODE = ZERO                                      38960015
389700         WHEN SQLCODE = +100                                      38970015
389800              CONTINUE                                            38980015
389900         WHEN SQLCODE = -904                                      38990015
390000         WHEN SQLCODE = -911                                      39000015
390100         WHEN SQLCODE = -913                                      39010015
390200              SET PS-UPDATES-DONE TO TRUE                         39020015
390300              PERFORM 9900-SOFT-ABORT                             39030015
390400         WHEN SQLWARN0 NOT = SPACE                                39040015
390500         WHEN SQLCODE NOT = ZERO                                  39050015
390600              MOVE '7512-UPDATE-TWRKORD'                          39060015
390700                               TO DP013-PARAGRAPH                 39070015
390800              MOVE 'UPDATE TWRKORD STATUS CODE'                   39080015
390900                               TO DP013-MESSAGE-TEXT (1)          39090015
391000              MOVE SQLCA       TO DP013-SQLCA                     39100015
391100              MOVE 'TWRKORD'   TO DP013-DB2-TABLE-NAME (1)        39110015
391200              SET DP013-DB2-ABEND                                 39120015
391300                               TO TRUE                            39130015
391400              PERFORM DP013-0000-PROCESS-ABEND                    39140015
391500     END-EVALUATE.                                                39150015
391600                                                                  39160015
391700******************************************************************39170015
391800* READ AN ITEM FROM THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *39180015
391900******************************************************************39190015
392000 9100-READ-SEL-QUEUE.                                             39200015
392100     EXEC CICS                                                    39210015
392200         READQ TS                                                 39220015
392300             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        39230015
392400             INTO  (PC016-TS-SEL-REC)                             39240015
392500             ITEM  (ASC-SEL-ITEM)                                 39250015
392600             RESP  (PV-CICS-RESP)                                 39260015
392700     END-EXEC.                                                    39270015
392800                                                                  39280015
392900     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        39290015
393000         CONTINUE                                                 39300015
393100     ELSE                                                         39310015
393200         SET DP013-LOGIC-ABEND                                    39320015
393300             DP013-NO-ROLLBACK     TO TRUE                        39330015
393400         MOVE '9100-READ-SEL-QUEUE'                               39340015
393500                                   TO DP013-PARAGRAPH             39350015
393600         MOVE 'ATTEMPTING TO READ TO LIST SELECTIONS TS QUEUE'    39360015
393700                                   TO DP013-MESSAGE-TEXT (1)      39370015
393800         PERFORM DP013-0000-PROCESS-ABEND                         39380015
393900     END-IF.                                                      39390015
394000                                                                  39400015
394100/                                                                 39410015
394200******************************************************************39420015
394300* UPDATE AN ITEM IN THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *39430015
394400******************************************************************39440015
394500 9200-REWRITE-LIST-QUEUE.                                         39450015
394600     EXEC CICS                                                    39460015
394700          WRITEQ TS                                               39470015
394800              QUEUE   (ASC-SEL-QUEUE-NAME-IN)                     39480015
394900              FROM    (PC016-TS-SEL-REC)                          39490015
395000              ITEM    (ASC-SEL-ITEM)                              39500015
395100              RESP    (PV-CICS-RESP)                              39510015
395200              REWRITE                                             39520015
395300     END-EXEC.                                                    39530015
395400                                                                  39540015
395500     IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                    39550015
395600         SET DP013-CICS-ABEND                                     39560015
395700             DP013-NO-ROLLBACK     TO TRUE                        39570015
395800         MOVE '9200-REWRITE-LIST-QUEUE'                           39580015
395900                                   TO DP013-PARAGRAPH             39590015
396000         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   39600015
396100                                   TO DP013-MESSAGE-TEXT (1)      39610015
396200         PERFORM DP013-0000-PROCESS-ABEND                         39620015
396300     END-IF.                                                      39630015
396400                                                                  39640015
396500/                                                                 39650015
396600******************************************************************39660015
396700* READ AN ITEM FROM THE INPUT SELECTED PACK SLIP ITEMS           *39670015
396800* TEMP STORAGE QUEUE.                                            *39680015
396900******************************************************************39690015
397000 9300-READ-PKSL-SEL-QUEUE.                                        39700015
397100                                                                  39710015
397200     EXEC CICS                                                    39720015
397300         READQ TS                                                 39730015
397400             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        39740015
397500             INTO  (RC013-DC-SELECT-RECORD)                       39750015
397600             ITEM  (ASC-SEL-ITEM)                                 39760015
397700             RESP  (PV-CICS-RESP)                                 39770015
397800     END-EXEC.                                                    39780015
397900                                                                  39790015
398000     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        39800015
398100         CONTINUE                                                 39810015
398200     ELSE                                                         39820015
398300         SET DP013-LOGIC-ABEND                                    39830015
398400             DP013-NO-ROLLBACK     TO TRUE                        39840015
398500         MOVE '9300-READ-PKSL-SEL-QUEUE'                          39850015
398600                                   TO DP013-PARAGRAPH             39860015
398700         MOVE 'ATTEMPTING TO READ TO LIST SELECTIONS TS QUEUE'    39870015
398800                                   TO DP013-MESSAGE-TEXT (1)      39880015
398900         PERFORM DP013-0000-PROCESS-ABEND                         39890015
399000     END-IF.                                                      39900015
399100                                                                  39910015
399200/                                                                 39920015
399300******************************************************************39930015
399400* UPDATE AN ITEM IN THE INPUT SELECTED PACK SLIP ITEMS           *39940015
399500* TEMP STORAGE QUEUE.                                            *39950015
399600******************************************************************39960015
399700 9400-REWRITE-PKSL-LIST-QUEUE.                                    39970015
399800                                                                  39980015
399900     EXEC CICS                                                    39990015
400000          WRITEQ TS                                               40000015
400100              QUEUE   (ASC-SEL-QUEUE-NAME-IN)                     40010015
400200              FROM    (RC013-DC-SELECT-RECORD)                    40020015
400300              ITEM    (ASC-SEL-ITEM)                              40030015
400400              RESP    (PV-CICS-RESP)                              40040015
400500              REWRITE                                             40050015
400600     END-EXEC.                                                    40060015
400700                                                                  40070015
400800     IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                    40080015
400900         SET DP013-CICS-ABEND                                     40090015
401000             DP013-NO-ROLLBACK     TO TRUE                        40100015
401100         MOVE '9400-REWRITE-PKSL-LIST-QUEUE'                      40110015
401200                                   TO DP013-PARAGRAPH             40120015
401300         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   40130015
401400                                   TO DP013-MESSAGE-TEXT (1)      40140015
401500         PERFORM DP013-0000-PROCESS-ABEND                         40150015
401600     END-IF.                                                      40160015
401700                                                                  40170015
401800/                                                                 40180015
401900*----------------------------------------------------------------*40190015
402000*    THE DB2 RESOURCE IS NOT AVAILABLE, SET THE ERROR MESSAGE    *40200015
402100*    AND THE ERROR SWITCHES.                                     *40210015
402200*----------------------------------------------------------------*40220015
402300 9900-SOFT-ABORT.                                                 40230015
402400     SET PS-ERROR         TO TRUE.                                40240015
402500     SET DP020-MSG-FATAL  TO TRUE.                                40250015
402600     MOVE PC-TSYMSG-00551 TO DP020-MSG-NUMBER.                    40260015
402700     SET  DP020-NEXT-ACT-APPL-ERROR TO TRUE.                      40270015
402800     MOVE 'PROGRAM EXIT CALL'    TO DP013-MESSAGE-TEXT (1).       40280015
402900     PERFORM 0001-CALL-CICS-ARCH-API.                             40290015
403000                                                                  40300015
403100*----------------------------------------------------------------*40310015
403200*    ABEND PROCESSOR MODULE                                      *40320015
403300*----------------------------------------------------------------*40330015
403400                                                                  40340015
403500     COPY DPPD013.                                                40350015
