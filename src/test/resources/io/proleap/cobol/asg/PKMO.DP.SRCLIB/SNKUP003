000100***************************************************************** 00010056
000200 IDENTIFICATION DIVISION.                                         00020056
000300***************************************************************** 00030056
000400                                                                  00040056
000500 PROGRAM-ID.             SNKUP003.                                00050056
000600 AUTHOR.                 PAT LEE.                                 00060056
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070056
000800 DATE-WRITTEN            05-11-92.                                00080056
000900 DATE-COMPILED.                                                   00090056
001000                                                                  00100056
001100***************************************************************** 00110056
001200*     ASSOCIATE ASN TO PO                                       * 00120056
001300*                                                               * 00130056
001400*  THIS PROGRAM WILL CONTROL THE MATCHING OF ADVANCE SHIP       * 00140056
001500*  NOTICE DETAIL TO A PURCHASE ORDER LINE ITEM.  THIS PROGRAM   * 00150056
001600*  WILL ONLY READ ADVANCE SHIP NOTICES WHICH RELATE TO A PUR-   * 00160056
001700*  CHASE ORDER WHICH EXISTS ON THE PURCHASE ORDER DATABASE.     * 00170056
001800***************************************************************** 00180056
001900*  CHANGE MADE:                                                 * 00190056
002000*                                                               * 00200056
002100***************************************************************** 00210056
002200* CHANGED ??/??/?? BY ??????????????????????????????????????????  00220056
002300*   WR#                                                           00230056
002400*                                                                 00240056
002500*                                                                 00250056
002600***************************************************************** 00260056
002700***************************************************************** 00270056
002800* CHANGED 04/22/93 BY NATALIYA PALATNIK                           00280056
002900*   WR# 1812                                                      00290056
003000***************************************************************** 00300056
003100*                                                                 00310059
003200* CHANGED 11/07/14 BY PRITHIVIRAJ SUBRAMANIAN (COGNIZANT)       * 00320056
003300*              CHANGES THRU OUT THE PROGRAM TO INCREASE SIZE OF * 00330056
003400*              PO# FROM 7 DIGITS TO 8 DIGITS.                   * 00340056
003500*              CHANGE TAGGED WITH *PS 11/07/2014                * 00350056
003600*                                                               * 00360056
003700***************************************************************** 00370056
003710* CHANGED 11/04/2021    BY JIM HUNTER      WR: CHG0263627         00371069
003720* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00372070
003730* MAKING THE CALL DYNAMIC VS STATIC.                              00373070
003760***************************************************************** 00376065
003770* CHANGED 05/05/2022    BY BOB MCASEY      WR: CHG0270359         00377069
003780* ADD WITH UR TO ALL SELECT STATEMENTS IN B100-CHECK-PREPACK,     00378068
003781* S350-GET-TOTAL-RECEIPTS, AND S402-GET-MTCHD-ASSOC-QTY.          00378168
003782* THIS IS IN RESONSE TO INC12098804 WHERE PROGRAM ABENDED WITH    00378268
003790* -911 ON 8/9/21.                                                 00379068
003791***************************************************************** 00379166
003800*                                                                 00380056
003900***************************************************************** 00390056
004000 ENVIRONMENT DIVISION.                                            00400056
004100***************************************************************** 00410056
004200                                                                  00420056
004300 CONFIGURATION SECTION.                                           00430056
004400                                                                  00440056
004500 SOURCE-COMPUTER.        IBM-3090.                                00450056
004600 OBJECT-COMPUTER.        IBM-3090.                                00460056
004700                                                                  00470056
004800 INPUT-OUTPUT SECTION.                                            00480056
004900                                                                  00490056
005000 FILE-CONTROL.                                                    00500056
005100*                                                                 00510056
005200     SELECT ASDTPL-LOAD-FILE                                      00520056
005300         ASSIGN TO OUT01.                                         00530056
005400*                                                                 00540056
005500***************************************************************** 00550056
005600 DATA DIVISION.                                                   00560056
005700***************************************************************** 00570056
005800*                                                                 00580056
005900 FILE SECTION.                                                    00590056
006000*                                                                 00600056
006100 FD  ASDTPL-LOAD-FILE                                             00610056
006200     RECORDING MODE IS F                                          00620056
006300     LABEL RECORDS ARE STANDARD                                   00630056
006400     BLOCK CONTAINS 0 RECORDS                                     00640056
006500     RECORD CONTAINS 45 CHARACTERS                                00650056
006600     DATA RECORD IS ASDTPL-LOAD-RECORD.                           00660056
006700                                                                  00670056
006800 01  ASDTPL-LOAD-RECORD          PIC X(45).                       00680056
006900*                                                                 00690056
007000 WORKING-STORAGE SECTION.                                         00700056
007100*                                                                 00710056
007200 01  FILLER.                                                      00720056
007300     05  FILLER                      PIC  X(36)    VALUE          00730056
007400         ' ***** WORKING STORAGE PGM=SNKUP003 '.                  00740056
007500     05  PGM-COMPILED                PIC  X(20)    VALUE SPACE.   00750056
007600     05  FILLER                      PIC  X(10)    VALUE          00760056
007700         ' LOCATION='.                                            00770056
007800     05  PGM-LOCATION                PIC  X(04)    VALUE SPACE.   00780056
007900     05  FILLER                      PIC  X(06)    VALUE          00790056
008000         ' *****'.                                                00800056
008100/                                                                 00810056
008200 01  PS-PROGRAM-SWITCHES.                                         00820056
008300     05  PS-PRPK-SW                  PIC  X(1)     VALUE 'N'.     00830056
008400         88  PS-PREPACK-PO                         VALUE 'Y'.     00840056
008500         88  PS-NOT-PREPACK-PO                     VALUE 'N'.     00850056
008600     05  PS-END-OF-ASNORD-IND        PIC  X(01)    VALUE 'N'.     00860056
008700         88  PS-END-OF-ASNORD                      VALUE 'Y'.     00870056
008800     05  PS-END-OF-ASNDTL-SKU-IND    PIC  X(01)    VALUE 'N'.     00880056
008900         88  PS-END-OF-ASNDTL-SKU                  VALUE 'Y'.     00890056
009000         88  PS-NOT-END-OF-ASNTL-SKU               VALUE 'N'.     00900056
009100     05  PS-PO-PO-LINE-IND           PIC  X(01)    VALUE 'N'.     00910056
009200         88  PS-MORE-PO-LINES                      VALUE 'N'.     00920056
009300         88  PS-NO-MORE-PO-LINES                   VALUE 'Y'.     00930056
009400     05  PS-END-OF-UNMTCHD-ASNORD-SW PIC  X(01)    VALUE 'N'.     00940056
009500         88  PS-END-OF-UNMTCHD-ASNORD              VALUE 'Y'.     00950056
009600         88  PS-NOT-END-OF-UNMTCHD-ASNORD          VALUE 'N'.     00960056
009700     05  PS-END-OF-MTCHD-ASNORD-SW   PIC  X(01)    VALUE 'N'.     00970056
009800         88  PS-END-OF-MTCHD-ASNORD                VALUE 'Y'.     00980056
009900         88  PS-NOT-END-OF-MTCHD-ASNORD            VALUE 'N'.     00990056
010000     05  PS-ASSOCIATION-IND          PIC  X(01)    VALUE 'N'.     01000056
010100         88  PS-FULL-ASSOCIATION                   VALUE 'F'.     01010056
010200         88  PS-PART-ASSOCIATION                   VALUE 'P'.     01020056
010300         88  PS-NO-ASSOCIATION                     VALUE 'N'.     01030056
010400     05  PS-PRIOR-ASSOCIATION-IND    PIC  X(01)    VALUE 'N'.     01040056
010500         88  PS-PRIOR-ASSOCIATION                  VALUE 'Y'.     01050056
010600         88  PS-NO-PRIOR-ASSOCIATION               VALUE 'N'.     01060056
010700     05  PS-PO-LINE-COMPL-ASSOC-IND  PIC  X(01)    VALUE 'N'.     01070056
010800         88  PS-PO-LINE-COMPL-ASSOC                VALUE 'Y'.     01080056
010900         88  PS-PO-LINE-NOT-COMPL-ASSOC            VALUE 'N'.     01090056
011000     05  PS-NEW-PO-LINE-IND          PIC  X(01)    VALUE 'N'.     01100056
011100         88  PS-NEW-PO-LINE                        VALUE 'Y'.     01110056
011200         88  PS-NOT-NEW-PO-LINE                    VALUE 'N'.     01120056
011300     05  PS-NEW-SKU-IND              PIC  X(01)    VALUE 'N'.     01130056
011400         88  PS-NEW-SKU                            VALUE 'Y'.     01140056
011500         88  PS-NOT-NEW-SKU                        VALUE 'N'.     01150056
011600*                                                                 01160056
011700 01  PC-PROGRAM-CONSTANTS.                                        01170056
011800     05  PC-ILBOABN0                 PIC  X(08)    VALUE          01180056
011900                                                   'ILBOABN0'.    01190056
012000     05  PC-POS-7                    PIC S9(04)    VALUE +7       01200056
012100                                                   COMP SYNC.     01210056
012200*PS 11/07/2014 CHANGE STARTS                                      01220056
012300     05  PC-POS-8                    PIC S9(04)    VALUE +8       01230056
012400                                                   COMP SYNC.     01240056
012500*PS 11/07/2014 CHANGE ENDS                                        01250056
012600     05  PC-NEG-1                    PIC S9(04)    VALUE -1       01260056
012700                                                   COMP SYNC.     01270056
012800     05  PC-NEG-904                  PIC S9(04)    VALUE -904     01280056
012900                                                   COMP SYNC.     01290056
013000     05  PC-NEG-913                  PIC S9(04)    VALUE -913     01300056
013100                                                   COMP SYNC.     01310056
013200     05  PC-CMD-CODE-D               PIC  X(02)    VALUE 'D-'.    01320056
013300     05  PC-OPERCO-NBR               PIC  X(02)    VALUE '03'.    01330056
013400     05  PC-ROW-NOT-FOUND            PIC S9(04)    VALUE +100     01340056
013500                                                   COMP SYNC.     01350056
013600     05  PC-ASTERISK                 PIC  X(60)    VALUE          01360056
013700         '*******************************************'.           01370056
013800     05  PC-NO-ASN-ORDERS            PIC  X(60)    VALUE          01380056
013900         'NO UNMATCHED ASN PURCHASE ORDERS WERE FOUND'.           01390056
014000     05  PC-P                        PIC  X(01)    VALUE 'P'.     01400056
014100     05  PC-Y                        PIC  X(01)    VALUE 'Y'.     01410056
014200     05  PC-C                        PIC  X(01)    VALUE 'C'.     01420056
014300*                                                                 01430056
014400 01  PV-NULLS-TABLE.                                              01440056
014500     05  PV-TOT-SHIPT-QTY-NULL        PIC S9(04)     VALUE +0     01450056
014600                                                     COMP SYNC.   01460056
014700     05  PV-VER-QTY-NULL              PIC S9(04)     VALUE +0     01470056
014800                                                     COMP SYNC.   01480056
014900     05  PV-ITM-SUBST-UPC-NBR-NULL    PIC S9(04)     VALUE +0     01490056
015000                                                     COMP SYNC.   01500056
015100/                                                                 01510056
015200*                                                                 01520056
015300 01  PV-PROGRAM-VARIABLES.                                        01530056
015400     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     01540056
015500                                                   COMP SYNC.     01550056
015600     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  01560056
015700*PS 11/07/2014 CHANGE STARTS                                      01570056
015800     05  PV-NUMERIC-PO-NBR           PIC  9(08)    VALUE ZERO.    01580056
015900*PS 11/07/2014 CHANGE ENDS                                        01590056
016000     05  PV-NUMERIC-PACK-ID          PIC S9(4)     COMP           01600056
016100                                                   VALUE +0.      01610056
016200     05  PV-INTEGER-PO-NBR           PIC S9(09)    COMP           01620056
016300                                                   VALUE +0.      01630056
016400     05  PV-INTEGER-PO-LNE-NBR       PIC S9(09)    COMP           01640056
016500                                                   VALUE +0.      01650056
016600     05  PV-UNMTCHD-ASNHDR-NBR       PIC  X(30)    VALUE SPACES.  01660056
016700     05  PV-MTCHD-ASNHDR-NBR         PIC  X(30)    VALUE SPACES.  01670056
016800     05  PV-QTY-TO-ASSOCIATE         PIC S9(09)    VALUE ZERO     01680056
016900                                                   COMP-3.        01690056
017000     05  PV-TOTAL-CURRENT-ASN-SHIPT-QTY                           01700056
017100                                     PIC S9(09)    VALUE ZERO     01710056
017200                                                   COMP-3.        01720056
017300     05  PV-TOTAL-PRIOR-ASN-SHIPT-QTY                             01730056
017400                                     PIC S9(09)    VALUE ZERO     01740056
017500                                                   COMP-3.        01750056
017600     05  PV-TOTAL-PO-VERIFIED-QTY    PIC S9(09)    VALUE ZERO     01760056
017700                                                   COMP-3.        01770056
017800     05  PV-TOTAL-RECEIPTS           PIC S9(09)    VALUE ZERO     01780056
017900                                                   COMP-3.        01790056
018000     05  PV-QTY-REMAINING            PIC S9(09)    VALUE ZERO     01800056
018100                                                   COMP-3.        01810056
018200     05  PV-ASSOC-QTY                PIC S9(09)    VALUE ZEROES   01820056
018300                                                   COMP-3.        01830056
018400     05  PV-PO-NBR                   PIC  X(22)    VALUE SPACES.  01840056
018500     05  PV-PO-LINE                  PIC S9(03)    VALUE ZEROES   01850056
018600                                                   COMP-3.        01860056
018700     05  PV-LAST-PO-LINE             PIC S9(03)    VALUE ZEROES   01870056
018800                                                   COMP-3.        01880056
018900     05  PV-CURRENT-ASSOC-QTY        PIC S9(09)    VALUE ZERO     01890056
019000                                                   COMP-3.        01900056
019100     05  PV-PRIOR-ASSOC-QTY          PIC S9(09)    VALUE ZERO     01910056
019200                                                   COMP-3.        01920056
019300     05  PV-SAVE-PRIOR-SUM-FIELDS.                                01930056
019400         10  PV-PRIOR-OPERCO-NBR     PIC X(2)      VALUE SPACES.  01940056
019500         10  PV-PRIOR-EDI-VEND-ID    PIC X(17)     VALUE SPACES.  01950056
019600         10  PV-PRIOR-PO-NBR         PIC X(22)     VALUE SPACES.  01960056
019700         10  PV-PRIOR-PO-LINE        PIC S9(03)    VALUE ZEROES   01970056
019800                                                   COMP-3.        01980056
019900         10  PV-PRIOR-MERCH-DEPT     PIC X(3)      VALUE SPACES.  01990056
020000         10  PV-PRIOR-MERCH-CLASS    PIC X(2)      VALUE SPACES.  02000056
020100         10  PV-PRIOR-SEQ-NMBR       PIC X(3)      VALUE SPACES.  02010056
020200     05  PV-ASDTPL-WRITTEN           PIC S9(9)     VALUE ZEROS.   02020056
020300     05  PV-PRIOR-SKU                PIC 9(9)      VALUE 0.       02030056
020400     05  PV-PRIOR-SUBST-UPC          PIC X(12)     VALUE SPACES.  02040056
020500*----------------------------------------------------------------*02050056
020600* ADDED NEW VARIABLES                          ** WR # 230ZZ     *02060056
020700*----------------------------------------------------------------*02070056
020800     05  PV-ITM-NBR                  PIC  S9(15)V COMP-3          02080056
020900                                                  VALUE ZEROS.    02090056
021000*CHG109545 - START                                                02100059
021100*    05  PV-DEPT-TEMP-9              PIC  9(03)   VALUE ZEROS.    02110056
021200*    05  PV-DEPT-TEMP                PIC  X(3)    VALUE ZEROS.    02120056
021300*CHG109545 - END                                                  02130059
021400                                                                  02140056
021500 01  PV-VALUE1-8.                                                 02150056
021600     05  FILLER                      PIC  X(01)   VALUE SPACE.    02160056
021700     05  PV-VALUE2-8                 PIC  X(07)   VALUE SPACE.    02170056
021710                                                                  02171062
021720 01  PV-DISPLAY-FIELDS.                                           02172062
021730     05  PV-DISPLAY-NBR              PIC 9(09)    VALUE ZERO.     02173062
021800                                                                  02180056
021810 01  DK-DATABASE-KEYS.                                            02181061
021820     05  DK-PO-NBR                    PIC S9(09)     COMP         02182061
021830                                                     VALUE ZEROS. 02183061
021840                                                                  02184061
021900*----------------------------------------------------------------*02190056
022000* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *02200056
022100*----------------------------------------------------------------*02210056
022200/                                                                 02220056
022300 01  OUT01-ASDTPL-LAYOUT.                                         02230056
022400     05  O1-ASNDTL-NBR               PIC S9(7)     VALUE ZEROS    02240056
022500                                                   COMP-3.        02250056
022600     05  O1-PO-LN-NBR                PIC S9(3)     VALUE ZEROS    02260056
022700                                                   COMP-3.        02270056
022800     05  O1-ASSOC-QTY                PIC S9(7)     VALUE ZEROS    02280056
022900                                                   COMP-3.        02290056
023000     05  O1-ASDTPL-ALLOC-IND         PIC X(1)      VALUE SPACES.  02300056
023100     05  O1-SHIPT-VAR-QTY            PIC S9(7)     VALUE ZEROS    02310056
023200                                                   COMP-3.        02320056
023300     05  O1-PR-CHG-EFF-DAY-NBR       PIC S9(2)     VALUE ZEROS    02330056
023400                                                   COMP-3.        02340056
023500     05  O1-PR-VAR-IND               PIC X(1)      VALUE SPACES.  02350056
023600     05  O1-PR-DISC-IND              PIC X(1)      VALUE SPACES.  02360056
023700     05  O1-PO-NBR                   PIC X(22)     VALUE SPACES.  02370056
023800     05  O1-ASNHDR-ID                PIC S9(09)    VALUE ZERO     02380056
023900                                                   COMP.          02390056
024000/                                                                 02400056
024100******************************************************************02410056
024200*       NUMERIC EDIT LAYOUT                                       02420056
024300******************************************************************02430056
024400*                                                                 02440056
024500     COPY DPWS010I.                                               02450056
024600/                                                                 02460056
024700     COPY MAWS900.                                                02470056
024800/                                                                 02480056
024900*  ASN ORDER TABLE LAYOUT                                         02490056
025000*                                                                 02500056
025100     EXEC SQL                                                     02510056
025200         INCLUDE TASNORD                                          02520056
025300     END-EXEC.                                                    02530056
025400/                                                                 02540056
025500*  ASN ITEM DETAIL TABLE LAYOUT                                   02550056
025600*                                                                 02560056
025700     EXEC SQL                                                     02570056
025800         INCLUDE TASNDTL                                          02580056
025900     END-EXEC.                                                    02590056
026000/                                                                 02600056
026100*  MATCH ASN DETAIL ITEM TO THE PO LINE ITEM TABLE LAYOUT         02610056
026200*                                                                 02620056
026300     EXEC SQL                                                     02630056
026400         INCLUDE TASDTPL                                          02640056
026500     END-EXEC.                                                    02650056
026600/                                                                 02660056
026700*  PO TABLE LAYOUT                                                02670056
026800*                                                                 02680056
026900     EXEC SQL                                                     02690056
027000         INCLUDE TPURCHS                                          02700056
027100     END-EXEC.                                                    02710056
027200/                                                                 02720056
027300*  PO LINE TABLE LAYOUT                                           02730056
027400*                                                                 02740056
027500     EXEC SQL                                                     02750056
027600         INCLUDE TPURITM                                          02760056
027700     END-EXEC.                                                    02770056
027800/                                                                 02780056
027900*  TRECDIS TABLE LAYOUT                                           02790056
028000*                                                                 02800056
028100     EXEC SQL                                                     02810056
028200         INCLUDE TRECDIS                                          02820056
028300     END-EXEC.                                                    02830056
028400/                                                                 02840056
028500*  TPOPRPK TABLE LAYOUT                                           02850056
028600*                                                                 02860056
028700     EXEC SQL                                                     02870056
028800         INCLUDE TPOPRPK                                          02880056
028900     END-EXEC.                                                    02890056
029000/                                                                 02900056
029100*  DB2 COMMUNICATION AREA                                         02910056
029200*                                                                 02920056
029300     EXEC SQL                                                     02930056
029400         INCLUDE SQLCA                                            02940056
029500     END-EXEC.                                                    02950056
029600/                                                                 02960056
029700*  DB2 COMMUNICATION AREA2                                        02970056
029800*                                                                 02980056
029900     COPY SQLCA2.                                                 02990056
030000/                                                                 03000056
030100*----------------------------------------------------------------*03010056
030200*  INCLUDED COPY BOOKS OF VIEWS                 **   WR # 230ZZ  *03020056
030300*----------------------------------------------------------------*03030056
030400* * * XLV_UPC VIEW                                                03040056
030500     EXEC SQL                                                     03050056
030600         INCLUDE XLV00003                                         03060056
030700     END-EXEC.                                                    03070056
030800 EJECT                                                            03080056
030900* * * XLV_VND_STYL VIEW                                           03090056
031000     EXEC SQL                                                     03100056
031100         INCLUDE XLV00001                                         03110056
031200     END-EXEC.                                                    03120056
031300 EJECT                                                            03130056
031400* * * XLV_SKU VIEW                                                03140056
031500     EXEC SQL                                                     03150056
031600         INCLUDE XLV00000                                         03160056
031700     END-EXEC.                                                    03170056
031800 EJECT                                                            03180056
031900*----------------------------------------------------------------*03190056
032000* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *03200056
032100*----------------------------------------------------------------*03210056
032200*                                                                 03220056
032300*  CURSOR TO FETCH PREVIOUSLY UNMATCED ASN'S                      03230056
032400*                                                                 03240056
032500*    CHANGE TO INCLUDE CANCELLED OR COMPLETED ORDERS              03250056
032600*                                                                 03260056
032700*                                                                 03270056
032800     EXEC SQL                                                     03280056
032900       DECLARE ASNORD_CURSOR CURSOR FOR                           03290056
033000         SELECT DISTINCT                                          03300056
033100                  PO_NBR,                                         03310056
033200                  ASNHDR_ID                                       03320056
033300           FROM   TASNORD                                         03330056
033400          WHERE   MTCH_PO_CDE  = :PC-P                            03340056
033500             OR   MTCH_PO_CDE  = :PC-C                            03350056
033600       ORDER BY   PO_NBR                                          03360056
033700     END-EXEC.                                                    03370056
033800/                                                                 03380056
033900*----------------------------------------------------------------*03390056
034000* INTRODUCED NEW CURSOR                         **   WR # 230ZZ  *03400056
034100*----------------------------------------------------------------*03410056
034200*                                                                 03420056
034300*  CURSOR TO FETCH DETAIL ITEMS SHIPPED FOR PO                    03430056
034400*                                                                 03440056
034500     EXEC SQL                                                     03450056
034600       DECLARE ASNDTL_SKU_CURSOR CURSOR FOR                       03460056
034700            SELECT A.ASNDTL_NBR,                                  03470056
034800                   A.SHIPT_QTY,                                   03480056
034900                   A.UPC_NBR,                                     03490056
035000                   A.PO_NBR,                                      03500056
035100                   A.ASNHDR_ID,                                   03510056
035200                   A.ITM_SUBST_UPC_NBR,                           03520056
035300                   B.ITM_NBR,                                     03530056
035400                   B.SKU_NBR                                      03540056
035800            FROM   TASNDTL A,                                     03580056
035900                   XLV_SKU B,                                     03590056
036000                   XLV_UPC C                                      03600056
036400           WHERE   A.ASNHDR_ID    = :ASNORD-ASNHDR-ID             03640056
036500             AND   A.PO_NBR       = :ASNORD-PO-NBR                03650056
036600             AND   A.UPC_NBR      =  C.UPC_NBR                    03660056
036700             AND   B.INTR_UPC_ID  =  C.INTR_UPC_ID                03670056
037100        ORDER BY   B.SKU_NBR,                                     03710056
037200                   A.UPC_NBR,                                     03720056
037300                   A.ASNDTL_NBR                                   03730056
037400     END-EXEC.                                                    03740056
037500/                                                                 03750056
037600*----------------------------------------------------------------*03760056
037700* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *03770056
037800*----------------------------------------------------------------*03780056
037900*                                                                 03790056
038000*----------------------------------------------------------------*03800056
038110* NON PRE-PACK PO CURSOR                                          03811061
038200*----------------------------------------------------------------*03820056
038300*  CURSOR TO FETCH PO , PO LINE - USED ONLY FOR NON PREPACK PO    03830061
038400*                                                                 03840056
038500     EXEC SQL                                                     03850056
038600       DECLARE PO_CURSOR CURSOR FOR                               03860056
038700           SELECT      A.DEPT_NBR,                                03870056
038800                       B.PO_NBR,                                  03880056
038900                       B.APP_PO_LNE_NBR,                          03890056
039000                       B.SKU_SEQ_NBR,                             03900056
039100                       B.UNT_QTY,                                 03910056
039200                       B.ITM_NBR,                                 03920061
039210                       CASE B.STATUS_CDE                          03921061
039220                            WHEN 'CA' THEN 'Z'                    03922061
039230                            ELSE 'A'                              03923061
039240                       END AS STATUS_SORT                         03924061
039300                FROM   TPURCHS A,                                 03930056
039400                       TPURITM B                                  03940056
039500               WHERE   A.PO_NBR         = :PV-INTEGER-PO-NBR      03950056
039600                 AND   A.PO_NBR         = B.PO_NBR                03960056
039700                 AND   A.VER_STATUS_CDE = 'A'                     03970056
039800                 AND   B.VER_STATUS_CDE = 'A'                     03980056
040300                 AND   B.ITM_NBR        = :XLV00000-ITM-NBR       04030056
040320                 AND   ((B.PO_PREPK_ID    > 0                     04032064
040330                 AND     A.PKGNG_CDE = 'M')                       04033064
040340                  OR   (B.PO_PREPK_ID = 0                         04034064
040350                 AND    NOT A.PKGNG_CDE = 'M'))                   04035064
040400           ORDER BY    B.PO_NBR,                                  04040056
040410                       STATUS_SORT,                               04041061
040500                       B.APP_PO_LNE_NBR                           04050056
040600     END-EXEC.                                                    04060056
040700*                                                                 04070056
040800*----------------------------------------------------------------*04080056
040900* PRE-PACK PO CURSOR                                              04090056
041000*----------------------------------------------------------------*04100056
041100*  CURSOR TO FETCH PO , PO LINE FOR PRE-PACK PO                   04110056
041200*                                                                 04120056
041300     EXEC SQL                                                     04130056
041400       DECLARE PRPK_CURSOR CURSOR FOR                             04140056
041500           SELECT      A.DEPT_NBR,                                04150056
041600                       B.PO_NBR,                                  04160056
041700                       B.APP_PO_LNE_NBR,                          04170056
041800                       B.SKU_SEQ_NBR,                             04180056
041900                       B.UNT_QTY,                                 04190056
042000                       B.ITM_NBR,                                 04200061
042010                       CASE B.STATUS_CDE                          04201061
042020                            WHEN 'CA' THEN 'Z'                    04202061
042030                            ELSE 'A'                              04203061
042040                       END AS STATUS_SORT                         04204061
042100                FROM   TPURCHS A,                                 04210056
042200                       TPURITM B                                  04220056
042300               WHERE   A.PO_NBR         = :PV-INTEGER-PO-NBR      04230056
042400                 AND   A.PO_NBR         = B.PO_NBR                04240056
042500                 AND   A.VER_STATUS_CDE = 'A'                     04250056
042600                 AND   B.VER_STATUS_CDE = 'A'                     04260056
043100                 AND   B.ITM_NBR        = :XLV00000-ITM-NBR       04310056
043200                 AND   B.PO_PREPK_ID    = :PV-NUMERIC-PACK-ID     04320061
043400           ORDER BY    B.PO_NBR,                                  04340056
043410                       STATUS_SORT,                               04341061
043500                       B.APP_PO_LNE_NBR                           04350056
043600     END-EXEC.                                                    04360056
043700                                                                  04370056
043800 PROCEDURE DIVISION.                                              04380056
043900*                                                                 04390056
044000*                                                                 04400056
044100 A000-MAINLINE-PROCESSING.                                        04410056
044200*                                                                 04420056
044300     DISPLAY '***********************************'.               04430056
044400     DISPLAY '*         S N K U P 0 0 3         *'.               04440056
044500     DISPLAY '***********************************'.               04450056
044600*                                                                 04460056
044700     INITIALIZE DCLXLV00000 DCLXLV00003 DCLTPURITM DCLTPOPRPK.    04470056
044800     INITIALIZE DCLXLV00001 DCLTPURCHS  DCLTASNORD DCLTASNDTL.    04480056
044900     MOVE 'A000'                  TO PGM-LOCATION.                04490056
045000     MOVE 'A000-MAINLINE-PROCESSING'                              04500056
045100                                  TO PV-ABEND-PARAGRAPH.          04510056
045200*    DISPLAY PV-ABEND-PARAGRAPH.                                  04520056
045300*                                                                 04530056
045400     OPEN OUTPUT ASDTPL-LOAD-FILE.                                04540056
045500                                                                  04550056
045600     PERFORM X100-OPEN-ASNORD-CURSOR.                             04560066
045700*                                                                 04570056
045800     PERFORM S100-FETCH-ASNORD-CURSOR.                            04580056
045900*                                                                 04590056
046000     IF SQLCODE = PC-ROW-NOT-FOUND                                04600056
046100         DISPLAY PC-ASTERISK                                      04610056
046200         DISPLAY PC-NO-ASN-ORDERS                                 04620056
046300         DISPLAY PC-ASTERISK                                      04630056
046400     ELSE                                                         04640056
046500         PERFORM A100-PROCESS-ASN                                 04650056
046600           UNTIL PS-END-OF-ASNORD                                 04660056
046700     END-IF.                                                      04670056
046800*                                                                 04680056
046900     PERFORM Y100-CLOSE-ASNORD-CURSOR.                            04690056
047000                                                                  04700056
047100     CLOSE ASDTPL-LOAD-FILE.                                      04710056
047200                                                                  04720056
047210     MOVE PV-ASDTPL-WRITTEN TO PV-DISPLAY-NBR.                    04721062
047300     DISPLAY 'ASDTPL RECORDS WRITTEN: ' PV-DISPLAY-NBR.           04730062
047400*                                                                 04740056
047500     GOBACK.                                                      04750056
047600*                                                                 04760056
047700/                                                                 04770056
047800******************************************************************04780056
047900*  THIS IS THE MAIN CONTROLING PARAGRAPH FOR PROCESSING ASN      *04790056
048000*  INFORMATION.                                                  *04800056
048100******************************************************************04810056
048200 A100-PROCESS-ASN.                                                04820056
048300*                                                                 04830056
048400     MOVE 'A100'                  TO PGM-LOCATION.                04840056
048500     MOVE 'A100-PROCESS-ASN             '                         04850056
048600                                  TO PV-ABEND-PARAGRAPH.          04860056
048700*    DISPLAY PV-ABEND-PARAGRAPH.                                  04870056
048800*                                                                 04880056
048900     PERFORM B000-EDIT-ASNORD-PO-NBR.                             04890056
049000     PERFORM B100-CHECK-PREPACK.                                  04900056
049100                                                                  04910056
049200     PERFORM X200-OPEN-ASNDTL-SKU-CURSOR.                         04920056
049300*                                                                 04930056
049400                                                                  04940056
049500     PERFORM S200-FETCH-ASNDTL-SKU-CURSOR.                        04950056
049600*                                                                 04960056
049700     IF PS-END-OF-ASNDTL-SKU                                      04970056
049800        CONTINUE                                                  04980056
049900     ELSE                                                         04990056
050000*       MOVE XLV00000-SKU-NBR TO PV-PRIOR-SKU                     05000056
050100        MOVE XLV00000-ITM-NBR TO PV-ITM-NBR                       05010056
050200        IF PS-PREPACK-PO AND                                      05020056
050300           (ASNDTL-ITM-SUBST-UPC-NBR = 'SIMPLE--PACK')            05030056
050400           SET PS-NOT-PREPACK-PO TO TRUE                          05040056
050500        END-IF                                                    05050056
050600                                                                  05060056
050700        IF PS-PREPACK-PO                                          05070056
050800*          PERFORM B200-EDIT-ITM-SUBST-UPC-NBR                    05080056
050900           PERFORM X301-OPEN-PRPK-LINE-CURSOR                     05090056
051000        ELSE                                                      05100056
051100           PERFORM X300-OPEN-PO-PO-LINE-CURSOR                    05110056
051200        END-IF                                                    05120056
051300                                                                  05130056
051400        PERFORM C000-ASSOCIATE-ASN-PO                             05140056
051500            UNTIL PS-END-OF-ASNDTL-SKU                            05150056
051600                                                                  05160056
051700        IF PS-PREPACK-PO                                          05170056
051800           PERFORM Y301-CLOSE-PRPK-LINE-CURSOR                    05180056
051900        ELSE                                                      05190056
052000           PERFORM Y300-CLOSE-PO-PO-LINE-CURSOR                   05200056
052100        END-IF                                                    05210056
052200     END-IF.                                                      05220056
052300                                                                  05230056
052400     PERFORM Y200-CLOSE-ASNDTL-SKU-CURSOR.                        05240056
052500*                                                                 05250056
052600     PERFORM S100-FETCH-ASNORD-CURSOR.                            05260056
052700/                                                                 05270056
052800******************************************************************05280056
052900*                                                                *05290056
053000******************************************************************05300056
053100 B000-EDIT-ASNORD-PO-NBR.                                         05310056
053200*                                                                 05320056
053300     MOVE 'B000'                  TO PGM-LOCATION.                05330056
053400     MOVE 'B000-VALIDATE-ASNORD-PO-NBR  '                         05340056
053500                                  TO PV-ABEND-PARAGRAPH.          05350056
053600*    DISPLAY PV-ABEND-PARAGRAPH.                                  05360056
053700*PS 11/07/2014 CHANGE STARTS                                      05370056
053800     IF ASNORD-PO-NBR (8:1) = SPACE                               05380056
053900        MOVE SPACES              TO PV-VALUE2-8                   05390056
054000        MOVE ASNORD-PO-NBR (1:7) TO PV-VALUE2-8                   05400056
054100        MOVE PV-VALUE1-8         TO DP010I-UNEDITED-FIELD         05410056
054200     ELSE                                                         05420056
054300        MOVE ASNORD-PO-NBR (1:8) TO DP010I-UNEDITED-FIELD         05430056
054400     END-IF.                                                      05440056
054500     MOVE PC-POS-8               TO DP010I-MAXIMUM-DIGITS.        05450056
054600*PS 11/07/2014 CHANGE ENDS                                        05460056
054700     MOVE ZERO                   TO DP010I-MAXIMUM-DECIMALS.      05470056
054800     SET DP010I-NEGATIVE-NOT-ALLOWED                              05480056
054900                                 TO TRUE.                         05490056
055010     CALL DP010I-NUMERIC-EDIT-ROUTINE                             05501065
055020          USING DP010I-NUMERIC-EDIT-AREA.                         05502065
055100     MOVE DP010I-NUMERIC-FIELD   TO PV-NUMERIC-PO-NBR             05510056
055200                                     PV-INTEGER-PO-NBR.           05520056
055300                                                                  05530056
055400     IF DP010I-ERROR-DETECTED                                     05540056
055500         DISPLAY 'ERROR EDITING PO NUMBER: '                      05550056
055600             ASNORD-PO-NBR                                        05560056
055700     END-IF.                                                      05570056
055800*                                                                 05580056
055900***************************************************************** 05590056
056000*     CHECK PREPACK                                               05600056
056100*                                                                 05610056
056200***************************************************************** 05620056
056300 B100-CHECK-PREPACK.                                              05630056
056310                                                                  05631061
056400     MOVE PV-INTEGER-PO-NBR TO DK-PO-NBR                          05640063
056401                               POPRPK-PO-NBR.                     05640163
056410                                                                  05641061
056420     EXEC SQL                                                     05642061
056430        SELECT A.PKGNG_CDE                                        05643061
056440          INTO :PURCHS-PKGNG-CDE                                  05644061
056450          FROM TPURCHS A                                          05645061
056460          WHERE A.PO_NBR         = :DK-PO-NBR                     05646063
056470            AND A.VER_STATUS_CDE = 'A'                            05647061
056471          WITH UR                                                 05647167
056480     END-EXEC.                                                    05648061
057100                                                                  05710056
057200     MOVE SQLCODE    TO SQLCODE2.                                 05720056
057300                                                                  05730056
057400     EVALUATE TRUE                                                05740056
057500        WHEN SQLCODE = 0                                          05750056
057600        WHEN SQLCODE = -811                                       05760056
057610             IF  PURCHS-PKGNG-CDE = 'M'                           05761061
057620             OR  PURCHS-PKGNG-CDE = 'I'                           05762061
057621                 SET PS-PREPACK-PO TO TRUE                        05762161
057622             ELSE                                                 05762261
057623                 SET PS-NOT-PREPACK-PO TO TRUE                    05762361
057640             END-IF                                               05764061
057650        WHEN SQLCODE = +100                                       05765061
057660             SET PS-NOT-PREPACK-PO TO TRUE                        05766061
058000     END-EVALUATE.                                                05800056
058100*                                                                 05810056
058200******************************************************************05820056
058300*                                                                *05830056
058400******************************************************************05840056
058500 B200-EDIT-ITM-SUBST-UPC-NBR.                                     05850056
058600*                                                                 05860056
058700     MOVE 'B300'                  TO PGM-LOCATION.                05870056
058800     MOVE 'B200-EDIT-ITM-SUBST-UPC-NBR  '                         05880056
058900                                  TO PV-ABEND-PARAGRAPH.          05890056
059000*    DISPLAY PV-ABEND-PARAGRAPH.                                  05900056
059100                                                                  05910056
059200     MOVE ASNDTL-ITM-SUBST-UPC-NBR TO                             05920056
059300        DP010I-UNEDITED-FIELD.                                    05930056
059400     MOVE 12                     TO DP010I-MAXIMUM-DIGITS.        05940056
059500     MOVE 0                      TO DP010I-MAXIMUM-DECIMALS.      05950056
059600     SET DP010I-NEGATIVE-NOT-ALLOWED                              05960056
059700                                 TO TRUE.                         05970056
059810     CALL DP010I-NUMERIC-EDIT-ROUTINE                             05981065
059820          USING DP010I-NUMERIC-EDIT-AREA.                         05982065
059900     IF DP010I-ERROR-DETECTED                                     05990056
060000        MOVE 0 TO PV-NUMERIC-PACK-ID                              06000056
060100     ELSE                                                         06010056
060200        MOVE DP010I-NUM-FIELD-13-DIG-4-DEC TO                     06020056
060300           PV-NUMERIC-PACK-ID                                     06030056
060400     END-IF.                                                      06040056
060500                                                                  06050056
060600/                                                                 06060056
060700******************************************************************06070056
060800*  THIS IS THE CONTROLING PARAGRAPH FOR ASSOCIATING ASN          *06080056
060900*  DETAIL ITEMS TO PO LINE ITEMS.                                *06090056
061000******************************************************************06100056
061100 C000-ASSOCIATE-ASN-PO.                                           06110056
061200*                                                                 06120056
061300     MOVE 'C000'                  TO PGM-LOCATION.                06130056
061400     MOVE 'C000-ASSOCIATE-ASN-PO' TO PV-ABEND-PARAGRAPH.          06140056
061500*    DISPLAY PV-ABEND-PARAGRAPH.                                  06150056
061600*                                                                 06160056
061700     MOVE ZEROES              TO PV-QTY-TO-ASSOCIATE.             06170056
061800     MOVE SPACES              TO PS-ASSOCIATION-IND.              06180056
061900     MOVE SPACES              TO PS-PRIOR-ASSOCIATION-IND.        06190056
062000     SET  PS-NOT-NEW-PO-LINE  TO TRUE.                            06200056
062100     SET  PS-NOT-NEW-SKU      TO TRUE.                            06210056
062200                                                                  06220056
062300     IF PS-PREPACK-PO                                             06230056
062400        PERFORM S301-FETCH-PRPK-LINE-CURSOR                       06240056
062500     ELSE                                                         06250056
062600        PERFORM S300-FETCH-PO-PO-LINE-CURSOR                      06260056
062700     END-IF.                                                      06270056
062800                                                                  06280056
062900     IF SQLCODE = ZERO                                            06290056
063000*            MOVE XLV00000-SKU-NBR TO PV-PRIOR-SKU                06300056
063100             MOVE PURITM-APP-PO-LNE-NBR  TO PV-PO-LINE            06310056
063200             MOVE ASNDTL-SHIPT-QTY                                06320056
063300                                  TO PV-QTY-TO-ASSOCIATE          06330056
063400                                                                  06340056
063500*----------------------------------------------------------------*06350056
063600* MOVED ITM-NBR INTO PV-ITM-NBR                 **   WR # 230ZZ  *06360056
063700*----------------------------------------------------------------*06370056
063800     MOVE XLV00000-ITM-NBR TO PV-ITM-NBR                          06380056
063900*----------------------------------------------------------------*06390056
064000* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *06400056
064100*----------------------------------------------------------------*06410056
064200                                                                  06420056
064300             PERFORM D000-ASSOCIATE-SHIPT-QTY                     06430056
064400               UNTIL PS-NEW-SKU                                   06440056
064500                  OR PS-END-OF-ASNDTL-SKU                         06450056
064600                  OR SQLCODE = +100                               06460056
064700                                                                  06470056
064800             IF  PS-PART-ASSOCIATION                              06480056
064900                                                                  06490056
065000               AND SQLCODE = +100                                 06500056
065100               AND PS-NOT-NEW-SKU                                 06510056
065200               AND PS-NOT-END-OF-ASNTL-SKU                        06520056
065300                 COMPUTE  O1-ASSOC-QTY                            06530056
065400                        = O1-ASSOC-QTY                            06540056
065500                        + PV-QTY-TO-ASSOCIATE                     06550056
065600                 PERFORM S500-WRITE-ASDTPL-REC                    06560056
065700                                                                  06570056
065800                                                                  06580056
065900                PERFORM UNTIL                                     06590056
066000                  PS-NEW-SKU        OR                            06600056
066100                  PS-END-OF-ASNDTL-SKU                            06610056
066200                                                                  06620056
066300                 PERFORM S200-FETCH-ASNDTL-SKU-CURSOR             06630056
066400                                                                  06640056
066500                 IF SQLCODE = ZERO AND PS-NOT-NEW-SKU             06650056
066600                  MOVE ASNDTL-ASNDTL-NBR TO O1-ASNDTL-NBR         06660056
066700                  MOVE ASNDTL-SHIPT-QTY TO O1-ASSOC-QTY           06670056
066800                  PERFORM S500-WRITE-ASDTPL-REC                   06680056
066900                                                                  06690056
067000                 END-IF                                           06700056
067100                                                                  06710056
067200                END-PERFORM                                       06720056
067300                                                                  06730056
067400             ELSE                                                 06740056
067500                 IF  PS-FULL-ASSOCIATION                          06750056
067600                     PERFORM S500-WRITE-ASDTPL-REC                06760056
067700                                                                  06770056
067800                     IF  PS-PO-LINE-COMPL-ASSOC                   06780056
067900                       AND SQLCODE = +100                         06790056
068000                       AND PS-NOT-NEW-SKU                         06800056
068100                       AND PS-NOT-END-OF-ASNTL-SKU                06810056
068200                         MOVE ASNDTL-ASNDTL-NBR TO O1-ASNDTL-NBR  06820056
068300                         MOVE ASNDTL-SHIPT-QTY TO O1-ASSOC-QTY    06830056
068400                         PERFORM S500-WRITE-ASDTPL-REC            06840056
068500                                                                  06850056
068600                                                                  06860056
068700                        PERFORM UNTIL                             06870056
068800                        PS-NEW-SKU        OR                      06880056
068900                        PS-END-OF-ASNDTL-SKU                      06890056
069000                                                                  06900056
069100                        PERFORM S200-FETCH-ASNDTL-SKU-CURSOR      06910056
069200                                                                  06920056
069300                        IF SQLCODE = ZERO AND PS-NOT-NEW-SKU      06930056
069400                          MOVE ASNDTL-SHIPT-QTY TO O1-ASSOC-QTY   06940056
069500                         MOVE ASNDTL-ASNDTL-NBR TO O1-ASNDTL-NBR  06950056
069600                          PERFORM S500-WRITE-ASDTPL-REC           06960056
069700                                                                  06970056
069800                        END-IF                                    06980056
069900                                                                  06990056
070000                        END-PERFORM                               07000056
070100                     END-IF                                       07010056
070200                                                                  07020056
070300                 END-IF                                           07030056
070400             END-IF                                               07040056
070500     END-IF.                                                      07050056
070600                                                                  07060056
070700     IF PS-NOT-END-OF-ASNTL-SKU                                   07070056
070800         PERFORM S200-FETCH-ASNDTL-SKU-CURSOR                     07080056
070900           UNTIL                                                  07090056
071000              PS-NEW-SKU        OR                                07100056
071100              PS-END-OF-ASNDTL-SKU                                07110056
071200                                                                  07120056
071300         IF PS-NEW-SKU                                            07130056
071400                                                                  07140056
071500             IF PS-PREPACK-PO                                     07150056
071600                PERFORM Y301-CLOSE-PRPK-LINE-CURSOR               07160056
071700*               PERFORM B200-EDIT-ITM-SUBST-UPC-NBR               07170056
071800                PERFORM X301-OPEN-PRPK-LINE-CURSOR                07180056
071900             ELSE                                                 07190056
072000                PERFORM Y300-CLOSE-PO-PO-LINE-CURSOR              07200056
072100                PERFORM X300-OPEN-PO-PO-LINE-CURSOR               07210056
072200             END-IF                                               07220056
072300         END-IF                                                   07230056
072400                                                                  07240056
072500     END-IF.                                                      07250056
072600                                                                  07260056
072700*                                                                 07270056
072800/                                                                 07280056
072900******************************************************************07290056
073000*  THIS PARAGRAPH CONTROLS THE ACTUAL ASSOCIATION OF ASN DETAIL  *07300056
073100*  ITEM TO A PO LINE ITEM.                                       *07310056
073200******************************************************************07320056
073300 D000-ASSOCIATE-SHIPT-QTY.                                        07330056
073400*                                                                 07340056
073500     MOVE 'D000'                  TO PGM-LOCATION.                07350056
073600     MOVE 'D000-ASSOCIATE-SHIPT-QTY     '                         07360056
073700                                  TO PV-ABEND-PARAGRAPH.          07370056
073800*    DISPLAY PV-ABEND-PARAGRAPH.                                  07380056
073900*                                                                 07390056
074000     MOVE ZEROES              TO PV-TOTAL-PO-VERIFIED-QTY.        07400056
074100     MOVE ZEROES              TO PV-TOTAL-PRIOR-ASN-SHIPT-QTY.    07410056
074200     MOVE ZEROES              TO PV-TOTAL-RECEIPTS.               07420056
074300     MOVE ZEROES              TO PV-QTY-REMAINING.                07430056
074400     MOVE ZEROES              TO PV-ASSOC-QTY.                    07440056
074500     MOVE ZEROES              TO PV-CURRENT-ASSOC-QTY.            07450056
074600     MOVE ZEROES              TO PV-TOTAL-CURRENT-ASN-SHIPT-QTY.  07460056
074700     MOVE ZEROES              TO PV-PRIOR-ASSOC-QTY.              07470056
074800*                                                                 07480056
074900     MOVE PV-NUMERIC-PO-NBR       TO PV-PO-NBR.                   07490056
075000*                                                                 07500056
075100* CALC THE TOTAL NUMBER OF UNITS RECEIVED FOR A PO LINE.          07510056
075200     PERFORM S350-GET-TOTAL-RECEIPTS.                             07520056
075300                                                                  07530056
075400* ADD THE TOTAL NUMBER OF UNITS RECEIVED FOR A PO LINE FROM       07540056
075500* PREVIOUS RUNS OF THIS JOB TO THE TOTAL NUMBER OF ASN UNITS      07550056
075600* PROCESSED IN THIS RUN OF THE JOB                                07560056
075700     COMPUTE PV-TOTAL-RECEIPTS                                    07570056
075800               = PV-TOTAL-PO-VERIFIED-QTY                         07580056
075900               + PV-TOTAL-CURRENT-ASN-SHIPT-QTY.                  07590056
076000*                                                                 07600056
076100     SET PS-NOT-NEW-PO-LINE  TO TRUE.                             07610056
076200     PERFORM UNTIL                                                07620056
076300             PS-NEW-SKU            OR                             07630056
076400             PS-NEW-PO-LINE        OR                             07640056
076500             PS-END-OF-ASNDTL-SKU  OR                             07650056
076600             SQLCODE = +100                                       07660056
076700                                                                  07670056
076800               PERFORM S400-SUM-PRIOR-ASN-SHIPT-QTY               07680056
076900*                                                                 07690056
077000               IF PV-TOT-SHIPT-QTY-NULL < ZERO                    07700056
077100                  MOVE ZEROES TO PV-TOTAL-PRIOR-ASN-SHIPT-QTY     07710056
077200               END-IF                                             07720056
077300*                                                                 07730056
077400               IF PV-TOTAL-PO-VERIFIED-QTY >                      07740056
077500                  PV-TOTAL-PRIOR-ASN-SHIPT-QTY                    07750056
077600                    COMPUTE PV-TOTAL-RECEIPTS                     07760056
077700                          = PV-TOTAL-PO-VERIFIED-QTY              07770056
077800                          + PV-TOTAL-CURRENT-ASN-SHIPT-QTY        07780056
077900               ELSE                                               07790056
078000                    COMPUTE PV-TOTAL-RECEIPTS                     07800056
078100                          = PV-TOTAL-PRIOR-ASN-SHIPT-QTY          07810056
078200                          + PV-TOTAL-CURRENT-ASN-SHIPT-QTY        07820056
078300               END-IF                                             07830056
078400                                                                  07840056
078500               MOVE PV-PO-LINE  TO PV-LAST-PO-LINE                07850056
078600                                                                  07860056
078700* SUBTRACT THE TOTAL RECEIPTS FROM THE PO LINE QTY WERE TRYING TO 07870056
078800* ASSOCIATE TO TO SEE HOW MANY UNITS ARE LEFT TO ASSOCIATE.       07880056
078900               COMPUTE PV-QTY-REMAINING                           07890056
079000                         = PURITM-UNT-QTY                         07900056
079100                         - PV-TOTAL-RECEIPTS                      07910056
079200                                                                  07920056
079300* THIS CODE VERIFIES IF WE HAVE OVER VERIFIED A LINE, IF THIS IS  07930056
079400* THE CASE, THE NEXT PO LINE WILL BE READ                         07940056
079500               IF PV-QTY-REMAINING < ZERO                         07950056
079600                   MOVE ZERO TO PV-QTY-REMAINING                  07960056
079700               END-IF                                             07970056
079800* IF THE QTY REMAINING (NUMBER OF UNITS LEFT ON THE PO LINE TO BE 07980056
079900* VERIFIED) IS LESS THAN THE QTY TO ASSOC (NUMBER OF UNITS ON THE 07990056
080000* ASN DETAIL RECORD), THEN WE HAVE NOT FULLY ASSOCIATED ALL ASN   08000056
080100* UNITS TO A COORESPONDING LINE FOR THE PO. THEREFORE ANOTHER     08010056
080200* LINE WITH THE SAME PO # AND SKU MUST BE READ                    08020056
080300                                                                  08030056
080400               IF PV-QTY-REMAINING < PV-QTY-TO-ASSOCIATE          08040056
080500                       MOVE PV-QTY-REMAINING                      08050056
080600                                    TO PV-ASSOC-QTY               08060056
080700                       SET PS-PART-ASSOCIATION                    08070056
080800                                    TO TRUE                       08080056
080900                                                                  08090056
081000               ELSE                                               08100056
081100                       MOVE PV-QTY-TO-ASSOCIATE                   08110056
081200                                    TO PV-ASSOC-QTY               08120056
081300                       SET PS-FULL-ASSOCIATION                    08130056
081400                                    TO TRUE                       08140056
081500                                                                  08150056
081600                       IF PV-QTY-REMAINING = PV-QTY-TO-ASSOCIATE  08160056
081700                           SET PS-PO-LINE-COMPL-ASSOC             08170056
081800                                    TO TRUE                       08180056
081900                                                                  08190056
082000                       ELSE                                       08200056
082100                           SET PS-PO-LINE-NOT-COMPL-ASSOC         08210056
082200                                    TO TRUE                       08220056
082300                                                                  08230056
082400                       END-IF                                     08240056
082500               END-IF                                             08250056
082600                                                                  08260056
082700               IF PS-PRIOR-ASSOCIATION                            08270056
082800                       PERFORM S500-WRITE-ASDTPL-REC              08280056
082900                       PERFORM D100-LOAD-ASDTPL-REC               08290056
083000               ELSE                                               08300056
083100                       SET PS-PRIOR-ASSOCIATION TO TRUE           08310056
083200                       PERFORM D100-LOAD-ASDTPL-REC               08320056
083300               END-IF                                             08330056
083400                                                                  08340056
083500               ADD PV-ASSOC-QTY                                   08350056
083600                               TO PV-TOTAL-CURRENT-ASN-SHIPT-QTY  08360056
083700                                                                  08370056
083800               COMPUTE PV-QTY-TO-ASSOCIATE                        08380056
083900                         = PV-QTY-TO-ASSOCIATE                    08390056
084000                         - PV-ASSOC-QTY                           08400056
084100                                                                  08410056
084200               IF PS-PART-ASSOCIATION                             08420056
084300                  IF PS-PREPACK-PO                                08430056
084400                     PERFORM S301-FETCH-PRPK-LINE-CURSOR          08440056
084500                  ELSE                                            08450056
084600                     PERFORM S300-FETCH-PO-PO-LINE-CURSOR         08460056
084700                  END-IF                                          08470056
084800               ELSE                                               08480056
084900                      IF PS-FULL-ASSOCIATION                      08490056
085000                          PERFORM S200-FETCH-ASNDTL-SKU-CURSOR    08500056
085100                          IF PS-END-OF-ASNDTL-SKU                 08510056
085200                              CONTINUE                            08520056
085300                          ELSE                                    08530056
085400                             IF PS-NEW-SKU                        08540056
085500                           IF PS-PREPACK-PO                       08550056
085600                              PERFORM Y301-CLOSE-PRPK-LINE-CURSOR 08560056
085700*                             PERFORM B200-EDIT-ITM-SUBST-UPC-NBR 08570056
085800                              PERFORM X301-OPEN-PRPK-LINE-CURSOR  08580056
085900                           ELSE                                   08590056
086000                              PERFORM Y300-CLOSE-PO-PO-LINE-CURSOR08600056
086100                              PERFORM X300-OPEN-PO-PO-LINE-CURSOR 08610056
086200                           END-IF                                 08620056
086300                             ELSE                                 08630056
086400                                MOVE ASNDTL-SHIPT-QTY             08640056
086500                                           TO PV-QTY-TO-ASSOCIATE 08650056
086600                                IF PS-PO-LINE-COMPL-ASSOC         08660056
086700                                                                  08670056
086800                           IF PS-PREPACK-PO                       08680056
086900                              PERFORM S301-FETCH-PRPK-LINE-CURSOR 08690056
087000                           ELSE                                   08700056
087100                              PERFORM S300-FETCH-PO-PO-LINE-CURSOR08710056
087200                           END-IF                                 08720056
087300                                                                  08730056
087400                                END-IF                            08740056
087500                             END-IF                               08750056
087600                          END-IF                                  08760056
087700                      END-IF                                      08770056
087800               END-IF                                             08780056
087900     END-PERFORM.                                                 08790056
088000*                                                                 08800056
088100/                                                                 08810056
088200******************************************************************08820056
088300*                                                                *08830056
088400******************************************************************08840056
088500 D100-LOAD-ASDTPL-REC.                                            08850056
088600*                                                                 08860056
088700     MOVE 'D100'                  TO PGM-LOCATION.                08870056
088800     MOVE 'D100-LOAD-ASDTPL-REC         '                         08880056
088900                                  TO PV-ABEND-PARAGRAPH.          08890056
089000*    DISPLAY PV-ABEND-PARAGRAPH.                                  08900056
089100                                                                  08910056
089200                                                                  08920056
089300     MOVE ASNDTL-ASNHDR-ID        TO O1-ASNHDR-ID.                08930056
089400     MOVE ASNDTL-ASNDTL-NBR       TO O1-ASNDTL-NBR.               08940056
089500     MOVE ASNDTL-PO-NBR           TO O1-PO-NBR.                   08950056
089600     MOVE PV-PO-LINE              TO O1-PO-LN-NBR.                08960056
089700     MOVE PV-ASSOC-QTY            TO O1-ASSOC-QTY.                08970056
089800*                                                                 08980056
089900/                                                                 08990056
090000******************************************************************09000056
090100*  FETCHES THE ASN ORDER INFORMATION.                            *09010056
090200******************************************************************09020056
090300 S100-FETCH-ASNORD-CURSOR.                                        09030056
090400*                                                                 09040056
090500     MOVE 'S100'                  TO PGM-LOCATION.                09050056
090600     MOVE 'S100-FETCH-ASNRORD-CURSOR'                             09060056
090700                                  TO PV-ABEND-PARAGRAPH.          09070056
090800*    DISPLAY PV-ABEND-PARAGRAPH.                                  09080056
090900*                                                                 09090056
091000     EXEC SQL                                                     09100056
091100         FETCH ASNORD_CURSOR                                      09110056
091200          INTO  :ASNORD-PO-NBR,                                   09120056
091300                :ASNORD-ASNHDR-ID                                 09130056
091400     END-EXEC.                                                    09140056
091500*                                                                 09150056
091600     MOVE SQLCODE    TO SQLCODE2.                                 09160056
091700*                                                                 09170056
091800     EVALUATE TRUE                                                09180056
091900       WHEN SQLCODE = ZEROS                                       09190056
092000         CONTINUE                                                 09200056
092100       WHEN SQLCODE = PC-ROW-NOT-FOUND                            09210056
092200         SET PS-END-OF-ASNORD     TO TRUE                         09220056
092300       WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                    09230056
092400         DISPLAY '******************************************'     09240056
092500         DISPLAY 'WARNING ISSUED ON FETCH OF ASNORD CURSOR  '     09250056
092600         DISPLAY '******************************************'     09260056
092700         DISPLAY  PV-ABEND-PARAGRAPH                              09270056
092800         PERFORM  Z998-SQL-WARNING                                09280056
092900       WHEN  SQLCODE < ZERO                                       09290056
093000         DISPLAY '******************************************'     09300056
093100         DISPLAY 'ERROR ISSUED ON FETCH OF ASNORD CURSOR    '     09310056
093200         DISPLAY '******************************************'     09320056
093300         DISPLAY  PV-ABEND-PARAGRAPH                              09330056
093400         PERFORM  Z999-SQL-ERROR                                  09340056
093500     END-EVALUATE.                                                09350056
093600*                                                                 09360056
093700/                                                                 09370056
093800******************************************************************09380056
093900*  FETCHES THE ASN DETAIL ITEM AND SKU INFORMATION.              *09390056
094000******************************************************************09400056
094100 S200-FETCH-ASNDTL-SKU-CURSOR.                                    09410056
094200*                                                                 09420056
094300     MOVE 'S200'                  TO PGM-LOCATION.                09430056
094400     MOVE 'S200-FETCH-ASNDTL-SKU-CURSOR'                          09440056
094500                                  TO PV-ABEND-PARAGRAPH.          09450056
094600     MOVE XLV00000-SKU-NBR TO PV-PRIOR-SKU.                       09460056
094700     MOVE ASNDTL-ITM-SUBST-UPC-NBR TO PV-PRIOR-SUBST-UPC.         09470056
094800                                                                  09480056
094900*    DISPLAY PV-ABEND-PARAGRAPH.                                  09490056
095000*                                                                 09500056
095100*----------------------------------------------------------------*09510056
095200* REPLACED WITH NEW FETCH                       **   WR # 230ZZ  *09520056
095300*----------------------------------------------------------------*09530056
095400     EXEC SQL                                                     09540056
095500        FETCH ASNDTL_SKU_CURSOR                                   09550056
095600        INTO :ASNDTL-ASNDTL-NBR,                                  09560056
095700             :ASNDTL-SHIPT-QTY,                                   09570056
095800             :ASNDTL-UPC-NBR,                                     09580056
095900             :ASNDTL-PO-NBR,                                      09590056
096000             :ASNDTL-ASNHDR-ID,                                   09600056
096100             :ASNDTL-ITM-SUBST-UPC-NBR:PV-ITM-SUBST-UPC-NBR-NULL, 09610056
096200             :XLV00000-ITM-NBR,                                   09620056
096300             :XLV00000-SKU-NBR                                    09630056
096400*CHG109545 - START                                                09640059
096500*            :XLV00001-DEPT-NBR                                   09650056
096600*CHG109545 - END                                                  09660059
096700     END-EXEC.                                                    09670056
096800*----------------------------------------------------------------*09680056
096900* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *09690056
097000*----------------------------------------------------------------*09700056
097100*                                                                 09710056
097200     MOVE SQLCODE    TO SQLCODE2.                                 09720056
097300*                                                                 09730056
097400*----------------------------------------------------------------*09740056
097500* INTRODUCED XLV REFERENCES                     **   WR # 230ZZ  *09750056
097600*----------------------------------------------------------------*09760056
097700     MOVE XLV00000-ITM-NBR TO PV-ITM-NBR.                         09770056
097800     EVALUATE TRUE                                                09780056
097900       WHEN SQLCODE = ZEROS                                       09790056
098000            IF PS-PREPACK-PO                                      09800056
098100               PERFORM B200-EDIT-ITM-SUBST-UPC-NBR                09810056
098200            END-IF                                                09820056
098300*CHG109545 - START                                                09830059
098400*           MOVE XLV00001-DEPT-NBR TO PV-DEPT-TEMP-9              09840056
098500*           MOVE PV-DEPT-TEMP-9 TO PV-DEPT-TEMP                   09850056
098600*CHG109545 - END                                                  09860059
098700         IF XLV00000-SKU-NBR = PV-PRIOR-SKU AND                   09870056
098800            ASNDTL-ITM-SUBST-UPC-NBR = PV-PRIOR-SUBST-UPC         09880056
098900            CONTINUE                                              09890056
099000         ELSE                                                     09900056
099100             SET PS-NEW-SKU       TO TRUE                         09910056
099200         END-IF                                                   09920056
099300       WHEN SQLCODE = PC-ROW-NOT-FOUND                            09930056
099400         SET PS-END-OF-ASNDTL-SKU TO TRUE                         09940056
099500       WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                    09950056
099600         DISPLAY '******************************************'     09960056
099700         DISPLAY 'WARNING ISSUED ON FETCH OF ASNDTL SKU CRSR'     09970056
099800         DISPLAY '******************************************'     09980056
099900         DISPLAY  PV-ABEND-PARAGRAPH                              09990056
100000         PERFORM  Z998-SQL-WARNING                                10000056
100100       WHEN  SQLCODE < ZERO                                       10010056
100200         DISPLAY '******************************************'     10020056
100300         DISPLAY 'ERROR ISSUED ON FETCH OF ASNDTL SKU CURSOR'     10030056
100400         DISPLAY '******************************************'     10040056
100500         DISPLAY  PV-ABEND-PARAGRAPH                              10050056
100600         PERFORM  Z999-SQL-ERROR                                  10060056
100700     END-EVALUATE.                                                10070056
100800*----------------------------------------------------------------*10080056
100900* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *10090056
101000*----------------------------------------------------------------*10100056
101100*                                                                 10110056
101200/                                                                 10120056
101300******************************************************************10130056
101400*  FETCHES THE PO PO LINE ITEM INFORMATION FROM TPURCHS , TPURITM*10140056
101500*  TABLES.                                                       *10150056
101600******************************************************************10160056
101700 S300-FETCH-PO-PO-LINE-CURSOR.                                    10170056
101800*                                                                 10180056
101900     MOVE 'S300'                  TO PGM-LOCATION.                10190056
102000     MOVE 'S300-FETCH-PO-PO-LINE-CURSOR'                          10200056
102100                                  TO PV-ABEND-PARAGRAPH.          10210056
102200                                                                  10220056
102300*    DISPLAY PV-ABEND-PARAGRAPH.                                  10230056
102400*                                                                 10240056
102500     EXEC SQL                                                     10250056
102600         FETCH PO_CURSOR                                          10260056
102700           INTO :PURCHS-DEPT-NBR,                                 10270056
102800                :PURITM-PO-NBR,                                   10280056
102900                :PURITM-APP-PO-LNE-NBR,                           10290056
103000                :PURITM-SKU-SEQ-NBR,                              10300056
103100                :PURITM-UNT-QTY,                                  10310056
103200                :PURITM-ITM-NBR                                   10320056
103300     END-EXEC.                                                    10330056
103400*                                                                 10340056
103500     MOVE SQLCODE    TO SQLCODE2.                                 10350056
103600*                                                                 10360056
103700     EVALUATE TRUE                                                10370056
103800       WHEN SQLCODE = ZEROS                                       10380056
103900                                                                  10390056
104000        IF  PURITM-APP-PO-LNE-NBR  NOT =  PV-PO-LINE              10400056
104100            SET PS-NEW-PO-LINE TO TRUE                            10410056
104200        END-IF                                                    10420056
104300          MOVE PURITM-APP-PO-LNE-NBR  TO PV-PO-LINE               10430056
104400                                                                  10440056
104500       WHEN SQLCODE = PC-ROW-NOT-FOUND                            10450056
104600         SET PS-NO-MORE-PO-LINES  TO TRUE                         10460056
104700                                                                  10470056
104800       WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                    10480056
104900         DISPLAY '******************************************'     10490056
105000         DISPLAY 'WARNING ISSUED ON FETCH OF PO PO LINE CRSR'     10500056
105100         DISPLAY '******************************************'     10510056
105200         DISPLAY  PV-ABEND-PARAGRAPH                              10520056
105300         DISPLAY '  SQLCODE      = ' SQLCODE                      10530056
105400         DISPLAY 'INTEGER-PO-NBR = ' PV-INTEGER-PO-NBR            10540056
105500         DISPLAY 'NUMERIC-PO-NBR = ' PV-NUMERIC-PO-NBR            10550056
105600*----------------------------------------------------------------*10560056
105700* DISPLAYED ITM-NBR                                * WR # 230ZZ  *10570056
105800*----------------------------------------------------------------*10580056
105900         DISPLAY 'ITM_NBR        = ' PV-ITM-NBR                   10590056
106000         PERFORM  Z998-SQL-WARNING                                10600056
106100       WHEN  SQLCODE < ZERO                                       10610056
106200         DISPLAY '******************************************'     10620056
106300         DISPLAY 'ERROR ISSUED ON FETCH OF PO PO LINE CURSOR'     10630056
106400         DISPLAY '******************************************'     10640056
106500         DISPLAY '  SQLCODE      = ' SQLCODE                      10650056
106600         DISPLAY 'INTEGER-PO-NBR = ' PV-INTEGER-PO-NBR            10660056
106700         DISPLAY 'NUMERIC-PO-NBR = ' PV-NUMERIC-PO-NBR            10670056
106800         DISPLAY 'ITM_NBR        = ' PV-ITM-NBR                   10680056
106900*----------------------------------------------------------------*10690056
107000* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *10700056
107100*----------------------------------------------------------------*10710056
107200         DISPLAY  PV-ABEND-PARAGRAPH                              10720056
107300         PERFORM  Z999-SQL-ERROR                                  10730056
107400     END-EVALUATE.                                                10740056
107500*                                                                 10750056
107600/                                                                 10760056
107700******************************************************************10770056
107800*  FETCHES THE PRPK LINE ITEM INFORMATION FROM TPURCHS , TPURITM  10780056
107900*  TABLES.                                                        10790056
108000******************************************************************10800056
108100 S301-FETCH-PRPK-LINE-CURSOR.                                     10810056
108200*                                                                 10820056
108300     MOVE 'S301'                  TO PGM-LOCATION.                10830056
108400     MOVE 'S301-FETCH-PRPK-LINE-CURSOR'                           10840056
108500                                  TO PV-ABEND-PARAGRAPH.          10850056
108600                                                                  10860056
108700*    DISPLAY PV-ABEND-PARAGRAPH.                                  10870056
108800*                                                                 10880056
108900     EXEC SQL                                                     10890056
109000         FETCH PRPK_CURSOR                                        10900056
109100           INTO :PURCHS-DEPT-NBR,                                 10910056
109200                :PURITM-PO-NBR,                                   10920056
109300                :PURITM-APP-PO-LNE-NBR,                           10930056
109400                :PURITM-SKU-SEQ-NBR,                              10940056
109500                :PURITM-UNT-QTY,                                  10950056
109600                :PURITM-ITM-NBR                                   10960056
109700     END-EXEC.                                                    10970056
109800*                                                                 10980056
109900     MOVE SQLCODE    TO SQLCODE2.                                 10990056
110000*                                                                 11000056
110100     EVALUATE TRUE                                                11010056
110200       WHEN SQLCODE = ZEROS                                       11020056
110300                                                                  11030056
110400        IF  PURITM-APP-PO-LNE-NBR  NOT =  PV-PO-LINE              11040056
110500            SET PS-NEW-PO-LINE TO TRUE                            11050056
110600        END-IF                                                    11060056
110700          MOVE PURITM-APP-PO-LNE-NBR  TO PV-PO-LINE               11070056
110800                                                                  11080056
110900       WHEN SQLCODE = PC-ROW-NOT-FOUND                            11090056
111000         SET PS-NO-MORE-PO-LINES  TO TRUE                         11100056
111100                                                                  11110056
111200       WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                    11120056
111300         DISPLAY '******************************************'     11130056
111400         DISPLAY 'WARNING ISSUED ON FETCH OF PRPK LINE CRSR'      11140056
111500         DISPLAY '******************************************'     11150056
111600         DISPLAY  PV-ABEND-PARAGRAPH                              11160056
111700         DISPLAY '  SQLCODE      = ' SQLCODE                      11170056
111800         DISPLAY 'INTEGER-PO-NBR = ' PV-INTEGER-PO-NBR            11180056
111900         DISPLAY 'NUMERIC-PO-NBR = ' PV-NUMERIC-PO-NBR            11190056
112000         DISPLAY 'ITM_NBR        = ' PV-ITM-NBR                   11200056
112100         PERFORM  Z998-SQL-WARNING                                11210056
112200       WHEN  SQLCODE < ZERO                                       11220056
112300         DISPLAY '******************************************'     11230056
112400         DISPLAY 'ERROR ISSUED ON FETCH OF PRPK LINE CURSOR'      11240056
112500         DISPLAY '******************************************'     11250056
112600         DISPLAY '  SQLCODE      = ' SQLCODE                      11260056
112700         DISPLAY 'INTEGER-PO-NBR = ' PV-INTEGER-PO-NBR            11270056
112800         DISPLAY 'NUMERIC-PO-NBR = ' PV-NUMERIC-PO-NBR            11280056
112900         DISPLAY 'ITM_NBR        = ' PV-ITM-NBR                   11290056
113000         DISPLAY  PV-ABEND-PARAGRAPH                              11300056
113100         PERFORM  Z999-SQL-ERROR                                  11310056
113200     END-EVALUATE.                                                11320056
113300*                                                                 11330056
113400/                                                                 11340056
113500******************************************************************11350056
113600 S350-GET-TOTAL-RECEIPTS.                                         11360056
113700*                                                                 11370056
113800     MOVE 'S350'                  TO PGM-LOCATION.                11380056
113900     MOVE 'S350-GET-TOTAL-RECEIPTS'                               11390056
114000                                  TO PV-ABEND-PARAGRAPH.          11400056
114100                                                                  11410056
114200*    DISPLAY PV-ABEND-PARAGRAPH.                                  11420056
114300*                                                                 11430056
114400     EXEC SQL                                                     11440056
114500         SELECT SUM(AP_VERIFY_ITM_QTY)                            11450056
114600          INTO :RECDIS-AP-VERIFY-ITM-QTY:PV-VER-QTY-NULL          11460056
114700          FROM TRECDIS                                            11470056
114800          WHERE ORD_NBR = :PURITM-PO-NBR                          11480056
114900           AND  ORD_LNE_NBR = :PURITM-APP-PO-LNE-NBR              11490056
115010          WITH UR                                                 11501066
115100     END-EXEC.                                                    11510056
115200*                                                                 11520056
115300     MOVE SQLCODE    TO SQLCODE2.                                 11530056
115400*                                                                 11540056
115500     EVALUATE TRUE                                                11550056
115600       WHEN SQLCODE = ZEROS                                       11560056
115700             IF PV-VER-QTY-NULL < ZERO                            11570056
115800                MOVE ZEROES           TO                          11580056
115900                         PV-TOTAL-PO-VERIFIED-QTY                 11590056
116000             ELSE                                                 11600056
116100                MOVE RECDIS-AP-VERIFY-ITM-QTY TO                  11610056
116200                         PV-TOTAL-PO-VERIFIED-QTY                 11620056
116300                                                                  11630056
116400             END-IF                                               11640056
116500                                                                  11650056
116600       WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                    11660056
116700         DISPLAY '******************************************'     11670056
116800         DISPLAY 'WARNING ISSUED ON SELECT SUM ON TRECDIS   '     11680056
116900         DISPLAY '******************************************'     11690056
117000         DISPLAY 'PO-NBR = ' PURITM-PO-NBR                        11700056
117100         DISPLAY 'PO-LNE-NBR = ' PV-PO-LINE                       11710056
117200         DISPLAY  PV-ABEND-PARAGRAPH                              11720056
117300         PERFORM  Z998-SQL-WARNING                                11730056
117400       WHEN  SQLCODE < ZERO                                       11740056
117500         DISPLAY '******************************************'     11750056
117600         DISPLAY 'ERROR ISSUED ON SELECT SUM ON TRECDIS     '     11760056
117700         DISPLAY '******************************************'     11770056
117800         DISPLAY 'PO-NBR = ' PURITM-PO-NBR                        11780056
117900         DISPLAY 'PO-LNE-NBR = ' PV-PO-LINE                       11790056
118000         DISPLAY  PV-ABEND-PARAGRAPH                              11800056
118100         PERFORM  Z999-SQL-ERROR                                  11810056
118200     END-EVALUATE.                                                11820056
118300*                                                                 11830056
118400/                                                                 11840056
118500******************************************************************11850056
118600*                                                                *11860056
118700******************************************************************11870056
118800 S400-SUM-PRIOR-ASN-SHIPT-QTY.                                    11880056
118900*                                                                 11890056
119000     MOVE 'S400'                  TO PGM-LOCATION.                11900056
119100     MOVE 'S400-SUM-PRIOR-ASN-SHIPT-QTY'                          11910056
119200                                  TO PV-ABEND-PARAGRAPH.          11920056
119300*    DISPLAY PV-ABEND-PARAGRAPH.                                  11930056
119400*                                                                 11940056
119500     MOVE ZEROES              TO PV-TOTAL-PRIOR-ASN-SHIPT-QTY.    11950056
119600*                                                                 11960056
119700                                                                  11970056
119800     PERFORM S402-GET-MTCHD-ASSOC-QTY.                            11980056
119900                                                                  11990056
120000                                                                  12000056
120100******************************************************************12010056
120200*                                                                 12020056
120300******************************************************************12030056
120400 S402-GET-MTCHD-ASSOC-QTY.                                        12040056
120500                                                                  12050056
120600     MOVE 'S402'                  TO PGM-LOCATION.                12060056
120700     MOVE 'S402-GET-MTCHD-ASSOC-QTY'                              12070056
120800                                  TO PV-ABEND-PARAGRAPH.          12080056
120900                                                                  12090056
121000       EXEC SQL                                                   12100056
121100        SELECT                                                    12110056
121200          SUM (ASSOC_QTY)                                         12120056
121300         INTO :PV-TOTAL-PRIOR-ASN-SHIPT-QTY:PV-TOT-SHIPT-QTY-NULL 12130056
121400         FROM  TASDTPL                                            12140056
121500           WHERE  PO_NBR       = :ASNORD-PO-NBR                   12150056
121600             AND  PO_LN_NBR    = :PV-PO-LINE                      12160056
121610          WITH UR                                                 12161066
121700       END-EXEC.                                                  12170056
121800*                                                                 12180056
121900     MOVE SQLCODE                 TO SQLCODE2.                    12190056
122000*                                                                 12200056
122100         EVALUATE TRUE                                            12210056
122200           WHEN SQLCODE = ZEROS                                   12220056
122300             IF PV-TOT-SHIPT-QTY-NULL < ZERO                      12230056
122400                MOVE ZEROES           TO                          12240056
122500                     PV-TOTAL-PRIOR-ASN-SHIPT-QTY                 12250056
122600             END-IF                                               12260056
122700           WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                12270056
122800             DISPLAY '******************************************' 12280056
122900             DISPLAY 'WARNING ISSUED ON SUM OF MTCHD ASNORD     ' 12290056
123000             DISPLAY '******************************************' 12300056
123100             DISPLAY  PV-ABEND-PARAGRAPH                          12310056
123200             DISPLAY  ASNORD-PO-NBR                               12320056
123300             DISPLAY  PV-PO-LINE                                  12330056
123400             PERFORM  Z998-SQL-WARNING                            12340056
123500           WHEN  SQLCODE < ZERO                                   12350056
123600             DISPLAY '******************************************' 12360056
123700             DISPLAY 'ERROR ISSUED ON SUM OF MTCHD ASNORD       ' 12370056
123800             DISPLAY '******************************************' 12380056
123900             DISPLAY  PV-ABEND-PARAGRAPH                          12390056
124000             PERFORM  Z999-SQL-ERROR                              12400056
124100         END-EVALUATE.                                            12410056
124200*                                                                 12420056
124300/                                                                 12430056
124400******************************************************************12440056
124500*                                                                *12450056
124600******************************************************************12460056
124700 S500-WRITE-ASDTPL-REC.                                           12470056
124800*                                                                 12480056
124900     MOVE 'S500'                  TO PGM-LOCATION.                12490056
125000     MOVE 'S500-WRITE-ASDTPL-REC        '                         12500056
125100                                  TO PV-ABEND-PARAGRAPH.          12510056
125200*    DISPLAY PV-ABEND-PARAGRAPH.                                  12520056
125300                                                                  12530056
125400     WRITE ASDTPL-LOAD-RECORD                                     12540056
125500         FROM OUT01-ASDTPL-LAYOUT.                                12550056
125600                                                                  12560056
125700     ADD +1                       TO PV-ASDTPL-WRITTEN.           12570056
125800*                                                                 12580056
125900/                                                                 12590056
126000******************************************************************12600056
126100*     OPENS THE ASNORD CURSOR                                    *12610056
126200*                                                                *12620056
126300******************************************************************12630056
126400 X100-OPEN-ASNORD-CURSOR.                                         12640056
126500*                                                                 12650056
126600     MOVE 'X100'                  TO PGM-LOCATION.                12660056
126700     MOVE 'X100-OPEN-ASNORD-CURSOR'                               12670056
126800                                  TO PV-ABEND-PARAGRAPH.          12680056
126900*    DISPLAY PV-ABEND-PARAGRAPH.                                  12690056
127000*                                                                 12700056
127100     EXEC SQL                                                     12710056
127200         OPEN ASNORD_CURSOR                                       12720056
127300     END-EXEC.                                                    12730056
127400*                                                                 12740056
127500     MOVE SQLCODE    TO SQLCODE2.                                 12750056
127600*                                                                 12760056
127700     EVALUATE TRUE                                                12770056
127800       WHEN SQLCODE         = ZERO                                12780056
127900         CONTINUE                                                 12790056
128000       WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                    12800056
128100         DISPLAY '******************************************'     12810056
128200         DISPLAY 'WARNING ISSUED ON OPEN OF ASNORD CURSOR   '     12820056
128300         DISPLAY '******************************************'     12830056
128400         DISPLAY  PV-ABEND-PARAGRAPH                              12840056
128500         PERFORM  Z998-SQL-WARNING                                12850056
128600       WHEN  SQLCODE < ZERO                                       12860056
128700         DISPLAY '******************************************'     12870056
128800         DISPLAY 'ERROR ISSUED ON OPEN OF ASNORD CURSOR     '     12880056
128900         DISPLAY '******************************************'     12890056
129000         DISPLAY  PV-ABEND-PARAGRAPH                              12900056
129100         PERFORM  Z999-SQL-ERROR                                  12910056
129200     END-EVALUATE.                                                12920056
129300*                                                                 12930056
129400/                                                                 12940056
129500******************************************************************12950056
129600*     OPENS THE ASNDTL SKU CURSOR                                *12960056
129700*                                                                *12970056
129800******************************************************************12980056
129900 X200-OPEN-ASNDTL-SKU-CURSOR.                                     12990056
130000*                                                                 13000056
130100     MOVE 'X200'                  TO PGM-LOCATION.                13010056
130200     MOVE 'X200-OPEN-ASNDTL-SKU-CURSOR'                           13020056
130300                                  TO PV-ABEND-PARAGRAPH.          13030056
130400*    DISPLAY PV-ABEND-PARAGRAPH.                                  13040056
130500*                                                                 13050056
130600     EXEC SQL                                                     13060056
130700         OPEN ASNDTL_SKU_CURSOR                                   13070056
130800     END-EXEC.                                                    13080056
130900*                                                                 13090056
131000     MOVE SQLCODE    TO SQLCODE2.                                 13100056
131100*                                                                 13110056
131200     EVALUATE TRUE                                                13120056
131300       WHEN SQLCODE         = ZERO                                13130056
131400         SET PS-NOT-END-OF-ASNTL-SKU TO TRUE                      13140056
131500       WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                    13150056
131600         DISPLAY '******************************************'     13160056
131700         DISPLAY 'WARNING ISSUED ON OPEN OF ASNDTL SKU CRSR '     13170056
131800         DISPLAY '******************************************'     13180056
131900         DISPLAY  PV-ABEND-PARAGRAPH                              13190056
132000         PERFORM  Z998-SQL-WARNING                                13200056
132100       WHEN  SQLCODE < ZERO                                       13210056
132200         DISPLAY '******************************************'     13220056
132300         DISPLAY 'ERROR ISSUED ON OPEN OF ASNDTL SKU CURSOR '     13230056
132400         DISPLAY '******************************************'     13240056
132500         DISPLAY  PV-ABEND-PARAGRAPH                              13250056
132600         PERFORM  Z999-SQL-ERROR                                  13260056
132700     END-EVALUATE.                                                13270056
132800*                                                                 13280056
132900/                                                                 13290056
133000******************************************************************13300056
133100 X300-OPEN-PO-PO-LINE-CURSOR.                                     13310056
133200*                                                                 13320056
133300     MOVE 'X300'                  TO PGM-LOCATION.                13330056
133400     MOVE 'X330-OPEN-PO-PO-LINE-CURSOR'                           13340056
133500                                  TO PV-ABEND-PARAGRAPH.          13350056
133600*    DISPLAY PV-ABEND-PARAGRAPH.                                  13360056
133700*                                                                 13370056
133800     EXEC SQL                                                     13380056
133900         OPEN PO_CURSOR                                           13390056
134000     END-EXEC.                                                    13400056
134100*                                                                 13410056
134200     MOVE SQLCODE    TO SQLCODE2.                                 13420056
134300*                                                                 13430056
134400     EVALUATE TRUE                                                13440056
134500       WHEN SQLCODE         = ZERO                                13450056
134600         CONTINUE                                                 13460056
134700       WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                    13470056
134800         DISPLAY '******************************************'     13480056
134900         DISPLAY 'WARNING ISSUED ON OPEN OF PO PO LINE CRSR '     13490056
135000         DISPLAY '******************************************'     13500056
135100         DISPLAY  PV-ABEND-PARAGRAPH                              13510056
135200         PERFORM  Z998-SQL-WARNING                                13520056
135300       WHEN  SQLCODE < ZERO                                       13530056
135400         DISPLAY '******************************************'     13540056
135500         DISPLAY 'ERROR ISSUED ON OPEN OF PO PO LINE CURSOR '     13550056
135600         DISPLAY '******************************************'     13560056
135700         DISPLAY  PV-ABEND-PARAGRAPH                              13570056
135800         PERFORM  Z999-SQL-ERROR                                  13580056
135900     END-EVALUATE.                                                13590056
136000*                                                                 13600056
136100/                                                                 13610056
136200******************************************************************13620056
136300 X301-OPEN-PRPK-LINE-CURSOR.                                      13630056
136400*                                                                 13640056
136500     MOVE 'X301'                  TO PGM-LOCATION.                13650056
136600     MOVE 'X331-OPEN-PRPK-LINE-CURSOR'                            13660056
136700                                  TO PV-ABEND-PARAGRAPH.          13670056
136800*    DISPLAY PV-ABEND-PARAGRAPH.                                  13680056
136900*                                                                 13690056
137000     EXEC SQL                                                     13700056
137100         OPEN PRPK_CURSOR                                         13710056
137200     END-EXEC.                                                    13720056
137300*                                                                 13730056
137400     MOVE SQLCODE    TO SQLCODE2.                                 13740056
137500*                                                                 13750056
137600     EVALUATE TRUE                                                13760056
137700       WHEN SQLCODE         = ZERO                                13770056
137800         CONTINUE                                                 13780056
137900       WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                    13790056
138000         DISPLAY '******************************************'     13800056
138100         DISPLAY 'WARNING ISSUED ON OPEN OF PRPK LINE CRSR '      13810056
138200         DISPLAY '******************************************'     13820056
138300         DISPLAY  PV-ABEND-PARAGRAPH                              13830056
138400         PERFORM  Z998-SQL-WARNING                                13840056
138500       WHEN  SQLCODE < ZERO                                       13850056
138600         DISPLAY '******************************************'     13860056
138700         DISPLAY 'ERROR ISSUED ON OPEN OF PRPK LINE CURSOR '      13870056
138800         DISPLAY '******************************************'     13880056
138900         DISPLAY  PV-ABEND-PARAGRAPH                              13890056
139000         PERFORM  Z999-SQL-ERROR                                  13900056
139100     END-EVALUATE.                                                13910056
139200*                                                                 13920056
139300/                                                                 13930056
139400******************************************************************13940056
139500*     CLOSES THE ASNORD CURSOR                                   *13950056
139600*                                                                *13960056
139700******************************************************************13970056
139800 Y100-CLOSE-ASNORD-CURSOR.                                        13980056
139900*                                                                 13990056
140000     MOVE 'Y100'                  TO PGM-LOCATION.                14000056
140100     MOVE 'Y100-CLOSE-ASNORD-CURSOR'                              14010056
140200                                  TO PV-ABEND-PARAGRAPH.          14020056
140300*    DISPLAY PV-ABEND-PARAGRAPH.                                  14030056
140400*                                                                 14040056
140500     EXEC SQL                                                     14050056
140600         CLOSE ASNORD_CURSOR                                      14060056
140700     END-EXEC.                                                    14070056
140800*                                                                 14080056
140900     MOVE SQLCODE    TO SQLCODE2.                                 14090056
141000*                                                                 14100056
141100     EVALUATE TRUE                                                14110056
141200       WHEN SQLCODE         = ZERO                                14120056
141300         CONTINUE                                                 14130056
141400       WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                    14140056
141500         DISPLAY '******************************************'     14150056
141600         DISPLAY 'WARNING ISSUED ON CLOSE OF ASNORD CURSOR  '     14160056
141700         DISPLAY '******************************************'     14170056
141800         DISPLAY  PV-ABEND-PARAGRAPH                              14180056
141900         PERFORM  Z998-SQL-WARNING                                14190056
142000       WHEN  SQLCODE < ZERO                                       14200056
142100         DISPLAY '******************************************'     14210056
142200         DISPLAY 'ERROR ISSUED ON CLOSE OF ASNORD CURSOR    '     14220056
142300         DISPLAY '******************************************'     14230056
142400         DISPLAY  PV-ABEND-PARAGRAPH                              14240056
142500         PERFORM  Z999-SQL-ERROR                                  14250056
142600     END-EVALUATE.                                                14260056
142700*                                                                 14270056
142800/                                                                 14280056
142900******************************************************************14290056
143000*     CLOSES THE ASNDTL SKU CURSOR                               *14300056
143100*                                                                *14310056
143200******************************************************************14320056
143300 Y200-CLOSE-ASNDTL-SKU-CURSOR.                                    14330056
143400*                                                                 14340056
143500     MOVE 'Y200'                  TO PGM-LOCATION.                14350056
143600     MOVE 'Y200-CLOSE-ASNDTL-SKU-CURSOR'                          14360056
143700                                  TO PV-ABEND-PARAGRAPH.          14370056
143800*    DISPLAY PV-ABEND-PARAGRAPH.                                  14380056
143900*                                                                 14390056
144000     EXEC SQL                                                     14400056
144100         CLOSE ASNDTL_SKU_CURSOR                                  14410056
144200     END-EXEC.                                                    14420056
144300*                                                                 14430056
144400     MOVE SQLCODE    TO SQLCODE2.                                 14440056
144500*                                                                 14450056
144600     EVALUATE TRUE                                                14460056
144700       WHEN SQLCODE         = ZERO                                14470056
144800         CONTINUE                                                 14480056
144900       WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                    14490056
145000         DISPLAY '******************************************'     14500056
145100         DISPLAY 'WARNING ISSUED ON CLOSE OF ASNDTL SKU CRSR'     14510056
145200         DISPLAY '******************************************'     14520056
145300         DISPLAY  PV-ABEND-PARAGRAPH                              14530056
145400         PERFORM  Z998-SQL-WARNING                                14540056
145500       WHEN  SQLCODE < ZERO                                       14550056
145600         DISPLAY '******************************************'     14560056
145700         DISPLAY 'ERROR ISSUED ON CLOSE OF ASNDTL SKU CURSOR'     14570056
145800         DISPLAY '******************************************'     14580056
145900         DISPLAY  PV-ABEND-PARAGRAPH                              14590056
146000         PERFORM  Z999-SQL-ERROR                                  14600056
146100     END-EVALUATE.                                                14610056
146200*                                                                 14620056
146300/                                                                 14630056
146400******************************************************************14640056
146500*     CLOSES THE ASNDTL SKU CURSOR                               *14650056
146600*                                                                *14660056
146700******************************************************************14670056
146800 Y300-CLOSE-PO-PO-LINE-CURSOR.                                    14680056
146900*                                                                 14690056
147000     MOVE 'Y300'                  TO PGM-LOCATION.                14700056
147100     MOVE 'Y300-CLOSE-PO-PO-LINE-CURSOR'                          14710056
147200                                  TO PV-ABEND-PARAGRAPH.          14720056
147300*    DISPLAY PV-ABEND-PARAGRAPH.                                  14730056
147400*                                                                 14740056
147500     EXEC SQL                                                     14750056
147600         CLOSE PO_CURSOR                                          14760056
147700     END-EXEC.                                                    14770056
147800*                                                                 14780056
147900     MOVE SQLCODE    TO SQLCODE2.                                 14790056
148000*                                                                 14800056
148100     EVALUATE TRUE                                                14810056
148200       WHEN SQLCODE         = ZERO                                14820056
148300         CONTINUE                                                 14830056
148400       WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                    14840056
148500         DISPLAY '******************************************'     14850056
148600         DISPLAY 'WARNING ISSUED ON CLOSE OF PO PO LINE CRSR'     14860056
148700         DISPLAY '******************************************'     14870056
148800         DISPLAY  PV-ABEND-PARAGRAPH                              14880056
148900         PERFORM  Z998-SQL-WARNING                                14890056
149000       WHEN  SQLCODE < ZERO                                       14900056
149100         DISPLAY '******************************************'     14910056
149200         DISPLAY 'ERROR ISSUED ON CLOSE OF PO PO LINE CURSOR'     14920056
149300         DISPLAY '******************************************'     14930056
149400         DISPLAY  PV-ABEND-PARAGRAPH                              14940056
149500         PERFORM  Z999-SQL-ERROR                                  14950056
149600     END-EVALUATE.                                                14960056
149700*                                                                 14970056
149800/                                                                 14980056
149900******************************************************************14990056
150000*     CLOSES THE ASNDTL SKU CURSOR                               *15000056
150100*                                                                *15010056
150200******************************************************************15020056
150300 Y301-CLOSE-PRPK-LINE-CURSOR.                                     15030056
150400*                                                                 15040056
150500     MOVE 'Y301'                  TO PGM-LOCATION.                15050056
150600     MOVE 'Y301-CLOSE-PRPK-LINE-CURSOR'                           15060056
150700                                  TO PV-ABEND-PARAGRAPH.          15070056
150800*    DISPLAY PV-ABEND-PARAGRAPH.                                  15080056
150900*                                                                 15090056
151000     EXEC SQL                                                     15100056
151100         CLOSE PRPK_CURSOR                                        15110056
151200     END-EXEC.                                                    15120056
151300*                                                                 15130056
151400     MOVE SQLCODE    TO SQLCODE2.                                 15140056
151500*                                                                 15150056
151600     EVALUATE TRUE                                                15160056
151700       WHEN SQLCODE         = ZERO                                15170056
151800         CONTINUE                                                 15180056
151900       WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                    15190056
152000         DISPLAY '******************************************'     15200056
152100         DISPLAY 'WARNING ISSUED ON CLOSE OF PRPK LINE CRSR'      15210056
152200         DISPLAY '******************************************'     15220056
152300         DISPLAY  PV-ABEND-PARAGRAPH                              15230056
152400         PERFORM  Z998-SQL-WARNING                                15240056
152500       WHEN  SQLCODE < ZERO                                       15250056
152600         DISPLAY '******************************************'     15260056
152700         DISPLAY 'ERROR ISSUED ON CLOSE OF PRPK LINE CURSOR'      15270056
152800         DISPLAY '******************************************'     15280056
152900         DISPLAY  PV-ABEND-PARAGRAPH                              15290056
153000         PERFORM  Z999-SQL-ERROR                                  15300056
153100     END-EVALUATE.                                                15310056
153200*                                                                 15320056
153300/                                                                 15330056
153400******************************************************************15340056
153500*     SQL WARNING OR ERROR PROCESSING                            *15350056
153600*                                                                *15360056
153700******************************************************************15370056
153800                                                                  15380056
153900 Z998-SQL-WARNING.                                                15390056
154000*-----------------                                                15400056
154100                                                                  15410056
154200     MOVE SQLCODE    TO SQLCODE2.                                 15420056
154300     MOVE SQLERRD(3) TO SQLERRD3.                                 15430056
154400     DISPLAY '** ABEND **       ** = SQLWARNING'.                 15440056
154500     DISPLAY '** PROGRAM        ** = SNKUP003'.                   15450056
154600     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  15460056
154700     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  15470056
154800     DISPLAY '** SQLWARN0       ** = ' SQLWARN0.                  15480056
154900     DISPLAY '** SQLWARN1       ** = ' SQLWARN1.                  15490056
155000     DISPLAY '** SQLWARN2       ** = ' SQLWARN2.                  15500056
155100     DISPLAY '** SQLWARN3       ** = ' SQLWARN3.                  15510056
155200     DISPLAY '** SQLWARN4       ** = ' SQLWARN4.                  15520056
155300     DISPLAY '** SQLWARN5       ** = ' SQLWARN5.                  15530056
155400     DISPLAY '** SQLWARN6       ** = ' SQLWARN6.                  15540056
155500     DISPLAY '** SQLWARN7       ** = ' SQLWARN7.                  15550056
155600     EXEC SQL                                                     15560056
155700         COMMIT                                                   15570056
155800     END-EXEC.                                                    15580056
155900     MOVE +4013 TO PV-ABEND-CODE.                                 15590056
156000     CALL PC-ILBOABN0 USING PV-ABEND-CODE.                        15600056
156100*                                                                 15610056
156200 Z999-SQL-ERROR.                                                  15620056
156300*---------------                                                  15630056
156400                                                                  15640056
156500     MOVE SQLCODE    TO SQLCODE2.                                 15650056
156600     MOVE SQLERRD(3) TO SQLERRD3.                                 15660056
156700     DISPLAY '** ABEND **       ** = SQLERROR'.                   15670056
156800     DISPLAY '** PROGRAM        ** = SNKUP003'.                   15680056
156900     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  15690056
157000     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  15700056
157100     DISPLAY '** SQLERRM        ** = ' SQLERRM.                   15710056
157200     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  15720056
157300     EXEC SQL                                                     15730056
157400         COMMIT                                                   15740056
157500     END-EXEC.                                                    15750056
157600     MOVE +4013 TO PV-ABEND-CODE.                                 15760056
157700     CALL PC-ILBOABN0 USING PV-ABEND-CODE.                        15770056
157800*                                                                 15780056
