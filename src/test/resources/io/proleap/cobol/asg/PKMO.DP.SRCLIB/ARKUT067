000100***************************************************************** 00010036
000200 IDENTIFICATION DIVISION.                                         00020036
000300***************************************************************** 00030036
000400                                                                  00040036
000500 PROGRAM-ID.             ARKUT067.                                00050046
000600 AUTHOR.                 COGNIZANT.                               00060036
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070036
000800 DATE-WRITTEN            AUGUST 2015.                             00080046
000900 DATE-COMPILED.                                                   00090036
001000                                                                  00100036
001100***************************************************************** 00110036
001200*  PURPOSE:                                                       00120036
001300*  THIS PROGRAM WILL TOKENIZE THE ACCOUNT NUMBER AND SSN NUMBER   00130046
001400*  FIELDS IN THE INPUT FILE.                                      00131046
001600*  PROTEGRITY MODULE WILL BE INVOKED TO TOKENIZE THE ACCOUNT      00160046
001700*  NUMBER AND SSN NUMBER                                          00170046
001710*                                                                 00171046
001800*  INPUT FILES :   EMP-ACCT-FILE             DDNAME = INP01       00180047
001900*  OUTPUT FILES:   EMP-ACCT-TOKEN-FILE       DDNAME = OUT01       00190047
002000*                                                                 00200036
002100***************************************************************** 00210036
002200*----------------------------------------------------------------*00220036
002300*                                                                *00230036
002400* DATE:        08/26/2015                                        *00240046
002500* WR/IR#:      CHG0125054                                        *00250066
002600* PROGRAMMER:  COGNIZANT                                         *00260036
002700* DESCRIPTION: INITIAL VERSION CREATED FOR COSA DATA SECURITY    *00270036
002800*              PROJECT                                           *00280036
002900*                                                                *00290036
003000*----------------------------------------------------------------*00300036
003100***************************************************************** 00310036
003200 ENVIRONMENT DIVISION.                                            00320036
003300***************************************************************** 00330036
003400                                                                  00340036
003500 CONFIGURATION SECTION.                                           00350036
003600                                                                  00360036
003700 SOURCE-COMPUTER.        IBM-3090.                                00370036
003800                                                                  00380036
003900 OBJECT-COMPUTER.        IBM-3090.                                00390036
004000                                                                  00400036
004100 INPUT-OUTPUT SECTION.                                            00410036
004200                                                                  00420036
004300 FILE-CONTROL.                                                    00430036
004400                                                                  00440036
004500     SELECT EMP-ACCT-FILE                                         00450046
004600         ASSIGN TO INP01.                                         00460036
004700                                                                  00470036
004800     SELECT EMP-ACCT-TOKEN-FILE                                   00480046
004900         ASSIGN TO OUT01.                                         00490046
005000                                                                  00500036
006900******************************************************************00690036
007000 DATA DIVISION.                                                   00700036
007100******************************************************************00710036
007200                                                                  00720036
007300 FILE SECTION.                                                    00730036
007400                                                                  00740036
007500 FD  EMP-ACCT-FILE                                                00750046
007600     RECORDING MODE IS F                                          00760036
007700     BLOCK CONTAINS 0 RECORDS                                     00770036
007800     LABEL RECORDS ARE STANDARD.                                  00780036
007900                                                                  00790036
008000 01  EMP-ACCT-RECORD             PIC X(50).                       00800063
008100                                                                  00810036
008200 FD  EMP-ACCT-TOKEN-FILE                                          00820046
008300     RECORDING MODE IS F                                          00830036
008400     BLOCK CONTAINS 0 RECORDS                                     00840036
008500     LABEL RECORDS ARE STANDARD.                                  00850036
008600                                                                  00860036
008700 01  EMP-ACCT-TOKEN-RECORD       PIC X(50).                       00870064
008800                                                                  00880036
013500******************************************************************01350036
013600 WORKING-STORAGE SECTION.                                         01360036
013700******************************************************************01370036
013800 01  FILLER                            PIC X(50)  VALUE           01380036
013900     ' *** WORKING STORAGE STARTS HERE FOR ARKUT067 *** '.        01390046
014000                                                                  01400036
014100 01  PS-PROGRAM-SWITCHES.                                         01410036
014200     05  PS-END-OF-FILE-SW          PIC X(01)  VALUE 'N'.         01420046
014300         88  PS-NOT-END-OF-FILE                VALUE 'N'.         01430046
014400         88  PS-END-OF-FILE                    VALUE 'Y'.         01440046
014500     05  PS-ACCT-SSN                PIC X(08)  VALUE SPACES.      01450046
014600         88  PS-ACCT-NBR                       VALUE 'ACCT NBR'.  01460046
014700         88  PS-SSN-NBR                        VALUE 'SSN NBR'.   01470046
015400                                                                  01540036
015500 01  PC-CONSTANTS.                                                01550036
015600     05  PC-PROGRAM-NAME               PIC  X(08) VALUE           01560036
015700                                                 'ARKUT067'.      01570046
015800 01  PV-PROGRAM-VARIABLES.                                        01580036
015900     05  PV-READ-COUNT                 PIC  9(09) VALUE ZEROES.   01590047
016000     05  PV-WRITE-COUNT                PIC  9(09) VALUE ZEROES.   01600047
016700     05  PV-INPUT-LEN                  PIC  9(09) VALUE ZEROES.   01670046
016701     05  PV-OUTPUT-RECORD              PIC  X(50) VALUE SPACES.   01670164
016702     05  PV-ACCT-NBR-12.                                          01671046
016703         10  PV-ACCT-NBR-10            PIC  X(10) VALUE SPACES.   01672046
016704         10  FILLER                    PIC  X(02) VALUE '00'.     01673046
016800                                                                  01680036
016900 01  ABEND-CODE                        PIC S9(04) VALUE ZERO      01690050
016910                                                  COMP SYNC.      01691050
017000                                                                  01700042
017100******************************************************************01710036
017200* RECORD LAYOUT FOR EMPLOYEE ACCOUNT FILE - INPUT AND OUTPUT     *01720046
017300******************************************************************01730036
017400     COPY ARRD067.                                                01740046
017500                                                                  01750036
018700******************************************************************01870036
018800* LAYOUT THAT DEFINES THE PARAMETERS NEEDED TO INVOKE PROTEGRITY *01880036
018900* MODULE                                                         *01890036
019000******************************************************************01900036
019100     COPY PTYCCSIP.                                               01910036
019200                                                                  01920036
019300******************************************************************01930036
019400* LAYOUT THAT DEFINES THE WORKING VARIABLES TO INVOKE PROTEGRITY *01940036
019500* MODULE                                                         *01950036
019600******************************************************************01960036
019700     COPY DPWS031.                                                01970042
019800                                                                  01980036
019900******************************************************************01990036
020000                                                                  02000036
020100 PROCEDURE DIVISION.                                              02010036
020200                                                                  02020036
020300 0000-MAINLINE-PARA.                                              02030036
020400                                                                  02040036
020500     PERFORM 1000-INITIALIZE.                                     02050036
020600                                                                  02060036
020700     PERFORM 2000-PROCESS-PARA                                    02070046
020800           UNTIL PS-END-OF-FILE.                                  02080046
020900                                                                  02090036
021900     PERFORM 9000-EOJ-ROUTINE.                                    02190036
022000                                                                  02200036
022100     STOP RUN.                                                    02210036
022200                                                                  02220036
022300******************************************************************02230036
022400* 1000-INITIALIZE                                                 02240036
022500*     INITIALIZE THE VARIABLES, OPEN THE INPUT AND OUTPUT FILES   02250036
022600*     AND READ THE INPUT FILE                                     02260036
022700******************************************************************02270036
022800 1000-INITIALIZE.                                                 02280036
022900                                                                  02290036
023000     DISPLAY 'PROGRAM - ' PC-PROGRAM-NAME.                        02300036
023100     INITIALIZE PV-PROGRAM-VARIABLES.                             02310036
023200     MOVE PC-PROGRAM-NAME               TO DP031-PROGRAM-NAME.    02320043
023300                                                                  02330036
023400     OPEN INPUT  EMP-ACCT-FILE                                    02340046
023500          OUTPUT EMP-ACCT-TOKEN-FILE.                             02350046
024200                                                                  02420036
024300     PERFORM 2100-READ-FILE.                                      02430046
024400                                                                  02440036
025100******************************************************************02510036
025200* 2000-PROCESS-PARA                                               02520046
025300*   1. PROCESS THE RECORDS IN THE INPUT FILE                      02530046
025400*   2. CALL TOKENIZE PARA TO TOKENIZE ACCOUNT AND SSN NUMBER      02540046
025500*   3. WRITE OUTPUT RECORDS                                       02541046
025600******************************************************************02560036
025700 2000-PROCESS-PARA.                                               02570046
025800                                                                  02580036
025900     INITIALIZE PV-ACCT-NBR-12                                    02590046
025910                PV-INPUT-LEN.                                     02591046
026000                                                                  02600036
026001     SET PS-ACCT-NBR     TO TRUE.                                 02601062
026002     MOVE AR067-ACCT-NBR TO PV-ACCT-NBR-10.                       02601162
026003     PERFORM 2300-TOKENIZE-DATA.                                  02601262
026004                                                                  02601555
026005     INSPECT FUNCTION REVERSE (AR067-SSN)                         02601955
026006            TALLYING PV-INPUT-LEN FOR LEADING SPACES.             02602055
026007     COMPUTE PV-INPUT-LEN = LENGTH OF AR067-SSN -                 02602155
026008                                      PV-INPUT-LEN.               02602255
026009                                                                  02602355
026010     IF PV-INPUT-LEN NOT = 9                                      02602455
026011        CONTINUE                                                  02602555
026012     ELSE                                                         02602655
026013        SET PS-SSN-NBR TO TRUE                                    02602755
026014        PERFORM 2300-TOKENIZE-DATA                                02602855
026015     END-IF.                                                      02602946
026016                                                                  02603146
026017     PERFORM 2200-WRITE-FILE.                                     02603246
026018     PERFORM 2100-READ-FILE.                                      02603346
026019                                                                  02604046
028900******************************************************************02890036
029000* 2100-READ-FILE                                                  02900046
029100*      READ THE RECORDS IN EMPLOYEE ACCOUNT FILE                  02910046
029200******************************************************************02920036
029300 2100-READ-FILE.                                                  02930046
029400                                                                  02940036
029500     READ EMP-ACCT-FILE INTO AR067-EMPLOYEE-DELTA-REC             02950046
029600        AT END                                                    02960036
029700           SET PS-END-OF-FILE  TO TRUE                            02970046
029800        NOT AT END                                                02980036
029900           ADD 1               TO PV-READ-COUNT                   02990046
030000     END-READ.                                                    03000036
030100                                                                  03010036
030200******************************************************************03020036
030300* 2200-WRITE-FILE                                                 03030046
030400*      WRITE THE RECORDS TO OUTPUT                                03040036
030500******************************************************************03050036
030600 2200-WRITE-FILE.                                                 03060046
030700                                                                  03061064
030800     INITIALIZE PV-OUTPUT-RECORD.                                 03061165
030801     MOVE AR067-EMPLOYEE-DELTA-REC TO PV-OUTPUT-RECORD.           03062064
030802                                                                  03070036
030803     WRITE EMP-ACCT-TOKEN-RECORD FROM PV-OUTPUT-RECORD.           03080064
030900     ADD 1                       TO PV-WRITE-COUNT.               03090060
031000                                                                  03100036
031001******************************************************************03101046
031002* 2300-TOKENIZE-DATA                                              03102046
031003*    TOKENIZE ACCOUNT AND SSN NUMBERS                             03103046
031004******************************************************************03106046
031005 2300-TOKENIZE-DATA.                                              03107046
031006                                                                  03108046
031007     INITIALIZE CSI-PARAMETERS                                    03109046
031008                DP031-PROTEG-PGM-PARAMETERS.                      03109146
031009                                                                  03109246
031010     EVALUATE TRUE                                                03109346
031011        WHEN PS-ACCT-NBR                                          03109446
031012          MOVE 'ACCT-NBR'         TO DP031-FIELD                  03109546
031013          MOVE PV-ACCT-NBR-12     TO DP031-CLEAR-TEXT             03109646
031014          MOVE 12                 TO DP031-INPUT-LEN              03109746
031015          SET DP031-ACCTNBR       TO TRUE                         03109955
031016        WHEN PS-SSN-NBR                                           03110055
031017          MOVE 'SSN-NBR'          TO DP031-FIELD                  03110155
031018          MOVE AR067-SSN          TO DP031-CLEAR-TEXT             03110346
031019          MOVE PV-INPUT-LEN       TO DP031-INPUT-LEN              03110446
031020          SET DP031-SSN           TO TRUE                         03110549
031021     END-EVALUATE.                                                03110646
031022                                                                  03110746
031023     SET CSI-ENCRYPT-FUNCTION     TO TRUE.                        03110846
031024     PERFORM DP031-0000-PROTG-TOKEN-DETOKEN.                      03111146
031025                                                                  03111246
031026     IF CSI-RETURN-CODE = ZERO                                    03111346
031027        IF PS-ACCT-NBR                                            03111446
031028           MOVE DP031-CIPHER-TEXT TO PV-ACCT-NBR-12               03111546
031029           MOVE PV-ACCT-NBR-10    TO AR067-ACCT-NBR               03111755
031030        ELSE                                                      03111855
031031           MOVE DP031-CIPHER-TEXT TO AR067-SSN                    03111955
031032        END-IF                                                    03112055
031033     ELSE                                                         03112155
031034        DISPLAY 'ISSUE IN RECORD# : ' PV-READ-COUNT               03112246
031035        PERFORM DP031-9999-ABEND                                  03112346
031036     END-IF.                                                      03112446
031037                                                                  03112560
050300******************************************************************05030036
050400* 9000-EOJ-ROUTINE                                                05040036
050500*      CLOSE THE INPUT AND OUTPUT FILES, DISPLAY THE MESSAGES     05050036
050600*      AND TERMINATE THE PROCESS.                                 05060036
050700******************************************************************05070036
050800 9000-EOJ-ROUTINE.                                                05080036
050900                                                                  05090036
051000     CLOSE EMP-ACCT-FILE                                          05100046
051100           EMP-ACCT-TOKEN-FILE.                                   05110046
051800                                                                  05180036
051900     IF PV-READ-COUNT = 0                                         05190046
052000        DISPLAY 'INPUT FILE IS EMPTY'                             05200046
052100     ELSE                                                         05200146
052200        DISPLAY 'RECORDS READ   : ' PV-READ-COUNT                 05201046
052300        DISPLAY 'RECORDS WRITTEN: ' PV-WRITE-COUNT                05202046
052310     END-IF.                                                      05210036
052400                                                                  05240036
054500******************************************************************05450036
054600*      COPY MEMBER DPPD031 CONTAINS STATEMENTS NEEDED TO INVOKE   05460042
054700*      PROTEGRITY MODULE FOR PROTECTION/UNPROTECTION              05470048
054800******************************************************************05480036
054900      COPY DPPD031.                                               05490042
055000                                                                  05500036
055100******************************************************************05510036
