000100*TITLE 'ELIMINATE DUPLICATE MANUAL AUDIT DATA'.                   00010099
000200 IDENTIFICATION DIVISION.                                         00020094
000300 PROGRAM-ID.    SUKUT188.                                         00030099
000400 AUTHOR.        SIVARAMAKRISHNAN.                                 00040094
000500 DATE-WRITTEN.  7-7-2017.                                         00050094
000600 ENVIRONMENT DIVISION.                                            00060094
000700 INPUT-OUTPUT SECTION.                                            00070094
000800                                                                  00080094
000900******************************************************************00090094
001000                                                                  00100094
001100* THIS PROGRAM ELIMINATES DUPLICATE MANUAL AUDIT DATA AND         00110098
001200* GENERATES REFORMATTED MANUAL AUDIT DATA AS PER VLRD068 COPYBOOK 00120098
001700******************************************************************00170094
001800 FILE-CONTROL.                                                    00180094
001810     SELECT AUDIT-WEEKLY-FILE       ASSIGN TO INP01.              00181094
001900     SELECT AUDIT-EDITED-FILE       ASSIGN TO OUT01.              00190094
002000                                                                  00200094
002100 DATA DIVISION.                                                   00210094
002200 FILE SECTION.                                                    00220094
002300                                                                  00230094
002400 FD  AUDIT-WEEKLY-FILE                                            00240094
002500     RECORDING MODE IS F                                          00250094
002600     LABEL RECORDS ARE STANDARD                                   00260094
002700     RECORD CONTAINS 232                                          00270094
002800     BLOCK CONTAINS 0 RECORDS                                     00280094
002900     DATA RECORD IS AUDIT-WEEKLY-RECORD.                          00290094
003000 01  AUDIT-WEEKLY-RECORD             PIC X(232).                  00300094
003100                                                                  00310094
003110 FD  AUDIT-EDITED-FILE                                            00311094
003120     RECORDING MODE IS F                                          00312094
003130     LABEL RECORDS ARE STANDARD                                   00313094
003140     RECORD CONTAINS 206                                          00314094
003150     BLOCK CONTAINS 0 RECORDS                                     00315094
003160     DATA RECORD IS AUDIT-EDITED-RECORD.                          00316094
003170 01  AUDIT-EDITED-RECORD             PIC X(206).                  00317094
003180                                                                  00318094
003200 WORKING-STORAGE SECTION.                                         00320094
003600                                                                  00360094
003700 01  PS-PROGRAM-SWITCHES.                                         00370094
003800     05  PS-END-OF-FILE-SW            PIC X(1)   VALUE 'N'.       00380094
003900         88  PS-END-OF-FILE                      VALUE 'Y'.       00390095
004000                                                                  00400094
004010     05  PS-EXTRACT-WRITE-SW          PIC X(1)   VALUE 'N'.       00401095
004020         88  PS-EXTRACT-WRITE-YES                VALUE 'Y'.       00402095
004030         88  PS-EXTRACT-WRITE-NO                 VALUE 'N'.       00403095
004100                                                                  00410095
004200 01  PV-PROGRAM-VARIABLES.                                        00420095
004500     05  PV-DISP-NBR                  PIC Z(8)9  VALUE ZERO.      00450095
004600     05  PV-HOLD-AUD-CNTL-NBR         PIC 9(13)  VALUE ZERO.      00460095
004700     05  PV-HOLD-AUD-STP-TMST         PIC X(26)  VALUE SPACES.    00470095
006700                                                                  00670095
006800 01  PV-COUNTERS COMP-3.                                          00680095
006810     05  PV-READ-COUNT                PIC S9(9)   VALUE ZERO.     00681095
006810     05  PV-DUP-COUNT                 PIC S9(9)   VALUE ZERO.     00682099
006900     05  PV-WRITE-COUNT               PIC S9(9)   VALUE ZERO.     00690095
008500/                                                                 00850095
008600*    AUDIT-WEEKLY RECORD                                          00860095
008700     COPY SURD159.                                                00870097
008701                                                                  00870195
008710*    AUDIT-EDITED RECORD                                          00871095
008720     COPY VLRD068.                                                00872095
008800/                                                                 00880095
017900/                                                                 01790095
018000 PROCEDURE DIVISION.                                              01800095
018100                                                                  01810095
018200     PERFORM 1000-INIT.                                           01820095
018300                                                                  01830095
018400     PERFORM 2000-PROCESS UNTIL PS-END-OF-FILE.                   01840095
018500                                                                  01850095
018600     PERFORM 9000-TERMINATE.                                      01860095
018700                                                                  01870095
018800     GOBACK.                                                      01880095
018900/                                                                 01890095
019000 1000-INIT.                                                       01900095
019100                                                                  01910095
019200     OPEN INPUT  AUDIT-WEEKLY-FILE                                01920095
019300          OUTPUT AUDIT-EDITED-FILE                                01930095
019400                                                                  01940095
019410     INITIALIZE PV-PROGRAM-VARIABLES.                             01941095
019500     PERFORM    8000-READ-WEEKLY-REC.                             01950095
019600/                                                                 01960095
019700 2000-PROCESS.                                                    01970095
019710                                                                  01971095
019800     IF SU159-AUD-CNTL-NBR = PV-HOLD-AUD-CNTL-NBR                 01980097
019801        IF SU159-AUD-STP-TMST = PV-HOLD-AUD-STP-TMST              01980197
019802          SET PS-EXTRACT-WRITE-YES TO TRUE                        01980295
019803        ELSE                                                      01980395
019804          SET PS-EXTRACT-WRITE-NO  TO TRUE                        01980495
                ADD +1 TO PV-DUP-COUNT                                  01980599
019805        END-IF                                                    01980695
019806     ELSE                                                         01980795
019807           MOVE SU159-AUD-CNTL-NBR TO PV-HOLD-AUD-CNTL-NBR        01980897
019808           MOVE SU159-AUD-STP-TMST TO PV-HOLD-AUD-STP-TMST        01980997
019809           SET PS-EXTRACT-WRITE-YES TO TRUE                       01981095
019810     END-IF.                                                      01981195
019811                                                                  01981295
019820     IF PS-EXTRACT-WRITE-YES                                      01982095
019900        PERFORM 3000-BUILD-RECORDS                                01990095
020000        PERFORM 8100-WRITE-EXTRACT-REC                            02000095
020100     END-IF.                                                      02010095
020400/                                                                 02040095
020410     PERFORM 8000-READ-WEEKLY-REC.                                02041095
020500 3000-BUILD-RECORDS.                                              02050095
020600                                                                  02060095
020700     MOVE SU159-WEEK-END-DATE     TO VL068-WEEK-END-DATE          02070097
020800     MOVE SU159-VENDOR-ID         TO VL068-VENDOR-ID              02080097
020900     MOVE SU159-PO-NBR            TO VL068-PO-NBR                 02090097
021000     MOVE SU159-DEPT-NBR          TO VL068-DEPT-NBR               02100097
021100     MOVE SU159-RCVR-SEQ-NBR      TO VL068-RCVR-SEQ-NBR           02110097
021200     MOVE SU159-PO-TYP-CDE        TO VL068-PO-TYP-CDE             02120097
021300     MOVE SU159-PKGNG-TYPE        TO VL068-PKGNG-TYPE             02130097
021400     MOVE SU159-VENDOR-AUDIT-RANK TO VL068-VENDOR-AUDIT-RANK      02140097
021500     MOVE SU159-AUD-CNTL-NBR      TO VL068-AUD-CNTL-NBR           02150097
021700     MOVE SU159-CRTNS-AUDITED     TO VL068-CRTNS-AUDITED          02170097
021800     MOVE SU159-CRTNS-W-PICK-ERR  TO VL068-CRTNS-W-PICK-ERR       02180097
021900     MOVE SU159-UNITS-AUDITED     TO VL068-UNITS-AUDITED          02190097
022000     MOVE SU159-UNITS-PICK-ERR    TO VL068-UNITS-PICK-ERR         02200097
022100     MOVE SU159-UNITS-PACK-ERR    TO VL068-UNITS-PACK-ERR         02210097
022200     MOVE SU159-PACKS-AUDITED     TO VL068-PACKS-AUDITED          02220097
022300     MOVE SU159-PACKS-W-PACK-ERR  TO VL068-PACKS-W-PACK-ERR       02230097
022400     MOVE SU159-FAILURE-ERROR-SW  TO VL068-FAILURE-ERROR-SW       02240097
022500     MOVE SU159-AUD-STAT-CDE      TO VL068-AUD-STAT-CDE           02250097
022600     MOVE SU159-UNITS-TICK-ERR    TO VL068-UNITS-TICK-ERR         02260097
022700     MOVE SU159-ANCHOR-CONSTANT   TO VL068-ANCHOR-CONSTANT.       02270097
030700/                                                                 03070095
030710 8000-READ-WEEKLY-REC.                                            03071095
030720                                                                  03072095
030730     READ AUDIT-WEEKLY-FILE INTO                                  03073095
030740           SU159-RECORD                                           03074097
030750     AT END                                                       03075095
030760         SET PS-END-OF-FILE           TO TRUE                     03076095
030770     NOT AT END                                                   03077095
030780         ADD +1                       TO PV-READ-COUNT            03078099
030793     END-READ.                                                    03079395
030794                                                                  03079495
030800 8100-WRITE-EXTRACT-REC.                                          03080095
030900                                                                  03090095
031000     WRITE AUDIT-EDITED-RECORD FROM VL068-RECORD.                 03100095
031200     ADD   +1                  TO   PV-WRITE-COUNT.               03120095
031300/                                                                 03130095
031400 9000-TERMINATE.                                                  03140095
031500                                                                  03150095
031800     CLOSE AUDIT-WEEKLY-FILE                                      03180095
031900           AUDIT-EDITED-FILE                                      03190095
031910                                                                  03191095
032000     DISPLAY '************************'.                          03200095
032100     DISPLAY '******* SUKUT188 *******'.                          03210099
032200     DISPLAY '************************'.                          03220095
032300     DISPLAY SPACES                                               03230095
032400                                                                  03240095
032410     MOVE PV-READ-COUNT              TO PV-DISP-NBR               03241095
032420     DISPLAY 'EXTRACT RECS  READ         = ' PV-DISP-NBR          03242095
032430     DISPLAY SPACES                                               03243095
032440     DISPLAY '************************'.                          03244095
032410     MOVE PV-DUP-COUNT               TO PV-DISP-NBR               03245099
032420     DISPLAY 'DUPLICATE RECS SKIPPED     = ' PV-DISP-NBR          03246099
032430     DISPLAY SPACES                                               03247099
032440     DISPLAY '************************'.                          03248099
032500     MOVE PV-WRITE-COUNT              TO PV-DISP-NBR              03250095
032600     DISPLAY 'EXTRACT RECS  WRITTEN      = ' PV-DISP-NBR          03260095
032700     DISPLAY SPACES                                               03270095
032800     DISPLAY '************************'.                          03280095
032900/                                                                 03290095
