W31475**********************!!! ATTENTION !!!***************************        
W31475* THIS IS A CLONE OF BVWS001. ANY CHANGE HERE NEEDS TO REFLECT            
W31475* THERE AND VICE VERSA.                                                   
      ******************************************************************        
      *  THIS WORKING-STORAGE COPYBOOK IS NEEDED FOR BVPD003 COPY CODE.         
      *                                                                         
      *  FOR INSTRUCTIONS, PLEASE SEE BVPD003                                   
      ******************************************************************        
RONNA2*         10/05/2006   REMOVE LOGIC FOR SKU, ITEM, UPC, UPC ID,  *        
RONNA2*                      AND SKU DEPT LOOKUPS.                              
RONNA2*                      THE PRICING/ATTRIBUTE UTILITY WILL BE     *        
RONNA2*                      USED TO GET THE ATTRIBUTES, THEN          *        
RONNA2*                      BV UTILTY WILL BE CALLED THROUGH THE               
RONNA2*                      PRICING MODULE                                     
W31475*         05/20/2009   ML PERFORMANCE TUNNING                             
      ******************************************************************        
                                                                                
       01  BV003-PV-PROGRAM-VARIABLE.                                           
           05  BV003-PV-INPUT-AREA.                                             
               10  BV003-PV-LOOKUP-TYPE-IN PIC X(08) VALUE SPACES.              
                   88  BV003-PV-BRND-DEPT-LOOKUP     VALUE 'BRNDDPT'.           
                   88  BV003-PV-BRND-LOOKUP          VALUE 'BRAND'.             
                   88  BV003-PV-BRND-VND-DPT-LOOKUP  VALUE 'BVD'.               
                   88  BV003-PV-REL-ID-LOOKUP        VALUE 'REL'.               
                   88  BV003-PV-UNK-BRND-LOOKUP      VALUE 'UNK'.               
                   88  BV003-PV-VNDR-DEPT-LOOKUP     VALUE 'VNDDPT'.            
                   88  BV003-PV-VNDR-LOOKUP          VALUE 'VENDOR'.            
               10  BV003-PV-VND-PAST-FUT-IN   PIC X(01) VALUE 'N'.              
                   88  BV003-VND-LOOK-PAST-FUT       VALUE 'Y'.                 
                   88  BV003-VND-DONT-LOOK-PAST-FUT  VALUE 'N'.                 
               10  BV003-PV-USE-KNWN-UNK-SW   PIC X(01) VALUE 'N'.              
                   88  BV003-USE-KNOWN-UNKNOWN          VALUE 'Y'.              
                   88  BV003-DONT-USE-UNK-KNOWN         VALUE 'N'.              
               10  BV003-PV-PAST-MONTHS    PIC S9(4) VALUE ZEROES               
                                                    COMP.                       
               10  BV003-PV-EFF-DTE-IN.                                         
                   15 BV003-PV-EFF-DTE-IN-YR  PIC X(04) VALUE SPACES.           
                   15 FILLER                  PIC X(01) VALUE SPACES.           
                   15 BV003-PV-EFF-DTE-IN-MN  PIC X(02) VALUE SPACES.           
                   15 FILLER                  PIC X(01) VALUE SPACES.           
                   15 BV003-PV-EFF-DTE-IN-DY  PIC X(02) VALUE SPACES.           
               10  BV003-PV-ENT-ID-IN      PIC X(09) VALUE SPACES.              
               10  BV003-PV-ENT-ID-IN-9 REDEFINES BV003-PV-ENT-ID-IN            
                                           PIC 9(09).                           
               10  BV003-PV-BRAND-IN       PIC X(05)       VALUE SPACES.        
               10  BV003-PV-BRAND-IN-9       REDEFINES                          
                   BV003-PV-BRAND-IN       PIC 9(05).                           
               10  BV003-PV-DEPT-IN        PIC X(04) VALUE SPACES.              
               10  BV003-PV-DEPT-IN-9 REDEFINES BV003-PV-DEPT-IN                
                                           PIC 9(04).                           
               10  BV003-PV-RLTNSHP-ID-IN  PIC X(09).                           
               10  BV003-PV-RLTNSHP-ID-IN-9 REDEFINES                           
                   BV003-PV-RLTNSHP-ID-IN  PIC 9(09).                           
           05  BV003-PV-OUTPUT-AREA.                                            
               10  BV003-PV-ENT-ID-OUT     PIC S9(09)      VALUE ZEROES         
                               COMP.                                            
                   88  BV003-PV-ENT-NOT-FOUND              VALUE +5161.         
               10  BV003-PV-BRAND-OUT      PIC S9(04)      VALUE ZEROES         
                               COMP.                                            
                   88  BV003-PV-BRAND-NOT-FOUND            VALUE +2230.         
               10  BV003-PV-VD-CSR-SW      PIC X(01)       VALUE 'V'.           
                   88  BV003-PV-VNDR-DEPT-CSR-ORIG         VALUE 'V'.           
                   88  BV003-PV-VNDR-DEPT-CSR-FUT          VALUE 'F'.           
                   88  BV003-PV-VNDR-DEPT-CSR-PAST         VALUE 'P'.           
               10  BV003-PV-DEPT-OUT       PIC S9(04)      VALUE ZEROES         
                               COMP.                                            
               10  BV003-PV-RLTNSHP-ID-OUT PIC S9(09)      VALUE ZEROES         
                               COMP.                                            
               10  BV003-PV-SQLCODE-OUT    PIC S9(09) COMP-4.                   
               10  BV003-PV-RT-SUB-OUT     PIC S9(04) COMP VALUE ZERO.          
W31475*        10  BV003-PV-RLTNSHP-OUT-TABLE.                                  
W31475*            15  BV003-PV-RLTNSHP-ENTRY-OUT OCCURS 9999 TIMES.            
W31475*                20  BV003-RT-ENT-ID-OUT           PIC S9(09).            
W31475*                    88 BV003-RT-ENT-NOT-FOUND     VALUE +5161.           
W31475*                20  BV003-RT-BRND-OUT             PIC S9(04).            
W31475*                    88 BV003-RT-BRND-NOT-FOUND    VALUE +2230.           
W31475*                20  BV003-RT-DEPT-OUT             PIC S9(04).            
W31475*                20  BV003-RT-RLTNSHP-ID-OUT       PIC S9(09).            
               10  BV003-PV-RETURN-STATUS-AREA.                                 
                   15  BV003-PV-RETURN-CDE PIC S9(04)      VALUE ZEROES         
                               COMP.                                            
                       88  BV003-PV-NO-ERRORS-FOUND   VALUE 0.                  
                       88  BV003-PV-ERROR-FOUND       VALUES                    
                           +1, +2, +3, +4, +5, +6, +7, +8.                      
                       88  BV003-PV-FOUND-REL-OR-UNK  VALUES                    
RONNA                      0, +1.                                               
RONNA *                    0, +1, +3, +9.                                       
RONNA *                88  BV003-PV-ITM-OR-REL-NOT-FOUND VALUES +1, +3.         
RONNA                  88  BV003-PV-ITM-OR-REL-NOT-FOUND VALUES +1.             
RONNA *                                                         +9.             
                       88  BV003-PV-NO-REL-FOUND      VALUE +1.                 
                       88  BV003-BAD-INPUT            VALUE +2.                 
RONNA *                88  BV003-ITEM-NOT-FOUND       VALUE +3.                 
                       88  BV003-REL-ID-NOT-FOUND     VALUE +4.                 
                       88  BV003-PV-SQL-ERROR         VALUE +5.                 
                       88  BV003-NO-RLTNSHP-FOR-DTE   VALUE +6.                 
                       88  BV003-PV-INVALID-FUNCTION  VALUE +7.                 
                       88  BV003-PV-OTHER-ERROR       VALUE +8.                 
RONNA *                88  BV003-PV-ZERO-BRAND        VALUE +9.                 
                   15  BV003-PV-PAST-FUT-DBV-REL-SW   PIC X(01)                 
                                                      VALUE 'N'.                
                       88  BV003-PAST-DBV-REL-FOUND   VALUE 'P'.                
                       88  BV003-FUT-DBV-REL-FOUND    VALUE 'F'.                
                       88  BV003-PAST-OR-FUT-DBV-REL-FND                        
                                                      VALUES 'F' 'P'.           
                   15  BV003-PV-RETURN-MSG-1 PIC X(80) VALUE SPACES.            
                   15  BV003-PV-RETURN-MSG-2 PIC X(80) VALUE SPACES.            
               10  BV003-PV-UNKNOWN-INS-SW   PIC X(01) VALUE 'N'.               
                   88  BV003-UNKNOWN-INS     VALUE 'Y'.                         
               10  BV003-PV-DUMMY-SKU-OUT-SW PIC X(01) VALUE 'N'.               
                   88  BV003-DUMMY-SKU       VALUE 'Y'.                         
           05  BV003-PV-WORK-AREA.                                              
               10 BV003-PV-WORK-FUNC-FOUND-SW PIC X(01).                        
                  88 BV003-PV-WORK-FUNC-FOUND     VALUE 'Y'.                    
                  88 BV003-PV-WORK-FUNC-NOT-FOUND VALUE 'N'.                    
               10 BV003-PV-MORE-CSR-RECORDS-SW PIC X(01).                       
                  88 BV003-PV-MORE-RECORDS        VALUE 'Y'.                    
                  88 BV003-PV-NO-MORE-RECORDS     VALUE 'N'.                    
               10 BV003-PV-DATE-PROVIDED-SW    PIC X(01).                       
                  88 BV003-PV-DATE-PROVIDED       VALUE 'Y'.                    
                  88 BV003-PV-NO-DATE-PROVIDED    VALUE 'N'.                    
               10  BV003-PV-WORK-ENT-ID     PIC  S9(9)     VALUE ZEROES         
                               COMP.                                            
                   88  BV003-PV-WORK-ENT-NOT-FOUND         VALUE +5161.         
               10  BV003-PV-WORK-REL-ID    PIC S9(09)      VALUE ZEROES         
                               COMP.                                            
               10  BV003-PV-WORK-SEQ-NBR   PIC S9(9)      VALUE ZEROES          
                               COMP.                                            
               10  BV003-PV-WORK-SKU       PIC S9(08)V     VALUE ZEROES         
                               COMP-3.                                          
               10  BV003-PV-WORK-BRAND      PIC  S9(4)     VALUE ZEROES         
                               COMP.                                            
                   88  BV003-PV-WORK-BRAND-NOT-FOUND        VALUE +2230.        
               10  BV003-PV-WORK-UPC-NBR   PIC S9(15)V     VALUE ZEROES         
                               COMP-3.                                          
               10  BV003-PV-WORK-UPC-ID    PIC S9(09)      VALUE ZEROES         
                               COMP.                                            
               10  BV003-PV-WORK-DATE      PIC X(10)       VALUE SPACES.        
               10  BV003-PV-WORK-ITM-NBR   PIC S9(15)V     VALUE ZEROES         
                               COMP-3.                                          
               10  BV003-PV-WORK-DEPT      PIC S9(4)V VALUE ZEROES              
                                                      COMP-3.                   
               10  BV003-PV-WORK-RLTNSHP-ID PIC S9(09)    VALUE ZEROES          
                               COMP.                                            
               10  BV003-PV-WORK-SQL-CODE  PIC  S9(9)     VALUE ZEROES.         
               10  BV003-PV-WORK-BVD-ERROR-FIELDS PIC X(01).                    
                   88 BV003-WORK-ERROR-JUST-BRND    VALUE 'A'.                  
                   88 BV003-WORK-ERROR-BRND-DPT     VALUE 'B'.                  
                   88 BV003-WORK-ERROR-JUST-VNDR    VALUE 'C'.                  
                   88 BV003-WORK-ERROR-VNDR-DPT     VALUE 'D'.                  
                   88 BV003-WORK-ERROR-BV-DPT       VALUE 'E'.                  
           05  BV003-PC-CONSTANTS.                                              
               10 BV003-PC-UNK-VNDR              PIC S9(09) VALUE +5161         
                                                 COMP.                          
               10 BV003-PC-UNK-BRAND             PIC S9(04) VALUE +2230         
                                                 COMP.                          
W31475     05  BV003-PV-OUTPUT-AREA-TABLE.                                      
W31475         10  BV003-PV-RLTNSHP-OUT-TABLE            VALUE ZEROES.          
W31475             15  BV003-PV-RLTNSHP-ENTRY-OUT OCCURS 9999 TIMES             
W31475                 DEPENDING ON BV003-PV-RT-SUB-OUT.                        
W31475                 20  BV003-RT-ENT-ID-OUT           PIC S9(09).            
W31475                     88 BV003-RT-ENT-NOT-FOUND     VALUE +5161.           
W31475                 20  BV003-RT-BRND-OUT             PIC S9(04).            
W31475                     88 BV003-RT-BRND-NOT-FOUND    VALUE +2230.           
W31475                 20  BV003-RT-DEPT-OUT             PIC S9(04).            
W31475                 20  BV003-RT-RLTNSHP-ID-OUT       PIC S9(09).            
