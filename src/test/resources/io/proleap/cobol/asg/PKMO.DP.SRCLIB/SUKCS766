000100*-----------------------*                                         00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000300*-----------------------*                                         00030001
000400 PROGRAM-ID.    SUKCS766.                                         00040001
000500 AUTHOR.        DENISE HAHN.                                      00050001
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060001
000700 DATE-WRITTEN.  NOVEMBER 2015.                                    00070001
000800 DATE-COMPILED.                                                   00080001
000900*---------------------------------------------------------------* 00090001
001000*    S766 - OUTBOUND TRIP - UPDATE TRAILER SERIAL THAT IS         00100001
001100*    ASSIGNED TO THE TRIP.                                        00110001
001200*    THIS FUNCTION IS ONLY AVAILABLE TO THE SUPPORT TEAM.         00120001
001210* NAVIGATION:                                                     00121001
001300*    SUMENU ==> SUSOTBND (OUTBOUND TRAILER/DOOR STATUS SUKCS558)  00130001
001400*    KEY IN THE OUTBOUND TRIP F15 - UPDATE TRAILER SERIAL         00140001
001130*                                                                 00141051
001110* CHANGED 01/09/2023    BY JEAN KURK       WR: CHG0278099         00142051
001120* CHANGE CALL OF DPKCS030 TO BE DYNAMIC                           00143051
001500*---------------------------------------------------------------* 00150001
001600 ENVIRONMENT DIVISION.                                            00160001
001700 DATA DIVISION.                                                   00170001
001800                                                                  00180001
001900 WORKING-STORAGE SECTION.                                         00190001
002000*                                                                 00200001
002100 01  DK-DB2-KEYS.                                                 00210001
002200     05  DK-OPER-UNT-ID           PIC  S9(4) COMP   VALUE ZEROES. 00220010
002300     05  DK-TRIP-ID               PIC  S9(9) COMP   VALUE ZEROES. 00230010
002400     05  DK-TRLR-SRL-NBR          PIC  S9(9) COMP   VALUE ZEROES. 00240009
002500     05  DK-NEW-TRLR-SRL-NBR      PIC  S9(9) COMP   VALUE ZEROES. 00250009
002800*                                                                 00280001
002900 01  PC-PROGRAM-CONSTANTS.                                        00290001
002910     05  PC-CRIT-SPEC-FORMAT      PIC  X(01)  VALUE '1'.          00291014
003000     05  PC-CURRENT-PROGRAM-NAME  PIC  X(08)  VALUE  'SUKCS766'.  00300001
003100     05  PC-CURRENT-MAP-NAME      PIC  X(08)  VALUE  'SUK766  '.  00310001
003200     05  PC-CURRENT-MAPSET-NAME   PIC  X(08)  VALUE  'SUKM766 '.  00320001
003500     05  PC-MAX-RETRIES           PIC S9(04)  VALUE  +3           00350009
003600                                              COMP.               00360009
005400                                                                  00540001
005500*----------------------------------------------------------------*00550001
005600*  SYSTEM MESSAGES                                                00560001
005700*----------------------------------------------------------------*00570001
005800*   00005 - INVALID VALUE                                         00580001
005900*   00007 - REQUIRED ENTRY                                        00590001
006000*   00008 - MUST BE NUMERIC                                       00600001
006200*   00045 - INVALID FUNCTION                                      00620001
006300*   00059 - UPDATE(S) SUCCESSFUL                                  00630001
007805*   03772 - INVALID TRAILER STATUS - NO UPDATE ALLOWED            00780515
007806*   03773 - UPDATING TRAILER SRL - F2 TO CONFIRM                  00780641
007807*   03812 - ORIG STAT TMST MUST BE AFTER NEW TRLR TMST - RESTATUS 00780747
007808*----------------------------------------------------------------*00780841
007809     05  PC-TSYMSG-NUMBERS.                                       00780941
007810         10  PC-TSYMSG-00005      PIC  9(05)  VALUE  00005.       00781041
007811         10  PC-TSYMSG-00007      PIC  9(05)  VALUE  00007.       00781141
007812         10  PC-TSYMSG-00008      PIC  9(05)  VALUE  00008.       00781241
007830         10  PC-TSYMSG-00045      PIC  9(05)  VALUE  00045.       00783014
007840         10  PC-TSYMSG-00059      PIC  9(05)  VALUE  00059.       00784016
009310         10  PC-TSYMSG-03772      PIC  9(05)  VALUE  03772.       00931016
009320         10  PC-TSYMSG-03773      PIC  9(05)  VALUE  03773.       00932041
009330         10  PC-TSYMSG-03812      PIC  9(05)  VALUE  03812.       00933050
009500*                                                                 00950001
009600 01  PS-PROGRAM-SWITCHES.                                         00960001
009700     05  PS-ERROR-SW              PIC  X(01)  VALUE  'N'.         00970004
009800         88  PS-ERROR                         VALUE  'Y'.         00980004
009900         88  PS-NO-ERROR                      VALUE  'N'.         00990004
010000     05  PS-COMMAREA-SW           PIC  X(01)  VALUE  'N'.         01000014
010100         88  PS-COMMAREA-VALID                VALUE  'Y'.         01010014
010200         88  PS-COMMAREA-NOT-VALID            VALUE  'N'.         01020014
012100                                                                  01210041
012200 01  PV-PROGRAM-CONSTANTS.                                        01220019
012201     05  PC-MAX-ITEMS             PIC S9(09)  VALUE +3            01220119
012202                                              COMP-3.             01220219
012210 01  PV-PROGRAM-VARIABLES.                                        01221019
012300     05  PV-CICS-RESPONSE         PIC S9(04)  VALUE +0            01230014
012400                                              COMP SYNC.          01240014
012500     05  PV-RETRY-COUNTER         PIC S9(04)  VALUE +0            01250014
012600                                              COMP SYNC.          01260014
013500     05  PV-DISP-OPER             PIC  Z(04)  VALUE ZEROES.       01350021
013600     05  PV-DISP-DEST             PIC  Z(04)  VALUE ZEROES.       01360021
013700     05  PV-DISP-SCAC             PIC  X(04)  VALUE ZEROES.       01370021
013800     05  PV-DISP-TRLR             PIC  X(12)  VALUE ZEROES.       01380021
013900     05  PV-DISP-SRL              PIC  Z(09)  VALUE ZEROES.       01390021
014000     05  PV-DISP-NEW-SCAC         PIC  X(04)  VALUE ZEROES.       01400021
014100     05  PV-DISP-NEW-TRLR         PIC  X(12)  VALUE ZEROES.       01410021
014200     05  PV-DISP-NEW-SRL          PIC  Z(09)  VALUE ZEROES.       01420022
016300                                                                  01630001
016900*----------------------------------------------------------------*01690001
017000*    MAP LAYOUT                                                  *01700001
017100*----------------------------------------------------------------*01710001
017200     COPY SUKM766.                                                01720001
017300                                                                  01730001
017400*----------------------------------------------------------------*01740001
017500*    ATTRIBUTE SETTINGS COPYBOOK.                                *01750001
017600*----------------------------------------------------------------*01760001
017700     COPY DPWS015.                                                01770001
017800                                                                  01780001
017900*----------------------------------------------------------------*01790001
018000*    FUNCTION KEYS COPYBOOK                                      *01800001
018100*----------------------------------------------------------------*01810001
018200     COPY DPWS016.                                                01820001
018300                                                                  01830001
018400**--------------------------------------------------------------**01840001
018500** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **01850001
018600** SUB-ROUTINE (DPKUT100).                                      **01860001
018700**--------------------------------------------------------------**01870001
018800     COPY DPWS010I.                                               01880001
018900                                                                  01890001
019000**--------------------------------------------------------------**01900001
019200** PARAMETERS FOR CALLING CICS ARCHITECTURE API                 **01920051
019300**--------------------------------------------------------------**01930001
019400     COPY DPWS030.                                                01940001
019400     COPY DPWS930.                                                01941051
019500                                                                  01950001
019600**--------------------------------------------------------------**01960001
019700*    STANDARD COMMAREA.                                           01970001
019800**--------------------------------------------------------------**01980001
019900     COPY DPWS020.                                                01990001
020000     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02000001
020100                                                                  02010001
020200*---------------------------------------------------------------* 02020001
020300* INTER-APPLICATION COMMAREA.                                     02030001
020400*   SUWS008 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 02040001
020500*             SPEC SCREEN.                                        02050001
020800*---------------------------------------------------------------* 02080001
020900*                                                                 02090001
021000         10  INTER-APPL-COMM-AREA PIC X(200).                     02100001
021100     COPY SUWS008.                                                02110001
021300***************************************************************** 02130001
021400*    SPECIFIC COMMMAREA FOR SUKCS766.                             02140001
021500***************************************************************** 02150001
021600         10  ASC-SPECIFIC-COMMAREA.                               02160001
021710             15  ASC-OPER-UNT-ID           PIC S9(04)  COMP.      02171001
021711             15  ASC-OPER-NAME             PIC  X(25).            02171104
021720             15  ASC-TRLR-SRL-NBR          PIC  9(09).            02172001
021730             15  ASC-SCAC-CDE              PIC  X(04).            02173001
021740             15  ASC-TRLR-ID               PIC  X(12).            02174001
021741             15  ASC-TRIP-ID               PIC  9(09).            02174106
021742             15  ASC-TRIP-STAT-DESC        PIC  X(30).            02174202
021743             15  ASC-TRIP-STAT-CDE         PIC  X(08).            02174302
021744                 88  ASC-STAT-UPD-ALLOW                           02174402
021745                         VALUE  'AK', 'AO', 'DC', 'DO'.           02174514
021746                 88  ASC-STAT-NO-UPD-ALLOW                        02174602
021747                         VALUE  'AR', 'DR', 'DS', 'SO', 'SU'.     02174714
021748             15  ASC-OTBND-STAT-TMST       PIC  X(26).            02174802
021749             15  ASC-OTBND-STAT-TMST-R REDEFINES                  02174945
021750                                       ASC-OTBND-STAT-TMST.       02175045
021754                 20  ASC-ORIG-STAT-DATE    PIC  X(10).            02175445
021755                 20  FILLER                PIC  X(01).            02175545
021756                 20  ASC-ORIG-STAT-TIME    PIC  X(08).            02175645
021757                 20  FILLER                PIC  X(07).            02175745
021758             15  ASC-NEW-TRLR-SRL-NBR      PIC  9(09).            02175845
021759             15  ASC-NEW-SCAC-CDE          PIC  X(04).            02175945
021760             15 ASC-NEW-TRLR-ID            PIC  X(12).            02176045
021761             15 ASC-NEW-TRIP-STAT-DESC     PIC  X(30).            02176145
021762             15 ASC-NEW-TRIP-STAT-CDE      PIC  X(08).            02176245
021763                 88  ASC-NEW-STAT-UPD-ALLOW                       02176345
021764                         VALUE 'AR', 'DR', 'SU'.                  02176445
021765             15  ASC-NEW-OTBND-STAT-TMST   PIC  X(26).            02176545
021766             15  ASC-NEW-OTBND-STAT-TMST-R REDEFINES              02176645
021767                                       ASC-NEW-OTBND-STAT-TMST.   02176745
021768                 20  ASC-NEW-STAT-DATE     PIC  X(10).            02176845
021769                 20  FILLER                PIC  X(01).            02176945
021770                 20  ASC-NEW-STAT-TIME     PIC  X(08).            02177045
021771                 20  FILLER                PIC  X(07).            02177145
021772             15  ASC-NEW-TRIP-ID           PIC  9(09).            02177245
021773             15  ASC-DEST-NBR              PIC S9(04)  COMP.      02177345
021774             15  ASC-DEST-NAME             PIC  X(25).            02177445
021780                                                                  02178045
024100*SWITCHES                                                         02410001
024110             15  ASC-F2-CONFIRM-SW            PIC  X(01).         02411007
024120                 88  ASC-F2-CONFIRM-YES               VALUE 'Y'.  02412007
024130                 88  ASC-F2-CONFIRM-NO                VALUE 'N'.  02413007
028140                                                                  02814001
028150*----------------------------------------------------------------*02815001
028160*    ABEND PROCESSING COPYBOOK.                                  *02816001
028170*----------------------------------------------------------------*02817001
028180     COPY DPWS013.                                                02818001
028190                                                                  02819001
028200*----------------------------------------------------------------*02820001
028300*    DB2 TABLE FOR OUTBOUND TRAILER DEFINITION                    02830001
028400*----------------------------------------------------------------*02840001
028500     EXEC SQL                                                     02850001
028600          INCLUDE TCNTRID                                         02860001
028700     END-EXEC.                                                    02870001
028800                                                                  02880001
028900*----------------------------------------------------------------*02890001
029000*    DB2 TABLE FOR OUTBOUND TRIP DEFINITION                       02900001
029100*----------------------------------------------------------------*02910001
029200     EXEC SQL                                                     02920001
029300          INCLUDE TSUOBTR                                         02930001
029400     END-EXEC.                                                    02940001
029500                                                                  02950001
029600*----------------------------------------------------------------*02960001
029700*    DB2 TABLE FOR OUTBOUND TRIP STATUS                           02970001
029800*----------------------------------------------------------------*02980001
029900     EXEC SQL                                                     02990001
030000          INCLUDE TSUOBTS                                         03000001
030100     END-EXEC.                                                    03010001
032500                                                                  03250001
032600*----------------------------------------------------------------*03260010
032700*    DB2 TABLE FOR OUTBOUND TRIP STATUS CODE DESCRIPTIONS         03270010
032800*----------------------------------------------------------------*03280010
032900     EXEC SQL                                                     03290010
033000          INCLUDE TSUOBSC                                         03300010
033100     END-EXEC.                                                    03310010
033200                                                                  03320010
033300*----------------------------------------------------------------*03330010
033400*    XLT_LOC                                                      03340010
033500*----------------------------------------------------------------*03350010
033600     EXEC SQL                                                     03360010
033700          INCLUDE XLT00010                                        03370010
033800     END-EXEC.                                                    03380010
033900                                                                  03390010
034000*----------------------------------------------------------------*03400043
034010*    SUT_TRIP_WRKR_AUD                                            03401043
034020*----------------------------------------------------------------*03402043
034030     EXEC SQL                                                     03403043
034040          INCLUDE SUT00006                                        03404043
034050     END-EXEC.                                                    03405043
034060                                                                  03406043
034100*----------------------------------------------------------------*03410001
034200*    DB2 AREA FOR COMMUNICATIONS                                  03420001
034300*----------------------------------------------------------------*03430001
034400     EXEC SQL                                                     03440001
034500          INCLUDE SQLCA                                           03450001
034600     END-EXEC.                                                    03460001
034700                                                                  03470001
034800*----------------------------------------------------------------*03480001
034900 LINKAGE SECTION.                                                 03490001
035000                                                                  03500001
035100 01  DFHCOMMAREA.                                                 03510001
035200     05  FILLER                         OCCURS  1 TO 4072 TIMES   03520001
035300                                        DEPENDING ON EIBCALEN.    03530001
035400         10  FILLER                     PIC X.                    03540001
035500                                                                  03550001
035600 PROCEDURE DIVISION.                                              03560025
036510******************************************************************03651025
036520**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **03652025
036530**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **03653025
036540**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **03654025
036550******************************************************************03655025
036560 0000-MAIN-MODULE.                                                03656025
036600     INITIALIZE DP030-CICS-API-FIELDS.                            03660001
036700     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       03670001
036800     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          03680001
036900     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         03690001
037000     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       03700001
037100     MOVE LENGTH OF SUK766I        TO DP030-MAP-LENGTH (1).       03710001
037200     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     03720001
037300     PERFORM 0001-CALL-CICS-ARCH-API.                             03730001
037400                                                                  03740001
037500     PERFORM 1000-CONTROL-PROCESSING                              03750001
037600                                                                  03760001
037700     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     03770001
037800     PERFORM 0001-CALL-CICS-ARCH-API.                             03780001
037900                                                                  03790001
038000 0001-CALL-CICS-ARCH-API.                                         03800001
038100*    CALL 'DPKCS030' USING DFHEIBLK                               03810051
038100     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      03811051
038200                           DFHCOMMAREA                            03820001
038300                           DP030-CICS-API-FIELDS                  03830001
038400                           DP020-STANDARD-COMMAREA                03840001
038500                           SUK766I.                               03850001
038600                                                                  03860001
038700     IF  DP030-RC-CALL-SUCCESSFUL                                 03870001
038800         CONTINUE                                                 03880001
038900     ELSE                                                         03890001
039000         SET DP013-NO-ROLLBACK                                    03900001
039100             DP013-XCTL-DISPLAY-RESTART                           03910001
039200             DP013-CICS-ABEND      TO TRUE                        03920001
039300         MOVE 'BEFORE 0000-MAIN-MODULE'                           03930001
039400                                   TO DP013-PARAGRAPH             03940001
039500*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX03950051
039600*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      03960051
039500         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O03961051
039600-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      03962051
039700         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      03970001
039800         PERFORM DP013-0000-PROCESS-ABEND                         03980001
039900     END-IF.                                                      03990001
040000*                                                                 04000001
040100*----------------------------------------------------------------*04010001
040200*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *04020001
040300*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *04030001
040400*----------------------------------------------------------------*04040001
040500 1000-CONTROL-PROCESSING.                                         04050001
040600                                                                  04060001
040700     EVALUATE TRUE                                                04070001
040800         WHEN DP020-NEXT-ACT-INITIAL                              04080001
040900              INITIALIZE ASC-SPECIFIC-COMMAREA                    04090001
041000                                                                  04100001
041100              PERFORM 1100-PROCESS-INTER-APPL-COMM                04110001
041200                                                                  04120001
041600              PERFORM 4000-BUILD-INITIAL-PANEL                    04160014
041700              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                04170025
042300              PERFORM 3200-RESET-ATTRIBUTES                       04230025
042500                                                                  04250001
042600         WHEN DP020-NEXT-ACT-READ-MAP                             04260004
042700             PERFORM 2000-PROCESS-PANEL                           04270004
042710                                                                  04271004
042800*F3-END                                                           04280001
042900         WHEN DP020-NEXT-ACT-RETURN                               04290007
043000             PERFORM 4000-BUILD-INITIAL-PANEL                     04300007
043100             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   04310007
043200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 04320007
043300             MOVE -1                   TO ANEWSRLL                04330014
043400                                                                  04340007
043500         WHEN OTHER                                               04350007
043600             SET DP013-LOGIC-ABEND TO TRUE                        04360007
043700             SET DP013-NO-ROLLBACK TO TRUE                        04370007
043800             MOVE '1000-CONTROL-PROCESSING'                       04380007
043900                                   TO DP013-PARAGRAPH             04390007
044000             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    04400007
044100                                   TO DP013-MESSAGE-TEXT(1)       04410007
044200             MOVE DP020-NEXT-APPL-ACTIVITY                        04420007
044300                                   TO DP013-MESSAGE-TEXT(2)       04430007
044400             PERFORM DP013-0000-PROCESS-ABEND                     04440007
044500     END-EVALUATE.                                                04450007
044600                                                                  04460001
044700******************************************************************04470001
044800** DETERMINE THE KEY OF THE OBJECT TO BE UPDATED BASED ON THE   **04480001
044900** INTER-APPLICATION FORMAT CODE.                               **04490001
045000******************************************************************04500001
045100 1100-PROCESS-INTER-APPL-COMM.                                    04510001
045200                                                                  04520025
045210     SET PS-COMMAREA-VALID                                        04521001
045220         ASC-F2-CONFIRM-NO         TO TRUE.                       04522001
045230                                                                  04523001
045300     IF  DP020-INT-APPL-FORMAT-IND  = PC-CRIT-SPEC-FORMAT         04530001
046600          MOVE SU008-OPER-UNT-ID       TO ASC-OPER-UNT-ID         04660001
046700          MOVE SU008-TRLR-SRL-NBR      TO ASC-TRLR-SRL-NBR        04670001
046800          MOVE SU008-SCAC-CDE          TO ASC-SCAC-CDE            04680001
046900          MOVE SU008-TRLR-ID           TO ASC-TRLR-ID             04690001
047000          MOVE SU008-TRIP-ID           TO ASC-TRIP-ID             04700001
050200     END-IF.                                                      05020001
050300                                                                  05030001
059700*                                                                 05970001
059800*----------------------------------------------------------------*05980001
059900* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *05990001
060000* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *06000001
060100* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *06010001
060200* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *06020001
060300* FUNCTION KEYS CAN GET THIS FAR.                                *06030001
060400*----------------------------------------------------------------*06040001
060500 2000-PROCESS-PANEL.                                              06050004
060600                                                                  06060004
060700     EVALUATE TRUE                                                06070004
060900         WHEN DP020-SRC-AID = DP016-CLEAR                         06090004
061000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   06100004
061100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06110004
061200                                                                  06120004
061300*F5 REFRESH -                                                     06130001
061400         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     06140007
061600              SET  ASC-F2-CONFIRM-NO     TO  TRUE                 06160007
061700              PERFORM 4000-BUILD-INITIAL-PANEL                    06170007
061800              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                06180007
061900              PERFORM 3200-RESET-ATTRIBUTES                       06190007
061910                                                                  06191007
062000         WHEN OTHER                                               06200007
062100             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 06210007
062200             PERFORM 3200-RESET-ATTRIBUTES                        06220007
062300             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   06230007
062400             IF PS-NO-ERROR                                       06240037
062600                 PERFORM 2100-CHECK-FUNCTION-KEY                  06260037
062700                 IF PS-NO-ERROR                                   06270037
062710                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         06271037
062720                     SET DP030-CONTINUE-GO TO TRUE                06272037
062730                 ELSE                                             06273037
062731                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         06273140
062740                     SET DP030-OVERRIDE-GO TO TRUE                06274037
062750                 END-IF                                           06275037
062760             ELSE                                                 06276037
062761                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             06276137
062770                 SET DP030-OVERRIDE-GO TO TRUE                    06277037
062780             END-IF                                               06278037
063060     END-EVALUATE.                                                06306007
063070                                                                  06307007
063100                                                                  06310007
070100*----------------------------------------------------------------*07010001
070200* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED       *07020001
070300* FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED   *07030001
070400* FROM THE CICS ARCHITECTURE API.                                *07040001
070500*----------------------------------------------------------------*07050001
070600 2100-CHECK-FUNCTION-KEY.                                         07060007
070700     EVALUATE TRUE                                                07070007
070800         WHEN DP020-SRC-AID = DP016-ENTER                         07080008
073400              SET PS-NO-ERROR       TO TRUE                       07340008
073500              MOVE SPACES           TO DP020-MSG-SEVERITY-IND     07350008
073600              MOVE ZEROES           TO DP020-MSG-NUMBER           07360008
074100              MOVE DP015-UNP-ALP-NOR-MDT  TO ANEWSRLA             07410035
074200              MOVE DP015-GREEN            TO ANEWSRLC             07420008
074300              MOVE DP015-UNDERLINE        TO ANEWSRLH             07430008
074400              MOVE -1                     TO ANEWSRLL             07440008
074800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07480008
074900                                                                  07490007
074901* F02 = CONFIRM NO PREVIOUS UPDATE REQUEST                        07490107
074910         WHEN DP020-FK-CONFIRM  (DP020-SRC-AID) AND               07491007
074920              ASC-F2-CONFIRM-NO                                   07492007
074930               MOVE PC-TSYMSG-00045 TO DP020-MSG-NUMBER           07493007
074940               SET DP020-MSG-FATAL TO TRUE                        07494007
074950                                                                  07495007
075000* F02 = CONFIRM WITH PREVIOUS UPDATE REQUEST                      07500007
075100         WHEN DP020-FK-CONFIRM  (DP020-SRC-AID) AND               07510015
075200              ASC-F2-CONFIRM-YES                                  07520015
077000                                                                  07700007
077100              IF NOT ASC-NEW-TRLR-SRL-NBR  > 0                    07710007
077200                  SET PS-ERROR                                    07720007
077300                      DP020-MSG-FATAL         TO TRUE             07730007
077400                  MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER 07740007
077500                  MOVE DP015-UNP-ALP-BRT-MDT  TO ANEWSRLA         07750035
077600                  MOVE DP015-RED              TO ANEWSRLC         07760007
077700                  MOVE DP015-REVERSE          TO ANEWSRLH         07770007
077800                  MOVE -1                     TO ANEWSRLL         07780015
077900                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             07790007
078000           END-IF                                                 07800007
083400           IF PS-NO-ERROR                                         08340007
083500               PERFORM 5100-PROCESS-UPDATE                        08350007
083600               SET  ASC-F2-CONFIRM-NO         TO TRUE             08360007
083700               IF PS-NO-ERROR                                     08370007
083800                   PERFORM 2110-PREPARE-INTER-APPL-COMM           08380007
083900               END-IF                                             08390007
084000           END-IF                                                 08400007
084100                                                                  08410007
084200* F15 = UPDATE TRAILER SERIAL                                     08420007
084300         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              08430007
084400           IF NOT ASC-NEW-TRLR-SRL-NBR > 0                        08440007
084500                 SET PS-ERROR                                     08450007
084600                     DP020-MSG-FATAL         TO TRUE              08460007
084700                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  08470007
084800                 MOVE DP015-UNP-ALP-BRT-MDT  TO ANEWSRLA          08480035
084900                 MOVE DP015-RED              TO ANEWSRLC          08490014
085000                 MOVE DP015-REVERSE          TO ANEWSRLH          08500014
085100                 MOVE -1                     TO ANEWSRLL          08510014
085200                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              08520007
085300           END-IF                                                 08530007
085301                                                                  08530107
085310           IF  PS-NO-ERROR                                        08531049
085500               PERFORM 3015-GET-CURRENT-TRIP-STATUS               08550015
086400           END-IF                                                 08640007
086401                                                                  08640107
086402           IF  PS-NO-ERROR                                        08640207
086410               PERFORM 3030-GET-NEW-SCAC-TRLR                     08641007
086420           END-IF                                                 08642007
086430                                                                  08643007
086440           IF  PS-NO-ERROR                                        08644007
086441               PERFORM 3035-GET-NEW-TRIP-STATUS                   08644107
086450           END-IF                                                 08645007
086460                                                                  08646007
086470           IF  PS-NO-ERROR                                        08647007
086471               SET  ASC-F2-CONFIRM-YES      TO  TRUE              08647107
086480           END-IF                                                 08648007
086490                                                                  08649007
113125           IF  PS-NO-ERROR                                        11312507
113126                SET ASC-F2-CONFIRM-YES      TO TRUE               11312607
113127                SET PS-ERROR                TO TRUE               11312707
113128                SET DP020-MSG-FATAL         TO TRUE               11312807
113129                MOVE PC-TSYMSG-03773        TO DP020-MSG-NUMBER   11312941
113130                MOVE DP015-PRO-NOR-MDT      TO ANEWSRLA           11313031
113140                MOVE DP015-BLUE             TO ANEWSRLC           11314007
113150                MOVE -1                     TO ANEWSRLL           11315007
113160                SET DP030-SET-CURSOR-APPL-1 TO TRUE               11316007
113170           END-IF                                                 11317007
113180                                                                  11318007
117400         WHEN OTHER                                               11740007
117500             SET DP013-NO-ROLLBACK                                11750007
117600                 DP013-XCTL-DISPLAY-RESTART                       11760007
117700                 DP013-CICS-ABEND      TO TRUE                    11770007
117800             MOVE '2000-PROCESS-PANEL' TO DP013-PARAGRAPH         11780007
117900             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      11790007
118000                                   TO DP013-MESSAGE-TEXT (1)      11800007
118100             PERFORM DP013-0000-PROCESS-ABEND                     11810007
118200                                                                  11820007
118300     END-EVALUATE.                                                11830007
118400*                                                                 11840001
118500******************************************************************11850001
118600** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **11860001
118700** INTER-APPLICATION COMMAREA.                                  **11870001
118800******************************************************************11880001
118900 2110-PREPARE-INTER-APPL-COMM.                                    11890015
119000                                                                  11900015
119100     INITIALIZE SU008-INTER-APPL-COMMAREA.                        11910015
119200                                                                  11920015
119210     MOVE ASC-OPER-UNT-ID       TO  SU008-OPER-UNT-ID.            11921015
119230     MOVE ASC-TRIP-ID           TO  SU008-TRIP-ID .               11923015
119280     MOVE ASC-TRLR-SRL-NBR      TO  SU008-TRLR-SRL-NBR.           11928015
119290     MOVE ASC-SCAC-CDE          TO  SU008-SCAC-CDE.               11929015
119291     MOVE ASC-TRLR-ID           TO  SU008-TRLR-ID.                11929115
119295                                                                  11929515
120700                                                                  12070015
120800*----------------------------------------------------------------*12080001
120900* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS   *12090001
121000* IN THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN   *12100001
121100* THE APPLICATION-SPECIFIC COMMAERA, NOT ON THE SCREEN.          *12110001
121200* THIS PARAGRAPH DOES NOT USE TEMPORARY VARIABLES.               *12120001
121300*----------------------------------------------------------------*12130001
121400 2200-MOVE-SCREEN-TO-COMMAREA.                                    12140007
121500*NEW SERIAL                                                       12150007
121600         IF  ANEWSRLL > ZERO                                      12160007
121700             MOVE ANEWSRLI             TO ASC-NEW-TRLR-SRL-NBR    12170007
121900         ELSE                                                     12190007
122000             IF  ANEWSRLF = DP015-ERASE-EOF                       12200007
122100                 MOVE ZEROES           TO ASC-NEW-TRLR-SRL-NBR    12210007
122200             END-IF                                               12220007
122300         END-IF.                                                  12230015
122400                                                                  12240007
126900                                                                  12690007
127000*----------------------------------------------------------------*12700001
127100* PERFORM EDITS ON EACH FIELD ENTERED BY THE USER.  IF AN ERROR  *12710001
127200* IS FOUND, THE CURSOR IS POSITIONED AT THAT FIELD AND AN        *12720001
127300* APPROPRIATE ERROR MESSAGE IS DISPLAYED.                        *12730001
127400*----------------------------------------------------------------*12740001
127500 3000-EDIT-DATA-IN-COMMAREA.                                      12750004
127600                                                                  12760004
127700     IF  ASC-TRIP-ID  >  0                                        12770004
127800         PERFORM 3005-GET-ORIGINAL-TRIP-SRL                       12780005
128000     END-IF                                                       12800004
128010                                                                  12801004
128011     IF  ASC-TRIP-ID  >  0  AND                                   12801104
128012         PS-NO-ERROR                                              12801204
128013         PERFORM 3010-GET-ORIGINAL-SCAC-TRLR                      12801305
128014     END-IF                                                       12801404
128015                                                                  12801504
128016     IF  ASC-TRIP-ID  >  0  AND                                   12801604
128017         PS-NO-ERROR                                              12801704
128018         PERFORM 3015-GET-CURRENT-TRIP-STATUS                     12801815
128019     END-IF                                                       12801904
128020                                                                  12802004
128021     IF  ASC-NEW-TRLR-SRL-NBR  > 0                                12802105
128023         PERFORM 3030-GET-NEW-SCAC-TRLR                           12802305
128024     END-IF                                                       12802405
128025                                                                  12802504
128026     IF  ASC-NEW-TRLR-SRL-NBR  > 0  AND                           12802615
128027         PS-NO-ERROR                                              12802705
128029         PERFORM 3035-GET-NEW-TRIP-STATUS                         12802905
128030     END-IF                                                       12803005
128031                                                                  12803104
128032     IF  DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)  AND              12803207
128034         PS-NO-ERROR                                              12803407
128035         SET ASC-F2-CONFIRM-NO          TO TRUE                   12803507
128036         IF  ASC-NEW-TRLR-SRL-NBR  > 0                            12803607
128037             CONTINUE                                             12803707
128038         ELSE                                                     12803807
128039             SET PS-ERROR                                         12803907
128040                 DP020-MSG-FATAL         TO TRUE                  12804007
128041             MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER      12804107
128042             MOVE DP015-UNP-ALP-BRT-MDT  TO ANEWSRLA              12804235
128043             MOVE DP015-RED              TO ANEWSRLC              12804307
128044             MOVE DP015-REVERSE          TO ANEWSRLH              12804407
128045             MOVE -1                     TO ANEWSRLL              12804507
128046             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  12804607
128047         END-IF                                                   12804707
128048     END-IF.                                                      12804807
128049                                                                  12804907
128050                                                                  12805007
137501                                                                  13750104
137502******************************************************************13750204
137503** GET TRAILER SERIAL FOR ORIGINAL TRIP                         **13750304
137504******************************************************************13750404
137510 3005-GET-ORIGINAL-TRIP-SRL.                                      13751004
137520      MOVE ASC-TRIP-ID  TO  SUOBTR-OTBND-TRIP-ID.                 13752004
137530                                                                  13753004
137540        EXEC SQL                                                  13754004
137550          SELECT  TRLR_SRL_NBR                                    13755004
137560            INTO :SUOBTR-TRLR-SRL-NBR                             13756013
137570            FROM  TSUOBTR                                         13757013
137580           WHERE  OTBND_TRIP_ID  = :SUOBTR-OTBND-TRIP-ID          13758004
137590            WITH UR                                               13759005
137591        END-EXEC                                                  13759104
137592                                                                  13759204
137593        EVALUATE TRUE                                             13759304
137594            WHEN SQLCODE = +0                                     13759404
137595                MOVE SUOBTR-TRLR-SRL-NBR  TO  ASC-TRLR-SRL-NBR    13759532
137596            WHEN SQLCODE = +100                                   13759604
137597                                                                  13759721
137598                MOVE ASC-OPER-UNT-ID      TO PV-DISP-OPER         13759821
137599                MOVE ASC-DEST-NBR         TO PV-DISP-DEST         13759921
137600                MOVE ASC-SCAC-CDE         TO PV-DISP-SCAC         13760021
137601                MOVE ASC-TRLR-ID          TO PV-DISP-TRLR         13760121
137602                MOVE ASC-TRLR-SRL-NBR     TO PV-DISP-SRL          13760221
137603                MOVE ASC-NEW-SCAC-CDE     TO PV-DISP-NEW-SCAC     13760321
137604                MOVE ASC-NEW-TRLR-ID      TO PV-DISP-NEW-TRLR     13760421
137605                MOVE ASC-NEW-TRLR-SRL-NBR TO PV-DISP-SRL          13760524
137606                STRING  PV-DISP-OPER '-'                          13760621
137607                        PV-DISP-DEST ' - FROM '                   13760721
137608                        PV-DISP-SCAC '-'                          13760821
137609                        PV-DISP-TRLR '-'                          13760921
137610                        PV-DISP-SRL    DELIMITED BY SIZE          13761021
137620                                  INTO DP013-MESSAGE-TEXT (1)     13762021
137621                STRING                                            13762121
137622                        ' TO '                                    13762221
137623                        PV-DISP-NEW-SCAC                          13762321
137624                        PV-DISP-NEW-TRLR                          13762421
137625                        PV-DISP-SRL    DELIMITED BY SIZE          13762521
137626                                  INTO DP013-MESSAGE-TEXT (2)     13762621
137630                                                                  13763021
137631                SET PS-ERROR                                      13763104
137632                    DP020-MSG-FATAL         TO TRUE               13763204
137633                MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER   13763304
137634                MOVE DP015-PRO-NOR-MDT      TO ATRIPIDA           13763415
137635                MOVE DP015-RED              TO ATRIPIDC           13763504
137636                MOVE DP015-REVERSE          TO ATRIPIDH           13763604
137637                MOVE -1                     TO ANEWSRLL           13763704
137638                SET DP030-SET-CURSOR-APPL-1 TO TRUE               13763804
137639                MOVE SPACES                 TO ANEWSRLO           13763915
137640                                                                  13764004
137641            WHEN SQLWARN0 NOT = SPACES                            13764104
137642            WHEN SQLCODE < +0                                     13764204
137643            WHEN SQLCODE > +0                                     13764304
137644                                                                  13764421
137645                MOVE ASC-OPER-UNT-ID      TO PV-DISP-OPER         13764521
137646                MOVE ASC-DEST-NBR         TO PV-DISP-DEST         13764621
137647                MOVE ASC-SCAC-CDE         TO PV-DISP-SCAC         13764721
137648                MOVE ASC-TRLR-ID          TO PV-DISP-TRLR         13764821
137649                MOVE ASC-TRLR-SRL-NBR     TO PV-DISP-SRL          13764921
137650                MOVE ASC-NEW-SCAC-CDE     TO PV-DISP-NEW-SCAC     13765021
137651                MOVE ASC-NEW-TRLR-ID      TO PV-DISP-NEW-TRLR     13765121
137652                MOVE ASC-NEW-TRLR-SRL-NBR TO PV-DISP-SRL          13765224
137653                STRING  PV-DISP-OPER '-'                          13765321
137654                        PV-DISP-DEST ' - FROM '                   13765421
137655                        PV-DISP-SCAC '-'                          13765521
137656                        PV-DISP-TRLR '-'                          13765621
137657                        PV-DISP-SRL    DELIMITED BY SIZE          13765721
137658                                  INTO DP013-MESSAGE-TEXT (1)     13765821
137659                STRING                                            13765921
137660                        ' TO '                                    13766021
137661                        PV-DISP-NEW-SCAC                          13766121
137662                        PV-DISP-NEW-TRLR                          13766221
137663                        PV-DISP-SRL    DELIMITED BY SIZE          13766321
137664                                  INTO DP013-MESSAGE-TEXT (2)     13766421
137665                                                                  13766521
137666                MOVE '3005-GET-ORIGINAL-TRIP-SRL  '               13766604
137667                                          TO DP013-PARAGRAPH      13766704
137668                MOVE 'GET ORIGINAL TRIP SERIAL NUMBER'            13766804
137669                                    TO DP013-MESSAGE-TEXT (3)     13766921
137670                MOVE SQLCA      TO DP013-SQLCA                    13767004
137671                MOVE 'TSUOBTR'  TO DP013-DB2-TABLE-NAME (1)       13767104
137672                SET DP013-DB2-ABEND                               13767204
137673                    DP013-XCTL-DISPLAY-RESTART TO TRUE            13767304
137674                PERFORM DP013-0000-PROCESS-ABEND                  13767404
137675        END-EVALUATE.                                             13767504
137676                                                                  13767604
137677                                                                  13767704
137678******************************************************************13767804
137679** GET SCAC/TRAILER FOR ORIGINAL TRAILER SERIAL                 **13767904
137680******************************************************************13768004
137681 3010-GET-ORIGINAL-SCAC-TRLR.                                     13768104
137682                                                                  13768204
137683      MOVE ASC-TRLR-SRL-NBR TO CNTRID-TRLR-SRL-NBR.               13768304
137684                                                                  13768404
137685        EXEC SQL                                                  13768504
137686          SELECT  SCAC_CDE                                        13768604
137687               ,  TRLR_ID                                         13768704
137688            INTO :CNTRID-SCAC-CDE                                 13768804
137689               , :CNTRID-TRLR-ID                                  13768904
137690            FROM  TCNTRID                                         13769004
137691           WHERE  TRLR_SRL_NBR   = :CNTRID-TRLR-SRL-NBR           13769104
137692            WITH UR                                               13769205
137693        END-EXEC                                                  13769304
137694                                                                  13769404
137695        EVALUATE TRUE                                             13769504
137696            WHEN SQLCODE = +0                                     13769604
137697                 MOVE CNTRID-SCAC-CDE  TO  ASC-SCAC-CDE           13769704
137698                 MOVE CNTRID-TRLR-ID   TO  ASC-TRLR-ID            13769804
137699            WHEN SQLCODE = +100                                   13769904
137700                 MOVE SPACES           TO  ASC-SCAC-CDE           13770004
137701                                           ASC-TRLR-ID            13770104
137702                SET PS-ERROR                                      13770204
137703                    DP020-MSG-FATAL         TO TRUE               13770304
137704                MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER   13770404
137705                MOVE DP015-PRO-NOR-MDT      TO ASRLNBRA           13770515
137706                MOVE DP015-RED              TO ASRLNBRC           13770604
137707                MOVE DP015-REVERSE          TO ASRLNBRH           13770704
137708                MOVE -1                     TO ANEWSRLL           13770804
137709                SET DP030-SET-CURSOR-APPL-1 TO TRUE               13770904
137710                                                                  13771004
137711            WHEN SQLWARN0 NOT = SPACES                            13771104
137712            WHEN SQLCODE < +0                                     13771204
137713            WHEN SQLCODE > +0                                     13771304
137714                                                                  13771421
137715                MOVE ASC-OPER-UNT-ID      TO PV-DISP-OPER         13771521
137716                MOVE ASC-DEST-NBR         TO PV-DISP-DEST         13771621
137717                MOVE ASC-SCAC-CDE         TO PV-DISP-SCAC         13771721
137718                MOVE ASC-TRLR-ID          TO PV-DISP-TRLR         13771821
137719                MOVE ASC-TRLR-SRL-NBR     TO PV-DISP-SRL          13771921
137720                MOVE ASC-NEW-SCAC-CDE     TO PV-DISP-NEW-SCAC     13772021
137721                MOVE ASC-NEW-TRLR-ID      TO PV-DISP-NEW-TRLR     13772121
137722                MOVE ASC-NEW-TRLR-SRL-NBR TO PV-DISP-SRL          13772224
137723                STRING  PV-DISP-OPER '-'                          13772321
137724                        PV-DISP-DEST ' - FROM '                   13772421
137725                        PV-DISP-SCAC '-'                          13772521
137726                        PV-DISP-TRLR '-'                          13772621
137727                        PV-DISP-SRL    DELIMITED BY SIZE          13772721
137728                                  INTO DP013-MESSAGE-TEXT (1)     13772821
137729                STRING                                            13772921
137730                        ' TO '                                    13773021
137731                        PV-DISP-NEW-SCAC                          13773121
137732                        PV-DISP-NEW-TRLR                          13773221
137733                        PV-DISP-SRL    DELIMITED BY SIZE          13773321
137734                                  INTO DP013-MESSAGE-TEXT (2)     13773421
137735                                                                  13773521
137738                MOVE '3010-GET-ORIGINAL-SCAC-TRLR '               13773804
137739                                          TO DP013-PARAGRAPH      13773904
137740                MOVE 'GET ORIGINAL TRLR SRL - SCAC/TRLR'          13774004
137741                                    TO DP013-MESSAGE-TEXT (3)     13774121
137742                MOVE SQLCA      TO DP013-SQLCA                    13774204
137743                MOVE 'TCNTRID'  TO DP013-DB2-TABLE-NAME (1)       13774304
137744                SET DP013-DB2-ABEND                               13774404
137745                    DP013-XCTL-DISPLAY-RESTART TO TRUE            13774504
137746                PERFORM DP013-0000-PROCESS-ABEND                  13774604
137747        END-EVALUATE.                                             13774704
137748                                                                  13774804
137749                                                                  13774904
137750******************************************************************13775004
137751** GET CURRENT TRIP STATUS                                      **13775104
137752******************************************************************13775204
137753 3015-GET-CURRENT-TRIP-STATUS.                                    13775304
137754                                                                  13775404
137755      MOVE ASC-TRIP-ID  TO  SUOBTS-OTBND-TRIP-ID.                 13775504
137756                                                                  13775604
137757        EXEC SQL                                                  13775704
137758          SELECT  A.TRIP_STAT_CDE                                 13775804
137759               ,  A.OTBND_STAT_TMST                               13775904
137760               ,  C.TRIP_STAT_DESC                                13776004
137761            INTO :SUOBTS-TRIP-STAT-CDE                            13776104
137762               , :SUOBTS-OTBND-STAT-TMST                          13776204
137763               , :SUOBSC-TRIP-STAT-DESC                           13776304
137764            FROM  TSUOBTS A                                       13776404
137765               ,  TSUOBSC C                                       13776504
137766           WHERE  A.OTBND_TRIP_ID  = :SUOBTS-OTBND-TRIP-ID        13776604
137767             AND  A.OTBND_STAT_TMST IN                            13776704
137768                 (SELECT MAX(B.OTBND_STAT_TMST)                   13776804
137769                    FROM TSUOBTS B                                13776904
137770                   WHERE A.OTBND_TRIP_ID  =  B.OTBND_TRIP_ID)     13777004
137771             AND A.TRIP_STAT_CDE          =  C.TRIP_STAT_CDE      13777104
137772            WITH UR                                               13777205
137773        END-EXEC                                                  13777304
137774                                                                  13777404
137775        EVALUATE TRUE                                             13777504
137776            WHEN SQLCODE = +0                                     13777604
137777              MOVE SUOBTS-TRIP-STAT-CDE                           13777704
137778                   TO  ASC-TRIP-STAT-CDE                          13777804
137779              MOVE SUOBTS-OTBND-STAT-TMST                         13777904
137780                   TO  ASC-OTBND-STAT-TMST                        13778004
137781              MOVE SUOBSC-TRIP-STAT-DESC                          13778104
137782                   TO  ASC-TRIP-STAT-DESC                         13778204
137783                                                                  13778304
137784              PERFORM 3020-VALIDATE-STATUS                        13778404
137785                                                                  13778504
137786            WHEN SQLWARN0 NOT = SPACES                            13778604
137787            WHEN SQLCODE < +0                                     13778704
137788            WHEN SQLCODE > +0                                     13778804
137789                                                                  13778921
137790                MOVE ASC-OPER-UNT-ID      TO PV-DISP-OPER         13779021
137791                MOVE ASC-DEST-NBR         TO PV-DISP-DEST         13779121
137792                MOVE ASC-SCAC-CDE         TO PV-DISP-SCAC         13779221
137793                MOVE ASC-TRLR-ID          TO PV-DISP-TRLR         13779321
137794                MOVE ASC-TRLR-SRL-NBR     TO PV-DISP-SRL          13779421
137795                MOVE ASC-NEW-SCAC-CDE     TO PV-DISP-NEW-SCAC     13779521
137796                MOVE ASC-NEW-TRLR-ID      TO PV-DISP-NEW-TRLR     13779621
137797                MOVE ASC-NEW-TRLR-SRL-NBR TO PV-DISP-SRL          13779724
137798                STRING  PV-DISP-OPER '-'                          13779821
137799                        PV-DISP-DEST ' - FROM '                   13779921
137800                        PV-DISP-SCAC '-'                          13780021
137801                        PV-DISP-TRLR '-'                          13780121
137802                        PV-DISP-SRL    DELIMITED BY SIZE          13780221
137803                                  INTO DP013-MESSAGE-TEXT (1)     13780321
137804                STRING                                            13780421
137805                        ' TO '                                    13780521
137806                        PV-DISP-NEW-SCAC                          13780621
137807                        PV-DISP-NEW-TRLR                          13780721
137808                        PV-DISP-SRL    DELIMITED BY SIZE          13780821
137809                                  INTO DP013-MESSAGE-TEXT (2)     13780921
137810                                                                  13781021
137811                MOVE '3015-GET-CURRENT-TRIP-STATUS'               13781104
137812                                          TO DP013-PARAGRAPH      13781204
137813                MOVE 'GET TRIP CURRENT STATUS        '            13781304
137814                                    TO DP013-MESSAGE-TEXT (3)     13781421
137815                MOVE SQLCA      TO DP013-SQLCA                    13781504
137816                MOVE 'TSUOBTS'  TO DP013-DB2-TABLE-NAME (1)       13781604
137817                MOVE 'TSUOBSC'  TO DP013-DB2-TABLE-NAME (2)       13781704
137818                SET DP013-DB2-ABEND                               13781804
137819                    DP013-XCTL-DISPLAY-RESTART TO TRUE            13781904
137820                PERFORM DP013-0000-PROCESS-ABEND                  13782004
137821        END-EVALUATE.                                             13782104
137822                                                                  13782204
137823                                                                  13782304
137824******************************************************************13782404
137825** VERIFY THAT THE TRIP IS IN A STATUS THAT CAN BE CHANGED      **13782504
137826*   AK - AUDIT KEEP                                             **13782604
137827*   AO - AUDIT OPEN                                             **13782704
137828*   DC - DC CLOSED                                              **13782804
137829*   DO - DC OPENED                                              **13782904
137830******************************************************************13783004
137831 3020-VALIDATE-STATUS.                                            13783104
137832                                                                  13783204
137833     IF  ASC-STAT-UPD-ALLOW                                       13783304
137834         CONTINUE                                                 13783404
137835     ELSE                                                         13783504
137836         SET PS-ERROR                                             13783604
137837             DP020-MSG-FATAL         TO TRUE                      13783704
137838         MOVE PC-TSYMSG-03772        TO DP020-MSG-NUMBER          13783815
137839         MOVE DP015-PRO-NOR-MDT      TO ATRSTATA                  13783915
137840                                        ASTDESCA                  13784004
137841         MOVE DP015-RED              TO ATRSTATC                  13784104
137842                                        ASTDESCC                  13784204
137843         MOVE DP015-REVERSE          TO ATRSTATH                  13784304
137844                                        ASTDESCH                  13784404
137845         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      13784504
137846     END-IF.                                                      13784604
137847                                                                  13784704
137864                                                                  13786447
137865******************************************************************13786505
137866** GET SCAC/TRAILER FOR NEW TRAILER SERIAL                      **13786605
137867******************************************************************13786705
137868 3030-GET-NEW-SCAC-TRLR.                                          13786805
137869                                                                  13786905
137870      MOVE ASC-NEW-TRLR-SRL-NBR  TO  CNTRID-TRLR-SRL-NBR.         13787005
137871                                                                  13787105
137872        EXEC SQL                                                  13787205
137873          SELECT  SCAC_CDE                                        13787305
137874               ,  TRLR_ID                                         13787405
137875            INTO :CNTRID-SCAC-CDE                                 13787505
137876               , :CNTRID-TRLR-ID                                  13787605
137877            FROM  TCNTRID                                         13787705
137878           WHERE  TRLR_SRL_NBR   = :CNTRID-TRLR-SRL-NBR           13787805
137879            WITH UR                                               13787905
137880        END-EXEC                                                  13788005
137881                                                                  13788105
137882        EVALUATE TRUE                                             13788205
137883            WHEN SQLCODE = +0                                     13788305
137884                 MOVE CNTRID-SCAC-CDE  TO  ASC-NEW-SCAC-CDE       13788405
137885                 MOVE CNTRID-TRLR-ID   TO  ASC-NEW-TRLR-ID        13788505
137886            WHEN SQLCODE = +100                                   13788605
137887                 MOVE SPACES       TO  ASC-NEW-SCAC-CDE           13788736
137888                                       ASC-NEW-TRLR-ID            13788836
137889                                       ASC-NEW-TRIP-STAT-DESC     13788936
137890                                       ASC-NEW-TRIP-STAT-CDE      13789036
137891                                       ASC-NEW-OTBND-STAT-TMST    13789136
137892                 MOVE ZEROES       TO  ASC-NEW-TRIP-ID            13789236
137893                SET PS-ERROR                                      13789305
137894                    DP020-MSG-FATAL         TO TRUE               13789405
137895                MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER   13789505
137896                MOVE DP015-UNP-ALP-BRT-MDT  TO ANEWSRLA           13789635
137897                MOVE DP015-RED              TO ANEWSRLC           13789705
137898                MOVE DP015-REVERSE          TO ANEWSRLH           13789805
137899                MOVE -1                     TO ANEWSRLL           13789905
137900                SET DP030-SET-CURSOR-APPL-1 TO TRUE               13790005
137901                                                                  13790105
137902            WHEN SQLWARN0 NOT = SPACES                            13790205
137903            WHEN SQLCODE < +0                                     13790305
137904            WHEN SQLCODE > +0                                     13790405
137905                                                                  13790521
137906                MOVE ASC-OPER-UNT-ID      TO PV-DISP-OPER         13790621
137907                MOVE ASC-DEST-NBR         TO PV-DISP-DEST         13790721
137908                MOVE ASC-SCAC-CDE         TO PV-DISP-SCAC         13790821
137909                MOVE ASC-TRLR-ID          TO PV-DISP-TRLR         13790921
137910                MOVE ASC-TRLR-SRL-NBR     TO PV-DISP-SRL          13791021
137911                MOVE ASC-NEW-SCAC-CDE     TO PV-DISP-NEW-SCAC     13791121
137912                MOVE ASC-NEW-TRLR-ID      TO PV-DISP-NEW-TRLR     13791221
137913                MOVE ASC-NEW-TRLR-SRL-NBR TO PV-DISP-SRL          13791324
137914                STRING  PV-DISP-OPER '-'                          13791421
137915                        PV-DISP-DEST ' - FROM '                   13791521
137916                        PV-DISP-SCAC '-'                          13791621
137917                        PV-DISP-TRLR '-'                          13791721
137918                        PV-DISP-SRL    DELIMITED BY SIZE          13791821
137919                                  INTO DP013-MESSAGE-TEXT (1)     13791921
137920                STRING                                            13792021
137921                        ' TO '                                    13792121
137922                        PV-DISP-NEW-SCAC                          13792221
137923                        PV-DISP-NEW-TRLR                          13792321
137924                        PV-DISP-SRL    DELIMITED BY SIZE          13792421
137925                                  INTO DP013-MESSAGE-TEXT (2)     13792521
137926                                                                  13792621
137927                MOVE '3030-GET-NEW-SCAC-TRLR      '               13792705
137928                                          TO DP013-PARAGRAPH      13792805
137929                MOVE 'GET NEW TRLR SRL - SCAC/TRLR     '          13792905
137930                                    TO DP013-MESSAGE-TEXT (3)     13793021
137931                MOVE SQLCA      TO DP013-SQLCA                    13793105
137932                MOVE 'TCNTRID'  TO DP013-DB2-TABLE-NAME (1)       13793205
137933                SET DP013-DB2-ABEND                               13793305
137934                    DP013-XCTL-DISPLAY-RESTART TO TRUE            13793405
137935                PERFORM DP013-0000-PROCESS-ABEND                  13793505
137936        END-EVALUATE.                                             13793605
137937                                                                  13793705
137938                                                                  13793805
137939******************************************************************13793905
137940** GET NEW TRLR SERIAL - CURRENT TRIP & STATUS                  **13794005
137941******************************************************************13794105
137942 3035-GET-NEW-TRIP-STATUS.                                        13794205
137943                                                                  13794305
137944      MOVE ASC-NEW-TRLR-SRL-NBR  TO  SUOBTR-TRLR-SRL-NBR.         13794417
137945                                                                  13794505
137946        EXEC SQL                                                  13794605
137947          SELECT D.OTBND_TRIP_ID                                  13794705
137948               , E.OTBND_STAT_TMST                                13794805
137949               , E.TRIP_STAT_CDE                                  13794905
137950               , F.TRIP_STAT_DESC                                 13795005
137951            INTO :SUOBTR-OTBND-TRIP-ID                            13795106
137952               , :SUOBTS-OTBND-STAT-TMST                          13795205
137953               , :SUOBTS-TRIP-STAT-CDE                            13795305
137954               , :SUOBSC-TRIP-STAT-DESC                           13795405
137955            FROM TSUOBTR D                                        13795505
137956               , TSUOBTS E                                        13795605
137957               , TSUOBSC F                                        13795705
137958           WHERE D.TRLR_SRL_NBR  = :SUOBTR-TRLR-SRL-NBR           13795817
137959             AND D.OTBND_TRIP_ID = E.OTBND_TRIP_ID                13795905
137960             AND E.TRIP_STAT_CDE = F.TRIP_STAT_CDE                13796005
137961             AND E.OTBND_STAT_TMST IN                             13796105
137962                 (SELECT MAX(T1.OTBND_STAT_TMST)                  13796205
137963                    FROM                                          13796305
137964                      (SELECT B.OTBND_STAT_TMST                   13796405
137965                         FROM TSUOBTR A                           13796505
137966                            , TSUOBTS B                           13796605
137967                         WHERE A.TRLR_SRL_NBR  =                  13796705
137968                                          :SUOBTR-TRLR-SRL-NBR    13796818
137969                           AND A.OTBND_TRIP_ID = B.OTBND_TRIP_ID  13796905
137970                           AND B.OTBND_STAT_TMST  IN              13797005
137971                              (SELECT MAX(C.OTBND_STAT_TMST)      13797105
137972                                 FROM TSUOBTS C                   13797205
137973                                WHERE B.OTBND_TRIP_ID =           13797305
137974                                               C.OTBND_TRIP_ID)   13797405
137975                              ) AS T1                             13797505
137976                 )                                                13797605
137977            WITH UR                                               13797705
137978        END-EXEC                                                  13797805
137979                                                                  13797905
137980        EVALUATE TRUE                                             13798005
137981            WHEN SQLCODE = +0                                     13798105
137982                  MOVE SUOBTR-OTBND-TRIP-ID                       13798206
137983                    TO  ASC-NEW-TRIP-ID                           13798306
137984                  MOVE SUOBTS-TRIP-STAT-CDE                       13798406
137985                    TO  ASC-NEW-TRIP-STAT-CDE                     13798506
137986                  MOVE SUOBTS-OTBND-STAT-TMST                     13798606
137987                    TO  ASC-NEW-OTBND-STAT-TMST                   13798706
137988                  MOVE SUOBSC-TRIP-STAT-DESC                      13798806
137989                    TO  ASC-NEW-TRIP-STAT-DESC                    13798906
137990                                                                  13799005
137991              PERFORM 3040-VALIDATE-NEW-STATUS                    13799106
137992                                                                  13799206
137993            WHEN SQLCODE = +100                                   13799306
137994                 MOVE ZEROES  TO  ASC-NEW-TRIP-ID                 13799406
137995                 MOVE SPACES  TO  ASC-NEW-TRIP-STAT-CDE           13799506
137996                                  ASC-NEW-OTBND-STAT-TMST         13799606
137997                                  ASC-NEW-TRIP-STAT-DESC          13799706
137998                                                                  13799805
137999            WHEN SQLWARN0 NOT = SPACES                            13799905
138000            WHEN SQLCODE < +0                                     13800005
138001            WHEN SQLCODE > +0                                     13800105
138002                                                                  13800221
138003                MOVE ASC-OPER-UNT-ID      TO PV-DISP-OPER         13800321
138004                MOVE ASC-DEST-NBR         TO PV-DISP-DEST         13800421
138005                MOVE ASC-SCAC-CDE         TO PV-DISP-SCAC         13800521
138006                MOVE ASC-TRLR-ID          TO PV-DISP-TRLR         13800621
138007                MOVE ASC-TRLR-SRL-NBR     TO PV-DISP-SRL          13800721
138008                MOVE ASC-NEW-SCAC-CDE     TO PV-DISP-NEW-SCAC     13800821
138009                MOVE ASC-NEW-TRLR-ID      TO PV-DISP-NEW-TRLR     13800921
138010                MOVE ASC-NEW-TRLR-SRL-NBR TO PV-DISP-SRL          13801024
138011                STRING  PV-DISP-OPER '-'                          13801121
138012                        PV-DISP-DEST ' - FROM '                   13801221
138013                        PV-DISP-SCAC '-'                          13801321
138014                        PV-DISP-TRLR '-'                          13801421
138015                        PV-DISP-SRL    DELIMITED BY SIZE          13801521
138016                                  INTO DP013-MESSAGE-TEXT (1)     13801621
138017                STRING                                            13801721
138018                        ' TO '                                    13801821
138019                        PV-DISP-NEW-SCAC                          13801921
138020                        PV-DISP-NEW-TRLR                          13802021
138021                        PV-DISP-SRL    DELIMITED BY SIZE          13802121
138022                                  INTO DP013-MESSAGE-TEXT (2)     13802221
138023                                                                  13802321
138024                MOVE '3035-GET-NEW-TRIP-STATUS'                   13802406
138025                                          TO DP013-PARAGRAPH      13802505
138026                MOVE 'GET TRIP CURRENT STATUS        '            13802605
138027                                    TO DP013-MESSAGE-TEXT (3)     13802721
138028                MOVE SQLCA      TO DP013-SQLCA                    13802805
138029                MOVE 'TSUOBTR'  TO DP013-DB2-TABLE-NAME (1)       13802906
138030                MOVE 'TSUOBTS'  TO DP013-DB2-TABLE-NAME (2)       13803006
138031                MOVE 'TSUOBSC'  TO DP013-DB2-TABLE-NAME (3)       13803106
138032                SET DP013-DB2-ABEND                               13803206
138033                    DP013-XCTL-DISPLAY-RESTART TO TRUE            13803306
138034                PERFORM DP013-0000-PROCESS-ABEND                  13803406
138035        END-EVALUATE.                                             13803506
138036                                                                  13803606
138037                                                                  13803706
138038******************************************************************13803806
138039** VERIFY THAT THE TRIP THAT IS CURRENTLY FOR THE NEW TRAILER   **13803906
138040*  SERIAL IS VALID FOR REUSE                                    **13804006
138041*   SU - STORE UNLOADED                                         **13804106
138042*   AR - AUDIT RELEASED                                         **13804206
138043*   DR - DC RELEASED                                            **13804306
138044******************************************************************13804406
138045 3040-VALIDATE-NEW-STATUS.                                        13804515
138046                                                                  13804606
138047     IF  ASC-NEW-STAT-UPD-ALLOW                                   13804706
138048         CONTINUE                                                 13804806
138049     ELSE                                                         13804906
138050         SET PS-ERROR                                             13805006
138051             DP020-MSG-FATAL         TO TRUE                      13805106
138052         MOVE PC-TSYMSG-03772        TO DP020-MSG-NUMBER          13805215
138053         MOVE -1                     TO ANEWSRLL                  13805335
138054         MOVE DP015-UNP-ALP-BRT-MDT  TO ANEWSRLA                  13805435
138055                                        ANWSTATA                  13805542
138056                                        ANWDESCA                  13805642
138057         MOVE DP015-RED              TO ANEWSRLC                  13805742
138058                                        ANWSTATC                  13805842
138059                                        ANWDESCC                  13805942
138060         MOVE DP015-REVERSE          TO ANEWSRLH                  13806042
138061                                        ANWSTATH                  13806142
138062                                        ANWDESCH                  13806242
138063         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      13806342
138064     END-IF.                                                      13806442
138070                                                                  13807006
138080     IF  ASC-NEW-STAT-UPD-ALLOW                                   13808047
138090         IF  ASC-OTBND-STAT-TMST <  ASC-NEW-OTBND-STAT-TMST       13809049
138092             SET PS-ERROR                                         13809249
138093                 DP020-MSG-FATAL     TO TRUE                      13809349
138094             MOVE PC-TSYMSG-03812    TO DP020-MSG-NUMBER          13809449
138095             MOVE DP015-PRO-NOR-MDT  TO                           13809550
138097                                        AORIGDTA                  13809747
138098                                        AORIGTMA                  13809847
138099             MOVE DP015-RED          TO                           13809950
138101                                        AORIGDTC                  13810147
138102                                        AORIGTMC                  13810247
138103             MOVE DP015-REVERSE      TO                           13810350
138105                                        AORIGDTH                  13810547
138106                                        AORIGTMH                  13810647
138110             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  13811049
138120         END-IF                                                   13812049
138121     END-IF.                                                      13812149
138130                                                                  13813047
138200                                                                  13820006
160470*----------------------------------------------------------------*16047001
160480* MOVE THE DEFAULT ATTRIBUTE VALUES TO THE ENTERABLE FIELDS ON   *16048001
160490* MAP.                                                           *16049001
160500*----------------------------------------------------------------*16050001
160600 3200-RESET-ATTRIBUTES.                                           16060008
160610                                                                  16061008
160700     IF  PS-NO-ERROR                                              16070008
160800         MOVE -1                       TO ANEWSRLL                16080035
160900         MOVE DP015-UNP-ALP-BRT-MDT    TO ANEWSRLA                16090035
161200         MOVE DP015-GREEN              TO ANEWSRLC                16120008
161400         MOVE DP015-UNDERLINE          TO ANEWSRLH                16140008
161700         MOVE DP015-PRO-NOR-MDT        TO AOPRUNTA                16170031
161800                                          AOPRNMEA                16180008
161810                                          ATRIPIDA                16181008
161820                                          ADESTA                  16182008
161830                                          ANAMEA                  16183008
161840                                          ATRSTATA                16184008
161850                                          ASTDESCA                16185008
161851                                          AORIGDTA                16185145
161852                                          AORIGTMA                16185245
161860                                          ASRLNBRA                16186008
161870                                          ASCACA                  16187008
161880                                          ATRLRA                  16188008
161890                                          ANWSCACA                16189008
161891                                          ANWTRLRA                16189108
161892                                          ANWTRIPA                16189233
161893                                          ANWSTATA                16189333
161894                                          ANWDESCA                16189433
161895                                          ANEWDTA                 16189546
161896                                          ANEWTMA                 16189646
161900         MOVE DP015-BLUE               TO AOPRUNTC                16190008
161910                                          AOPRNMEC                16191008
161920                                          ATRIPIDC                16192008
161930                                          ADESTC                  16193008
161940                                          ANAMEC                  16194008
161950                                          ATRSTATC                16195008
161960                                          ASTDESCC                16196008
161961                                          AORIGDTC                16196145
161962                                          AORIGTMC                16196245
161970                                          ASRLNBRC                16197008
161980                                          ASCACC                  16198008
161990                                          ATRLRC                  16199008
161991                                          ANWSCACC                16199108
161992                                          ANWTRLRC                16199208
161993                                          ANWTRIPC                16199333
161994                                          ANWSTATC                16199433
161995                                          ANWDESCC                16199533
161996                                          ANEWDTC                 16199646
161997                                          ANEWTMC                 16199746
162100         MOVE DP015-HL-OFF             TO AOPRUNTH                16210008
162110                                          AOPRNMEH                16211008
162120                                          ATRIPIDH                16212008
162130                                          ADESTH                  16213008
162140                                          ANAMEH                  16214008
162150                                          ATRSTATH                16215008
162160                                          ASTDESCH                16216008
162161                                          AORIGDTH                16216145
162162                                          AORIGTMH                16216245
162170                                          ASRLNBRH                16217008
162180                                          ASCACH                  16218008
162190                                          ATRLRH                  16219008
162191                                          ANWSCACH                16219108
162192                                          ANWTRLRH                16219208
162193                                          ANWTRIPH                16219333
162194                                          ANWSTATH                16219433
162195                                          ANWDESCH                16219533
162196                                          ANEWDTH                 16219646
162197                                          ANEWTMH                 16219746
162300     END-IF.                                                      16230008
165200                                                                  16520008
165210                                                                  16521008
165300*----------------------------------------------------------------*16530001
165400*    VALIDATE THE QUEUE WAS PASSED AND DISPLAY FOR THE FIRST     *16540001
165500*    ENTRY.                                                      *16550001
165600*----------------------------------------------------------------*16560001
165700 4000-BUILD-INITIAL-PANEL.                                        16570001
165710                                                                  16571001
165720     PERFORM 4005-GET-OPER-NAME.                                  16572004
165721     PERFORM 4010-GET-DEST-INFO.                                  16572104
165730                                                                  16573004
165900     MOVE ASC-OPER-UNT-ID       TO  AOPRUNTO.                     16590004
165910     MOVE ASC-OPER-NAME         TO  AOPRNMEO.                     16591004
165920     MOVE ASC-TRIP-ID           TO  ATRIPIDO.                     16592004
165930     MOVE ASC-DEST-NBR          TO  ADESTO.                       16593004
165940     MOVE ASC-DEST-NAME         TO  ANAMEO.                       16594004
165950     MOVE ASC-TRIP-STAT-CDE     TO  ATRSTATO.                     16595004
165960     MOVE ASC-TRIP-STAT-DESC    TO  ASTDESCO.                     16596004
165970     MOVE ASC-ORIG-STAT-DATE    TO  AORIGDTO.                     16597045
165980     MOVE ASC-ORIG-STAT-TIME    TO  AORIGTMO.                     16598045
166000     MOVE ASC-TRLR-SRL-NBR      TO  ASRLNBRO.                     16600004
166100     MOVE ASC-SCAC-CDE          TO  ASCACO.                       16610004
166200     MOVE ASC-TRLR-ID           TO  ATRLRO.                       16620004
166210                                                                  16621004
166211     IF  ASC-NEW-TRLR-SRL-NBR  >  0                               16621104
166220         PERFORM 4015-GET-NEW-SCAC-TRLR                           16622004
166221     ELSE                                                         16622104
166222         MOVE ZEROES  TO  ASC-NEW-TRLR-SRL-NBR                    16622204
166223         MOVE SPACES  TO  ASC-NEW-SCAC-CDE                        16622304
166224                          ASC-NEW-TRLR-ID                         16622404
166225     END-IF.                                                      16622504
166230                                                                  16623004
166310     MOVE ASC-NEW-SCAC-CDE       TO  ANWSCACO.                    16631033
166320     MOVE ASC-NEW-TRLR-ID        TO  ANWTRLRO.                    16632033
166330     MOVE ASC-NEW-TRLR-SRL-NBR   TO  ANEWSRLO.                    16633033
166340     MOVE ASC-NEW-TRIP-ID        TO  ANWTRIPO.                    16634033
166350     MOVE ASC-NEW-TRIP-STAT-CDE  TO  ANWSTATO.                    16635033
166360     MOVE ASC-NEW-TRIP-STAT-DESC TO  ANWDESCO.                    16636033
166370     MOVE ASC-NEW-STAT-DATE      TO  ANEWDTO.                     16637045
166380     MOVE ASC-NEW-STAT-TIME      TO  ANEWTMO.                     16638045
166430                                                                  16643033
166500     SET DP030-SET-CURSOR-APPL-1   TO TRUE                        16650001
166600     MOVE -1                       TO ANEWSRLL.                   16660001
168401     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        16840116
168403                                                                  16840301
168404                                                                  16840416
168405*----------------------------------------------------------------*16840516
168406* GET THE SIGN ON LOCATION NAME                                   16840616
168407*----------------------------------------------------------------*16840716
168408 4005-GET-OPER-NAME.                                              16840816
168409     MOVE ASC-OPER-UNT-ID    TO DK-OPER-UNT-ID.                   16840916
168410                                                                  16841004
168411     EXEC SQL                                                     16841104
168412         SELECT  LOC_NM                                           16841204
168413           INTO :XLT00010-LOC-NM                                  16841304
168414           FROM  XLT_LOC                                          16841404
168415          WHERE  LOC_NBR  = :DK-OPER-UNT-ID                       16841504
168417     END-EXEC.                                                    16841704
168418                                                                  16841804
168419     EVALUATE TRUE                                                16841904
168420         WHEN SQLCODE = ZERO                                      16842004
168421              MOVE XLT00010-LOC-NM  TO  ASC-OPER-NAME             16842104
168426         WHEN SQLWARN0 NOT = SPACES                               16842604
168427         WHEN SQLCODE < +0                                        16842704
168428         WHEN SQLCODE > +0                                        16842804
168429              MOVE SPACES           TO  ASC-OPER-NAME             16842904
168430             MOVE '4005-GET-OPER-NAME        ' TO DP013-PARAGRAPH 16843004
168431             MOVE 'GET DC NAME                   '                16843104
168432                                      TO DP013-MESSAGE-TEXT (1)   16843204
168433             MOVE SQLCA        TO DP013-SQLCA                     16843304
168434             MOVE 'XLT_LOC '   TO DP013-DB2-TABLE-NAME (1)        16843404
168435             SET DP013-DB2-ABEND                                  16843504
168436                 DP013-XCTL-DISPLAY-RESTART TO TRUE               16843604
168437             PERFORM DP013-0000-PROCESS-ABEND                     16843704
168438         END-EVALUATE.                                            16843804
168439                                                                  16843904
168440                                                                  16844004
168441*----------------------------------------------------------------*16844104
168442* GET THE TRIP DESTINATION INFORMATION                            16844204
168443*----------------------------------------------------------------*16844304
168444 4010-GET-DEST-INFO.                                              16844404
168445                                                                  16844504
168446     MOVE ASC-TRIP-ID        TO SUOBTR-OTBND-TRIP-ID.             16844604
168447                                                                  16844704
168448     EXEC SQL                                                     16844804
168449         SELECT  A.DEST_OPER_UNT_ID                               16844904
168450              ,  B.OTBND_STAT_TMST                                16845004
168451              ,  B.TRIP_STAT_CDE                                  16845104
168452              ,  D.LOC_NM                                         16845204
168453              ,  E.SCAC_CDE                                       16845304
168454              ,  E.TRLR_ID                                        16845404
168455              ,  E.TRLR_SRL_NBR                                   16845504
168456              ,  F.TRIP_STAT_DESC                                 16845627
168458           INTO :SUOBTR-DEST-OPER-UNT-ID                          16845827
168459              , :SUOBTS-OTBND-STAT-TMST                           16845927
168460              , :SUOBTS-TRIP-STAT-CDE                             16846027
168461              , :XLT00010-LOC-NM                                  16846127
168462              , :CNTRID-SCAC-CDE                                  16846227
168463              , :CNTRID-TRLR-ID                                   16846327
168464              , :CNTRID-TRLR-SRL-NBR                              16846427
168465              , :SUOBSC-TRIP-STAT-DESC                            16846527
168467           FROM  TSUOBTR A                                        16846727
168468              ,  TSUOBTS B                                        16846827
168469              ,  XLT_LOC D                                        16846927
168470              ,  TCNTRID E                                        16847027
168471              ,  TSUOBSC F                                        16847127
168472          WHERE  A.OTBND_TRIP_ID    =  :SUOBTR-OTBND-TRIP-ID      16847227
168473            AND  A.OTBND_TRIP_ID    =  B.OTBND_TRIP_ID            16847327
168474            AND  A.DEST_OPER_UNT_ID =  D.LOC_NBR                  16847427
168475            AND  B.OTBND_STAT_TMST IN                             16847527
168476                 (SELECT MAX(C.OTBND_STAT_TMST)                   16847627
168477                    FROM TSUOBTS C                                16847727
168478                   WHERE B.OTBND_TRIP_ID  =  C.OTBND_TRIP_ID)     16847827
168479            AND A.TRLR_SRL_NBR     =  E.TRLR_SRL_NBR              16847927
168480            AND B.TRIP_STAT_CDE    =  F.TRIP_STAT_CDE             16848029
168481          WITH UR                                                 16848127
168482     END-EXEC.                                                    16848227
168483                                                                  16848327
168484     EVALUATE TRUE                                                16848427
168485         WHEN SQLCODE = ZERO                                      16848527
168486              MOVE SUOBTR-DEST-OPER-UNT-ID TO ASC-DEST-NBR        16848627
168487              MOVE SUOBTS-OTBND-STAT-TMST  TO ASC-OTBND-STAT-TMST 16848727
168488              MOVE SUOBTS-TRIP-STAT-CDE    TO ASC-TRIP-STAT-CDE   16848827
168489              MOVE XLT00010-LOC-NM         TO ASC-DEST-NAME       16848927
168490              MOVE CNTRID-TRLR-SRL-NBR     TO ASC-TRLR-SRL-NBR    16849027
168491              MOVE CNTRID-SCAC-CDE         TO ASC-SCAC-CDE        16849127
168492              MOVE CNTRID-TRLR-ID          TO ASC-TRLR-ID         16849227
168493              MOVE SUOBSC-TRIP-STAT-DESC   TO ASC-TRIP-STAT-DESC  16849328
168494                                                                  16849427
168495         WHEN SQLWARN0 NOT = SPACES                               16849527
168496         WHEN SQLCODE < +0                                        16849627
168497         WHEN SQLCODE > +0                                        16849727
168498                                                                  16849827
168499                MOVE ASC-OPER-UNT-ID      TO PV-DISP-OPER         16849927
168500                MOVE ASC-DEST-NBR         TO PV-DISP-DEST         16850027
168501                MOVE ASC-SCAC-CDE         TO PV-DISP-SCAC         16850127
168502                MOVE ASC-TRLR-ID          TO PV-DISP-TRLR         16850227
168503                MOVE ASC-TRLR-SRL-NBR     TO PV-DISP-SRL          16850327
168504                MOVE ASC-NEW-SCAC-CDE     TO PV-DISP-NEW-SCAC     16850427
168505                MOVE ASC-NEW-TRLR-ID      TO PV-DISP-NEW-TRLR     16850527
168506                MOVE ASC-NEW-TRLR-SRL-NBR TO PV-DISP-SRL          16850627
168507                STRING  PV-DISP-OPER '-'                          16850727
168508                        PV-DISP-DEST ' - FROM '                   16850827
168509                        PV-DISP-SCAC '-'                          16850927
168510                        PV-DISP-TRLR '-'                          16851027
168511                        PV-DISP-SRL    DELIMITED BY SIZE          16851127
168512                                  INTO DP013-MESSAGE-TEXT (1)     16851227
168513                STRING                                            16851327
168514                        ' TO '                                    16851427
168515                        PV-DISP-NEW-SCAC                          16851527
168516                        PV-DISP-NEW-TRLR                          16851627
168517                        PV-DISP-SRL    DELIMITED BY SIZE          16851727
168518                                  INTO DP013-MESSAGE-TEXT (2)     16851827
168519                                                                  16851927
168520              MOVE ZEROES  TO  ASC-DEST-NBR                       16852027
168521                               ASC-TRLR-SRL-NBR                   16852127
168522              MOVE SPACES  TO  ASC-TRIP-STAT-DESC                 16852227
168523                               ASC-TRIP-STAT-CDE                  16852327
168524                               ASC-DEST-NAME                      16852427
168525                               ASC-SCAC-CDE                       16852527
168526                               ASC-TRLR-ID                        16852627
168527                                                                  16852727
168528             MOVE '4010-GET-DEST-INFO        ' TO DP013-PARAGRAPH 16852827
168529             MOVE 'GET TRIP DESTINATION INFO     '                16852927
168530                                      TO DP013-MESSAGE-TEXT (3)   16853027
168531             MOVE SQLCA        TO DP013-SQLCA                     16853127
168532             MOVE 'TSUOBTR '   TO DP013-DB2-TABLE-NAME (1)        16853227
168533             MOVE 'TSUOBTS '   TO DP013-DB2-TABLE-NAME (2)        16853327
168534             MOVE 'XLT_LOC '   TO DP013-DB2-TABLE-NAME (3)        16853427
168535             MOVE 'TCNTRID '   TO DP013-DB2-TABLE-NAME (4)        16853527
168536             SET DP013-DB2-ABEND                                  16853627
168537                 DP013-XCTL-DISPLAY-RESTART TO TRUE               16853727
168538             PERFORM DP013-0000-PROCESS-ABEND                     16853827
168539         END-EVALUATE.                                            16853927
168540                                                                  16854027
168541                                                                  16854127
168542*----------------------------------------------------------------*16854227
168543* GET THE NEW SCAC/TRAILER INFO                                   16854327
168550*----------------------------------------------------------------*16855004
168560 4015-GET-NEW-SCAC-TRLR.                                          16856004
168570                                                                  16857004
168580     MOVE ASC-NEW-TRLR-SRL-NBR TO  CNTRID-TRLR-SRL-NBR.           16858004
168590                                                                  16859004
168600     EXEC SQL                                                     16860004
168650         SELECT  SCAC_CDE                                         16865004
168651              ,  TRLR_ID                                          16865104
168652              ,  TRLR_SRL_NBR                                     16865204
168657           INTO :CNTRID-SCAC-CDE                                  16865704
168658              , :CNTRID-TRLR-ID                                   16865804
168659              , :CNTRID-TRLR-SRL-NBR                              16865904
168663           FROM  TCNTRID                                          16866304
168664          WHERE  TRLR_SRL_NBR  =  :CNTRID-TRLR-SRL-NBR            16866411
168671          WITH UR                                                 16867104
168672     END-EXEC.                                                    16867204
168673                                                                  16867304
168674     EVALUATE TRUE                                                16867404
168675         WHEN SQLCODE = ZERO                                      16867504
168676              MOVE CNTRID-SCAC-CDE      TO ASC-NEW-SCAC-CDE       16867604
168677              MOVE CNTRID-TRLR-ID       TO ASC-NEW-TRLR-ID        16867704
168678              MOVE CNTRID-TRLR-SRL-NBR  TO ASC-NEW-TRLR-SRL-NBR   16867804
168683                                                                  16868304
168684         WHEN SQLCODE = +100                                      16868416
168685              MOVE ZEROES  TO  ASC-NEW-TRLR-SRL-NBR               16868504
168686              MOVE SPACES  TO  ASC-NEW-SCAC-CDE                   16868604
168687                               ASC-NEW-TRLR-ID                    16868704
168688                                                                  16868804
168689         WHEN SQLWARN0 NOT = SPACES                               16868904
168690         WHEN SQLCODE < +0                                        16869004
168691         WHEN SQLCODE > +0                                        16869104
168692                                                                  16869221
168693                MOVE ASC-OPER-UNT-ID      TO PV-DISP-OPER         16869321
168694                MOVE ASC-DEST-NBR         TO PV-DISP-DEST         16869421
168695                MOVE ASC-SCAC-CDE         TO PV-DISP-SCAC         16869521
168696                MOVE ASC-TRLR-ID          TO PV-DISP-TRLR         16869621
168697                MOVE ASC-TRLR-SRL-NBR     TO PV-DISP-SRL          16869721
168698                MOVE ASC-NEW-SCAC-CDE     TO PV-DISP-NEW-SCAC     16869821
168699                MOVE ASC-NEW-TRLR-ID      TO PV-DISP-NEW-TRLR     16869921
168700                MOVE ASC-NEW-TRLR-SRL-NBR TO PV-DISP-SRL          16870024
168701                STRING  PV-DISP-OPER '-'                          16870121
168702                        PV-DISP-DEST ' - FROM '                   16870221
168703                        PV-DISP-SCAC '-'                          16870321
168704                        PV-DISP-TRLR '-'                          16870421
168705                        PV-DISP-SRL    DELIMITED BY SIZE          16870521
168706                                  INTO DP013-MESSAGE-TEXT (1)     16870621
168707                STRING                                            16870721
168708                        ' TO '                                    16870821
168709                        PV-DISP-NEW-SCAC                          16870921
168710                        PV-DISP-NEW-TRLR                          16871021
168711                        PV-DISP-SRL    DELIMITED BY SIZE          16871121
168712                                  INTO DP013-MESSAGE-TEXT (2)     16871221
168713                                                                  16871321
168714              MOVE ZEROES  TO  ASC-NEW-TRLR-SRL-NBR               16871404
168715              MOVE SPACES  TO  ASC-NEW-SCAC-CDE                   16871504
168716                               ASC-NEW-TRLR-ID                    16871604
168717                                                                  16871704
168718             MOVE '4015-GET-NEW-SCAC-TRLR    ' TO DP013-PARAGRAPH 16871804
168719             MOVE 'GET NEW SRL INFO              '                16871904
168720                                      TO DP013-MESSAGE-TEXT (3)   16872021
168721             MOVE SQLCA        TO DP013-SQLCA                     16872104
168722             MOVE 'TCNTRID '   TO DP013-DB2-TABLE-NAME (1)        16872204
168723             SET DP013-DB2-ABEND                                  16872304
168724                 DP013-XCTL-DISPLAY-RESTART TO TRUE               16872404
168725             PERFORM DP013-0000-PROCESS-ABEND                     16872504
168726         END-EVALUATE.                                            16872604
168727                                                                  16872704
168730                                                                  16873004
181101*----------------------------------------------------------------*18110101
181102* GET TRAILER INFORMATION                                         18110201
181103*----------------------------------------------------------------*18110301
181110 4100-GET-TRAILER-INFO.                                           18111001
181111                                                                  18111101
181120      PERFORM 4110-GET-SCAC-TRLR-INFO.                            18112001
181130      PERFORM 4120-GET-TRIP-STATUS.                               18113001
181131                                                                  18113102
181140                                                                  18114001
181200*----------------------------------------------------------------*18120001
181300* GET SCAC/TRAILER INFORMATION FOR TRIP                           18130002
181400*----------------------------------------------------------------*18140001
181500 4110-GET-SCAC-TRLR-INFO.                                         18150002
181600                                                                  18160002
182000     EXEC SQL                                                     18200002
182100         SELECT B.SCAC_CDE                                        18210002
182110              , B.TRLR_ID                                         18211002
182200           INTO :ASC-SCAC-CDE                                     18220002
182210              , :ASC-TRLR-ID                                      18221002
182300           FROM TSUOBTR A                                         18230002
182310              , TCNTRID B                                         18231002
182400          WHERE A.OTBND_TRIP_ID  =  :DK-TRIP-ID                   18240012
182500            AND A.TRLR_SRL_NBR   =  B.TRLR_SRL_NBR                18250002
182700     END-EXEC                                                     18270002
182800                                                                  18280002
182900     EVALUATE TRUE                                                18290002
183000         WHEN SQLCODE = ZERO                                      18300002
183100              CONTINUE                                            18310002
183600         WHEN SQLWARN0 NOT = SPACES                               18360002
183700         WHEN SQLCODE < +0                                        18370002
183800         WHEN SQLCODE > +0                                        18380002
183810                                                                  18381021
183820                MOVE ASC-OPER-UNT-ID      TO PV-DISP-OPER         18382021
183830                MOVE ASC-DEST-NBR         TO PV-DISP-DEST         18383021
183840                MOVE ASC-SCAC-CDE         TO PV-DISP-SCAC         18384021
183850                MOVE ASC-TRLR-ID          TO PV-DISP-TRLR         18385021
183860                MOVE ASC-TRLR-SRL-NBR     TO PV-DISP-SRL          18386021
183870                MOVE ASC-NEW-SCAC-CDE     TO PV-DISP-NEW-SCAC     18387021
183880                MOVE ASC-NEW-TRLR-ID      TO PV-DISP-NEW-TRLR     18388021
183890                MOVE ASC-NEW-TRLR-SRL-NBR TO PV-DISP-SRL          18389024
183891                STRING  PV-DISP-OPER '-'                          18389121
183892                        PV-DISP-DEST ' - FROM '                   18389221
183893                        PV-DISP-SCAC '-'                          18389321
183894                        PV-DISP-TRLR '-'                          18389421
183895                        PV-DISP-SRL    DELIMITED BY SIZE          18389521
183896                                  INTO DP013-MESSAGE-TEXT (1)     18389621
183897                STRING                                            18389721
183898                        ' TO '                                    18389821
183899                        PV-DISP-NEW-SCAC                          18389921
183900                        PV-DISP-NEW-TRLR                          18390021
183901                        PV-DISP-SRL    DELIMITED BY SIZE          18390121
183902                                  INTO DP013-MESSAGE-TEXT (2)     18390221
183903                                                                  18390321
183910             MOVE '4110-GET-SCAC-TRLR-INFO' TO DP013-PARAGRAPH    18391010
184000             MOVE 'GET EXISTING TRIP SCAC/TRLR INFO'              18400002
184100                                      TO DP013-MESSAGE-TEXT (3)   18410021
184200             MOVE SQLCA        TO DP013-SQLCA                     18420002
184300             MOVE 'TSUOBTR '   TO DP013-DB2-TABLE-NAME (1)        18430002
184310             MOVE 'TCNTRID '   TO DP013-DB2-TABLE-NAME (2)        18431002
184400             SET DP013-DB2-ABEND                                  18440002
184500                 DP013-XCTL-DISPLAY-RESTART TO TRUE               18450002
184600             PERFORM DP013-0000-PROCESS-ABEND                     18460002
184700         END-EVALUATE.                                            18470002
184800                                                                  18480002
184900*----------------------------------------------------------------*18490001
185000* GET THE CURRENT STATUS OF THE TRIP BEING CHANGED               *18500002
185100*----------------------------------------------------------------*18510001
185200 4120-GET-TRIP-STATUS.                                            18520002
185210                                                                  18521002
185220     EXEC SQL                                                     18522002
185230         SELECT B.TRIP_STAT_CDE                                   18523002
185240              , B.OTBND_STAT_TMST                                 18524002
185250           INTO :ASC-TRIP-STAT-CDE                                18525002
185260              , :ASC-OTBND-STAT-TMST                              18526002
185270           FROM TSUOBTR A                                         18527002
185280              , TSUOBTS B                                         18528002
185290          WHERE A.OTBND_TRIP_ID  =  :DK-TRIP-ID                   18529012
185291            AND A.OTBND_TRIP_ID  =  B.OTBND_TRIP_ID               18529102
185292            AND B.OTBND_STAT_TMST IN                              18529202
185293                (SELECT MAX(C.OTBND_STAT_TMST)                    18529302
185294                   FROM TSUOBTS C                                 18529402
185295                  WHERE B.OTBND_TRIP_ID = C.OTBND_TRIP_ID)        18529502
185296     END-EXEC                                                     18529602
185297                                                                  18529702
185298     EVALUATE TRUE                                                18529802
185299         WHEN SQLCODE = ZERO                                      18529902
185301              CONTINUE                                            18530102
185302         WHEN SQLWARN0 NOT = SPACES                               18530202
185303         WHEN SQLCODE < +0                                        18530302
185304         WHEN SQLCODE > +0                                        18530402
185305                                                                  18530521
185306                MOVE ASC-OPER-UNT-ID      TO PV-DISP-OPER         18530621
185307                MOVE ASC-DEST-NBR         TO PV-DISP-DEST         18530721
185308                MOVE ASC-SCAC-CDE         TO PV-DISP-SCAC         18530821
185309                MOVE ASC-TRLR-ID          TO PV-DISP-TRLR         18530921
185310                MOVE ASC-TRLR-SRL-NBR     TO PV-DISP-SRL          18531021
185311                MOVE ASC-NEW-SCAC-CDE     TO PV-DISP-NEW-SCAC     18531121
185312                MOVE ASC-NEW-TRLR-ID      TO PV-DISP-NEW-TRLR     18531221
185313                MOVE ASC-NEW-TRLR-SRL-NBR TO PV-DISP-SRL          18531324
185314                STRING  PV-DISP-OPER '-'                          18531421
185315                        PV-DISP-DEST ' - FROM '                   18531521
185316                        PV-DISP-SCAC '-'                          18531621
185317                        PV-DISP-TRLR '-'                          18531721
185318                        PV-DISP-SRL    DELIMITED BY SIZE          18531821
185319                                  INTO DP013-MESSAGE-TEXT (1)     18531921
185320                STRING                                            18532021
185321                        ' TO '                                    18532121
185322                        PV-DISP-NEW-SCAC                          18532221
185323                        PV-DISP-NEW-TRLR                          18532321
185324                        PV-DISP-SRL    DELIMITED BY SIZE          18532421
185325                                  INTO DP013-MESSAGE-TEXT (2)     18532521
185326                                                                  18532621
185327             MOVE '4120-GET-TRIP-STATUS'      TO DP013-PARAGRAPH  18532702
185328             MOVE 'GET EXISTING TRIP CURRENT STATUS'              18532802
185329                                      TO DP013-MESSAGE-TEXT (3)   18532921
185330             MOVE SQLCA        TO DP013-SQLCA                     18533002
185331             MOVE 'TSUOBTR '   TO DP013-DB2-TABLE-NAME (1)        18533102
185332             MOVE 'TSUOBTS '   TO DP013-DB2-TABLE-NAME (2)        18533202
185333             MOVE 'TSUOBTS '   TO DP013-DB2-TABLE-NAME (3)        18533302
185334             SET DP013-DB2-ABEND                                  18533402
185335                 DP013-XCTL-DISPLAY-RESTART TO TRUE               18533502
185336             PERFORM DP013-0000-PROCESS-ABEND                     18533602
185337         END-EVALUATE.                                            18533702
185340                                                                  18534002
185600                                                                  18560002
213500*----------------------------------------------------------------*21350001
213600*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *21360001
213700*----------------------------------------------------------------*21370001
213800 4400-MOVE-COMMAREA-TO-SCREEN.                                    21380002
213810                                                                  21381002
213820     MOVE ASC-OPER-UNT-ID        TO  AOPRUNTO.                    21382033
213830     MOVE ASC-OPER-NAME          TO  AOPRNMEO.                    21383033
213840     MOVE ASC-TRIP-ID            TO  ATRIPIDO.                    21384033
213850     MOVE ASC-DEST-NBR           TO  ADESTO.                      21385033
213860     MOVE ASC-DEST-NAME          TO  ANAMEO.                      21386033
213870     MOVE ASC-TRIP-STAT-CDE      TO  ATRSTATO.                    21387033
213880     MOVE ASC-TRIP-STAT-DESC     TO  ASTDESCO.                    21388033
213890     MOVE ASC-TRLR-SRL-NBR       TO  ASRLNBRO.                    21389033
213891     MOVE ASC-SCAC-CDE           TO  ASCACO.                      21389133
213892     MOVE ASC-TRLR-ID            TO  ATRLRO.                      21389233
213902     MOVE ASC-NEW-SCAC-CDE       TO  ANWSCACO.                    21390233
213903     MOVE ASC-NEW-TRLR-ID        TO  ANWTRLRO.                    21390333
213904     MOVE ASC-NEW-TRLR-SRL-NBR   TO  ANEWSRLO.                    21390433
213905     MOVE ASC-NEW-TRIP-ID        TO  ANWTRIPO.                    21390533
213906     MOVE ASC-NEW-TRIP-STAT-CDE  TO  ANWSTATO.                    21390633
213907     MOVE ASC-NEW-TRIP-STAT-DESC TO  ANWDESCO.                    21390733
213908     MOVE ASC-NEW-STAT-DATE      TO  ANEWDTO.                     21390848
213909     MOVE ASC-NEW-STAT-TIME      TO  ANEWTMO.                     21390948
215000                                                                  21500004
215010                                                                  21501004
215020*----------------------------------------------------------------*21502041
221300* UPDATE OUTBOUND TRIP TO NEW TRAILER SERIAL #                   *22130008
221400*----------------------------------------------------------------*22140001
221500 5100-PROCESS-UPDATE.                                             22150008
221510                                                                  22151008
221520     MOVE ASC-TRLR-SRL-NBR      TO  DK-TRLR-SRL-NBR.              22152008
221550     MOVE ASC-TRIP-ID           TO  DK-TRIP-ID.                   22155008
221594     MOVE ASC-NEW-TRLR-SRL-NBR  TO  DK-NEW-TRLR-SRL-NBR.          22159408
221595                                                                  22159508
221630     PERFORM                                                      22163008
221640         WITH TEST AFTER                                          22164008
221650         VARYING PV-RETRY-COUNTER                                 22165008
221660         FROM 1 BY 1                                              22166008
221670         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               22167008
221680         OR     (SQLCODE = ZERO)                                  22168008
221690         OR     (SQLCODE = +100))                                 22169008
221691                                                                  22169108
221692         EXEC SQL                                                 22169208
221693             UPDATE TSUOBTR                                       22169308
221694               SET                                                22169408
221695                  TRLR_SRL_NBR       = :DK-NEW-TRLR-SRL-NBR       22169508
221700            WHERE TRLR_SRL_NBR       = :DK-TRLR-SRL-NBR           22170008
221701              AND OTBND_TRIP_ID      = :DK-TRIP-ID                22170108
221702         END-EXEC                                                 22170208
221703                                                                  22170308
221704         EVALUATE TRUE                                            22170408
221705             WHEN SQLCODE = +0                                    22170508
221706                  MOVE 'SUKCS766' TO SUT00006-CRE-BY-PGM-NM       22170643
221707                  PERFORM 7400-INSERT-WRKR-AUD                    22170743
221708                  MOVE SPACES  TO  ASC-NEW-SCAC-CDE               22170838
221709                                   ASC-NEW-TRLR-ID                22170938
221710                                   ASC-NEW-TRIP-STAT-DESC         22171038
221711                                   ASC-NEW-TRIP-STAT-CDE          22171138
221712                  MOVE ZEROES  TO  ASC-NEW-TRIP-ID                22171238
221713                                   ASC-NEW-TRLR-SRL-NBR           22171339
221714                  PERFORM 3005-GET-ORIGINAL-TRIP-SRL              22171438
221715                  PERFORM 3010-GET-ORIGINAL-SCAC-TRLR             22171538
221716             WHEN SQLWARN0 NOT = SPACES                           22171638
221717             WHEN SQLCODE < +0                                    22171738
221718             WHEN SQLCODE > +0                                    22171838
221719                                                                  22171938
221720                MOVE ASC-OPER-UNT-ID      TO PV-DISP-OPER         22172038
221721                MOVE ASC-DEST-NBR         TO PV-DISP-DEST         22172138
221722                MOVE ASC-SCAC-CDE         TO PV-DISP-SCAC         22172238
221723                MOVE ASC-TRLR-ID          TO PV-DISP-TRLR         22172338
221724                MOVE ASC-TRLR-SRL-NBR     TO PV-DISP-SRL          22172438
221725                MOVE ASC-NEW-SCAC-CDE     TO PV-DISP-NEW-SCAC     22172538
221726                MOVE ASC-NEW-TRLR-ID      TO PV-DISP-NEW-TRLR     22172638
221727                MOVE ASC-NEW-TRLR-SRL-NBR TO PV-DISP-SRL          22172738
221728                STRING  PV-DISP-OPER '-'                          22172838
221729                        PV-DISP-DEST ' - FROM '                   22172938
221730                        PV-DISP-SCAC '-'                          22173038
221731                        PV-DISP-TRLR '-'                          22173138
221732                        PV-DISP-SRL    DELIMITED BY SIZE          22173238
221733                                  INTO DP013-MESSAGE-TEXT (1)     22173338
221734                STRING                                            22173438
221735                        ' TO '                                    22173538
221736                        PV-DISP-NEW-SCAC                          22173638
221737                        PV-DISP-NEW-TRLR                          22173738
221738                        PV-DISP-SRL    DELIMITED BY SIZE          22173838
221739                                  INTO DP013-MESSAGE-TEXT (2)     22173938
221740                                                                  22174038
221741                 MOVE '5100-PROCESS-UPDATE' TO DP013-PARAGRAPH    22174138
221742                 MOVE 'UPDATE TSUOBTR WITH NEW TRLR SRL'          22174238
221743                                   TO DP013-MESSAGE-TEXT (3)      22174338
221744                 MOVE SQLCA        TO DP013-SQLCA                 22174438
221745                 MOVE 'TSUOBTR'    TO DP013-DB2-TABLE-NAME (1)    22174538
221746                 SET DP013-DB2-ABEND                              22174638
221747                     DP013-XCTL-DISPLAY-RESTART TO TRUE           22174738
221748                 PERFORM DP013-0000-PROCESS-ABEND                 22174838
221749         END-EVALUATE                                             22174938
221750     END-PERFORM.                                                 22175038
221751                                                                  22175138
221752     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         22175238
221753                                                                  22175338
221754                MOVE ASC-OPER-UNT-ID      TO PV-DISP-OPER         22175438
221755                MOVE ASC-DEST-NBR         TO PV-DISP-DEST         22175538
221756                MOVE ASC-SCAC-CDE         TO PV-DISP-SCAC         22175638
221757                MOVE ASC-TRLR-ID          TO PV-DISP-TRLR         22175738
221758                MOVE ASC-TRLR-SRL-NBR     TO PV-DISP-SRL          22175838
221759                MOVE ASC-NEW-SCAC-CDE     TO PV-DISP-NEW-SCAC     22175938
221760                MOVE ASC-NEW-TRLR-ID      TO PV-DISP-NEW-TRLR     22176038
221761                MOVE ASC-NEW-TRLR-SRL-NBR TO PV-DISP-SRL          22176138
221762                STRING  PV-DISP-OPER '-'                          22176238
221763                        PV-DISP-DEST ' - FROM '                   22176338
221764                        PV-DISP-SCAC '-'                          22176438
221765                        PV-DISP-TRLR '-'                          22176538
221766                        PV-DISP-SRL    DELIMITED BY SIZE          22176638
221767                                  INTO DP013-MESSAGE-TEXT (1)     22176738
221768                STRING                                            22176838
221769                        ' TO '                                    22176938
221770                        PV-DISP-NEW-SCAC                          22177038
221771                        PV-DISP-NEW-TRLR                          22177138
221772                        PV-DISP-SRL    DELIMITED BY SIZE          22177238
221773                                  INTO DP013-MESSAGE-TEXT (2)     22177338
221774                                                                  22177438
221775         MOVE '5100-PROCESS-UPDATE' TO DP013-PARAGRAPH            22177538
221776         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     22177638
221777                                       TO DP013-MESSAGE-TEXT (3)  22177738
221778         MOVE SQLCA          TO DP013-SQLCA                       22177838
221779         MOVE 'TSUOBTR'      TO DP013-DB2-TABLE-NAME (1)          22177938
221780         SET DP013-DB2-ABEND                                      22178038
221781             PS-ERROR                                             22178138
221782             DP013-XCTL-DISPLAY-RESTART TO TRUE                   22178238
221783         PERFORM DP013-0000-PROCESS-ABEND                         22178338
221784     END-IF.                                                      22178438
221785     MOVE +0 TO PV-RETRY-COUNTER.                                 22178538
221786                                                                  22178638
221790     IF  PS-NO-ERROR                                              22179008
221900         SET ASC-F2-CONFIRM-NO       TO TRUE                      22190008
222000         MOVE PC-TSYMSG-00059 TO DP020-MSG-NUMBER                 22200008
222100         SET DP020-MSG-INFORMATIONAL TO TRUE                      22210008
222110         MOVE DP015-UNP-NUM-NOR-MDT    TO ANEWSRLA                22211035
222120         MOVE DP015-GREEN              TO ANEWSRLC                22212008
222130         MOVE DP015-UNDERLINE          TO ANEWSRLH                22213008
222140         MOVE -1                       TO ANEWSRLL                22214035
223200        SET DP030-SET-CURSOR-APPL-1  TO TRUE                      22320008
223300     END-IF.                                                      22330008
223400                                                                  22340008
223410                                                                  22341043
223500*----------------------------------------------------------------*22350043
223600*    INSERT ROW INTO TRIP WORKER AUDIT TABLE TO TRACK WHO IS     *22360043
223610*    UPDATING TRAILER SERIAL NUMBERS ON OUTBOUND TRIPS            22361043
223700*----------------------------------------------------------------*22370043
238910 7400-INSERT-WRKR-AUD.                                            23891043
238920     EXEC SQL                                                     23892043
238930         INSERT INTO SUT_TRIP_WRKR_AUD                            23893043
238940             (                                                    23894043
238950               OTBND_TRIP_ID                                      23895043
238960             , USR_ID                                             23896043
238970             , CRE_TMST                                           23897043
238980             , CRE_BY_PGM_NM                                      23898043
238990                 )                                                23899043
238991                                                                  23899143
238992             VALUES                                               23899243
238993                                                                  23899343
238994                 (                                                23899443
238995                 :DK-TRIP-ID                                      23899543
238996             ,   :DP020-USERID                                    23899643
238997             ,   CURRENT TIMESTAMP                                23899743
238998             ,   :SUT00006-CRE-BY-PGM-NM                          23899843
238999                 )                                                23899943
239000     END-EXEC.                                                    23900043
239001                                                                  23900143
239002     EVALUATE TRUE                                                23900243
239003         WHEN SQLCODE = ZERO                                      23900343
239004         WHEN SQLCODE = +100                                      23900443
239005              CONTINUE                                            23900543
239006         WHEN SQLWARN0 NOT = SPACE                                23900643
239007         WHEN SQLCODE NOT = ZERO                                  23900743
239008                                                                  23900843
239009                MOVE ASC-OPER-UNT-ID      TO PV-DISP-OPER         23900943
239010              MOVE ASC-DEST-NBR         TO PV-DISP-DEST           23901044
239011              MOVE ASC-SCAC-CDE         TO PV-DISP-SCAC           23901144
239012              MOVE ASC-TRLR-ID          TO PV-DISP-TRLR           23901244
239013              MOVE ASC-TRLR-SRL-NBR     TO PV-DISP-SRL            23901344
239014              MOVE ASC-NEW-SCAC-CDE     TO PV-DISP-NEW-SCAC       23901444
239015              MOVE ASC-NEW-TRLR-ID      TO PV-DISP-NEW-TRLR       23901544
239016              MOVE ASC-NEW-TRLR-SRL-NBR TO PV-DISP-SRL            23901644
239017              STRING  PV-DISP-OPER '-'                            23901744
239018                      PV-DISP-DEST ' - FROM '                     23901844
239019                      PV-DISP-SCAC '-'                            23901944
239020                      PV-DISP-TRLR '-'                            23902044
239021                      PV-DISP-SRL    DELIMITED BY SIZE            23902144
239022                                INTO DP013-MESSAGE-TEXT (1)       23902244
239023              STRING                                              23902344
239024                      ' TO '                                      23902444
239025                      PV-DISP-NEW-SCAC '-'                        23902544
239026                      PV-DISP-NEW-TRLR '-'                        23902644
239027                      PV-DISP-SRL      '-'                        23902744
239028                      DP020-USERID   DELIMITED BY SIZE            23902844
239029                                INTO DP013-MESSAGE-TEXT (2)       23902944
239030                                                                  23903044
239031               MOVE '7400-INSERT-WRKR-AUD' TO DP013-PARAGRAPH     23903144
239032               MOVE 'TRACK WHO UPDATES TRAILER SRL'               23903244
239033                                 TO DP013-MESSAGE-TEXT (3)        23903344
239034               MOVE SQLCA        TO DP013-SQLCA                   23903444
239035               MOVE 'SUT00006'   TO DP013-DB2-TABLE-NAME (1)      23903544
239036               SET DP013-DB2-ABEND                                23903644
239037                   DP013-XCTL-DISPLAY-RESTART TO TRUE             23903744
239038               PERFORM DP013-0000-PROCESS-ABEND                   23903844
239049     END-EVALUATE.                                                23904943
239050                                                                  23905043
239051                                                                  23905143
239060*----------------------------------------------------------------*23906001
239100*    ABEND PROCESSOR MODULE                                      *23910021
239200*----------------------------------------------------------------*23920001
239300     COPY DPPD013.                                                23930043
