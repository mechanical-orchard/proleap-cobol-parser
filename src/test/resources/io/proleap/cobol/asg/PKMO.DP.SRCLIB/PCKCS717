000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    PCKCS717.                                         00040000
000500 AUTHOR.        THERESE RAMSEYER.                                 00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  JUNE 2000.                                        00070000
000800 DATE-COMPILED.                                                   00080000
000900                                                                  00090000
002200*----------------------------------------------------------------*00220000
002201*    E717 - PROC CNTL PRINT MISC LABEL                           *00220100
002203*----------------------------------------------------------------*00220300
002204*             T R O U B L E   S H O O T I N G                    *00220400
002205*----------------------------------------------------------------*00220500
002206* IF ANY ADJUSTMENTS ARE MADE TO THE PROGRAM, AND NO LABELS ARE  *00220600
002207* BEING PRINTED, EVEN THOUGH THE DATA WAS PASSED, AND THERE WAS  *00220700
002208* NO SOCKET ERROR, CHECK TO BE CERTAIN THAT A NUMBER GREATER     *00220800
002209* THAT 0 IS BEING PASSED IN THE TOT-LBLS FIELD. THERE ARE SOME   *00220900
002210* CALCS IN THE SOCKET PROGRAM THAT USE MULTIPLICATION TO         *00221000
002211* DETERMINE HOW MANY TIMES TO LOOP (SEND DATA), A 0 WILL MAKE    *00221100
002212* THE TOTAL-LABELS QTY 0, PROCESSING WON'T LOOP, NO LABELS PRINT.*00221200
002213* CHECK THE SWITCHES IN THE "SETS" LOGIC IN PARAGRAPH 2100- .    *00221300
002214* IF ONLY 1 SET IS BEING PRINTED WHEN MULTIPLE ARE REQUESTED OR  *00221400
002215* DATA IS BEING SENT (NOTICEABLE ON THE PTMS MONITOR), AND NO    *00221500
002216* LABELS ACTUALLY PRINT, CHANCES ARE THERE IS A PROBLEM IN       *00221600
002217* PARAGRAPH 2100- WHERE THE DEFAULT 1 IS BEING PUT INTO THE SETS *00221700
002218* FIELD WHEN IT SHOULDN'T.                                       *00221800
002219*----------------------------------------------------------------*00221900
002220*    E717 - PROC CNTL PRINT MISC LABEL                           *00222000
002222*----------------------------------------------------------------*00222200
002223* THE MISC LABEL PROGRAM WILL PASS DATA TO THE SOCKET PROGRAM     00222300
002224* PCKCS707. MULTIPLE SETS OF LABELS CAN BE PRINTED. THE LABEL     00222400
002225* CONSISTS OF FREE FORM TEXT FIELDS AND THREE LINES RESERVED      00222500
002226* FOR COMMENTS. EACH LINE WILL DISPLAY 30 ALPHANUMERIC CHARS.     00222600
002227* THE FREE FORM TEXT FIELDS CONSIST OF QUALIFIERS, RANGE VALUES   00222700
002228* IF DESIRED, AND SEPARATORS (WHICH WILL BE THE BREAK IN THE TEXT)00222800
002229* THE HUMAN READABLE (HR) PORTION OF THE LABEL CAN BE UP TO 20 CHA00222900
002230* IN LENGTH. THE BAR CODE PORTION CAN BE UP TO 12 CHARS IN LENGTH,00223000
002231* AND IT WILL NOT INCLUDE SEPARATORS. IF A RANGE IS REQUESTED, IT 00223100
002232* WILL USE 4 CHARS (PADDED WITH LEADING ZEROES). ONLY 1 VALID RANG00223200
002233* WILL BE ALLOWED. A QUALIFIER CAN BE LETTERS OR NUMBERS OR A     00223300
002234* COMBINATION OF BOTH. USE THE "@" CHAR AS A SEPARATOR IF YOU     00223400
002235* WANT A BLANK SPACE BETWEEN TEXT PORTIONS, OTHERWISE EVERYTHING  00223500
002236* ENETERED IS STRUNG TOGETHER TO BE PASSED TO THE SOCKET PROGRAM. 00223600
002237* THE SETS VALUE WILL DEFAULT TO 1 WHEN THE SCREEN IS REFRESHED.  00223700
002238* A SINGLE SET IS ASSUMED UNLESS IT IS CHANGED.                   00223800
002239* PF1=ADD WILL EXECUTE THE PRINT COMMAND.                         00223900
002240* A CONFIRMATION WILL BE REQUIRED IF MULTIPLE SETS ARE            00224000
002241* REQUESTED OR IF MORE THAN 99 LABELS ARE REQUESTED.              00224100
002242* AFTER A SUCCESSFUL PRINT, THE SCREEN WILL BE CLEARED, AND WILL  00224200
002243* BE READY FOR ANOTHER LABEL PRINT REQUEST.                       00224300
002244*--------------------------------------------------------------   00224400
002245* NOTE: NUMBERS APPEARING ON LABELS WILL HAVE LEADING ZEROES      00224500
002246*       BUT IT IS NOT NECESSARY THAT THEY ARE ENTERED THAT WAY.   00224600
002247*--------------------------------------------------------------   00224700
002248* DATE  11/04/2021                                                00224899
002249*            - CHANGE CALL OF 'DPKUT100' TO                     * 00224999
002250*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 00225099
002260*              MAKING THE CALL DYNAMIC VS STATIC                * 00226099
002270*     MADE BY: GERMAN BANDA            WR/IR #: CHG0264232        00227099
002280*-----------------------------------------------------------------00228099
1122RM* DATE  11/07/2022                                              * 00229099
1122RM*            - ADD COPYBOOK DPWS930                             * 00229199
1122RM*              CHANGE CALL TO DPWS030 FROM STATIC TO            * 00229299
1122RM*              DYNAMIC.                                         * 00229399
1122RM*     MADE BY: BOB MCASEY              WR/IR #: CHG0277910      * 00229499
1122RM*-----------------------------------------------------------------00229599
002300                                                                  00230000
002400 ENVIRONMENT DIVISION.                                            00240000
002500                                                                  00250000
002600 DATA DIVISION.                                                   00260000
002700                                                                  00270000
002800 WORKING-STORAGE SECTION.                                         00280000
002900                                                                  00290000
003000 01  PC-PROGRAM-CONSTANTS.                                        00300000
003100     05  PC-CURRENT-MAP-NAME      PIC  X(08)  VALUE  'PC717A  '.  00310000
003200     05  PC-CURRENT-MAPSET-NAME   PIC  X(08)  VALUE  'PCKM717 '.  00320000
003300     05  PC-CURRENT-PROGRAM-NAME  PIC  X(08)  VALUE  'PCKCS717'.  00330000
003400     05  PC-MAX-RETRIES           PIC S9(04)  VALUE  +3           00340000
003500                                              COMP.               00350000
003600     05  PC-ENROUTE               PIC  X(07)  VALUE  'ENROUTE'.   00360000
003700     05  PC-LABEL-FORMAT          PIC  9(03)  VALUE  2.           00370000
003800     05  PC-PROCESS-AREA          PIC  X(02)  VALUE  'P '.        00380000
003900     05  PC-ENTRY-FROM-PCAHDR     PIC  X(01)  VALUE  '1'.         00390000
004000     05  PC-STARTING-CNT          PIC  X(04)  VALUE  '1   '.      00400000
004100     05  PC-PRE-TICKETED          PIC  X(15)  VALUE               00410000
004200         'PRE TICKETED   '.                                       00420000
004300     05  PC-ON-HANGER             PIC  X(09)  VALUE               00430000
004400         'ON HANGER'.                                             00440000
004500     05  PC-MULTIPLE-SHIPMENTS    PIC  X(18)  VALUE               00450000
004600         'MULTIPLE SHIPMENTS'.                                    00460000
004700     05  PC-DETAIL-CHECK          PIC  X(12)  VALUE               00470000
004800         'DETAIL CHECK'.                                          00480000
004900     05  PC-Y                     PIC  X(01)  VALUE  'Y'.         00490000
005000     05  PC-N                     PIC  X(01)  VALUE  'N'.         00500000
005010     05  PC-EOD                   PIC  X(01)  VALUE ''.          00501099
005100     05  PC-A                     PIC  X(01)  VALUE  'A'.         00510000
005200     05  PC-F                     PIC  X(01)  VALUE  'F'.         00520000
005300     05  PC-S                     PIC  X(01)  VALUE  'S'.         00530000
005400     05  PC-90                    PIC  X(02)  VALUE '90'.         00540000
005500     05  PC-01                    PIC  X(02)  VALUE  '01'.        00550000
005600     05  PC-1                     PIC  9(04)  VALUE  0001.        00560000
005700     05  PC-99                    PIC  9(04)  VALUE  0099.        00570000
005800     05  PC-2                     PIC  9(01)  VALUE  2.           00580000
005900     05  PC-3                     PIC  9(01)  VALUE  3.           00590000
006000     05  PC-4                     PIC  9(01)  VALUE  4.           00600000
006100     05  PC-5                     PIC  9(01)  VALUE  5.           00610000
006200     05  PC-6                     PIC  9(01)  VALUE  6.           00620000
006300     05  PC-7                     PIC  9(01)  VALUE  7.           00630000
006400     05  PC-8                     PIC  9(01)  VALUE  8.           00640000
006500     05  PC-9                     PIC  9(01)  VALUE  9.           00650000
006600     05  PC-10                    PIC  9(02)  VALUE  10.          00660000
006700     05  PC-11                    PIC  9(02)  VALUE  11.          00670000
006800     05  PC-12                    PIC  9(02)  VALUE  12.          00680000
006900     05  PC-PRTR-VALIDATION-PGM   PIC  X(08)  VALUE  'DPKCS060'.  00690000
007000                                                                  00700000
007100     05  PC-TSYMSG-NUMBERS.                                       00710000
007200         10  PC-TSYMSG-00005      PIC  9(05)  VALUE  00005.       00720000
007300*            INVALID VALUE                                        00730000
007400         10  PC-TSYMSG-00007      PIC  9(05)  VALUE  00007.       00740000
007500*            REQUIRED ENTRY                                       00750000
007600         10  PC-TSYMSG-00008      PIC  9(05)  VALUE  00008.       00760000
007700*            MUST BE NUMERIC                                      00770000
007800         10  PC-TSYMSG-00009      PIC  9(05)  VALUE  00009.       00780000
007900*            INVALID DATE                                         00790000
008000         10  PC-TSYMSG-00052      PIC  9(05)  VALUE  00052.       00800000
008100*            END OF RANGE PRECEDES START OF RANGE                 00810000
008200         10  PC-TSYMSG-00053      PIC  9(05)  VALUE  00053.       00820000
008300*            NO START OF RANGE HAS BEEN SPECIFIED                 00830000
008400         10  PC-TSYMSG-00055      PIC  9(05)  VALUE  00055.       00840000
008500*            ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     00850000
008600         10  PC-TSYMSG-00083      PIC  9(05)  VALUE  00083.       00860000
008700*            PO NOT FOUND                                         00870000
008800         10  PC-TSYMSG-00098      PIC  9(05)  VALUE  00098.       00880000
008900*            PRINT SUCCESSFUL                                     00890000
009000         10  PC-TSYMSG-00342      PIC  9(05)  VALUE  00342.       00900000
009100*            MUST BE NUMERIC AND > ZERO                           00910000
009200         10  PC-TSYMSG-00746      PIC  9(05)  VALUE  00746.       00920000
009300*            INVALID PRINTER DESTINATION                          00930000
009400         10  PC-TSYMSG-02122      PIC  9(05)  VALUE  02122.       00940000
009500*            SOCKET ERROR                                         00950000
009600         10  PC-TSYMSG-02503      PIC  9(05)  VALUE  02503.       00960000
009700*            BARCODE GREATER THAN 12 CHARS (RANGE USES 4 CHARS)   00970000
009800         10  PC-TSYMSG-02504      PIC  9(05)  VALUE  02504.       00980000
009900*            CONFIRM > 1 SET  OF LABELS                           00990000
010000         10  PC-TSYMSG-02505      PIC  9(05)  VALUE  02505.       01000000
010100*            CONFIRM > 99 LABELS                                  01010000
010200         10  PC-TSYMSG-02506      PIC  9(05)  VALUE  02506.       01020000
010300*            RANGE NUMBER CANNOT BE > THAN 4 DIGITS IN LENGTH     01030000
010400     05  PC-OPER-UNT-ID               PIC S9(04) VALUE +0         01040000
010500                                                 COMP.            01050000
010600     05  PC-FCLTY-ID                  PIC S9(04) VALUE +0         01060000
010700                                                 COMP.            01070000
010800                                                                  01080000
010900 01  PM-PROGRAM-MESSAGES.                                         01090000
011000     05  PM-PROGRAM-MESSAGE-1.                                    01100000
011100         10  FILLER               PIC  X(54)  VALUE               01110000
011200         'ERROR TRYING TO SCHEDULE PSB - PCKCS113-RETURN CODE = '.01120000
011300         10  PM-IMS-CODE-1        PIC X(02)   VALUE SPACES.       01130000
011400         10  FILLER               PIC X(20)   VALUE SPACES.       01140000
011500     05  PM-PROGRAM-MESSAGE-2.                                    01150000
011600         10  FILLER               PIC  X(54)  VALUE               01160000
011700         'ERROR TRYING TO TERMINATE PSB- PCKCS113-RETURN CODE = '.01170000
011800         10  PM-IMS-CODE-2        PIC X(02)   VALUE SPACES.       01180000
011900         10  FILLER               PIC X(20)   VALUE SPACES.       01190000
012000     05  PM-PROGRAM-MESSAGE-3.                                    01200000
012100         10  FILLER               PIC  X(54)  VALUE               01210000
012200         'ERROR DURING GU OF CRC100DS - PCKCS113  RETURN CODE = '.01220000
012300         10  PM-IMS-CODE-3        PIC X(02)   VALUE SPACES.       01230000
012400         10  FILLER               PIC X(20)   VALUE SPACES.       01240000
012500     05  PM-PROGRAM-MESSAGE-4.                                    01250000
012600         10  FILLER               PIC  X(54)  VALUE               01260000
012700         'ERROR DURING GU OF CPO100DS - PCKCS113  RETURN CODE = '.01270000
012800         10  PM-IMS-CODE-4        PIC X(02)   VALUE SPACES.       01280000
012900         10  FILLER               PIC X(20)   VALUE SPACES.       01290000
013000     05  PM-PROGRAM-MESSAGE-5.                                    01300000
013100         10  FILLER               PIC  X(54)  VALUE               01310000
013200         'ERROR DURING GNP OF CRC320DS -PCKCS113- RETURN CODE = '.01320000
013300         10  PM-IMS-CODE-5        PIC X(02)   VALUE SPACES.       01330000
013400         10  FILLER               PIC X(20)   VALUE SPACES.       01340000
013500     05  PM-PROGRAM-MESSAGE-6.                                    01350000
013600         10  PM-RET-CDE           PIC  X(02)  VALUE SPACES.       01360000
013700         10  FILLER               PIC  X(01)  VALUE '-'.          01370000
013800         10  PM-RET-MSG           PIC  X(25)  VALUE SPACES.       01380000
013900         10  FILLER               PIC  X(48)  VALUE SPACES.       01390000
014000                                                                  01400000
014100 01  PS-PROGRAM-SWITCHES.                                         01410000
014200     05  PS-ERROR-SW              PIC  X(01)  VALUE  'N'.         01420000
014300         88  PS-ERROR                         VALUE  'Y'.         01430000
014400         88  PS-NO-ERROR                      VALUE  'N'.         01440000
014500     05  PS-PRINT-COMPLETE-SW     PIC  X(01)  VALUE  'N'.         01450000
014600         88  PS-PRINT-COMPLETE                VALUE  'Y'.         01460000
014700         88  PS-PRINT-COMPLETE-NO             VALUE  'N'.         01470000
014800     05  FACILITY-EDIT-SW         PIC  X(01)  VALUE  ' '.         01480000
014900         88  ERROR-ON-FACILITY-EDIT           VALUE  ' '.         01490000
015000         88  NO-ERROR-ON-FACILITY-EDIT        VALUE  'X'.         01500000
015100     05  OP-UNIT-EDIT-SW          PIC  X(01)  VALUE  ' '.         01510000
015200         88  ERROR-ON-OP-UNIT-EDIT            VALUE  ' '.         01520000
015300         88  NO-ERROR-ON-OP-UNIT-EDIT         VALUE  'X'.         01530000
015400     05  PRINTER-EDIT-SW          PIC  X(01)  VALUE  ' '.         01540000
015500         88  ERROR-ON-PRINTER-EDIT            VALUE  ' '.         01550000
015600         88  NO-ERROR-ON-PRINTER-EDIT         VALUE  'X'.         01560000
015601     05  BARCODE-EDIT-SW          PIC  X(01)  VALUE  ' '.         01560199
015602         88  ERROR-ON-BARCODE-SWITCH          VALUE  ' '.         01560299
015603         88  NO-ERROR-ON-BARCODE-SWITCH       VALUE  'X'.         01560399
015610     05  PS-BARCODE-REQUESTED-SW  PIC  X(01)  VALUE  'Y'.         01561099
015620         88  PS-BARCODE-REQUESTED             VALUE  'Y'.         01562099
015630         88  PS-NO-BARCODE-REQUESTED          VALUE  'N'.         01563099
015700                                                                  01570000
015800 01  PV-PROGRAM-VARIABLES.                                        01580000
015900     05  PV-CICS-RESPONSE         PIC S9(04)  VALUE +0            01590000
016000                                              COMP SYNC.          01600000
016100     05  PV-RETRY-COUNTER         PIC S9(04)  VALUE +0            01610000
016200                                              COMP SYNC.          01620000
016300     05  PV-OPER-UNT-ID           PIC S9(04)  VALUE +0            01630000
016400                                              COMP.               01640000
016500     05  PV-PRINTER-ID            PIC S9(03)  VALUE +0            01650000
016600                                              COMP.               01660000
016700     05  PV-FCLTY-ID              PIC S9(04)  VALUE +0            01670000
016800                                              COMP.               01680000
016900     05  PV-QUOTIENT              PIC 9(02)   VALUE ZERO          01690000
017000                                              COMP.               01700000
017100     05  PV-REMAIN                PIC 9(02)   VALUE ZERO          01710000
017200                                              COMP.               01720000
017300     05  PV-COMMAREA-LENGTH       PIC S9(04)  VALUE +0            01730000
017400                                              COMP.               01740000
017500     05  PV-NUMBER-OF-LABELS      PIC  9(04)  VALUE ZERO          01750000
017600                                              COMP.               01760000
017700     05  PV-TOTAL-LABELS          PIC  9(04)  VALUE ZERO          01770000
017800                                              COMP.               01780000
017900     05  PV-RANGE                 PIC  9(12)  VALUE ZERO.         01790000
018000                                                                  01800000
018100     05  PV-QUALIFIER             PIC  9(12)  VALUE ZERO.         01810000
018200                                                                  01820000
018300     05  PV-SETS                  PIC  9(04)  VALUE ZERO.         01830000
018400                                                                  01840000
018500     05  PV-4DIGIT-X              PIC  X(04)  VALUE SPACES.       01850000
018600                                                                  01860000
018700     05  PV-4DIGIT-N              PIC  9(04)  VALUE ZEROES.       01870000
018800                                                                  01880000
018900     05  PV-PRTR-DESC             PIC  X(25)  VALUE SPACE.        01890000
019000                                                                  01900000
019100     05  PV-OPER-UNT-NME          PIC  X(25)  VALUE SPACE.        01910000
019200                                                                  01920000
019300     05  PV-COUNT                 PIC S9(04)  VALUE +0.           01930000
019400                                                                  01940000
019500     05  PV-BEGIN-RANGE-POSITION-HR  PIC  9(04)  VALUE  0.        01950000
019600                                                                  01960000
019700     05  PV-END-RANGE-POSITION-HR    PIC  9(04)  VALUE  0.        01970000
019800                                                                  01980000
019900     05  PV-BEGIN-RANGE-POSITION-BC  PIC  9(04)  VALUE  0.        01990000
020000                                                                  02000000
020100     05  PV-END-RANGE-POSITION-BC    PIC  9(04)  VALUE  0.        02010000
020200                                                                  02020000
020300     05  PV-HOLD-FOR-BC-RANGE-CALC   PIC  9(04)  VALUE  0.        02030000
020400                                                                  02040000
020500     05  PV-HOLD-FOR-HR-RANGE-CALC   PIC  9(04)  VALUE  0.        02050000
020600                                                                  02060000
020700     05  PV-CHAR-CNTR             PIC  9(04)  VALUE  0.           02070000
020800                                                                  02080000
020900     05  PV-TOT-CHARS-IN-QLFR     PIC  9(04)  VALUE  0.           02090000
021000                                                                  02100000
021100     05  PV-TOT-CHAR-CNTR-HR      PIC  9(04)  VALUE  0.           02110000
021200                                                                  02120000
021300     05  PV-TOT-CHAR-CNTR-BC      PIC  9(04)  VALUE  0.           02130000
021400                                                                  02140000
021500     05  PV-TOT-PRECEDING-CHARS   PIC  9(04)  VALUE  0.           02150000
021600                                                                  02160000
021700     05  PV-SPACE-CNTR            PIC  9(04)  VALUE  0.           02170000
021800                                                                  02180000
021900     05  PV-CONVERSION-FIELD-X    PIC  X(12)  VALUE SPACES.       02190000
022000                                                                  02200000
022100     05  PV-CONVERSION-FIELD-9    PIC  9(12)  VALUE ZEROES.       02210000
022200                                                                  02220000
022300     05  PV-ECA-POINTER           PIC S9(08)  VALUE ZEROS         02230000
022400                                              COMP.               02240000
022500     05  PV-PICX-FOUR             PIC X(04)   VALUE SPACES.       02250000
022600     05  PV-PIC9-FOUR REDEFINES                                   02260000
022700         PV-PICX-FOUR             PIC 9(04).                      02270000
022800     05  PV-SUPPRESS-FOUR         PIC ZZZ9.                       02280000
022900     05 PV-DC-5-CHAR-ABBR            PIC X(05) VALUE SPACES.      02290000
023000     05 PV-DC-5-CHAR-ABBR-R REDEFINES PV-DC-5-CHAR-ABBR.          02300000
023100         10 FILLER                   PIC  X(03).                  02310000
023200         10 PV-2-DIGIT-DC-ABBR       PIC  X(02).                  02320000
023300                                                                  02330000
023400 EJECT                                                            02340000
023500*----------------------------------------------------------------*02350000
023600*  SENDING/RECEIVING AREA FOR THE                                *02360000
023700*  PRINTER VALIDATION ROUTING (DPKCS060)                         *02370000
023800*----------------------------------------------------------------*02380000
023900     COPY DPWS072.                                                02390000
024000                                                                  02400000
024100 EJECT                                                            02410000
024200*----------------------------------------------------------------*02420000
024300*    CALLING PARMS USED TO COMMUNICATE TO ARCH PROGRAM DPKCS030  *02430000
024400*----------------------------------------------------------------*02440000
024500     COPY DPWS030.                                                02450000
1122RM     COPY DPWS930.                                                02451099
024600                                                                  02460000
024700 EJECT                                                            02470000
024800*----------------------------------------------------------------*02480000
024900*    NUMERIC EDIT COPYBOOK                                       *02490000
025000*----------------------------------------------------------------*02500000
025100     COPY DPWS010I.                                               02510000
025200                                                                  02520000
025300 EJECT                                                            02530000
025400*----------------------------------------------------------------*02540000
025500*    DATE VALIDATION COPYBOOK FOR THE DATE ROUTINE DPKUT500      *02550000
025600*----------------------------------------------------------------*02560000
025700     COPY DPWS500.                                                02570000
025800                                                                  02580000
025900 EJECT                                                            02590000
026000*----------------------------------------------------------------*02600000
026100*    CURRENT DATE AND TIME COPYBOOK                              *02610000
026200*----------------------------------------------------------------*02620000
026300     COPY DPWS017.                                                02630000
026400                                                                  02640000
026500 EJECT                                                            02650000
026600*----------------------------------------------------------------*02660000
026700*    STANDARD COMMAREA.                                          *02670000
026800*----------------------------------------------------------------*02680000
026900                                                                  02690000
027000     COPY DPWS020.                                                02700000
027100     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02710000
027200                                                                  02720000
027300*----------------------------------------------------------------*02730000
027400*    INTER-APPLICATION COMMAREA.                                 *02740000
027500*----------------------------------------------------------------*02750000
027600                                                                  02760000
027700         10  INTER-APPL-COMM-AREA PIC X(200).                     02770000
027800     COPY PCWS014.                                                02780000
027900*----------------------------------------------------------------*02790000
028000*    SPECIFIC COMMMAREA FOR PCKCS717.                            *02800099
028100*----------------------------------------------------------------*02810000
028200         10  ASC-SPECIFIC-COMMAREA.                               02820000
028300             15  ASC-ADD-COMPLETE-SW         PIC  X(01).          02830000
028400                 88  ASC-ADD-COMPLETE                   VALUE 'Y'.02840000
028500                 88  ASC-ADD-PENDING                    VALUE 'N'.02850000
028600             15  ASC-RANGE-ERROR-SW          PIC  X(01).          02860000
028700                 88  ASC-RANGE-ERROR                    VALUE 'Y'.02870000
028800                 88  ASC-RANGE-ERROR-NO                 VALUE 'N'.02880000
028900             15  ASC-RANGE-REQUESTED-SW      PIC  X(01).          02890000
029000                 88  ASC-RANGE-REQUESTED                VALUE 'Y'.02900000
029100                 88  ASC-RANGE-REQUESTED-NO             VALUE 'N'.02910000
029200             15  ASC-RANGE1-SPECIFIED-SW     PIC  X(01).          02920000
029300                 88  ASC-RANGE1-SPECIFIED               VALUE 'Y'.02930000
029400                 88  ASC-RANGE1-SPECIFIED-NO            VALUE 'N'.02940000
029500             15  ASC-RANGE2-SPECIFIED-SW     PIC  X(01).          02950000
029600                 88  ASC-RANGE2-SPECIFIED               VALUE 'Y'.02960000
029700                 88  ASC-RANGE2-SPECIFIED-NO            VALUE 'N'.02970000
029800             15  ASC-RANGE3-SPECIFIED-SW     PIC  X(01).          02980000
029900                 88  ASC-RANGE3-SPECIFIED               VALUE 'Y'.02990000
030000                 88  ASC-RANGE3-SPECIFIED-NO            VALUE 'N'.03000000
030100             15  ASC-RANGE4-SPECIFIED-SW     PIC  X(01).          03010000
030200                 88  ASC-RANGE4-SPECIFIED               VALUE 'Y'.03020000
030300                 88  ASC-RANGE4-SPECIFIED-NO            VALUE 'N'.03030000
030400             15  ASC-RANGE1-IS-NUMERIC-SW    PIC  X(01).          03040000
030500                 88  ASC-RANGE1-IS-NUMERIC              VALUE 'Y'.03050000
030600                 88  ASC-RANGE1-IS-NUMERIC-NO           VALUE 'N'.03060000
030700             15  ASC-RANGE2-IS-NUMERIC-SW    PIC  X(01).          03070000
030800                 88  ASC-RANGE2-IS-NUMERIC              VALUE 'Y'.03080000
030900                 88  ASC-RANGE2-IS-NUMERIC-NO           VALUE 'N'.03090000
031000             15  ASC-RANGE3-IS-NUMERIC-SW    PIC  X(01).          03100000
031100                 88  ASC-RANGE3-IS-NUMERIC              VALUE 'Y'.03110000
031200                 88  ASC-RANGE3-IS-NUMERIC-NO           VALUE 'N'.03120000
031300             15  ASC-RANGE4-IS-NUMERIC-SW    PIC  X(01).          03130000
031400                 88  ASC-RANGE4-IS-NUMERIC              VALUE 'Y'.03140000
031500                 88  ASC-RANGE4-IS-NUMERIC-NO           VALUE 'N'.03150000
031600             15  ASC-RANGE-VALID-SW          PIC  X(01).          03160000
031700                 88  ASC-RANGE-VALID                    VALUE 'Y'.03170000
031800                 88  ASC-RANGE-VALID-NO                 VALUE 'N'.03180000
031900             15  ASC-RANGE-IS-ON-LINE-1-SW   PIC  X(01).          03190000
032000                 88  ASC-RANGE-IS-ON-LINE-1             VALUE 'Y'.03200000
032100                 88  ASC-RANGE-IS-ON-LINE-1-NO          VALUE 'N'.03210000
032200             15  ASC-RANGE-IS-ON-LINE-2-SW   PIC  X(01).          03220000
032300                 88  ASC-RANGE-IS-ON-LINE-2             VALUE 'Y'.03230000
032400                 88  ASC-RANGE-IS-ON-LINE-2-NO          VALUE 'N'.03240000
032500             15  ASC-RANGE-IS-ON-LINE-3-SW   PIC  X(01).          03250000
032600                 88  ASC-RANGE-IS-ON-LINE-3             VALUE 'Y'.03260000
032700                 88  ASC-RANGE-IS-ON-LINE-3-NO          VALUE 'N'.03270000
032800             15  ASC-RANGE-IS-ON-LINE-4-SW   PIC  X(01).          03280000
032900                 88  ASC-RANGE-IS-ON-LINE-4             VALUE 'Y'.03290000
033000                 88  ASC-RANGE-IS-ON-LINE-4-NO          VALUE 'N'.03300000
033100             15  ASC-QLFR1-SPECIFIED-SW      PIC  X(01).          03310000
033200                 88  ASC-QLFR1-SPECIFIED                VALUE 'Y'.03320000
033300                 88  ASC-QLFR1-SPECIFIED-NO             VALUE 'N'.03330000
033400             15  ASC-QLFR2-SPECIFIED-SW      PIC  X(01).          03340000
033500                 88  ASC-QLFR2-SPECIFIED                VALUE 'Y'.03350000
033600                 88  ASC-QLFR2-SPECIFIED-NO             VALUE 'N'.03360000
033700             15  ASC-QLFR3-SPECIFIED-SW      PIC  X(01).          03370000
033800                 88  ASC-QLFR3-SPECIFIED                VALUE 'Y'.03380000
033900                 88  ASC-QLFR3-SPECIFIED-NO             VALUE 'N'.03390000
034000             15  ASC-QLFR4-SPECIFIED-SW      PIC  X(01).          03400000
034100                 88  ASC-QLFR4-SPECIFIED                VALUE 'Y'.03410000
034200                 88  ASC-QLFR4-SPECIFIED-NO             VALUE 'N'.03420000
034300             15  ASC-QLFR1-IS-NUMERIC-SW     PIC  X(01).          03430000
034400                 88  ASC-QLFR1-IS-NUMERIC               VALUE 'Y'.03440000
034500                 88  ASC-QLFR1-IS-NUMERIC-NO            VALUE 'N'.03450000
034600             15  ASC-QLFR2-IS-NUMERIC-SW     PIC  X(01).          03460000
034700                 88  ASC-QLFR2-IS-NUMERIC               VALUE 'Y'.03470000
034800                 88  ASC-QLFR2-IS-NUMERIC-NO            VALUE 'N'.03480000
034900             15  ASC-QLFR3-IS-NUMERIC-SW     PIC  X(01).          03490000
035000                 88  ASC-QLFR3-IS-NUMERIC               VALUE 'Y'.03500000
035100                 88  ASC-QLFR3-IS-NUMERIC-NO            VALUE 'N'.03510000
035200             15  ASC-QLFR4-IS-NUMERIC-SW     PIC  X(01).          03520000
035300                 88  ASC-QLFR4-IS-NUMERIC               VALUE 'Y'.03530000
035400                 88  ASC-QLFR4-IS-NUMERIC-NO            VALUE 'N'.03540000
035500             15  ASC-SEPR1-SPECIFIED-SW      PIC  X(01).          03550000
035600                 88  ASC-SEPR1-SPECIFIED                VALUE 'Y'.03560000
035700                 88  ASC-SEPR1-SPECIFIED-NO             VALUE 'N'.03570000
035800             15  ASC-SEPR2-SPECIFIED-SW      PIC  X(01).          03580000
035900                 88  ASC-SEPR2-SPECIFIED                VALUE 'Y'.03590000
036000                 88  ASC-SEPR2-SPECIFIED-NO             VALUE 'N'.03600000
036100             15  ASC-SEPR3-SPECIFIED-SW      PIC  X(01).          03610000
036200                 88  ASC-SEPR3-SPECIFIED                VALUE 'Y'.03620000
036300                 88  ASC-SEPR3-SPECIFIED-NO             VALUE 'N'.03630000
036400             15  ASC-SEPR4-SPECIFIED-SW      PIC  X(01).          03640000
036500                 88  ASC-SEPR4-SPECIFIED                VALUE 'Y'.03650000
036600                 88  ASC-SEPR4-SPECIFIED-NO             VALUE 'N'.03660000
036700             15  ASC-KEEP-SETS-VALUE-SW      PIC  X(01).          03670000
036800                 88  ASC-KEEP-SETS-VALUE                VALUE 'Y'.03680000
036900                 88  ASC-KEEP-SETS-VALUE-NO             VALUE 'N'.03690000
037000             15  ASC-MULT-SETS-CONFIRMED-SW  PIC  X(01).          03700000
037100                 88  ASC-MULT-SETS-CONFIRMED            VALUE 'Y'.03710000
037200                 88  ASC-MULT-SETS-CONFIRMED-NO         VALUE 'N'.03720000
037300             15  ASC-OVER-99-CHECK-DONE-SW   PIC  X(01).          03730000
037400                 88  ASC-OVER-99-CHECK-DONE             VALUE 'Y'.03740000
037500                 88  ASC-OVER-99-CHECK-DONE-NO          VALUE 'N'.03750000
037600             15  ASC-LABEL-PRINT-COMPLETE-SW PIC  X(01).          03760000
037700                 88  ASC-LABEL-PRINT-COMPLETE           VALUE 'Y'.03770000
037800                 88  ASC-LABEL-PRINT-COMPLETE-NO        VALUE 'N'.03780000
037900             15  ASC-EDITS-COMPLETE-SW       PIC  X(01).          03790000
038000                 88  ASC-EDITS-COMPLETE                 VALUE 'Y'.03800000
038100                 88  ASC-EDITS-COMPLETE-NO              VALUE 'N'.03810000
038200             15  ASC-AID-ENTER-SW            PIC  X(01).          03820000
038300                 88  ASC-AID-ENTER                      VALUE 'Y'.03830000
038400                 88  ASC-AID-ENTER-NO                   VALUE 'N'.03840000
038500             15  ASC-AID-ADD-SW              PIC  X(01).          03850000
038600                 88  ASC-AID-ADD                        VALUE 'Y'.03860000
038700                 88  ASC-AID-ADD-NO                     VALUE 'N'.03870000
038800             15  ASC-TOTAL-WITHIN-LIMITS-SW  PIC  X(01).          03880000
038900                 88  ASC-TOTAL-WITHIN-LIMITS            VALUE 'Y'.03890000
039000                 88  ASC-TOTAL-WITHIN-LIMITS-NO         VALUE 'N'.03900000
039100             15  ASC-OPER-UNT-ID           PIC X(04).             03910000
039200             15  ASC-OPER-UNT-ID-N    REDEFINES                   03920000
039300                 ASC-OPER-UNT-ID             PIC 9(04).           03930000
039400             15  ASC-OPER-UNT-NME          PIC X(25).             03940000
039500             15  ASC-FCLTY-ID                PIC X(04).           03950000
039600             15  ASC-FCLTY-ID-N       REDEFINES                   03960000
039700                 ASC-FCLTY-ID                PIC 9(04).           03970000
039800             15  ASC-PRTR-ID                 PIC X(03).           03980000
039900             15  ASC-PRTR-ID-N        REDEFINES                   03990000
040000                 ASC-PRTR-ID                 PIC  9(03).          04000000
040100             15  ASC-PRTR-DESC               PIC  X(25).          04010000
040200             15  ASC-SETS-OF-LABELS          PIC  X(04).          04020000
040300             15  ASC-SETS-OF-LABELS-N  REDEFINES                  04030000
040400                 ASC-SETS-OF-LABELS          PIC  9(04).          04040000
040500             15  ASC-QUALIFIER-1             PIC  X(12).          04050000
040600             15  ASC-QUALIFIER-1-N           PIC  9(12).          04060000
040700             15  ASC-QUALIFIER-2             PIC  X(12).          04070000
040800             15  ASC-QUALIFIER-2-N           PIC  9(12).          04080000
040900             15  ASC-QUALIFIER-3             PIC  X(12).          04090000
041000             15  ASC-QUALIFIER-3-N           PIC  9(12).          04100000
041100             15  ASC-QUALIFIER-4             PIC  X(12).          04110000
041200             15  ASC-QUALIFIER-4-N           PIC  9(12).          04120000
041300             15  ASC-RANGE-1                 PIC  X(12).          04130000
041400             15  ASC-RANGE-1-N               PIC  9(12).          04140000
041500             15  ASC-RANGE-2                 PIC  X(12).          04150000
041600             15  ASC-RANGE-2-N               PIC  9(12).          04160000
041700             15  ASC-RANGE-3                 PIC  X(12).          04170000
041800             15  ASC-RANGE-3-N               PIC  9(12).          04180000
041900             15  ASC-RANGE-4                 PIC  X(12).          04190000
042000             15  ASC-RANGE-4-N               PIC  9(12).          04200000
042100             15  ASC-SEPARATOR-1             PIC  X(01).          04210000
042200             15  ASC-SEPARATOR-2             PIC  X(01).          04220000
042300             15  ASC-SEPARATOR-3             PIC  X(01).          04230000
042400             15  ASC-SEPARATOR-4             PIC  X(01).          04240000
042500             15  ASC-LABEL-COMMENTS-1        PIC  X(30).          04250000
042600             15  ASC-LABEL-COMMENTS-2        PIC  X(30).          04260000
042700             15  ASC-LABEL-COMMENTS-3        PIC  X(30).          04270000
042710             15  ASC-PRINT-BRCDE             PIC  X(01).          04271099
042800             15  ASC-TOTAL-LABELS            PIC  X(05).          04280000
042900             15  ASC-TOTAL-LABELS-N   REDEFINES                   04290000
043000                 ASC-TOTAL-LABELS            PIC  9(05).          04300000
043100             15  ASC-RANGE-CNTRS.                                 04310000
043200                 20  ASC-RANGE-FIELD-CNTR         PIC S9(04).     04320000
043300                 20  ASC-NUMERIC-QLFR-FIELD-CNTR  PIC S9(04).     04330000
043400                                                                  04340000
043500     EJECT                                                        04350000
043600*----------------------------------------------------------------*04360000
043700*    CARTON LABEL COPYBOOK  (SOCKETS)                            *04370000
043800*----------------------------------------------------------------*04380000
043900     COPY PCWS140.                                                04390000
044000                                                                  04400000
044100*----------------------------------------------------------------*04410000
044200*    ABEND PROCESSING COPYBOOK.                                  *04420000
044300*----------------------------------------------------------------*04430000
044400                                                                  04440000
044500     COPY DPWS013.                                                04450000
044600                                                                  04460000
044700     EJECT                                                        04470000
044800*----------------------------------------------------------------*04480000
044900*    ATTRIBUTE SETTINGS COPYBOOK.                                *04490000
045000*----------------------------------------------------------------*04500000
045100                                                                  04510000
045200     COPY DPWS015.                                                04520000
045300                                                                  04530000
045400*----------------------------------------------------------------*04540000
045500*    FUNCTION KEYS COPYBOOK                                      *04550000
045600*----------------------------------------------------------------*04560000
045700                                                                  04570000
045800     COPY DPWS016.                                                04580000
045900                                                                  04590000
046000*----------------------------------------------------------------*04600000
046100*    MAP LAYOUT                                                  *04610000
046200*----------------------------------------------------------------*04620000
046300                                                                  04630000
046400     COPY PCKM717.                                                04640000
046500                                                                  04650000
046600 EJECT                                                            04660000
046700                                                                  04670000
046800*    DB2 AREA FOR TSTATCD  (STATUS CODE)                          04680000
046900                                                                  04690000
047000     EXEC SQL                                                     04700000
047100          INCLUDE TSTATCD                                         04710000
047200     END-EXEC.                                                    04720000
047300                                                                  04730000
047400*    DB2 AREA FOR TRECEIV  (RECEIVER TABLE)                       04740000
047500                                                                  04750000
047600     EXEC SQL                                                     04760000
047700          INCLUDE TRECEIV                                         04770000
047800     END-EXEC.                                                    04780000
047900                                                                  04790000
048000                                                                  04800000
048810*----------------------------------------------------------------*04881099
048900*    DB2 AREA FOR TPURCHS  (PURCHASE ORDER HEADER TABLE)          04890000
048910*----------------------------------------------------------------*04891099
049000                                                                  04900000
049100     EXEC SQL                                                     04910000
049200          INCLUDE TPURCHS                                         04920000
049300     END-EXEC.                                                    04930000
049400                                                                  04940000
049410*----------------------------------------------------------------*04941099
049500*    DB2 AREA FOR TPURITM  (PURCHASE ORDER ITEM TABLE)            04950000
049510*----------------------------------------------------------------*04951099
049600                                                                  04960000
049700     EXEC SQL                                                     04970000
049800          INCLUDE TPURITM                                         04980000
049900     END-EXEC.                                                    04990000
050000                                                                  05000000
050100*    DB2 AREA FOR TWKORIN  (WORK ORDER INSTRUCTION TABLE)         05010000
050200                                                                  05020000
050300     EXEC SQL                                                     05030000
050400          INCLUDE TWKORIN                                         05040000
050500     END-EXEC.                                                    05050000
050600                                                                  05060000
050700                                                                  05070000
050800*    DB2 AREA FOR TPCLABL  (MISC FIELDS FOR LABEL VALIDATION)     05080000
050900                                                                  05090000
051000     EXEC SQL                                                     05100000
051100          INCLUDE TPCLABL                                         05110000
051200     END-EXEC.                                                    05120000
051300                                                                  05130000
051400*----------------------------------------------------------------*05140000
051500*    DB2 AREA FOR THE LOCATION TABLE - XLT_LOC                   *05150099
051600*----------------------------------------------------------------*05160000
051700     EXEC SQL                                                     05170000
051800          INCLUDE XLT00010                                        05180099
051900     END-EXEC.                                                    05190000
052000                                                                  05200000
052100*----------------------------------------------------------------*05210000
052200*    DB2 AREA FOR COMMUNICATIONS                                 *05220000
052300*----------------------------------------------------------------*05230000
052400                                                                  05240000
052500     EXEC SQL                                                     05250000
052600          INCLUDE SQLCA                                           05260000
052700     END-EXEC.                                                    05270000
052800                                                                  05280000
052900                                                                  05290000
053000 EJECT                                                            05300000
053100 LINKAGE SECTION.                                                 05310000
053200                                                                  05320000
053300 01  DFHCOMMAREA.                                                 05330000
053400     05  FILLER                         OCCURS  1 TO 4072 TIMES   05340000
053500                                        DEPENDING ON EIBCALEN.    05350000
053600         10  FILLER                     PIC X.                    05360000
053700                                                                  05370000
053800                                                                  05380000
053900 PROCEDURE DIVISION.                                              05390000
054000*----------------------------------------------------------------*05400000
054100*  THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM.   *05410000
054200*  THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API    *05420000
054300*  MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.              *05430000
054400*                                                                *05440000
054500*  THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE    *05450000
054600*  LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.         *05460000
054700*----------------------------------------------------------------*05470000
054800 0000-MAIN-MODULE.                                                05480000
054900                                                                  05490000
055000     INITIALIZE DP030-CICS-API-FIELDS.                            05500000
055100                                                                  05510000
055200     MOVE +1                     TO DP030-NUMBER-OF-MAPS.         05520000
055300     MOVE PC-CURRENT-MAPSET-NAME TO DP030-MAPSET-NAME.            05530000
055400     MOVE PC-CURRENT-MAP-NAME    TO DP030-MAP-NAME (1).           05540000
055500                                                                  05550000
055600     SET DP030-RECEIVE-APPL-MAP  TO TRUE.                         05560000
055700                                                                  05570000
055800     MOVE LENGTH OF PC717AI      TO DP030-MAP-LENGTH (1).         05580000
055900     MOVE 'PROGRAM ENTRY CALL'   TO DP013-MESSAGE-TEXT (1).       05590000
056000                                                                  05600000
056100     PERFORM 0001-CALL-CICS-ARCH-API.                             05610000
056200                                                                  05620000
056300     PERFORM 1000-CONTROL-PROCESSING.                             05630000
056400                                                                  05640000
056500     MOVE 'PROGRAM EXIT CALL'    TO DP013-MESSAGE-TEXT (1).       05650000
056600                                                                  05660000
056700     PERFORM 0001-CALL-CICS-ARCH-API.                             05670000
056800                                                                  05680000
056900                                                                  05690000
057000 0001-CALL-CICS-ARCH-API.                                         05700000
057100                                                                  05710000
1122RM*    CALL 'DPKCS030' USING DFHEIBLK                               05720099
1122RM     CALL DP930-CICS-ARCH-API                                     05721099
1122RM                     USING DFHEIBLK                               05722099
057300                           DFHCOMMAREA                            05730000
057400                           DP030-CICS-API-FIELDS                  05740000
057500                           DP020-STANDARD-COMMAREA                05750000
057600                           PC717AI.                               05760000
057700                                                                  05770000
057800     IF  DP030-RC-CALL-SUCCESSFUL                                 05780000
057900         CONTINUE                                                 05790000
058000     ELSE                                                         05800000
058100         SET DP013-NO-ROLLBACK   TO TRUE                          05810000
058200         SET DP013-XCTL-DISPLAY-RESTART                           05820000
058300                                 TO TRUE                          05830000
058400         SET DP013-CICS-ABEND    TO TRUE                          05840000
058500         MOVE 'BEFORE 0000-MAIN-MODULE'                           05850000
058600                                 TO DP013-PARAGRAPH               05860000
1122RM*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX05870099
1122RM*             'T LINE'           TO DP013-MESSAGE-TEXT (2)        05880099
1122rm         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O05881099
1122RM-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      05882099
058900         MOVE DP030-RETURN-CODE  TO DP013-MESSAGE-TEXT (3)        05890000
059000         PERFORM DP013-0000-PROCESS-ABEND                         05900000
059100     END-IF.                                                      05910000
059200 EJECT                                                            05920000
059300*----------------------------------------------------------------*05930000
059400*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *05940000
059500*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *05950000
059600*                                                                *05960000
059700*    PERFORMED BY 0000-MAIN-MODULE.                              *05970000
059800*----------------------------------------------------------------*05980000
059900                                                                  05990000
060000 1000-CONTROL-PROCESSING.                                         06000000
060100                                                                  06010000
060200     EVALUATE TRUE                                                06020000
060300         WHEN DP020-NEXT-ACT-INITIAL                              06030000
060400             INITIALIZE ASC-SPECIFIC-COMMAREA                     06040000
060500             INITIALIZE DP020-MSG-NUMBER                          06050000
060600             SET ASC-KEEP-SETS-VALUE-NO      TO TRUE              06060000
060700             SET ASC-OVER-99-CHECK-DONE-NO   TO TRUE              06070000
060800             SET ASC-LABEL-PRINT-COMPLETE-NO TO TRUE              06080000
060900             SET ASC-AID-ENTER-NO            TO TRUE              06090000
061000             SET ASC-AID-ADD-NO              TO TRUE              06100000
061100             SET ASC-EDITS-COMPLETE-NO       TO TRUE              06110000
061200             SET ASC-TOTAL-WITHIN-LIMITS-NO  TO TRUE              06120000
061300             PERFORM 3000-BUILD-INITIAL-PANEL                     06130000
061400             PERFORM 2210-RESET-ATTRIBUTES                        06140099
061500                                                                  06150000
061600         WHEN DP020-NEXT-ACT-READ-MAP                             06160000
061700             PERFORM 2000-FKEY-PROCESSING                         06170000
061800                                                                  06180000
061900         WHEN DP020-NEXT-ACT-RETURN                               06190000
062000             PERFORM 2300-MOVE-COMMAREA-TO-SCREEN                 06200000
062100             PERFORM 2200-EDIT-DATA-IN-COMMAREA                   06210000
062200             PERFORM 3200-DISPLAY-PANEL                           06220000
062300                                                                  06230000
062400         WHEN OTHER                                               06240000
062500             SET DP013-LOGIC-ABEND                                06250000
062600                                 TO TRUE                          06260000
062700             SET DP013-NO-ROLLBACK                                06270000
062800                                 TO TRUE                          06280000
062900             MOVE '1000-CONTROL-PROCESSING'                       06290000
063000                                 TO DP013-PARAGRAPH               06300000
063100             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   06310000
063200                                 TO DP013-MESSAGE-TEXT(1)         06320000
063300             MOVE DP020-NEXT-APPL-ACTIVITY                        06330000
063400                                 TO DP013-MESSAGE-TEXT(2)         06340000
063500             PERFORM DP013-0000-PROCESS-ABEND                     06350000
063600     END-EVALUATE.                                                06360000
063700                                                                  06370000
063800 EJECT                                                            06380000
063900*----------------------------------------------------------------*06390000
064000*   DETERMINE THE PROCESSING PATH HERE.                          *06400000
064100*----------------------------------------------------------------*06410000
064200 2000-FKEY-PROCESSING.                                            06420000
064300                                                                  06430000
064400     EVALUATE TRUE                                                06440000
064500         WHEN DP020-SRC-AID = DP016-CLEAR                         06450000
064600             PERFORM 2300-MOVE-COMMAREA-TO-SCREEN                 06460000
064700             PERFORM 2200-EDIT-DATA-IN-COMMAREA                   06470000
064800             PERFORM 3200-DISPLAY-PANEL                           06480000
064900             PERFORM 2210-RESET-ATTRIBUTES                        06490000
065000                                                                  06500000
065100         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     06510000
065200             MOVE ASC-PRTR-ID-N  TO PV-PRINTER-ID                 06520000
065300             INITIALIZE ASC-SPECIFIC-COMMAREA                     06530000
065400             MOVE PV-PRINTER-ID  TO ASC-PRTR-ID-N                 06540000
065500             MOVE SPACES         TO AOPUNITO                      06550000
065600                                    AFACILO                       06560000
065700                                    APRTRO                        06570000
065800                                    ASETSO                        06580000
065900                                    AQLFR1O                       06590000
066000                                    AQLFR2O                       06600000
066100                                    AQLFR3O                       06610000
066200                                    AQLFR4O                       06620000
066300                                    ARANGE1O                      06630000
066400                                    ARANGE2O                      06640000
066500                                    ARANGE3O                      06650000
066600                                    ARANGE4O                      06660000
066700                                    ASEPR1O                       06670000
066800                                    ASEPR2O                       06680000
066900                                    ASEPR3O                       06690000
067000                                    ASEPR4O                       06700000
067100                                    ACMNT1O                       06710000
067200                                    ACMNT2O                       06720000
067300                                    ACMNT3O                       06730000
067400                                    APRTBR1O                      06740099
067500             SET ASC-KEEP-SETS-VALUE-NO     TO TRUE               06750000
067600             SET ASC-OVER-99-CHECK-DONE-NO  TO TRUE               06760000
067700             SET ASC-AID-ENTER-NO           TO TRUE               06770000
067800             SET ASC-AID-ADD-NO             TO TRUE               06780000
067900             SET ASC-EDITS-COMPLETE-NO      TO TRUE               06790000
068000             SET ASC-TOTAL-WITHIN-LIMITS-NO TO TRUE               06800000
068100             PERFORM 3000-BUILD-INITIAL-PANEL                     06810000
068200             PERFORM 2210-RESET-ATTRIBUTES                        06820000
068300                                                                  06830000
068400         WHEN DP020-SRC-AID = DP016-ENTER                         06840000
068500             SET ASC-AID-ENTER  TO TRUE                           06850000
068600             SET ASC-AID-ADD-NO TO TRUE                           06860000
068700             PERFORM 2100-MOVE-SCREEN-TO-COMMAREA                 06870000
068800             PERFORM 2200-EDIT-DATA-IN-COMMAREA                   06880000
068900             IF ASC-TOTAL-WITHIN-LIMITS                           06890000
069000                MOVE -1                     TO AQLFR1L            06900000
069100                SET DP030-SET-CURSOR-APPL-1 TO TRUE               06910000
069200             END-IF                                               06920000
069300             IF  ASC-LABEL-PRINT-COMPLETE                         06930000
069400                    MOVE -1                     TO AQLFR1L        06940000
069500                    SET DP030-SET-CURSOR-APPL-1 TO TRUE           06950000
069600                 IF (ASC-SETS-OF-LABELS-N = 0 AND                 06960000
069700                     ASC-LABEL-PRINT-COMPLETE AND                 06970000
069800                     ASC-EDITS-COMPLETE)                          06980000
069900                     MOVE +0001         TO ASC-SETS-OF-LABELS-N   06990000
070000                     MOVE +0001         TO PV-SUPPRESS-FOUR       07000000
070100                     MOVE PV-SUPPRESS-FOUR      TO ASETSI         07010000
070200                 END-IF                                           07020000
070300             END-IF                                               07030000
070400             PERFORM 3200-DISPLAY-PANEL                           07040000
070500             PERFORM 2210-RESET-ATTRIBUTES                        07050000
070600                                                                  07060000
070700         WHEN DP020-FK-LOCAL-GOTO    (DP020-SRC-AID)              07070000
070800         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              07080000
070900         WHEN DP020-FK-CONFIRM       (DP020-SRC-AID)              07090000
071000             SET ASC-AID-ADD          TO TRUE                     07100000
071100             SET ASC-AID-ENTER-NO     TO TRUE                     07110000
071200             PERFORM 2100-MOVE-SCREEN-TO-COMMAREA                 07120000
071300             PERFORM 2200-EDIT-DATA-IN-COMMAREA                   07130000
071400             PERFORM 2260-CHECK-FOR-VALID-RANGE                   07140000
071500             PERFORM 2280-CALCULATE-LABEL-TOTALS                  07150000
071600             PERFORM 2282-CALC-RANGE-POSITIONS                    07160000
071700                                                                  07170000
071800             IF  PS-ERROR                                         07180000
071900                 SET DP030-OVERRIDE-GO                            07190000
072000                                 TO TRUE                          07200000
072100                 PERFORM 3200-DISPLAY-PANEL                       07210000
072200             ELSE                                                 07220000
072300                 IF  PV-TOT-CHAR-CNTR-BC > 12                     07230000
072400                     SET  PS-ERROR                TO TRUE         07240000
072500                     SET  DP020-MSG-FATAL         TO TRUE         07250000
072600                     SET DP020-MSG-WARNING TO TRUE                07260000
072700                     SET ASC-KEEP-SETS-VALUE      TO TRUE         07270000
072800                     SET DP030-OVERRIDE-GO        TO TRUE         07280000
072900                     MOVE PC-TSYMSG-02503 TO DP020-MSG-NUMBER     07290000
073000                     MOVE -1                      TO AQLFR1L      07300000
073100                     SET DP030-SET-CURSOR-APPL-1  TO TRUE         07310000
073200                     PERFORM 2300-MOVE-COMMAREA-TO-SCREEN         07320000
073300                     PERFORM 3200-DISPLAY-PANEL                   07330000
073400                 END-IF                                           07340000
073500             END-IF                                               07350000
073600             IF  PS-ERROR                                         07360000
073700                 SET DP030-OVERRIDE-GO                            07370000
073800                                 TO TRUE                          07380000
073900                 PERFORM 3200-DISPLAY-PANEL                       07390000
074000             ELSE                                                 07400000
074100                 IF NOT  (DP020-FK-CONFIRM (DP020-SRC-AID))       07410000
074200                   IF (ASC-SETS-OF-LABELS-N > PC-1)               07420000
074300                    SET PS-ERROR          TO TRUE                 07430000
074400                    SET DP020-MSG-WARNING TO TRUE                 07440000
074500                    MOVE ASC-SETS-OF-LABELS-N TO PV-SUPPRESS-FOUR 07450000
074600                    MOVE PV-SUPPRESS-FOUR     TO DP020-MSG-TEXT   07460000
074700                    MOVE PC-TSYMSG-02504  TO DP020-MSG-NUMBER     07470000
074800                    SET ASC-KEEP-SETS-VALUE   TO TRUE             07480000
074900                    SET ASC-MULT-SETS-CONFIRMED-NO  TO TRUE       07490000
075000                    SET DP030-OVERRIDE-GO TO TRUE                 07500000
075100                    PERFORM 3200-DISPLAY-PANEL                    07510000
075200                   END-IF                                         07520000
075300                 ELSE                                             07530000
075400                   IF ((DP020-FK-CONFIRM (DP020-SRC-AID)) AND     07540000
075500                        (ASC-SETS-OF-LABELS-N > PC-1))            07550000
075600                        SET ASC-MULT-SETS-CONFIRMED TO TRUE       07560000
075700                   END-IF                                         07570000
075800                 END-IF                                           07580000
075900             END-IF                                               07590000
076000             IF  PS-ERROR                                         07600000
076100                 SET DP030-OVERRIDE-GO                            07610000
076200                                 TO TRUE                          07620000
076300                 PERFORM 3200-DISPLAY-PANEL                       07630000
076400             ELSE                                                 07640000
076500                 SET ASC-KEEP-SETS-VALUE-NO TO TRUE               07650000
076600                 IF ((ASC-SETS-OF-LABELS-N > PC-1)) AND           07660000
076700                     (ASC-MULT-SETS-CONFIRMED)                    07670000
076800                   IF ((PV-TOTAL-LABELS > PC-99 ) AND             07680000
076900                       (ASC-OVER-99-CHECK-DONE-NO))               07690000
077000                    SET PS-ERROR          TO TRUE                 07700000
077100                    SET DP020-MSG-WARNING TO TRUE                 07710000
077200                    MOVE PC-TSYMSG-02505  TO DP020-MSG-NUMBER     07720000
077300                    MOVE PV-TOTAL-LABELS  TO PV-SUPPRESS-FOUR     07730000
077400                    MOVE PV-SUPPRESS-FOUR TO DP020-MSG-TEXT       07740000
077500                    SET ASC-KEEP-SETS-VALUE    TO TRUE            07750000
077600                    SET ASC-OVER-99-CHECK-DONE TO TRUE            07760000
077700                    SET DP030-OVERRIDE-GO TO TRUE                 07770000
077800                    PERFORM 3200-DISPLAY-PANEL                    07780000
077900                   ELSE                                           07790000
078000                    IF ((PV-TOTAL-LABELS = PC-99 ) AND            07800000
078100                        (ASC-OVER-99-CHECK-DONE-NO))              07810000
078200                     SET PS-ERROR          TO TRUE                07820000
078300                     SET DP020-MSG-WARNING TO TRUE                07830000
078400                     MOVE PC-TSYMSG-02505  TO DP020-MSG-NUMBER    07840000
078500                     MOVE PV-TOTAL-LABELS  TO PV-SUPPRESS-FOUR    07850000
078600                     MOVE PV-SUPPRESS-FOUR TO DP020-MSG-TEXT      07860000
078700                     SET ASC-KEEP-SETS-VALUE    TO TRUE           07870000
078800                     SET ASC-OVER-99-CHECK-DONE TO TRUE           07880000
078900                     SET DP030-OVERRIDE-GO TO TRUE                07890000
079000                     PERFORM 3200-DISPLAY-PANEL                   07900000
079100                    END-IF                                        07910000
079200                   END-IF                                         07920000
079300                 ELSE                                             07930000
079400                   IF ((ASC-SETS-OF-LABELS-N = PC-1) AND          07940000
079500                       (PV-TOTAL-LABELS > PC-99 ) AND             07950000
079600                        ASC-OVER-99-CHECK-DONE-NO)                07960000
079700                    SET PS-ERROR          TO TRUE                 07970000
079800                    SET DP020-MSG-WARNING TO TRUE                 07980000
079900                    MOVE PC-TSYMSG-02505  TO DP020-MSG-NUMBER     07990000
080000                    MOVE PV-TOTAL-LABELS  TO PV-SUPPRESS-FOUR     08000000
080100                    MOVE PV-SUPPRESS-FOUR TO DP020-MSG-TEXT       08010000
080200                    SET ASC-KEEP-SETS-VALUE    TO TRUE            08020000
080300                    SET ASC-OVER-99-CHECK-DONE TO TRUE            08030000
080400                    SET DP030-OVERRIDE-GO TO TRUE                 08040000
080500                    PERFORM 3200-DISPLAY-PANEL                    08050000
080600                   ELSE                                           08060000
080700                      IF ((PV-TOTAL-LABELS > PC-99 ) AND          08070000
080800                          (ASC-OVER-99-CHECK-DONE) AND            08080000
080900                         (DP020-FK-CONFIRM (DP020-SRC-AID)))      08090000
081000                         CONTINUE                                 08100000
081100                      END-IF                                      08110000
081200                   END-IF                                         08120000
081300                 END-IF                                           08130000
081400             END-IF                                               08140000
081500             IF PS-NO-ERROR                                       08150000
081600                 SET DP030-CONTINUE-GO TO TRUE                    08160000
081700                 PERFORM 4000-SETUP-LABELS                        08170000
081800                 IF PC140-CRA-SUCCESSFUL                          08180000
081900                    SET ASC-ADD-COMPLETE TO TRUE                  08190000
082000                    SET DP020-MSG-INFORMATIONAL                   08200000
082100                                         TO TRUE                  08210000
082200                    PERFORM 2300-MOVE-COMMAREA-TO-SCREEN          08220000
082300                    PERFORM 3000-BUILD-INITIAL-PANEL              08230000
082400                 END-IF                                           08240000
082500             END-IF                                               08250000
082600                                                                  08260000
082700         WHEN OTHER                                               08270000
082800             SET DP013-NO-ROLLBACK                                08280000
082900                                 TO TRUE                          08290000
083000             SET DP013-XCTL-DISPLAY-RESTART                       08300000
083100                                 TO TRUE                          08310000
083200             SET DP013-CICS-ABEND                                 08320000
083300                                 TO TRUE                          08330000
083400             MOVE '2000-FKEY-PROCESSING'                          08340000
083500                                 TO DP013-PARAGRAPH               08350000
083600             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      08360000
083700                                 TO DP013-MESSAGE-TEXT (1)        08370000
083800             PERFORM DP013-0000-PROCESS-ABEND                     08380000
083900     END-EVALUATE.                                                08390000
084000                                                                  08400000
084100 EJECT                                                            08410000
084200*----------------------------------------------------------------*08420000
084300*    MOVE THE DATA ENTERED ON THE SCREEN TO THE COMMAREA.        *08430000
084400*                                                                *08440000
084500*    WHILE ABSORBING THE USER-ENTERED DATA FROM THE SCREEN,      *08450000
084600*    IT IS NECESSARY TO DETERMINE WHICH QUALIFIER, RANGE OR      *08460000
084700*    SEPARATOR FIELDS HAVE VALUES, AND IF THE QUALIFIER OR RANGE *08470000
084800*    FIELDS CONTAIN NUMERICS. THIS IS NECESSARY IN ORDER TO      *08480000
084900*    DETERMINE IF A RANGE WAS SPECIFIED, IF IT IS A VALID        *08490000
085000*    RANGE, AND WHERE ITS POSITION WILL BE IN THE HORIZONTAL     *08500000
085100*    HUMAN READABLE PORTION OF THE LABEL THAT IT BEING CREATED.  *08510000
085200*    THE CHECK FOR NUMERIC WILL CALL THE KOHLS NUMERIC EDIT      *08520000
085300*    ROUTINE DPKUT100.                                           *08530000
085400*                                                                *08540000
085500* !! I M P O R T A N T !!                                        *08550000
085600*                                                                *08560000
085700*   SIMILAR LOGIC THAT SETS SWITCHES HERE NEEDS TO BE EXECUTED   *08570000
085800*   AGAIN IN PARAGRAPH 2260-CHECK-FOR-VALID-RANGE BECAUSE        *08580000
085900*   THE USER MAY HAVE ENTERED A RANGE VALUE W/O A CORRESPONDING  *08590000
086000*   NUMERIC QUALIFIER FIELD OR VICE VERSA, OR NO RANGE VALUE OR  *08600000
086100*   TOO MANY ETC. THE SCREEN WITH ERRORS WILL BE PRESENTED BACK  *08610000
086200*   TO THE USER. TO AVOID HAVING TO ENTER ALL OF THE FREE FORM   *08620000
086300*   TEXT EVERY TIME THERE IS AN ERROR, JUST EXECUTE TWICE THE    *08630000
086400*   LOGIC THAT DETERMINES IF A FIELD HAS A VALUE & IF IT IS      *08640000
086500*   NUMERIC ETC.                                                 *08650000
086600*----------------------------------------------------------------*08660000
086700 2100-MOVE-SCREEN-TO-COMMAREA.                                    08670000
086800                                                                  08680000
086900     IF AOPUNITL > ZERO                                           08690000
087000         MOVE AOPUNITI             TO ASC-OPER-UNT-ID             08700000
087100     ELSE                                                         08710000
087200         IF AOPUNITF = DP015-ERASE-EOF                            08720000
087300             MOVE SPACE            TO ASC-OPER-UNT-ID             08730000
087400         END-IF                                                   08740000
087500     END-IF.                                                      08750000
087600                                                                  08760000
087700     IF AFACILL  > ZERO                                           08770000
087800         MOVE AFACILI              TO ASC-FCLTY-ID                08780000
087900     ELSE                                                         08790000
088000         IF AFACILF  = DP015-ERASE-EOF                            08800000
088100             MOVE SPACE            TO ASC-FCLTY-ID                08810000
088200         END-IF                                                   08820000
088300     END-IF.                                                      08830000
088400                                                                  08840000
088500     IF  APRTRL > ZERO                                            08850000
088600         MOVE APRTRI               TO ASC-PRTR-ID                 08860000
088700     ELSE                                                         08870000
088800         IF  APRTRF = DP015-ERASE-EOF                             08880000
088900             MOVE SPACE            TO ASC-PRTR-ID                 08890000
089000         END-IF                                                   08900000
089100     END-IF.                                                      08910000
089200                                                                  08920000
089300     IF  ASETSL > ZERO                                            08930000
089400         MOVE ASETSI               TO PV-SUPPRESS-FOUR            08940000
089500         MOVE PV-SUPPRESS-FOUR     TO ASC-SETS-OF-LABELS          08950000
089600     ELSE                                                         08960000
089700        IF ASETSL = ZERO                                          08970000
089800          IF ((ASC-AID-ENTER                AND                   08980000
089900               ASC-EDITS-COMPLETE)                   OR           08990000
090000                                                                  09000000
090100              (ASC-KEEP-SETS-VALUE-NO       AND                   09010000
090200               ASC-AID-ADD                  AND                   09020000
090300               ASC-EDITS-COMPLETE-NO        AND                   09030000
090400               ASC-TOTAL-WITHIN-LIMITS-NO   AND                   09040000
090410               ASC-SETS-OF-LABELS = SPACE   AND                   09041000
090500              (ASC-SETS-OF-LABELS-N = 0   OR                      09050000
090600               ASC-SETS-OF-LABELS-N < 0))          OR             09060000
090700                                                                  09070000
090800              (ASC-KEEP-SETS-VALUE-NO       AND                   09080000
090900               ASC-SETS-OF-LABELS NOT > 0   AND                   09090000
091000               ASC-LABEL-PRINT-COMPLETE     AND                   09100000
091100               ASC-AID-ENTER))                                    09110000
091200           MOVE PC-1               TO ASC-SETS-OF-LABELS          09120000
091300          END-IF                                                  09130000
091400        ELSE                                                      09140000
091500           IF ASETSF = DP015-ERASE-EOF                            09150000
091600              MOVE SPACE           TO ASC-SETS-OF-LABELS          09160000
091700           END-IF                                                 09170000
091800        END-IF                                                    09180000
091900     END-IF.                                                      09190000
092000                                                                  09200000
092100     PERFORM 2250-RESET-FREE-FORM-SWITCHES.                       09210000
092200     INITIALIZE ASC-NUMERIC-QLFR-FIELD-CNTR.                      09220000
092300     INITIALIZE ASC-RANGE-FIELD-CNTR.                             09230000
092400                                                                  09240000
092500                                                                  09250000
092600     IF  (AQLFR1L > ZERO OR AQLFR1L = -1)                         09260000
092700         MOVE AQLFR1I              TO ASC-QUALIFIER-1             09270000
092800         SET ASC-QLFR1-SPECIFIED   TO TRUE                        09280000
092900         INITIALIZE DP010I-UNEDITED-FIELD                         09290000
093000         MOVE ASC-QUALIFIER-1      TO DP010I-UNEDITED-FIELD       09300000
093100         PERFORM 2101-NUMERIC-EDIT-ROUTINE                        09310000
093200         IF DP010I-NUM-FIELD-17-DIG-0-DEC > 0                     09320000
093300            SET ASC-QLFR1-IS-NUMERIC TO TRUE                      09330000
093400            INITIALIZE PV-CONVERSION-FIELD-X                      09340000
093500            MOVE ASC-QUALIFIER-1 TO PV-CONVERSION-FIELD-X         09350000
093600            PERFORM 2285-ALPHA-TO-NUM-CONVERSION-Q                09360000
093700            MOVE PV-CONVERSION-FIELD-9 TO ASC-QUALIFIER-1-N       09370000
093800         END-IF                                                   09380000
093900     ELSE                                                         09390000
094000         IF  AQLFR1F = DP015-ERASE-EOF                            09400000
094100             MOVE SPACE            TO ASC-QUALIFIER-1             09410000
094200         END-IF                                                   09420000
094300     END-IF.                                                      09430000
094400                                                                  09440000
094500     IF  AQLFR2L > ZERO                                           09450000
094600         MOVE AQLFR2I              TO ASC-QUALIFIER-2             09460000
094700         SET ASC-QLFR2-SPECIFIED   TO TRUE                        09470000
094800         INITIALIZE DP010I-UNEDITED-FIELD                         09480000
094900         MOVE ASC-QUALIFIER-2      TO DP010I-UNEDITED-FIELD       09490000
095000         PERFORM 2101-NUMERIC-EDIT-ROUTINE                        09500000
095100         IF DP010I-NUM-FIELD-17-DIG-0-DEC > 0                     09510000
095200            SET ASC-QLFR2-IS-NUMERIC TO TRUE                      09520000
095300            INITIALIZE PV-CONVERSION-FIELD-X                      09530000
095400            MOVE ASC-QUALIFIER-2 TO PV-CONVERSION-FIELD-X         09540000
095500            PERFORM 2285-ALPHA-TO-NUM-CONVERSION-Q                09550000
095600            MOVE PV-CONVERSION-FIELD-9 TO ASC-QUALIFIER-2-N       09560000
095700         END-IF                                                   09570000
095800     ELSE                                                         09580000
095900         IF  AQLFR2F = DP015-ERASE-EOF                            09590000
096000             MOVE SPACE            TO ASC-QUALIFIER-2             09600000
096100         END-IF                                                   09610000
096200     END-IF.                                                      09620000
096300                                                                  09630000
096400     IF  AQLFR3L > ZERO                                           09640000
096500         MOVE AQLFR3I              TO ASC-QUALIFIER-3             09650000
096600         SET ASC-QLFR3-SPECIFIED   TO TRUE                        09660000
096700         INITIALIZE DP010I-UNEDITED-FIELD                         09670000
096800         MOVE ASC-QUALIFIER-3      TO DP010I-UNEDITED-FIELD       09680000
096900         PERFORM 2101-NUMERIC-EDIT-ROUTINE                        09690000
097000         IF DP010I-NUM-FIELD-17-DIG-0-DEC > 0                     09700000
097100            SET ASC-QLFR3-IS-NUMERIC TO TRUE                      09710000
097200            INITIALIZE PV-CONVERSION-FIELD-X                      09720000
097300            MOVE ASC-QUALIFIER-3 TO PV-CONVERSION-FIELD-X         09730000
097400            PERFORM 2285-ALPHA-TO-NUM-CONVERSION-Q                09740000
097500            MOVE PV-CONVERSION-FIELD-9 TO ASC-QUALIFIER-3-N       09750000
097600         END-IF                                                   09760000
097700     ELSE                                                         09770000
097800         IF  AQLFR3F = DP015-ERASE-EOF                            09780000
097900             MOVE SPACE            TO ASC-QUALIFIER-3             09790000
098000         END-IF                                                   09800000
098100     END-IF.                                                      09810000
098200                                                                  09820000
098300     IF  AQLFR4L > ZERO                                           09830000
098400         MOVE AQLFR4I              TO ASC-QUALIFIER-4             09840000
098500         SET ASC-QLFR4-SPECIFIED   TO TRUE                        09850000
098600         INITIALIZE DP010I-UNEDITED-FIELD                         09860000
098700         MOVE ASC-QUALIFIER-4      TO DP010I-UNEDITED-FIELD       09870000
098800         PERFORM 2101-NUMERIC-EDIT-ROUTINE                        09880000
098900         IF DP010I-NUM-FIELD-17-DIG-0-DEC > 0                     09890000
099000            SET ASC-QLFR4-IS-NUMERIC TO TRUE                      09900000
099100            INITIALIZE PV-CONVERSION-FIELD-X                      09910000
099200            MOVE ASC-QUALIFIER-4 TO PV-CONVERSION-FIELD-X         09920000
099300            PERFORM 2285-ALPHA-TO-NUM-CONVERSION-Q                09930000
099400            MOVE PV-CONVERSION-FIELD-9 TO ASC-QUALIFIER-4-N       09940000
099500         END-IF                                                   09950000
099600     ELSE                                                         09960000
099700         IF  AQLFR4F = DP015-ERASE-EOF                            09970000
099800             MOVE SPACE            TO ASC-QUALIFIER-4             09980000
099900         END-IF                                                   09990000
100000     END-IF.                                                      10000000
100100                                                                  10010000
100200                                                                  10020000
100300     IF  ARANGE1L > ZERO                                          10030000
100400         MOVE ARANGE1I             TO ASC-RANGE-1                 10040000
100500         SET ASC-RANGE1-SPECIFIED  TO TRUE                        10050000
100600         INITIALIZE DP010I-UNEDITED-FIELD                         10060000
100700         MOVE ASC-RANGE-1          TO DP010I-UNEDITED-FIELD       10070000
100800         PERFORM 2101-NUMERIC-EDIT-ROUTINE                        10080000
100900         IF DP010I-NUM-FIELD-17-DIG-0-DEC > 0                     10090000
101000            SET ASC-RANGE1-IS-NUMERIC TO TRUE                     10100000
101100            INITIALIZE PV-CONVERSION-FIELD-X                      10110000
101200            MOVE ASC-RANGE-1     TO PV-CONVERSION-FIELD-X         10120000
101300            PERFORM 2286-ALPHA-TO-NUM-CONVERSION-R                10130000
101400            MOVE PV-CONVERSION-FIELD-9 TO ASC-RANGE-1-N           10140000
101500         END-IF                                                   10150000
101600     ELSE                                                         10160000
101700         IF  ARANGE1F = DP015-ERASE-EOF                           10170000
101800             MOVE SPACE            TO ASC-RANGE-1                 10180000
101900         END-IF                                                   10190000
102000     END-IF.                                                      10200000
102100                                                                  10210000
102200     IF  ARANGE2L > ZERO                                          10220000
102300         MOVE ARANGE2I             TO ASC-RANGE-2                 10230000
102400         SET ASC-RANGE2-SPECIFIED  TO TRUE                        10240000
102500         INITIALIZE DP010I-UNEDITED-FIELD                         10250000
102600         MOVE ASC-RANGE-2          TO DP010I-UNEDITED-FIELD       10260000
102700         PERFORM 2101-NUMERIC-EDIT-ROUTINE                        10270000
102800         IF DP010I-NUM-FIELD-17-DIG-0-DEC > 0                     10280000
102900            SET ASC-RANGE2-IS-NUMERIC TO TRUE                     10290000
103000            INITIALIZE PV-CONVERSION-FIELD-X                      10300000
103100            MOVE ASC-RANGE-2     TO PV-CONVERSION-FIELD-X         10310000
103200            PERFORM 2286-ALPHA-TO-NUM-CONVERSION-R                10320000
103300            MOVE PV-CONVERSION-FIELD-9 TO ASC-RANGE-2-N           10330000
103400         END-IF                                                   10340000
103500     ELSE                                                         10350000
103600         IF  ARANGE2F = DP015-ERASE-EOF                           10360000
103700             MOVE SPACE            TO ASC-RANGE-2                 10370000
103800         END-IF                                                   10380000
103900     END-IF.                                                      10390000
104000                                                                  10400000
104100     IF  ARANGE3L > ZERO                                          10410000
104200         MOVE ARANGE3I             TO ASC-RANGE-3                 10420000
104300         SET ASC-RANGE3-SPECIFIED  TO TRUE                        10430000
104400         INITIALIZE DP010I-UNEDITED-FIELD                         10440000
104500         MOVE ASC-RANGE-3          TO DP010I-UNEDITED-FIELD       10450000
104600         PERFORM 2101-NUMERIC-EDIT-ROUTINE                        10460000
104700         IF DP010I-NUM-FIELD-17-DIG-0-DEC > 0                     10470000
104800            SET ASC-RANGE3-IS-NUMERIC TO TRUE                     10480000
104900            INITIALIZE PV-CONVERSION-FIELD-X                      10490000
105000            MOVE ASC-RANGE-3     TO PV-CONVERSION-FIELD-X         10500000
105100            PERFORM 2286-ALPHA-TO-NUM-CONVERSION-R                10510000
105200            MOVE PV-CONVERSION-FIELD-9 TO ASC-RANGE-3-N           10520000
105300         END-IF                                                   10530000
105400     ELSE                                                         10540000
105500         IF  ARANGE3F = DP015-ERASE-EOF                           10550000
105600             MOVE SPACE            TO ASC-RANGE-3                 10560000
105700         END-IF                                                   10570000
105800     END-IF.                                                      10580000
105900                                                                  10590000
106000     IF  ARANGE4L > ZERO                                          10600000
106100         MOVE ARANGE4I             TO ASC-RANGE-4                 10610000
106200         SET ASC-RANGE4-SPECIFIED  TO TRUE                        10620000
106300         INITIALIZE DP010I-UNEDITED-FIELD                         10630000
106400         MOVE ASC-RANGE-4          TO DP010I-UNEDITED-FIELD       10640000
106500         PERFORM 2101-NUMERIC-EDIT-ROUTINE                        10650000
106600         IF DP010I-NUM-FIELD-17-DIG-0-DEC > 0                     10660000
106700            SET ASC-RANGE4-IS-NUMERIC TO TRUE                     10670000
106800            INITIALIZE PV-CONVERSION-FIELD-X                      10680000
106900            MOVE ASC-RANGE-4     TO PV-CONVERSION-FIELD-X         10690000
107000            PERFORM 2286-ALPHA-TO-NUM-CONVERSION-R                10700000
107100            MOVE PV-CONVERSION-FIELD-9 TO ASC-RANGE-4-N           10710000
107200         END-IF                                                   10720000
107300     ELSE                                                         10730000
107400         IF  ARANGE4F = DP015-ERASE-EOF                           10740000
107500             MOVE SPACE            TO ASC-RANGE-4                 10750000
107600         END-IF                                                   10760000
107700     END-IF.                                                      10770000
107800                                                                  10780000
107900     IF  ASEPR1L > ZERO                                           10790000
108000         MOVE ASEPR1I              TO ASC-SEPARATOR-1             10800000
108100         SET ASC-SEPR1-SPECIFIED   TO TRUE                        10810000
108200     ELSE                                                         10820000
108300         IF  ASEPR1F = DP015-ERASE-EOF                            10830000
108400             MOVE SPACE            TO ASC-SEPARATOR-1             10840000
108500         END-IF                                                   10850000
108600     END-IF.                                                      10860000
108700                                                                  10870000
108800     SET ASC-SEPR2-SPECIFIED-NO    TO TRUE.                       10880000
108900     IF  ASEPR2L > ZERO                                           10890000
109000         MOVE ASEPR2I              TO ASC-SEPARATOR-2             10900000
109100         SET ASC-SEPR2-SPECIFIED   TO TRUE                        10910000
109200     ELSE                                                         10920000
109300         IF  ASEPR2F = DP015-ERASE-EOF                            10930000
109400             MOVE SPACE            TO ASC-SEPARATOR-2             10940000
109500         END-IF                                                   10950000
109600     END-IF.                                                      10960000
109700                                                                  10970000
109800     SET ASC-SEPR3-SPECIFIED-NO    TO TRUE.                       10980000
109900     IF  ASEPR3L > ZERO                                           10990000
110000         MOVE ASEPR3I              TO ASC-SEPARATOR-3             11000000
110100         SET ASC-SEPR3-SPECIFIED   TO TRUE                        11010000
110200     ELSE                                                         11020000
110300         IF  ASEPR3F = DP015-ERASE-EOF                            11030000
110400             MOVE SPACE            TO ASC-SEPARATOR-3             11040000
110500         END-IF                                                   11050000
110600     END-IF.                                                      11060000
110700                                                                  11070000
110800     SET ASC-SEPR4-SPECIFIED-NO    TO TRUE.                       11080000
110900     IF  ASEPR4L > ZERO                                           11090000
111000         MOVE ASEPR4I              TO ASC-SEPARATOR-4             11100000
111100         SET ASC-SEPR3-SPECIFIED   TO TRUE                        11110000
111200     ELSE                                                         11120000
111300         IF  ASEPR4F = DP015-ERASE-EOF                            11130000
111400             MOVE SPACE            TO ASC-SEPARATOR-4             11140000
111500         END-IF                                                   11150000
111600     END-IF.                                                      11160000
111601                                                                  11160199
111610     IF  APRTBR1L > ZERO                                          11161099
111620         MOVE APRTBR1I             TO ASC-PRINT-BRCDE             11162099
111630     ELSE                                                         11163099
111640         IF APRTBR1F = DP015-ERASE-EOF                            11164099
111650             MOVE SPACE            TO ASC-PRINT-BRCDE             11165099
111660         END-IF                                                   11166099
111670     END-IF.                                                      11167099
111700                                                                  11170000
111800     IF  ACMNT1L > ZERO                                           11180000
111900         MOVE ACMNT1I              TO ASC-LABEL-COMMENTS-1        11190000
112000     ELSE                                                         11200000
112100         IF  ACMNT1F = DP015-ERASE-EOF                            11210000
112200             MOVE SPACE            TO ASC-LABEL-COMMENTS-1        11220000
112300         END-IF                                                   11230000
112400     END-IF.                                                      11240000
112500                                                                  11250000
112600     IF  ACMNT2L > ZERO                                           11260000
112700         MOVE ACMNT2I              TO ASC-LABEL-COMMENTS-2        11270000
112800     ELSE                                                         11280000
112900         IF  ACMNT2F = DP015-ERASE-EOF                            11290000
113000             MOVE SPACE            TO ASC-LABEL-COMMENTS-2        11300000
113100         END-IF                                                   11310000
113200     END-IF.                                                      11320000
113300                                                                  11330000
113400     IF  ACMNT3L > ZERO                                           11340099
113500         MOVE ACMNT3I              TO ASC-LABEL-COMMENTS-3        11350000
113600     ELSE                                                         11360000
113700         IF  ACMNT3F = DP015-ERASE-EOF                            11370000
113800             MOVE SPACE            TO ASC-LABEL-COMMENTS-3        11380000
113900         END-IF                                                   11390000
114000     END-IF.                                                      11400000
114001                                                                  11400199
114100                                                                  11410000
114200 EJECT                                                            11420000
114300*----------------------------------------------------------------*11430000
114400* KOHLS STANDARD NUMERIC EDIT ROUTINE DPKUT100.                  *11440000
114500*----------------------------------------------------------------*11450000
114600 2101-NUMERIC-EDIT-ROUTINE.                                       11460000
114700                                                                  11470000
114800     MOVE +4                     TO DP010I-MAXIMUM-DIGITS.        11480000
114900     MOVE +0                     TO DP010I-MAXIMUM-DECIMALS.      11490000
115000                                                                  11500000
115100     SET DP010I-NEGATIVE-NOT-ALLOWED                              11510000
115200                                 TO TRUE.                         11520000
115300                                                                  11530000
115410     CALL DP010I-NUMERIC-EDIT-ROUTINE                             11541099
115420                         USING DP010I-NUMERIC-EDIT-AREA.          11542099
115500                                                                  11550000
115600 EJECT                                                            11560000
115700*----------------------------------------------------------------*11570000
115800*    ENSURE THAT THE DATA IS CORRECT AND ISSUE APPROPRIATE       *11580000
115900*    ERROR MESSAGES IF NECESSARY.                                *11590000
116000*----------------------------------------------------------------*11600000
116100 2200-EDIT-DATA-IN-COMMAREA.                                      11610000
116200                                                                  11620000
116300     PERFORM 2210-RESET-ATTRIBUTES.                               11630000
116400                                                                  11640000
116500     SET ERROR-ON-OP-UNIT-EDIT TO TRUE.                           11650000
116600     PERFORM 2213-EDIT-OPERATING-UNIT.                            11660000
116700                                                                  11670000
116800     SET ERROR-ON-FACILITY-EDIT TO TRUE.                          11680000
116900     PERFORM 2215-EDIT-FACILITY.                                  11690000
117000                                                                  11700000
117100     SET ERROR-ON-PRINTER-EDIT TO TRUE.                           11710000
117200     PERFORM 2240-EDIT-PRINTER-ID.                                11720000
117201                                                                  11720199
117210     SET ERROR-ON-BARCODE-SWITCH TO TRUE.                         11721099
117220     PERFORM 2245-EDIT-BARCODE-SWITCH.                            11722099
117300                                                                  11730000
117400     INITIALIZE PC140-LABELMST.                                   11740000
117500                                                                  11750000
117600     IF NO-ERROR-ON-FACILITY-EDIT AND                             11760000
117700        NO-ERROR-ON-OP-UNIT-EDIT  AND                             11770000
117800        NO-ERROR-ON-PRINTER-EDIT  AND                             11780099
117810        NO-ERROR-ON-BARCODE-SWITCH                                11781099
117900        MOVE ASC-FCLTY-ID-N       TO PC140-CRA-FACLTY-ID          11790000
118000        PERFORM 2270-VALIDATE-PRINTER                             11800000
118100            IF PS-NO-ERROR                                        11810000
118200               PERFORM 2275-VALIDATE-PRINTER-ID                   11820000
118300               MOVE DP072-XMIT-INTFC-CDE TO PC140-XMIT-INTFC-CDE  11830000
118400               IF PC140-XMIT-INTFC-CDE = PC-F                     11840000
118500                  SET PS-ERROR                TO TRUE             11850000
118600                  SET DP020-MSG-FATAL         TO TRUE             11860000
118700                  MOVE PC-TSYMSG-00746        TO DP020-MSG-NUMBER 11870000
118800                  MOVE DP015-UNP-NUM-BRT-OFF  TO APRTRA           11880000
118900                  MOVE DP015-RED              TO APRTRC           11890000
119000                  MOVE DP015-REVERSE          TO APRTRH           11900000
119100                  MOVE -1                     TO APRTRL           11910000
119200                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             11920000
119300               ELSE                                               11930000
119400                  IF PC140-XMIT-INTFC-CDE = PC-S                  11940000
119500                     CONTINUE                                     11950000
119600                     MOVE DP072-PRTR-LOC-DESC                     11960000
119700                                              TO ASC-PRTR-DESC    11970000
119800                                                 APRDESCO         11980000
119900                  END-IF                                          11990000
120000               END-IF                                             12000000
120100            ELSE                                                  12010000
120200               SET DP030-OVERRIDE-GO   TO TRUE                    12020000
120300               PERFORM 3200-DISPLAY-PANEL                         12030000
120400            END-IF                                                12040000
120500       END-IF.                                                    12050000
120600                                                                  12060000
120700 EJECT                                                            12070000
120800*----------------------------------------------------------------*12080000
120900*   RESET ATTRIBUTES.                                            *12090000
121000*----------------------------------------------------------------*12100000
121100 2210-RESET-ATTRIBUTES.                                           12110000
121200                                                                  12120000
121300      MOVE DP015-UNP-NUM-NOR-OFF TO AOPUNITA                      12130000
121400                                    AFACILA                       12140000
121500                                    APRTRA.                       12150099
121600      MOVE DP015-UNP-NUM-NOR-MDT TO ASETSA.                       12160099
121610      MOVE DP015-UNP-ALP-NOR-MDT TO APRTBR1A.                     12161099
121700      MOVE DP015-UNP-ALP-NOR-OFF TO AQLFR1A                       12170000
121800                                    AQLFR2A                       12180000
121900                                    AQLFR3A                       12190000
122000                                    AQLFR4A                       12200000
122100                                    ASEPR1A                       12210000
122200                                    ASEPR2A                       12220000
122300                                    ASEPR3A                       12230000
122400                                    ASEPR4A                       12240000
122500                                    ACMNT1A                       12250000
122600                                    ACMNT2A                       12260000
122700                                    ACMNT3A.                      12270000
122800      MOVE DP015-UNP-NUM-NOR-OFF TO ARANGE1A                      12280000
122900                                    ARANGE2A                      12290000
123000                                    ARANGE3A                      12300000
123100                                    ARANGE4A.                     12310000
123200      MOVE DP015-GREEN           TO AOPUNITC                      12320000
123300                                    AFACILC                       12330000
123400                                    APRTRC                        12340000
123500                                    ASETSC                        12350000
123600                                    AQLFR1C                       12360000
123700                                    AQLFR2C                       12370000
123800                                    AQLFR3C                       12380000
123900                                    AQLFR4C                       12390000
124000                                    ARANGE1C                      12400000
124100                                    ARANGE2C                      12410000
124200                                    ARANGE3C                      12420000
124300                                    ARANGE4C                      12430000
124400                                    ASEPR1C                       12440000
124500                                    ASEPR2C                       12450000
124600                                    ASEPR3C                       12460000
124700                                    ASEPR4C                       12470000
124710                                    APRTBR1C                      12471099
124800                                    ACMNT1C                       12480000
124900                                    ACMNT2C                       12490000
125000                                    ACMNT3C.                      12500000
125100      MOVE DP015-UNDERLINE       TO AOPUNITH                      12510000
125200                                    AFACILH                       12520000
125300                                    APRTRH                        12530000
125400                                    ASETSH                        12540000
125500                                    AQLFR1H                       12550000
125600                                    AQLFR2H                       12560000
125700                                    AQLFR3H                       12570000
125800                                    AQLFR4H                       12580000
125900                                    ARANGE1H                      12590000
126000                                    ARANGE2H                      12600000
126100                                    ARANGE3H                      12610000
126200                                    ARANGE4H                      12620000
126300                                    ASEPR1H                       12630000
126400                                    ASEPR2H                       12640000
126500                                    ASEPR3H                       12650000
126510                                    APRTBR1H                      12651099
126600                                    ASEPR4H                       12660000
126700                                    ACMNT1H                       12670000
126800                                    ACMNT2H                       12680000
126900                                    ACMNT3H.                      12690000
127000                                                                  12700000
127100 EJECT                                                            12710000
127200*----------------------------------------------------------------*12720000
127300*    EDIT THE OPERATING UNIT                                     *12730000
127400*----------------------------------------------------------------*12740000
127500 2213-EDIT-OPERATING-UNIT.                                        12750000
127600                                                                  12760000
127700     IF ASC-OPER-UNT-ID NOT > SPACES                              12770000
127800         SET PS-ERROR            TO TRUE                          12780000
127900         SET DP020-MSG-FATAL     TO TRUE                          12790000
128000         MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER              12800000
128100         MOVE DP015-UNP-NUM-BRT-OFF                               12810000
128200                                 TO AOPUNITA                      12820000
128300         MOVE DP015-RED          TO AOPUNITC                      12830000
128400         MOVE DP015-REVERSE      TO AOPUNITH                      12840000
128500         MOVE -1                 TO AOPUNITL                      12850000
128600         SET DP030-SET-CURSOR-APPL-1                              12860000
128700                                 TO TRUE                          12870000
128800     ELSE                                                         12880000
128900                                                                  12890000
129000         MOVE ASC-OPER-UNT-ID-N      TO DP010I-UNEDITED-FIELD     12900000
129100         MOVE +4                     TO DP010I-MAXIMUM-DIGITS     12910000
129200         MOVE +0                     TO DP010I-MAXIMUM-DECIMALS   12920000
129300                                                                  12930000
129400         SET DP010I-NEGATIVE-NOT-ALLOWED                          12940000
129500                                     TO TRUE                      12950000
129600                                                                  12960000
129710         CALL DP010I-NUMERIC-EDIT-ROUTINE                         12971099
129720                         USING DP010I-NUMERIC-EDIT-AREA           12972099
129800                                                                  12980000
129900         IF DP010I-NO-ERROR-DETECTED                              12990000
130000             MOVE DP010I-NUMERIC-FIELD                            13000000
130100                                     TO ASC-OPER-UNT-ID-N         13010000
130200                                        PV-SUPPRESS-FOUR          13020000
130300             MOVE PV-SUPPRESS-FOUR   TO AOPUNITO                  13030000
130400             EXEC CICS                                            13040000
130500                  SYNCPOINT                                       13050000
130600             END-EXEC                                             13060000
130700             PERFORM 2214-GET-OP-UNIT-NAME                        13070000
130800             SET NO-ERROR-ON-OP-UNIT-EDIT TO TRUE                 13080000
130900         ELSE                                                     13090000
131000             SET PS-ERROR            TO TRUE                      13100000
131100             SET DP020-MSG-FATAL     TO TRUE                      13110000
131200             MOVE PC-TSYMSG-00008    TO DP020-MSG-NUMBER          13120000
131300             MOVE DP015-UNP-NUM-BRT-OFF                           13130000
131400                                     TO AOPUNITA                  13140000
131500             MOVE DP015-RED          TO AOPUNITC                  13150000
131600             MOVE DP015-REVERSE      TO AOPUNITH                  13160000
131700             MOVE -1                 TO AOPUNITL                  13170000
131800             SET DP030-SET-CURSOR-APPL-1                          13180000
131900                                     TO TRUE                      13190000
132000         END-IF                                                   13200000
132100     END-IF.                                                      13210000
132200                                                                  13220000
132300 EJECT                                                            13230000
132400*----------------------------------------------------------------*13240000
132500* RETRIEVE THE OPERATING UNIT NAME DESCRIPTION.                  *13250000
132600*----------------------------------------------------------------*13260000
132700 2214-GET-OP-UNIT-NAME.                                           13270000
132800                                                                  13280000
132900     MOVE SPACES            TO ASC-OPER-UNT-NME                   13290000
133000     MOVE ASC-OPER-UNT-ID-N TO PC-OPER-UNT-ID                     13300000
133100     MOVE ASC-FCLTY-ID-N    TO PC-FCLTY-ID                        13310000
133200     MOVE ASC-FCLTY-ID-N    TO PC140-CRA-FACLTY-ID                13320000
133300                                                                  13330000
133400     PERFORM                                                      13340000
133500         WITH TEST AFTER                                          13350000
133600         VARYING PV-RETRY-COUNTER                                 13360000
133700         FROM 1 BY 1                                              13370000
133800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               13380000
133900                   OR (SQLCODE = +0)                              13390000
134000                   OR (SQLCODE = +100))                           13400000
134100                                                                  13410000
134200         EXEC SQL                                                 13420000
134300            SELECT  LOC_NM                                        13430099
134400              INTO :XLT00010-LOC-NM                               13440099
134500              FROM  XLT_LOC                                       13450099
134600             WHERE  LOC_NBR  =  :PC-OPER-UNT-ID                   13460099
134800         END-EXEC                                                 13480000
134900                                                                  13490000
135000         EVALUATE TRUE                                            13500000
135100             WHEN SQLCODE = +0                                    13510000
135200                 MOVE XLT00010-LOC-NM  TO ASC-OPER-UNT-NME        13520099
135300                                          AOPDESCO                13530000
135400             WHEN SQLCODE = +100                                  13540000
135500                 MOVE SPACES           TO ASC-OPER-UNT-NME        13550000
135600                                          AOPDESCO                13560000
135700             WHEN SQLCODE = -811                                  13570000
135800             WHEN SQLCODE = -904                                  13580000
135900             WHEN SQLCODE = -913                                  13590000
136000                 CONTINUE                                         13600000
136100             WHEN SQLWARN0 NOT = SPACES                           13610000
136200             WHEN SQLCODE < +0                                    13620000
136300             WHEN SQLCODE > +0                                    13630000
136400                 MOVE '2214-GET-OP-UNIT-NAME'                     13640000
136500                                 TO DP013-PARAGRAPH               13650000
136600                 MOVE 'SELECT STORE NUMBER'                       13660000
136700                                 TO DP013-MESSAGE-TEXT (1)        13670000
136800                 MOVE SQLCA      TO DP013-SQLCA                   13680000
136900                 MOVE 'XLT_LOC'  TO DP013-DB2-TABLE-NAME (1)      13690099
137000                 SET DP013-DB2-ABEND                              13700000
137100                                 TO TRUE                          13710000
137200                 SET DP013-XCTL-DISPLAY-RESTART                   13720000
137300                                 TO TRUE                          13730000
137400                 PERFORM DP013-0000-PROCESS-ABEND                 13740000
137500         END-EVALUATE                                             13750000
137600     END-PERFORM.                                                 13760000
137700                                                                  13770000
137800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        13780000
137900         MOVE '2214-GET-OP-UNIT-NAME'                             13790000
138000                                 TO DP013-PARAGRAPH               13800000
138100         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     13810000
138200                                 TO DP013-MESSAGE-TEXT (1)        13820000
138300         MOVE 'STORE NUMBER  '   TO DP013-MESSAGE-TEXT (2)        13830000
138400         MOVE SQLCA              TO DP013-SQLCA                   13840000
138500         MOVE 'XLT_LOC'          TO DP013-DB2-TABLE-NAME (1)      13850099
138600         SET DP013-DB2-ABEND     TO TRUE                          13860000
138700         SET DP013-XCTL-DISPLAY-RESTART                           13870000
138800                                 TO TRUE                          13880000
138900         PERFORM DP013-0000-PROCESS-ABEND                         13890000
139000     END-IF.                                                      13900000
139100                                                                  13910000
139200 EJECT                                                            13920000
139300*----------------------------------------------------------------*13930000
139400*    EDIT THE FACILITY                                           *13940000
139500*----------------------------------------------------------------*13950000
139600 2215-EDIT-FACILITY.                                              13960000
139700                                                                  13970000
139800     IF ASC-FCLTY-ID    NOT > SPACES                              13980000
139900         SET PS-ERROR            TO TRUE                          13990000
140000         SET DP020-MSG-FATAL     TO TRUE                          14000000
140100         MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER              14010000
140200         MOVE DP015-UNP-NUM-BRT-OFF                               14020000
140300                                 TO AFACILA                       14030000
140400         MOVE DP015-RED          TO AFACILC                       14040000
140500         MOVE DP015-REVERSE      TO AFACILH                       14050000
140600         MOVE -1                 TO AFACILL                       14060000
140700         SET DP030-SET-CURSOR-APPL-1                              14070000
140800                                 TO TRUE                          14080000
140900     ELSE                                                         14090000
141000         MOVE ASC-FCLTY-ID-N         TO DP010I-UNEDITED-FIELD     14100000
141100         MOVE +4                     TO DP010I-MAXIMUM-DIGITS     14110000
141200         MOVE +0                     TO DP010I-MAXIMUM-DECIMALS   14120000
141300                                                                  14130000
141400         SET DP010I-NEGATIVE-NOT-ALLOWED                          14140000
141500                                     TO TRUE                      14150000
141600                                                                  14160000
141710         CALL DP010I-NUMERIC-EDIT-ROUTINE                         14171099
141720                         USING DP010I-NUMERIC-EDIT-AREA           14172099
141800                                                                  14180000
141900         IF DP010I-NO-ERROR-DETECTED                              14190000
142000             MOVE DP010I-NUMERIC-FIELD                            14200000
142100                                     TO ASC-FCLTY-ID-N            14210000
142200                                        PV-SUPPRESS-FOUR          14220000
142300             MOVE PV-SUPPRESS-FOUR   TO AFACILO                   14230000
142400             SET NO-ERROR-ON-FACILITY-EDIT TO TRUE                14240000
142500         ELSE                                                     14250000
142600             SET PS-ERROR            TO TRUE                      14260000
142700             SET DP020-MSG-FATAL     TO TRUE                      14270000
142800             MOVE PC-TSYMSG-00008    TO DP020-MSG-NUMBER          14280000
142900             MOVE DP015-UNP-NUM-BRT-OFF                           14290000
143000                                     TO AFACILA                   14300000
143100             MOVE DP015-RED          TO AFACILC                   14310000
143200             MOVE DP015-REVERSE      TO AFACILH                   14320000
143300             MOVE -1                 TO AFACILL                   14330000
143400             SET DP030-SET-CURSOR-APPL-1                          14340000
143500                                     TO TRUE                      14350000
143600         END-IF                                                   14360000
143700     END-IF.                                                      14370000
143800                                                                  14380000
143900*----------------------------------------------------------------*14390000
144000*    CHECK THE PRINTER NUMBER FOR NUMERIC                        *14400000
144100*----------------------------------------------------------------*14410000
144200 2240-EDIT-PRINTER-ID.                                            14420000
144300                                                                  14430000
144400     IF ASC-PRTR-ID     NOT > SPACES                              14440000
144500         SET PS-ERROR            TO TRUE                          14450000
144600         SET DP020-MSG-FATAL     TO TRUE                          14460000
144700         MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER              14470000
144800         MOVE DP015-UNP-NUM-BRT-OFF                               14480000
144900                                 TO APRTRA                        14490000
145000         MOVE DP015-RED          TO APRTRC                        14500000
145100         MOVE DP015-REVERSE      TO APRTRH                        14510000
145200         MOVE -1                 TO APRTRL                        14520000
145300         SET DP030-SET-CURSOR-APPL-1                              14530000
145400                                 TO TRUE                          14540000
145500     ELSE                                                         14550000
145600         MOVE ASC-PRTR-ID            TO DP010I-UNEDITED-FIELD     14560000
145700         MOVE +3                     TO DP010I-MAXIMUM-DIGITS     14570000
145800         MOVE +0                     TO DP010I-MAXIMUM-DECIMALS   14580000
145900                                                                  14590000
146000         SET DP010I-NEGATIVE-NOT-ALLOWED                          14600000
146100                                     TO TRUE                      14610000
146200                                                                  14620000
146310         CALL DP010I-NUMERIC-EDIT-ROUTINE                         14631099
146320                         USING DP010I-NUMERIC-EDIT-AREA           14632099
146400                                                                  14640000
146500         IF DP010I-ERROR-DETECTED                                 14650000
146600             SET PS-ERROR            TO TRUE                      14660000
146700             SET DP020-MSG-FATAL     TO TRUE                      14670000
146800             MOVE PC-TSYMSG-00008    TO DP020-MSG-NUMBER          14680000
146900             MOVE DP015-UNP-NUM-BRT-OFF                           14690000
147000                                     TO APRTRA                    14700000
147100             MOVE DP015-RED          TO APRTRC                    14710000
147200             MOVE DP015-REVERSE      TO APRTRH                    14720000
147300             MOVE -1                 TO APRTRL                    14730000
147400             SET DP030-SET-CURSOR-APPL-1                          14740000
147500                                     TO TRUE                      14750000
147600         ELSE                                                     14760000
147700             MOVE DP010I-NUMERIC-FIELD                            14770000
147800                                     TO ASC-PRTR-ID-N             14780000
147900             MOVE ASC-PRTR-ID        TO APRTRO                    14790000
148000             SET NO-ERROR-ON-PRINTER-EDIT TO TRUE                 14800000
148100         END-IF                                                   14810000
148200     END-IF.                                                      14820000
148300                                                                  14830000
148400 EJECT                                                            14840000
148410*----------------------------------------------------------------*14841099
148420*    CHECK THE BARCODE FOR 'Y' OR 'N'                            *14842099
148430*----------------------------------------------------------------*14843099
148440 2245-EDIT-BARCODE-SWITCH.                                        14844099
148450                                                                  14845099
148460     IF ASC-PRINT-BRCDE NOT > SPACES                              14846099
148470         SET PS-ERROR            TO TRUE                          14847099
148480         SET DP020-MSG-FATAL     TO TRUE                          14848099
148490         MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER              14849099
148491         MOVE DP015-UNP-NUM-BRT-OFF                               14849199
148492                                 TO APRTBR1A                      14849299
148493         MOVE DP015-RED          TO APRTBR1C                      14849399
148494         MOVE DP015-REVERSE      TO APRTBR1H                      14849499
148495         MOVE -1                 TO APRTBR1L                      14849599
148496         SET DP030-SET-CURSOR-APPL-1                              14849699
148497                                 TO TRUE                          14849799
148498     ELSE                                                         14849899
148499         IF ASC-PRINT-BRCDE =  (PC-Y OR PC-N)                     14849999
148500                                                                  14850099
148501             SET NO-ERROR-ON-BARCODE-SWITCH TO TRUE               14850199
148507                                                                  14850799
148508         ELSE                                                     14850899
148509             SET PS-ERROR            TO TRUE                      14850999
148510             SET DP020-MSG-FATAL     TO TRUE                      14851099
148511             MOVE PC-TSYMSG-00005    TO DP020-MSG-NUMBER          14851199
148512             MOVE DP015-UNP-NUM-BRT-OFF                           14851299
148513                                     TO APRTBR1A                  14851399
148514             MOVE DP015-RED          TO APRTBR1C                  14851499
148515             MOVE DP015-REVERSE      TO APRTBR1H                  14851599
148516             MOVE -1                 TO APRTBR1L                  14851699
148517             SET DP030-SET-CURSOR-APPL-1                          14851799
148518                                     TO TRUE                      14851899
148524         END-IF                                                   14852499
148525     END-IF.                                                      14852599
148526                                                                  14852699
148530*----------------------------------------------------------------*14853000
148600* RESET THE FREE FORM TEXT SWITCHES                              *14860000
148700*----------------------------------------------------------------*14870000
148800 2250-RESET-FREE-FORM-SWITCHES.                                   14880000
148900                                                                  14890000
149000     SET ASC-QLFR1-SPECIFIED-NO    TO TRUE.                       14900000
149100     SET ASC-QLFR1-IS-NUMERIC-NO   TO TRUE.                       14910000
149200                                                                  14920000
149300     SET ASC-QLFR2-SPECIFIED-NO    TO TRUE.                       14930000
149400     SET ASC-QLFR2-IS-NUMERIC-NO   TO TRUE.                       14940000
149500                                                                  14950000
149600     SET ASC-QLFR3-SPECIFIED-NO    TO TRUE.                       14960000
149700     SET ASC-QLFR3-IS-NUMERIC-NO   TO TRUE.                       14970000
149800                                                                  14980000
149900     SET ASC-QLFR4-SPECIFIED-NO    TO TRUE.                       14990000
150000     SET ASC-QLFR4-IS-NUMERIC-NO   TO TRUE.                       15000000
150100                                                                  15010000
150200     SET ASC-RANGE-REQUESTED-NO    TO TRUE.                       15020000
150300     SET ASC-RANGE-VALID-NO        TO TRUE.                       15030000
150400                                                                  15040000
150500     SET ASC-RANGE1-SPECIFIED-NO   TO TRUE.                       15050000
150600     SET ASC-RANGE1-IS-NUMERIC-NO  TO TRUE.                       15060000
150700                                                                  15070000
150800     SET ASC-RANGE2-SPECIFIED-NO   TO TRUE.                       15080000
150900     SET ASC-RANGE2-IS-NUMERIC-NO  TO TRUE.                       15090000
151000                                                                  15100000
151100     SET ASC-RANGE3-SPECIFIED-NO   TO TRUE.                       15110000
151200     SET ASC-RANGE3-IS-NUMERIC-NO  TO TRUE.                       15120000
151300                                                                  15130000
151400     SET ASC-RANGE4-SPECIFIED-NO   TO TRUE.                       15140000
151500     SET ASC-RANGE4-IS-NUMERIC-NO  TO TRUE.                       15150000
151600                                                                  15160000
151700     SET ASC-RANGE-IS-ON-LINE-1-NO TO TRUE.                       15170000
151800     SET ASC-RANGE-IS-ON-LINE-2-NO TO TRUE.                       15180000
151900     SET ASC-RANGE-IS-ON-LINE-3-NO TO TRUE.                       15190000
152000     SET ASC-RANGE-IS-ON-LINE-4-NO TO TRUE.                       15200000
152100                                                                  15210000
152200     SET ASC-SEPR1-SPECIFIED-NO    TO TRUE.                       15220000
152300                                                                  15230000
152400     SET ASC-SEPR2-SPECIFIED-NO    TO TRUE.                       15240000
152500                                                                  15250000
152600     SET ASC-SEPR3-SPECIFIED-NO    TO TRUE.                       15260000
152700                                                                  15270000
152800     SET ASC-SEPR4-SPECIFIED-NO    TO TRUE.                       15280000
152900                                                                  15290000
153000 EJECT                                                            15300000
153100*----------------------------------------------------------------*15310000
153200*NOTE: SOME OF THESE EDITS MIGHT SEEM REDUNDANT, BUT WE REALLY   *15320000
153300*      DON'T KNOW WHAT TO EXPECT IN THIS FREE FORM TEXT AREA, SO *15330000
153400*      THE EDITS HAVE TO BE REPEATED FOR EVERY POSSIBLE          *15340000
153500*      QUALIFIER/RANGE LINE CONBINATION (4). BE CAREFUL IF       *15350000
153600*      ADDING ANY SUBSEQUENT EDITS BECAUSE EACH EDIT MAKES       *15360000
153700*      ASSUMPTIONS BASED UPON THE PREVIOUS EDIT (SET OF IF'S).   *15370000
153800*----------------------------------------------------------------*15380000
153900*  1) DETERMINE IF A RANGE WAS SPECIFIED. ONLY 1 IS ALLOWED.     *15390000
154000*  2) THE RANGE MUST BE A POSITIVE INTEGER (GREATER THAN ZERO).  *15400000
154100*  3) DETERMINE UPON WHICH FREE FORM LINE (POSITION) THE VALID   *15410000
154200*     RANGE OCCURS, IN ORDER TO LOOP CORRECTLY IN THE SOCKET     *15420000
154300*     PROGRAM.                                                   *15430000
154400*  4) A VALID RANGE HAS A BEGINNING AND AN END. THE END CAN NOT  *15440000
154500*     NUMERICALLY PRECEDE THE BEGINNING.                         *15450000
154600* -------------------------------------------------------------- *15460000
154700*  EXAMPLE OF RANGE OCCURRING IN A VARIABLE POSITION OF THE      *15470000
154800*  FREE FORM TEXT ENTERED BY THE USER. (SCREEN SAMPLE BELOW)     *15480000
154900* -------------------------------------------------------------- *15490000
155000*                                                                *15500000
155100*                      OPERATING UNIT.:  ____                    *15510000
155200*                      FACILITY.......:  ____                    *15520000
155300*                      PRINTER NUMBER.:   ___                    *15530000
155400*                      SETS OF LABELS.:   __1                    *15540000
155500*                                                                *15550000
155600*  QUALIFIER     RANGE (IF NUMERIC)  SEPARATOR (FOR PRINTING)    *15560000
155700*                                                                *15570000
155800*  A___________  ____________           *                        *15580000
155900*  DOOR________  ____________           =                        *15590000
156000*  1___________  14__________           _                        *15600000
156100*  ____________  ____________           _                        *15610000
156200*                                                                *15620000
156300*                                                                *15630000
156400*  LABEL COMMENTS                                                *15640000
156500*                                                                *15650000
156600*  ______________________________                                *15660000
156700*  ______________________________                                *15670000
156800*  ______________________________                                *15680000
156900*                                                                *15690000
157000*----------------------------------------------------------------*15700000
157100* THE RESULTS WOULD BE AS FOLLOWS:                               *15710000
157200*                                                                *15720000
157300*  14 LABELS WOULD BE PRINTED. THE HUMAN READABLE PORTION        *15730000
157400*  WHICH IS THE HORIZONTAL LINE CONTAINING SEPARATORS WOULD      *15740000
157500*  BE :                                                          *15750000
157600*                                                                *15760000
157700*      A*DOOR=0001                                               *15770000
157800*                .         (NOTE: THE NUMBER FROM THE SPECIFIED  *15780000
157900*                .                RANGE BEGINS IN POSITION 8 OF  *15790000
158000*                .                THE 20 POSSIBLE POSITIONS OF   *15800000
158100*      A*DOOR=0014                THE HR PORTION OF THE LABEL.   *15810000
158200*                                 THE BARCODE WILL LOOK LIKE:    *15820000
158300*                                      ADOOR0001                 *15830000
158400*                                              .                 *15840000
158500*                                              .                 *15850000
158600*                                      ADOOR0014                 *15860000
158700*                                                                *15870000
158800*                                 THE RANGE NUMBER BEGINS IN     *15880000
158900*                                 POSITION 6 OF THE 12 POSSIBLE  *15890000
159000*                                 POSITIONS OF THE BARCODE       *15900000
159100*                                 PORTION OF THE LABEL.          *15910000
159200*----------------------------------------------------------------*15920000
159300*  THIS IS A SECOND EXAMPLE BELOW                                *15930000
159400*----------------------------------------------------------------*15940000
159500*                      OPERATING UNIT.:  ____                    *15950000
159600*                      FACILITY.......:  ____                    *15960000
159700*                      PRINTER NUMBER.:   ___                    *15970000
159800*                      SETS OF LABELS.:   __3                    *15980000
159900*                                                                *15990000
160000*  QUALIFIER     RANGE (IF NUMERIC)  SEPARATOR (FOR PRINTING)    *16000000
160100*                                                                *16010000
160200*  A___________  ____________           *                        *16020000
160300*  001_________  020_________           *                        *16030000
160400*  RCV_________  ____________           _                        *16040000
160500*  STG_________  ____________           _                        *16050000
160600*                                                                *16060000
160700*                                                                *16070000
160800*  LABEL COMMENTS                                                *16080000
160900*                                                                *16090000
161000*  ______________________________                                *16100000
161100*  ______________________________                                *16110000
161200*  ______________________________                                *16120000
161300*                                                                *16130000
161400*----------------------------------------------------------------*16140000
161500* THE RESULTS WOULD BE AS FOLLOWS:                               *16150000
161600*                                                                *16160000
161700*  60 LABELS WOULD BE PRINTED. THE HUMAN READABLE PORTION        *16170000
161800*  WHICH IS THE HORIZONTAL LINE CONTAINING SEPARATORS WOULD      *16180000
161900*  BE :                                                          *16190000
162000*       A*0001*RCVSTG               (NOTE: NO SEPARATOR BETWEEN  *16200000
162100*          .                               RCV AND STG)          *16210000
162200*          .                                                     *16220000
162300*          .                                                     *16230000
162400*       A*0020*RCVSTG                                            *16240000
162500*                                                                *16250000
162600*  20 LABELS WOULD BE PRINTED X 3 SETS = 60 TOTAL LABELS.        *16260000
162700*  (NOTE: HERE THE RANGE NUMBER IS IN POSITION 3 OF 20 POSSIBLE  *16270000
162800*  POSITIONS.  THIS IS IMPORTANT TO KNOW WHEN STRINGING THE      *16280000
162900*  FIELDS TOGETHER FOR THE HR AND BAR CODE PORTION OF THE        *16290000
163000*  LABEL AND FOR LOOPING IN THE SOCKET PROGRAM.                  *16300000
163100*----------------------------------------------------------------*16310000
163200*    MORE THAN 1 NUMERIC QUALIFIER SPECIFIED IS OKAY             *16320000
163300*    AS LONG AS IT IS NOT COUPLED WITH MORE THAN 1               *16330000
163400*    CORRESPONDING NUMERIC RANGE VALUE, BECAUSE ONLY             *16340000
163500*    1 RANGE WILL BE ALLOWED. NUMERIC QUALIFIERS WITHOUT         *16350000
163600*    A CORRESPONDING NUMERIC RANGE VALUE WILL BE                 *16360000
163700*    TREATED AS TEXT ENTERED. SO WHEN NUMERICS ARE               *16370000
163800*    COUPLED IN TWO CORRESPONDING FIELDS, THEY MAKE              *16380000
163900*    UP A 'SPECIFIED RANGE'.                                     *16390000
164000*----------------------------------------------------------------*16400000
164100 2260-CHECK-FOR-VALID-RANGE.                                      16410000
164200                                                                  16420000
164300**** THIS NEEDS TO BE CHECKED IF THE SCREEN WAS                   16430000
164400**** PREVIOUSLY SENT BACK TO THE USER, WITH AN ERROR              16440000
164500**** BECAUSE CHECKING THE "LENGTH" OF THE BMS RANGE               16450000
164600**** INPUT FIELD WILL BE LESS THAN ZERO THE SECOND TIME           16460000
164700**** AROUND IF THE USER ONLY HAD TO ENTER A QUALIFIER             16470000
164800**** AND A RANGE VALUE WAS STILL LEFT FROM 'BEFORE'               16480000
164900     IF   ASC-RANGE-1 > SPACE                                     16490000
165000          SET ASC-RANGE1-SPECIFIED  TO TRUE                       16500000
165100     END-IF.                                                      16510000
165200     IF   ASC-RANGE-2 > SPACE                                     16520000
165300          SET ASC-RANGE2-SPECIFIED  TO TRUE                       16530000
165400     END-IF.                                                      16540000
165500     IF   ASC-RANGE-3 > SPACE                                     16550000
165600          SET ASC-RANGE3-SPECIFIED  TO TRUE                       16560000
165700     END-IF.                                                      16570000
165800     IF   ASC-RANGE-4 > SPACE                                     16580000
165900          SET ASC-RANGE4-SPECIFIED  TO TRUE                       16590000
166000     END-IF.                                                      16600000
166100                                                                  16610000
166200**** THIS NEEDS TO BE CHECKED IF THE SCREEN WAS                   16620000
166300**** PREVIOUSLY SENT BACK TO THE USER, WITH AN ERROR              16630000
166400**** BECAUSE CHECKING THE "LENGTH" OF THE BMS RANGE               16640000
166500**** INPUT FIELD WILL BE LESS THAN ZERO THE SECOND TIME           16650000
166600**** AROUND IF THE USER ONLY HAD TO ENTER A QUALIFIER             16660000
166700**** AND A RANGE VALUE WAS STILL LEFT FROM 'BEFORE'               16670000
166800     IF   ASC-RANGE-1 > SPACE                                     16680000
166900          INITIALIZE DP010I-UNEDITED-FIELD                        16690000
167000          MOVE ASC-RANGE-1             TO DP010I-UNEDITED-FIELD   16700000
167100          PERFORM 2101-NUMERIC-EDIT-ROUTINE                       16710000
167200          IF DP010I-NUM-FIELD-17-DIG-0-DEC > 0                    16720000
167300             SET ASC-RANGE1-IS-NUMERIC TO TRUE                    16730000
167400          END-IF                                                  16740000
167500     END-IF.                                                      16750000
167600     IF   ASC-RANGE-2 > SPACE                                     16760000
167700          INITIALIZE DP010I-UNEDITED-FIELD                        16770000
167800          MOVE ASC-RANGE-2             TO DP010I-UNEDITED-FIELD   16780000
167900          PERFORM 2101-NUMERIC-EDIT-ROUTINE                       16790000
168000          IF DP010I-NUM-FIELD-17-DIG-0-DEC > 0                    16800000
168100             SET ASC-RANGE2-IS-NUMERIC TO TRUE                    16810000
168200          END-IF                                                  16820000
168300     END-IF.                                                      16830000
168400     IF   ASC-RANGE-3 > SPACE                                     16840000
168500          INITIALIZE DP010I-UNEDITED-FIELD                        16850000
168600          MOVE ASC-RANGE-3             TO DP010I-UNEDITED-FIELD   16860000
168700          PERFORM 2101-NUMERIC-EDIT-ROUTINE                       16870000
168800          IF DP010I-NUM-FIELD-17-DIG-0-DEC > 0                    16880000
168900             SET ASC-RANGE3-IS-NUMERIC TO TRUE                    16890000
169000          END-IF                                                  16900000
169100     END-IF.                                                      16910000
169200     IF   ASC-RANGE-4 > SPACE                                     16920000
169300          INITIALIZE DP010I-UNEDITED-FIELD                        16930000
169400          MOVE ASC-RANGE-4             TO DP010I-UNEDITED-FIELD   16940000
169500          PERFORM 2101-NUMERIC-EDIT-ROUTINE                       16950000
169600          IF DP010I-NUM-FIELD-17-DIG-0-DEC > 0                    16960000
169700             SET ASC-RANGE4-IS-NUMERIC TO TRUE                    16970000
169800          END-IF                                                  16980000
169900     END-IF.                                                      16990000
170000                                                                  17000000
170100**** CHECK TO SEE IF AT LEAST ONE VALUE                           17010000
170200**** WAS SPECIFIED IN THE RANGE FIELDS                            17020000
170300**** ( USER INTENDS TO USE A RANGE)                               17030000
170400     IF  ((ASC-RANGE1-SPECIFIED OR ASC-RANGE-1 > SPACE)           17040000
170500                   OR                                             17050000
170600          (ASC-RANGE2-SPECIFIED OR ASC-RANGE-2 > SPACE)           17060000
170700                   OR                                             17070000
170800          (ASC-RANGE3-SPECIFIED OR ASC-RANGE-3 > SPACE)           17080000
170900                   OR                                             17090000
171000          (ASC-RANGE4-SPECIFIED OR ASC-RANGE-4 > SPACE))          17100000
171100                                                                  17110000
171200          SET ASC-RANGE-REQUESTED  TO TRUE                        17120000
171300     END-IF.                                                      17130000
171400                                                                  17140000
171500**** THIS NEEDS TO BE CHECKED IF THE SCREEN WAS                   17150000
171600**** PREVIOUSLY SENT BACK TO THE USER, WITH AN ERROR              17160000
171700**** BECAUSE CHECKING THE "LENGTH" OF THE BMS RANGE               17170000
171800**** INPUT FIELD WILL BE LESS THAN ZERO THE SECOND TIME           17180000
171900**** AROUND IF THE USER ONLY HAD TO ENTER A QUALIFIER             17190000
172000**** AND A RANGE VALUE WAS STILL LEFT FROM 'BEFORE'               17200000
172100     IF  ASC-RANGE-1 > SPACE                                      17210000
172200         ADD +1 TO ASC-RANGE-FIELD-CNTR                           17220000
172300     END-IF.                                                      17230000
172400     IF  ASC-RANGE-2 > SPACE                                      17240000
172500         ADD +1 TO ASC-RANGE-FIELD-CNTR                           17250000
172600     END-IF.                                                      17260000
172700     IF  ASC-RANGE-3 > SPACE                                      17270000
172800         ADD +1 TO ASC-RANGE-FIELD-CNTR                           17280000
172900     END-IF.                                                      17290000
173000     IF  ASC-RANGE-4 > SPACE                                      17300000
173100         ADD +1 TO ASC-RANGE-FIELD-CNTR                           17310000
173200     END-IF.                                                      17320000
173300                                                                  17330000
173400**** THIS NEEDS TO BE CHECKED IF THE SCREEN WAS                   17340000
173500**** PREVIOUSLY SENT BACK TO THE USER, WITH AN ERROR              17350000
173600**** BECAUSE CHECKING THE "LENGTH" OF THE BMS RANGE               17360000
173700**** INPUT FIELD WILL BE LESS THAN ZERO THE SECOND TIME           17370000
173800**** AROUND IF THE USER ONLY HAD TO ENTER A RANGE                 17380000
173900**** AND A QUALIFIER VALUE WAS STILL LEFT FROM 'BEFORE'           17390000
174000     IF   ASC-QUALIFIER-1 > SPACE                                 17400000
174100          SET ASC-QLFR1-SPECIFIED  TO TRUE                        17410000
174200     END-IF.                                                      17420000
174300     IF   ASC-QUALIFIER-2 > SPACE                                 17430000
174400          SET ASC-QLFR2-SPECIFIED  TO TRUE                        17440000
174500     END-IF.                                                      17450000
174600     IF   ASC-QUALIFIER-3 > SPACE                                 17460000
174700          SET ASC-QLFR3-SPECIFIED  TO TRUE                        17470000
174800     END-IF.                                                      17480000
174900     IF   ASC-QUALIFIER-4 > SPACE                                 17490000
175000          SET ASC-QLFR4-SPECIFIED  TO TRUE                        17500000
175100     END-IF.                                                      17510000
175200                                                                  17520000
175300**** THIS NEEDS TO BE CHECKED IF THE SCREEN WAS                   17530000
175400**** PREVIOUSLY SENT BACK TO THE USER, WITH AN ERROR              17540000
175500**** BECAUSE CHECKING THE "LENGTH" OF THE BMS RANGE               17550000
175600**** INPUT FIELD WILL BE LESS THAN ZERO THE SECOND TIME           17560000
175700**** AROUND IF THE USER ONLY HAD TO ENTER A RANGE                 17570000
175800**** AND A QUALIFIER VALUE WAS STILL LEFT FROM 'BEFORE'           17580000
175900     IF   ASC-QUALIFIER-1 > SPACE                                 17590000
176000          INITIALIZE DP010I-UNEDITED-FIELD                        17600000
176100          MOVE ASC-QUALIFIER-1         TO DP010I-UNEDITED-FIELD   17610000
176200          PERFORM 2101-NUMERIC-EDIT-ROUTINE                       17620000
176300          IF DP010I-NUM-FIELD-17-DIG-0-DEC > 0                    17630000
176400             SET ASC-QLFR1-IS-NUMERIC  TO TRUE                    17640000
176500          END-IF                                                  17650000
176600     END-IF.                                                      17660000
176700     IF   ASC-QUALIFIER-2 > SPACE                                 17670000
176800          INITIALIZE DP010I-UNEDITED-FIELD                        17680000
176900          MOVE ASC-QUALIFIER-2         TO DP010I-UNEDITED-FIELD   17690000
177000          PERFORM 2101-NUMERIC-EDIT-ROUTINE                       17700000
177100          IF DP010I-NUM-FIELD-17-DIG-0-DEC > 0                    17710000
177200             SET ASC-QLFR2-IS-NUMERIC  TO TRUE                    17720000
177300          END-IF                                                  17730000
177400     END-IF.                                                      17740000
177500     IF   ASC-QUALIFIER-3 > SPACE                                 17750000
177600          INITIALIZE DP010I-UNEDITED-FIELD                        17760000
177700          MOVE ASC-QUALIFIER-3         TO DP010I-UNEDITED-FIELD   17770000
177800          PERFORM 2101-NUMERIC-EDIT-ROUTINE                       17780000
177900          IF DP010I-NUM-FIELD-17-DIG-0-DEC > 0                    17790000
178000             SET ASC-QLFR3-IS-NUMERIC  TO TRUE                    17800000
178100          END-IF                                                  17810000
178200     END-IF.                                                      17820000
178300     IF   ASC-QUALIFIER-4 > SPACE                                 17830000
178400          INITIALIZE DP010I-UNEDITED-FIELD                        17840000
178500          MOVE ASC-QUALIFIER-4         TO DP010I-UNEDITED-FIELD   17850000
178600          PERFORM 2101-NUMERIC-EDIT-ROUTINE                       17860000
178700          IF DP010I-NUM-FIELD-17-DIG-0-DEC > 0                    17870000
178800             SET ASC-QLFR4-IS-NUMERIC  TO TRUE                    17880000
178900          END-IF                                                  17890000
179000     END-IF.                                                      17900000
179100                                                                  17910000
179200**** THIS NEEDS TO BE CHECKED IF THE SCREEN WAS                   17920000
179300**** PREVIOUSLY SENT BACK TO THE USER, WITH AN ERROR              17930000
179400**** BECAUSE CHECKING THE "LENGTH" OF THE BMS RANGE               17940000
179500**** INPUT FIELD WILL BE LESS THAN ZERO THE SECOND TIME           17950000
179600**** AROUND IF THE USER ONLY HAD TO ENTER A RANGE                 17960000
179700**** AND A QUALIFIER VALUE WAS STILL LEFT FROM 'BEFORE'           17970000
179800     IF  ASC-QLFR1-IS-NUMERIC                                     17980000
179900         ADD +1 TO ASC-NUMERIC-QLFR-FIELD-CNTR                    17990000
180000     END-IF.                                                      18000000
180100     IF  ASC-QLFR2-IS-NUMERIC                                     18010000
180200         ADD +1 TO ASC-NUMERIC-QLFR-FIELD-CNTR                    18020000
180300     END-IF.                                                      18030000
180400     IF  ASC-QLFR3-IS-NUMERIC                                     18040000
180500         ADD +1 TO ASC-NUMERIC-QLFR-FIELD-CNTR                    18050000
180600     END-IF.                                                      18060000
180700     IF  ASC-QLFR4-IS-NUMERIC                                     18070000
180800         ADD +1 TO ASC-NUMERIC-QLFR-FIELD-CNTR                    18080000
180900     END-IF.                                                      18090000
181000                                                                  18100000
181100**** NOW DETERMINE WHICH NUMERIC QUALIFIER IS                     18110000
181200**** PAIRED WITH THE SINGLE RANGE VALUE                           18120000
181300     IF  (ASC-RANGE-FIELD-CNTR = +1 AND                           18130000
181400          ASC-RANGE1-SPECIFIED      AND                           18140000
181500          ASC-QLFR1-SPECIFIED       AND                           18150000
181600          ASC-QLFR1-IS-NUMERIC)                                   18160000
181700          SET ASC-RANGE-IS-ON-LINE-1   TO TRUE                    18170000
181800     END-IF.                                                      18180000
181900     IF  (ASC-RANGE-FIELD-CNTR = +1 AND                           18190000
182000          ASC-RANGE2-SPECIFIED      AND                           18200000
182100          ASC-QLFR2-SPECIFIED       AND                           18210000
182200          ASC-QLFR2-IS-NUMERIC)                                   18220000
182300          SET ASC-RANGE-IS-ON-LINE-2   TO TRUE                    18230000
182400     END-IF.                                                      18240000
182500     IF  (ASC-RANGE-FIELD-CNTR = +1 AND                           18250000
182600          ASC-RANGE3-SPECIFIED      AND                           18260000
182700          ASC-QLFR3-SPECIFIED       AND                           18270000
182800          ASC-QLFR3-IS-NUMERIC)                                   18280000
182900          SET ASC-RANGE-IS-ON-LINE-3   TO TRUE                    18290000
183000     END-IF.                                                      18300000
183100     IF  (ASC-RANGE-FIELD-CNTR = +1 AND                           18310000
183200          ASC-RANGE4-SPECIFIED      AND                           18320000
183300          ASC-QLFR4-SPECIFIED       AND                           18330000
183400          ASC-QLFR4-IS-NUMERIC)                                   18340000
183500          SET ASC-RANGE-IS-ON-LINE-4   TO TRUE                    18350000
183600     END-IF.                                                      18360000
183700                                                                  18370000
183800**** MAKE SURE THAT 1 (AND ONLY ONE) NUMERIC RANGE VALUE          18380000
183900**** HAS BEEN SPECIFIED OR SEND A                                 18390000
184000**** (55) "ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED" MSG. 18400000
184100****    ELSE                                                      18410000
184200**** MAKE SURE THAT 1 (AND ONLY ONE) NUMERIC QUALIFIER IS PAIRED  18420000
184300**** WITH A CORRESPONDING NUMERIC RANGE VALUE OR SEND A           18430000
184400**** (53) "NO START OF RANGE VALUE HAS BEEN SPECIFIED"  MSG.      18440000
184500**** POSITION THE CURSOR TO THE QUALIFIER OPPOSITE THE SPECIFIED  18450000
184600**** NUMERIC RANGE VALUE.                                         18460000
184700     IF  ASC-RANGE-FIELD-CNTR > +1                                18470000
184800         IF ((ASC-RANGE4-SPECIFIED)      AND                      18480000
184900             (ASC-RANGE4-IS-NUMERIC))                             18490000
185000              SET PS-ERROR            TO TRUE                     18500000
185100              SET DP020-MSG-FATAL     TO TRUE                     18510000
185200              MOVE PC-TSYMSG-00055    TO DP020-MSG-NUMBER         18520000
185300              MOVE DP015-UNP-ALP-BRT-OFF                          18530000
185400                                      TO ARANGE4A                 18540000
185500              MOVE DP015-RED          TO ARANGE4C                 18550000
185600              MOVE DP015-REVERSE      TO ARANGE4H                 18560000
185700              MOVE -1                 TO ARANGE4L                 18570000
185800              SET DP030-SET-CURSOR-APPL-1                         18580000
185900                                      TO TRUE                     18590000
186000              MOVE LOW-VALUES         TO ARANGE4I                 18600000
186100         ELSE                                                     18610000
186200           IF PS-NO-ERROR                                         18620000
186300              MOVE ASC-RANGE-4        TO ARANGE4O                 18630000
186400           END-IF                                                 18640000
186500         END-IF                                                   18650000
186600         IF ((ASC-RANGE3-SPECIFIED)      AND                      18660000
186700             (ASC-RANGE3-IS-NUMERIC))                             18670000
186800             SET PS-ERROR            TO TRUE                      18680000
186900             SET DP020-MSG-FATAL     TO TRUE                      18690000
187000             MOVE PC-TSYMSG-00055    TO DP020-MSG-NUMBER          18700000
187100             MOVE DP015-UNP-ALP-BRT-OFF                           18710000
187200                                     TO ARANGE3A                  18720000
187300             MOVE DP015-RED          TO ARANGE3C                  18730000
187400             MOVE DP015-REVERSE      TO ARANGE3H                  18740000
187500             MOVE -1                 TO ARANGE3L                  18750000
187600             SET DP030-SET-CURSOR-APPL-1                          18760000
187700                                     TO TRUE                      18770000
187800             MOVE LOW-VALUES         TO ARANGE3I                  18780000
187900         ELSE                                                     18790000
188000           IF PS-NO-ERROR                                         18800000
188100              MOVE ASC-RANGE-3        TO ARANGE3O                 18810000
188200           END-IF                                                 18820000
188300         END-IF                                                   18830000
188400         IF ((ASC-RANGE2-SPECIFIED)      AND                      18840000
188500             (ASC-RANGE2-IS-NUMERIC))                             18850000
188600             SET PS-ERROR            TO TRUE                      18860000
188700             SET DP020-MSG-FATAL     TO TRUE                      18870000
188800             MOVE PC-TSYMSG-00055    TO DP020-MSG-NUMBER          18880000
188900             MOVE DP015-UNP-ALP-BRT-OFF                           18890000
189000                                     TO ARANGE2A                  18900000
189100             MOVE DP015-RED          TO ARANGE2C                  18910000
189200             MOVE DP015-REVERSE      TO ARANGE2H                  18920000
189300             MOVE -1                 TO ARANGE2L                  18930000
189400             SET DP030-SET-CURSOR-APPL-1                          18940000
189500                                     TO TRUE                      18950000
189600             MOVE LOW-VALUES         TO ARANGE2I                  18960000
189700         ELSE                                                     18970000
189800           IF PS-NO-ERROR                                         18980000
189900             MOVE ASC-RANGE-2        TO ARANGE2O                  18990000
190000           END-IF                                                 19000000
190100         END-IF                                                   19010000
190200         IF ((ASC-RANGE1-SPECIFIED)      AND                      19020000
190300             (ASC-RANGE1-IS-NUMERIC))                             19030000
190400             SET PS-ERROR            TO TRUE                      19040000
190500             SET DP020-MSG-FATAL     TO TRUE                      19050000
190600             MOVE PC-TSYMSG-00055    TO DP020-MSG-NUMBER          19060000
190700             MOVE DP015-UNP-ALP-BRT-OFF                           19070000
190800                                     TO ARANGE1A                  19080000
190900             MOVE DP015-RED          TO ARANGE1C                  19090000
191000             MOVE DP015-REVERSE      TO ARANGE1H                  19100000
191100             MOVE -1                 TO ARANGE1L                  19110000
191200             SET DP030-SET-CURSOR-APPL-1                          19120000
191300                                     TO TRUE                      19130000
191400             MOVE LOW-VALUES         TO ARANGE1I                  19140000
191500         ELSE                                                     19150000
191600           IF PS-NO-ERROR                                         19160000
191700              MOVE ASC-RANGE-1        TO ARANGE1O                 19170000
191800           END-IF                                                 19180000
191900         END-IF                                                   19190000
192000     ELSE                                                         19200000
192100         IF ASC-RANGE-FIELD-CNTR = +1                             19210000
192200           IF ((ASC-RANGE1-SPECIFIED)      AND                    19220000
192300               (ASC-RANGE1-IS-NUMERIC)     AND                    19230000
192400               (ASC-QLFR1-IS-NUMERIC-NO))                         19240000
192500               SET PS-ERROR            TO TRUE                    19250000
192600               SET DP020-MSG-FATAL     TO TRUE                    19260000
192700               MOVE PC-TSYMSG-00053    TO DP020-MSG-NUMBER        19270000
192800               MOVE DP015-UNP-ALP-BRT-OFF                         19280000
192900                                       TO AQLFR1A                 19290000
193000               MOVE DP015-RED          TO AQLFR1C                 19300000
193100               MOVE DP015-REVERSE      TO AQLFR1H                 19310000
193200               MOVE -1                 TO AQLFR1L                 19320000
193300               SET DP030-SET-CURSOR-APPL-1                        19330000
193400                                       TO TRUE                    19340000
193500               MOVE SPACES             TO AQLFR1I                 19350000
193600           ELSE                                                   19360000
193700            IF PS-NO-ERROR                                        19370000
193800               MOVE ASC-QUALIFIER-1    TO AQLFR1O                 19380000
193900            END-IF                                                19390000
194000           END-IF                                                 19400000
194100           IF ((ASC-RANGE2-SPECIFIED)      AND                    19410000
194200               (ASC-RANGE2-IS-NUMERIC)     AND                    19420000
194300               (ASC-QLFR2-IS-NUMERIC-NO))                         19430000
194400               SET PS-ERROR            TO TRUE                    19440000
194500               SET DP020-MSG-FATAL     TO TRUE                    19450000
194600               MOVE PC-TSYMSG-00053    TO DP020-MSG-NUMBER        19460000
194700               MOVE DP015-UNP-ALP-BRT-OFF                         19470000
194800                                       TO AQLFR2A                 19480000
194900               MOVE DP015-RED          TO AQLFR2C                 19490000
195000               MOVE DP015-REVERSE      TO AQLFR2H                 19500000
195100               MOVE -1                 TO AQLFR2L                 19510000
195200               SET DP030-SET-CURSOR-APPL-1                        19520000
195300                                       TO TRUE                    19530000
195400               MOVE SPACES             TO AQLFR2I                 19540000
195500           ELSE                                                   19550000
195600            IF PS-NO-ERROR                                        19560000
195700               MOVE ASC-QUALIFIER-2    TO AQLFR2O                 19570000
195800            END-IF                                                19580000
195900           END-IF                                                 19590000
196000           IF ((ASC-RANGE3-SPECIFIED)      AND                    19600000
196100               (ASC-RANGE3-IS-NUMERIC)     AND                    19610000
196200               (ASC-QLFR3-IS-NUMERIC-NO))                         19620000
196300               SET PS-ERROR            TO TRUE                    19630000
196400               SET DP020-MSG-FATAL     TO TRUE                    19640000
196500               MOVE PC-TSYMSG-00053    TO DP020-MSG-NUMBER        19650000
196600               MOVE DP015-UNP-ALP-BRT-OFF                         19660000
196700                                       TO AQLFR3A                 19670000
196800               MOVE DP015-RED          TO AQLFR3C                 19680000
196900               MOVE DP015-REVERSE      TO AQLFR3H                 19690000
197000               MOVE -1                 TO AQLFR3L                 19700000
197100               SET DP030-SET-CURSOR-APPL-1                        19710000
197200                                       TO TRUE                    19720000
197300               MOVE SPACES             TO AQLFR3I                 19730000
197400           ELSE                                                   19740000
197500            IF PS-NO-ERROR                                        19750000
197600               MOVE ASC-QUALIFIER-3    TO AQLFR3O                 19760000
197700            END-IF                                                19770000
197800           END-IF                                                 19780000
197900           IF ((ASC-RANGE4-SPECIFIED)      AND                    19790000
198000               (ASC-RANGE4-IS-NUMERIC)     AND                    19800000
198100               (ASC-QLFR4-IS-NUMERIC-NO))                         19810000
198200               SET PS-ERROR            TO TRUE                    19820000
198300               SET DP020-MSG-FATAL     TO TRUE                    19830000
198400               MOVE PC-TSYMSG-00053    TO DP020-MSG-NUMBER        19840000
198500               MOVE DP015-UNP-ALP-BRT-OFF                         19850000
198600                                       TO AQLFR4A                 19860000
198700               MOVE DP015-RED          TO AQLFR4C                 19870000
198800               MOVE DP015-REVERSE      TO AQLFR4H                 19880000
198900               MOVE -1                 TO AQLFR4L                 19890000
199000               SET DP030-SET-CURSOR-APPL-1                        19900000
199100                                       TO TRUE                    19910000
199200               MOVE SPACES             TO AQLFR4I                 19920000
199300           ELSE                                                   19930000
199400            IF PS-NO-ERROR                                        19940000
199500               MOVE ASC-QUALIFIER-4    TO AQLFR4O                 19950000
199600            END-IF                                                19960000
199700           END-IF                                                 19970000
199800     END-IF.                                                      19980000
199900                                                                  19990000
200000     IF  PS-NO-ERROR                                              20000000
200100         CONTINUE                                                 20010000
200200     ELSE                                                         20020000
200300         SET DP030-OVERRIDE-GO   TO TRUE                          20030000
200400         PERFORM 3200-DISPLAY-PANEL                               20040000
200500     END-IF.                                                      20050000
200600                                                                  20060000
200700**** ANY SPECIFIED RANGE VALUES MUST BE NUMERIC AND > 0 OR SEND A 20070000
200800**** (342) "MUST BE NUMERIC AND GREATER THAN ZERO" MSG.           20080000
200900     IF ((ASC-RANGE1-SPECIFIED)      AND                          20090000
201000         (ASC-QLFR1-SPECIFIED)       AND                          20100000
201100         (ASC-QLFR1-IS-NUMERIC)      AND                          20110000
201200         (ASC-RANGE-FIELD-CNTR = +1) AND                          20120000
201300         (ASC-RANGE1-IS-NUMERIC-NO   OR                           20130000
201400          ASC-RANGE-1 = ZERO))                                    20140000
201500          SET PS-ERROR            TO TRUE                         20150000
201600          SET DP020-MSG-FATAL     TO TRUE                         20160000
201700          MOVE PC-TSYMSG-00342    TO DP020-MSG-NUMBER             20170000
201800          MOVE DP015-UNP-ALP-BRT-OFF                              20180000
201900                                  TO ARANGE1A                     20190000
202000          MOVE DP015-RED          TO ARANGE1C                     20200000
202100          MOVE DP015-REVERSE      TO ARANGE1H                     20210000
202200          MOVE -1                 TO ARANGE1L                     20220000
202300          SET DP030-SET-CURSOR-APPL-1                             20230000
202400                                  TO TRUE                         20240000
202500          MOVE LOW-VALUES         TO ARANGE1I                     20250000
202600     ELSE                                                         20260000
202700       IF PS-NO-ERROR                                             20270000
202800          MOVE ASC-RANGE-1        TO ARANGE1O                     20280000
202900       END-IF                                                     20290000
203000     END-IF.                                                      20300000
203100                                                                  20310000
203200     IF  PS-NO-ERROR                                              20320000
203300         CONTINUE                                                 20330000
203400     ELSE                                                         20340000
203500         SET DP030-OVERRIDE-GO   TO TRUE                          20350000
203600         PERFORM 3200-DISPLAY-PANEL                               20360000
203700     END-IF.                                                      20370000
203800                                                                  20380000
203900     IF ((ASC-RANGE2-SPECIFIED)      AND                          20390000
204000         (ASC-QLFR2-SPECIFIED)       AND                          20400000
204100         (ASC-QLFR2-IS-NUMERIC)      AND                          20410000
204200         (ASC-RANGE-FIELD-CNTR = +1) AND                          20420000
204300         (ASC-RANGE2-IS-NUMERIC-NO   OR                           20430000
204400          ASC-RANGE-2 = ZERO))                                    20440000
204500          SET PS-ERROR            TO TRUE                         20450000
204600          SET DP020-MSG-FATAL     TO TRUE                         20460000
204700          MOVE PC-TSYMSG-00342    TO DP020-MSG-NUMBER             20470000
204800          MOVE DP015-UNP-ALP-BRT-OFF                              20480000
204900                                  TO ARANGE2A                     20490000
205000          MOVE DP015-RED          TO ARANGE2C                     20500000
205100          MOVE DP015-REVERSE      TO ARANGE2H                     20510000
205200          MOVE -1                 TO ARANGE2L                     20520000
205300          SET DP030-SET-CURSOR-APPL-1                             20530000
205400                                  TO TRUE                         20540000
205500          MOVE LOW-VALUES         TO ARANGE2I                     20550000
205600     ELSE                                                         20560000
205700       IF PS-NO-ERROR                                             20570000
205800          MOVE ASC-RANGE-2        TO ARANGE2O                     20580000
205900       END-IF                                                     20590000
206000     END-IF.                                                      20600000
206100                                                                  20610000
206200     IF  PS-NO-ERROR                                              20620000
206300         CONTINUE                                                 20630000
206400     ELSE                                                         20640000
206500         SET DP030-OVERRIDE-GO   TO TRUE                          20650000
206600         PERFORM 3200-DISPLAY-PANEL                               20660000
206700     END-IF.                                                      20670000
206800                                                                  20680000
206900     IF ((ASC-RANGE3-SPECIFIED)      AND                          20690000
207000         (ASC-QLFR3-SPECIFIED)       AND                          20700000
207100         (ASC-QLFR3-IS-NUMERIC)      AND                          20710000
207200         (ASC-RANGE-FIELD-CNTR = +1) AND                          20720000
207300         (ASC-RANGE3-IS-NUMERIC-NO   OR                           20730000
207400          ASC-RANGE-3 = ZERO))                                    20740000
207500          SET PS-ERROR            TO TRUE                         20750000
207600          SET DP020-MSG-FATAL     TO TRUE                         20760000
207700          MOVE PC-TSYMSG-00342    TO DP020-MSG-NUMBER             20770000
207800          MOVE DP015-UNP-ALP-BRT-OFF                              20780000
207900                                  TO ARANGE3A                     20790000
208000          MOVE DP015-RED          TO ARANGE3C                     20800000
208100          MOVE DP015-REVERSE      TO ARANGE3H                     20810000
208200          MOVE -1                 TO ARANGE3L                     20820000
208300          SET DP030-SET-CURSOR-APPL-1                             20830000
208400                                  TO TRUE                         20840000
208500          MOVE LOW-VALUES         TO ARANGE3I                     20850000
208600     ELSE                                                         20860000
208700       IF PS-NO-ERROR                                             20870000
208800          MOVE ASC-RANGE-3        TO ARANGE3O                     20880000
208900       END-IF                                                     20890000
209000     END-IF.                                                      20900000
209100                                                                  20910000
209200     IF  PS-NO-ERROR                                              20920000
209300         CONTINUE                                                 20930000
209400     ELSE                                                         20940000
209500         SET DP030-OVERRIDE-GO   TO TRUE                          20950000
209600         PERFORM 3200-DISPLAY-PANEL                               20960000
209700     END-IF.                                                      20970000
209800                                                                  20980000
209900     IF ((ASC-RANGE4-SPECIFIED)      AND                          20990000
210000         (ASC-QLFR4-SPECIFIED)       AND                          21000000
210100         (ASC-QLFR4-IS-NUMERIC)      AND                          21010000
210200         (ASC-RANGE-FIELD-CNTR = +1) AND                          21020000
210300         (ASC-RANGE4-IS-NUMERIC-NO   OR                           21030000
210400          ASC-RANGE-4 = ZERO))                                    21040000
210500          SET PS-ERROR            TO TRUE                         21050000
210600          SET DP020-MSG-FATAL     TO TRUE                         21060000
210700          MOVE PC-TSYMSG-00342    TO DP020-MSG-NUMBER             21070000
210800          MOVE DP015-UNP-ALP-BRT-OFF                              21080000
210900                                  TO ARANGE4A                     21090000
211000          MOVE DP015-RED          TO ARANGE4C                     21100000
211100          MOVE DP015-REVERSE      TO ARANGE4H                     21110000
211200          MOVE -1                 TO ARANGE4L                     21120000
211300          SET DP030-SET-CURSOR-APPL-1                             21130000
211400                                  TO TRUE                         21140000
211500          MOVE LOW-VALUES         TO ARANGE4I                     21150000
211600     ELSE                                                         21160000
211700       IF PS-NO-ERROR                                             21170000
211800          MOVE ASC-RANGE-4        TO ARANGE4O                     21180000
211900       END-IF                                                     21190000
212000     END-IF.                                                      21200000
212100                                                                  21210000
212200     IF  PS-NO-ERROR                                              21220000
212300         CONTINUE                                                 21230000
212400     ELSE                                                         21240000
212500         SET DP030-OVERRIDE-GO   TO TRUE                          21250000
212600         PERFORM 3200-DISPLAY-PANEL                               21260000
212700     END-IF.                                                      21270000
212800                                                                  21280000
212900**** MAKE SURE THAT THE RANGE BEGINNING IS                        21290000
213000**** LESS THAN THE RANGE END. IF PROCESSING                       21300000
213100**** GETS THRU THIS FINAL LOGIC, A SINGLE RANGE                   21310000
213200**** WILL HAVE BEEN SPECIFIED, AND IT WILL BE VALID.              21320000
213300**** (52) "END OF RANGE PRECEDES START OF RANGE".                 21330000
213400     SET ASC-RANGE-ERROR-NO        TO TRUE                        21340000
213500     IF (ASC-RANGE-IS-ON-LINE-1      AND                          21350000
213600         ASC-QLFR1-IS-NUMERIC        AND                          21360000
213700         ASC-TOTAL-WITHIN-LIMITS     AND                          21370000
213800         ASC-RANGE1-IS-NUMERIC)                                   21380000
213900       IF (ASC-QUALIFIER-1-N NOT < ASC-RANGE-1-N)                 21390000
214000           SET ASC-RANGE-ERROR     TO TRUE                        21400000
214100           SET PS-ERROR            TO TRUE                        21410000
214200        IF ASC-RANGE-ERROR                                        21420000
214300           SET DP020-MSG-FATAL     TO TRUE                        21430000
214400           MOVE PC-TSYMSG-00052    TO DP020-MSG-NUMBER            21440000
214500           MOVE DP015-UNP-NUM-BRT-OFF                             21450000
214600                                   TO ARANGE1A                    21460000
214700           MOVE DP015-RED          TO ARANGE1C                    21470000
214800           MOVE DP015-REVERSE      TO ARANGE1H                    21480000
214900           MOVE -1                 TO ARANGE1L                    21490000
215000           SET DP030-SET-CURSOR-APPL-1                            21500000
215100                                   TO TRUE                        21510000
215200           MOVE LOW-VALUES         TO ARANGE1I                    21520000
215300        END-IF                                                    21530000
215400       END-IF                                                     21540000
215500     ELSE                                                         21550000
215600      IF PS-NO-ERROR                                              21560000
215700         MOVE ASC-RANGE-1        TO ARANGE1O                      21570000
215800      END-IF                                                      21580000
215900     END-IF.                                                      21590000
216000                                                                  21600000
216100     SET ASC-RANGE-ERROR-NO        TO TRUE                        21610000
216200     IF (ASC-RANGE-IS-ON-LINE-2      AND                          21620000
216300         ASC-QLFR2-IS-NUMERIC        AND                          21630000
216400         ASC-TOTAL-WITHIN-LIMITS     AND                          21640000
216500         ASC-RANGE2-IS-NUMERIC)                                   21650000
216600       IF (ASC-QUALIFIER-2-N NOT < ASC-RANGE-2-N)                 21660000
216700           SET ASC-RANGE-ERROR     TO TRUE                        21670000
216800           SET PS-ERROR            TO TRUE                        21680000
216900        IF ASC-RANGE-ERROR                                        21690000
217000           SET DP020-MSG-FATAL     TO TRUE                        21700000
217100           MOVE PC-TSYMSG-00052    TO DP020-MSG-NUMBER            21710000
217200           MOVE DP015-UNP-NUM-BRT-OFF                             21720000
217300                                   TO ARANGE2A                    21730000
217400           MOVE DP015-RED          TO ARANGE2C                    21740000
217500           MOVE DP015-REVERSE      TO ARANGE2H                    21750000
217600           MOVE -1                 TO ARANGE2L                    21760000
217700           SET DP030-SET-CURSOR-APPL-1                            21770000
217800                                   TO TRUE                        21780000
217900           MOVE LOW-VALUES         TO ARANGE2I                    21790000
218000        END-IF                                                    21800000
218100       END-IF                                                     21810000
218200     ELSE                                                         21820000
218300      IF PS-NO-ERROR                                              21830000
218400         MOVE ASC-RANGE-2        TO ARANGE2O                      21840000
218500      END-IF                                                      21850000
218600     END-IF.                                                      21860000
218700                                                                  21870000
218800     SET ASC-RANGE-ERROR-NO        TO TRUE                        21880000
218900     IF (ASC-RANGE-IS-ON-LINE-3      AND                          21890000
219000         ASC-QLFR3-IS-NUMERIC        AND                          21900000
219100         ASC-TOTAL-WITHIN-LIMITS     AND                          21910000
219200         ASC-RANGE3-IS-NUMERIC)                                   21920000
219300       IF (ASC-QUALIFIER-3-N NOT < ASC-RANGE-3-N)                 21930000
219400           SET ASC-RANGE-ERROR     TO TRUE                        21940000
219500           SET PS-ERROR            TO TRUE                        21950000
219600        IF ASC-RANGE-ERROR                                        21960000
219700           SET DP020-MSG-FATAL     TO TRUE                        21970000
219800           MOVE PC-TSYMSG-00052    TO DP020-MSG-NUMBER            21980000
219900           MOVE DP015-UNP-NUM-BRT-OFF                             21990000
220000                                   TO ARANGE3A                    22000000
220100           MOVE DP015-RED          TO ARANGE3C                    22010000
220200           MOVE DP015-REVERSE      TO ARANGE3H                    22020000
220300           MOVE -1                 TO ARANGE3L                    22030000
220400           SET DP030-SET-CURSOR-APPL-1                            22040000
220500                                   TO TRUE                        22050000
220600           MOVE LOW-VALUES         TO ARANGE3I                    22060000
220700        END-IF                                                    22070000
220800       END-IF                                                     22080000
220900     ELSE                                                         22090000
221000      IF PS-NO-ERROR                                              22100000
221100         MOVE ASC-RANGE-3        TO ARANGE3O                      22110000
221200      END-IF                                                      22120000
221300     END-IF.                                                      22130000
221400                                                                  22140000
221500     SET ASC-RANGE-ERROR-NO        TO TRUE                        22150000
221600     IF (ASC-RANGE-IS-ON-LINE-4      AND                          22160000
221700         ASC-QLFR4-IS-NUMERIC        AND                          22170000
221800         ASC-TOTAL-WITHIN-LIMITS     AND                          22180000
221900         ASC-RANGE4-IS-NUMERIC)                                   22190000
222000       IF (ASC-QUALIFIER-4-N NOT < ASC-RANGE-4-N)                 22200000
222100           SET ASC-RANGE-ERROR     TO TRUE                        22210000
222200           SET PS-ERROR            TO TRUE                        22220000
222300        IF ASC-RANGE-ERROR                                        22230000
222400           SET DP020-MSG-FATAL     TO TRUE                        22240000
222500           MOVE PC-TSYMSG-00052    TO DP020-MSG-NUMBER            22250000
222600           MOVE DP015-UNP-NUM-BRT-OFF                             22260000
222700                                   TO ARANGE4A                    22270000
222800           MOVE DP015-RED          TO ARANGE4C                    22280000
222900           MOVE DP015-REVERSE      TO ARANGE4H                    22290000
223000           MOVE -1                 TO ARANGE4L                    22300000
223100           SET DP030-SET-CURSOR-APPL-1                            22310000
223200                                   TO TRUE                        22320000
223300           MOVE LOW-VALUES         TO ARANGE4I                    22330000
223400        END-IF                                                    22340000
223500       END-IF                                                     22350000
223600     ELSE                                                         22360000
223700      IF PS-NO-ERROR                                              22370000
223800         MOVE ASC-RANGE-4        TO ARANGE4O                      22380000
223900      END-IF                                                      22390000
224000     END-IF.                                                      22400000
224100                                                                  22410000
224200     MOVE ASC-LABEL-COMMENTS-1     TO ACMNT1O.                    22420000
224300     MOVE ASC-LABEL-COMMENTS-2     TO ACMNT2O.                    22430000
224400     MOVE ASC-LABEL-COMMENTS-3     TO ACMNT3O.                    22440000
224500                                                                  22450000
224600     IF  PS-NO-ERROR                                              22460000
224700         CONTINUE                                                 22470000
224800     ELSE                                                         22480000
224900         SET DP030-OVERRIDE-GO     TO TRUE                        22490000
225000         PERFORM 3200-DISPLAY-PANEL                               22500000
225100     END-IF.                                                      22510000
225200                                                                  22520000
225300     IF  ASC-RANGE-REQUESTED                                      22530000
225400         IF ((ASC-QUALIFIER-1-N > 0  OR                           22540000
225500              ASC-QUALIFIER-2-N > 0  OR                           22550000
225600              ASC-QUALIFIER-3-N > 0  OR                           22560000
225700              ASC-QUALIFIER-4-N > 0  OR                           22570000
225800              ASC-RANGE-1-N     > 0  OR                           22580000
225900              ASC-RANGE-2-N     > 0  OR                           22590000
226000              ASC-RANGE-3-N     > 0  OR                           22600000
226100              ASC-RANGE-4-N     > 0)        AND                   22610000
226200              ASC-TOTAL-WITHIN-LIMITS-NO)                         22620000
226300              SET PS-ERROR            TO TRUE                     22630000
226400              SET DP020-MSG-FATAL     TO TRUE                     22640000
226500              MOVE PC-TSYMSG-02506    TO DP020-MSG-NUMBER         22650000
226600              EVALUATE TRUE                                       22660000
226700                 WHEN ((ASC-RANGE1-SPECIFIED     AND              22670000
226800                        ASC-RANGE1-IS-NUMERIC))                   22680000
226900                        MOVE DP015-UNP-ALP-BRT-OFF                22690000
227000                                            TO ARANGE1A           22700000
227100                        MOVE DP015-RED      TO ARANGE1C           22710000
227200                        MOVE DP015-REVERSE  TO ARANGE1H           22720000
227300                        MOVE -1             TO ARANGE1L           22730000
227400                        SET DP030-SET-CURSOR-APPL-1               22740000
227500                                            TO TRUE               22750000
227600                 WHEN ((ASC-RANGE2-SPECIFIED     AND              22760000
227700                        ASC-RANGE2-IS-NUMERIC))                   22770000
227800                        MOVE DP015-UNP-ALP-BRT-OFF                22780000
227900                                            TO ARANGE2A           22790000
228000                        MOVE DP015-RED      TO ARANGE2C           22800000
228100                        MOVE DP015-REVERSE  TO ARANGE2H           22810000
228200                        MOVE -1             TO ARANGE2L           22820000
228300                        SET DP030-SET-CURSOR-APPL-1               22830000
228400                                            TO TRUE               22840000
228500                 WHEN ((ASC-RANGE3-SPECIFIED     AND              22850000
228600                        ASC-RANGE3-IS-NUMERIC))                   22860000
228700                        MOVE DP015-UNP-ALP-BRT-OFF                22870000
228800                                            TO ARANGE3A           22880000
228900                        MOVE DP015-RED      TO ARANGE3C           22890000
229000                        MOVE DP015-REVERSE  TO ARANGE3H           22900000
229100                        MOVE -1             TO ARANGE3L           22910000
229200                        SET DP030-SET-CURSOR-APPL-1               22920000
229300                                            TO TRUE               22930000
229400                 WHEN ((ASC-RANGE4-SPECIFIED     AND              22940000
229500                        ASC-RANGE4-IS-NUMERIC))                   22950000
229600                        MOVE DP015-UNP-ALP-BRT-OFF                22960000
229700                                            TO ARANGE4A           22970000
229800                        MOVE DP015-RED      TO ARANGE4C           22980000
229900                        MOVE DP015-REVERSE  TO ARANGE4H           22990000
230000                        MOVE -1             TO ARANGE4L           23000000
230100                        SET DP030-SET-CURSOR-APPL-1               23010000
230200                                            TO TRUE               23020000
230300              END-EVALUATE                                        23030000
230400         END-IF                                                   23040000
230500     END-IF.                                                      23050000
230600                                                                  23060000
230700     IF  PS-NO-ERROR                                              23070000
230800         SET ASC-RANGE-VALID       TO TRUE                        23080000
230900         SET ASC-EDITS-COMPLETE    TO TRUE                        23090000
231000     ELSE                                                         23100000
231100         SET ASC-EDITS-COMPLETE-NO TO TRUE                        23110000
231200         SET DP030-OVERRIDE-GO     TO TRUE                        23120000
231300         PERFORM 3200-DISPLAY-PANEL                               23130000
231400     END-IF.                                                      23140000
231500                                                                  23150000
231600                                                                  23160000
231700 EJECT                                                            23170000
231800*----------------------------------------------------------------*23180000
231900*  THERE ARE 4 FIELDS USED TO PASS THIS FREE FORM TEXT TO THE    *23190000
232000*  SOCKET PROGRAM. THEY ARE : PC140-ML-START-LABEL-ID            *23200000
232100*                             PC140-ML-END-LABEL-ID              *23210000
232200*                             PC140-ML-START-LABEL-ID-HR         *23220000
232300*                             PC140-ML-END-LABEL-ID-HR           *23230000
232400* THE "HR" HUMAN READABLE FIELDS 20 CHAR, AND WILL CONTAIN       *23240000
232500* ANY SEPARATORS REQUESTED BY THE USER. THE OTHER BARCODE        *23250000
232600* DATA FIELDS ARE 12 CHARS IN LENGTH.                            *23260000
232700* BOTH START AND END FIELDS WILL BE USED IF A RANGE WAS          *23270000
232800* REQUESTED, OTHERWISE ONLY THE START FIELDS WILL BE USED        *23280000
232900* WHILE THE END FIELDS REMAIN SPACES. PROGRAM PCKCS707 WILL      *23290000
233000* INTERROGATE THE FIELDS TO DETERMINE IF A RANGE IS PRESENT TOO. *23300000
233100* FIRST DETERMINE IF A RANGE IS PRESENT TO THEN DETERMINE HOW TO *23310000
233200* STRING QUALIFIER, RANGE AND SEPARATOR FIELDS TOGETHER.         *23320000
233300*----------------------------------------------------------------*23330000
233400 2265-STRING-FREE-FORM-TEXT.                                      23340000
233500                                                                  23350000
233600     IF (ASC-RANGE-REQUESTED AND                                  23360000
233700         ASC-RANGE-VALID)                                         23370000
233800**** NOTE: THE ONLY DIFFERENCE BETWEEN THE NEXT 4 IF STATEMENTS   23380000
233900****       IS THAT THE RANGE VALUE WILL BE USED FOR THE "END"     23390000
234000****       VALUES, AND IT CORRESPONDS TO THE LINE NBR OF THE FREE 23400000
234100****       FORM ENTERABLE TEXT FIELDS THAT CONTAIN THE RANGE.     23410000
234200         IF ASC-RANGE-IS-ON-LINE-1                                23420000
234300            INITIALIZE PV-4DIGIT-N                                23430000
234400            MOVE ASC-QUALIFIER-1-N   TO PV-4DIGIT-N               23440000
234500            STRING PV-4DIGIT-N               DELIMITED BY SIZE    23450000
234600                   ASC-SEPARATOR-1           DELIMITED BY SPACE   23460000
234700                   ASC-QUALIFIER-2           DELIMITED BY SPACE   23470000
234800                   ASC-SEPARATOR-2           DELIMITED BY SPACE   23480000
234900                   ASC-QUALIFIER-3           DELIMITED BY SPACE   23490000
235000                   ASC-SEPARATOR-3           DELIMITED BY SPACE   23500000
235100                   ASC-QUALIFIER-4           DELIMITED BY SPACE   23510000
235200                   ASC-SEPARATOR-4           DELIMITED BY SPACE   23520000
235300            INTO   PC140-ML-START-LABEL-ID-HR                     23530000
235400                                                                  23540000
235500            STRING PV-4DIGIT-N               DELIMITED BY SIZE    23550000
235600                   ASC-QUALIFIER-2           DELIMITED BY SPACE   23560000
235700                   ASC-QUALIFIER-3           DELIMITED BY SPACE   23570000
235800                   ASC-QUALIFIER-4           DELIMITED BY SPACE   23580000
235810*                  PC-EOD                    DELIMITED BY SIZE    23581099
235900            INTO   PC140-ML-START-LABEL-ID                        23590000
236000                                                                  23600000
236100            INITIALIZE PV-4DIGIT-N                                23610000
236200            MOVE ASC-RANGE-1-N TO PV-4DIGIT-N                     23620000
236300            STRING PV-4DIGIT-N               DELIMITED BY SIZE    23630000
236400                   ASC-SEPARATOR-1           DELIMITED BY SPACE   23640000
236500                   ASC-QUALIFIER-2           DELIMITED BY SPACE   23650000
236600                   ASC-SEPARATOR-2           DELIMITED BY SPACE   23660000
236700                   ASC-QUALIFIER-3           DELIMITED BY SPACE   23670000
236800                   ASC-SEPARATOR-3           DELIMITED BY SPACE   23680000
236900                   ASC-QUALIFIER-4           DELIMITED BY SPACE   23690000
237000                   ASC-SEPARATOR-4           DELIMITED BY SPACE   23700000
237100            INTO   PC140-ML-END-LABEL-ID-HR                       23710000
237200                                                                  23720000
237300            STRING PV-4DIGIT-N               DELIMITED BY SIZE    23730000
237400                   ASC-QUALIFIER-2           DELIMITED BY SPACE   23740000
237500                   ASC-QUALIFIER-3           DELIMITED BY SPACE   23750000
237600                   ASC-QUALIFIER-4           DELIMITED BY SPACE   23760000
237610*                  PC-EOD                    DELIMITED BY SIZE    23761099
237700            INTO   PC140-ML-END-LABEL-ID                          23770000
237800                                                                  23780000
237900            MOVE ASC-QUALIFIER-1-N (8:5)   TO                     23790000
238000                         PC140-ML-BEGIN-RANGE-NBR                 23800000
238100            MOVE ASC-RANGE-1-N     (8:5)   TO                     23810000
238200                         PC140-ML-END-RANGE-NBR                   23820000
238300         END-IF                                                   23830000
238400         IF ASC-RANGE-IS-ON-LINE-2                                23840000
238410            MOVE SPACES TO PC140-ML-START-LABEL-ID                23841099
238420                           PC140-ML-END-LABEL-ID                  23842099
238500            INITIALIZE PV-4DIGIT-N                                23850000
238600            MOVE ASC-QUALIFIER-2-N   TO PV-4DIGIT-N               23860000
238700            STRING ASC-QUALIFIER-1           DELIMITED BY SPACE   23870000
238800                   ASC-SEPARATOR-1           DELIMITED BY SPACE   23880000
238900                   PV-4DIGIT-N               DELIMITED BY SIZE    23890000
239000                   ASC-SEPARATOR-2           DELIMITED BY SPACE   23900000
239100                   ASC-QUALIFIER-3           DELIMITED BY SPACE   23910000
239200                   ASC-SEPARATOR-3           DELIMITED BY SPACE   23920000
239300                   ASC-QUALIFIER-4           DELIMITED BY SPACE   23930000
239400                   ASC-SEPARATOR-4           DELIMITED BY SPACE   23940000
239500            INTO   PC140-ML-START-LABEL-ID-HR                     23950000
239600                                                                  23960000
239700            STRING ASC-QUALIFIER-1           DELIMITED BY SPACE   23970000
239800                   PV-4DIGIT-N               DELIMITED BY SIZE    23980000
239900                   ASC-QUALIFIER-3           DELIMITED BY SPACE   23990000
240000                   ASC-QUALIFIER-4           DELIMITED BY SPACE   24000000
240010*                  PC-EOD                    DELIMITED BY SIZE    24001099
240100            INTO   PC140-ML-START-LABEL-ID                        24010000
240200                                                                  24020000
240300            INITIALIZE PV-4DIGIT-N                                24030000
240400            MOVE ASC-RANGE-2-N       TO PV-4DIGIT-N               24040000
240500            STRING ASC-QUALIFIER-1           DELIMITED BY SPACE   24050000
240600                   ASC-SEPARATOR-1           DELIMITED BY SPACE   24060000
240700                   PV-4DIGIT-N               DELIMITED BY SIZE    24070000
240800                   ASC-SEPARATOR-2           DELIMITED BY SPACE   24080000
240900                   ASC-QUALIFIER-3           DELIMITED BY SPACE   24090000
241000                   ASC-SEPARATOR-3           DELIMITED BY SPACE   24100000
241100                   ASC-QUALIFIER-4           DELIMITED BY SPACE   24110000
241200                   ASC-SEPARATOR-4           DELIMITED BY SPACE   24120000
241300            INTO   PC140-ML-END-LABEL-ID-HR                       24130000
241400                                                                  24140000
241500            STRING ASC-QUALIFIER-1           DELIMITED BY SPACE   24150000
241600                   PV-4DIGIT-N               DELIMITED BY SIZE    24160000
241700                   ASC-QUALIFIER-3           DELIMITED BY SPACE   24170000
241800                   ASC-QUALIFIER-4           DELIMITED BY SPACE   24180000
241810*                  PC-EOD                    DELIMITED BY SIZE    24181099
241900            INTO   PC140-ML-END-LABEL-ID                          24190000
242000                                                                  24200000
242100            MOVE ASC-QUALIFIER-2-N (8:5)   TO                     24210000
242200                         PC140-ML-BEGIN-RANGE-NBR                 24220000
242300            MOVE ASC-RANGE-2-N     (8:5)   TO                     24230000
242400                         PC140-ML-END-RANGE-NBR                   24240000
242500         END-IF                                                   24250000
242600         IF ASC-RANGE-IS-ON-LINE-3                                24260000
242700            INITIALIZE PV-4DIGIT-N                                24270000
242800            MOVE ASC-QUALIFIER-3-N   TO PV-4DIGIT-N               24280000
242900            STRING ASC-QUALIFIER-1           DELIMITED BY SPACE   24290000
243000                   ASC-SEPARATOR-1           DELIMITED BY SPACE   24300000
243100                   ASC-QUALIFIER-2           DELIMITED BY SPACE   24310000
243200                   ASC-SEPARATOR-2           DELIMITED BY SPACE   24320000
243300                   PV-4DIGIT-N               DELIMITED BY SIZE    24330000
243400                   ASC-SEPARATOR-3           DELIMITED BY SPACE   24340000
243500                   ASC-QUALIFIER-4           DELIMITED BY SPACE   24350000
243600                   ASC-SEPARATOR-4           DELIMITED BY SPACE   24360000
243700            INTO   PC140-ML-START-LABEL-ID-HR                     24370000
243800                                                                  24380000
243900            STRING ASC-QUALIFIER-1           DELIMITED BY SPACE   24390000
244000                   ASC-QUALIFIER-2           DELIMITED BY SPACE   24400000
244100                   PV-4DIGIT-N               DELIMITED BY SIZE    24410000
244200                   ASC-QUALIFIER-4           DELIMITED BY SPACE   24420000
244210*                  PC-EOD                    DELIMITED BY SIZE    24421099
244300            INTO   PC140-ML-START-LABEL-ID                        24430000
244400                                                                  24440000
244500            INITIALIZE PV-4DIGIT-N                                24450000
244600            MOVE ASC-RANGE-3-N       TO PV-4DIGIT-N               24460000
244700            STRING ASC-QUALIFIER-1           DELIMITED BY SPACE   24470000
244800                   ASC-SEPARATOR-1           DELIMITED BY SPACE   24480000
244900                   ASC-QUALIFIER-2           DELIMITED BY SPACE   24490000
245000                   ASC-SEPARATOR-2           DELIMITED BY SPACE   24500000
245100                   PV-4DIGIT-N               DELIMITED BY SIZE    24510000
245200                   ASC-SEPARATOR-3           DELIMITED BY SPACE   24520000
245300                   ASC-QUALIFIER-4           DELIMITED BY SPACE   24530000
245400                   ASC-SEPARATOR-4           DELIMITED BY SPACE   24540000
245500            INTO   PC140-ML-END-LABEL-ID-HR                       24550000
245600                                                                  24560000
245700            STRING ASC-QUALIFIER-1           DELIMITED BY SPACE   24570000
245800                   ASC-QUALIFIER-2           DELIMITED BY SPACE   24580000
245900                   PV-4DIGIT-N               DELIMITED BY SIZE    24590000
246000                   ASC-QUALIFIER-4           DELIMITED BY SPACE   24600000
246010*                  PC-EOD                    DELIMITED BY SIZE    24601099
246100            INTO   PC140-ML-END-LABEL-ID                          24610000
246200                                                                  24620000
246300            MOVE ASC-QUALIFIER-3-N (8:5)   TO                     24630000
246400                         PC140-ML-BEGIN-RANGE-NBR                 24640000
246500            MOVE ASC-RANGE-3-N     (8:5)   TO                     24650000
246600                         PC140-ML-END-RANGE-NBR                   24660000
246700         END-IF                                                   24670000
246800         IF ASC-RANGE-IS-ON-LINE-4                                24680000
246900            INITIALIZE PV-4DIGIT-N                                24690000
247000            MOVE ASC-QUALIFIER-4-N   TO PV-4DIGIT-N               24700000
247100            STRING ASC-QUALIFIER-1           DELIMITED BY SPACE   24710000
247200                   ASC-SEPARATOR-1           DELIMITED BY SPACE   24720000
247300                   ASC-QUALIFIER-2           DELIMITED BY SPACE   24730000
247400                   ASC-SEPARATOR-2           DELIMITED BY SPACE   24740000
247500                   ASC-QUALIFIER-3           DELIMITED BY SPACE   24750000
247600                   ASC-SEPARATOR-3           DELIMITED BY SPACE   24760000
247700                   PV-4DIGIT-N               DELIMITED BY SIZE    24770000
247800                   ASC-SEPARATOR-4           DELIMITED BY SPACE   24780000
247900            INTO   PC140-ML-START-LABEL-ID-HR                     24790000
248000                                                                  24800000
248100            STRING ASC-QUALIFIER-1           DELIMITED BY SPACE   24810000
248200                   ASC-QUALIFIER-2           DELIMITED BY SPACE   24820000
248300                   ASC-QUALIFIER-3           DELIMITED BY SPACE   24830000
248400                   PV-4DIGIT-N               DELIMITED BY SIZE    24840000
248410*                  PC-EOD                    DELIMITED BY SIZE    24841099
248500            INTO   PC140-ML-START-LABEL-ID                        24850000
248600                                                                  24860000
248700            INITIALIZE PV-4DIGIT-N                                24870000
248800            MOVE ASC-RANGE-4-N       TO PV-4DIGIT-N               24880000
248900            STRING ASC-QUALIFIER-1           DELIMITED BY SPACE   24890000
249000                   ASC-SEPARATOR-1           DELIMITED BY SPACE   24900000
249100                   ASC-QUALIFIER-2           DELIMITED BY SPACE   24910000
249200                   ASC-SEPARATOR-2           DELIMITED BY SPACE   24920000
249300                   ASC-QUALIFIER-3           DELIMITED BY SPACE   24930000
249400                   ASC-SEPARATOR-3           DELIMITED BY SPACE   24940000
249500                   PV-4DIGIT-N               DELIMITED BY SIZE    24950000
249600                   ASC-SEPARATOR-4           DELIMITED BY SPACE   24960000
249700            INTO   PC140-ML-END-LABEL-ID-HR                       24970000
249800                                                                  24980000
249900            STRING ASC-QUALIFIER-1           DELIMITED BY SPACE   24990000
250000                   ASC-QUALIFIER-2           DELIMITED BY SPACE   25000000
250100                   ASC-QUALIFIER-3           DELIMITED BY SPACE   25010000
250200                   PV-4DIGIT-N               DELIMITED BY SIZE    25020000
250210*                  PC-EOD                    DELIMITED BY SIZE    25021099
250300            INTO   PC140-ML-END-LABEL-ID                          25030000
250400                                                                  25040000
250500                                                                  25050000
250600            MOVE ASC-QUALIFIER-4-N (8:5)   TO                     25060000
250700                         PC140-ML-BEGIN-RANGE-NBR                 25070000
250800            MOVE ASC-RANGE-4-N     (8:5)   TO                     25080000
250900                         PC140-ML-END-RANGE-NBR                   25090000
251000         END-IF                                                   25100000
251100     ELSE                                                         25110000
251200         IF ASC-RANGE-REQUESTED-NO                                25120000
251300            STRING ASC-QUALIFIER-1           DELIMITED BY SPACE   25130000
251400                   ASC-SEPARATOR-1           DELIMITED BY SPACE   25140000
251500                   ASC-QUALIFIER-2           DELIMITED BY SPACE   25150000
251600                   ASC-SEPARATOR-2           DELIMITED BY SPACE   25160000
251700                   ASC-QUALIFIER-3           DELIMITED BY SPACE   25170000
251800                   ASC-SEPARATOR-3           DELIMITED BY SPACE   25180000
251900                   ASC-QUALIFIER-4           DELIMITED BY SPACE   25190000
252000                   ASC-SEPARATOR-4           DELIMITED BY SPACE   25200000
252100            INTO   PC140-ML-START-LABEL-ID-HR                     25210000
252200                                                                  25220000
252300            STRING ASC-QUALIFIER-1           DELIMITED BY SPACE   25230000
252400                   ASC-QUALIFIER-2           DELIMITED BY SPACE   25240000
252500                   ASC-QUALIFIER-3           DELIMITED BY SPACE   25250000
252600                   ASC-QUALIFIER-4           DELIMITED BY SPACE   25260000
252610*                  PC-EOD                    DELIMITED BY SIZE    25261099
252700            INTO   PC140-ML-START-LABEL-ID                        25270000
252800            MOVE SPACES           TO  PC140-ML-END-LABEL-ID-HR    25280000
252900                                      PC140-ML-END-LABEL-ID       25290000
253000         END-IF                                                   25300000
253100     END-IF.                                                      25310000
253200                                                                  25320000
253300 EJECT                                                            25330000
253400*----------------------------------------------------------------*25340000
253500* CALLS DPKCS060 TO VALIDATE THE PRINTER ID                      *25350000
253600*----------------------------------------------------------------*25360000
253700 2270-VALIDATE-PRINTER.                                           25370000
253800                                                                  25380000
253900     MOVE ASC-PRTR-ID-N           TO DP072-PRINTER-ID.            25390000
254000     MOVE PC-CURRENT-PROGRAM-NAME TO DP072-RPT-PGM-NME.           25400000
254100     MOVE PC-01                   TO DP072-RPT-PGM-TYP-ID.        25410000
254200     MOVE ASC-OPER-UNT-ID-N       TO DP072-ORIGIN-OPER-UNT-ID     25420000
254300                                     DP072-OPER-UNT-ID.           25430000
254400     MOVE ASC-FCLTY-ID-N          TO DP072-ORIGIN-FCLTY-ID        25440000
254500                                     DP072-FCLTY-ID.              25450000
254600                                                                  25460000
254700     SET DP072-VALIDATE           TO TRUE.                        25470000
254800                                                                  25480000
254900     EXEC CICS                                                    25490000
255000          LINK PROGRAM  (PC-PRTR-VALIDATION-PGM)                  25500000
255100               COMMAREA (DP072-COMM-AREA)                         25510000
255200               RESP     (PV-CICS-RESPONSE)                        25520000
255300     END-EXEC.                                                    25530000
255400                                                                  25540000
255500     EVALUATE TRUE                                                25550000
255600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 25560000
255700              CONTINUE                                            25570000
255800         WHEN OTHER                                               25580000
255900              SET PS-ERROR                TO TRUE                 25590000
256000              SET DP020-MSG-FATAL         TO TRUE                 25600000
256100              MOVE PC-TSYMSG-00746        TO DP020-MSG-NUMBER     25610000
256200              MOVE DP015-UNP-NUM-BRT-OFF  TO APRTRA               25620000
256300              MOVE DP015-RED              TO APRTRC               25630000
256400              MOVE DP015-REVERSE          TO APRTRH               25640000
256500              MOVE -1                     TO APRTRL               25650000
256600              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 25660000
256700              PERFORM DP013-0000-PROCESS-ABEND                    25670000
256800     END-EVALUATE.                                                25680000
256900                                                                  25690000
257000 EJECT                                                            25700000
257100*----------------------------------------------------------------*25710000
257200*  VALIDATE THE PRINTER NUMBER ENTERED ON THE SCREEN TO ENSURE   *25720000
257300*  THIS IS A VALID PRINTER AND THAT THESE LABELS CAN BE PRINTED  *25730000
257400*  ON THIS PRINTER.                                              *25740000
257500*----------------------------------------------------------------*25750000
257600 2275-VALIDATE-PRINTER-ID.                                        25760000
257700                                                                  25770000
257800     IF  DP072-PRTR-PRTR-TRK-STAT-CDE =  PC-A                     25780000
257900         CONTINUE                                                 25790000
258000     ELSE                                                         25800000
258100         SET  PS-ERROR                TO TRUE                     25810000
258200         SET  DP020-MSG-FATAL         TO TRUE                     25820000
258300         MOVE PC-TSYMSG-00746         TO DP020-MSG-NUMBER         25830000
258400         MOVE DP015-UNP-NUM-BRT-OFF   TO APRTRA                   25840000
258500         MOVE DP015-RED               TO APRTRC                   25850000
258600         MOVE DP015-REVERSE           TO APRTRH                   25860000
258700         MOVE -1                      TO APRTRL                   25870000
258800         SET DP030-SET-CURSOR-APPL-1  TO TRUE                     25880000
258900     END-IF.                                                      25890000
259000                                                                  25900000
259100 EJECT                                                            25910000
259200*----------------------------------------------------------------*25920000
259300* CALCULATE TOTAL NUMBER OF LABELS.                              *25930000
259400* NOTE:  IF A RANGE WAS NOT SPECIFIED, THE TOTAL NUMBER OF       *25940000
259500* LABELS WILL BE 1 TIMES WHATEVER IS IN THE SETS-OF-LABELS FIELD.*25950000
259600* FIELDS PV-NUMBER-OF-LABELS, PV-QUALIFIER AND PV-RANGE ARE WORK *25960000
259700* FIELDS.                                                        *25970000
259800*----------------------------------------------------------------*25980000
259900 2280-CALCULATE-LABEL-TOTALS.                                     25990000
260000                                                                  26000000
260100     INITIALIZE ASC-TOTAL-LABELS-N                                26010000
260200                PV-QUALIFIER                                      26020000
260300                PV-RANGE                                          26030000
260400                PV-SETS                                           26040000
260500                PV-NUMBER-OF-LABELS                               26050000
260600                PV-TOTAL-LABELS.                                  26060000
260700                                                                  26070000
260800     IF (ASC-RANGE-REQUESTED AND                                  26080000
260900         ASC-RANGE-VALID)                                         26090000
261000         IF ASC-RANGE-IS-ON-LINE-1                                26100000
261100            MOVE ASC-QUALIFIER-1-N     TO PV-QUALIFIER            26110000
261200            MOVE ASC-RANGE-1-N         TO PV-RANGE                26120000
261300            MOVE ASC-SETS-OF-LABELS    TO PV-SETS                 26130000
261400            COMPUTE PV-NUMBER-OF-LABELS  =                        26140000
261500                   (PV-RANGE  -  PV-QUALIFIER)                    26150000
261600                    ADD +1            TO PV-NUMBER-OF-LABELS      26160000
261700            COMPUTE PV-TOTAL-LABELS      =                        26170000
261800                   (PV-NUMBER-OF-LABELS  * PV-SETS)               26180000
261900            MOVE PV-TOTAL-LABELS      TO ASC-TOTAL-LABELS-N       26190000
262000         END-IF                                                   26200000
262100         IF ASC-RANGE-IS-ON-LINE-2                                26210000
262200            MOVE ASC-QUALIFIER-2-N    TO PV-QUALIFIER             26220000
262300            MOVE ASC-RANGE-2-N        TO PV-RANGE                 26230000
262400            MOVE ASC-SETS-OF-LABELS   TO PV-SETS                  26240000
262500            COMPUTE PV-NUMBER-OF-LABELS  =                        26250000
262600                   (PV-RANGE  -  PV-QUALIFIER)                    26260000
262700                    ADD +1            TO PV-NUMBER-OF-LABELS      26270000
262800            COMPUTE PV-TOTAL-LABELS      =                        26280000
262900                   (PV-NUMBER-OF-LABELS  * PV-SETS)               26290000
263000            MOVE PV-TOTAL-LABELS      TO ASC-TOTAL-LABELS-N       26300000
263100         END-IF                                                   26310000
263200         IF ASC-RANGE-IS-ON-LINE-3                                26320000
263300            MOVE ASC-QUALIFIER-3-N    TO PV-QUALIFIER             26330000
263400            MOVE ASC-RANGE-3-N        TO PV-RANGE                 26340000
263500            MOVE ASC-SETS-OF-LABELS   TO PV-SETS                  26350000
263600            COMPUTE PV-NUMBER-OF-LABELS  =                        26360000
263700                   (PV-RANGE  -  PV-QUALIFIER)                    26370000
263800                    ADD +1            TO PV-NUMBER-OF-LABELS      26380000
263900            COMPUTE PV-TOTAL-LABELS      =                        26390000
264000                   (PV-NUMBER-OF-LABELS  * PV-SETS)               26400000
264100            MOVE PV-TOTAL-LABELS      TO ASC-TOTAL-LABELS-N       26410000
264200         END-IF                                                   26420000
264300         IF ASC-RANGE-IS-ON-LINE-4                                26430000
264400            MOVE ASC-QUALIFIER-4-N    TO PV-QUALIFIER             26440000
264500            MOVE ASC-RANGE-4-N        TO PV-RANGE                 26450000
264600            MOVE ASC-SETS-OF-LABELS   TO PV-SETS                  26460000
264700            COMPUTE PV-NUMBER-OF-LABELS  =                        26470000
264800                   (PV-RANGE  -  PV-QUALIFIER)                    26480000
264900                    ADD +1            TO PV-NUMBER-OF-LABELS      26490000
265000            COMPUTE PV-TOTAL-LABELS      =                        26500000
265100                   (PV-NUMBER-OF-LABELS  * PV-SETS)               26510000
265200            MOVE PV-TOTAL-LABELS      TO ASC-TOTAL-LABELS-N       26520000
265300         END-IF                                                   26530000
265400     ELSE                                                         26540000
265500         IF ASC-RANGE-REQUESTED-NO                                26550000
265600              MOVE ASC-SETS-OF-LABELS  TO ASC-TOTAL-LABELS        26560000
265700         END-IF                                                   26570000
265800     END-IF.                                                      26580000
265900                                                                  26590000
266000 EJECT                                                            26600000
266100*----------------------------------------------------------------*26610000
266200* CALCULATE RANGE POSITION IF A RANGE WAS SPECIFIED.             *26620000
266300* THE HUMAN READABLE PORTION OF THE LABEL IS 20 CHARS IN LENGTH. *26630000
266400* NOTE:  BECAUSE THE FIELDS ARE FREE FORM, THE POSITION OF THE   *26640000
266500* FIELD THAT WILL HOLD THE INCREMENTING RANGE NUMBERS MUST BE    *26650000
266600* DETERMINED SO IT CAN BE PASSED TO THE SOCKET PROGRAM, WHICH    *26660000
266700* WILL LOOP VARYING THE VARIABLE FIELD ACCORDING TO THE NUMBER   *26670000
266800* SPECIFIED IN THE RANGE, THEN REPEAT THAT SET OF RANGE LABELS   *26680000
266900* AS MANY TIMES AS WAS INDICATED IN THE SETS-OF-LABLES FIELD.    *26690000
267000*----------------------------------------------------------------*26700000
267100* RANGE ON LINE 1        EXAMPLE (HR-PORTION INCLUDES SEPARATORS) 26710000
267200*                                                                 26720000
267300*  __ __ __ __ __ __ __ __ __ __ __ __ __ __ __ __ __ __ __ __    26730000
267400*  1  2  3  4  5  6  7  8  9  10 11 12 13 14 15 16 17 18 19 20    26740000
267500*                                                                 26750000
267600* IF A VARYING RANGE FIELD IS IN (1:4), THE REMAINING QUALIFIERS  26760000
267700* AND SEPARATORS, IF SPECIFIED, WILL BE IN (5:16).                26770000
267800* LIKEWISE IF A VARYING RANGE FIELD IS IN (7:4), IT WILL BE       26780000
267900* POSSIBLE FOR OTHER TEXT TO BE IN (1:6) AND (11:10).             26790000
268000***************************************************************** 26800000
268100 2282-CALC-RANGE-POSITIONS.                                       26810000
268200                                                                  26820000
268300                                                                  26830000
268400     IF (ASC-RANGE-REQUESTED AND                                  26840000
268500         ASC-RANGE-VALID)                                         26850000
268600*****> RANGE 1 CALCS                                              26860000
268700       IF ASC-RANGE-IS-ON-LINE-1                                  26870000
268800          INITIALIZE PV-CHAR-CNTR                                 26880000
268900                     PV-SPACE-CNTR                                26890000
269000                     PV-TOT-CHARS-IN-QLFR                         26900000
269100                     PV-TOT-CHAR-CNTR-HR                          26910000
269200                     PV-TOT-CHAR-CNTR-BC                          26920000
269300                     PV-BEGIN-RANGE-POSITION-HR                   26930000
269400                     PV-END-RANGE-POSITION-HR                     26940000
269500                     PV-BEGIN-RANGE-POSITION-BC                   26950000
269600                     PV-END-RANGE-POSITION-BC                     26960000
269700                     PV-HOLD-FOR-BC-RANGE-CALC                    26970000
269800                     PV-HOLD-FOR-HR-RANGE-CALC                    26980000
269900          ADD +4              TO PV-TOT-CHAR-CNTR-HR              26990000
270000                                 PV-TOT-CHAR-CNTR-BC              27000000
270100*** BARCODE AND HR RANGE POSITIONS WOULD BE THE SAME FIRST 4 CHARS27010000
270200          MOVE +1   TO PV-BEGIN-RANGE-POSITION-HR                 27020000
270300                       PV-BEGIN-RANGE-POSITION-BC                 27030000
270400          MOVE +4   TO PV-END-RANGE-POSITION-HR                   27040000
270500                       PV-END-RANGE-POSITION-BC                   27050000
270600*** CONTINUE TO SUM REST OF CHARS IF SPECIFIED IN FREE FORM TEXT  27060000
270700          INITIALIZE PV-SPACE-CNTR                                27070000
270800                     PV-CHAR-CNTR                                 27080000
270900          IF ASC-SEPARATOR-1 > SPACE                              27090000
271000             ADD +1 TO PV-TOT-CHAR-CNTR-HR                        27100000
271100          END-IF                                                  27110000
271200          INSPECT  ASC-QUALIFIER-2                                27120000
271300          TALLYING PV-SPACE-CNTR                                  27130000
271400          FOR ALL ' '                                             27140000
271500          COMPUTE PV-CHAR-CNTR =                                  27150000
271600                  ( +12 - PV-SPACE-CNTR )                         27160000
271700          ADD PV-CHAR-CNTR TO PV-TOT-CHAR-CNTR-HR                 27170000
271800                              PV-TOT-CHAR-CNTR-BC                 27180000
271900          INITIALIZE PV-SPACE-CNTR                                27190000
272000                     PV-CHAR-CNTR                                 27200000
272100          IF ASC-SEPARATOR-2 > SPACE                              27210000
272200             ADD +1 TO PV-TOT-CHAR-CNTR-HR                        27220000
272300          END-IF                                                  27230000
272400          INSPECT  ASC-QUALIFIER-3                                27240000
272500          TALLYING PV-SPACE-CNTR                                  27250000
272600          FOR ALL ' '                                             27260000
272700          COMPUTE PV-CHAR-CNTR =                                  27270000
272800                  ( +12 - PV-SPACE-CNTR )                         27280000
272900          ADD PV-CHAR-CNTR TO PV-TOT-CHAR-CNTR-HR                 27290000
273000                              PV-TOT-CHAR-CNTR-BC                 27300000
273100          INITIALIZE PV-SPACE-CNTR                                27310000
273200                     PV-CHAR-CNTR                                 27320000
273300          IF ASC-SEPARATOR-3 > SPACE                              27330000
273400             ADD +1 TO PV-TOT-CHAR-CNTR-HR                        27340000
273500          END-IF                                                  27350000
273600          INSPECT  ASC-QUALIFIER-4                                27360000
273700          TALLYING PV-SPACE-CNTR                                  27370000
273800          FOR ALL ' '                                             27380000
273900          COMPUTE PV-CHAR-CNTR =                                  27390000
274000                  ( +12 - PV-SPACE-CNTR )                         27400000
274100          ADD PV-CHAR-CNTR TO PV-TOT-CHAR-CNTR-HR                 27410000
274200                              PV-TOT-CHAR-CNTR-BC                 27420000
274300          IF ASC-SEPARATOR-4 > SPACE                              27430000
274400             ADD +1 TO PV-TOT-CHAR-CNTR-HR                        27440000
274500          END-IF                                                  27450000
274600       END-IF                                                     27460000
274700                                                                  27470000
274800*****> RANGE 2 CALCS                                              27480000
274900       IF ASC-RANGE-IS-ON-LINE-2                                  27490000
275000          INITIALIZE PV-CHAR-CNTR                                 27500000
275100                     PV-SPACE-CNTR                                27510000
275200                     PV-TOT-CHARS-IN-QLFR                         27520000
275300                     PV-TOT-CHAR-CNTR-HR                          27530000
275400                     PV-TOT-CHAR-CNTR-BC                          27540000
275500                     PV-BEGIN-RANGE-POSITION-HR                   27550000
275600                     PV-END-RANGE-POSITION-HR                     27560000
275700                     PV-BEGIN-RANGE-POSITION-BC                   27570000
275800                     PV-END-RANGE-POSITION-BC                     27580000
275900                     PV-HOLD-FOR-BC-RANGE-CALC                    27590000
276000                     PV-HOLD-FOR-HR-RANGE-CALC                    27600000
276100          ADD +4              TO PV-TOT-CHAR-CNTR-HR              27610000
276200                                 PV-TOT-CHAR-CNTR-BC              27620000
276300          INSPECT  ASC-QUALIFIER-1                                27630000
276400          TALLYING PV-SPACE-CNTR                                  27640000
276500          FOR ALL ' '                                             27650000
276600          COMPUTE PV-CHAR-CNTR =                                  27660000
276700                  ( +12 - PV-SPACE-CNTR )                         27670000
276800          ADD  PV-CHAR-CNTR   TO PV-TOT-CHARS-IN-QLFR             27680000
276900                                 PV-TOT-CHAR-CNTR-HR              27690000
277000                                 PV-TOT-CHAR-CNTR-BC              27700000
277100*** CALC BARCODE RANGE POSITIONS (SEPARATORS ARE NOT IN BARCODE)  27710000
277200          ADD PV-TOT-CHARS-IN-QLFR  TO PV-HOLD-FOR-BC-RANGE-CALC  27720000
277300          ADD +1     TO PV-HOLD-FOR-BC-RANGE-CALC                 27730000
277400          MOVE  PV-HOLD-FOR-BC-RANGE-CALC  TO                     27740000
277500                      PV-BEGIN-RANGE-POSITION-BC                  27750000
277600          ADD +3     TO PV-HOLD-FOR-BC-RANGE-CALC                 27760000
277700          MOVE  PV-HOLD-FOR-BC-RANGE-CALC  TO                     27770000
277800                     PV-END-RANGE-POSITION-BC                     27780000
277900          IF ASC-SEPARATOR-1 > SPACE                              27790000
278000             ADD +1  TO PV-CHAR-CNTR                              27800000
278100                        PV-TOT-CHAR-CNTR-HR                       27810000
278200          END-IF                                                  27820000
278300*** USE CURRENT PV-CHAR-CNTR VALUE TO CALC HR RANGE POSITIONS     27830000
278400          ADD +1     TO PV-CHAR-CNTR                              27840000
278500          MOVE PV-CHAR-CNTR TO PV-BEGIN-RANGE-POSITION-HR         27850000
278600                               PV-HOLD-FOR-HR-RANGE-CALC          27860000
278700          ADD +3                    TO PV-HOLD-FOR-HR-RANGE-CALC  27870000
278800          MOVE  PV-HOLD-FOR-HR-RANGE-CALC  TO                     27880000
278900                     PV-END-RANGE-POSITION-HR                     27890000
279000*** CONTINUE TO SUM REST OF CHARS IF SPECIFIED IN FREE FORM TEXT  27900000
279100          INITIALIZE PV-SPACE-CNTR                                27910000
279200                     PV-CHAR-CNTR                                 27920000
279300          IF ASC-SEPARATOR-2 > SPACE                              27930000
279400             ADD +1 TO PV-TOT-CHAR-CNTR-HR                        27940000
279500          END-IF                                                  27950000
279600          INSPECT  ASC-QUALIFIER-3                                27960000
279700          TALLYING PV-SPACE-CNTR                                  27970000
279800          FOR ALL ' '                                             27980000
279900          COMPUTE PV-CHAR-CNTR =                                  27990000
280000                  ( +12 - PV-SPACE-CNTR )                         28000000
280100          ADD PV-CHAR-CNTR TO PV-TOT-CHAR-CNTR-HR                 28010000
280200                              PV-TOT-CHAR-CNTR-BC                 28020000
280300          IF ASC-SEPARATOR-3 > SPACE                              28030000
280400             ADD +1 TO PV-TOT-CHAR-CNTR-HR                        28040000
280500          END-IF                                                  28050000
280600          INITIALIZE PV-SPACE-CNTR                                28060000
280700                     PV-CHAR-CNTR                                 28070000
280800          INSPECT  ASC-QUALIFIER-4                                28080000
280900          TALLYING PV-SPACE-CNTR                                  28090000
281000          FOR ALL ' '                                             28100000
281100          COMPUTE PV-CHAR-CNTR =                                  28110000
281200                  ( +12 - PV-SPACE-CNTR )                         28120000
281300          ADD PV-CHAR-CNTR TO PV-TOT-CHAR-CNTR-HR                 28130000
281400                              PV-TOT-CHAR-CNTR-BC                 28140000
281500          IF ASC-SEPARATOR-4 > SPACE                              28150000
281600             ADD +1 TO PV-TOT-CHAR-CNTR-HR                        28160000
281700          END-IF                                                  28170000
281800       END-IF                                                     28180000
281900*****> RANGE 3 CALCS                                              28190000
282000       IF ASC-RANGE-IS-ON-LINE-3                                  28200000
282100          INITIALIZE PV-CHAR-CNTR                                 28210000
282200                     PV-SPACE-CNTR                                28220000
282300                     PV-TOT-CHARS-IN-QLFR                         28230000
282400                     PV-TOT-PRECEDING-CHARS                       28240000
282500                     PV-TOT-CHAR-CNTR-HR                          28250000
282600                     PV-TOT-CHAR-CNTR-BC                          28260000
282700                     PV-BEGIN-RANGE-POSITION-HR                   28270000
282800                     PV-END-RANGE-POSITION-HR                     28280000
282900                     PV-BEGIN-RANGE-POSITION-BC                   28290000
283000                     PV-END-RANGE-POSITION-BC                     28300000
283100                     PV-HOLD-FOR-BC-RANGE-CALC                    28310000
283200                     PV-HOLD-FOR-HR-RANGE-CALC                    28320000
283300          ADD +4              TO PV-TOT-CHAR-CNTR-HR              28330000
283400                                 PV-TOT-CHAR-CNTR-BC              28340000
283500          INSPECT  ASC-QUALIFIER-1                                28350000
283600          TALLYING PV-SPACE-CNTR                                  28360000
283700          FOR ALL ' '                                             28370000
283800          COMPUTE PV-CHAR-CNTR =                                  28380000
283900                  ( +12 - PV-SPACE-CNTR )                         28390000
284000          ADD  PV-CHAR-CNTR   TO PV-TOT-PRECEDING-CHARS           28400000
284100                                 PV-TOT-CHAR-CNTR-HR              28410000
284200                                 PV-TOT-CHAR-CNTR-BC              28420000
284300          IF ASC-SEPARATOR-1 > SPACE                              28430000
284400             ADD +1 TO PV-TOT-CHAR-CNTR-HR                        28440000
284500                       PV-TOT-PRECEDING-CHARS                     28450000
284600          END-IF                                                  28460000
284700          INITIALIZE PV-SPACE-CNTR                                28470000
284800                     PV-CHAR-CNTR                                 28480000
284900          INSPECT  ASC-QUALIFIER-2                                28490000
285000          TALLYING PV-SPACE-CNTR                                  28500000
285100          FOR ALL ' '                                             28510000
285200          COMPUTE PV-CHAR-CNTR =                                  28520000
285300                  ( +12 - PV-SPACE-CNTR )                         28530000
285400          ADD  PV-CHAR-CNTR   TO PV-TOT-PRECEDING-CHARS           28540000
285500                                 PV-TOT-CHAR-CNTR-HR              28550000
285600                                 PV-TOT-CHAR-CNTR-BC              28560000
285700          IF ASC-SEPARATOR-2 > SPACE                              28570000
285800             ADD +1 TO PV-TOT-CHAR-CNTR-HR                        28580000
285900                       PV-TOT-PRECEDING-CHARS                     28590000
286000          END-IF                                                  28600000
286100*** CALC BARCODE RANGE POSITIONS (SEPARATORS ARE NOT IN BARCODE)  28610000
286200          MOVE PV-TOT-PRECEDING-CHARS     TO                      28620000
286300                     PV-HOLD-FOR-BC-RANGE-CALC                    28630000
286400          SUBTRACT +1  FROM PV-HOLD-FOR-BC-RANGE-CALC             28640000
286500          MOVE PV-HOLD-FOR-BC-RANGE-CALC  TO                      28650000
286600                     PV-BEGIN-RANGE-POSITION-BC                   28660000
286700          ADD +3  TO PV-HOLD-FOR-BC-RANGE-CALC                    28670000
286800          MOVE PV-HOLD-FOR-BC-RANGE-CALC  TO                      28680000
286900                     PV-END-RANGE-POSITION-BC                     28690000
287000*** CALC HR RANGE POSITIONS                                       28700000
287100          MOVE PV-TOT-PRECEDING-CHARS     TO                      28710000
287200                     PV-HOLD-FOR-HR-RANGE-CALC                    28720000
287300          ADD +1  TO PV-HOLD-FOR-HR-RANGE-CALC                    28730000
287400          MOVE PV-HOLD-FOR-HR-RANGE-CALC  TO                      28740000
287500                     PV-BEGIN-RANGE-POSITION-HR                   28750000
287600          ADD +3  TO PV-HOLD-FOR-HR-RANGE-CALC                    28760000
287700          MOVE PV-HOLD-FOR-HR-RANGE-CALC  TO                      28770000
287800                     PV-END-RANGE-POSITION-HR                     28780000
287900*** CONTINUE TO SUM REST OF CHARS IF SPECIFIED IN FREE FORM TEXT  28790000
288000          IF ASC-SEPARATOR-3 > SPACE                              28800000
288100             ADD +1 TO PV-TOT-CHAR-CNTR-HR                        28810000
288200          END-IF                                                  28820000
288300          INITIALIZE PV-SPACE-CNTR                                28830000
288400                     PV-CHAR-CNTR                                 28840000
288500          INSPECT  ASC-QUALIFIER-4                                28850000
288600          TALLYING PV-SPACE-CNTR                                  28860000
288700          FOR ALL ' '                                             28870000
288800          COMPUTE PV-CHAR-CNTR =                                  28880000
288900                  ( +12 - PV-SPACE-CNTR )                         28890000
289000          ADD PV-CHAR-CNTR TO PV-TOT-CHAR-CNTR-HR                 28900000
289100                              PV-TOT-CHAR-CNTR-BC                 28910000
289200          IF ASC-SEPARATOR-4 > SPACE                              28920000
289300             ADD +1 TO PV-TOT-CHAR-CNTR-HR                        28930000
289400          END-IF                                                  28940000
289500       END-IF                                                     28950000
289600*****> RANGE 4 CALCS                                              28960000
289700       IF ASC-RANGE-IS-ON-LINE-4                                  28970000
289800          INITIALIZE PV-CHAR-CNTR                                 28980000
289900                     PV-SPACE-CNTR                                28990000
290000                     PV-TOT-CHARS-IN-QLFR                         29000000
290100                     PV-TOT-PRECEDING-CHARS                       29010000
290200                     PV-TOT-CHAR-CNTR-HR                          29020000
290300                     PV-TOT-CHAR-CNTR-BC                          29030000
290400                     PV-BEGIN-RANGE-POSITION-HR                   29040000
290500                     PV-END-RANGE-POSITION-HR                     29050000
290600                     PV-BEGIN-RANGE-POSITION-BC                   29060000
290700                     PV-END-RANGE-POSITION-BC                     29070000
290800                     PV-HOLD-FOR-BC-RANGE-CALC                    29080000
290900                     PV-HOLD-FOR-HR-RANGE-CALC                    29090000
291000          ADD +4              TO PV-TOT-CHAR-CNTR-HR              29100000
291100                                 PV-TOT-CHAR-CNTR-BC              29110000
291200          INSPECT  ASC-QUALIFIER-1                                29120000
291300          TALLYING PV-SPACE-CNTR                                  29130000
291400          FOR ALL ' '                                             29140000
291500          COMPUTE PV-CHAR-CNTR =                                  29150000
291600                  ( +12 - PV-SPACE-CNTR )                         29160000
291700          ADD  PV-CHAR-CNTR   TO PV-TOT-PRECEDING-CHARS           29170000
291800                                 PV-TOT-CHAR-CNTR-HR              29180000
291900                                 PV-TOT-CHAR-CNTR-BC              29190000
292000          IF ASC-SEPARATOR-1 > SPACE                              29200000
292100             ADD +1 TO PV-TOT-CHAR-CNTR-HR                        29210000
292200                       PV-TOT-PRECEDING-CHARS                     29220000
292300          END-IF                                                  29230000
292400          INITIALIZE PV-SPACE-CNTR                                29240000
292500                     PV-CHAR-CNTR                                 29250000
292600          INSPECT  ASC-QUALIFIER-2                                29260000
292700          TALLYING PV-SPACE-CNTR                                  29270000
292800          FOR ALL ' '                                             29280000
292900          COMPUTE PV-CHAR-CNTR =                                  29290000
293000                  ( +12 - PV-SPACE-CNTR )                         29300000
293100          ADD  PV-CHAR-CNTR   TO PV-TOT-PRECEDING-CHARS           29310000
293200                                 PV-TOT-CHAR-CNTR-HR              29320000
293300                                 PV-TOT-CHAR-CNTR-BC              29330000
293400          IF ASC-SEPARATOR-2 > SPACE                              29340000
293500             ADD +1 TO PV-TOT-CHAR-CNTR-HR                        29350000
293600                       PV-TOT-PRECEDING-CHARS                     29360000
293700          END-IF                                                  29370000
293800          INITIALIZE PV-SPACE-CNTR                                29380000
293900                     PV-CHAR-CNTR                                 29390000
294000          INSPECT  ASC-QUALIFIER-3                                29400000
294100          TALLYING PV-SPACE-CNTR                                  29410000
294200          FOR ALL ' '                                             29420000
294300          COMPUTE PV-CHAR-CNTR =                                  29430000
294400                  ( +12 - PV-SPACE-CNTR )                         29440000
294500          ADD  PV-CHAR-CNTR   TO PV-TOT-PRECEDING-CHARS           29450000
294600                                 PV-TOT-CHAR-CNTR-HR              29460000
294700                                 PV-TOT-CHAR-CNTR-BC              29470000
294800          IF ASC-SEPARATOR-3 > SPACE                              29480000
294900             ADD +1 TO PV-TOT-CHAR-CNTR-HR                        29490000
295000                       PV-TOT-PRECEDING-CHARS                     29500000
295100          END-IF                                                  29510000
295200*** CALC BARCODE RANGE POSITIONS (SEPARATORS ARE NOT IN BARCODE)  29520000
295300          MOVE PV-TOT-PRECEDING-CHARS     TO                      29530000
295400                     PV-HOLD-FOR-BC-RANGE-CALC                    29540000
295500** SUBTRACT 2 FOR THE 2 SEPARATORS ENCOUNTERED SO FAR             29550000
295600          SUBTRACT +2  FROM PV-HOLD-FOR-BC-RANGE-CALC             29560000
295700          MOVE PV-HOLD-FOR-BC-RANGE-CALC  TO                      29570000
295800                     PV-BEGIN-RANGE-POSITION-BC                   29580000
295900          ADD +3  TO PV-HOLD-FOR-BC-RANGE-CALC                    29590000
296000          MOVE PV-HOLD-FOR-BC-RANGE-CALC  TO                      29600000
296100                     PV-END-RANGE-POSITION-BC                     29610000
296200*** CALC HR RANGE POSITIONS                                       29620000
296300          MOVE PV-TOT-PRECEDING-CHARS     TO                      29630000
296400                     PV-HOLD-FOR-HR-RANGE-CALC                    29640000
296500          ADD +1  TO PV-HOLD-FOR-HR-RANGE-CALC                    29650000
296600          MOVE PV-HOLD-FOR-HR-RANGE-CALC  TO                      29660000
296700                     PV-BEGIN-RANGE-POSITION-HR                   29670000
296800          ADD +3  TO PV-HOLD-FOR-HR-RANGE-CALC                    29680000
296900          MOVE PV-HOLD-FOR-HR-RANGE-CALC  TO                      29690000
297000                     PV-END-RANGE-POSITION-HR                     29700000
297100*** CONTINUE TO SUM REST OF CHARS IF SPECIFIED IN FREE FORM TEXT  29710000
297200          IF ASC-SEPARATOR-4 > SPACE                              29720000
297300             ADD +1 TO PV-TOT-CHAR-CNTR-HR                        29730000
297400          END-IF                                                  29740000
297500       END-IF                                                     29750000
297600     END-IF.                                                      29760000
297700                                                                  29770000
297800          MOVE PV-BEGIN-RANGE-POSITION-HR TO                      29780000
297900                              PC140-ML-BEGIN-RANGE-POSN-HR.       29790000
298000          MOVE PV-END-RANGE-POSITION-HR   TO                      29800000
298100                              PC140-ML-END-RANGE-POSN-HR.         29810000
298200          MOVE PV-BEGIN-RANGE-POSITION-BC TO                      29820000
298300                              PC140-ML-BEGIN-RANGE-POSN-BC.       29830000
298400          MOVE PV-END-RANGE-POSITION-BC   TO                      29840000
298500                              PC140-ML-END-RANGE-POSN-BC.         29850000
298600                                                                  29860000
298700 EJECT                                                            29870000
298800***************************************************************** 29880000
298900* RIGHT JUSTIFY THE FIELD AND PAD WITH LEADING ZEROES           * 29890000
299000* THE QUALIFIER MAY OR MAY NOT BE PART OF A RANGE, BUT THAT     * 29900000
299100* WILL BE DETERMINED IN THE EDITS. SO FOR NOW, A QUALIFIER      * 29910000
299200* CAN HAVE MORE THAN 4 CHARS. THE -Q REFERS TO QUALIFIER.       * 29920000
299300***************************************************************** 29930000
299400 2285-ALPHA-TO-NUM-CONVERSION-Q.                                  29940000
299500                                                                  29950000
299600                                                                  29960000
299700     INITIALIZE PV-SPACE-CNTR                                     29970000
299800                PV-CHAR-CNTR                                      29980000
299900                PV-CONVERSION-FIELD-9.                            29990000
300000                                                                  30000000
300100     INSPECT  PV-CONVERSION-FIELD-X                               30010000
300200     TALLYING PV-SPACE-CNTR                                       30020000
300300     FOR ALL ' '                                                  30030000
300400     COMPUTE PV-CHAR-CNTR =                                       30040000
300500             ( +12 - PV-SPACE-CNTR ).                             30050000
300600                                                                  30060000
300700     EVALUATE PV-CHAR-CNTR                                        30070000
300800         WHEN PC-1                                                30080000
300900              MOVE PV-CONVERSION-FIELD-X (1:1)                    30090000
301000                TO PV-CONVERSION-FIELD-9 (12:1)                   30100000
301100         WHEN PC-2                                                30110000
301200              MOVE PV-CONVERSION-FIELD-X (1:2)                    30120000
301300                TO PV-CONVERSION-FIELD-9 (11:2)                   30130000
301400         WHEN PC-3                                                30140000
301500              MOVE PV-CONVERSION-FIELD-X (1:3)                    30150000
301600                TO PV-CONVERSION-FIELD-9 (10:3)                   30160000
301700         WHEN PC-4                                                30170000
301800              MOVE PV-CONVERSION-FIELD-X (1:4)                    30180000
301900                TO PV-CONVERSION-FIELD-9 (9:4)                    30190000
302000         WHEN PC-5                                                30200000
302100              MOVE PV-CONVERSION-FIELD-X (1:5)                    30210000
302200                TO PV-CONVERSION-FIELD-9 (8:5)                    30220000
302300         WHEN PC-6                                                30230000
302400              MOVE PV-CONVERSION-FIELD-X (1:6)                    30240000
302500                TO PV-CONVERSION-FIELD-9 (7:6)                    30250000
302600         WHEN PC-7                                                30260000
302700              MOVE PV-CONVERSION-FIELD-X (1:7)                    30270000
302800                TO PV-CONVERSION-FIELD-9 (6:7)                    30280000
302900         WHEN PC-8                                                30290000
303000              MOVE PV-CONVERSION-FIELD-X (1:8)                    30300000
303100                TO PV-CONVERSION-FIELD-9 (5:8)                    30310000
303200         WHEN PC-9                                                30320000
303300              MOVE PV-CONVERSION-FIELD-X (1:9)                    30330000
303400                TO PV-CONVERSION-FIELD-9 (4:9)                    30340000
303500         WHEN PC-10                                               30350000
303600              MOVE PV-CONVERSION-FIELD-X (1:10)                   30360000
303700                TO PV-CONVERSION-FIELD-9 (3:10)                   30370000
303800         WHEN PC-11                                               30380000
303900              MOVE PV-CONVERSION-FIELD-X (1:11)                   30390000
304000                TO PV-CONVERSION-FIELD-9 (2:11)                   30400000
304100         WHEN PC-12                                               30410000
304200              MOVE PV-CONVERSION-FIELD-X (1:12)                   30420000
304300                TO PV-CONVERSION-FIELD-9 (1:12)                   30430000
304400     END-EVALUATE.                                                30440000
304500                                                                  30450000
304600 EJECT                                                            30460000
304700                                                                  30470000
304800***************************************************************** 30480000
304900* RIGHT JUSTIFY THE FIELD AND PAD WITH LEADING ZEROES           * 30490000
305000* IF A RANGE WILL BE USED, IT WILL BE DETERMINED IN THE EDITS,  * 30500000
305100* FOR NOW, A RANGE VALUE CAN ONLY BE 4 CHARS IN LENGTH.         * 30510000
305200***************************************************************** 30520000
305300 2286-ALPHA-TO-NUM-CONVERSION-R.                                  30530000
305400                                                                  30540000
305500     INITIALIZE PV-SPACE-CNTR                                     30550000
305600                PV-CHAR-CNTR                                      30560000
305700                PV-CONVERSION-FIELD-9.                            30570000
305800                                                                  30580000
305900     INSPECT  PV-CONVERSION-FIELD-X                               30590000
306000     TALLYING PV-SPACE-CNTR                                       30600000
306100     FOR ALL ' '                                                  30610000
306200     COMPUTE PV-CHAR-CNTR =                                       30620000
306300             ( +12 - PV-SPACE-CNTR ).                             30630000
306400                                                                  30640000
306500     EVALUATE PV-CHAR-CNTR                                        30650000
306600         WHEN PC-1                                                30660000
306700              MOVE PV-CONVERSION-FIELD-X (1:1)                    30670000
306800                TO PV-CONVERSION-FIELD-9 (12:1)                   30680000
306900               SET ASC-TOTAL-WITHIN-LIMITS TO TRUE                30690000
307000         WHEN PC-2                                                30700000
307100              MOVE PV-CONVERSION-FIELD-X (1:2)                    30710000
307200                TO PV-CONVERSION-FIELD-9 (11:2)                   30720000
307300               SET ASC-TOTAL-WITHIN-LIMITS TO TRUE                30730000
307400         WHEN PC-3                                                30740000
307500              MOVE PV-CONVERSION-FIELD-X (1:3)                    30750000
307600                TO PV-CONVERSION-FIELD-9 (10:3)                   30760000
307700               SET ASC-TOTAL-WITHIN-LIMITS TO TRUE                30770000
307800         WHEN PC-4                                                30780000
307900              MOVE PV-CONVERSION-FIELD-X (1:4)                    30790000
308000                TO PV-CONVERSION-FIELD-9 (9:4)                    30800000
308100               SET ASC-TOTAL-WITHIN-LIMITS TO TRUE                30810000
308200         WHEN OTHER                                               30820000
308300              SET PS-ERROR            TO TRUE                     30830000
308400              SET DP020-MSG-FATAL     TO TRUE                     30840000
308500              MOVE PC-TSYMSG-02506    TO DP020-MSG-NUMBER         30850000
308600              SET ASC-TOTAL-WITHIN-LIMITS-NO TO TRUE              30860000
308700              EVALUATE TRUE                                       30870000
308800                 WHEN ((ASC-RANGE1-SPECIFIED     AND              30880000
308900                        ASC-RANGE1-IS-NUMERIC))                   30890000
309000                        MOVE DP015-UNP-ALP-BRT-OFF                30900000
309100                                            TO ARANGE1A           30910000
309200                        MOVE DP015-RED      TO ARANGE1C           30920000
309300                        MOVE DP015-REVERSE  TO ARANGE1H           30930000
309400                        MOVE -1             TO ARANGE1L           30940000
309500                        SET DP030-SET-CURSOR-APPL-1               30950000
309600                                            TO TRUE               30960000
309700                 WHEN ((ASC-RANGE2-SPECIFIED     AND              30970000
309800                        ASC-RANGE2-IS-NUMERIC))                   30980000
309900                        MOVE DP015-UNP-ALP-BRT-OFF                30990000
310000                                            TO ARANGE2A           31000000
310100                        MOVE DP015-RED      TO ARANGE2C           31010000
310200                        MOVE DP015-REVERSE  TO ARANGE2H           31020000
310300                        MOVE -1             TO ARANGE2L           31030000
310400                        SET DP030-SET-CURSOR-APPL-1               31040000
310500                                            TO TRUE               31050000
310600                 WHEN ((ASC-RANGE3-SPECIFIED     AND              31060000
310700                        ASC-RANGE3-IS-NUMERIC))                   31070000
310800                        MOVE DP015-UNP-ALP-BRT-OFF                31080000
310900                                            TO ARANGE3A           31090000
311000                        MOVE DP015-RED      TO ARANGE3C           31100000
311100                        MOVE DP015-REVERSE  TO ARANGE3H           31110000
311200                        MOVE -1             TO ARANGE3L           31120000
311300                        SET DP030-SET-CURSOR-APPL-1               31130000
311400                                            TO TRUE               31140000
311500                 WHEN ((ASC-RANGE4-SPECIFIED     AND              31150000
311600                        ASC-RANGE4-IS-NUMERIC))                   31160000
311700                        MOVE DP015-UNP-ALP-BRT-OFF                31170000
311800                                            TO ARANGE4A           31180000
311900                        MOVE DP015-RED      TO ARANGE4C           31190000
312000                        MOVE DP015-REVERSE  TO ARANGE4H           31200000
312100                        MOVE -1             TO ARANGE4L           31210000
312200                        SET DP030-SET-CURSOR-APPL-1               31220000
312300                                            TO TRUE               31230000
312400              END-EVALUATE                                        31240000
312500     END-EVALUATE.                                                31250000
312600                                                                  31260000
312700 EJECT                                                            31270000
312800                                                                  31280000
312900*----------------------------------------------------------------*31290000
313000*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *31300000
313100*----------------------------------------------------------------*31310000
313200 2300-MOVE-COMMAREA-TO-SCREEN.                                    31320000
313300                                                                  31330000
313400     MOVE ASC-OPER-UNT-ID-N      TO PV-SUPPRESS-FOUR.             31340000
313500     MOVE PV-SUPPRESS-FOUR       TO AOPUNITO.                     31350000
313600     MOVE ASC-OPER-UNT-NME       TO AOPDESCO.                     31360000
313700     MOVE ASC-FCLTY-ID-N         TO PV-SUPPRESS-FOUR.             31370000
313800     MOVE PV-SUPPRESS-FOUR       TO AFACILO.                      31380000
313900     MOVE ASC-PRTR-ID            TO APRTRO.                       31390000
314000     MOVE ASC-PRTR-DESC          TO APRDESCO.                     31400000
314100     IF ASC-SETS-OF-LABELS   >   '0001'                           31410000
314200     MOVE ASC-SETS-OF-LABELS     TO PV-SUPPRESS-FOUR              31420000
314300     MOVE PV-SUPPRESS-FOUR       TO ASETSO                        31430000
314400     ELSE                                                         31440000
314500     MOVE ASC-SETS-OF-LABELS-N   TO PV-SUPPRESS-FOUR              31450000
314600     MOVE PV-SUPPRESS-FOUR       TO ASETSO                        31460000
314700     END-IF.                                                      31470000
314800     MOVE ASC-QUALIFIER-1        TO AQLFR1O.                      31480000
314900     MOVE ASC-QUALIFIER-2        TO AQLFR2O.                      31490000
315000     MOVE ASC-QUALIFIER-3        TO AQLFR3O.                      31500000
315100     MOVE ASC-QUALIFIER-4        TO AQLFR4O.                      31510000
315200     MOVE ASC-RANGE-1            TO ARANGE1O.                     31520000
315300     MOVE ASC-RANGE-2            TO ARANGE2O.                     31530000
315400     MOVE ASC-RANGE-3            TO ARANGE3O.                     31540000
315500     MOVE ASC-RANGE-4            TO ARANGE4O.                     31550000
315600     MOVE ASC-SEPARATOR-1        TO ASEPR1O.                      31560000
315700     MOVE ASC-SEPARATOR-2        TO ASEPR2O.                      31570000
315800     MOVE ASC-SEPARATOR-3        TO ASEPR3O.                      31580000
315900     MOVE ASC-SEPARATOR-4        TO ASEPR4O.                      31590000
315901                                                                  31590199
315910     MOVE ASC-PRINT-BRCDE        TO APRTBR1O.                     31591099
316000     MOVE ASC-LABEL-COMMENTS-1   TO ACMNT1O.                      31600000
316100     MOVE ASC-LABEL-COMMENTS-2   TO ACMNT2O.                      31610000
316200     MOVE ASC-LABEL-COMMENTS-3   TO ACMNT3O.                      31620000
316300                                                                  31630000
316400 EJECT                                                            31640000
316500*----------------------------------------------------------------*31650000
316600*    DISPLAY A BLANK MAP EXCEPT FOR THE 1 WHICH IS THE DEFAULT   *31660000
316700*    VALUE FOR THE "SETS OF LABELS" FIELD.                       *31670000
316800*----------------------------------------------------------------*31680000
316900 3000-BUILD-INITIAL-PANEL.                                        31690000
317000                                                                  31700000
317100     EVALUATE TRUE                                                31710000
317200         WHEN DP020-NEXT-ACT-INITIAL                              31720000
317300         WHEN DP020-NEXT-ACT-RETURN                               31730000
317400         WHEN DP020-NEXT-ACT-READ-MAP                             31740000
317500              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 31750000
317600              MOVE -1                     TO APRTRL               31760000
317700              MOVE +0001                  TO PV-SUPPRESS-FOUR     31770000
317800              MOVE PV-SUPPRESS-FOUR       TO ASETSI               31780000
317810              MOVE PC-Y                   TO APRTBR1O             31781099
317900         WHEN OTHER                                               31790000
318000           IF ASC-KEEP-SETS-VALUE-NO                              31800000
318100              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 31810000
318200              MOVE -1                     TO APRTRL               31820000
318300              MOVE +0001                  TO PV-SUPPRESS-FOUR     31830000
318400              MOVE PV-SUPPRESS-FOUR       TO ASETSI               31840000
318500           ELSE                                                   31850000
318600              MOVE ASC-SETS-OF-LABELS-N   TO PV-SUPPRESS-FOUR     31860000
318700              MOVE PV-SUPPRESS-FOUR       TO ASETSI               31870000
318800           END-IF                                                 31880000
318900           IF ASC-LABEL-PRINT-COMPLETE                            31890000
319000              MOVE -1                     TO AQLFR1L              31900000
319100              MOVE +0001                  TO PV-SUPPRESS-FOUR     31910000
319200              MOVE PV-SUPPRESS-FOUR       TO ASETSI               31920000
319300              SET ASC-LABEL-PRINT-COMPLETE-NO  TO TRUE            31930000
319400           END-IF                                                 31940000
319410           MOVE PC-Y                      TO APRTBR1I             31941099
319500     END-EVALUATE.                                                31950000
319600                                                                  31960000
319700     PERFORM DP017-0000-GET-CURR-DATE-TIME.                       31970000
319800                                                                  31980000
319900**** DEFAULT OPERATING UNIT AND FACILITY                          31990000
320000     PERFORM 3300-FORMAT-OP-UNIT.                                 32000000
320100     PERFORM 3400-FORMAT-FCLTY-ID.                                32010000
320200                                                                  32020000
320300     PERFORM 3200-DISPLAY-PANEL.                                  32030000
320400                                                                  32040000
320500 EJECT                                                            32050000
320600*----------------------------------------------------------------*32060000
320700*    FILL THE MAP WITH THE NECESSARY DATA AND WRITE IT OUT.      *32070000
320800*----------------------------------------------------------------*32080000
320900 3200-DISPLAY-PANEL.                                              32090000
321000                                                                  32100000
321100     MOVE PC-CURRENT-MAPSET-NAME TO DP030-MAPSET-NAME.            32110000
321200     MOVE PC-CURRENT-MAP-NAME    TO DP030-MAP-NAME (1).           32120000
321300                                                                  32130000
321400 EJECT                                                            32140000
321500*----------------------------------------------------------------*32150000
321600*  CALL DPKUT100 NUMERIC EDIT                                    *32160000
321700*----------------------------------------------------------------*32170000
321800 3300-FORMAT-OP-UNIT.                                             32180000
321900                                                                  32190000
322000     MOVE DP020-LOCATION-NBR     TO DP010I-UNEDITED-FIELD.        32200099
322100     MOVE +4                     TO DP010I-MAXIMUM-DIGITS.        32210000
322200     MOVE +0                     TO DP010I-MAXIMUM-DECIMALS.      32220000
322300                                                                  32230000
322400     SET DP010I-NEGATIVE-NOT-ALLOWED                              32240000
322500                                 TO TRUE.                         32250000
322600                                                                  32260000
322710     CALL DP010I-NUMERIC-EDIT-ROUTINE                             32271099
322720                         USING DP010I-NUMERIC-EDIT-AREA           32272099
322800                                                                  32280000
322900     IF DP010I-NO-ERROR-DETECTED                                  32290000
323000         MOVE DP010I-NUMERIC-FIELD                                32300000
323100                                 TO PV-PIC9-FOUR                  32310000
323200         MOVE PV-PICX-FOUR       TO PV-SUPPRESS-FOUR              32320000
323300         MOVE PV-SUPPRESS-FOUR   TO AOPUNITO                      32330000
323400                                    ASC-OPER-UNT-ID               32340000
323500     ELSE                                                         32350000
323600         MOVE DP020-LOCATION-NBR TO PV-PICX-FOUR                  32360099
323700         MOVE PV-PICX-FOUR       TO PV-SUPPRESS-FOUR              32370000
323800         MOVE PV-SUPPRESS-FOUR   TO AOPUNITO                      32380000
323900                                    ASC-OPER-UNT-ID               32390000
324000     END-IF.                                                      32400000
324100                                                                  32410000
324200 EJECT                                                            32420000
324300*----------------------------------------------------------------*32430000
324400* CALL DPKUT100 NUMERIC EDIT                                     *32440000
324500*----------------------------------------------------------------*32450000
324600 3400-FORMAT-FCLTY-ID.                                            32460000
324700                                                                  32470000
324800     MOVE DP020-FCLTY-ID         TO DP010I-UNEDITED-FIELD.        32480000
324900     MOVE +4                     TO DP010I-MAXIMUM-DIGITS.        32490000
325000     MOVE +0                     TO DP010I-MAXIMUM-DECIMALS.      32500000
325100                                                                  32510000
325200     SET DP010I-NEGATIVE-NOT-ALLOWED                              32520000
325300                                 TO TRUE.                         32530000
325400                                                                  32540000
325510     CALL DP010I-NUMERIC-EDIT-ROUTINE                             32551099
325520                         USING DP010I-NUMERIC-EDIT-AREA           32552099
325600                                                                  32560000
325700     IF DP010I-NO-ERROR-DETECTED                                  32570000
325800         MOVE DP010I-NUMERIC-FIELD                                32580000
325900                                 TO PV-PIC9-FOUR                  32590000
326000         MOVE PV-PICX-FOUR       TO PV-SUPPRESS-FOUR              32600000
326100         MOVE PV-SUPPRESS-FOUR   TO AFACILO                       32610000
326200                                    ASC-FCLTY-ID-N                32620000
326300     ELSE                                                         32630000
326400         MOVE DP020-FCLTY-ID     TO AFACILO                       32640099
326500                                    ASC-FCLTY-ID                  32650000
326600         SET PS-ERROR            TO TRUE                          32660000
326700         SET DP020-MSG-FATAL     TO TRUE                          32670000
326800         MOVE PC-TSYMSG-00005                                     32680000
326900                                 TO DP020-MSG-NUMBER              32690000
327000         MOVE DP015-UNP-ALP-BRT-OFF                               32700000
327100                                 TO AFACILA                       32710000
327200         MOVE DP015-RED          TO AFACILC                       32720000
327300         MOVE DP015-REVERSE      TO AFACILH                       32730000
327400         MOVE -1                 TO AFACILL                       32740000
327500         SET DP030-SET-CURSOR-APPL-1                              32750000
327600                                 TO TRUE                          32760000
327700     END-IF.                                                      32770000
327800                                                                  32780000
327900 EJECT                                                            32790000
328000*----------------------------------------------------------------*32800000
328100*  THIS WILL BE USED TO FORMAT PRINTER ID ON BOTTOM OF LABEL.    *32810000
328200*----------------------------------------------------------------*32820000
328300 3500-GET-DC-LOCATION.                                            32830000
328400     EXEC SQL                                                     32840000
328500          SELECT LOC_5_ABBR_NM                                    32850099
328600          INTO  :PV-DC-5-CHAR-ABBR                                32860000
328700          FROM   XLT_LOC                                          32870099
328800          WHERE  LOC_TYP_CDE = 'DC'                               32880099
328900          AND    LOC_NBR     = :PC-OPER-UNT-ID                    32890099
329000     END-EXEC.                                                    32900000
329100                                                                  32910000
329200     EVALUATE TRUE                                                32920000
329300         WHEN SQLCODE = ZERO                                      32930000
329400              MOVE  PV-2-DIGIT-DC-ABBR  TO  PC140-CRA-DC-ID       32940000
329500              MOVE  PC-OPER-UNT-ID      TO  PC140-CRA-OPER-UNT-ID 32950000
329600                                                                  32960000
329700         WHEN SQLCODE = +100                                      32970000
329800              MOVE  PC-90   TO  PC140-CRA-DC-ID                   32980000
329900                                PC140-CRA-OPER-UNT-ID             32990000
330000                                                                  33000000
330100         WHEN SQLWARN0 NOT = SPACES                               33010000
330200         WHEN SQLCODE NOT EQUAL ZERO                              33020000
330300             MOVE '3500-GET-DC-LOCATION'                          33030000
330400                             TO DP013-PARAGRAPH                   33040000
330500             MOVE 'PCKCS717 - GET DC LOCATION CODE'               33050000
330600                             TO DP013-MESSAGE-TEXT(1)             33060000
330700             MOVE PC140-CRA-DC-ID                                 33070000
330800                             TO DP013-MESSAGE-TEXT(2)             33080000
330900             MOVE SQLCA      TO DP013-SQLCA                       33090000
331000             MOVE 'XLT_LOC'  TO DP013-DB2-TABLE-NAME(1)           33100099
331100             SET DP013-DB2-ABEND                                  33110000
331200                             TO TRUE                              33120000
331300             SET DP013-NO-ROLLBACK                                33130000
331400                             TO TRUE                              33140000
331500             SET DP013-XCTL-DISPLAY-RESTART                       33150000
331600                             TO TRUE                              33160000
331700             PERFORM DP013-0000-PROCESS-ABEND                     33170000
331800     END-EVALUATE.                                                33180000
331900                                                                  33190000
332000 EJECT                                                            33200000
332100*----------------------------------------------------------------*33210000
332200* PASS NECESSARY DATA TO SOCKET PROGRAM BY FILLING PCWS140 FIELDS*33220000
332300*----------------------------------------------------------------*33230000
332400 4000-SETUP-LABELS.                                               33240000
332500     IF ASC-PRINT-BRCDE = 'Y'                                     33250099
332600         SET PC140-COMMON-MISC-LBL-NBR TO TRUE                    33260099
332601     ELSE                                                         33260199
332610         SET PC140-COMMON-MISC-LBL-MSG TO TRUE                    33261099
332620     END-IF                                                       33262099
332700     MOVE ASC-PRTR-ID              TO PC140-ML-PRTR-ID.           33270000
332800     PERFORM 2265-STRING-FREE-FORM-TEXT.                          33280000
332900     MOVE ASC-LABEL-COMMENTS-1     TO PC140-ML-DESC1.             33290000
333000     MOVE ASC-LABEL-COMMENTS-2     TO PC140-ML-DESC2.             33300000
333100     MOVE ASC-LABEL-COMMENTS-3     TO PC140-ML-DESC3.             33310000
333200*** LABEL TOTAL IS CALCULATED IN SOCKET PGM (SETS X NBR IN RANGE).33320000
333300     MOVE ASC-SETS-OF-LABELS       TO PC140-ML-TOT-LBLS.          33330000
333400     MOVE DP072-PRTR-DATA-XFER-MODE-ID                            33340000
333500                                   TO PC140-ML-XFER-MODE-ID.      33350000
333600     MOVE DP072-PRTR-IP-ADDRESS                                   33360000
333700                                   TO PC140-ML-IP-ADDRESS.        33370000
333800     MOVE DP072-PRTR-CLUSTER-OS-RLSE-CDE                          33380000
333900                                   TO PC140-ML-OS-RLSE-CDE.       33390000
334000     MOVE DP072-PRTR-OPER-UNT-ID   TO PC-OPER-UNT-ID.             33400000
334100                                                                  33410000
334200     PERFORM 3500-GET-DC-LOCATION.                                33420000
334300     IF PC140-SOCKET-INTFC                                        33430000
334400         PERFORM 4300-LINK-SOCKET-PRINT-ROUTINE                   33440000
334500     END-IF.                                                      33450000
334600                                                                  33460000
334700 EJECT                                                            33470000
334800*----------------------------------------------------------------*33480000
334900* LINK TO PCKCS707.                                              *33490000
335000*----------------------------------------------------------------*33500000
335100 4300-LINK-SOCKET-PRINT-ROUTINE.                                  33510000
335200                                                                  33520000
335300     MOVE DP020-USERID           TO PC140-CRA-USERID.             33530000
335400     MOVE 400                    TO PV-COMMAREA-LENGTH.           33540000
335500                                                                  33550000
335600     EXEC CICS                                                    33560000
335700          LINK PROGRAM  ('PCKCS707')                              33570000
335800               COMMAREA (PC140-LABELMST)                          33580000
335900               LENGTH   (PV-COMMAREA-LENGTH)                      33590000
336000               RESP     (PV-CICS-RESPONSE)                        33600000
336100     END-EXEC.                                                    33610000
336200                                                                  33620000
336300     EVALUATE TRUE                                                33630000
336400         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 33640000
336500              CONTINUE                                            33650000
336600         WHEN OTHER                                               33660000
336700              PERFORM DP013-0000-PROCESS-ABEND                    33670000
336800     END-EVALUATE.                                                33680000
336900     IF PC140-CRA-SOCKET-COMM-ERROR                               33690000
337000         SET PS-ERROR            TO TRUE                          33700000
337100         SET DP020-MSG-FATAL     TO TRUE                          33710000
337200         MOVE PC-TSYMSG-02122    TO DP020-MSG-NUMBER              33720000
337300         MOVE DP015-UNP-NUM-BRT-OFF                               33730000
337400                                 TO APRTRA                        33740000
337500         MOVE DP015-RED          TO APRTRC                        33750000
337600         MOVE DP015-REVERSE      TO APRTRH                        33760000
337700         MOVE -1                 TO APRTRL                        33770000
337800         SET DP030-SET-CURSOR-APPL-1                              33780000
337900                                 TO TRUE                          33790000
338000     ELSE                                                         33800000
338100     IF PC140-CRA-INVALID-PRT-FMT                                 33810000
338200         SET PS-ERROR            TO TRUE                          33820000
338300         SET DP020-MSG-FATAL     TO TRUE                          33830000
338400         MOVE DP015-UNP-NUM-BRT-OFF                               33840000
338500                                 TO APRTRA                        33850000
338600         MOVE DP015-RED          TO APRTRC                        33860000
338700         MOVE DP015-REVERSE      TO APRTRH                        33870000
338800         MOVE -1                 TO APRTRL                        33880000
338900         SET DP030-SET-CURSOR-APPL-1                              33890000
339000                                 TO TRUE                          33900000
339100         MOVE PC140-CRA-RET-CDE      TO PM-RET-CDE                33910000
339200         MOVE PC140-CRA-RET-MSG      TO PM-RET-MSG                33920000
339300         MOVE PM-PROGRAM-MESSAGE-1   TO DP020-MSG-TEXT            33930000
339400     ELSE                                                         33940000
339500         SET ASC-KEEP-SETS-VALUE-NO  TO TRUE                      33950000
339600         SET DP020-MSG-INFORMATIONAL TO TRUE                      33960000
339700         MOVE PC-TSYMSG-00098    TO DP020-MSG-NUMBER              33970000
339800         MOVE -1                 TO AQLFR1L                       33980000
339900         SET DP030-SET-CURSOR-APPL-1                              33990000
340000                                 TO TRUE                          34000000
340100         SET ASC-LABEL-PRINT-COMPLETE TO TRUE                     34010000
340200     END-IF.                                                      34020000
340300                                                                  34030000
340400         PERFORM 4305-PARTIAL-REFRESH.                            34040000
340500                                                                  34050000
340600 EJECT                                                            34060000
340700*----------------------------------------------------------------*34070000
340800* CLEAR THE FREE FORM TEXT AREAS AND LEAVE OP UNT DESC,          *34080000
340900* PRTR DESC AND THE PRTR NUMBER THE USER HAD ENTERED.            *34090000
341000*----------------------------------------------------------------*34100000
341100 4305-PARTIAL-REFRESH.                                            34110000
341200                                                                  34120000
341300             MOVE ASC-PRTR-ID-N      TO PV-PRINTER-ID.            34130000
341400             MOVE ASC-PRTR-DESC      TO PV-PRTR-DESC.             34140000
341500             MOVE ASC-OPER-UNT-ID-N  TO PV-OPER-UNT-ID.           34150000
341600             MOVE ASC-OPER-UNT-NME   TO PV-OPER-UNT-NME.          34160000
341700             MOVE ASC-FCLTY-ID-N     TO PV-FCLTY-ID.              34170000
341800             SET PS-PRINT-COMPLETE-NO TO TRUE.                    34180000
341900             IF ASC-LABEL-PRINT-COMPLETE                          34190000
342000                SET PS-PRINT-COMPLETE TO TRUE                     34200000
342100             END-IF.                                              34210000
342200                                                                  34220000
342300             INITIALIZE ASC-SPECIFIC-COMMAREA.                    34230000
342400                                                                  34240000
342500             MOVE PV-PRINTER-ID    TO ASC-PRTR-ID-N.              34250000
342600             MOVE PV-PRTR-DESC     TO ASC-PRTR-DESC.              34260000
342700             MOVE PV-OPER-UNT-NME  TO ASC-OPER-UNT-NME.           34270000
342800             MOVE PV-OPER-UNT-ID   TO ASC-OPER-UNT-ID-N.          34280000
342900             MOVE PV-FCLTY-ID      TO ASC-FCLTY-ID-N.             34290000
343000             IF PS-PRINT-COMPLETE                                 34300000
343100                SET ASC-LABEL-PRINT-COMPLETE TO TRUE              34310000
343200                SET ASC-EDITS-COMPLETE-NO    TO TRUE              34320000
343300             END-IF.                                              34330000
343400                                                                  34340000
343500             MOVE SPACES         TO AQLFR1O                       34350000
343600                                    AQLFR2O                       34360000
343700                                    AQLFR3O                       34370000
343800                                    AQLFR4O                       34380000
343900                                    ARANGE1O                      34390000
344000                                    ARANGE2O                      34400000
344100                                    ARANGE3O                      34410000
344200                                    ARANGE4O                      34420000
344300                                    ASEPR1O                       34430000
344400                                    ASEPR2O                       34440000
344500                                    ASEPR3O                       34450000
344600                                    ASEPR4O                       34460000
344700                                    ACMNT1O                       34470000
344800                                    ACMNT2O                       34480000
344900                                    ACMNT3O                       34490000
345000                                    ASC-SETS-OF-LABELS.           34500000
345100                                                                  34510000
345200             SET ASC-KEEP-SETS-VALUE-NO     TO TRUE.              34520000
345300             SET ASC-OVER-99-CHECK-DONE-NO  TO TRUE.              34530000
345400             SET ASC-AID-ENTER-NO           TO TRUE.              34540000
345500             SET ASC-AID-ADD-NO             TO TRUE.              34550000
345600             SET ASC-TOTAL-WITHIN-LIMITS-NO TO TRUE.              34560000
345700             MOVE -1                        TO AQLFR1L.           34570000
345800             MOVE +0001                     TO PV-SUPPRESS-FOUR.  34580000
345900             MOVE PV-SUPPRESS-FOUR          TO ASETSI.            34590000
346000             PERFORM 2210-RESET-ATTRIBUTES.                       34600000
346100                                                                  34610000
346200 EJECT                                                            34620000
346300*----------------------------------------------------------------*34630000
346400*    RETRY DELAY LOGIC.                                    S.T.  *34640000
346500*     -- THIS LOGIC INSTITUTES A ONE SECOND DELAY.               *34650000
346600*----------------------------------------------------------------*34660000
346700 Z100-DELAY-RETRY.                                                34670000
346800                                                                  34680000
346900     EXEC CICS                                                    34690000
347000         POST INTERVAL(1) SET(PV-ECA-POINTER)                     34700000
347100     END-EXEC.                                                    34710000
347200                                                                  34720000
347300     EXEC CICS                                                    34730000
347400         WAIT EVENT ECADDR(PV-ECA-POINTER)                        34740000
347500     END-EXEC.                                                    34750000
347600                                                                  34760000
347700** DEFINE PV-ECA-POINTER AS PIC S9(08) COMP.                      34770000
347800                                                                  34780000
347900/                                                                 34790000
348000*----------------------------------------------------------------*34800000
348100*    ABEND PROCESSOR MODULE                                      *34810000
348200*----------------------------------------------------------------*34820000
348300                                                                  34830000
348400     COPY DPPD013.                                                34840000
348500                                                                  34850000
348600 EJECT                                                            34860000
348700*----------------------------------------------------------------*34870000
348800*    UPDATE TIME AND DATE MODULE                                 *34880000
348900*----------------------------------------------------------------*34890000
349000                                                                  34900000
349100     COPY DPPD017.                                                34910000
