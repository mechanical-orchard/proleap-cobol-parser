000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400                                                                  00040000
000500 PROGRAM-ID.             SUKRP015.                                00050000
000600 AUTHOR.                 MARY SARDINA.                            00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN            OCTOBER 1997.                            00080000
000900 DATE-COMPILED.                                                   00090000
001000***************************************************************** 00100000
001100***************************************************************** 00110000
001200*  THIS PROGRAM WILL CREATE THE LISTING OF PO/RECEIVERS FOR AN  * 00120000
001300*  AUDIT CONTROL NUMBER.  IT IS PRODUCED FOLLOWING THE AUDIT OF * 00130000
001400*  SELECTED PO/RECEIVERS IN A CARTON WHICH IS DONE USING LRT    * 00140000
001500*  TERMINALS.  THIS IS JUST A COPY OF SUKRP013.  I AM USING IT  * 00150000
001600*  AS A TEMPLATE FOR THE NEW REPORT.                            * 00160000
001700***************************************************************** 00170000
001800*  CHANGED 11/09/02 BY ALBERT A VINOD                           * 00180048
001900*   WR# 21361 3 DIGIT SKU SEQUENCE NUMBER IS REPLACED WITH 8    * 00190048
002000*             DIGIT SKU NUMBER IN THE REPORT. THE HEADING OF    * 00200048
002001*             THE REPORT IS MODIFIED TO  INCLUDE DPT AND CL.    * 00210048
002002*                                                               * 00220048
001600*  CHANGED 10/05/09 BY SAURABH DUDDALWAR                        * 00230052
001700*   CHANGES ARE DONE TO HANDLE DATA CONTENTION ERRORS IN THE    * 00240052
001800*            PROGRAM WHILE REPORT GENERATION.                   * 00250052
002002*                                                               * 00250153
001600*  CHANGED 10/13/14 BY CHERI PARMLEY                            * 00251053
001700*   EXPANDED PO# FROM 7 TO 8 DIGITS     CHG#0094517             * 00252053
001900***************************************************************** 00260052
002010***************************************************************** 00270048
002020*  CHANGED MM/DD/YY BY XXXXXXXXXXX                              * 00280048
002030*   WR# XXXX XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX * 00290048
002040*                                                               * 00300048
002100***************************************************************** 00310000
002200***************************************************************** 00320000
002300 ENVIRONMENT DIVISION.                                            00330000
002400***************************************************************** 00340000
002500                                                                  00350000
002600 CONFIGURATION SECTION.                                           00360000
002700                                                                  00370000
002800 SOURCE-COMPUTER.        IBM-3090.                                00380000
002900 OBJECT-COMPUTER.        IBM-3090.                                00390000
003000                                                                  00400000
003100 INPUT-OUTPUT SECTION.                                            00410000
003200                                                                  00420000
003300 FILE-CONTROL.                                                    00430000
003400*                                                                 00440000
003500     SELECT RECEIVER-FILE                                         00450000
003600         ASSIGN TO INP01.                                         00460000
003700                                                                  00470000
003800     SELECT SU-RECEIV-AUDIT-RPT-FILE                              00480000
003900         ASSIGN TO RPT01.                                         00490000
004000                                                                  00500000
004100     SELECT SU-RECEIV-AUDIT-RPT-FILE-REG                          00510000
004200         ASSIGN TO RPT02.                                         00520000
004300*                                                                 00530000
004400***************************************************************** 00540000
004500 DATA DIVISION.                                                   00550000
004600***************************************************************** 00560000
004700*                                                                 00570000
004800 FILE SECTION.                                                    00580000
004900*                                                                 00590000
005000*                                                                 00600000
005100 FD  RECEIVER-FILE                                                00610000
005200     RECORDING MODE IS F                                          00620000
005300     BLOCK CONTAINS 0  RECORDS                                    00630000
005400     RECORD CONTAINS 200 CHARACTERS.                              00640000
005500 01  RECEIVER-RECORD                 PIC  X(200).                 00650000
005600*                                                                 00660000
005700*                                                                 00670000
005800 FD  SU-RECEIV-AUDIT-RPT-FILE                                     00680000
005900     RECORDING MODE IS F                                          00690000
006000     BLOCK CONTAINS 0  RECORDS.                                   00700000
006100 01  SU-RECEIV-AUDIT-RPT-RECORD      PIC  X(132).                 00710000
006200*                                                                 00720000
006300 FD  SU-RECEIV-AUDIT-RPT-FILE-REG                                 00730000
006400     RECORDING MODE IS F                                          00740000
006500     BLOCK CONTAINS 0  RECORDS.                                   00750000
006600 01  SU-RECEIV-AUDIT-RPT-RECORD-REG  PIC  X(132).                 00760000
006700*                                                                 00770000
006800                                                                  00780000
006900 WORKING-STORAGE SECTION.                                         00790000
007000*                                                                 00800000
007100 01  PROGRAM-SWITCHES.                                            00810000
007200     05  PS-DATA-IND                   PIC  X(01)  VALUE 'N'.     00820000
007300         88  PS-DATA                               VALUE 'Y'.     00830000
007400         88  PS-NO-DATA                            VALUE 'N'.     00840000
007500     05  PS-END-OF-CARTON-FILE-SW    PIC  X(01)    VALUE 'N'.     00850000
007600         88  PS-END-OF-CARTON-FILE                 VALUE 'Y'.     00860000
007700         88  PS-NOT-END-OF-CARTON-FILE             VALUE 'N'.     00870000
007800     05  PS-END-OF-RECEIVER-FILE-SW  PIC  X(01)    VALUE 'N'.     00880000
007900         88  PS-END-OF-RECEIVER-FILE               VALUE 'Y'.     00890000
008000         88  PS-NOT-END-OF-RECEIVER-FILE           VALUE 'N'.     00900000
008100     05  PS-FIRST-TIME-SW            PIC  X(01)    VALUE 'Y'.     00910000
008200         88  PS-FIRST-TIME                         VALUE 'Y'.     00920000
008300         88  PS-NOT-FIRST-TIME                     VALUE 'N'.     00930000
008400     05  PS-ERROR-FOUND-SW           PIC  X(01)    VALUE 'N'.     00940000
008500         88  PS-ERROR-FOUND                        VALUE 'Y'.     00950000
008600         88  PS-NO-ERROR-FOUND                     VALUE 'N'.     00960000
008700     05  PS-RECEIVER-ERROR-SW        PIC  X(01)    VALUE 'N'.     00970000
008800         88  PS-RECEIVER-ERROR                     VALUE 'Y'.     00980000
008900         88  PS-NO-RECEIVER-ERROR                  VALUE 'N'.     00990000
009000*                                                                 01000000
009100 01  PC-CONSTANTS.                                                01010000
009200     05  PC-1                        PIC S9(03)    VALUE +1       01020000
009300                                                   COMP-3.        01030000
009400     05  PC-2                        PIC S9(03)    VALUE +2       01040000
009500                                                   COMP-3.        01050000
009600     05  PC-3                        PIC S9(03)    VALUE +3       01060000
009700                                                   COMP-3.        01070000
009800     05  PC-4                        PIC S9(03)    VALUE +3       01080000
009900                                                   COMP-3.        01090000
010000     05  PC-7                        PIC S9(01)    VALUE +7.      01100000
010100     05  PC-14                       PIC S9(03)    VALUE +14      01110000
010200                                                   COMP-3.        01120000
010300     05  PC-11                       PIC S9(03)    VALUE +14      01130000
010400                                                   COMP-3.        01140000
010500     05  PC-60                       PIC S9(03)    VALUE +60      01150000
010600                                                   COMP-3.        01160000
010700     05  PC-DASH                     PIC  X(01)    VALUE '-'.     01170000
010800     05  PC-Y                        PIC  X(01)    VALUE 'Y'.     01180000
010900     05  PC-00                       PIC  X(02)    VALUE '00'.    01190000
011000     05  PC-LONG-NAME                PIC  X(02)    VALUE '01'.    01200000
011100     05  PC-ACTIVE-STATUS            PIC  X(01)    VALUE 'A'.     01210000
011200     05  PC-SUKRP015                 PIC  X(08)    VALUE          01220000
011300         'SUKRP015'.                                              01230000
011400     05  PC-100-PCT-CHECK            PIC  X(10)    VALUE          01240000
011500         '100% CHECK'.                                            01250000
011600     05  PC-SPOT-CHECK               PIC  X(10)    VALUE          01260000
011700         'SPOT CHECK'.                                            01270000
011800     05  PC-REWORK                   PIC  X(10)    VALUE          01280000
011900         'REWORK    '.                                            01290000
012000     05  PC-IN-PROCESS               PIC  X(10)    VALUE          01300000
012100         'IN PROCESS'.                                            01310000
012200     05  PC-COMPLETE                 PIC  X(10)    VALUE          01320000
012300         '  COMPLETE'.                                            01330000
012400     05  PC-POSTPONED                PIC  X(10)    VALUE          01340000
012500         ' POSTPONED'.                                            01350000
012600     05  PC-UNKNOWN                  PIC  X(10)    VALUE          01360000
012700         'UNKNOWN   '.                                            01370000
012800     05  PC-DEFAULT-TMST             PIC  X(26)    VALUE          01380000
012900         '9999-09-09-09.09.09.999999'.                            01390000
013000     05  PC-OVER-SHORT-MSG           PIC  X(28)    VALUE          01400000
013100         'RCVR LEVEL OVER/SHORT EXISTS'.                          01410000
013200     05  PC-BLANK-LINE               PIC  X(132)   VALUE SPACES.  01420000
013300     05  PC-NOERROR-LINE.                                         01430000
013400         10  FILLER                  PIC  X(30)    VALUE SPACES.  01440000
013500         10  FILLER                  PIC  X(28)    VALUE          01450000
013600             'NO OVER/SHORTS EXIST        '.                      01460000
013700     05  PC-NODATA-LINE.                                          01470000
013800         10  FILLER                  PIC  X(30)    VALUE SPACES.  01480000
013900         10  FILLER                  PIC  X(28)    VALUE          01490000
014000             'NO DATA EXISTS              '.                      01500000
014100     05  PC-REPORT-NBR               PIC  9(01)    VALUE 1.       01510000
014200     05  PC-MAX-REPORT-LINES             PIC S9(04)  VALUE +60    01520000
014300                                                     COMP SYNC.   01530000
014400     05  PC-MAX-FOR-PO-LINES             PIC S9(04)  VALUE +56    01540000
014500                                                     COMP SYNC.   01550000
014600*                                                                 01560000
014700 01  PV-MISC-FIELDS.                                              01570000
014800     05  PV-LINE-CNT                 PIC S9(03)    VALUE ZERO     01580000
014900                                                   COMP-3.        01590000
015000     05  PV-PAGE-CNT                 PIC S9(04)    VALUE ZERO     01600000
015100                                                   COMP-3.        01610000
015200     05  PV-ERROR-COUNT              PIC S9(04)    VALUE ZERO     01620000
015300                                                   COMP SYNC.     01630000
015400     05  PV-LINE-TOTAL               PIC S9(04)    VALUE ZERO     01640000
015500                                                   COMP SYNC.     01650000
015600     05  PV-EXPTED-QTY               PIC S9(04)    VALUE ZERO     01660000
015700                                                   COMP SYNC.     01670000
015800     05  PV-AUDIT-DURATION-TIME      PIC S9(09)    VALUE ZERO     01680000
015900                                                   COMP SYNC.     01690000
016000     05  PV-AUDIT-DURATION-HOURS     PIC S9(09)    VALUE ZERO     01700000
016100                                                   COMP SYNC.     01710000
016200     05  PV-AUDIT-DURATION-MINUTES   PIC S9(09)    VALUE ZERO     01720000
016300                                                   COMP SYNC.     01730000
016400     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     01740000
016500                                                   COMP SYNC.     01750000
016600     05  PV-CARTONS-IN-ERROR         PIC S9(09)    VALUE ZERO     01760000
016700                                                   COMP SYNC.     01770000
016800     05  PV-CARTONS-IN-AUDIT         PIC S9(09)    VALUE ZERO     01780000
016900                                                   COMP SYNC.     01790000
017000     05  PV-CURR-SHIPT-UNT-ID        PIC S9(18)    VALUE ZERO     01800000
017100                                                   COMP-3.        01810000
017200     05  PV-PCT-CTNS-IN-ERROR        PIC S9(03)V99 VALUE ZERO     01820000
017300                                                   COMP-3.        01830000
017400     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  01840000
017500     05  PV-HOLD-STR                 PIC S9(04)  VALUE ZERO       01850000
017600                                               COMP.              01860000
017700     05  PV-CURR-STORE-NBR           PIC S9(04)  VALUE ZERO       01870000
017800                                               COMP.              01880000
017900     05  PV-PREV-STORE-NBR           PIC S9(04)  VALUE ZERO       01890000
018000                                               COMP.              01900000
018100     05  PV-AUD-CNTL-NBR             PIC  9(09)    VALUE ZERO.    01910000
018200     05  PV-PREV-AUD-CNTL-NBR        PIC  9(09)    VALUE ZERO.    01920000
018300     05  PV-OPER-UNT-ID              PIC  9(04)    VALUE ZERO.    01930049
018400     05  PV-PO-RECEIVER.                                          01940000
      *CLP 10/13/14 START                                               01941053
018500         10  PV-PO                   PIC  ZZZZZZZ9 VALUE ZERO.    01950053
018600         10  FILLER                  PIC  X(01)    VALUE '-'.     01960000
018700         10  PV-RECEIVER             PIC  9(04)    VALUE ZERO.    01970000
018800     05  PV-CURR-PO-RECEIVER.                                     01980000
018900         10  PV-CURR-PO-NBR          PIC  ZZZZZZZ9 VALUE ZERO.    01990053
019000         10  PV-CURR-REC-SEQ-NBR     PIC  9(04)    VALUE ZERO.    02000000
019100     05  PV-PREV-PO-RECEIVER.                                     02010000
019200         10  PV-PREV-PO-NBR          PIC  ZZZZZZZ9 VALUE ZERO.    02020053
019300         10  PV-PREV-REC-SEQ-NBR     PIC  9(04)    VALUE ZERO.    02030000
019400     05  PV-KEY-PO-RECEIVER.                                      02040000
019500         10  PV-KEY-PO-NBR           PIC  ZZZZZZZ9 VALUE ZERO.    02050053
019600         10  PV-KEY-REC-SEQ-NBR      PIC  9(04)    VALUE ZERO.    02060000
      *CLP 10/13/14 END                                                 02061053
019700     05  PV-TODAYS-DATE.                                          02070000
019800         10  PV-TODAYS-DATE-YY       PIC  9(02)    VALUE ZERO.    02080000
019900         10  PV-TODAYS-DATE-MM       PIC  9(02)    VALUE ZERO.    02090000
020000         10  PV-TODAYS-DATE-DD       PIC  9(02)    VALUE ZERO.    02100000
020100     05  PV-TODAYS-TIME.                                          02110000
020200         10  PV-TODAYS-TIME-HH       PIC  9(02)    VALUE ZERO.    02120000
020300         10  PV-TODAYS-TIME-MM       PIC  9(02)    VALUE ZERO.    02130000
020400         10  PV-TODAYS-TIME-SS       PIC  9(02)    VALUE ZERO.    02140000
020500         10  FILLER                  PIC  9(02)    VALUE ZERO.    02150000
020600     05  PV-DB2-DATE.                                             02160000
020700         10  PV-DB2-DATE-CC          PIC  X(02)    VALUE ZERO.    02170000
020800         10  PV-DB2-DATE-YY          PIC  X(02)    VALUE ZERO.    02180000
020900         10  FILLER                  PIC  X(01)    VALUE ZERO.    02190000
021000         10  PV-DB2-DATE-MM          PIC  X(02)    VALUE ZERO.    02200000
021100         10  FILLER                  PIC  X(01)    VALUE ZERO.    02210000
021200         10  PV-DB2-DATE-DD          PIC  X(02)    VALUE ZERO.    02220000
021300     05  PV-DB2-TMST.                                             02230000
021400         10 PV-DB2-TMST-CCYY          PIC  9(04).                 02240000
021500         10 FILLER                    PIC  X(01).                 02250000
021600         10 PV-DB2-TMST-MM            PIC  9(02).                 02260000
021700         10 FILLER                    PIC  X(01).                 02270000
021800         10 PV-DB2-TMST-DD            PIC  9(02).                 02280000
021900         10 FILLER                    PIC  X(01).                 02290000
022000         10 PV-DB2-TMST-HH            PIC  9(02).                 02300000
022100         10 FILLER                    PIC  X(01).                 02310000
022200         10 PV-DB2-TMST-MN            PIC  9(02).                 02320000
022300         10 FILLER                    PIC  X(01).                 02330000
022400         10 PV-DB2-TMST-SS            PIC  9(02).                 02340000
022500         10 FILLER                    PIC  X(07).                 02350000
022600     05  PV-FORMAT-DATE.                                          02360000
022700         10 PV-FORMAT-DATE-MM         PIC  9(02).                 02370000
022800         10 FILLER                    PIC  X(01) VALUE '/'.       02380000
022900         10 PV-FORMAT-DATE-DD         PIC  9(02).                 02390000
023000         10 FILLER                    PIC  X(01) VALUE '/'.       02400000
023100         10 PV-FORMAT-DATE-CCYY       PIC  9(04).                 02410000
023200     05  PV-FORMAT-TIME.                                          02420000
023300         10 PV-FORMAT-TIME-HH         PIC  9(02).                 02430000
023400         10 FILLER                    PIC  X(01) VALUE ':'.       02440000
023500         10 PV-FORMAT-TIME-MN         PIC  9(02).                 02450000
023600                                                                  02460000
023610******************************************************************02470000
023620*  MODIFIED COPYBOOK SURD004 TO REMOVE 3-DIGIT SKU     WR# 21361 *02480000
023630*  SEQUENCE NUMBER AND TO ADD 8-DIGIT SKU NUMBER.                *02490000
023640******************************************************************02500000
023700******************************************************************02510000
023800* COPY BOOK CONTAINING THE LAYOUT OF THE RECEIVER LEVEL AUDIT     02520000
023900* EXTRACT FILE                                                    02530000
024000******************************************************************02540000
024100 01  SU004-COPYBOOK.                                              02550000
024200     COPY SURD004.                                                02560000
024300                                                                  02570000
024310******************************************************************02580000
024320*  CHANGES MADE FOR WR# 21361 ENDS HERE.                         *02590000
024330******************************************************************02600000
024400******************************************************************02610000
024500* COPY BOOK WITH PRINTEK/CODE V PRINTER CODES                     02620000
024600******************************************************************02630000
024700     COPY DSWS004.                                                02640000
024800                                                                  02650000
024900******************************************************************02660000
025000*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               02670000
025100******************************************************************02680000
025200     COPY DPWS132O.                                               02690000
025300                                                                  02700049
024900******************************************************************02710049
025000*  LOGISTICS DOMAIN LOCATION MODULE - XLKUT071.                   02720049
025100******************************************************************02730049
025200     COPY XLWS071.                                                02740049
025300                                                                  02750049
025400*                                                                 02760000
025500 01  HEADING-LINES.                                               02770000
025600     05  HEADING-LINE-0.                                          02780000
025700         10  FILLER                  PIC  X(52)    VALUE SPACES.  02790000
025800         10  FILLER                  PIC  X(28)    VALUE          02800000
025900             'VENDOR ACCURACY CARTON AUDIT'.                      02810000
026000         10  FILLER                  PIC  X(52)    VALUE SPACES.  02820000
026100*                                                                 02830000
026200     05  HEADING-LINE-1.                                          02840000
026300         10  FILLER                  PIC  X(40)    VALUE SPACES.  02850000
026400         10  FILLER                  PIC  X(28)    VALUE          02860000
026500             'LISTING OF RECEIVER LEVEL OV'.                      02870000
026600         10  FILLER                  PIC  X(25)    VALUE          02880000
026700             'ER/SHORTAGES FOR AN AUDIT'.                         02890000
026800         10  FILLER                  PIC  X(41)    VALUE SPACES.  02900000
026900*                                                                 02910000
027000     05  HEADING-LINE-2.                                          02920000
027100         10  FILLER                  PIC  X(03)    VALUE SPACE.   02930000
027200         10  FILLER                  PIC  X(23)    VALUE          02940000
027300             'AUDIT CONTROL NUMBER:  '.                           02950000
027400         10  HL2-AUD-CNTL-NBR        PIC  X(10)    VALUE SPACES.  02960000
027500         10  FILLER                  PIC  X(08)    VALUE SPACE.   02970000
027600         10  FILLER                  PIC  X(18)    VALUE          02980000
027700             'AUDIT TYPE:       '.                                02990000
027800         10  HL2-AUDIT-TYPE          PIC  X(10)    VALUE SPACES.  03000000
027900         10  FILLER                  PIC  X(18)    VALUE SPACE.   03010000
028000         10  FILLER                  PIC  X(21)    VALUE          03020000
028100             'AUDIT STATUS:        '.                             03030000
028200         10  HL2-AUDIT-STATUS        PIC  X(10)    VALUE SPACES.  03040000
028300         10  FILLER                  PIC  X(11)    VALUE SPACES.  03050000
028400*                                                                 03060000
028500     05  HEADING-LINE-3.                                          03070000
028600         10  FILLER                  PIC  X(03)    VALUE SPACES.  03080000
028700         10  FILLER                  PIC  X(18)    VALUE          03090000
028800             'AUDIT START:      '.                                03100000
028900         10  HL3-AUDIT-START-DATE.                                03110000
029000             15  HL3-AUDIT-START-DATE-MM                          03120000
029100                                     PIC  X(02)    VALUE SPACES.  03130000
029200             15  FILLER              PIC  X(01)    VALUE '/'.     03140000
029300             15  HL3-AUDIT-START-DATE-DD                          03150000
029400                                     PIC  X(02)    VALUE SPACES.  03160000
029500             15  FILLER              PIC  X(01)    VALUE '/'.     03170000
029600             15  HL3-AUDIT-START-DATE-CCYY                        03180000
029700                                     PIC  X(04)    VALUE SPACES.  03190000
029800         10  FILLER                  PIC  X(02)    VALUE SPACES.  03200000
029900         10  HL3-AUDIT-START-TIME.                                03210000
030000             15  HL3-AUDIT-START-TIME-HH                          03220000
030100                                     PIC  X(02)    VALUE SPACES.  03230000
030200             15  FILLER              PIC  X(01)    VALUE ':'.     03240000
030300             15  HL3-AUDIT-START-TIME-MN                          03250000
030400                                     PIC  X(02)    VALUE SPACES.  03260000
030500         10  FILLER                  PIC  X(06)    VALUE SPACES.  03270000
030600         10  FILLER                  PIC  X(18)    VALUE          03280000
030700             'AUDIT STOP:       '.                                03290000
030800         10  HL3-AUDIT-STOP-DATE.                                 03300000
030900             15  HL3-AUDIT-STOP-DATE-MM                           03310000
031000                                     PIC  X(02)    VALUE SPACES.  03320000
031100             15  FILLER              PIC  X(01)    VALUE '/'.     03330000
031200             15  HL3-AUDIT-STOP-DATE-DD                           03340000
031300                                     PIC  X(02)    VALUE SPACES.  03350000
031400             15  FILLER              PIC  X(01)    VALUE '/'.     03360000
031500             15  HL3-AUDIT-STOP-DATE-CCYY                         03370000
031600                                     PIC  X(04)    VALUE SPACES.  03380000
031700         10  FILLER                  PIC  X(02)    VALUE SPACES.  03390000
031800         10  HL3-AUDIT-STOP-TIME.                                 03400000
031900             15  HL3-AUDIT-STOP-TIME-HH                           03410000
032000                                     PIC  X(02)    VALUE SPACES.  03420000
032100             15  FILLER              PIC  X(01)    VALUE ':'.     03430000
032200             15  HL3-AUDIT-STOP-TIME-MN                           03440000
032300                                     PIC  X(02)    VALUE SPACES.  03450000
032400         10  FILLER                  PIC  X(11)    VALUE SPACES.  03460000
032500         10  FILLER                  PIC  X(25)    VALUE          03470000
032600             'AUDIT DURATION (HH:MM):  '.                         03480000
032700         10  HL3-AUDIT-DURATION.                                  03490000
032800             15  HL3-AUDIT-DURATION-HH                            03500000
032900                                     PIC  ZZ9      VALUE ZEROES.  03510000
033000             15  FILLER              PIC  X(01)    VALUE ':'.     03520000
033100             15  HL3-AUDIT-DURATION-MM                            03530000
033200                                     PIC  9(02)    VALUE ZEROES.  03540000
033300         10  FILLER                  PIC  X(11)    VALUE SPACES.  03550000
033400*                                                                 03560000
033500     05  HEADING-LINE-4.                                          03570000
033600         10  FILLER                  PIC  X(02)    VALUE SPACES.  03580049
033700         10  FILLER                  PIC  X(11)    VALUE          03590000
033800             'FACILITY:  '.                                       03600000
033900         10  HL4-AUDIT-FCLTY-PRINT.                               03610000
034000             15  HL4-AUDIT-FCLTY-ID  PIC  X(04)    VALUE SPACES.  03620049
034100             15  FILLER              PIC  X(03)    VALUE ' - '.   03630000
034200             15  HL4-AUDIT-FCLTY-NAME                             03640000
034300                                     PIC  X(25)    VALUE SPACES.  03650000
034400         10  FILLER                  PIC  X(02)    VALUE SPACES.  03660000
034500         10  FILLER                  PIC  X(24)    VALUE          03670000
034600             'AUDIT PROCESS AREA:     '.                          03680000
034700         10  HL4-AUDIT-PRC-AREA      PIC  X(06)    VALUE SPACES.  03690000
034800         10  FILLER                  PIC  X(55)    VALUE SPACES.  03700000
034900*                                                                 03710000
035000     05  HEADING-LINE-5.                                          03720000
035100         10  FILLER                  PIC  X(04)    VALUE SPACES.  03730000
035200         10  FILLER                  PIC  X(12)    VALUE          03740000
035300             'PO/RECEIVER:'.                                      03750000
035400         10  FILLER                  PIC  X(02)    VALUE SPACES.  03760000
      *CLP 10/13/14 START                                               03761053
035500         10  HL5-PO-RECEIVER         PIC  X(13)    VALUE SPACES.  03770053
035610         10  FILLER                  PIC  X(15)    VALUE SPACES.  03780053
      *CLP 10/13/14 END                                                 03781053
035700         10  FILLER                  PIC  X(12)    VALUE          03790000
035800             'VENDOR NAME:'.                                      03800000
035900         10  FILLER                  PIC  X(02)    VALUE SPACES.  03810000
036000         10  HL5-VENDOR-NAME         PIC  X(20)    VALUE SPACES.  03820000
036100         10  FILLER                  PIC  X(11)    VALUE SPACES.  03830000
036200         10  FILLER                  PIC  X(20)    VALUE          03840000
036300             'PACK BY STORE IND:  '.                              03850000
036400         10  HL5-PBS-IND             PIC  X(01)    VALUE SPACES.  03860000
036500         10  FILLER                  PIC  X(08)    VALUE SPACES.  03870000
036600*                                                                 03880000
036700********                                                          03890000
036710******************************************************************03900000
036720*  REMOVED FILLER VALUE 'SKU' AND ADDED NEW FILLER     WR# 21361 *03910000
036730*  VALUE 'CL SKU' AND ADJUST THE FILLERS.                        *03920000
036740******************************************************************03930000
036800     05  HEADING-LINE-6.                                          03940000
036900         10  FILLER                  PIC  X(20)    VALUE SPACES.  03950000
037000         10  FILLER                  PIC  X(05)    VALUE          03960000
037100             'STORE'.                                             03970000
037210         10  FILLER                  PIC  X(03)    VALUE SPACES.  03980000
037540         10  FILLER                  PIC  X(10)    VALUE          03990000
037550             'DPT CL SKU'.                                        04000000
037560         10  FILLER                  PIC  X(08)    VALUE SPACES.  04010000
037600         10  FILLER                  PIC  X(08)    VALUE          04020000
037700             'EXPECTED'.                                          04030000
037800         10  FILLER                  PIC  X(04)    VALUE SPACES.  04040000
037900         10  FILLER                  PIC  X(07)    VALUE          04050000
038000             'AUDITED'.                                           04060000
038100         10  FILLER                  PIC  X(53)    VALUE SPACES.  04070000
038200*                                                                 04080000
038210******************************************************************04090000
038220*  ADJUSTED FILLER TO ALIGN SECOND NUMBER UNDER SKU    WR# 21361 *04100000
038230*  IN THE REPORT HEADING.                                        *04110000
038240******************************************************************04120000
038300     05  HEADING-LINE-7.                                          04130000
038400         10  FILLER                  PIC  X(20)    VALUE SPACES.  04140000
038500         10  FILLER                  PIC  X(06)    VALUE          04150000
038600             'NUMBER'.                                            04160000
038710         10  FILLER                  PIC  X(09)    VALUE SPACES.  04170000
038800         10  FILLER                  PIC  X(06)    VALUE          04180000
038900             'NUMBER'.                                            04190000
039010         10  FILLER                  PIC  X(05)    VALUE SPACES.  04200000
039100         10  FILLER                  PIC  X(08)    VALUE          04210000
039200             'UNITS   '.                                          04220000
039300         10  FILLER                  PIC  X(04)    VALUE SPACES.  04230000
039400         10  FILLER                  PIC  X(07)    VALUE          04240000
039500             'UNITS  '.                                           04250000
039610         10  FILLER                  PIC  X(51)    VALUE SPACES.  04260000
039700*                                                                 04270000
039800 01  MISCELLANEOUS-LINES.                                         04280000
039900     05  END-OF-REPORT-LINE.                                      04290000
040000         10  FILLER                  PIC  X(44)    VALUE SPACES.  04300000
040100         10  FILLER                  PIC  X(45)    VALUE          04310000
040200             '*******   E N D   O F   R E P O R T   *******'.     04320000
040300         10  FILLER                  PIC  X(43)    VALUE SPACES.  04330000
040400*                                                                 04340000
040410******************************************************************04350000
040420*  MODIFIED GROUP VARIABLE DL1-SKU-NBR TO REMOVE       WR# 21361 *04360000
040430*  DL1-SKU-NBR-SEQ 9(3) AND ADD NEW VARIABLE DL1-SKU-NMBR 9(08)  *04370000
040440*  AND VALUE OF FILLER CHANGED TO SPACES.                        *04380000
040460******************************************************************04390000
040500 01  DETAIL-LINES.                                                04400000
040600     05  DETAIL-LINE1.                                            04410000
040700         10  FILLER                  PIC  X(22)    VALUE SPACES.  04420000
040800         10  DL1-STR-NBR             PIC  ZZ9.                    04430000
040900         10  DL1-STR-NBR-X REDEFINES                              04440000
041000             DL1-STR-NBR             PIC  X(03).                  04450000
041110         10  FILLER                  PIC  X(03)   VALUE SPACES.   04460000
041200         10  DL1-SKU-NBR.                                         04470000
041300             15 DL1-SKU-NBR-DEPT     PIC  9(03).                  04480000
041400             15 FILLER               PIC  X   VALUE SPACES.       04490000
041500             15 DL1-SKU-NBR-CLASS    PIC  9(02).                  04500000
041600             15 FILLER               PIC  X   VALUE SPACES.       04510000
041710             15 DL1-SKU-NMBR         PIC  9(08).                  04520000
041810         10  FILLER                  PIC  X(05)    VALUE SPACES.  04530000
041900         10  DL1-EXPTED-UNITS        PIC  ZZZZZZ9  VALUE ZEROES.  04540000
042000         10  FILLER                  PIC  X(03)    VALUE SPACES.  04550000
042100         10  DL1-AUDITED-UNITS       PIC  ZZZZZZ9  VALUE ZEROES.  04560000
042200         10  FILLER                  PIC  X(02)    VALUE SPACES.  04570000
042210******************************************************************04580000
042220*  CHANGES MADE FOR WR# 21361 ENDS HERE.                         *04590000
042230******************************************************************04600000
042300                                                                  04610000
042400 01  CC-CONTROL-CARD.                                             04620000
042500     05  CC-PRINTER-ID                PIC  X(08)  VALUE SPACES.   04630000
042600     05  CC-PRTR-CNTL-IND             PIC  X(01)  VALUE SPACE.    04640000
042700     05  CC-TRACK-NBR                 PIC  9(01)  VALUE ZERO.     04650000
042800*DMB 9/18/01                                                      04660000
042900     05  CC-BRCDE-IND                 PIC  X(01)  VALUE SPACE.    04670000
043000     05  CC-PRTR-CUT-IND              PIC  X(01)  VALUE SPACE.    04680000
043100*                                                                 04690000
043200*  COPY BOOK FOR THE SHIPPING UNIT AUDIT TABLE (TSUNAUD)          04700000
043300     EXEC SQL                                                     04710000
043400          INCLUDE TSUNAUD                                         04720000
043500     END-EXEC.                                                    04730000
043600*                                                                 04740000
043700*  COPY BOOK FOR SHIPPING UNIT AUDIT TRANSACTIONS TABLE           04750000
043800*  (TSUATRN)                                                      04760000
043900*                                                                 04770000
044000     EXEC SQL                                                     04780000
044100          INCLUDE TSUATRN                                         04790000
044200     END-EXEC.                                                    04800000
044300*                                                                 04810000
044400*  COPY BOOK FOR THE SHIPPING UNIT AUDIT EXCEPTION TABLE          04820000
044500*  (TSUEXCP)                                                      04830000
044600*                                                                 04840000
044700     EXEC SQL                                                     04850000
044800          INCLUDE TSUEXCP                                         04860000
044900     END-EXEC.                                                    04870000
045000*                                                                 04880000
045100*  COPY BOOK FOR RECEIVER TABLE (TRECEIV)                         04890000
045200*                                                                 04900000
045300     EXEC SQL                                                     04910000
045400          INCLUDE TRECEIV                                         04920000
045500     END-EXEC.                                                    04930000
045600*                                                                 04940000
045700*  COPY BOOK FOR THE PURCHASE ORDER TABLE (TPURCHS)               04950000
045800*                                                                 04960000
045900     EXEC SQL                                                     04970000
046000          INCLUDE TPURCHS                                         04980000
046100     END-EXEC.                                                    04990000
046800*                                                                 05000000
046900*  COPY BOOK FOR THE ENTITY NAME TABLE (TENTNME)                  05010000
047000*                                                                 05020000
047100     EXEC SQL                                                     05030000
047200          INCLUDE TENTNME                                         05040000
047300     END-EXEC.                                                    05050000
047400                                                                  05060049
047500*  DB2 COMMUNICATION AREA                                         05070000
047600*                                                                 05080000
047700     EXEC SQL                                                     05090000
047800         INCLUDE SQLCA                                            05100000
047900     END-EXEC.                                                    05110000
048000                                                                  05120049
048100*  DB2 COMMUNICATION AREA2                                        05130000
048200*                                                                 05140000
048300     COPY SQLCA2.                                                 05150000
048400                                                                  05160000
048500**********************************************************        05170049
048700 PROCEDURE DIVISION.                                              05180000
048500**********************************************************        05190049
048900 0000-MAINLINE-PROCESSING.                                        05200000
049000******************************************************************05210000
049100**  THIS IS THE MAIN DRIVER FOR THE PROGRAM.                      05220000
049200******************************************************************05230000
049300     OPEN INPUT  RECEIVER-FILE                                    05240000
049400          OUTPUT SU-RECEIV-AUDIT-RPT-FILE                         05250000
049500                 SU-RECEIV-AUDIT-RPT-FILE-REG.                    05260000
049600*                                                                 05270000
049700     PERFORM 1000-INITIALIZATION.                                 05280000
049800*                                                                 05290000
049900     PERFORM 2000-PROCESS-SU                                      05300000
050000         UNTIL PS-END-OF-RECEIVER-FILE.                           05310000
050100*                                                                 05320000
050200*    PERFORM 8400-WRITE-DETAIL-LINES.                             05330000
050300*                                                                 05340000
050400     WRITE SU-RECEIV-AUDIT-RPT-RECORD                             05350000
050500       FROM END-OF-REPORT-LINE                                    05360000
050600         AFTER ADVANCING 2 LINES.                                 05370000
050700     WRITE SU-RECEIV-AUDIT-RPT-RECORD-REG                         05380000
050800       FROM END-OF-REPORT-LINE                                    05390000
050900         AFTER ADVANCING 2 LINES.                                 05400000
051000*                                                                 05410000
051100*DMB 9/18/01    IF CC-PRTR-CNTL-IND = 'P'                         05420000
051200      IF CC-PRTR-CUT-IND = 'Y'                                    05430000
051300         WRITE SU-RECEIV-AUDIT-RPT-RECORD                         05440000
051400              FROM DS004-PLC-CUT-FORM                             05450000
051500          AFTER ADVANCING 1 LINE                                  05460000
051600      END-IF.                                                     05470000
051700                                                                  05480000
051800                                                                  05490000
051900     CLOSE RECEIVER-FILE                                          05500000
052000           SU-RECEIV-AUDIT-RPT-FILE                               05510000
052100           SU-RECEIV-AUDIT-RPT-FILE-REG                           05520000
052200*                                                                 05530000
052300     GOBACK.                                                      05540000
052400*                                                                 05550000
052500*                                                                 05560000
052600 1000-INITIALIZATION.                                             05570000
052700******************************************************************05580000
052800**  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               05590000
052900******************************************************************05600000
053000     ACCEPT CC-CONTROL-CARD FROM SYSIN.                           05610000
053100     DISPLAY 'CONTROL CARD = ' CC-CONTROL-CARD.                   05620000
053200                                                                  05630000
053300     ACCEPT PV-TODAYS-DATE                                        05640000
053400       FROM DATE.                                                 05650000
053500*                                                                 05660000
053600     ACCEPT PV-TODAYS-TIME                                        05670000
053700       FROM TIME.                                                 05680000
053800*                                                                 05690000
053900     MOVE PC-REPORT-NBR      TO DP132O-REPORT-NUMBER.             05700000
054000     MOVE PV-TODAYS-DATE-MM  TO DP132O-RUN-MONTH.                 05710000
054100     MOVE PV-TODAYS-DATE-DD  TO DP132O-RUN-DAY.                   05720000
054200     MOVE PV-TODAYS-DATE-YY  TO DP132O-RUN-YEAR.                  05730000
054300*                                                                 05740000
054400     MOVE PV-TODAYS-TIME-HH  TO DP132O-RUN-HOUR.                  05750000
054500     MOVE PV-TODAYS-TIME-MM  TO DP132O-RUN-MINUTE.                05760000
054600     MOVE PC-SUKRP015        TO DP132O-PROGRAM-NAME.              05770000
054700     SET PS-NO-ERROR-FOUND TO TRUE                                05780000
054800     PERFORM 7100-READ-RECEIVER-EXTRACT.                          05790000
054900                                                                  05800000
055000*    IF THERE IS NO DATA, PRINT NO DATA MESSAGE TO THE REPORT,    05810000
055100*    OTHERWISE SET-UP THE PAGE HEADINGS                           05820000
055200     IF PS-END-OF-RECEIVER-FILE                                   05830000
055300         SET PS-NO-DATA                  TO TRUE                  05840000
055400          DISPLAY '*******  NO DATA TO REPORT IN SUKRP015 ******' 05850000
055500     ELSE                                                         05860000
055600         SET PS-DATA                     TO TRUE                  05870000
055700         PERFORM 1050-GET-HEADING-INFO                            05880000
055800         MOVE SU004-PO-NBR           TO PV-CURR-PO-NBR            05890000
055900                                        PV-PO                     05900000
056000         MOVE SU004-REC-SEQ-NBR      TO PV-CURR-REC-SEQ-NBR       05910000
056100                                        PV-RECEIVER               05920000
056200         MOVE SU004-DEST-OPER-UNT-ID TO PV-CURR-STORE-NBR         05930000
056300     END-IF.                                                      05940000
056400                                                                  05950000
056500*    IF THIS IS A PRINTEK PRINTER, LOAD THE FORM                  05960000
056600     IF CC-PRTR-CNTL-IND = 'P'                                    05970000
056700         MOVE CC-TRACK-NBR           TO DS004-PLC-LF-FORM-NBR     05980000
056800         MOVE DS004-PES-8LPI         TO DS004-PLC-LF-LPI          05990000
056900                                                                  06000000
057000         WRITE SU-RECEIV-AUDIT-RPT-RECORD                         06010000
057100             FROM DS004-PLC-LOAD-FORM                             06020000
057200         AFTER ADVANCING 1 LINE                                   06030000
057300     END-IF.                                                      06040000
057400                                                                  06050000
057500     PERFORM 8000-WRITE-REPORT-HEADERS.                           06060000
057600                                                                  06070000
057700     IF PS-END-OF-RECEIVER-FILE                                   06080000
057800         CONTINUE                                                 06090000
057900     ELSE                                                         06100000
058000         IF PS-NO-ERROR-FOUND                                     06110000
058100             PERFORM 7100-READ-RECEIVER-EXTRACT                   06120000
058200                 UNTIL PS-ERROR-FOUND OR                          06130000
058300                    PS-END-OF-RECEIVER-FILE                       06140000
058400          END-IF                                                  06150000
058500     END-IF.                                                      06160000
058600                                                                  06170000
058700     IF PS-NO-DATA                                                06180000
058800         WRITE SU-RECEIV-AUDIT-RPT-RECORD                         06190000
058900           FROM PC-NODATA-LINE                                    06200000
059000             AFTER ADVANCING 1 LINE                               06210000
059100         WRITE SU-RECEIV-AUDIT-RPT-RECORD-REG                     06220000
059200           FROM PC-NODATA-LINE                                    06230000
059300             AFTER ADVANCING 1 LINE                               06240000
059400     ELSE                                                         06250000
059500         IF PS-NO-ERROR-FOUND                                     06260000
059600             WRITE SU-RECEIV-AUDIT-RPT-RECORD                     06270000
059700               FROM PC-NOERROR-LINE                               06280000
059800                 AFTER ADVANCING 1 LINE                           06290000
059900             WRITE SU-RECEIV-AUDIT-RPT-RECORD-REG                 06300000
060000               FROM PC-NOERROR-LINE                               06310000
060100                 AFTER ADVANCING 1 LINE                           06320000
060200                 DISPLAY 'NO ERRORS TO REPORT'                    06330000
060300          END-IF                                                  06340000
060400     END-IF.                                                      06350000
060500                                                                  06360000
060600     IF PS-END-OF-RECEIVER-FILE                                   06370000
060700         CONTINUE                                                 06380000
060800     ELSE                                                         06390000
060900         MOVE SU004-PO-NBR       TO PV-CURR-PO-NBR                06400000
061000         MOVE SU004-REC-SEQ-NBR  TO PV-CURR-REC-SEQ-NBR           06410000
061100         MOVE SU004-DEST-OPER-UNT-ID TO PV-CURR-STORE-NBR         06420000
061200     END-IF.                                                      06430000
061300*                                                                 06440000
061400 1050-GET-HEADING-INFO.                                           06450000
061500     PERFORM 1100-SELECT-TSUNAUD.                                 06460000
061600     MOVE SU004-AUD-CNTL-NBR TO PV-AUD-CNTL-NBR.                  06470000
061700     MOVE PV-AUD-CNTL-NBR    TO HL2-AUD-CNTL-NBR.                 06480000
061800                                                                  06490000
061900     EVALUATE SUNAUD-AUD-TYP-CDE                                  06500000
062000         WHEN '01'                                                06510000
062100             MOVE PC-100-PCT-CHECK TO HL2-AUDIT-TYPE              06520000
062200         WHEN '02'                                                06530000
062300             MOVE PC-SPOT-CHECK    TO HL2-AUDIT-TYPE              06540000
062400         WHEN '03'                                                06550000
062500             MOVE PC-REWORK        TO HL2-AUDIT-TYPE              06560000
062600         WHEN OTHER                                               06570000
062700             MOVE PC-UNKNOWN       TO HL2-AUDIT-TYPE              06580000
062800     END-EVALUATE.                                                06590000
062900                                                                  06600000
063000     EVALUATE SUNAUD-AUD-STAT-CDE                                 06610000
063100         WHEN 'IP'                                                06620000
063200             MOVE PC-IN-PROCESS TO HL2-AUDIT-STATUS               06630000
063300         WHEN 'CM'                                                06640000
063400             MOVE PC-COMPLETE   TO HL2-AUDIT-STATUS               06650000
063500         WHEN 'PP'                                                06660000
063600             MOVE PC-POSTPONED  TO HL2-AUDIT-STATUS               06670000
063700         WHEN OTHER                                               06680000
063800             MOVE PC-UNKNOWN    TO HL2-AUDIT-STATUS               06690000
063900     END-EVALUATE.                                                06700000
064000                                                                  06710000
064100     MOVE SUNAUD-AUD-STRT-TMST TO PV-DB2-TMST.                    06720000
064200     MOVE PV-DB2-TMST-MM       TO HL3-AUDIT-START-DATE-MM.        06730000
064300     MOVE PV-DB2-TMST-DD       TO HL3-AUDIT-START-DATE-DD.        06740000
064400     MOVE PV-DB2-TMST-CCYY     TO HL3-AUDIT-START-DATE-CCYY.      06750000
064500     MOVE PV-DB2-TMST-HH       TO HL3-AUDIT-START-TIME-HH.        06760000
064600     MOVE PV-DB2-TMST-MN       TO HL3-AUDIT-START-TIME-MN.        06770000
064700                                                                  06780000
064800     IF  SUNAUD-AUD-STP-TMST = PC-DEFAULT-TMST                    06790000
064900         MOVE SPACES TO HL3-AUDIT-STOP-DATE                       06800000
065000                        HL3-AUDIT-STOP-TIME                       06810000
065100                        HL3-AUDIT-DURATION                        06820000
065200     ELSE                                                         06830000
065300         MOVE SUNAUD-AUD-STP-TMST                                 06840000
065400                               TO PV-DB2-TMST                     06850000
065500         MOVE PV-DB2-TMST-MM   TO HL3-AUDIT-STOP-DATE-MM          06860000
065600         MOVE PV-DB2-TMST-DD   TO HL3-AUDIT-STOP-DATE-DD          06870000
065700         MOVE PV-DB2-TMST-CCYY TO HL3-AUDIT-STOP-DATE-CCYY        06880000
065800         MOVE PV-DB2-TMST-HH   TO HL3-AUDIT-STOP-TIME-HH          06890000
065900         MOVE PV-DB2-TMST-MN   TO HL3-AUDIT-STOP-TIME-MN          06900000
066000                                                                  06910000
066100         PERFORM 1200-CALC-DURATION                               06920000
066200                                                                  06930000
066300*  SUBTRACT OUT THE MINUTES THAT THE AUDIT WAS EITHER             06940000
066400*  CLOSED OR POSTPONED -- THIS TIME SHOULD NOT COUNT              06950000
066500*  COUNT AGAINST THE TIME OF THE AUDIT                            06960000
066600                                                                  06970000
066700         COMPUTE PV-AUDIT-DURATION-TIME =                         06980000
066800             PV-AUDIT-DURATION-TIME -                             06990000
066900                 SUNAUD-AUD-PSPND-MNIT-QTY -                      07000000
067000                     SUNAUD-AUD-CLO-MNIT-QTY                      07010000
067100                                                                  07020000
067200         DIVIDE PV-AUDIT-DURATION-TIME BY 60                      07030000
067300             GIVING PV-AUDIT-DURATION-HOURS                       07040000
067400          REMAINDER PV-AUDIT-DURATION-MINUTES                     07050000
067500                                                                  07060000
067600         MOVE PV-AUDIT-DURATION-HOURS                             07070000
067700                               TO HL3-AUDIT-DURATION-HH           07080000
067800         MOVE PV-AUDIT-DURATION-MINUTES                           07090000
067900                               TO HL3-AUDIT-DURATION-MM           07100000
068000     END-IF                                                       07110000
068100                                                                  07120000
068200     PERFORM 1300-LOCATION-NAME.                                  07130049
068300                                                                  07140000
068400     MOVE SUNAUD-OPER-UNT-ID   TO PV-OPER-UNT-ID.                 07150000
068500     MOVE PV-OPER-UNT-ID       TO HL4-AUDIT-FCLTY-ID.             07160000
068600     MOVE XL071-LOC-NM         TO HL4-AUDIT-FCLTY-NAME.           07170049
068700     MOVE SUNAUD-PRC-FCLTY-AREA-ID                                07180000
068800                               TO HL4-AUDIT-PRC-AREA.             07190000
068900                                                                  07200000
069100******************************************************************07210000
069200**  SELECT INFORMATION FROM THE SHIPPING UNIT AUDIT TABLE FOR THE 07220000
069300**  HEADER PORTION OF THE REPORT.                                 07230000
069400******************************************************************07240000
069000 1100-SELECT-TSUNAUD.                                             07250049
069500     INITIALIZE DCLTSUNAUD.                                       07260000
069600                                                                  07270000
069700     MOVE '1100-SELECT-TSUNAUD '                                  07280000
069800                                 TO PV-ABEND-PARAGRAPH.           07290000
069900     EXEC SQL                                                     07300000
070000       SELECT  AUD_STRT_TMST                                      07310000
070100              ,AUD_STP_TMST                                       07320000
070200              ,AUD_PSPND_MNIT_QTY                                 07330000
070300              ,AUD_CLO_MNIT_QTY                                   07340000
070400              ,OPER_UNT_ID                                        07350000
070500              ,FCLTY_ID                                           07360000
070600              ,PRC_FCLTY_AREA_ID                                  07370000
070700              ,AUD_STAT_CDE                                       07380000
070800              ,AUD_TYP_CDE                                        07390000
070900         INTO  :SUNAUD-AUD-STRT-TMST                              07400000
071000              ,:SUNAUD-AUD-STP-TMST                               07410000
071100              ,:SUNAUD-AUD-PSPND-MNIT-QTY                         07420000
071200              ,:SUNAUD-AUD-CLO-MNIT-QTY                           07430000
071300              ,:SUNAUD-OPER-UNT-ID                                07440000
071400              ,:SUNAUD-FCLTY-ID                                   07450000
071500              ,:SUNAUD-PRC-FCLTY-AREA-ID                          07460000
071600              ,:SUNAUD-AUD-STAT-CDE                               07470000
071700              ,:SUNAUD-AUD-TYP-CDE                                07480000
071800         FROM  TSUNAUD                                            07490000
071900        WHERE  AUD_CNTL_NBR = :SU004-AUD-CNTL-NBR                 07500000
072000     END-EXEC.                                                    07510000
072100                                                                  07520000
072200     EVALUATE TRUE                                                07530000
072300       WHEN SQLCODE = ZEROS                                       07540000
072400         CONTINUE                                                 07550000
072500       WHEN OTHER                                                 07560000
072600         DISPLAY PV-ABEND-PARAGRAPH                               07570000
072700         DISPLAY 'AUD CNTL NBR ' SU004-AUD-CNTL-NBR               07580000
072800         PERFORM Z999-SQL-ERROR                                   07590000
072900     END-EVALUATE.                                                07600000
073000                                                                  07610000
073100                                                                  07620000
073200 1200-CALC-DURATION.                                              07630000
073300******************************************************************07640000
073400**  CALCULATE THE DURATION OF THE AUDIT                           07650000
073500******************************************************************07660000
073600     INITIALIZE PV-AUDIT-DURATION-TIME.                           07670000
073700                                                                  07680000
073800     MOVE '1200-CALC-DURATION  ' TO PV-ABEND-PARAGRAPH.           07690000
073900                                                                  07700000
074000     EXEC SQL                                                     07710000
074100       SELECT                                                     07720000
074200           ((DAY(AUD_STP_TMST) - DAY(AUD_STRT_TMST)) * 1440) +    07730000
074300           ((HOUR(AUD_STP_TMST) - HOUR(AUD_STRT_TMST)) * 60) +    07740000
074400            (MINUTE(AUD_STP_TMST) - MINUTE(AUD_STRT_TMST))        07750000
074500         INTO                                                     07760000
074600             :PV-AUDIT-DURATION-TIME                              07770000
074700         FROM                                                     07780000
074800             TSUNAUD                                              07790000
074900        WHERE                                                     07800000
075000             AUD_CNTL_NBR = :SU004-AUD-CNTL-NBR                   07810000
075100     END-EXEC.                                                    07820000
075200                                                                  07830000
075300     EVALUATE TRUE                                                07840000
075400       WHEN SQLCODE = ZEROS                                       07850000
075500         CONTINUE                                                 07860000
075600       WHEN OTHER                                                 07870000
075700         DISPLAY PV-ABEND-PARAGRAPH                               07880000
075800         DISPLAY 'AUD CNTL NBR ' SU004-AUD-CNTL-NBR               07890000
075900         PERFORM Z999-SQL-ERROR                                   07900000
076000     END-EVALUATE.                                                07910000
076100                                                                  07920000
076200*                                                                 07930000
076400******************************************************************07940000
076500**  FETCH THE FACILITY NAME TO DISPLAY IN THE HEADING OF THE      07950000
076600**  REPORT                                                        07960000
076700******************************************************************07970000
076300 1300-LOCATION-NAME.                                              07980049
077000     MOVE '1300-LOCATION-NAME' TO PV-ABEND-PARAGRAPH.             07990049
076900                                                                  08000049
061600     INITIALIZE XL071-COMMAREA-REC.                               08010049
061700     MOVE SUNAUD-OPER-UNT-ID    TO XL071-LOCATION-NUMBER          08020049
061800                                                                  08030049
061900     CALL XL071-LOCATION-MODULE USING XL071-COMMAREA-REC.         08040049
062000                                                                  08050049
062100     EVALUATE TRUE                                                08060049
062200         WHEN XL071-NO-ERRORS                                     08070049
062300             CONTINUE                                             08080049
062400         WHEN XL071-LOC-NOT-FOUND                                 08090049
062500         WHEN XL071-DC-ASGMT-NOT-FND                              08100049
062600             MOVE 'UNKNOWN FACILITY' TO XL071-LOC-NM              08110049
062700         WHEN XL071-BAD-DB2-RETURN                                08120049
062800             DISPLAY PV-ABEND-PARAGRAPH                           08130049
078700             DISPLAY 'OPER UNT ID  ' SUNAUD-OPER-UNT-ID           08140049
062900             DISPLAY 'CALL LOCATION MOD '                         08150049
063000             DISPLAY 'XLT00010'                                   08160049
063100             MOVE XL071-SQLCA             TO SQLCA                08170049
063200             PERFORM Z999-SQL-ERROR                               08180049
063300     END-EVALUATE.                                                08190049
077100                                                                  08200000
079200*                                                                 08210000
079300 2000-PROCESS-SU.                                                 08220000
079400******************************************************************08230000
079500*  THIS IS THE MAIN CONTROLLING PARAGRAPH FOR PROCESSING THE     *08240000
079600*  VENDOR ACCURACY CARTON AUDIT REPORT.                          *08250000
079700******************************************************************08260000
079800     IF  PV-CURR-PO-RECEIVER = PV-PREV-PO-RECEIVER                08270000
079900         IF PV-CURR-STORE-NBR = PV-PREV-STORE-NBR                 08280000
080000             MOVE SPACES TO DL1-STR-NBR-X                         08290000
080100             PERFORM 3000-CREATE-DETAIL-LINE                      08300000
080200         ELSE                                                     08310000
080300             MOVE PV-CURR-STORE-NBR TO DL1-STR-NBR                08320000
080400             PERFORM 8300-WRITE-BLANK-LINE                        08330000
080500             PERFORM  3000-CREATE-DETAIL-LINE                     08340000
080600             MOVE  PV-CURR-STORE-NBR  TO PV-PREV-STORE-NBR        08350000
080700         END-IF                                                   08360000
080800     ELSE                                                         08370000
080900          PERFORM 3100-SETUP-PO-RECEIVER-HEADER                   08380000
081000          MOVE PV-CURR-STORE-NBR TO DL1-STR-NBR                   08390000
081100          PERFORM 8100-WRITE-REPORT-HEADERS-PO                    08400000
081200          PERFORM 3000-CREATE-DETAIL-LINE                         08410000
081300          MOVE PV-CURR-STORE-NBR   TO PV-PREV-STORE-NBR           08420000
081400          MOVE PV-CURR-PO-NBR      TO PV-PREV-PO-NBR              08430000
081500          MOVE PV-CURR-REC-SEQ-NBR TO PV-PREV-REC-SEQ-NBR         08440000
081600     END-IF.                                                      08450000
081700                                                                  08460000
081800     SET PS-NO-ERROR-FOUND TO TRUE                                08470000
081900                                                                  08480000
082000     PERFORM 7100-READ-RECEIVER-EXTRACT                           08490000
082100         UNTIL PS-ERROR-FOUND OR                                  08500000
082200            PS-END-OF-RECEIVER-FILE                               08510000
082300                                                                  08520000
082400     IF PS-END-OF-RECEIVER-FILE                                   08530000
082500         CONTINUE                                                 08540000
082600     ELSE                                                         08550000
082700         MOVE SU004-PO-NBR           TO PV-CURR-PO-NBR            08560000
082800                                        PV-PO                     08570000
082900         MOVE SU004-REC-SEQ-NBR      TO PV-CURR-REC-SEQ-NBR       08580000
083000                                        PV-RECEIVER               08590000
083100         MOVE SU004-DEST-OPER-UNT-ID TO PV-CURR-STORE-NBR         08600000
083200     END-IF.                                                      08610000
083300                                                                  08620000
083400                                                                  08630000
083500                                                                  08640000
083600 2100-FETCH-TRECEIV-INFO.                                         08650000
083700******************************************************************08660000
083800*  FETCH RECEIVER RELATED INFORMATION                            *08670000
083900******************************************************************08680000
084000     INITIALIZE DCLTRECEIV                                        08690000
084100                DCLTPURCHS                                        08700000
084200                DCLTENTNME.                                       08710000
084300                                                                  08720000
084400     MOVE '2100-FETCH-TRECEIV-INFO'                               08730000
084500                                 TO PV-ABEND-PARAGRAPH.           08740000
084600                                                                  08750000
084700     EXEC SQL                                                     08760000
084800       SELECT  A.REC_TMST                                         08770000
084900              ,A.EXPTED_CART_CNT                                  08780000
085000              ,A.ACTL_CART_CNT                                    08790000
085100              ,A.PACK_BY_ST_IND                                   08800000
085200              ,C.ENT_NAME_DESC                                    08810000
085300         INTO  :RECEIV-REC-TMST                                   08820000
085400              ,:RECEIV-EXPTED-CART-CNT                            08830000
085500              ,:RECEIV-ACTL-CART-CNT                              08840000
085600              ,:RECEIV-PACK-BY-ST-IND                             08850000
085700              ,:ENTNME-ENT-NAME-DESC                              08860000
085800         FROM  TRECEIV A                                          08870000
085900              ,TPURCHS B                                          08880000
086000              ,TENTNME C                                          08890000
086100        WHERE  A.ORD_NBR        = :SU004-PO-NBR                   08900000
086200          AND  A.REC_SEQ_NBR    = :SU004-REC-SEQ-NBR              08910000
086300          AND  A.ORD_NBR        = B.PO_NBR                        08920000
086400          AND  B.VER_STATUS_CDE = :PC-ACTIVE-STATUS               08930000
086500          AND  B.ENT_ID         = C.ENT_ID                        08940000
086600          AND  C.TYPE_CDE       = :PC-LONG-NAME                   08950000
086700     END-EXEC.                                                    08960000
086800                                                                  08970000
086900     EVALUATE TRUE                                                08980000
087000       WHEN SQLCODE = ZEROS                                       08990000
087100         CONTINUE                                                 09000000
087200       WHEN SQLCODE = +100                                        09010000
087300         MOVE 'UNKNOWN VENDOR' TO ENTNME-ENT-NAME-DESC            09020000
087400       WHEN OTHER                                                 09030000
087500         DISPLAY PV-ABEND-PARAGRAPH                               09040000
087600         DISPLAY 'PO NUMBER    '  SU004-PO-NBR                    09050000
087700         DISPLAY 'REC SEQ NBR  '  SU004-REC-SEQ-NBR               09060000
087800         PERFORM Z999-SQL-ERROR                                   09070000
087900     END-EVALUATE.                                                09080000
088000                                                                  09090000
088100                                                                  09100000
088200 2200-FETCH-TSUATRN-INFO.                                         09110000
088300******************************************************************09120000
088400*  FETCH AUDIT CARTON COUNT INFORMATION                          *09130000
088500******************************************************************09140000
088600     INITIALIZE PV-CARTONS-IN-AUDIT.                              09150000
088700                                                                  09160000
088800     MOVE '2200-FETCH-TSUATRN-INFO'                               09170000
088900                                 TO PV-ABEND-PARAGRAPH.           09180000
089000                                                                  09190000
089100     EXEC SQL                                                     09200000
089200       SELECT  COUNT(*)                                           09210000
089300         INTO  :PV-CARTONS-IN-AUDIT                               09220000
089400         FROM  TSUATRN                                            09230000
089500        WHERE  AUD_CNTL_NBR   = :SU004-AUD-CNTL-NBR               09240000
089600          AND  TRN_NBR        = :SU004-PO-NBR                     09250000
089700          AND  REC_SEQ_NBR    = :SU004-REC-SEQ-NBR                09260000
089800     END-EXEC.                                                    09270000
089900                                                                  09280000
090000     EVALUATE TRUE                                                09290000
090100       WHEN SQLCODE = ZEROS                                       09300000
090200       WHEN SQLCODE = +100                                        09310000
090300         CONTINUE                                                 09320000
090400       WHEN OTHER                                                 09330000
090500         DISPLAY PV-ABEND-PARAGRAPH                               09340000
090600         DISPLAY 'AUD CNTL NBR ' SU004-AUD-CNTL-NBR               09350000
090700         DISPLAY 'PO NUMBER    ' SU004-PO-NBR                     09360000
090800         DISPLAY 'REC SEQ NBR  ' SU004-REC-SEQ-NBR                09370000
090900         PERFORM Z999-SQL-ERROR                                   09380000
091000     END-EVALUATE.                                                09390000
091100                                                                  09400000
091200 7100-READ-RECEIVER-EXTRACT.                                      09410000
091300******************************************************************09420000
091400*  READ A RECORD FROM THE CARTON EXTRACT FILE.                   *09430000
091500******************************************************************09440000
091600     INITIALIZE SU004-EXTRACT-RECORD.                             09450000
091700                                                                  09460000
091800     READ RECEIVER-FILE INTO SU004-EXTRACT-RECORD                 09470000
091900        AT END                                                    09480000
092000           SET PS-END-OF-RECEIVER-FILE TO TRUE.                   09490000
092100                                                                  09500000
092200     IF PS-END-OF-RECEIVER-FILE                                   09510000
092300         CONTINUE                                                 09520000
092400     ELSE                                                         09530000
092500         IF SU004-QTY-AUD = SU004-QTY-RECV                        09540000
092600             SET PS-NO-ERROR-FOUND TO TRUE                        09550000
092700         ELSE                                                     09560000
092800             SET PS-ERROR-FOUND TO TRUE                           09570000
092900         END-IF                                                   09580000
093000     END-IF.                                                      09590000
093100******************************************************************09600000
093200*  MOVE FIELDS TO THE DETAIL LINE.                               *09610000
093300******************************************************************09620000
093400                                                                  09630000
093500 3000-CREATE-DETAIL-LINE.                                         09640000
093600                                                                  09650000
093610******************************************************************09660000
093630*  REPLACED SU004-SKU-SEQ-NBR AND DL1-SKU-NBR-SEQ WITH  WR#21361 *09670000
093631*  SU004-SKU-NMBR AND DL1-SKU-NMBR.                              *09680000
093640******************************************************************09690000
093700     MOVE SU004-SKU-DEPT-NBR       TO  DL1-SKU-NBR-DEPT.          09700000
093800     MOVE SU004-SKU-CL-NBR         TO  DL1-SKU-NBR-CLASS.         09710000
093910     MOVE SU004-SKU-NMBR           TO  DL1-SKU-NMBR.              09720000
094000     MOVE SU004-QTY-RECV           TO  DL1-EXPTED-UNITS.          09730000
094100     MOVE SU004-QTY-AUD            TO  DL1-AUDITED-UNITS.         09740000
094200     PERFORM 8400-WRITE-DETAIL-LINES.                             09750000
094300                                                                  09760000
094310******************************************************************09770000
094320*  CHANGES MADE FOR WR# 21361 ENDS HERE.                         *09780000
094330******************************************************************09790000
094400 3100-SETUP-PO-RECEIVER-HEADER.                                   09800000
094500     PERFORM 2100-FETCH-TRECEIV-INFO.                             09810000
094600                                                                  09820000
094700     MOVE PV-PO-RECEIVER         TO HL5-PO-RECEIVER               09830000
094800     MOVE ENTNME-ENT-NAME-DESC   TO HL5-VENDOR-NAME.              09840000
094900     MOVE RECEIV-PACK-BY-ST-IND  TO HL5-PBS-IND.                  09850000
095000                                                                  09860000
095100 8000-WRITE-REPORT-HEADERS.                                       09870000
095200******************************************************************09880000
095300*  PRINT THE HEADING FOR THE REPORT.                             *09890000
095400******************************************************************09900000
095500     PERFORM 8200-WRITE-TOP-LINE.                                 09910000
095600*                                                                 09920000
095700     WRITE SU-RECEIV-AUDIT-RPT-RECORD                             09930000
095800       FROM HEADING-LINE-0                                        09940000
095900         AFTER ADVANCING 2 LINE.                                  09950000
096000     WRITE SU-RECEIV-AUDIT-RPT-RECORD-REG                         09960000
096100       FROM HEADING-LINE-0                                        09970000
096200         AFTER ADVANCING 2 LINE.                                  09980000
096300*                                                                 09990000
096400     WRITE SU-RECEIV-AUDIT-RPT-RECORD                             10000000
096500       FROM HEADING-LINE-1                                        10010000
096600         AFTER ADVANCING 1 LINE.                                  10020000
096700     WRITE SU-RECEIV-AUDIT-RPT-RECORD-REG                         10030000
096800       FROM HEADING-LINE-1                                        10040000
096900         AFTER ADVANCING 1 LINE.                                  10050000
097000*                                                                 10060000
097100     WRITE SU-RECEIV-AUDIT-RPT-RECORD                             10070000
097200       FROM HEADING-LINE-2                                        10080000
097300         AFTER ADVANCING 3 LINES.                                 10090000
097400     WRITE SU-RECEIV-AUDIT-RPT-RECORD-REG                         10100000
097500       FROM HEADING-LINE-2                                        10110000
097600         AFTER ADVANCING 3 LINES.                                 10120000
097700*                                                                 10130000
097800     WRITE SU-RECEIV-AUDIT-RPT-RECORD                             10140000
097900       FROM HEADING-LINE-3                                        10150000
098000         AFTER ADVANCING 1 LINES.                                 10160000
098100     WRITE SU-RECEIV-AUDIT-RPT-RECORD-REG                         10170000
098200       FROM HEADING-LINE-3                                        10180000
098300         AFTER ADVANCING 1 LINES.                                 10190000
098400*                                                                 10200000
098500     WRITE SU-RECEIV-AUDIT-RPT-RECORD                             10210000
098600       FROM HEADING-LINE-4                                        10220000
098700         AFTER ADVANCING 2 LINES.                                 10230000
098800     WRITE SU-RECEIV-AUDIT-RPT-RECORD-REG                         10240000
098900       FROM HEADING-LINE-4                                        10250000
099000         AFTER ADVANCING 2 LINES.                                 10260000
099100     MOVE PC-11                   TO PV-LINE-CNT.                 10270000
099200*                                                                 10280000
099300 8100-WRITE-REPORT-HEADERS-PO.                                    10290000
099400******************************************************************10300000
099500*  PRINT THE HEADINGS WHEN NEW PO/RECEIVER.                      *10310000
099600******************************************************************10320000
099700                                                                  10330000
099800     IF PV-LINE-CNT          >                                    10340000
099900                               PC-MAX-FOR-PO-LINES                10350000
100000         PERFORM 8000-WRITE-REPORT-HEADERS                        10360000
100100     END-IF.                                                      10370000
100200                                                                  10380000
100300*                                                                 10390000
100400     WRITE SU-RECEIV-AUDIT-RPT-RECORD                             10400000
100500       FROM HEADING-LINE-5                                        10410000
100600         AFTER ADVANCING 3 LINES.                                 10420000
100700     WRITE SU-RECEIV-AUDIT-RPT-RECORD-REG                         10430000
100800       FROM HEADING-LINE-5                                        10440000
100900         AFTER ADVANCING 3 LINES.                                 10450000
101000*                                                                 10460000
101100     WRITE SU-RECEIV-AUDIT-RPT-RECORD                             10470000
101200       FROM PC-BLANK-LINE                                         10480000
101300         AFTER ADVANCING 1 LINE.                                  10490000
101400     WRITE SU-RECEIV-AUDIT-RPT-RECORD-REG                         10500000
101500       FROM PC-BLANK-LINE                                         10510000
101600         AFTER ADVANCING 1 LINE.                                  10520000
101700                                                                  10530000
101800     WRITE SU-RECEIV-AUDIT-RPT-RECORD                             10540000
101900       FROM HEADING-LINE-6                                        10550000
102000         AFTER ADVANCING 1 LINE.                                  10560000
102100     WRITE SU-RECEIV-AUDIT-RPT-RECORD-REG                         10570000
102200       FROM HEADING-LINE-6                                        10580000
102300         AFTER ADVANCING 1 LINE.                                  10590000
102400*                                                                 10600000
102500     WRITE SU-RECEIV-AUDIT-RPT-RECORD                             10610000
102600       FROM HEADING-LINE-7                                        10620000
102700         AFTER ADVANCING 1 LINE.                                  10630000
102800     WRITE SU-RECEIV-AUDIT-RPT-RECORD-REG                         10640000
102900       FROM HEADING-LINE-7                                        10650000
103000         AFTER ADVANCING 1 LINE.                                  10660000
103100*                                                                 10670000
103200     WRITE SU-RECEIV-AUDIT-RPT-RECORD                             10680000
103300       FROM PC-BLANK-LINE                                         10690000
103400         AFTER ADVANCING 1 LINE.                                  10700000
103500     WRITE SU-RECEIV-AUDIT-RPT-RECORD-REG                         10710000
103600       FROM PC-BLANK-LINE                                         10720000
103700         AFTER ADVANCING 1 LINE.                                  10730000
103800*                                                                 10740000
103900     ADD  PC-7                    TO PV-LINE-CNT.                 10750000
104000*                                                                 10760000
104100*                                                                 10770000
104200 8200-WRITE-TOP-LINE.                                             10780000
104300******************************************************************10790000
104400*     WRITES HEADER LINES 0 AND 1 WHEN MORE THAN ONE PAGE IS     *10800000
104500*     NEEDED FOR AN ASN NUMBER.                                  *10810000
104600******************************************************************10820000
104700     ADD 1                        TO PV-PAGE-CNT.                 10830000
104800*                                                                 10840000
104900     MOVE PV-PAGE-CNT             TO DP132O-PAGE-NUMBER.          10850000
105000*                                                                 10860000
105100     WRITE SU-RECEIV-AUDIT-RPT-RECORD                             10870000
105200       FROM DP132O-STANDRD-HEADER-132-COLS                        10880000
105300         AFTER ADVANCING PAGE.                                    10890000
105400     WRITE SU-RECEIV-AUDIT-RPT-RECORD-REG                         10900000
105500       FROM DP132O-STANDRD-HEADER-132-COLS                        10910000
105600         AFTER ADVANCING PAGE.                                    10920000
105700*                                                                 10930000
105800*                                                                 10940000
105900 8300-WRITE-BLANK-LINE.                                           10950000
106000     WRITE SU-RECEIV-AUDIT-RPT-RECORD                             10960000
106100       FROM PC-BLANK-LINE                                         10970000
106200         AFTER ADVANCING 1 LINE.                                  10980000
106300     WRITE SU-RECEIV-AUDIT-RPT-RECORD-REG                         10990000
106400       FROM PC-BLANK-LINE                                         11000000
106500         AFTER ADVANCING 1 LINE.                                  11010000
106600     ADD +1                          TO PV-LINE-CNT.              11020000
106700*                                                                 11030000
106800*                                                                 11040000
106900 8400-WRITE-DETAIL-LINES.                                         11050000
107000******************************************************************11060000
107100*     WRITES THE DETAIL LINE INFORMATION.                        *11070000
107200******************************************************************11080000
107300                                                                  11090000
107400     IF PV-LINE-CNT          > PC-MAX-REPORT-LINES                11100000
107500         PERFORM 8000-WRITE-REPORT-HEADERS                        11110000
107600         PERFORM 8100-WRITE-REPORT-HEADERS-PO                     11120000
107700     END-IF.                                                      11130000
107800                                                                  11140000
107900     WRITE SU-RECEIV-AUDIT-RPT-RECORD                             11150000
108000       FROM DETAIL-LINE1                                          11160000
108100         AFTER ADVANCING 1 LINE.                                  11170000
108200     WRITE SU-RECEIV-AUDIT-RPT-RECORD-REG                         11180000
108300       FROM DETAIL-LINE1                                          11190000
108400         AFTER ADVANCING 1 LINE.                                  11200000
108500*                                                                 11210000
108600     ADD +1                          TO PV-LINE-CNT.              11220000
108700*                                                                 11230000
108800*                                                                 11240000
108900******************************************************************11250000
109000*     SQL WARNING OR ERROR PROCESSING                            *11260000
109100******************************************************************11270000
109200                                                                  11280000
       Z999-SQL-ERROR.                                                  11290050
      *                                                                 11300050
      * SND 10/2009  DATA CONTENTION CHANGES START                      11310052
           IF SQLCODE                  = -904 OR -911 OR -913           11320051
              MOVE +4050               TO RETURN-CODE                   11330050
              STOP RUN                                                  11340050
           ELSE                                                         11350050
              PERFORM Z998-ABEND-PROGRAM                                11360050
           END-IF.                                                      11370050
      *                                                                 11380050
      *Z999-EXIT.                                                       11390050
      *                                                                 11400050
      * SND 10/2009  DATA CONTENTION CHANGES END                        11410052
       Z998-ABEND-PROGRAM.                                              11420050
109300*                                                                 11430000
109700     MOVE SQLCODE    TO SQLCODE2.                                 11440000
109800     MOVE SQLERRD(3) TO SQLERRD3.                                 11450000
109900     DISPLAY '** ABEND **       ** = SQLERROR'.                   11460000
110000     DISPLAY '** PROGRAM        ** = SUKRP015'.                   11470000
110100     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  11480000
110200     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  11490000
110300     DISPLAY '** SQLERRM        ** = ' SQLERRM.                   11500000
110400     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  11510000
110500     EXEC SQL                                                     11520000
110600         COMMIT                                                   11530000
110700     END-EXEC.                                                    11540000
110800     MOVE +4013 TO PV-ABEND-CODE.                                 11550000
110900     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         11560000
