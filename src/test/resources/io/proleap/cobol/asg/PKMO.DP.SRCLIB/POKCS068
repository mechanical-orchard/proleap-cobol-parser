000100*-----------------------*                                         00010005
000200 IDENTIFICATION DIVISION.                                         00020005
000300*-----------------------*                                         00030005
000400 PROGRAM-ID.    POKCS068.                                         00040005
000500 AUTHOR.        JIM SCHNEIDER.                                    00050005
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060005
000700 DATE-WRITTEN.  02-24-95.                                         00070005
000800 DATE-COMPILED.                                                   00080005
000900                                                                  00090005
001000*---------------------------------------------------------------* 00100005
001100*    W068 - ASN INQUIRY PROGRAM.                                * 00110005
001200*                                                               * 00120005
001300*    THIS PROGRAM DISPLAYS ASN STATUS INFORMATION AT THE PO     * 00130005
001400*    LEVEL. ALL FIELDS ARE INQUIRY ONLY.                        * 00140005
001500*                                                               * 00150005
001600*---------------------------------------------------------------* 00160005
001610*    IMPORTANT NOTE ABOUT THIS PROGRAM                            00170005
001620*                                                                 00180005
001630*    THE ASN CREATE DATE IS THE DATE THE VENDOR TRANSMITS THE ASN 00190005
001640*    TO THE MAILBOX. THE DATE IS REPRESENTED IN THE TIME ZONE OF  00200005
001650*    THE VENDOR TRANSMITTING IT. SO IF AN EASTERN TIME ZONE VENDOR00210005
001660*    TRANMITS SOMETHING AT MIDNIGHT ON 6/1/97. 6/1/97 WILL APPEAR 00220005
001670*    ON THE SCREEN EVEN THOUGH IT WAS STILL 5/31/97 IN THE CENTRAL00230005
001680*    TIME ZONE.                                                   00240005
001690*                                                                 00250005
001700*    THE MAILBOX PICKUP DATE/TIME IS THE DATE/TIME KOHL'S PICKS   00260005
001710*    UP THE TRANSMISSION FROM THE MAILBOX. THIS IS STORED ON THE  00270005
001720*    DATABASE AS THE TIME ZONE OF THE NETWORK. TWO OF THE THREE   00280005
001730*    NETWORKS WE WORK WITH ARE IN THE CENTRAL TIME ZONE. ONE      00290005
001740*    (SEARS) IS IN THE EASTERN TIME ZONE. WE CONVERT SEARS        00300005
001750*    TRANSMISSIONS TO CENTRAL TIME ZONE IN THIS PROGRAM. IN OTHER 00310005
001760*    WORDS, ALL OF THE MAILBOX PICKUP DATES/TIMES REPRESENT THE   00320005
001770*    CENTRAL TIME ZONE.                                           00330005
001780******************************************************************00340005
C98147*----------------------------------------------------------------*00350017
C98147* 11/17/14 - LINDA FRIESS          - CHG0098147                   00360017
C98147*    - EXPANDED PO NUMBER TO 8 DIGITS IN MAP AND COMMAREA         00370017
C98147*    - ADDED AN 8-DIGIT FORMAT FOR SELECTING PO NBR IN ASN TABLES 00380020
C98147*      (PARAGRAPH 4000)                                           00390020
C98147*----------------------------------------------------------------*00400017
140977* 05/03/16 - COGNIZANT             - CHG0140977                   00402024
140977*    - EXPANDED STORE NUMBER TO 4 DIGIT FOR PV-NAME-ID-OUT-CDE    00403025
140977*----------------------------------------------------------------*00406024
076319* DATE  10/27/2021                                                00407027
076320*            - CHANGE CALL OF 'DPKUT100' TO                     * 00408027
076321*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 00409027
076322*              MAKING THE CALL DYNAMIC VS STATIC                * 00409127
076323*     MADE BY: GERMAN BANDA            WR/IR #: CHG0263126        00409228
076312*                                                               * 00409327
076318*---------------------------------------------------------------* 00409427
CICS  *  CHANGED 11/15/2022    BY BARB SCHULTZ    WR: CHG0278485      8 00409530
CICS  *                                                               * 00409629
CICS  *  ADDED COPYBOOK DPWS930 AND MADE THE CICS ARCHITECTURE CALL   * 00409729
CICS  *  DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.    * 00409829
CICS  *---------------------------------------------------------------* 00409929
001790 ENVIRONMENT DIVISION.                                            00411029
001800                                                                  00420005
001900 DATA DIVISION.                                                   00430005
002000                                                                  00440005
002100 WORKING-STORAGE SECTION.                                         00450005
002200                                                                  00460005
002300 01  PC-PROGRAM-CONSTANTS.                                        00470005
002400     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00480005
002500                                                    'PO068A  '.   00490005
002600     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00500005
002700                                                    'POKM068 '.   00510005
002800     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00520005
002900                                                    'POKCS068'.   00530005
003200     05  PC-DTL-QUEUE-SEQ               PIC  9(01)  VALUE 3.      00540005
003300     05  PC-CRIT-SPEC-FORMAT            PIC  X(01)  VALUE '1'.    00550005
003400     05  PC-LIST-FORMAT                 PIC  X(01)  VALUE '2'.    00560005
003500     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +7      00570005
003600                                                    COMP SYNC.    00580005
003700     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00590005
003800                                                    COMP SYNC.    00600005
003900     05  PC-MAX-TABLE                   PIC S9(09)  VALUE         00610005
004000                                                    +4999.        00620005
004100     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00630005
004200                                                    +1000000      00640005
004300                                                    COMP-3.       00650005
004400     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +7      00660005
004500                                                    COMP SYNC.    00670005
004600     05  PC-MAX-RETRIES                 PIC S9(3)    VALUE 3      00680005
004700                                                     COMP-3.      00690005
004800     05  PC-PRO-TEXT                    PIC X(04)    VALUE 'PRO:'.00700005
004900     05  PC-ASN-TEXT                    PIC X(04)    VALUE 'ASN:'.00710005
005000     05  PC-NO-DATE                     PIC X(10)    VALUE        00720005
005010                                                     '9999-09-09'.00730005
005020                                                                  00740005
005030 01  PC-TSYMSG-NUMBERS.                                           00750005
005040     05  PC-TSYMSG-00008                PIC 9(5)    VALUE 00008.  00760005
005050     05  PC-TSYMSG-00050                PIC 9(5)    VALUE 00050.  00770005
005060     05  PC-TSYMSG-00069                PIC 9(5)    VALUE 00069.  00780005
005070     05  PC-TSYMSG-00070                PIC 9(5)    VALUE 00070.  00790005
005080     05  PC-TSYMSG-00101                PIC 9(5)    VALUE 00101.  00800005
005090     05  PC-TSYMSG-00279                PIC 9(5)    VALUE 00279.  00810005
005100     05  PC-TSYMSG-00984                PIC 9(5)    VALUE 00984.  00820005
005200     05  PC-TSYMSG-00994                PIC 9(5)    VALUE 00994.  00830005
005300                                                                  00840005
005400 01  PS-PROGRAM-SUBSCRIPTS.                                       00850005
005500     05  PS-SUB                         PIC S9(04)   VALUE +0     00860005
005600                                                     COMP SYNC.   00870005
005700                                                                  00880005
005800 01  PS-PROGRAM-SWITCHES.                                         00890005
005900     05  PS-ERROR-SW                    PIC X(01)    VALUE 'Y'.   00900005
006000         88  PS-NO-ERROR                             VALUE 'Y'.   00910005
006100         88  PS-ERROR                                VALUE 'N'.   00920005
006200     05  PS-INVALID-LOC-NBR-SW          PIC X(01)    VALUE 'N'.   00930010
006300         88  PS-INVALID-LOC-NBR                      VALUE 'Y'.   00940010
006400         88  PS-VALID-LOC-NBR                        VALUE 'N'.   00950010
006500     05  PS-DATE-INVALID-SW             PIC X(01)    VALUE 'N'.   00960005
006600         88  PS-DATE-INVALID                         VALUE 'Y'.   00970005
006700         88  PS-DATE-VALID                           VALUE 'N'.   00980005
006800     05  PS-TIME-INVALID-SW             PIC X(01)    VALUE 'N'.   00990005
006900         88  PS-TIME-INVALID                         VALUE 'Y'.   01000005
007000         88  PS-TIME-VALID                           VALUE 'N'.   01010005
007100     05  PS-END-OF-TABLE-SW             PIC X(01)    VALUE 'N'.   01020005
007200         88  PS-END-OF-TABLE                         VALUE 'Y'.   01030005
007300         88  PS-NOT-END-OF-TABLE                     VALUE 'N'.   01040005
007400     05  PS-END-OF-STORE-SW             PIC X(01)    VALUE 'N'.   01050005
007500         88  PS-END-OF-STORE                         VALUE 'Y'.   01060005
007600         88  PS-NOT-END-OF-STORE                     VALUE 'N'.   01070005
007700     05  PS-BUILD-STORE-NUMBER-SW       PIC X(01)    VALUE 'N'.   01080005
007800         88  PS-BUILD-STORE-NUMBER                   VALUE 'Y'.   01090005
007900         88  PS-NO-BUILD-STORE-NUMBER                VALUE 'N'.   01100005
008000     05  PS-PICKUP-DATE-FOUND-SW        PIC X(01)    VALUE 'N'.   01110005
008100         88  PS-PICKUP-DATE-FOUND                    VALUE 'Y'.   01120005
008200         88  PS-NO-PICKUP-DATE-FOUND                 VALUE 'N'.   01130005
008300     05  PS-STORE-CRE-DATE-SW           PIC X(01)    VALUE 'N'.   01140005
008400         88  PS-STORE-CRE-DATE                       VALUE 'Y'.   01150005
008500         88  PS-DONT-STORE-CRE-DATE                  VALUE 'N'.   01160005
008600                                                                  01170005
008700 01  PV-PROGRAM-VARIABLES.                                        01180005
008800     05     PV-TALLY                   PIC S9(04)   COMP          01190005
008900                                                    VALUE +0.     01200005
008910                                                                  01210005
008920     05  PV-REMAINDER                   PIC S9(04)   VALUE +0     01220005
008930                                                     COMP SYNC.   01230005
008940     05  PV-READ-COUNT                  PIC S9(09)   VALUE +0     01240005
008950                                                     COMP-3.      01250005
008960     05  PV-TOP-ITEM                    PIC S9(09)   VALUE +0     01260005
008970                                                     COMP-3.      01270005
008980     05  PV-BOTTOM-ITEM                 PIC S9(09)   VALUE +0     01280005
008990                                                     COMP-3.      01290005
009000     05  PV-BLOCK-NUMBER                PIC S9(04)   VALUE +0     01300005
009100                                                     COMP SYNC.   01310005
009200     05  PV-CICS-RESP                   PIC S9(04)   VALUE +0     01320005
009300                                                     COMP SYNC.   01330005
009400     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)   VALUE +0     01340005
009500                                                     COMP SYNC.   01350005
009600     05  PV-LIST-ITEM-NUMBER            PIC S9(04)   VALUE +0     01360005
009700                                                     COMP SYNC.   01370005
009800     05  PV-SQL-SUB                     PIC S9(4)    COMP.        01380005
009900                                                                  01390005
010000     05  PV-CARTON-COUNT                PIC S9(9)    VALUE +0     01400005
010100                                                     COMP.        01410005
010200     05  PV-PACK-BY-STORE-COUNT         PIC S9(9)    VALUE +0     01420005
010300                                                     COMP.        01430005
010400     05  PV-TABLE-COUNTER               PIC 9(4)     VALUE ZEROES.01440005
010600     05  PV-CARTONS                     PIC 9(6)     VALUE ZEROES.01450005
010700     05  PV-UNITS                       PIC 9(7)     VALUE ZEROES.01460005
010800     05  PV-FACILITY                    PIC X(05)    VALUE SPACES.01470005
010900     05  PV-HOLD-PO-NUMBER-COMP         PIC S9(9)    COMP.        01480005
011000     05  PV-PO-NBR                      PIC 9(10)    VALUE ZEROES.01490005
011100     05  PV-PO-NMBR                     PIC S9(9) COMP.           01500005
011200     05  PV-ASN-PO-NBR-6                PIC X(22)    VALUE SPACES.01510005
011300     05  PV-ASN-PO-NBR-7                PIC X(22)    VALUE SPACES.01520005
C98147     05  PV-ASN-PO-NBR-8                PIC X(22)    VALUE SPACES.01530018
011400     05  PV-STORE-NBR                   PIC X(04).                01540011
011500     05  PV-STORE-NBR-NUM               PIC 9(04).                01550011
011500     05  PV-DB-STR-NBR                  PIC S9(4) COMP.           01560013
011600     05  PV-PRO-NUMBER-NULL             PIC S9(04)   VALUE +0     01570005
011700                                                     COMP SYNC.   01580005
011800     05  PV-SHIPT-QTY-NULL              PIC S9(04)   VALUE +0     01590005
011900                                                     COMP SYNC.   01600005
012000     05  PV-CARTON-CNT-NULL             PIC S9(04)   VALUE +0     01610005
012100                                                     COMP SYNC.   01620005
012200     05  PV-NAME-ID-CDE-NULL            PIC S9(04)   VALUE +0     01630005
012300                                                     COMP SYNC.   01640005
012400     05  PV-ID-CTR                      PIC 99       VALUE ZEROES.01650005
012500     05  PV-OUT-CTR                     PIC 9        VALUE ZERO.  01660005
012600     05  PV-STR-NBR-CTR                 PIC 99       VALUE ZERO.  01670005
012700                                                                  01680005
012800     05  PV-PRE-CONV-DATE               PIC X(10).                01690005
012900                                                                  01700005
013000     05  PV-DATE-10.                                              01710005
013100         10  PV-CENTURY-10              PIC 9(02).                01720005
013200         10  PV-YEAR-10                 PIC 9(02).                01730005
013300         10  FILLER                     PIC X(01)    VALUE SPACES.01740005
013400         10  PV-MONTH-10                PIC 9(02).                01750005
013500         10  FILLER                     PIC X(01)    VALUE SPACES.01760005
013600         10  PV-DAY-10                  PIC 9(02).                01770005
013700                                                                  01780005
013800     05  PV-DATE-8.                                               01790005
013900         10  PV-MONTH-8                 PIC X(02).                01800005
014000         10  PV-SLASH-1                 PIC X(01)    VALUE '/'.   01810005
014100         10  PV-DAY-8                   PIC X(02).                01820005
014200         10  PV-SLASH-2                 PIC X(01)    VALUE '/'.   01830005
014300         10  PV-YEAR-8                  PIC X(02).                01840005
014400                                                                  01850005
           05  PV-DATE-8-RC                   PIC X(08)     VALUE SPACE.01860006
           05  PV-DATE-8-PU                   PIC X(08)     VALUE SPACE.01870006
014500***  05  PV-HOLD-CRE-TIME               PIC 9(04).                01880005
014600***  05  FILLER REDEFINES PV-HOLD-CRE-TIME.                       01890005
014700***      10 PV-HOLD-CRE-HOUR            PIC 9(02).                01900005
014800***      10 PV-HOLD-CRE-MINUTE          PIC 9(02).                01910005
014810                                                                  01920005
014820     05  PV-HOLD-CRE-TIME               PIC X(08).                01930005
014830     05  FILLER REDEFINES PV-HOLD-CRE-TIME.                       01940005
014840         10 PV-HOLD-CRE-HOUR            PIC 9(02).                01950005
014841         10 FILLER                      PIC X(01).                01960005
014850         10 PV-HOLD-CRE-MINUTE          PIC 9(02).                01970005
014860         10 FILLER                      PIC X(01).                01980005
014870         10 PV-HOLD-CRE-SECOND          PIC 9(02).                01990005
014900                                                                  02000005
015000     05  PV-STORE-CRE-DATE              PIC X(10).                02010005
015100     05  PV-STORE-CRE-TIME              PIC X(5).                 02020005
015200                                                                  02030005
015300     05  PV-TIME.                                                 02040005
015400         10 PV-HOUR                     PIC X(02).                02050005
015500         10 FILLER REDEFINES PV-HOUR.                             02060005
015600            15 PV-HOUR-N                PIC 9(02).                02070005
015700         10 PV-COLON                    PIC X(01).                02080005
015800         10 PV-MINUTE                   PIC X(02).                02090005
015810         10 FILLER REDEFINES PV-MINUTE.                           02100005
015820            15 PV-MINUTE-N              PIC 9(02).                02110005
                                                                        02120006
           05  PV-TIME-RC                     PIC X(05)    VALUE SPACES.02130006
           05  PV-TIME-PU                     PIC X(05)    VALUE SPACES.02140006
015830                                                                  02150005
015840     05  PV-PACK-BY-STORE-TABLE.                                  02160005
015850         10  PV-PACK-BY-STORE-ENTRY OCCURS 5000 TIMES.            02170005
015860             15  PV-PBS-CRE-DATE      PIC X(10).                  02180005
015870             15  PV-PBS-CRE-TIME      PIC X(5).                   02190005
015880             15  PV-PBS-RC-DATE       PIC X(8).                   02200005
015890             15  PV-PBS-RC-TIME       PIC X(5).                   02210005
015880             15  PV-PBS-PU-DATE       PIC X(8).                   02220005
015890             15  PV-PBS-PU-TIME       PIC X(5).                   02230005
015900             15  PV-PBS-BOL           PIC X(30).                  02240005
016000             15  PV-PBS-PRO           PIC X(30).                  02250005
016100             15  PV-PBS-ASN           PIC X(30).                  02260005
016200             15  PV-PBS-FACILITY      PIC X(5).                   02270005
016300             15  PV-PBS-UNITS         PIC 9(7).                   02280005
016400             15  PV-PBS-CARTONS       PIC 9(6).                   02290005
016500                                                                  02300005
016600                                                                  02310005
140977     05 PV-NAME-ID-OUT-CDE            PIC X(4).                   02320024
016800     05 FILLER REDEFINES PV-NAME-ID-OUT-CDE.                      02330005
140977        10 PV-NAME-ID-OUT-TABLE  OCCURS 4 TIMES.                  02340024
017000           15  PV-NAME-ID-OUT         PIC X.                      02350005
017100                                                                  02360005
017200     05 PV-NAME-ID-CDE                PIC X(17).                  02370005
017300     05 FILLER REDEFINES PV-NAME-ID-CDE.                          02380005
017400        10 PV-NAME-ID-TABLE OCCURS 17 TIMES.                      02390005
017500           15  PV-NAME-ID-CHAR        PIC X.                      02400005
017600                                                                  02410005
017700     05 PV-ASNHDR-NBR                 PIC X(30).                  02420005
017800                                                                  02430005
017900 01  PV-DB2-CRITERIA-AREA.                                        02440005
018000     15  PV-DB2-MESSAGE-NUMBER          PIC S9(05)  VALUE ZERO    02450005
018100                                                    COMP-3.       02460005
018200                                                                  02470005
018300 EJECT                                                            02480005
018400*---------------------------------------------------------------* 02490005
CICS  *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * 02500029
018600*---------------------------------------------------------------* 02510005
018700                                                                  02520005
018800     COPY DPWS030.                                                02530005
CICS       COPY DPWS930.                                                02531029
018900 EJECT                                                            02540005
019000*---------------------------------------------------------------* 02550005
019100*    STANDARD COMMAREA.                                         * 02560005
019200*---------------------------------------------------------------* 02570005
019300                                                                  02580005
019400     COPY DPWS020.                                                02590005
019500     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02600005
019600                                                                  02610005
019700*---------------------------------------------------------------* 02620005
019800*    INTER-APPLICATION COMMAREA.                                * 02630005
019900*---------------------------------------------------------------* 02640005
020000                                                                  02650005
020100         10  INTER-APPL-COMM-AREA       PIC X(200).               02660005
020200     COPY POWS017.                                                02670005
020300*---------------------------------------------------------------* 02680005
020400*    SPECIFIC COMMMAREA FOR POKCS068.                           * 02690005
020500*---------------------------------------------------------------* 02700005
020600         10  ASC-SPECIFIC-COMMAREA.                               02710005
020700             15  ASC-LIST-KEYS.                                   02720005
C98147                 20  ASC-KEY-PO-NUMBER               PIC Z(08).   02730018
020900                 20  ASC-NETWK-NAME                  PIC X(05).   02740005
021000             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                02750005
021100                 20  ASC-ITEM-ENTRIES OCCURS 7 TIMES.             02760005
021200                     25  ASC-LIST-ITEM-NUMBER        PIC S9(09)   02770005
021300                                                     COMP-3.      02780005
021500                     25  ASC-RC-DATE                 PIC X(8).    02790005
021600                     25  ASC-RC-TIME                 PIC X(5).    02800005
021500                     25  ASC-PU-DATE                 PIC X(8).    02810005
021600                     25  ASC-PU-TIME                 PIC X(5).    02820005
021700                     25  ASC-BOL-NUMBER              PIC X(27).   02830005
021800                     25  ASC-UNITS                   PIC ZZZZZZ9. 02840005
021900                     25  ASC-CARTONS                 PIC ZZZZZ9.  02850005
022000                     25  ASC-FACILITY                PIC X(5).    02860005
022100                     25  ASC-PRO-NUMBER              PIC X(30).   02870005
022200                     25  ASC-ASN-NUMBER              PIC X(30).   02880005
022300             15  ASC-BLK-SUB                         PIC S9(04)   02890005
022400                                                         COMP     02900005
022500                                                         SYNC.    02910005
022600             15  ASC-ITEM-SUB                        PIC S9(04)   02920005
022700                                                         COMP     02930005
022800                                                         SYNC.    02940005
022900             15  ASC-SEL-SUB                         PIC S9(04)   02950005
023000                                                         COMP.    02960005
023100             15  ASC-SEL-ITEM                        PIC S9(04)   02970005
023200                                                         COMP.    02980005
023300             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)   02990005
023400                                                         COMP-3.  03000005
023500             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   03010005
023600                                                         COMP-3.  03020005
023700             15  ASC-NUMBER-OF-TS-ITEMS              PIC S9(05)   03030005
023800                                                         COMP-3.  03040005
023900             15  ASC-ITEMS-DISPLAYED                 PIC S9(03)   03050005
024000                                                         COMP-3.  03060005
024100             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   03070005
024200                                                         COMP-3.  03080005
024300             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)   03090005
024400                                                         COMP-3.  03100005
024500             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)   03110005
024600                                                         COMP     03120005
024700                                                         SYNC.    03130005
024800             15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   03140005
024900                                                         COMP-3.  03150005
025000             15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   03160005
025100                                                         COMP-3.  03170005
025200             15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  03180005
025300                 88  ASC-ITEMS-LEFT-ON-DB              VALUE 'Y'. 03190005
025400                 88  ASC-NO-ITEMS-LEFT-ON-DB           VALUE 'N'. 03200005
025500             15  ASC-USE-SELECTION-QUEUE-IND         PIC  X(01).  03210005
025600                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 03220005
025700             15  ASC-DESC-LINE-IND                   PIC  X(01).  03230005
025800                 88  ASC-DESC-LINE-DONE                VALUE 'Y'. 03240005
025900             15  ASC-CORR-LINE-IND                   PIC  X(01).  03250005
026000                 88  ASC-CORR-LINE-DONE                VALUE 'Y'. 03260005
026100             15  ASC-LIST-QUEUE-NAME.                             03270005
026200                 20  ASC-LIST-TERM-ID                PIC  X(04).  03280005
026300                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   03290005
026400                                                         COMP-3.  03300005
026500                 20  ASC-LIST-SEQ                    PIC  9(01).  03310005
026600             15  ASC-SEL-QUEUE-NAME.                              03320005
026700                 20  ASC-SEL-TERM-ID                 PIC  X(04).  03330005
026800                 20  ASC-SEL-TASK-NUMBER             PIC S9(05)   03340005
026900                                                          COMP-3. 03350005
027000                 20  ASC-SEL-SEQ                     PIC  9(01).  03360005
027100             15  ASC-DTL-QUEUE-NAME.                              03370005
027200                 20  ASC-DTL-TERM-ID                 PIC  X(04).  03380005
027300                 20  ASC-DTL-TASK-NUMBER             PIC S9(05)   03390005
027400                                                         COMP-3.  03400005
027500                 20  ASC-DTL-SEQ                     PIC  9(01).  03410005
027600                                                                  03420005
027700             15  ASC-START-ITEM-REQUEST.                          03430005
027800                 20  ASC-START-ITEM-REQUEST-N        PIC  9(07).  03440005
027900                                                                  03450005
028000     EJECT                                                        03460005
028100*---------------------------------------------------------------* 03470005
028200*    MESSAGE SELECTION TSQ B QUEUE RECORD LAYOUT.               * 03480005
028300*---------------------------------------------------------------* 03490005
028400                                                                  03500005
028500     COPY DPWS057.                                                03510005
028600                                                                  03520005
028700     EJECT                                                        03530005
028800*---------------------------------------------------------------* 03540005
028900*    ABEND PROCESSING COPYBOOK.                                 * 03550005
029000*---------------------------------------------------------------* 03560005
029100                                                                  03570005
029200     COPY DPWS013.                                                03580005
029300                                                                  03590005
029400     EJECT                                                        03600005
029500*---------------------------------------------------------------* 03610005
029600*    ATTRIBUTE SETTINGS COPYBOOK.                               * 03620005
029700*---------------------------------------------------------------* 03630005
029800                                                                  03640005
029900     COPY DPWS015.                                                03650005
030000                                                                  03660005
030100*---------------------------------------------------------------* 03670005
030200*    FUNCTION KEYS COPYBOOK.                                    * 03680005
030300*---------------------------------------------------------------* 03690005
030400                                                                  03700005
030500     COPY DPWS016.                                                03710005
030600                                                                  03720005
030700*---------------------------------------------------------------* 03730005
030800*    NUMERIC EDIT LAYOUT.                                       * 03740005
030900*---------------------------------------------------------------* 03750005
031000                                                                  03760005
031100     COPY DPWS010I.                                               03770005
031200                                                                  03780005
031300*---------------------------------------------------------------* 03790005
031400*    DATE CONVERSION ROUTINE                                    * 03800005
031500*---------------------------------------------------------------* 03810005
031600                                                                  03820005
031700     COPY DPWS500.                                                03830005
031800                                                                  03840005
031900*---------------------------------------------------------------* 03850005
032000*    MAP LAYOUT                                                 * 03860005
032100*---------------------------------------------------------------* 03870005
032200                                                                  03880005
032300     COPY POKM068.                                                03890005
032400                                                                  03900005
032500 01  MR-OCCURS-LAYOUT          REDEFINES  PO068AO.                03910005
032600     05  FILLER                PIC X(48).                         03920005
032700                                                                  03930005
032800     05  MR-PO-NBR-L            PIC S9(04) COMP.                  03940005
032900     05  MR-PO-NBR-A            PIC  X(01).                       03950005
033000     05  MR-PO-NBR-C            PIC  X(01).                       03960005
033100     05  MR-PO-NBR-H            PIC  X(01).                       03970005
C98147     05  MR-PO-NBR              PIC  X(08).                       03980018
033300                                                                  03990005
033400     05  MR-ENT-NAME-DESC-L     PIC S9(04) COMP.                  04000005
033500     05  MR-ENT-NAME-DESC-A     PIC  X(01).                       04010005
033600     05  MR-ENT-NAME-DESC-C     PIC  X(01).                       04020005
033700     05  MR-ENT-NAME-DESC-H     PIC  X(01).                       04030005
033800     05  MR-ENT-NAME-DESC       PIC  X(30).                       04040005
033900                                                                  04050005
034000     05  MR-NTWK-NAME-L         PIC S9(04) COMP.                  04060005
034100     05  MR-NTWK-NAME-A         PIC  X(01).                       04070005
034200     05  MR-NTWK-NAME-C         PIC  X(01).                       04080005
034300     05  MR-NTWK-NAME-H         PIC  X(01).                       04090005
034400     05  MR-NTWK-NAME           PIC  X(05).                       04100005
034500                                                                  04110005
034600     05  MR-SCROLL-AREA OCCURS 7 TIMES.                           04120005
035300         10  MR-ASN-RC-DTE-L       PIC S9(04) COMP.               04130005
035400         10  MR-ASN-RC-DTE-A       PIC  X(01).                    04140005
035410         10  MR-ASN-RC-DTE-C       PIC  X(01).                    04150005
035420         10  MR-ASN-RC-DTE-H       PIC  X(01).                    04160005
035430         10  MR-ASN-RC-DTE         PIC  X(08).                    04170005
035440                                                                  04180005
035450         10  MR-ASN-RC-TME-L    PIC S9(04) COMP.                  04190005
035460         10  MR-ASN-RC-TME-A    PIC  X(01).                       04200005
035470         10  MR-ASN-RC-TME-C    PIC  X(01).                       04210005
035480         10  MR-ASN-RC-TME-H    PIC  X(01).                       04220005
035490         10  MR-ASN-RC-TME      PIC  X(05).                       04230005
                                                                        04240005
035300         10  MR-ASN-PU-DTE-L       PIC S9(04) COMP.               04250005
035400         10  MR-ASN-PU-DTE-A       PIC  X(01).                    04260005
035410         10  MR-ASN-PU-DTE-C       PIC  X(01).                    04270005
035420         10  MR-ASN-PU-DTE-H       PIC  X(01).                    04280005
035430         10  MR-ASN-PU-DTE         PIC  X(08).                    04290005
035440                                                                  04300005
035450         10  MR-ASN-PU-TME-L    PIC S9(04) COMP.                  04310005
035460         10  MR-ASN-PU-TME-A    PIC  X(01).                       04320005
035470         10  MR-ASN-PU-TME-C    PIC  X(01).                       04330005
035480         10  MR-ASN-PU-TME-H    PIC  X(01).                       04340005
035490         10  MR-ASN-PU-TME      PIC  X(05).                       04350005
035500                                                                  04360005
035600         10  MR-BOL-L           PIC S9(04) COMP.                  04370005
035700         10  MR-BOL-A           PIC  X(01).                       04380005
035800         10  MR-BOL-C           PIC  X(01).                       04390005
035900         10  MR-BOL-H           PIC  X(01).                       04400005
036000         10  MR-BOL             PIC  X(27).                       04410005
036100                                                                  04420005
036200         10  MR-UNITS-L         PIC S9(04) COMP.                  04430005
036300         10  MR-UNITS-A         PIC  X(01).                       04440005
036400         10  MR-UNITS-C         PIC  X(01).                       04450005
036500         10  MR-UNITS-H         PIC  X(01).                       04460005
036600         10  MR-UNITS           PIC  X(07).                       04470005
036700                                                                  04480005
036800         10  MR-CARTONS-L       PIC S9(04) COMP.                  04490005
036900         10  MR-CARTONS-A       PIC  X(01).                       04500005
037000         10  MR-CARTONS-C       PIC  X(01).                       04510005
037100         10  MR-CARTONS-H       PIC  X(01).                       04520005
037200         10  MR-CARTONS         PIC  X(06).                       04530005
037300                                                                  04540005
037400         10  MR-FACILITY-L      PIC S9(04) COMP.                  04550005
037500         10  MR-FACILITY-A      PIC  X(01).                       04560005
037600         10  MR-FACILITY-C      PIC  X(01).                       04570005
037700         10  MR-FACILITY-H      PIC  X(01).                       04580005
037800         10  MR-FACILITY        PIC  X(05).                       04590005
037900                                                                  04600005
038000         10  MR-PRO-TEXT-L      PIC S9(04) COMP.                  04610005
038100         10  MR-PRO-TEXT-A      PIC  X(01).                       04620005
038200         10  MR-PRO-TEXT-C      PIC  X(01).                       04630005
038300         10  MR-PRO-TEXT-H      PIC  X(01).                       04640005
038400         10  MR-PRO-TEXT        PIC  X(04).                       04650005
038500                                                                  04660005
038600         10  MR-PRO-L           PIC S9(04) COMP.                  04670005
038700         10  MR-PRO-A           PIC  X(01).                       04680005
038800         10  MR-PRO-C           PIC  X(01).                       04690005
038900         10  MR-PRO-H           PIC  X(01).                       04700005
039000         10  MR-PRO             PIC  X(30).                       04710005
039100                                                                  04720005
039200         10  MR-ASN-TEXT-L      PIC S9(04) COMP.                  04730005
039300         10  MR-ASN-TEXT-A      PIC  X(01).                       04740005
039400         10  MR-ASN-TEXT-C      PIC  X(01).                       04750005
039500         10  MR-ASN-TEXT-H      PIC  X(01).                       04760005
039600         10  MR-ASN-TEXT        PIC  X(04).                       04770005
039700                                                                  04780005
039800         10  MR-ASN-L           PIC S9(04) COMP.                  04790005
039900         10  MR-ASN-A           PIC  X(01).                       04800005
040000         10  MR-ASN-C           PIC  X(01).                       04810005
040100         10  MR-ASN-H           PIC  X(01).                       04820005
040200         10  MR-ASN             PIC  X(30).                       04830005
040300                                                                  04840005
040400 EJECT                                                            04850005
040500*---------------------------------------------------------------* 04860005
040600*    DB2 AREA FOR COMMUNICATIONS                                * 04870005
040700*---------------------------------------------------------------* 04880005
040800     EXEC SQL                                                     04890005
040900          INCLUDE SQLCA                                           04900005
041000     END-EXEC.                                                    04910005
041100                                                                  04920005
041200*---------------------------------------------------------------* 04930005
041300*    DB2 AREA FOR TMESSAGE                                      * 04940005
041400*---------------------------------------------------------------* 04950005
041500     EXEC SQL                                                     04960005
041600          INCLUDE TSYMSG                                          04970005
041700     END-EXEC.                                                    04980005
041800                                                                  04990005
041900*---------------------------------------------------------------* 05000005
042000*    DB2 AREA FOR ASN HEADER                                    * 05010005
042100*---------------------------------------------------------------* 05020005
042200     EXEC SQL                                                     05030005
042300          INCLUDE TASNHDR                                         05040005
042400     END-EXEC.                                                    05050005
042500                                                                  05060005
042600*---------------------------------------------------------------* 05070005
042700*    DB2 AREA FOR ASN ORDER                                     * 05080005
042800*---------------------------------------------------------------* 05090005
042900     EXEC SQL                                                     05100005
043000          INCLUDE TASNORD                                         05110005
043100     END-EXEC.                                                    05120005
043200                                                                  05130005
043300*---------------------------------------------------------------* 05140005
043400*    DB2 AREA FOR ASN DETAIL                                    * 05150005
043500*---------------------------------------------------------------* 05160005
043600     EXEC SQL                                                     05170005
043700          INCLUDE TASNDTL                                         05180005
043800     END-EXEC.                                                    05190005
043900                                                                  05200005
044000*---------------------------------------------------------------* 05210005
044100*    DB2 AREA FOR ADVANCED SHIP NOTICE DETAIL                   * 05220005
044200*---------------------------------------------------------------* 05230005
044300     EXEC SQL                                                     05240005
044400          INCLUDE TASNCAR                                         05250005
044500     END-EXEC.                                                    05260005
044600                                                                  05270005
044700*---------------------------------------------------------------* 05280005
044800*    DB2 AREA FOR ASN HEADER NAME AND ADDRESS DETAIL            * 05290005
044900*---------------------------------------------------------------* 05300005
045000     EXEC SQL                                                     05310005
045100          INCLUDE TASHADR                                         05320005
045200     END-EXEC.                                                    05330005
045300                                                                  05340005
045400*---------------------------------------------------------------* 05350005
045500*    DB2 AREA FOR PURCHASE ORDER HEADER                         * 05360005
045600*---------------------------------------------------------------* 05370005
045700     EXEC SQL                                                     05380005
045800          INCLUDE TPURCHS                                         05390005
045900     END-EXEC.                                                    05400005
046000                                                                  05410005
046100*---------------------------------------------------------------* 05420005
046200*    DB2 AREA FOR PURCHASE ORDER AGREEMENT                      * 05430005
046300*---------------------------------------------------------------* 05440005
046400     EXEC SQL                                                     05450005
046500          INCLUDE TPOAGMT                                         05460005
046600     END-EXEC.                                                    05470005
046700                                                                  05480005
046800*---------------------------------------------------------------* 05490005
046900*    DB2 AREA FOR NETWORK TABLE                                 * 05500005
047000*---------------------------------------------------------------* 05510005
047100     EXEC SQL                                                     05520005
047200          INCLUDE TNETWRK                                         05530005
047300     END-EXEC.                                                    05540005
047400                                                                  05550005
047500*---------------------------------------------------------------* 05560005
047600*    DB2 AREA FOR TRADING PARTNERSHIP TABLE                     * 05570005
047700*---------------------------------------------------------------* 05580005
047800     EXEC SQL                                                     05590005
047900          INCLUDE TTRDPRT                                         05600005
048000     END-EXEC.                                                    05610005
048100                                                                  05620005
048200*---------------------------------------------------------------* 05630005
048300*    DB2 AREA FOR TRADING PARTNERSHIP TRANSACTION TABLE         * 05640005
048400*---------------------------------------------------------------* 05650005
048500     EXEC SQL                                                     05660005
048600          INCLUDE TTRDTRN                                         05670005
048610     END-EXEC.                                                    05680005
048620                                                                  05690005
048630*---------------------------------------------------------------* 05700005
048640*    DB2 AREA FOR LOCATION                                      * 05710008
048650*---------------------------------------------------------------* 05720005
048660     EXEC SQL                                                     05730005
048670          INCLUDE XMT00001                                        05740008
048680     END-EXEC.                                                    05750005
048690                                                                  05760005
048700*---------------------------------------------------------------* 05770005
048800*    DB2 AREA                                                     05780005
048900*---------------------------------------------------------------* 05790005
049000     EXEC SQL                                                     05800005
049100          INCLUDE TFGTRST                                         05810005
049200     END-EXEC.                                                    05820005
049210                                                                  05830005
049220*---------------------------------------------------------------* 05840005
049230*    DB2 AREA                                                     05850005
049240*---------------------------------------------------------------* 05860005
049250     EXEC SQL                                                     05870005
049260          INCLUDE TINTTRN                                         05880005
049270     END-EXEC.                                                    05890005
049280                                                                  05900005
049290*                                                                 05910005
049300*  CURSOR TO FETCH ASN HEADER INFORMATION                         05920005
049400*                                                                 05930005
049500     EXEC SQL                                                     05940005
049600       DECLARE ASN_HEADER_CURSOR CURSOR FOR                       05950005
049700         SELECT DISTINCT                                          05960005
049800                A.ASNHDR_NBR,                                     05970005
049900                A.ASNHDR_ID,                                      05980005
050000                A.CRE_DTE,                                        05990005
050100                A.BOL_NBR,                                        06000005
050200                A.PRO_NBR,                                        06010005
050300                A.CRE_TM                                          06020005
050400           FROM TASNHDR A,                                        06030005
050500                TASNORD B                                         06040005
050600           WHERE A.ASNHDR_ID    = B.ASNHDR_ID                     06050005
C98147             AND B.PO_NBR IN                                      06060018
C98147             (:PV-ASN-PO-NBR-6,:PV-ASN-PO-NBR-7,:PV-ASN-PO-NBR-8) 06070019
050800           ORDER BY A.CRE_DTE DESC,                               06080005
050900                    A.CRE_TM DESC,                                06090005
051000                    A.BOL_NBR                                     06100005
051100     END-EXEC.                                                    06110005
051200                                                                  06120005
051300     EXEC SQL                                                     06130005
051310       DECLARE MAILBOX_CURSOR CURSOR FOR                          06140005
051320        SELECT MAILBOX_PU_DTE, MAILBOX_PU_TME,                    06150007
051320               MAILBOX_REC_DTE, MAILBOX_REC_TME                   06160007
051330          FROM TPURCHS A,                                         06170005
051340               TTRDPRT B,                                         06180005
051350               TFGTRST C,                                         06190005
051360               TINTTRN D                                          06200005
051370         WHERE A.PO_NBR = :PV-PO-NMBR                             06210005
051380           AND A.VER_STATUS_CDE = 'A'                             06220005
051390           AND A.ENT_ID = B.ENT_ID                                06230005
051391           AND B.TP_DKEY = C.TP_DKEY                              06240005
051392           AND C.TRN_SET_CDE = '856'                              06250005
051393           AND C.TRN_DTL_TXT = :PV-ASNHDR-NBR                     06260005
051394           AND C.TP_DKEY = D.TP_DKEY                              06270005
051395           AND C.TP_DKEY_TMST = D.TP_DKEY_TMST                    06280005
051396           AND D.DIR_IND = 'R'                                    06290005
051400           AND D.PROD_TEST_IND = 'P'                              06300005
051401      ORDER BY MAILBOX_PU_DTE, MAILBOX_PU_TME                     06310005
051402     END-EXEC.                                                    06320005
051403                                                                  06330005
051410 LINKAGE SECTION.                                                 06340005
051500                                                                  06350005
051600 01  DFHCOMMAREA.                                                 06360005
051700     05  FILLER                         OCCURS  1 TO 4072 TIMES   06370005
051800                                        DEPENDING ON EIBCALEN.    06380005
051900         10  FILLER                     PIC X.                    06390005
052000                                                                  06400005
052100 EJECT                                                            06410005
052200 PROCEDURE DIVISION.                                              06420005
052300                                                                  06430005
052400 0000-MAIN-MODULE.                                                06440005
052500                                                                  06450005
052600     INITIALIZE DP030-CICS-API-FIELDS.                            06460005
052700     MOVE +1                      TO DP030-NUMBER-OF-MAPS.        06470005
052800     MOVE PC-CURRENT-MAPSET-NAME  TO DP030-MAPSET-NAME.           06480005
052900     MOVE PC-CURRENT-MAP-NAME     TO DP030-MAP-NAME (1).          06490005
053000     SET DP030-RECEIVE-APPL-MAP   TO TRUE.                        06500005
053100     MOVE LENGTH OF PO068AI       TO DP030-MAP-LENGTH (1).        06510005
053200     MOVE 'PROGRAM ENTRY CALL'    TO DP013-MESSAGE-TEXT (1).      06520005
053300     PERFORM 9000-CALL-CICS-ARCH-API.                             06530005
053400                                                                  06540005
053500     PERFORM 1000-CONTROL-PROCESSING.                             06550005
053600                                                                  06560005
053700     MOVE 'PROGRAM EXIT CALL'     TO DP013-MESSAGE-TEXT (1).      06570005
053800     PERFORM 9000-CALL-CICS-ARCH-API.                             06580005
053900                                                                  06590005
054000*----------------------------------------------------------------*06600005
054100*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *06610005
054200*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *06620005
054300*----------------------------------------------------------------*06630005
054400                                                                  06640005
054500 1000-CONTROL-PROCESSING.                                         06650005
054600                                                                  06660005
054700     EVALUATE TRUE                                                06670005
054800         WHEN DP020-NEXT-ACT-INITIAL                              06680005
054900             INITIALIZE ASC-SPECIFIC-COMMAREA                     06690005
055000             MOVE SPACE             TO ASC-START-ITEM-REQUEST     06700005
055100             MOVE EIBTRMID          TO ASC-DTL-TERM-ID            06710005
055200             MOVE DP020-SRC-TASK-NUMBER                           06720005
055300                                    TO ASC-DTL-TASK-NUMBER        06730005
055400             MOVE PC-DTL-QUEUE-SEQ  TO ASC-DTL-SEQ                06740005
055500             PERFORM 2050-DELETE-DETAIL-QUEUE                     06750005
055600             PERFORM 4000-BUILD-INITIAL-PANEL                     06760005
055700                                                                  06770005
055800         WHEN DP020-NEXT-ACT-READ-MAP                             06780005
055900             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        06790005
056000                               TO PV-TOP-ITEM                     06800005
056100             PERFORM 2000-PROCESS-PANEL                           06810005
056200                                                                  06820005
056300         WHEN DP020-NEXT-ACT-RETURN                               06830005
056400             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        06840005
056500                               TO PV-TOP-ITEM                     06850005
056600             MOVE ZERO         TO ASC-ITEM-AT-TOP-OF-PANEL        06860005
056700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06870005
056800                                                                  06880005
056900         WHEN OTHER                                               06890005
057000             SET DP013-LOGIC-ABEND TO TRUE                        06900005
057100             SET DP013-NO-ROLLBACK TO TRUE                        06910005
057200             MOVE '1000-CONTROL-PROCESSING'                       06920005
057300                               TO  DP013-PARAGRAPH                06930005
057400             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    06940005
057500                               TO  DP013-MESSAGE-TEXT(1)          06950005
057600             PERFORM DP013-0000-PROCESS-ABEND                     06960005
057700     END-EVALUATE.                                                06970005
057800                                                                  06980005
057900 EJECT                                                            06990005
058000*----------------------------------------------------------------*07000005
058100*    RECEIVE THE MAP AND PERFORM THE APPROPRIATE PARAGRAPH BASED *07010005
058200*    ON WHAT FUNCTION KEY WAS SELECTED.                          *07020005
058300*----------------------------------------------------------------*07030005
058400                                                                  07040005
058500 2000-PROCESS-PANEL.                                              07050005
058600                                                                  07060005
058700     EVALUATE TRUE                                                07070005
058800         WHEN DP020-SRC-AID = DP016-CLEAR                         07080005
058900             MOVE ZERO TO ASC-ITEM-AT-TOP-OF-PANEL                07090005
059000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07100005
059100             PERFORM 3200-RESET-ATTRIBUTES                        07110005
059200                                                                  07120005
059300         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    07130005
059400             PERFORM 2050-DELETE-DETAIL-QUEUE                     07140005
059500             PERFORM 4000-BUILD-INITIAL-PANEL                     07150005
059600             PERFORM 3200-RESET-ATTRIBUTES                        07160005
059700                                                                  07170005
059800         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  07180005
059900             MOVE +1 TO PV-TOP-ITEM                               07190005
060000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07200005
060100             PERFORM 3200-RESET-ATTRIBUTES                        07210005
060200                                                                  07220005
060300         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   07230005
060400             PERFORM 2110-BROWSE-BACKWARD                         07240005
060500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07250005
060600             PERFORM 3200-RESET-ATTRIBUTES                        07260005
060700                                                                  07270005
060800         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   07280005
060900             PERFORM 2120-BROWSE-FORWARD                          07290005
061000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07300005
061100             PERFORM 3200-RESET-ATTRIBUTES                        07310005
061200                                                                  07320005
061300         WHEN DP020-SRC-AID = DP016-ENTER                         07330005
061400             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   07340005
061500             IF  PS-ERROR                                         07350005
061600                 CONTINUE                                         07360005
061700             ELSE                                                 07370005
061800                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             07380005
061900                 PERFORM 3200-RESET-ATTRIBUTES                    07390005
062000             END-IF                                               07400005
062100                                                                  07410005
062200         WHEN OTHER                                               07420005
062300             SET DP013-NO-ROLLBACK TO TRUE                        07430005
062400             SET DP013-XCTL-DISPLAY-RESTART TO TRUE               07440005
062500             SET DP013-CICS-ABEND TO TRUE                         07450005
062600             MOVE '2100-CHECK-FUNCTION-KEY' TO DP013-PARAGRAPH    07460005
062700             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      07470005
062800                                   TO DP013-MESSAGE-TEXT (1)      07480005
062900             PERFORM DP013-0000-PROCESS-ABEND                     07490005
063000                                                                  07500005
063100     END-EVALUATE.                                                07510005
063200 EJECT                                                            07520005
063300*----------------------------------------------------------------*07530005
063400*    DELETE THE TEMPORARY STORAGE QUEUE.                         *07540005
063500*----------------------------------------------------------------*07550005
063600                                                                  07560005
063700 2050-DELETE-DETAIL-QUEUE.                                        07570005
063800                                                                  07580005
063900     EXEC CICS                                                    07590005
064000         DELETEQ TS                                               07600005
064100             QUEUE (ASC-DTL-QUEUE-NAME)                           07610005
064200             RESP  (PV-CICS-RESP)                                 07620005
064300     END-EXEC.                                                    07630005
064400                                                                  07640005
064500     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       07650005
064600        (PV-CICS-RESP = DFHRESP(QIDERR))                          07660005
064700         CONTINUE                                                 07670005
064800     ELSE                                                         07680005
064900         SET DP013-CICS-ABEND TO TRUE                             07690005
065000         SET DP013-NO-ROLLBACK TO TRUE                            07700005
065100                                                                  07710005
065200         MOVE '2050-DELETE-DETAIL-QUEUE' TO DP013-PARAGRAPH       07720005
065300         MOVE 'ERROR TRYING TO DELETE DETAIL TEMP STORAGE QUEUE'  07730005
065400                        TO DP013-MESSAGE-TEXT (1)                 07740005
065500         PERFORM DP013-0000-PROCESS-ABEND                         07750005
065600     END-IF.                                                      07760005
065700                                                                  07770005
065800     MOVE +0 TO ASC-HIGHEST-BLOCK-WRITTEN.                        07780005
065900 EJECT                                                            07790005
066000*----------------------------------------------------------------*07800005
066100*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *07810005
066200*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *07820005
066300*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *07830005
066400*    MESSAGE.                                                    *07840005
066500*----------------------------------------------------------------*07850005
066600                                                                  07860005
066700 2110-BROWSE-BACKWARD.                                            07870005
066800                                                                  07880005
066900     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    07890005
067000         GIVING PV-TOP-ITEM.                                      07900005
067100                                                                  07910005
067200     IF  PV-TOP-ITEM < +1                                         07920005
067300         MOVE +1              TO PV-TOP-ITEM                      07930005
067400*        -- TOP OF LIST --                                        07940005
067500         MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER                 07950005
067600         SET DP020-MSG-INFORMATIONAL TO TRUE                      07960005
067700     END-IF.                                                      07970005
067800                                                                  07980005
067900 EJECT                                                            07990005
068000                                                                  08000005
068100*----------------------------------------------------------------*08010005
068200*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *08020005
068300*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *08030005
068400*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *08040005
068500*----------------------------------------------------------------*08050005
068600                                                                  08060005
068700 2120-BROWSE-FORWARD.                                             08070005
068800                                                                  08080005
068900     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              08090005
069000         GIVING PV-TOP-ITEM.                                      08100005
069100     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   08110005
069200         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            08120005
069300                                   TO PV-TOP-ITEM                 08130005
069400*        -- BOTTOM OF LIST --                                     08140005
069500         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            08150005
069600         SET DP020-MSG-INFORMATIONAL                              08160005
069700                                   TO TRUE                        08170005
069800     ELSE                                                         08180005
069900         COMPUTE PV-BOTTOM-ITEM =                                 08190005
070000             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 08200005
070100         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            08210005
070200*            -- BOTTOM OF LIST --                                 08220005
070300             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            08230005
070400             SET DP020-MSG-INFORMATIONAL                          08240005
070500                                   TO TRUE                        08250005
070600         END-IF                                                   08260005
070700     END-IF.                                                      08270005
070800 EJECT                                                            08280005
070900*----------------------------------------------------------------*08290005
071000*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *08300005
071100*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *08310005
071200*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *08320005
071300*    RATHER THAN HITTING PF8 TO PAGE FORWARD TO THAT POINT.      *08330005
071400*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *08340005
071500*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *08350005
071600*----------------------------------------------------------------*08360005
071700                                                                  08370005
071800 2130-CHECK-FOR-JUMP-BROWSE.                                      08380005
071900                                                                  08390005
072000     IF ASTRTITL > ZERO                                           08400005
072100         MOVE ASTRTITI             TO ASC-START-ITEM-REQUEST      08410005
072200     ELSE                                                         08420005
072300         IF ASTRTITF = DP015-ERASE-EOF                            08430005
072400             INITIALIZE ASC-START-ITEM-REQUEST                    08440005
072500         END-IF                                                   08450005
072600     END-IF.                                                      08460005
072700                                                                  08470005
072800     SET PS-NO-ERROR               TO TRUE.                       08480005
072900     IF (ASC-START-ITEM-REQUEST = SPACE)                          08490005
073000         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            08500005
073100                                   TO PV-TOP-ITEM                 08510005
073200     ELSE                                                         08520005
073300         MOVE ASC-START-ITEM-REQUEST                              08530005
073400                                   TO DP010I-UNEDITED-FIELD       08540005
073500         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       08550005
073600         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     08560005
073700         SET DP010I-NEGATIVE-NOT-ALLOWED                          08570005
073800                                   TO TRUE                        08580005
264220         CALL DP010I-NUMERIC-EDIT-ROUTINE                         08591026
264230                         USING DP010I-NUMERIC-EDIT-AREA           08592026
074000                                                                  08600005
074100         IF  NOT DP010I-ERROR-DETECTED                            08610005
074200             MOVE DP010I-NUMERIC-FIELD                            08620005
074300                                   TO  ASC-START-ITEM-REQUEST-N   08630005
074400             IF  ASC-START-ITEM-REQUEST-N > ZERO                  08640005
074500                 IF  ASC-START-ITEM-REQUEST-N >                   08650005
074600                                          ASC-NUMBER-OF-ITEMS-READ08660005
074700                     MOVE SPACE TO ASC-START-ITEM-REQUEST         08670005
074800                     COMPUTE PV-TOP-ITEM =                        08680005
074900                             ASC-NUMBER-OF-ITEMS-READ             08690005
075000                             - PC-ITEMS-PER-PANEL + 1             08700005
075100                     IF  PV-TOP-ITEM < +1                         08710005
075200                         MOVE +1   TO PV-TOP-ITEM                 08720005
075300                         MOVE PC-TSYMSG-00070                     08730005
075400                                   TO DP020-MSG-NUMBER            08740005
075500                         SET DP020-MSG-INFORMATIONAL              08750005
075600                                   TO TRUE                        08760005
075700                     END-IF                                       08770005
075800                 ELSE                                             08780005
075900                     MOVE ASC-START-ITEM-REQUEST-N                08790005
076000                                   TO PV-TOP-ITEM                 08800005
076100                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      08810005
076200                     COMPUTE PV-BOTTOM-ITEM =                     08820005
076300                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     08830005
076400                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ08840005
076500*                        -- BOTTOM OF LIST --                     08850005
076600                         MOVE PC-TSYMSG-00070                     08860005
076700                                   TO DP020-MSG-NUMBER            08870005
076800                         SET DP020-MSG-INFORMATIONAL              08880005
076900                                   TO TRUE                        08890005
077000                     END-IF                                       08900005
077100                 END-IF                                           08910005
077200             ELSE                                                 08920005
077300*                --- VALUE OUT OF RANGE ----                      08930005
077400                 MOVE PC-TSYMSG-00101                             08940005
077500                                   TO DP020-MSG-NUMBER            08950005
077600                 MOVE -1           TO ASTRTITL                    08960005
077700                 SET DP030-SET-CURSOR-APPL-1                      08970005
077800                                   TO TRUE                        08980005
077900                 MOVE DP015-REVERSE                               08990005
078000                                   TO ASTRTITH                    09000005
078100                 MOVE DP015-RED    TO ASTRTITC                    09010005
078200                 MOVE DP015-UNP-NUM-BRT-MDT                       09020005
078300                                   TO ASTRTITA                    09030005
078400                 SET DP020-MSG-FATAL                              09040005
078500                                   TO TRUE                        09050005
078600                 SET PS-ERROR      TO TRUE                        09060005
078700             END-IF                                               09070005
078800                                                                  09080005
078900         ELSE                                                     09090005
079000             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            09100005
079100             MOVE -1               TO ASTRTITL                    09110005
079200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  09120005
079300             MOVE DP015-REVERSE    TO ASTRTITH                    09130005
079400             MOVE DP015-RED        TO ASTRTITC                    09140005
079500             MOVE DP015-UNP-NUM-BRT-MDT                           09150005
079600                                   TO ASTRTITA                    09160005
079700             SET DP020-MSG-FATAL   TO TRUE                        09170005
079800             SET PS-ERROR          TO TRUE                        09180005
079900         END-IF                                                   09190005
080000     END-IF.                                                      09200005
080100 EJECT                                                            09210005
080200                                                                  09220005
080300*----------------------------------------------------------------*09230005
080400*    RESET ATTRIBUTES.                                           *09240005
080500*----------------------------------------------------------------*09250005
080600                                                                  09260005
080700 3200-RESET-ATTRIBUTES.                                           09270005
080800                                                                  09280005
080900     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   09290005
081000     MOVE DP015-GREEN              TO ASTRTITC.                   09300005
081100     MOVE DP015-UNDERLINE          TO ASTRTITH.                   09310005
081200     MOVE -1                       TO ASTRTITL.                   09320005
081300     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       09330005
081400                                                                  09340005
081500 EJECT                                                            09350005
081600                                                                  09360005
081700*----------------------------------------------------------------*09370005
081800*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *09380005
081900*    INITIALIZE ALL COUNTERS AND FLAGS.                          *09390005
082000*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *09400005
082100*    DISPLAY THE PANEL TO USER.                                  *09410005
082200*----------------------------------------------------------------*09420005
082300                                                                  09430005
082400 4000-BUILD-INITIAL-PANEL.                                        09440005
082500                                                                  09450005
082600     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            09460005
082700                                 ASC-BLOCK-ENTRIES (2).           09470005
082800     MOVE +1                 TO  ASC-BLK-SUB.                     09480005
082900     SET ASC-ITEMS-LEFT-ON-DB                                     09490005
083000                             TO  TRUE.                            09500005
083100                                                                  09510005
083200     MOVE +0                 TO  ASC-ITEM-SUB                     09520005
083300                                 ASC-NUMBER-OF-ITEMS-READ         09530005
083400                                 ASC-NUMBER-OF-SELECTED-ITEMS     09540005
083500                                 ASC-HIGHEST-BLOCK-WRITTEN        09550005
083600                                 ASC-START-OF-SELECTED-RANGE      09560005
083700                                 ASC-END-OF-SELECTED-RANGE        09570005
083800                                 ASC-ITEM-AT-TOP-OF-PANEL.        09580005
083900                                                                  09590005
084000     MOVE SPACE                  TO  ASC-DESC-LINE-IND            09600005
084100                                     ASC-CORR-LINE-IND.           09610005
084200                                                                  09620005
084300     MOVE ZEROES          TO PV-PO-NBR.                           09630005
084400     MOVE SPACES          TO PV-ASN-PO-NBR-6                      09640005
084500                             PV-ASN-PO-NBR-7                      09650018
C98147                             PV-ASN-PO-NBR-8.                     09660018
084600     MOVE PO017-PO-NBR TO PV-PO-NBR.                              09670005
084700                                                                  09680005
C98147*  CREATE ALL POSSIBLE FORMATS OF PO NBR FOR READING ASN TABLES.  09690020
C98147*  PO NBR IS 22 CHARACTERS LEFT-JUSTIFIED IN TABLES.              09700020
C98147                                                                  09710020
C98147*    -- CHECK FOR 7-DIGIT OR 6-DIGIT PO                           09720020
C98147     IF PV-PO-NBR(3:1) = 0                                        09730018
084800        IF PV-PO-NBR(4:1) = 0                                     09740018
084900                                                                  09750005
C98147*          -- CREATE 6-DIGIT PO FORMATS AS A 22 CHAR FIELD:       09760020
C98147*             123456                                              09770020
C98147*             0123456                                             09780020
C98147*             00123456                                            09790020
085100           MOVE PV-PO-NBR(5:6) TO PV-ASN-PO-NBR-6                 09800018
085000           MOVE PV-PO-NBR(4:7) TO PV-ASN-PO-NBR-7                 09810018
C98147           MOVE PV-PO-NBR(3:8) TO PV-ASN-PO-NBR-8                 09820018
C98147        ELSE                                                      09830018
C98147*          -- CREATE 7-DIGIT PO FORMATS AS A 22 CHAR FIELD:       09840020
C98147*             1234567                                             09850020
C98147*             01234567                                            09860020
C98147           MOVE PV-PO-NBR(4:7) TO PV-ASN-PO-NBR-6                 09870018
C98147           MOVE PV-PO-NBR(3:8) TO PV-ASN-PO-NBR-7                 09880018
C98147                                  PV-ASN-PO-NBR-8                 09890021
C98147        END-IF                                                    09900018
                                                                        09910018
085300     ELSE                                                         09920005
C98147*       -- CREATE 8-DIGIT PO FORMAT AS A 22 CHAR FIELD:           09930021
C98147*          12345678                                               09940021
C98147        MOVE PV-PO-NBR(3:8) TO PV-ASN-PO-NBR-6                    09950018
C98147                               PV-ASN-PO-NBR-7                    09960021
C98147                               PV-ASN-PO-NBR-8                    09970021
085700     END-IF.                                                      09980005
085800                                                                  09990005
085900     INITIALIZE PV-PACK-BY-STORE-TABLE.                           10000005
C98147     MOVE PV-PO-NBR              TO  ASC-KEY-PO-NUMBER.           10010018
086100     MOVE PO017-PO-NBR           TO  PV-HOLD-PO-NUMBER-COMP.      10020005
086200                                                                  10030005
086300     PERFORM 4100-SELECT-NETWORK-NAME.                            10040005
086400     PERFORM 4150-CHECK-PACK-BY-STORE.                            10050005
086500                                                                  10060005
086600     PERFORM 4200-OPEN-ASN-HEADER-CURSOR.                         10070005
086700     PERFORM 4210-READ-ITEMS-FROM-DB.                             10080005
086800     PERFORM 4230-CLOSE-ASN-HEADER-CURSOR.                        10090005
086900     IF PV-PACK-BY-STORE-COUNT > 0                                10100005
087000         PERFORM 4250-WRITE-TABLE-TO-COMMAREA                     10110005
087100         PERFORM 4270-TEMP-STORAGE-CLEANUP                        10120005
087200     END-IF.                                                      10130005
087300                                                                  10140005
087400     MOVE +1                 TO  PV-TOP-ITEM.                     10150005
087500     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          10160005
087600         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    10170005
087700         SET DP020-MSG-FATAL   TO  TRUE                           10180005
087800         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               10190005
087900     ELSE                                                         10200005
088000         MOVE -1             TO ASTRTITL                          10210005
088100         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      10220005
088200         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     10230005
088300     END-IF.                                                      10240005
088400 EJECT                                                            10250005
088500                                                                  10260005
088600*----------------------------------------------------------------*10270005
088700*    SELECT TNETWRK TABLE TO RETRIEVE THE NETWORK NAME & ID      *10280005
088800*----------------------------------------------------------------*10290005
088900 4100-SELECT-NETWORK-NAME.                                        10300005
089000                                                                  10310005
089100     EXEC SQL                                                     10320005
089200         SELECT C.NETWK_ID, C.NETWK_NME                           10330014
089300           INTO :NETWRK-NETWK-ID,                                 10340005
089400                :NETWRK-NETWK-NME                                 10350005
089500           FROM TPURCHS A,                                        10360005
089600                TTRDPRT B,                                        10370005
089700                TNETWRK C,                                        10380005
089800                TTRDTRN D                                         10390005
089900           WHERE A.PO_NBR           = :PV-HOLD-PO-NUMBER-COMP     10400005
090000             AND A.VER_STATUS_CDE   = 'A'                         10410005
090100             AND A.ENT_ID           = B.ENT_ID                    10420005
090200             AND CURRENT DATE BETWEEN B.ACTV_DTE                  10430005
090300                                  AND B.INACTV_DTE                10440005
090400             AND B.NETWK_ID         = C.NETWK_ID                  10450005
090401             AND B.TP_DKEY = D.TP_DKEY                            10460005
090402             AND D.TRAN_SET_CDE = '856'                           10470005
090403             AND D.PROD_TEST_IND = 'P'                            10480005
090404             AND D.INACTV_DTE =: PC-NO-DATE                       10490005
090405     END-EXEC.                                                    10500005
090406                                                                  10510005
090407     EVALUATE TRUE                                                10520005
090408         WHEN SQLCODE = +0                                        10530005
               WHEN SQLCODE = -811                                      10540016
090409             MOVE NETWRK-NETWK-NME TO ASC-NETWK-NAME              10550005
090410         WHEN SQLCODE = +100                                      10560005
090420             MOVE SPACES           TO ASC-NETWK-NAME              10570005
090430         WHEN SQLCODE = -904                                      10580005
090440         WHEN SQLCODE = -911                                      10590005
090450         WHEN SQLCODE = -913                                      10600005
090460              MOVE PC-TSYMSG-00984      TO DP020-MSG-NUMBER       10610005
090470              SET PS-ERROR                                        10620005
090480                  DP020-NEXT-ACT-APPL-ERROR                       10630005
090490                  DP020-MSG-FATAL                                 10640005
090500                      TO TRUE                                     10650005
090600              MOVE 'PROGRAM EXIT CALL'  TO DP013-MESSAGE-TEXT (1) 10660005
090700              PERFORM 9000-CALL-CICS-ARCH-API                     10670005
090800                                                                  10680005
090900         WHEN SQLWARN0 NOT = SPACES                               10690005
091000         WHEN SQLCODE < +0                                        10700005
091100         WHEN SQLCODE > +0                                        10710005
091200              MOVE '4100-SELECT-NETWORK-NAME'                     10720005
091300                              TO DP013-PARAGRAPH                  10730005
091400              MOVE 'UNSUCCESSFUL SELECT ON TNETWRK'               10740005
091500                              TO DP013-MESSAGE-TEXT (1)           10750005
091600              MOVE SQLCA      TO DP013-SQLCA                      10760005
091700              MOVE 'TPURCHS ' TO DP013-DB2-TABLE-NAME (1)         10770005
091800              MOVE 'TTRDPRT ' TO DP013-DB2-TABLE-NAME (2)         10780005
091900              MOVE 'TNETWRK ' TO DP013-DB2-TABLE-NAME (3)         10790005
092000              SET DP013-DB2-ABEND                                 10800005
092100                  DP013-XCTL-DISPLAY-RESTART                      10810005
092200                              TO TRUE                             10820005
092300              PERFORM DP013-0000-PROCESS-ABEND                    10830005
092400     END-EVALUATE.                                                10840005
092500                                                                  10850005
092600 4150-CHECK-PACK-BY-STORE.                                        10860005
092700                                                                  10870005
092800     EXEC SQL                                                     10880005
092900         SELECT COUNT (*)                                         10890005
093000           INTO :PV-PACK-BY-STORE-COUNT                           10900005
093100           FROM TPOAGMT                                           10910005
093200           WHERE PO_NBR           = :PV-HOLD-PO-NUMBER-COMP       10920005
093300             AND VER_STATUS_CDE   = 'A'                           10930005
093400             AND AGRMT_TYP_ID     = '4'                           10940005
093500             AND TYP_CDE          = 4                             10950005
093600     END-EXEC.                                                    10960005
093700                                                                  10970005
093800     EVALUATE TRUE                                                10980005
093900         WHEN SQLCODE = +0                                        10990005
094000             CONTINUE                                             11000005
094100         WHEN SQLCODE = +100                                      11010005
094200             MOVE ZEROES                TO PV-PACK-BY-STORE-COUNT 11020005
094300         WHEN SQLCODE = -904                                      11030005
094400         WHEN SQLCODE = -911                                      11040005
094500         WHEN SQLCODE = -913                                      11050005
094600              MOVE PC-TSYMSG-00984      TO DP020-MSG-NUMBER       11060005
094700              SET PS-ERROR                                        11070005
094800                  DP020-NEXT-ACT-APPL-ERROR                       11080005
094900                  DP020-MSG-FATAL                                 11090005
095000                      TO TRUE                                     11100005
095100              MOVE 'PROGRAM EXIT CALL'  TO DP013-MESSAGE-TEXT (1) 11110005
095200              PERFORM 9000-CALL-CICS-ARCH-API                     11120005
095300                                                                  11130005
095400         WHEN SQLWARN0 NOT = SPACES                               11140005
095500         WHEN SQLCODE < +0                                        11150005
095600         WHEN SQLCODE > +0                                        11160005
095700              MOVE '4150-CHECK-PACK-BY-STROE'                     11170005
095800                              TO DP013-PARAGRAPH                  11180005
095900              MOVE 'UNSUCCESSFUL SELECT ON TPOAGMT'               11190005
096000                              TO DP013-MESSAGE-TEXT (1)           11200005
096100              MOVE SQLCA      TO DP013-SQLCA                      11210005
096200              MOVE 'TPOAGMT ' TO DP013-DB2-TABLE-NAME (1)         11220005
096300              SET DP013-DB2-ABEND                                 11230005
096400                  DP013-XCTL-DISPLAY-RESTART                      11240005
096500                              TO TRUE                             11250005
096600              PERFORM DP013-0000-PROCESS-ABEND                    11260005
096700     END-EVALUATE.                                                11270005
096800                                                                  11280005
096900*----------------------------------------------------------------*11290005
097000*    OPEN THE ASN HEADER CURSOR                                   11300005
097100*----------------------------------------------------------------*11310005
097200 4200-OPEN-ASN-HEADER-CURSOR.                                     11320005
097300                                                                  11330005
097400     EXEC SQL                                                     11340005
097500          OPEN ASN_HEADER_CURSOR                                  11350005
097600     END-EXEC                                                     11360005
097700                                                                  11370005
097800     EVALUATE TRUE                                                11380005
097900         WHEN SQLCODE = ZERO                                      11390005
098000                 CONTINUE                                         11400005
098100                                                                  11410005
098200         WHEN SQLCODE = -904                                      11420005
098300         WHEN SQLCODE = -911                                      11430005
098400         WHEN SQLCODE = -913                                      11440005
098500              MOVE PC-TSYMSG-00984      TO DP020-MSG-NUMBER       11450005
098600              SET PS-ERROR                                        11460005
098700                  DP020-NEXT-ACT-APPL-ERROR                       11470005
098800                  DP020-MSG-FATAL                                 11480005
098900                      TO TRUE                                     11490005
099000              MOVE 'PROGRAM EXIT CALL'  TO DP013-MESSAGE-TEXT (1) 11500005
099100              PERFORM 9000-CALL-CICS-ARCH-API                     11510005
099200                                                                  11520005
099300         WHEN SQLWARN0 NOT = SPACES                               11530005
099400         WHEN SQLCODE < ZERO                                      11540005
099500         WHEN SQLCODE > ZERO                                      11550005
099600             MOVE '4200-OPEN-ASN-HEADER-CURSOR'                   11560005
099700                               TO DP013-PARAGRAPH                 11570005
099800             MOVE 'OPEN ASN HEADER CURSOR - '                     11580005
099900                               TO DP013-MESSAGE-TEXT (1)          11590005
100000             MOVE SQLCA        TO DP013-SQLCA                     11600005
100100             MOVE 'TASNHDR '   TO DP013-DB2-TABLE-NAME (1)        11610005
100200             MOVE 'TASNORD '   TO DP013-DB2-TABLE-NAME (2)        11620005
100300             SET DP013-DB2-ABEND                                  11630005
100400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               11640005
100500             PERFORM DP013-0000-PROCESS-ABEND                     11650005
100600     END-EVALUATE.                                                11660005
100700                                                                  11670005
100800*----------------------------------------------------------------*11680005
100900*    THIS PARAGRAPH FETCHES ALL ROWS FROM THE ASN HEADER CURSOR   11690005
101000*    AND WRITES THEM OUT TO THE SCREEN.                           11700005
101100*----------------------------------------------------------------*11710005
101200                                                                  11720005
101300 4210-READ-ITEMS-FROM-DB.                                         11730005
101400                                                                  11740005
101500     PERFORM                                                      11750005
101600         VARYING PV-READ-COUNT                                    11760005
101700         FROM 1 BY 1                                              11770005
101800         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    11780005
101900            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         11790005
102000                                                                  11800005
102100         PERFORM 4220-FETCH-ASN-HEADER-CURSOR                     11810005
102200         MOVE +0 TO PV-TALLY                                      11820005
102300         INSPECT ASNHDR-ASNHDR-NBR                                11830005
102400          TALLYING PV-TALLY                                       11840005
102500            FOR LEADING ZEROES                                    11850005
102600         MOVE ASNHDR-ASNHDR-NBR(1 + PV-TALLY:30 - PV-TALLY) TO    11860005
102700           PV-ASNHDR-NBR                                          11870005
102800                                                                  11880005
102900         IF  ASC-ITEMS-LEFT-ON-DB                                 11890005
103000             PERFORM 4300-SUM-CARTONS                             11900005
103100             MOVE PV-CARTON-COUNT TO PV-CARTONS                   11910005
103200             MOVE ASNHDR-CRE-DTE TO PV-DATE-10                    11920005
103310             MOVE ASNHDR-CRE-TM   TO PV-HOLD-CRE-TIME             11930005
103400             MOVE PV-HOLD-CRE-HOUR TO PV-HOUR-N                   11940005
103500             MOVE PV-HOLD-CRE-MINUTE TO PV-MINUTE-N               11950005
103600             SET PS-STORE-CRE-DATE TO TRUE                        11960005
103700             PERFORM 4320-DATE-TIME-CONVERSION                    11970005
103800             SET PS-DONT-STORE-CRE-DATE TO TRUE                   11980005
103900                                                                  11990005
104000             PERFORM 4350-VALIDATE-LOC-NBR                        12000010
104100             PERFORM 4360-SUM-SHIPT-QTY                           12010005
104200             MOVE ASNDTL-SHIPT-QTY TO PV-UNITS                    12020005
104300                                                                  12030005
104400             MOVE PO017-PO-NBR TO PV-PO-NMBR                      12040005
104500             IF PV-PACK-BY-STORE-COUNT > 0                        12050005
104600                 PERFORM 4370-TABLIZE-LIKE-BOL                    12060005
104700             ELSE                                                 12070005
104800                 PERFORM 4260-ALLOC-TEMP-STORAGE                  12080005
104900                 IF PV-DATE-8 = '  N/A   '                        12090005
105000                     CONTINUE                                     12100005
105100                 ELSE                                             12110005
105200                     MOVE '/' TO PV-SLASH-1                       12120005
105300                                 PV-SLASH-2                       12130005
105310                 END-IF                                           12140005
105340                 PERFORM 4390-GET-PU-DATE                         12150005
105350                 IF PS-PICKUP-DATE-FOUND                          12160005
105360                     IF INTTRN-MAILBOX-PU-DTE = PC-NO-DATE        12170005
105370                         MOVE '  N/A   ' TO                       12180005
105380                            ASC-PU-DATE (ASC-BLK-SUB ASC-ITEM-SUB)12190005
105390                         MOVE ' N/A ' TO                          12200005
105400                            ASC-PU-TIME (ASC-BLK-SUB ASC-ITEM-SUB)12210005
105500                     ELSE                                         12220005
105501                         MOVE INTTRN-MAILBOX-PU-DTE TO PV-DATE-10 12230005
105502                         MOVE INTTRN-MAILBOX-PU-TME TO PV-TIME    12240005
105503                                                                  12250005
105504                         PERFORM 4320-DATE-TIME-CONVERSION        12260005
                                                                        12270006
                               MOVE PV-DATE-8 TO PV-DATE-8-PU           12280006
                               MOVE PV-TIME   TO PV-TIME-PU             12290006
105505                                                                  12300005
105506                         MOVE PV-DATE-8-PU TO                     12310006
105507                            ASC-PU-DATE (ASC-BLK-SUB ASC-ITEM-SUB)12320005
105508                         MOVE PV-TIME-PU TO                       12330006
105509                            ASC-PU-TIME (ASC-BLK-SUB ASC-ITEM-SUB)12340005
105510                     END-IF                                       12350005
105520                 ELSE                                             12360005
105521                     MOVE '  N/A   '                              12370005
105522                       TO ASC-PU-DATE (ASC-BLK-SUB ASC-ITEM-SUB)  12380005
105523                     MOVE ' N/A '                                 12390005
105524                       TO ASC-PU-TIME (ASC-BLK-SUB ASC-ITEM-SUB)  12400005
105525                 END-IF                                           12410005
105350                 IF PS-PICKUP-DATE-FOUND                          12420005
105360                     IF INTTRN-MAILBOX-REC-DTE = PC-NO-DATE       12430005
105370                         MOVE '  N/A   ' TO                       12440005
105380                            ASC-RC-DATE (ASC-BLK-SUB ASC-ITEM-SUB)12450005
105390                         MOVE ' N/A ' TO                          12460005
105400                            ASC-RC-TIME (ASC-BLK-SUB ASC-ITEM-SUB)12470005
105500                     ELSE                                         12480005
105501                         MOVE INTTRN-MAILBOX-REC-DTE TO PV-DATE-1012490005
105502                         MOVE INTTRN-MAILBOX-REC-TME TO PV-TIME   12500005
105503                                                                  12510005
105504                         PERFORM 4320-DATE-TIME-CONVERSION        12520005
105505                                                                  12530005
                               MOVE PV-DATE-8 TO PV-DATE-8-RC           12540006
                               MOVE PV-TIME   TO PV-TIME-RC             12550006
                                                                        12560006
105506                         MOVE PV-DATE-8-RC TO                     12570006
105507                            ASC-RC-DATE (ASC-BLK-SUB ASC-ITEM-SUB)12580005
105508                         MOVE PV-TIME-RC TO                       12590006
105509                            ASC-RC-TIME (ASC-BLK-SUB ASC-ITEM-SUB)12600005
105510                     END-IF                                       12610005
105520                 ELSE                                             12620005
105521                     MOVE '  N/A   '                              12630005
105522                       TO ASC-RC-DATE (ASC-BLK-SUB ASC-ITEM-SUB)  12640005
105523                     MOVE ' N/A '                                 12650005
105524                       TO ASC-RC-TIME (ASC-BLK-SUB ASC-ITEM-SUB)  12660005
105525                 END-IF                                           12670005
105526                 MOVE ASNHDR-BOL-NBR(1:27)                        12680005
105527                   TO ASC-BOL-NUMBER  (ASC-BLK-SUB ASC-ITEM-SUB)  12690005
105528                 MOVE ASNHDR-ASNHDR-NBR                           12700005
105529                   TO ASC-ASN-NUMBER  (ASC-BLK-SUB ASC-ITEM-SUB)  12710005
105530                 MOVE ASNHDR-PRO-NBR                              12720005
105540                   TO ASC-PRO-NUMBER  (ASC-BLK-SUB ASC-ITEM-SUB)  12730005
105550                 MOVE PV-UNITS                                    12740005
105560                   TO ASC-UNITS       (ASC-BLK-SUB ASC-ITEM-SUB)  12750005
105570                 MOVE PV-CARTONS                                  12760005
105580                   TO ASC-CARTONS     (ASC-BLK-SUB ASC-ITEM-SUB)  12770005
105590                 MOVE PV-FACILITY                                 12780005
105600                   TO ASC-FACILITY    (ASC-BLK-SUB ASC-ITEM-SUB)  12790005
105700             END-IF                                               12800005
105800         END-IF                                                   12810005
105900     END-PERFORM.                                                 12820005
106000                                                                  12830005
106100     IF PV-PACK-BY-STORE-COUNT > 0                                12840005
106200         CONTINUE                                                 12850005
106300     ELSE                                                         12860005
106400         PERFORM 4270-TEMP-STORAGE-CLEANUP                        12870005
106500     END-IF.                                                      12880005
106600 EJECT                                                            12890005
106700                                                                  12900005
106800*----------------------------------------------------------------*12910005
106900*    FETCH ASN HEADER CURSOR.                                     12920005
107000*----------------------------------------------------------------*12930005
107100 4220-FETCH-ASN-HEADER-CURSOR.                                    12940005
107200                                                                  12950005
107300     EXEC SQL                                                     12960005
107400         FETCH ASN_HEADER_CURSOR                                  12970005
107500          INTO :ASNHDR-ASNHDR-NBR,                                12980005
107600               :ASNHDR-ASNHDR-ID,                                 12990005
107700               :ASNHDR-CRE-DTE,                                   13000005
107800               :ASNHDR-BOL-NBR,                                   13010005
107900               :ASNHDR-PRO-NBR:PV-PRO-NUMBER-NULL,                13020005
108000               :ASNHDR-CRE-TM                                     13030005
108010****           :ASNHDR-CRE-TIME                                   13040005
108100     END-EXEC.                                                    13050005
108200                                                                  13060005
108300     EVALUATE TRUE                                                13070005
108400         WHEN SQLCODE = ZERO                                      13080005
108500              IF PV-PRO-NUMBER-NULL < ZERO                        13090005
108600                  MOVE SPACES TO ASNHDR-PRO-NBR                   13100005
108700              END-IF                                              13110005
108800         WHEN SQLCODE = +100                                      13120005
108900              SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                 13130005
109000         WHEN SQLCODE = -904                                      13140005
109100         WHEN SQLCODE = -911                                      13150005
109200         WHEN SQLCODE = -913                                      13160005
109300              MOVE PC-TSYMSG-00984      TO DP020-MSG-NUMBER       13170005
109400              SET PS-ERROR                                        13180005
109500                  DP020-NEXT-ACT-APPL-ERROR                       13190005
109600                  DP020-MSG-FATAL                                 13200005
109700                      TO TRUE                                     13210005
109800              MOVE 'PROGRAM EXIT CALL'  TO DP013-MESSAGE-TEXT (1) 13220005
109900              PERFORM 9000-CALL-CICS-ARCH-API                     13230005
110000                                                                  13240005
110100         WHEN SQLWARN0 NOT = SPACE                                13250005
110200         WHEN SQLCODE NOT = ZERO                                  13260005
110300              MOVE '4220-FETCH-ASN-HEADER-CURSOR'                 13270005
110400                                   TO DP013-PARAGRAPH             13280005
110500              MOVE 'FETCH ASN HEADER CURSOR'                      13290005
110600                                   TO DP013-MESSAGE-TEXT (1)      13300005
110700              MOVE SQLCA           TO DP013-SQLCA                 13310005
110800              SET DP013-DB2-ABEND                                 13320005
110900                                   TO TRUE                        13330005
111000              PERFORM DP013-0000-PROCESS-ABEND                    13340005
111100     END-EVALUATE.                                                13350005
111200                                                                  13360005
111300*----------------------------------------------------------------*13370005
111400*    CLOSE ASN HEADER CURSOR.                                     13380005
111500*----------------------------------------------------------------*13390005
111600 4230-CLOSE-ASN-HEADER-CURSOR.                                    13400005
111700                                                                  13410005
111800     EXEC SQL                                                     13420005
111900         CLOSE ASN_HEADER_CURSOR                                  13430005
112000     END-EXEC.                                                    13440005
112100                                                                  13450005
112200     EVALUATE TRUE                                                13460005
112300         WHEN SQLCODE = ZERO                                      13470005
112400             CONTINUE                                             13480005
112500         WHEN SQLCODE = -904                                      13490005
112600         WHEN SQLCODE = -911                                      13500005
112700         WHEN SQLCODE = -913                                      13510005
112800              MOVE PC-TSYMSG-00984      TO DP020-MSG-NUMBER       13520005
112900              SET PS-ERROR                                        13530005
113000                  DP020-NEXT-ACT-APPL-ERROR                       13540005
113100                  DP020-MSG-FATAL                                 13550005
113200                      TO TRUE                                     13560005
113300              MOVE 'PROGRAM EXIT CALL'  TO DP013-MESSAGE-TEXT (1) 13570005
113400              PERFORM 9000-CALL-CICS-ARCH-API                     13580005
113500                                                                  13590005
113600         WHEN SQLWARN0 NOT = SPACES                               13600005
113700         WHEN SQLCODE < ZERO                                      13610005
113800         WHEN SQLCODE > ZERO                                      13620005
113900             MOVE '4230-CLOSE-ASN-HEADER-CURSOR'                  13630005
114000                                   TO DP013-PARAGRAPH             13640005
114100             MOVE 'CLOSE ASN HEADER CURSOR '                      13650005
114200                                   TO DP013-MESSAGE-TEXT (1)      13660005
114300             MOVE SQLCA            TO DP013-SQLCA                 13670005
114400             MOVE 'TASNHDR '   TO DP013-DB2-TABLE-NAME (1)        13680005
114500             MOVE 'TASNORD '   TO DP013-DB2-TABLE-NAME (2)        13690005
114600             SET DP013-DB2-ABEND                                  13700005
114700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               13710005
114800             PERFORM DP013-0000-PROCESS-ABEND                     13720005
114900     END-EVALUATE.                                                13730005
115000                                                                  13740005
115100*-----------------------------------------------------------------13750005
115200*  WRITE TABLE VALUES TO ASC COMMAREA                             13760005
115300*-----------------------------------------------------------------13770005
115400                                                                  13780005
115500 4250-WRITE-TABLE-TO-COMMAREA.                                    13790005
115600                                                                  13800005
115700     PERFORM VARYING PV-TABLE-COUNTER                             13810005
115800        FROM 1 BY 1                                               13820005
115900        UNTIL PS-END-OF-TABLE                                     13830005
116000                                                                  13840005
116100        IF PV-PBS-BOL (PV-TABLE-COUNTER) = SPACES AND             13850005
116200           PV-PBS-UNITS (PV-TABLE-COUNTER) = ZEROES               13860005
116300            SET PS-END-OF-TABLE TO TRUE                           13870005
116400        ELSE                                                      13880005
116500            PERFORM 4260-ALLOC-TEMP-STORAGE                       13890005
116600            MOVE PV-PBS-CRE-DATE (PV-TABLE-COUNTER) TO PV-DATE-10 13900005
116700            PERFORM 4330-REFORMAT-DATE                            13910005
117000            MOVE PV-PBS-RC-DATE (PV-TABLE-COUNTER)                13920006
117100                   TO ASC-RC-DATE     (ASC-BLK-SUB ASC-ITEM-SUB)  13930006
117200            MOVE PV-PBS-RC-TIME (PV-TABLE-COUNTER)                13940006
117300                   TO ASC-RC-TIME     (ASC-BLK-SUB ASC-ITEM-SUB)  13950006
117000            MOVE PV-PBS-PU-DATE (PV-TABLE-COUNTER)                13960006
117100                   TO ASC-PU-DATE     (ASC-BLK-SUB ASC-ITEM-SUB)  13970006
117200            MOVE PV-PBS-PU-TIME (PV-TABLE-COUNTER)                13980006
117300                   TO ASC-PU-TIME     (ASC-BLK-SUB ASC-ITEM-SUB)  13990006
117400            MOVE PV-PBS-BOL (PV-TABLE-COUNTER)                    14000005
117500                   TO ASC-BOL-NUMBER  (ASC-BLK-SUB ASC-ITEM-SUB)  14010005
117600            MOVE PV-PBS-PRO (PV-TABLE-COUNTER)                    14020005
117700                   TO ASC-PRO-NUMBER  (ASC-BLK-SUB ASC-ITEM-SUB)  14030005
117800            MOVE PV-PBS-ASN (PV-TABLE-COUNTER)                    14040005
117900                   TO ASC-ASN-NUMBER  (ASC-BLK-SUB ASC-ITEM-SUB)  14050005
118000            MOVE PV-PBS-FACILITY (PV-TABLE-COUNTER)               14060005
118100                   TO ASC-FACILITY    (ASC-BLK-SUB ASC-ITEM-SUB)  14070005
118200            MOVE PV-PBS-UNITS (PV-TABLE-COUNTER)                  14080005
118300                   TO ASC-UNITS       (ASC-BLK-SUB ASC-ITEM-SUB)  14090005
118400            MOVE PV-PBS-CARTONS (PV-TABLE-COUNTER)                14100005
118500                   TO ASC-CARTONS     (ASC-BLK-SUB ASC-ITEM-SUB)  14110005
118600        END-IF                                                    14120005
118700     END-PERFORM.                                                 14130005
118800                                                                  14140005
118900*-----------------------------------------------------------------14150005
119000*  RESERVES TEMP STORAGE SPACE FOR A RECORD                       14160005
119100*-----------------------------------------------------------------14170005
119200                                                                  14180005
119300 4260-ALLOC-TEMP-STORAGE.                                         14190005
119400                                                                  14200005
119500     IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                        14210005
119600         ADD +1            TO ASC-ITEM-SUB                        14220005
119700     ELSE                                                         14230005
119800         ADD +1            TO ASC-BLK-SUB                         14240005
119900         MOVE +1           TO ASC-ITEM-SUB                        14250005
120000                                                                  14260005
120100         IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY                 14270005
120200             MOVE +1       TO ASC-BLK-SUB                         14280005
120300             PERFORM 5100-WRITE-TEMP-STORAGE                      14290005
120400             MOVE ASC-BLOCK-ENTRIES                               14300005
120500                       (PC-MAX-BLOCKS-IN-ARRAY)                   14310005
120600                    TO ASC-BLOCK-ENTRIES (ASC-BLK-SUB)            14320005
120700             ADD +1        TO ASC-BLK-SUB                         14330005
120800            INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)            14340005
120900         END-IF                                                   14350005
121000     END-IF.                                                      14360005
121100                                                                  14370005
121200     ADD +1                TO ASC-NUMBER-OF-ITEMS-READ.           14380005
121300                                                                  14390005
121400     MOVE ASC-NUMBER-OF-ITEMS-READ                                14400005
121500                           TO ASC-LIST-ITEM-NUMBER                14410005
121600                          (ASC-BLK-SUB ASC-ITEM-SUB).             14420005
121700                                                                  14430005
121800*-----------------------------------------------------------------14440005
121900*  AFTER WRITING RECORDS TO THE ASC COMMAREA, THIS PARAGRAPH      14450005
122000*  WRITES ANY ADDITIONAL RECORDS.                                 14460005
122100*-----------------------------------------------------------------14470005
122200                                                                  14480005
122300 4270-TEMP-STORAGE-CLEANUP.                                       14490005
122400                                                                  14500005
122500     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          14510005
122600         MOVE +1               TO ASC-BLK-SUB                     14520005
122700         PERFORM 5100-WRITE-TEMP-STORAGE                          14530005
122800         ADD +1                TO ASC-BLK-SUB                     14540005
122900         PERFORM 5100-WRITE-TEMP-STORAGE                          14550005
123000                                                                  14560005
123100         MOVE 1                TO ASC-BLK-SUB                     14570005
123200                                  PV-BLOCK-NUMBER                 14580005
123300         PERFORM 4410-READ-TEMP-STORAGE                           14590005
123400         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             14600005
123500             MOVE 2            TO ASC-BLK-SUB                     14610005
123600                                  PV-BLOCK-NUMBER                 14620005
123700             PERFORM 4410-READ-TEMP-STORAGE                       14630005
123800         END-IF                                                   14640005
123900     END-IF.                                                      14650005
124000                                                                  14660005
124100*-----------------------------------------------------------------14670005
124200*  GET CARTON COUNT INFORMATION FROM TASNORD TABLE( TD1 RECORD    14680005
124300*  ON PO LEVEL)                                                   14690005
124400*-----------------------------------------------------------------14700005
124500                                                                  14710005
124600 4300-SUM-CARTONS.                                                14720005
124700                                                                  14730005
124800     EXEC SQL                                                     14740005
124900         SELECT SUM (CART_SHIP_QTY)                               14750005
125000         INTO  :PV-CARTON-COUNT:PV-CARTON-CNT-NULL                14760005
125100         FROM  TASNORD                                            14770005
125200         WHERE ASNHDR_ID   = :ASNHDR-ASNHDR-ID                    14780005
C98147           AND PO_NBR IN                                          14790018
C98147             (:PV-ASN-PO-NBR-6,:PV-ASN-PO-NBR-7,:PV-ASN-PO-NBR-8) 14800019
125400     END-EXEC.                                                    14810005
125500                                                                  14820005
125600     EVALUATE TRUE                                                14830005
125700                                                                  14840005
125800       WHEN SQLCODE = ZERO                                        14850005
125900           IF PV-CARTON-COUNT = ZERO OR                           14860005
126000              PV-CARTON-CNT-NULL < ZEROES                         14870005
126100                  PERFORM 4310-COUNT-CARTONS-FOR-PO               14880005
126200           END-IF                                                 14890005
126300                                                                  14900005
126400       WHEN OTHER                                                 14910005
126500           SET DP013-LOGIC-ABEND TO TRUE                          14920005
126600           SET DP013-NO-ROLLBACK TO TRUE                          14930005
126700           MOVE '4300-SUM-CARTONS'                                14940005
126800                               TO  DP013-PARAGRAPH                14950005
126900           MOVE 'INVALID SELECT OF TASNORD'                       14960005
127000                               TO  DP013-MESSAGE-TEXT(1)          14970005
127100           PERFORM DP013-0000-PROCESS-ABEND                       14980005
127200     END-EVALUATE.                                                14990005
127300*                                                                 15000005
127400*EJECT                                                            15010005
127500                                                                  15020005
127600*----------------------------------------------------------------*15030005
127700*  RETREIVES COUNT OF CARTONS FOR SPECIFIED ORDER AND PO FROM     15040005
127800*  TASNCAR TABLE.                                                 15050005
127900*----------------------------------------------------------------*15060005
128000                                                                  15070005
128100 4310-COUNT-CARTONS-FOR-PO.                                       15080005
128200                                                                  15090005
128300     EXEC SQL                                                     15100005
128400         SELECT COUNT (*)                                         15110005
128500           INTO  :PV-CARTON-COUNT                                 15120005
128600           FROM  TASNCAR                                          15130005
128700           WHERE ASNHDR_ID        = :ASNHDR-ASNHDR-ID             15140005
C98147             AND PO_NBR IN                                        15150018
C98147             (:PV-ASN-PO-NBR-6,:PV-ASN-PO-NBR-7,:PV-ASN-PO-NBR-8) 15160019
128900     END-EXEC.                                                    15170005
129000                                                                  15180005
129100     EVALUATE TRUE                                                15190005
129200       WHEN SQLCODE = ZERO                                        15200005
129300           IF PV-CARTON-COUNT > ZERO                              15210005
129400               CONTINUE                                           15220005
129500           ELSE                                                   15230005
129600               MOVE ZEROES TO PV-CARTON-COUNT                     15240005
129700           END-IF                                                 15250005
129800                                                                  15260005
129900       WHEN OTHER                                                 15270005
130000           SET DP013-LOGIC-ABEND TO TRUE                          15280005
130100           SET DP013-NO-ROLLBACK TO TRUE                          15290005
130200           MOVE '4310-COUNT-CARTONS-FOR-PO'                       15300005
130300                               TO  DP013-PARAGRAPH                15310005
130400           MOVE 'INVALID SELECT OF TASNCAR'                       15320005
130500                               TO  DP013-MESSAGE-TEXT(1)          15330005
130600           PERFORM DP013-0000-PROCESS-ABEND                       15340005
130700     END-EVALUATE.                                                15350005
130800                                                                  15360005
130900*----------------------------------------------------------------*15370005
131000*  VERIFIES THE DATE AND TIME ARE NUMERIC. IF THEY ARE, THEY ARE  15380005
131100*  CONVERTED TO THE FORMAT THEY WILL APPEAR IN ON THE SCREEN. IF  15390005
131200*  THEY AREN'T, 'N/A' (NOT AVAILABLE) IS MOVED TO THE SCREEN.     15400005
131300*----------------------------------------------------------------*15410005
131400                                                                  15420005
131500 4320-DATE-TIME-CONVERSION.                                       15430005
131600                                                                  15440005
131700     IF PV-MONTH-10 = ZEROES OR PV-DAY-10 = ZEROES                15450005
131800         SET PS-DATE-INVALID TO TRUE                              15460005
131900     END-IF.                                                      15470005
132000                                                                  15480005
132100     IF PV-HOUR-N = ZEROES AND PV-MINUTE-N = ZEROES               15490005
132200         SET PS-TIME-INVALID TO TRUE                              15500005
132300     END-IF.                                                      15510005
132400                                                                  15520005
132500     IF PS-DATE-INVALID AND PS-TIME-INVALID                       15530005
132600         MOVE '  N/A   ' TO PV-DATE-8                             15540005
132700         MOVE ' N/A '    TO PV-TIME                               15550005
132800     ELSE                                                         15560005
132900         IF PS-DATE-INVALID                                       15570005
133000             MOVE '  N/A   ' TO PV-DATE-8                         15580005
133100             IF NETWRK-NETWK-ID = '2'                             15590005
133200                 IF PV-HOUR-N = ZEROES                            15600005
133300                     MOVE 23           TO PV-HOUR-N               15610005
133400                 ELSE                                             15620005
133500                     SUBTRACT 1 FROM PV-HOUR-N                    15630005
133600                 END-IF                                           15640005
133700             END-IF                                               15650005
133800             MOVE ':'                  TO PV-COLON                15660005
133900         ELSE                                                     15670005
134000             IF PS-TIME-INVALID                                   15680005
134100                 MOVE ' N/A '          TO PV-TIME                 15690005
134200                 MOVE PV-MONTH-10      TO PV-MONTH-8              15700005
134300                 MOVE PV-DAY-10        TO PV-DAY-8                15710005
134400                 MOVE PV-YEAR-10       TO PV-YEAR-8               15720005
134500             ELSE                                                 15730005
134600                 PERFORM 4325-TIME-ZONE-CONVERSION                15740005
134700             END-IF                                               15750005
134800             MOVE '/' TO PV-SLASH-1                               15760005
134900                         PV-SLASH-2                               15770005
135000         END-IF                                                   15780005
135100     END-IF.                                                      15790005
135200                                                                  15800005
135300     IF PS-STORE-CRE-DATE                                         15810005
135400         MOVE PV-DATE-10 TO PV-STORE-CRE-DATE                     15820005
135500         MOVE PV-TIME TO PV-STORE-CRE-TIME                        15830005
135600     END-IF.                                                      15840005
135700                                                                  15850005
135800     SET PS-DATE-VALID TO TRUE.                                   15860005
135900     SET PS-TIME-VALID TO TRUE.                                   15870005
136000                                                                  15880005
136100*----------------------------------------------------------------*15890005
136200*    SEARS (NETWK-ID = 2) USES THE EASTERN STANDARD TIME FOR      15900005
136300*    DATE & TIME FIELDS AND THEY NEED TO BE CONVERTED TO CENTRAL  15910005
136400*    STANDARD TIME. MOST OF THE TIME AN HOUR WILL BE SUBTRACTED   15920005
136500*    FROM THE TIME FIELD. BUT IF THE TIME IS BETWEEN 12-12:59 AM  15930005
136600*    (0-0:59 MILITARY TIME), 23 IS MOVED TO THE HOUR FIELD (TIMES 15940005
136700*    ARE DISPLAYED IN MILITARY TIME) AND THE DATE IS ROLLED BACK  15950005
136800*    ONE DAY. IF THE DAY HAPPENS TO BE THE FIRST DAY OF THE MONTH,15960005
136900*    THE CALENDAR ROUTINE IS USED TO ROLL BACK ONE DAY.           15970005
137000*----------------------------------------------------------------*15980005
137100                                                                  15990005
137200 4325-TIME-ZONE-CONVERSION.                                       16000005
137300                                                                  16010005
137400     IF NETWRK-NETWK-ID = '2'                                     16020005
137500         IF PV-HOUR-N = ZEROES                                    16030005
137600             MOVE 23 TO PV-HOUR-N                                 16040005
137700             IF PV-DAY-10 = 01                                    16050005
137800                 MOVE PV-DATE-10 TO PV-PRE-CONV-DATE              16060005
137900                 PERFORM 4340-DATE-CONVERSION-ROUTINE             16070005
138000             ELSE                                                 16080005
138100                 SUBTRACT 1 FROM PV-DAY-10                        16090005
138200             END-IF                                               16100005
138300         ELSE                                                     16110005
138400             SUBTRACT 1 FROM PV-HOUR-N                            16120005
138500         END-IF                                                   16130005
138600     END-IF.                                                      16140005
138700                                                                  16150005
138800     PERFORM 4330-REFORMAT-DATE.                                  16160005
138900     MOVE ':'       TO PV-COLON.                                  16170005
139000                                                                  16180005
139100*----------------------------------------------------------------*16190005
139200*    CONVERTS THE DATE FROM CCYY-MM-DD TO MM/DD/YY FORMAT.        16200005
139300*----------------------------------------------------------------*16210005
139400                                                                  16220005
139500 4330-REFORMAT-DATE.                                              16230005
139600                                                                  16240005
139700     MOVE PV-MONTH-10 TO PV-MONTH-8.                              16250005
139800     MOVE PV-DAY-10   TO PV-DAY-8.                                16260005
139900     MOVE PV-YEAR-10  TO PV-YEAR-8.                               16270005
140000     MOVE '/'         TO PV-SLASH-1                               16280005
140100                         PV-SLASH-2.                              16290005
140200                                                                  16300005
140300*----------------------------------------------------------------*16310005
140400*    THE CALENDAR ROUTINE IS USED TO ROLL THE DATE BACK ONE DAY.  16320005
140500*----------------------------------------------------------------*16330005
140600 4340-DATE-CONVERSION-ROUTINE.                                    16340005
140700                                                                  16350005
140800     SET DPG51-ACTUAL-CALENDAR-ONLY  TO TRUE.                     16360005
140900     SET DPG51-DECREMENT-DATE        TO TRUE.                     16370005
141000     SET DPG52-LK-DTE-ISO-FMT        TO TRUE.                     16380005
141100     MOVE 1                          TO DPG51-INCR-DECR-DAYS-9.   16390005
141200     MOVE PV-PRE-CONV-DATE           TO DPG52-LK-DATE-INPUT.      16400005
141300                                                                  16410005
141410     CALL DP500-KOHLS-CALENDAR-ROUTINE USING                      16420005
141500         DPG51 DPG52 DPG53 DPG54 DPG55 DPG56                      16430005
141600                                                                  16440005
141700     IF  (DPG54-NO-ERROR                                          16450005
141800      OR  DPG54-WARNING-ERROR)                                    16460005
141900      AND DPG54-DATE-VALID                                        16470005
142000          MOVE DPG55-DB2-ISO-DATE-FMT                             16480005
142100            TO PV-DATE-10.                                        16490005
142200                                                                  16500005
142300*----------------------------------------------------------------*16510005
142400*    VERIFIES SEQ NUMBER REPRESENTS A DC IN ORDER TO DISPLAY IT  *16520005
142500*    IN THE FACILITY FIELD. IF IT IS NOT A DC, THE TASHADR TABLE *16530005
142600*    IS CHECKED.                                                 *16540005
142700*----------------------------------------------------------------*16550005
142800                                                                  16560005
142900 4350-VALIDATE-LOC-NBR.                                           16570010
143000                                                                  16580005
143100     MOVE SPACES TO PV-FACILITY.                                  16590005
143200     PERFORM 4355-GET-LOC-NBR.                                    16600010
143300                                                                  16610005
143400     IF PS-VALID-LOC-NBR                                          16620010
143500         MOVE ASNORD-LOC-NBR TO PV-STORE-NBR                      16630010
143600         PERFORM 4359-VALIDATE-STORE-NBR                          16640005
143700         IF XMT00001-LOC-TYP-CDE = 'DC' AND SQLCODE = ZERO        16650008
143800             MOVE XMT00001-LOC-5-ABBR-NM TO PV-FACILITY           16660009
143900         ELSE                                                     16670005
144000             PERFORM 4356-ADDR-DTL-DC-NBR                         16680005
144100     ELSE                                                         16690005
144200         PERFORM 4356-ADDR-DTL-DC-NBR                             16700005
144300     END-IF.                                                      16710005
144400                                                                  16720005
144500*----------------------------------------------------------------*16730005
144600*    RETRIEVE SEQUENCE NUMBER WHICH REPRESENTS FACILITY ID       *16740005
144700*----------------------------------------------------------------*16750005
144800                                                                  16760005
144900 4355-GET-LOC-NBR.                                                16770010
145000                                                                  16780005
145100     EXEC SQL                                                     16790005
145200         SELECT DISTINCT LOC_NBR                                  16800010
145300           INTO :ASNORD-LOC-NBR                                   16810010
145400           FROM TASNORD                                           16820005
145500          WHERE ASNHDR_ID = :ASNHDR-ASNHDR-ID                     16830005
C98147            AND PO_NBR IN                                         16840018
C98147             (:PV-ASN-PO-NBR-6,:PV-ASN-PO-NBR-7,:PV-ASN-PO-NBR-8) 16850019
145700     END-EXEC.                                                    16860005
145800                                                                  16870005
145900     EVALUATE TRUE                                                16880005
146000         WHEN SQLCODE = +0                                        16890005
146100             SET PS-VALID-LOC-NBR TO TRUE                         16900010
146200         WHEN SQLCODE = +100                                      16910005
146300         WHEN SQLCODE = -811                                      16920005
146400             SET PS-INVALID-LOC-NBR TO TRUE                       16930010
146500         WHEN SQLCODE = -904                                      16940005
146600         WHEN SQLCODE = -911                                      16950005
146700         WHEN SQLCODE = -913                                      16960005
146800             MOVE PC-TSYMSG-00984   TO DP020-MSG-NUMBER           16970005
146900              SET PS-ERROR                                        16980005
147000                  DP020-NEXT-ACT-APPL-ERROR                       16990005
147100                  DP020-MSG-FATAL                                 17000005
147200                      TO TRUE                                     17010005
147300              MOVE 'PROGRAM EXIT CALL'                            17020005
147400                                    TO DP013-MESSAGE-TEXT (1)     17030005
147500              PERFORM 9000-CALL-CICS-ARCH-API                     17040005
147600         WHEN SQLWARN0 NOT = SPACES                               17050005
147700         WHEN SQLCODE < +0                                        17060005
147800         WHEN SQLCODE > +0                                        17070005
147900              MOVE '4355-GET-LOC-NBR'                             17080010
148000                              TO DP013-PARAGRAPH                  17090005
148100              MOVE 'UNSUCCESSFUL SELECT ON TASNORD'               17100005
148200                              TO DP013-MESSAGE-TEXT (1)           17110005
148300              MOVE SQLCA      TO DP013-SQLCA                      17120005
148400              MOVE 'TASNORD ' TO DP013-DB2-TABLE-NAME (1)         17130005
148500              SET DP013-DB2-ABEND                                 17140005
148600                  DP013-XCTL-DISPLAY-RESTART                      17150005
148700                              TO TRUE                             17160005
148800              PERFORM DP013-0000-PROCESS-ABEND                    17170005
148900     END-EVALUATE.                                                17180005
149000                                                                  17190005
149100*----------------------------------------------------------------*17200005
149200*    SELECT DC NUMBER IN THE EVENT A STORE NUMBER IS RETURNED    *17210005
149300*    FROM TASNORD TABLE.                                         *17220005
149400*----------------------------------------------------------------*17230005
149500                                                                  17240005
149600 4356-ADDR-DTL-DC-NBR.                                            17250005
149700                                                                  17260005
149800     EXEC SQL                                                     17270005
149900         SELECT NAME_ID_CDE                                       17280005
150000           INTO :ASHADR-NAME-ID-CDE:PV-NAME-ID-CDE-NULL           17290005
150100           FROM TASHADR                                           17300005
150200           WHERE ASNHDR_ID          = :ASNHDR-ASNHDR-ID           17310005
150300             AND NAME_CDE           = 'ST'                        17320005
150400     END-EXEC.                                                    17330005
150500                                                                  17340005
150600     EVALUATE TRUE                                                17350005
150700         WHEN SQLCODE = +0                                        17360005
150800             IF PV-NAME-ID-CDE-NULL < ZERO                        17370005
150900                 MOVE SPACES TO ASHADR-NAME-ID-CDE                17380005
151000             END-IF                                               17390005
151100             PERFORM 4357-INSPECT-STORE-NBR                       17400005
151200             IF PV-FACILITY = 'UNK'                               17410005
151300                 CONTINUE                                         17420005
151400             ELSE                                                 17430005
151500                 PERFORM 4359-VALIDATE-STORE-NBR                  17440005
151600                 MOVE XMT00001-LOC-5-ABBR-NM TO PV-FACILITY       17450009
151700             END-IF                                               17460005
151800         WHEN SQLCODE = +100                                      17470005
151900             MOVE 'UNK  '                 TO PV-FACILITY          17480005
152000         WHEN SQLCODE = -904                                      17490005
152100         WHEN SQLCODE = -911                                      17500005
152200         WHEN SQLCODE = -913                                      17510005
152300              MOVE PC-TSYMSG-00984      TO DP020-MSG-NUMBER       17520005
152400              SET PS-ERROR                                        17530005
152500                  DP020-NEXT-ACT-APPL-ERROR                       17540005
152600                  DP020-MSG-FATAL                                 17550005
152700                      TO TRUE                                     17560005
152800              MOVE 'PROGRAM EXIT CALL'  TO DP013-MESSAGE-TEXT (1) 17570005
152900              PERFORM 9000-CALL-CICS-ARCH-API                     17580005
153000                                                                  17590005
153100         WHEN SQLWARN0 NOT = SPACES                               17600005
153200         WHEN SQLCODE < +0                                        17610005
153300         WHEN SQLCODE > +0                                        17620005
153400              MOVE '4356-ADDR-DTL-DC-NBR'                         17630005
153500                              TO DP013-PARAGRAPH                  17640005
153600              MOVE 'UNSUCCESSFUL SELECT ON TASHADR'               17650005
153700                              TO DP013-MESSAGE-TEXT (1)           17660005
153800              MOVE SQLCA      TO DP013-SQLCA                      17670005
153900              MOVE 'TASHADR ' TO DP013-DB2-TABLE-NAME (1)         17680005
154000              SET DP013-DB2-ABEND                                 17690005
154100                  DP013-XCTL-DISPLAY-RESTART                      17700005
154200                              TO TRUE                             17710005
154300              PERFORM DP013-0000-PROCESS-ABEND                    17720005
154400     END-EVALUATE.                                                17730005
154500                                                                  17740005
154600*----------------------------------------------------------------*17750005
154700*    VERIFY THE STORE NUMBER FROM TASHADR IS IN A FORMAT WHICH   *17760005
154800*    WILL ALLOW IT TO BE COMPARED TO PV-STORE-NBR.               *17770005
154900*                                                                *17780005
155000*    VALID FORMATS                          INVALID FORMATS      *17790005
155100*    -------------                          ---------------      *17800005
155200*    85,085,0085,00085,_85, ETC             8500, 85 0, DC085    *17810005
155300*----------------------------------------------------------------*17820005
155400                                                                  17830005
155500 4357-INSPECT-STORE-NBR.                                          17840005
155600                                                                  17850005
155700     MOVE SPACES             TO PV-NAME-ID-CDE                    17860005
155800                                PV-NAME-ID-OUT-CDE.               17870005
155900     MOVE ZEROES             TO PV-ID-CTR                         17880005
156000                                PV-STR-NBR-CTR                    17890005
156100                                PV-OUT-CTR.                       17900005
156200     SET PS-NOT-END-OF-STORE      TO TRUE.                        17910005
156300     SET PS-NO-BUILD-STORE-NUMBER TO TRUE.                        17920005
156400                                                                  17930005
156500     MOVE ASHADR-NAME-ID-CDE TO PV-NAME-ID-CDE.                   17940005
156600                                                                  17950005
156700     INSPECT PV-NAME-ID-CDE                                       17960005
156800         REPLACING LEADING SPACES                                 17970005
156900             BY '0'.                                              17980005
157000                                                                  17990005
157100     PERFORM                                                      18000005
157200         VARYING PV-ID-CTR                                        18010005
157300         FROM 1 BY 1                                              18020005
157400         UNTIL PV-ID-CTR > 17 OR                                  18030005
157500               PS-END-OF-STORE                                    18040005
157600                                                                  18050005
157700         IF PV-NAME-ID-CHAR (PV-ID-CTR) < ZEROES AND              18060005
157800            PV-NAME-ID-CHAR (PV-ID-CTR) NOT = SPACES              18070005
157900             SET PS-END-OF-STORE TO TRUE                          18080005
158000         ELSE                                                     18090005
158100             IF PV-NAME-ID-CHAR (PV-ID-CTR) > 0 OR                18100005
158200                PS-BUILD-STORE-NUMBER                             18110005
158300                 SET PS-BUILD-STORE-NUMBER TO TRUE                18120005
158400                 ADD 1 TO PV-STR-NBR-CTR                          18130005
140977                 IF PV-STR-NBR-CTR > 4                            18140024
158600                     IF PV-NAME-ID-CHAR (PV-ID-CTR) = SPACES      18150005
158700                         CONTINUE                                 18160005
158800                     ELSE                                         18170005
158900                         SET PS-END-OF-STORE TO TRUE              18180005
159000                     END-IF                                       18190005
159100                 ELSE                                             18200005
159200                     ADD 1 TO PV-OUT-CTR                          18210005
159300                     MOVE PV-NAME-ID-CHAR (PV-ID-CTR) TO          18220005
159400                          PV-NAME-ID-OUT (PV-OUT-CTR)             18230005
159500                 END-IF                                           18240005
159600             END-IF                                               18250005
159700         END-IF                                                   18260005
159800     END-PERFORM.                                                 18270005
159900                                                                  18280005
160000     IF PS-END-OF-STORE OR PS-NO-BUILD-STORE-NUMBER               18290005
160100         MOVE 'UNK' TO PV-FACILITY                                18300005
160200     ELSE                                                         18310005
160300         MOVE PV-NAME-ID-OUT-CDE TO DP010I-UNEDITED-FIELD         18320005
160400         MOVE 4 TO DP010I-MAXIMUM-DIGITS                          18330011
160500         MOVE 0 TO DP010I-MAXIMUM-DECIMALS                        18340005
160600         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  18350005
264220         CALL DP010I-NUMERIC-EDIT-ROUTINE                         18361026
264230                         USING DP010I-NUMERIC-EDIT-AREA           18362026
160800         IF DP010I-ERROR-DETECTED                                 18370005
160900             MOVE 'UNK' TO PV-FACILITY                            18380005
161000         ELSE                                                     18390005
161100             MOVE DP010I-NUMERIC-FIELD TO PV-STORE-NBR-NUM        18400005
161200             MOVE PV-STORE-NBR-NUM     TO PV-STORE-NBR            18410005
161300         END-IF                                                   18420005
161400     END-IF.                                                      18430005
161500                                                                  18440005
161600*----------------------------------------------------------------*18450005
161700*    SELECT STORE NUMBER TO VERIFY IT EXISTS. IF SO, THE STORE   *18460005
161800*    NAME IS EXTRACTED.                                          *18470005
161900*----------------------------------------------------------------*18480005
162000                                                                  18490005
162100 4359-VALIDATE-STORE-NBR.                                         18500005
           MOVE PV-STORE-NBR TO PV-DB-STR-NBR                           18510013
162200                                                                  18520005
162300     EXEC SQL                                                     18530005
162400         SELECT LOC_5_ABBR_NM,                                    18540012
162500                LOC_TYP_CDE                                       18550012
162600           INTO :XMT00001-LOC-5-ABBR-NM,                          18560009
162700                :XMT00001-LOC-TYP-CDE                             18570008
162800           FROM XMT_LOC                                           18580008
162900           WHERE LOC_NBR           = :PV-DB-STR-NBR               18590013
163100     END-EXEC.                                                    18600005
163200                                                                  18610005
163300     EVALUATE TRUE                                                18620005
163400         WHEN SQLCODE = +0                                        18630005
163500         WHEN SQLCODE = +100                                      18640005
163600             CONTINUE                                             18650005
163700         WHEN SQLCODE = -904                                      18660005
163800         WHEN SQLCODE = -911                                      18670005
163900         WHEN SQLCODE = -913                                      18680005
164000              MOVE PC-TSYMSG-00984      TO DP020-MSG-NUMBER       18690005
164100              SET PS-ERROR                                        18700005
164200                  DP020-NEXT-ACT-APPL-ERROR                       18710005
164300                  DP020-MSG-FATAL                                 18720005
164400                      TO TRUE                                     18730005
164500              MOVE 'PROGRAM EXIT CALL'  TO DP013-MESSAGE-TEXT (1) 18740005
164600              PERFORM 9000-CALL-CICS-ARCH-API                     18750005
164700                                                                  18760005
164800         WHEN SQLWARN0 NOT = SPACES                               18770005
164900         WHEN SQLCODE < +0                                        18780005
165000         WHEN SQLCODE > +0                                        18790005
165100              MOVE '4359-VALIDATE-STORE-NUMBER'                   18800005
165200                              TO DP013-PARAGRAPH                  18810005
165300              MOVE 'UNSUCCESSFUL SELECT ON XMT_LOC'               18820008
165400                              TO DP013-MESSAGE-TEXT (1)           18830005
165500              MOVE SQLCA      TO DP013-SQLCA                      18840005
165600              MOVE 'XMT_LOC ' TO DP013-DB2-TABLE-NAME (1)         18850008
165700              SET DP013-DB2-ABEND                                 18860005
165800                  DP013-XCTL-DISPLAY-RESTART                      18870005
165900                              TO TRUE                             18880005
166000              PERFORM DP013-0000-PROCESS-ABEND                    18890005
166100     END-EVALUATE.                                                18900005
166200                                                                  18910005
166300*----------------------------------------------------------------*18920005
166400*    SELECT/SUM ON SHIPT-QTY TO RETRIEVE DESTINATION UNITS        18930005
166500*----------------------------------------------------------------*18940005
166600                                                                  18950005
166700 4360-SUM-SHIPT-QTY.                                              18960005
166800                                                                  18970005
166900     EXEC SQL                                                     18980005
167000         SELECT SUM (A.SHIPT_QTY)                                 18990005
167100           INTO :ASNDTL-SHIPT-QTY:PV-SHIPT-QTY-NULL               19000005
167200           FROM TASNDTL A,                                        19010005
167300                TASNHDR B                                         19020005
167400           WHERE B.ASNHDR_ID        = :ASNHDR-ASNHDR-ID           19030005
167500             AND A.ASNHDR_ID        = B.ASNHDR_ID                 19040005
C98147             AND PO_NBR IN                                        19050018
C98147             (:PV-ASN-PO-NBR-6,:PV-ASN-PO-NBR-7,:PV-ASN-PO-NBR-8) 19060019
167700     END-EXEC.                                                    19070005
167800                                                                  19080005
167900     EVALUATE TRUE                                                19090005
168000         WHEN SQLCODE = +0                                        19100005
168100             IF PV-SHIPT-QTY-NULL < ZEROES                        19110005
168200                 MOVE ZEROES            TO ASNDTL-SHIPT-QTY       19120005
168300             END-IF                                               19130005
168400         WHEN SQLCODE = +100                                      19140005
168500             MOVE ZEROES                TO ASNDTL-SHIPT-QTY       19150005
168600         WHEN SQLCODE = -904                                      19160005
168700         WHEN SQLCODE = -911                                      19170005
168800         WHEN SQLCODE = -913                                      19180005
168900              MOVE PC-TSYMSG-00984      TO DP020-MSG-NUMBER       19190005
169000              SET PS-ERROR                                        19200005
169100                  DP020-NEXT-ACT-APPL-ERROR                       19210005
169200                  DP020-MSG-FATAL                                 19220005
169300                      TO TRUE                                     19230005
169400              MOVE 'PROGRAM EXIT CALL'  TO DP013-MESSAGE-TEXT (1) 19240005
169500              PERFORM 9000-CALL-CICS-ARCH-API                     19250005
169600                                                                  19260005
169700         WHEN SQLWARN0 NOT = SPACES                               19270005
169800         WHEN SQLCODE < +0                                        19280005
169900         WHEN SQLCODE > +0                                        19290005
170000              MOVE '4360-SUM-SHIPT-QTY'                           19300005
170100                              TO DP013-PARAGRAPH                  19310005
170200              MOVE 'UNSUCCESSFUL SELECT ON TASNDTL'               19320005
170300                              TO DP013-MESSAGE-TEXT (1)           19330005
170400              MOVE SQLCA      TO DP013-SQLCA                      19340005
170500              MOVE 'TASNDTL ' TO DP013-DB2-TABLE-NAME (1)         19350005
170600              MOVE 'TASNHDR ' TO DP013-DB2-TABLE-NAME (2)         19360005
170700              SET DP013-DB2-ABEND                                 19370005
170800                  DP013-XCTL-DISPLAY-RESTART                      19380005
170900                              TO TRUE                             19390005
171000              PERFORM DP013-0000-PROCESS-ABEND                    19400005
171100     END-EVALUATE.                                                19410005
171200                                                                  19420005
171300*----------------------------------------------------------------*19430005
171400*    TABLIZE RECORDS WITH IDENTICAL BILLS OF LADING, CREATE DATE *19440005
171500*    AND CREATE TIME.                                            *19450005
171600*----------------------------------------------------------------*19460005
171700                                                                  19470005
171800 4370-TABLIZE-LIKE-BOL.                                           19480005
171900                                                                  19490005
172000     PERFORM 4390-GET-PU-DATE.                                    19500005
172100                                                                  19510005
172200     IF PS-PICKUP-DATE-FOUND                                      19520005
172300         IF INTTRN-MAILBOX-PU-DTE = PC-NO-DATE                    19530005
172400             MOVE '  N/A   ' TO PV-DATE-8-PU                      19540006
172500             MOVE ' N/A ' TO PV-TIME-PU                           19550006
172600         ELSE                                                     19560005
172700             MOVE INTTRN-MAILBOX-PU-DTE TO PV-DATE-10             19570005
172800             MOVE INTTRN-MAILBOX-PU-TME TO PV-TIME                19580005
172900                                                                  19590005
172910             PERFORM 4320-DATE-TIME-CONVERSION                    19600005
                   MOVE PV-DATE-8 TO PV-DATE-8-PU                       19610006
                   MOVE PV-TIME   TO PV-TIME-PU                         19620006
105505                                                                  19630006
172920         END-IF                                                   19640005
172930     ELSE                                                         19650005
172940         MOVE '  N/A   ' TO PV-DATE-8-PU                          19660006
172950         MOVE ' N/A ' TO PV-TIME-PU                               19670006
172960     END-IF.                                                      19680005
172200     IF PS-PICKUP-DATE-FOUND                                      19690005
172300         IF INTTRN-MAILBOX-REC-DTE = PC-NO-DATE                   19700005
172400             MOVE '  N/A   ' TO PV-DATE-8-RC                      19710006
172500             MOVE ' N/A ' TO PV-TIME-RC                           19720006
172600         ELSE                                                     19730005
172700             MOVE INTTRN-MAILBOX-REC-DTE TO PV-DATE-10            19740005
172800             MOVE INTTRN-MAILBOX-REC-TME TO PV-TIME               19750005
172900                                                                  19760005
172910             PERFORM 4320-DATE-TIME-CONVERSION                    19770005
                   MOVE PV-DATE-8 TO PV-DATE-8-RC                       19780006
                   MOVE PV-TIME   TO PV-TIME-RC                         19790006
105505                                                                  19800006
172920         END-IF                                                   19810005
172930     ELSE                                                         19820005
172940         MOVE '  N/A   ' TO PV-DATE-8-RC                          19830006
172950         MOVE ' N/A ' TO PV-TIME-RC                               19840006
172960     END-IF.                                                      19850005
172970                                                                  19860005
172980     PERFORM VARYING PV-TABLE-COUNTER                             19870005
172990        FROM 1 BY 1                                               19880005
173000        UNTIL PS-END-OF-TABLE                                     19890005
173100                                                                  19900005
173200        IF PV-PBS-BOL (PV-TABLE-COUNTER) = SPACES AND             19910005
173300           PV-PBS-UNITS (PV-TABLE-COUNTER) = ZEROES               19920005
173400            MOVE PV-STORE-CRE-DATE                                19930005
173500                           TO PV-PBS-CRE-DATE   (PV-TABLE-COUNTER)19940005
173600            MOVE PV-STORE-CRE-TIME                                19950005
173700                           TO PV-PBS-CRE-TIME   (PV-TABLE-COUNTER)19960005
173800            MOVE PV-DATE-8-RC                                     19970006
173801                           TO PV-PBS-RC-DATE    (PV-TABLE-COUNTER)19980006
173802            MOVE PV-TIME-RC                                       19990006
173803                           TO PV-PBS-RC-TIME    (PV-TABLE-COUNTER)20000006
173800            MOVE PV-DATE-8-PU                                     20010006
173801                           TO PV-PBS-PU-DATE    (PV-TABLE-COUNTER)20020005
173802            MOVE PV-TIME-PU                                       20030006
173803                           TO PV-PBS-PU-TIME    (PV-TABLE-COUNTER)20040005
173805            IF ASNHDR-BOL-NBR = SPACES                            20050005
173808                 MOVE  'UNKNOWN                    '              20060005
173809                           TO PV-PBS-BOL        (PV-TABLE-COUNTER)20070005
173820            ELSE                                                  20080005
173830                 MOVE ASNHDR-BOL-NBR(1:27)                        20090005
173840                           TO PV-PBS-BOL        (PV-TABLE-COUNTER)20100005
173850            END-IF                                                20110005
173860            MOVE ASNHDR-PRO-NBR                                   20120005
173870                           TO PV-PBS-PRO        (PV-TABLE-COUNTER)20130005
173880            MOVE ASNHDR-ASNHDR-NBR                                20140005
173890                           TO PV-PBS-ASN        (PV-TABLE-COUNTER)20150005
173900            MOVE PV-FACILITY                                      20160005
174000                           TO PV-PBS-FACILITY   (PV-TABLE-COUNTER)20170005
174100            MOVE PV-UNITS  TO PV-PBS-UNITS      (PV-TABLE-COUNTER)20180005
174200            MOVE PV-CARTONS                                       20190005
174300                           TO PV-PBS-CARTONS    (PV-TABLE-COUNTER)20200005
174400            SET PS-END-OF-TABLE TO TRUE                           20210005
174500        ELSE                                                      20220005
174600            IF PV-STORE-CRE-DATE =                                20230005
174700               PV-PBS-CRE-DATE (PV-TABLE-COUNTER)                 20240005
174800               AND                                                20250005
174900               PV-STORE-CRE-TIME =                                20260005
175000               PV-PBS-CRE-TIME (PV-TABLE-COUNTER)                 20270005
175100               AND                                                20280005
175200               ASNHDR-BOL-NBR(1:27) =                             20290005
175200                                PV-PBS-BOL (PV-TABLE-COUNTER)     20300005
175300                                                                  20310005
175400                ADD PV-UNITS TO PV-PBS-UNITS (PV-TABLE-COUNTER)   20320005
175500                ADD PV-CARTONS TO                                 20330005
175600                    PV-PBS-CARTONS (PV-TABLE-COUNTER)             20340005
175700                PERFORM 4375-MULTIPLE-ASN-CHECK                   20350005
175800                PERFORM 4380-MULTIPLE-FAC-CHECK                   20360005
175900                PERFORM 4385-MULTIPLE-PRO-CHECK                   20370005
176000                SET PS-END-OF-TABLE TO TRUE                       20380005
176100            ELSE                                                  20390005
176200                IF PV-TABLE-COUNTER = PC-MAX-TABLE                20400005
176300                    SET PS-END-OF-TABLE TO TRUE                   20410005
176400*                   --- TABLE EXCEEDED ----                       20420005
176500                    MOVE PC-TSYMSG-00994  TO DP020-MSG-NUMBER     20430005
176600                    SET DP020-MSG-INFORMATIONAL TO TRUE           20440005
176700                ELSE                                              20450005
176800                    CONTINUE                                      20460005
176900                END-IF                                            20470005
177000            END-IF                                                20480005
177100        END-IF                                                    20490005
177200     END-PERFORM.                                                 20500005
177300     SET PS-NOT-END-OF-TABLE TO TRUE.                             20510005
177400                                                                  20520005
177500*----------------------------------------------------------------*20530005
177600*  CHECKS ALL CONSOLIDATED RECORDS TO SEE IF MULTIPLE ASNS EXIST *20540005
177700*----------------------------------------------------------------*20550005
177800                                                                  20560005
177900 4375-MULTIPLE-ASN-CHECK.                                         20570005
178000                                                                  20580005
178100     IF PV-PBS-ASN (PV-TABLE-COUNTER) =                           20590005
178200                                  'MULTIPLE                      '20600005
178300         CONTINUE                                                 20610005
178400     ELSE                                                         20620005
178500         IF PV-PBS-ASN (PV-TABLE-COUNTER) = ASNHDR-ASNHDR-NBR     20630005
178600             CONTINUE                                             20640005
178700         ELSE                                                     20650005
178800             MOVE 'MULTIPLE                      '                20660005
178900               TO PV-PBS-ASN (PV-TABLE-COUNTER)                   20670005
179000         END-IF                                                   20680005
179100     END-IF.                                                      20690005
179200                                                                  20700005
179300*----------------------------------------------------------------*20710005
179400*  CHECKS ALL CONSOLIDATED RECORDS TO SEE IF MULTIPLE FACILITIES *20720005
179500*  EXIST.                                                        *20730005
179600*----------------------------------------------------------------*20740005
179700                                                                  20750005
179800 4380-MULTIPLE-FAC-CHECK.                                         20760005
179900                                                                  20770005
180000     IF PV-PBS-FACILITY (PV-TABLE-COUNTER) = 'UNK  '              20780005
180100         CONTINUE                                                 20790005
180200     ELSE                                                         20800005
180300         IF PV-PBS-FACILITY (PV-TABLE-COUNTER) = PV-FACILITY      20810005
180400             CONTINUE                                             20820005
180500         ELSE                                                     20830005
180600             MOVE 'UNK  '                                         20840005
180700               TO PV-PBS-FACILITY (PV-TABLE-COUNTER)              20850005
180800         END-IF                                                   20860005
180900     END-IF.                                                      20870005
181000                                                                  20880005
181100*----------------------------------------------------------------*20890005
181200*  CHECKS ALL CONSOLIDATED RECORDS TO SEE IF MULTIPLE PROS EXIST *20900005
181300*----------------------------------------------------------------*20910005
181400                                                                  20920005
181500 4385-MULTIPLE-PRO-CHECK.                                         20930005
181600                                                                  20940005
181700     IF PV-PBS-PRO (PV-TABLE-COUNTER) =                           20950005
181800                                  'MULTIPLE                      '20960005
181900         CONTINUE                                                 20970005
182000     ELSE                                                         20980005
182100         IF PV-PBS-PRO (PV-TABLE-COUNTER) = ASNHDR-PRO-NBR        20990005
182200             CONTINUE                                             21000005
182300         ELSE                                                     21010005
182400             MOVE 'MULTIPLE                      '                21020005
182500               TO PV-PBS-PRO (PV-TABLE-COUNTER)                   21030005
182600         END-IF                                                   21040005
182700     END-IF.                                                      21050005
182800                                                                  21060005
182900*----------------------------------------------------------------*21070005
182910* GET MAILBOX PICKUP DATE AND TIME                                21080005
182920* OFTEN TIMES ONLY ONE ROW WILL BE RETURNED. OCCASIONALLY MULTIPLE21090005
182921* ROWS WILL EXIST. WE ARE ONLY CONCERNED WITH THE FIRST ROW       21100005
182922* TRANSMITTED.                                                    21110005
182923*----------------------------------------------------------------*21120005
182924 4390-GET-PU-DATE.                                                21130005
182925                                                                  21140005
182926     PERFORM 4391-OPEN-MAILBOX-CURSOR.                            21150005
182927     PERFORM 4392-FETCH-MAILBOX-CURSOR.                           21160005
182928     PERFORM 4393-CLOSE-MAILBOX-CURSOR.                           21170005
182929                                                                  21180005
182930*----------------------------------------------------------------*21190005
182940*    OPEN THE MAILBOX CURSOR                                      21200005
182950*----------------------------------------------------------------*21210005
182960 4391-OPEN-MAILBOX-CURSOR.                                        21220005
182970                                                                  21230005
182980     EXEC SQL                                                     21240005
182990          OPEN MAILBOX_CURSOR                                     21250005
183000     END-EXEC                                                     21260005
183010                                                                  21270005
183020     EVALUATE TRUE                                                21280005
183030         WHEN SQLCODE = ZERO                                      21290005
183040                 CONTINUE                                         21300005
183050                                                                  21310005
183051         WHEN SQLCODE = -904                                      21320005
183052         WHEN SQLCODE = -911                                      21330005
183053         WHEN SQLCODE = -913                                      21340005
183054              MOVE PC-TSYMSG-00984      TO DP020-MSG-NUMBER       21350005
183055              SET PS-ERROR                                        21360005
183056                  DP020-NEXT-ACT-APPL-ERROR                       21370005
183057                  DP020-MSG-FATAL                                 21380005
183058                      TO TRUE                                     21390005
183059              MOVE 'PROGRAM EXIT CALL'  TO DP013-MESSAGE-TEXT (1) 21400005
183060              PERFORM 9000-CALL-CICS-ARCH-API                     21410005
183061                                                                  21420005
183062         WHEN SQLWARN0 NOT = SPACES                               21430005
183063         WHEN SQLCODE < ZERO                                      21440005
183064         WHEN SQLCODE > ZERO                                      21450005
183065             MOVE '4391-OPEN-MAILBOX-CURSOR'                      21460005
183066                               TO DP013-PARAGRAPH                 21470005
183067             MOVE 'OPEN MAILBOX CURSOR - '                        21480005
183068                               TO DP013-MESSAGE-TEXT (1)          21490005
183069             MOVE SQLCA        TO DP013-SQLCA                     21500005
183070             MOVE 'TPURCHS '   TO DP013-DB2-TABLE-NAME (1)        21510005
183071             MOVE 'TTRDPRT '   TO DP013-DB2-TABLE-NAME (2)        21520005
183072             MOVE 'TFGTRST '   TO DP013-DB2-TABLE-NAME (3)        21530005
183073             MOVE 'TINTTRN '   TO DP013-DB2-TABLE-NAME (4)        21540005
183074             SET DP013-DB2-ABEND                                  21550005
183075                 DP013-XCTL-DISPLAY-RESTART TO TRUE               21560005
183076             PERFORM DP013-0000-PROCESS-ABEND                     21570005
183077     END-EVALUATE.                                                21580005
183078                                                                  21590005
183079*----------------------------------------------------------------*21600005
183080*    FETCH MAILBOX CURSOR.                                        21610005
183090*----------------------------------------------------------------*21620005
183100 4392-FETCH-MAILBOX-CURSOR.                                       21630005
183110                                                                  21640005
183120     EXEC SQL                                                     21650005
183130         FETCH MAILBOX_CURSOR                                     21660005
183140          INTO :INTTRN-MAILBOX-PU-DTE,                            21670005
183150               :INTTRN-MAILBOX-PU-TME,                            21680005
183140               :INTTRN-MAILBOX-REC-DTE,                           21690005
183150               :INTTRN-MAILBOX-REC-TME                            21700005
183160     END-EXEC.                                                    21710005
183170                                                                  21720005
183180     EVALUATE TRUE                                                21730005
183190         WHEN SQLCODE = ZERO                                      21740005
183191              SET PS-PICKUP-DATE-FOUND TO TRUE                    21750005
183192         WHEN SQLCODE = +100                                      21760005
183193              SET PS-NO-PICKUP-DATE-FOUND TO TRUE                 21770005
183194         WHEN SQLCODE = -904                                      21780005
183195         WHEN SQLCODE = -911                                      21790005
183196         WHEN SQLCODE = -913                                      21800005
183197              MOVE PC-TSYMSG-00984      TO DP020-MSG-NUMBER       21810005
183198              SET PS-ERROR                                        21820005
183199                  DP020-NEXT-ACT-APPL-ERROR                       21830005
183200                  DP020-MSG-FATAL                                 21840005
183201                      TO TRUE                                     21850005
183202              MOVE 'PROGRAM EXIT CALL'  TO DP013-MESSAGE-TEXT (1) 21860005
183203              PERFORM 9000-CALL-CICS-ARCH-API                     21870005
183204                                                                  21880005
183205         WHEN SQLWARN0 NOT = SPACE                                21890005
183206         WHEN SQLCODE NOT = ZERO                                  21900005
183207              MOVE '4392-FETCH-MAILBOX-CURSOR'                    21910005
183208                                   TO DP013-PARAGRAPH             21920005
183209              MOVE 'FETCH MAILBOX CURSOR'                         21930005
183210                                   TO DP013-MESSAGE-TEXT (1)      21940005
183211              MOVE SQLCA           TO DP013-SQLCA                 21950005
183212              SET DP013-DB2-ABEND                                 21960005
183213                                   TO TRUE                        21970005
183214              PERFORM DP013-0000-PROCESS-ABEND                    21980005
183215     END-EVALUATE.                                                21990005
183216                                                                  22000005
183217*----------------------------------------------------------------*22010005
183218*    CLOSE MAILBOX CURSOR.                                        22020005
183219*----------------------------------------------------------------*22030005
183220 4393-CLOSE-MAILBOX-CURSOR.                                       22040005
183221                                                                  22050005
183222     EXEC SQL                                                     22060005
183223         CLOSE MAILBOX_CURSOR                                     22070005
183224     END-EXEC.                                                    22080005
183225                                                                  22090005
183226     EVALUATE TRUE                                                22100005
183227         WHEN SQLCODE = ZERO                                      22110005
183228             CONTINUE                                             22120005
183229         WHEN SQLCODE = -904                                      22130005
183230         WHEN SQLCODE = -911                                      22140005
183231         WHEN SQLCODE = -913                                      22150005
183232              MOVE PC-TSYMSG-00984      TO DP020-MSG-NUMBER       22160005
183233              SET PS-ERROR                                        22170005
183234                  DP020-NEXT-ACT-APPL-ERROR                       22180005
183235                  DP020-MSG-FATAL                                 22190005
183236                      TO TRUE                                     22200005
183237              MOVE 'PROGRAM EXIT CALL'  TO DP013-MESSAGE-TEXT (1) 22210005
183238              PERFORM 9000-CALL-CICS-ARCH-API                     22220005
183239                                                                  22230005
183240         WHEN SQLWARN0 NOT = SPACES                               22240005
183241         WHEN SQLCODE < ZERO                                      22250005
183242         WHEN SQLCODE > ZERO                                      22260005
183243             MOVE '4393-CLOSE-MAILBOX-CURSOR'                     22270005
183244                                   TO DP013-PARAGRAPH             22280005
183245             MOVE 'CLOSE MAILBOX CURSOR '                         22290005
183246                                   TO DP013-MESSAGE-TEXT (1)      22300005
183247             MOVE SQLCA            TO DP013-SQLCA                 22310005
183248             MOVE 'TPURCHS '   TO DP013-DB2-TABLE-NAME (1)        22320005
183249             MOVE 'TTRDPRT '   TO DP013-DB2-TABLE-NAME (2)        22330005
183250             MOVE 'TFGTRST '   TO DP013-DB2-TABLE-NAME (3)        22340005
183251             MOVE 'TINTTRN '   TO DP013-DB2-TABLE-NAME (4)        22350005
183252             SET DP013-DB2-ABEND                                  22360005
183253                 DP013-XCTL-DISPLAY-RESTART TO TRUE               22370005
183254             PERFORM DP013-0000-PROCESS-ABEND                     22380005
183255     END-EVALUATE.                                                22390005
183256                                                                  22400005
183257*----------------------------------------------------------------*22410005
183258*    FORMAT THE MAP AND DETERMINE THE CURSOR POSITION.           *22420005
183259*----------------------------------------------------------------*22430005
183260                                                                  22440005
183270 4400-MOVE-COMMAREA-TO-SCREEN.                                    22450005
183280                                                                  22460005
183290     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             22470005
183300         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          22480005
183400         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          22490005
183500             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             22500005
183600                 GIVING PV-BLOCK-NUMBER                           22510005
183700                 REMAINDER PV-REMAINDER                           22520005
183800             IF  PV-REMAINDER > ZERO                              22530005
183900                 ADD +1 TO PV-BLOCK-NUMBER                        22540005
184000             END-IF                                               22550005
184100             MOVE +1    TO ASC-BLK-SUB                            22560005
184200             PERFORM 4410-READ-TEMP-STORAGE                       22570005
184300             ADD +1     TO ASC-BLK-SUB                            22580005
184400                           PV-BLOCK-NUMBER                        22590005
184500             PERFORM 4410-READ-TEMP-STORAGE                       22600005
184600     END-IF.                                                      22610005
184700     MOVE +1                       TO ASC-BLK-SUB.                22620005
184800     COMPUTE ASC-ITEM-SUB =                                       22630005
184900         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              22640005
185000         + PC-ITEMS-PER-PANEL).                                   22650005
185100                                                                  22660005
185200     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        22670005
185300         ADD +1   TO ASC-BLK-SUB                                  22680005
185400         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            22690005
185500     END-IF.                                                      22700005
185600                                                                  22710005
185700     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           22720005
185800         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                22730005
185900     PERFORM 4415-FORMAT-HEADING-LIST-LINES.                      22740005
186000     PERFORM 4420-FORMAT-LIST-LINES                               22750005
186100         VARYING PS-SUB                                           22760005
186200         FROM PC-ITEMS-PER-PANEL BY -1                            22770005
186300         UNTIL PS-SUB < +1.                                       22780005
186400                                                                  22790005
186500     COMPUTE ASC-ITEMS-DISPLAYED =                                22800005
186600         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          22810005
186700     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    22820005
186800                                      ASTRTITO.                   22830005
186900     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    22840005
187000     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    22850005
187100                                                                  22860005
187200     IF  DP020-MSG-NUMBER-X = SPACE                               22870005
187300         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  22880005
187400*            --- MORE ITEMS TO DISPLAY ----                       22890005
187500             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            22900005
187600             SET DP020-MSG-INFORMATIONAL TO TRUE                  22910005
187700         END-IF                                                   22920005
187800     END-IF.                                                      22930005
187900                                                                  22940005
188000*----------------------------------------------------------------*22950005
188100*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *22960005
188200*----------------------------------------------------------------*22970005
188300                                                                  22980005
188400 4410-READ-TEMP-STORAGE.                                          22990005
188500                                                                  23000005
188600     EXEC CICS                                                    23010005
188700         READQ TS                                                 23020005
188800             QUEUE (ASC-DTL-QUEUE-NAME)                           23030005
188900             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               23040005
189000             ITEM  (PV-BLOCK-NUMBER)                              23050005
189100             RESP  (PV-CICS-RESP)                                 23060005
189200     END-EXEC.                                                    23070005
189300                                                                  23080005
189400     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       23090005
189500       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     23100005
189600         CONTINUE                                                 23110005
189700     ELSE                                                         23120005
189800         SET DP013-CICS-ABEND TO  TRUE                            23130005
189900         SET DP013-NO-ROLLBACK TO  TRUE                           23140005
190000         MOVE '4410-READ-TEMP-STORAGE'                            23150005
190100                               TO  DP013-PARAGRAPH                23160005
190200         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      23170005
190300                               TO  DP013-MESSAGE-TEXT(1)          23180005
190400         PERFORM DP013-0000-PROCESS-ABEND                         23190005
190500     END-IF.                                                      23200005
190600                                                                  23210005
190700     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         23220005
190800         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               23230005
190900     END-IF.                                                      23240005
191000 EJECT                                                            23250005
191100                                                                  23260005
191200*----------------------------------------------------------------*23270005
191300*    WRITES HEADING INFORMATION (NON-SCROLLABLE) TO THE SCREEN.  *23280005
191400*----------------------------------------------------------------*23290005
191500                                                                  23300005
191600 4415-FORMAT-HEADING-LIST-LINES.                                  23310005
191700                                                                  23320005
191800     MOVE ASC-KEY-PO-NUMBER     TO MR-PO-NBR.                     23330005
191900     MOVE PO017-ENT-NAME-DESC   TO MR-ENT-NAME-DESC.              23340005
192000     MOVE ASC-NETWK-NAME        TO MR-NTWK-NAME.                  23350005
192100                                                                  23360005
192200*----------------------------------------------------------------*23370005
192300*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *23380005
192400*----------------------------------------------------------------*23390005
192500                                                                  23400005
192600 4420-FORMAT-LIST-LINES.                                          23410005
192700                                                                  23420005
192800     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      23430005
192900         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                23440005
193000         MOVE SPACE              TO                               23450005
193100                                    MR-ASN-RC-DTE (PS-SUB)        23460005
193200                                    MR-ASN-RC-TME (PS-SUB)        23470005
193100                                    MR-ASN-PU-DTE (PS-SUB)        23480005
193200                                    MR-ASN-PU-TME (PS-SUB)        23490005
193300                                    MR-BOL      (PS-SUB)          23500005
193400                                    MR-UNITS    (PS-SUB)          23510005
193500                                    MR-CARTONS  (PS-SUB)          23520005
193600                                    MR-FACILITY (PS-SUB)          23530005
193700                                    MR-PRO-TEXT (PS-SUB)          23540005
193800                                    MR-PRO      (PS-SUB)          23550005
193900                                    MR-ASN-TEXT (PS-SUB)          23560005
194000                                    MR-ASN      (PS-SUB)          23570005
194100     ELSE                                                         23580005
194200         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           23590005
194500             MOVE ASC-RC-DATE    (ASC-BLK-SUB ASC-ITEM-SUB)       23600005
194600               TO MR-ASN-RC-DTE  (PS-SUB)                         23610005
194700             MOVE ASC-RC-TIME    (ASC-BLK-SUB ASC-ITEM-SUB)       23620005
194800               TO MR-ASN-RC-TME  (PS-SUB)                         23630005
194500             MOVE ASC-PU-DATE    (ASC-BLK-SUB ASC-ITEM-SUB)       23640005
194600               TO MR-ASN-PU-DTE  (PS-SUB)                         23650005
194700             MOVE ASC-PU-TIME    (ASC-BLK-SUB ASC-ITEM-SUB)       23660005
194800               TO MR-ASN-PU-TME  (PS-SUB)                         23670005
194900             MOVE ASC-BOL-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)       23680005
195000               TO MR-BOL         (PS-SUB)                         23690005
195100             MOVE ASC-UNITS      (ASC-BLK-SUB ASC-ITEM-SUB)       23700005
195200               TO MR-UNITS       (PS-SUB)                         23710005
195300             MOVE ASC-CARTONS    (ASC-BLK-SUB ASC-ITEM-SUB)       23720005
195400               TO MR-CARTONS     (PS-SUB)                         23730005
195500             MOVE ASC-FACILITY   (ASC-BLK-SUB ASC-ITEM-SUB)       23740005
195600               TO MR-FACILITY    (PS-SUB)                         23750005
195700             MOVE PC-PRO-TEXT                                     23760005
195800               TO MR-PRO-TEXT    (PS-SUB)                         23770005
195900             MOVE ASC-PRO-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)       23780005
196000               TO MR-PRO         (PS-SUB)                         23790005
196100             MOVE PC-ASN-TEXT                                     23800005
196200               TO MR-ASN-TEXT    (PS-SUB)                         23810005
196300             MOVE ASC-ASN-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)       23820005
196400               TO MR-ASN         (PS-SUB)                         23830005
196500         END-IF                                                   23840005
196600     END-IF.                                                      23850005
196700     SUBTRACT +1 FROM ASC-ITEM-SUB.                               23860005
196800     IF  ASC-ITEM-SUB < + 1                                       23870005
196900         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  23880005
197000         MOVE +1                 TO ASC-BLK-SUB                   23890005
197100     END-IF.                                                      23900005
197200                                                                  23910005
197300*----------------------------------------------------------------*23920005
197400*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *23930005
197500*----------------------------------------------------------------*23940005
197600                                                                  23950005
197700 5100-WRITE-TEMP-STORAGE.                                         23960005
197800                                                                  23970005
197900     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     23980005
198000                               TO  PV-LIST-ITEM-NUMBER.           23990005
198100     COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                           24000005
198200         ASC-HIGHEST-BLOCK-WRITTEN + 1.                           24010005
198300                                                                  24020005
198400     EXEC CICS                                                    24030005
198500         WRITEQ TS                                                24040005
198600             QUEUE (ASC-DTL-QUEUE-NAME)                           24050005
198700             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               24060005
198800             ITEM  (PV-HIGHEST-BLOCK-WRITTEN)                     24070005
198900             RESP  (PV-CICS-RESP)                                 24080005
199000     END-EXEC.                                                    24090005
199100                                                                  24100005
199200     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      24110005
199300         SET DP013-CICS-ABEND                                     24120005
199400                       TO  TRUE                                   24130005
199500         SET DP013-NO-ROLLBACK                                    24140005
199600                       TO  TRUE                                   24150005
199700         MOVE '5100-WRITE-TEMP-STORAGE'                           24160005
199800                       TO  DP013-PARAGRAPH                        24170005
199900         MOVE 'ATTEMPTING TO WRITE TEMP STORAGE LIST BLOCK'       24180005
200000                       TO  DP013-MESSAGE-TEXT(1)                  24190005
200100         PERFORM DP013-0000-PROCESS-ABEND                         24200005
200200     END-IF.                                                      24210005
200300     ADD +1            TO  ASC-HIGHEST-BLOCK-WRITTEN.             24220005
200400                                                                  24230005
200500 EJECT                                                            24240005
200600*----------------------------------------------------------------*24250005
200700*   THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE    *24260005
200800*   AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.          *24270005
200900*----------------------------------------------------------------*24280005
201000                                                                  24290005
201100 9000-CALL-CICS-ARCH-API.                                         24300005
201200                                                                  24310005
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      24320029
201400                                    DFHCOMMAREA                   24330029
201500                                    DP030-CICS-API-FIELDS         24340029
201600                                    DP020-STANDARD-COMMAREA       24350029
201700                                    PO068AI.                      24360029
201800                                                                  24370005
201900     IF  DP030-RC-CALL-SUCCESSFUL                                 24380005
202000         CONTINUE                                                 24390005
202100     ELSE                                                         24400005
202200         SET DP013-NO-ROLLBACK TO TRUE                            24410005
202300         SET DP013-XCTL-DISPLAY-RESTART TO TRUE                   24420005
202400         SET DP013-CICS-ABEND TO TRUE                             24430005
CICS           MOVE '9000-CALL-CICS-ARCH-API' TO DP013-PARAGRAPH        24440029
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O24450029
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      24460029
202800         MOVE DP030-RETURN-CODE                                   24470005
202900                               TO DP013-MESSAGE-TEXT (3)          24480005
203000         PERFORM DP013-0000-PROCESS-ABEND                         24490005
203100     END-IF.                                                      24500005
203200                                                                  24510005
203300*----------------------------------------------------------------*24520005
203400*    ABEND PROCESSOR MODULE                                      *24530005
203500*----------------------------------------------------------------*24540005
203600                                                                  24550005
203700     COPY DPPD013.                                                24560005
203800*----------------------------------------------------------------*24570005
