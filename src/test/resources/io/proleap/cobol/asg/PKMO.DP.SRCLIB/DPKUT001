00001  IDENTIFICATION DIVISION.                                         01/27/94
00002  PROGRAM-ID.    DPKUT001.                                         DPKUT001
00003  AUTHOR.        THOMAS J. RUSKA. G&R.                                LV003
00004  INSTALLATION.  KOHLS.                                            DPKUT001
00005  DATE-WRITTEN.  OCTOBER, 1993.                                    DPKUT001
00006  DATE-COMPILED.                                                   DPKUT001
00007 ******************************************************************DPKUT001
00008 *  THIS PROGRAM WILL GENERATE A RANDOM NUMBER.                    DPKUT001
00009 *  TWO PARAMETERS NEED TO BE PASSED TO THIS SUBROUTINE.           DPKUT001
00010 *  THE CURRENT DATE IN MMDDYY FORMAT AND THE TIME IN HHMMSSHS     DPKUT001
00011 *  FORMAT.                                                        DPKUT001
00012 *  THESE TWO ITEMS ARE USED AS A "SEED" TO GENERATE A RANDOM      DPKUT001
00013 *  NUMBER WHICH WILL BE RETURNED TO THE CALLING PROGRAM.          DPKUT001
00014 *  THIS SUBROUTINE SHOULD BE INVOKED AS A DYNAMIC CALL.           DPKUT001
00015 ******************************************************************DPKUT001
00016 *  SAMPLE OF THE CODE NEEDED IN A BATCH PROGRAM                      CL**3
00017 *                                                                    CL**3
00018 *    ACCEPT DP065-CURRENT-DATE FROM DATE.                            CL**3
00019 *    ACCEPT DP065-CURRENT-TIME FROM TIME.                            CL**3
00020 *                                                                    CL**3
00021 *    CALL PC-RANDNBR-PGM USING DP065-RANDNBR-ROUTINE-FIELDS.         CL**3
00022 *                                                                    CL**3
00023 ******************************************************************   CL**3
00024 *  SAMPLE OF THE CODE NEEDED IN A ONLINE PROGRAM                     CL**3
00025 *                                                                    CL**3
00026 *                                                                    CL**3
00027 *    INITIALIZE DP065-RANDNBR-ROUTINE-FIELDS.                        CL**3
00028 *                                                                    CL**3
00029 *    EXEC CICS ASKTIME                                               CL**3
00030 *         ABSTIME (PV-ABSTIME)                                       CL**3
00031 *    END-EXEC.                                                       CL**3
00032 *    EXEC CICS FORMATTIME                                            CL**3
00033 *         ABSTIME (PV-ABSTIME)                                       CL**3
00034 *         YYMMDD  (PV-CURRENT-DATE)                                  CL**3
00035 *         TIME    (PV-CURRENT-TIME)                                  CL**3
00036 *    END-EXEC.                                                       CL**3
00037 *                                                                    CL**3
00038 *    MOVE PV-CURRENT-DATE          TO DP065-CURRENT-DATE.            CL**3
00039 *    MOVE PV-CURRENT-TIME          TO DP065-CURRENT-TIME.            CL**3
00040 *                                                                    CL**3
00041 *    CALL PC-RANDNBR-PGM USING DP065-RANDNBR-ROUTINE-FIELDS.         CL**3
00042 *                                                                    CL**3
00043 ******************************************************************   CL**3
00044  ENVIRONMENT DIVISION.                                            DPKUT001
00045  CONFIGURATION SECTION.                                           DPKUT001
00046  SOURCE-COMPUTER. IBM-3090.                                       DPKUT001
00047  OBJECT-COMPUTER. IBM-3090.                                       DPKUT001
00048  INPUT-OUTPUT SECTION.                                            DPKUT001
00049  FILE-CONTROL.                                                    DPKUT001
00050  DATA DIVISION.                                                   DPKUT001
00051  FILE SECTION.                                                    DPKUT001
00052 /                                                                 DPKUT001
00053  WORKING-STORAGE SECTION.                                         DPKUT001
00054                                                                   DPKUT001
00055  LINKAGE SECTION.                                                 DPKUT001
00056      COPY DPWS065.                                                   CL**3
00057                                                                   DPKUT001
00058 /                                                                 DPKUT001
00059  PROCEDURE DIVISION USING DP065-RANDNBR-ROUTINE-FIELDS.           DPKUT001
00060                                                                   DPKUT001
00061  0000-PROGRAM-MAINLINE.                                           DPKUT001
00062                                                                   DPKUT001
00063      MOVE '00'                       TO DP065-RETURN-DATA.        DPKUT001
00064                                                                   DPKUT001
00065      IF  DP065-CURRENT-DATE = ZEROES                              DPKUT001
00066          MOVE '01'                   TO DP065-RETURN-DATA         DPKUT001
00067      ELSE                                                         DPKUT001
00068          IF  DP065-CURRENT-TIME = ZEROES                          DPKUT001
00069              MOVE '02'               TO DP065-RETURN-DATA         DPKUT001
00070          END-IF                                                   DPKUT001
00071      END-IF.                                                      DPKUT001
00072                                                                   DPKUT001
00073      IF  DP065-SUCCESSFUL                                         DPKUT001
00074          COMPUTE DP065-RANDOM-NUMBER =                            DPKUT001
00075               (((DP065-CURRENT-DATE-DD  * 24                      DPKUT001
00076                + DP065-CURRENT-TIME-HH) * 60                      DPKUT001
00077                + DP065-CURRENT-TIME-MM) * 60                      DPKUT001
00078                + DP065-CURRENT-TIME-SS) * 100                     DPKUT001
00079                + DP065-CURRENT-TIME-HS                            DPKUT001
00080                + DP065-RANDOM-TRAIL                               DPKUT001
00081          COMPUTE DP065-RANDOM-NUMBER =                            DPKUT001
00082                  DP065-RANDOM-NUMBER + 1                          DPKUT001
00083      END-IF.                                                      DPKUT001
00084                                                                   DPKUT001
00085      GOBACK.                                                      DPKUT001
00086                                                                   DPKUT001
