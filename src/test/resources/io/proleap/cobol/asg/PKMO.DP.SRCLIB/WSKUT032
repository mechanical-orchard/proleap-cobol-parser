000100 IDENTIFICATION DIVISION.                                         00010026
000200 PROGRAM-ID.   WSKUT032.                                          00020026
000300 AUTHOR.       RENGIN SIRVANCI.                                   00030026
000400 INSTALLATION. KOHLS DEPARTMENT STORES.                           00040026
000500 DATE-WRITTEN. MAY 2007.                                          00050026
000600                                                                  00060026
000700******************************************************************00070026
000800* THIS PROGRAM WILL BE USED TO EXTRACT PIX RECORDS FROM THE PIX   00080026
000900* REPOSITORY (WST_PIX_TRAN_HIST -- WST00000).  THERE CAN BE       00090026
001000* MULTIPLE INPUT RECORDS.                                         00100026
001100******************************************************************00110026
001101* 2010-11-26 CHRISTINE TWIEHAUS WR38972 MLOF                      00110157
001102*            REMOVE STORE TRANSLATION VIA TKRPRPM                 00110257
001110******************************************************************00111055
001200 ENVIRONMENT DIVISION.                                            00120026
001300******************************************************************00130026
001400 CONFIGURATION SECTION.                                           00140026
001500 SOURCE-COMPUTER.        IBM-3090.                                00150026
001600 OBJECT-COMPUTER.        IBM-3090.                                00160001
001700                                                                  00170001
001800 INPUT-OUTPUT SECTION.                                            00180001
001900                                                                  00190001
002000***************************************************************** 00200001
002100 FILE-CONTROL.                                                    00210001
002200     SELECT PIX-FILE-IN                                           00220009
002300       ASSIGN TO INP01.                                           00230003
002400                                                                  00240003
002500     SELECT PIX-FILE-OUT                                          00250009
002600       ASSIGN TO OUT01.                                           00260003
002700                                                                  00270001
002800***************************************************************** 00280001
002900 DATA DIVISION.                                                   00290001
003000 FILE SECTION.                                                    00300001
003100                                                                  00310001
003200 FD  PIX-FILE-IN                                                  00320003
003300     RECORDING MODE IS F                                          00330001
003400     BLOCK CONTAINS 0 RECORDS                                     00340010
003500     RECORD CONTAINS 80 CHARACTERS                                00350027
003600     LABEL RECORDS ARE STANDARD.                                  00360011
003700 01  PIX-REC-IN                     PIC X(80).                    00370027
003800                                                                  00380001
003900 FD  PIX-FILE-OUT                                                 00390003
004000     RECORDING MODE IS F                                          00400001
004100     BLOCK CONTAINS 0 RECORDS                                     00410010
004200     RECORD CONTAINS 700 CHARACTERS                               00420003
004300     LABEL RECORDS ARE STANDARD.                                  00430011
004400 01  PIX-REC-OUT                    PIC X(700).                   00440003
004500                                                                  00450001
004600******************************************************************00460001
004700 WORKING-STORAGE SECTION.                                         00470001
004800******************************************************************00480001
004810 01  DK-DB2-KEYS.                                                 00481029
004820     05 DK-DC-NBR                      PIC  S9(4) COMP.           00482029
004821* JAK 05/2010 - ADD 1 LINE                                        00482149
004822     05 DK-LOC-ID                      PIC  S9(4) COMP.           00482249
004830                                                                  00483029
004900 01  PS-PROGRAM-SWITCHES.                                         00490001
005000     05  PS-WHAT-CURSOR-SW             PIC X(01).                 00500027
005010         88  PS-NO-CSR                           VALUE 'A'.       00501027
005011         88  PS-ALL-PIX-CSR                      VALUE 'B'.       00501127
005012         88  PS-PIX-TYP-CDE-ACTN-CSR             VALUE 'C'.       00501227
005013         88  PS-PIX-TYP-CDE-CSR                  VALUE 'D'.       00501327
005014         88  PS-PIX-TYP-CSR                      VALUE 'E'.       00501427
005015* JAK 05/2010 - ADD 4 CURSOR SWITCH VALUES                        00501554
005016         88  PS-ALL-PIX-ALL-DC                   VALUE 'F'.       00501654
005017         88  PS-PIX-TYP-CDE-ACTN-ALL-DC          VALUE 'G'.       00501754
005018         88  PS-PIX-TYP-CDE-ALL-DC               VALUE 'H'.       00501854
005019         88  PS-PIX-TYP-ALL-DC                   VALUE 'I'.       00501954
005020                                                                  00502054
005030     05  PS-END-OF-INPUT-SW            PIC X(01) VALUE 'N'.       00503054
005100         88  PS-END-OF-INPUT-YES                 VALUE 'Y'.       00510001
005200         88  PS-END-OF-INPUT-NO                  VALUE 'N'.       00520001
005300                                                                  00530001
005310     05  PS-GOOD-INPUT-RECORD          PIC X(01) VALUE 'N'.       00531039
005320         88  PS-GOOD-INPUT-RECORD-YES            VALUE 'Y'.       00532039
005330         88  PS-GOOD-INPUT-RECORD-NO             VALUE 'N'.       00533039
005340                                                                  00534035
005400     05  PS-EOF-CSR                    PIC X(01) VALUE 'N'.       00540027
005500         88  PS-EOF-CSR-YES                      VALUE 'Y'.       00550027
005600         88  PS-EOF-CSR-NO                       VALUE 'N'.       00560027
005700                                                                  00570003
006600******************************************************************00660003
006700**** PROGRAM VARIABLES                                            00670003
006800******************************************************************00680003
006900 01  PV-PROGRAM-VARIABLES.                                        00690003
007000     05  PV-PRC-CURR-DATE          PIC X(10)  VALUE SPACES.       00700003
007100     05  PV-PRC-CNTL-TMST          PIC X(26)  VALUE SPACES.       00710003
007110     05  PV-DISP-SQLCODE           PIC 999-   VALUE ZEROES.       00711028
007111     05  PV-TOTAL-RECORDS-IN           PIC 9(09)  VALUE 0.        00711135
007120     05  PV-TOTAL-RECORDS-OUT           PIC 9(09)  VALUE 0.       00712028
007130     05  PV-ALL-PIX-TOTALS-READ         PIC 9(09)  VALUE 0.       00713028
007140     05  PV-ALL-PIX-TOTALS-WRITTEN      PIC 9(09)  VALUE 0.       00714028
007150     05  PV-PIX-TYP-ACTN-TOTALS-READ    PIC 9(09)  VALUE 0.       00715028
007160     05  PV-PIX-TYP-ACTN-TOTALS-WRITTEN PIC 9(09)  VALUE 0.       00716028
007170     05  PV-PIX-TYP-TOTALS-READ         PIC 9(09)  VALUE 0.       00717028
007180     05  PV-PIX-TYP-TOTALS-WRITTEN      PIC 9(09)  VALUE 0.       00718028
007190     05  PV-PIX-TOTALS-READ             PIC 9(09)  VALUE 0.       00719028
007191     05  PV-PIX-TOTALS-WRITTEN          PIC 9(09)  VALUE 0.       00719128
007192* JAK 05/2010 - ADD VARIABLES                                     00719250
007193     05  PV-ALL-PIX-ALL-DC-READ         PIC 9(09)  VALUE 0.       00719354
007194     05  PV-ALL-PIX-ALL-DC-WRITTEN      PIC 9(09)  VALUE 0.       00719454
007195     05  PV-PIX-TYP-ACTN-ALL-DC-READ    PIC 9(09)  VALUE 0.       00719554
007196     05  PV-PIX-TYP-ACTN-ALL-DC-WRITTEN PIC 9(09)  VALUE 0.       00719654
007197     05  PV-PIX-TYP-ALL-DC-READ         PIC 9(09)  VALUE 0.       00719754
007198     05  PV-PIX-TYP-ALL-DC-WRITTEN      PIC 9(09)  VALUE 0.       00719854
007199     05  PV-PIX-ALL-DC-READ             PIC 9(09)  VALUE 0.       00719954
007200     05  PV-PIX-ALL-DC-WRITTEN          PIC 9(09)  VALUE 0.       00720054
007201     05  PV-STORE-CHAR                  PIC X(03).                00720149
007202     05  PV-STORE-NBR REDEFINES PV-STORE-CHAR                     00720249
007203                                        PIC 9(03).                00720349
007204     05  PV-DC-NBR                      PIC X(04).                00720450
007205     05  PV-DC-STRUC REDEFINES PV-DC-NBR.                         00720551
007206         10  PV-DC-ZERO                 PIC X(01).                00720650
007207         10  PV-DC-VALUE                PIC X(03).                00720750
007208* JAK 05/2010 - END                                               00720850
007210                                                                  00721050
007300******************************************************************00730003
007400**** PROGRAM CONSTANTS                                            00740009
007500******************************************************************00750009
007600 01  PC-PROGRAM-CONSTANTS.                                        00760009
007700     05  PC-PGM-NAME             PIC X(08) VALUE 'WSKUT032'.      00770009
009000                                                                  00900001
009100******************************************************************00910003
009200**ABEND INFORMATION                                               00920003
009300******************************************************************00930003
009400 01  PV-MISC-ABEND-FIELDS.                                        00940003
009500     05  PV-NULL-IND                 PIC S9(04) COMP.             00950003
009600     05  PV-PARAGRAPH-NME            PIC  X(30)    VALUE SPACE.   00960003
009700                                                                  00970003
009800  01  PV-ABEND-CODE                   PIC S9(04) VALUE ZERO       00980003
009900                                                 COMP SYNC.       00990003
010000******************************************************************01000001
010100* INPUT PIX RECORD LAYOUT.                                        01010003
010200******************************************************************01020001
010300     COPY WSRD044.                                                01030001
010400                                                                  01040001
010500******************************************************************01050001
010600* OUTPUT PIX RECORD LAYOUT.                                       01060003
010700******************************************************************01070001
010800     COPY WSRD045.                                                01080001
010900                                                                  01090001
011000******************************************************************01100003
011100*  COMMUNICATIONS AREA FOR DB2                                    01110003
011200******************************************************************01120003
011300     EXEC SQL                                                     01130003
011400          INCLUDE SQLCA                                           01140003
011500     END-EXEC.                                                    01150003
011600                                                                  01160003
011700******************************************************************01170003
011800*  DB2 AREA FOR WST_PIX_TRAN_HIST TABLE.                          01180003
011900******************************************************************01190003
012000     EXEC SQL                                                     01200003
012100          INCLUDE WST00000                                        01210003
012200     END-EXEC.                                                    01220003
012300                                                                  01230003
012400******************************************************************01240003
012500*  DB2 AREA FOR WSV_PIX_RTE.                                      01250003
012600******************************************************************01260003
012700     EXEC SQL                                                     01270003
012800          INCLUDE WSV00002                                        01280003
012900     END-EXEC.                                                    01290003
013000                                                                  01300003
013080******************************************************************01308049
013090*  DB2 AREA FOR XLT_LOC                                           01309049
013091******************************************************************01309149
013092     EXEC SQL                                                     01309249
013093          INCLUDE XLT00010                                        01309349
013094     END-EXEC.                                                    01309449
013095                                                                  01309549
013096* JAK 05/2010 - END                                               01309649
013100******************************************************************01310003
013200*  DB2 ERROR MESSAGES FORMAT AREA.                                01320003
013300******************************************************************01330003
013400     COPY DPWS004.                                                01340003
013500                                                                  01350003
013600******************************************************************01360003
013700*  CURSOR FOR ALL PIX INFORMATION - FOR DATE RANGE/DC/QUEUE       01370027
013710*  PIX_TRAN_TYP = "ALL"                                           01371027
013800******************************************************************01380003
013900     EXEC SQL                                                     01390003
014000       DECLARE ALL_PIX_CSR CURSOR FOR                             01400027
014100       SELECT A.TRAN_TYPE                                         01410003
014200            , A.TRAN_CODE                                         01420003
014300            , A.TRAN_NBR                                          01430003
014400            , A.PIX_SEQ_NBR                                       01440003
014500            , A.PROC_STAT_CODE                                    01450003
014600            , A.WHSE                                              01460003
014700            , A.CO                                                01470003
014800            , A.DIV                                               01480003
014900            , A.CASE_NBR                                          01490003
015000            , A.SKU_ID                                            01500003
015100            , A.SEASON                                            01510003
015200            , A.SEASON_YR                                         01520003
015300            , A.STYLE                                             01530003
015400            , A.STYLE_SFX                                         01540003
015500            , A.COLOR                                             01550003
015600            , A.COLOR_SFX                                         01560003
015700            , A.SEC_DIM                                           01570003
015800            , A.QUAL                                              01580003
015900            , A.SIZE_DESC                                         01590003
016000            , A.SIZE_RANGE_CODE                                   01600003
016100            , A.SIZE_POSN_IN_TBL                                  01610003
016200            , A.INVN_TYPE                                         01620003
016300            , A.PROD_STAT                                         01630003
016400            , A.BATCH_NBR                                         01640003
016500            , A.SKU_ATTR_1                                        01650003
016600            , A.SKU_ATTR_2                                        01660003
016700            , A.SKU_ATTR_3                                        01670003
016800            , A.SKU_ATTR_4                                        01680003
016900            , A.SKU_ATTR_5                                        01690003
017000            , A.CNTRY_OF_ORGN                                     01700003
017100            , A.INVN_ADJMT_QTY                                    01710003
017200            , A.INVN_ADJMT_TYPE                                   01720003
017300            , A.WT_ADJMT_QTY                                      01730003
017400            , A.WT_ADJMT_TYPE                                     01740003
017500            , A.UOM                                               01750003
017600            , A.REF_WHSE                                          01760003
017700            , A.RSN_CODE                                          01770003
017800            , A.RCPT_VARI                                         01780003
017900            , A.RCPT_CMPL                                         01790003
018000            , A.CASES_SHPD                                        01800003
018100            , A.UNITS_SHPD                                        01810003
018200            , A.CASES_RCVD                                        01820003
018300            , A.UNITS_RCVD                                        01830003
018400            , A.ACTN_CODE                                         01840003
018500            , A.CUSTOM_REF                                        01850003
018600            , A.DATE_PROC                                         01860003
018700            , A.SYS_USER_ID                                       01870003
018800            , A.ERROR_CMNT                                        01880003
018900            , A.REF_CODE_ID_1                                     01890003
019000            , A.REF_FIELD_1                                       01900003
019100            , A.REF_CODE_ID_2                                     01910003
019200            , A.REF_FIELD_2                                       01920003
019300            , A.REF_CODE_ID_3                                     01930003
019400            , A.REF_FIELD_3                                       01940003
019500            , A.REF_CODE_ID_4                                     01950003
019600            , A.REF_FIELD_4                                       01960003
019700            , A.REF_CODE_ID_5                                     01970003
019800            , A.REF_FIELD_5                                       01980003
019900            , A.REF_CODE_ID_6                                     01990003
020000            , A.REF_FIELD_6                                       02000003
020100            , A.REF_CODE_ID_7                                     02010003
020200            , A.REF_FIELD_7                                       02020003
020300            , A.REF_CODE_ID_8                                     02030003
020400            , A.REF_FIELD_8                                       02040003
020500            , A.REF_CODE_ID_9                                     02050003
020600            , A.REF_FIELD_9                                       02060003
020700            , A.REF_CODE_ID_10                                    02070003
020800            , A.REF_FIELD_10                                      02080003
020900            , A.XML_GROUP_ID                                      02090003
021000            , A.CREATE_DATE_TIME                                  02100003
021100            , A.MOD_DATE_TIME                                     02110003
021200            , A.USER_ID                                           02120003
021300            , A.K_DC_NBR                                          02130003
021400            , A.K_ISRT_TMST                                       02140003
021500            , B.PIX_QUE                                           02150005
021600       FROM                                                       02160003
021700              WST_PIX_TRAN_HIST A                                 02170003
021800             ,WSV_PIX_RTE       B                                 02180012
021900            WHERE  A.TRAN_TYPE         = B.PIX_TYP                02190003
022000               AND A.TRAN_CODE         = B.PIX_CDE                02200003
022100               AND (A.ACTN_CODE        = B.PIX_ACTN_CDE OR        02210023
022200                   (A.ACTN_CODE        = '  ' AND                 02220023
022300                    B.PIX_ACTN_CDE     IS NULL))                  02230024
022400               AND B.INTGRTN_TYP_CDE   = 'PIXRTEBRKR'             02240003
022500               AND B.ACTV_IND          = 'Y'                      02250003
022600               AND DATE(B.EFF_BEG_DTE) <= CURRENT DATE            02260016
022700               AND DATE(B.EFF_END_DTE) >= CURRENT DATE            02270016
022800               AND B.PIX_QUE            = :WS044-QUEUE            02280003
022900               AND A.K_ISRT_TMST       >= :WS044-FROM-TMST        02290003
023000               AND A.K_ISRT_TMST       <= :WS044-TO-TMST          02300003
023100               AND A.K_DC_NBR           = :DK-DC-NBR              02310029
023200       ORDER BY A.K_ISRT_TMST                                     02320014
023300       FOR FETCH ONLY                                             02330003
023400       WITH UR                                                    02340003
023500     END-EXEC.                                                    02350003
023600                                                                  02360003
023790******************************************************************02379003
023800*  CURSOR FOR SPECIFIC PIX INFORMATION - FOR DATE RANGE/DC/QUEUE  02380027
023810*  PIX_TRAN_TYPE, PIX_CODE & PIX_ACTN  ALL POPULATED              02381027
023900******************************************************************02390003
024000     EXEC SQL                                                     02400003
024100       DECLARE PIX_TYP_CDE_AC_CSR   CURSOR FOR                    02410030
024200       SELECT A.TRAN_TYPE                                         02420003
024300            , A.TRAN_CODE                                         02430003
024400            , A.TRAN_NBR                                          02440003
024500            , A.PIX_SEQ_NBR                                       02450003
024600            , A.PROC_STAT_CODE                                    02460003
024700            , A.WHSE                                              02470003
024800            , A.CO                                                02480003
024900            , A.DIV                                               02490003
025000            , A.CASE_NBR                                          02500003
025100            , A.SKU_ID                                            02510003
025200            , A.SEASON                                            02520003
025300            , A.SEASON_YR                                         02530003
025400            , A.STYLE                                             02540003
025500            , A.STYLE_SFX                                         02550003
025600            , A.COLOR                                             02560003
025700            , A.COLOR_SFX                                         02570003
025800            , A.SEC_DIM                                           02580003
025900            , A.QUAL                                              02590003
026000            , A.SIZE_DESC                                         02600003
026100            , A.SIZE_RANGE_CODE                                   02610003
026200            , A.SIZE_POSN_IN_TBL                                  02620003
026300            , A.INVN_TYPE                                         02630003
026400            , A.PROD_STAT                                         02640003
026500            , A.BATCH_NBR                                         02650003
026600            , A.SKU_ATTR_1                                        02660003
026700            , A.SKU_ATTR_2                                        02670003
026800            , A.SKU_ATTR_3                                        02680003
026900            , A.SKU_ATTR_4                                        02690003
027000            , A.SKU_ATTR_5                                        02700003
027100            , A.CNTRY_OF_ORGN                                     02710003
027200            , A.INVN_ADJMT_QTY                                    02720003
027300            , A.INVN_ADJMT_TYPE                                   02730003
027400            , A.WT_ADJMT_QTY                                      02740003
027500            , A.WT_ADJMT_TYPE                                     02750003
027600            , A.UOM                                               02760003
027700            , A.REF_WHSE                                          02770003
027800            , A.RSN_CODE                                          02780003
027900            , A.RCPT_VARI                                         02790003
028000            , A.RCPT_CMPL                                         02800003
028100            , A.CASES_SHPD                                        02810003
028200            , A.UNITS_SHPD                                        02820003
028300            , A.CASES_RCVD                                        02830003
028400            , A.UNITS_RCVD                                        02840003
028500            , A.ACTN_CODE                                         02850003
028600            , A.CUSTOM_REF                                        02860003
028700            , A.DATE_PROC                                         02870003
028800            , A.SYS_USER_ID                                       02880003
028900            , A.ERROR_CMNT                                        02890003
029000            , A.REF_CODE_ID_1                                     02900003
029100            , A.REF_FIELD_1                                       02910003
029200            , A.REF_CODE_ID_2                                     02920003
029300            , A.REF_FIELD_2                                       02930003
029400            , A.REF_CODE_ID_3                                     02940003
029500            , A.REF_FIELD_3                                       02950003
029600            , A.REF_CODE_ID_4                                     02960003
029700            , A.REF_FIELD_4                                       02970003
029800            , A.REF_CODE_ID_5                                     02980003
029900            , A.REF_FIELD_5                                       02990003
030000            , A.REF_CODE_ID_6                                     03000003
030100            , A.REF_FIELD_6                                       03010003
030200            , A.REF_CODE_ID_7                                     03020003
030300            , A.REF_FIELD_7                                       03030003
030400            , A.REF_CODE_ID_8                                     03040003
030500            , A.REF_FIELD_8                                       03050003
030600            , A.REF_CODE_ID_9                                     03060003
030700            , A.REF_FIELD_9                                       03070003
030800            , A.REF_CODE_ID_10                                    03080003
030900            , A.REF_FIELD_10                                      03090003
031000            , A.XML_GROUP_ID                                      03100003
031100            , A.CREATE_DATE_TIME                                  03110003
031200            , A.MOD_DATE_TIME                                     03120003
031300            , A.USER_ID                                           03130003
031400            , A.K_DC_NBR                                          03140003
031500            , A.K_ISRT_TMST                                       03150003
031600            , B.PIX_QUE                                           03160005
031700       FROM                                                       03170003
031800              WST_PIX_TRAN_HIST A                                 03180003
031900             ,WSV_PIX_RTE       B                                 03190012
032000            WHERE  A.TRAN_TYPE         = B.PIX_TYP                03200003
032100               AND A.TRAN_CODE         = B.PIX_CDE                03210003
032200               AND (A.ACTN_CODE        = B.PIX_ACTN_CDE OR        03220023
032300                   (A.ACTN_CODE        = '  ' AND                 03230023
032400                    B.PIX_ACTN_CDE     IS NULL))                  03240024
032500               AND B.INTGRTN_TYP_CDE   = 'PIXRTEBRKR'             03250003
032600               AND B.ACTV_IND          = 'Y'                      03260003
032700               AND DATE(B.EFF_BEG_DTE) <= CURRENT DATE            03270016
032800               AND DATE(B.EFF_END_DTE) >= CURRENT DATE            03280016
032900               AND A.TRAN_TYPE          = :WS044-PIX-TYP          03290003
033000               AND A.TRAN_CODE          = :WS044-PIX-CDE          03300003
033100               AND A.ACTN_CODE          = :WS044-PIX-ACTN-CDE     03310003
033200               AND B.PIX_QUE            = :WS044-QUEUE            03320003
033300               AND A.K_ISRT_TMST       >= :WS044-FROM-TMST        03330003
033400               AND A.K_ISRT_TMST       <= :WS044-TO-TMST          03340003
033500               AND A.K_DC_NBR           = :DK-DC-NBR              03350029
033600       ORDER BY A.K_ISRT_TMST                                     03360014
033700       FOR FETCH ONLY                                             03370003
033800       WITH UR                                                    03380003
033900     END-EXEC.                                                    03390003
034000                                                                  03400003
034100******************************************************************03410027
034110*  CURSOR FOR SPECIFIC PIX INFORMATION - FOR DATE RANGE/DC/QUEUE  03411027
034120*  PIX_TRAN_TYPE, PIX_CODE  (NO PIX_ACTN)                         03412027
034130******************************************************************03413027
034140     EXEC SQL                                                     03414027
034150       DECLARE PIX_TYP_CDE_CSR         CURSOR FOR                 03415029
034160       SELECT A.TRAN_TYPE                                         03416027
034170            , A.TRAN_CODE                                         03417027
034180            , A.TRAN_NBR                                          03418027
034181            , A.PIX_SEQ_NBR                                       03418127
034182            , A.PROC_STAT_CODE                                    03418227
034183            , A.WHSE                                              03418327
034184            , A.CO                                                03418427
034185            , A.DIV                                               03418527
034186            , A.CASE_NBR                                          03418627
034187            , A.SKU_ID                                            03418727
034188            , A.SEASON                                            03418827
034189            , A.SEASON_YR                                         03418927
034190            , A.STYLE                                             03419027
034191            , A.STYLE_SFX                                         03419127
034192            , A.COLOR                                             03419227
034193            , A.COLOR_SFX                                         03419327
034194            , A.SEC_DIM                                           03419427
034195            , A.QUAL                                              03419527
034196            , A.SIZE_DESC                                         03419627
034197            , A.SIZE_RANGE_CODE                                   03419727
034198            , A.SIZE_POSN_IN_TBL                                  03419827
034199            , A.INVN_TYPE                                         03419927
034200            , A.PROD_STAT                                         03420027
034201            , A.BATCH_NBR                                         03420127
034202            , A.SKU_ATTR_1                                        03420227
034203            , A.SKU_ATTR_2                                        03420327
034204            , A.SKU_ATTR_3                                        03420427
034205            , A.SKU_ATTR_4                                        03420527
034206            , A.SKU_ATTR_5                                        03420627
034207            , A.CNTRY_OF_ORGN                                     03420727
034208            , A.INVN_ADJMT_QTY                                    03420827
034209            , A.INVN_ADJMT_TYPE                                   03420927
034210            , A.WT_ADJMT_QTY                                      03421027
034211            , A.WT_ADJMT_TYPE                                     03421127
034212            , A.UOM                                               03421227
034213            , A.REF_WHSE                                          03421327
034214            , A.RSN_CODE                                          03421427
034215            , A.RCPT_VARI                                         03421527
034216            , A.RCPT_CMPL                                         03421627
034217            , A.CASES_SHPD                                        03421727
034218            , A.UNITS_SHPD                                        03421827
034219            , A.CASES_RCVD                                        03421927
034220            , A.UNITS_RCVD                                        03422027
034221            , A.ACTN_CODE                                         03422127
034222            , A.CUSTOM_REF                                        03422227
034223            , A.DATE_PROC                                         03422327
034224            , A.SYS_USER_ID                                       03422427
034225            , A.ERROR_CMNT                                        03422527
034226            , A.REF_CODE_ID_1                                     03422627
034227            , A.REF_FIELD_1                                       03422727
034228            , A.REF_CODE_ID_2                                     03422827
034229            , A.REF_FIELD_2                                       03422927
034230            , A.REF_CODE_ID_3                                     03423027
034231            , A.REF_FIELD_3                                       03423127
034232            , A.REF_CODE_ID_4                                     03423227
034233            , A.REF_FIELD_4                                       03423327
034234            , A.REF_CODE_ID_5                                     03423427
034235            , A.REF_FIELD_5                                       03423527
034236            , A.REF_CODE_ID_6                                     03423627
034237            , A.REF_FIELD_6                                       03423727
034238            , A.REF_CODE_ID_7                                     03423827
034239            , A.REF_FIELD_7                                       03423927
034240            , A.REF_CODE_ID_8                                     03424027
034241            , A.REF_FIELD_8                                       03424127
034242            , A.REF_CODE_ID_9                                     03424227
034243            , A.REF_FIELD_9                                       03424327
034244            , A.REF_CODE_ID_10                                    03424427
034245            , A.REF_FIELD_10                                      03424527
034246            , A.XML_GROUP_ID                                      03424627
034247            , A.CREATE_DATE_TIME                                  03424727
034248            , A.MOD_DATE_TIME                                     03424827
034249            , A.USER_ID                                           03424927
034250            , A.K_DC_NBR                                          03425027
034251            , A.K_ISRT_TMST                                       03425127
034252            , B.PIX_QUE                                           03425227
034253       FROM                                                       03425327
034254              WST_PIX_TRAN_HIST A                                 03425427
034255             ,WSV_PIX_RTE       B                                 03425527
034256            WHERE  A.TRAN_TYPE         = B.PIX_TYP                03425627
034257               AND A.TRAN_CODE         = B.PIX_CDE                03425727
034258               AND (A.ACTN_CODE        = B.PIX_ACTN_CDE OR        03425827
034259                   (A.ACTN_CODE        = '  ' AND                 03425927
034260                    B.PIX_ACTN_CDE     IS NULL))                  03426027
034261               AND B.INTGRTN_TYP_CDE   = 'PIXRTEBRKR'             03426127
034262               AND B.ACTV_IND          = 'Y'                      03426227
034263               AND DATE(B.EFF_BEG_DTE) <= CURRENT DATE            03426327
034264               AND DATE(B.EFF_END_DTE) >= CURRENT DATE            03426427
034265               AND A.TRAN_TYPE          = :WS044-PIX-TYP          03426527
034266               AND A.TRAN_CODE          = :WS044-PIX-CDE          03426627
034267               AND A.ACTN_CODE          = :WS044-PIX-ACTN-CDE     03426727
034268               AND B.PIX_QUE            = :WS044-QUEUE            03426827
034269               AND A.K_ISRT_TMST       >= :WS044-FROM-TMST        03426927
034270               AND A.K_ISRT_TMST       <= :WS044-TO-TMST          03427027
034271               AND A.K_DC_NBR           = :DK-DC-NBR              03427129
034272       ORDER BY A.K_ISRT_TMST                                     03427227
034273       FOR FETCH ONLY                                             03427327
034274       WITH UR                                                    03427427
034275     END-EXEC.                                                    03427527
034276                                                                  03427627
034277******************************************************************03427727
034278*  CURSOR FOR SPECIFIC PIX INFORMATION - FOR DATE RANGE/DC/QUEUE  03427827
034279*  PIX_TRAN_TYPE (NO PIX_CODE)  (NO PIX_ACTN)                     03427927
034280******************************************************************03428027
034281     EXEC SQL                                                     03428127
034282       DECLARE PIX_TYP_CSR CURSOR FOR                             03428227
034283       SELECT A.TRAN_TYPE                                         03428327
034284            , A.TRAN_CODE                                         03428427
034285            , A.TRAN_NBR                                          03428527
034286            , A.PIX_SEQ_NBR                                       03428627
034287            , A.PROC_STAT_CODE                                    03428727
034288            , A.WHSE                                              03428827
034289            , A.CO                                                03428927
034290            , A.DIV                                               03429027
034291            , A.CASE_NBR                                          03429127
034292            , A.SKU_ID                                            03429227
034293            , A.SEASON                                            03429327
034294            , A.SEASON_YR                                         03429427
034295            , A.STYLE                                             03429527
034296            , A.STYLE_SFX                                         03429627
034297            , A.COLOR                                             03429727
034298            , A.COLOR_SFX                                         03429827
034299            , A.SEC_DIM                                           03429927
034300            , A.QUAL                                              03430027
034301            , A.SIZE_DESC                                         03430127
034302            , A.SIZE_RANGE_CODE                                   03430227
034303            , A.SIZE_POSN_IN_TBL                                  03430327
034304            , A.INVN_TYPE                                         03430427
034305            , A.PROD_STAT                                         03430527
034306            , A.BATCH_NBR                                         03430627
034307            , A.SKU_ATTR_1                                        03430727
034308            , A.SKU_ATTR_2                                        03430827
034309            , A.SKU_ATTR_3                                        03430927
034310            , A.SKU_ATTR_4                                        03431027
034311            , A.SKU_ATTR_5                                        03431127
034312            , A.CNTRY_OF_ORGN                                     03431227
034313            , A.INVN_ADJMT_QTY                                    03431327
034314            , A.INVN_ADJMT_TYPE                                   03431427
034315            , A.WT_ADJMT_QTY                                      03431527
034316            , A.WT_ADJMT_TYPE                                     03431627
034317            , A.UOM                                               03431727
034318            , A.REF_WHSE                                          03431827
034319            , A.RSN_CODE                                          03431927
034320            , A.RCPT_VARI                                         03432027
034321            , A.RCPT_CMPL                                         03432127
034322            , A.CASES_SHPD                                        03432227
034323            , A.UNITS_SHPD                                        03432327
034324            , A.CASES_RCVD                                        03432427
034325            , A.UNITS_RCVD                                        03432527
034326            , A.ACTN_CODE                                         03432627
034327            , A.CUSTOM_REF                                        03432727
034328            , A.DATE_PROC                                         03432827
034329            , A.SYS_USER_ID                                       03432927
034330            , A.ERROR_CMNT                                        03433027
034331            , A.REF_CODE_ID_1                                     03433127
034332            , A.REF_FIELD_1                                       03433227
034333            , A.REF_CODE_ID_2                                     03433327
034334            , A.REF_FIELD_2                                       03433427
034335            , A.REF_CODE_ID_3                                     03433527
034336            , A.REF_FIELD_3                                       03433627
034337            , A.REF_CODE_ID_4                                     03433727
034338            , A.REF_FIELD_4                                       03433827
034339            , A.REF_CODE_ID_5                                     03433927
034340            , A.REF_FIELD_5                                       03434027
034341            , A.REF_CODE_ID_6                                     03434127
034342            , A.REF_FIELD_6                                       03434227
034343            , A.REF_CODE_ID_7                                     03434327
034344            , A.REF_FIELD_7                                       03434427
034345            , A.REF_CODE_ID_8                                     03434527
034346            , A.REF_FIELD_8                                       03434627
034347            , A.REF_CODE_ID_9                                     03434727
034348            , A.REF_FIELD_9                                       03434827
034349            , A.REF_CODE_ID_10                                    03434927
034350            , A.REF_FIELD_10                                      03435027
034351            , A.XML_GROUP_ID                                      03435127
034352            , A.CREATE_DATE_TIME                                  03435227
034353            , A.MOD_DATE_TIME                                     03435327
034354            , A.USER_ID                                           03435427
034355            , A.K_DC_NBR                                          03435527
034356            , A.K_ISRT_TMST                                       03435627
034357            , B.PIX_QUE                                           03435727
034358       FROM                                                       03435827
034359              WST_PIX_TRAN_HIST A                                 03435927
034360             ,WSV_PIX_RTE       B                                 03436027
034361            WHERE  A.TRAN_TYPE         = B.PIX_TYP                03436127
034362               AND A.TRAN_CODE         = B.PIX_CDE                03436227
034363               AND (A.ACTN_CODE        = B.PIX_ACTN_CDE OR        03436327
034364                   (A.ACTN_CODE        = '  ' AND                 03436427
034365                    B.PIX_ACTN_CDE     IS NULL))                  03436527
034366               AND B.INTGRTN_TYP_CDE   = 'PIXRTEBRKR'             03436627
034367               AND B.ACTV_IND          = 'Y'                      03436727
034368               AND DATE(B.EFF_BEG_DTE) <= CURRENT DATE            03436827
034369               AND DATE(B.EFF_END_DTE) >= CURRENT DATE            03436927
034370               AND A.TRAN_TYPE          = :WS044-PIX-TYP          03437027
034371               AND A.TRAN_CODE          = :WS044-PIX-CDE          03437127
034372               AND A.ACTN_CODE          = :WS044-PIX-ACTN-CDE     03437227
034373               AND B.PIX_QUE            = :WS044-QUEUE            03437327
034374               AND A.K_ISRT_TMST       >= :WS044-FROM-TMST        03437427
034375               AND A.K_ISRT_TMST       <= :WS044-TO-TMST          03437527
034376               AND A.K_DC_NBR           = :DK-DC-NBR              03437629
034377       ORDER BY A.K_ISRT_TMST                                     03437727
034378       FOR FETCH ONLY                                             03437827
034379       WITH UR                                                    03437927
034380     END-EXEC.                                                    03438027
034381                                                                  03438127
034382* JAK 05/2010 - ADD 4 NEW CURSORS FOR SELECTING ALL DC'S          03438254
034383******************************************************************03438354
034384*  CURSOR FOR ALL PIX INFORMATION - FOR DATE RANGE/QUEUE - ALL DC 03438454
034385*  PIX_TRAN_TYP = "ALL"                                           03438554
034386******************************************************************03438654
034387     EXEC SQL                                                     03438754
034388       DECLARE ALL_PIX_ALL_DC_CSR CURSOR FOR                      03438854
034389       SELECT A.TRAN_TYPE                                         03438954
034390            , A.TRAN_CODE                                         03439054
034391            , A.TRAN_NBR                                          03439154
034400            , A.PIX_SEQ_NBR                                       03440054
034500            , A.PROC_STAT_CODE                                    03450054
034600            , A.WHSE                                              03460054
034700            , A.CO                                                03470054
034800            , A.DIV                                               03480054
034900            , A.CASE_NBR                                          03490054
035000            , A.SKU_ID                                            03500054
035100            , A.SEASON                                            03510054
035200            , A.SEASON_YR                                         03520054
035300            , A.STYLE                                             03530054
035400            , A.STYLE_SFX                                         03540054
035500            , A.COLOR                                             03550054
035600            , A.COLOR_SFX                                         03560054
035700            , A.SEC_DIM                                           03570054
035800            , A.QUAL                                              03580054
035900            , A.SIZE_DESC                                         03590054
036000            , A.SIZE_RANGE_CODE                                   03600054
036100            , A.SIZE_POSN_IN_TBL                                  03610054
036200            , A.INVN_TYPE                                         03620054
036300            , A.PROD_STAT                                         03630054
036400            , A.BATCH_NBR                                         03640054
036500            , A.SKU_ATTR_1                                        03650054
036600            , A.SKU_ATTR_2                                        03660054
036700            , A.SKU_ATTR_3                                        03670054
036800            , A.SKU_ATTR_4                                        03680054
036900            , A.SKU_ATTR_5                                        03690054
037000            , A.CNTRY_OF_ORGN                                     03700054
037100            , A.INVN_ADJMT_QTY                                    03710054
037200            , A.INVN_ADJMT_TYPE                                   03720054
037300            , A.WT_ADJMT_QTY                                      03730054
037400            , A.WT_ADJMT_TYPE                                     03740054
037500            , A.UOM                                               03750054
037600            , A.REF_WHSE                                          03760054
037700            , A.RSN_CODE                                          03770054
037800            , A.RCPT_VARI                                         03780054
037900            , A.RCPT_CMPL                                         03790054
038000            , A.CASES_SHPD                                        03800054
038100            , A.UNITS_SHPD                                        03810054
038200            , A.CASES_RCVD                                        03820054
038300            , A.UNITS_RCVD                                        03830054
038400            , A.ACTN_CODE                                         03840054
038500            , A.CUSTOM_REF                                        03850054
038600            , A.DATE_PROC                                         03860054
038700            , A.SYS_USER_ID                                       03870054
038800            , A.ERROR_CMNT                                        03880054
038900            , A.REF_CODE_ID_1                                     03890054
039000            , A.REF_FIELD_1                                       03900054
039100            , A.REF_CODE_ID_2                                     03910054
039200            , A.REF_FIELD_2                                       03920054
039300            , A.REF_CODE_ID_3                                     03930054
039400            , A.REF_FIELD_3                                       03940054
039500            , A.REF_CODE_ID_4                                     03950054
039600            , A.REF_FIELD_4                                       03960054
039700            , A.REF_CODE_ID_5                                     03970054
039800            , A.REF_FIELD_5                                       03980054
039900            , A.REF_CODE_ID_6                                     03990054
040000            , A.REF_FIELD_6                                       04000054
040100            , A.REF_CODE_ID_7                                     04010054
040200            , A.REF_FIELD_7                                       04020054
040300            , A.REF_CODE_ID_8                                     04030054
040400            , A.REF_FIELD_8                                       04040054
040500            , A.REF_CODE_ID_9                                     04050054
040600            , A.REF_FIELD_9                                       04060054
040700            , A.REF_CODE_ID_10                                    04070054
040800            , A.REF_FIELD_10                                      04080054
040900            , A.XML_GROUP_ID                                      04090054
041000            , A.CREATE_DATE_TIME                                  04100054
041100            , A.MOD_DATE_TIME                                     04110054
041200            , A.USER_ID                                           04120054
041300            , A.K_DC_NBR                                          04130054
041400            , A.K_ISRT_TMST                                       04140054
041500            , B.PIX_QUE                                           04150054
041600       FROM                                                       04160054
041700              WST_PIX_TRAN_HIST A                                 04170054
041800             ,WSV_PIX_RTE       B                                 04180054
041900            WHERE  A.TRAN_TYPE         = B.PIX_TYP                04190054
042000               AND A.TRAN_CODE         = B.PIX_CDE                04200054
042100               AND (A.ACTN_CODE        = B.PIX_ACTN_CDE OR        04210054
042200                   (A.ACTN_CODE        = '  ' AND                 04220054
042300                    B.PIX_ACTN_CDE     IS NULL))                  04230054
042400               AND B.INTGRTN_TYP_CDE   = 'PIXRTEBRKR'             04240054
042500               AND B.ACTV_IND          = 'Y'                      04250054
042600               AND DATE(B.EFF_BEG_DTE) <= CURRENT DATE            04260054
042700               AND DATE(B.EFF_END_DTE) >= CURRENT DATE            04270054
042800               AND B.PIX_QUE            = :WS044-QUEUE            04280054
042900               AND A.K_ISRT_TMST       >= :WS044-FROM-TMST        04290054
043000               AND A.K_ISRT_TMST       <= :WS044-TO-TMST          04300054
043200       ORDER BY A.K_ISRT_TMST                                     04320054
043300       FOR FETCH ONLY                                             04330054
043400       WITH UR                                                    04340054
043500     END-EXEC.                                                    04350054
043600                                                                  04360054
043700******************************************************************04370054
043800*  CURSOR FOR SPECIFIC PIX INFO - FOR DATE RANGE/QUEUE - ALL DC'S 04380054
043900*  PIX_TRAN_TYPE, PIX_CODE & PIX_ACTN  ALL POPULATED              04390054
044000******************************************************************04400054
044100     EXEC SQL                                                     04410054
044200       DECLARE PIX_TYP_AC_ALL_DC_CSR   CURSOR FOR                 04420054
044300       SELECT A.TRAN_TYPE                                         04430054
044400            , A.TRAN_CODE                                         04440054
044500            , A.TRAN_NBR                                          04450054
044510            , A.PIX_SEQ_NBR                                       04451054
044520            , A.PROC_STAT_CODE                                    04452054
044530            , A.WHSE                                              04453054
044540            , A.CO                                                04454054
044550            , A.DIV                                               04455054
044560            , A.CASE_NBR                                          04456054
044570            , A.SKU_ID                                            04457054
044580            , A.SEASON                                            04458054
044581            , A.SEASON_YR                                         04458154
044582            , A.STYLE                                             04458254
044583            , A.STYLE_SFX                                         04458354
044584            , A.COLOR                                             04458454
044585            , A.COLOR_SFX                                         04458554
044586            , A.SEC_DIM                                           04458654
044587            , A.QUAL                                              04458754
044588            , A.SIZE_DESC                                         04458854
044589            , A.SIZE_RANGE_CODE                                   04458954
044590            , A.SIZE_POSN_IN_TBL                                  04459054
044591            , A.INVN_TYPE                                         04459154
044592            , A.PROD_STAT                                         04459254
044593            , A.BATCH_NBR                                         04459354
044594            , A.SKU_ATTR_1                                        04459454
044595            , A.SKU_ATTR_2                                        04459554
044596            , A.SKU_ATTR_3                                        04459654
044597            , A.SKU_ATTR_4                                        04459754
044598            , A.SKU_ATTR_5                                        04459854
044599            , A.CNTRY_OF_ORGN                                     04459954
044600            , A.INVN_ADJMT_QTY                                    04460054
044601            , A.INVN_ADJMT_TYPE                                   04460154
044602            , A.WT_ADJMT_QTY                                      04460254
044603            , A.WT_ADJMT_TYPE                                     04460354
044604            , A.UOM                                               04460454
044605            , A.REF_WHSE                                          04460554
044606            , A.RSN_CODE                                          04460654
044607            , A.RCPT_VARI                                         04460754
044608            , A.RCPT_CMPL                                         04460854
044609            , A.CASES_SHPD                                        04460954
044610            , A.UNITS_SHPD                                        04461054
044611            , A.CASES_RCVD                                        04461154
044612            , A.UNITS_RCVD                                        04461254
044613            , A.ACTN_CODE                                         04461354
044614            , A.CUSTOM_REF                                        04461454
044615            , A.DATE_PROC                                         04461554
044616            , A.SYS_USER_ID                                       04461654
044617            , A.ERROR_CMNT                                        04461754
044618            , A.REF_CODE_ID_1                                     04461854
044619            , A.REF_FIELD_1                                       04461954
044620            , A.REF_CODE_ID_2                                     04462054
044621            , A.REF_FIELD_2                                       04462154
044622            , A.REF_CODE_ID_3                                     04462254
044623            , A.REF_FIELD_3                                       04462354
044624            , A.REF_CODE_ID_4                                     04462454
044625            , A.REF_FIELD_4                                       04462554
044626            , A.REF_CODE_ID_5                                     04462654
044627            , A.REF_FIELD_5                                       04462754
044628            , A.REF_CODE_ID_6                                     04462854
044629            , A.REF_FIELD_6                                       04462954
044630            , A.REF_CODE_ID_7                                     04463054
044631            , A.REF_FIELD_7                                       04463154
044632            , A.REF_CODE_ID_8                                     04463254
044633            , A.REF_FIELD_8                                       04463354
044634            , A.REF_CODE_ID_9                                     04463454
044635            , A.REF_FIELD_9                                       04463554
044636            , A.REF_CODE_ID_10                                    04463654
044637            , A.REF_FIELD_10                                      04463754
044638            , A.XML_GROUP_ID                                      04463854
044639            , A.CREATE_DATE_TIME                                  04463954
044640            , A.MOD_DATE_TIME                                     04464054
044641            , A.USER_ID                                           04464154
044642            , A.K_DC_NBR                                          04464254
044643            , A.K_ISRT_TMST                                       04464354
044644            , B.PIX_QUE                                           04464454
044645       FROM                                                       04464554
044646              WST_PIX_TRAN_HIST A                                 04464654
044647             ,WSV_PIX_RTE       B                                 04464754
044648            WHERE  A.TRAN_TYPE         = B.PIX_TYP                04464854
044649               AND A.TRAN_CODE         = B.PIX_CDE                04464954
044650               AND (A.ACTN_CODE        = B.PIX_ACTN_CDE OR        04465054
044651                   (A.ACTN_CODE        = '  ' AND                 04465154
044652                    B.PIX_ACTN_CDE     IS NULL))                  04465254
044653               AND B.INTGRTN_TYP_CDE   = 'PIXRTEBRKR'             04465354
044654               AND B.ACTV_IND          = 'Y'                      04465454
044655               AND DATE(B.EFF_BEG_DTE) <= CURRENT DATE            04465554
044656               AND DATE(B.EFF_END_DTE) >= CURRENT DATE            04465654
044657               AND A.TRAN_TYPE          = :WS044-PIX-TYP          04465754
044658               AND A.TRAN_CODE          = :WS044-PIX-CDE          04465854
044659               AND A.ACTN_CODE          = :WS044-PIX-ACTN-CDE     04465954
044660               AND B.PIX_QUE            = :WS044-QUEUE            04466054
044661               AND A.K_ISRT_TMST       >= :WS044-FROM-TMST        04466154
044662               AND A.K_ISRT_TMST       <= :WS044-TO-TMST          04466254
044664       ORDER BY A.K_ISRT_TMST                                     04466454
044665       FOR FETCH ONLY                                             04466554
044666       WITH UR                                                    04466654
044667     END-EXEC.                                                    04466754
044668                                                                  04466854
044669******************************************************************04466954
044670*  CURSOR FOR SPECIFIC PIX INFO - FOR DATE RANGE/QUEUE - ALL DC'S 04467054
044671*  PIX_TRAN_TYPE, PIX_CODE  (NO PIX_ACTN)                         04467154
044672******************************************************************04467254
044673     EXEC SQL                                                     04467354
044674       DECLARE PIX_TYP_CDE_ALL_DC_CSR   CURSOR FOR                04467454
044675       SELECT A.TRAN_TYPE                                         04467554
044676            , A.TRAN_CODE                                         04467654
044677            , A.TRAN_NBR                                          04467754
044678            , A.PIX_SEQ_NBR                                       04467854
044679            , A.PROC_STAT_CODE                                    04467954
044680            , A.WHSE                                              04468054
044681            , A.CO                                                04468154
044682            , A.DIV                                               04468254
044683            , A.CASE_NBR                                          04468354
044684            , A.SKU_ID                                            04468454
044685            , A.SEASON                                            04468554
044686            , A.SEASON_YR                                         04468654
044687            , A.STYLE                                             04468754
044688            , A.STYLE_SFX                                         04468854
044689            , A.COLOR                                             04468954
044690            , A.COLOR_SFX                                         04469054
044691            , A.SEC_DIM                                           04469154
044692            , A.QUAL                                              04469254
044693            , A.SIZE_DESC                                         04469354
044694            , A.SIZE_RANGE_CODE                                   04469454
044695            , A.SIZE_POSN_IN_TBL                                  04469554
044696            , A.INVN_TYPE                                         04469654
044697            , A.PROD_STAT                                         04469754
044698            , A.BATCH_NBR                                         04469854
044699            , A.SKU_ATTR_1                                        04469954
044700            , A.SKU_ATTR_2                                        04470054
044701            , A.SKU_ATTR_3                                        04470154
044702            , A.SKU_ATTR_4                                        04470254
044703            , A.SKU_ATTR_5                                        04470354
044704            , A.CNTRY_OF_ORGN                                     04470454
044705            , A.INVN_ADJMT_QTY                                    04470554
044706            , A.INVN_ADJMT_TYPE                                   04470654
044707            , A.WT_ADJMT_QTY                                      04470754
044708            , A.WT_ADJMT_TYPE                                     04470854
044709            , A.UOM                                               04470954
044710            , A.REF_WHSE                                          04471054
044711            , A.RSN_CODE                                          04471154
044712            , A.RCPT_VARI                                         04471254
044713            , A.RCPT_CMPL                                         04471354
044714            , A.CASES_SHPD                                        04471454
044715            , A.UNITS_SHPD                                        04471554
044716            , A.CASES_RCVD                                        04471654
044717            , A.UNITS_RCVD                                        04471754
044718            , A.ACTN_CODE                                         04471854
044719            , A.CUSTOM_REF                                        04471954
044720            , A.DATE_PROC                                         04472054
044721            , A.SYS_USER_ID                                       04472154
044722            , A.ERROR_CMNT                                        04472254
044723            , A.REF_CODE_ID_1                                     04472354
044724            , A.REF_FIELD_1                                       04472454
044725            , A.REF_CODE_ID_2                                     04472554
044726            , A.REF_FIELD_2                                       04472654
044727            , A.REF_CODE_ID_3                                     04472754
044728            , A.REF_FIELD_3                                       04472854
044729            , A.REF_CODE_ID_4                                     04472954
044730            , A.REF_FIELD_4                                       04473054
044731            , A.REF_CODE_ID_5                                     04473154
044732            , A.REF_FIELD_5                                       04473254
044733            , A.REF_CODE_ID_6                                     04473354
044734            , A.REF_FIELD_6                                       04473454
044735            , A.REF_CODE_ID_7                                     04473554
044736            , A.REF_FIELD_7                                       04473654
044737            , A.REF_CODE_ID_8                                     04473754
044738            , A.REF_FIELD_8                                       04473854
044739            , A.REF_CODE_ID_9                                     04473954
044740            , A.REF_FIELD_9                                       04474054
044741            , A.REF_CODE_ID_10                                    04474154
044742            , A.REF_FIELD_10                                      04474254
044743            , A.XML_GROUP_ID                                      04474354
044744            , A.CREATE_DATE_TIME                                  04474454
044745            , A.MOD_DATE_TIME                                     04474554
044746            , A.USER_ID                                           04474654
044747            , A.K_DC_NBR                                          04474754
044748            , A.K_ISRT_TMST                                       04474854
044749            , B.PIX_QUE                                           04474954
044750       FROM                                                       04475054
044751              WST_PIX_TRAN_HIST A                                 04475154
044752             ,WSV_PIX_RTE       B                                 04475254
044753            WHERE  A.TRAN_TYPE         = B.PIX_TYP                04475354
044754               AND A.TRAN_CODE         = B.PIX_CDE                04475454
044755               AND (A.ACTN_CODE        = B.PIX_ACTN_CDE OR        04475554
044756                   (A.ACTN_CODE        = '  ' AND                 04475654
044757                    B.PIX_ACTN_CDE     IS NULL))                  04475754
044758               AND B.INTGRTN_TYP_CDE   = 'PIXRTEBRKR'             04475854
044759               AND B.ACTV_IND          = 'Y'                      04475954
044760               AND DATE(B.EFF_BEG_DTE) <= CURRENT DATE            04476054
044761               AND DATE(B.EFF_END_DTE) >= CURRENT DATE            04476154
044762               AND A.TRAN_TYPE          = :WS044-PIX-TYP          04476254
044763               AND A.TRAN_CODE          = :WS044-PIX-CDE          04476354
044764               AND A.ACTN_CODE          = :WS044-PIX-ACTN-CDE     04476454
044765               AND B.PIX_QUE            = :WS044-QUEUE            04476554
044766               AND A.K_ISRT_TMST       >= :WS044-FROM-TMST        04476654
044767               AND A.K_ISRT_TMST       <= :WS044-TO-TMST          04476754
044769       ORDER BY A.K_ISRT_TMST                                     04476954
044770       FOR FETCH ONLY                                             04477054
044771       WITH UR                                                    04477154
044772     END-EXEC.                                                    04477254
044773                                                                  04477354
044774******************************************************************04477454
044775*  CURSOR FOR SPECIFIC PIX INFO - FOR DATE RANGE/QUEUE - ALL DC'S 04477554
044776*  PIX_TRAN_TYPE (NO PIX_CODE)  (NO PIX_ACTN)                     04477654
044777******************************************************************04477754
044778     EXEC SQL                                                     04477854
044779       DECLARE PIX_TYP_ALL_DC_CSR CURSOR FOR                      04477954
044780       SELECT A.TRAN_TYPE                                         04478054
044781            , A.TRAN_CODE                                         04478154
044782            , A.TRAN_NBR                                          04478254
044783            , A.PIX_SEQ_NBR                                       04478354
044784            , A.PROC_STAT_CODE                                    04478454
044785            , A.WHSE                                              04478554
044786            , A.CO                                                04478654
044787            , A.DIV                                               04478754
044788            , A.CASE_NBR                                          04478854
044789            , A.SKU_ID                                            04478954
044790            , A.SEASON                                            04479054
044791            , A.SEASON_YR                                         04479154
044792            , A.STYLE                                             04479254
044793            , A.STYLE_SFX                                         04479354
044794            , A.COLOR                                             04479454
044795            , A.COLOR_SFX                                         04479554
044796            , A.SEC_DIM                                           04479654
044797            , A.QUAL                                              04479754
044798            , A.SIZE_DESC                                         04479854
044799            , A.SIZE_RANGE_CODE                                   04479954
044800            , A.SIZE_POSN_IN_TBL                                  04480054
044801            , A.INVN_TYPE                                         04480154
044802            , A.PROD_STAT                                         04480254
044803            , A.BATCH_NBR                                         04480354
044804            , A.SKU_ATTR_1                                        04480454
044805            , A.SKU_ATTR_2                                        04480554
044806            , A.SKU_ATTR_3                                        04480654
044807            , A.SKU_ATTR_4                                        04480754
044808            , A.SKU_ATTR_5                                        04480854
044809            , A.CNTRY_OF_ORGN                                     04480954
044810            , A.INVN_ADJMT_QTY                                    04481054
044811            , A.INVN_ADJMT_TYPE                                   04481154
044812            , A.WT_ADJMT_QTY                                      04481254
044813            , A.WT_ADJMT_TYPE                                     04481354
044814            , A.UOM                                               04481454
044815            , A.REF_WHSE                                          04481554
044816            , A.RSN_CODE                                          04481654
044817            , A.RCPT_VARI                                         04481754
044818            , A.RCPT_CMPL                                         04481854
044819            , A.CASES_SHPD                                        04481954
044820            , A.UNITS_SHPD                                        04482054
044821            , A.CASES_RCVD                                        04482154
044822            , A.UNITS_RCVD                                        04482254
044823            , A.ACTN_CODE                                         04482354
044824            , A.CUSTOM_REF                                        04482454
044825            , A.DATE_PROC                                         04482554
044826            , A.SYS_USER_ID                                       04482654
044827            , A.ERROR_CMNT                                        04482754
044828            , A.REF_CODE_ID_1                                     04482854
044829            , A.REF_FIELD_1                                       04482954
044830            , A.REF_CODE_ID_2                                     04483054
044831            , A.REF_FIELD_2                                       04483154
044832            , A.REF_CODE_ID_3                                     04483254
044833            , A.REF_FIELD_3                                       04483354
044834            , A.REF_CODE_ID_4                                     04483454
044835            , A.REF_FIELD_4                                       04483554
044836            , A.REF_CODE_ID_5                                     04483654
044837            , A.REF_FIELD_5                                       04483754
044838            , A.REF_CODE_ID_6                                     04483854
044839            , A.REF_FIELD_6                                       04483954
044840            , A.REF_CODE_ID_7                                     04484054
044841            , A.REF_FIELD_7                                       04484154
044842            , A.REF_CODE_ID_8                                     04484254
044843            , A.REF_FIELD_8                                       04484354
044844            , A.REF_CODE_ID_9                                     04484454
044845            , A.REF_FIELD_9                                       04484554
044846            , A.REF_CODE_ID_10                                    04484654
044847            , A.REF_FIELD_10                                      04484754
044848            , A.XML_GROUP_ID                                      04484854
044849            , A.CREATE_DATE_TIME                                  04484954
044850            , A.MOD_DATE_TIME                                     04485054
044851            , A.USER_ID                                           04485154
044852            , A.K_DC_NBR                                          04485254
044853            , A.K_ISRT_TMST                                       04485354
044854            , B.PIX_QUE                                           04485454
044855       FROM                                                       04485554
044856              WST_PIX_TRAN_HIST A                                 04485654
044857             ,WSV_PIX_RTE       B                                 04485754
044858            WHERE  A.TRAN_TYPE         = B.PIX_TYP                04485854
044859               AND A.TRAN_CODE         = B.PIX_CDE                04485954
044860               AND (A.ACTN_CODE        = B.PIX_ACTN_CDE OR        04486054
044861                   (A.ACTN_CODE        = '  ' AND                 04486154
044862                    B.PIX_ACTN_CDE     IS NULL))                  04486254
044863               AND B.INTGRTN_TYP_CDE   = 'PIXRTEBRKR'             04486354
044864               AND B.ACTV_IND          = 'Y'                      04486454
044865               AND DATE(B.EFF_BEG_DTE) <= CURRENT DATE            04486554
044866               AND DATE(B.EFF_END_DTE) >= CURRENT DATE            04486654
044867               AND A.TRAN_TYPE          = :WS044-PIX-TYP          04486754
044868               AND A.TRAN_CODE          = :WS044-PIX-CDE          04486854
044869               AND A.ACTN_CODE          = :WS044-PIX-ACTN-CDE     04486954
044870               AND B.PIX_QUE            = :WS044-QUEUE            04487054
044871               AND A.K_ISRT_TMST       >= :WS044-FROM-TMST        04487154
044872               AND A.K_ISRT_TMST       <= :WS044-TO-TMST          04487254
044874       ORDER BY A.K_ISRT_TMST                                     04487454
044875       FOR FETCH ONLY                                             04487554
044876       WITH UR                                                    04487654
044877     END-EXEC.                                                    04487754
044878* JAK 05/2010 - END                                               04487854
044879                                                                  04487954
044880******************************************************************04488054
044881 PROCEDURE DIVISION.                                              04488154
044882******************************************************************04488254
044890 0000-PROGRAM-MAINLINE.                                           04489003
044900     DISPLAY '**** START OF WSKUT032 ****'.                       04490003
045000                                                                  04500003
045100     PERFORM 1000-INITIALIZATION.                                 04510003
045200                                                                  04520003
045300     IF PS-END-OF-INPUT-YES                                       04530003
045400        DISPLAY '                                 '               04540003
045500        DISPLAY '*********************************'               04550003
045600        DISPLAY 'NO DATA FOUND IN INPUT FILE INP01'               04560003
045700        DISPLAY '*********************************'               04570003
045800     ELSE                                                         04580003
045900        PERFORM 2000-PROCESS-TRANSACTION                          04590003
046000          UNTIL PS-END-OF-INPUT-YES                               04600003
046100     END-IF.                                                      04610003
046200                                                                  04620003
046300     PERFORM 9000-WRAPUP.                                         04630003
046400                                                                  04640003
046500     STOP RUN.                                                    04650003
046600                                                                  04660003
046700***************************************************************** 04670003
046800* INITIALIZATION                                                  04680003
046900*     OPENS FILES                                                 04690003
047000*     INITIALIZES VARIABLES                                       04700003
047100*     PROCESSES PARMS                                             04710003
047200***************************************************************** 04720003
047300 1000-INITIALIZATION.                                             04730003
047400                                                                  04740003
047500     OPEN INPUT  PIX-FILE-IN                                      04750003
047600          OUTPUT PIX-FILE-OUT.                                    04760003
048100                                                                  04810003
048200     SET PS-END-OF-INPUT-NO    TO TRUE.                           04820003
048600                                                                  04860003
048700     INITIALIZE WS044-EXTRACT-REC                                 04870003
048800                WS045-PIX-REP-REC                                 04880003
048900                PV-TOTAL-RECORDS-IN                               04890034
049000                PV-TOTAL-RECORDS-OUT                              04900034
049100                PV-ALL-PIX-TOTALS-READ                            04910034
049200                PV-ALL-PIX-TOTALS-WRITTEN                         04920034
049300                PV-PIX-TYP-ACTN-TOTALS-READ                       04930034
049400                PV-PIX-TYP-ACTN-TOTALS-WRITTEN                    04940034
049500                PV-PIX-TYP-TOTALS-READ                            04950034
049600                PV-PIX-TYP-TOTALS-WRITTEN                         04960034
049610                PV-PIX-TOTALS-READ                                04961034
049620                PV-PIX-TOTALS-WRITTEN.                            04962034
049700                                                                  04970003
049800     PERFORM 1050-READ-PIX-FILE-IN                                04980035
049810       UNTIL PS-END-OF-INPUT-YES                                  04981027
049820          OR PS-GOOD-INPUT-RECORD-YES.                            04982040
049821                                                                  04982128
049830***************************************************************** 04983028
049840* READ INPUT FILE                                                 04984028
049850***************************************************************** 04985028
049860 1050-READ-PIX-FILE-IN.                                           04986028
049870     DISPLAY 'WSKUT032 - 1050-READ-PIX-FILE-IN         '.         04987028
049880                                                                  04988028
049890     SET   PS-GOOD-INPUT-RECORD-NO                                04989039
049891           PS-NO-CSR             TO  TRUE.                        04989128
049892                                                                  04989228
049893     READ PIX-FILE-IN                                             04989328
049894        INTO WS044-EXTRACT-REC                                    04989428
049895        AT END                                                    04989528
049896            SET PS-END-OF-INPUT-YES TO TRUE                       04989628
049897     END-READ.                                                    04989728
049898     DISPLAY ' CONTROL CARD: ' WS044-EXTRACT-REC                  04989828
049899     ADD +1 TO PV-TOTAL-RECORDS-IN.                               04989936
049900                                                                  04990028
049901     EVALUATE TRUE                                                04990143
049910         WHEN WS044-FROM-TMST NOT > SPACES  OR                    04991043
049920              WS044-TO-TMST   NOT > SPACES  OR                    04992044
049930              WS044-PIX-TYP   NOT > SPACES  OR                    04993043
049940              WS044-QUEUE     NOT > SPACES  OR                    04994043
049950              WS044-DC-NBR    NOT > SPACES                        04995043
049960              SET PS-GOOD-INPUT-RECORD-NO  TO  TRUE               04996043
049970              DISPLAY ' MISSING REQUIRED FIELD: '                 04997043
049971                                             WS044-EXTRACT-REC    04997143
049972              DISPLAY ' CURSOR NO'                                04997243
049973              DISPLAY                                             04997346
049974             '************************************************'   04997446
049979* JAK 05/2010 - CHECK FOR ALL DC CURSORS                          04997954
049980         WHEN WS044-FROM-TMST  >  SPACES  AND                     04998054
049981              WS044-TO-TMST    >  SPACES  AND                     04998154
049982              WS044-QUEUE      >  SPACES  AND                     04998254
049983              WS044-DC-NBR     =  'ALL'   AND                     04998354
049984              WS044-PIX-TYP    =  'ALL'                           04998454
049986              SET  PS-ALL-PIX-ALL-DC         TO  TRUE             04998654
049987              SET  PS-GOOD-INPUT-RECORD-YES  TO  TRUE             04998754
049988              DISPLAY ' CURSOR ALL PIX - ALL DC'                  04998854
049989                                                                  04998954
049993         WHEN WS044-FROM-TMST     >  SPACES  AND                  04999354
049994              WS044-TO-TMST       >  SPACES  AND                  04999454
049995              WS044-QUEUE         >  SPACES  AND                  04999554
049996              WS044-DC-NBR        >  'ALL'   AND                  04999654
049997              WS044-PIX-TYP       >  SPACES  AND                  04999754
049998              WS044-PIX-CDE       >  SPACES  AND                  04999854
049999              WS044-PIX-ACTN-CDE  >  SPACES                       04999954
050001              SET  PS-PIX-TYP-CDE-ACTN-ALL-DC TO  TRUE            05000154
050002              SET  PS-GOOD-INPUT-RECORD-YES  TO  TRUE             05000254
050003              DISPLAY ' CURSOR PIX TYP-CDE-ACTN - ALL DC'         05000354
050004                                                                  05000454
050007         WHEN WS044-FROM-TMST  >  SPACES  AND                     05000754
050008              WS044-TO-TMST    >  SPACES  AND                     05000854
050009              WS044-QUEUE      >  SPACES  AND                     05000954
050010              WS044-DC-NBR     =  'ALL'   AND                     05001054
050011              WS044-PIX-TYP    >  SPACES  AND                     05001154
050012              WS044-PIX-CDE    >  SPACES                          05001254
050014              SET  PS-PIX-TYP-CDE-ALL-DC     TO  TRUE             05001454
050015              SET  PS-GOOD-INPUT-RECORD-YES  TO  TRUE             05001554
050016              DISPLAY ' CURSOR PIX TYP-CDE - ALL DC'              05001654
050017                                                                  05001754
050019         WHEN WS044-FROM-TMST  >  SPACES  AND                     05001954
050020              WS044-TO-TMST    >  SPACES  AND                     05002054
050021              WS044-QUEUE      >  SPACES  AND                     05002154
050022              WS044-DC-NBR     =  'ALL'   AND                     05002254
050023              WS044-PIX-TYP    >  SPACES                          05002354
050025              SET  PS-PIX-TYP-ALL-DC         TO  TRUE             05002554
050026              SET  PS-GOOD-INPUT-RECORD-YES  TO  TRUE             05002654
050027              DISPLAY ' CURSOR PIX TYP - ALL DC'                  05002754
050028* JAK 05/2010 - END                                               05002854
050033                                                                  05003354
050034         WHEN WS044-FROM-TMST  >  SPACES  AND                     05003454
050035              WS044-TO-TMST    >  SPACES  AND                     05003554
050036              WS044-QUEUE      >  SPACES  AND                     05003654
050037              WS044-DC-NBR     >  SPACES  AND                     05003754
050038              WS044-PIX-TYP    =  'ALL'                           05003854
050039              MOVE  WS044-DC-NBR   TO  DK-DC-NBR                  05003954
050040              SET  PS-ALL-PIX-CSR            TO  TRUE             05004054
050041              SET  PS-GOOD-INPUT-RECORD-YES  TO  TRUE             05004154
050042              DISPLAY ' CURSOR ALL PIX '                          05004254
050043                                                                  05004354
050044         WHEN WS044-FROM-TMST     >  SPACES  AND                  05004454
050045              WS044-TO-TMST       >  SPACES  AND                  05004554
050046              WS044-QUEUE         >  SPACES  AND                  05004654
050047              WS044-DC-NBR        >  SPACES  AND                  05004754
050048              WS044-PIX-TYP       >  SPACES  AND                  05004854
050049              WS044-PIX-CDE       >  SPACES  AND                  05004954
050050              WS044-PIX-ACTN-CDE  >  SPACES                       05005054
050051              MOVE  WS044-DC-NBR             TO  DK-DC-NBR        05005154
050052              SET  PS-PIX-TYP-CDE-ACTN-CSR   TO  TRUE             05005254
050053              SET  PS-GOOD-INPUT-RECORD-YES  TO  TRUE             05005354
050054              DISPLAY ' CURSOR PIX TYP-CDE-ACTN'                  05005454
050055                                                                  05005543
050060         WHEN WS044-FROM-TMST  >  SPACES  AND                     05006043
050070              WS044-TO-TMST    >  SPACES  AND                     05007043
050080              WS044-QUEUE      >  SPACES  AND                     05008043
050090              WS044-DC-NBR     >  SPACES  AND                     05009043
050091              WS044-PIX-TYP    >  SPACES  AND                     05009143
050092              WS044-PIX-CDE    >  SPACES                          05009243
050093              MOVE  WS044-DC-NBR             TO  DK-DC-NBR        05009343
050094              SET  PS-PIX-TYP-CDE-CSR        TO  TRUE             05009443
050095              SET  PS-GOOD-INPUT-RECORD-YES  TO  TRUE             05009543
050096              DISPLAY ' CURSOR PIX TYP-CDE'                       05009643
050097                                                                  05009743
050098         WHEN WS044-FROM-TMST  >  SPACES  AND                     05009843
050099              WS044-TO-TMST    >  SPACES  AND                     05009943
050100              WS044-QUEUE      >  SPACES  AND                     05010043
050101              WS044-DC-NBR     >  SPACES  AND                     05010143
050102              WS044-PIX-TYP    >  SPACES                          05010243
050103              MOVE  WS044-DC-NBR             TO  DK-DC-NBR        05010343
050104              SET  PS-PIX-TYP-CSR            TO  TRUE             05010443
050105              SET  PS-GOOD-INPUT-RECORD-YES  TO  TRUE             05010543
050106              DISPLAY ' CURSOR PIX TYP '                          05010643
050110     END-EVALUATE.                                                05011043
050200                                                                  05020003
053000***************************************************************** 05300003
053100* RE-FORMAT AND MOVE TRANSACTIONS.                                05310003
053200***************************************************************** 05320003
053300 2000-PROCESS-TRANSACTION.                                        05330003
053400***  DISPLAY 'WSKUT032 - 2000-PROCESS-TRANSACTION      '.         05340046
053500                                                                  05350015
053505     EVALUATE TRUE                                                05350528
053506         WHEN  PS-ALL-PIX-CSR                                     05350628
053507               PERFORM 3100-OPEN-ALL-PIX-CSR                      05350728
053508               PERFORM 3110-FETCH-ALL-PIX-INFO                    05350828
053509                 UNTIL PS-EOF-CSR-YES                             05350928
053510               PERFORM 3120-CLOSE-ALL-PIX-CSR                     05351028
053511                                                                  05351128
053512         WHEN  PS-PIX-TYP-CDE-ACTN-CSR                            05351228
053513               PERFORM 3200-OPEN-PIX-TYP-ACTN-CSR                 05351328
053514               PERFORM 3210-FETCH-PIX-TYP-ACTN-INFO               05351428
053515                 UNTIL PS-EOF-CSR-YES                             05351528
053516               PERFORM 3220-CLOSE-PIX-TYP-ACTN-CSR                05351628
053517                                                                  05351728
053518         WHEN  PS-PIX-TYP-CDE-CSR                                 05351828
053519               PERFORM 3300-OPEN-PIX-TYP-CSR                      05351928
053520               PERFORM 3310-FETCH-PIX-TYP-INFO                    05352028
053521                 UNTIL PS-EOF-CSR-YES                             05352128
053522               PERFORM 3320-CLOSE-PIX-TYP-CSR                     05352228
053523                                                                  05352328
053524         WHEN  PS-PIX-TYP-CSR                                     05352428
053525               PERFORM 3400-OPEN-PIX-CSR                          05352528
053526               PERFORM 3410-FETCH-PIX-INFO                        05352628
053527                 UNTIL PS-EOF-CSR-YES                             05352728
053528               PERFORM 3420-CLOSE-PIX-CSR                         05352828
053529                                                                  05352928
053530* JAK 05/2010 - ADD PROCESSING FOR ALL DC CURSORS                 05353054
053535         WHEN  PS-ALL-PIX-ALL-DC                                  05353554
053536               PERFORM 3500-OPEN-ALL-PIX-ALL-DC                   05353654
053537               PERFORM 3510-FETCH-ALL-PIX-ALL-DC                  05353754
053538                 UNTIL PS-EOF-CSR-YES                             05353854
053539               PERFORM 3520-CLOSE-ALL-PIX-ALL-DC                  05353954
053540                                                                  05354054
053541         WHEN  PS-PIX-TYP-CDE-ACTN-ALL-DC                         05354154
053542               PERFORM 3600-OPEN-PIX-TYP-ACTN-ALL-DC              05354254
053543               PERFORM 3610-FETCH-PIX-TYP-ACTN-ALL-DC             05354354
053544                 UNTIL PS-EOF-CSR-YES                             05354454
053545               PERFORM 3620-CLOSE-PIX-TYP-ACTN-ALL-DC             05354554
053546                                                                  05354654
053547         WHEN  PS-PIX-TYP-CDE-ALL-DC                              05354754
053548               PERFORM 3700-OPEN-PIX-TYP-ALL-DC                   05354854
053549               PERFORM 3710-FETCH-PIX-TYP-ALL-DC                  05354954
053550                 UNTIL PS-EOF-CSR-YES                             05355054
053551               PERFORM 3720-CLOSE-PIX-TYP-ALL-DC                  05355154
053552                                                                  05355254
053553         WHEN  PS-PIX-TYP-ALL-DC                                  05355354
053554               PERFORM 3800-OPEN-PIX-ALL-DC                       05355454
053555               PERFORM 3810-FETCH-PIX-ALL-DC                      05355554
053556                 UNTIL PS-EOF-CSR-YES                             05355654
053557               PERFORM 3820-CLOSE-PIX-ALL-DC                      05355754
053558* JAK 05/2010 - END                                               05355854
053559                                                                  05355954
053560     END-EVALUATE.                                                05356054
053561                                                                  05356154
053562     SET PS-GOOD-INPUT-RECORD-NO  TO  TRUE.                       05356254
053563                                                                  05356354
053570                                                                  05357028
053700     IF PS-EOF-CSR-YES                                            05370027
054000           PERFORM 1050-READ-PIX-FILE-IN                          05400037
054010              UNTIL PS-END-OF-INPUT-YES                           05401037
054020                 OR PS-GOOD-INPUT-RECORD-YES                      05402039
054100     END-IF.                                                      05410008
054200                                                                  05420003
062400******************************************************************06240003
062500*   OPEN ALL PIX CURSOR                                           06250003
062600******************************************************************06260003
062700 3100-OPEN-ALL-PIX-CSR.                                           06270003
062800***  DISPLAY 'WSKUT032 - 3100-OPEN-ALL-PIX-CSR     '.             06280046
062900                                                                  06290003
063000     SET PS-EOF-CSR-NO        TO TRUE.                            06300028
063100     EXEC SQL                                                     06310003
063200         OPEN ALL_PIX_CSR                                         06320003
063300     END-EXEC.                                                    06330003
063400                                                                  06340003
063500     EVALUATE SQLCODE                                             06350003
063600         WHEN 0                                                   06360003
063700             CONTINUE                                             06370003
063710                                                                  06371028
063800         WHEN OTHER                                               06380003
063801             MOVE '3100-OPEN-ALL-PIX-CSR'                         06380128
063802                            TO  PV-PARAGRAPH-NME                  06380228
063803             MOVE  SQLCODE  TO  PV-DISP-SQLCODE                   06380328
063900             PERFORM 9998-SQL-ERROR                               06390003
064000     END-EVALUATE.                                                06400003
064100                                                                  06410003
064200******************************************************************06420003
064300*   FETCH ALL PIX INFORMATION.                                    06430003
064400******************************************************************06440003
064500 3110-FETCH-ALL-PIX-INFO.                                         06450028
064600***  DISPLAY 'WSKUT032 - 3110-FETCH-ALL-PIX-INFO     '.           06460046
064700                                                                  06470003
064800       EXEC SQL                                                   06480003
064900       FETCH ALL_PIX_CSR                                          06490003
065000         INTO :WST00000-TRAN-TYPE                                 06500004
065100             ,:WST00000-TRAN-CODE                                 06510004
065200             ,:WST00000-TRAN-NBR                                  06520004
065300             ,:WST00000-PIX-SEQ-NBR                               06530004
065400             ,:WST00000-PROC-STAT-CODE                            06540004
065500             ,:WST00000-WHSE                                      06550004
065600             ,:WST00000-CO                                        06560004
065700             ,:WST00000-DIV                                       06570004
065800             ,:WST00000-CASE-NBR                                  06580004
065900             ,:WST00000-SKU-ID                                    06590004
066000             ,:WST00000-SEASON                                    06600004
066100             ,:WST00000-SEASON-YR                                 06610004
066200             ,:WST00000-STYLE                                     06620004
066300             ,:WST00000-STYLE-SFX                                 06630004
066400             ,:WST00000-COLOR                                     06640004
066500             ,:WST00000-COLOR-SFX                                 06650004
066600             ,:WST00000-SEC-DIM                                   06660004
066700             ,:WST00000-QUAL                                      06670004
066800             ,:WST00000-SIZE-DESC                                 06680004
066900             ,:WST00000-SIZE-RANGE-CODE                           06690004
067000             ,:WST00000-SIZE-POSN-IN-TBL                          06700004
067100             ,:WST00000-INVN-TYPE                                 06710004
067200             ,:WST00000-PROD-STAT                                 06720004
067300             ,:WST00000-BATCH-NBR                                 06730004
067400             ,:WST00000-SKU-ATTR-1                                06740004
067500             ,:WST00000-SKU-ATTR-2                                06750004
067600             ,:WST00000-SKU-ATTR-3                                06760004
067700             ,:WST00000-SKU-ATTR-4                                06770004
067800             ,:WST00000-SKU-ATTR-5                                06780004
067900             ,:WST00000-CNTRY-OF-ORGN                             06790004
068000             ,:WST00000-INVN-ADJMT-QTY                            06800004
068100             ,:WST00000-INVN-ADJMT-TYPE                           06810004
068200             ,:WST00000-WT-ADJMT-QTY                              06820004
068300             ,:WST00000-WT-ADJMT-TYPE                             06830004
068400             ,:WST00000-UOM                                       06840004
068500             ,:WST00000-REF-WHSE                                  06850004
068600             ,:WST00000-RSN-CODE                                  06860004
068700             ,:WST00000-RCPT-VARI                                 06870004
068800             ,:WST00000-RCPT-CMPL                                 06880004
068900             ,:WST00000-CASES-SHPD                                06890004
069000             ,:WST00000-UNITS-SHPD                                06900004
069100             ,:WST00000-CASES-RCVD                                06910004
069200             ,:WST00000-UNITS-RCVD                                06920004
069300             ,:WST00000-ACTN-CODE                                 06930004
069400             ,:WST00000-CUSTOM-REF                                06940004
069500             ,:WST00000-DATE-PROC                                 06950004
069600             ,:WST00000-SYS-USER-ID                               06960004
069700             ,:WST00000-ERROR-CMNT                                06970004
069800             ,:WST00000-REF-CODE-ID-1                             06980004
069900             ,:WST00000-REF-FIELD-1                               06990004
070000             ,:WST00000-REF-CODE-ID-2                             07000004
070100             ,:WST00000-REF-FIELD-2                               07010004
070200             ,:WST00000-REF-CODE-ID-3                             07020004
070300             ,:WST00000-REF-FIELD-3                               07030004
070400             ,:WST00000-REF-CODE-ID-4                             07040004
070500             ,:WST00000-REF-FIELD-4                               07050004
070600             ,:WST00000-REF-CODE-ID-5                             07060004
070700             ,:WST00000-REF-FIELD-5                               07070004
070800             ,:WST00000-REF-CODE-ID-6                             07080004
070900             ,:WST00000-REF-FIELD-6                               07090004
071000             ,:WST00000-REF-CODE-ID-7                             07100004
071100             ,:WST00000-REF-FIELD-7                               07110004
071200             ,:WST00000-REF-CODE-ID-8                             07120004
071300             ,:WST00000-REF-FIELD-8                               07130004
071400             ,:WST00000-REF-CODE-ID-9                             07140004
071500             ,:WST00000-REF-FIELD-9                               07150004
071600             ,:WST00000-REF-CODE-ID-10                            07160004
071700             ,:WST00000-REF-FIELD-10                              07170004
071800             ,:WST00000-XML-GROUP-ID                              07180004
071900             ,:WST00000-CREATE-DATE-TIME                          07190004
072000             ,:WST00000-MOD-DATE-TIME                             07200004
072100             ,:WST00000-USER-ID                                   07210004
072200             ,:WST00000-K-DC-NBR                                  07220004
072300             ,:WST00000-K-ISRT-TMST                               07230004
072400             ,:WSV00002-PIX-QUE                                   07240021
072500       END-EXEC                                                   07250004
072600                                                                  07260004
072700       EVALUATE TRUE                                              07270004
072800          WHEN SQLCODE = +0                                       07280004
072900             ADD +1 TO PV-ALL-PIX-TOTALS-READ                     07290028
073000             PERFORM 4000-POPULATE-OUTPUT-RECORD                  07300008
073100             ADD +1 TO PV-ALL-PIX-TOTALS-WRITTEN                  07310028
073200             PERFORM 4200-WRITE-PIX-RECORD-OUT                    07320007
073210                                                                  07321028
073300          WHEN SQLCODE = +100                                     07330004
073400             SET PS-EOF-CSR-YES TO TRUE                           07340028
073500             PERFORM 5000-WRITE-PIX-CSR-TOTALS                    07350009
073600             INITIALIZE PV-ALL-PIX-TOTALS-READ                    07360037
073700             INITIALIZE PV-ALL-PIX-TOTALS-WRITTEN                 07370037
073710                                                                  07371028
073800          WHEN SQLCODE = -911                                     07380004
073900          WHEN SQLCODE = -913                                     07390004
074000             CONTINUE                                             07400004
074010                                                                  07401028
074100          WHEN OTHER                                              07410004
074110             MOVE '3110-FETCH-ALL-PIX-INFO'                       07411028
074120                            TO  PV-PARAGRAPH-NME                  07412028
074130             MOVE  SQLCODE  TO  PV-DISP-SQLCODE                   07413028
074200             PERFORM 9998-SQL-ERROR                               07420004
074300       END-EVALUATE.                                              07430004
074400                                                                  07440004
074500     IF  (SQLWARN0 NOT = SPACES  OR                               07450028
074600          (SQLCODE > 0 AND SQLCODE NOT = +100)  OR                07460028
074700          SQLCODE < 0)                                            07470028
074701                                                                  07470128
074710         MOVE '3110-FETCH-ALL-PIX-INFO'                           07471028
074720                        TO  PV-PARAGRAPH-NME                      07472028
074730         MOVE  SQLCODE  TO  PV-DISP-SQLCODE                       07473028
074800         PERFORM 9998-SQL-ERROR                                   07480004
074900     END-IF.                                                      07490004
075000                                                                  07500004
075100******************************************************************07510004
075200*   CLOSE ALL PIX CURSOR.                                         07520004
075300******************************************************************07530004
075400 3120-CLOSE-ALL-PIX-CSR.                                          07540037
075500***  DISPLAY 'WSKUT032 - 3120-CLOSE-ALL-PIX-CSR      '.           07550046
075600                                                                  07560004
075700         EXEC SQL                                                 07570004
075800             CLOSE ALL_PIX_CSR                                    07580004
075900         END-EXEC.                                                07590004
076000                                                                  07600004
076100         EVALUATE SQLCODE                                         07610004
076200             WHEN 0                                               07620004
076300                 CONTINUE                                         07630004
076310                                                                  07631028
076400             WHEN OTHER                                           07640004
076410                  MOVE '3130-CLOSE-ALL-PIX-CSR'                   07641028
076420                                 TO  PV-PARAGRAPH-NME             07642028
076430                  MOVE  SQLCODE  TO  PV-DISP-SQLCODE              07643028
076500                  PERFORM 9998-SQL-ERROR                          07650028
076600         END-EVALUATE.                                            07660004
076700                                                                  07670004
076800******************************************************************07680004
076900*   OPEN SPECIFIC PIX CURSOR                                      07690015
077000******************************************************************07700004
077100 3200-OPEN-PIX-TYP-ACTN-CSR.                                      07710028
077200***  DISPLAY 'WSKUT032 - 3200-OPEN-PIX-TYP-ACTN-CSR'.             07720046
077300                                                                  07730004
077400     SET PS-EOF-CSR-NO        TO TRUE.                            07740028
077500     EXEC SQL                                                     07750004
077600         OPEN PIX_TYP_CDE_AC_CSR                                  07760030
077700     END-EXEC.                                                    07770004
077800                                                                  07780004
077900     EVALUATE SQLCODE                                             07790004
078000         WHEN 0                                                   07800004
078100             CONTINUE                                             07810004
078110                                                                  07811028
078200         WHEN OTHER                                               07820004
078210              MOVE '3200-OPEN-PIX-TYP-ACTN-CSR'                   07821028
078220                                 TO  PV-PARAGRAPH-NME             07822028
078230                  MOVE  SQLCODE  TO  PV-DISP-SQLCODE              07823028
078300             PERFORM 9998-SQL-ERROR                               07830004
078400     END-EVALUATE.                                                07840004
078500                                                                  07850004
078600******************************************************************07860004
078700*   FETCH SPECIFIC PIX INFORMATION.                               07870008
078800******************************************************************07880004
078900 3210-FETCH-PIX-TYP-ACTN-INFO.                                    07890028
079000***  DISPLAY 'WSKUT032 - 3210-FETCH-PIX-TYP-ACTN-INFO'.           07900046
079100                                                                  07910004
079200       EXEC SQL                                                   07920004
079300       FETCH PIX_TYP_CDE_AC_CSR                                   07930031
079400         INTO :WST00000-TRAN-TYPE                                 07940004
079500             ,:WST00000-TRAN-CODE                                 07950004
079600             ,:WST00000-TRAN-NBR                                  07960008
079700             ,:WST00000-PIX-SEQ-NBR                               07970008
079800             ,:WST00000-PROC-STAT-CODE                            07980008
079900             ,:WST00000-WHSE                                      07990008
080000             ,:WST00000-CO                                        08000008
080100             ,:WST00000-DIV                                       08010008
080200             ,:WST00000-CASE-NBR                                  08020008
080300             ,:WST00000-SKU-ID                                    08030008
080400             ,:WST00000-SEASON                                    08040008
080500             ,:WST00000-SEASON-YR                                 08050008
080600             ,:WST00000-STYLE                                     08060008
080700             ,:WST00000-STYLE-SFX                                 08070008
080800             ,:WST00000-COLOR                                     08080008
080900             ,:WST00000-COLOR-SFX                                 08090008
081000             ,:WST00000-SEC-DIM                                   08100008
081100             ,:WST00000-QUAL                                      08110008
081200             ,:WST00000-SIZE-DESC                                 08120008
081300             ,:WST00000-SIZE-RANGE-CODE                           08130008
081400             ,:WST00000-SIZE-POSN-IN-TBL                          08140008
081500             ,:WST00000-INVN-TYPE                                 08150008
081600             ,:WST00000-PROD-STAT                                 08160008
081700             ,:WST00000-BATCH-NBR                                 08170008
081800             ,:WST00000-SKU-ATTR-1                                08180008
081900             ,:WST00000-SKU-ATTR-2                                08190008
082000             ,:WST00000-SKU-ATTR-3                                08200008
082100             ,:WST00000-SKU-ATTR-4                                08210008
082200             ,:WST00000-SKU-ATTR-5                                08220008
082300             ,:WST00000-CNTRY-OF-ORGN                             08230008
082400             ,:WST00000-INVN-ADJMT-QTY                            08240008
082500             ,:WST00000-INVN-ADJMT-TYPE                           08250008
082600             ,:WST00000-WT-ADJMT-QTY                              08260008
082700             ,:WST00000-WT-ADJMT-TYPE                             08270008
082800             ,:WST00000-UOM                                       08280008
082900             ,:WST00000-REF-WHSE                                  08290008
083000             ,:WST00000-RSN-CODE                                  08300008
083100             ,:WST00000-RCPT-VARI                                 08310008
083200             ,:WST00000-RCPT-CMPL                                 08320008
083300             ,:WST00000-CASES-SHPD                                08330008
083400             ,:WST00000-UNITS-SHPD                                08340008
083500             ,:WST00000-CASES-RCVD                                08350008
083600             ,:WST00000-UNITS-RCVD                                08360008
083700             ,:WST00000-ACTN-CODE                                 08370008
083800             ,:WST00000-CUSTOM-REF                                08380008
083900             ,:WST00000-DATE-PROC                                 08390008
084000             ,:WST00000-SYS-USER-ID                               08400008
084100             ,:WST00000-ERROR-CMNT                                08410008
084200             ,:WST00000-REF-CODE-ID-1                             08420008
084300             ,:WST00000-REF-FIELD-1                               08430008
084400             ,:WST00000-REF-CODE-ID-2                             08440008
084500             ,:WST00000-REF-FIELD-2                               08450008
084600             ,:WST00000-REF-CODE-ID-3                             08460008
084700             ,:WST00000-REF-FIELD-3                               08470008
084800             ,:WST00000-REF-CODE-ID-4                             08480008
084900             ,:WST00000-REF-FIELD-4                               08490008
085000             ,:WST00000-REF-CODE-ID-5                             08500008
085100             ,:WST00000-REF-FIELD-5                               08510008
085200             ,:WST00000-REF-CODE-ID-6                             08520008
085300             ,:WST00000-REF-FIELD-6                               08530008
085400             ,:WST00000-REF-CODE-ID-7                             08540008
085500             ,:WST00000-REF-FIELD-7                               08550008
085600             ,:WST00000-REF-CODE-ID-8                             08560008
085700             ,:WST00000-REF-FIELD-8                               08570008
085800             ,:WST00000-REF-CODE-ID-9                             08580008
085900             ,:WST00000-REF-FIELD-9                               08590008
086000             ,:WST00000-REF-CODE-ID-10                            08600008
086100             ,:WST00000-REF-FIELD-10                              08610008
086200             ,:WST00000-XML-GROUP-ID                              08620008
086300             ,:WST00000-CREATE-DATE-TIME                          08630008
086400             ,:WST00000-MOD-DATE-TIME                             08640008
086500             ,:WST00000-USER-ID                                   08650008
086600             ,:WST00000-K-DC-NBR                                  08660008
086700             ,:WST00000-K-ISRT-TMST                               08670008
086800             ,:WSV00002-PIX-QUE                                   08680021
086900       END-EXEC                                                   08690004
087000                                                                  08700004
087100       EVALUATE TRUE                                              08710008
087200          WHEN SQLCODE = +0                                       08720008
087300             ADD +1 TO PV-PIX-TYP-ACTN-TOTALS-READ                08730028
087400             PERFORM 4000-POPULATE-OUTPUT-RECORD                  08740008
087500             ADD +1 TO PV-PIX-TYP-ACTN-TOTALS-WRITTEN             08750028
087600             PERFORM 4200-WRITE-PIX-RECORD-OUT                    08760008
087610                                                                  08761028
087700          WHEN SQLCODE = +100                                     08770008
087800             SET PS-EOF-CSR-YES TO TRUE                           08780028
087900             PERFORM 5000-WRITE-PIX-CSR-TOTALS                    08790009
088000             INITIALIZE PV-PIX-TYP-ACTN-TOTALS-READ               08800037
088100             INITIALIZE PV-PIX-TYP-ACTN-TOTALS-WRITTEN            08810037
088110                                                                  08811028
088200          WHEN SQLCODE = -911                                     08820008
088300          WHEN SQLCODE = -913                                     08830008
088400             CONTINUE                                             08840008
088410                                                                  08841028
088500          WHEN OTHER                                              08850008
088510               MOVE '3210-FETCH-PIX-TYP-ACTN-INFO'                08851028
088520                              TO  PV-PARAGRAPH-NME                08852028
088530               MOVE  SQLCODE  TO  PV-DISP-SQLCODE                 08853028
088600               PERFORM 9998-SQL-ERROR                             08860028
088700       END-EVALUATE.                                              08870008
088800                                                                  08880004
088900     IF  (SQLWARN0 NOT = SPACES  OR                               08890028
089000          (SQLCODE > 0 AND SQLCODE NOT = +100)  OR                08900028
089100          SQLCODE < 0)                                            08910028
089110          MOVE '3210-FETCH-PIX-TYP-ACTN-INFO'                     08911028
089120                         TO  PV-PARAGRAPH-NME                     08912028
089130          MOVE  SQLCODE  TO  PV-DISP-SQLCODE                      08913028
089200          PERFORM 9998-SQL-ERROR                                  08920028
089300     END-IF.                                                      08930004
089400                                                                  08940004
089500******************************************************************08950004
089600*   CLOSE SPECIFIC PIX CURSOR.                                    08960015
089700******************************************************************08970004
089800 3220-CLOSE-PIX-TYP-ACTN-CSR.                                     08980037
089900***  DISPLAY 'WSKUT032 - 3220-CLOSE-PIX-TYP-ACTN-CSR'.            08990046
090000                                                                  09000004
090100         EXEC SQL                                                 09010004
090200             CLOSE PIX_TYP_CDE_AC_CSR                             09020030
090300         END-EXEC.                                                09030025
090400                                                                  09040004
090500         EVALUATE SQLCODE                                         09050004
090600             WHEN 0                                               09060004
090700                 CONTINUE                                         09070004
090710                                                                  09071028
090800             WHEN OTHER                                           09080004
090810                  MOVE '3230-CLOSE-PIX-TYP-ACTN-CSR '             09081028
090820                                 TO  PV-PARAGRAPH-NME             09082028
090830                  MOVE  SQLCODE  TO  PV-DISP-SQLCODE              09083028
090900                  PERFORM 9998-SQL-ERROR                          09090028
091000         END-EVALUATE.                                            09100004
091100                                                                  09110004
091200******************************************************************09120004
091300*   OPEN ACTION CODE NULL CURSOR                                  09130004
091400******************************************************************09140004
091500 3300-OPEN-PIX-TYP-CSR.                                           09150028
091600***  DISPLAY 'WSKUT032 - 3300-OPEN-PIX-TYP-CSR     '.             09160046
091700                                                                  09170004
091800     SET PS-EOF-CSR-NO        TO TRUE.                            09180028
091900     EXEC SQL                                                     09190004
092000         OPEN PIX_TYP_CDE_CSR                                     09200029
092100     END-EXEC.                                                    09210004
092200                                                                  09220004
092300     EVALUATE SQLCODE                                             09230004
092400         WHEN 0                                                   09240004
092500             CONTINUE                                             09250004
092510                                                                  09251028
092600         WHEN OTHER                                               09260004
092610              MOVE '3300-OPEN-PIX-TYP-CSR       '                 09261028
092620                             TO  PV-PARAGRAPH-NME                 09262028
092630              MOVE  SQLCODE  TO  PV-DISP-SQLCODE                  09263028
092700              PERFORM 9998-SQL-ERROR                              09270028
092800     END-EVALUATE.                                                09280004
092900                                                                  09290004
093000******************************************************************09300004
093100*   FETCH ACTION CODE NULLS INFORMATION.                          09310004
093200******************************************************************09320004
093300 3310-FETCH-PIX-TYP-INFO.                                         09330028
093400***  DISPLAY 'WSKUT032 - 3310-FETCH-PIX-TYP-INFO     '.           09340046
093500                                                                  09350004
093600       EXEC SQL                                                   09360004
093700       FETCH PIX_TYP_CDE_CSR                                      09370029
093800         INTO :WST00000-TRAN-TYPE                                 09380004
093900             ,:WST00000-TRAN-CODE                                 09390004
094000             ,:WST00000-TRAN-NBR                                  09400008
094100             ,:WST00000-PIX-SEQ-NBR                               09410008
094200             ,:WST00000-PROC-STAT-CODE                            09420008
094300             ,:WST00000-WHSE                                      09430008
094400             ,:WST00000-CO                                        09440008
094500             ,:WST00000-DIV                                       09450008
094600             ,:WST00000-CASE-NBR                                  09460008
094700             ,:WST00000-SKU-ID                                    09470008
094800             ,:WST00000-SEASON                                    09480008
094900             ,:WST00000-SEASON-YR                                 09490008
095000             ,:WST00000-STYLE                                     09500008
095100             ,:WST00000-STYLE-SFX                                 09510008
095200             ,:WST00000-COLOR                                     09520008
095300             ,:WST00000-COLOR-SFX                                 09530008
095400             ,:WST00000-SEC-DIM                                   09540008
095500             ,:WST00000-QUAL                                      09550008
095600             ,:WST00000-SIZE-DESC                                 09560008
095700             ,:WST00000-SIZE-RANGE-CODE                           09570008
095800             ,:WST00000-SIZE-POSN-IN-TBL                          09580008
095900             ,:WST00000-INVN-TYPE                                 09590008
096000             ,:WST00000-PROD-STAT                                 09600008
096100             ,:WST00000-BATCH-NBR                                 09610008
096200             ,:WST00000-SKU-ATTR-1                                09620008
096300             ,:WST00000-SKU-ATTR-2                                09630008
096400             ,:WST00000-SKU-ATTR-3                                09640008
096500             ,:WST00000-SKU-ATTR-4                                09650008
096600             ,:WST00000-SKU-ATTR-5                                09660008
096700             ,:WST00000-CNTRY-OF-ORGN                             09670008
096800             ,:WST00000-INVN-ADJMT-QTY                            09680008
096900             ,:WST00000-INVN-ADJMT-TYPE                           09690008
097000             ,:WST00000-WT-ADJMT-QTY                              09700008
097100             ,:WST00000-WT-ADJMT-TYPE                             09710008
097200             ,:WST00000-UOM                                       09720008
097300             ,:WST00000-REF-WHSE                                  09730008
097400             ,:WST00000-RSN-CODE                                  09740008
097500             ,:WST00000-RCPT-VARI                                 09750008
097600             ,:WST00000-RCPT-CMPL                                 09760008
097700             ,:WST00000-CASES-SHPD                                09770008
097800             ,:WST00000-UNITS-SHPD                                09780008
097900             ,:WST00000-CASES-RCVD                                09790008
098000             ,:WST00000-UNITS-RCVD                                09800008
098100             ,:WST00000-ACTN-CODE                                 09810008
098200             ,:WST00000-CUSTOM-REF                                09820008
098300             ,:WST00000-DATE-PROC                                 09830008
098400             ,:WST00000-SYS-USER-ID                               09840008
098500             ,:WST00000-ERROR-CMNT                                09850008
098600             ,:WST00000-REF-CODE-ID-1                             09860008
098700             ,:WST00000-REF-FIELD-1                               09870008
098800             ,:WST00000-REF-CODE-ID-2                             09880008
098900             ,:WST00000-REF-FIELD-2                               09890008
099000             ,:WST00000-REF-CODE-ID-3                             09900008
099100             ,:WST00000-REF-FIELD-3                               09910008
099200             ,:WST00000-REF-CODE-ID-4                             09920008
099300             ,:WST00000-REF-FIELD-4                               09930008
099400             ,:WST00000-REF-CODE-ID-5                             09940008
099500             ,:WST00000-REF-FIELD-5                               09950008
099600             ,:WST00000-REF-CODE-ID-6                             09960008
099700             ,:WST00000-REF-FIELD-6                               09970008
099800             ,:WST00000-REF-CODE-ID-7                             09980008
099900             ,:WST00000-REF-FIELD-7                               09990008
100000             ,:WST00000-REF-CODE-ID-8                             10000008
100100             ,:WST00000-REF-FIELD-8                               10010008
100200             ,:WST00000-REF-CODE-ID-9                             10020008
100300             ,:WST00000-REF-FIELD-9                               10030008
100400             ,:WST00000-REF-CODE-ID-10                            10040008
100500             ,:WST00000-REF-FIELD-10                              10050008
100600             ,:WST00000-XML-GROUP-ID                              10060008
100700             ,:WST00000-CREATE-DATE-TIME                          10070008
100800             ,:WST00000-MOD-DATE-TIME                             10080008
100900             ,:WST00000-USER-ID                                   10090008
101000             ,:WST00000-K-DC-NBR                                  10100008
101100             ,:WST00000-K-ISRT-TMST                               10110008
101200             ,:WSV00002-PIX-QUE                                   10120021
101300       END-EXEC                                                   10130008
101400                                                                  10140008
101500       EVALUATE TRUE                                              10150008
101600          WHEN SQLCODE = +0                                       10160008
101700               ADD +1 TO PV-PIX-TYP-TOTALS-READ                   10170028
101800               PERFORM 4000-POPULATE-OUTPUT-RECORD                10180028
101900               ADD +1 TO PV-PIX-TYP-TOTALS-WRITTEN                10190028
102000               PERFORM 4200-WRITE-PIX-RECORD-OUT                  10200028
102010                                                                  10201028
102100          WHEN SQLCODE = +100                                     10210008
102200               SET PS-EOF-CSR-YES TO TRUE                         10220028
102300               PERFORM 5000-WRITE-PIX-CSR-TOTALS                  10230028
102400               INITIALIZE PV-PIX-TYP-TOTALS-READ                  10240037
102500               INITIALIZE PV-PIX-TYP-TOTALS-WRITTEN               10250037
102510                                                                  10251028
102600          WHEN SQLCODE = -911                                     10260022
102700          WHEN SQLCODE = -913                                     10270022
102800               CONTINUE                                           10280028
102810                                                                  10281028
102900          WHEN OTHER                                              10290022
102910               MOVE '3310-FETCH-PIX-TYP-INFO     '                10291028
102920                              TO  PV-PARAGRAPH-NME                10292028
102930               MOVE  SQLCODE  TO  PV-DISP-SQLCODE                 10293028
103000               PERFORM 9998-SQL-ERROR                             10300028
103100       END-EVALUATE.                                              10310022
103200                                                                  10320022
103300     IF  (SQLWARN0 NOT = SPACES  OR                               10330028
103400           (SQLCODE > 0 AND SQLCODE NOT = +100)  OR               10340028
103500          SQLCODE < 0)                                            10350028
103510          MOVE '3310-FETCH-PIX-TYP-INFO     '                     10351028
103520                         TO  PV-PARAGRAPH-NME                     10352028
103530          MOVE  SQLCODE  TO  PV-DISP-SQLCODE                      10353028
103600          PERFORM 9998-SQL-ERROR                                  10360028
103700     END-IF.                                                      10370004
103800                                                                  10380004
103900******************************************************************10390004
104000*   CLOSE ACTION CODE NULLS CURSOR.                               10400015
104100******************************************************************10410004
104200 3320-CLOSE-PIX-TYP-CSR.                                          10420037
104300***  DISPLAY 'WSKUT032 - 3330-CLOSE-PIX-TYP-CSR      '.           10430046
104400                                                                  10440004
104500         EXEC SQL                                                 10450004
104600             CLOSE PIX_TYP_CDE_CSR                                10460029
104700         END-EXEC.                                                10470025
104800                                                                  10480004
104900         EVALUATE SQLCODE                                         10490004
105000             WHEN 0                                               10500004
105100                  CONTINUE                                        10510028
105110                                                                  10511028
105200             WHEN OTHER                                           10520004
105210                  MOVE '3330-CLOSE-PIX-TYP-CSR      '             10521028
105220                                 TO  PV-PARAGRAPH-NME             10522028
105230                  MOVE  SQLCODE  TO  PV-DISP-SQLCODE              10523028
105300                  PERFORM 9998-SQL-ERROR                          10530028
105400         END-EVALUATE.                                            10540004
105500                                                                  10550004
105510******************************************************************10551028
105520*   OPEN ACTION CODE NULL CURSOR                                  10552028
105530******************************************************************10553028
105540 3400-OPEN-PIX-CSR.                                               10554028
105550***  DISPLAY 'WSKUT032 - 3400-OPEN-PIX-CSR     '.                 10555046
105560                                                                  10556028
105570     SET PS-EOF-CSR-NO        TO TRUE.                            10557028
105580     EXEC SQL                                                     10558028
105590         OPEN PIX_TYP_CSR                                         10559029
105591     END-EXEC.                                                    10559128
105592                                                                  10559228
105593     EVALUATE SQLCODE                                             10559328
105594         WHEN 0                                                   10559428
105595             CONTINUE                                             10559528
105596                                                                  10559628
105597         WHEN OTHER                                               10559728
105598              MOVE '3400-OPEN-PIX-CSR           '                 10559828
105599                             TO  PV-PARAGRAPH-NME                 10559928
105600              MOVE  SQLCODE  TO  PV-DISP-SQLCODE                  10560028
105601              PERFORM 9998-SQL-ERROR                              10560128
105602     END-EVALUATE.                                                10560228
105603                                                                  10560328
105604******************************************************************10560428
105605*   FETCH ACTION CODE NULLS INFORMATION.                          10560528
105606******************************************************************10560628
105607 3410-FETCH-PIX-INFO.                                             10560728
105608***  DISPLAY 'WSKUT032 - 3410-FETCH-PIX-INFO     '.               10560846
105609                                                                  10560928
105610       EXEC SQL                                                   10561028
105611       FETCH PIX_TYP_CSR                                          10561129
105612         INTO :WST00000-TRAN-TYPE                                 10561228
105613             ,:WST00000-TRAN-CODE                                 10561328
105614             ,:WST00000-TRAN-NBR                                  10561428
105615             ,:WST00000-PIX-SEQ-NBR                               10561528
105616             ,:WST00000-PROC-STAT-CODE                            10561628
105617             ,:WST00000-WHSE                                      10561728
105618             ,:WST00000-CO                                        10561828
105619             ,:WST00000-DIV                                       10561928
105620             ,:WST00000-CASE-NBR                                  10562028
105621             ,:WST00000-SKU-ID                                    10562128
105622             ,:WST00000-SEASON                                    10562228
105623             ,:WST00000-SEASON-YR                                 10562328
105624             ,:WST00000-STYLE                                     10562428
105625             ,:WST00000-STYLE-SFX                                 10562528
105626             ,:WST00000-COLOR                                     10562628
105627             ,:WST00000-COLOR-SFX                                 10562728
105628             ,:WST00000-SEC-DIM                                   10562828
105629             ,:WST00000-QUAL                                      10562928
105630             ,:WST00000-SIZE-DESC                                 10563028
105631             ,:WST00000-SIZE-RANGE-CODE                           10563128
105632             ,:WST00000-SIZE-POSN-IN-TBL                          10563228
105633             ,:WST00000-INVN-TYPE                                 10563328
105634             ,:WST00000-PROD-STAT                                 10563428
105635             ,:WST00000-BATCH-NBR                                 10563528
105636             ,:WST00000-SKU-ATTR-1                                10563628
105637             ,:WST00000-SKU-ATTR-2                                10563728
105638             ,:WST00000-SKU-ATTR-3                                10563828
105639             ,:WST00000-SKU-ATTR-4                                10563928
105640             ,:WST00000-SKU-ATTR-5                                10564028
105641             ,:WST00000-CNTRY-OF-ORGN                             10564128
105642             ,:WST00000-INVN-ADJMT-QTY                            10564228
105643             ,:WST00000-INVN-ADJMT-TYPE                           10564328
105644             ,:WST00000-WT-ADJMT-QTY                              10564428
105645             ,:WST00000-WT-ADJMT-TYPE                             10564528
105646             ,:WST00000-UOM                                       10564628
105647             ,:WST00000-REF-WHSE                                  10564728
105648             ,:WST00000-RSN-CODE                                  10564828
105649             ,:WST00000-RCPT-VARI                                 10564928
105650             ,:WST00000-RCPT-CMPL                                 10565028
105651             ,:WST00000-CASES-SHPD                                10565128
105652             ,:WST00000-UNITS-SHPD                                10565228
105653             ,:WST00000-CASES-RCVD                                10565328
105654             ,:WST00000-UNITS-RCVD                                10565428
105655             ,:WST00000-ACTN-CODE                                 10565528
105656             ,:WST00000-CUSTOM-REF                                10565628
105657             ,:WST00000-DATE-PROC                                 10565728
105658             ,:WST00000-SYS-USER-ID                               10565828
105659             ,:WST00000-ERROR-CMNT                                10565928
105660             ,:WST00000-REF-CODE-ID-1                             10566028
105661             ,:WST00000-REF-FIELD-1                               10566128
105662             ,:WST00000-REF-CODE-ID-2                             10566228
105663             ,:WST00000-REF-FIELD-2                               10566328
105664             ,:WST00000-REF-CODE-ID-3                             10566428
105665             ,:WST00000-REF-FIELD-3                               10566528
105666             ,:WST00000-REF-CODE-ID-4                             10566628
105667             ,:WST00000-REF-FIELD-4                               10566728
105668             ,:WST00000-REF-CODE-ID-5                             10566828
105669             ,:WST00000-REF-FIELD-5                               10566928
105670             ,:WST00000-REF-CODE-ID-6                             10567028
105671             ,:WST00000-REF-FIELD-6                               10567128
105672             ,:WST00000-REF-CODE-ID-7                             10567228
105673             ,:WST00000-REF-FIELD-7                               10567328
105674             ,:WST00000-REF-CODE-ID-8                             10567428
105675             ,:WST00000-REF-FIELD-8                               10567528
105676             ,:WST00000-REF-CODE-ID-9                             10567628
105677             ,:WST00000-REF-FIELD-9                               10567728
105678             ,:WST00000-REF-CODE-ID-10                            10567828
105679             ,:WST00000-REF-FIELD-10                              10567928
105680             ,:WST00000-XML-GROUP-ID                              10568028
105681             ,:WST00000-CREATE-DATE-TIME                          10568128
105682             ,:WST00000-MOD-DATE-TIME                             10568228
105683             ,:WST00000-USER-ID                                   10568328
105684             ,:WST00000-K-DC-NBR                                  10568428
105685             ,:WST00000-K-ISRT-TMST                               10568528
105686             ,:WSV00002-PIX-QUE                                   10568628
105687       END-EXEC                                                   10568728
105688                                                                  10568828
105689       EVALUATE TRUE                                              10568928
105690          WHEN SQLCODE = +0                                       10569028
105691             ADD +1 TO PV-PIX-TOTALS-READ                         10569128
105692             PERFORM 4000-POPULATE-OUTPUT-RECORD                  10569228
105693             ADD +1 TO PV-PIX-TOTALS-WRITTEN                      10569328
105694             PERFORM 4200-WRITE-PIX-RECORD-OUT                    10569428
105695                                                                  10569528
105696          WHEN SQLCODE = +100                                     10569628
105697             SET PS-EOF-CSR-YES TO TRUE                           10569728
105698             PERFORM 5000-WRITE-PIX-CSR-TOTALS                    10569828
105699             INITIALIZE PV-PIX-TOTALS-READ                        10569937
105700             INITIALIZE PV-PIX-TOTALS-WRITTEN                     10570037
105701                                                                  10570128
105702          WHEN SQLCODE = -911                                     10570228
105703          WHEN SQLCODE = -913                                     10570328
105704             CONTINUE                                             10570428
105705                                                                  10570528
105706          WHEN OTHER                                              10570628
105707              MOVE '3410-FETCH-PIX-INFO         '                 10570728
105708                             TO  PV-PARAGRAPH-NME                 10570828
105709              MOVE  SQLCODE  TO  PV-DISP-SQLCODE                  10570928
105710              PERFORM 9998-SQL-ERROR                              10571028
105711       END-EVALUATE.                                              10571128
105712                                                                  10571228
105713     IF (SQLWARN0 NOT = SPACES  OR                                10571328
105714         (SQLCODE > 0 AND SQLCODE NOT = +100)  OR                 10571428
105715        SQLCODE < 0)                                              10571528
105716        MOVE '3410-FETCH-PIX-INFO         '                       10571628
105717                       TO  PV-PARAGRAPH-NME                       10571728
105718        MOVE  SQLCODE  TO  PV-DISP-SQLCODE                        10571828
105719        PERFORM 9998-SQL-ERROR                                    10571928
105720     END-IF.                                                      10572028
105721                                                                  10572128
105722******************************************************************10572228
105723*   CLOSE ACTION CODE NULLS CURSOR.                               10572328
105724******************************************************************10572428
105725 3420-CLOSE-PIX-CSR.                                              10572537
105726***  DISPLAY 'WSKUT032 - 3420-CLOSE-PIX-CSR      '.               10572646
105727                                                                  10572728
105728         EXEC SQL                                                 10572828
105729             CLOSE PIX_TYP_CSR                                    10572929
105730         END-EXEC.                                                10573028
105731                                                                  10573128
105732         EVALUATE SQLCODE                                         10573228
105733             WHEN 0                                               10573328
105734                 CONTINUE                                         10573428
105735                                                                  10573528
105736             WHEN OTHER                                           10573628
105737                  MOVE '3430-CLOSE-PIX-CSR          '             10573728
105738                                 TO  PV-PARAGRAPH-NME             10573828
105739                  MOVE  SQLCODE  TO  PV-DISP-SQLCODE              10573928
105740                  PERFORM 9998-SQL-ERROR                          10574028
105741         END-EVALUATE.                                            10574128
105742                                                                  10574254
105743* JAK 05/2010 - ADD PROCESSING FOR ALL DC CURSORS                 10574354
105744******************************************************************10574454
105745*   OPEN ALL PIX ALL DC CURSOR                                    10574554
105746******************************************************************10574654
105747 3500-OPEN-ALL-PIX-ALL-DC.                                        10574754
105748***  DISPLAY 'WSKUT032 - 3500-OPEN-ALL-PIX-ALL-DC  '.             10574854
105749                                                                  10574954
105750     SET PS-EOF-CSR-NO        TO TRUE.                            10575054
105751     EXEC SQL                                                     10575154
105752         OPEN ALL_PIX_ALL_DC_CSR                                  10575254
105753     END-EXEC.                                                    10575354
105754                                                                  10575454
105755     EVALUATE SQLCODE                                             10575554
105756         WHEN 0                                                   10575654
105757             CONTINUE                                             10575754
105758                                                                  10575854
105759         WHEN OTHER                                               10575954
105760             MOVE '3500-OPEN-ALL-PIX-ALL-DC'                      10576054
105761                            TO  PV-PARAGRAPH-NME                  10576154
105762             MOVE  SQLCODE  TO  PV-DISP-SQLCODE                   10576254
105763             PERFORM 9998-SQL-ERROR                               10576354
105764     END-EVALUATE.                                                10576454
105765                                                                  10576554
105766******************************************************************10576654
105767*   FETCH ALL PIX ALL DC INFORMATION                              10576754
105768******************************************************************10576854
105769 3510-FETCH-ALL-PIX-ALL-DC.                                       10576954
105770***  DISPLAY 'WSKUT032 - 3510-FETCH-ALL-PIX-ALL-DC   '.           10577054
105771                                                                  10577154
105772       EXEC SQL                                                   10577254
105773       FETCH ALL_PIX_ALL_DC_CSR                                   10577354
105774         INTO :WST00000-TRAN-TYPE                                 10577454
105775             ,:WST00000-TRAN-CODE                                 10577554
105776             ,:WST00000-TRAN-NBR                                  10577654
105777             ,:WST00000-PIX-SEQ-NBR                               10577754
105778             ,:WST00000-PROC-STAT-CODE                            10577854
105779             ,:WST00000-WHSE                                      10577954
105780             ,:WST00000-CO                                        10578054
105781             ,:WST00000-DIV                                       10578154
105782             ,:WST00000-CASE-NBR                                  10578254
105783             ,:WST00000-SKU-ID                                    10578354
105784             ,:WST00000-SEASON                                    10578454
105785             ,:WST00000-SEASON-YR                                 10578554
105786             ,:WST00000-STYLE                                     10578654
105787             ,:WST00000-STYLE-SFX                                 10578754
105788             ,:WST00000-COLOR                                     10578854
105789             ,:WST00000-COLOR-SFX                                 10578954
105790             ,:WST00000-SEC-DIM                                   10579054
105791             ,:WST00000-QUAL                                      10579154
105792             ,:WST00000-SIZE-DESC                                 10579254
105793             ,:WST00000-SIZE-RANGE-CODE                           10579354
105794             ,:WST00000-SIZE-POSN-IN-TBL                          10579454
105795             ,:WST00000-INVN-TYPE                                 10579554
105796             ,:WST00000-PROD-STAT                                 10579654
105797             ,:WST00000-BATCH-NBR                                 10579754
105798             ,:WST00000-SKU-ATTR-1                                10579854
105799             ,:WST00000-SKU-ATTR-2                                10579954
105800             ,:WST00000-SKU-ATTR-3                                10580054
105801             ,:WST00000-SKU-ATTR-4                                10580154
105802             ,:WST00000-SKU-ATTR-5                                10580254
105803             ,:WST00000-CNTRY-OF-ORGN                             10580354
105804             ,:WST00000-INVN-ADJMT-QTY                            10580454
105805             ,:WST00000-INVN-ADJMT-TYPE                           10580554
105806             ,:WST00000-WT-ADJMT-QTY                              10580654
105807             ,:WST00000-WT-ADJMT-TYPE                             10580754
105808             ,:WST00000-UOM                                       10580854
105809             ,:WST00000-REF-WHSE                                  10580954
105810             ,:WST00000-RSN-CODE                                  10581054
105811             ,:WST00000-RCPT-VARI                                 10581154
105812             ,:WST00000-RCPT-CMPL                                 10581254
105813             ,:WST00000-CASES-SHPD                                10581354
105814             ,:WST00000-UNITS-SHPD                                10581454
105815             ,:WST00000-CASES-RCVD                                10581554
105816             ,:WST00000-UNITS-RCVD                                10581654
105817             ,:WST00000-ACTN-CODE                                 10581754
105818             ,:WST00000-CUSTOM-REF                                10581854
105819             ,:WST00000-DATE-PROC                                 10581954
105820             ,:WST00000-SYS-USER-ID                               10582054
105821             ,:WST00000-ERROR-CMNT                                10582154
105822             ,:WST00000-REF-CODE-ID-1                             10582254
105823             ,:WST00000-REF-FIELD-1                               10582354
105824             ,:WST00000-REF-CODE-ID-2                             10582454
105825             ,:WST00000-REF-FIELD-2                               10582554
105826             ,:WST00000-REF-CODE-ID-3                             10582654
105827             ,:WST00000-REF-FIELD-3                               10582754
105828             ,:WST00000-REF-CODE-ID-4                             10582854
105829             ,:WST00000-REF-FIELD-4                               10582954
105830             ,:WST00000-REF-CODE-ID-5                             10583054
105831             ,:WST00000-REF-FIELD-5                               10583154
105832             ,:WST00000-REF-CODE-ID-6                             10583254
105833             ,:WST00000-REF-FIELD-6                               10583354
105834             ,:WST00000-REF-CODE-ID-7                             10583454
105835             ,:WST00000-REF-FIELD-7                               10583554
105836             ,:WST00000-REF-CODE-ID-8                             10583654
105837             ,:WST00000-REF-FIELD-8                               10583754
105838             ,:WST00000-REF-CODE-ID-9                             10583854
105839             ,:WST00000-REF-FIELD-9                               10583954
105840             ,:WST00000-REF-CODE-ID-10                            10584054
105841             ,:WST00000-REF-FIELD-10                              10584154
105842             ,:WST00000-XML-GROUP-ID                              10584254
105843             ,:WST00000-CREATE-DATE-TIME                          10584354
105844             ,:WST00000-MOD-DATE-TIME                             10584454
105845             ,:WST00000-USER-ID                                   10584554
105846             ,:WST00000-K-DC-NBR                                  10584654
105847             ,:WST00000-K-ISRT-TMST                               10584754
105848             ,:WSV00002-PIX-QUE                                   10584854
105849       END-EXEC                                                   10584954
105850                                                                  10585054
105851       EVALUATE TRUE                                              10585154
105852          WHEN SQLCODE = +0                                       10585254
105853             ADD +1 TO PV-ALL-PIX-ALL-DC-READ                     10585354
105854             PERFORM 4000-POPULATE-OUTPUT-RECORD                  10585454
105855             ADD +1 TO PV-ALL-PIX-ALL-DC-WRITTEN                  10585554
105856             PERFORM 4200-WRITE-PIX-RECORD-OUT                    10585654
105857                                                                  10585754
105858          WHEN SQLCODE = +100                                     10585854
105859             SET PS-EOF-CSR-YES TO TRUE                           10585954
105860             PERFORM 5000-WRITE-PIX-CSR-TOTALS                    10586054
105861             INITIALIZE PV-ALL-PIX-ALL-DC-READ                    10586154
105862             INITIALIZE PV-ALL-PIX-ALL-DC-WRITTEN                 10586254
105863                                                                  10586354
105864          WHEN SQLCODE = -911                                     10586454
105865          WHEN SQLCODE = -913                                     10586554
105866             CONTINUE                                             10586654
105867                                                                  10586754
105868          WHEN OTHER                                              10586854
105869             MOVE '3510-FETCH-ALL-PIX-ALL-DC'                     10586954
105870                            TO  PV-PARAGRAPH-NME                  10587054
105871             MOVE  SQLCODE  TO  PV-DISP-SQLCODE                   10587154
105872             PERFORM 9998-SQL-ERROR                               10587254
105873       END-EVALUATE.                                              10587354
105874                                                                  10587454
105875     IF  (SQLWARN0 NOT = SPACES  OR                               10587554
105876          (SQLCODE > 0 AND SQLCODE NOT = +100)  OR                10587654
105877          SQLCODE < 0)                                            10587754
105878                                                                  10587854
105879         MOVE '3510-FETCH-ALL-PIX-ALL-DC'                         10587954
105880                        TO  PV-PARAGRAPH-NME                      10588054
105881         MOVE  SQLCODE  TO  PV-DISP-SQLCODE                       10588154
105882         PERFORM 9998-SQL-ERROR                                   10588254
105883     END-IF.                                                      10588354
105884                                                                  10588454
105885******************************************************************10588554
105886*   CLOSE ALL PIX ALL DC CURSOR.                                  10588654
105887******************************************************************10588754
105888 3520-CLOSE-ALL-PIX-ALL-DC.                                       10588854
105889***  DISPLAY 'WSKUT032 - 3520-CLOSE-ALL-PIX-ALL-DC   '.           10588954
105890                                                                  10589054
105891         EXEC SQL                                                 10589154
105892             CLOSE ALL_PIX_ALL_DC_CSR                             10589254
105893         END-EXEC.                                                10589354
105894                                                                  10589454
105895         EVALUATE SQLCODE                                         10589554
105896             WHEN 0                                               10589654
105897                 CONTINUE                                         10589754
105898                                                                  10589854
105899             WHEN OTHER                                           10589954
105900                  MOVE '3530-CLOSE-ALL-PIX-ALLDC'                 10590054
105901                                 TO  PV-PARAGRAPH-NME             10590154
105902                  MOVE  SQLCODE  TO  PV-DISP-SQLCODE              10590254
105903                  PERFORM 9998-SQL-ERROR                          10590354
105904         END-EVALUATE.                                            10590454
105905                                                                  10590554
105906******************************************************************10590654
105907*   OPEN SPECIFIC PIX CURSOR - ALL DC                             10590754
105908******************************************************************10590854
105909 3600-OPEN-PIX-TYP-ACTN-ALL-DC.                                   10590954
105910***  DISPLAY 'WSKUT032 - 3600-OPEN-PIX-TYP-ACTN-ALL-DC'.          10591054
105911                                                                  10591154
105912     SET PS-EOF-CSR-NO        TO TRUE.                            10591254
105913     EXEC SQL                                                     10591354
105914         OPEN PIX_TYP_AC_ALL_DC_CSR                               10591454
105915     END-EXEC.                                                    10591554
105916                                                                  10591654
105917     EVALUATE SQLCODE                                             10591754
105918         WHEN 0                                                   10591854
105919             CONTINUE                                             10591954
105920                                                                  10592054
105921         WHEN OTHER                                               10592154
105922              MOVE '3600-OPEN-PIX-TYP-ACTN-ALL-DC'                10592254
105923                                 TO  PV-PARAGRAPH-NME             10592354
105924                  MOVE  SQLCODE  TO  PV-DISP-SQLCODE              10592454
105925             PERFORM 9998-SQL-ERROR                               10592554
105926     END-EVALUATE.                                                10592654
105927                                                                  10592754
105928******************************************************************10592854
105929*   FETCH SPECIFIC PIX INFORMATION - ALL DC                       10592954
105930******************************************************************10593054
105931 3610-FETCH-PIX-TYP-ACTN-ALL-DC.                                  10593154
105932***  DISPLAY 'WSKUT032 - 3610-FETCH-PIX-TYP-ACTN-ALL-DC'.         10593254
105933                                                                  10593354
105934       EXEC SQL                                                   10593454
105935       FETCH PIX_TYP_AC_ALL_DC_CSR                                10593554
105936         INTO :WST00000-TRAN-TYPE                                 10593654
105937             ,:WST00000-TRAN-CODE                                 10593754
105938             ,:WST00000-TRAN-NBR                                  10593854
105939             ,:WST00000-PIX-SEQ-NBR                               10593954
105940             ,:WST00000-PROC-STAT-CODE                            10594054
105941             ,:WST00000-WHSE                                      10594154
105942             ,:WST00000-CO                                        10594254
105943             ,:WST00000-DIV                                       10594354
105944             ,:WST00000-CASE-NBR                                  10594454
105945             ,:WST00000-SKU-ID                                    10594554
105946             ,:WST00000-SEASON                                    10594654
105947             ,:WST00000-SEASON-YR                                 10594754
105948             ,:WST00000-STYLE                                     10594854
105949             ,:WST00000-STYLE-SFX                                 10594954
105950             ,:WST00000-COLOR                                     10595054
105951             ,:WST00000-COLOR-SFX                                 10595154
105952             ,:WST00000-SEC-DIM                                   10595254
105953             ,:WST00000-QUAL                                      10595354
105954             ,:WST00000-SIZE-DESC                                 10595454
105955             ,:WST00000-SIZE-RANGE-CODE                           10595554
105956             ,:WST00000-SIZE-POSN-IN-TBL                          10595654
105957             ,:WST00000-INVN-TYPE                                 10595754
105958             ,:WST00000-PROD-STAT                                 10595854
105959             ,:WST00000-BATCH-NBR                                 10595954
105960             ,:WST00000-SKU-ATTR-1                                10596054
105961             ,:WST00000-SKU-ATTR-2                                10596154
105962             ,:WST00000-SKU-ATTR-3                                10596254
105963             ,:WST00000-SKU-ATTR-4                                10596354
105964             ,:WST00000-SKU-ATTR-5                                10596454
105965             ,:WST00000-CNTRY-OF-ORGN                             10596554
105966             ,:WST00000-INVN-ADJMT-QTY                            10596654
105967             ,:WST00000-INVN-ADJMT-TYPE                           10596754
105968             ,:WST00000-WT-ADJMT-QTY                              10596854
105969             ,:WST00000-WT-ADJMT-TYPE                             10596954
105970             ,:WST00000-UOM                                       10597054
105971             ,:WST00000-REF-WHSE                                  10597154
105972             ,:WST00000-RSN-CODE                                  10597254
105973             ,:WST00000-RCPT-VARI                                 10597354
105974             ,:WST00000-RCPT-CMPL                                 10597454
105975             ,:WST00000-CASES-SHPD                                10597554
105976             ,:WST00000-UNITS-SHPD                                10597654
105977             ,:WST00000-CASES-RCVD                                10597754
105978             ,:WST00000-UNITS-RCVD                                10597854
105979             ,:WST00000-ACTN-CODE                                 10597954
105980             ,:WST00000-CUSTOM-REF                                10598054
105981             ,:WST00000-DATE-PROC                                 10598154
105982             ,:WST00000-SYS-USER-ID                               10598254
105983             ,:WST00000-ERROR-CMNT                                10598354
105984             ,:WST00000-REF-CODE-ID-1                             10598454
105985             ,:WST00000-REF-FIELD-1                               10598554
105986             ,:WST00000-REF-CODE-ID-2                             10598654
105987             ,:WST00000-REF-FIELD-2                               10598754
105988             ,:WST00000-REF-CODE-ID-3                             10598854
105989             ,:WST00000-REF-FIELD-3                               10598954
105990             ,:WST00000-REF-CODE-ID-4                             10599054
105991             ,:WST00000-REF-FIELD-4                               10599154
105992             ,:WST00000-REF-CODE-ID-5                             10599254
105993             ,:WST00000-REF-FIELD-5                               10599354
105994             ,:WST00000-REF-CODE-ID-6                             10599454
105995             ,:WST00000-REF-FIELD-6                               10599554
105996             ,:WST00000-REF-CODE-ID-7                             10599654
105997             ,:WST00000-REF-FIELD-7                               10599754
105998             ,:WST00000-REF-CODE-ID-8                             10599854
105999             ,:WST00000-REF-FIELD-8                               10599954
106000             ,:WST00000-REF-CODE-ID-9                             10600054
106001             ,:WST00000-REF-FIELD-9                               10600154
106002             ,:WST00000-REF-CODE-ID-10                            10600254
106003             ,:WST00000-REF-FIELD-10                              10600354
106004             ,:WST00000-XML-GROUP-ID                              10600454
106005             ,:WST00000-CREATE-DATE-TIME                          10600554
106006             ,:WST00000-MOD-DATE-TIME                             10600654
106007             ,:WST00000-USER-ID                                   10600754
106008             ,:WST00000-K-DC-NBR                                  10600854
106009             ,:WST00000-K-ISRT-TMST                               10600954
106010             ,:WSV00002-PIX-QUE                                   10601054
106011       END-EXEC                                                   10601154
106012                                                                  10601254
106013       EVALUATE TRUE                                              10601354
106014          WHEN SQLCODE = +0                                       10601454
106015             ADD +1 TO PV-PIX-TYP-ACTN-ALL-DC-READ                10601554
106016             PERFORM 4000-POPULATE-OUTPUT-RECORD                  10601654
106017             ADD +1 TO PV-PIX-TYP-ACTN-ALL-DC-WRITTEN             10601754
106018             PERFORM 4200-WRITE-PIX-RECORD-OUT                    10601854
106019                                                                  10601954
106020          WHEN SQLCODE = +100                                     10602054
106021             SET PS-EOF-CSR-YES TO TRUE                           10602154
106022             PERFORM 5000-WRITE-PIX-CSR-TOTALS                    10602254
106023             INITIALIZE PV-PIX-TYP-ACTN-ALL-DC-READ               10602354
106024             INITIALIZE PV-PIX-TYP-ACTN-ALL-DC-WRITTEN            10602454
106025                                                                  10602554
106026          WHEN SQLCODE = -911                                     10602654
106027          WHEN SQLCODE = -913                                     10602754
106028             CONTINUE                                             10602854
106029                                                                  10602954
106030          WHEN OTHER                                              10603054
106031               MOVE '3610-FETCH-PIX-TYP-ACTN-ALL-DC'              10603154
106032                              TO  PV-PARAGRAPH-NME                10603254
106033               MOVE  SQLCODE  TO  PV-DISP-SQLCODE                 10603354
106034               PERFORM 9998-SQL-ERROR                             10603454
106035       END-EVALUATE.                                              10603554
106036                                                                  10603654
106037     IF  (SQLWARN0 NOT = SPACES  OR                               10603754
106038          (SQLCODE > 0 AND SQLCODE NOT = +100)  OR                10603854
106039          SQLCODE < 0)                                            10603954
106040          MOVE '3610-FETCH-PIX-TYP-ACTN-ALL-DC'                   10604054
106041                         TO  PV-PARAGRAPH-NME                     10604154
106042          MOVE  SQLCODE  TO  PV-DISP-SQLCODE                      10604254
106043          PERFORM 9998-SQL-ERROR                                  10604354
106044     END-IF.                                                      10604454
106045                                                                  10604554
106046******************************************************************10604654
106047*   CLOSE SPECIFIC PIX CURSOR - ALL DC                            10604754
106048******************************************************************10604854
106049 3620-CLOSE-PIX-TYP-ACTN-ALL-DC.                                  10604954
106050***  DISPLAY 'WSKUT032 - 3620-CLOSE-PIX-TYP-ACTN-ALL-DC'.         10605054
106051                                                                  10605154
106052         EXEC SQL                                                 10605254
106053             CLOSE PIX_TYP_AC_ALL_DC_CSR                          10605354
106054         END-EXEC.                                                10605454
106055                                                                  10605554
106056         EVALUATE SQLCODE                                         10605654
106057             WHEN 0                                               10605754
106058                 CONTINUE                                         10605854
106059                                                                  10605954
106060             WHEN OTHER                                           10606054
106061                  MOVE '3630-CLOSE-PIX-TYP-ACTN-ALL-DC '          10606154
106062                                 TO  PV-PARAGRAPH-NME             10606254
106063                  MOVE  SQLCODE  TO  PV-DISP-SQLCODE              10606354
106064                  PERFORM 9998-SQL-ERROR                          10606454
106065         END-EVALUATE.                                            10606554
106066                                                                  10606654
106067******************************************************************10606754
106068*   OPEN ACTION CODE NULL CURSOR - ALL DC                         10606854
106069******************************************************************10606954
106070 3700-OPEN-PIX-TYP-ALL-DC.                                        10607054
106071***  DISPLAY 'WSKUT032 - 3700-OPEN-PIX-TYP-ALL-DC  '.             10607154
106072                                                                  10607254
106073     SET PS-EOF-CSR-NO        TO TRUE.                            10607354
106074     EXEC SQL                                                     10607454
106075         OPEN PIX_TYP_CDE_ALL_DC_CSR                              10607554
106076     END-EXEC.                                                    10607654
106077                                                                  10607754
106078     EVALUATE SQLCODE                                             10607854
106079         WHEN 0                                                   10607954
106080             CONTINUE                                             10608054
106081                                                                  10608154
106082         WHEN OTHER                                               10608254
106083              MOVE '3700-OPEN-PIX-TYP-ALL-DC    '                 10608354
106084                             TO  PV-PARAGRAPH-NME                 10608454
106085              MOVE  SQLCODE  TO  PV-DISP-SQLCODE                  10608554
106086              PERFORM 9998-SQL-ERROR                              10608654
106087     END-EVALUATE.                                                10608754
106088                                                                  10608854
106089******************************************************************10608954
106090*   FETCH ACTION CODE NULLS INFORMATION - ALL DC                  10609054
106091******************************************************************10609154
106092 3710-FETCH-PIX-TYP-ALL-DC.                                       10609254
106093***  DISPLAY 'WSKUT032 - 3710-FETCH-PIX-TYP-ALL-DC   '.           10609354
106094                                                                  10609454
106095       EXEC SQL                                                   10609554
106096       FETCH PIX_TYP_CDE_ALL_DC_CSR                               10609654
106097         INTO :WST00000-TRAN-TYPE                                 10609754
106098             ,:WST00000-TRAN-CODE                                 10609854
106099             ,:WST00000-TRAN-NBR                                  10609954
106100             ,:WST00000-PIX-SEQ-NBR                               10610054
106101             ,:WST00000-PROC-STAT-CODE                            10610154
106102             ,:WST00000-WHSE                                      10610254
106103             ,:WST00000-CO                                        10610354
106104             ,:WST00000-DIV                                       10610454
106105             ,:WST00000-CASE-NBR                                  10610554
106106             ,:WST00000-SKU-ID                                    10610654
106107             ,:WST00000-SEASON                                    10610754
106108             ,:WST00000-SEASON-YR                                 10610854
106109             ,:WST00000-STYLE                                     10610954
106110             ,:WST00000-STYLE-SFX                                 10611054
106111             ,:WST00000-COLOR                                     10611154
106112             ,:WST00000-COLOR-SFX                                 10611254
106113             ,:WST00000-SEC-DIM                                   10611354
106114             ,:WST00000-QUAL                                      10611454
106115             ,:WST00000-SIZE-DESC                                 10611554
106116             ,:WST00000-SIZE-RANGE-CODE                           10611654
106117             ,:WST00000-SIZE-POSN-IN-TBL                          10611754
106118             ,:WST00000-INVN-TYPE                                 10611854
106119             ,:WST00000-PROD-STAT                                 10611954
106120             ,:WST00000-BATCH-NBR                                 10612054
106121             ,:WST00000-SKU-ATTR-1                                10612154
106122             ,:WST00000-SKU-ATTR-2                                10612254
106123             ,:WST00000-SKU-ATTR-3                                10612354
106124             ,:WST00000-SKU-ATTR-4                                10612454
106125             ,:WST00000-SKU-ATTR-5                                10612554
106126             ,:WST00000-CNTRY-OF-ORGN                             10612654
106127             ,:WST00000-INVN-ADJMT-QTY                            10612754
106128             ,:WST00000-INVN-ADJMT-TYPE                           10612854
106129             ,:WST00000-WT-ADJMT-QTY                              10612954
106130             ,:WST00000-WT-ADJMT-TYPE                             10613054
106131             ,:WST00000-UOM                                       10613154
106132             ,:WST00000-REF-WHSE                                  10613254
106133             ,:WST00000-RSN-CODE                                  10613354
106134             ,:WST00000-RCPT-VARI                                 10613454
106135             ,:WST00000-RCPT-CMPL                                 10613554
106136             ,:WST00000-CASES-SHPD                                10613654
106137             ,:WST00000-UNITS-SHPD                                10613754
106138             ,:WST00000-CASES-RCVD                                10613854
106139             ,:WST00000-UNITS-RCVD                                10613954
106140             ,:WST00000-ACTN-CODE                                 10614054
106141             ,:WST00000-CUSTOM-REF                                10614154
106142             ,:WST00000-DATE-PROC                                 10614254
106143             ,:WST00000-SYS-USER-ID                               10614354
106144             ,:WST00000-ERROR-CMNT                                10614454
106145             ,:WST00000-REF-CODE-ID-1                             10614554
106146             ,:WST00000-REF-FIELD-1                               10614654
106147             ,:WST00000-REF-CODE-ID-2                             10614754
106148             ,:WST00000-REF-FIELD-2                               10614854
106149             ,:WST00000-REF-CODE-ID-3                             10614954
106150             ,:WST00000-REF-FIELD-3                               10615054
106151             ,:WST00000-REF-CODE-ID-4                             10615154
106152             ,:WST00000-REF-FIELD-4                               10615254
106153             ,:WST00000-REF-CODE-ID-5                             10615354
106154             ,:WST00000-REF-FIELD-5                               10615454
106155             ,:WST00000-REF-CODE-ID-6                             10615554
106156             ,:WST00000-REF-FIELD-6                               10615654
106157             ,:WST00000-REF-CODE-ID-7                             10615754
106158             ,:WST00000-REF-FIELD-7                               10615854
106159             ,:WST00000-REF-CODE-ID-8                             10615954
106160             ,:WST00000-REF-FIELD-8                               10616054
106161             ,:WST00000-REF-CODE-ID-9                             10616154
106162             ,:WST00000-REF-FIELD-9                               10616254
106163             ,:WST00000-REF-CODE-ID-10                            10616354
106164             ,:WST00000-REF-FIELD-10                              10616454
106165             ,:WST00000-XML-GROUP-ID                              10616554
106166             ,:WST00000-CREATE-DATE-TIME                          10616654
106167             ,:WST00000-MOD-DATE-TIME                             10616754
106168             ,:WST00000-USER-ID                                   10616854
106169             ,:WST00000-K-DC-NBR                                  10616954
106170             ,:WST00000-K-ISRT-TMST                               10617054
106171             ,:WSV00002-PIX-QUE                                   10617154
106172       END-EXEC                                                   10617254
106173                                                                  10617354
106174       EVALUATE TRUE                                              10617454
106175          WHEN SQLCODE = +0                                       10617554
106176               ADD +1 TO PV-PIX-TYP-ALL-DC-READ                   10617654
106177               PERFORM 4000-POPULATE-OUTPUT-RECORD                10617754
106178               ADD +1 TO PV-PIX-TYP-ALL-DC-WRITTEN                10617854
106179               PERFORM 4200-WRITE-PIX-RECORD-OUT                  10617954
106180                                                                  10618054
106181          WHEN SQLCODE = +100                                     10618154
106182               SET PS-EOF-CSR-YES TO TRUE                         10618254
106183               PERFORM 5000-WRITE-PIX-CSR-TOTALS                  10618354
106184               INITIALIZE PV-PIX-TYP-ALL-DC-READ                  10618454
106185               INITIALIZE PV-PIX-TYP-ALL-DC-WRITTEN               10618554
106186                                                                  10618654
106187          WHEN SQLCODE = -911                                     10618754
106188          WHEN SQLCODE = -913                                     10618854
106189               CONTINUE                                           10618954
106190                                                                  10619054
106191          WHEN OTHER                                              10619154
106192               MOVE '3710-FETCH-PIX-TYP-ALL-DC   '                10619254
106193                              TO  PV-PARAGRAPH-NME                10619354
106194               MOVE  SQLCODE  TO  PV-DISP-SQLCODE                 10619454
106195               PERFORM 9998-SQL-ERROR                             10619554
106196       END-EVALUATE.                                              10619654
106197                                                                  10619754
106198     IF  (SQLWARN0 NOT = SPACES  OR                               10619854
106199           (SQLCODE > 0 AND SQLCODE NOT = +100)  OR               10619954
106200          SQLCODE < 0)                                            10620054
106201          MOVE '3710-FETCH-PIX-TYP-ALL-DC   '                     10620154
106202                         TO  PV-PARAGRAPH-NME                     10620254
106203          MOVE  SQLCODE  TO  PV-DISP-SQLCODE                      10620354
106204          PERFORM 9998-SQL-ERROR                                  10620454
106205     END-IF.                                                      10620554
106206                                                                  10620654
106207******************************************************************10620754
106208*   CLOSE ACTION CODE NULLS CURSOR.                               10620854
106209******************************************************************10620954
106210 3720-CLOSE-PIX-TYP-ALL-DC.                                       10621054
106211***  DISPLAY 'WSKUT032 - 3720-CLOSE-PIX-TYP-ALL-DC   '.           10621154
106212                                                                  10621254
106213         EXEC SQL                                                 10621354
106214             CLOSE PIX_TYP_CDE_ALL_DC_CSR                         10621454
106215         END-EXEC.                                                10621554
106216                                                                  10621654
106217         EVALUATE SQLCODE                                         10621754
106218             WHEN 0                                               10621854
106219                  CONTINUE                                        10621954
106220                                                                  10622054
106221             WHEN OTHER                                           10622154
106222                  MOVE '3720-CLOSE-PIX-TYP-ALL-DC   '             10622254
106223                                 TO  PV-PARAGRAPH-NME             10622354
106224                  MOVE  SQLCODE  TO  PV-DISP-SQLCODE              10622454
106225                  PERFORM 9998-SQL-ERROR                          10622554
106226         END-EVALUATE.                                            10622654
106227                                                                  10622754
106228******************************************************************10622854
106229*   OPEN ACTION CODE NULL CURSOR - ALL DC                         10622954
106230******************************************************************10623054
106231 3800-OPEN-PIX-ALL-DC.                                            10623154
106232***  DISPLAY 'WSKUT032 - 3800-OPEN-PIX-ALL-DC  '.                 10623254
106233                                                                  10623354
106234     SET PS-EOF-CSR-NO        TO TRUE.                            10623454
106235     EXEC SQL                                                     10623554
106236         OPEN PIX_TYP_ALL_DC_CSR                                  10623654
106237     END-EXEC.                                                    10623754
106238                                                                  10623854
106239     EVALUATE SQLCODE                                             10623954
106240         WHEN 0                                                   10624054
106241             CONTINUE                                             10624154
106242                                                                  10624254
106243         WHEN OTHER                                               10624354
106244              MOVE '3800-OPEN-PIX-ALL-DC        '                 10624454
106245                             TO  PV-PARAGRAPH-NME                 10624554
106246              MOVE  SQLCODE  TO  PV-DISP-SQLCODE                  10624654
106247              PERFORM 9998-SQL-ERROR                              10624754
106248     END-EVALUATE.                                                10624854
106249                                                                  10624954
106250******************************************************************10625054
106251*   FETCH ACTION CODE NULLS INFORMATION - ALL DC                  10625154
106252******************************************************************10625254
106253 3810-FETCH-PIX-ALL-DC.                                           10625354
106254***  DISPLAY 'WSKUT032 - 3810-FETCH-PIX-ALL-DC   '.               10625454
106255                                                                  10625554
106256       EXEC SQL                                                   10625654
106257       FETCH PIX_TYP_ALL_DC_CSR                                   10625754
106258         INTO :WST00000-TRAN-TYPE                                 10625854
106259             ,:WST00000-TRAN-CODE                                 10625954
106260             ,:WST00000-TRAN-NBR                                  10626054
106261             ,:WST00000-PIX-SEQ-NBR                               10626154
106262             ,:WST00000-PROC-STAT-CODE                            10626254
106263             ,:WST00000-WHSE                                      10626354
106264             ,:WST00000-CO                                        10626454
106265             ,:WST00000-DIV                                       10626554
106266             ,:WST00000-CASE-NBR                                  10626654
106267             ,:WST00000-SKU-ID                                    10626754
106268             ,:WST00000-SEASON                                    10626854
106269             ,:WST00000-SEASON-YR                                 10626954
106270             ,:WST00000-STYLE                                     10627054
106271             ,:WST00000-STYLE-SFX                                 10627154
106272             ,:WST00000-COLOR                                     10627254
106273             ,:WST00000-COLOR-SFX                                 10627354
106274             ,:WST00000-SEC-DIM                                   10627454
106275             ,:WST00000-QUAL                                      10627554
106276             ,:WST00000-SIZE-DESC                                 10627654
106277             ,:WST00000-SIZE-RANGE-CODE                           10627754
106278             ,:WST00000-SIZE-POSN-IN-TBL                          10627854
106279             ,:WST00000-INVN-TYPE                                 10627954
106280             ,:WST00000-PROD-STAT                                 10628054
106281             ,:WST00000-BATCH-NBR                                 10628154
106282             ,:WST00000-SKU-ATTR-1                                10628254
106283             ,:WST00000-SKU-ATTR-2                                10628354
106284             ,:WST00000-SKU-ATTR-3                                10628454
106285             ,:WST00000-SKU-ATTR-4                                10628554
106286             ,:WST00000-SKU-ATTR-5                                10628654
106287             ,:WST00000-CNTRY-OF-ORGN                             10628754
106288             ,:WST00000-INVN-ADJMT-QTY                            10628854
106289             ,:WST00000-INVN-ADJMT-TYPE                           10628954
106290             ,:WST00000-WT-ADJMT-QTY                              10629054
106291             ,:WST00000-WT-ADJMT-TYPE                             10629154
106292             ,:WST00000-UOM                                       10629254
106293             ,:WST00000-REF-WHSE                                  10629354
106294             ,:WST00000-RSN-CODE                                  10629454
106295             ,:WST00000-RCPT-VARI                                 10629554
106296             ,:WST00000-RCPT-CMPL                                 10629654
106297             ,:WST00000-CASES-SHPD                                10629754
106298             ,:WST00000-UNITS-SHPD                                10629854
106299             ,:WST00000-CASES-RCVD                                10629954
106300             ,:WST00000-UNITS-RCVD                                10630054
106301             ,:WST00000-ACTN-CODE                                 10630154
106302             ,:WST00000-CUSTOM-REF                                10630254
106303             ,:WST00000-DATE-PROC                                 10630354
106304             ,:WST00000-SYS-USER-ID                               10630454
106305             ,:WST00000-ERROR-CMNT                                10630554
106306             ,:WST00000-REF-CODE-ID-1                             10630654
106307             ,:WST00000-REF-FIELD-1                               10630754
106308             ,:WST00000-REF-CODE-ID-2                             10630854
106309             ,:WST00000-REF-FIELD-2                               10630954
106310             ,:WST00000-REF-CODE-ID-3                             10631054
106311             ,:WST00000-REF-FIELD-3                               10631154
106312             ,:WST00000-REF-CODE-ID-4                             10631254
106313             ,:WST00000-REF-FIELD-4                               10631354
106314             ,:WST00000-REF-CODE-ID-5                             10631454
106315             ,:WST00000-REF-FIELD-5                               10631554
106316             ,:WST00000-REF-CODE-ID-6                             10631654
106317             ,:WST00000-REF-FIELD-6                               10631754
106318             ,:WST00000-REF-CODE-ID-7                             10631854
106319             ,:WST00000-REF-FIELD-7                               10631954
106320             ,:WST00000-REF-CODE-ID-8                             10632054
106321             ,:WST00000-REF-FIELD-8                               10632154
106322             ,:WST00000-REF-CODE-ID-9                             10632254
106323             ,:WST00000-REF-FIELD-9                               10632354
106324             ,:WST00000-REF-CODE-ID-10                            10632454
106325             ,:WST00000-REF-FIELD-10                              10632554
106326             ,:WST00000-XML-GROUP-ID                              10632654
106327             ,:WST00000-CREATE-DATE-TIME                          10632754
106328             ,:WST00000-MOD-DATE-TIME                             10632854
106329             ,:WST00000-USER-ID                                   10632954
106330             ,:WST00000-K-DC-NBR                                  10633054
106331             ,:WST00000-K-ISRT-TMST                               10633154
106332             ,:WSV00002-PIX-QUE                                   10633254
106333       END-EXEC                                                   10633354
106334                                                                  10633454
106335       EVALUATE TRUE                                              10633554
106336          WHEN SQLCODE = +0                                       10633654
106337             ADD +1 TO PV-PIX-ALL-DC-READ                         10633754
106338             PERFORM 4000-POPULATE-OUTPUT-RECORD                  10633854
106339             ADD +1 TO PV-PIX-ALL-DC-WRITTEN                      10633954
106340             PERFORM 4200-WRITE-PIX-RECORD-OUT                    10634054
106341                                                                  10634154
106342          WHEN SQLCODE = +100                                     10634254
106343             SET PS-EOF-CSR-YES TO TRUE                           10634354
106344             PERFORM 5000-WRITE-PIX-CSR-TOTALS                    10634454
106345             INITIALIZE PV-PIX-ALL-DC-READ                        10634554
106346             INITIALIZE PV-PIX-ALL-DC-WRITTEN                     10634654
106347                                                                  10634754
106348          WHEN SQLCODE = -911                                     10634854
106349          WHEN SQLCODE = -913                                     10634954
106350             CONTINUE                                             10635054
106351                                                                  10635154
106352          WHEN OTHER                                              10635254
106353              MOVE '3810-FETCH-PIX-ALL-DC       '                 10635354
106354                             TO  PV-PARAGRAPH-NME                 10635454
106355              MOVE  SQLCODE  TO  PV-DISP-SQLCODE                  10635554
106356              PERFORM 9998-SQL-ERROR                              10635654
106357       END-EVALUATE.                                              10635754
106358                                                                  10635854
106359     IF (SQLWARN0 NOT = SPACES  OR                                10635954
106360         (SQLCODE > 0 AND SQLCODE NOT = +100)  OR                 10636054
106361        SQLCODE < 0)                                              10636154
106362        MOVE '3810-FETCH-PIX-ALL-DC       '                       10636254
106363                       TO  PV-PARAGRAPH-NME                       10636354
106364        MOVE  SQLCODE  TO  PV-DISP-SQLCODE                        10636454
106365        PERFORM 9998-SQL-ERROR                                    10636554
106366     END-IF.                                                      10636654
106367                                                                  10636754
106368******************************************************************10636854
106369*   CLOSE ACTION CODE NULLS CURSOR - ALL DC                       10636954
106370******************************************************************10637054
106371 3820-CLOSE-PIX-ALL-DC.                                           10637154
106372***  DISPLAY 'WSKUT032 - 3820-CLOSE-PIX-ALL-DC   '.               10637254
106373                                                                  10637354
106374         EXEC SQL                                                 10637454
106375             CLOSE PIX_TYP_ALL_DC_CSR                             10637554
106376         END-EXEC.                                                10637654
106377                                                                  10637754
106378         EVALUATE SQLCODE                                         10637854
106379             WHEN 0                                               10637954
106380                 CONTINUE                                         10638054
106381                                                                  10638154
106382             WHEN OTHER                                           10638254
106383                  MOVE '3820-CLOSE-PIX-ALL-DC       '             10638354
106384                                 TO  PV-PARAGRAPH-NME             10638454
106385                  MOVE  SQLCODE  TO  PV-DISP-SQLCODE              10638554
106386                  PERFORM 9998-SQL-ERROR                          10638654
106387         END-EVALUATE.                                            10638754
106388* JAK 05/2010 - END                                               10638854
106389                                                                  10638954
106390***************************************************************** 10639054
106391* POPULATE FIELDS FOR THE OUTPUT RECORD FOR EACH PIX.             10639154
106392***************************************************************** 10639254
106393 4000-POPULATE-OUTPUT-RECORD.                                     10639354
106394***  DISPLAY 'WSKUT032 - 4000-POPULATE-OUTPUT-RECORD '.           10639454
106395                                                                  10639554
106396     MOVE WST00000-TRAN-TYPE      TO WS045-TRANSACTIONTYPE.       10639654
106397     MOVE WST00000-TRAN-CODE      TO WS045-TRANSACTIONCODE.       10639754
106400     MOVE WST00000-TRAN-NBR       TO WS045-TRANSACTIONNUMBER.     10640019
106500     MOVE WST00000-PIX-SEQ-NBR    TO WS045-SEQUENCENUMBER.        10650019
106600     MOVE WST00000-WHSE           TO WS045-WAREHOUSE.             10660019
106700     MOVE WST00000-CO             TO WS045-COMPANY.               10670019
106800     MOVE WST00000-DIV            TO WS045-DIVISIO1.              10680019
106900     MOVE WST00000-CASE-NBR       TO WS045-CASENUMBER.            10690019
107000     MOVE WST00000-SKU-ID         TO WS045-SKUID.                 10700019
107100     MOVE WST00000-STYLE-SFX      TO WS045-STYLESUFFIX.           10710019
107200     MOVE WST00000-INVN-TYPE      TO WS045-INVENTORYTYPE.         10720019
107300     MOVE WST00000-PROD-STAT      TO WS045-PRODUCTSTATUS.         10730019
107400     MOVE WST00000-BATCH-NBR      TO WS045-BATCHNUMBER.           10740019
107500     MOVE WST00000-SKU-ATTR-1     TO WS045-SKUATTRIBUTE1.         10750019
107600     MOVE WST00000-SKU-ATTR-2     TO WS045-SKUATTRIBUTE2.         10760019
107700     MOVE WST00000-SKU-ATTR-3     TO WS045-SKUATTRIBUTE3.         10770019
107800     MOVE WST00000-SKU-ATTR-4     TO WS045-SKUATTRIBUTE4.         10780019
107900     MOVE WST00000-SKU-ATTR-5     TO WS045-SKUATTRIBUTE5.         10790019
108000     MOVE WST00000-CNTRY-OF-ORGN  TO WS045-COUNTRYOFORGIN.        10800019
108100     MOVE WST00000-INVN-ADJMT-QTY TO WS045-INVADJUSTMENTQTY.      10810019
108200     MOVE WST00000-INVN-ADJMT-TYPE TO WS045-INVADJUSTMENTTYPE.    10820019
108300     MOVE WST00000-WT-ADJMT-QTY   TO                              10830007
108400                                WS045-WEIGHTADJUSTMENTQUANTITY.   10840019
108500     MOVE WST00000-WT-ADJMT-TYPE  TO WS045-WEIGHTADJUSTMENTTYPE.  10850019
108600     MOVE WST00000-UOM            TO WS045-UNITOFMEASURE.         10860019
108700     MOVE WST00000-REF-WHSE       TO WS045-REFERENCEWHSE.         10870019
108800     MOVE WST00000-RSN-CODE       TO WS045-TRANSREASONCODE.       10880019
108900     MOVE WST00000-RCPT-VARI      TO WS045-RECEIPTSVARIANCE.      10890019
109000     MOVE WST00000-RCPT-CMPL      TO WS045-RECEIPTSCOMPLETED.     10900019
109100     MOVE WST00000-CASES-SHPD     TO WS045-CASESSHIPPED.          10910019
109200     MOVE WST00000-UNITS-SHPD     TO WS045-UNITSSHIPPED.          10920019
109300     MOVE WST00000-CASES-RCVD     TO WS045-CASESRECEIVED.         10930019
109400     MOVE WST00000-UNITS-RCVD     TO WS045-UNITSRECEIVED.         10940019
109500     MOVE WST00000-ACTN-CODE      TO WS045-ACTIONCODE.            10950019
109600     MOVE WST00000-CUSTOM-REF     TO WS045-CUSTOMREFERENCE.       10960019
109700     MOVE WST00000-USER-ID        TO WS045-AS400USERID.           10970047
109800     MOVE WST00000-ERROR-CMNT     TO WS045-ERRORCOMMENT.          10980019
109900     MOVE WST00000-REF-CODE-ID-1  TO WS045-REFERENCECODE1.        10990019
110000     MOVE WST00000-REF-FIELD-1    TO WS045-REFERENCE1.            11000019
110100     MOVE WST00000-REF-CODE-ID-2  TO WS045-REFERENCECODE2.        11010019
110200     MOVE WST00000-REF-FIELD-2    TO WS045-REFERENCE2.            11020019
110300     MOVE WST00000-REF-CODE-ID-3  TO WS045-REFERENCECODE3.        11030019
110400     MOVE WST00000-REF-FIELD-3    TO WS045-REFERENCE3.            11040019
110500     MOVE WST00000-REF-CODE-ID-4  TO WS045-REFERENCECODE4.        11050019
110600     MOVE WST00000-REF-FIELD-4    TO WS045-REFERENCE4.            11060019
110700     MOVE WST00000-REF-CODE-ID-5  TO WS045-REFERENCECODE5.        11070019
110800     MOVE WST00000-REF-FIELD-5    TO WS045-REFERENCE5.            11080019
110900     MOVE WST00000-REF-CODE-ID-6  TO WS045-REFERENCECODE6.        11090019
111000     MOVE WST00000-REF-FIELD-6    TO WS045-REFERENCEFIELD6.       11100019
111100     MOVE WST00000-REF-CODE-ID-7  TO WS045-REFERENCECODE7.        11110019
111200     MOVE WST00000-REF-FIELD-7    TO WS045-REFERENCEFIELD7.       11120019
111300     MOVE WST00000-REF-CODE-ID-8  TO WS045-REFERENCECODE8.        11130019
111400     MOVE WST00000-REF-FIELD-8    TO WS045-REFERENCEFIELD8.       11140019
111500     MOVE WST00000-REF-CODE-ID-9  TO WS045-REFERENCECODE9.        11150019
111600     MOVE WST00000-REF-FIELD-9    TO WS045-REFERENCEFIELD9.       11160019
111700     MOVE WST00000-REF-CODE-ID-10 TO WS045-REFERENCECODE10.       11170019
111800     MOVE WST00000-REF-FIELD-10   TO WS045-REFERENCEFIELD10.      11180019
111900     MOVE WST00000-CREATE-DATE-TIME TO WS045-DATECREATED.         11190019
112000     MOVE WST00000-K-DC-NBR       TO WS045-DCNUMBER.              11200019
112100     MOVE WST00000-K-DC-NBR       TO WS045-DC-NUMBER.             11210019
112200     MOVE WST00000-K-ISRT-TMST    TO WS045-INSERT-TMST.           11220019
112300     MOVE WSV00002-PIX-QUE-TEXT   TO WS045-QUEUE.                 11230020
112400     MOVE SPACES                  TO WS045-WEIGHT.                11240019
112500     MOVE SPACES                  TO WS045-RECEIVEDFROM.          11250009
112600                                                                  11260007
112601* JAK 05/2010 - CONVERT DC/STORE TO EFC1 FOR FASHION & CUBISCAN   11260149
112602     IF WS045-QUEUE = 'PIXFASHION' OR                             11260249
112603        WS045-QUEUE = 'PIXCUBISCN'                                11260349
112604*            WST00000-WHSE WILL CONTAIN STORE VALUE FOR THE EFC   11260449
112610         MOVE WST00000-WHSE       TO PV-STORE-CHAR                11261049
112611         MOVE PV-STORE-NBR        TO DK-LOC-ID                    11261149
112617         MOVE PV-STORE-CHAR       TO WS045-WAREHOUSE              11261749
112618         MOVE PV-STORE-NBR        TO DK-LOC-ID                    11261849
112619         PERFORM 6010-GET-DC-NBR                                  11261949
112620*            XLT00010-LOC-NBR WILL CONTAIN EFC1 DC VALUE          11262049
112621         MOVE XLT00010-LOC-NBR    TO WS045-DC-NUMBER              11262149
112622         MOVE '0'                 TO PV-DC-ZERO                   11262249
112623         MOVE XLT00010-LOC-NBR    TO PV-STORE-NBR                 11262349
112624         MOVE PV-STORE-CHAR       TO PV-DC-VALUE                  11262449
112625         MOVE PV-DC-NBR           TO WS045-DCNUMBER               11262549
112640     END-IF.                                                      11264049
112650* JAK 05/2010 - END                                               11265049
112700***************************************************************** 11270004
112800* WRITE OUTPUT RECORD FOR EACH PIX.                               11280004
112900***************************************************************** 11290004
113000 4200-WRITE-PIX-RECORD-OUT.                                       11300007
113100***  DISPLAY 'WSKUT032 - 4200-WRITE-PIX-RECORD-OUT   '.           11310046
113200                                                                  11320004
113300     WRITE PIX-REC-OUT                                            11330009
113400         FROM WS045-PIX-REP-REC.                                  11340004
113500                                                                  11350004
113600     ADD +1 TO PV-TOTAL-RECORDS-OUT.                              11360034
113700     INITIALIZE WS045-PIX-REP-REC.                                11370022
113800                                                                  11380004
113900***************************************************************** 11390008
114000* PERFORM END OF CURSOR - SUMMARIZE RECORDS READ AND WRITTEN AT   11400008
114100* THE END OF EACH CURSOR.                                         11410008
114200***************************************************************** 11420008
114300 5000-WRITE-PIX-CSR-TOTALS.                                       11430009
114400***  DISPLAY 'WSKUT032 - 5000-WRITE-PIX-CSR-TOTALS   '.           11440046
114500                                                                  11450008
114600     DISPLAY '************************************************'.  11460008
114700     DISPLAY '   * WSKUT032 CURSOR SUMMARY STATISTICS *     '     11470008
114800     DISPLAY 'FROM TIMESTAMP: ' WS044-FROM-TMST                   11480008
114900     DISPLAY 'TO TIMESTAMP:   ' WS044-TO-TMST                     11490008
115000     DISPLAY 'PIX TYPE    :   ' WS044-PIX-TYP                     11500008
115100     DISPLAY 'PIX CODE    :   ' WS044-PIX-CDE                     11510008
115200     DISPLAY 'PIX ACTION CODE:' WS044-PIX-ACTN-CDE                11520008
115300     DISPLAY 'QUEUE       :   ' WS044-QUEUE                       11530008
115400     DISPLAY 'DC NUMBER   :   ' WS044-DC-NBR.                     11540008
115401                                                                  11540132
115500     IF PS-EOF-CSR-YES  AND                                       11550032
115510        PS-ALL-PIX-CSR                                            11551032
115600        DISPLAY ' TOTAL ALL PIX CURSOR RECORDS READ: '            11560032
115700                        PV-ALL-PIX-TOTALS-READ                    11570032
115800        DISPLAY ' TOTAL ALL PIX CURSOR RECS WRITTEN: '            11580033
115900                        PV-ALL-PIX-TOTALS-WRITTEN                 11590032
116000     END-IF.                                                      11600008
116010                                                                  11601032
116100     IF PS-EOF-CSR-YES  AND                                       11610032
116110        PS-PIX-TYP-CDE-ACTN-CSR                                   11611032
116200        DISPLAY ' TOTAL PIX-TYP-CDE-ACTN CSR RECORDS READ:'       11620032
116300                        PV-PIX-TYP-ACTN-TOTALS-READ               11630032
116400        DISPLAY ' TOTAL PIX-TYP-CDE-ACTN CSR RECS WRITTEN:'       11640032
116500                        PV-PIX-TYP-ACTN-TOTALS-WRITTEN            11650032
116600     END-IF.                                                      11660008
116610                                                                  11661032
116700     IF PS-EOF-CSR-YES   AND                                      11670032
116710        PS-PIX-TYP-CDE-CSR                                        11671032
116800        DISPLAY ' TOTAL PIX-TYP-CDE CURSOR RECORDS READ  :'       11680032
116900                        PV-PIX-TYP-TOTALS-READ                    11690032
117000        DISPLAY ' TOTAL PIX-TYP-CDE CURSOR RECS WRITTEN  :'       11700032
117100                        PV-PIX-TYP-TOTALS-WRITTEN                 11710032
117200     END-IF.                                                      11720008
117201                                                                  11720132
117210     IF PS-EOF-CSR-YES  AND                                       11721032
117211        PS-PIX-TYP-CSR                                            11721132
117220        DISPLAY ' TOTAL PIX-TYP     CURSOR RECORDS READ  :'       11722032
117230                        PV-PIX-TOTALS-READ                        11723032
117240        DISPLAY ' TOTAL PIX-TYP     CURSOR RECS WRITTEN  :'       11724032
117250                        PV-PIX-TOTALS-WRITTEN                     11725032
117260     END-IF.                                                      11726032
117300     DISPLAY ' '                                                  11730008
117400     DISPLAY '************************************************'.  11740008
117500                                                                  11750008
117619******************************************************************11761956
117620* GETS DC NBR FOR STORE                                           11762056
117630******************************************************************11763056
117631 6010-GET-DC-NBR.                                                 11763149
117632                                                                  11763249
117633       EXEC SQL                                                   11763349
117634        SELECT B.LOC_NBR                                          11763449
117635         INTO :XLT00010-LOC-NBR                                   11763549
117636         FROM XLT_LOC A                                           11763649
117637            , XLT_LOC B                                           11763749
117638        WHERE A.E_BUS_IND     = 'Y'                               11763849
117639          AND A.E_BUS_IND     = B.E_BUS_IND                       11763949
117640          AND A.CTY_NM        = B.CTY_NM                          11764049
117641          AND B.LOC_TYP_CDE   = 'DC'                              11764149
117642          AND A.LOC_NBR       = :DK-LOC-ID                        11764249
117643       END-EXEC                                                   11764349
117644                                                                  11764449
117645     EVALUATE SQLCODE                                             11764549
117646         WHEN 0                                                   11764649
117647             CONTINUE                                             11764749
117648                                                                  11764849
117649         WHEN OTHER                                               11764949
117650             MOVE '6010-GET-DC-NBR'                               11765049
117651                            TO  PV-PARAGRAPH-NME                  11765149
117652             MOVE  SQLCODE  TO  PV-DISP-SQLCODE                   11765249
117653             PERFORM 9998-SQL-ERROR                               11765349
117654     END-EVALUATE.                                                11765449
117655                                                                  11765549
117656* JAK 05/2010 - END                                               11765649
117660***************************************************************** 11766049
117700* PERFORM WRAP-UP, CLOSE FILES, PUT SUMMARY TOTALS ON SYSOUT.     11770004
117800***************************************************************** 11780004
117900 9000-WRAPUP.                                                     11790004
118000     CLOSE PIX-FILE-IN                                            11800004
118100           PIX-FILE-OUT.                                          11810004
118200     SUBTRACT 1 FROM PV-TOTAL-RECORDS-IN.                         11820035
118300                                                                  11830018
118400     DISPLAY '************************************************'.  11840004
118500     DISPLAY '     * WSKUT032 SUMMARY STATISTICS *            '   11850004
118600     DISPLAY '     * EXTRACT PIX REP RECORDS   *            '     11860004
118700     DISPLAY ' TOTAL PIX RECORDS READ          :'                 11870004
118800                        PV-TOTAL-RECORDS-IN                       11880035
118900     DISPLAY ' TOTAL PIX RECORDS WRITTEN       :'                 11890004
119000                        PV-TOTAL-RECORDS-OUT                      11900034
119100     DISPLAY ' '                                                  11910004
119200     DISPLAY '************************************************'.  11920004
119300                                                                  11930004
120600******************************************************************12060004
120700* ABEND ROUTINE FOR BAD SQL CALLS                                *12070004
120800******************************************************************12080004
120900 9998-SQL-ERROR.                                                  12090004
121000     DISPLAY '** ABEND **          =  SQL ERROR'.                 12100029
121010     DISPLAY '** SQLCODE **        = ' PV-DISP-SQLCODE.           12101028
121100     DISPLAY '** PROGRAM **        = ' PC-PGM-NAME.               12110004
121200     DISPLAY '** PARAGRAPH **      = ' PV-PARAGRAPH-NME.          12120004
121300                                                                  12130004
121400******************************************************************12140004
121500* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    12150004
121600* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         12160004
121700* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     12170004
121800* FORMAT.                                                         12180004
121900******************************************************************12190004
122000     COPY DPPD004.                                                12200004
122100                                                                  12210004
122200     EXEC SQL                                                     12220004
122300          COMMIT                                                  12230004
122400     END-EXEC.                                                    12240004
122500*                                                                 12250004
122600     MOVE +4013                      TO PV-ABEND-CODE.            12260004
122700     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         12270004
122800                                                                  12280004
