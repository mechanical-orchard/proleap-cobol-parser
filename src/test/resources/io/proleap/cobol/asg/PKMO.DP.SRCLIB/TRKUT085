000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.              TRKUT085.                               00020059
000300 AUTHOR.                  DAVID KIEFER.                           00030029
000400 DATE-WRITTEN.            AUGUST 2010.                            00040029
000500 DATE-COMPILED.                                                   00050000
000600                                                                  00060000
000700******************************************************************00070000
000800* THIS PROGRAM RETRIEVES THE EXPIRED TRAILER INFORMATION AND     *00080029
000900* THE INFORMATION IS WRITTEN TO A FILE WHERE IT IS READ IN       *00090029
000910* TRKUP085 WHERE THE UPDATES TO THE TABLE ARE MADE.              *00091073
001000******************************************************************00100000
001100 ENVIRONMENT DIVISION.                                            00110000
001200 CONFIGURATION SECTION.                                           00120000
001300                                                                  00130000
001400 INPUT-OUTPUT SECTION.                                            00140000
001500 FILE-CONTROL.                                                    00150000
001600                                                                  00160000
001700     SELECT OUTPUT-FILE                                           00170000
001800        ASSIGN TO OUT01.                                          00180000
001900                                                                  00190000
002000 DATA DIVISION.                                                   00200000
002100 FILE SECTION.                                                    00210000
002200                                                                  00220000
002300 FD  OUTPUT-FILE                                                  00230000
002400     RECORDING MODE IS F                                          00240000
002500     LABEL RECORDS ARE STANDARD                                   00250000
002600     RECORD CONTAINS 200 CHARACTERS                               00260033
002700     DATA RECORD IS OUTPUT-RECORD.                                00270000
002800                                                                  00280000
002900 01  OUTPUT-RECORD               PIC X(200).                      00290033
003000                                                                  00300000
003100                                                                  00310000
003200 WORKING-STORAGE SECTION.                                         00320000
003300                                                                  00330000
003400 01  PROGRAM-CONSTANTS.                                           00340000
003500     05  PC-CALENDAR-ROUTINE         PIC X(8)   VALUE 'DPKUT500'. 00350000
003600                                                                  00360000
003700 01  PROGRAM-SWITCHES.                                            00370000
003800     05  END-OF-TRIPST-SW            PIC X(1)   VALUE 'N'.        00380000
003900         88  END-OF-TRIPST                      VALUE 'Y'.        00390000
004000     05  PS-ERROR-SW                 PIC  X(01)  VALUE 'N'.       00400074
004010         88  PS-ERROR-YES                        VALUE 'Y'.       00401074
004020         88  PS-ERROR-NO                         VALUE 'N'.       00402074
004030     05  PS-CHECK-FA-VE-ALL-VE-SW    PIC  X(01)  VALUE 'N'.       00403078
004040         88  PS-CHECK-FA-VE-ONLY                 VALUE 'N'.       00404078
004050         88  PS-CHECK-ALL-RCVR-VE                VALUE 'Y'.       00405078
004840                                                                  00484000
005700 01  PROGRAM-VARIABLES.                                           00570000
005800                                                                  00580000
005900     05  WS-PROCESS-DATE             PIC X(10).                   00590000
006000     05  WS-STATUS-DATE              PIC X(10).                   00600000
006100                                                                  00610000
006200     05  WS-EST-AR-TMST              PIC X(26).                   00620000
006300     05  FILLER REDEFINES WS-EST-AR-TMST.                         00630000
006400         10  WS-DELIVERY-DATE        PIC X(10).                   00640000
006500         10  FILLER                  PIC X(16).                   00650000
006600                                                                  00660000
006700     05  WS-MAJOR-CLASS              PIC X(2).                    00670000
006800     05  FILLER REDEFINES WS-MAJOR-CLASS.                         00680000
006900         10  WS-CLASS-CHAR-1         PIC X(1).                    00690000
007000         10  WS-CLASS-CHAR-2         PIC X(1).                    00700000
007100                                                                  00710000
007200     05  SUB                         PIC 9(3).                    00720000
007300     05  CLASS-SUB                   PIC 9(2).                    00730000
007500     05  PV-PARAGRAPH-NAME           PIC X(30).                   00750000
007600     05  PV-DB2-OPER-ATTEMPTED       PIC X(30).                   00760000
007620     05  PV-DB2-COUNT                PIC S9(9) VALUE ZEROES COMP. 00762061
007621     05  WS-TRIP-RECORDS             PIC S9(9) VALUE ZEROES       00762174
007622                                               COMP.              00762261
007623                                                                  00762380
007624     05  PV-DISP-NO-DEPART-MSG.                                   00762480
007625         10 PV-DISP-OPER-UNT-ID   PIC X(04) VALUE ZEROES.         00762583
007626         10 FILLER                PIC X(11) VALUE ' SCAC/TRLR:'.  00762680
007627         10 PV-DISP-OWNR-SCAC-ID  PIC X(04) VALUE SPACES.         00762780
007628         10 FILLER                PIC X(01) VALUE '/'.            00762880
007629         10 PV-DISP-VEH-NBR       PIC X(10) VALUE SPACES.         00762980
007630         10 FILLER                PIC X(06) VALUE ' TRIP:'.       00763085
007631         10 PV-DISP-TRIP-ID       PIC Z(10) VALUE ZEROES.         00763180
007632         10 FILLER                PIC X(07) VALUE ' SHPMT:'.      00763285
007634         10 PV-DISP-SHIP-ID       PIC Z(10) VALUE ZEROES.         00763480
007635         10 FILLER                PIC X(03) VALUE ' # '.          00763584
007636         10 FILLER                PIC X(12) VALUE 'NON VE RCVR:'. 00763684
007637         10 PV-DISP-NON-VE-RCVR   PIC Z(06).                      00763786
007638                                                                  00763884
007639 01  ABEND-CODE                PIC S9(04)  VALUE +0 COMP SYNC.    00763984
007640     88 ABEND-4013                         VALUE +4013.           00764061
008200***************************************************************** 00820000
008300*    OUTPUT FILE LAYOUT.                                        * 00830000
008400***************************************************************** 00840000
008500     COPY TRRD065.                                                00850070
008600                                                                  00860000
008700***************************************************************** 00870000
008800*    CALENDAR ROUTINE WORK AREA.                                * 00880000
008900***************************************************************** 00890000
009000     COPY DPWS500.                                                00900000
009100                                                                  00910000
009200***************************************************************** 00920000
009300*    SQL ABEND ROUTINE WORKING STORAGE                          * 00930000
009400***************************************************************** 00940000
009500     COPY DPWS004.                                                00950000
009600                                                                  00960000
010100     EXEC SQL                                                     01010000
010200        INCLUDE TKRPRPM                                           01020000
010300     END-EXEC.                                                    01030000
010400                                                                  01040000
010500     EXEC SQL                                                     01050000
010600        INCLUDE TTRIPST                                           01060000
010700     END-EXEC.                                                    01070000
010800                                                                  01080000
010810     EXEC SQL                                                     01081081
010820        INCLUDE TTRSTYP                                           01082081
010830     END-EXEC.                                                    01083081
010840                                                                  01084081
010850     EXEC SQL                                                     01085081
010860        INCLUDE TVEHICL                                           01086081
010870     END-EXEC.                                                    01087081
010880                                                                  01088081
010890     EXEC SQL                                                     01089081
010891        INCLUDE XLT00010                                          01089181
010892     END-EXEC.                                                    01089281
010893                                                                  01089381
010900     EXEC SQL                                                     01090000
011000        INCLUDE TVHTRIP                                           01100000
011100     END-EXEC.                                                    01110000
011200     EXEC SQL                                                     01120050
011300        INCLUDE TSHIPMT                                           01130051
011400     END-EXEC.                                                    01140050
011500     EXEC SQL                                                     01150063
011600        INCLUDE TSHPTPO                                           01160063
011700     END-EXEC.                                                    01170063
011800     EXEC SQL                                                     01180063
011900        INCLUDE TRECEIV                                           01190063
012000     END-EXEC.                                                    01200063
015250                                                                  01525000
015300     EXEC SQL                                                     01530000
015400        INCLUDE SQLCA                                             01540000
015500     END-EXEC.                                                    01550000
015501                                                                  01550131
015510     EXEC SQL                                                     01551049
015530        DECLARE TRIPST_CURSOR CURSOR FOR                          01553049
015540             SELECT DISTINCT                                      01554074
015550                    A.TRIP_ID,                                    01555074
015560                    B.OPER_UNT_ID,                                01556074
015570                    A.VEH_NBR,                                    01557074
015580                    A.OWNER_SCAC_ID,                              01558074
015590                    G.SHIPT_ID                                    01559074
015600             FROM TVHTRIP A,                                      01560074
015700                  TTRIPST B,                                      01570074
015800                  TTRSTYP C,                                      01580074
015900                  TVEHICL D,                                      01590074
016000                  XLT_LOC E,                                      01600074
016100                  TKRPRPM F,                                      01610074
016200                  TSHIPMT G                                       01620074
016300             WHERE A.TRIP_ID         = B.TRIP_ID                  01630074
016400               AND A.TRIP_ID         = G.TRIP_ID                  01640074
016500               AND B.TRIP_STATUS_CDE = C.TRIP_STATUS_CDE          01650074
016600               AND D.CURR_TRIP_ID    = A.TRIP_ID                  01660074
016700               AND C.PRTY_CDE        = '70'                       01670074
016800               AND E.LOC_NBR         = B.OPER_UNT_ID              01680074
016900               AND E.LOC_TYP_CDE     = 'DC'                       01690074
016910               AND B.OPER_UNT_ID     = F.LOC_ID                   01691074
016920               AND F.SYS_PRC_FUNC_CDE = 'RCDPRT'                  01692074
016930               AND STATUS_DTE <= (CURRENT DATE - F.FUNC_QTY DAYS) 01693074
016940               AND STATUS_DTE >  (CURRENT DATE -                  01694075
016941                                     :KRPRPM-FUNC-QTY DAYS)       01694176
016950               AND C.PRTY_CDE        =                            01695074
016960                  (SELECT MAX(E.PRTY_CDE)                         01696074
016970                    FROM TTRIPST D,                               01697077
016980                         TTRSTYP E                                01698077
016990                    WHERE D.TRIP_ID         = A.TRIP_ID           01699074
016991                      AND D.TRIP_STATUS_CDE = E.TRIP_STATUS_CDE)  01699174
017000     END-EXEC.                                                    01700049
019800                                                                  01980000
020100***********************************************************       02010000
020200 PROCEDURE DIVISION.                                              02020000
020300***********************************************************       02030000
020400     OPEN OUTPUT OUTPUT-FILE.                                     02040000
020410                                                                  02041057
020420     EXEC SQL                                                     02042057
020430         SET :WS-PROCESS-DATE       = CURRENT DATE                02043057
020440     END-EXEC.                                                    02044057
020450                                                                  02045057
020900     PERFORM 1000-GET-TRLR-UNLD-DAYS.                             02090075
020901     PERFORM 1010-CHECK-FA-OR-ALL-VE.                             02090178
020902                                                                  02090278
020903     DISPLAY '************************************************'   02090378
020904     DISPLAY '** TRKUT085 - CHECK FOR FA VE (N) '                 02090479
020905     DISPLAY '**          - CHECK FOR ALL RCVRS VE (Y) '          02090579
020906     DISPLAY '**          - ' PS-CHECK-FA-VE-ALL-VE-SW            02090678
020907     DISPLAY '************************************************'   02090778
020908                                                                  02090878
020910     PERFORM 2000-CREATE-TRIP-STATUS-FILE THRU 2000-EXIT.         02091075
021000                                                                  02100065
021001     DISPLAY '************************************************'   02100136
021002     DISPLAY '** TRKUT085 - RUN DATE ' WS-PROCESS-DATE            02100269
021003     DISPLAY '**          - OUTPUT COUNT ' WS-TRIP-RECORDS        02100357
021004     DISPLAY '************************************************'   02100436
021100                                                                  02110000
021200     CLOSE OUTPUT-FILE.                                           02120000
021300                                                                  02130000
021400     STOP RUN.                                                    02140000
033500                                                                  03350000
033604******************************************************************03360475
033605**SELECT UPPER LIMIT OF NUMBER OF DAYS BACK TO QUERY ON *         03360575
033606**IN MAIN CURSOR *                                                03360675
033609***************************************************************** 03360975
033610 1000-GET-TRLR-UNLD-DAYS.                                         03361075
033611                                                                  03361175
033612     EXEC SQL                                                     03361275
033613          SELECT FUNC_QTY                                         03361375
033614          INTO   :KRPRPM-FUNC-QTY                                 03361475
033615          FROM   TKRPRPM                                          03361575
033616          WHERE  LOC_ID             = 090                         03361675
033617          AND    FUNC_PRC_STAT_CDE  = 'AC'                        03361775
033618          AND    SYS_PRC_FUNC_CDE   = 'TRUNDY'                    03361875
033619     END-EXEC.                                                    03361975
033620                                                                  03362075
033621     EVALUATE TRUE                                                03362175
033622         WHEN SQLCODE = +0                                        03362275
033623              CONTINUE                                            03362375
033624         WHEN SQLCODE = +100                                      03362475
033625              MOVE +90 TO  KRPRPM-FUNC-QTY                        03362575
033626         WHEN OTHER                                               03362675
033627             DISPLAY '** ABEND ** IN TRKUT085'                    03362775
033628             DISPLAY 'PARAGRAPH:1000-GET-TRLR-UNLD-DAYS'          03362875
033629             DISPLAY 'MESSAGE:  SQL ERROR SELECTING FROM TKRPRPM' 03362975
033630             PERFORM 9999-SQL-ERROR    THRU 9999-EXIT             03363075
033631     END-EVALUATE.                                                03363175
033640*                                                                 03364075
033650******************************************************************03365078
033651**SELECT UPPER LIMIT OF NUMBER OF DAYS BACK TO QUERY ON *         03365178
033652**IN MAIN CURSOR *                                                03365278
033653***************************************************************** 03365378
033654 1010-CHECK-FA-OR-ALL-VE.                                         03365478
033655                                                                  03365578
033656     EXEC SQL                                                     03365678
033657          SELECT FUNC_TXT                                         03365782
033658          INTO   :PS-CHECK-FA-VE-ALL-VE-SW                        03365878
033659          FROM   TKRPRPM                                          03365978
033660          WHERE  LOC_ID             = 090                         03366078
033661          AND    FUNC_PRC_STAT_CDE  = 'AC'                        03366178
033662          AND    SYS_PRC_FUNC_CDE   = 'AUTODP'                    03366278
033663     END-EXEC.                                                    03366378
033664                                                                  03366478
033665     EVALUATE TRUE                                                03366578
033666         WHEN SQLCODE = +0                                        03366678
033667              CONTINUE                                            03366778
033668         WHEN SQLCODE = +100                                      03366878
033669              MOVE 'N' TO  PS-CHECK-FA-VE-ALL-VE-SW               03366978
033670         WHEN OTHER                                               03367078
033671             DISPLAY '** ABEND ** IN TRKUT085'                    03367178
033672             DISPLAY 'PARAGRAPH:1010-CHECK-FA-OR-ALL-VE'          03367278
033673             DISPLAY 'MESSAGE:  SQL ERROR SELECTING FROM TKRPRPM' 03367378
033674             PERFORM 9999-SQL-ERROR    THRU 9999-EXIT             03367478
033675     END-EVALUATE.                                                03367578
033676*                                                                 03367678
033680 2000-CREATE-TRIP-STATUS-FILE.                                    03368075
033700                                                                  03370000
033800     EXEC SQL                                                     03380000
033900        OPEN TRIPST_CURSOR                                        03390000
034000     END-EXEC.                                                    03400000
034100                                                                  03410000
034200     IF SQLCODE NOT = +000                                        03420000
034300        MOVE '2000-CREATE-TRIP-STATUS-FILE' TO PV-PARAGRAPH-NAME  03430031
034400        MOVE 'OPEN TRIPST CURSOR' TO PV-DB2-OPER-ATTEMPTED        03440000
034500        PERFORM 9999-SQL-ERROR THRU 9999-EXIT.                    03450032
034600                                                                  03460000
034700     PERFORM 3000-GET-WRITE-RECORD                                03470031
034800        THRU 3000-EXIT                                            03480031
034900           UNTIL END-OF-TRIPST.                                   03490000
035000                                                                  03500000
035100     EXEC SQL                                                     03510000
035200        CLOSE TRIPST_CURSOR                                       03520000
035300     END-EXEC.                                                    03530000
035400                                                                  03540000
035500     IF SQLCODE NOT = +000                                        03550000
035510        MOVE '2000-CREATE-TRIP-STATUS-FILE' TO PV-PARAGRAPH-NAME  03551031
035700        MOVE 'CLOSE TRIPST CURSOR' TO PV-DB2-OPER-ATTEMPTED       03570000
035800        PERFORM 9999-SQL-ERROR THRU 9999-EXIT.                    03580032
035900                                                                  03590000
036000 2000-EXIT.                                                       03600031
036100     EXIT.                                                        03610000
036300                                                                  03630000
036410 3000-GET-WRITE-RECORD.                                           03641031
036600     EXEC SQL                                                     03660000
036700        FETCH TRIPST_CURSOR                                       03670000
036800        INTO :TRIPST-TRIP-ID                                      03680047
036810           , :TRIPST-OPER-UNT-ID                                  03681049
036900           , :VHTRIP-VEH-NBR                                      03690049
037000           , :VHTRIP-OWNER-SCAC-ID                                03700049
037100           , :SHIPMT-SHIPT-ID                                     03710056
037200     END-EXEC.                                                    03720000
037300                                                                  03730000
037400     IF SQLCODE = +000                                            03740000
037410         CONTINUE                                                 03741069
037600     ELSE                                                         03760000
037700         IF SQLCODE = +100                                        03770069
037800             MOVE 'Y' TO END-OF-TRIPST-SW                         03780069
037900             SET PS-ERROR-YES TO TRUE                             03790069
038000         ELSE                                                     03800069
038010             SET PS-ERROR-YES TO TRUE                             03801069
038100             MOVE '3000-GET-WRITE-RECORD' TO PV-PARAGRAPH-NAME    03810069
038200             MOVE 'FETCH TRIPST CURSOR' TO PV-DB2-OPER-ATTEMPTED  03820069
038300             PERFORM 9999-SQL-ERROR THRU 9999-EXIT                03830069
038310         END-IF                                                   03831069
038320     END-IF.                                                      03832069
038400                                                                  03840000
038401     IF  PS-CHECK-FA-VE-ONLY                                      03840178
038402         PERFORM 3100-CHECK-FOR-FRASTRYS THRU 3100-EXIT           03840278
038403     ELSE                                                         03840378
038404         PERFORM 3110-CHECK-ALL-RCVRS-VE                          03840478
038405     END-IF.                                                      03840578
038406                                                                  03840678
038420                                                                  03842061
038460     IF PS-ERROR-NO AND PV-DB2-COUNT = 0                          03846065
038470         ADD +1                    TO WS-TRIP-RECORDS             03847067
038500         MOVE VHTRIP-VEH-NBR       TO TR065-VEH-NBR               03850070
038600         MOVE VHTRIP-OWNER-SCAC-ID TO TR065-OWNR-SCAC-ID          03860070
038700         MOVE TRIPST-TRIP-ID       TO TR065-TRIP-ID               03870070
038710         MOVE SHIPMT-SHIPT-ID      TO TR065-SHIP-ID               03871070
038800         MOVE TRIPST-OPER-UNT-ID   TO TR065-OPER-UNT-ID           03880070
039000                                                                  03900054
039500         WRITE OUTPUT-RECORD                                      03950063
039600             FROM TR065-DATA-RECORD                               03960070
039700     END-IF.                                                      03970062
039950                                                                  03995000
039960     IF PV-DB2-COUNT > 0                                          03996080
039980         MOVE VHTRIP-VEH-NBR       TO PV-DISP-VEH-NBR             03998080
039990         MOVE VHTRIP-OWNER-SCAC-ID TO PV-DISP-OWNR-SCAC-ID        03999080
039991         MOVE TRIPST-TRIP-ID       TO PV-DISP-TRIP-ID             03999180
039992         MOVE SHIPMT-SHIPT-ID      TO PV-DISP-SHIP-ID             03999280
039993         MOVE TRIPST-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID         03999380
039994         MOVE PV-DB2-COUNT         TO PV-DISP-NON-VE-RCVR         03999480
039995                                                                  03999580
039996         DISPLAY PV-DISP-NO-DEPART-MSG                            03999680
039998     END-IF.                                                      03999880
039999                                                                  03999980
040000 3000-EXIT.                                                       04000031
040100     EXIT.                                                        04010000
040101                                                                  04010162
040110 3100-CHECK-FOR-FRASTRYS.                                         04011075
040120     MOVE ZEROES TO PV-DB2-COUNT                                  04012065
040130                                                                  04013065
040200     EXEC SQL                                                     04020060
040300         SELECT COUNT(*)                                          04030060
040400         INTO :PV-DB2-COUNT                                       04040060
040500         FROM  TSHIPMT A                                          04050060
040600              ,TSHPTPO B                                          04060060
040700              ,TRECEIV C                                          04070060
040800        WHERE A.TRIP_ID        = :TRIPST-TRIP-ID                  04080061
040900          AND A.SHIPT_ID       = B.SHIPT_ID                       04090060
041000          AND B.PRIM_SHIPT_IND = 'Y'                              04100060
041100          AND B.PO_NBR         = C.ORD_NBR                        04110060
041200          AND B.REC_SEQ_NBR    = C.REC_SEQ_NBR                    04120060
041300          AND C.FRE_ASTRA_IND  = 'Y'                              04130060
041400          AND C.STATUS_CDE    <> 'VE'                             04140060
041401     END-EXEC.                                                    04140163
041402                                                                  04140263
041403     EVALUATE TRUE                                                04140363
041404         WHEN SQLCODE = +0                                        04140463
041405         WHEN SQLCODE = +100                                      04140563
041406         WHEN SQLCODE = -911                                      04140663
041407             CONTINUE                                             04140763
041409         WHEN OTHER                                               04140963
041410           MOVE '3100-CHECK-FOR-FRASTRYS' TO PV-PARAGRAPH-NAME    04141075
041411           MOVE 'SELECT COUNT STMENT' TO PV-DB2-OPER-ATTEMPTED    04141163
041412           PERFORM 9999-SQL-ERROR THRU 9999-EXIT                  04141264
041415     END-EVALUATE.                                                04141563
041418                                                                  04141863
041427 3100-EXIT.                                                       04142760
041430     EXIT.                                                        04143060
041500                                                                  04150060
041510***************************************************************** 04151078
041520* BEFORE AUTO-DEPARTING THE TRIP, MAKE SURE THAT ALL RECEIVERS ** 04152078
041530* ON THE TRIP ARE VE (VERIFIED)                                ** 04153078
041540***************************************************************** 04154078
041600 3110-CHECK-ALL-RCVRS-VE.                                         04160078
041700     MOVE ZEROES TO PV-DB2-COUNT                                  04170078
041800                                                                  04180078
041900     EXEC SQL                                                     04190078
042000         SELECT COUNT(*)                                          04200078
042100         INTO :PV-DB2-COUNT                                       04210078
042200         FROM  TSHIPMT A                                          04220078
042300              ,TSHPTPO B                                          04230078
042400              ,TRECEIV C                                          04240078
042500        WHERE A.TRIP_ID        = :TRIPST-TRIP-ID                  04250078
042600          AND A.SHIPT_ID       = B.SHIPT_ID                       04260078
042700          AND B.PRIM_SHIPT_IND = 'Y'                              04270078
042800          AND B.PO_NBR         = C.ORD_NBR                        04280078
042900          AND B.REC_SEQ_NBR    = C.REC_SEQ_NBR                    04290078
043100          AND C.STATUS_CDE    <> 'VE'                             04310078
043200     END-EXEC.                                                    04320078
043300                                                                  04330078
043400     EVALUATE TRUE                                                04340078
043500         WHEN SQLCODE = +0                                        04350078
043600         WHEN SQLCODE = +100                                      04360078
043700         WHEN SQLCODE = -911                                      04370078
043800             CONTINUE                                             04380078
043900         WHEN OTHER                                               04390078
044000           MOVE '3110-CHECK-ALL-RCVRS-VE' TO PV-PARAGRAPH-NAME    04400078
044100           MOVE 'SELECT COUNT STMENT' TO PV-DB2-OPER-ATTEMPTED    04410078
044200           PERFORM 9999-SQL-ERROR THRU 9999-EXIT                  04420078
044300     END-EVALUATE.                                                04430078
044400                                                                  04440078
044500                                                                  04450078
084170 9999-SQL-ERROR.                                                  08417000
084200                                                                  08420000
084300     SET ABEND-4013 TO TRUE.                                      08430000
084400                                                                  08440000
084500     DISPLAY '**  PARAGRAPH **  = ' PV-PARAGRAPH-NAME.            08450000
084600     DISPLAY '**  OPERATION **  = ' PV-DB2-OPER-ATTEMPTED.        08460000
084700                                                                  08470000
084800     COPY DPPD004.                                                08480000
084900                                                                  08490000
085000     CALL 'ILBOABN0'  USING ABEND-CODE.                           08500000
085100 9999-EXIT.                                                       08510032
085200     EXIT.                                                        08520032
