000100 IDENTIFICATION DIVISION.                                         00010010
000200 PROGRAM-ID.      XLKUT083.                                       00020037
000300 AUTHOR.          KOHLS DEPARTMENT STORES.                        00030010
000400 INSTALLATION.    KOHLS DEPARTMENT STORES.                        00040010
000500 DATE-WRITTEN.    08/25/2004.                                     00050037
000600 DATE-COMPILED.                                                   00060010
000700******************************************************************00070010
000800**XL DOMAIN TABLE INTEGRITY PROCESS - FOR XLT_MDSE_INV_PARM       00080037
000900******************************************************************00090010
001000**THIS PROGRAM VALIDATES THE DATA IN THE XL DOMAIN IS THE SAME    00100017
001100**AS THE DATA IN THE RMS.                                         00110034
001200******************************************************************00120010
001300**DATE:08/25/2004   MADE BY:VISWA KARUTURI INITIAL PROGRAM WRITE  00130037
001400******************************************************************00140010
001500 ENVIRONMENT DIVISION.                                            00150010
001600 CONFIGURATION SECTION.                                           00160010
001700 SOURCE-COMPUTER.        IBM-3090.                                00170010
001800 OBJECT-COMPUTER.        IBM-3090.                                00180010
001900 INPUT-OUTPUT SECTION.                                            00190010
002000 FILE-CONTROL.                                                    00200010
002100                                                                  00210010
002200     SELECT RMS-INV-FILE                                          00220037
002300            ASSIGN TO INP01.                                      00230010
002400     SELECT XL-INV-FILE                                           00240037
002500            ASSIGN TO INP02.                                      00250010
002600     SELECT DIFFERENCES-FILE                                      00260010
002700            ASSIGN TO OUT01.                                      00270010
002800                                                                  00280010
002900 DATA DIVISION.                                                   00290010
003000 FILE SECTION.                                                    00300010
003100                                                                  00310010
003200 FD  RMS-INV-FILE                                                 00320037
003300     RECORDING MODE F                                             00330010
003400     BLOCK CONTAINS 0 RECORDS                                     00340010
003500     LABEL RECORDS ARE OMITTED                                    00350010
003600     DATA RECORD IS RMS-INV-REC.                                  00360037
003700 01  RMS-INV-REC                     PIC X(330).                  00370057
003800                                                                  00380010
003900 FD  XL-INV-FILE                                                  00390037
004000     RECORDING MODE F                                             00400010
004100     BLOCK CONTAINS 0 RECORDS                                     00410010
004200     LABEL RECORDS ARE OMITTED                                    00420010
004300     DATA RECORD IS XL-INV-REC.                                   00430037
004400 01  XL-INV-REC                      PIC X(306).                  00440063
004500                                                                  00450010
004600 FD  DIFFERENCES-FILE                                             00460010
004700     RECORDING MODE F                                             00470010
004800     BLOCK CONTAINS 0 RECORDS                                     00480010
004900     LABEL RECORDS ARE OMITTED                                    00490010
005000     DATA RECORD IS DIFFERENCES-RECORD.                           00500010
005100 01  DIFFERENCES-RECORD              PIC X(330).                  00510057
005200                                                                  00520010
005300 WORKING-STORAGE SECTION.                                         00530010
005400******************************************************************00540010
005500**SWITCHES                                                        00550010
005600******************************************************************00560010
005700 01  PS-PROGRAM-SWITCHES.                                         00570010
005800     05  PS-END-OF-FILE-SW               PIC X(01) VALUE 'N'.     00580035
005900         88  PS-END-OF-FILE                        VALUE 'Y'.     00590035
006000         88  PS-NOT-END-OF-FILE                    VALUE 'N'.     00600035
006100     05  PS-END-OF-RMS-INV-SW            PIC X(01) VALUE 'N'.     00610037
006200         88  PS-END-OF-RMS-INV                     VALUE 'Y'.     00620037
006300         88  PS-NOT-END-OF-RMS-INV                 VALUE 'N'.     00630037
006400     05  PS-END-OF-XL-INV-SW             PIC X(01) VALUE 'N'.     00640037
006500         88  PS-END-OF-XL-INV                      VALUE 'Y'.     00650037
006600         88  PS-NOT-END-OF-XL-INV                  VALUE 'N'.     00660037
006700******************************************************************00670010
006800**PROGRAM CONSTANTS                                               00680010
006900******************************************************************00690010
007000 01  PC-PROGRAM-CONSTANTS.                                        00700010
007100     05  PC-CURRENT-PROGRAM-NAME         PIC X(08)                00710010
007200                                                 VALUE 'XLKUT083'.00720037
007300******************************************************************00730010
007400**PROGRAM COUNTERS                                                00740010
007500******************************************************************00750010
007600 01  PC-PROGRAM-COUNTER.                                          00760010
007700     05  PC-RECORD-COUNT                 PIC S9(09) VALUE ZEROS   00770010
007800                                                    COMP-3.       00780010
007900     05  PC-RMS-INV-RECS-READ            PIC 9(09) VALUE ZEROS.   00790037
008000     05  PC-XL-INV-RECS-READ             PIC 9(09) VALUE ZEROS.   00800037
008100     05  PC-DIFFER-RECORD-WRITTEN        PIC 9(09) VALUE ZEROS.   00810035
008200******************************************************************00820044
008300**CONTROL CARD                                                    00830044
008400******************************************************************00840044
008500 01  CONTROL-CARD-DATA.                                           00850044
008600     05  CC-PROGRAM-NAME              PIC X(01) VALUE SPACES.     00860044
008700         88  CC-NIGHTLY-MAINT               VALUE '1'.            00870044
008800         88  CC-DATA-INTEGRITY              VALUE '2'.            00880044
008900     05  CC-FILLER                    PIC X(79) VALUE SPACES.     00890044
009000******************************************************************00900010
009100**ERROR HANDLING                                                  00910010
009200******************************************************************00920010
009300 01  PV-MISC-ABEND-FIELDS.                                        00930010
009400     05  PV-PARAGRAPH-NAME            PIC X(30) VALUE SPACE.      00940010
009500     05  PV-OPERATION-MSG-1           PIC X(40) VALUE SPACE.      00950010
009600     05  PV-OPERATION-MSG-2           PIC X(40) VALUE SPACE.      00960010
009700     05  PV-DB2-OPERATION             PIC X(30) VALUE SPACE.      00970010
009800 01  ABEND-CODE                  PIC S9(4) VALUE ZEROS COMP SYNC. 00980010
009900     88  ABEND-4013-DB2-ERROR              VALUE +4013.           00990010
010000******************************************************************01000010
010100**COPYBOOKS                                                       01010010
010200******************************************************************01020010
010300***RMS EXTRACT FILE LAYOUT                                        01030034
010400     COPY INRD901.                                                01040038
010500***DIFFERENCE FILE LAYOUT                                         01050038
010600     COPY XLRD053.                                                01060039
010700***VARIABLES REQUIRED FOR THE FORMAT SQLCA ROUTINE DPPD004        01070010
010800     COPY DPWS004.                                                01080010
010801***LAYOUT OF INPUT FROM DSNINTAUL UTILITY                         01090072
010810     COPY XLRD064.                                                01100072
010900***DB2 ABEND COPYBOOK                                             01110010
011000***  COPY DPWS900.                                                01120073
011100***DB2 MESSAGE AREA                                               01130010
011200***  COPY SQLCA2.                                                 01140073
011300******************************************************************01150010
011400**TABLE INCLUSIONS                                                01160010
011500******************************************************************01170010
011600***DB2 COMMUNICATIONS AREA                                        01180010
011700***  EXEC SQL                                                     01190073
011800***       INCLUDE SQLCA                                           01200073
011900***  END-EXEC.                                                    01210073
012000***TABLE XLT_MDSE_INV_PARM                                        01220042
012100***  EXEC SQL                                                     01230070
012200***       INCLUDE XLT00025                                        01240070
012300***  END-EXEC.                                                    01250070
012400                                                                  01260010
012500 PROCEDURE DIVISION.                                              01270010
012600***************************************************************** 01280010
012700 0000-MAINLINE.                                                   01290055
012800*                                                                 01300085
012900     PERFORM 1000-INITIALIZATION.                                 01310010
013000*                                                                 01320085
013800     PERFORM 2000-PROCESS-INV-REC                                 01330039
013900             UNTIL PS-END-OF-RMS-INV                              01340039
014000                OR PS-END-OF-XL-INV.                              01350039
013000*                                                                 01360085
014200     PERFORM 3000-PROCESS-EXTRA-INV-REC                           01370039
014300             UNTIL PS-END-OF-RMS-INV                              01380039
014400               AND PS-END-OF-XL-INV.                              01390039
014500*                                                                 01400085
014600     PERFORM 9999-WRAPUP.                                         01410010
014700     GOBACK.                                                      01420010
014800                                                                  01430010
014900 EJECT.                                                           01440010
015000******************************************************************01450010
015100**INITIALIZATION AREA                                             01460010
015200******************************************************************01470010
015300 1000-INITIALIZATION.                                             01480010
015400                                                                  01490010
015500     MOVE '1000-INITIALIZATION' TO PV-PARAGRAPH-NAME.             01500010
015600                                                                  01510010
015700     INITIALIZE PC-PROGRAM-COUNTER.                               01520010
015800                                                                  01530010
015900     ACCEPT CONTROL-CARD-DATA FROM SYSIN.                         01540044
016000                                                                  01550044
016100     OPEN INPUT  RMS-INV-FILE                                     01560039
016200                 XL-INV-FILE                                      01570039
016300          OUTPUT DIFFERENCES-FILE.                                01580010
016400                                                                  01590010
016500     SET PS-NOT-END-OF-FILE         TO TRUE.                      01600046
016600     SET PS-NOT-END-OF-RMS-INV      TO TRUE.                      01610039
016700     SET PS-NOT-END-OF-XL-INV       TO TRUE.                      01620039
016800                                                                  01630019
016900     PERFORM 9000-READ-RMS-INV.                                   01640039
017000     PERFORM 9100-READ-XL-INV.                                    01650039
017100                                                                  01660010
017200 EJECT.                                                           01670010
017300******************************************************************01680010
017400**PROCESSES INPUT FILE                                            01690010
017500******************************************************************01700010
017600 2000-PROCESS-INV-REC.                                            01710046
017700                                                                  01720010
017800     MOVE '2000-PROCESS-INV-REC' TO PV-PARAGRAPH-NAME.            01730046
018000     INITIALIZE XL053-INVPAR-TRANS-REC.                           01740039
      *                                                                 01750085
      *----------------------------------------------------------------*01760085
      * CASE 1: WHEN THE INVENTORY ID, LOCATION ARE SAME THEN CHECK    *01770086
      * IF OTHER DETAILS FOR THE RECORD ARE SAME. IF THERE ARE ANY     *01780086
      * CHANGES IN THE SAME THEN THE RECORD NEEDS TO BE UPDATED.       *01790086
      *----------------------------------------------------------------*01800085
      *                                                                 01810085
           IF  IN901-INV-ID       = XL064-INV-ID                        01820085
           AND IN901-LOC-NBR      = XL064-LOC-NBR                       01830085
               SET XL053-MODIFY   TO TRUE                               01840090
           END-IF                                                       01850085
      *                                                                 01860085
      *----------------------------------------------------------------*01870085
      * CASE 2: WHEN THE INVENTORY ID IN THE INPUT FILE IS NOT SAME AS *01880086
      * THAT OF TABLE THEN THE RECORD NEEDS TO BE EITHER INSERTED OR   *01890086
      * DELETED FROM THE TABLE.                                        *01900086
      *----------------------------------------------------------------*01910085
      *                                                                 01920085
           IF  IN901-INV-ID           NOT = XL064-INV-ID                01930097
              IF  IN901-INV-ID        > XL064-INV-ID                    01940097
                  SET XL053-DELETE    TO TRUE                           01950097
              ELSE                                                      01960097
                  SET XL053-INSERT    TO TRUE                           01970097
              END-IF                                                    01980097
           END-IF                                                       01990097
      *                                                                 02000085
      *                                                                 02010088
      *----------------------------------------------------------------*02020088
      * CASE 3: WHEN THE INVENTORY ID IN THE INPUT FILE IS SAME AS     *02030088
      * THAT OF TABLE BUT THE LOCATION ID HAS BEEN CHANGED THEN THE    *02040088
      * RECORDS NEEDS TO BE EITHER INSERTED OR DELETED FROM THE TABLE. *02050088
      *----------------------------------------------------------------*02060088
      *                                                                 02070088
           IF  IN901-INV-ID        = XL064-INV-ID                       02080088
           AND IN901-LOC-NBR       NOT = XL064-LOC-NBR                  02090088
               IF IN901-LOC-NBR    > XL064-LOC-NBR                      02100088
                  SET XL053-DELETE TO TRUE                              02110088
               ELSE                                                     02120088
019100            SET XL053-INSERT  TO TRUE                             02130088
               END-IF                                                   02140088
           END-IF                                                       02150088
      *                                                                 02160088
           IF XL053-DELETE                                              02170088
              PERFORM 9500-MOVE-XL-INV-VALUES                           02180088
              PERFORM 9800-WRITE-DIFFER-RECORD                          02190088
              PERFORM 9100-READ-XL-INV                                  02200088
           END-IF                                                       02210088
      *                                                                 02220088
           IF XL053-INSERT                                              02230088
019200        PERFORM 9400-MOVE-RMS-INV-VALUES                          02240088
019300        PERFORM 9800-WRITE-DIFFER-RECORD                          02250088
019400        PERFORM 9000-READ-RMS-INV                                 02260088
           END-IF.                                                      02270089
      *                                                                 02280088
           IF XL053-MODIFY                                              02290090
               PERFORM 2200-COMPARE-INV-FIELDS                          02300090
               PERFORM 9000-READ-RMS-INV                                02310090
               PERFORM 9100-READ-XL-INV                                 02320090
           END-IF .                                                     02330090
022300******************************************************************02340010
022400**COMPARES ALL FIELDS TO SEE IF DIFFERENCES EXIST                 02350013
022500******************************************************************02360010
022600 2200-COMPARE-INV-FIELDS.                                         02370043
022700                                                                  02380010
022800     MOVE '2200-COMPARE-INV-FIELDS' TO PV-PARAGRAPH-NAME.         02390043
022820     INSPECT XL064-INV-NM-TEXT REPLACING ALL LOW-VALUES BY SPACE. 02400078
022900                                                                  02410010
023000     IF XL064-PLND-INV-DTE          NOT = IN901-PLND-INV-DTE      02420079
           OR XL064-INV-DTE               NOT = IN901-INV-DTE           02430091
023100     OR XL064-SCN-INV-IND           NOT = IN901-SCN-INV-IND       02440079
023200     OR XL064-UNIT-BK-DTE           NOT = IN901-UNIT-BK-DTE       02450079
023300     OR XL064-FIN-BK-DTE            NOT = IN901-FIN-BK-DTE        02460079
023400     OR XL064-PLND-UNIT-BK-DTE      NOT = IN901-PLND-UNIT-BK-DTE  02470079
023500     OR XL064-PLND-FIN-BK-DTE       NOT = IN901-PLND-FIN-BK-DTE   02480079
023600     OR XL064-INV-RCVD-DTE          NOT = IN901-INV-RCVD-DTE      02490079
023700     OR XL064-STKRM-DAY-QTY         NOT = IN901-STKRM-DAY-QTY     02500079
023800     OR XL064-CORR-DAY-QTY          NOT = IN901-CORR-DAY-QTY      02510079
023900     OR XL064-SOR-LAST-UPD-TMST     NOT = IN901-LAST-UPD-TMST     02520079
024000     OR XL064-SOR-UPD-BY-USR-ID     NOT = IN901-LAST-UPD-BY-USR-ID02530079
024100     OR XL064-LDGR-CTOFF-TMST       NOT = IN901-LDGR-CTOFF-TMST   02540079
024200     OR XL064-DC-CTOFF-DTE          NOT = IN901-DC-CTOFF-DTE      02550079
024300     OR XL064-PHY-CNT-TMST          NOT = IN901-PHY-CNT-TMST      02560079
024400     OR XL064-SLS-ADJ-CPLD-IND      NOT = IN901-SLS-ADJ-CPLD-IND  02570079
024500     OR XL064-SCHD-PHY-CNT-CDE      NOT = IN901-SCHD-PHY-CNT-CDE  02580079
024600     OR XL064-XFER-INV-CTOFF-DTE    NOT = IN901-XFER-INV-CTOFF-DTE02590079
024700     OR XL064-SHEET-INV-CPLD-IND    NOT = IN901-SHEET-INV-CPLD-IND02600079
024800     OR XL064-UNT-BKG-STAT-CDE      NOT = IN901-UNT-BKG-STAT-CDE  02610079
024900     OR XL064-FIL-TOT-BAL-CDE       NOT = IN901-FIL-TOT-BAL-CDE   02620079
025000     OR XL064-STKRM-WDRWL-IND       NOT = IN901-STKRM-WDRWL-IND   02630079
025100     OR XL064-MFSTNG-IND            NOT = IN901-MFSTNG-IND        02640079
025200     OR XL064-INV-SRVC-CDE          NOT = IN901-INV-SRVC-CDE      02650079
025300     OR XL064-SHEET-INV-REQR-IND    NOT = IN901-SHEET-INV-REQR-CDE02660079
025400     OR XL064-TMST-EDT-STAT-CDE     NOT = IN901-TMST-EDT-STAT-CDE 02670079
025410     OR XL064-INV-NM                NOT = IN901-INV-NM            02680079
025420     OR XL064-ACTV-IND              NOT = IN901-ACTV-IND          02690079
025430     OR XL064-OPN-FSCL-MN-NBR       NOT = IN901-OPN-FSCL-MN-NBR   02700079
025440     OR XL064-OPN-FSCL-MN-DTE       NOT = IN901-OPN-FSCL-MN-DTE   02710079
025450     OR XL064-ITM-CTOFF-IND         NOT = IN901-ITM-CTOFF-IND     02720079
025460     OR XL064-SHTG-ACTL-INV-DTE     NOT = IN901-SHTG-ACTL-INV-DTE 02730079
025470     OR XL064-JOB-NM                NOT = IN901-LAST-UPD-JOB-NM   02740079
025480     OR XL064-INV-CLO-DTE           NOT = IN901-INV-CLO-DTE       02750079
025490     OR XL064-FINCL-INV-STAT-CDE    NOT = IN901-FINCL-INV-STAT-CDE02760079
025491     OR XL064-LOC-INV-STAT-CDE      NOT = IN901-LOC-INV-STAT-CDE  02770079
025492     OR XL064-LOC-DEL-RSN-TXT       NOT = IN901-LOC-DEL-RSN-TXT   02780079
025493     OR XL064-LOC-DEL-DTE           NOT = IN901-LOC-DEL-DTE       02790079
025500         SET XL053-MODIFY   TO TRUE                               02800039
025510         DISPLAY                                                  02810079
025520        XL064-INV-ID                '--' IN901-INV-ID             02820099
025510         DISPLAY                                                  02830099
025520        XL064-LOC-NBR               '--' IN901-LOC-NBR            02840099
025510         DISPLAY                                                  02850099
025520        XL064-INV-DTE               '--' IN901-INV-DTE            02860099
025510         DISPLAY                                                  02870099
025520        XL064-PLND-INV-DTE          '--' IN901-PLND-INV-DTE       02880099
025521         DISPLAY                                                  02890079
025530        XL064-SCN-INV-IND           '--' IN901-SCN-INV-IND        02900079
025531         DISPLAY                                                  02910079
025540        XL064-UNIT-BK-DTE           '--' IN901-UNIT-BK-DTE        02920079
025541         DISPLAY                                                  02930079
025550        XL064-FIN-BK-DTE            '--' IN901-FIN-BK-DTE         02940079
025551         DISPLAY                                                  02950079
025560        XL064-PLND-UNIT-BK-DTE      '--' IN901-PLND-UNIT-BK-DTE   02960079
025561         DISPLAY                                                  02970079
025570        XL064-PLND-FIN-BK-DTE       '--' IN901-PLND-FIN-BK-DTE    02980079
025571         DISPLAY                                                  02990079
025580        XL064-INV-RCVD-DTE          '--' IN901-INV-RCVD-DTE       03000079
025581         DISPLAY                                                  03010079
025590        XL064-STKRM-DAY-QTY         '--' IN901-STKRM-DAY-QTY      03020079
025591         DISPLAY                                                  03030079
025592        XL064-CORR-DAY-QTY          '--' IN901-CORR-DAY-QTY       03040079
025593         DISPLAY                                                  03050079
025594        XL064-SOR-LAST-UPD-TMST     '--' IN901-LAST-UPD-TMST      03060079
025595         DISPLAY                                                  03070079
025596        XL064-SOR-UPD-BY-USR-ID     '--' IN901-LAST-UPD-BY-USR-ID 03080079
025597         DISPLAY                                                  03090079
025598        XL064-LDGR-CTOFF-TMST       '--' IN901-LDGR-CTOFF-TMST    03100079
025599         DISPLAY                                                  03110079
025600        XL064-DC-CTOFF-DTE          '--' IN901-DC-CTOFF-DTE       03120079
025601         DISPLAY                                                  03130079
025602        XL064-PHY-CNT-TMST          '--' IN901-PHY-CNT-TMST       03140079
025603         DISPLAY                                                  03150079
025604        XL064-SLS-ADJ-CPLD-IND      '--' IN901-SLS-ADJ-CPLD-IND   03160079
025605         DISPLAY                                                  03170079
025606        XL064-SCHD-PHY-CNT-CDE      '--' IN901-SCHD-PHY-CNT-CDE   03180079
025607         DISPLAY                                                  03190079
025608        XL064-XFER-INV-CTOFF-DTE '--' IN901-XFER-INV-CTOFF-DTE    03200079
025609         DISPLAY                                                  03210079
025610        XL064-SHEET-INV-CPLD-IND '--' IN901-SHEET-INV-CPLD-IND    03220079
025611         DISPLAY                                                  03230079
025612        XL064-UNT-BKG-STAT-CDE      '--' IN901-UNT-BKG-STAT-CDE   03240079
025613         DISPLAY                                                  03250079
025614        XL064-FIL-TOT-BAL-CDE       '--' IN901-FIL-TOT-BAL-CDE    03260079
025615         DISPLAY                                                  03270079
025616        XL064-STKRM-WDRWL-IND       '--' IN901-STKRM-WDRWL-IND    03280079
025617         DISPLAY                                                  03290079
025618        XL064-MFSTNG-IND            '--' IN901-MFSTNG-IND         03300079
025619         DISPLAY                                                  03310079
025620        XL064-INV-SRVC-CDE          '--' IN901-INV-SRVC-CDE       03320079
025621         DISPLAY                                                  03330079
025622        XL064-SHEET-INV-REQR-IND '--' IN901-SHEET-INV-REQR-CDE    03340079
025623         DISPLAY                                                  03350079
025624        XL064-TMST-EDT-STAT-CDE     '--' IN901-TMST-EDT-STAT-CDE  03360079
025625         DISPLAY                                                  03370075
025626        XL064-INV-NM                '--' IN901-INV-NM             03380075
025631         DISPLAY                                                  03390079
025632        XL064-ACTV-IND              '--' IN901-ACTV-IND           03400079
025633         DISPLAY                                                  03410079
025634        XL064-OPN-FSCL-MN-NBR       '--' IN901-OPN-FSCL-MN-NBR    03420079
025635         DISPLAY                                                  03430079
025636        XL064-OPN-FSCL-MN-DTE       '--' IN901-OPN-FSCL-MN-DTE    03440079
025637         DISPLAY                                                  03450079
025638        XL064-ITM-CTOFF-IND         '--' IN901-ITM-CTOFF-IND      03460079
025639         DISPLAY                                                  03470079
025640        XL064-SHTG-ACTL-INV-DTE     '--' IN901-SHTG-ACTL-INV-DTE  03480079
025641         DISPLAY                                                  03490079
025642        XL064-JOB-NM                '--' IN901-LAST-UPD-JOB-NM    03500079
025643         DISPLAY                                                  03510079
025644        XL064-INV-CLO-DTE           '--' IN901-INV-CLO-DTE        03520079
025645         DISPLAY                                                  03530079
025646        XL064-FINCL-INV-STAT-CDE '--' IN901-FINCL-INV-STAT-CDE    03540079
025647         DISPLAY                                                  03550079
025648        XL064-LOC-INV-STAT-CDE      '--' IN901-LOC-INV-STAT-CDE   03560079
025649         DISPLAY                                                  03570079
025650        XL064-LOC-DEL-RSN-TXT       '--' IN901-LOC-DEL-RSN-TXT    03580079
025651         DISPLAY                                                  03590079
025652        XL064-LOC-DEL-DTE           '--' IN901-LOC-DEL-DTE        03600079
025653         DISPLAY '***************************'                    03610068
025660         PERFORM 9400-MOVE-RMS-INV-VALUES                         03620039
025700         PERFORM 9800-WRITE-DIFFER-RECORD                         03630034
025800     END-IF.                                                      03640010
025900                                                                  03650010
026000 EJECT.                                                           03660010
026100******************************************************************03670010
026200**COMPLETE PROCESSING OF EXTRACT RECORDS IF THEY EXIST            03680013
026300******************************************************************03690010
026400 3000-PROCESS-EXTRA-INV-REC.                                      03700040
026500                                                                  03710010
026600     MOVE '3000-PROCESS-EXTRA-INV-REC' TO PV-PARAGRAPH-NAME.      03720040
026700                                                                  03730010
026800     IF  PS-NOT-END-OF-RMS-INV                                    03740040
026900         SET XL053-INSERT   TO TRUE                               03750040
027000         PERFORM 9400-MOVE-RMS-INV-VALUES                         03760040
027100         PERFORM 9800-WRITE-DIFFER-RECORD                         03770034
027200         PERFORM 9000-READ-RMS-INV                                03780040
027300     END-IF.                                                      03790010
027400                                                                  03800010
027500     IF  PS-NOT-END-OF-XL-INV                                     03810040
               DISPLAY 'END OF FILE'                                    03820080
027600         SET XL053-DELETE   TO TRUE                               03830040
027700         PERFORM 9500-MOVE-XL-INV-VALUES                          03840040
027800         PERFORM 9800-WRITE-DIFFER-RECORD                         03850034
027900         PERFORM 9100-READ-XL-INV                                 03860040
028000     END-IF.                                                      03870010
028100                                                                  03880010
028200 EJECT.                                                           03890010
028300***************************************************************** 03900010
028400**READ RMS EXTRACT FILE                                           03910040
028500***************************************************************** 03920010
028600 9000-READ-RMS-INV.                                               03930040
028700                                                                  03940010
028800     READ RMS-INV-FILE INTO IN901-INVPAR-COMMON-EXTRACT           03950048
028900         AT END                                                   03960023
029000             SET PS-END-OF-RMS-INV TO TRUE                        03970040
029100             SET PS-END-OF-FILE    TO TRUE                        03980044
029200     END-READ.                                                    03990023
029300                                                                  04000010
029400     IF  PS-NOT-END-OF-RMS-INV                                    04010040
029500         ADD +1 TO PC-RMS-INV-RECS-READ                           04020040
029600     END-IF.                                                      04030010
029700                                                                  04040010
029800 EJECT.                                                           04050010
029900***************************************************************** 04060010
030000**READ XL EXTRACT FILE                                            04070016
030100***************************************************************** 04080010
030200 9100-READ-XL-INV.                                                04090042
030300                                                                  04100010
030400     READ XL-INV-FILE INTO XL064-DCLXLT0025                       04110071
030500         AT END                                                   04120040
030600             SET PS-END-OF-XL-INV  TO TRUE                        04130040
030700             SET PS-END-OF-FILE    TO TRUE                        04140044
030800     END-READ.                                                    04150040
030900                                                                  04160040
031000     IF  PS-NOT-END-OF-XL-INV                                     04170040
031100         ADD +1 TO PC-XL-INV-RECS-READ                            04180040
031200     END-IF.                                                      04190040
031300                                                                  04200010
031400 EJECT.                                                           04210010
031500***************************************************************** 04220010
031600**MOVES RMS EXTRACT VALUES TO ERROR RECORD                        04230040
031700***************************************************************** 04240010
031800 9400-MOVE-RMS-INV-VALUES.                                        04250040
031900                                                                  04260010
032000     MOVE IN901-INV-ID                TO XL053-INV-ID.            04270057
032010     MOVE IN901-LOC-NBR               TO XL053-LOC-NBR.           04280057
032100     MOVE IN901-INV-DTE               TO XL053-INV-DTE.           04290040
032200     MOVE IN901-PLND-INV-DTE          TO XL053-PLND-INV-DTE.      04300040
032300     MOVE IN901-SCN-INV-IND           TO XL053-SCN-INV-IND.       04310040
032400     MOVE IN901-UNIT-BK-DTE           TO XL053-UNIT-BK-DTE.       04320040
032500     MOVE IN901-FIN-BK-DTE            TO XL053-FIN-BK-DTE.        04330040
032600     MOVE IN901-PLND-UNIT-BK-DTE      TO XL053-PLND-UNIT-BK-DTE.  04340040
032700     MOVE IN901-PLND-FIN-BK-DTE       TO XL053-PLND-FIN-BK-DTE.   04350040
032800     MOVE IN901-INV-RCVD-DTE          TO XL053-INV-RCVD-DTE.      04360040
032900     MOVE IN901-STKRM-DAY-QTY         TO XL053-STKRM-DAY-QTY.     04370040
033000     MOVE IN901-CORR-DAY-QTY          TO XL053-CORR-DAY-QTY.      04380048
033100     MOVE IN901-LAST-UPD-TMST         TO XL053-SOR-LAST-UPD-TMST. 04390047
033200     MOVE IN901-LAST-UPD-BY-USR-ID    TO XL053-SOR-UPD-BY-USR-ID. 04400050
033300     MOVE IN901-LDGR-CTOFF-TMST       TO XL053-LDGR-CTOFF-TMST.   04410040
033400     MOVE IN901-DC-CTOFF-DTE          TO XL053-DC-CTOFF-DTE.      04420040
033500     MOVE IN901-PHY-CNT-TMST          TO XL053-PHY-CNT-TMST.      04430040
033600     MOVE IN901-SLS-ADJ-CPLD-IND      TO XL053-SLS-ADJ-CPLD-IND.  04440040
033700     MOVE IN901-SCHD-PHY-CNT-CDE      TO XL053-SCHD-PHY-CNT-CDE . 04450040
033800     MOVE IN901-XFER-INV-CTOFF-DTE    TO XL053-XFER-INV-CTOFF-DTE.04460040
033900     MOVE IN901-SHEET-INV-CPLD-IND    TO XL053-SHEET-INV-CPLD-IND.04470040
034000     MOVE IN901-UNT-BKG-STAT-CDE      TO XL053-UNT-BKG-STAT-CDE.  04480040
034100     MOVE IN901-FIL-TOT-BAL-CDE       TO XL053-FIL-TOT-BAL-CDE.   04490040
034200     MOVE IN901-STKRM-WDRWL-IND       TO XL053-STKRM-WDRWL-IND.   04500040
034300     MOVE IN901-MFSTNG-IND            TO XL053-MFSTNG-IND.        04510040
034400     MOVE IN901-INV-SRVC-CDE          TO XL053-INV-SRVC-CDE.      04520040
034500     MOVE IN901-SHEET-INV-REQR-CDE    TO XL053-SHEET-INV-REQR-IND.04530050
034600     MOVE IN901-TMST-EDT-STAT-CDE     TO XL053-TMST-EDT-STAT-CDE. 04540040
034610     MOVE IN901-INV-NM                TO XL053-INV-NM.            04550057
034620     MOVE IN901-ACTV-IND              TO XL053-ACTV-IND.          04560057
034630     MOVE IN901-OPN-FSCL-MN-NBR       TO XL053-OPN-FSCL-MN-NBR.   04570057
034640     MOVE IN901-OPN-FSCL-MN-DTE       TO XL053-OPN-FSCL-MN-DTE.   04580057
034650     MOVE IN901-ITM-CTOFF-IND         TO XL053-ITM-CTOFF-IND.     04590057
034660     MOVE IN901-SHTG-ACTL-INV-DTE     TO XL053-SHTG-ACTL-INV-DTE. 04600057
034670     MOVE IN901-LAST-UPD-JOB-NM       TO XL053-JOB-NM.            04610062
034680     MOVE IN901-INV-CLO-DTE           TO XL053-INV-CLO-DTE.       04620057
034690     MOVE IN901-FINCL-INV-STAT-CDE    TO XL053-FINCL-INV-STAT-CDE.04630057
034691     MOVE IN901-LOC-INV-STAT-CDE      TO XL053-LOC-INV-STAT-CDE.  04640057
034692     MOVE IN901-LOC-DEL-RSN-TXT       TO XL053-LOC-DEL-RSN-TXT.   04650057
034693     MOVE IN901-LOC-DEL-DTE           TO XL053-LOC-DEL-DTE.       04660057
034700                                                                  04670034
034800 EJECT.                                                           04680010
034900***************************************************************** 04690010
035000**MOVES XL EXTRACT VALUES TO ERROR RECORD                         04700040
035100***************************************************************** 04710010
035200 9500-MOVE-XL-INV-VALUES.                                         04720040
035300                                                                  04730010
035400     MOVE XL064-INV-ID                TO XL053-INV-ID.            04740070
035410     MOVE XL064-LOC-NBR               TO XL053-LOC-NBR.           04750070
035500     MOVE XL064-INV-DTE               TO XL053-INV-DTE.           04760070
035600     MOVE XL064-PLND-INV-DTE          TO XL053-PLND-INV-DTE.      04770070
035700     MOVE XL064-SCN-INV-IND           TO XL053-SCN-INV-IND.       04780070
035800     MOVE XL064-UNIT-BK-DTE           TO XL053-UNIT-BK-DTE.       04790070
035900     MOVE XL064-FIN-BK-DTE            TO XL053-FIN-BK-DTE.        04800070
036000     MOVE XL064-PLND-UNIT-BK-DTE      TO XL053-PLND-UNIT-BK-DTE.  04810070
036100     MOVE XL064-PLND-FIN-BK-DTE       TO XL053-PLND-FIN-BK-DTE.   04820070
036200     MOVE XL064-INV-RCVD-DTE          TO XL053-INV-RCVD-DTE.      04830070
036300     MOVE XL064-STKRM-DAY-QTY         TO XL053-STKRM-DAY-QTY.     04840070
036400     MOVE XL064-CORR-DAY-QTY          TO XL053-CORR-DAY-QTY.      04850070
036500     MOVE XL064-SOR-LAST-UPD-TMST     TO XL053-SOR-LAST-UPD-TMST. 04860070
036600     MOVE XL064-SOR-UPD-BY-USR-ID     TO XL053-SOR-UPD-BY-USR-ID. 04870070
036700     MOVE XL064-LDGR-CTOFF-TMST       TO XL053-LDGR-CTOFF-TMST.   04880070
036800     MOVE XL064-DC-CTOFF-DTE          TO XL053-DC-CTOFF-DTE.      04890070
036900     MOVE XL064-PHY-CNT-TMST          TO XL053-PHY-CNT-TMST.      04900070
037000     MOVE XL064-SLS-ADJ-CPLD-IND      TO XL053-SLS-ADJ-CPLD-IND.  04910070
037100     MOVE XL064-SCHD-PHY-CNT-CDE      TO XL053-SCHD-PHY-CNT-CDE . 04920070
037200     MOVE XL064-XFER-INV-CTOFF-DTE    TO XL053-XFER-INV-CTOFF-DTE.04930088
037300     MOVE XL064-SHEET-INV-CPLD-IND    TO XL053-SHEET-INV-CPLD-IND.04940088
037400     MOVE XL064-UNT-BKG-STAT-CDE      TO XL053-UNT-BKG-STAT-CDE.  04950070
037500     MOVE XL064-FIL-TOT-BAL-CDE       TO XL053-FIL-TOT-BAL-CDE.   04960070
037600     MOVE XL064-STKRM-WDRWL-IND       TO XL053-STKRM-WDRWL-IND.   04970070
037700     MOVE XL064-MFSTNG-IND            TO XL053-MFSTNG-IND.        04980070
037800     MOVE XL064-INV-SRVC-CDE          TO XL053-INV-SRVC-CDE.      04990070
037900     MOVE XL064-SHEET-INV-REQR-IND    TO XL053-SHEET-INV-REQR-IND.05000088
038000     MOVE XL064-TMST-EDT-STAT-CDE     TO XL053-TMST-EDT-STAT-CDE. 05010070
038010     MOVE XL064-INV-NM                TO XL053-INV-NM.            05020070
038020     MOVE XL064-ACTV-IND              TO XL053-ACTV-IND.          05030070
038030     MOVE XL064-OPN-FSCL-MN-NBR       TO XL053-OPN-FSCL-MN-NBR.   05040070
038040     MOVE XL064-OPN-FSCL-MN-DTE       TO XL053-OPN-FSCL-MN-DTE.   05050070
038050     MOVE XL064-ITM-CTOFF-IND         TO XL053-ITM-CTOFF-IND.     05060070
038060     MOVE XL064-SHTG-ACTL-INV-DTE     TO XL053-SHTG-ACTL-INV-DTE. 05070070
038070     MOVE XL064-JOB-NM                TO XL053-JOB-NM.            05080070
038080     MOVE XL064-INV-CLO-DTE           TO XL053-INV-CLO-DTE.       05090070
038090     MOVE XL064-FINCL-INV-STAT-CDE    TO XL053-FINCL-INV-STAT-CDE.05100088
038091     MOVE XL064-LOC-INV-STAT-CDE      TO XL053-LOC-INV-STAT-CDE.  05110070
038092     MOVE XL064-LOC-DEL-RSN-TXT       TO XL053-LOC-DEL-RSN-TXT.   05120070
038093     MOVE XL064-LOC-DEL-DTE           TO XL053-LOC-DEL-DTE.       05130070
038100                                                                  05140010
038200 EJECT.                                                           05150010
038300***************************************************************** 05160010
038400**ERROR FILE                                                      05170010
038500***************************************************************** 05180010
038600 9800-WRITE-DIFFER-RECORD.                                        05190034
038700                                                                  05200010
038800     WRITE DIFFERENCES-RECORD FROM XL053-INVPAR-TRANS-REC.        05210040
038900                                                                  05220010
039000     ADD +1                   TO PC-DIFFER-RECORD-WRITTEN.        05230034
039100                                                                  05240044
039200     IF CC-DATA-INTEGRITY                                         05250044
039300         MOVE 4094 TO RETURN-CODE                                 05260044
039400     END-IF.                                                      05270044
039500                                                                  05280010
039600 EJECT.                                                           05290010
039700****************************************************************  05300010
039800*END OF PROGRAM ROUTINE                                           05310010
039900****************************************************************  05320010
040000 9999-WRAPUP.                                                     05330010
040100                                                                  05340010
040200     CLOSE RMS-INV-FILE                                           05350042
040300           XL-INV-FILE                                            05360042
040400           DIFFERENCES-FILE.                                      05370010
040500                                                                  05380010
040600     PERFORM 9999-DISPLAY-STATISTICS.                             05390010
040700                                                                  05400010
040800                                                                  05410010
040900 EJECT.                                                           05420010
041000****************************************************************  05430010
041100*DISPLAY PROGRAM STATISTICS                                       05440010
041200****************************************************************  05450010
041300 9999-DISPLAY-STATISTICS.                                         05460010
041400                                                                  05470010
041500     DISPLAY '*************************************************'. 05480010
041600     DISPLAY '* PROGRAM...............: ' PC-CURRENT-PROGRAM-NAME.05490036
041700     DISPLAY '* RMS INV RECORDS READ..: ' PC-RMS-INV-RECS-READ.   05500042
041800     DISPLAY '* XL INV RECORDS READ...: ' PC-XL-INV-RECS-READ.    05510042
041900     DISPLAY '* DIFFER RECORDS WRITTEN: '                         05520036
042000                                        PC-DIFFER-RECORD-WRITTEN. 05530036
042100     DISPLAY '*************************************************'. 05540010
042200                                                                  05550010
042300 EJECT.                                                           05560010
