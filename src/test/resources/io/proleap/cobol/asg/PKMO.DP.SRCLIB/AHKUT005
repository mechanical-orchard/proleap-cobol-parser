000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    AHKUT005.                                         00020000
000300 AUTHOR.        CHERI MASTEL.                                     00030000
000400 INSTALLATION.  KOHLS.                                            00040000
000500 DATE-WRITTEN   AUG, 1997.                                        00050000
000600 DATE-COMPILED.                                                   00060000
000700                                                                  00070000
000800******************************************************************00080000
000900*   AHKUT005.  "ARCHIVE HISTORY" PROJECT. DATA OFFLOAD.          *00090000
001000*                                                                *00100000
001100*   PURPOSE:                                                     *00110000
001200*                                                                *00120000
001300*   THIS PROGRAM APPLIES A "VOLUME CONTROL CARD" TO THE          *00130000
001400*   DRIVER FILE, SELECTING A LIMITED SUBSET OF RECORDS TO        *00140000
001500*   PROCESS.                                                     *00150000
001600*                                                                *00160000
001700*   THIS IS DONE BECAUSE THERE MAY BE SMALL WINDOWS              *00170000
001800*   OF OPPORTUNITY TO RUN THIS SYSTEM.                           *00180000
001900*   - WITHOUT THE VOLUME CONTROL CARD, THE ARCHIVAL PROCESS MAY  *00190000
002000*     NEED TO BE INTERRUPTED OR CANCELLED BEFORE COMPLETION,     *00200000
002100*     DUE TO TIME CONSTRAINTS.  THIS WOULD LEAVE SOME TABLES     *00210000
002200*     OUT OF SYNC WITH THE OTHERS.                               *00220000
002300*   - USING THE VOLUME CONTROL CARD, PROCESSING CAN BE CONTROLLED*00230000
002400*     TO ARCHIVE A LIMITED AMOUNT OF DATA FROM ALL PERTINENT     *00240000
002500*     TABLES WITHIN THE ALLOTED TIME, THEREBY PRESERVING         *00250000
002600*     REFERENTIAL INTEGRITY ON BOTH THE OPERATIONAL TABLES AND   *00260000
002700*     THE ARCHIVE/HISTORY TABLES.                                *00270000
002800*                                                                *00280000
002900*   PROCESSING OVERVIEW:                                         *00290000
003000*   THIS PROGRAM READS THE VOLUME CONTROL CARD,                  *00300000
003100*   ESTABLISHES THE BEGINNING POSITION IN THE DRIVER FILE,       *00310000
003200*   AND READS/WRITES ALL RECORDS FOR THE NEXT "X" PO'S.          *00320000
003300*                                                                *00330000
003400*   SELECT ALL RECORDS FOR A PO TO BE ARCHIVED TOGETHER IN 1 RUN.*00340000
003500*                                                                *00350000
003600*   ON EACH PO CONTROL BREAK, REPORT PROGRAM PROGRESS:           *00360000
003700*   PO#, REC#, PO NUM, RECS FOR THIS PO, AND CURRENT DATE/TIME.  *00370000
003800*   THIS WILL ASSIST WITH RUN-TIME ESTIMATE OF TIME REMAINING    *00380000
003900*   TO COMPLETE.                                                 *00390000
004000*                                                                *00400000
004100******************************************************************00410000
004200*   02/13/02                                                     *00420000
004300*    ADDED LOGIC TO CHECK PROCESSING INTERVALS BEFORE DISPLAYING *00430000
004400*    THE PROGRESS FOR EACH PO.                                   *00440000
004500*   NANCY EILBES                              WR#: 22902         *00450000
004600*                                                                *00460000
004610*   06/04/07                                                     *00461001
004620*     INCREASED SIZE OF INPUT AND OUTPUT FILES FROM 186 TO 189.  *00462000
004630*     THIS WAS NEEDED TO ALLOW FOR THE 2 NEW FIELDS IN THE       *00463000
004640*     AHRD001 COPYBOOK: DC-NBR AND MTCH-LVL-CDE.                 *00464000
004650*   ROLF NOHE                                 WR#: 30241         *00465000
004660*----------------------------------------------------------------*00466000
263455* CHANGED 10/29/2021    BY JIM HUNTER      WR: CHG0263455         00466103
263455* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00466203
263455* MAKING THE CALL DYNAMIC VS STATIC.                              00466303
263455*----------------------------------------------------------------*00466403
004670******************************************************************00467000
004680 ENVIRONMENT DIVISION.                                            00468000
004690 CONFIGURATION SECTION.                                           00469000
004700 SOURCE-COMPUTER.        IBM-3090.                                00470000
004800 OBJECT-COMPUTER.        IBM-3090.                                00480000
004900                                                                  00490000
005000 INPUT-OUTPUT SECTION.                                            00500000
005100 FILE-CONTROL.                                                    00510000
005200                                                                  00520000
005300     SELECT IN-DRIVER-FILE                ASSIGN TO IN01.         00530000
005400     SELECT OUT-DRIVER-FILE               ASSIGN TO OUT01.        00540000
005500                                                                  00550000
005600******************************************************************00560000
005700 DATA DIVISION.                                                   00570000
005800 FILE SECTION.                                                    00580000
005900                                                                  00590000
006000 FD  IN-DRIVER-FILE                                               00600000
006100     RECORDING MODE IS F                                          00610000
006200     LABEL RECORDS ARE STANDARD                                   00620000
006300     BLOCK CONTAINS 0 RECORDS.                                    00630000
006400 01  IN-DRIVER-RECORD                PIC  X(189).                 00640000
006500                                                                  00650000
006600 FD  OUT-DRIVER-FILE                                              00660000
006700     RECORDING MODE IS F                                          00670000
006800     LABEL RECORDS ARE STANDARD                                   00680000
006900     BLOCK CONTAINS 0 RECORDS.                                    00690000
007000 01  OUT-DRIVER-RECORD               PIC  X(189).                 00700000
007100                                                                  00710000
007200                                                                  00720000
007300 WORKING-STORAGE SECTION.                                         00730000
007400                                                                  00740000
007500******************************************************************00750000
007600*    PROGRAM CONSTANTS                                           *00760000
007700******************************************************************00770000
007800 01  PC-PROGRAM-CONSTANTS.                                        00780000
007900     05  PC-CURRENT-PROGRAM-NAME     PIC X(08) VALUE 'AHKUT005'.  00790000
008000     05  PC-PGM-PROGRESS-DESC.                                    00800000
008100         10  PC-BEGINNING            PIC X(09) VALUE 'BEGINNING'. 00810000
008200         10  PC-BYPASSING            PIC X(09) VALUE 'BYPASSING'. 00820000
008300         10  PC-CONTINUING           PIC X(10) VALUE              00830000
008400                                               'CONTINUING'.      00840000
008500         10  PC-EOF-ENDING           PIC X(10) VALUE 'EOF ENDING'.00850000
008600         10  PC-MAX-ENDING           PIC X(10) VALUE 'MAX ENDING'.00860000
008700         10  PC-ABENDING             PIC X(08) VALUE 'ABENDING'.  00870000
008800     05  PC-EDIT-CC-NUMERIC-LEN      PIC S9(4) VALUE +9           00880000
008900                                               COMP SYNC.         00890000
009000     05  PC-FIRSTONE                  PIC S9(9) COMP-3            00900000
009100                                               VALUE +1.          00910000
009200                                                                  00920000
009300     05  PC-DISPLAY-CC-INTRO-MSG.                                 00930000
009400         10  FILLER                  PIC X(41) VALUE              00940000
009500             'VOLUME CONTROL CARD FOLLOWS ON NEXT LINE:'.         00950000
009600     05  PC-DISPLAY-RULER-LINE-01-80.                             00960000
009700         10  FILLER                  PIC X(40) VALUE              00970000
009800             '----+----1----+----2----+----3----+----4'.          00980000
009900         10  FILLER                  PIC X(40) VALUE              00990000
010000             '----+----5----+----6----+----7----+----8'.          01000000
010100                                                                  01010000
010200                                                                  01020000
010300******************************************************************01030000
010400*    PROGRAM SWITCHES                                            *01040000
010500******************************************************************01050000
010600 01  PS-PROGRAM-SWITCHES.                                         01060000
010700     05  PS-STARTING-POSITION-SW     PIC 9(09) VALUE ZEROS.       01070000
010800         88 PS-START-FROM-TOP                  VALUE 000000000    01080000
010900                                               THRU  000000001.   01090000
011000         88 PS-START-FROM-MIDDLE               VALUE 000000002    01100000
011100                                               THRU  999999999.   01110000
011200                                                                  01120000
011300     05  PS-FIRST-LOGICAL-RECORD-SW  PIC X(01) VALUE 'Y'.         01130000
011400         88  PS-FIRST-SELECTED-REC             VALUE 'Y'.         01140000
011500         88  PS-NOT-FIRST-SELECTED-REC         VALUE 'N'.         01150000
011600                                                                  01160000
011700     05  PS-CONTROL-BREAK-SW         PIC X(01) VALUE 'N'.         01170000
011800         88  PS-CONTROL-BREAK                  VALUE 'Y'.         01180000
011900         88  PS-RESET-CONTROL-BREAK            VALUE 'N'.         01190000
012000                                                                  01200000
012100     05  PS-IN-DRIVER-EOF-SW         PIC X(01) VALUE 'N'.         01210000
012200         88  PS-IN-DRIVER-EOF                  VALUE 'Y'.         01220000
012300         88  PS-IN-DRIVER-NOT-EOF              VALUE 'N'.         01230000
012400                                                                  01240000
012500     05  PS-IN-DRIVER-LOGICAL-EOF-SW PIC X(01) VALUE 'N'.         01250000
012600         88  PS-IN-DRIVER-LOGICAL-EOF          VALUE 'Y'.         01260000
012700         88  PS-IN-DRIVER-NOT-LOGICAL-EOF      VALUE 'N'.         01270000
012800                                                                  01280000
012900                                                                  01290000
013000******************************************************************01300000
013100*    PROGRAM VARIABLES                                           *01310000
013200******************************************************************01320000
013300 01  PV-PROGRAM-VARIABLES.                                        01330000
013400     05  PV-PARAGRAPH-NAME           PIC X(30) VALUE SPACES.      01340000
013500     05  PV-MAX-POS-TO-SELECT        PIC 9(09) VALUE ZEROS.       01350000
013600                                                                  01360000
013700                                                                  01370000
013800     05  PV-STARTING-CONTROL.                                     01380000
013900         10  PV-START-AFTER-PO      PIC 9(09) VALUE ZEROS.        01390000
014000         10  PV-STARTING-BYPASS-READS                             01400000
014100                                    PIC S9(9) COMP-3              01410000
014200                                              VALUE ZEROS.        01420000
014300                                                                  01430000
014400     05  PV-KEYS.                                                 01440000
014500         10  PV-PREV-PO-NBR          PIC S9(9) COMP.              01450000
014600         10  PV-PO-NBR               PIC S9(9) COMP.              01460000
014700                                                                  01470000
014800                                                                  01480000
014900     05  PV-COUNTS-ACCUMULATORS.                                  01490000
015000         10  PV-IN-TOTAL-RECS-CNT    PIC S9(9) COMP-3             01500000
015100                                               VALUE ZEROS.       01510000
015200         10  PV-1ST-REC-FOR-THIS-PO  PIC S9(9) COMP-3             01520000
015300                                               VALUE ZEROS.       01530000
015400         10  PV-IN-BYPASSED-RECS-CNT PIC S9(9) COMP-3             01540000
015500                                               VALUE ZEROS.       01550000
015600         10  PV-IN-BYPASSED-PO-CNT   PIC S9(7) COMP-3             01560000
015700                                               VALUE ZEROS.       01570000
015800         10  PV-IN-SELECT-RECS-CNT   PIC S9(9) COMP-3             01580000
015900                                               VALUE ZEROS.       01590000
016000         10  PV-IN-SELECT-PO-CNT     PIC S9(7) COMP-3             01600000
016100                                               VALUE ZEROS.       01610000
016200         10  PV-DRIVER-WRITTEN-CNT   PIC 9(9)  COMP-3             01620000
016300                                               VALUE ZEROS.       01630000
016400         10  PV-DISPLAY-NTH-MULTIPLE     PIC 9(9)  VALUE 0.       01640000
016500         10  PV-DISPLAY-NTH-REMAINDER    PIC 9(9)  VALUE 0.       01650000
016600                                                                  01660000
016700                                                                  01670000
016800     05  PV-COUNTS-TEMP-REUSED.                                   01680000
016900         10  PV-RECS-FOR-THIS-PO     PIC S9(7) COMP-3             01690000
017000                                               VALUE ZEROS.       01700000
017100                                                                  01710000
017200     05  PV-ERROR-ABEND-REPORTING.                                01720000
017300         10  PV-PARAGRAPH-NAME       PIC X(30) VALUE SPACES.      01730000
017400                                                                  01740000
017500     05  PV-TMST                     PIC X(26) VALUE SPACES.      01750000
017600     05  PV-TIMESTAMP-DETAIL                                      01760000
017700         REDEFINES                                                01770000
017800         PV-TMST.                                                 01780000
017900         10  PV-TIMESTAMP-16.                                     01790000
018000             15  PV-TMS-DATE.                                     01800000
018100                 20  PV-TMS-YEAR.                                 01810000
018200                     25  PV-TMS-CC   PIC X(02).                   01820000
018300                     25  PV-TMS-YY   PIC X(02).                   01830000
018400                 20  FILLER          PIC X(01).                   01840000
018500                 20  PV-TMS-MONTH    PIC X(02).                   01850000
018600                 20  FILLER          PIC X(01).                   01860000
018700                 20  PV-TMS-DAY      PIC X(02).                   01870000
018800             15  FILLER              PIC X(01).                   01880000
018900             15  PV-TMS-HOUR         PIC X(02).                   01890000
019000             15  FILLER              PIC X(01).                   01900000
019100             15  PV-TMS-MINUTE       PIC X(02).                   01910000
019200         10  FILLER                  PIC X(01).                   01920000
019300         10  PV-TMS-SECOND           PIC X(02).                   01930000
019400         10  FILLER                  PIC X(01).                   01940000
019500         10  PV-TMS-MSECOND          PIC X(06).                   01950000
019600                                                                  01960000
019700                                                                  01970000
019800******************************************************************01980000
019900*    DISPLAY AREAS                                               *01990000
020000******************************************************************02000000
020100 01  DM-DISPLAY-MESSAGE.                                          02010000
020200     05  DM-01-10.                                                02020000
020300         10  DM-PROGRAM              PIC X(08) VALUE SPACE.       02030000
020400         10  FILLER                  PIC X(02) VALUE ': '.        02040000
020500     05  DM-11-80.                                                02050000
020600         10  FILLER                  PIC X(38) VALUE              02060000
020700                        'APPLY VOLUME CNTL CARD TO DRIVER FILE.'. 02070000
020800         10  FILLER                  PIC X(01) VALUE SPACE.       02080000
020900         10  FILLER                  PIC X(31) VALUE ALL '*'.     02090000
021000     05  DM-81-120.                                               02100000
021100         10  FILLER                  PIC X(40) VALUE ALL '*'.     02110000
021200                                                                  02120000
021300 01  DP-DISPLAY-PROGRESS-MSG.                                     02130000
021400     05  DP-PROGRAM                  PIC X(08) VALUE SPACE.       02140000
021500     05  FILLER                      PIC X(02) VALUE SPACE.       02150000
021600     05  DP-STATUS-DESCRIPTION       PIC X(10) VALUE SPACE.       02160000
021700     05  FILLER                      PIC X(01) VALUE SPACE.       02170000
021800     05  DP-TIMESTAMP-16             PIC X(16) VALUE SPACE.       02180000
021900     05  FILLER                      PIC X(01) VALUE SPACE.       02190000
022000     05  FILLER                      PIC X(02) VALUE '#:'.        02200000
022100     05  DP-PO-CNT                   PIC ZZZZZZ9                  02210000
022200                                               VALUE ZERO.        02220000
022300     05  FILLER                      PIC X(02) VALUE ', '.        02230000
022400     05  FILLER                      PIC X(05) VALUE 'REC#:'.     02240000
022500     05  DP-1ST-REC-FOR-THIS-PO      PIC ZZZZZZZZ9                02250000
022600                                               VALUE ZERO.        02260000
022700     05  FILLER                      PIC X(02) VALUE ', '.        02270000
022800     05  FILLER                      PIC X(05) VALUE 'PO#:'.      02280000
022900     05  DP-DISPLAY-PO-NBR           PIC 9(09) VALUE ZERO.        02290000
023000     05  FILLER                      PIC X(02) VALUE ', '.        02300000
023100     05  FILLER                      PIC X(08) VALUE 'PO RECS:'.  02310000
023200     05  DP-RECS-FOR-THIS-PO         PIC ZZZZZZ9                  02320000
023300                                               VALUE ZERO.        02330000
023400     05  FILLER                      PIC X(02) VALUE ', '.        02340000
023500     05  FILLER                      PIC X(08) VALUE 'OUT:'.      02350000
023600     05  DP-OUT-CNT                  PIC ZZZZZZZZ9                02360000
023700                                               VALUE ZERO.        02370000
023800     05  FILLER                      PIC X(01) VALUE '.'.         02380000
023900                                                                  02390000
024000                                                                  02400000
024100 01  ABEND-CODE                      PIC S9(04)                   02410000
024200                                               VALUE ZEROES       02420000
024300                                               COMP SYNC.         02430000
024400                                                                  02440000
024500******************************************************************02450000
024600*    VOLUME CONTROL CARD.                                        *02460000
024700*    INDICATES PORTION OF DRIVER TO PROCESS.                     *02470000
024800*    GIVES THE DRIVER RECORD NUMBER TO BEGIN PROCESSING WITH,    *02480000
024900*    AND MAX NUMBER OF PO'S TO SELECT FOR PROCESSING.            *02490000
025000*                                                                *02500000
025100*    NOTE: CONTROL CARD MUST BE MANUALLY UPDATED FOR EACH RUN.   *02510000
025200******************************************************************02520000
025300 01  CC-CONTROL-CARD.                                             02530000
025400     05  CC-PROGRAM-ID               PIC X(08) VALUE SPACES.      02540000
025500     05  FILLER                      PIC X(01) VALUE SPACES.      02550000
025600     05  CC-POS-TO-BYPASS            PIC X(09) VALUE SPACES.      02560000
025700     05  FILLER                      PIC X(01) VALUE SPACES.      02570000
025800     05  CC-MAX-POS-TO-SELECT        PIC X(09) VALUE SPACES.      02580000
025900                                                                  02590000
026000                                                                  02600000
026100*---------------------------------------------------------------* 02610000
026200*  DB2 FORMATTED MESSAGE AREA                                     02620000
026300*---------------------------------------------------------------* 02630000
026400     COPY DPWS004.                                                02640000
026500                                                                  02650000
026600                                                                  02660000
026700*---------------------------------------------------------------* 02670000
026800*    NUMERIC EDIT LAYOUT COPYBOOKS.                             * 02680000
026900*---------------------------------------------------------------* 02690000
027000     COPY DPWS010I.                                               02700000
027100                                                                  02710000
027200     05  PC-ABEND-INFO.                                           02720000
027300         10  PC-ABEND                PIC X(11) VALUE              02730000
027400                                               '** ABEND **'.     02740000
027500         10  PC-ABEND-MSG-PARA       PIC X(15) VALUE              02750000
027600                                               '- PARA       : '. 02760000
027700         10  PC-ABEND-MSG-DISPLAY-PARA                            02770000
027800                                     PIC X(15) VALUE              02780000
027900                                               '  CALLED PARA: '. 02790000
028000         10  PC-ABEND-MSG-NUMBER     PIC X(15) VALUE              02800000
028100                                               '  FOR ABEND# : '. 02810000
028200         10  PC-ABEND-MSG-DESC       PIC X(15) VALUE              02820000
028300                                               '- ERROR IS   : '. 02830000
028400         10  PC-ABEND-MSG-INDENT-15  PIC X(15) VALUE SPACES.      02840000
028500         10  PC-ABEND-MSG-ACTION     PIC X(15) VALUE              02850000
028600                                               '- ACTION     : '. 02860000
028700     05  PC-HOW-OFTEN-TO-DISPLAY     PIC 9(9)  VALUE 10000.       02870000
028800                                                                  02880000
028900                                                                  02890000
029000*---------------------------------------------------------------* 02900000
029100*  RECORD LAYOUT FOR DRIVER FILE                                * 02910000
029200*---------------------------------------------------------------* 02920000
029300     COPY AHRD001.                                                02930000
029400                                                                  02940000
029500                                                                  02950000
029600*---------------------------------------------------------------* 02960000
029700*    DB2 AREA FOR COMMUNICATIONS                                * 02970000
029800*---------------------------------------------------------------* 02980000
029900     EXEC SQL                                                     02990000
030000          INCLUDE SQLCA                                           03000000
030100     END-EXEC.                                                    03010000
030200                                                                  03020000
030300                                                                  03030000
030400 PROCEDURE DIVISION.                                              03040000
030500                                                                  03050000
030600 0000-PROGRAM-MAINLINE.                                           03060000
030700                                                                  03070000
030800     PERFORM 1000-INITIALIZE.                                     03080000
030900                                                                  03090000
031000     PERFORM 2000-PROCESS-DRIVER-FILE                             03100000
031100         UNTIL PS-IN-DRIVER-EOF                                   03110000
031200         OR    PS-IN-DRIVER-LOGICAL-EOF.                          03120000
031300                                                                  03130000
031400     PERFORM 6000-EOJ-ROUTINE.                                    03140000
031500     STOP RUN.                                                    03150000
031600                                                                  03160000
031700                                                                  03170000
031800******************************************************************03180000
031900*   INITIALIZATIONS                                              *03190000
032000******************************************************************03200000
032100 1000-INITIALIZE.                                                 03210000
032200                                                                  03220000
032300     MOVE PC-CURRENT-PROGRAM-NAME TO DM-PROGRAM.                  03230000
032400     DISPLAY DM-DISPLAY-MESSAGE.                                  03240000
032500                                                                  03250000
032600     MOVE PC-BEGINNING              TO DP-STATUS-DESCRIPTION.     03260000
032700     PERFORM 6200-DISPLAY-PGM-PROGRESS.                           03270000
032800                                                                  03280000
032900     OPEN  INPUT  IN-DRIVER-FILE                                  03290000
033000          OUTPUT OUT-DRIVER-FILE.                                 03300000
033100                                                                  03310000
033200     PERFORM 1100-PROCESS-CONTROL-CARD.                           03320000
033300                                                                  03330000
033400     SET PS-IN-DRIVER-NOT-EOF         TO TRUE.                    03340000
033500     SET PS-IN-DRIVER-NOT-LOGICAL-EOF TO TRUE.                    03350000
033600     PERFORM 1200-POSITION-AT-START-REC.                          03360000
033700                                                                  03370000
033800                                                                  03380000
033900******************************************************************03390000
034000*   ACCEPT, DISPLAY, AND EDIT THE CONTROL CARD.                  *03400000
034100******************************************************************03410000
034200 1100-PROCESS-CONTROL-CARD.                                       03420000
034300                                                                  03430000
034400     INITIALIZE CC-CONTROL-CARD.                                  03440000
034500                                                                  03450000
034600     ACCEPT  CC-CONTROL-CARD.                                     03460000
034700                                                                  03470000
034800     DISPLAY PC-CURRENT-PROGRAM-NAME                              03480000
034900             '  '                                                 03490000
035000             PC-DISPLAY-CC-INTRO-MSG.                             03500000
035100                                                                  03510000
035200     DISPLAY PC-CURRENT-PROGRAM-NAME                              03520000
035300             '  '                                                 03530000
035400             CC-CONTROL-CARD.                                     03540000
035500                                                                  03550000
035600     DISPLAY PC-CURRENT-PROGRAM-NAME                              03560000
035700             '  '                                                 03570000
035800             PC-DISPLAY-RULER-LINE-01-80.                         03580000
035900                                                                  03590000
036000     PERFORM 1110-EDIT-CC-PROGRAM-ID.                             03600000
036100     PERFORM 1120-EDIT-CC-POS-TO-BYPASS.                          03610000
036200     PERFORM 1130-EDIT-CC-MAX-POS-TO-SELECT.                      03620000
036300                                                                  03630000
036400                                                                  03640000
036500******************************************************************03650000
036600*   EDIT THE INPUT CONTROL CARD.                                 *03660000
036700*   FIELD: PROGRAM NAME.                                         *03670000
036800******************************************************************03680000
036900 1110-EDIT-CC-PROGRAM-ID.                                         03690000
037000                                                                  03700000
037100     IF  CC-PROGRAM-ID = PC-CURRENT-PROGRAM-NAME                  03710000
037200         NEXT SENTENCE                                            03720000
037300     ELSE                                                         03730000
037400         PERFORM 9901-DISPLAY-CUSTOM-ABEND-MSG1                   03740000
037500         MOVE +4003  TO ABEND-CODE                                03750000
037600         PERFORM 9998-GENERAL-ABEND                               03760000
037700     END-IF.                                                      03770000
037800                                                                  03780000
037900                                                                  03790000
038000******************************************************************03800000
038100*   EDIT THE INPUT CONTROL CARD.                                 *03810000
038200*   FIELD: START/RESTART RECORD NUMBER.                          *03820000
038300******************************************************************03830000
038400 1120-EDIT-CC-POS-TO-BYPASS.                                      03840000
038500                                                                  03850000
038600     MOVE CC-POS-TO-BYPASS           TO DP010I-UNEDITED-FIELD.    03860000
038700     MOVE PC-EDIT-CC-NUMERIC-LEN     TO DP010I-MAXIMUM-DIGITS.    03870000
038800     MOVE ZERO                       TO DP010I-MAXIMUM-DECIMALS.  03880000
038900     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     03890000
263455     CALL DP010I-NUMERIC-EDIT-ROUTINE                             03901003
263455          USING DP010I-NUMERIC-EDIT-AREA.                         03902003
039100                                                                  03910000
039200     EVALUATE TRUE                                                03920000
039300                                                                  03930000
039400         WHEN DP010I-ERROR-DETECTED                               03940000
039500             PERFORM 9902-DISPLAY-CUSTOM-ABEND-MSG2               03950000
039600             MOVE +4003  TO ABEND-CODE                            03960000
039700             PERFORM 9998-GENERAL-ABEND                           03970000
039800                                                                  03980000
039900         WHEN PC-EDIT-CC-NUMERIC-LEN > DP010I-DIGIT-COUNT         03990000
040000             PERFORM 9903-DISPLAY-CUSTOM-ABEND-MSG3               04000000
040100             MOVE +4003  TO ABEND-CODE                            04010000
040200             PERFORM 9998-GENERAL-ABEND                           04020000
040300                                                                  04030000
040400         WHEN OTHER                                               04040000
040500             MOVE DP010I-NUMERIC-FIELD                            04050000
040600                                      TO PV-START-AFTER-PO        04060000
040700                                                                  04070000
040800     END-EVALUATE.                                                04080000
040900                                                                  04090000
041000                                                                  04100000
041100******************************************************************04110000
041200*   EDIT THE INPUT CONTROL CARD.                                 *04120000
041300*   FIELD: ESTIMATE OF RECORDS TO SELECT FOR PROCESSING THIS RUN.*04130000
041400******************************************************************04140000
041500 1130-EDIT-CC-MAX-POS-TO-SELECT.                                  04150000
041600                                                                  04160000
041700     MOVE CC-MAX-POS-TO-SELECT       TO DP010I-UNEDITED-FIELD.    04170000
041800     MOVE PC-EDIT-CC-NUMERIC-LEN     TO DP010I-MAXIMUM-DIGITS.    04180000
041900     MOVE ZERO                       TO DP010I-MAXIMUM-DECIMALS.  04190000
042000     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     04200000
263455     CALL DP010I-NUMERIC-EDIT-ROUTINE                             04211003
263455          USING DP010I-NUMERIC-EDIT-AREA.                         04212003
042200                                                                  04220000
042300     EVALUATE TRUE                                                04230000
042400                                                                  04240000
042500         WHEN DP010I-ERROR-DETECTED                               04250000
042600             PERFORM 9904-DISPLAY-CUSTOM-ABEND-MSG4               04260000
042700             MOVE +4003  TO ABEND-CODE                            04270000
042800             PERFORM 9998-GENERAL-ABEND                           04280000
042900                                                                  04290000
043000         WHEN PC-EDIT-CC-NUMERIC-LEN > DP010I-DIGIT-COUNT         04300000
043100             PERFORM 9905-DISPLAY-CUSTOM-ABEND-MSG5               04310000
043200             MOVE +4003  TO ABEND-CODE                            04320000
043300             PERFORM 9998-GENERAL-ABEND                           04330000
043400                                                                  04340000
043500         WHEN OTHER                                               04350000
043600             MOVE DP010I-NUMERIC-FIELD                            04360000
043700               TO PV-MAX-POS-TO-SELECT                            04370000
043800                                                                  04380000
043900     END-EVALUATE.                                                04390000
044000                                                                  04400000
044100                                                                  04410000
044200******************************************************************04420000
044300*    PERFORM PRIME READ -OR-                                     *04430000
044400*    READ INPUT DRIVER FILE UNTIL THE CORRECT NUMBER OF          *04440000
044500*    RECORDS HAVE BEEN BYPASSED.                                 *04450000
044600******************************************************************04460000
044700 1200-POSITION-AT-START-REC.                                      04470000
044800     MOVE CC-POS-TO-BYPASS    TO PS-STARTING-POSITION-SW.         04480000
044900                                                                  04490000
045000     EVALUATE TRUE                                                04500000
045100                                                                  04510000
045200         WHEN PS-START-FROM-TOP                                   04520000
045300             PERFORM 9050-READ-IN-DRIVER-FILE                     04530000
045400             IF PS-IN-DRIVER-EOF                                  04540000
045500                 PERFORM 9906-DISPLAY-CUSTOM-ABEND-MSG6           04550000
045600                 MOVE +4008  TO ABEND-CODE                        04560000
045700                 PERFORM 9998-GENERAL-ABEND                       04570000
045800             ELSE                                                 04580000
045900                 DISPLAY PC-CURRENT-PROGRAM-NAME                  04590000
046000                  '  '                                            04600000
046100                  'STARTING   AT 1ST PO (1ST RECORD) IN FILE.'    04610000
046200             END-IF                                               04620000
046300                                                                  04630000
046400         WHEN PS-START-FROM-MIDDLE                                04640000
046500             PERFORM 9030-READ-DRIVER-TO-POSITION                 04650000
046600                 VARYING PV-STARTING-BYPASS-READS                 04660000
046700                 FROM   +1                                        04670000
046800                 BY     +1                                        04680000
046900                 UNTIL  PS-IN-DRIVER-EOF                          04690000
047000                    OR  PV-IN-BYPASSED-PO-CNT >                   04700000
047100                        PV-START-AFTER-PO                         04710000
047200                                                                  04720000
047300             IF PS-IN-DRIVER-NOT-EOF                              04730000
047400                 PERFORM 9050-READ-IN-DRIVER-FILE                 04740000
047500                 DISPLAY PC-CURRENT-PROGRAM-NAME                  04750000
047600                  '  '                                            04760000
047700                  'STARTING   AT RECORD #'                        04770000
047800                  PV-IN-TOTAL-RECS-CNT                            04780000
047900                  '.'                                             04790000
048000             END-IF                                               04800000
048100                                                                  04810000
048200             IF PS-IN-DRIVER-EOF                                  04820000
048300                 PERFORM 9907-DISPLAY-CUSTOM-ABEND-MSG7           04830000
048400                 MOVE +4008  TO ABEND-CODE                        04840000
048500                 PERFORM 9998-GENERAL-ABEND                       04850000
048600             END-IF                                               04860000
048700                                                                  04870000
048800     END-EVALUATE.                                                04880000
048900                                                                  04890000
049000                                                                  04900000
049100******************************************************************04910000
049200*   1) GET NEXT RECORD FROM DRIVER FILE, AND                     *04920000
049300*         1A- INCREMENT COUNTS                                   *04930000
049400*         1B- WRITE DRIVER RECORD                                *04940000
049500******************************************************************04950000
049600 2000-PROCESS-DRIVER-FILE.                                        04960000
049700                                                                  04970000
049800     SET PS-RESET-CONTROL-BREAK TO TRUE.                          04980000
049900                                                                  04990000
050000     IF  PV-IN-SELECT-PO-CNT < PV-MAX-POS-TO-SELECT               05000000
050100         CONTINUE                                                 05010000
050200     ELSE                                                         05020000
050300         SET PS-IN-DRIVER-LOGICAL-EOF TO TRUE                     05030000
050400     END-IF.                                                      05040000
050500                                                                  05050000
050600     PERFORM 2020-LOOP-TIL-NEXT-PO                                05060000
050700         UNTIL PS-IN-DRIVER-EOF                                   05070000
050800            OR PS-CONTROL-BREAK.                                  05080000
050900                                                                  05090000
051000                                                                  05100000
051100******************************************************************05110000
051200*   COPY EACH RECORD FOR THIS PO FROM THE INPUT DRIVER FILE      *05120000
051300*   TO THE OUTPUT DRIVER FILE.                                   *05130000
051400******************************************************************05140000
051500 2020-LOOP-TIL-NEXT-PO.                                           05150000
051600                                                                  05160000
051700     PERFORM 9750-WRITE-DRIVER-RECORD.                            05170000
051800                                                                  05180000
051900     PERFORM 9050-READ-IN-DRIVER-FILE.                            05190000
052000                                                                  05200000
052100******************************************************************05210000
052200*      EVERY NTH RECORD (IE: INITIAL SETTING 1000), REPORT       *05220000
052300*      RECORD COUNT AND CURRENT DATE/TIME.  THIS WILL ASSIST     *05230000
052400*      WITH RUN-TIME ESTIMATE OF TIME REMAINING TO COMPLETE.     *05240000
052500******************************************************************05250000
052600 2100-CHECK-PGM-PROGRESS.                                         05260000
052700     DIVIDE    PV-DRIVER-WRITTEN-CNT                              05270000
052800         BY        PC-HOW-OFTEN-TO-DISPLAY                        05280000
052900         GIVING    PV-DISPLAY-NTH-MULTIPLE                        05290000
053000         REMAINDER PV-DISPLAY-NTH-REMAINDER.                      05300000
053100                                                                  05310000
053200     IF PV-DISPLAY-NTH-REMAINDER = ZERO                           05320000
053300         MOVE PC-CONTINUING         TO DP-STATUS-DESCRIPTION      05330000
053400         PERFORM 6200-DISPLAY-PGM-PROGRESS                        05340000
053500     END-IF.                                                      05350000
053600                                                                  05360000
053700                                                                  05370000
053800******************************************************************05380000
053900*   DISPLAY END OF RUN MESSAGE, CLOSE THE OUTPUT FILES           *05390000
054000******************************************************************05400000
054100 6000-EOJ-ROUTINE.                                                05410000
054200                                                                  05420000
054300     CLOSE IN-DRIVER-FILE                                         05430000
054400           OUT-DRIVER-FILE.                                       05440000
054500                                                                  05450000
054600     IF PS-IN-DRIVER-LOGICAL-EOF                                  05460000
054700         MOVE PC-MAX-ENDING         TO DP-STATUS-DESCRIPTION      05470000
054800     ELSE                                                         05480000
054900         MOVE PC-EOF-ENDING         TO DP-STATUS-DESCRIPTION      05490000
055000     END-IF.                                                      05500000
055100     PERFORM 6200-DISPLAY-PGM-PROGRESS.                           05510000
055200                                                                  05520000
055300                                                                  05530000
055400******************************************************************05540000
055500*   DISPLAY PROGRAM PROGRESS.                                    *05550000
055600******************************************************************05560000
055700 6200-DISPLAY-PGM-PROGRESS.                                       05570000
055800                                                                  05580000
055900     EXEC SQL                                                     05590000
056000          SET :PV-TMST = CURRENT TIMESTAMP                        05600000
056100     END-EXEC.                                                    05610000
056200                                                                  05620000
056300     MOVE PC-CURRENT-PROGRAM-NAME   TO DP-PROGRAM.                05630000
056400     MOVE PV-TIMESTAMP-16           TO DP-TIMESTAMP-16.           05640000
056500     MOVE PV-IN-SELECT-PO-CNT       TO DP-PO-CNT.                 05650000
056600     MOVE PV-1ST-REC-FOR-THIS-PO    TO DP-1ST-REC-FOR-THIS-PO.    05660000
056700     MOVE PV-PREV-PO-NBR            TO DP-DISPLAY-PO-NBR.         05670000
056800     MOVE PV-RECS-FOR-THIS-PO       TO DP-RECS-FOR-THIS-PO.       05680000
056900     MOVE PV-DRIVER-WRITTEN-CNT     TO DP-OUT-CNT.                05690000
057000                                                                  05700000
057100     DISPLAY DP-DISPLAY-PROGRESS-MSG.                             05710000
057200                                                                  05720000
057300                                                                  05730000
057400******************************************************************05740000
057500*   FILE AND DB2 TABLE ACCESS PARAGRAPHS.                        *05750000
057600*   90XX- INPUT:  DRIVER FILE                                    *05760000
057700*   97XX- OUTPUT: DRIVER FILE                                    *05770000
057800******************************************************************05780000
057900                                                                  05790000
058000                                                                  05800000
058100******************************************************************05810000
058200*   READ  INPUT DRIVER FILE UNTIL POSITIONED AT APPROPRIATE      *05820000
058300*         RECORD TO BEGIN SELECTIONS FOR THIS RUN.               *05830000
058400******************************************************************05840000
058500 9030-READ-DRIVER-TO-POSITION.                                    05850000
058600     READ IN-DRIVER-FILE                                          05860000
058700          INTO AH001-DRIVER-RECORD-LAYOUT                         05870000
058800          AT END                                                  05880000
058900              SET PS-IN-DRIVER-EOF TO TRUE.                       05890000
059000*             MOVE HIGH-VALUES     TO PV-KEYS.                    05900000
059100                                                                  05910000
059200     IF PS-IN-DRIVER-EOF                                          05920000
059300         CONTINUE                                                 05930000
059400     ELSE                                                         05940000
059500         ADD +1                    TO PV-IN-TOTAL-RECS-CNT        05950000
059600         ADD +1                    TO PV-IN-BYPASSED-RECS-CNT     05960000
059700         IF AH001-B-PO-NBR = PV-PREV-PO-NBR                       05970000
059800             ADD +1                TO PV-RECS-FOR-THIS-PO         05980000
059900         ELSE                                                     05990000
060000             IF PV-IN-TOTAL-RECS-CNT = PC-FIRSTONE                06000000
060100                 CONTINUE                                         06010000
060200             ELSE                                                 06020000
060300                 SET PS-CONTROL-BREAK  TO TRUE                    06030000
060400                 MOVE PC-BYPASSING     TO DP-STATUS-DESCRIPTION   06040000
060500                 PERFORM 2100-CHECK-PGM-PROGRESS                  06050000
060600             END-IF                                               06060000
060700             MOVE PV-IN-TOTAL-RECS-CNT                            06070000
060800                                   TO PV-1ST-REC-FOR-THIS-PO      06080000
060900             MOVE AH001-B-PO-NBR   TO PV-PREV-PO-NBR              06090000
061000             ADD +1                TO PV-IN-BYPASSED-PO-CNT       06100000
061100             MOVE +1               TO PV-RECS-FOR-THIS-PO         06110000
061200         END-IF                                                   06120000
061300     END-IF.                                                      06130000
061400                                                                  06140000
061500                                                                  06150000
061600******************************************************************06160000
061700*   READ  INPUT DRIVER FILE OF ELIGIBLE DATA TO DRIVE THIS RUN   *06170000
061800******************************************************************06180000
061900 9050-READ-IN-DRIVER-FILE.                                        06190000
062000     READ IN-DRIVER-FILE                                          06200000
062100          INTO AH001-DRIVER-RECORD-LAYOUT                         06210000
062200          AT END                                                  06220000
062300              SET PS-IN-DRIVER-EOF TO TRUE.                       06230000
062400*             MOVE HIGH-VALUES     TO PV-KEYS.                    06240000
062500                                                                  06250000
062600     IF PS-IN-DRIVER-EOF                                          06260000
062700         CONTINUE                                                 06270000
062800     ELSE                                                         06280000
062900         ADD +1                    TO PV-IN-TOTAL-RECS-CNT        06290000
063000         ADD +1                    TO PV-IN-SELECT-RECS-CNT       06300000
063100         IF AH001-B-PO-NBR = PV-PREV-PO-NBR                       06310000
063200             ADD +1                TO PV-RECS-FOR-THIS-PO         06320000
063300         ELSE                                                     06330000
063400             IF PS-FIRST-SELECTED-REC                             06340000
063500                 SET PS-NOT-FIRST-SELECTED-REC TO TRUE            06350000
063600             ELSE                                                 06360000
063700                 SET PS-CONTROL-BREAK  TO TRUE                    06370000
063800                 MOVE PC-CONTINUING    TO DP-STATUS-DESCRIPTION   06380000
063900                 PERFORM 2100-CHECK-PGM-PROGRESS                  06390000
064000             END-IF                                               06400000
064100             IF PS-IN-DRIVER-LOGICAL-EOF                          06410000
064200                 CONTINUE                                         06420000
064300             ELSE                                                 06430000
064400                 MOVE PV-IN-TOTAL-RECS-CNT                        06440000
064500                                   TO PV-1ST-REC-FOR-THIS-PO      06450000
064600                 MOVE AH001-B-PO-NBR                              06460000
064700                                   TO PV-PREV-PO-NBR              06470000
064800                 ADD +1            TO PV-IN-SELECT-PO-CNT         06480000
064900                 MOVE +1           TO PV-RECS-FOR-THIS-PO         06490000
065000             END-IF                                               06500000
065100         END-IF                                                   06510000
065200     END-IF.                                                      06520000
065300                                                                  06530000
065400                                                                  06540000
065500******************************************************************06550000
065600*   WRITE A RECORD TO THE FINAL VERSION OF THE DRIVER FILE.      *06560000
065700******************************************************************06570000
065800 9750-WRITE-DRIVER-RECORD.                                        06580000
065900     WRITE  OUT-DRIVER-RECORD   FROM  AH001-DRIVER-RECORD-LAYOUT. 06590000
066000     ADD +1 TO PV-DRIVER-WRITTEN-CNT.                             06600000
066100                                                                  06610000
066200                                                                  06620000
066300                                                                  06630000
066400                                                                  06640000
066500******************************************************************06650000
066600*   ABEND PARAGRAPHS.                                            *06660000
066700*   ----------------------------------------------------------   *06670000
066800*   990X- DISPLAY CUSTOM ABEND MESSAGE                           *06680000
066900*   9998- CALL ABEND ROUTINE FOR GENERAL ABENDS                  *06690000
067000******************************************************************06700000
067100                                                                  06710000
067200******************************************************************06720000
067300*   DISPLAY CUSTOM ABEND MESSAGE 1:                              *06730000
067400*   INFORMATION NEEDED FOR DEBUGGING/MAINTENANCE/SUPPORT         *06740000
067500*   WHEN THIS CONDITION OCCURS.                                  *06750000
067600******************************************************************06760000
067700 9901-DISPLAY-CUSTOM-ABEND-MSG1.                                  06770000
067800     DISPLAY PC-CURRENT-PROGRAM-NAME                              06780000
067900             ' ** PARAGRAPH       ** = '                          06790000
068000             '1110-EDIT-CC-PROGRAM-ID'.                           06800000
068100     DISPLAY PC-CURRENT-PROGRAM-NAME                              06810000
068200             ' ** MESSAGE:        ** = '                          06820000
068300             'CONTROL CARD FAILED EDIT. FIELD: PROGRAM-ID'.       06830000
068400     DISPLAY PC-CURRENT-PROGRAM-NAME                              06840000
068500             ' **                 **   '                          06850000
068600             'IS MISSING OR DOES NOT MATCH PROGRAM NAME.'.        06860000
068700     DISPLAY PC-CURRENT-PROGRAM-NAME                              06870000
068800             ' ** CC-PROGRAM-ID:  ** = ' CC-PROGRAM-ID '.'.       06880000
068900     DISPLAY PC-CURRENT-PROGRAM-NAME                              06890000
069000             ' ** ACTION:         ** = '                          06900000
069100             'EDIT CONTROL CARD BEFORE RUNNING AGAIN.'.           06910000
069200                                                                  06920000
069300                                                                  06930000
069400******************************************************************06940000
069500*   DISPLAY CUSTOM ABEND MESSAGE 2:                              *06950000
069600*   INFORMATION NEEDED FOR DEBUGGING/MAINTENANCE/SUPPORT         *06960000
069700*   WHEN THIS CONDITION OCCURS.                                  *06970000
069800******************************************************************06980000
069900 9902-DISPLAY-CUSTOM-ABEND-MSG2.                                  06990000
070000                                                                  07000000
070100     DISPLAY PC-CURRENT-PROGRAM-NAME                              07010000
070200             ' ** PARAGRAPH       ** = '                          07020000
070300             '1120-EDIT-CC-POS-TO-BYPASS'.                        07030000
070400     DISPLAY PC-CURRENT-PROGRAM-NAME                              07040000
070500             ' ** MESSAGE:        ** = '                          07050000
070600             'CONTROL CARD FAILED EDIT. FIELD: PO"S TO BYPASS'.   07060000
070700     DISPLAY PC-CURRENT-PROGRAM-NAME                              07070000
070800             ' **                 **   '                          07080000
070900             'IS NOT NUMERIC.'.                                   07090000
071000     DISPLAY PC-CURRENT-PROGRAM-NAME                              07100000
071100             ' ** CC-POS-TO-BYPASS = '                            07110000
071200                  CC-POS-TO-BYPASS '.'.                           07120000
071300     DISPLAY PC-CURRENT-PROGRAM-NAME                              07130000
071400             ' ** ACTION:         ** = '                          07140000
071500             'CHECK LAST RUN FOR WHICH PO"S WERE SELECTED,'.      07150000
071600     DISPLAY PC-CURRENT-PROGRAM-NAME                              07160000
071700             ' **                 **   '                          07170000
071800             'DETERMINE CORRECT PO"S TO BYPASS ON THIS RUN, AND'. 07180000
071900     DISPLAY PC-CURRENT-PROGRAM-NAME                              07190000
072000             ' **                 **   '                          07200000
072100             'EDIT CONTROL CARD BEFORE RUNNING AGAIN.'.           07210000
072200                                                                  07220000
072300                                                                  07230000
072400******************************************************************07240000
072500*   DISPLAY CUSTOM ABEND MESSAGE 3:                              *07250000
072600*   INFORMATION NEEDED FOR DEBUGGING/MAINTENANCE/SUPPORT         *07260000
072700*   WHEN THIS CONDITION OCCURS.                                  *07270000
072800******************************************************************07280000
072900 9903-DISPLAY-CUSTOM-ABEND-MSG3.                                  07290000
073000                                                                  07300000
073100     DISPLAY PC-CURRENT-PROGRAM-NAME                              07310000
073200             ' ** PARAGRAPH       ** = '                          07320000
073300             '1120-EDIT-CC-POS-TO-BYPASS'.                        07330000
073400     DISPLAY PC-CURRENT-PROGRAM-NAME                              07340000
073500             ' ** MESSAGE:        ** = '                          07350000
073600             'CONTROL CARD FAILED EDIT. FIELD: PO"S TO BYPASS'.   07360000
073700     DISPLAY PC-CURRENT-PROGRAM-NAME                              07370000
073800             ' **                 **   '                          07380000
073900             'IS INCORRECT LENGTH / NOT IN EXPECTED COLUMNS.'.    07390000
074000     DISPLAY PC-CURRENT-PROGRAM-NAME                              07400000
074100             ' ** CC-POS-TO-BYPASS = '                            07410000
074200                  CC-POS-TO-BYPASS '.'.                           07420000
074300     DISPLAY PC-CURRENT-PROGRAM-NAME                              07430000
074400             ' ** ACTION:         ** = '                          07440000
074500             'CHECK PROGRAM DOC FOR CC INSTRUCTIONS, '.           07450000
074600     DISPLAY PC-CURRENT-PROGRAM-NAME                              07460000
074700             ' **                 **   '                          07470000
074800             'EDIT CONTROL CARD BEFORE RUNNING AGAIN.'.           07480000
074900                                                                  07490000
075000                                                                  07500000
075100******************************************************************07510000
075200*   DISPLAY CUSTOM ABEND MESSAGE 4:                              *07520000
075300*   INFORMATION NEEDED FOR DEBUGGING/MAINTENANCE/SUPPORT         *07530000
075400*   WHEN THIS CONDITION OCCURS.                                  *07540000
075500******************************************************************07550000
075600 9904-DISPLAY-CUSTOM-ABEND-MSG4.                                  07560000
075700                                                                  07570000
075800     DISPLAY PC-CURRENT-PROGRAM-NAME                              07580000
075900             ' ** PARAGRAPH       ** = '                          07590000
076000             '1130-EDIT-CC-MAX-POS-TO-SELECT'.                    07600000
076100     DISPLAY PC-CURRENT-PROGRAM-NAME                              07610000
076200             ' ** MESSAGE:        ** = '                          07620000
076300             'CONTROL CARD FAILED EDIT. FIELD: MAX PO"S TO SELECT'07630000
076400     DISPLAY PC-CURRENT-PROGRAM-NAME                              07640000
076500             ' **                 **   '                          07650000
076600             'IS NOT NUMERIC.'.                                   07660000
076700     DISPLAY PC-CURRENT-PROGRAM-NAME                              07670000
076800             ' ** CC-MAX-POS-TO-SELECT'                           07680000
076900                  CC-MAX-POS-TO-SELECT '.'.                       07690000
077000     DISPLAY PC-CURRENT-PROGRAM-NAME                              07700000
077100             ' ** ACTION:         ** = '                          07710000
077200             'CHECK PREVIOUS ARCHIVE RUNS '.                      07720000
077300     DISPLAY ' **                 ** = '                          07730000
077400             '(DRIVER / EXTRACT / LOAD / DELETE JOBS),'.          07740000
077500     DISPLAY PC-CURRENT-PROGRAM-NAME                              07750000
077600             ' **                 **   '                          07760000
077700             'DETERMINE HOW MANY PO"S MAY PROCESS IN THE'.        07770000
077800     DISPLAY PC-CURRENT-PROGRAM-NAME                              07780000
077900             ' **                 **   '                          07790000
078000             'TIME AVAILABLE FOR THE CURRENT PROCESSING WINDOW,'. 07800000
078100     DISPLAY PC-CURRENT-PROGRAM-NAME                              07810000
078200             ' **                 **   '                          07820000
078300             'AND EDIT CONTROL CARD BEFORE RUNNING AGAIN.'.       07830000
078400                                                                  07840000
078500                                                                  07850000
078600******************************************************************07860000
078700*   DISPLAY CUSTOM ABEND MESSAGE 5:                              *07870000
078800*   INFORMATION NEEDED FOR DEBUGGING/MAINTENANCE/SUPPORT         *07880000
078900*   WHEN THIS CONDITION OCCURS.                                  *07890000
079000******************************************************************07900000
079100 9905-DISPLAY-CUSTOM-ABEND-MSG5.                                  07910000
079200                                                                  07920000
079300     DISPLAY PC-CURRENT-PROGRAM-NAME                              07930000
079400             ' ** PARAGRAPH       ** = '                          07940000
079500             '1130-EDIT-CC-MAX-POS-TO-SELECT'.                    07950000
079600     DISPLAY PC-CURRENT-PROGRAM-NAME                              07960000
079700             ' ** MESSAGE:        ** = '                          07970000
079800             'CONTROL CARD FAILED EDIT.'.                         07980000
079900     DISPLAY PC-CURRENT-PROGRAM-NAME                              07990000
080000             ' **                 ** = '                          08000000
080100             'FIELD: MAX PO"S TO SELECT'.                         08010000
080200     DISPLAY PC-CURRENT-PROGRAM-NAME                              08020000
080300             ' **                 **   '                          08030000
080400             'IS INCORRECT LENGTH / NOT IN EXPECTED COLUMNS.'.    08040000
080500     DISPLAY PC-CURRENT-PROGRAM-NAME                              08050000
080600             ' ** CC-MAX-POS-TO-SELECT'                           08060000
080700                  CC-MAX-POS-TO-SELECT '.'                        08070000
080800     DISPLAY PC-CURRENT-PROGRAM-NAME                              08080000
080900             ' ** ACTION:         ** = '                          08090000
081000             'CHECK PROGRAM DOC FOR CC INSTRUCTIONS, '.           08100000
081100     DISPLAY PC-CURRENT-PROGRAM-NAME                              08110000
081200             ' **                 **   '                          08120000
081300             'EDIT CONTROL CARD BEFORE RUNNING AGAIN.'.           08130000
081400                                                                  08140000
081500                                                                  08150000
081600******************************************************************08160000
081700*   DISPLAY CUSTOM ABEND MESSAGE 6:                              *08170000
081800*   INFORMATION NEEDED FOR DEBUGGING/MAINTENANCE/SUPPORT         *08180000
081900*   WHEN THIS CONDITION OCCURS.                                  *08190000
082000******************************************************************08200000
082100 9906-DISPLAY-CUSTOM-ABEND-MSG6.                                  08210000
082200     DISPLAY PC-CURRENT-PROGRAM-NAME                              08220000
082300             ' ** PARAGRAPH       ** = '                          08230000
082400             '1200-POSITION-AT-START-REC'.                        08240000
082500     DISPLAY PC-CURRENT-PROGRAM-NAME                              08250000
082600             ' ** MESSAGE:        ** = '                          08260000
082700             'EOF ENCOUNTERED ON 1ST READ OF DRIVER FILE.'.       08270000
082800     DISPLAY PC-CURRENT-PROGRAM-NAME                              08280000
082900             ' **                 **   '                          08290000
083000             'FILE IS EMPTY.'.                                    08300000
083100     DISPLAY PC-CURRENT-PROGRAM-NAME                              08310000
083200             ' ** ACTION:         ** = '                          08320000
083300             'CHECK RUN OF DRIVER FILE CREATION PGMS.'.           08330000
083400                                                                  08340000
083500                                                                  08350000
083600******************************************************************08360000
083700*   DISPLAY CUSTOM ABEND MESSAGE 7:                              *08370000
083800*   INFORMATION NEEDED FOR DEBUGGING/MAINTENANCE/SUPPORT         *08380000
083900*   WHEN THIS CONDITION OCCURS.                                  *08390000
084000******************************************************************08400000
084100 9907-DISPLAY-CUSTOM-ABEND-MSG7.                                  08410000
084200     DISPLAY PC-CURRENT-PROGRAM-NAME                              08420000
084300             ' ** PARAGRAPH       ** = '                          08430000
084400             '1200-POSITION-AT-START-REC'.                        08440000
084500     DISPLAY PC-CURRENT-PROGRAM-NAME                              08450000
084600             ' ** MESSAGE:        ** = '                          08460000
084700             'EOF ENCOUNTERED WHILE READING DRIVER FILE'.         08470000
084800     DISPLAY PC-CURRENT-PROGRAM-NAME                              08480000
084900             ' **                 ** = '                          08490000
085000             'TO SET POSITION AT START RECORD FOR THIS RUN.'.     08500000
085100     DISPLAY PC-CURRENT-PROGRAM-NAME                              08510000
085200             ' ** ACTION:         ** = '                          08520000
085300             'CHECK PREVIOUS ARCHIVE RUNS '.                      08530000
085400     DISPLAY ' **                 ** = '                          08540000
085500             '(DRIVER / EXTRACT / LOAD / DELETE JOBS),'.          08550000
085600     DISPLAY PC-CURRENT-PROGRAM-NAME                              08560000
085700             ' **                 **   '                          08570000
085800             'DETERMINE CORRECT STARTING RECORD, AND '.           08580000
085900     DISPLAY PC-CURRENT-PROGRAM-NAME                              08590000
086000             ' **                 **   '                          08600000
086100             'EDIT CONTROL CARD BEFORE RUNNING AGAIN.'.           08610000
086200                                                                  08620000
086300                                                                  08630000
086400******************************************************************08640000
086500*   DISPLAY FINAL PROGRAM PROGRESS STATISTICS                    *08650000
086600*   AND CALL THE ABEND PROCESSOR IN THE EVENT THAT A GENERAL     *08660000
086700*   ABEND OCCURS.                                                *08670000
086800******************************************************************08680000
086900 9998-GENERAL-ABEND.                                              08690000
087000     DISPLAY PC-CURRENT-PROGRAM-NAME                              08700000
087100             ' 9998-GENERAL-ABEND'.                               08710000
087200     DISPLAY PC-CURRENT-PROGRAM-NAME                              08720000
087300             ' ** ABEND           **'.                            08730000
087400                                                                  08740000
087500     MOVE PC-ABENDING TO DP-STATUS-DESCRIPTION                    08750000
087600     PERFORM 6200-DISPLAY-PGM-PROGRESS.                           08760000
087700                                                                  08770000
087800                                                                  08780000
087900     EXEC SQL                                                     08790000
088000         ROLLBACK                                                 08800000
088100     END-EXEC.                                                    08810000
088200                                                                  08820000
088300*----------------------------------------------------------------*08830000
088400* CALL ABEND                                                     *08840000
088500*----------------------------------------------------------------*08850000
088600     CALL 'ILBOABN0' USING ABEND-CODE.                            08860000
088700                                                                  08870000
088800                                                                  08880000
088900*                                                                 08890000
089000                                                                  08900000
