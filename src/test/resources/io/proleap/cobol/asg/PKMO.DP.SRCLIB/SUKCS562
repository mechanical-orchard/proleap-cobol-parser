000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    SUKCS562.                                         00040000
000500 AUTHOR.        DEANNA BRANTNER.                                  00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  JUNE, 2001.                                       00070000
000800 DATE-COMPILED.                                                   00080000
000900*---------------------------------------------------------------* 00090000
001000*    S562 - SHIPPING DOOR STATUS  - DOOR TRAILER LIST           * 00100000
001100*---------------------------------------------------------------* 00110000
263968* CHANGED 11/15/2021    BY JIM HUNTER      WR: CHG0263968         00112015
263968* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00113015
263968* MAKING THE CALL DYNAMIC VS STATIC.                              00114015
001130*                                                                 00114116
001110* CHANGED 01/09/2023    BY JEAN KURK       WR: CHG0278099         00114216
001120* CHANGE CALL OF DPKCS030 TO BE DYNAMIC                           00114316
263968*---------------------------------------------------------------* 00115015
001200 ENVIRONMENT DIVISION.                                            00120000
001300 DATA DIVISION.                                                   00130000
001400                                                                  00140000
001500 WORKING-STORAGE SECTION.                                         00150000
001600 01  DK-DB2-KEYS.                                                 00160000
001700     05  DK-FROM-TMST                   PIC  X(26)  VALUE SPACES. 00170000
001800     05  DK-TO-TMST                     PIC  X(26)  VALUE SPACES. 00180000
001900     05  DK-DOOR-ID                     PIC  X(04)  VALUE SPACES. 00190000
002000     05  DK-OPER-UNT-ID                 PIC S9(04)  VALUE ZERO    00200000
002100                                                    COMP.         00210000
002200     05  DK-STORE-NUMBER                PIC S9(04)  VALUE ZERO    00220000
002300                                                    COMP.         00230000
002400     05  DK-DOOR-TYPE.                                            00240000
002500         10  DK-SHUTTLE                 PIC X(02)  VALUE SPACES.  00250000
002600         10  DK-SHIPPING                PIC X(02)  VALUE SPACES.  00260000
002700         10  DK-RECEIVING               PIC X(02)  VALUE SPACES.  00270000
002800         10  DK-STORAGE                 PIC X(02)  VALUE SPACES.  00280000
002900         10  DK-STRIPPING               PIC X(02)  VALUE SPACES.  00290000
003000         10  DK-YARD                    PIC X(02)  VALUE SPACES.  00300000
003100     05  DK-TYPE-CODES.                                           00310000
003200         10  DK-TYPE-CDE1               PIC X(02).                00320000
003300         10  DK-TYPE-CDE2               PIC X(02).                00330000
003400         10  DK-TYPE-CDE3               PIC X(02).                00340000
003500         10  DK-TYPE-CDE4               PIC X(02).                00350000
003600         10  DK-TYPE-CDE5               PIC X(02).                00360000
003700         10  DK-TYPE-CDE6               PIC X(02).                00370000
003800         10  DK-TYPE-CDE7               PIC X(02).                00380000
003900         10  DK-TYPE-CDE8               PIC X(02).                00390000
004000                                                                  00400000
004100     05  DK-TRLR-STATUS.                                          00410013
004200         10  DK-DCOPEN                  PIC X(02)  VALUE SPACES.  00420013
004300         10  DK-DCCLOSED                PIC X(02)  VALUE SPACES.  00430013
004400         10  DK-SHIPPED                 PIC X(02)  VALUE SPACES.  00440013
004500         10  DK-AUDIT                   PIC X(02)  VALUE SPACES.  00450013
004600         10  DK-STOREOPEN               PIC X(02)  VALUE SPACES.  00460013
004700         10  DK-STOREUNLOADED           PIC X(02)  VALUE SPACES.  00470013
004800     05  DK-STAT-CODES.                                           00480013
004900         10  DK-STAT-CDE1               PIC X(02).                00490013
005000         10  DK-STAT-CDE2               PIC X(02).                00500013
005100         10  DK-STAT-CDE3               PIC X(02).                00510013
005200         10  DK-STAT-CDE4               PIC X(02).                00520013
005300         10  DK-STAT-CDE5               PIC X(02).                00530013
005400         10  DK-STAT-CDE6               PIC X(02).                00540013
005500         10  DK-STAT-CDE7               PIC X(02).                00550013
005600         10  DK-STAT-CDE8               PIC X(02).                00560013
005601                                                                  00560113
005602 01  PC-PROGRAM-CONSTANTS.                                        00560200
005603     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'SU562A  '.  00560300
005604     05  PC-DEFAULT-TMST                 PIC  X(26)   VALUE       00560400
005605                                   '9999-09-09-09.09.09.999999'.  00560500
005606     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'SUKM562'.   00560600
005607     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'SUKCS562'.  00560700
005608     05  PC-LOCATION-MODULE        PIC  X(08)  VALUE 'XLKUT071'.  00560813
005609     05  PC-LIST-QUEUE-SEQ         PIC  9(01)  VALUE 1.           00560900
005610     05  PC-SEL-QUEUE-SEQ          PIC  9(01)  VALUE 2.           00561000
005611     05  PC-CRIT-SPEC-FORMAT       PIC  X(01)  VALUE '1'.         00561100
005612     05  PC-LIST-FORMAT            PIC  X(01)  VALUE '2'.         00561200
005613     05  PC-ITEMS-PER-PANEL        PIC S9(04)  VALUE +12          00561300
005614                                               COMP SYNC.         00561400
005615     05  PC-MAX-BLOCKS-IN-ARRAY    PIC S9(04)  VALUE +2           00561500
005616                                               COMP SYNC.         00561600
005617     05  PC-MAX-ITEMS              PIC S9(09)  VALUE +1000000     00561700
005618                                               COMP-3.            00561800
005700     05  PC-MSG-NUMBER-LENGTH      PIC S9(04)  VALUE +5           00570000
005800                                               COMP SYNC.         00580000
005900     05  PC-MAX-RETRIES            PIC S9(03)  VALUE 3            00590000
006000                                               COMP-3.            00600000
006100     05  PC-INQ                    PIC  X(03)  VALUE 'INQ'.       00610000
006200     05  PC-UPD                    PIC  X(03)  VALUE 'UPD'.       00620000
006300     05  PC-DEL                    PIC  X(03)  VALUE 'DEL'.       00630000
006400     05  PC-ERR                    PIC  X(03)  VALUE 'ERR'.       00640000
006500     05  PC-NEW                    PIC  X(02)  VALUE 'NW'.        00650000
006600     05  PC-ZERO                   PIC S9(04)  VALUE ZEROES       00660000
006700                                               COMP.              00670000
006800     05  PC-01                     PIC  X(02)  VALUE '01'.        00680000
006900     05  PC-SH                     PIC  X(02)  VALUE 'SH'.        00690000
007000     05  PC-RC                     PIC  X(02)  VALUE 'RC'.        00700000
007100     05  PC-DS                     PIC  X(02)  VALUE 'DS'.        00710000
007200     05  PC-ST                     PIC  X(02)  VALUE 'ST'.        00720000
007300     05  PC-SG                     PIC  X(02)  VALUE 'SG'.        00730000
007400     05  PC-YD                     PIC  X(02)  VALUE 'YD'.        00740000
007500     05  PC-CC                     PIC  X(02)  VALUE 'CC'.        00750000
007600     05  PC-NR                     PIC  X(02)  VALUE 'NR'.        00760000
007700     05  PC-A                      PIC  X(01)  VALUE 'A'.         00770000
007800*                                                                 00780000
007900*                                                                 00790000
008000*----------------------------------------------------------------*00800000
008100*  SYSTEM MESSAGES                                               *00810000
008200*----------------------------------------------------------------*00820000
008300*   00005 = INVALID VALUE                                        *00830000
008400*   00008 = MUST BE NUMERIC                                      *00840000
008500*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *00850000
008600*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *00860000
008700*   00052 - END OF RANGE PRECEDES START OF RANGE                 *00870000
008800*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *00880000
008900*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *00890000
009000*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *00900000
009100*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *00910000
009200*   00069 - TOP OF LIST                                          *00920000
009300*   00070 - BOTTOM OF LIST                                       *00930000
009400*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *00940000
009500*   00551 - WAIT 15 SECONDS;RETRY FUNCTION AGAIN; IF UNSUCCESSFUL*00950000
009600*   00279 - MORE ITEMS TO DISPLAY                                *00960000
009700*   00840 - YOU ARE NOT AUTHORIZED TO VIEW THIS INFORMATION      *00970000
009800*   00984 - DATABASE IS BUSY, TRY AGAIN IN A FEW MINUTES         *00980000
009900*   02227 = APPLICATION UNAVAILABLE AT THIS TIME                 *00990000
010000*   99901 = INVALID COMMAND WAS ENTERED                          *01000000
010100*----------------------------------------------------------------*01010000
010200     05  PC-TSYMSG-NUMBERS.                                       01020000
010300         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01030000
010400         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01040000
010500         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01050000
010600         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01060000
010700         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01070000
010800         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01080000
010900         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01090000
011000         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01100000
011100         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01110000
011200         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01120000
011300         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01130000
011400         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01140000
011500         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01150000
011600         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  01160000
011700         10  PC-TSYMSG-00746            PIC  9(05)  VALUE 00746.  01170000
011800         10  PC-TSYMSG-00840            PIC  9(05)  VALUE 00840.  01180000
011900         10  PC-TSYMSG-01563            PIC  9(05)  VALUE 01563.  01190000
012000         10  PC-TSYMSG-00984            PIC  9(05)  VALUE 00984.  01200000
012100         10  PC-TSYMSG-02227            PIC  9(05)  VALUE 02227.  01210000
012200         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  01220000
012300*                                                                 01230000
012400 01  PS-PROGRAM-SWITCHES.                                         01240000
012500     05  PS-BLOCK-ERROR-SW              PIC  X(01)  VALUE 'Y'.    01250000
012600         88  PS-NO-BLOCK-ERROR                      VALUE 'Y'.    01260000
012700         88  PS-BLOCK-ERROR                         VALUE 'N'.    01270000
012800     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01280000
012900         88  PS-NO-ERROR                            VALUE 'Y'.    01290000
013000         88  PS-ERROR                               VALUE 'N'.    01300000
013100     05  PS-SOFT-ABORT-ERROR-SW         PIC  X(01)  VALUE  'N'.   01310000
013200         88  PS-SOFT-ABORT-ERROR                    VALUE  'Y'.   01320000
013300         88  PS-NO-SOFT-ABORT-ERROR                 VALUE  'N'.   01330000
013400     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01340000
013500         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01350000
013600         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01360000
013700     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    01370000
013800         88  PS-DONE                                VALUE 'Y'.    01380000
013900         88  PS-NOT-DONE                            VALUE 'N'.    01390000
014000     05  PS-LIST-END-SW                 PIC  X(01)  VALUE  'N'.   01400000
014100         88  PS-LIST-END                            VALUE  'Y'.   01410000
014200         88  PS-NO-LIST-END                         VALUE  'N'.   01420000
014300     05  PS-CURSOR-SW                   PIC  X(01)  VALUE  ' '.   01430000
014400         88  PS-OPER-UNT-CSR                        VALUE  'A'.   01440000
014500         88  PS-DOOR-ID-CSR                         VALUE  'B'.   01450000
014600         88  PS-DOOR-TYPE-CSR                       VALUE  'C'.   01460000
014700     05  PS-ACCESS-SW                   PIC  X(01)  VALUE  'N'.   01470000
014800         88  PS-ACCESS-ALLOWED                      VALUE  'Y'.   01480000
014900         88  PS-ACCESS-NOT-ALLOWED                  VALUE  'N'.   01490000
015000*                                                                 01500000
015100 01  PV-PROGRAM-VARIABLES.                                        01510000
015200     05  PV-ORIGINAL-BLOCK               PIC S9(04)  VALUE +0     01520000
015300                                                     COMP SYNC.   01530000
015400     05  PV-ITEMS-HOLD                   PIC S9(03)  COMP-3.      01540000
015500     05  PV-ITEMS-DIFF                   PIC S9(03)  COMP-3.      01550000
015600     05  PV-RACF-ERROR-CODE             PIC  9(04)  VALUE ZEROES. 01560000
015700     05  PV-CICS-RESPONSE               PIC S9(08)  VALUE ZEROES  01570000
015800                                        COMP SYNC.                01580000
015900     05  PV-SUB                         PIC S9(04)  VALUE +0      01590000
016000                                                    COMP SYNC.    01600000
016100     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      01610000
016200                                                    COMP SYNC.    01620000
016300     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      01630000
016400                                                    COMP-3.       01640000
016500     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      01650000
016600                                                    COMP-3.       01660000
016700     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      01670000
016800                                                    COMP-3.       01680000
016900     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      01690000
017000                                                    COMP-3.       01700000
017100     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      01710000
017200                                                    COMP-3.       01720000
017300     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      01730000
017400                                                    COMP-3.       01740000
017500     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      01750000
017600                                                    COMP-3.       01760000
017700     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      01770000
017800                                                    COMP SYNC.    01780000
017900     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01790000
018000                                                    COMP SYNC.    01800000
018100     05  PV-ITEM                        PIC S9(04)  VALUE +0      01810000
018200                                                    COMP SYNC.    01820000
018300     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      01830000
018400                                                    COMP SYNC.    01840000
018500     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      01850000
018600                                                    COMP SYNC.    01860000
018700     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      01870000
018800                                                    COMP SYNC.    01880000
018900     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      01890000
019000                                                    COMP SYNC.    01900000
019100     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      01910000
019200                                                    COMP SYNC.    01920000
019300     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01930000
019400                                                    COMP SYNC.    01940000
019500     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01950000
019600                                                    COMP SYNC.    01960000
019700     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      01970000
019800                                                    COMP SYNC.    01980000
019900     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      01990000
020000                                                    COMP SYNC.    02000000
020100     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      02010000
020200                                                    COMP SYNC.    02020000
020300     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      02030000
020400                                                    COMP SYNC.    02040000
020500     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      02050000
020600                                                    COMP SYNC.    02060000
020700     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      02070000
020800                                                    COMP SYNC.    02080000
020900     05  PV-NULL-IND-1                  PIC S9(04)  VALUE +0      02090000
021000                                                    COMP.         02100000
021100     05  PV-NULL-IND-2                  PIC S9(04)  VALUE +0      02110000
021200                                                    COMP.         02120000
021300     05  PV-NULL-IND-3                  PIC S9(04)  VALUE +0      02130000
021400                                                    COMP.         02140000
021500     05  PV-SOFT-ABORT-MSG.                                       02150000
021600         10  FILLER            PIC X(12) VALUE ' SUKCS562 - '.    02160000
021700         10  FILLER            PIC X(09) VALUE 'SQLCODE: '.       02170000
021800         10  PV-SOFT-SQLCODE   PIC ZZZZZZZZ9-.                    02180000
021900         10  FILLER            PIC X(12) VALUE ' PARAGRAPH: '.    02190000
022000         10  PV-SOFT-PARAGRAPH PIC X(30).                         02200000
022100     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     02210000
022200                                                     COMP SYNC.   02220000
022300     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACE. 02230000
022400     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 02240000
022500     05  PV-CICS-MSG-HOLD.                                        02250000
022600         10  FILLER                      PIC  X(01)  VALUE SPACE. 02260000
022700         10  PV-CICS-MSG-DATA            PIC  X(79)  VALUE SPACE. 02270000
022800     05  PV-CICS-MSG-HOLD2.                                       02280000
022900         10  FILLER                      PIC  X(01)  VALUE SPACE. 02290000
023000         10  PV-CICS-MSG-DATA2           PIC  X(99)  VALUE SPACE. 02300000
023100                                                                  02310000
023200     05  PV-TMST                 PIC X(26)   VALUE SPACES.        02320000
023300     05  PV-TMST-R REDEFINES  PV-TMST.                            02330000
023400         10   PV-TMST-DATE              PIC X(10).                02340000
023500         10   FILLER                    PIC X(01).                02350000
023600         10   PV-TMST-HRS               PIC X(02).                02360000
023700         10   FILLER                    PIC X(01).                02370000
023800         10   PV-TMST-MIN               PIC X(02).                02380000
023900         10   FILLER                    PIC X(01).                02390000
024000         10   PV-TMST-SEC               PIC X(02).                02400000
024100         10   FILLER                    PIC X(07).                02410000
024200     05  PV-FROM-TMST.                                            02420000
024300         10   PV-FROM-YY    PIC X(04)  VALUE ZEROES.              02430000
024400         10   FILLER        PIC X(01)  VALUE '-'.                 02440000
024500         10   PV-FROM-MM    PIC X(02)  VALUE ZEROES.              02450000
024600         10   FILLER        PIC X(01)  VALUE '-'.                 02460000
024700         10   PV-FROM-DD    PIC X(02)  VALUE ZEROES.              02470000
024800         10   FILLER        PIC X(16)  VALUE '-00.00.00.000000'.  02480000
024900     05  PV-TO-TMST.                                              02490000
025000         10   PV-TO-YY      PIC X(04)  VALUE ZEROES.              02500000
025100         10   FILLER        PIC X(01)  VALUE '-'.                 02510000
025200         10   PV-TO-MM      PIC X(02)  VALUE ZEROES.              02520000
025300         10   FILLER        PIC X(01)  VALUE '-'.                 02530000
025400         10   PV-TO-DD      PIC X(02)  VALUE ZEROES.              02540000
025500         10   FILLER        PIC X(16)  VALUE '-23.59.59.999999'.  02550000
025600     05  PV-DATE-TIME-DISPLAY.                                    02560000
025700         10   PV-DISPLAY-MM             PIC X(02)   VALUE SPACES. 02570000
025800         10   PV-SLASH-1                PIC X(01)   VALUE SPACES. 02580000
025900         10   PV-DISPLAY-DD             PIC X(02)   VALUE SPACES. 02590000
026000         10   PV-SLASH-2                PIC X(01)   VALUE SPACES. 02600000
026100         10   PV-DISPLAY-CCYY           PIC X(04)   VALUE SPACES. 02610000
026200         10   PV-AT                     PIC X(03)   VALUE SPACES. 02620000
026300         10   PV-DISPLAY-HRS            PIC X(02)   VALUE SPACES. 02630000
026400         10   PV-SEMICOLON-1            PIC X(01)   VALUE SPACES. 02640000
026500         10   PV-DISPLAY-MIN            PIC X(02)   VALUE SPACES. 02650000
026600         10   PV-SEMICOLON-2            PIC X(01)   VALUE SPACES. 02660000
026700         10   PV-DISPLAY-SEC            PIC X(02)   VALUE SPACES. 02670000
026800     05  PV-CREATE-DATE                  PIC  X(08) VALUE SPACES. 02680000
026810     05  PV-USA-DATE                     PIC  X(10) VALUE SPACES. 02681000
026900     05  PV-SELECT-LIST-SEQ              PIC  X(01) VALUE SPACES. 02690000
027000     05  PV-NBR-ITEMS                    PIC  9(05) VALUE ZEROES. 02700000
027100     05  PV-SEL-TERM-ID                  PIC  X(04).              02710000
027200     05  PV-SEL-TASK-NUMBER              PIC  9(05).              02720000
027300     05  PV-SEL-SEQ                      PIC  9(01).              02730000
027310     05  PV-HOLD-STAT                    PIC  X(02).              02731013
027400                                                                  02740000
027500******************************************************************02750000
027600**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **02760000
027700**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **02770000
027800**  APPLICATION-SPECIFIC COMMAREA.                              **02780000
027900******************************************************************02790000
028000 01  LQW-LIST-QUEUE-WORK-AREA.                                    02800000
028100     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  02810000
028200     05  LQW-ITEM-ENTRIES               OCCURS 12 TIMES           02820000
028300                                        INDEXED BY LQW-IDX.       02830000
028400         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       02840000
028500         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               02850000
028600         10  LQW-SELECTED-SW            PIC  X(01).               02860000
028700             88  LQW-SELECT                         VALUE 'S'.    02870000
028800             88  LQW-DESELECT                       VALUE ' '.    02880000
028900         10  LQW-ACTION                 PIC  X(03).               02890000
029000             88  LQW-DEL                            VALUE 'DEL'.  02900000
029100             88  LQW-INQ                            VALUE 'INQ'.  02910000
029200             88  LQW-UPD                            VALUE 'UPD'.  02920000
029300             88  LQW-ERR                            VALUE 'ERR'.  02930000
029400         10  LQW-DOOR-ID                PIC  X(04).               02940000
029500         10  LQW-DOOR-TYPE              PIC  X(02).               02950000
029600         10  LQW-DESCRIPTION            PIC  X(11).               02960001
029700         10  LQW-TRLR-SRL-NBR           PIC  9(09).               02970000
029800         10  LQW-SCAC-CDE               PIC  X(04).               02980000
029900         10  LQW-TRLR-NBR               PIC  X(09).               02990000
030000         10  LQW-TRIP-ID                PIC  9(09).               03000000
030010         10  LQW-TRIP-STATUS            PIC  X(02).               03001001
030100         10  LQW-DATE-ASGN              PIC  X(10).               03010000
030200         10  LQW-DEST-NBR               PIC  9(04).               03020000
030300                                                                  03030000
030400*---------------------------------------------------------------* 03040000
030500* SELECTON QUEUE LAYOUT                                         * 03050000
030600*---------------------------------------------------------------* 03060000
030700     COPY SUWS010.                                                03070000
030800                                                                  03080000
030900*---------------------------------------------------------------* 03090000
031000*    MAP LAYOUT                                                 * 03100000
031100*---------------------------------------------------------------* 03110000
031200     COPY SUKM562.                                                03120000
031300*                                                                 03130000
031400 01  MR-OCCURS-LAYOUT                   REDEFINES  SU562AO.       03140000
031500     05  FILLER                         PIC  X(100).              03150003
031600     05  MR-SCROLL-AREA                 OCCURS 12 TIMES.          03160000
031700         10  MR-SELECTL                 PIC S9(04) COMP.          03170000
031800         10  MR-SELECTA                 PIC  X(01).               03180000
031900         10  MR-SELECTC                 PIC  X(01).               03190000
032000         10  MR-SELECTH                 PIC  X(01).               03200000
032100         10  MR-SELECTI                 PIC  X(01).               03210000
032200                                                                  03220000
032300         10  MR-ACTIONL                 PIC S9(04) COMP.          03230000
032400         10  MR-ACTIONA                 PIC  X(01).               03240000
032500         10  MR-ACTIONC                 PIC  X(01).               03250000
032600         10  MR-ACTIONH                 PIC  X(01).               03260000
032700         10  MR-ACTION                  PIC  X(03).               03270000
032800                                                                  03280000
032900         10  MR-DOOR-IDL                PIC S9(04) COMP.          03290000
033000         10  MR-DOOR-IDA                PIC  X(01).               03300000
033100         10  MR-DOOR-IDC                PIC  X(01).               03310000
033200         10  MR-DOOR-IDH                PIC  X(01).               03320000
033300         10  MR-DOOR-ID                 PIC  X(04).               03330000
033400                                                                  03340000
033500         10  MR-DOOR-TYPEL              PIC S9(04) COMP.          03350000
033600         10  MR-DOOR-TYPEA              PIC  X(01).               03360000
033700         10  MR-DOOR-TYPEC              PIC  X(01).               03370000
033800         10  MR-DOOR-TYPEH              PIC  X(01).               03380000
033900         10  MR-DOOR-TYPE               PIC  X(02).               03390000
034000                                                                  03400000
034100         10  MR-DESCRIPTIONL            PIC S9(04) COMP.          03410000
034200         10  MR-DESCRIPTIONA            PIC  X(01).               03420000
034300         10  MR-DESCRIPTIONC            PIC  X(01).               03430000
034400         10  MR-DESCRIPTIONH            PIC  X(01).               03440000
034500         10  MR-DESCRIPTION             PIC  X(11).               03450001
034600                                                                  03460000
034700         10  MR-TRLR-SRL-NBRL           PIC S9(04) COMP.          03470000
034800         10  MR-TRLR-SRL-NBRA           PIC  X(01).               03480000
034900         10  MR-TRLR-SRL-NBRC           PIC  X(01).               03490000
035000         10  MR-TRLR-SRL-NBRH           PIC  X(01).               03500000
035100         10  MR-TRLR-SRL-NBR            PIC  X(09).               03510000
035200                                                                  03520000
035300         10  MR-SCAC-CDEL               PIC S9(04) COMP.          03530000
035400         10  MR-SCAC-CDEA               PIC  X(01).               03540000
035500         10  MR-SCAC-CDEC               PIC  X(01).               03550000
035600         10  MR-SCAC-CDEH               PIC  X(01).               03560000
035700         10  MR-SCAC-CDE                PIC  X(04).               03570000
035800                                                                  03580000
035900         10  MR-TRLR-NBRL                PIC S9(04) COMP.         03590000
036000         10  MR-TRLR-NBRA               PIC  X(01).               03600000
036100         10  MR-TRLR-NBRC               PIC  X(01).               03610000
036200         10  MR-TRLR-NBRH               PIC  X(01).               03620000
036300         10  MR-TRLR-NBR                PIC  X(09).               03630000
036400                                                                  03640000
036500         10  MR-TRIP-IDL                PIC S9(04) COMP.          03650000
036600         10  MR-TRIP-IDA                PIC  X(01).               03660000
036700         10  MR-TRIP-IDC                PIC  X(01).               03670000
036800         10  MR-TRIP-IDH                PIC  X(01).               03680000
036900         10  MR-TRIP-ID                 PIC  X(09).               03690000
037000                                                                  03700000
037100         10  MR-TRIP-STATUSL            PIC S9(04) COMP.          03710005
037200         10  MR-TRIP-STATUSA            PIC  X(01).               03720005
037300         10  MR-TRIP-STATUSC            PIC  X(01).               03730005
037400         10  MR-TRIP-STATUSH            PIC  X(01).               03740005
037500         10  MR-TRIP-STATUS             PIC  X(02).               03750005
037600                                                                  03760000
037610         10  MR-DATE-ASGNL              PIC S9(04) COMP.          03761001
037620         10  MR-DATE-ASGNA              PIC  X(01).               03762001
037630         10  MR-DATE-ASGNC              PIC  X(01).               03763001
037640         10  MR-DATE-ASGNH              PIC  X(01).               03764001
037650         10  MR-DATE-ASGN               PIC  X(10).               03765001
037660                                                                  03766001
037700         10  MR-DEST-NBRL               PIC S9(04) COMP.          03770000
037800         10  MR-DEST-NBRA               PIC  X(01).               03780000
037900         10  MR-DEST-NBRC               PIC  X(01).               03790000
038000         10  MR-DEST-NBRH               PIC  X(01).               03800000
038100         10  MR-DEST-NBR                PIC  X(04).               03810000
038110     05  FILLER                         PIC  X(12).               03811003
038200                                                                  03820000
038300*    ITEM COMMAREA FOR XLKUT071                                   03830013
038400     COPY XLWS071.                                                03840013
038401                                                                  03840113
038402*---------------------------------------------------------------* 03840200
038403*    ATTRIBUTE SETTINGS COPYBOOK.                               * 03840300
038500*---------------------------------------------------------------* 03850000
038600     COPY DPWS015.                                                03860000
038700                                                                  03870000
038800*---------------------------------------------------------------* 03880000
038900*    FUNCTION KEYS COPYBOOK.                                    * 03890000
039000*---------------------------------------------------------------* 03900000
039100     COPY DPWS016.                                                03910000
039200                                                                  03920000
039300*---------------------------------------------------------------* 03930000
039400*    NUMERIC EDIT LAYOUT.                                       * 03940000
039500*---------------------------------------------------------------* 03950000
039600     COPY DPWS010I.                                               03960000
039700                                                                  03970000
039800*----------------------------------------------------------------*03980000
039900**  SECURITY SUBROUTINE PARAMETERS                                03990000
040000*----------------------------------------------------------------*04000000
040100     COPY DPWS008.                                                04010000
040200                                                                  04020000
040300*---------------------------------------------------------------* 04030000
040400*    PARAMETERS FOR CALLING CICS ARCHITECTURE API               * 04040016
040500*---------------------------------------------------------------* 04050000
040600     COPY DPWS030.                                                04060000
040600     COPY DPWS930.                                                04061016
040700                                                                  04070000
040800*---------------------------------------------------------------* 04080000
040900*    STANDARD COMMAREA.                                         * 04090000
041000*---------------------------------------------------------------* 04100000
041100     COPY DPWS020.                                                04110000
041200     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04120000
041300                                                                  04130000
041400*---------------------------------------------------------------* 04140000
041500* INTER-APPLICATION COMMAREA.                                   * 04150000
041600*   SUWS008 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 04160000
041700*             SPEC SCREEN.                                      * 04170000
041800*   SUWS009 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 04180000
041900*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 04190000
042000*---------------------------------------------------------------* 04200000
042100                                                                  04210000
042200         10  INTER-APPL-COMM-AREA       PIC X(200).               04220000
042300     COPY SUWS008.                                                04230000
042400     COPY SUWS009.                                                04240000
042500*---------------------------------------------------------------* 04250000
042600*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 04260000
042700*---------------------------------------------------------------* 04270000
042800         10  ASC-SPECIFIC-COMMAREA.                               04280000
042900             15  ASC-OPER-UNT-ID             PIC  X(04).          04290000
043000             15  ASC-OPER-UNT-ID-N REDEFINES                      04300000
043100                     ASC-OPER-UNT-ID         PIC  9(04).          04310000
043200             15  ASC-OPER-UNT-NAME           PIC  X(24).          04320000
043300             15  ASC-DOOR-ID                 PIC  X(04).          04330000
043400             15  ASC-DOOR-ID-R  REDEFINES ASC-DOOR-ID.            04340000
043500                 20  ASC-DOOR-ID-N           PIC  9(04).          04350000
043600             15  ASC-DOOR-TYPE               PIC  X(12).          04360000
043700             15  ASC-DOOR-DESC               PIC  X(12).          04370000
043800             15  ASC-TRLR-SRL-NMBR           PIC  9(09).          04380000
043900             15  ASC-SCAC-CODE               PIC  X(04).          04390000
043910             15  ASC-TRLR-STATUS             PIC  X(12).          04391013
044000             15  ASC-TRLR-ID                 PIC  X(09).          04400000
044100             15  ASC-OUTBOUND-TRIP-ID        PIC  9(09).          04410000
044200             15  ASC-DATE-ASGN.                                   04420000
044300                 20  ASC-ASGN-MM             PIC  X(02).          04430000
044400                 20  ASC-ASGN-DD             PIC  X(02).          04440000
044500                 20  ASC-ASGN-YY             PIC  X(04).          04450000
044600             15  ASC-STR-NBR-X               PIC  X(04).          04460000
044700             15  ASC-STR-NBR-N REDEFINES ASC-STR-NBR-X.           04470000
044800                 20  ASC-STR-NBR             PIC  9(04).          04480000
044900             15  ASC-SEQUENCE-SW             PIC  X(01).          04490000
045000                 88  ASC-DOOR-SEQ             VALUE 'D'.          04500013
045001                 88  ASC-STORE-SEQ            VALUE 'S'.          04500113
045002             15  FILLER                      PIC  X(124).         04500200
045003*-----------------------------------------------------------------04500300
045100             15  ASC-BLK-SUB                  PIC S9(04) COMP     04510000
045200                                                         SYNC.    04520000
045300             15  ASC-ITEM-SUB                 PIC S9(04) COMP     04530000
045400                                                         SYNC.    04540000
045500             15  ASC-NUMBER-OF-ITEMS-READ     PIC S9(09) COMP-3.  04550000
045600             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09) COMP-3.  04560000
045700             15  ASC-ITEMS-DISPLAYED          PIC S9(03) COMP-3.  04570000
045800             15  ASC-ITEM-AT-TOP-OF-PANEL     PIC S9(09) COMP-3.  04580000
045900             15  ASC-ITEM-AT-BOT-OF-PANEL     PIC S9(09) COMP-3.  04590000
046000             15  ASC-HIGHEST-BLOCK-WRITTEN    PIC S9(04) COMP     04600000
046100                                                         SYNC.    04610000
046200             15  ASC-START-OF-SELECTED-RANGE  PIC S9(09) COMP-3.  04620000
046300             15  ASC-END-OF-SELECTED-RANGE    PIC S9(09) COMP-3.  04630000
046400             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         04640000
046500                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     04650000
046600                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     04660000
046700             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         04670000
046800                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     04680000
046900                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     04690000
047000             15  ASC-LIST-QUEUE-NAME.                             04700000
047100                 20  ASC-LIST-TERM-ID         PIC  X(04).         04710000
047200                 20  ASC-LIST-TASK-NUMBER     PIC S9(05) COMP-3.  04720000
047300                 20  ASC-LIST-SEQ             PIC  9(01).         04730000
047400                                                                  04740000
047500             15  ASC-START-ITEM-REQUEST.                          04750000
047600                 20  ASC-START-ITEM-REQUEST-N PIC  9(05).         04760000
047700                                                                  04770000
047800             15  ASC-SEL-SUB                  PIC S9(4) COMP.     04780000
047900             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     04790000
048000             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          04800000
048100                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 04810000
048200             15  ASC-SEL-QUEUE-NAME.                              04820000
048300                 20  ASC-SEL-TERM-ID          PIC  X(04).         04830000
048400                 20  ASC-SEL-TASK-NUMBER      PIC S9(05) COMP-3.  04840000
048500                 20  ASC-SEL-SEQ              PIC  9(01).         04850000
048600             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  04860000
048700                                                                  04870000
048800*-----------------------------------------------------------------04880000
048900             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                04890000
049000                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  04900000
049100                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   04910000
049200                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   04920000
049300                                                                  04930000
049400                 20  ASC-ITEM-ARRAY.                              04940000
049500                     25  ASC-ITEM-ENTRIES OCCURS 12 TIMES.        04950000
049600                         30  ASC-LIST-ITEM-NUMBER                 04960000
049700                                                     PIC S9(09)   04970000
049800                                                     COMP-3.      04980000
049900                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  04990000
050000                             88  ASC-VALID-SELECT    VALUE ' '    05000000
050100                                                           'S'    05010000
050200                                                           'B'    05020000
050300                                                           'E'.   05030000
050400                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   05040000
050500                             88  ASC-TEMP-SELECT     VALUE 'S'.   05050000
050600                             88  ASC-TEMP-BEGIN      VALUE 'B'.   05060000
050700                             88  ASC-TEMP-END        VALUE 'E'.   05070000
050800                         30  ASC-SELECTED-SW         PIC  X(01).  05080000
050900                             88  ASC-NO-SELECT       VALUE ' '.   05090000
051000                             88  ASC-SELECT          VALUE 'S'.   05100000
051100                             88  ASC-BEGIN           VALUE 'B'.   05110000
051200                             88  ASC-END             VALUE 'E'.   05120000
051300                         30  ASC-ACTION              PIC  X(03).  05130000
051400                         30  ASC-DOORID              PIC  X(04).  05140000
051500                         30  ASC-DOORTYPE            PIC  X(02).  05150000
051600                         30  ASC-DESCRIPTION         PIC  X(11).  05160001
051700                         30  ASC-TRLR-SRL-NBR        PIC  9(09).  05170000
051800                         30  ASC-SCAC                PIC  X(04).  05180000
051900                         30  ASC-TRLR-NBR            PIC  X(09).  05190000
052000                         30  ASC-TRIP-ID             PIC  X(09).  05200000
052010                         30  ASC-TRIP-STATUS         PIC  X(02).  05201001
052100                         30  ASC-DATEASGN            PIC  X(10).  05210000
052200                         30  ASC-DEST-NBR            PIC  9(04).  05220000
052210*            15  FILLER                       PIC  X(815).        05221000
052300                                                                  05230000
052400*---------------------------------------------------------------* 05240000
052500*    ABEND PROCESSING COPYBOOK.                                 * 05250000
052600*---------------------------------------------------------------* 05260000
052700     COPY DPWS013.                                                05270000
052800                                                                  05280000
052900*---------------------------------------------------------------* 05290000
053000*    TSUOBTR - OUTBOUND TRAILER TRIP                            * 05300000
053100*---------------------------------------------------------------* 05310000
053200     EXEC SQL                                                     05320000
053300          INCLUDE TSUOBTR                                         05330017
053400     END-EXEC.                                                    05340000
053500                                                                  05350000
053600*---------------------------------------------------------------* 05360000
053700*    TSUOBTS - OUTBOUND TRAILER TRIP STATUS                     * 05370000
053800*---------------------------------------------------------------* 05380000
053900     EXEC SQL                                                     05390000
054000          INCLUDE TSUOBTS                                         05400000
054100     END-EXEC.                                                    05410000
054200                                                                  05420000
054300*---------------------------------------------------------------* 05430000
054400*    TCNDRST - DOOR STATUS                                        05440000
054500*---------------------------------------------------------------* 05450000
054600     EXEC SQL                                                     05460000
054700          INCLUDE TCNDRST                                         05470000
054800     END-EXEC.                                                    05480000
054900                                                                  05490000
055000*---------------------------------------------------------------* 05500000
055100*    TCNDCDR - DC TO DOOR ASSIGNMENT                            * 05510000
055200*---------------------------------------------------------------* 05520000
055300     EXEC SQL                                                     05530000
055400          INCLUDE TCNDCDR                                         05540000
055500     END-EXEC.                                                    05550000
055600                                                                  05560000
055700*---------------------------------------------------------------* 05570000
055800*    TCNDRTY - DOOR TYPE DESCRIPTION                            * 05580000
055900*---------------------------------------------------------------* 05590000
056000     EXEC SQL                                                     05600000
056100          INCLUDE TCNDRTY                                         05610000
056200     END-EXEC.                                                    05620000
056300                                                                  05630000
056400*---------------------------------------------------------------* 05640000
056500*    TCNTRID - TRAILER ID                                         05650000
056600*---------------------------------------------------------------* 05660000
056700     EXEC SQL                                                     05670000
056800          INCLUDE TCNTRID                                         05680000
056900     END-EXEC.                                                    05690000
057000                                                                  05700000
057800*---------------------------------------------------------------* 05780000
057900*    DB2 AREA FOR COMMUNICATIONS                                * 05790000
058000*---------------------------------------------------------------* 05800000
058100     EXEC SQL                                                     05810000
058200          INCLUDE SQLCA                                           05820000
058300     END-EXEC.                                                    05830000
058400                                                                  05840000
058500*---------------------------------------------------------------* 05850000
058600*   OPER UNT CURSOR                                               05860000
058700*---------------------------------------------------------------* 05870000
058800     EXEC SQL                                                     05880000
058900          DECLARE OPER-UNT-CSR CURSOR FOR                         05890000
059000              SELECT   DISTINCT(A.OTBND_TRIP_ID)                  05900000
059100                     ,A.DOOR_ID                                   05910000
059110                     ,A.TRIP_STAT_CDE                             05911002
059200                     ,B.DEST_OPER_UNT_ID                          05920000
059300                     ,B.TRLR_SRL_NBR                              05930000
059400                     ,C.SCAC_CDE                                  05940000
059500                     ,C.TRLR_ID                                   05950000
059600                     ,D.DOOR_TYP_CDE                              05960000
059700                     ,D.DOOR_LOC_DESC                             05970000
059800               FROM  TSUOBTS A                                    05980000
059900                    ,TSUOBTR B                                    05990000
060000                    ,TCNTRID C                                    06000000
060100                    ,TCNDCDR D                                    06010000
060200             WHERE  B.ORGN_OPER_UNT_ID       =  :DK-OPER-UNT-ID   06020000
060300               AND  A.OTBND_TRIP_ID          =  B.OTBND_TRIP_ID   06030000
060400               AND  B.TRLR_SRL_NBR           =  C.TRLR_SRL_NBR    06040000
060500               AND  NOT A.TRIP_STAT_CDE IN ('DS','SO','SU','AR')  06050014
060600               AND  A.DOOR_ID                =  D.DOOR_ID         06060000
060700               AND  B.ORGN_OPER_UNT_ID       =  D.OPER_UNT_ID     06070000
060800                                                                  06080013
060900                 AND  A.TRIP_STAT_CDE IN (:DK-STAT-CDE1,          06090013
061000                                          :DK-STAT-CDE2,          06100013
061100                                          :DK-STAT-CDE3,          06110013
061200                                          :DK-STAT-CDE4,          06120013
061300                                          :DK-STAT-CDE5,          06130013
061400                                          :DK-STAT-CDE6,          06140013
061500                                          :DK-STAT-CDE7,          06150013
061600                                          :DK-STAT-CDE8)          06160013
061601                                                                  06160113
061602               AND  A.OTBND_STAT_TMST  =                          06160200
061603                  (SELECT  MAX(E.OTBND_STAT_TMST)                 06160300
061604                     FROM  TSUOBTS E                              06160400
061605                   WHERE  E.OTBND_TRIP_ID     = A.OTBND_TRIP_ID)  06160500
061606               ORDER  BY A.DOOR_ID                                06160600
061607     END-EXEC.                                                    06160700
061608*                                                                 06160800
061609*    IN STORE SEQUENCE                                            06160900
061610     EXEC SQL                                                     06161000
061611          DECLARE OPER-UNT-CSR-ALT CURSOR FOR                     06161100
061612              SELECT   DISTINCT(A.OTBND_TRIP_ID)                  06161200
061613                     ,A.DOOR_ID                                   06161300
061614                     ,A.TRIP_STAT_CDE                             06161402
061615                     ,B.DEST_OPER_UNT_ID                          06161500
061616                     ,B.TRLR_SRL_NBR                              06161600
061617                     ,C.SCAC_CDE                                  06161700
061618                     ,C.TRLR_ID                                   06161800
061619                     ,D.DOOR_TYP_CDE                              06161900
061620                     ,D.DOOR_LOC_DESC                             06162000
061621               FROM  TSUOBTS A                                    06162100
061622                    ,TSUOBTR B                                    06162200
061623                    ,TCNTRID C                                    06162300
061624                    ,TCNDCDR D                                    06162400
061625             WHERE  B.ORGN_OPER_UNT_ID       =  :DK-OPER-UNT-ID   06162500
061626               AND  A.OTBND_TRIP_ID          =  B.OTBND_TRIP_ID   06162600
061627               AND  B.TRLR_SRL_NBR           =  C.TRLR_SRL_NBR    06162700
061628               AND  NOT A.TRIP_STAT_CDE IN ('DS','SO','SU','AR')  06162814
061629               AND  A.DOOR_ID                =  D.DOOR_ID         06162900
061630               AND  B.ORGN_OPER_UNT_ID       =  D.OPER_UNT_ID     06163000
061640                                                                  06164013
061650                 AND  A.TRIP_STAT_CDE IN (:DK-STAT-CDE1,          06165013
061660                                          :DK-STAT-CDE2,          06166013
061670                                          :DK-STAT-CDE3,          06167013
061680                                          :DK-STAT-CDE4,          06168013
061690                                          :DK-STAT-CDE5,          06169013
061700                                          :DK-STAT-CDE6,          06170013
061800                                          :DK-STAT-CDE7,          06180013
061900                                          :DK-STAT-CDE8)          06190013
061901                                                                  06190113
061902               AND  A.OTBND_STAT_TMST  =                          06190200
061903                  (SELECT  MAX(E.OTBND_STAT_TMST)                 06190300
061904                     FROM  TSUOBTS E                              06190400
061905                   WHERE  E.OTBND_TRIP_ID     = A.OTBND_TRIP_ID)  06190500
061906               ORDER  BY B.DEST_OPER_UNT_ID                       06190600
061907     END-EXEC.                                                    06190700
061908                                                                  06190800
061909*---------------------------------------------------------------* 06190900
061910*    DOOR ID CURSOR (DOOR SEQUENCE)                               06191000
061911*---------------------------------------------------------------* 06191100
061912     EXEC SQL                                                     06191200
061913          DECLARE DOOR-ID-CSR CURSOR FOR                          06191300
062000              SELECT   DISTINCT(A.OTBND_TRIP_ID)                  06200000
062100                     ,A.DOOR_ID                                   06210000
062110                     ,A.TRIP_STAT_CDE                             06211002
062200                     ,B.DEST_OPER_UNT_ID                          06220000
062300                     ,B.TRLR_SRL_NBR                              06230000
062400                     ,C.SCAC_CDE                                  06240000
062500                     ,C.TRLR_ID                                   06250000
062600                     ,D.DOOR_TYP_CDE                              06260000
062700                     ,D.DOOR_LOC_DESC                             06270000
062800             FROM   TSUOBTS A                                     06280000
062900                   ,TSUOBTR B                                     06290000
063000                   ,TCNTRID C                                     06300000
063100                   ,TCNDCDR D                                     06310000
063200            WHERE  A.DOOR_ID               =  :DK-DOOR-ID         06320000
063300              AND  B.ORGN_OPER_UNT_ID      =  :DK-OPER-UNT-ID     06330000
063400              AND  B.OTBND_TRIP_ID         =  A.OTBND_TRIP_ID     06340000
063500              AND  B.TRLR_SRL_NBR          =  C.TRLR_SRL_NBR      06350000
063600              AND  NOT A.TRIP_STAT_CDE IN ('DS','SO','SU','AR')   06360014
063700              AND  A.DOOR_ID               =  D.DOOR_ID           06370000
063800              AND  B.ORGN_OPER_UNT_ID      =  D.OPER_UNT_ID       06380000
063900                                                                  06390013
064000                 AND  A.TRIP_STAT_CDE IN (:DK-STAT-CDE1,          06400013
064100                                          :DK-STAT-CDE2,          06410013
064200                                          :DK-STAT-CDE3,          06420013
064300                                          :DK-STAT-CDE4,          06430013
064400                                          :DK-STAT-CDE5,          06440013
064500                                          :DK-STAT-CDE6,          06450013
064600                                          :DK-STAT-CDE7,          06460013
064700                                          :DK-STAT-CDE8)          06470013
064701                                                                  06470113
064702              AND  A.OTBND_STAT_TMST  IN                          06470200
064703                (SELECT  MAX(E.OTBND_STAT_TMST)                   06470300
064704                   FROM  TSUOBTS E                                06470400
064705                   WHERE  E.OTBND_TRIP_ID     = A.OTBND_TRIP_ID)  06470500
064706              ORDER  BY A.DOOR_ID                                 06470600
064707     END-EXEC.                                                    06470700
064708                                                                  06470800
064709                                                                  06470900
064710*    STORE SEQUENCE                                               06471000
064711     EXEC SQL                                                     06471100
064712          DECLARE DOOR-ID-CSR-ALT CURSOR FOR                      06471200
064713              SELECT   DISTINCT(A.OTBND_TRIP_ID)                  06471300
064714                     ,A.DOOR_ID                                   06471400
064715                     ,A.TRIP_STAT_CDE                             06471502
064716                     ,B.DEST_OPER_UNT_ID                          06471600
064717                     ,B.TRLR_SRL_NBR                              06471700
064718                     ,C.SCAC_CDE                                  06471800
064719                     ,C.TRLR_ID                                   06471900
064720                     ,D.DOOR_TYP_CDE                              06472000
064721                     ,D.DOOR_LOC_DESC                             06472100
064722             FROM   TSUOBTS A                                     06472200
064723                   ,TSUOBTR B                                     06472300
064724                   ,TCNTRID C                                     06472400
064725                   ,TCNDCDR D                                     06472500
064726            WHERE  A.DOOR_ID               =  :DK-DOOR-ID         06472600
064727              AND  B.ORGN_OPER_UNT_ID      =  :DK-OPER-UNT-ID     06472700
064728              AND  B.OTBND_TRIP_ID         =  A.OTBND_TRIP_ID     06472800
064729              AND  B.TRLR_SRL_NBR          =  C.TRLR_SRL_NBR      06472900
064730              AND  NOT A.TRIP_STAT_CDE IN ('DS','SO','SU','AR')   06473014
064731              AND  A.DOOR_ID               =  D.DOOR_ID           06473100
064732              AND  B.ORGN_OPER_UNT_ID      =  D.OPER_UNT_ID       06473200
064733                                                                  06473313
064734                 AND  A.TRIP_STAT_CDE IN (:DK-STAT-CDE1,          06473413
064735                                          :DK-STAT-CDE2,          06473513
064736                                          :DK-STAT-CDE3,          06473613
064737                                          :DK-STAT-CDE4,          06473713
064738                                          :DK-STAT-CDE5,          06473813
064739                                          :DK-STAT-CDE6,          06473913
064740                                          :DK-STAT-CDE7,          06474013
064750                                          :DK-STAT-CDE8)          06475013
064751                                                                  06475113
064752              AND  A.OTBND_STAT_TMST  IN                          06475200
064753                (SELECT  MAX(E.OTBND_STAT_TMST)                   06475300
064754                   FROM  TSUOBTS E                                06475400
064755                   WHERE  E.OTBND_TRIP_ID     = A.OTBND_TRIP_ID)  06475500
064756               ORDER  BY B.DEST_OPER_UNT_ID                       06475600
064757     END-EXEC.                                                    06475700
064758                                                                  06475800
064759*---------------------------------------------------------------* 06475900
064760*    DOOR TYPE CURSOR (DOOR SEQUENCE)                             06476000
064800*---------------------------------------------------------------* 06480000
064900     EXEC SQL                                                     06490000
065000          DECLARE DOOR-TYPE-CSR CURSOR FOR                        06500000
065100              SELECT   DISTINCT(A.OTBND_TRIP_ID)                  06510000
065200                     ,A.DOOR_ID                                   06520000
065210                     ,A.TRIP_STAT_CDE                             06521002
065300                     ,B.DEST_OPER_UNT_ID                          06530000
065400                     ,B.TRLR_SRL_NBR                              06540000
065500                     ,C.SCAC_CDE                                  06550000
065600                     ,C.TRLR_ID                                   06560000
065700                     ,D.DOOR_TYP_CDE                              06570000
065800                     ,D.DOOR_LOC_DESC                             06580000
065900             FROM   TSUOBTS A                                     06590000
066000                   ,TSUOBTR B                                     06600000
066100                   ,TCNTRID C                                     06610000
066200                   ,TCNDCDR D                                     06620000
066300            WHERE  B.ORGN_OPER_UNT_ID      =  :DK-OPER-UNT-ID     06630000
066400              AND  B.OTBND_TRIP_ID         =  A.OTBND_TRIP_ID     06640000
066500              AND  B.TRLR_SRL_NBR          =  C.TRLR_SRL_NBR      06650000
066600              AND  NOT A.TRIP_STAT_CDE IN ('DS','SO','SU','AR')   06660014
066700              AND  A.DOOR_ID               =  D.DOOR_ID           06670000
066800              AND  B.ORGN_OPER_UNT_ID      =  D.OPER_UNT_ID       06680000
066900              AND  D.DOOR_TYP_CDE  IN (:DK-TYPE-CDE1,             06690000
067000                                       :DK-TYPE-CDE2,             06700000
067100                                       :DK-TYPE-CDE3,             06710000
067200                                       :DK-TYPE-CDE4,             06720000
067300                                       :DK-TYPE-CDE5,             06730000
067400                                       :DK-TYPE-CDE6,             06740000
067500                                       :DK-TYPE-CDE7,             06750000
067600                                       :DK-TYPE-CDE8)             06760000
067700                                                                  06770013
067800                 AND  A.TRIP_STAT_CDE IN (:DK-STAT-CDE1,          06780013
067900                                          :DK-STAT-CDE2,          06790013
068000                                          :DK-STAT-CDE3,          06800013
068100                                          :DK-STAT-CDE4,          06810013
068200                                          :DK-STAT-CDE5,          06820013
068300                                          :DK-STAT-CDE6,          06830013
068400                                          :DK-STAT-CDE7,          06840013
068500                                          :DK-STAT-CDE8)          06850013
068501                                                                  06850113
068502              AND  A.OTBND_STAT_TMST  IN                          06850200
068503                (SELECT  MAX(E.OTBND_STAT_TMST)                   06850300
068504                   FROM  TSUOBTS E                                06850400
068505                   WHERE  E.OTBND_TRIP_ID     = A.OTBND_TRIP_ID)  06850500
068506              ORDER  BY A.DOOR_ID                                 06850600
068507     END-EXEC.                                                    06850700
068508                                                                  06850813
068509                                                                  06850913
068510*    STORE-SEQ                                                    06851013
068511     EXEC SQL                                                     06851100
068512          DECLARE DOOR-TYPE-CSR-ALT CURSOR FOR                    06851200
068513              SELECT   DISTINCT(A.OTBND_TRIP_ID)                  06851300
068514                     ,A.DOOR_ID                                   06851400
068515                     ,A.TRIP_STAT_CDE                             06851502
068516                     ,B.DEST_OPER_UNT_ID                          06851600
068517                     ,B.TRLR_SRL_NBR                              06851700
068518                     ,C.SCAC_CDE                                  06851800
068519                     ,C.TRLR_ID                                   06851900
068520                     ,D.DOOR_TYP_CDE                              06852000
068521                     ,D.DOOR_LOC_DESC                             06852100
068522             FROM   TSUOBTS A                                     06852200
068523                   ,TSUOBTR B                                     06852300
068524                   ,TCNTRID C                                     06852400
068525                   ,TCNDCDR D                                     06852500
068526            WHERE  B.ORGN_OPER_UNT_ID      =  :DK-OPER-UNT-ID     06852600
068527              AND  B.OTBND_TRIP_ID         =  A.OTBND_TRIP_ID     06852700
068528              AND  B.TRLR_SRL_NBR          =  C.TRLR_SRL_NBR      06852800
068529              AND  NOT A.TRIP_STAT_CDE IN ('DS','SO','SU','AR')   06852914
068530              AND  A.DOOR_ID               =  D.DOOR_ID           06853000
068531              AND  B.ORGN_OPER_UNT_ID      =  D.OPER_UNT_ID       06853100
068532              AND  D.DOOR_TYP_CDE  IN (:DK-TYPE-CDE1,             06853200
068533                                       :DK-TYPE-CDE2,             06853300
068534                                       :DK-TYPE-CDE3,             06853400
068535                                       :DK-TYPE-CDE4,             06853500
068536                                       :DK-TYPE-CDE5,             06853600
068537                                       :DK-TYPE-CDE6,             06853700
068538                                       :DK-TYPE-CDE7,             06853800
068539                                       :DK-TYPE-CDE8)             06853900
068540                                                                  06854013
068550                 AND  A.TRIP_STAT_CDE IN (:DK-STAT-CDE1,          06855013
068560                                          :DK-STAT-CDE2,          06856013
068570                                          :DK-STAT-CDE3,          06857013
068580                                          :DK-STAT-CDE4,          06858013
068590                                          :DK-STAT-CDE5,          06859013
068600                                          :DK-STAT-CDE6,          06860013
068700                                          :DK-STAT-CDE7,          06870013
068800                                          :DK-STAT-CDE8)          06880013
068801                                                                  06880113
068802              AND  A.OTBND_STAT_TMST  IN                          06880200
068803                (SELECT  MAX(E.OTBND_STAT_TMST)                   06880300
068804                   FROM  TSUOBTS E                                06880400
068805                   WHERE  E.OTBND_TRIP_ID     = A.OTBND_TRIP_ID)  06880500
068806               ORDER  BY B.DEST_OPER_UNT_ID                       06880600
068807     END-EXEC.                                                    06880700
068808*-----------------------------------------------------------------06880800
068809 LINKAGE SECTION.                                                 06880900
068810                                                                  06881000
068811 01  DFHCOMMAREA.                                                 06881100
068812     05  FILLER                         OCCURS  1 TO 4072 TIMES   06881200
068813                                        DEPENDING ON EIBCALEN.    06881300
068900         10  FILLER                     PIC X.                    06890000
069000                                                                  06900000
069100                                                                  06910000
069200 PROCEDURE DIVISION.                                              06920000
069300******************************************************************06930000
069400**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **06940000
069500**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **06950000
069600**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **06960000
069700******************************************************************06970000
069800 0000-MAIN-MODULE.                                                06980000
069900     INITIALIZE DP030-CICS-API-FIELDS.                            06990000
070000     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       07000000
070100     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          07010000
070200     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         07020000
070300     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       07030000
070400     MOVE LENGTH OF SU562AI        TO DP030-MAP-LENGTH (1).       07040000
070500     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     07050000
070600     PERFORM 0001-CALL-CICS-ARCH-API.                             07060000
070700*                                                                 07070000
070800     PERFORM 1000-CONTROL-PROCESSING                              07080000
070900*                                                                 07090000
071000     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     07100000
071100     PERFORM 0001-CALL-CICS-ARCH-API.                             07110000
071200                                                                  07120000
071300******************************************************************07130000
071400**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **07140000
071500**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **07150000
071600******************************************************************07160000
071700 0001-CALL-CICS-ARCH-API.                                         07170000
071800*    CALL 'DPKCS030' USING DFHEIBLK                               07180016
071800     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      07181016
071900                           DFHCOMMAREA                            07190000
072000                           DP030-CICS-API-FIELDS                  07200000
072100                           DP020-STANDARD-COMMAREA                07210000
072200                           SU562AI.                               07220000
072300*                                                                 07230000
072400     IF  DP030-RC-CALL-SUCCESSFUL                                 07240000
072500         CONTINUE                                                 07250000
072600     ELSE                                                         07260000
072700         SET DP013-NO-ROLLBACK                                    07270000
072800             DP013-XCTL-DISPLAY-RESTART                           07280000
072900             DP013-CICS-ABEND      TO TRUE                        07290000
073000         MOVE '0001-CALL-CICS-ARCH-API' TO DP013-PARAGRAPH        07300000
073100*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX07310016
073200*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      07320016
073100         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL. RETURN-CODE O07321016
073200-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      07322016
073300         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      07330000
073400         PERFORM DP013-0000-PROCESS-ABEND                         07340000
073500     END-IF.                                                      07350000
073600                                                                  07360000
073700*----------------------------------------------------------------*07370000
073800* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *07380000
073900* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *07390000
074000*                                                                *07400000
074100* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *07410000
074200*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *07420000
074300*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *07430000
074400*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *07440000
074500*----------------------------------------------------------------*07450000
074600 1000-CONTROL-PROCESSING.                                         07460000
074700                                                                  07470000
074800     EVALUATE TRUE                                                07480000
074900         WHEN DP020-NEXT-ACT-INITIAL                              07490000
075000             INITIALIZE ASC-SPECIFIC-COMMAREA                     07500000
075100             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            07510000
075200                                      ASC-SEL-TERM-ID             07520000
075300             MOVE DP020-SRC-TASK-NUMBER TO ASC-LIST-TASK-NUMBER   07530000
075400                                           ASC-SEL-TASK-NUMBER    07540000
075500             MOVE PC-LIST-QUEUE-SEQ  TO ASC-LIST-SEQ              07550000
075600             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 07560000
075610             SET ASC-DOOR-SEQ         TO TRUE                     07561013
075700             PERFORM 1100-PROCESS-INTER-APPL-COMM                 07570000
075800***-----$TEMPLATE NOTE$-------------------------------------------07580000
075900*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,07590000
076000*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  07600000
076100*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.07610000
076200***---------------------------------------------------------------07620000
076300             IF  PS-COMMAREA-NOT-VALID                            07630000
076400                 SET DP020-NEXT-ACT-APPL-ERROR TO TRUE            07640000
076500             ELSE                                                 07650000
076600                 PERFORM 4000-BUILD-INITIAL-PANEL                 07660000
076700             END-IF                                               07670000
076800                                                                  07680000
076900         WHEN DP020-NEXT-ACT-READ-MAP                             07690000
077000             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         07700000
077100             PERFORM 2000-PROCESS-PANEL                           07710000
077200                                                                  07720000
077300         WHEN DP020-NEXT-ACT-RETURN                               07730000
077400             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         07740000
077500             MOVE ZERO  TO ASC-ITEM-AT-TOP-OF-PANEL               07750000
077600             IF ASC-DOOR-SEQ                                      07760013
077700                 MOVE 'DOOR SEQUENCE'  TO ASEQO                   07770013
077800             ELSE                                                 07780013
077900                 MOVE 'STORE SEQUENCE' TO ASEQO                   07790013
078000             END-IF                                               07800013
078001                                                                  07800113
078002             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 07800200
078003             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07800300
078004                                                                  07800400
078005         WHEN OTHER                                               07800500
078006             SET DP013-LOGIC-ABEND TO TRUE                        07800600
078100             SET DP013-NO-ROLLBACK TO TRUE                        07810000
078200             MOVE '1000-CONTROL-PROCESSING' TO DP013-PARAGRAPH    07820000
078300             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    07830000
078400                                   TO DP013-MESSAGE-TEXT(1)       07840000
078500             PERFORM DP013-0000-PROCESS-ABEND                     07850000
078600     END-EVALUATE.                                                07860000
078700                                                                  07870000
078800*----------------------------------------------------------------*07880000
078900* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *07890000
079000* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *07900000
079100*----------------------------------------------------------------*07910000
079200 1100-PROCESS-INTER-APPL-COMM.                                    07920000
079300                                                                  07930000
079400     SET PS-COMMAREA-VALID         TO TRUE.                       07940000
079500     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     07950000
079600                                                                  07960000
079700     IF  DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT          07970000
079800         MOVE SU008-OPER-UNT-ID       TO ASC-OPER-UNT-ID-N        07980000
079900                                         DK-OPER-UNT-ID           07990000
080000         MOVE SU008-DOOR-ID           TO ASC-DOOR-ID              08000000
080100                                         DK-DOOR-ID               08010000
080200         MOVE SU008-DOOR-TYPE         TO ASC-DOOR-TYPE            08020000
080300         MOVE SU008-TRLR-SRL-NBR      TO ASC-TRLR-SRL-NMBR        08030000
080400         MOVE SU008-SCAC-CDE          TO ASC-SCAC-CODE            08040000
080500         MOVE SU008-DEST-STR-NBR      TO ASC-STR-NBR              08050000
080600         MOVE SU008-TRIP-ID           TO ASC-OUTBOUND-TRIP-ID     08060000
080700         MOVE SU008-TRLR-STATUS       TO ASC-TRLR-STATUS          08070013
080701                                         DK-TRLR-STATUS           08070113
080702     ELSE                                                         08070200
080800         MOVE SU009-OPER-UNT-ID       TO ASC-OPER-UNT-ID-N        08080000
080900         MOVE SU009-TRLR-SRL-NBR      TO ASC-TRLR-SRL-NMBR        08090000
081000         MOVE SU009-SCAC-CDE          TO ASC-SCAC-CODE            08100000
081100         MOVE SU009-TRLR-ID           TO ASC-TRLR-ID              08110000
081200         MOVE SU009-STATUS-DATE       TO ASC-DATE-ASGN            08120000
081300         MOVE SU009-DEST-STR-NBR      TO ASC-STR-NBR              08130000
081400         MOVE SU009-TRIP-ID           TO ASC-OUTBOUND-TRIP-ID     08140000
081500     END-IF.                                                      08150000
081600                                                                  08160000
081700*-----------------------------------------------------------------08170000
081800 1120-PREPARE-LIST-ENTRY.                                         08180000
081900                                                                  08190000
082000     MOVE SU010-MAX-ITEMS          TO ASC-SEL-SUB.                08200000
082100     MOVE ZERO                     TO ASC-SEL-ITEM.               08210000
082200     PERFORM 1130-GET-NEXT-RECORD.                                08220000
082300                                                                  08230000
082400*-----------------------------------------------------------------08240000
082500*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*08250000
082600*-----------------------------------------------------------------08260000
082700 1130-GET-NEXT-RECORD.                                            08270000
082800                                                                  08280000
082900     ADD +1                       TO ASC-SEL-SUB.                 08290000
083000                                                                  08300000
083100     IF  ASC-SEL-SUB > SU010-MAX-ITEMS                            08310000
083200         ADD +1                   TO ASC-SEL-ITEM                 08320000
083300         MOVE +1                  TO ASC-SEL-SUB                  08330000
083400     END-IF.                                                      08340000
083500                                                                  08350000
083600     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                08360000
083700         PERFORM 9100-READ-SEL-QUEUE                              08370000
083800         IF  SU010-ITEM (ASC-SEL-SUB) > ZERO                      08380000
083900             MOVE SU010-DOOR-ID  (ASC-SEL-SUB)                    08390000
084000                                       TO ASC-DOOR-ID             08400000
084100             MOVE SU010-DOOR-TYPE  (ASC-SEL-SUB)                  08410000
084200                                       TO ASC-DOOR-TYPE           08420000
084300             MOVE SU010-DESCRIPTION (ASC-SEL-SUB)                 08430000
084400                                       TO ASC-DOOR-DESC           08440000
084500             MOVE SU010-TRLR-SRL-NBR (ASC-SEL-SUB)                08450000
084600                                       TO ASC-TRLR-SRL-NMBR       08460000
084700             MOVE SU010-SCAC (ASC-SEL-SUB)                        08470000
084800                                       TO ASC-SCAC-CODE           08480000
084900             MOVE SU010-TRIP-ID (ASC-SEL-SUB)                     08490000
085000                                       TO ASC-OUTBOUND-TRIP-ID    08500000
085100             MOVE SU010-STAT-DATE (ASC-SEL-SUB)                   08510000
085200                                       TO ASC-DATE-ASGN           08520000
085300             MOVE SU010-DEST-NBR (ASC-SEL-SUB)                    08530000
085400                                       TO ASC-STR-NBR             08540000
085500             SET SU010-INQ (ASC-SEL-SUB) TO TRUE                  08550000
085600             PERFORM 9200-REWRITE-SEL-QUEUE                       08560000
085700         ELSE                                                     08570000
085800             SUBTRACT +1 FROM ASC-SEL-SUB                         08580000
085900             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             08590000
086000             SET DP020-MSG-INFORMATIONAL                          08600000
086100                 PS-LIST-END             TO TRUE                  08610000
086200         END-IF                                                   08620000
086300     ELSE                                                         08630000
086400         SUBTRACT +1 FROM ASC-SEL-ITEM                            08640000
086500         MOVE SU010-MAX-ITEMS     TO ASC-SEL-SUB                  08650000
086600         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             08660000
086700         SET DP020-MSG-INFORMATIONAL                              08670000
086800             PS-LIST-END             TO TRUE                      08680000
086900     END-IF.                                                      08690000
087000                                                                  08700000
087100*-----------------------------------------------------------------08710000
087200*    GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING      *08720000
087300*    PROCESSED.                                                  *08730000
087400*-----------------------------------------------------------------08740000
087500 1140-GET-PREV-RECORD.                                            08750000
087600                                                                  08760000
087700     SUBTRACT +1 FROM ASC-SEL-SUB.                                08770000
087800                                                                  08780000
087900     IF  ASC-SEL-SUB < +1                                         08790000
088000         SUBTRACT +1 FROM ASC-SEL-ITEM                            08800000
088100         MOVE SU010-MAX-ITEMS     TO ASC-SEL-SUB                  08810000
088200     END-IF.                                                      08820000
088300                                                                  08830000
088400     IF  ASC-SEL-ITEM > ZERO                                      08840000
088500         PERFORM 9100-READ-SEL-QUEUE                              08850000
088600         MOVE SU010-DOOR-ID  (ASC-SEL-SUB)                        08860000
088700                                       TO ASC-DOOR-ID             08870000
088800         MOVE SU010-DOOR-TYPE  (ASC-SEL-SUB)                      08880000
088900                                       TO ASC-DOOR-TYPE           08890000
089000         MOVE SU010-DESCRIPTION (ASC-SEL-SUB)                     08900000
089100                                       TO ASC-DOOR-DESC           08910000
089200         MOVE SU010-TRLR-SRL-NBR (ASC-SEL-SUB)                    08920000
089300                                       TO ASC-TRLR-SRL-NMBR       08930000
089400         MOVE SU010-SCAC (ASC-SEL-SUB) TO ASC-SCAC-CODE           08940000
089500         MOVE SU010-TRIP-ID (ASC-SEL-SUB)                         08950000
089600                                       TO ASC-OUTBOUND-TRIP-ID    08960000
089700         MOVE SU010-STAT-DATE (ASC-SEL-SUB)                       08970000
089800                                       TO ASC-DATE-ASGN           08980000
089900         MOVE SU010-DEST-NBR (ASC-SEL-SUB)                        08990000
090000                                       TO ASC-STR-NBR             09000000
090100         SET SU010-INQ (ASC-SEL-SUB) TO TRUE                      09010000
090200         PERFORM 9200-REWRITE-SEL-QUEUE                           09020000
090300     ELSE                                                         09030000
090400         MOVE +1                  TO ASC-SEL-ITEM                 09040000
090500                                     ASC-SEL-SUB                  09050000
090600         MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             09060000
090700         SET DP020-MSG-INFORMATIONAL                              09070000
090800             PS-LIST-END             TO TRUE                      09080000
090900     END-IF.                                                      09090000
091000                                                                  09100000
091100*----------------------------------------------------------------*09110000
091200* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *09120000
091300* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *09130000
091400* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *09140000
091500* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *09150000
091600* FUNCTION KEYS CAN GET THIS FAR.                                *09160000
091700*----------------------------------------------------------------*09170000
091800 2000-PROCESS-PANEL.                                              09180000
091900     EVALUATE TRUE                                                09190000
092000         WHEN DP020-SRC-AID = DP016-CLEAR                         09200000
092100             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    09210000
092200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   09220000
092300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09230000
092400                                                                  09240000
092500         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    09250000
092600             PERFORM 2050-DELETE-LIST-QUEUE                       09260000
092700             PERFORM 4000-BUILD-INITIAL-PANEL                     09270000
092800                                                                  09280000
092900         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    09290000
093000             PERFORM 2140-DESELECT-ALL-ITEMS                      09300000
093100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09310000
093200                                                                  09320000
093300         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  09330000
093400             PERFORM 2150-SELECT-ALL-ITEMS                        09340000
093500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09350000
093600                                                                  09360000
093700         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             09370000
093800             IF  ASC-USE-SELECTION-QUEUE                          09380000
093900                 PERFORM 1130-GET-NEXT-RECORD                     09390000
094000                 IF PS-LIST-END                                   09400000
094100                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         09410000
094200                     SET PS-NO-LIST-END TO TRUE                   09420000
094300                 ELSE                                             09430000
094400                     PERFORM 2050-DELETE-LIST-QUEUE               09440000
094500                     PERFORM 3200-RESET-ATTRIBUTES                09450000
094600                     PERFORM 4000-BUILD-INITIAL-PANEL             09460000
094700                 END-IF                                           09470000
094800              ELSE                                                09480000
094900                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             09490000
095000*                --- BOTTOM OF LIST ---                           09500000
095100                 MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER         09510000
095200                 SET DP020-MSG-INFORMATIONAL TO TRUE              09520000
095300             END-IF                                               09530000
095400                                                                  09540000
095500         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             09550000
095600             IF  ASC-USE-SELECTION-QUEUE                          09560000
095700                 PERFORM 1140-GET-PREV-RECORD                     09570000
095800                 IF PS-LIST-END                                   09580000
095900                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         09590000
096000                     SET PS-NO-LIST-END TO TRUE                   09600000
096100                 ELSE                                             09610000
096200                     PERFORM 2050-DELETE-LIST-QUEUE               09620000
096300                     PERFORM 3200-RESET-ATTRIBUTES                09630000
096400                     PERFORM 4000-BUILD-INITIAL-PANEL             09640000
096500                 END-IF                                           09650000
096600             ELSE                                                 09660000
096700                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             09670000
096800                 MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER         09680000
096900                 SET DP020-MSG-INFORMATIONAL TO TRUE              09690000
097000             END-IF                                               09700000
097100                                                                  09710000
097200         WHEN OTHER                                               09720000
097300             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 09730000
097400             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   09740000
097500                                                                  09750000
097600             IF  PS-NO-ERROR                                      09760000
097700                 SET DP030-CONTINUE-GO TO TRUE                    09770000
097800                 PERFORM 2100-CHECK-FUNCTION-KEY                  09780000
097900             ELSE                                                 09790000
098000                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             09800000
098100                 SET DP030-OVERRIDE-GO TO TRUE                    09810000
098200             END-IF                                               09820000
098300     END-EVALUATE.                                                09830000
098400                                                                  09840000
098500*----------------------------------------------------------------*09850000
098600*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *09860000
098700*----------------------------------------------------------------*09870000
098800 2050-DELETE-LIST-QUEUE.                                          09880000
098900                                                                  09890000
099000     EXEC CICS                                                    09900000
099100         DELETEQ TS                                               09910000
099200             QUEUE (ASC-LIST-QUEUE-NAME)                          09920000
099300             RESP  (PV-CICS-RESP)                                 09930000
099400     END-EXEC.                                                    09940000
099500                                                                  09950000
099600     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       09960000
099700        (PV-CICS-RESP = DFHRESP(QIDERR))                          09970000
099800         CONTINUE                                                 09980000
099900     ELSE                                                         09990000
100000         SET DP013-CICS-ABEND      TO TRUE                        10000000
100100         SET DP013-NO-ROLLBACK     TO TRUE                        10010000
100200                                                                  10020000
100300         MOVE '2050-DELETE-LIST-QUEUE' TO DP013-PARAGRAPH         10030000
100400         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    10040000
100500                                   TO DP013-MESSAGE-TEXT (1)      10050000
100600         PERFORM DP013-0000-PROCESS-ABEND                         10060000
100700     END-IF.                                                      10070000
100800                                                                  10080000
100900     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  10090000
101000                                                                  10100000
101100*----------------------------------------------------------------*10110000
101200* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*10120000
101300* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *10130000
101400* CICS ARCHITECTURE API.                                         *10140000
101500*----------------------------------------------------------------*10150000
101600 2100-CHECK-FUNCTION-KEY.                                         10160000
101700                                                                  10170000
101800     MOVE ASC-TRLR-STATUS             TO DK-TRLR-STATUS           10180013
101801                                                                  10180113
101802     EVALUATE TRUE                                                10180200
101900*                                                                 10190000
102000* F13 - CHANGE SEQUENCE                                           10200000
102100         WHEN DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)              10210000
102200             IF ASC-DOOR-SEQ                                      10220013
102300                 SET ASC-STORE-SEQ    TO TRUE                     10230013
102400             ELSE                                                 10240013
102500                 SET ASC-DOOR-SEQ     TO TRUE                     10250013
102600             END-IF                                               10260013
102601                                                                  10260113
102602             PERFORM 2050-DELETE-LIST-QUEUE                       10260200
102603             PERFORM 4100-PREPARE-CURSOR                          10260313
102604             PERFORM 4000-BUILD-INITIAL-PANEL                     10260400
102605*                                                                 10260500
102606* F16 - TRAILER SHIP / RELEASE                                    10260600
102607         WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)              10260700
102608             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              10260800
102609                 SET ASC-USE-SELECTION-QUEUE TO TRUE              10260900
102610                 INITIALIZE SU009-INTER-APPL-COMMAREA             10261000
102611                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                10261100
102612                                TO SU009-NUMBER-OF-SELECTED-ITEMS 10261200
102700                 MOVE ASC-NUMBER-OF-TS-ITEMS                      10270000
102800                                      TO SU009-NUMBER-OF-TS-ITEMS 10280000
102900                 MOVE ASC-SEL-QUEUE-NAME   TO SU009-SEL-QUEUE-NAME10290000
103000                 MOVE ASC-OPER-UNT-ID-N    TO SU009-OPER-UNT-ID   10300000
103100                 PERFORM 5000-PREPARE-SEL-QUEUE                   10310000
103200             ELSE                                                 10320000
103300                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             10330000
103400                 SET DP030-OVERRIDE-GO TO TRUE                    10340000
103500                 MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER         10350000
103600                 SET DP020-MSG-WARNING TO TRUE                    10360000
103700             END-IF                                               10370000
103800*                                                                 10380000
103900* F17 - TRAILER HISTORY                                           10390000
104000         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              10400000
104100             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              10410000
104200                 SET ASC-USE-SELECTION-QUEUE TO TRUE              10420000
104300                 INITIALIZE SU009-INTER-APPL-COMMAREA             10430000
104400                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                10440000
104500                                TO SU009-NUMBER-OF-SELECTED-ITEMS 10450000
104600                 MOVE ASC-NUMBER-OF-TS-ITEMS                      10460000
104700                                      TO SU009-NUMBER-OF-TS-ITEMS 10470000
104800                 MOVE ASC-SEL-QUEUE-NAME   TO SU009-SEL-QUEUE-NAME10480000
104900                 MOVE ASC-OPER-UNT-ID-N    TO SU009-OPER-UNT-ID   10490000
105000                 PERFORM 5000-PREPARE-SEL-QUEUE                   10500000
105100             ELSE                                                 10510000
105200                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             10520000
105300                 SET DP030-OVERRIDE-GO TO TRUE                    10530000
105400                 MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER         10540000
105500                 SET DP020-MSG-WARNING TO TRUE                    10550000
105600             END-IF                                               10560000
105700*                                                                 10570000
105800* F18 - TRAILER CARTONS                                           10580000
105900         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              10590000
106000             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              10600000
106100                 SET ASC-USE-SELECTION-QUEUE TO TRUE              10610000
106200                 INITIALIZE SU009-INTER-APPL-COMMAREA             10620000
106300                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                10630000
106400                                TO SU009-NUMBER-OF-SELECTED-ITEMS 10640000
106500                 MOVE ASC-NUMBER-OF-TS-ITEMS                      10650000
106600                                      TO SU009-NUMBER-OF-TS-ITEMS 10660000
106700                 MOVE ASC-SEL-QUEUE-NAME   TO SU009-SEL-QUEUE-NAME10670000
106800                 MOVE ASC-OPER-UNT-ID-N    TO SU009-OPER-UNT-ID   10680000
106900                 PERFORM 5000-PREPARE-SEL-QUEUE                   10690000
107000             ELSE                                                 10700000
107100                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             10710000
107200                 SET DP030-OVERRIDE-GO TO TRUE                    10720000
107300                 MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER         10730000
107400                 SET DP020-MSG-WARNING TO TRUE                    10740000
107500             END-IF                                               10750000
107600*                                                                 10760000
107700* F22 - ASSOCIATE LIST                                            10770000
107800         WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)              10780000
107900             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              10790000
108000                 SET ASC-USE-SELECTION-QUEUE TO TRUE              10800000
108100                 INITIALIZE SU009-INTER-APPL-COMMAREA             10810000
108200                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                10820000
108300                                TO SU009-NUMBER-OF-SELECTED-ITEMS 10830000
108400                 MOVE ASC-NUMBER-OF-TS-ITEMS                      10840000
108500                                      TO SU009-NUMBER-OF-TS-ITEMS 10850000
108600                 MOVE ASC-SEL-QUEUE-NAME   TO SU009-SEL-QUEUE-NAME10860000
108700                 MOVE ASC-OPER-UNT-ID-N    TO SU009-OPER-UNT-ID   10870000
108800                 PERFORM 5000-PREPARE-SEL-QUEUE                   10880000
108900             ELSE                                                 10890000
109000                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             10900000
109100                 SET DP030-OVERRIDE-GO TO TRUE                    10910000
109200                 MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER         10920000
109300                 SET DP020-MSG-WARNING TO TRUE                    10930000
109400             END-IF                                               10940000
109500*                                                                 10950000
109600* F23 - TRAILER SEAL LIST                                         10960000
109700         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              10970000
109800             MOVE 'SUTRLRSL' TO DP008-FUNCTION-NAME               10980000
109900             PERFORM 2105-RACF-ACCESS                             10990000
110000             IF  PS-ACCESS-NOT-ALLOWED                            11000000
110100                 SET  PS-ERROR                                    11010000
110200                      DP020-MSG-FATAL TO TRUE                     11020000
110300                 MOVE PC-TSYMSG-00840 TO DP020-MSG-NUMBER         11030000
110400                 MOVE -1              TO MR-SELECTL (1)           11040000
110500                 SET  DP030-SET-CURSOR-APPL-1 TO TRUE             11050000
110600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11060000
110610                 SET DP030-OVERRIDE-GO TO TRUE                    11061000
110700             END-IF                                               11070000
110800                                                                  11080000
110900             IF  PS-NO-ERROR                                      11090000
111000                 IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO          11100000
111100                     SET ASC-USE-SELECTION-QUEUE TO TRUE          11110000
111200                     INITIALIZE SU009-INTER-APPL-COMMAREA         11120000
111300                     MOVE ASC-NUMBER-OF-SELECTED-ITEMS            11130000
111400                                TO SU009-NUMBER-OF-SELECTED-ITEMS 11140000
111500                     MOVE ASC-NUMBER-OF-TS-ITEMS                  11150000
111600                                      TO SU009-NUMBER-OF-TS-ITEMS 11160000
111700                     MOVE ASC-SEL-QUEUE-NAME   TO                 11170000
111800                                              SU009-SEL-QUEUE-NAME11180000
111900                     MOVE ASC-OPER-UNT-ID-N  TO SU009-OPER-UNT-ID 11190000
112000                     PERFORM 5000-PREPARE-SEL-QUEUE               11200000
112100                 ELSE                                             11210000
112200                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         11220000
112300                     SET DP030-OVERRIDE-GO TO TRUE                11230000
112400                     MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER     11240000
112500                     SET DP020-MSG-WARNING TO TRUE                11250000
112600                 END-IF                                           11260000
112700             END-IF                                               11270000
112800*                                                                 11280000
112900* F24 - DOOR CARTON LIST                                          11290000
113000         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              11300000
113100             IF  PS-NO-ERROR                                      11310000
113200                 IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO          11320000
113300                     SET ASC-USE-SELECTION-QUEUE TO TRUE          11330000
113400                     INITIALIZE SU009-INTER-APPL-COMMAREA         11340000
113500                     MOVE ASC-NUMBER-OF-SELECTED-ITEMS            11350000
113600                                TO SU009-NUMBER-OF-SELECTED-ITEMS 11360000
113700                     MOVE ASC-NUMBER-OF-TS-ITEMS                  11370000
113800                                      TO SU009-NUMBER-OF-TS-ITEMS 11380000
113900                     MOVE ASC-SEL-QUEUE-NAME   TO                 11390000
114000                                              SU009-SEL-QUEUE-NAME11400000
114100                     MOVE ASC-OPER-UNT-ID-N  TO SU009-OPER-UNT-ID 11410000
114200                     PERFORM 5000-PREPARE-SEL-QUEUE               11420000
114300                 ELSE                                             11430000
114400                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         11440000
114500                     SET DP030-OVERRIDE-GO TO TRUE                11450000
114600                     MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER     11460000
114700                     SET DP020-MSG-WARNING TO TRUE                11470000
114800                 END-IF                                           11480000
114900             END-IF                                               11490000
115000*                                                                 11500000
115100* F6 - FIRST PAGE                                                 11510000
115200         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  11520000
115300             MOVE +1               TO PV-TOP-ITEM                 11530000
115400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11540000
115500*                                                                 11550000
115600* F7 - PREVIOUS PAGE                                              11560000
115700         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   11570000
115800             PERFORM 2110-BROWSE-BACKWARD                         11580000
115900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11590000
116000*                                                                 11600000
116100* F8 - NEXT PAGE                                                  11610000
116200         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   11620000
116300             PERFORM 2120-BROWSE-FORWARD                          11630000
116400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11640000
116500*                                                                 11650000
116600* ENTER KEY                                                       11660000
116700         WHEN DP020-SRC-AID = DP016-ENTER                         11670000
116800             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   11680000
116900             IF  PS-ERROR                                         11690000
117000                 CONTINUE                                         11700000
117100             ELSE                                                 11710000
117200                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11720000
117300             END-IF                                               11730000
117400                                                                  11740000
117500         WHEN OTHER                                               11750000
117600             SET DP013-NO-ROLLBACK                                11760000
117700                 DP013-XCTL-DISPLAY-RESTART                       11770000
117800                 DP013-CICS-ABEND  TO TRUE                        11780000
117900             MOVE '2100-CHECK-FUNCTION-KEY'                       11790000
118000                                   TO DP013-PARAGRAPH             11800000
118100             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      11810000
118200                                   TO DP013-MESSAGE-TEXT (1)      11820000
118300             PERFORM DP013-0000-PROCESS-ABEND                     11830000
118400     END-EVALUATE.                                                11840000
118500*                                                                 11850000
118600*----------------------------------------------------------------*11860000
118700* CHECK TO SEE IF USER HAS RACF AUTHORIZATION                     11870000
118800*----------------------------------------------------------------*11880000
118900 2105-RACF-ACCESS.                                                11890000
119000                                                                  11900000
119100      SET DP008-RSRC-TYPE-FUNC           TO TRUE                  11910000
119200      SET DP008-ACCESS-TYPE-USE          TO TRUE                  11920000
119300                                                                  11930000
119400      EXEC CICS                                                   11940000
119500         LINK PROGRAM (DP008-SECURITY-SUBROUTINE)                 11950000
119600              COMMAREA (DP008-SECURITY-COMMAREA)                  11960000
119700              LENGTH (DP008-SECURITY-COMMAREA-LENGTH)             11970000
119800      END-EXEC                                                    11980000
119900                                                                  11990000
120000      IF DP008-CALL-SUCCESSFUL                                    12000000
120100         IF DP008-ACCESS-ALLOWED                                  12010000
120200             SET PS-ACCESS-ALLOWED TO TRUE                        12020000
120300         ELSE                                                     12030000
120400             SET PS-ACCESS-NOT-ALLOWED TO TRUE                    12040000
120500             MOVE DP008-ERROR-CODE TO PV-RACF-ERROR-CODE          12050000
120600             STRING ' SUKCS562- RACF -'  DELIMITED BY SIZE        12060000
120700                    ' DP008-ACCESS-SW- ' DELIMITED BY SIZE        12070000
120800                      DP008-ACCESS-SW    DELIMITED BY SIZE        12080000
120900                    ' RACF ERROR CODE-'  DELIMITED BY SIZE        12090000
121000                      PV-RACF-ERROR-CODE DELIMITED BY SIZE        12100000
121100                                    INTO PV-CICS-MSG-AREA2        12110000
121200             MOVE LENGTH OF PV-CICS-MSG-AREA2                     12120000
121300               TO PV-COMMAREA-LENGTH                              12130000
121400             EXEC CICS                                            12140000
121500                  WRITEQ TD                                       12150000
121600                   QUEUE  ('CSSL')                                12160000
121700                    FROM  (PV-CICS-MSG-AREA2)                     12170000
121800                  LENGTH  (PV-COMMAREA-LENGTH)                    12180000
121900                    RESP  (PV-CICS-RESP)                          12190000
122000             END-EXEC                                             12200000
122100         END-IF                                                   12210000
122200     ELSE                                                         12220000
122300         MOVE ' 2105-RACF-ACCESS'  TO DP013-PARAGRAPH             12230000
122400          MOVE 'UNABLE TO ACCESS CICS'                            12240000
122500                               TO DP013-MESSAGE-TEXT (1)          12250000
122600          MOVE SQLCA                 TO DP013-SQLCA               12260000
122700          SET DP013-DB2-ABEND                                     12270000
122800              DP013-XCTL-DISPLAY-RESTART TO TRUE                  12280000
122900          PERFORM DP013-0000-PROCESS-ABEND                        12290000
123000      END-IF.                                                     12300000
123100                                                                  12310000
123200*----------------------------------------------------------------*12320000
123300*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *12330000
123400*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *12340000
123500*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *12350000
123600*    MESSAGE.                                                    *12360000
123700*----------------------------------------------------------------*12370000
123800 2110-BROWSE-BACKWARD.                                            12380000
123900     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    12390000
124000         GIVING PV-TOP-ITEM.                                      12400000
124100*                                                                 12410000
124200     IF  ((PV-TOP-ITEM < +1)                                      12420000
124300       OR (PV-TOP-ITEM = +1))                                     12430000
124400         MOVE +1                   TO PV-TOP-ITEM                 12440000
124500*        -- TOP OF LIST --                                        12450000
124600         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            12460000
124700         SET DP020-MSG-INFORMATIONAL TO TRUE                      12470000
124800     END-IF.                                                      12480000
124900                                                                  12490000
125000*----------------------------------------------------------------*12500000
125100*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *12510000
125200*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *12520000
125300*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *12530000
125400*----------------------------------------------------------------*12540000
125500 2120-BROWSE-FORWARD.                                             12550000
125600                                                                  12560000
125700     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              12570000
125800         GIVING PV-TOP-ITEM.                                      12580000
125900     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   12590000
126000         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             12600000
126100*        -- BOTTOM OF LIST --                                     12610000
126200         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            12620000
126300         SET DP020-MSG-INFORMATIONAL  TO TRUE                     12630000
126400     ELSE                                                         12640000
126500         COMPUTE PV-BOTTOM-ITEM =                                 12650000
126600             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 12660000
126700         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            12670000
126800*            -- BOTTOM OF LIST --                                 12680000
126900             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            12690000
127000             SET DP020-MSG-INFORMATIONAL TO TRUE                  12700000
127100         END-IF                                                   12710000
127200     END-IF.                                                      12720000
127300                                                                  12730000
127400*----------------------------------------------------------------*12740000
127500*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *12750000
127600*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *12760000
127700*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *12770000
127800*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *12780000
127900*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *12790000
128000*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *12800000
128100*----------------------------------------------------------------*12810000
128200 2130-CHECK-FOR-JUMP-BROWSE.                                      12820000
128300     SET PS-NO-ERROR               TO TRUE.                       12830000
128400     IF (ASC-START-ITEM-REQUEST = SPACE)                          12840000
128500         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             12850000
128600     ELSE                                                         12860000
128700         MOVE ASC-START-ITEM-REQUEST TO DP010I-UNEDITED-FIELD     12870000
128800         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       12880000
128900         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     12890000
129000         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  12900000
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         12911015
263968              USING DP010I-NUMERIC-EDIT-AREA                      12912015
129200                                                                  12920000
129300         IF  NOT DP010I-ERROR-DETECTED                            12930000
129400             MOVE DP010I-NUMERIC-FIELD TO ASC-START-ITEM-REQUEST-N12940000
129500             IF  ASC-START-ITEM-REQUEST-N > ZERO                  12950000
129600                 IF  ASC-START-ITEM-REQUEST-N >                   12960000
129700                                          ASC-NUMBER-OF-ITEMS-READ12970000
129800                     MOVE SPACE TO ASC-START-ITEM-REQUEST         12980000
129900                     COMPUTE PV-TOP-ITEM =                        12990000
130000                             ASC-NUMBER-OF-ITEMS-READ             13000000
130100                             - PC-ITEMS-PER-PANEL + 1             13010000
130200                     IF  PV-TOP-ITEM < +1                         13020000
130300                         MOVE +1   TO PV-TOP-ITEM                 13030000
130400                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 13040000
130500                         SET DP020-MSG-INFORMATIONAL TO TRUE      13050000
130600                     END-IF                                       13060000
130700                 ELSE                                             13070000
130800                     MOVE ASC-START-ITEM-REQUEST-N TO PV-TOP-ITEM 13080000
130900                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      13090000
131000                     COMPUTE PV-BOTTOM-ITEM =                     13100000
131100                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     13110000
131200                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ13120000
131300*                        -- BOTTOM OF LIST --                     13130000
131400                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 13140000
131500                         SET DP020-MSG-INFORMATIONAL TO TRUE      13150000
131600                     END-IF                                       13160000
131700                 END-IF                                           13170000
131800             ELSE                                                 13180000
131900*                --- VALUE OUT OF RANGE ----                      13190000
132000                 MOVE PC-TSYMSG-00101  TO DP020-MSG-NUMBER        13200000
132100                 MOVE -1           TO ASTRTITL                    13210000
132200                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              13220000
132300                 MOVE DP015-REVERSE TO ASTRTITH                   13230000
132400                 MOVE DP015-RED    TO ASTRTITC                    13240000
132500                 MOVE DP015-UNP-NUM-BRT-MDT TO ASTRTITA           13250000
132600                 SET DP020-MSG-FATAL                              13260000
132700                     PS-ERROR        TO TRUE                      13270000
132800             END-IF                                               13280000
132900                                                                  13290000
133000         ELSE                                                     13300000
133100             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            13310000
133200             MOVE -1               TO ASTRTITL                    13320000
133300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  13330000
133400             MOVE DP015-REVERSE    TO ASTRTITH                    13340000
133500             MOVE DP015-RED        TO ASTRTITC                    13350000
133600             MOVE DP015-UNP-NUM-BRT-MDT TO ASTRTITA               13360000
133700             SET DP020-MSG-FATAL   TO TRUE                        13370000
133800             SET PS-ERROR          TO TRUE                        13380000
133900         END-IF                                                   13390000
134000     END-IF.                                                      13400000
134100                                                                  13410000
134200*----------------------------------------------------------------*13420000
134300*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *13430000
134400*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *13440000
134500*----------------------------------------------------------------*13450000
134600 2140-DESELECT-ALL-ITEMS.                                         13460000
134700     MOVE +1                       TO ASC-BLK-SUB.                13470000
134800                                                                  13480000
134900     PERFORM 2141-CLEAR-SELECTED-INDS                             13490000
135000         VARYING ASC-ITEM-SUB                                     13500000
135100         FROM 1 BY 1                                              13510000
135200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 13520000
135300                                                                  13530000
135400     ADD +1                        TO ASC-BLK-SUB.                13540000
135500                                                                  13550000
135600     PERFORM 2141-CLEAR-SELECTED-INDS                             13560000
135700         VARYING ASC-ITEM-SUB                                     13570000
135800         FROM 1 BY 1                                              13580000
135900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 13590000
136000                                                                  13600000
136100     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               13610000
136200                                   TO PV-LIST-ITEM-NUMBER.        13620000
136300                                                                  13630000
136400     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            13640000
136500         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    13650000
136600                                                                  13660000
136700     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     13670000
136800        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      13680000
136900         MOVE +1                   TO ASC-BLK-SUB                 13690000
137000                                                                  13700000
137100         PERFORM 5100-WRITE-TEMP-STORAGE                          13710000
137200         MOVE +2                   TO ASC-BLK-SUB                 13720000
137300         PERFORM 5100-WRITE-TEMP-STORAGE                          13730000
137400         MOVE +1                   TO ASC-BLK-SUB                 13740000
137500                                                                  13750000
137600         MOVE +1                   TO PV-BLOCK-NUMBER             13760000
137700                                                                  13770000
137800         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         13780000
137900             PV-FIRST-BLOCK-IN-ARRAY - 1                          13790000
138000                                                                  13800000
138100         PERFORM                                                  13810000
138200             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       13820000
138300                                                                  13830000
138400             PERFORM 4410-READ-TEMP-STORAGE                       13840000
138500                                                                  13850000
138600             PERFORM 2141-CLEAR-SELECTED-INDS                     13860000
138700                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 13870000
138800                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          13880000
138900                                                                  13890000
139000             PERFORM 5100-WRITE-TEMP-STORAGE                      13900000
139100                                                                  13910000
139200             ADD +1                TO PV-BLOCK-NUMBER             13920000
139300                                                                  13930000
139400         END-PERFORM                                              13940000
139500                                                                  13950000
139600         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         13960000
139700             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     13970000
139800                                                                  13980000
139900         PERFORM                                                  13990000
140000             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       14000000
140100                   ASC-HIGHEST-BLOCK-WRITTEN                      14010000
140200                                                                  14020000
140300             MOVE PV-NEXT-BLOCK-IN-ARRAY                          14030000
140400                                   TO PV-BLOCK-NUMBER             14040000
140500                                                                  14050000
140600             PERFORM 4410-READ-TEMP-STORAGE                       14060000
140700                                                                  14070000
140800             PERFORM 2141-CLEAR-SELECTED-INDS                     14080000
140900                 VARYING ASC-ITEM-SUB                             14090000
141000                 FROM 1 BY 1                                      14100000
141100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          14110000
141200                                                                  14120000
141300             PERFORM 5100-WRITE-TEMP-STORAGE                      14130000
141400                                                                  14140000
141500             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      14150000
141600                                                                  14160000
141700         END-PERFORM                                              14170000
141800                                                                  14180000
141900         MOVE PV-FIRST-BLOCK-IN-ARRAY                             14190000
142000                                   TO PV-BLOCK-NUMBER             14200000
142100                                                                  14210000
142200         PERFORM 4410-READ-TEMP-STORAGE                           14220000
142300     END-IF.                                                      14230000
142400                                                                  14240000
142500                                                                  14250000
142600     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 14260000
142700     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.14270000
142800     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  14280000
142900                                                                  14290000
143000     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        14300000
143100                                                                  14310000
143200*----------------------------------------------------------------*14320000
143300*    MARK EACH ITEM AS BEING NOT SELECTED.                       *14330000
143400*----------------------------------------------------------------*14340000
143500 2141-CLEAR-SELECTED-INDS.                                        14350000
143600                                                                  14360000
143700     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           14370000
143800             NOT EQUAL ZERO                                       14380000
143900         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          14390000
144000             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          14400000
144100                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    14410000
144200                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  14420000
144300                                   TO TRUE                        14430000
144400         END-IF                                                   14440000
144500     END-IF.                                                      14450000
144600                                                                  14460000
144700*----------------------------------------------------------------*14470000
144800*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *14480000
144900*  FOR ALL ITEMS.                                                *14490000
145000*----------------------------------------------------------------*14500000
145100 2150-SELECT-ALL-ITEMS.                                           14510000
145200                                                                  14520000
145300     MOVE +1                       TO ASC-BLK-SUB.                14530000
145400                                                                  14540000
145500     PERFORM 2151-SET-SELECTED-INDS                               14550000
145600         VARYING ASC-ITEM-SUB                                     14560000
145700         FROM 1 BY 1                                              14570000
145800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 14580000
145900                                                                  14590000
146000     ADD +1                        TO ASC-BLK-SUB.                14600000
146100                                                                  14610000
146200     PERFORM 2151-SET-SELECTED-INDS                               14620000
146300         VARYING ASC-ITEM-SUB                                     14630000
146400         FROM 1 BY 1                                              14640000
146500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 14650000
146600                                                                  14660000
146700     MOVE ASC-LIST-ITEM-NUMBER(1 1) TO PV-LIST-ITEM-NUMBER.       14670000
146800                                                                  14680000
146900     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            14690000
147000         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    14700000
147100                                                                  14710000
147200     IF  PV-FIRST-BLOCK-IN-ARRAY  = +1                            14720000
147300         MOVE +1                   TO ASC-BLK-SUB                 14730000
147400                                                                  14740000
147500         PERFORM 5100-WRITE-TEMP-STORAGE                          14750000
147600         MOVE +2                   TO ASC-BLK-SUB                 14760000
147700         PERFORM 5100-WRITE-TEMP-STORAGE                          14770000
147800         MOVE +1                   TO ASC-BLK-SUB                 14780000
147900         MOVE +1                   TO PV-BLOCK-NUMBER             14790000
148000     END-IF.                                                      14800000
148100                                                                  14810000
148200     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     14820000
148300        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    14830000
148400         MOVE +1                   TO ASC-BLK-SUB                 14840000
148500                                                                  14850000
148600         PERFORM 5100-WRITE-TEMP-STORAGE                          14860000
148700         MOVE +2                   TO ASC-BLK-SUB                 14870000
148800         PERFORM 5100-WRITE-TEMP-STORAGE                          14880000
148900         MOVE +1                   TO ASC-BLK-SUB                 14890000
149000         MOVE +1                   TO PV-BLOCK-NUMBER             14900000
149100                                                                  14910000
149200         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         14920000
149300             PV-FIRST-BLOCK-IN-ARRAY - 1                          14930000
149400                                                                  14940000
149500         PERFORM                                                  14950000
149600             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       14960000
149700                                                                  14970000
149800             PERFORM 4410-READ-TEMP-STORAGE                       14980000
149900                                                                  14990000
150000             PERFORM 2151-SET-SELECTED-INDS                       15000000
150100                 VARYING ASC-ITEM-SUB                             15010000
150200                 FROM 1 BY 1                                      15020000
150300                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          15030000
150400                                                                  15040000
150500             PERFORM 5100-WRITE-TEMP-STORAGE                      15050000
150600                                                                  15060000
150700             ADD +1                TO PV-BLOCK-NUMBER             15070000
150800                                                                  15080000
150900         END-PERFORM                                              15090000
151000                                                                  15100000
151100         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         15110000
151200             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     15120000
151300                                                                  15130000
151400         PERFORM                                                  15140000
151500             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       15150000
151600                   ASC-HIGHEST-BLOCK-WRITTEN                      15160000
151700                                                                  15170000
151800             MOVE PV-NEXT-BLOCK-IN-ARRAY                          15180000
151900                                   TO PV-BLOCK-NUMBER             15190000
152000                                                                  15200000
152100             PERFORM 4410-READ-TEMP-STORAGE                       15210000
152200                                                                  15220000
152300             PERFORM 2151-SET-SELECTED-INDS                       15230000
152400                 VARYING ASC-ITEM-SUB                             15240000
152500                 FROM 1 BY 1                                      15250000
152600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          15260000
152700                                                                  15270000
152800             PERFORM 5100-WRITE-TEMP-STORAGE                      15280000
152900                                                                  15290000
153000             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      15300000
153100                                                                  15310000
153200         END-PERFORM                                              15320000
153300                                                                  15330000
153400         MOVE PV-FIRST-BLOCK-IN-ARRAY                             15340000
153500                                   TO PV-BLOCK-NUMBER             15350000
153600                                                                  15360000
153700         PERFORM 4410-READ-TEMP-STORAGE                           15370000
153800     END-IF.                                                      15380000
153900                                                                  15390000
154000                                                                  15400000
154100     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             15410000
154200                       ASC-NUMBER-OF-SELECTED-ITEMS.              15420000
154300                                                                  15430000
154400     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        15440000
154500                                                                  15450000
154600*----------------------------------------------------------------*15460000
154700*    MARK EACH ITEM AS BEING SELECTED.                           *15470000
154800*----------------------------------------------------------------*15480000
154900 2151-SET-SELECTED-INDS.                                          15490000
155000                                                                  15500000
155100     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           15510000
155200             NOT EQUAL ZERO                                       15520000
155300         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             15530000
155400             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             15540000
155500                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        15550000
155600                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  15560000
155700                               TO  TRUE                           15570000
155800         END-IF                                                   15580000
155900     END-IF.                                                      15590000
156000                                                                  15600000
156100******************************************************************15610000
156200** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **15620000
156300** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **15630000
156400******************************************************************15640000
156500 2200-MOVE-SCREEN-TO-COMMAREA.                                    15650000
156600                                                                  15660000
156700     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             15670000
156800     MOVE +1                       TO PV-SUB.                     15680000
156900*                                                                 15690000
157000     PERFORM 3100-SET-SUBSCRIPTS.                                 15700000
157100     IF  ASTRTITL > ZERO                                          15710000
157200         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          15720000
157300     ELSE                                                         15730000
157400         IF  ASTRTITF = DP015-ERASE-EOF                           15740000
157500             INITIALIZE ASC-START-ITEM-REQUEST                    15750000
157600         END-IF                                                   15760000
157700     END-IF.                                                      15770000
157800                                                                  15780000
157900     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          15790000
158000         VARYING PV-SUB                                           15800000
158100         FROM 1 BY 1                                              15810000
158200         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      15820000
158300******************************************************************15830000
158400** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**15840000
158500******************************************************************15850000
158600 2210-MOVE-LINES-TO-COMMAREA.                                     15860000
158700     IF  MR-SELECTL (PV-SUB) > ZERO                               15870000
158800         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             15880000
158900         MOVE MR-SELECTI (PV-SUB)                                 15890000
159000                                   TO ASC-TEMP-SELECTED-SW        15900000
159100                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      15910000
159200     ELSE                                                         15920000
159300         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                15930000
159400                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     15940000
159500                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        15950000
159600                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      15960000
159700         END-IF                                                   15970000
159800     END-IF.                                                      15980000
159900     ADD +1                        TO ASC-ITEM-SUB.               15990000
160000                                                                  16000000
160100     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        16010000
160200         ADD +1                    TO ASC-BLK-SUB                 16020000
160300         MOVE +1                   TO ASC-ITEM-SUB                16030000
160400     END-IF.                                                      16040000
160500******************************************************************16050000
160600** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **16060000
160700** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **16070000
160800******************************************************************16080000
160900 3000-EDIT-DATA-IN-COMMAREA.                                      16090000
161000     SET PS-NO-ERROR               TO TRUE.                       16100000
161100     PERFORM 3200-RESET-ATTRIBUTES.                               16110000
161200     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     16120000
161300                                                                  16130000
161400**                                                                16140000
161500* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              16150000
161600* EDITTING IS DONE FROM THE BOTTOM UP.                            16160000
161700**                                                                16170000
161800     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       16180000
161900         ASC-ITEMS-DISPLAYED - 1.                                 16190000
162000     PERFORM 3100-SET-SUBSCRIPTS.                                 16200000
162100*                                                                 16210000
162200     IF  PS-NO-ERROR                                              16220000
162300         PERFORM 3005-EDIT-COMMAREA-BLOCKS                        16230000
162400     END-IF.                                                      16240000
162500                                                                  16250000
162600     IF  PS-NO-ERROR                                              16260000
162700         PERFORM 3400-CHECK-RANGE-SEQUENCE                        16270000
162800     END-IF.                                                      16280000
162900*                                                                 16290000
163000     IF  ((PS-NO-ERROR)                                           16300000
163100       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   16310000
163200       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    16320000
163300             PERFORM 3500-MARK-RANGE-AS-SELECTED                  16330000
163400     END-IF.                                                      16340000
163500                                                                  16350000
163600*----------------------------------------------------------------*16360000
163700*   3005-EDIT-COMMAREA-BLOCKS                                    *16370000
163800*----------------------------------------------------------------*16380000
163900 3005-EDIT-COMMAREA-BLOCKS.                                       16390000
164000     MOVE +1                       TO PV-BLOCK-NUMBER.            16400000
164100     MOVE +1                       TO ASC-BLK-SUB.                16410000
164200     MOVE PC-ITEMS-PER-PANEL       TO ASC-ITEM-SUB.               16420000
164300                                                                  16430000
164400     COMPUTE PV-BLOCK-NUMBER  =                                   16440000
164500        1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /                 16450000
164600            PC-ITEMS-PER-PANEL.                                   16460000
164700                                                                  16470000
164800     MOVE  PV-BLOCK-NUMBER         TO PV-ORIGINAL-BLOCK.          16480000
164900                                                                  16490000
165000     PERFORM                                                      16500000
165100       UNTIL PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN          16510000
165200          OR PS-ERROR                                             16520000
165300          OR PS-BLOCK-ERROR                                       16530000
165400                                                                  16540000
165500             COMPUTE PV-ITEMS-HOLD  =                             16550000
165600                     ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +        16560000
165700                     PC-ITEMS-PER-PANEL - 1                       16570000
165800                                                                  16580000
165900             IF  PV-ITEMS-HOLD  >  ASC-NUMBER-OF-ITEMS-READ       16590000
166000                 SUBTRACT  ASC-NUMBER-OF-ITEMS-READ               16600000
166100                     FROM  PV-ITEMS-HOLD                          16610000
166200                   GIVING  PV-ITEMS-DIFF                          16620000
166300                 SUBTRACT  PV-ITEMS-DIFF                          16630000
166400                     FROM  PC-ITEMS-PER-PANEL                     16640000
166500                   GIVING  PV-ITEMS-HOLD                          16650000
166600                     MOVE  PV-ITEMS-HOLD  TO  PV-SUB              16660000
166700                                              ASC-ITEM-SUB        16670000
166800                                              ASC-ITEMS-DISPLAYED 16680000
166900             ELSE                                                 16690000
167000                 MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB              16700000
167100                 MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB        16710000
167200             END-IF                                               16720000
167300                                                                  16730000
167400             PERFORM 3300-EDIT-SELECTIONS                         16740000
167500                     VARYING PV-SUB                               16750000
167600                        FROM PV-SUB BY -1                         16760000
167700                       UNTIL PV-SUB < +1                          16770000
167800                                                                  16780000
167900             MOVE +1               TO ASC-BLK-SUB                 16790000
168000                                                                  16800000
168100             PERFORM 5105-REWRITE-ASC-LISTQ                       16810000
168200                                                                  16820000
168300             MOVE +1                TO ASC-BLK-SUB                16830000
168400                                                                  16840000
168500             IF  PS-BLOCK-ERROR                                   16850000
168600                 SET  PS-ERROR     TO TRUE                        16860000
168700                 MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)        16870000
168800                                   TO PV-TOP-ITEM                 16880000
168900             ELSE                                                 16890000
169000                 ADD  +1           TO PV-BLOCK-NUMBER             16900000
169100                 IF  PV-BLOCK-NUMBER >                            16910000
169200                     ASC-HIGHEST-BLOCK-WRITTEN                    16920000
169300                     MOVE +2       TO ASC-BLK-SUB                 16930000
169400                     PERFORM 4410-READ-TEMP-STORAGE               16940000
169500                     MOVE +1       TO ASC-BLK-SUB                 16950000
169600                 ELSE                                             16960000
169700                     PERFORM 4410-READ-TEMP-STORAGE               16970000
169800                     ADD  +1        TO PV-BLOCK-NUMBER            16980000
169900                     MOVE +2        TO ASC-BLK-SUB                16990000
170000                     PERFORM 4410-READ-TEMP-STORAGE               17000000
170100                     SUBTRACT +1  FROM PV-BLOCK-NUMBER            17010000
170200                     MOVE +1        TO ASC-BLK-SUB                17020000
170300                 END-IF                                           17030000
170400             END-IF                                               17040000
170500     END-PERFORM.                                                 17050000
170600                                                                  17060000
170700     IF  PV-ORIGINAL-BLOCK  = +1    OR                            17070000
170800         PS-ERROR                   OR                            17080000
170900         PS-BLOCK-ERROR                                           17090000
171000         CONTINUE                                                 17100000
171100     ELSE                                                         17110000
171200         MOVE +1                 TO PV-BLOCK-NUMBER               17120000
171300         MOVE +1                 TO ASC-BLK-SUB                   17130000
171400         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  17140000
171500         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEMS-DISPLAYED           17150000
171600         PERFORM 4410-READ-TEMP-STORAGE                           17160000
171700                                                                  17170000
171800         PERFORM                                                  17180000
171900           UNTIL PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK              17190000
172000              OR PS-ERROR                                         17200000
172100              OR PS-BLOCK-ERROR                                   17210000
172200                                                                  17220000
172300                 COMPUTE PV-ITEMS-HOLD  =                         17230000
172400                         ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +    17240000
172500                         PC-ITEMS-PER-PANEL - 1                   17250000
172600                                                                  17260000
172700                 IF  PV-ITEMS-HOLD > ASC-NUMBER-OF-ITEMS-READ     17270000
172800                     SUBTRACT  ASC-NUMBER-OF-ITEMS-READ           17280000
172900                         FROM  PV-ITEMS-HOLD                      17290000
173000                       GIVING  PV-ITEMS-DIFF                      17300000
173100                     SUBTRACT  PV-ITEMS-DIFF                      17310000
173200                         FROM  PC-ITEMS-PER-PANEL                 17320000
173300                       GIVING  PV-ITEMS-HOLD                      17330000
173400                         MOVE  PV-ITEMS-HOLD TO PV-SUB            17340000
173500                                                ASC-ITEM-SUB      17350000
173600                                               ASC-ITEMS-DISPLAYED17360000
173700                 ELSE                                             17370000
173800                     MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB          17380000
173900                     MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB    17390000
174000                 END-IF                                           17400000
174100                                                                  17410000
174200                 PERFORM 3300-EDIT-SELECTIONS                     17420000
174300                         VARYING PV-SUB                           17430000
174400                            FROM PV-SUB BY -1                     17440000
174500                           UNTIL PV-SUB < +1                      17450000
174600                                                                  17460000
174700                 MOVE +1               TO ASC-BLK-SUB             17470000
174800                                                                  17480000
174900                 PERFORM 5105-REWRITE-ASC-LISTQ                   17490000
175000                                                                  17500000
175100                 MOVE +1                TO ASC-BLK-SUB            17510000
175200                                                                  17520000
175300                 IF  PS-BLOCK-ERROR                               17530000
175400                     SET  PS-ERROR     TO TRUE                    17540000
175500                     MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)    17550000
175600                                       TO PV-TOP-ITEM             17560000
175700                 ELSE                                             17570000
175800                     ADD  +1            TO PV-BLOCK-NUMBER        17580000
175900                     IF  PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK      17590000
176000                         MOVE +2        TO ASC-BLK-SUB            17600000
176100                         PERFORM 4410-READ-TEMP-STORAGE           17610000
176200                         MOVE +1        TO ASC-BLK-SUB            17620000
176300                     ELSE                                         17630000
176400                         PERFORM 4410-READ-TEMP-STORAGE           17640000
176500                         ADD  +1        TO PV-BLOCK-NUMBER        17650000
176600                         MOVE +2        TO ASC-BLK-SUB            17660000
176700                         PERFORM 4410-READ-TEMP-STORAGE           17670000
176800                         SUBTRACT +1  FROM PV-BLOCK-NUMBER        17680000
176900                         MOVE +1        TO ASC-BLK-SUB            17690000
177000                     END-IF                                       17700000
177100                 END-IF                                           17710000
177200     END-PERFORM.                                                 17720000
177300                                                                  17730000
177400*----------------------------------------------------------------*17740000
177500*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *17750000
177600*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*17760000
177700*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *17770000
177800*                                                                *17780000
177900*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *17790000
178000*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *17800000
178100*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *17810000
178200*    US IN THE 2ND BLOCK OF THE ARRAY.                           *17820000
178300*----------------------------------------------------------------*17830000
178400 3100-SET-SUBSCRIPTS.                                             17840000
178500                                                                  17850000
178600     COMPUTE ASC-ITEM-SUB =                                       17860000
178700         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        17870000
178800                                                                  17880000
178900     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         17890000
179000         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            17900000
179100         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               17910000
179200     ELSE                                                         17920000
179300         MOVE +1                     TO ASC-BLK-SUB               17930000
179400     END-IF.                                                      17940000
179500******************************************************************17950000
179600** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **17960000
179700******************************************************************17970000
179800 3200-RESET-ATTRIBUTES.                                           17980000
179900     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   17990000
180000     MOVE DP015-GREEN              TO ASTRTITC.                   18000000
180100     MOVE DP015-UNDERLINE          TO ASTRTITH.                   18010000
180200                                                                  18020000
180300     PERFORM                                                      18030000
180400         VARYING PV-SUB                                           18040000
180500         FROM 1 BY 1                                              18050000
180600         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        18060000
180700             MOVE DP015-UNP-ALP-NOR-OFF TO MR-SELECTA (PV-SUB)    18070000
180800             MOVE DP015-GREEN         TO MR-SELECTC (PV-SUB)      18080000
180900             MOVE DP015-UNDERLINE     TO MR-SELECTH (PV-SUB)      18090000
181000     END-PERFORM.                                                 18100000
181100                                                                  18110000
181200******************************************************************18120000
181300** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **18130000
181400** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **18140000
181500** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **18150000
181600** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **18160000
181700******************************************************************18170000
181800 3300-EDIT-SELECTIONS.                                            18180000
181900     EVALUATE TRUE                                                18190000
182000         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     18200000
182100             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         18210000
182200                 CONTINUE                                         18220000
182300         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         18230000
182400             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        18240000
182500                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   18250000
182600                 MOVE ASC-TEMP-SELECTED-SW                        18260000
182700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18270000
182800                                TO ASC-SELECTED-SW                18280000
182900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18290000
183000             END-IF                                               18300000
183100         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     18310000
183200                 = SPACE                                          18320000
183300             EVALUATE TRUE                                        18330000
183400                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       18340000
183500                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS18350000
183600                     MOVE SPACE TO ASC-SELECTED-SW                18360000
183700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18370000
183800                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        18380000
183900                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    18390000
184000                     MOVE SPACE TO ASC-SELECTED-SW                18400000
184100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18410000
184200                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          18420000
184300                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      18430000
184400                     MOVE SPACE TO ASC-SELECTED-SW                18440000
184500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18450000
184600             END-EVALUATE                                         18460000
184700         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           18470000
184800             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            18480000
184900                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    18490000
185000             END-IF                                               18500000
185100             PERFORM 3310-EDIT-RANGE                              18510000
185200         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             18520000
185300             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            18530000
185400                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    18540000
185500             END-IF                                               18550000
185600             PERFORM 3310-EDIT-RANGE                              18560000
185700         WHEN OTHER                                               18570000
185800             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           18580000
185900             SET DP020-MSG-FATAL    TO TRUE                       18590000
186000             MOVE -1                TO MR-SELECTL (PV-SUB)        18600000
186100             SET DP030-SET-CURSOR-APPL-1                          18610000
186200                                    TO TRUE                       18620000
186300             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        18630000
186400             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        18640000
186500             SET PS-ERROR TO TRUE                                 18650000
186600             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            18660000
186700                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     18670000
186800                 MOVE SPACE         TO ASC-SELECTED-SW            18680000
186900                                        (ASC-BLK-SUB ASC-ITEM-SUB)18690000
187000             END-IF                                               18700000
187100     END-EVALUATE.                                                18710000
187200                                                                  18720000
187300     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 18730000
187400     SUBTRACT +1 FROM ASC-ITEM-SUB.                               18740000
187500     IF  ASC-ITEM-SUB < 1                                         18750000
187600         SUBTRACT +1 FROM ASC-BLK-SUB                             18760000
187700         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                18770000
187800     END-IF.                                                      18780000
187900                                                                  18790000
188000******************************************************************18800000
188100** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **18810000
188200** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **18820000
188300** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**18830000
188400** THE ENDING.                                                  **18840000
188500******************************************************************18850000
188600 3310-EDIT-RANGE.                                                 18860000
188700     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                18870000
188800         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   18880000
188900             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)18890000
189000                                   TO ASC-SELECTED-SW             18900000
189100                                        (ASC-BLK-SUB ASC-ITEM-SUB)18910000
189200             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 18920000
189300         ELSE                                                     18930000
189400             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     18940000
189500                 CONTINUE                                         18950000
189600             ELSE                                                 18960000
189700*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        18970000
189800                 MOVE PC-TSYMSG-00054                             18980000
189900                                       TO DP020-MSG-NUMBER        18990000
190000                 MOVE -1               TO MR-SELECTL (PV-SUB)     19000000
190100                 MOVE DP015-RED        TO MR-SELECTC (PV-SUB)     19010000
190200                 MOVE DP015-UNDERLINE  TO MR-SELECTH (PV-SUB)     19020000
190300                 SET DP020-MSG-FATAL                              19030000
190400                     DP030-SET-CURSOR-APPL-1                      19040000
190500                     PS-ERROR          TO TRUE                    19050000
190600             END-IF                                               19060000
190700         END-IF                                                   19070000
190800     ELSE                                                         19080000
190900         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     19090000
191000             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 19100000
191100                                   TO ASC-SELECTED-SW             19110000
191200                                     (ASC-BLK-SUB ASC-ITEM-SUB)   19120000
191300             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   19130000
191400         ELSE                                                     19140000
191500             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       19150000
191600                 CONTINUE                                         19160000
191700             ELSE                                                 19170000
191800*                -- ONLY ONE END-OF-RANGE ALLOWED --              19180000
191900                 MOVE PC-TSYMSG-00055                             19190000
192000                                        TO DP020-MSG-NUMBER       19200000
192100                 MOVE -1                TO MR-SELECTL (PV-SUB)    19210000
192200                 SET DP020-MSG-FATAL                              19220000
192300                     DP030-SET-CURSOR-APPL-1                      19230000
192400                     PS-ERROR           TO TRUE                   19240000
192500             END-IF                                               19250000
192600         END-IF                                                   19260000
192700     END-IF.                                                      19270000
192800*                                                                 19280000
192900******************************************************************19290000
193000** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **19300000
193100** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **19310000
193200******************************************************************19320000
193300 3400-CHECK-RANGE-SEQUENCE.                                       19330000
193400     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       19340000
193500       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      19350000
193600       AND  ASC-START-OF-SELECTED-RANGE >                         19360000
193700                                         ASC-END-OF-SELECTED-RANGE19370000
193800*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                19380000
193900         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 19390000
194000         SET DP020-MSG-FATAL TO TRUE                              19400000
194100         SET PS-ERROR TO TRUE                                     19410000
194200         PERFORM 3410-POSITION-AT-ERROR                           19420000
194300     END-IF.                                                      19430000
194400******************************************************************19440000
194500** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **19450000
194600** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **19460000
194700** SHOULD BE POSITIONED ON A RANGE ERROR.                       **19470000
194800******************************************************************19480000
194900 3410-POSITION-AT-ERROR.                                          19490000
195000     SET DP030-SET-CURSOR-APPL-1                                  19500000
195100                                   TO TRUE.                       19510000
195200     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 19520000
195300                    - PV-TOP-ITEM + 1.                            19530000
195400     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      19540000
195500         CONTINUE                                                 19550000
195600     ELSE                                                         19560000
195700         MOVE -1                   TO MR-SELECTL (PV-SUB)         19570000
195800         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         19580000
195900         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         19590000
196000     END-IF.                                                      19600000
196100*                                                                 19610000
196200     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   19620000
196300                    - PV-TOP-ITEM + 1.                            19630000
196400     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      19640000
196500         CONTINUE                                                 19650000
196600     ELSE                                                         19660000
196700         MOVE -1                   TO MR-SELECTL (PV-SUB)         19670000
196800         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         19680000
196900         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         19690000
197000     END-IF.                                                      19700000
197100                                                                  19710000
197200*----------------------------------------------------------------*19720000
197300*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *19730000
197400*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *19740000
197500*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *19750000
197600*----------------------------------------------------------------*19760000
197700 3500-MARK-RANGE-AS-SELECTED.                                     19770000
197800     MOVE +1                       TO  ASC-BLK-SUB.               19780000
197900     PERFORM 3510-MARK-SELECTED-INDS                              19790000
198000         VARYING ASC-ITEM-SUB                                     19800000
198100         FROM 1 BY 1                                              19810000
198200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 19820000
198300                                                                  19830000
198400     ADD +1                        TO ASC-BLK-SUB.                19840000
198500     PERFORM 3510-MARK-SELECTED-INDS                              19850000
198600         VARYING ASC-ITEM-SUB                                     19860000
198700         FROM 1 BY 1                                              19870000
198800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 19880000
198900                                                                  19890000
199000     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               19900000
199100                                   TO  PV-LIST-ITEM-NUMBER.       19910000
199200     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            19920000
199300         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         19930000
199400               PC-ITEMS-PER-PANEL).                               19940000
199500                                                                  19950000
199600     MOVE ASC-START-OF-SELECTED-RANGE                             19960000
199700                                   TO PV-START-OF-SELECTED-RANGE. 19970000
199800     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            19980000
199900         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  19990000
200000               PC-ITEMS-PER-PANEL).                               20000000
200100                                                                  20010000
200200     MOVE ASC-END-OF-SELECTED-RANGE                               20020000
200300                                   TO  PV-END-OF-SELECTED-RANGE.  20030000
200400     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             20040000
200500         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    20050000
200600               PC-ITEMS-PER-PANEL).                               20060000
200700     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             20070000
200800         PV-FIRST-BLOCK-IN-ARRAY + 1.                             20080000
200900                                                                  20090000
201000     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    20100000
201100        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        20110000
201200         MOVE +1                   TO ASC-BLK-SUB                 20120000
201300         PERFORM 5100-WRITE-TEMP-STORAGE                          20130000
201400         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         20140000
201500             PV-FIRST-BLOCK-IN-ARRAY - 1                          20150000
201600                                                                  20160000
201700         PERFORM                                                  20170000
201800             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      20180000
201900                   PV-PREV-BLOCK-IN-ARRAY                         20190000
202000             MOVE PV-FIRST-BLOCK-IN-RANGE                         20200000
202100                                   TO PV-BLOCK-NUMBER             20210000
202200             PERFORM 4410-READ-TEMP-STORAGE                       20220000
202300             PERFORM 3510-MARK-SELECTED-INDS                      20230000
202400                 VARYING ASC-ITEM-SUB                             20240000
202500                 FROM 1 BY 1                                      20250000
202600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          20260000
202700             PERFORM 5100-WRITE-TEMP-STORAGE                      20270000
202800             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     20280000
202900         END-PERFORM                                              20290000
203000                                                                  20300000
203100         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         20310000
203200             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     20320000
203300         PERFORM                                                  20330000
203400             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       20340000
203500                   PV-LAST-BLOCK-IN-RANGE                         20350000
203600             MOVE PV-NEXT-BLOCK-IN-ARRAY                          20360000
203700                                   TO PV-BLOCK-NUMBER             20370000
203800             PERFORM 4410-READ-TEMP-STORAGE                       20380000
203900             PERFORM 3510-MARK-SELECTED-INDS                      20390000
204000                 VARYING ASC-ITEM-SUB                             20400000
204100                 FROM 1 BY 1                                      20410000
204200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          20420000
204300             PERFORM 5100-WRITE-TEMP-STORAGE                      20430000
204400             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      20440000
204500         END-PERFORM                                              20450000
204600                                                                  20460000
204700         MOVE PV-FIRST-BLOCK-IN-ARRAY                             20470000
204800                                   TO PV-BLOCK-NUMBER             20480000
204900         PERFORM 4410-READ-TEMP-STORAGE                           20490000
205000     END-IF.                                                      20500000
205100                                                                  20510000
205200     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 20520000
205300                                      ASC-END-OF-SELECTED-RANGE.  20530000
205400                                                                  20540000
205500*----------------------------------------------------------------*20550000
205600* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *20560000
205700*----------------------------------------------------------------*20570000
205800 3510-MARK-SELECTED-INDS.                                         20580000
205900                                                                  20590000
206000     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         20600000
206100                                ASC-ITEM-SUB) >                   20610000
206200         ASC-START-OF-SELECTED-RANGE)                             20620000
206300     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         20630000
206400                                ASC-ITEM-SUB) =                   20640000
206500         ASC-START-OF-SELECTED-RANGE)                             20650000
206600                                                                  20660000
206700         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     20670000
206800                                    ASC-ITEM-SUB) <               20680000
206900             ASC-END-OF-SELECTED-RANGE)                           20690000
207000         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     20700000
207100                                    ASC-ITEM-SUB) =               20710000
207200             ASC-END-OF-SELECTED-RANGE)                           20720000
207300                                                                  20730000
207400             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          20740000
207500                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   20750000
207600                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   20760000
207700                               TO TRUE                            20770000
207800                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              20780000
207900                               TO TRUE                            20790000
208000                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    20800000
208100             END-IF                                               20810000
208200         END-IF                                                   20820000
208300     END-IF.                                                      20830000
208400                                                                  20840000
208500*----------------------------------------------------------------*20850000
208600*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *20860000
208700*    INITIALIZE ALL COUNTERS AND FLAGS.                          *20870000
208800*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *20880000
208900*    DISPLAY THE PANEL TO USER.                                  *20890000
209000*----------------------------------------------------------------*20900000
209100 4000-BUILD-INITIAL-PANEL.                                        20910000
209200                                                                  20920000
209300     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            20930000
209400                                 ASC-BLOCK-ENTRIES (2).           20940000
209500     MOVE +1                 TO ASC-BLK-SUB.                      20950000
209600     SET ASC-ITEMS-LEFT-ON-DB                                     20960000
209700                             TO TRUE.                             20970000
209800                                                                  20980000
209900     MOVE +0                 TO ASC-ITEM-SUB                      20990000
210000                                ASC-NUMBER-OF-ITEMS-READ          21000000
210100                                ASC-NUMBER-OF-SELECTED-ITEMS      21010000
210200                                ASC-HIGHEST-BLOCK-WRITTEN         21020000
210300                                ASC-START-OF-SELECTED-RANGE       21030000
210400                                ASC-END-OF-SELECTED-RANGE         21040000
210500                                ASC-ITEM-AT-TOP-OF-PANEL.         21050000
210600                                                                  21060000
210700         MOVE ASC-OPER-UNT-ID  TO DK-OPER-UNT-ID.                 21070000
210800         MOVE ASC-DOOR-ID      TO DK-DOOR-ID.                     21080000
210900                                                                  21090000
211000     INITIALIZE XL071-COMMAREA-REC.                               21100013
211100     MOVE DK-OPER-UNT-ID  TO XL071-LOCATION-NUMBER.               21110013
211200                                                                  21120013
211300     CALL PC-LOCATION-MODULE  USING DFHEIBLK                      21130013
211400                                    XL071-COMMAREA                21140013
211500                                    XL071-COMMAREA-REC.           21150013
211600                                                                  21160013
211700     IF XL071-NO-ERRORS                                           21170013
211800         MOVE XL071-LOC-NM       TO ASC-OPER-UNT-NAME             21180013
211900     ELSE                                                         21190013
212000         MOVE SPACES             TO ASC-OPER-UNT-NAME             21200013
212100     END-IF.                                                      21210013
212300                                                                  21230000
212400     PERFORM 4100-PREPARE-CURSOR.                                 21240000
212500     PERFORM 4010-OPEN-CURSOR.                                    21250000
212600     PERFORM 4300-READ-ITEMS-FROM-DB.                             21260000
212700     PERFORM 4020-CLOSE-CURSOR.                                   21270000
212800                                                                  21280000
212900     MOVE +1                   TO  PV-TOP-ITEM.                   21290000
213000     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          21300000
213100         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    21310000
213200         SET DP020-MSG-FATAL   TO  TRUE                           21320000
213300         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               21330000
213400     ELSE                                                         21340000
213500         MOVE -1               TO MR-SELECTL (1)                  21350000
213600         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      21360000
213700         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     21370000
213800     END-IF.                                                      21380000
213900                                                                  21390000
214000 4101-LOAD-STAT-CDES.                                             21400013
214100                                                                  21410013
214200     MOVE ASC-TRLR-STATUS             TO DK-TRLR-STATUS           21420013
214300                                                                  21430013
214400*    BEGIN BY SELECTING ALL POSSIBLE STATUSES                     21440013
214500     MOVE 'DO'                        TO DK-STAT-CDE1             21450013
214600     MOVE 'DC'                        TO DK-STAT-CDE2             21460013
214700     MOVE 'DS'                        TO DK-STAT-CDE3             21470013
214800     MOVE 'SO'                        TO DK-STAT-CDE4             21480013
214900     MOVE 'SU'                        TO DK-STAT-CDE5             21490013
215000     MOVE 'AO'                        TO DK-STAT-CDE6             21500013
215100     MOVE 'AK'                        TO DK-STAT-CDE7             21510013
215200     MOVE 'AR'                        TO DK-STAT-CDE8             21520013
215300                                                                  21530013
215400*    THEN BLANK OUT THE ONES THAT WEREN'T ACTUALLY USED           21540013
215500     IF DK-DCOPEN = SPACES                                        21550013
215600         MOVE SPACES                  TO DK-STAT-CDE1             21560013
215700     ELSE                                                         21570013
215800         MOVE DK-DCOPEN               TO PV-HOLD-STAT             21580013
215900     END-IF                                                       21590013
216000                                                                  21600013
216100     IF DK-DCCLOSED = SPACES                                      21610013
216200         MOVE SPACES                  TO DK-STAT-CDE2             21620013
216300     ELSE                                                         21630013
216400         MOVE DK-DCCLOSED             TO PV-HOLD-STAT             21640013
216500     END-IF                                                       21650013
216600                                                                  21660013
216700     IF DK-SHIPPED = SPACES                                       21670013
216800         MOVE SPACES                  TO DK-STAT-CDE3             21680013
216900     ELSE                                                         21690013
217000         MOVE DK-SHIPPED              TO PV-HOLD-STAT             21700013
217100     END-IF                                                       21710013
217200                                                                  21720013
217300                                                                  21730013
217400     IF DK-STOREOPEN = SPACES                                     21740013
217500         MOVE SPACES                  TO DK-STAT-CDE4             21750013
217600     ELSE                                                         21760013
217700         MOVE DK-STOREOPEN            TO PV-HOLD-STAT             21770013
217800     END-IF                                                       21780013
217900                                                                  21790013
218000     IF DK-STOREUNLOADED = SPACES                                 21800013
218100         MOVE SPACES                  TO DK-STAT-CDE5             21810013
218200     ELSE                                                         21820013
218300         MOVE DK-STOREUNLOADED        TO PV-HOLD-STAT             21830013
218400     END-IF                                                       21840013
218500                                                                  21850013
218600     IF DK-AUDIT = SPACES                                         21860013
218700         MOVE SPACES                  TO DK-STAT-CDE6             21870013
218800                                         DK-STAT-CDE7             21880013
218900                                         DK-STAT-CDE8             21890013
219000     ELSE                                                         21900013
219100         MOVE DK-AUDIT                TO PV-HOLD-STAT             21910013
219200     END-IF                                                       21920013
219300                                                                  21930013
219400*    FILL IN UNUSED STATUSES WITH THE HOLD FIELD FROM THE         21940013
219500*    PREVIOUS STEP.                                               21950013
219600     IF DK-STAT-CDE1 = SPACES                                     21960013
219700         MOVE PV-HOLD-STAT            TO DK-STAT-CDE1             21970013
219800     END-IF                                                       21980013
219900     IF DK-STAT-CDE2 = SPACES                                     21990013
220000         MOVE PV-HOLD-STAT            TO DK-STAT-CDE2             22000013
220100     END-IF                                                       22010013
220200     IF DK-STAT-CDE3 = SPACES                                     22020013
220300         MOVE PV-HOLD-STAT            TO DK-STAT-CDE3             22030013
220400     END-IF                                                       22040013
220500     IF DK-STAT-CDE4 = SPACES                                     22050013
220600         MOVE PV-HOLD-STAT            TO DK-STAT-CDE4             22060013
220700     END-IF                                                       22070013
220800     IF DK-STAT-CDE5 = SPACES                                     22080013
220900         MOVE PV-HOLD-STAT            TO DK-STAT-CDE5             22090013
221000     END-IF                                                       22100013
221100     IF DK-STAT-CDE6 = SPACES                                     22110013
221200         MOVE PV-HOLD-STAT            TO DK-STAT-CDE6             22120013
221300     END-IF                                                       22130013
221400     IF DK-STAT-CDE7 = SPACES                                     22140013
221500         MOVE PV-HOLD-STAT            TO DK-STAT-CDE7             22150013
221600     END-IF                                                       22160013
221700     IF DK-STAT-CDE8 = SPACES                                     22170013
221800         MOVE PV-HOLD-STAT            TO DK-STAT-CDE8             22180013
221900     END-IF.                                                      22190013
221901/                                                                 22190113
221902*----------------------------------------------------------------*22190200
221903* OPEN THE CURSOR                                                 22190300
221904*   IN THIS PARTICULAR APPLICATION ONE OF 3 DIFFERENT CURSORS    *22190400
221905*   WILL BE OPENED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *22190500
221906*   USER.                                                        *22190600
221907*----------------------------------------------------------------*22190700
221908 4010-OPEN-CURSOR.                                                22190800
221909     PERFORM                                                      22190900
221910         WITH TEST AFTER                                          22191000
221911         VARYING PV-RETRY-COUNTER                                 22191100
221912         FROM 1 BY 1                                              22191200
221913         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               22191300
221914                   OR (SQLCODE = ZERO))                           22191400
221915                                                                  22191500
221916         EVALUATE TRUE                                            22191600
221917             WHEN PS-OPER-UNT-CSR                                 22191700
221918                 IF ASC-DOOR-SEQ                                  22191813
221919                     EXEC SQL                                     22191900
221920                          OPEN OPER-UNT-CSR                       22192000
221930                     END-EXEC                                     22193000
221931                 ELSE                                             22193113
221932                     EXEC SQL                                     22193200
221933                          OPEN OPER-UNT-CSR-ALT                   22193300
221934                     END-EXEC                                     22193400
221935                 END-IF                                           22193513
221936                                                                  22193600
221937             WHEN PS-DOOR-ID-CSR                                  22193700
221938                 IF ASC-DOOR-SEQ                                  22193813
221939                     EXEC SQL                                     22193900
221940                          OPEN DOOR-ID-CSR                        22194000
221941                     END-EXEC                                     22194100
221942                 ELSE                                             22194200
221943                     EXEC SQL                                     22194300
221944                          OPEN DOOR-ID-CSR-ALT                    22194400
221945                     END-EXEC                                     22194500
221946                 END-IF                                           22194613
221947                                                                  22194700
221948             WHEN PS-DOOR-TYPE-CSR                                22194800
221949                 IF ASC-DOOR-SEQ                                  22194913
221950                     EXEC SQL                                     22195000
221951                          OPEN DOOR-TYPE-CSR                      22195100
221952                     END-EXEC                                     22195200
221953                 ELSE                                             22195300
221954                     EXEC SQL                                     22195400
221955                          OPEN DOOR-TYPE-CSR-ALT                  22195500
221956                     END-EXEC                                     22195600
221957                 END-IF                                           22195700
221958                                                                  22195800
221959         END-EVALUATE                                             22195900
221960                                                                  22196000
221961         EVALUATE TRUE                                            22196100
221962             WHEN SQLCODE = ZERO                                  22196200
221963             WHEN SQLCODE = -904                                  22196300
221964             WHEN SQLCODE = -913                                  22196400
221965                 CONTINUE                                         22196500
221966             WHEN SQLWARN0 NOT = SPACES                           22196600
221967             WHEN SQLCODE < ZERO                                  22196700
221968             WHEN SQLCODE > ZERO                                  22196800
221969                 MOVE '4010-OPEN-CURSOR' TO DP013-PARAGRAPH       22196900
221970                 MOVE 'OPEN CURSOR PROBLEM    - '                 22197000
221971                                   TO DP013-MESSAGE-TEXT (1)      22197100
221972                 MOVE SQLCA        TO DP013-SQLCA                 22197200
221973                 MOVE 'TSUOBTR '   TO DP013-DB2-TABLE-NAME (1)    22197300
221974                 SET DP013-DB2-ABEND                              22197400
221975                     DP013-XCTL-DISPLAY-RESTART TO TRUE           22197500
221976                 PERFORM DP013-0000-PROCESS-ABEND                 22197600
221977         END-EVALUATE                                             22197700
221978     END-PERFORM.                                                 22197800
221979*                                                                 22197900
221980     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        22198000
221981         MOVE '4010-OPEN-CURSOR'   TO DP013-PARAGRAPH             22198100
221982         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   22198200
221983                                   TO DP013-MESSAGE-TEXT (1)      22198300
221984         MOVE SQLCA                TO DP013-SQLCA                 22198400
221985         MOVE 'TSUOBTR '           TO DP013-DB2-TABLE-NAME (1)    22198500
221986         SET DP013-DB2-ABEND                                      22198600
221987             DP013-XCTL-DISPLAY-RESTART TO TRUE                   22198700
221988         PERFORM DP013-0000-PROCESS-ABEND                         22198800
221989     END-IF.                                                      22198900
221990                                                                  22199000
221991*----------------------------------------------------------------*22199100
221992* CLOSE THE CURSOR.                                               22199200
221993*   IN THIS PARTICULAR APPLICATION ONE OF 3 DIFFERENT CURSORS    *22199300
221994*   WILL BE CLOSED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *22199400
221995*   USER.                                                        *22199500
221996*----------------------------------------------------------------*22199600
221997 4020-CLOSE-CURSOR.                                               22199700
221998                                                                  22199800
221999     EVALUATE TRUE                                                22199900
222000         WHEN PS-OPER-UNT-CSR                                     22200000
222001             IF ASC-DOOR-SEQ                                      22200113
222002                 EXEC SQL                                         22200200
222003                      CLOSE OPER-UNT-CSR                          22200300
222004                 END-EXEC                                         22200400
222005             ELSE                                                 22200500
222006                 EXEC SQL                                         22200600
222007                      CLOSE OPER-UNT-CSR-ALT                      22200700
222008                 END-EXEC                                         22200800
222009             END-IF                                               22200900
222010                                                                  22201000
222020         WHEN PS-DOOR-ID-CSR                                      22202000
222021             IF ASC-DOOR-SEQ                                      22202113
222022                 EXEC SQL                                         22202200
222023                      CLOSE DOOR-ID-CSR                           22202300
222024                 END-EXEC                                         22202400
222025             ELSE                                                 22202500
222026                 EXEC SQL                                         22202600
222027                      CLOSE DOOR-ID-CSR-ALT                       22202700
222028                 END-EXEC                                         22202800
222029             END-IF                                               22202900
222030                                                                  22203000
222100         WHEN PS-DOOR-TYPE-CSR                                    22210000
222110             IF ASC-DOOR-SEQ                                      22211013
222200                 EXEC SQL                                         22220000
222300                      CLOSE DOOR-TYPE-CSR                         22230000
222400                 END-EXEC                                         22240000
222500             ELSE                                                 22250000
222501                 EXEC SQL                                         22250113
222502                      CLOSE DOOR-TYPE-CSR-ALT                     22250200
222503                 END-EXEC                                         22250300
222504             END-IF                                               22250400
222505                                                                  22250500
222600     END-EVALUATE.                                                22260000
222700                                                                  22270000
222800     EVALUATE TRUE                                                22280000
222900         WHEN SQLCODE = ZERO                                      22290000
223000         WHEN SQLCODE = +100                                      22300000
223100             CONTINUE                                             22310000
223200         WHEN SQLWARN0 NOT = SPACES                               22320000
223300         WHEN SQLCODE < ZERO                                      22330000
223400         WHEN SQLCODE > ZERO                                      22340000
223500             MOVE '4020-CLOSE-CURSOR' TO DP013-PARAGRAPH          22350000
223600             MOVE 'CLOSE CURSOR PROBLEM   '                       22360000
223700                               TO DP013-MESSAGE-TEXT (1)          22370000
223800             MOVE SQLCA        TO DP013-SQLCA                     22380000
223900             MOVE 'TSUOBTR '   TO DP013-DB2-TABLE-NAME (1)        22390000
224000             SET DP013-DB2-ABEND                                  22400000
224100                 DP013-XCTL-DISPLAY-RESTART TO TRUE               22410000
224200             PERFORM DP013-0000-PROCESS-ABEND                     22420000
224300     END-EVALUATE.                                                22430000
224400                                                                  22440000
224500*----------------------------------------------------------------*22450000
224600*    SET UP THE HOST VARIABLES.                                  *22460000
224700*----------------------------------------------------------------*22470000
224800 4100-PREPARE-CURSOR.                                             22480000
224900                                                                  22490013
225000     IF ASC-DOOR-SEQ                                              22500013
225100         MOVE 'DOOR SEQUENCE'  TO ASEQO                           22510013
225200     ELSE                                                         22520013
225300         MOVE 'STORE SEQUENCE' TO ASEQO                           22530013
225400     END-IF                                                       22540013
225401                                                                  22540113
225402     MOVE SPACE TO PS-CURSOR-SW.                                  22540200
225403     IF ASC-DOOR-ID   > SPACES                                    22540300
225404         SET PS-DOOR-ID-CSR TO TRUE                               22540400
225405     ELSE                                                         22540500
225406         IF ASC-DOOR-TYPE  > SPACES                               22540600
225407             MOVE ASC-DOOR-TYPE TO DK-DOOR-TYPE                   22540700
225500             SET PS-DOOR-TYPE-CSR TO TRUE                         22550000
225600         ELSE                                                     22560000
225700             IF ASC-OPER-UNT-ID  > SPACES                         22570000
225800                SET PS-OPER-UNT-CSR TO TRUE                       22580000
225900             END-IF                                               22590000
226000          END-IF                                                  22600000
226100     END-IF.                                                      22610000
226200                                                                  22620000
226300     IF PS-DOOR-TYPE-CSR                                          22630000
226400         IF DK-SHUTTLE > SPACES AND DK-SHIPPING > SPACES AND      22640000
226500            DK-RECEIVING > SPACES AND DK-STORAGE > SPACES AND     22650000
226600            DK-STRIPPING > SPACES AND DK-YARD > SPACES            22660000
226700                MOVE PC-YD TO DK-TYPE-CDE8                        22670000
226800                              DK-TYPE-CDE7                        22680000
226900                              DK-TYPE-CDE6                        22690000
227000                MOVE PC-SG TO DK-TYPE-CDE5                        22700000
227100                MOVE PC-ST TO DK-TYPE-CDE4                        22710000
227200                MOVE PC-RC TO DK-TYPE-CDE3                        22720000
227300                MOVE PC-SH TO DK-TYPE-CDE2                        22730000
227400                MOVE PC-DS TO DK-TYPE-CDE1                        22740000
227500         ELSE                                                     22750000
227600         IF DK-SHUTTLE > SPACES AND DK-SHIPPING > SPACES AND      22760000
227700            DK-RECEIVING > SPACES AND DK-STORAGE > SPACES AND     22770000
227800            DK-STRIPPING > SPACES AND DK-YARD = SPACES            22780000
227900                MOVE PC-SG TO DK-TYPE-CDE8                        22790000
228000                              DK-TYPE-CDE7                        22800000
228100                              DK-TYPE-CDE6                        22810000
228200                              DK-TYPE-CDE5                        22820000
228300                MOVE PC-ST TO DK-TYPE-CDE4                        22830000
228400                MOVE PC-RC TO DK-TYPE-CDE3                        22840000
228500                MOVE PC-SH TO DK-TYPE-CDE2                        22850000
228600                MOVE PC-DS TO DK-TYPE-CDE1                        22860000
228700         ELSE                                                     22870000
228800         IF DK-SHUTTLE > SPACES AND DK-SHIPPING > SPACES AND      22880000
228900            DK-RECEIVING > SPACES AND DK-STORAGE > SPACES AND     22890000
229000            DK-STRIPPING = SPACES AND DK-YARD = SPACES            22900000
229100                MOVE PC-ST TO DK-TYPE-CDE8                        22910000
229200                              DK-TYPE-CDE7                        22920000
229300                              DK-TYPE-CDE6                        22930000
229400                              DK-TYPE-CDE5                        22940000
229500                              DK-TYPE-CDE4                        22950000
229600                MOVE PC-RC TO DK-TYPE-CDE3                        22960000
229700                MOVE PC-SH TO DK-TYPE-CDE2                        22970000
229800                MOVE PC-DS TO DK-TYPE-CDE1                        22980000
229900         ELSE                                                     22990000
230000         IF DK-SHUTTLE > SPACES AND DK-SHIPPING > SPACES AND      23000000
230100            DK-RECEIVING > SPACES AND DK-STORAGE = SPACES AND     23010000
230200            DK-STRIPPING = SPACES AND DK-YARD = SPACES            23020000
230300                MOVE PC-RC TO DK-TYPE-CDE8                        23030000
230400                              DK-TYPE-CDE7                        23040000
230500                              DK-TYPE-CDE6                        23050000
230600                              DK-TYPE-CDE5                        23060000
230700                              DK-TYPE-CDE4                        23070000
230800                              DK-TYPE-CDE3                        23080000
230900                MOVE PC-SH TO DK-TYPE-CDE2                        23090000
231000                MOVE PC-DS TO DK-TYPE-CDE1                        23100000
231100         ELSE                                                     23110000
231200         IF DK-SHUTTLE > SPACES AND DK-SHIPPING > SPACES AND      23120000
231300            DK-RECEIVING = SPACES AND DK-STORAGE = SPACES AND     23130000
231400            DK-STRIPPING = SPACES AND DK-YARD = SPACES            23140000
231500                MOVE PC-SH TO DK-TYPE-CDE8                        23150000
231600                              DK-TYPE-CDE7                        23160000
231700                              DK-TYPE-CDE6                        23170000
231800                              DK-TYPE-CDE5                        23180000
231900                              DK-TYPE-CDE4                        23190000
232000                              DK-TYPE-CDE3                        23200000
232100                              DK-TYPE-CDE2                        23210000
232200                MOVE PC-DS TO DK-TYPE-CDE1                        23220000
232300         ELSE                                                     23230000
232400         IF DK-SHUTTLE > SPACES AND DK-SHIPPING = SPACES AND      23240000
232500            DK-RECEIVING = SPACES AND DK-STORAGE = SPACES AND     23250000
232600            DK-STRIPPING = SPACES AND DK-YARD = SPACES            23260000
232700                MOVE PC-DS TO DK-TYPE-CDE8                        23270000
232800                              DK-TYPE-CDE7                        23280000
232900                              DK-TYPE-CDE6                        23290000
233000                              DK-TYPE-CDE5                        23300000
233100                              DK-TYPE-CDE4                        23310000
233200                              DK-TYPE-CDE3                        23320000
233300                              DK-TYPE-CDE2                        23330000
233400                              DK-TYPE-CDE1                        23340000
233500         ELSE                                                     23350000
233600         IF DK-SHUTTLE > SPACES AND DK-SHIPPING = SPACES AND      23360000
233700            DK-RECEIVING = SPACES AND DK-STORAGE = SPACES AND     23370000
233800            DK-STRIPPING = SPACES AND DK-YARD > SPACES            23380000
233900                MOVE PC-YD TO DK-TYPE-CDE8                        23390000
234000                              DK-TYPE-CDE7                        23400000
234100                              DK-TYPE-CDE6                        23410000
234200                              DK-TYPE-CDE5                        23420000
234300                              DK-TYPE-CDE4                        23430000
234400                              DK-TYPE-CDE3                        23440000
234500                              DK-TYPE-CDE2                        23450000
234600                MOVE PC-DS TO DK-TYPE-CDE1                        23460000
234700         ELSE                                                     23470000
234800         IF DK-SHUTTLE > SPACES AND DK-SHIPPING = SPACES AND      23480000
234900            DK-RECEIVING = SPACES AND DK-STORAGE = SPACES AND     23490000
235000            DK-STRIPPING > SPACES AND DK-YARD = SPACES            23500000
235100                MOVE PC-SG TO DK-TYPE-CDE8                        23510000
235200                              DK-TYPE-CDE7                        23520000
235300                              DK-TYPE-CDE6                        23530000
235400                              DK-TYPE-CDE5                        23540000
235500                              DK-TYPE-CDE4                        23550000
235600                              DK-TYPE-CDE3                        23560000
235700                              DK-TYPE-CDE2                        23570000
235800                MOVE PC-DS TO DK-TYPE-CDE1                        23580000
235900         ELSE                                                     23590000
236000         IF DK-SHUTTLE > SPACES AND DK-SHIPPING = SPACES AND      23600000
236100            DK-RECEIVING = SPACES AND DK-STORAGE > SPACES AND     23610000
236200            DK-STRIPPING = SPACES AND DK-YARD = SPACES            23620000
236300                MOVE PC-ST TO DK-TYPE-CDE8                        23630000
236400                              DK-TYPE-CDE7                        23640000
236500                              DK-TYPE-CDE6                        23650000
236600                              DK-TYPE-CDE5                        23660000
236700                              DK-TYPE-CDE4                        23670000
236800                              DK-TYPE-CDE3                        23680000
236900                              DK-TYPE-CDE2                        23690000
237000                MOVE PC-DS TO DK-TYPE-CDE1                        23700000
237100         ELSE                                                     23710000
237200         IF DK-SHUTTLE > SPACES AND DK-SHIPPING = SPACES AND      23720000
237300            DK-RECEIVING > SPACES AND DK-STORAGE = SPACES AND     23730000
237400            DK-STRIPPING = SPACES AND DK-YARD = SPACES            23740000
237500                MOVE PC-RC TO DK-TYPE-CDE8                        23750000
237600                              DK-TYPE-CDE7                        23760000
237700                              DK-TYPE-CDE6                        23770000
237800                              DK-TYPE-CDE5                        23780000
237900                              DK-TYPE-CDE4                        23790000
238000                              DK-TYPE-CDE3                        23800000
238100                              DK-TYPE-CDE2                        23810000
238200                MOVE PC-DS TO DK-TYPE-CDE1                        23820000
238300         ELSE                                                     23830000
238400         IF DK-SHUTTLE > SPACES AND DK-SHIPPING = SPACES AND      23840000
238500            DK-RECEIVING > SPACES AND DK-STORAGE > SPACES AND     23850000
238600            DK-STRIPPING > SPACES AND DK-YARD > SPACES            23860000
238700                MOVE PC-YD TO DK-TYPE-CDE8                        23870000
238800                              DK-TYPE-CDE7                        23880000
238900                              DK-TYPE-CDE6                        23890000
239000                              DK-TYPE-CDE5                        23900000
239100                MOVE PC-SG TO DK-TYPE-CDE4                        23910000
239200                MOVE PC-ST TO DK-TYPE-CDE3                        23920000
239300                MOVE PC-RC TO DK-TYPE-CDE2                        23930000
239400                MOVE PC-DS TO DK-TYPE-CDE1                        23940000
239500         ELSE                                                     23950000
239600         IF DK-SHUTTLE > SPACES AND DK-SHIPPING = SPACES AND      23960000
239700            DK-RECEIVING > SPACES AND DK-STORAGE > SPACES AND     23970000
239800            DK-STRIPPING > SPACES AND DK-YARD = SPACES            23980000
239900                MOVE PC-SG TO DK-TYPE-CDE8                        23990000
240000                              DK-TYPE-CDE7                        24000000
240100                              DK-TYPE-CDE6                        24010000
240200                              DK-TYPE-CDE5                        24020000
240300                              DK-TYPE-CDE4                        24030000
240400                MOVE PC-ST TO DK-TYPE-CDE3                        24040000
240500                MOVE PC-RC TO DK-TYPE-CDE2                        24050000
240600                MOVE PC-DS TO DK-TYPE-CDE1                        24060000
240700         ELSE                                                     24070000
240800         IF DK-SHUTTLE > SPACES AND DK-SHIPPING > SPACES AND      24080000
240900            DK-RECEIVING = SPACES AND DK-STORAGE > SPACES AND     24090000
241000            DK-STRIPPING > SPACES AND DK-YARD > SPACES            24100000
241100                MOVE PC-YD TO DK-TYPE-CDE8                        24110000
241200                              DK-TYPE-CDE7                        24120000
241300                              DK-TYPE-CDE6                        24130000
241400                              DK-TYPE-CDE5                        24140000
241500                MOVE PC-SG TO DK-TYPE-CDE4                        24150000
241600                MOVE PC-ST TO DK-TYPE-CDE3                        24160000
241700                MOVE PC-SH TO DK-TYPE-CDE2                        24170000
241800                MOVE PC-DS TO DK-TYPE-CDE1                        24180000
241900         ELSE                                                     24190000
242000         IF DK-SHUTTLE > SPACES AND DK-SHIPPING > SPACES AND      24200000
242100            DK-RECEIVING = SPACES AND DK-STORAGE > SPACES AND     24210000
242200            DK-STRIPPING > SPACES AND DK-YARD = SPACES            24220000
242300                MOVE PC-SG TO DK-TYPE-CDE8                        24230000
242400                              DK-TYPE-CDE7                        24240000
242500                              DK-TYPE-CDE6                        24250000
242600                              DK-TYPE-CDE5                        24260000
242700                              DK-TYPE-CDE4                        24270000
242800                MOVE PC-ST TO DK-TYPE-CDE3                        24280000
242900                MOVE PC-SH TO DK-TYPE-CDE2                        24290000
243000                MOVE PC-DS TO DK-TYPE-CDE1                        24300000
243100         ELSE                                                     24310000
243200         IF DK-SHUTTLE > SPACES AND DK-SHIPPING > SPACES AND      24320000
243300            DK-RECEIVING > SPACES AND DK-STORAGE = SPACES AND     24330000
243400            DK-STRIPPING > SPACES AND DK-YARD > SPACES            24340000
243500                MOVE PC-YD TO DK-TYPE-CDE8                        24350000
243600                              DK-TYPE-CDE7                        24360000
243700                              DK-TYPE-CDE6                        24370000
243800                              DK-TYPE-CDE5                        24380000
243900                MOVE PC-SG TO DK-TYPE-CDE4                        24390000
244000                MOVE PC-RC TO DK-TYPE-CDE3                        24400000
244100                MOVE PC-SH TO DK-TYPE-CDE2                        24410000
244200                MOVE PC-DS TO DK-TYPE-CDE1                        24420000
244300         ELSE                                                     24430000
244400         IF DK-SHUTTLE > SPACES AND DK-SHIPPING > SPACES AND      24440000
244500            DK-RECEIVING > SPACES AND DK-STORAGE = SPACES AND     24450000
244600            DK-STRIPPING > SPACES AND DK-YARD = SPACES            24460000
244700                MOVE PC-SG TO DK-TYPE-CDE8                        24470000
244800                              DK-TYPE-CDE7                        24480000
244900                              DK-TYPE-CDE6                        24490000
245000                              DK-TYPE-CDE5                        24500000
245100                              DK-TYPE-CDE4                        24510000
245200                MOVE PC-RC TO DK-TYPE-CDE3                        24520000
245300                MOVE PC-SH TO DK-TYPE-CDE2                        24530000
245400                MOVE PC-DS TO DK-TYPE-CDE1                        24540000
245500         ELSE                                                     24550000
245600         IF DK-SHUTTLE > SPACES AND DK-SHIPPING > SPACES AND      24560000
245700            DK-RECEIVING = SPACES AND DK-STORAGE > SPACES AND     24570000
245800            DK-STRIPPING = SPACES AND DK-YARD > SPACES            24580000
245900                MOVE PC-YD TO DK-TYPE-CDE8                        24590000
246000                              DK-TYPE-CDE7                        24600000
246100                              DK-TYPE-CDE6                        24610000
246200                              DK-TYPE-CDE5                        24620000
246300                              DK-TYPE-CDE4                        24630000
246400                MOVE PC-ST TO DK-TYPE-CDE3                        24640000
246500                MOVE PC-SH TO DK-TYPE-CDE2                        24650000
246600                MOVE PC-DS TO DK-TYPE-CDE1                        24660000
246700         ELSE                                                     24670000
246800         IF DK-SHUTTLE > SPACES AND DK-SHIPPING > SPACES AND      24680000
246900            DK-RECEIVING = SPACES AND DK-STORAGE > SPACES AND     24690000
247000            DK-STRIPPING = SPACES AND DK-YARD = SPACES            24700000
247100                MOVE PC-ST TO DK-TYPE-CDE8                        24710000
247200                              DK-TYPE-CDE7                        24720000
247300                              DK-TYPE-CDE6                        24730000
247400                              DK-TYPE-CDE5                        24740000
247500                              DK-TYPE-CDE4                        24750000
247600                              DK-TYPE-CDE3                        24760000
247700                MOVE PC-SH TO DK-TYPE-CDE2                        24770000
247800                MOVE PC-DS TO DK-TYPE-CDE1                        24780000
247900         ELSE                                                     24790000
248000         IF DK-SHUTTLE > SPACES AND DK-SHIPPING = SPACES AND      24800000
248100            DK-RECEIVING > SPACES AND DK-STORAGE > SPACES AND     24810000
248200            DK-STRIPPING = SPACES AND DK-YARD > SPACES            24820000
248300                MOVE PC-YD TO DK-TYPE-CDE8                        24830000
248400                              DK-TYPE-CDE7                        24840000
248500                              DK-TYPE-CDE6                        24850000
248600                              DK-TYPE-CDE5                        24860000
248700                              DK-TYPE-CDE4                        24870000
248800                MOVE PC-ST TO DK-TYPE-CDE3                        24880000
248900                MOVE PC-RC TO DK-TYPE-CDE2                        24890000
249000                MOVE PC-DS TO DK-TYPE-CDE1                        24900000
249100         ELSE                                                     24910000
249200         IF DK-SHUTTLE > SPACES AND DK-SHIPPING = SPACES AND      24920000
249300            DK-RECEIVING > SPACES AND DK-STORAGE > SPACES AND     24930000
249400            DK-STRIPPING = SPACES AND DK-YARD = SPACES            24940000
249500                MOVE PC-ST TO DK-TYPE-CDE8                        24950000
249600                              DK-TYPE-CDE7                        24960000
249700                              DK-TYPE-CDE6                        24970000
249800                              DK-TYPE-CDE5                        24980000
249900                              DK-TYPE-CDE4                        24990000
250000                              DK-TYPE-CDE3                        25000000
250100                MOVE PC-RC TO DK-TYPE-CDE2                        25010000
250200                MOVE PC-DS TO DK-TYPE-CDE1                        25020000
250300         ELSE                                                     25030000
250400         IF DK-SHUTTLE > SPACES AND DK-SHIPPING = SPACES AND      25040000
250500            DK-RECEIVING > SPACES AND DK-STORAGE = SPACES AND     25050000
250600            DK-STRIPPING > SPACES AND DK-YARD > SPACES            25060000
250700                MOVE PC-YD TO DK-TYPE-CDE8                        25070000
250800                              DK-TYPE-CDE7                        25080000
250900                              DK-TYPE-CDE6                        25090000
251000                              DK-TYPE-CDE5                        25100000
251100                              DK-TYPE-CDE4                        25110000
251200                MOVE PC-SG TO DK-TYPE-CDE3                        25120000
251300                MOVE PC-RC TO DK-TYPE-CDE2                        25130000
251400                MOVE PC-DS TO DK-TYPE-CDE1                        25140000
251500         ELSE                                                     25150000
251600         IF DK-SHUTTLE > SPACES AND DK-SHIPPING = SPACES AND      25160000
251700            DK-RECEIVING > SPACES AND DK-STORAGE = SPACES AND     25170000
251800            DK-STRIPPING > SPACES AND DK-YARD = SPACES            25180000
251900                MOVE PC-SG TO DK-TYPE-CDE8                        25190000
252000                              DK-TYPE-CDE7                        25200000
252100                              DK-TYPE-CDE6                        25210000
252200                              DK-TYPE-CDE5                        25220000
252300                              DK-TYPE-CDE4                        25230000
252400                              DK-TYPE-CDE3                        25240000
252500                MOVE PC-RC TO DK-TYPE-CDE2                        25250000
252600                MOVE PC-DS TO DK-TYPE-CDE1                        25260000
252700         ELSE                                                     25270000
252800         IF DK-SHUTTLE > SPACES AND DK-SHIPPING > SPACES AND      25280000
252900            DK-RECEIVING = SPACES AND DK-STORAGE = SPACES AND     25290000
253000            DK-STRIPPING > SPACES AND DK-YARD > SPACES            25300000
253100                MOVE PC-YD TO DK-TYPE-CDE8                        25310000
253200                              DK-TYPE-CDE7                        25320000
253300                              DK-TYPE-CDE6                        25330000
253400                              DK-TYPE-CDE5                        25340000
253500                              DK-TYPE-CDE4                        25350000
253600                MOVE PC-SG TO DK-TYPE-CDE3                        25360000
253700                MOVE PC-SH TO DK-TYPE-CDE2                        25370000
253800                MOVE PC-DS TO DK-TYPE-CDE1                        25380000
253900         ELSE                                                     25390000
254000         IF DK-SHUTTLE > SPACES AND DK-SHIPPING > SPACES AND      25400000
254100            DK-RECEIVING = SPACES AND DK-STORAGE = SPACES AND     25410000
254200            DK-STRIPPING > SPACES AND DK-YARD = SPACES            25420000
254300                MOVE PC-SG TO DK-TYPE-CDE8                        25430000
254400                              DK-TYPE-CDE7                        25440000
254500                              DK-TYPE-CDE6                        25450000
254600                              DK-TYPE-CDE5                        25460000
254700                              DK-TYPE-CDE4                        25470000
254800                              DK-TYPE-CDE3                        25480000
254900                MOVE PC-SH TO DK-TYPE-CDE2                        25490000
255000                MOVE PC-DS TO DK-TYPE-CDE1                        25500000
255100         ELSE                                                     25510000
255200         IF DK-SHUTTLE > SPACES AND DK-SHIPPING = SPACES AND      25520000
255300            DK-RECEIVING = SPACES AND DK-STORAGE > SPACES AND     25530000
255400            DK-STRIPPING > SPACES AND DK-YARD > SPACES            25540000
255500                MOVE PC-YD TO DK-TYPE-CDE8                        25550000
255600                              DK-TYPE-CDE7                        25560000
255700                              DK-TYPE-CDE6                        25570000
255800                              DK-TYPE-CDE5                        25580000
255900                              DK-TYPE-CDE4                        25590000
256000                MOVE PC-SG TO DK-TYPE-CDE3                        25600000
256100                MOVE PC-ST TO DK-TYPE-CDE2                        25610000
256200                MOVE PC-DS TO DK-TYPE-CDE1                        25620000
256300         ELSE                                                     25630000
256400         IF DK-SHUTTLE > SPACES AND DK-SHIPPING = SPACES AND      25640000
256500            DK-RECEIVING = SPACES AND DK-STORAGE > SPACES AND     25650000
256600            DK-STRIPPING > SPACES AND DK-YARD = SPACES            25660000
256700                MOVE PC-SG TO DK-TYPE-CDE8                        25670000
256800                              DK-TYPE-CDE7                        25680000
256900                              DK-TYPE-CDE6                        25690000
257000                              DK-TYPE-CDE5                        25700000
257100                              DK-TYPE-CDE4                        25710000
257200                              DK-TYPE-CDE3                        25720000
257300                MOVE PC-ST TO DK-TYPE-CDE2                        25730000
257400                MOVE PC-DS TO DK-TYPE-CDE1                        25740000
257500         ELSE                                                     25750000
257600         IF DK-SHUTTLE = SPACES AND DK-SHIPPING > SPACES AND      25760000
257700            DK-RECEIVING > SPACES AND DK-STORAGE > SPACES AND     25770000
257800            DK-STRIPPING > SPACES AND DK-YARD > SPACES            25780000
257900                MOVE PC-YD TO DK-TYPE-CDE8                        25790000
258000                              DK-TYPE-CDE7                        25800000
258100                              DK-TYPE-CDE6                        25810000
258200                              DK-TYPE-CDE5                        25820000
258300                MOVE PC-SG TO DK-TYPE-CDE4                        25830000
258400                MOVE PC-ST TO DK-TYPE-CDE3                        25840000
258500                MOVE PC-RC TO DK-TYPE-CDE2                        25850000
258600                MOVE PC-SH TO DK-TYPE-CDE1                        25860000
258700         ELSE                                                     25870000
258800         IF DK-SHUTTLE = SPACES AND DK-SHIPPING > SPACES AND      25880000
258900            DK-RECEIVING > SPACES AND DK-STORAGE > SPACES AND     25890000
259000            DK-STRIPPING > SPACES AND DK-YARD = SPACES            25900000
259100                MOVE PC-SG TO DK-TYPE-CDE8                        25910000
259200                              DK-TYPE-CDE7                        25920000
259300                              DK-TYPE-CDE6                        25930000
259400                              DK-TYPE-CDE5                        25940000
259500                              DK-TYPE-CDE4                        25950000
259600                MOVE PC-ST TO DK-TYPE-CDE3                        25960000
259700                MOVE PC-RC TO DK-TYPE-CDE2                        25970000
259800                MOVE PC-SH TO DK-TYPE-CDE1                        25980000
259900         ELSE                                                     25990000
260000         IF DK-SHUTTLE = SPACES AND DK-SHIPPING > SPACES AND      26000000
260100            DK-RECEIVING > SPACES AND DK-STORAGE > SPACES AND     26010000
260200            DK-STRIPPING = SPACES AND DK-YARD > SPACES            26020000
260300                MOVE PC-YD TO DK-TYPE-CDE8                        26030000
260400                              DK-TYPE-CDE7                        26040000
260500                              DK-TYPE-CDE6                        26050000
260600                              DK-TYPE-CDE5                        26060000
260700                              DK-TYPE-CDE4                        26070000
260800                MOVE PC-ST TO DK-TYPE-CDE3                        26080000
260900                MOVE PC-RC TO DK-TYPE-CDE2                        26090000
261000                MOVE PC-SH TO DK-TYPE-CDE1                        26100000
261100          ELSE                                                    26110000
261200         IF DK-SHUTTLE = SPACES AND DK-SHIPPING > SPACES AND      26120000
261300            DK-RECEIVING > SPACES AND DK-STORAGE > SPACES AND     26130000
261400            DK-STRIPPING = SPACES AND DK-YARD = SPACES            26140000
261500                MOVE PC-ST TO DK-TYPE-CDE8                        26150000
261600                              DK-TYPE-CDE7                        26160000
261700                              DK-TYPE-CDE6                        26170000
261800                              DK-TYPE-CDE5                        26180000
261900                              DK-TYPE-CDE4                        26190000
262000                              DK-TYPE-CDE3                        26200000
262100                MOVE PC-RC TO DK-TYPE-CDE2                        26210000
262200                MOVE PC-SH TO DK-TYPE-CDE1                        26220000
262300          ELSE                                                    26230000
262400         IF DK-SHUTTLE = SPACES AND DK-SHIPPING > SPACES AND      26240000
262500            DK-RECEIVING > SPACES AND DK-STORAGE = SPACES AND     26250000
262600            DK-STRIPPING > SPACES AND DK-YARD > SPACES            26260000
262700                MOVE PC-YD TO DK-TYPE-CDE8                        26270000
262800                              DK-TYPE-CDE7                        26280000
262900                              DK-TYPE-CDE6                        26290000
263000                              DK-TYPE-CDE5                        26300000
263100                              DK-TYPE-CDE4                        26310000
263200                MOVE PC-SG TO DK-TYPE-CDE3                        26320000
263300                MOVE PC-RC TO DK-TYPE-CDE2                        26330000
263400                MOVE PC-SH TO DK-TYPE-CDE1                        26340000
263500         ELSE                                                     26350000
263600         IF DK-SHUTTLE = SPACES AND DK-SHIPPING > SPACES AND      26360000
263700            DK-RECEIVING > SPACES AND DK-STORAGE = SPACES AND     26370000
263800            DK-STRIPPING > SPACES AND DK-YARD = SPACES            26380000
263900                MOVE PC-SG TO DK-TYPE-CDE8                        26390000
264000                              DK-TYPE-CDE7                        26400000
264100                              DK-TYPE-CDE6                        26410000
264200                              DK-TYPE-CDE5                        26420000
264300                              DK-TYPE-CDE4                        26430000
264400                              DK-TYPE-CDE3                        26440000
264500                MOVE PC-RC TO DK-TYPE-CDE2                        26450000
264600                MOVE PC-SH TO DK-TYPE-CDE1                        26460000
264700         ELSE                                                     26470000
264800         IF DK-SHUTTLE = SPACES AND DK-SHIPPING > SPACES AND      26480000
264900            DK-RECEIVING = SPACES AND DK-STORAGE > SPACES AND     26490000
265000            DK-STRIPPING > SPACES AND DK-YARD > SPACES            26500000
265100                MOVE PC-YD TO DK-TYPE-CDE8                        26510000
265200                              DK-TYPE-CDE7                        26520000
265300                              DK-TYPE-CDE6                        26530000
265400                              DK-TYPE-CDE5                        26540000
265500                              DK-TYPE-CDE4                        26550000
265600                MOVE PC-SG TO DK-TYPE-CDE3                        26560000
265700                MOVE PC-ST TO DK-TYPE-CDE2                        26570000
265800                MOVE PC-SH TO DK-TYPE-CDE1                        26580000
265900         ELSE                                                     26590000
266000         IF DK-SHUTTLE = SPACES AND DK-SHIPPING > SPACES AND      26600000
266100            DK-RECEIVING = SPACES AND DK-STORAGE > SPACES AND     26610000
266200            DK-STRIPPING > SPACES AND DK-YARD = SPACES            26620000
266300                MOVE PC-SG TO DK-TYPE-CDE8                        26630000
266400                              DK-TYPE-CDE7                        26640000
266500                              DK-TYPE-CDE6                        26650000
266600                              DK-TYPE-CDE5                        26660000
266700                              DK-TYPE-CDE4                        26670000
266800                              DK-TYPE-CDE3                        26680000
266900                MOVE PC-ST TO DK-TYPE-CDE2                        26690000
267000                MOVE PC-SH TO DK-TYPE-CDE1                        26700000
267100         ELSE                                                     26710000
267200         IF DK-SHUTTLE = SPACES AND DK-SHIPPING > SPACES AND      26720000
267300            DK-RECEIVING > SPACES AND DK-STORAGE = SPACES AND     26730000
267400            DK-STRIPPING = SPACES AND DK-YARD > SPACES            26740000
267500                MOVE PC-YD TO DK-TYPE-CDE8                        26750000
267600                              DK-TYPE-CDE7                        26760000
267700                              DK-TYPE-CDE6                        26770000
267800                              DK-TYPE-CDE5                        26780000
267900                              DK-TYPE-CDE4                        26790000
268000                              DK-TYPE-CDE3                        26800000
268100                MOVE PC-RC TO DK-TYPE-CDE2                        26810000
268200                MOVE PC-SH TO DK-TYPE-CDE1                        26820000
268300         ELSE                                                     26830000
268400         IF DK-SHUTTLE = SPACES AND DK-SHIPPING > SPACES AND      26840000
268500            DK-RECEIVING > SPACES AND DK-STORAGE = SPACES AND     26850000
268600            DK-STRIPPING = SPACES AND DK-YARD = SPACES            26860000
268700                MOVE PC-RC TO DK-TYPE-CDE8                        26870000
268800                              DK-TYPE-CDE7                        26880000
268900                              DK-TYPE-CDE6                        26890000
269000                              DK-TYPE-CDE5                        26900000
269100                              DK-TYPE-CDE4                        26910000
269200                              DK-TYPE-CDE3                        26920000
269300                              DK-TYPE-CDE2                        26930000
269400                MOVE PC-SH TO DK-TYPE-CDE1                        26940000
269500         ELSE                                                     26950000
269600         IF DK-SHUTTLE = SPACES AND DK-SHIPPING > SPACES AND      26960000
269700            DK-RECEIVING = SPACES AND DK-STORAGE > SPACES AND     26970000
269800            DK-STRIPPING = SPACES AND DK-YARD > SPACES            26980000
269900                MOVE PC-YD TO DK-TYPE-CDE8                        26990000
270000                              DK-TYPE-CDE7                        27000000
270100                              DK-TYPE-CDE6                        27010000
270200                              DK-TYPE-CDE5                        27020000
270300                              DK-TYPE-CDE4                        27030000
270400                              DK-TYPE-CDE3                        27040000
270500                MOVE PC-ST TO DK-TYPE-CDE2                        27050000
270600                MOVE PC-SH TO DK-TYPE-CDE1                        27060000
270700         ELSE                                                     27070000
270800         IF DK-SHUTTLE = SPACES AND DK-SHIPPING > SPACES AND      27080000
270900            DK-RECEIVING = SPACES AND DK-STORAGE > SPACES AND     27090000
271000            DK-STRIPPING = SPACES AND DK-YARD = SPACES            27100000
271100                MOVE PC-ST TO DK-TYPE-CDE8                        27110000
271200                              DK-TYPE-CDE7                        27120000
271300                              DK-TYPE-CDE6                        27130000
271400                              DK-TYPE-CDE5                        27140000
271500                              DK-TYPE-CDE4                        27150000
271600                              DK-TYPE-CDE3                        27160000
271700                              DK-TYPE-CDE2                        27170000
271800                MOVE PC-SH TO DK-TYPE-CDE1                        27180000
271900         ELSE                                                     27190000
272000         IF DK-SHUTTLE = SPACES AND DK-SHIPPING > SPACES AND      27200000
272100            DK-RECEIVING = SPACES AND DK-STORAGE = SPACES AND     27210000
272200            DK-STRIPPING > SPACES AND DK-YARD > SPACES            27220000
272300                MOVE PC-YD TO DK-TYPE-CDE8                        27230000
272400                              DK-TYPE-CDE7                        27240000
272500                              DK-TYPE-CDE6                        27250000
272600                              DK-TYPE-CDE5                        27260000
272700                              DK-TYPE-CDE4                        27270000
272800                              DK-TYPE-CDE3                        27280000
272900                MOVE PC-SG TO DK-TYPE-CDE2                        27290000
273000                MOVE PC-SH TO DK-TYPE-CDE1                        27300000
273100         ELSE                                                     27310000
273200         IF DK-SHUTTLE = SPACES AND DK-SHIPPING > SPACES AND      27320000
273300            DK-RECEIVING = SPACES AND DK-STORAGE = SPACES AND     27330000
273400            DK-STRIPPING > SPACES AND DK-YARD = SPACES            27340000
273500                MOVE PC-SG TO DK-TYPE-CDE8                        27350000
273600                              DK-TYPE-CDE7                        27360000
273700                              DK-TYPE-CDE6                        27370000
273800                              DK-TYPE-CDE5                        27380000
273900                              DK-TYPE-CDE4                        27390000
274000                              DK-TYPE-CDE3                        27400000
274100                              DK-TYPE-CDE2                        27410000
274200                MOVE PC-SH TO DK-TYPE-CDE1                        27420000
274300         ELSE                                                     27430000
274400         IF DK-SHUTTLE = SPACES AND DK-SHIPPING > SPACES AND      27440000
274500            DK-RECEIVING = SPACES AND DK-STORAGE = SPACES AND     27450000
274600            DK-STRIPPING = SPACES AND DK-YARD > SPACES            27460000
274700                MOVE PC-YD TO DK-TYPE-CDE8                        27470000
274800                              DK-TYPE-CDE7                        27480000
274900                              DK-TYPE-CDE6                        27490000
275000                              DK-TYPE-CDE5                        27500000
275100                              DK-TYPE-CDE4                        27510000
275200                              DK-TYPE-CDE3                        27520000
275300                              DK-TYPE-CDE2                        27530000
275400                MOVE PC-SH TO DK-TYPE-CDE1                        27540000
275500         ELSE                                                     27550000
275600         IF DK-SHUTTLE = SPACES AND DK-SHIPPING > SPACES AND      27560000
275700            DK-RECEIVING = SPACES AND DK-STORAGE = SPACES AND     27570000
275800            DK-STRIPPING = SPACES AND DK-YARD = SPACES            27580000
275900                MOVE PC-SH TO DK-TYPE-CDE8                        27590000
276000                              DK-TYPE-CDE7                        27600000
276100                              DK-TYPE-CDE6                        27610000
276200                              DK-TYPE-CDE5                        27620000
276300                              DK-TYPE-CDE4                        27630000
276400                              DK-TYPE-CDE3                        27640000
276500                              DK-TYPE-CDE2                        27650000
276600                              DK-TYPE-CDE1                        27660000
276700         ELSE                                                     27670000
276800         IF DK-SHUTTLE = SPACES AND DK-SHIPPING = SPACES AND      27680000
276900            DK-RECEIVING > SPACES AND DK-STORAGE > SPACES AND     27690000
277000            DK-STRIPPING > SPACES AND DK-YARD > SPACES            27700000
277100                MOVE PC-YD TO DK-TYPE-CDE8                        27710000
277200                              DK-TYPE-CDE7                        27720000
277300                              DK-TYPE-CDE6                        27730000
277400                              DK-TYPE-CDE5                        27740000
277500                              DK-TYPE-CDE4                        27750000
277600                MOVE PC-SG TO DK-TYPE-CDE3                        27760000
277700                MOVE PC-ST TO DK-TYPE-CDE2                        27770000
277800                MOVE PC-RC TO DK-TYPE-CDE1                        27780000
277900         ELSE                                                     27790000
278000         IF DK-SHUTTLE = SPACES AND DK-SHIPPING = SPACES AND      27800000
278100            DK-RECEIVING > SPACES AND DK-STORAGE > SPACES AND     27810000
278200            DK-STRIPPING > SPACES AND DK-YARD = SPACES            27820000
278300                MOVE PC-SG TO DK-TYPE-CDE8                        27830000
278400                              DK-TYPE-CDE7                        27840000
278500                              DK-TYPE-CDE6                        27850000
278600                              DK-TYPE-CDE5                        27860000
278700                              DK-TYPE-CDE4                        27870000
278800                              DK-TYPE-CDE3                        27880000
278900                MOVE PC-ST TO DK-TYPE-CDE2                        27890000
279000                MOVE PC-RC TO DK-TYPE-CDE1                        27900000
279100         ELSE                                                     27910000
279200         IF DK-SHUTTLE = SPACES AND DK-SHIPPING = SPACES AND      27920000
279300            DK-RECEIVING > SPACES AND DK-STORAGE > SPACES AND     27930000
279400            DK-STRIPPING = SPACES AND DK-YARD > SPACES            27940000
279500                MOVE PC-YD TO DK-TYPE-CDE8                        27950000
279600                              DK-TYPE-CDE7                        27960000
279700                              DK-TYPE-CDE6                        27970000
279800                              DK-TYPE-CDE5                        27980000
279900                              DK-TYPE-CDE4                        27990000
280000                              DK-TYPE-CDE3                        28000000
280100                MOVE PC-ST TO DK-TYPE-CDE2                        28010000
280200                MOVE PC-RC TO DK-TYPE-CDE1                        28020000
280300         ELSE                                                     28030000
280400         IF DK-SHUTTLE = SPACES AND DK-SHIPPING = SPACES AND      28040000
280500            DK-RECEIVING > SPACES AND DK-STORAGE > SPACES AND     28050000
280600            DK-STRIPPING = SPACES AND DK-YARD = SPACES            28060000
280700                MOVE PC-ST TO DK-TYPE-CDE8                        28070000
280800                              DK-TYPE-CDE7                        28080000
280900                              DK-TYPE-CDE6                        28090000
281000                              DK-TYPE-CDE5                        28100000
281100                              DK-TYPE-CDE4                        28110000
281200                              DK-TYPE-CDE3                        28120000
281300                              DK-TYPE-CDE2                        28130000
281400                MOVE PC-RC TO DK-TYPE-CDE1                        28140000
281500         ELSE                                                     28150000
281600        IF DK-SHUTTLE = SPACES AND DK-SHIPPING = SPACES AND       28160000
281700            DK-RECEIVING > SPACES AND DK-STORAGE = SPACES AND     28170000
281800            DK-STRIPPING > SPACES AND DK-YARD > SPACES            28180000
281900                MOVE PC-YD TO DK-TYPE-CDE8                        28190000
282000                              DK-TYPE-CDE7                        28200000
282100                              DK-TYPE-CDE6                        28210000
282200                              DK-TYPE-CDE5                        28220000
282300                              DK-TYPE-CDE4                        28230000
282400                              DK-TYPE-CDE3                        28240000
282500                MOVE PC-SG TO DK-TYPE-CDE2                        28250000
282600                MOVE PC-RC TO DK-TYPE-CDE1                        28260000
282700         ELSE                                                     28270000
282800        IF DK-SHUTTLE = SPACES AND DK-SHIPPING = SPACES AND       28280000
282900            DK-RECEIVING > SPACES AND DK-STORAGE = SPACES AND     28290000
283000            DK-STRIPPING > SPACES AND DK-YARD = SPACES            28300000
283100                MOVE PC-SG TO DK-TYPE-CDE8                        28310000
283200                              DK-TYPE-CDE7                        28320000
283300                              DK-TYPE-CDE6                        28330000
283400                              DK-TYPE-CDE5                        28340000
283500                              DK-TYPE-CDE4                        28350000
283600                              DK-TYPE-CDE3                        28360000
283700                              DK-TYPE-CDE2                        28370000
283800                MOVE PC-RC TO DK-TYPE-CDE1                        28380000
283900         ELSE                                                     28390000
284000         IF DK-SHUTTLE = SPACES AND DK-SHIPPING = SPACES AND      28400000
284100            DK-RECEIVING > SPACES AND DK-STORAGE = SPACES AND     28410000
284200            DK-STRIPPING = SPACES AND DK-YARD > SPACES            28420000
284300                MOVE PC-YD TO DK-TYPE-CDE8                        28430000
284400                              DK-TYPE-CDE7                        28440000
284500                              DK-TYPE-CDE6                        28450000
284600                              DK-TYPE-CDE5                        28460000
284700                              DK-TYPE-CDE4                        28470000
284800                              DK-TYPE-CDE3                        28480000
284900                              DK-TYPE-CDE2                        28490000
285000                MOVE PC-RC TO DK-TYPE-CDE1                        28500000
285100         ELSE                                                     28510000
285200         IF DK-SHUTTLE = SPACES AND DK-SHIPPING = SPACES AND      28520000
285300            DK-RECEIVING > SPACES AND DK-STORAGE = SPACES AND     28530000
285400            DK-STRIPPING = SPACES AND DK-YARD = SPACES            28540000
285500                MOVE PC-RC TO DK-TYPE-CDE8                        28550000
285600                              DK-TYPE-CDE7                        28560000
285700                              DK-TYPE-CDE6                        28570000
285800                              DK-TYPE-CDE5                        28580000
285900                              DK-TYPE-CDE4                        28590000
286000                              DK-TYPE-CDE3                        28600000
286100                              DK-TYPE-CDE2                        28610000
286200                              DK-TYPE-CDE1                        28620000
286300         ELSE                                                     28630000
286400         IF DK-SHUTTLE = SPACES AND DK-SHIPPING = SPACES AND      28640000
286500            DK-RECEIVING = SPACES AND DK-STORAGE > SPACES AND     28650000
286600            DK-STRIPPING > SPACES AND DK-YARD > SPACES            28660000
286700                MOVE PC-YD TO DK-TYPE-CDE8                        28670000
286800                              DK-TYPE-CDE7                        28680000
286900                              DK-TYPE-CDE6                        28690000
287000                              DK-TYPE-CDE5                        28700000
287100                              DK-TYPE-CDE4                        28710000
287200                              DK-TYPE-CDE3                        28720000
287300                MOVE PC-SG TO DK-TYPE-CDE2                        28730000
287400                MOVE PC-ST TO DK-TYPE-CDE1                        28740000
287500         ELSE                                                     28750000
287600         IF DK-SHUTTLE = SPACES AND DK-SHIPPING = SPACES AND      28760000
287700            DK-RECEIVING = SPACES AND DK-STORAGE > SPACES AND     28770000
287800            DK-STRIPPING > SPACES AND DK-YARD = SPACES            28780000
287900                MOVE PC-SG TO DK-TYPE-CDE8                        28790000
288000                              DK-TYPE-CDE7                        28800000
288100                              DK-TYPE-CDE6                        28810000
288200                              DK-TYPE-CDE5                        28820000
288300                              DK-TYPE-CDE4                        28830000
288400                              DK-TYPE-CDE3                        28840000
288500                              DK-TYPE-CDE2                        28850000
288600                MOVE PC-ST TO DK-TYPE-CDE1                        28860000
288700         ELSE                                                     28870000
288800         IF DK-SHUTTLE = SPACES AND DK-SHIPPING = SPACES AND      28880000
288900            DK-RECEIVING = SPACES AND DK-STORAGE > SPACES AND     28890000
289000            DK-STRIPPING = SPACES AND DK-YARD > SPACES            28900000
289100                MOVE PC-YD TO DK-TYPE-CDE8                        28910000
289200                              DK-TYPE-CDE7                        28920000
289300                              DK-TYPE-CDE6                        28930000
289400                              DK-TYPE-CDE5                        28940000
289500                              DK-TYPE-CDE4                        28950000
289600                              DK-TYPE-CDE3                        28960000
289700                              DK-TYPE-CDE2                        28970000
289800                MOVE PC-ST TO DK-TYPE-CDE1                        28980000
289900         ELSE                                                     28990000
290000         IF DK-SHUTTLE = SPACES AND DK-SHIPPING = SPACES AND      29000000
290100            DK-RECEIVING = SPACES AND DK-STORAGE > SPACES AND     29010000
290200            DK-STRIPPING = SPACES AND DK-YARD = SPACES            29020000
290300                MOVE PC-ST TO DK-TYPE-CDE8                        29030000
290400                              DK-TYPE-CDE7                        29040000
290500                              DK-TYPE-CDE6                        29050000
290600                              DK-TYPE-CDE5                        29060000
290700                              DK-TYPE-CDE4                        29070000
290800                              DK-TYPE-CDE3                        29080000
290900                              DK-TYPE-CDE2                        29090000
291000                              DK-TYPE-CDE1                        29100000
291100         ELSE                                                     29110000
291200         IF DK-SHUTTLE = SPACES AND DK-SHIPPING = SPACES AND      29120000
291300            DK-RECEIVING = SPACES AND DK-STORAGE = SPACES AND     29130000
291400            DK-STRIPPING > SPACES AND DK-YARD > SPACES            29140000
291500                MOVE PC-YD TO DK-TYPE-CDE8                        29150000
291600                              DK-TYPE-CDE7                        29160000
291700                              DK-TYPE-CDE6                        29170000
291800                              DK-TYPE-CDE5                        29180000
291900                              DK-TYPE-CDE4                        29190000
292000                              DK-TYPE-CDE3                        29200000
292100                              DK-TYPE-CDE2                        29210000
292200                MOVE PC-SG TO DK-TYPE-CDE1                        29220000
292300         ELSE                                                     29230000
292400         IF DK-SHUTTLE = SPACES AND DK-SHIPPING = SPACES AND      29240000
292500            DK-RECEIVING = SPACES AND DK-STORAGE = SPACES AND     29250000
292600            DK-STRIPPING > SPACES AND DK-YARD = SPACES            29260000
292700                MOVE PC-SG TO DK-TYPE-CDE8                        29270000
292800                              DK-TYPE-CDE7                        29280000
292900                              DK-TYPE-CDE6                        29290000
293000                              DK-TYPE-CDE5                        29300000
293100                              DK-TYPE-CDE4                        29310000
293200                              DK-TYPE-CDE3                        29320000
293300                              DK-TYPE-CDE2                        29330000
293400                              DK-TYPE-CDE1                        29340000
293500         ELSE                                                     29350000
293600         IF DK-SHUTTLE = SPACES AND DK-SHIPPING = SPACES AND      29360000
293700            DK-RECEIVING = SPACES AND DK-STORAGE = SPACES AND     29370000
293800            DK-STRIPPING = SPACES AND DK-YARD > SPACES            29380000
293900                MOVE PC-YD TO DK-TYPE-CDE8                        29390000
294000                              DK-TYPE-CDE7                        29400000
294100                              DK-TYPE-CDE6                        29410000
294200                              DK-TYPE-CDE5                        29420000
294300                              DK-TYPE-CDE4                        29430000
294400                              DK-TYPE-CDE3                        29440000
294500                              DK-TYPE-CDE2                        29450000
294600                              DK-TYPE-CDE1                        29460000
294700     END-IF.                                                      29470000
294800                                                                  29480000
294810     PERFORM 4101-LOAD-STAT-CDES.                                 29481013
294900*----------------------------------------------------------------*29490000
295000*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *29500000
295100*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *29510000
295200*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *29520000
295300*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *29530000
295400*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *29540000
295500*                                                                *29550000
295600*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *29560000
295700*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *29570000
295800*    UPON INITIALIZATION.                                        *29580000
295900*----------------------------------------------------------------*29590000
296000 4300-READ-ITEMS-FROM-DB.                                         29600000
296100                                                                  29610000
296200     PERFORM                                                      29620000
296300         VARYING PV-READ-COUNT                                    29630000
296400         FROM 1 BY 1                                              29640000
296500         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    29650000
296600            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         29660000
296700                                                                  29670000
296800         PERFORM 4310-FETCH                                       29680000
296900                                                                  29690000
297000         IF  ASC-ITEMS-LEFT-ON-DB                                 29700000
297100             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                29710000
297200                 ADD +1            TO ASC-ITEM-SUB                29720000
297300             ELSE                                                 29730000
297400                 ADD +1            TO ASC-BLK-SUB                 29740000
297500                 MOVE +1           TO ASC-ITEM-SUB                29750000
297600                                                                  29760000
297700                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         29770000
297800                     MOVE +1       TO ASC-BLK-SUB                 29780000
297900                     SET ASC-BLOCK-MODIFIED (1) TO TRUE           29790000
298000                     PERFORM 5100-WRITE-TEMP-STORAGE              29800000
298100                     MOVE ASC-BLOCK-ENTRIES                       29810000
298200                                   (PC-MAX-BLOCKS-IN-ARRAY)       29820000
298300                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 29830000
298400                     ADD +1        TO ASC-BLK-SUB                 29840000
298500                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   29850000
298600                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      29860000
298700                                                          TO TRUE 29870000
298800                 END-IF                                           29880000
298900             END-IF                                               29890000
299000             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    29900000
299100             SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB) TO TRUE          29910000
299200             MOVE ASC-NUMBER-OF-ITEMS-READ                        29920000
299300                                   TO ASC-LIST-ITEM-NUMBER        29930000
299400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  29940000
299500             MOVE SUOBTS-DOOR-ID                                  29950000
299600                        TO ASC-DOORID (ASC-BLK-SUB ASC-ITEM-SUB)  29960000
299610             MOVE SUOBTS-TRIP-STAT-CDE                            29961002
299620                   TO ASC-TRIP-STATUS (ASC-BLK-SUB ASC-ITEM-SUB)  29962002
299700             MOVE CNDCDR-DOOR-TYP-CDE                             29970000
299800                     TO ASC-DOORTYPE (ASC-BLK-SUB ASC-ITEM-SUB)   29980000
299900             MOVE CNDCDR-DOOR-LOC-DESC                            29990000
300000                   TO ASC-DESCRIPTION (ASC-BLK-SUB ASC-ITEM-SUB)  30000000
300100             MOVE SUOBTR-TRLR-SRL-NBR                             30010000
300200                   TO ASC-TRLR-SRL-NBR (ASC-BLK-SUB ASC-ITEM-SUB) 30020000
300300             MOVE CNTRID-SCAC-CDE                                 30030000
300400                           TO ASC-SCAC (ASC-BLK-SUB ASC-ITEM-SUB) 30040000
300500             MOVE SUOBTS-OTBND-TRIP-ID                            30050000
300600                        TO ASC-TRIP-ID (ASC-BLK-SUB ASC-ITEM-SUB) 30060000
300700             MOVE CNTRID-TRLR-ID                                  30070000
300800                      TO ASC-TRLR-NBR (ASC-BLK-SUB ASC-ITEM-SUB)  30080000
300900             MOVE PV-USA-DATE                                     30090000
301000                   TO ASC-DATEASGN (ASC-BLK-SUB ASC-ITEM-SUB)     30100000
301100             MOVE SUOBTR-DEST-OPER-UNT-ID                         30110000
301200                   TO ASC-DEST-NBR (ASC-BLK-SUB ASC-ITEM-SUB)     30120000
301300         END-IF                                                   30130000
301400     END-PERFORM.                                                 30140000
301500                                                                  30150000
301600     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          30160000
301700         MOVE +1               TO ASC-BLK-SUB                     30170000
301800         PERFORM 5100-WRITE-TEMP-STORAGE                          30180000
301900         ADD +1                TO ASC-BLK-SUB                     30190000
302000         PERFORM 5100-WRITE-TEMP-STORAGE                          30200000
302100                                                                  30210000
302200         MOVE 1                TO ASC-BLK-SUB                     30220000
302300                                  PV-BLOCK-NUMBER                 30230000
302400         PERFORM 4410-READ-TEMP-STORAGE                           30240000
302500         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             30250000
302600             MOVE 2            TO ASC-BLK-SUB                     30260000
302700                                  PV-BLOCK-NUMBER                 30270000
302800             PERFORM 4410-READ-TEMP-STORAGE                       30280000
302900         END-IF                                                   30290000
303000     END-IF.                                                      30300000
303100                                                                  30310000
303200*----------------------------------------------------------------*30320000
303300*    FETCH THE CURSOR                                             30330000
303400*----------------------------------------------------------------*30340000
303500 4310-FETCH.                                                      30350000
303600     EVALUATE TRUE                                                30360000
303700         WHEN PS-OPER-UNT-CSR                                     30370000
303710             IF ASC-DOOR-SEQ                                      30371013
303800                 EXEC SQL                                         30380000
303900                      FETCH OPER-UNT-CSR                          30390000
304000                     INTO :SUOBTS-OTBND-TRIP-ID                   30400000
304100                         ,:SUOBTS-DOOR-ID                         30410000
304110                         ,:SUOBTS-TRIP-STAT-CDE                   30411002
304200                         ,:SUOBTR-DEST-OPER-UNT-ID                30420000
304300                         ,:SUOBTR-TRLR-SRL-NBR                    30430000
304400                         ,:CNTRID-SCAC-CDE                        30440000
304500                         ,:CNTRID-TRLR-ID                         30450000
304600                         ,:CNDCDR-DOOR-TYP-CDE                    30460000
304700                         ,:CNDCDR-DOOR-LOC-DESC                   30470000
304800                 END-EXEC                                         30480000
304801             ELSE                                                 30480113
304802                 EXEC SQL                                         30480200
304803                      FETCH OPER-UNT-CSR-ALT                      30480300
304804                     INTO :SUOBTS-OTBND-TRIP-ID                   30480400
304805                         ,:SUOBTS-DOOR-ID                         30480500
304806                         ,:SUOBTS-TRIP-STAT-CDE                   30480602
304807                         ,:SUOBTR-DEST-OPER-UNT-ID                30480700
304808                         ,:SUOBTR-TRLR-SRL-NBR                    30480800
304809                         ,:CNTRID-SCAC-CDE                        30480900
304810                         ,:CNTRID-TRLR-ID                         30481000
304811                         ,:CNDCDR-DOOR-TYP-CDE                    30481100
304812                         ,:CNDCDR-DOOR-LOC-DESC                   30481200
304813                 END-EXEC                                         30481300
304814             END-IF                                               30481413
304900                                                                  30490000
305000         WHEN PS-DOOR-ID-CSR                                      30500000
305010             IF ASC-DOOR-SEQ                                      30501013
305100                 EXEC SQL                                         30510000
305200                      FETCH DOOR-ID-CSR                           30520000
305300                     INTO :SUOBTS-OTBND-TRIP-ID                   30530000
305400                         ,:SUOBTS-DOOR-ID                         30540000
305410                         ,:SUOBTS-TRIP-STAT-CDE                   30541002
305500                         ,:SUOBTR-DEST-OPER-UNT-ID                30550000
305600                         ,:SUOBTR-TRLR-SRL-NBR                    30560000
305700                         ,:CNTRID-SCAC-CDE                        30570000
305800                         ,:CNTRID-TRLR-ID                         30580000
305900                         ,:CNDCDR-DOOR-TYP-CDE                    30590000
306000                         ,:CNDCDR-DOOR-LOC-DESC                   30600000
306100                 END-EXEC                                         30610000
306200             ELSE                                                 30620000
306201                 EXEC SQL                                         30620113
306202                      FETCH DOOR-ID-CSR-ALT                       30620200
306203                     INTO :SUOBTS-OTBND-TRIP-ID                   30620300
306204                         ,:SUOBTS-DOOR-ID                         30620400
306205                         ,:SUOBTS-TRIP-STAT-CDE                   30620502
306206                         ,:SUOBTR-DEST-OPER-UNT-ID                30620600
306207                         ,:SUOBTR-TRLR-SRL-NBR                    30620700
306208                         ,:CNTRID-SCAC-CDE                        30620800
306209                         ,:CNTRID-TRLR-ID                         30620900
306210                         ,:CNDCDR-DOOR-TYP-CDE                    30621000
306211                         ,:CNDCDR-DOOR-LOC-DESC                   30621100
306212                 END-EXEC                                         30621200
306213             END-IF                                               30621313
306214                                                                  30621400
306300         WHEN PS-DOOR-TYPE-CSR                                    30630000
306310             IF ASC-DOOR-SEQ                                      30631013
306400                 EXEC SQL                                         30640000
306500                      FETCH DOOR-TYPE-CSR                         30650000
306600                     INTO :SUOBTS-OTBND-TRIP-ID                   30660000
306700                         ,:SUOBTS-DOOR-ID                         30670000
306710                         ,:SUOBTS-TRIP-STAT-CDE                   30671002
306800                         ,:SUOBTR-DEST-OPER-UNT-ID                30680000
306900                         ,:SUOBTR-TRLR-SRL-NBR                    30690000
307000                         ,:CNTRID-SCAC-CDE                        30700000
307100                         ,:CNTRID-TRLR-ID                         30710000
307200                         ,:CNDCDR-DOOR-TYP-CDE                    30720000
307300                         ,:CNDCDR-DOOR-LOC-DESC                   30730000
307400                 END-EXEC                                         30740000
307500             ELSE                                                 30750000
307501                 EXEC SQL                                         30750113
307502                      FETCH DOOR-TYPE-CSR-ALT                     30750200
307503                     INTO :SUOBTS-OTBND-TRIP-ID                   30750300
307504                         ,:SUOBTS-DOOR-ID                         30750400
307505                         ,:SUOBTS-TRIP-STAT-CDE                   30750502
307506                         ,:SUOBTR-DEST-OPER-UNT-ID                30750600
307507                         ,:SUOBTR-TRLR-SRL-NBR                    30750700
307508                         ,:CNTRID-SCAC-CDE                        30750800
307509                         ,:CNTRID-TRLR-ID                         30750900
307510                         ,:CNDCDR-DOOR-TYP-CDE                    30751000
307511                         ,:CNDCDR-DOOR-LOC-DESC                   30751100
307512                 END-EXEC                                         30751200
307513             END-IF                                               30751313
307514                                                                  30751400
307600     END-EVALUATE.                                                30760000
307700                                                                  30770000
307800     EVALUATE TRUE                                                30780000
307900         WHEN SQLCODE = ZERO                                      30790000
308000             EXEC SQL                                             30800000
308100                SELECT CHAR(DATE(MIN(OTBND_STAT_TMST)),USA)       30810000
308200                      INTO :PV-USA-DATE                           30820000
308300                         FROM TSUOBTS                             30830000
308400                 WHERE OTBND_TRIP_ID     =  :SUOBTS-OTBND-TRIP-ID 30840000
308500             END-EXEC                                             30850000
308600         WHEN SQLCODE = +100                                      30860000
308700              CONTINUE                                            30870000
308800         WHEN SQLWARN0 NOT = SPACE                                30880000
308900         WHEN SQLCODE NOT = ZERO                                  30890000
309000              MOVE '4310-FETCH-CURSOR' TO DP013-PARAGRAPH         30900000
309100              MOVE 'FETCH CURSOR PROBLEM '                        30910000
309200                               TO DP013-MESSAGE-TEXT (1)          30920000
309300              MOVE SQLCA       TO DP013-SQLCA                     30930000
309400              MOVE 'TSUOBTR '   TO DP013-DB2-TABLE-NAME (1)       30940000
309500              SET DP013-DB2-ABEND TO TRUE                         30950000
309600              PERFORM DP013-0000-PROCESS-ABEND                    30960000
309700     END-EVALUATE.                                                30970000
309800                                                                  30980000
309900     IF  SQLCODE EQUAL +100                                       30990000
310000         SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                      31000000
310100     END-IF.                                                      31010000
310200                                                                  31020000
310300*----------------------------------------------------------------*31030000
310400* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *31040000
310500*----------------------------------------------------------------*31050000
310600 4400-MOVE-COMMAREA-TO-SCREEN.                                    31060000
310700     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             31070000
310800         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          31080000
310900         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          31090000
311000             MOVE +1    TO ASC-BLK-SUB                            31100000
311100             PERFORM 5100-WRITE-TEMP-STORAGE                      31110000
311200             ADD +1     TO ASC-BLK-SUB                            31120000
311300             PERFORM 5100-WRITE-TEMP-STORAGE                      31130000
311400             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             31140000
311500                 GIVING PV-BLOCK-NUMBER                           31150000
311600                 REMAINDER PV-REMAINDER                           31160000
311700             IF  PV-REMAINDER > ZERO                              31170000
311800                 ADD +1 TO PV-BLOCK-NUMBER                        31180000
311900             END-IF                                               31190000
312000             MOVE +1    TO ASC-BLK-SUB                            31200000
312100             PERFORM 4410-READ-TEMP-STORAGE                       31210000
312200             ADD +1     TO ASC-BLK-SUB                            31220000
312300                           PV-BLOCK-NUMBER                        31230000
312400             PERFORM 4410-READ-TEMP-STORAGE                       31240000
312500     END-IF.                                                      31250000
312600     MOVE +1            TO ASC-BLK-SUB.                           31260000
312700     COMPUTE ASC-ITEM-SUB =                                       31270000
312800         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              31280000
312900         + PC-ITEMS-PER-PANEL).                                   31290000
313000*                                                                 31300000
313100     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        31310000
313200         ADD +1         TO ASC-BLK-SUB                            31320000
313300         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            31330000
313400     END-IF.                                                      31340000
313500*                                                                 31350000
313600     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           31360000
313700         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                31370000
313800     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        31380000
313900     PERFORM 4420-FORMAT-LIST-LINES                               31390000
314000         VARYING PV-SUB                                           31400000
314100         FROM PC-ITEMS-PER-PANEL BY -1                            31410000
314200         UNTIL PV-SUB < +1.                                       31420000
314300*                                                                 31430000
314400     COMPUTE ASC-ITEMS-DISPLAYED =                                31440000
314500         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          31450000
314600     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    31460000
314700                                      ASTRTITO.                   31470000
314800     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    31480000
314900     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    31490000
315000     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            31500000
315100                                   TO ASELITO.                    31510000
315200                                                                  31520000
315300     MOVE ASC-OPER-UNT-ID            TO AOPERO.                   31530000
315400     MOVE ASC-OPER-UNT-NAME          TO AOPRNMEO.                 31540000
315500                                                                  31550000
315600     IF  DP020-MSG-NUMBER-X = SPACE                               31560000
315700         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  31570000
315800*            --- MORE ITEMS TO DISPLAY ----                       31580000
315900             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            31590000
316000             SET DP020-MSG-INFORMATIONAL TO TRUE                  31600000
316100         END-IF                                                   31610000
316200     END-IF.                                                      31620000
316300                                                                  31630000
316400*----------------------------------------------------------------*31640000
316500*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *31650000
316600*----------------------------------------------------------------*31660000
316700 4410-READ-TEMP-STORAGE.                                          31670000
316800                                                                  31680000
316900     EXEC CICS                                                    31690000
317000         READQ TS                                                 31700000
317100             QUEUE (ASC-LIST-QUEUE-NAME)                          31710000
317200             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               31720000
317300             ITEM  (PV-BLOCK-NUMBER)                              31730000
317400             RESP  (PV-CICS-RESP)                                 31740000
317500     END-EXEC.                                                    31750000
317600                                                                  31760000
317700     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       31770000
317800       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     31780000
317900         CONTINUE                                                 31790000
318000     ELSE                                                         31800000
318100         SET DP013-CICS-ABEND     TO TRUE                         31810000
318200         SET DP013-NO-ROLLBACK    TO TRUE                         31820000
318300         MOVE '4410-READ-TEMP-STORAGE'                            31830000
318400                                  TO DP013-PARAGRAPH              31840000
318500         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      31850000
318600                                  TO DP013-MESSAGE-TEXT(1)        31860000
318700         PERFORM DP013-0000-PROCESS-ABEND                         31870000
318800     END-IF.                                                      31880000
318900                                                                  31890000
319000     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             31900000
319100*                                                                 31910000
319200     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         31920000
319300         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               31930000
319400     END-IF.                                                      31940000
319500                                                                  31950000
319600*----------------------------------------------------------------*31960000
319700*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *31970000
319800*----------------------------------------------------------------*31980000
319900 4420-FORMAT-LIST-LINES.                                          31990000
320000     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      32000000
320100         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                32010000
320200         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           32020000
320300         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           32030000
320400         MOVE SPACE              TO MR-SELECTI (PV-SUB)           32040000
320500                                    MR-ACTION (PV-SUB)            32050000
320600                                    MR-DOOR-ID (PV-SUB)           32060000
320700                                    MR-DOOR-TYPE (PV-SUB)         32070000
320800                                    MR-DESCRIPTION (PV-SUB)       32080000
320900                                    MR-TRLR-SRL-NBR (PV-SUB)      32090000
321000                                    MR-SCAC-CDE (PV-SUB)          32100000
321100                                    MR-TRLR-NBR (PV-SUB)          32110000
321200                                    MR-TRIP-ID (PV-SUB)           32120000
321210                                    MR-TRIP-STATUS (PV-SUB)       32121004
321300                                    MR-DATE-ASGN (PV-SUB)         32130000
321400                                    MR-DEST-NBR (PV-SUB)          32140000
321500     ELSE                                                         32150000
321600         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      32160000
321700                                                   > SPACE        32170000
321800             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 32180000
321900                                 TO MR-SELECTI (PV-SUB)           32190000
322000         ELSE                                                     32200000
322100             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      32210000
322200                                 TO MR-SELECTI (PV-SUB)           32220000
322300         END-IF                                                   32230000
322400         IF  DP030-SET-CURSOR-TRAILER                             32240000
322500             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)32250000
322600                 > SPACE)                                         32260000
322700               OR (PV-SUB = 1))                                   32270000
322800                SET DP030-SET-CURSOR-APPL-1 TO TRUE               32280000
322900                MOVE -1               TO MR-SELECTL (PV-SUB)      32290000
323000             END-IF                                               32300000
323100         END-IF                                                   32310000
323200*                                                                 32320000
323300         MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)               32330000
323400                                            TO MR-ACTION (PV-SUB) 32340000
323500         MOVE ASC-DOORID (ASC-BLK-SUB ASC-ITEM-SUB)               32350000
323600                                           TO MR-DOOR-ID (PV-SUB) 32360000
323700         MOVE ASC-DOORTYPE (ASC-BLK-SUB ASC-ITEM-SUB)             32370000
323800                                         TO MR-DOOR-TYPE (PV-SUB) 32380000
323900         MOVE ASC-DESCRIPTION (ASC-BLK-SUB ASC-ITEM-SUB)          32390000
324000                                       TO MR-DESCRIPTION (PV-SUB) 32400000
324100         MOVE ASC-TRLR-SRL-NBR (ASC-BLK-SUB ASC-ITEM-SUB)         32410000
324200                                      TO MR-TRLR-SRL-NBR (PV-SUB) 32420000
324300         MOVE ASC-SCAC (ASC-BLK-SUB ASC-ITEM-SUB)                 32430000
324400                                          TO MR-SCAC-CDE (PV-SUB) 32440000
324500         MOVE ASC-TRLR-NBR (ASC-BLK-SUB ASC-ITEM-SUB)             32450000
324600                                          TO MR-TRLR-NBR (PV-SUB) 32460000
324700         MOVE ASC-TRIP-ID (ASC-BLK-SUB ASC-ITEM-SUB)              32470000
324800                                           TO MR-TRIP-ID (PV-SUB) 32480000
324810         MOVE ASC-TRIP-STATUS (ASC-BLK-SUB ASC-ITEM-SUB)          32481004
324820                                       TO MR-TRIP-STATUS (PV-SUB) 32482004
324900         MOVE ASC-DATEASGN (ASC-BLK-SUB ASC-ITEM-SUB)             32490000
325000                                         TO MR-DATE-ASGN (PV-SUB) 32500000
325100         MOVE ASC-DEST-NBR (ASC-BLK-SUB ASC-ITEM-SUB)             32510000
325200                                          TO MR-DEST-NBR (PV-SUB) 32520000
325300     END-IF.                                                      32530000
325400     SUBTRACT +1 FROM ASC-ITEM-SUB                                32540000
325500     IF  ASC-ITEM-SUB < + 1                                       32550000
325600         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  32560000
325700         MOVE +1                 TO ASC-BLK-SUB                   32570000
325800     END-IF.                                                      32580000
325900                                                                  32590000
326000******************************************************************32600000
326100** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **32610000
326200** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **32620000
326300** ISSUE A WARNING.                                             **32630000
326400******************************************************************32640000
326500 4430-CHECK-FOR-BEGIN-AND-END.                                    32650000
326600     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       32660000
326700         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     32670000
326800*            -- NO END-OF-RANGE SPECFIED ---                      32680000
326900             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            32690000
327000             SET DP020-MSG-WARNING TO TRUE                        32700000
327100             PERFORM 4431-POSITION-AT-WARNING                     32710000
327200         END-IF                                                   32720000
327300     ELSE                                                         32730000
327400         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     32740000
327500*            -- NO BEGINNING-OF-RANGE SPECFIED ---                32750000
327600             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            32760000
327700             SET DP020-MSG-WARNING TO TRUE                        32770000
327800             PERFORM 4431-POSITION-AT-WARNING                     32780000
327900         END-IF                                                   32790000
328000     END-IF.                                                      32800000
328100******************************************************************32810000
328200** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **32820000
328300** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **32830000
328400** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **32840000
328500** POSITION THE CURSOR THERE.                                   **32850000
328600******************************************************************32860000
328700 4431-POSITION-AT-WARNING.                                        32870000
328800     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 32880000
328900                    - PV-TOP-ITEM + 1.                            32890000
329000     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      32900000
329100         CONTINUE                                                 32910000
329200     ELSE                                                         32920000
329300         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      32930000
329400         MOVE -1                   TO MR-SELECTL (PV-SUB)         32940000
329500         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         32950000
329600         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         32960000
329700     END-IF.                                                      32970000
329800*                                                                 32980000
329900     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   32990000
330000                    - PV-TOP-ITEM + 1.                            33000000
330100     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      33010000
330200         CONTINUE                                                 33020000
330300     ELSE                                                         33030000
330400         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      33040000
330500         MOVE -1                   TO MR-SELECTL (PV-SUB)         33050000
330600         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         33060000
330700         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         33070000
330800     END-IF.                                                      33080000
330900                                                                  33090000
331000*----------------------------------------------------------------*33100000
331100* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *33110000
331200* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *33120000
331300* FOR THE SELECTED ITEMS QUEUE.                                  *33130000
331400*                                                                *33140000
331500* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *33150000
331600* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *33160000
331700* THE ARRAY IS FULL.                                             *33170000
331800*----------------------------------------------------------------*33180000
331900 5000-PREPARE-SEL-QUEUE.                                          33190000
332000                                                                  33200000
332100     MOVE +1                   TO  ASC-BLK-SUB.                   33210000
332200     PERFORM 5100-WRITE-TEMP-STORAGE.                             33220000
332300     ADD +1                    TO  ASC-BLK-SUB.                   33230000
332400     PERFORM 5100-WRITE-TEMP-STORAGE.                             33240000
332500                                                                  33250000
332600     MOVE ASC-SEL-QUEUE-NAME   TO  SU009-SEL-QUEUE-NAME.          33260000
332700     PERFORM 6010-DELETE-SEL-QUEUE.                               33270000
332800                                                                  33280000
332900     SET ASC-UPDATE-TSQ        TO  TRUE.                          33290000
333000                                                                  33300000
333100     SET SU010-IDX             TO  1.                             33310000
333200     MOVE ZERO                 TO SU009-NUMBER-OF-TS-ITEMS.       33320000
333300     INITIALIZE SU010-SELECTED-ITEM-ARRAY.                        33330000
333400                                                                  33340000
333500     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           33350000
333600             VARYING PV-ITEM                                      33360000
333700             FROM 1 BY 1                                          33370000
333800             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     33380000
333900                                                                  33390000
334000     IF  SU010-IDX > 1                                            33400000
334100         PERFORM 5205-WRITE-SEL-QUEUE                             33410000
334200         ADD +1                TO SU009-NUMBER-OF-TS-ITEMS        33420000
334300     END-IF.                                                      33430000
334400*----------------------------------------------------------------*33440000
334500*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *33450000
334600*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *33460000
334700*----------------------------------------------------------------*33470000
334800 5100-WRITE-TEMP-STORAGE.                                         33480000
334900     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     33490000
335000                                   TO PV-LIST-ITEM-NUMBER.        33500000
335100     COMPUTE PV-BLOCK-NUMBER =                                    33510000
335200         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    33520000
335300                                                                  33530000
335400     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             33540000
335500     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             33550000
335600         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      33560000
335700             PERFORM 5105-REWRITE-ASC-LISTQ                       33570000
335800         END-IF                                                   33580000
335900     ELSE                                                         33590000
336000         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       33600000
336100         ASC-HIGHEST-BLOCK-WRITTEN + 1                            33610000
336200         PERFORM 5110-WRITE-ASC-LISTQ                             33620000
336300         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   33630000
336400     END-IF.                                                      33640000
336500                                                                  33650000
336600     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             33660000
336700                                                                  33670000
336800******************************************************************33680000
336900** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **33690000
337000** SPECIFIC COMMAREA.                                           **33700000
337100******************************************************************33710000
337200 5105-REWRITE-ASC-LISTQ.                                          33720000
337300     EXEC CICS                                                    33730000
337400         WRITEQ TS                                                33740000
337500             QUEUE (ASC-LIST-QUEUE-NAME)                          33750000
337600             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               33760000
337700             ITEM  (PV-BLOCK-NUMBER)                              33770000
337800             REWRITE                                              33780000
337900             RESP  (PV-CICS-RESP)                                 33790000
338000     END-EXEC.                                                    33800000
338100                                                                  33810000
338200     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           33820000
338300         CONTINUE                                                 33830000
338400     ELSE                                                         33840000
338500         SET DP013-CICS-ABEND            TO TRUE                  33850000
338600         SET DP013-NO-ROLLBACK           TO TRUE                  33860000
338700         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       33870000
338800         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     33880000
338900                                         TO DP013-MESSAGE-TEXT(1) 33890000
339000         PERFORM DP013-0000-PROCESS-ABEND                         33900000
339100     END-IF.                                                      33910000
339200                                                                  33920000
339300******************************************************************33930000
339400** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **33940000
339500** SPECIFIC COMMAREA.                                           **33950000
339600******************************************************************33960000
339700 5110-WRITE-ASC-LISTQ.                                            33970000
339800     EXEC CICS                                                    33980000
339900         WRITEQ TS                                                33990000
340000             QUEUE (ASC-LIST-QUEUE-NAME)                          34000000
340100             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               34010000
340200             ITEM  (PV-BLOCK-NUMBER)                              34020000
340300             RESP  (PV-CICS-RESP)                                 34030000
340400     END-EXEC.                                                    34040000
340500     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      34050000
340600         SET DP013-CICS-ABEND      TO TRUE                        34060000
340700         SET DP013-NO-ROLLBACK     TO TRUE                        34070000
340800         MOVE '5110-WRITE-ASC-LISTQ'                              34080000
340900                                   TO DP013-PARAGRAPH             34090000
341000         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           34100000
341100                                   TO DP013-MESSAGE-TEXT(1)       34110000
341200         PERFORM DP013-0000-PROCESS-ABEND                         34120000
341300     END-IF.                                                      34130000
341400                                                                  34140000
341500*----------------------------------------------------------------*34150000
341600* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *34160000
341700* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *34170000
341800*----------------------------------------------------------------*34180000
341900 5200-FILL-SEL-QUEUE-RECORD.                                      34190000
342000                                                                  34200000
342100     PERFORM 6112-READ-LIST-QUEUE.                                34210000
342200                                                                  34220000
342300     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       34230000
342400         PERFORM                                                  34240000
342500         VARYING LQW-IDX                                          34250000
342600         FROM 1 BY 1                                              34260000
342700         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            34270000
342800           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          34280000
342900                                                                  34290000
343000             IF  LQW-SELECT (LQW-IDX)                             34300000
343100                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              34310000
343200                                   TO SU010-ITEM (SU010-IDX)      34320000
343300                 MOVE SPACE        TO SU010-ACTION-SW (SU010-IDX) 34330000
343400                                                                  34340000
343500                 MOVE LQW-DOOR-ID (LQW-IDX)                       34350000
343600                                     TO SU010-DOOR-ID (SU010-IDX) 34360000
343700                 MOVE LQW-DOOR-TYPE (LQW-IDX)                     34370000
343800                                   TO SU010-DOOR-TYPE (SU010-IDX) 34380000
343900                 MOVE LQW-DESCRIPTION (LQW-IDX)                   34390000
344000                                 TO SU010-DESCRIPTION (SU010-IDX) 34400000
344100                 MOVE LQW-TRLR-SRL-NBR (LQW-IDX)                  34410000
344200                                TO SU010-TRLR-SRL-NBR (SU010-IDX) 34420000
344300                 MOVE LQW-SCAC-CDE (LQW-IDX)                      34430000
344400                                        TO SU010-SCAC (SU010-IDX) 34440000
344500                 MOVE LQW-TRLR-NBR (LQW-IDX)                      34450000
344600                                   TO SU010-TRLR-ID (SU010-IDX)   34460000
344700                 MOVE LQW-TRIP-ID (LQW-IDX)                       34470000
344800                                     TO SU010-TRIP-ID (SU010-IDX) 34480000
344900                 MOVE LQW-DATE-ASGN (LQW-IDX)                     34490000
345000                                   TO SU010-STAT-DATE (SU010-IDX) 34500000
345100                 MOVE LQW-DEST-NBR (LQW-IDX)                      34510000
345200                                    TO SU010-DEST-NBR (SU010-IDX) 34520000
345300                                                                  34530000
345400                 SET SU010-IDX UP BY 1                            34540000
345500                 IF  SU010-IDX > SU010-MAX-ITEMS                  34550000
345600                     PERFORM 5205-WRITE-SEL-QUEUE                 34560000
345700                     ADD +1        TO SU009-NUMBER-OF-TS-ITEMS    34570000
345800                     INITIALIZE SU010-SELECTED-ITEM-ARRAY         34580000
345900                     SET SU010-IDX TO  1                          34590000
346000                 END-IF                                           34600000
346100             END-IF                                               34610000
346200         END-PERFORM                                              34620000
346300     END-IF.                                                      34630000
346400                                                                  34640000
346500*----------------------------------------------------------------*34650000
346600*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *34660000
346700*----------------------------------------------------------------*34670000
346800 5205-WRITE-SEL-QUEUE.                                            34680000
346900                                                                  34690000
347000     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            34700000
347100                                   TO SU010-SELECTED-ITEMS.       34710000
347200                                                                  34720000
347300     EXEC CICS                                                    34730000
347400          WRITEQ TS                                               34740000
347500              QUEUE (ASC-SEL-QUEUE-NAME)                          34750000
347600              FROM  (SU010-SELECT-RECORD)                         34760000
347700              ITEM  (PV-SEL-QUEUE-ITEM)                           34770000
347800              RESP  (PV-CICS-RESP)                                34780000
347900     END-EXEC.                                                    34790000
348000                                                                  34800000
348100     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          34810000
348200         CONTINUE                                                 34820000
348300     ELSE                                                         34830000
348400         SET DP013-CICS-ABEND      TO TRUE                        34840000
348500         SET DP013-NO-ROLLBACK     TO TRUE                        34850000
348600         MOVE '5205-WRITE-SEL-QUEUE'                              34860000
348700                                   TO DP013-PARAGRAPH             34870000
348800         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          34880000
348900                                   TO DP013-MESSAGE-TEXT(1)       34890000
349000         PERFORM DP013-0000-PROCESS-ABEND                         34900000
349100     END-IF.                                                      34910000
349200******************************************************************34920000
349300** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **34930000
349400** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **34940000
349500** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **34950000
349600** THE USER.                                                    **34960000
349700******************************************************************34970000
349800 6000-REFRESH-PANEL-FROM-TEMP.                                    34980000
349900     IF  ASC-UPDATE-TSQ                                           34990000
350000         SET ASC-NO-TSQ-UPDATE TO TRUE                            35000000
350100         MOVE ZERO                 TO PV-SAVE-ITEM                35010000
350200                                      PV-SEL-QUEUE-ITEM           35020000
350300         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        35030000
350400                                   TO PV-HOLD-SELECTED-ITEMS      35040000
350500         MOVE +1                   TO PV-ITEMS-PROCESSED          35050000
350600         PERFORM 6100-UPDATE-TSQ                                  35060000
350700             UNTIL PV-ITEMS-PROCESSED >                           35070000
350800                                     PV-HOLD-SELECTED-ITEMS       35080000
350900         INITIALIZE ASC-BLOCK-ENTRIES (1)                         35090000
351000                    ASC-BLOCK-ENTRIES (2)                         35100000
351100     END-IF.                                                      35110000
351200                                                                  35120000
351300*----------------------------------------------------------------*35130000
351400*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *35140000
351500*----------------------------------------------------------------*35150000
351600 6010-DELETE-SEL-QUEUE.                                           35160000
351700                                                                  35170000
351800     EXEC CICS                                                    35180000
351900         DELETEQ TS                                               35190000
352000             QUEUE (ASC-SEL-QUEUE-NAME)                           35200000
352100             RESP  (PV-CICS-RESP)                                 35210000
352200     END-EXEC.                                                    35220000
352300*                                                                 35230000
352400     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      35240000
352500        (PV-CICS-RESP = DFHRESP(QIDERR)))                         35250000
352600         CONTINUE                                                 35260000
352700     ELSE                                                         35270000
352800         SET DP013-CICS-ABEND TO TRUE                             35280000
352900         SET DP013-NO-ROLLBACK TO TRUE                            35290000
353000         MOVE '6010-DELETE-SEL-QUEUE'                             35300000
353100                        TO DP013-PARAGRAPH                        35310000
353200         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         35320000
353300                        TO DP013-MESSAGE-TEXT (1)                 35330000
353400         PERFORM DP013-0000-PROCESS-ABEND                         35340000
353500     END-IF.                                                      35350000
353600                                                                  35360000
353700*----------------------------------------------------------------*35370000
353800*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *35380000
353900*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *35390000
354000*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *35400000
354100*    THE TEMP QUEUE.                                             *35410000
354200*----------------------------------------------------------------*35420000
354300 6100-UPDATE-TSQ.                                                 35430000
354400                                                                  35440000
354500     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             35450000
354600     PERFORM 6150-READ-SEL-QUEUE.                                 35460000
354700     PERFORM                                                      35470000
354800         VARYING SU010-IDX                                        35480000
354900         FROM 1 BY 1                                              35490000
355000         UNTIL ((PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS)     35500000
355100         OR (SU010-IDX GREATER THAN SU010-MAX-ITEMS))             35510000
355200         IF  SU010-ACTION-SW (SU010-IDX) > SPACE                  35520000
355300             PERFORM 6110-PROCESS-ITEMS                           35530000
355400         END-IF                                                   35540000
355500         ADD +1                TO PV-ITEMS-PROCESSED              35550000
355600     END-PERFORM.                                                 35560000
355700     PERFORM 6111-WRITE-LIST-QUEUE.                               35570000
355800                                                                  35580000
355900*----------------------------------------------------------------*35590000
356000*    READ THE LIST QUEUE RECORD.                                 *35600000
356100*----------------------------------------------------------------*35610000
356200 6150-READ-SEL-QUEUE.                                             35620000
356300                                                                  35630000
356400     EXEC CICS                                                    35640000
356500          READQ TS                                                35650000
356600              QUEUE (ASC-SEL-QUEUE-NAME)                          35660000
356700              INTO  (SU010-SELECT-RECORD)                         35670000
356800              ITEM  (PV-SEL-QUEUE-ITEM)                           35680000
356900              RESP  (PV-CICS-RESP)                                35690000
357000     END-EXEC.                                                    35700000
357100*                                                                 35710000
357200     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          35720000
357300         CONTINUE                                                 35730000
357400     ELSE                                                         35740000
357500         SET DP013-CICS-ABEND      TO  TRUE                       35750000
357600         SET DP013-NO-ROLLBACK     TO  TRUE                       35760000
357700         MOVE '6150-READ-SEL-QUEUE' TO  DP013-PARAGRAPH           35770000
357800         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           35780000
357900                                   TO  DP013-MESSAGE-TEXT(1)      35790000
358000         PERFORM DP013-0000-PROCESS-ABEND                         35800000
358100     END-IF.                                                      35810000
358200                                                                  35820000
358300*----------------------------------------------------------------*35830000
358400*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*35840000
358500*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*35850000
358600*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *35860000
358700*----------------------------------------------------------------*35870000
358800 6110-PROCESS-ITEMS.                                              35880000
358900                                                                  35890000
359000     COMPUTE PV-ITEM = 1 + ((SU010-ITEM (SU010-IDX) - 1)          35900000
359100                     / PC-ITEMS-PER-PANEL).                       35910000
359200                                                                  35920000
359300     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           35930000
359400         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          35940000
359500             PERFORM 6111-WRITE-LIST-QUEUE                        35950000
359600         END-IF                                                   35960000
359700         MOVE PV-ITEM          TO PV-SAVE-ITEM                    35970000
359800                                                                  35980000
359900         PERFORM 6112-READ-LIST-QUEUE                             35990000
360000         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               36000000
360100             CONTINUE                                             36010000
360200         END-IF                                                   36020000
360300     END-IF.                                                      36030000
360400                                                                  36040000
360500     COMPUTE PV-SUB = (SU010-ITEM (SU010-IDX)                     36050000
360600                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              36060000
360700     SET LQW-DESELECT (PV-SUB) TO    TRUE                         36070000
360800     MOVE LQW-SELECTED-SW (PV-SUB)                                36080000
360900                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  36090000
361000                                                                  36100000
361100     EVALUATE TRUE                                                36110000
361200         WHEN SU010-INQ (SU010-IDX)                               36120000
361300              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             36130000
361400                                                                  36140000
361500         WHEN SU010-UPD (SU010-IDX)                               36150000
361600              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             36160000
361700                                                                  36170000
361800         WHEN SU010-DEL (SU010-IDX)                               36180000
361900              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             36190000
362000                                                                  36200000
362100         WHEN SU010-ERR (SU010-IDX)                               36210000
362200              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             36220000
362300     END-EVALUATE.                                                36230000
362400                                                                  36240000
362500     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                36250000
362600                                                                  36260000
362700*----------------------------------------------------------------*36270000
362800*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *36280000
362900*----------------------------------------------------------------*36290000
363000 6111-WRITE-LIST-QUEUE.                                           36300000
363100                                                                  36310000
363200     EXEC CICS                                                    36320000
363300         WRITEQ TS                                                36330000
363400             QUEUE (ASC-LIST-QUEUE-NAME)                          36340000
363500             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     36350000
363600             ITEM  (PV-SAVE-ITEM)                                 36360000
363700             REWRITE                                              36370000
363800             RESP  (PV-CICS-RESP)                                 36380000
363900     END-EXEC.                                                    36390000
364000*                                                                 36400000
364100     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          36410000
364200         CONTINUE                                                 36420000
364300     ELSE                                                         36430000
364400         SET DP013-CICS-ABEND  TO  TRUE                           36440000
364500         SET DP013-NO-ROLLBACK TO  TRUE                           36450000
364600         MOVE '6111-WRITE-LIST-QUEUE'                             36460000
364700                               TO  DP013-PARAGRAPH                36470000
364800         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  36480000
364900                               TO  DP013-MESSAGE-TEXT(1)          36490000
365000         PERFORM DP013-0000-PROCESS-ABEND                         36500000
365100     END-IF.                                                      36510000
365200                                                                  36520000
365300*----------------------------------------------------------------*36530000
365400*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*36540000
365500*----------------------------------------------------------------*36550000
365600 6112-READ-LIST-QUEUE.                                            36560000
365700                                                                  36570000
365800     EXEC CICS                                                    36580000
365900         READQ TS                                                 36590000
366000             QUEUE (ASC-LIST-QUEUE-NAME)                          36600000
366100             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     36610000
366200             ITEM  (PV-ITEM)                                      36620000
366300             RESP  (PV-CICS-RESP)                                 36630000
366400     END-EXEC.                                                    36640000
366500*                                                                 36650000
366600     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          36660000
366700         CONTINUE                                                 36670000
366800     ELSE                                                         36680000
366900         SET DP013-CICS-ABEND        TO TRUE                      36690000
367000         SET DP013-NO-ROLLBACK       TO TRUE                      36700000
367100         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           36710000
367200         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    36720000
367300                                     TO DP013-MESSAGE-TEXT(1)     36730000
367400         PERFORM DP013-0000-PROCESS-ABEND                         36740000
367500     END-IF.                                                      36750000
367600                                                                  36760000
367700*-----------------------------------------------------------------36770000
367800*  READ THE LIST QUEUE RECORD                                     36780000
367900*-----------------------------------------------------------------36790000
368000 9100-READ-SEL-QUEUE.                                             36800000
368100                                                                  36810000
368200     EXEC CICS                                                    36820000
368300         READQ TS                                                 36830000
368400             QUEUE (ASC-SEL-QUEUE-NAME)                           36840000
368500             INTO  (SU010-SELECT-RECORD)                          36850000
368600             ITEM  (ASC-SEL-ITEM)                                 36860000
368700             RESP  (PV-CICS-RESP)                                 36870000
368800     END-EXEC.                                                    36880000
368900     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        36890000
369000         CONTINUE                                                 36900000
369100     ELSE                                                         36910000
369200         SET DP013-LOGIC-ABEND                                    36920000
369300             DP013-NO-ROLLBACK   TO   TRUE                        36930000
369400         MOVE '9100-READ-SEL-QUEUE' TO   DP013-PARAGRAPH          36940000
369500         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   36950000
369600                                 TO   DP013-MESSAGE-TEXT (1)      36960000
369700         PERFORM DP013-0000-PROCESS-ABEND                         36970000
369800     END-IF.                                                      36980000
369900                                                                  36990000
370000*-----------------------------------------------------------------37000000
370100* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *37010000
370200*-----------------------------------------------------------------37020000
370300 9200-REWRITE-SEL-QUEUE.                                          37030000
370400                                                                  37040000
370500     EXEC CICS                                                    37050000
370600          WRITEQ TS                                               37060000
370700              QUEUE  (ASC-SEL-QUEUE-NAME)                         37070000
370800              FROM   (SU010-SELECT-RECORD)                        37080000
370900              ITEM   (ASC-SEL-ITEM)                               37090000
371000              RESP   (PV-CICS-RESP)                               37100000
371100              REWRITE                                             37110000
371200     END-EXEC.                                                    37120000
371300                                                                  37130000
371400     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   37140000
371500         SET DP013-CICS-ABEND                                     37150000
371600             DP013-NO-ROLLBACK     TO TRUE                        37160000
371700         MOVE '9200-REWRITE-SEL-QUEUE'                            37170000
371800                                   TO DP013-PARAGRAPH             37180000
371900         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   37190000
372000                                   TO DP013-MESSAGE-TEXT (1)      37200000
372100         PERFORM DP013-0000-PROCESS-ABEND                         37210000
372200     END-IF.                                                      37220000
372300                                                                  37230000
372400*----------------------------------------------------------------*37240000
372500*    THE DB2 RESOURCE IS NOT AVAILABLE, DISPLAY A MESSAGE ON     *37250000
372600*    THE TERMINAL INDICATING THAT THE RESOURCE IS UNAVAILABLE.   *37260000
372700*----------------------------------------------------------------*37270000
372800 9900-SOFT-ABORT.                                                 37280000
372900                                                                  37290000
373000     EXEC CICS SYNCPOINT                                          37300000
373100          ROLLBACK                                                37310000
373200     END-EXEC.                                                    37320000
373300                                                                  37330000
373400     SET  PS-ERROR                                                37340000
373500          PS-SOFT-ABORT-ERROR                                     37350000
373600          DP020-MSG-FATAL       TO  TRUE.                         37360000
373700                                                                  37370000
373800*----------------------------------------------------------------*37380000
373900*    ABEND PROCESSOR MODULE                                      *37390000
374000*----------------------------------------------------------------*37400000
374100                                                                  37410000
374200     COPY DPPD013.                                                37420000
