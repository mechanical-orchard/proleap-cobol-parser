000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400 PROGRAM-ID.             SUKCS720.                                00040000
000500 AUTHOR.                 CHERI PARMLEY.                           00050000
000600 INSTALLATION.           KOHLS DEPARTMENT STORE.                  00060000
000700 DATE-WRITTEN            OCT, 2013.                               00070000
000800 DATE-COMPILED.                                                   00080000
000900******************************************************************00090000
001000* THIS PROGRAM WILL DETERMINE IF A CARTON NEED TO BE RFID AUDITED 00100000
001100* USING THE PARAMETERS SET UP FOR THE VENDOR. IT WAS MODELED      00110000
001101* FROM SUKCS583 USING THE PACK-BY-STORE ONLY LOGIC.               00110105
001102******************************************************************00110200
001103* CHANGES:                                                        00110305
001104* 03/18/2014  CHERI PARMLEY CHG0077335  TKID: TKMAF76             00110405
001105*             CHANGE IN 0000-PROGRAM-MAINLINE WHERE IT CHECKS IF  00110505
001106*             THE CARTON IS CHECK-IN TO PERFORM 1000- THIS WAS    00110605
001107*             MISSING ORIGINALLY AND EVENTUALLY FALLING THRU TO   00110705
001108*             THIS PARA.                                          00110805
001200******************************************************************00120000
001300 ENVIRONMENT DIVISION.                                            00130000
001400 DATA DIVISION.                                                   00140000
001500******************************************************************00150000
001600 WORKING-STORAGE SECTION.                                         00160000
001700                                                                  00170000
001800 01  DK-DB2-KEYS.                                                 00180000
001900     05  DK-PO-NBR                PIC S9(09)  COMP.               00190000
002000     05  DK-PO-LINE-NBR           PIC S9(09)  COMP.               00200000
002100     05  DK-PO-DRIVER-LINE        PIC S9(09)  COMP.               00210000
002200     05  DK-SHUUPC-LNE-NBR        PIC S9(09)  COMP.               00220000
002300     05  DK-PREPK-ID              PIC S9(04)  COMP.               00230000
002400     05  DK-OPER-UNT-ID           PIC S9(04)  COMP.               00240000
002500     05  DK-INBND-TRIP-ID         PIC S9(09)  COMP.               00250000
002600     05  DK-RCVR-SEQ-NBR          PIC S9(09)  COMP.               00260000
002700     05  DK-SHIPT-UNT-ID          PIC S9(18)V COMP-3.             00270000
002800     05  DK-ENT-ID                PIC S9(09)  COMP.               00280000
002900     05  DK-DEPT-NBR              PIC S9(04)  COMP-4.             00290000
003000     05  DK-PKGNG-TYP-CDE         PIC  X(02).                     00300000
003100     05  DK-AUDIT-CNTL-NBR        PIC S9(09) COMP.                00310000
003110     05  DK-BYPASS-PO-NBR         PIC S9(09)  COMP.               00311006
003120     05  DK-BYPASS-REC-SEQ-NBR    PIC S9(09)  COMP.               00312006
003200                                                                  00320000
003300 01  DN-DB2-NULL-INDICATORS.                                      00330000
003400     05  DN-SUM-NULL                PIC S9(04) COMP VALUE ZEROES. 00340000
003500     05  DN-SUM-NULL-UPC            PIC S9(04) COMP VALUE ZEROES. 00350000
003600*                                                                 00360000
003700*----------------------------------------------------------------*00370000
003800* COMMAREA USED WHEN LINKING FROM A CALLING PROGRAM               00380000
003900*----------------------------------------------------------------*00390000
004000     COPY SURD021.                                                00400000
004100                                                                  00410000
004200******************************************************************00420000
004300*  RANDOM NUMBER AREA.                                            00430000
004400******************************************************************00440000
004500     COPY DPWS902.                                                00450000
004600                                                                  00460000
004700******************************************************************00470000
004800*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA                00480000
004900******************************************************************00490000
005000     COPY DPWS013.                                                00500000
005100                                                                  00510000
005200*----------------------------------------------------------------*00520000
005300*  PROGRAM CONSTANTS                                             *00530000
005400*----------------------------------------------------------------*00540000
005500 01  PC-PROGRAM-CONSTANTS.                                        00550000
005600     05  PC-F                     PIC  X(01)  VALUE 'F'.          00560000
005700     05  PC-P                     PIC  X(01)  VALUE 'P'.          00570000
005800     05  PC-I                     PIC  X(01)  VALUE 'I'.          00580000
005900     05  PC-N                     PIC  X(01)  VALUE 'N'.          00590000
006000     05  PC-Y                     PIC  X(01)  VALUE 'Y'.          00600000
006100     05  PC-A                     PIC  X(01)  VALUE 'A'.          00610000
006200     05  PC-D                     PIC  X(01)  VALUE 'D'.          00620000
006300     05  PC-C                     PIC  X(01)  VALUE 'C'.          00630000
006301     05  PC-R                     PIC  X(01)  VALUE 'R'.          00630105
006302     05  PC-Q                     PIC  X(01)  VALUE 'Q'.          00630200
006400     05  PC-IP                    PIC  X(02)  VALUE 'IP'.         00640000
006500     05  PC-02                    PIC  X(02)  VALUE '02'.         00650000
006600     05  PC-DEFAULT               PIC  X(06)  VALUE 'DEFALT'.     00660000
006700     05  PC-DEFAULT-DATE          PIC  X(26)  VALUE               00670000
006800                                  '9999-09-09-09.09.09.999999'.   00680000
006900     05  PC-RANDOM-NBR-GENERATOR  PIC  X(08)  VALUE 'DPKUT902'.   00690000
007000     05  PC-LOG-QUEUE             PIC  X(04)  VALUE 'CSSL'.       00700000
007100     05  PC-MSG-TABLE-SIZE            PIC S9(03) COMP-3 VALUE 200.00710000
007200     05  PC-100                       PIC  9(03)V99     VALUE 100.00720000
007300     05  PC-LOGON-TRAN-ID                PIC  X(04)  VALUE 'Z028'.00730000
007400                                                                  00740000
007500*----------------------------------------------------------------*00750000
007600*  PROGRAM SWITCHES                                              *00760000
007700*----------------------------------------------------------------*00770000
007800 01  PS-PROGRAM-SWITCHES.                                         00780000
007900     05  PS-CARTON-ALREADY-EXISTS-SW     PIC  X(01)  VALUE 'N'.   00790000
008000         88  PS-CARTON-ALREADY-EXISTS                VALUE 'Y'.   00800000
008100         88  PS-CARTON-DOESNT-EXIST                  VALUE 'N'.   00810000
008200     05  PS-SHOW-DEBUG-SW                PIC  X(01)  VALUE 'N'.   00820000
008300         88  PS-DONT-SHOW-DEBUG-INFO                 VALUE 'N'.   00830000
008400         88  PS-SHOW-DEBUG-INFO                      VALUE 'Y'.   00840000
008500     05  PS-REQ-REC-FOUND-SW             PIC  X(01)  VALUE 'N'.   00850000
008600         88  PS-REQ-REC-FOUND                        VALUE 'Y'.   00860000
008700         88  PS-NO-REQ-REC-FOUND                     VALUE 'N'.   00870000
008800     05  PS-NO-AUDIT-STARTED-SW          PIC  X(01)  VALUE 'N'.   00880000
008900         88  PS-AUDIT-STARTED                        VALUE 'Y'.   00890000
009000         88  PS-NO-AUDIT-STARTED                     VALUE 'N'.   00900000
009100     05  PS-DEPT-RANK-FOUND-SW           PIC  X(01)  VALUE 'N'.   00910000
009200         88  PS-DEPT-RANK-FOUND                      VALUE 'Y'.   00920000
009300         88  PS-NO-DEPT-RANK-FOUND                   VALUE 'N'.   00930000
009400     05  PS-PASSED-AUDITS-FOUND-SW       PIC  X(01)  VALUE 'N'.   00940000
009500         88  PS-PASSED-AUDITS-FOUND                  VALUE 'Y'.   00950000
009600         88  PS-NO-PASSED-AUDITS-FOUND               VALUE 'N'.   00960000
009700     05  PS-FAILED-AUDITS-FOUND-SW       PIC  X(01)  VALUE 'N'.   00970000
009800         88  PS-FAILED-AUDITS-FOUND                  VALUE 'Y'.   00980000
009900         88  PS-NO-FAILED-AUDITS-FOUND               VALUE 'N'.   00990000
010000     05  PS-AUDIT-NBR-IND                PIC  X(01)  VALUE 'N'.   01000000
010100         88  PS-AUDIT-NBR-EXISTS                     VALUE 'Y'.   01010000
010200         88  PS-AUDIT-NBR-NOT-EXISTS                 VALUE 'N'.   01020000
010300     05  PS-VEND-RANK-FOUND-SW           PIC  X(01)  VALUE 'N'.   01030000
010400         88  PS-VEND-RANK-FOUND                      VALUE 'Y'.   01040000
010500         88  PS-NO-VEND-RANK-FOUND                   VALUE 'N'.   01050000
010600     05  PS-DEFAULT-RANK-FOUND-SW        PIC  X(01)  VALUE 'N'.   01060000
010700         88  PS-DEFAULT-RANK-FOUND                   VALUE 'Y'.   01070000
010800         88  PS-NO-DEFAULT-RANK-FOUND                VALUE 'N'.   01080000
010900     05  PS-PO-INFO-FOUND-SW             PIC  X(01)  VALUE 'N'.   01090000
011000         88  PS-PO-INFO-FOUND                        VALUE 'Y'.   01100000
011100         88  PS-NO-PO-INFO-FOUND                     VALUE 'N'.   01110000
011200     05  PS-LINE-LEVEL-FOUND-SW          PIC  X(01)  VALUE 'N'.   01120000
011300         88  PS-LINE-LEVEL-FOUND                     VALUE 'Y'.   01130000
011400         88  PS-NO-LINE-LEVEL-FOUND                  VALUE 'N'.   01140000
011500     05  PS-PO-LEVEL-FOUND-SW            PIC  X(01)  VALUE 'N'.   01150000
011600         88  PS-PO-LEVEL-FOUND                       VALUE 'Y'.   01160000
011700         88  PS-NO-PO-LEVEL-FOUND                    VALUE 'N'.   01170000
011800     05  PS-AUDIT-IS-REQUIRED-SW         PIC  X(01)  VALUE 'N'.   01180000
011900         88  PS-AUDIT-IS-REQUIRED                    VALUE 'Y'.   01190000
012000         88  PS-AUDIT-IS-NOT-REQUIRED                VALUE 'N'.   01200000
012100     05  PS-ERROR-SW                     PIC  X(01)  VALUE 'N'.   01210000
012200         88  PS-ERROR                                VALUE 'Y'.   01220000
012300         88  PS-ERROR-NO                             VALUE 'N'.   01230000
012400     05  PS-DUMP-TO-LOG-SW               PIC X(01)   VALUE 'N'.   01240000
012500         88  PS-DONT-DUMP-TO-LOG                     VALUE 'N'.   01250000
012600         88  PS-DUMP-TO-LOG                          VALUE 'Y'.   01260000
012601     05  PS-IS-DC-OK-FOR-RFID-AUDIT      PIC X(01)   VALUE 'N'.   01260105
012602         88  PS-DC-OK-FOR-RFID-AUDIT                 VALUE 'Y'.   01260200
012603         88  PS-DC-NOT-OK-FOR-RFID-AUDIT             VALUE 'N'.   01260300
012604     05  PS-BYPASS-PROMPT-AUDIT-SW       PIC  X(01)  VALUE 'N'.   01260406
012605         88  PS-BYPASS-PROMPT-AUDIT                  VALUE 'Y'.   01260506
012606         88  PS-BYPASS-PROMPT-AUDIT-NO               VALUE 'N'.   01260606
012700                                                                  01270000
012800*----------------------------------------------------------------*01280000
012900*  PROGRAM VARIABLES                                             *01290000
013000*----------------------------------------------------------------*01300000
013100 01  PV-PROGRAM-VARIABLES.                                        01310000
013200                                                                  01320000
013300     05  PV-DISPLAY-PO-NBR               PIC 9(09).               01330000
013400     05  PV-DISPLAY-PO-LINE-NBR          PIC 9(09).               01340000
013500     05  PV-DISPLAY-PREPK-ID             PIC 9(04).               01350000
013600     05  PV-DISPLAY-OPER-UNT-ID          PIC 9(04).               01360000
013700     05  PV-DISPLAY-INBND-TRIP-ID        PIC 9(09).               01370000
013800     05  PV-DISPLAY-RCVR-SEQ-NBR         PIC 9(09).               01380000
013900     05  PV-DISPLAY-SHIPT-UNT-ID         PIC 9(18).               01390000
014000     05  PV-DISPLAY-ENT-ID               PIC 9(09).               01400000
014100     05  PV-DISPLAY-DEPT-NBR             PIC 9(04).               01410000
014200     05  PV-DISPLAY-CK-AFT-DAY-QTY       PIC 9(04).               01420000
014300     05  PV-DISPLAY-LIMIT-DAYS           PIC 9(09).               01430000
014400     05  PV-DISPLAY-TASK                 PIC 9(07).               01440000
014500     05  PV-DISPLAY-MSG-NBR              PIC 9(03).               01450000
014600                                                                  01460000
014700     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACES.01470000
014800                                                                  01480000
014900     05  PV-PASSED-COUNT                 PIC S9(4)  COMP.         01490000
015000     05  PV-PROMPTED-CNT                 PIC S9(4)  COMP.         01500000
015100     05  PV-DB2-COUNT-EXP-SCN            PIC S9(4)  VALUE +0      01510000
015200                                                    COMP.         01520000
015300     05  PV-CARTONS-TO-AUDIT             PIC S9(9)  VALUE +0      01530000
015400                                                    COMP.         01540000
015500     05  PV-UNITS-TO-AUDIT               PIC S9(9)  VALUE +0      01550000
015600                                                    COMP.         01560000
015700     05  PV-TOTAL-CARTONS                PIC S9(9)  VALUE +0      01570000
015800                                                    COMP.         01580000
015900     05  PV-CHECK-IN-COUNT               PIC S9(9)  VALUE +0      01590000
016000                                                    COMP.         01600000
016100     05  PV-TOTAL-UNITS                  PIC S9(9)  VALUE +0      01610000
016200                                                    COMP.         01620000
016300     05  PV-SUM-EXPTD-ALLOC              PIC S9(9)  VALUE +0      01630000
016400                                                    COMP.         01640000
016500     05  PV-SUM-OF-ALL-LINES             PIC S9(9)  VALUE +0      01650000
016600                                                    COMP.         01660000
016700     05  PV-AUDIT-CNTL-NBR-X             PIC  X(09) VALUE SPACE.  01670000
016800     05  PV-AUDIT-CNTL-NBR  REDEFINES                             01680000
016900         PV-AUDIT-CNTL-NBR-X             PIC  9(09).              01690000
017000     05  PV-RWRK-AUD-CNTL-NBR            PIC  S9(9) COMP.         01700005
017001     05  PV-AUDIT-NUMBER                 PIC  S9(9) COMP.         01700105
017002     05  PV-LIMIT-DAYS                   PIC S9(09) COMP.         01700200
017100     05  PV-SHPD-QTY-SUM                 PIC S9(09) COMP-3.       01710000
017200     05  PV-CARTON-COUNT                 PIC S9(09) COMP.         01720000
017300     05  PV-CICS-MSG-AREA                PIC  X(80) VALUE SPACE.  01730000
017400     05  PV-CICS-RESPONSE                PIC S9(08) VALUE ZEROS   01740000
017500                                                    COMP SYNC.    01750000
017600     05  PV-EIBTASKN                     PIC Z(06)9.              01760000
017700     05  PV-PREV-SEQUENCE                PIC S9(05) COMP-3        01770000
017800                                                     VALUE ZERO.  01780000
017900     05  PV-NEXT-SEQUENCE                PIC S9(05) COMP-3        01790000
018000                                                     VALUE ZERO.  01800000
018100     05  PV-UNT-QTY                      PIC  9(05)V99.           01810000
018200     05  PV-SYSID                        PIC  X(04)  VALUE SPACE. 01820000
018300     05  PV-TS-ITEM                      PIC S9(04)  VALUE ZERO   01830000
018400                                                     COMP.        01840000
018500     05  PV-SIGN-ON-INFO-LENGTH          PIC S9(04)  VALUE ZERO   01850000
018600                                                     COMP SYNC.   01860000
018700/                                                                 01870000
018800 01  TS-TEMP-STORAGE-QUEUE-INFO.                                  01880000
018900     05  TS-INFO-QUEUE-NAME.                                      01890000
019000         10  TS-INFO-QUEUE-TERMINAL      PIC  X(04)  VALUE SPACE. 01900000
019100         10  FILLER                      PIC  X(04)  VALUE 'INFO'.01910000
019200                                                                  01920000
019300/                                                                 01930000
019400 01  PT-MSG-TABLE.                                                01940000
019500     05  PT-MSG-LINES OCCURS 200 TIMES                            01950000
019600                              INDEXED BY PT-MSG-IDX.              01960000
019700         10  PT-MSG-SEQ                  PIC S9(05) COMP-3.       01970000
019800         10  PT-MSG-LINE                 PIC X(69).               01980000
019900                                                                  01990000
020000     05  PV-COMMAREA-LENGTH              PIC S9(04)  COMP         02000000
020100                                                     VALUE ZERO.  02010000
020200     05  PV-CICS-RESP                    PIC S9(08)  VALUE ZEROS  02020000
020300                                                     COMP SYNC.   02030000
020400                                                                  02040000
020500*                                                                 02050000
020600     COPY DPWS026.                                                02060000
020700                                                                  02070000
020710*---------------------------------------------------------------* 02071006
020720*    DB2 AREA FOR THE RECEIVER HEADER TABLE                     * 02072006
020730*---------------------------------------------------------------* 02073006
020740     EXEC SQL                                                     02074006
020750          INCLUDE TRECEIV                                         02075006
020760     END-EXEC.                                                    02076006
020800*---------------------------------------------------------------* 02080000
020900*    DB2 AREA FOR THE PURCHASE TABLE                            * 02090000
021000*---------------------------------------------------------------* 02100000
021100     EXEC SQL                                                     02110000
021200          INCLUDE TPURCHS                                         02120000
021300     END-EXEC.                                                    02130000
021400*---------------------------------------------------------------* 02140000
021500*    DB2 AREA FOR SHIPMENT PO TABLE                             * 02150000
021600*---------------------------------------------------------------* 02160000
021700     EXEC SQL                                                     02170000
021800          INCLUDE TSHPTPO                                         02180000
021900     END-EXEC.                                                    02190000
022000*---------------------------------------------------------------* 02200000
022100*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT      02210000
022200*  (TSHPUNT)                                                      02220000
022300*---------------------------------------------------------------* 02230000
022400     EXEC SQL                                                     02240000
022500         INCLUDE TSHPUNT                                          02250000
022600     END-EXEC.                                                    02260000
022700                                                                  02270000
022800*---------------------------------------------------------------* 02280000
022900*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE CARTON LOCATION    02290000
023000*  (TSHUNLO)                                                      02300000
023100*---------------------------------------------------------------* 02310000
023200     EXEC SQL                                                     02320000
023300         INCLUDE TSHUNLO                                          02330000
023400     END-EXEC.                                                    02340000
023500                                                                  02350000
023600*---------------------------------------------------------------* 02360000
023700*    DB2 AREA FOR THE INPKSU TABLE                                02370000
023800*---------------------------------------------------------------* 02380000
023900     EXEC SQL                                                     02390000
024000          INCLUDE TINPKSU                                         02400000
024100     END-EXEC.                                                    02410000
024200*---------------------------------------------------------------* 02420000
024300*    DB2 AREA FOR THE PACKSLIP TABLE                            * 02430000
024400*---------------------------------------------------------------* 02440000
024500     EXEC SQL                                                     02450000
024600          INCLUDE TPKSLIP                                         02460000
024700     END-EXEC.                                                    02470000
024800*---------------------------------------------------------------* 02480000
024900*    DB2 AREA FOR THE SHIPPING UNIT AUDIT TABLE                 * 02490000
025000*---------------------------------------------------------------* 02500000
025100     EXEC SQL                                                     02510000
025200         INCLUDE TSUNAUD                                          02520000
025300     END-EXEC.                                                    02530000
025400*---------------------------------------------------------------* 02540000
025500*    DB2 AREA FOR THE SHIPPING UNIT AUDIT TRANSACTION TABLE     * 02550000
025600*---------------------------------------------------------------* 02560000
025700     EXEC SQL                                                     02570000
025800         INCLUDE TSUATRN                                          02580000
025900     END-EXEC.                                                    02590000
026000*---------------------------------------------------------------* 02600000
026100*    DB2 AREA FOR THE PO AUDIT EXC TABLE (SUT_PO_AUD_EXC)       * 02610000
026200*---------------------------------------------------------------* 02620000
026300     EXEC SQL                                                     02630000
026400         INCLUDE SUT00014                                         02640000
026500     END-EXEC.                                                    02650000
026600*---------------------------------------------------------------* 02660000
026700*    DB2 AREA FOR THE PO AUDIT REQUEST TABLE (SUT_PO_AUD_REQ)   * 02670000
026800*---------------------------------------------------------------* 02680000
026900     EXEC SQL                                                     02690000
027000         INCLUDE SUT00015                                         02700000
027100     END-EXEC.                                                    02710000
027200*---------------------------------------------------------------* 02720000
027300*    DB2 AREA FOR THE VENDOR AUDIT PARM TABLE (SUT_PO_AUD_PARM) * 02730000
027400*---------------------------------------------------------------* 02740000
027500     EXEC SQL                                                     02750000
027600         INCLUDE SUT00017                                         02760000
027700     END-EXEC.                                                    02770000
027800*---------------------------------------------------------------* 02780000
027900*    DB2 AREA FOR THE VENDOR DEPT RANKING TBL (SUT_VND_DEPT_RNKG) 02790000
028000*---------------------------------------------------------------* 02800000
028100     EXEC SQL                                                     02810000
028200         INCLUDE SUT00018                                         02820000
028300     END-EXEC.                                                    02830000
028400*---------------------------------------------------------------* 02840000
028500*    DB2 AREA FOR THE VENDOR RANKING TABLE (SUT_VND_RNKG)       * 02850000
028600*---------------------------------------------------------------* 02860000
028700     EXEC SQL                                                     02870000
028800         INCLUDE SUT00019                                         02880000
028900     END-EXEC.                                                    02890000
029000*---------------------------------------------------------------* 02900000
029100*    DB2 AREA FOR THE DISTRIBUTION HEADER TABLE                 * 02910000
029200*---------------------------------------------------------------* 02920000
029300     EXEC SQL                                                     02930000
029400          INCLUDE TDISTHD                                         02940000
029500     END-EXEC.                                                    02950000
029600*---------------------------------------------------------------* 02960000
029700*    DB2 AREA FOR THE DISTRIBUTION DETAIL TABLE                 * 02970000
029800*---------------------------------------------------------------* 02980000
029900     EXEC SQL                                                     02990000
030000          INCLUDE TDISTDT                                         03000000
030100     END-EXEC.                                                    03010000
030200*---------------------------------------------------------------* 03020000
030300*    DB2 AREA FOR THE RECEIVER ITEM TABLE                       * 03030000
030400*---------------------------------------------------------------* 03040000
030500     EXEC SQL                                                     03050000
030600          INCLUDE TRECITM                                         03060000
030700     END-EXEC.                                                    03070000
030800*---------------------------------------------------------------* 03080000
030900*    DB2 AREA FOR THE PURCHASE ITEM TABLE                       * 03090000
031000*---------------------------------------------------------------* 03100000
031100     EXEC SQL                                                     03110000
031200          INCLUDE TPURITM                                         03120000
031300     END-EXEC.                                                    03130000
031400*---------------------------------------------------------------* 03140000
031500*    DB2 AREA FOR THE SHIPPING UPC TABLE                        * 03150000
031600*---------------------------------------------------------------* 03160000
031700     EXEC SQL                                                     03170000
031800          INCLUDE TSHUUPC                                         03180000
031900     END-EXEC.                                                    03190000
032000*---------------------------------------------------------------* 03200000
032100*    DB2 AREA FOR THE RECEIVING SYSTEM PARM TABLE               * 03210000
032200*---------------------------------------------------------------* 03220000
032300     EXEC SQL                                                     03230000
032400         INCLUDE TKRPRPM                                          03240000
032500     END-EXEC.                                                    03250000
032600*----------------------------------------------------------------*03260000
032700*  COMMUNICATIONS AREA FOR DB2                                   *03270000
032800*----------------------------------------------------------------*03280000
032900     EXEC SQL                                                     03290000
033000         INCLUDE SQLCA                                            03300000
033100     END-EXEC.                                                    03310000
033200                                                                  03320000
033300                                                                  03330000
033400******************************************************************03340000
033500 LINKAGE SECTION.                                                 03350000
033600******************************************************************03360000
033700 01  DFHCOMMAREA.                                                 03370000
033800     05  FILLER                         OCCURS  1 TO 4072 TIMES   03380000
033900                                      DEPENDING ON EIBCALEN.      03390000
034000         10  FILLER                   PIC X.                      03400000
034100                                                                  03410000
034200******************************************************************03420000
034300 PROCEDURE DIVISION.                                              03430000
034400******************************************************************03440000
034500 0000-PROGRAM-MAINLINE.                                           03450000
034600     MOVE EIBTASKN                 TO  PV-EIBTASKN.               03460000
034700     INITIALIZE                        SU021-CARTON-AUDIT-RECORD. 03470000
034800     MOVE DFHCOMMAREA              TO  SU021-CARTON-AUDIT-RECORD. 03480000
034900                                                                  03490000
035000     MOVE SPACES                   TO PV-CICS-MSG-AREA.           03500000
035100     INITIALIZE PT-MSG-TABLE.                                     03510000
035200     MOVE 1                        TO PT-MSG-SEQ (PT-MSG-IDX).    03520000
035310     IF SU021-PRINT-APPLY-SW  = 'Y'                               03531000
035320        MOVE SU021-OPER-UNT-ID TO DP026-LOCATION-NBR              03532000
035330     ELSE                                                         03533000
035340        PERFORM 0500-FIND-SYSTEM-ID                               03534000
035350        PERFORM 0700-FIND-LOGON-INFO                              03535000
035360     END-IF.                                                      03536000
035370                                                                  03537000
035380     IF DP026-LOCATION-NBR = 90                                   03538000
035390         MOVE SU021-OPER-UNT-ID        TO DK-OPER-UNT-ID          03539000
035400     ELSE                                                         03540000
035500         IF DP026-LOCATION-NBR NOT = SU021-OPER-UNT-ID            03550000
035600             SET SU021-RFID-AUDIT-IS-COMPLETE TO TRUE             03560000
035700             PERFORM 9998-RETURN                                  03570000
035800         ELSE                                                     03580000
035900             MOVE SU021-OPER-UNT-ID        TO DK-OPER-UNT-ID      03590000
036000         END-IF                                                   03600000
036100     END-IF.                                                      03610000
036200                                                                  03620005
036300*    FIRST CHECK IF THE DC IS TURNED ON THE PARM TABLE FOR        03630005
036400*    RFID AUDIT, IF IT IS CONTINUE ELSE GET OUT OF PROGRAM        03640005
036500*    WITH AN AUDIT IS COMPLETED STATUS                            03650005
036600                                                                  03660005
036700     PERFORM 0900-CHECK-DC-RFDAUD-FIRST.                          03670005
039900     EVALUATE TRUE                                                03990000
313000       WHEN PS-DC-NOT-OK-FOR-RFID-AUDIT                           31300000
313001         SET SU021-RFID-AUDIT-IS-COMPLETE TO TRUE                 31300105
313002         PERFORM 9998-RETURN                                      31300200
313003     END-EVALUATE.                                                31300305
313004                                                                  31300405
313005     PERFORM 8850-SELECT-TKRPRPM.                                 31300500
313006     STRING ' PS-SHOW-DEBUG-SW= ' PS-SHOW-DEBUG-SW                31300600
313007         DELIMITED BY SIZE INTO PV-CICS-MSG-AREA                  31300700
313008     PERFORM 9990-WRITE-CICS.                                     31300800
313009                                                                  31300900
313010* RESERVE THE LOG QUEUE FOR THE EXCLUSIVE USE OF THIS TRANSACTION 31301000
313011* TO KEEP OTHER TRANSACTIONS FROM INTERUPTING THE DISPLAY.        31301100
313012* THIS IS DONE ONLY IF THE DEBUGGING FLAG FOR THE DC IS           31301200
313013* SWITCHED ON.  IF AN ERROR OCCURS WHEN THE FLAG IS OFF,          31301300
313014* WE WILL ENQ THE LOG BEFORE DUMPING THE MESSAGE TABLE.           31301400
313015                                                                  31301500
313016     IF PS-SHOW-DEBUG-INFO                                        31301600
313017         EXEC CICS ENQ                                            31301700
313018             RESOURCE(PC-LOG-QUEUE)                               31301800
313019         END-EXEC                                                 31301900
313020     END-IF.                                                      31302000
313021                                                                  31302100
313022     IF SU021-CARTON-CHECK-IN                                     31302200
313023         SET PS-AUDIT-IS-NOT-REQUIRED    TO TRUE                  31302300
313024*CLP 03/18/14 START                                               31302405
313025         PERFORM 1000-DETERMINE-IF-AUDIT-REQ                      31302500
313026*CLP 03/18/14 END                                                 31302605
313027     ELSE                                                         31302700
313028         IF SU021-CARTON-AUDIT                                    31302800
313029             PERFORM 2000-AUDIT-CARTON-DATA                       31302900
313030         ELSE                                                     31303000
313031             SET SU021-RFID-INVALID-REQUEST TO TRUE               31303100
313032         END-IF                                                   31303200
313033     END-IF.                                                      31303300
313034                                                                  31303400
313035*                                                                 31303500
313036 0500-FIND-SYSTEM-ID.                                             31303600
313037     EXEC CICS                                                    31303700
313038         INQUIRE                                                  31303800
313039             TRANSACTION   (PC-LOGON-TRAN-ID)                     31303900
313040             REMOTESYSTEM  (PV-SYSID)                             31304000
313041             RESP          (PV-CICS-RESPONSE)                     31304100
313042     END-EXEC.                                                    31304200
313043                                                                  31304300
313044     EVALUATE TRUE                                                31304400
313045         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 31304500
313046             CONTINUE                                             31304600
313047         WHEN OTHER                                               31304700
313048             MOVE '0500-FIND-SYSTEM-ID'                           31304800
313049                 TO DP013-PARAGRAPH                               31304900
313050             MOVE 'UNABLE TO DETERMINE SYSTEM ID'                 31305000
313051                 TO DP013-MESSAGE-TEXT (1)                        31305100
313052             SET DP013-CICS-ABEND      TO  TRUE                   31305200
313053             SET DP013-NO-ROLLBACK     TO  TRUE                   31305300
313054             PERFORM 9999-WRITE-CICS-LOG-MSG                      31305400
313055             SET PS-DUMP-TO-LOG       TO TRUE                     31305500
313056     END-EVALUATE.                                                31305600
313057*                                                                 31305700
313058 0700-FIND-LOGON-INFO.                                            31305800
313059     MOVE LENGTH OF DP026-SIGN-ON-INFO                            31305900
313060                    TO  PV-SIGN-ON-INFO-LENGTH.                   31306000
313061     MOVE EIBTRMID  TO  TS-INFO-QUEUE-TERMINAL.                   31306100
313062     MOVE +1        TO  PV-TS-ITEM.                               31306200
313063                                                                  31306300
313064     IF PV-SYSID = SPACES                                         31306400
313065         EXEC CICS                                                31306500
313066             READQ TS                                             31306600
313067                 QUEUE  (TS-INFO-QUEUE-NAME)                      31306700
313068                 ITEM   (PV-TS-ITEM)                              31306800
313069                 INTO   (DP026-SIGN-ON-INFO)                      31306900
313070                 RESP   (PV-CICS-RESPONSE)                        31307000
313071         END-EXEC                                                 31307100
313072     ELSE                                                         31307200
313073         EXEC CICS                                                31307300
313074             READQ TS                                             31307400
313075                 QUEUE   (TS-INFO-QUEUE-NAME)                     31307500
313076                 SYSID   (PV-SYSID)                               31307600
313077                 ITEM    (PV-TS-ITEM)                             31307700
313078                 INTO    (DP026-SIGN-ON-INFO)                     31307800
313079                 LENGTH  (PV-SIGN-ON-INFO-LENGTH)                 31307900
313080                 RESP    (PV-CICS-RESPONSE)                       31308000
313081         END-EXEC                                                 31308100
313082     END-IF.                                                      31308200
313083                                                                  31308300
313084     EVALUATE TRUE                                                31308400
313085         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 31308500
313086             CONTINUE                                             31308600
313087         WHEN OTHER                                               31308700
313088             MOVE '0700-FIND-LOGON-INFO'                          31308800
313089                 TO DP013-PARAGRAPH                               31308900
313090             MOVE 'UNABLE TO READ LOGON TSQ'                      31309000
313091                 TO DP013-MESSAGE-TEXT (1)                        31309100
313092             MOVE SU021-PO-NUMBER    TO PV-DISPLAY-PO-NBR         31309200
313093             MOVE SU021-LINE-NBR     TO PV-DISPLAY-PO-LINE-NBR    31309300
313094             MOVE SU021-OPER-UNT-ID  TO PV-DISPLAY-OPER-UNT-ID    31309400
313095             MOVE SU021-SHIPT-UNT-ID TO PV-DISPLAY-SHIPT-UNT-ID   31309500
313096             STRING ' PO = '                                      31309600
313097               PV-DISPLAY-PO-NBR                                  31309700
313098               ' LINE = '                                         31309800
313099               PV-DISPLAY-PO-LINE-NBR                             31309900
313100               ' OPER = '                                         31310000
313101               PV-DISPLAY-OPER-UNT-ID                             31310100
313102               DELIMITED BY SIZE                                  31310200
313103               INTO DP013-MESSAGE-TEXT (2)                        31310300
313104             STRING ' CARTON = '                                  31310400
313105               PV-DISPLAY-SHIPT-UNT-ID                            31310500
313106               DELIMITED BY SIZE                                  31310600
313107               INTO DP013-MESSAGE-TEXT (3)                        31310700
313108             STRING ' PV-SYSID = '                                31310800
313109               PV-SYSID                                           31310900
313110               DELIMITED BY SIZE                                  31311000
313111               INTO DP013-MESSAGE-TEXT (4)                        31311100
313112             SET DP013-CICS-ABEND     TO TRUE                     31311200
313113             SET DP013-NO-ROLLBACK    TO TRUE                     31311300
313114             PERFORM 9999-WRITE-CICS-LOG-MSG                      31311400
313115     END-EVALUATE.                                                31311500
313116                                                                  31311605
313117*-----------------------------------------------------------------31311700
313118*CHECK IF THE DC IS TURNED ON FOR RFID AUDIT                      31311800
313119*-----------------------------------------------------------------31311900
313120 0900-CHECK-DC-RFDAUD-FIRST.                                      31312005
313121                                                                  31312105
313122     STRING ' 0900-CHECK-DC-RFDAUD-FIRST'                         31312200
313123         DELIMITED BY SIZE                                        31312300
313124         INTO PV-CICS-MSG-AREA.                                   31312400
313125     PERFORM 9990-WRITE-CICS.                                     31312500
313126                                                                  31312600
313127     EXEC SQL                                                     31312700
313128          SELECT FUNC_TXT                                         31312800
313129            INTO :KRPRPM-FUNC-TXT                                 31312900
313130            FROM TKRPRPM                                          31313000
313131           WHERE LOC_ID            = :DK-OPER-UNT-ID              31313100
313132             AND INTFC_SYS_CDE    = 'KHL'                         31313200
313133             AND SYS_PRC_FUNC_CDE = 'RFDAUD'                      31313300
313134             AND FUNC_PRC_STAT_CDE = 'AC'                         31313400
313135     END-EXEC.                                                    31313500
313136                                                                  31313600
313137     EVALUATE TRUE                                                31313700
313138         WHEN SQLCODE = ZERO                                      31313800
313139             IF KRPRPM-FUNC-TXT = 'Y'                             31313900
313140                 SET PS-DC-OK-FOR-RFID-AUDIT                      31314000
313150                                      TO TRUE                     31315000
313200             ELSE                                                 31320000
313300                 SET PS-DC-NOT-OK-FOR-RFID-AUDIT                  31330000
313400                                      TO TRUE                     31340000
313500             END-IF                                               31350000
313501         WHEN SQLCODE = +100                                      31350105
313502                 SET PS-DC-NOT-OK-FOR-RFID-AUDIT                  31350200
313503                                      TO TRUE                     31350300
313600         WHEN SQLWARN0 NOT = SPACES                               31360000
313700         WHEN SQLCODE NOT EQUAL ZERO                              31370000
313800             MOVE '0900-CHECK-DC-RFDAUD-FIRST'                    31380000
313900                             TO DP013-PARAGRAPH                   31390000
314000             MOVE DK-OPER-UNT-ID TO PV-DISPLAY-OPER-UNT-ID        31400000
314100             STRING 'OPER UNIT: '      DELIMITED BY SIZE          31410000
314200                PV-DISPLAY-OPER-UNT-ID DELIMITED BY SIZE          31420000
314300                           INTO DP013-MESSAGE-TEXT(1)             31430000
314400             MOVE SQLCA      TO DP013-SQLCA                       31440000
314500             MOVE 'TKRPRPM ' TO DP013-DB2-TABLE-NAME(1)           31450000
314600             SET DP013-DB2-ABEND                                  31460000
314700                             TO TRUE                              31470000
314800             SET DP013-NO-ROLLBACK                                31480000
314900                             TO TRUE                              31490000
315000             PERFORM 9999-WRITE-CICS-LOG-MSG                      31500000
315100             SET PS-DUMP-TO-LOG       TO TRUE                     31510000
315200             SET SU021-RFID-DB2-ERROR TO TRUE                     31520000
315300     END-EVALUATE.                                                31530000
315301*-----------------------------------------------------------------31530105
315302*DETERMINE IF AN AUDIT IS NEEDED FOR THIS PO                      31530200
315303*-----------------------------------------------------------------31530300
315304                                                                  31530405
315305 1000-DETERMINE-IF-AUDIT-REQ.                                     31530500
315306     STRING ' 1000-DETERMINE-IF-AUDIT-REQ'                        31530600
315307         DELIMITED BY SIZE                                        31530700
315308         INTO PV-CICS-MSG-AREA.                                   31530800
315309     PERFORM 9990-WRITE-CICS.                                     31530900
315310     MOVE SU021-CARTON-AUDIT-RECORD                               31531000
315311           TO PV-CICS-MSG-AREA.                                   31531100
315312     PERFORM 9990-WRITE-CICS.                                     31531200
315313                                                                  31531305
315314     MOVE SU021-PO-NUMBER         TO DK-PO-NBR.                   31531400
315315     MOVE 0                       TO DK-PO-LINE-NBR.              31531500
315316                                                                  31531605
315317     MOVE -9999                   TO DK-PREPK-ID.                 31531700
315318                                                                  31531805
315319     MOVE SU021-REC-SEQ-NBR       TO DK-RCVR-SEQ-NBR.             31531900
315320     MOVE SU021-INBOUND-TRIP-ID   TO DK-INBND-TRIP-ID.            31532000
315321     MOVE SU021-SHIPT-UNT-ID      TO DK-SHIPT-UNT-ID.             31532100
315322*  CHECK IF SUT_PO_AUD_REQ RECORDS EXIST                          31532200
315323     PERFORM 7000-SELECT-REQ-INFO.                                31532300
315324                                                                  31532400
315325     IF PS-REQ-REC-FOUND                                          31532500
315326         MOVE SUT00015-AUD-CNTL-NBR   TO SU021-RFID-AUDIT-NUMBER  31532600
315327         PERFORM 9000-SELECT-CARTON                               31532700
315328     END-IF.                                                      31532800
315329                                                                  31532905
315330*   CHECK IF AUDIT IS ALREADY DONE                                31533000
315331     IF NOT SU021-RFID-DB2-ERROR AND                              31533100
315332        PS-REQ-REC-FOUND AND                                      31533200
315333        (SUT00015-CART-PRMPT-CDE = 'D' OR                         31533300
315334         SUT00015-CART-PRMPT-CDE = 'F')                           31533400
315335                                                                  31533505
315336         IF SUT00015-CART-PRMPT-CDE = 'D'                         31533600
315337                                                                  31533705
315338             IF SUT00015-AUD-STAT-CDE = 'P' OR                    31533800
315339                SUT00015-AUD-STAT-CDE = 'N'                       31533900
315340                                                                  31534005
315350                 SET SU021-RFID-AUDIT-IS-COMPLETE TO TRUE         31535000
315351                                                                  31535105
315352             ELSE                                                 31535200
315353                                                                  31535305
315354                 IF SUT00015-AUD-STAT-CDE = 'F'                   31535400
315355                     SET SU021-RFID-REWORK  TO TRUE               31535500
315356                 ELSE                                             31535600
315357***    SUT00015-AUD-STAT-CDE = 'I'                                31535700
315358                     SET SU021-RFID-AUDIT-PENDING TO TRUE         31535800
315359                 END-IF                                           31535900
315360                                                                  31536005
315370             END-IF                                               31537000
315371                                                                  31537105
315372         ELSE                                                     31537200
315373             SET SU021-RFID-REWORK TO TRUE                        31537300
315374                                                                  31537405
315375     ELSE                                                         31537500
315376                                                                  31537605
315377       IF NOT SU021-RFID-DB2-ERROR                                31537700
315378                                                                  31537805
315379*        WHEN NO SUT_PO_AUD_REQ FOUND, GET DEPT AND ENT-ID        31537900
315380         IF PS-NO-REQ-REC-FOUND                                   31538000
315381             PERFORM 7150-RETREIVE-PO-INFO                        31538100
315382             MOVE PURCHS-DEPT-NBR         TO DK-DEPT-NBR          31538200
315383             MOVE PURCHS-ENT-ID           TO DK-ENT-ID            31538300
315384         ELSE                                                     31538400
315385             MOVE SUT00015-DEPT-NBR       TO DK-DEPT-NBR          31538500
315386             MOVE SUT00015-ENT-ID         TO DK-ENT-ID            31538600
315387             SET PS-PO-INFO-FOUND TO TRUE                         31538700
315388         END-IF                                                   31538800
315389                                                                  31538905
315390         IF PS-PO-INFO-FOUND                                      31539000
315391                                                                  31539100
315392             IF PS-REQ-REC-FOUND                                  31539200
315393                PERFORM 7190-RETREIVE-PO-AUD-PARM                 31539300
315394             ELSE                                                 31539400
315395                PERFORM 1100-RETREIVE-VENDOR-RANKING              31539500
315396             END-IF                                               31539600
315397                                                                  31539705
315398             MOVE SU021-PO-NUMBER TO                              31539806
315399                  DK-BYPASS-PO-NBR                                31539906
315400             MOVE SU021-REC-SEQ-NBR TO                            31540006
315401                  DK-BYPASS-REC-SEQ-NBR                           31540106
315402             PERFORM 1200-CHECK-PO-AUDIT-EXC                      31540200
315403             PERFORM 7100-CHECK-FOR-BYPASS                        31540306
315404                                                                  31540405
315405             IF  SUT00017-AUD-PCT = 0   AND                       31540500
315406                 PS-NO-LINE-LEVEL-FOUND AND                       31540600
315407                 PS-NO-PO-LEVEL-FOUND                             31540700
315408                                                                  31540805
315409                 IF PS-NO-REQ-REC-FOUND                           31540900
315410                     SET SU021-RFID-AUDIT-IS-COMPLETE TO TRUE     31541000
315411                 ELSE                                             31541100
315412                     PERFORM 1430-DETERMINE-STAT-CDE              31541200
315413                 END-IF                                           31541300
315414                                                                  31541405
315415             ELSE                                                 31541500
315416                                                                  31541605
315417               PERFORM 1400-CHECK-FOR-IN-PROCES-AUDIT             31541700
315418                                                                  31541805
315419*                   AUDIT HAS BEEN STARTED FOR THIS DC            31541900
315420               IF PS-AUDIT-STARTED                                31542000
315421                                                                  31542105
315422                 PERFORM 1430-DETERMINE-STAT-CDE                  31542200
315423                                                                  31542305
315424               ELSE                                               31542400
315425                                                                  31542505
315430                 PERFORM 7850-SELECT-DC-PASSED                    31543000
315431                                                                  31543105
315432                 IF  PV-PASSED-COUNT > 0    AND                   31543200
315433                     PS-NO-LINE-LEVEL-FOUND AND                   31543300
315434                     PS-NO-PO-LEVEL-FOUND                         31543400
315435                                                                  31543505
315436                     SET SU021-RFID-AUDIT-IS-COMPLETE TO TRUE     31543600
315437                                                                  31543705
315438                 ELSE                                             31543800
315439*                             DMH END 03/07/02                    31543900
315440                                                                  31544000
315441*                           NO RECORDS EXIST IN SUT_PO_AUD_EXC    31544100
315442                   IF PS-NO-LINE-LEVEL-FOUND AND                  31544200
315443                              PS-NO-PO-LEVEL-FOUND                31544300
315444                                                                  31544405
315445                     PERFORM 1300-CHECK-PO-AUDIT-REQ              31544500
315446                     PERFORM 1410-CHECK-PROMPTED-LINES            31544600
315447                                                                  31544705
315448*                        SOME FAILED AUDITS WERE FOUND            31544800
315449                     IF PS-FAILED-AUDITS-FOUND                    31544900
315450                         SET SU021-RFID-AUDIT-REQUIRED TO TRUE    31545000
315451                         PERFORM 1500-CALCULATE-QUANTITIES        31545100
315452                         PERFORM 1600-INSERT-INTO-TABLES          31545200
315453                                                                  31545305
315454                     ELSE                                         31545400
315455                                                                  31545505
315456*                           PASSED AUDITS WERE FOUND FOR THIS ITEM31545600
315457                       IF PS-PASSED-AUDITS-FOUND                  31545700
315458                                                                  31545805
315459                         IF SUT00017-CKD-DC-QTY > PV-PASSED-COUNT 31545900
315460                                                                  31546005
315461*        CHECK THE NUMBER OF LINES FOR THE PO-RCVR PROMPTED       31546100
315462                             IF  PV-PROMPTED-CNT >=               31546200
315463                                 SUT00017-MAX-PO-LNE-QTY AND      31546300
315464                                 SUT00017-MAX-PO-LNE-QTY > 0      31546400
315465                                                                  31546505
315466                                  SET SU021-RFID-AUDIT-IS-COMPLETE31546600
315467                                       TO TRUE                    31546700
315468                                                                  31546805
315469                             ELSE                                 31546900
315470                                                                  31547005
315471                                 SET SU021-RFID-AUDIT-REQUIRED    31547100
315472                                     TO TRUE                      31547200
315473                                 PERFORM                          31547300
315474                                     1500-CALCULATE-QUANTITIES    31547400
315475                                 PERFORM                          31547500
315476                                      1600-INSERT-INTO-TABLES     31547600
315477                                                                  31547705
315478                             END-IF                               31547800
315479                                                                  31547905
315480                         ELSE                                     31548000
315481                                                                  31548105
315482                          SET SU021-RFID-AUDIT-IS-COMPLETE TO TRUE31548200
315483                                                                  31548305
315484                         END-IF                                   31548400
315485                                                                  31548505
315486*                         NO FAILED OR PASSED AUDITS WERE FOUND   31548600
315487                                                                  31548705
315488                       ELSE                                       31548800
315489                                                                  31548905
315490*               CHECK THE NUMBER OF LINES FOR THE PO-RCVR PROMPTED31549000
315491                         IF  PV-PROMPTED-CNT >=                   31549100
315492                             SUT00017-MAX-PO-LNE-QTY  AND         31549200
315493                             SUT00017-MAX-PO-LNE-QTY > 0          31549300
315494                               SET SU021-RFID-AUDIT-IS-COMPLETE   31549400
315495                                       TO TRUE                    31549500
315496                                                                  31549605
315497                         ELSE                                     31549700
315498                                                                  31549805
315499                             SET SU021-RFID-AUDIT-REQUIRED TO TRUE31549900
315500                             PERFORM 1500-CALCULATE-QUANTITIES    31550000
315600                             PERFORM 1600-INSERT-INTO-TABLES      31560000
315601                                                                  31560105
315602                         END-IF                                   31560200
315603                                                                  31560305
315604                       END-IF                                     31560400
315605                                                                  31560505
315606                     END-IF                                       31560600
315607                                                                  31560705
315608*                        A RECORD EXISTS IN SUT_PO_AUD_EXC        31560800
315609                   ELSE                                           31560900
315610                                                                  31561005
315620                     PERFORM 1700-RETURN-WITH-EXC-VALUES          31562000
315621                                                                  31562105
315622                   END-IF                                         31562200
315623                                                                  31562305
315624                 END-IF                                           31562400
315625                                                                  31562505
315626               END-IF                                             31562600
315627                                                                  31562705
315628             END-IF                                               31562800
315629                                                                  31562905
315630         ELSE                                                     31563000
315631                                                                  31563105
315632             SET SU021-RFID-DB2-ERROR TO TRUE                     31563200
315633                                                                  31563305
315634         END-IF                                                   31563400
315635                                                                  31563505
315636       END-IF                                                     31563600
315637                                                                  31563705
315638     END-IF.                                                      31563800
315639                                                                  31563900
315640                                                                  31564000
315641     PERFORM 9998-RETURN.                                         31564100
315642                                                                  31564200
315643*-----------------------------------------------------------------31564300
315644*RETRIEVE THE VENDOR RANKING FOR THE PO                           31564400
315645*-----------------------------------------------------------------31564500
315646 1100-RETREIVE-VENDOR-RANKING.                                    31564600
315647     STRING ' 1100-RETREIVE-VENDOR-RANKING'                       31564700
315648         DELIMITED BY SIZE                                        31564800
315649         INTO PV-CICS-MSG-AREA.                                   31564900
315650     PERFORM 9990-WRITE-CICS.                                     31565000
315651     MOVE SU021-PACKAGE-TYPE-CODE TO DK-PKGNG-TYP-CDE.            31565100
315652     IF PS-REQ-REC-FOUND                                          31565200
315653         PERFORM 7200-RETREIVE-VENDOR-DEPT                        31565300
315654         IF PS-NO-DEPT-RANK-FOUND                                 31565400
315655             PERFORM 7300-RETREIVE-VENDOR-RANK                    31565500
315656             IF PS-NO-VEND-RANK-FOUND                             31565600
315657                 PERFORM 7400-RETREIVE-DEFAULT-RANK               31565700
315658                 IF PS-DEFAULT-RANK-FOUND                         31565800
315659                     MOVE 'DEFAULT RANK FOUND '                   31565900
315660                                     TO PV-CICS-MSG-AREA          31566000
315661                     PERFORM 9990-WRITE-CICS                      31566100
315662                     MOVE SUT00017-CK-AFT-DAY-QTY                 31566200
315663                          TO PV-DISPLAY-CK-AFT-DAY-QTY            31566300
315664                     STRING 'CHECK AFTER DAYS = '                 31566400
315665                                   DELIMITED BY SIZE              31566500
315666                             PV-DISPLAY-CK-AFT-DAY-QTY            31566600
315667                                   DELIMITED BY SIZE              31566700
315668                                   INTO PV-CICS-MSG-AREA          31566800
315669                     PERFORM 9990-WRITE-CICS                      31566900
315670                     MOVE PV-LIMIT-DAYS                           31567000
315671                               TO PV-DISPLAY-LIMIT-DAYS           31567100
315672                     STRING 'PV-LIMIT-DAYS  = '                   31567200
315673                                   DELIMITED BY SIZE              31567300
315674                            PV-DISPLAY-LIMIT-DAYS                 31567400
315675                                   DELIMITED BY SIZE              31567500
315676                                   INTO PV-CICS-MSG-AREA          31567600
315677                     PERFORM 9990-WRITE-CICS                      31567700
315678                 END-IF                                           31567800
315679             ELSE                                                 31567900
315680                 MOVE 'VEND RANK FOUND '                          31568000
315681                                 TO PV-CICS-MSG-AREA              31568100
315682                 PERFORM 9990-WRITE-CICS                          31568200
315683                 MOVE SUT00017-CK-AFT-DAY-QTY                     31568300
315684                      TO PV-DISPLAY-CK-AFT-DAY-QTY                31568400
315685                 STRING 'CHECK AFTER DAYS = '                     31568500
315686                               DELIMITED BY SIZE                  31568600
315687                         PV-DISPLAY-CK-AFT-DAY-QTY                31568700
315688                               DELIMITED BY SIZE                  31568800
315689                               INTO PV-CICS-MSG-AREA              31568900
315690                 PERFORM 9990-WRITE-CICS                          31569000
315691                 MOVE PV-LIMIT-DAYS                               31569100
315692                           TO PV-DISPLAY-LIMIT-DAYS               31569200
315693                 STRING 'PV-LIMIT-DAYS  = '                       31569300
315694                               DELIMITED BY SIZE                  31569400
315695                        PV-DISPLAY-LIMIT-DAYS                     31569500
315696                               DELIMITED BY SIZE                  31569600
315697                               INTO PV-CICS-MSG-AREA              31569700
315698                 PERFORM 9990-WRITE-CICS                          31569800
315699             END-IF                                               31569900
315700         ELSE                                                     31570000
315701             MOVE 'DEPT RANK FOUND '                              31570100
315702                                 TO PV-CICS-MSG-AREA              31570200
315703             PERFORM 9990-WRITE-CICS                              31570300
315704             MOVE SUT00017-CK-AFT-DAY-QTY                         31570400
315705                  TO PV-DISPLAY-CK-AFT-DAY-QTY                    31570500
315706             STRING 'CHECK AFTER DAYS = '                         31570600
315707                           DELIMITED BY SIZE                      31570700
315708                     PV-DISPLAY-CK-AFT-DAY-QTY                    31570800
315709                           DELIMITED BY SIZE                      31570900
315710                           INTO PV-CICS-MSG-AREA                  31571000
315711             PERFORM 9990-WRITE-CICS                              31571100
315712             MOVE PV-LIMIT-DAYS                                   31571200
315713                       TO PV-DISPLAY-LIMIT-DAYS                   31571300
315714             STRING 'PV-LIMIT-DAYS  = '                           31571400
315715                           DELIMITED BY SIZE                      31571500
315716                    PV-DISPLAY-LIMIT-DAYS                         31571600
315717                           DELIMITED BY SIZE                      31571700
315718                           INTO PV-CICS-MSG-AREA                  31571800
315719             PERFORM 9990-WRITE-CICS                              31571900
315720         END-IF                                                   31572000
315721     ELSE                                                         31572100
315722         PERFORM 7250-RETREIVE-VENDOR-DEPT                        31572200
315723         IF PS-NO-DEPT-RANK-FOUND                                 31572300
315724             PERFORM 7350-RETREIVE-VENDOR-RANK                    31572400
315725             IF PS-NO-VEND-RANK-FOUND                             31572500
315726                 PERFORM 7450-RETREIVE-DEFAULT-RANK               31572600
315727                 IF PS-DEFAULT-RANK-FOUND                         31572700
315728                     MOVE 'DEFAULT RANK FOUND '                   31572800
315729                                     TO PV-CICS-MSG-AREA          31572900
315730                     PERFORM 9990-WRITE-CICS                      31573000
315731                     MOVE SUT00017-CK-AFT-DAY-QTY                 31573100
315732                          TO PV-DISPLAY-CK-AFT-DAY-QTY            31573200
315733                     STRING 'CHECK AFTER DAYS = '                 31573300
315734                                   DELIMITED BY SIZE              31573400
315735                             PV-DISPLAY-CK-AFT-DAY-QTY            31573500
315736                                   DELIMITED BY SIZE              31573600
315737                                   INTO PV-CICS-MSG-AREA          31573700
315738                     PERFORM 9990-WRITE-CICS                      31573800
315739                     MOVE PV-LIMIT-DAYS                           31573900
315740                               TO PV-DISPLAY-LIMIT-DAYS           31574000
315741                     STRING 'PV-LIMIT-DAYS  = '                   31574100
315742                                   DELIMITED BY SIZE              31574200
315743                            PV-DISPLAY-LIMIT-DAYS                 31574300
315744                                   DELIMITED BY SIZE              31574400
315745                                   INTO PV-CICS-MSG-AREA          31574500
315746                     PERFORM 9990-WRITE-CICS                      31574600
315747                 END-IF                                           31574700
315748             ELSE                                                 31574800
315749                 MOVE 'VEND RANK FOUND '                          31574900
315750                                 TO PV-CICS-MSG-AREA              31575000
315751                 PERFORM 9990-WRITE-CICS                          31575100
315752                 MOVE SUT00017-CK-AFT-DAY-QTY                     31575200
315753                      TO PV-DISPLAY-CK-AFT-DAY-QTY                31575300
315754                 STRING 'CHECK AFTER DAYS = '                     31575400
315755                               DELIMITED BY SIZE                  31575500
315756                         PV-DISPLAY-CK-AFT-DAY-QTY                31575600
315757                               DELIMITED BY SIZE                  31575700
315758                               INTO PV-CICS-MSG-AREA              31575800
315759                 PERFORM 9990-WRITE-CICS                          31575900
315760                 MOVE PV-LIMIT-DAYS                               31576000
315761                           TO PV-DISPLAY-LIMIT-DAYS               31576100
315762                 STRING 'PV-LIMIT-DAYS  = '                       31576200
315763                               DELIMITED BY SIZE                  31576300
315764                        PV-DISPLAY-LIMIT-DAYS                     31576400
315765                               DELIMITED BY SIZE                  31576500
315766                               INTO PV-CICS-MSG-AREA              31576600
315767                 PERFORM 9990-WRITE-CICS                          31576700
315768             END-IF                                               31576800
315769         ELSE                                                     31576900
315770             MOVE 'DEPT RANK FOUND '                              31577000
315771                                 TO PV-CICS-MSG-AREA              31577100
315772             PERFORM 9990-WRITE-CICS                              31577200
315773             MOVE SUT00017-CK-AFT-DAY-QTY                         31577300
315774                  TO PV-DISPLAY-CK-AFT-DAY-QTY                    31577400
315775             STRING 'CHECK AFTER DAYS = '                         31577500
315776                           DELIMITED BY SIZE                      31577600
315777                     PV-DISPLAY-CK-AFT-DAY-QTY                    31577700
315778                           DELIMITED BY SIZE                      31577800
315779                           INTO PV-CICS-MSG-AREA                  31577900
315780             PERFORM 9990-WRITE-CICS                              31578000
315781             MOVE PV-LIMIT-DAYS                                   31578100
315782                       TO PV-DISPLAY-LIMIT-DAYS                   31578200
315783             STRING 'PV-LIMIT-DAYS  = '                           31578300
315784                           DELIMITED BY SIZE                      31578400
315785                    PV-DISPLAY-LIMIT-DAYS                         31578500
315786                           DELIMITED BY SIZE                      31578600
315787                           INTO PV-CICS-MSG-AREA                  31578700
315788             PERFORM 9990-WRITE-CICS                              31578800
315789         END-IF                                                   31578900
315790     END-IF.                                                      31579000
315791                                                                  31579100
315792*-----------------------------------------------------------------31579200
315793*CHECK TO SEE IF THE PO NEEDS TO BE AUDITED                       31579300
315794*-----------------------------------------------------------------31579400
315795 1200-CHECK-PO-AUDIT-EXC.                                         31579500
315796     STRING ' 1200-CHECK-PO-AUDIT-EXC'                            31579600
315797         DELIMITED BY SIZE                                        31579700
315798         INTO PV-CICS-MSG-AREA.                                   31579800
315799     PERFORM 9990-WRITE-CICS.                                     31579900
315800     SET PS-NO-LINE-LEVEL-FOUND                                   31580000
315801         PS-NO-PO-LEVEL-FOUND    TO TRUE.                         31580100
315802     IF PS-NO-LINE-LEVEL-FOUND                                    31580200
315803         PERFORM 7600-SELECT-PO-LEVEL                             31580300
315804     END-IF.                                                      31580400
315805                                                                  31580500
315806*-----------------------------------------------------------------31580600
315807*CHECK TO SEE IF THE PO NEEDS TO BE AUDITED                       31580700
315808*-----------------------------------------------------------------31580800
315809 1300-CHECK-PO-AUDIT-REQ.                                         31580900
315810     STRING ' 1300-CHECK-PO-AUDIT-REQ'                            31581000
315811         DELIMITED BY SIZE                                        31581100
315812         INTO PV-CICS-MSG-AREA.                                   31581200
315813     PERFORM 9990-WRITE-CICS.                                     31581300
315814     SET PS-NO-FAILED-AUDITS-FOUND                                31581400
315815         PS-NO-PASSED-AUDITS-FOUND    TO TRUE.                    31581500
315816     PERFORM 7700-SELECT-FAILED.                                  31581600
315817     IF PS-NO-FAILED-AUDITS-FOUND                                 31581700
315818         PERFORM 7800-SELECT-PASSED                               31581800
315819     END-IF.                                                      31581900
315820                                                                  31582000
315821*  AN AUDIT FOR THIS PO (LINE OR PREPACK-ID) HAS FAILED, SO       31582100
315822*  THIS CARTON MUST BE AUDITED                                    31582200
315823                                                                  31582300
315824     IF PS-FAILED-AUDITS-FOUND                                    31582400
315825         SET PS-AUDIT-IS-REQUIRED TO TRUE                         31582500
315826     END-IF.                                                      31582600
315827                                                                  31582700
315828                                                                  31582800
315829*-----------------------------------------------------------------31582900
315830* CHECK FOR IN PROCESS AUDIT                                      31583000
315831*-----------------------------------------------------------------31583100
315832 1400-CHECK-FOR-IN-PROCES-AUDIT.                                  31583200
315833     STRING ' 1400-CHECK-FOR-IN-PROCES-AUDIT'                     31583300
315834         DELIMITED BY SIZE                                        31583400
315835         INTO PV-CICS-MSG-AREA.                                   31583500
315836     PERFORM 9990-WRITE-CICS.                                     31583600
315837     PERFORM 7900-SELECT-THIS-FACILITY.                           31583700
315838                                                                  31583800
315839                                                                  31583900
315840*-----------------------------------------------------------------31584000
315841* COUNT # OF LINES FOR PROMPTED AUDIT                             31584100
315842*-----------------------------------------------------------------31584200
315843 1410-CHECK-PROMPTED-LINES.                                       31584300
315844     STRING ' 1410-CHECK-PROMPTED-LINES'                          31584400
315845         DELIMITED BY SIZE                                        31584500
315846         INTO PV-CICS-MSG-AREA.                                   31584600
315847     PERFORM 9990-WRITE-CICS.                                     31584700
315848     PERFORM 7950-SELECT-PROMPTED-LINES.                          31584800
315849                                                                  31584900
315850                                                                  31585000
315851*-----------------------------------------------------------------31585100
315852* DETERMINE AUDIT STATUS                                          31585200
315853*-----------------------------------------------------------------31585300
315854 1430-DETERMINE-STAT-CDE.                                         31585400
315855     STRING ' 1430-DETERMINE-STAT-CDE'                            31585500
315856         DELIMITED BY SIZE                                        31585600
315857         INTO PV-CICS-MSG-AREA.                                   31585700
315858     PERFORM 9990-WRITE-CICS.                                     31585800
315859**    AUDIT IS NO LONGER NEEDED OR HAS PASSED AN AUDIT            31585900
315860     IF SUT00015-AUD-STAT-CDE = PC-N OR                           31586000
315861        SUT00015-AUD-STAT-CDE = PC-P                              31586100
315862         SET SU021-RFID-AUDIT-IS-COMPLETE TO TRUE                 31586200
315863     ELSE                                                         31586300
315864**    HAS FAILED AN AUDIT                                         31586400
315865         IF SUT00015-AUD-STAT-CDE = PC-F                          31586500
315866             SET SU021-RFID-REWORK TO TRUE                        31586600
315867         ELSE                                                     31586700
315868**    AN AUDIT IS IN-PROCESS                                      31586800
315869             IF SUT00015-AUD-STAT-CDE = PC-I                      31586900
315870                 MOVE SUT00015-AUD-CNTL-NBR  TO PV-AUDIT-CNTL-NBR 31587000
315871                                                DK-AUDIT-CNTL-NBR 31587100
315872*  IF THIS CARTON HAS ALREADY BEEN SCANNED, GO THROUGH THE LOGIC  31587200
315873*  THIS FAR TO DETERMINBE THE RETURN STATUS - DO NOT DO ANY       31587300
315874*  INSERTS OR UPDATES ON THE DATABASES.                           31587400
315875                 IF PS-CARTON-ALREADY-EXISTS AND                  31587500
315876                    SUT00015-AUD-CNTL-NBR = SUATRN-AUD-CNTL-NBR   31587600
315877                     SET SU021-RFID-AUDIT-PENDING  TO TRUE        31587700
315878                 ELSE                                             31587800
315879                     PERFORM 1460-CHECK-IF-PROMPTING-DONE         31587900
315880                 END-IF                                           31588000
315881             END-IF                                               31588100
315882         END-IF                                                   31588200
315883     END-IF.                                                      31588300
315884                                                                  31588400
315885*-----------------------------------------------------------------31588500
315886* CHECK IF PROMPTING DONE                                         31588600
315887*-----------------------------------------------------------------31588700
315888 1460-CHECK-IF-PROMPTING-DONE.                                    31588800
315889     STRING ' 1460-CHECK-IF-PROMPTING-DONE'                       31588900
315890         DELIMITED BY SIZE                                        31589000
315891         INTO PV-CICS-MSG-AREA.                                   31589100
315892     PERFORM 9990-WRITE-CICS.                                     31589200
315893*    DETERMINE CARTON COUNT                                       31589300
315894     PERFORM 1660-BUILD-TSUATRN                                   31589400
315895     IF PS-DUMP-TO-LOG                                            31589500
315896        CONTINUE                                                  31589600
315897     ELSE                                                         31589700
315898        PERFORM 8200-SUM-CARTONS                                  31589800
315899        IF SUT00015-CART-QTY > PV-CARTON-COUNT                    31589900
315900             CONTINUE                                             31590000
315901        ELSE                                                      31590100
315902             PERFORM 1490-UPDATE-REQ-BY-TYPE                      31590200
315903        END-IF                                                    31590300
315904        SET SU021-RFID-AUDIT-REQUIRED TO TRUE                     31590400
315905     END-IF.                                                      31590500
315906                                                                  31590600
315907*---------------------------------------------------------------  31590705
315908*  UPDATE PROMPT AUDIT CODE                                       31590805
315909*---------------------------------------------------------------  31590905
315910 1490-UPDATE-REQ-BY-TYPE.                                         31591000
315911     STRING ' 1490-UPDATE-REQ-BY-TYPE'                            31591100
315912         DELIMITED BY SIZE                                        31591200
315913         INTO PV-CICS-MSG-AREA.                                   31591300
315914     PERFORM 9990-WRITE-CICS.                                     31591400
315915                                                                  31591501
315916     IF SU021-USER-ID  = 'TKMA352' OR 'TKMA135' OR 'TKMA738'      31591605
315917        CONTINUE                                                  31591701
315918     ELSE                                                         31591801
315919        PERFORM 8700-UPDATE-SUT-PO-AUD-REQ                        31591903
315920     END-IF.                                                      31592002
315921                                                                  31592101
315922*-----------------------------------------------------------------31592200
315923*DETERMINE THE NUMBER OF CARTONS OR UNITS TO BE AUDITED.          31592300
315924*-----------------------------------------------------------------31592400
315925 1500-CALCULATE-QUANTITIES.                                       31592500
315926     STRING ' 1500-CALCULATE-QUANTITIES'                          31592600
315927         DELIMITED BY SIZE                                        31592700
315928         INTO PV-CICS-MSG-AREA.                                   31592800
315929     PERFORM 9990-WRITE-CICS.                                     31592900
315930     IF SU021-PACKAGE-TYPE-CODE = 'RF'                            31593000
315931*        RF WORKS LIKE PACK-BY-STORE                              31593105
315932         PERFORM 1530-CALCULATE-RFID                              31593200
315933     END-IF.                                                      31593300
315934                                                                  31593400
315935*-----------------------------------------------------------------31593500
315936* CALCULATE CARTONS TO BE AUDITED                                 31593600
315937*-----------------------------------------------------------------31593700
315938 1530-CALCULATE-RFID.                                             31593800
315939     STRING ' 1530-CALCULATE-RFID'                                31593900
315940         DELIMITED BY SIZE                                        31594000
315941         INTO PV-CICS-MSG-AREA.                                   31594100
315942     PERFORM 9990-WRITE-CICS.                                     31594200
315943     MOVE ZERO                 TO PV-UNITS-TO-AUDIT.              31594300
315944     PERFORM 8250-SELECT-EXPECTD-CNT.                             31594400
315945**  ADD 1 CARTON BECAUSE THE SUBSELECT IN THE 8250- PARA          31594500
315946**  REMOVED THE CURRENT CARTON THAT IS BEING PROCESSED            31594600
315947     COMPUTE PV-DB2-COUNT-EXP-SCN =                               31594700
315948             PV-DB2-COUNT-EXP-SCN + 1.                            31594800
315949     IF SUT00017-AUD-PCT > 0 AND                                  31594900
315950        PV-DB2-COUNT-EXP-SCN > 0                                  31595000
315951         COMPUTE PV-CARTONS-TO-AUDIT ROUNDED =                    31595100
315952           (PV-DB2-COUNT-EXP-SCN * (SUT00017-AUD-PCT / 100))      31595200
315953         IF PV-CARTONS-TO-AUDIT < 1                               31595300
315954             MOVE 1 TO    PV-CARTONS-TO-AUDIT                     31595400
315955         END-IF                                                   31595500
315956     ELSE                                                         31595600
315957         MOVE PV-DB2-COUNT-EXP-SCN TO PV-CARTONS-TO-AUDIT         31595700
315958     END-IF.                                                      31595800
315959     IF PV-CARTONS-TO-AUDIT < SUT00017-MIN-CART-CKD-QTY AND       31595900
315960        PV-DB2-COUNT-EXP-SCN > SUT00017-MIN-CART-CKD-QTY          31596000
315961         MOVE SUT00017-MIN-CART-CKD-QTY TO PV-CARTONS-TO-AUDIT    31596100
315962     ELSE                                                         31596200
315963         IF PV-CARTONS-TO-AUDIT > SUT00017-MAX-CART-CKD-QTY       31596300
315964             MOVE SUT00017-MAX-CART-CKD-QTY                       31596400
315965                                        TO PV-CARTONS-TO-AUDIT    31596500
315966         END-IF                                                   31596600
315967     END-IF.                                                      31596700
315968                                                                  31596800
315969*-----------------------------------------------------------------31596900
315970* INSERT THE AUDIT INFORMATION TO THE TABLES                      31597000
315971*-----------------------------------------------------------------31597100
315972 1600-INSERT-INTO-TABLES.                                         31597200
315973     STRING ' 1600-INSERT-INTO-TABLES'                            31597300
315974         DELIMITED BY SIZE                                        31597400
315975         INTO PV-CICS-MSG-AREA.                                   31597500
315976     PERFORM 9990-WRITE-CICS.                                     31597600
315977     SET PS-AUDIT-NBR-EXISTS  TO TRUE.                            31597700
315978                                                                  31597800
315979     PERFORM UNTIL PS-AUDIT-NBR-NOT-EXISTS                        31597900
315980         PERFORM 1620-CREATE-RANDOM-NBR                           31598000
315981                                                                  31598100
315982         MOVE DP902-RANDOM-NUMBER TO PV-AUDIT-CNTL-NBR            31598200
315983         PERFORM 8550-VALIDATE-AUDIT-NBR                          31598300
315984     END-PERFORM.                                                 31598400
315985                                                                  31598500
315986     MOVE PV-AUDIT-CNTL-NBR       TO SU021-RFID-AUDIT-NUMBER.     31598600
315987     PERFORM 1640-BUILD-TSUNAUD.                                  31598700
315988     IF PS-DUMP-TO-LOG                                            31598800
315989         CONTINUE                                                 31598900
315990     ELSE                                                         31599000
315991         PERFORM 1660-BUILD-TSUATRN                               31599100
315992         IF PS-DUMP-TO-LOG                                        31599200
315993             CONTINUE                                             31599300
315994         ELSE                                                     31599400
315995             PERFORM 1680-BUILD-SUT-PO-AUD-REQ                    31599500
315996         END-IF                                                   31599600
315997     END-IF.                                                      31599700
315998******************************************************************31599800
315999*  THIS PARAGRAPH WILL RANDOMLY CREATE A NEW AUDIT CNTL NUMBER   *31599900
316000******************************************************************31600000
316001 1620-CREATE-RANDOM-NBR.                                          31600100
316002                                                                  31600200
316003     STRING ' 1620-CREATE-RANDOM-NBR'                             31600300
316004         DELIMITED BY SIZE                                        31600400
316005         INTO PV-CICS-MSG-AREA.                                   31600500
316006     PERFORM 9990-WRITE-CICS.                                     31600600
316007     INITIALIZE DP902-RANDNBR-ROUTINE-FIELDS.                     31600700
316008     CALL PC-RANDOM-NBR-GENERATOR USING                           31600800
316009                            DFHEIBLK                              31600900
316010                            DFHCOMMAREA                           31601000
316011                            DP902-RANDNBR-ROUTINE-FIELDS.         31601100
316012                                                                  31601200
316013     IF DP902-SUCCESSFUL                                          31601300
316014         CONTINUE                                                 31601400
316015     ELSE                                                         31601500
316016         SET SU021-RFID-DB2-ERROR TO TRUE                         31601600
316017         SET PS-ERROR TO TRUE                                     31601700
316018     END-IF.                                                      31601800
316019                                                                  31601900
316020*-----------------------------------------------------------------31602000
316021* INSERT TSUNAUD                                                  31602100
316022*-----------------------------------------------------------------31602200
316023 1640-BUILD-TSUNAUD.                                              31602300
316024     STRING ' 1640-BUILD-TSUNAUD'                                 31602400
316025         DELIMITED BY SIZE                                        31602500
316026         INTO PV-CICS-MSG-AREA.                                   31602600
316027     PERFORM 9990-WRITE-CICS.                                     31602700
316028     INITIALIZE DCLTSUNAUD.                                       31602800
316029                                                                  31602900
316030     MOVE PV-AUDIT-CNTL-NBR       TO SUNAUD-AUD-CNTL-NBR.         31603000
316031     MOVE +0                      TO SUNAUD-AUD-PSPND-MNIT-QTY    31603100
316032                                     SUNAUD-AUD-CLO-MNIT-QTY.     31603200
316033     MOVE SU021-USER-ID           TO SUNAUD-AUD-USR-ID.           31603300
316034     MOVE SU021-OPER-UNT-ID       TO SUNAUD-OPER-UNT-ID.          31603400
316035     MOVE 1                       TO SUNAUD-FCLTY-ID.             31603500
316036     MOVE 'RECV  '                TO SUNAUD-PRC-FCLTY-AREA-ID.    31603600
316037                                                                  31603700
316038     MOVE PC-IP                   TO SUNAUD-AUD-STAT-CDE.         31603800
316039     MOVE PC-02                   TO SUNAUD-AUD-TYP-CDE.          31603900
316040     MOVE PC-R                    TO SUNAUD-AUD-CAT-CDE.          31604000
316041     MOVE PC-N                    TO SUNAUD-DEST-TYP-CDE.         31604100
316042     PERFORM 8300-INSERT-TSUNAUD.                                 31604200
316043                                                                  31604300
316044*-----------------------------------------------------------------31604400
316045* INSERT TSUATRN                                                  31604500
316046*-----------------------------------------------------------------31604600
316047 1660-BUILD-TSUATRN.                                              31604700
316048                                                                  31604800
316049     STRING ' 1660-BUILD-TSUATRN'                                 31604900
316050         DELIMITED BY SIZE                                        31605000
316051         INTO PV-CICS-MSG-AREA.                                   31605100
316052     PERFORM 9990-WRITE-CICS.                                     31605200
316053     INITIALIZE DCLTSUATRN.                                       31605300
316054     MOVE SU021-SHIPT-UNT-ID      TO DK-SHIPT-UNT-ID.             31605400
316055     PERFORM 8000-SELECT-SHPUNT.                                  31605500
316056     MOVE PV-AUDIT-CNTL-NBR       TO SUATRN-AUD-CNTL-NBR.         31605600
316057     MOVE SU021-SHIPT-UNT-ID      TO SUATRN-SHIPT-UNT-ID.         31605700
316058     MOVE SPACES                  TO SUATRN-UNT-AUD-USR-ID.       31605800
316059     MOVE PC-IP                   TO SUATRN-UNT-AUD-STAT-CDE.     31605900
316060     MOVE SU021-PO-NUMBER         TO SUATRN-TRN-NBR.              31606000
316061     MOVE SU021-REC-SEQ-NBR       TO SUATRN-REC-SEQ-NBR.          31606100
316062     MOVE SHPUNT-DEST-OPER-UNT-ID TO SUATRN-DEST-OPER-UNT-ID.     31606200
316063     MOVE PC-N                    TO SUATRN-UNT-AUD-ERR-IND.      31606300
316064     PERFORM 8350-INSERT-TSUATRN.                                 31606400
316065                                                                  31606500
316066*-----------------------------------------------------------------31606600
316067* INSERT PO AUDIT REQUESTED TABLE                                 31606700
316068*-----------------------------------------------------------------31606800
316069 1680-BUILD-SUT-PO-AUD-REQ.                                       31606900
316070                                                                  31607000
316071     STRING ' 1680-BUILD-SUT-PO-AUD-REQ'                          31607100
316072         DELIMITED BY SIZE                                        31607200
316073         INTO PV-CICS-MSG-AREA.                                   31607300
316074     PERFORM 9990-WRITE-CICS.                                     31607400
316075     INITIALIZE DCLSUT00015.                                      31607500
316076     MOVE SU021-PO-NUMBER         TO SUT00015-PO-NBR.             31607600
316077*    -9999 MEANS ITS AN RFID AUDIT                                31607705
316078     MOVE -9999                   TO SUT00015-PO-PREPK-ID.        31607805
316079     MOVE SU021-OPER-UNT-ID       TO SUT00015-OPER-UNT-ID.        31607900
316080     MOVE SU021-INBOUND-TRIP-ID   TO SUT00015-INBND-TRIP-ID.      31608000
316081     MOVE SU021-REC-SEQ-NBR       TO SUT00015-RCVR-SEQ-NBR.       31608100
316082     MOVE PV-AUDIT-CNTL-NBR       TO SUT00015-AUD-CNTL-NBR.       31608200
316083     MOVE SUT00017-VND-RNKG-CDE   TO SUT00015-VND-RNKG-CDE.       31608300
316084     MOVE SUT00017-PKGNG-TYP-CDE  TO SUT00015-PKGNG-TYP-CDE.      31608400
316085     MOVE SUT00017-EFF-BEG-TMST   TO SUT00015-EFF-BEG-TMST.       31608500
316086     MOVE PV-CARTONS-TO-AUDIT     TO SUT00015-CART-QTY.           31608600
316087     IF PV-UNITS-TO-AUDIT > 0 AND                                 31608700
316088        SUT00017-CKD-PCT > 0                                      31608800
316089         COMPUTE PV-UNT-QTY ROUNDED =                             31608900
316090                 (PV-UNITS-TO-AUDIT *                             31609000
316091                 ((PC-100 - SUT00017-CKD-PCT) / 100))             31609100
316092         IF PV-UNT-QTY < 1                                        31609200
316093             MOVE 1              TO SUT00015-UNT-QTY              31609300
316094         ELSE                                                     31609400
316095             COMPUTE SUT00015-UNT-QTY ROUNDED =                   31609500
316096                        PV-UNT-QTY * 1                            31609600
316097         END-IF                                                   31609700
316098     ELSE                                                         31609800
316099         MOVE PV-UNITS-TO-AUDIT  TO SUT00015-UNT-QTY              31609900
316100     END-IF.                                                      31610000
316101     MOVE +0                      TO SUT00015-AUD-UNT-QTY.        31610100
316102     MOVE +0                      TO SUT00015-AUD-CART-QTY.       31610200
316103     MOVE PC-I                    TO SUT00015-AUD-STAT-CDE.       31610300
316104     IF SU021-DEFERRED-AUDIT-IND = 'Y'                            31610400
316105         MOVE 'N'                 TO SUT00015-DFRD-AUD-IND        31610500
316106     ELSE                                                         31610600
316107         MOVE 'Y'                 TO SUT00015-DFRD-AUD-IND        31610700
316108     END-IF.                                                      31610800
316109     MOVE ZERO                    TO SUT00015-AUD-ERR-PCT.        31610900
316110     MOVE +0              TO SHUUPC-SHPD-QTY                      31611000
316111     IF PV-CARTONS-TO-AUDIT = 1                                   31611100
316112         MOVE PC-D                TO SUT00015-CART-PRMPT-CDE      31611200
316113     ELSE                                                         31611300
316114         MOVE PC-C            TO SUT00015-CART-PRMPT-CDE          31611400
316115     END-IF.                                                      31611500
316116     MOVE PURCHS-ENT-ID           TO SUT00015-ENT-ID.             31611600
316117     MOVE PURCHS-DEPT-NBR         TO SUT00015-DEPT-NBR.           31611700
316118     PERFORM 8400-INSERT-PO-AUD-REQ.                              31611800
316119*    UPDATE THE QC AUDIT ROW WITH THE RFID# IN RWRK               31611905
316120     PERFORM 8410-UPDATE-SUT-PO-AUD-REQ.                          31612000
316121                                                                  31612100
316122 1700-RETURN-WITH-EXC-VALUES.                                     31612200
316123     STRING ' 1700-RETURN-WITH-EXC-VALUES'                        31612300
316124         DELIMITED BY SIZE                                        31612400
316125         INTO PV-CICS-MSG-AREA.                                   31612500
316126     PERFORM 9990-WRITE-CICS.                                     31612600
316127*                                                                 31612705
316128     IF SUT00014-AUD-TYP-CDE = PC-N                               31612800
316129         SET SU021-RFID-AUDIT-IS-COMPLETE TO TRUE                 31612900
316130     ELSE                                                         31613000
316131         IF SUT00014-AUD-TYP-CDE = PC-A OR PC-R                   31613100
316132             SET SU021-RFID-100-PC-AUDIT-REQD TO TRUE             31613200
316133         ELSE                                                     31613300
316134            IF SUT00014-AUD-TYP-CDE = PC-Q                        31613405
316135               CONTINUE                                           31613505
316136            ELSE                                                  31613605
316137               SET SU021-RFID-DB2-ERROR TO TRUE                   31613700
316138            END-IF                                                31613805
316139         END-IF                                                   31613900
316140     END-IF.                                                      31614000
316141                                                                  31614100
316142 2000-AUDIT-CARTON-DATA.                                          31614200
316143     STRING ' 2000-AUDIT-CARTON-DATA'                             31614300
316144         DELIMITED BY SIZE                                        31614400
316145         INTO PV-CICS-MSG-AREA.                                   31614500
316146     PERFORM 9990-WRITE-CICS.                                     31614600
316147                                                                  31614700
316148 7000-SELECT-REQ-INFO.                                            31614800
316149     STRING ' 7000-SELECT-REQ-INFO'                               31614900
316150         DELIMITED BY SIZE                                        31615000
316151         INTO PV-CICS-MSG-AREA.                                   31615100
316152     PERFORM 9990-WRITE-CICS.                                     31615200
316153                                                                  31615300
316154     INITIALIZE DCLSUT00015.                                      31615400
316155                                                                  31615500
316156     EXEC SQL                                                     31615600
316157          SELECT AUD_CNTL_NBR                                     31615700
316158             ,   VND_RNKG_CDE                                     31615800
316159             ,   PKGNG_TYP_CDE                                    31615900
316160             ,   EFF_BEG_TMST                                     31616000
316161             ,   AUD_STAT_CDE                                     31616100
316162             ,   CART_PRMPT_CDE                                   31616200
316163             ,   ENT_ID                                           31616300
316164             ,   DEPT_NBR                                         31616400
316165          INTO   :SUT00015-AUD-CNTL-NBR                           31616500
316166             ,   :SUT00015-VND-RNKG-CDE                           31616600
316167             ,   :SUT00015-PKGNG-TYP-CDE                          31616700
316168             ,   :SUT00015-EFF-BEG-TMST                           31616800
316169             ,   :SUT00015-AUD-STAT-CDE                           31616900
316170             ,   :SUT00015-CART-PRMPT-CDE                         31617000
316171             ,   :SUT00015-ENT-ID                                 31617100
316172             ,   :SUT00015-DEPT-NBR                               31617200
316173          FROM   SUT_PO_AUD_REQ                                   31617300
316174          WHERE  PO_NBR         = :DK-PO-NBR                      31617400
316175            AND  PO_LNE_NBR     = :DK-PO-LINE-NBR                 31617500
316176            AND  PO_PREPK_ID    = :DK-PREPK-ID                    31617600
316177            AND  RCVR_SEQ_NBR   = :DK-RCVR-SEQ-NBR                31617700
316178            AND  OPER_UNT_ID    = :DK-OPER-UNT-ID                 31617800
316179           AND   PKGNG_TYP_CDE  = 'RF'                            31617905
316180     END-EXEC.                                                    31618000
316181                                                                  31618100
316182     EVALUATE TRUE                                                31618200
316183         WHEN SQLCODE = ZERO                                      31618300
316184         WHEN SQLCODE = -811                                      31618400
316185             SET PS-REQ-REC-FOUND TO TRUE                         31618500
316186         WHEN SQLCODE = +100                                      31618600
316187             SET PS-NO-REQ-REC-FOUND TO TRUE                      31618700
316188         WHEN SQLWARN0 NOT = SPACES                               31618800
316189         WHEN SQLCODE NOT EQUAL ZERO                              31618900
316190             MOVE '7000-SELECT-REQ-INFO'                          31619000
316191                             TO DP013-PARAGRAPH                   31619100
316192             MOVE 'SUKCS720 - GET BULK REQ RECS'                  31619200
316193                             TO DP013-MESSAGE-TEXT(1)             31619300
316194             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 31619400
316195             STRING 'PO NBR: '         DELIMITED BY SIZE          31619500
316196                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          31619600
316197                           INTO DP013-MESSAGE-TEXT(2)             31619700
316198             MOVE DK-PO-LINE-NBR TO PV-DISPLAY-PO-LINE-NBR        31619800
316199             STRING 'PO LINE NBR: '    DELIMITED BY SIZE          31619900
316200                PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE          31620000
316201                           INTO DP013-MESSAGE-TEXT(3)             31620100
316202             MOVE DK-RCVR-SEQ-NBR                                 31620200
316203                             TO PV-DISPLAY-RCVR-SEQ-NBR           31620300
316204             STRING 'RECV SEQ: '       DELIMITED BY SIZE          31620400
316205                 PV-DISPLAY-RCVR-SEQ-NBR                          31620500
316206                                       DELIMITED BY SIZE          31620600
316207                           INTO DP013-MESSAGE-TEXT(4)             31620700
316208             MOVE SQLCA      TO DP013-SQLCA                       31620800
316209             MOVE 'SUT00015' TO DP013-DB2-TABLE-NAME(1)           31620900
316210             SET DP013-DB2-ABEND                                  31621000
316211                             TO TRUE                              31621100
316212             SET DP013-NO-ROLLBACK                                31621200
316213                             TO TRUE                              31621300
316214             PERFORM 9999-WRITE-CICS-LOG-MSG                      31621400
316215             SET PS-DUMP-TO-LOG       TO TRUE                     31621500
316216             SET SU021-RFID-DB2-ERROR TO TRUE                     31621600
316217     END-EVALUATE.                                                31621700
316218                                                                  31621800
316219******************************************************************31621906
316220*  7100-CHECK-FOR-BYPASS                                         *31622006
316221*  USING THE PO/RECEIVER FROM THE COMM AREA, RUN THIS SQL TO     *31622106
316222*  SEE IF THE OPER_UNT_ID FROM TRECEIV MAY BE SET UP ON THE      *31622206
316223*  PARM TABLE FOR PARM BYRAUD TO SEE IF WE ARE TO BYPASS         *31622306
316224*  PROMPTING AN AUDIT FOR MERCHANDISE BEING WORKED FOR THAT      *31622406
316225*  OPER UNIT ID.                                                 *31622506
316226*  FYI - IF A ROW IS FOUND IN THIS SQL, THAT MEANS THE DC IS     *31622606
316227*  SET UP TO BYPASS AUDIT PROMPTING - WHEN THAT IS THE CASE,     *31622706
316228*  THE PROGRAM WILL CHECK TO SEE IF SOMETHING HAD BEEN FOUND IN  *31622806
316229*  THE 1200-CHECK-PO-AUDIT-EXC PARAGRAPH AND IF NOT, THEN THE    *31622906
316230*  PROGRAM WILL SET THE PS-PO-LEVEL-FOUND TO TRUE AND MOVE A     *31623006
316231*  VALUE OF 'N' TO THE SUT00014-AUD-TYP-CDE FIELD SO THAT THE    *31623106
316232*  PROGRAM WILL NOW PROCESS THIS AUDIT CHECK AS IF THE RECEIVER  *31623206
316233*  WAS SET TO NO PROMPT FOR AUDITS.  IF AN EXCEPTION HAD BEEN    *31623306
316234*  FOUND IN THE 1200-CHECK-PO-AUDIT-EXC CALL, THEN NOTHING MORE  *31623406
316235*  WILL BE DONE AS THE PROGRAM WILL NOT PROMPT FOR AN AUDIT      *31623506
316236*  BECAUSE OF THE AUDIT EXCEPTION FOUND WHICH HAS PRIORITY OVER  *31623606
316237*  AUDIT PROMPTING.                                              *31623706
316238******************************************************************31623806
316239 7100-CHECK-FOR-BYPASS.                                           31623906
316240                                                                  31624006
316246     STRING ' SUKCS583 - '                                        31624606
316247            ' 7100-CHECK-FOR-BYPASS'                              31624706
316248         DELIMITED BY SIZE                                        31624806
316249         INTO PV-CICS-MSG-AREA.                                   31624906
316250     PERFORM 9990-WRITE-CICS.                                     31625006
316251     EXEC SQL                                                     31625106
316252          SELECT A.OPER_UNT_ID                                    31625206
316253          INTO   :RECEIV-OPER-UNT-ID                              31625306
316254          FROM   TRECEIV A                                        31625406
316255             ,   TKRPRPM B                                        31625506
316256          WHERE  A.ORD_NBR           = :DK-BYPASS-PO-NBR          31625606
316257            AND  A.REC_SEQ_NBR       = :DK-BYPASS-REC-SEQ-NBR     31625706
316258            AND  B.LOC_ID            = A.OPER_UNT_ID              31625806
316259            AND  B.INTFC_SYS_CDE     = 'AUD'                      31625906
316260            AND  B.SYS_PRC_FUNC_CDE  = 'BYRAUD'                   31626006
316261            AND  B.FUNC_TXT          = 'Y'                        31626106
316262            AND  B.FUNC_BEG_TMST    <= CURRENT TIMESTAMP          31626206
316263            AND  B.FUNC_END_TMST    >= CURRENT TIMESTAMP          31626306
316264            AND  B.FUNC_PRC_STAT_CDE = 'AC'                       31626406
316265           WITH UR                                                31626506
316266     END-EXEC.                                                    31626606
316267                                                                  31626706
316268     EVALUATE TRUE                                                31626806
316269         WHEN SQLCODE = ZERO                                      31626906
316270             SET PS-BYPASS-PROMPT-AUDIT TO TRUE                   31627006
316271             IF  PS-NO-LINE-LEVEL-FOUND                           31627106
316272             AND PS-NO-PO-LEVEL-FOUND                             31627206
316273                 SET PS-PO-LEVEL-FOUND TO TRUE                    31627306
316274                 MOVE 'N' TO SUT00014-AUD-TYP-CDE                 31627406
316275             END-IF                                               31627506
316276         WHEN SQLCODE = +100                                      31627606
316277             SET PS-BYPASS-PROMPT-AUDIT-NO TO TRUE                31627706
316278         WHEN SQLWARN0 NOT = SPACES                               31627806
316279         WHEN SQLCODE NOT EQUAL ZERO                              31627906
316282                                                                  31628206
316283             MOVE '7100-CHECK-FOR-BYPASS '                        31628306
316284                             TO DP013-PARAGRAPH                   31628406
316285             MOVE 'SUKCS583 - CHECK FOR BYPASS OF AUDIT '         31628506
316286                             TO DP013-MESSAGE-TEXT(1)             31628606
316287             MOVE DK-BYPASS-PO-NBR  TO PV-DISPLAY-PO-NBR          31628706
316288             MOVE DK-BYPASS-REC-SEQ-NBR TO                        31628806
316289                  PV-DISPLAY-RCVR-SEQ-NBR                         31628906
316290             STRING 'PO/REC: '      PV-DISPLAY-PO-NBR             31629006
316291                    ' - '           PV-DISPLAY-RCVR-SEQ-NBR       31629106
316292              DELIMITED BY SIZE                                   31629206
316293                           INTO DP013-MESSAGE-TEXT(2)             31629306
316294             MOVE SQLCA      TO DP013-SQLCA                       31629406
316295             MOVE 'TRECEIV'  TO DP013-DB2-TABLE-NAME(1)           31629506
316296             MOVE 'TKRPRPM'  TO DP013-DB2-TABLE-NAME(2)           31629606
316297             SET DP013-DB2-ABEND                                  31629706
316298                             TO TRUE                              31629806
316299             SET DP013-NO-ROLLBACK                                31629906
316300                             TO TRUE                              31630006
316301             PERFORM 9999-WRITE-CICS-LOG-MSG                      31630106
316302             SET PS-DUMP-TO-LOG       TO TRUE                     31630206
316303             SET SU021-DB2-ERROR TO TRUE                          31630306
316304     END-EVALUATE.                                                31630406
316305                                                                  31630506
316306                                                                  31630600
316307 7150-RETREIVE-PO-INFO.                                           31630700
316308                                                                  31630800
316309     STRING ' 7150-RETREIVE-PO-INFO'                              31630900
316310         DELIMITED BY SIZE                                        31631000
316311         INTO PV-CICS-MSG-AREA.                                   31631100
316312     PERFORM 9990-WRITE-CICS.                                     31631200
316313     EXEC SQL                                                     31631300
316314          SELECT DEPT_NBR                                         31631400
316315              ,  ENT_ID                                           31631500
316316          INTO   :PURCHS-DEPT-NBR                                 31631600
316317              ,  :PURCHS-ENT-ID                                   31631700
316318          FROM   TPURCHS                                          31631800
316319          WHERE  PO_NBR   = :DK-PO-NBR                            31631900
316320            AND  VER_STATUS_CDE = 'A'                             31632000
316321     END-EXEC.                                                    31632100
316322                                                                  31632200
316323     EVALUATE TRUE                                                31632300
316324         WHEN SQLCODE = ZERO                                      31632400
316325             SET PS-PO-INFO-FOUND TO TRUE                         31632500
316326         WHEN SQLCODE = +100                                      31632600
316327             SET PS-NO-PO-INFO-FOUND TO TRUE                      31632700
316328         WHEN SQLWARN0 NOT = SPACES                               31632800
316329         WHEN SQLCODE NOT EQUAL ZERO                              31632900
316330             MOVE '7150-RETREIVE-PO-INFO'                         31633000
316331                             TO DP013-PARAGRAPH                   31633100
316332             MOVE 'SUKCS720 - GET PO INFO '                       31633200
316333                             TO DP013-MESSAGE-TEXT(1)             31633300
316334             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 31633400
316335             STRING 'PO NBR: '         DELIMITED BY SIZE          31633500
316336                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          31633600
316337                           INTO DP013-MESSAGE-TEXT(2)             31633700
316338             MOVE SQLCA      TO DP013-SQLCA                       31633800
316339             MOVE 'TPURCHS'  TO DP013-DB2-TABLE-NAME(1)           31633900
316340             SET DP013-DB2-ABEND                                  31634000
316341                             TO TRUE                              31634100
316342             SET DP013-NO-ROLLBACK                                31634200
316343                             TO TRUE                              31634300
316344             PERFORM 9999-WRITE-CICS-LOG-MSG                      31634400
316345             SET PS-DUMP-TO-LOG       TO TRUE                     31634500
316346             SET PS-NO-PO-INFO-FOUND TO TRUE                      31634600
316347             SET SU021-RFID-DB2-ERROR TO TRUE                     31634700
316348     END-EVALUATE.                                                31634800
316349                                                                  31634900
316350 7190-RETREIVE-PO-AUD-PARM.                                       31635000
316351                                                                  31635100
316352     STRING ' 7190-RETREIVE-PO-AUD-PARM'                          31635200
316353         DELIMITED BY SIZE                                        31635300
316354         INTO PV-CICS-MSG-AREA.                                   31635400
316355     PERFORM 9990-WRITE-CICS.                                     31635500
316356     EXEC SQL                                                     31635600
316357          SELECT VND_RNKG_CDE                                     31635700
316358              ,  PKGNG_TYP_CDE                                    31635800
316359              ,  EFF_BEG_TMST                                     31635900
316360              ,  AUD_PCT                                          31636000
316361              ,  CKD_PCT                                          31636100
316362              ,  MAX_CKD_QTY                                      31636200
316363              ,  MAX_CART_CKD_QTY                                 31636300
316364              ,  MIN_CART_CKD_QTY                                 31636400
316365              ,  CKD_DC_QTY                                       31636500
316366              ,  MAX_PO_LNE_QTY                                   31636600
316367              ,  CK_AFT_DAY_QTY                                   31636700
316368              ,  CK_AFT_RCVR_QTY                                  31636800
316369              ,  DAYS(CURRENT DATE) - (CK_AFT_DAY_QTY +1)         31636900
316370          INTO   :SUT00017-VND-RNKG-CDE                           31637000
316371              ,  :SUT00017-PKGNG-TYP-CDE                          31637100
316372              ,  :SUT00017-EFF-BEG-TMST                           31637200
316373              ,  :SUT00017-AUD-PCT                                31637300
316374              ,  :SUT00017-CKD-PCT                                31637400
316375              ,  :SUT00017-MAX-CKD-QTY                            31637500
316376              ,  :SUT00017-MAX-CART-CKD-QTY                       31637600
316377              ,  :SUT00017-MIN-CART-CKD-QTY                       31637700
316378              ,  :SUT00017-CKD-DC-QTY                             31637800
316379              ,  :SUT00017-MAX-PO-LNE-QTY                         31637900
316380              ,  :SUT00017-CK-AFT-DAY-QTY                         31638000
316381              ,  :SUT00017-CK-AFT-RCVR-QTY                        31638100
316382              ,  :PV-LIMIT-DAYS                                   31638200
316383          FROM   SUT_PO_AUD_PARM A                                31638300
316384          WHERE  A.VND_RNKG_CDE  = :SUT00015-VND-RNKG-CDE         31638400
316385            AND  A.PKGNG_TYP_CDE = :SUT00015-PKGNG-TYP-CDE        31638500
316386            AND  A.EFF_BEG_TMST  = :SUT00015-EFF-BEG-TMST         31638600
316387     END-EXEC.                                                    31638700
316388                                                                  31638800
316389     EVALUATE TRUE                                                31638900
316390         WHEN SQLCODE = ZERO                                      31639000
316391             CONTINUE                                             31639100
316392         WHEN SQLWARN0 NOT = SPACES                               31639200
316393         WHEN SQLCODE NOT EQUAL ZERO                              31639300
316394             MOVE '7190-RETREIVE-PO-AUD-PARM'                     31639400
316395                             TO DP013-PARAGRAPH                   31639500
316396             MOVE 'SUKCS720 - GET AUD PARM DATA '                 31639600
316397                             TO DP013-MESSAGE-TEXT(1)             31639700
316398             MOVE DK-ENT-ID   TO PV-DISPLAY-ENT-ID                31639800
316399             STRING 'ENT ID: '         DELIMITED BY SIZE          31639900
316400                 PV-DISPLAY-ENT-ID     DELIMITED BY SIZE          31640000
316401                           INTO DP013-MESSAGE-TEXT(2)             31640100
316402             MOVE DK-DEPT-NBR TO PV-DISPLAY-DEPT-NBR              31640200
316403             STRING 'DEPT NBR: '       DELIMITED BY SIZE          31640300
316404                 PV-DISPLAY-DEPT-NBR   DELIMITED BY SIZE          31640400
316405                           INTO DP013-MESSAGE-TEXT(3)             31640500
316406             STRING 'PKGNG TYPE: '     DELIMITED BY SIZE          31640600
316407                 DK-PKGNG-TYP-CDE      DELIMITED BY SIZE          31640700
316408                           INTO DP013-MESSAGE-TEXT(4)             31640800
316409             MOVE SQLCA      TO DP013-SQLCA                       31640900
316410             MOVE 'SUT00017' TO DP013-DB2-TABLE-NAME(1)           31641000
316411             SET DP013-DB2-ABEND                                  31641100
316412                             TO TRUE                              31641200
316413             SET DP013-NO-ROLLBACK                                31641300
316414                             TO TRUE                              31641400
316415             PERFORM 9999-WRITE-CICS-LOG-MSG                      31641500
316416             SET PS-DUMP-TO-LOG       TO TRUE                     31641600
316417             SET PS-NO-PO-INFO-FOUND TO TRUE                      31641700
316418             SET SU021-RFID-DB2-ERROR TO TRUE                     31641800
316419     END-EVALUATE.                                                31641900
316420                                                                  31642000
316421 7200-RETREIVE-VENDOR-DEPT.                                       31642100
316422                                                                  31642200
316423     STRING ' 7200-RETREIVE-VENDOR-DEPT'                          31642300
316424         DELIMITED BY SIZE                                        31642400
316425         INTO PV-CICS-MSG-AREA.                                   31642500
316426     PERFORM 9990-WRITE-CICS.                                     31642600
316427     EXEC SQL                                                     31642700
316428          SELECT B.VND_RNKG_CDE                                   31642800
316429              ,  B.PKGNG_TYP_CDE                                  31642900
316430              ,  EFF_BEG_TMST                                     31643000
316431              ,  AUD_PCT                                          31643100
316432              ,  CKD_PCT                                          31643200
316433              ,  MAX_CKD_QTY                                      31643300
316434              ,  MAX_CART_CKD_QTY                                 31643400
316435              ,  MIN_CART_CKD_QTY                                 31643500
316436              ,  CKD_DC_QTY                                       31643600
316437              ,  MAX_PO_LNE_QTY                                   31643700
316438              ,  CK_AFT_DAY_QTY                                   31643800
316439              ,  CK_AFT_RCVR_QTY                                  31643900
316440              ,  DAYS(CURRENT DATE) - (CK_AFT_DAY_QTY +1)         31644000
316441          INTO   :SUT00017-VND-RNKG-CDE                           31644100
316442              ,  :SUT00017-PKGNG-TYP-CDE                          31644200
316443              ,  :SUT00017-EFF-BEG-TMST                           31644300
316444              ,  :SUT00017-AUD-PCT                                31644400
316445              ,  :SUT00017-CKD-PCT                                31644500
316446              ,  :SUT00017-MAX-CKD-QTY                            31644600
316447              ,  :SUT00017-MAX-CART-CKD-QTY                       31644700
316448              ,  :SUT00017-MIN-CART-CKD-QTY                       31644800
316449              ,  :SUT00017-CKD-DC-QTY                             31644900
316450              ,  :SUT00017-MAX-PO-LNE-QTY                         31645000
316451              ,  :SUT00017-CK-AFT-DAY-QTY                         31645100
316452              ,  :SUT00017-CK-AFT-RCVR-QTY                        31645200
316453              ,  :PV-LIMIT-DAYS                                   31645300
316454          FROM   SUT_VND_DEPT_RNKG A                              31645400
316455             ,   SUT_PO_AUD_PARM   B                              31645500
316456          WHERE  A.ENT_ID        = :DK-ENT-ID                     31645600
316457            AND  A.DEPT_NBR      = :DK-DEPT-NBR                   31645700
316458            AND  A.PKGNG_TYP_CDE = :DK-PKGNG-TYP-CDE              31645800
316459            AND  A.VND_RNKG_CDE  = B.VND_RNKG_CDE                 31645900
316460            AND  A.PKGNG_TYP_CDE = B.PKGNG_TYP_CDE                31646000
316461            AND  B.EFF_BEG_TMST  = :SUT00015-EFF-BEG-TMST         31646100
316462     END-EXEC.                                                    31646200
316463                                                                  31646300
316464     EVALUATE TRUE                                                31646400
316465         WHEN SQLCODE = ZERO                                      31646500
316466             SET PS-DEPT-RANK-FOUND TO TRUE                       31646600
316467         WHEN SQLCODE = +100                                      31646700
316468             SET PS-NO-DEPT-RANK-FOUND TO TRUE                    31646800
316469         WHEN SQLWARN0 NOT = SPACES                               31646900
316470         WHEN SQLCODE NOT EQUAL ZERO                              31647000
316471             MOVE '7200-RETREIVE-VENDOR-DEPT'                     31647100
316472                             TO DP013-PARAGRAPH                   31647200
316473             MOVE 'SUKCS720 - GET VENDOR DEPT'                    31647300
316474                             TO DP013-MESSAGE-TEXT(1)             31647400
316475             MOVE DK-ENT-ID   TO PV-DISPLAY-ENT-ID                31647500
316476             STRING 'ENT ID: '         DELIMITED BY SIZE          31647600
316477                 PV-DISPLAY-ENT-ID     DELIMITED BY SIZE          31647700
316478                           INTO DP013-MESSAGE-TEXT(2)             31647800
316479             MOVE DK-DEPT-NBR TO PV-DISPLAY-DEPT-NBR              31647900
316480             STRING 'DEPT NBR: '       DELIMITED BY SIZE          31648000
316481                 PV-DISPLAY-DEPT-NBR   DELIMITED BY SIZE          31648100
316482                           INTO DP013-MESSAGE-TEXT(3)             31648200
316483             STRING 'PKGNG TYPE: '     DELIMITED BY SIZE          31648300
316484                 DK-PKGNG-TYP-CDE      DELIMITED BY SIZE          31648400
316485                           INTO DP013-MESSAGE-TEXT(4)             31648500
316486             MOVE SQLCA      TO DP013-SQLCA                       31648600
316487             MOVE 'SUT00018' TO DP013-DB2-TABLE-NAME(1)           31648700
316488             MOVE 'SUT00017' TO DP013-DB2-TABLE-NAME(2)           31648800
316489             SET DP013-DB2-ABEND                                  31648900
316490                             TO TRUE                              31649000
316491             SET DP013-NO-ROLLBACK                                31649100
316492                             TO TRUE                              31649200
316493             PERFORM 9999-WRITE-CICS-LOG-MSG                      31649300
316494             SET PS-DUMP-TO-LOG       TO TRUE                     31649400
316495             SET PS-NO-PO-INFO-FOUND TO TRUE                      31649500
316496             SET SU021-RFID-DB2-ERROR TO TRUE                     31649600
316497     END-EVALUATE.                                                31649700
316498                                                                  31649800
316499 7250-RETREIVE-VENDOR-DEPT.                                       31649900
316500                                                                  31650000
316501     STRING ' 7250-RETREIVE-VENDOR-DEPT'                          31650100
316502         DELIMITED BY SIZE                                        31650200
316503         INTO PV-CICS-MSG-AREA.                                   31650300
316504     PERFORM 9990-WRITE-CICS.                                     31650400
316505     EXEC SQL                                                     31650500
316506          SELECT B.VND_RNKG_CDE                                   31650600
316507              ,  B.PKGNG_TYP_CDE                                  31650700
316508              ,  EFF_BEG_TMST                                     31650800
316509              ,  AUD_PCT                                          31650900
316510              ,  CKD_PCT                                          31651000
316511              ,  MAX_CKD_QTY                                      31651100
316512              ,  MAX_CART_CKD_QTY                                 31651200
316513              ,  MIN_CART_CKD_QTY                                 31651300
316514              ,  CKD_DC_QTY                                       31651400
316515              ,  MAX_PO_LNE_QTY                                   31651500
316516              ,  CK_AFT_DAY_QTY                                   31651600
316517              ,  CK_AFT_RCVR_QTY                                  31651700
316518              ,  DAYS(CURRENT DATE) - (CK_AFT_DAY_QTY +1)         31651800
316519          INTO   :SUT00017-VND-RNKG-CDE                           31651900
316520              ,  :SUT00017-PKGNG-TYP-CDE                          31652000
316521              ,  :SUT00017-EFF-BEG-TMST                           31652100
316522              ,  :SUT00017-AUD-PCT                                31652200
316523              ,  :SUT00017-CKD-PCT                                31652300
316524              ,  :SUT00017-MAX-CKD-QTY                            31652400
316525              ,  :SUT00017-MAX-CART-CKD-QTY                       31652500
316526              ,  :SUT00017-MIN-CART-CKD-QTY                       31652600
316527              ,  :SUT00017-CKD-DC-QTY                             31652700
316528              ,  :SUT00017-MAX-PO-LNE-QTY                         31652800
316529              ,  :SUT00017-CK-AFT-DAY-QTY                         31652900
316530              ,  :SUT00017-CK-AFT-RCVR-QTY                        31653000
316531              ,  :PV-LIMIT-DAYS                                   31653100
316532          FROM   SUT_VND_DEPT_RNKG A                              31653200
316533             ,   SUT_PO_AUD_PARM   B                              31653300
316534          WHERE  A.ENT_ID        = :DK-ENT-ID                     31653400
316535            AND  A.DEPT_NBR      = :DK-DEPT-NBR                   31653500
316536            AND  A.PKGNG_TYP_CDE = :DK-PKGNG-TYP-CDE              31653600
316537            AND  A.VND_RNKG_CDE  = B.VND_RNKG_CDE                 31653700
316538            AND  A.PKGNG_TYP_CDE = B.PKGNG_TYP_CDE                31653800
316539            AND  B.EFF_BEG_TMST  =                                31653900
316540             (SELECT MAX(C.EFF_BEG_TMST)                          31654000
316541              FROM   SUT_PO_AUD_PARM C                            31654100
316542              WHERE  B.VND_RNKG_CDE  = C.VND_RNKG_CDE             31654200
316543                AND  B.PKGNG_TYP_CDE = C.PKGNG_TYP_CDE)           31654300
316544     END-EXEC.                                                    31654400
316545                                                                  31654500
316546     EVALUATE TRUE                                                31654600
316547         WHEN SQLCODE = ZERO                                      31654700
316548             SET PS-DEPT-RANK-FOUND TO TRUE                       31654800
316549         WHEN SQLCODE = +100                                      31654900
316550             SET PS-NO-DEPT-RANK-FOUND TO TRUE                    31655000
316551         WHEN SQLWARN0 NOT = SPACES                               31655100
316552         WHEN SQLCODE NOT EQUAL ZERO                              31655200
316553             MOVE '7250-RETREIVE-VENDOR-DEPT'                     31655300
316554                             TO DP013-PARAGRAPH                   31655400
316555             MOVE 'SUKCS720 - GET VENDOR DEPT'                    31655500
316556                             TO DP013-MESSAGE-TEXT(1)             31655600
316557             MOVE DK-ENT-ID   TO PV-DISPLAY-ENT-ID                31655700
316558             STRING 'ENT ID: '         DELIMITED BY SIZE          31655800
316559                 PV-DISPLAY-ENT-ID     DELIMITED BY SIZE          31655900
316560                           INTO DP013-MESSAGE-TEXT(2)             31656000
316561             MOVE DK-DEPT-NBR TO PV-DISPLAY-DEPT-NBR              31656100
316562             STRING 'DEPT NBR: '       DELIMITED BY SIZE          31656200
316563                 PV-DISPLAY-DEPT-NBR   DELIMITED BY SIZE          31656300
316564                           INTO DP013-MESSAGE-TEXT(3)             31656400
316565             STRING 'PKGNG TYPE: '     DELIMITED BY SIZE          31656500
316566                 DK-PKGNG-TYP-CDE      DELIMITED BY SIZE          31656600
316567                           INTO DP013-MESSAGE-TEXT(4)             31656700
316568             MOVE SQLCA      TO DP013-SQLCA                       31656800
316569             MOVE 'SUT00018' TO DP013-DB2-TABLE-NAME(1)           31656900
316570             MOVE 'SUT00017' TO DP013-DB2-TABLE-NAME(2)           31657000
316571             SET DP013-DB2-ABEND                                  31657100
316572                             TO TRUE                              31657200
316573             SET DP013-NO-ROLLBACK                                31657300
316574                             TO TRUE                              31657400
316575             PERFORM 9999-WRITE-CICS-LOG-MSG                      31657500
316576             SET PS-DUMP-TO-LOG       TO TRUE                     31657600
316577             SET PS-NO-PO-INFO-FOUND TO TRUE                      31657700
316578             SET SU021-RFID-DB2-ERROR TO TRUE                     31657800
316579     END-EVALUATE.                                                31657900
316580                                                                  31658000
316581 7300-RETREIVE-VENDOR-RANK.                                       31658100
316582                                                                  31658200
316583     STRING ' 7300-RETREIVE-VENDOR-RANK'                          31658300
316584         DELIMITED BY SIZE                                        31658400
316585         INTO PV-CICS-MSG-AREA.                                   31658500
316586     PERFORM 9990-WRITE-CICS.                                     31658600
316587     EXEC SQL                                                     31658700
316588          SELECT B.VND_RNKG_CDE                                   31658800
316589              ,  B.PKGNG_TYP_CDE                                  31658900
316590              ,  EFF_BEG_TMST                                     31659000
316591              ,  AUD_PCT                                          31659100
316592              ,  CKD_PCT                                          31659200
316593              ,  MAX_CKD_QTY                                      31659300
316594              ,  MAX_CART_CKD_QTY                                 31659400
316595              ,  MIN_CART_CKD_QTY                                 31659500
316596              ,  CKD_DC_QTY                                       31659600
316597              ,  MAX_PO_LNE_QTY                                   31659700
316598              ,  CK_AFT_DAY_QTY                                   31659800
316599              ,  CK_AFT_RCVR_QTY                                  31659900
316600              ,  DAYS(CURRENT DATE) - (CK_AFT_DAY_QTY +1)         31660000
316601          INTO   :SUT00017-VND-RNKG-CDE                           31660100
316602              ,  :SUT00017-PKGNG-TYP-CDE                          31660200
316603              ,  :SUT00017-EFF-BEG-TMST                           31660300
316604              ,  :SUT00017-AUD-PCT                                31660400
316605              ,  :SUT00017-CKD-PCT                                31660500
316606              ,  :SUT00017-MAX-CKD-QTY                            31660600
316607              ,  :SUT00017-MAX-CART-CKD-QTY                       31660700
316608              ,  :SUT00017-MIN-CART-CKD-QTY                       31660800
316609              ,  :SUT00017-CKD-DC-QTY                             31660900
316610              ,  :SUT00017-MAX-PO-LNE-QTY                         31661000
316611              ,  :SUT00017-CK-AFT-DAY-QTY                         31661100
316612              ,  :SUT00017-CK-AFT-RCVR-QTY                        31661200
316613              ,  :PV-LIMIT-DAYS                                   31661300
316614          FROM   SUT_VND_RNKG      A                              31661400
316615             ,   SUT_PO_AUD_PARM   B                              31661500
316616          WHERE  A.ENT_ID        = :DK-ENT-ID                     31661600
316617            AND  A.PKGNG_TYP_CDE = :DK-PKGNG-TYP-CDE              31661700
316618            AND  A.VND_RNKG_CDE  = B.VND_RNKG_CDE                 31661800
316619            AND  A.PKGNG_TYP_CDE = B.PKGNG_TYP_CDE                31661900
316620            AND  B.EFF_BEG_TMST  = :SUT00015-EFF-BEG-TMST         31662000
316621     END-EXEC.                                                    31662100
316622                                                                  31662200
316623     EVALUATE TRUE                                                31662300
316624         WHEN SQLCODE = ZERO                                      31662400
316625             SET PS-VEND-RANK-FOUND TO TRUE                       31662500
316626         WHEN SQLCODE = +100                                      31662600
316627             SET PS-NO-VEND-RANK-FOUND TO TRUE                    31662700
316628         WHEN SQLWARN0 NOT = SPACES                               31662800
316629         WHEN SQLCODE NOT EQUAL ZERO                              31662900
316630             MOVE '7300-RETREIVE-VENDOR-RANK'                     31663000
316631                             TO DP013-PARAGRAPH                   31663100
316632             MOVE 'SUKCS720 - GET VENDOR RANK'                    31663200
316633                             TO DP013-MESSAGE-TEXT(1)             31663300
316634             MOVE DK-ENT-ID   TO PV-DISPLAY-ENT-ID                31663400
316635             STRING 'ENT ID: '         DELIMITED BY SIZE          31663500
316636                 PV-DISPLAY-ENT-ID     DELIMITED BY SIZE          31663600
316637                           INTO DP013-MESSAGE-TEXT(2)             31663700
316638             STRING 'PKGNG TYPE: '     DELIMITED BY SIZE          31663800
316639                 DK-PKGNG-TYP-CDE      DELIMITED BY SIZE          31663900
316640                           INTO DP013-MESSAGE-TEXT(3)             31664000
316641             STRING 'TIMESTAMP: '      DELIMITED BY SIZE          31664100
316642                 SUT00015-EFF-BEG-TMST DELIMITED BY SIZE          31664200
316643                           INTO DP013-MESSAGE-TEXT(4)             31664300
316644             MOVE SQLCA      TO DP013-SQLCA                       31664400
316645             MOVE 'SUT00019' TO DP013-DB2-TABLE-NAME(1)           31664500
316646             MOVE 'SUT00017' TO DP013-DB2-TABLE-NAME(2)           31664600
316647             SET DP013-DB2-ABEND                                  31664700
316648                             TO TRUE                              31664800
316649             SET DP013-NO-ROLLBACK                                31664900
316650                             TO TRUE                              31665000
316651             PERFORM 9999-WRITE-CICS-LOG-MSG                      31665100
316652             SET PS-DUMP-TO-LOG       TO TRUE                     31665200
316653             SET PS-NO-PO-INFO-FOUND TO TRUE                      31665300
316654             SET SU021-RFID-DB2-ERROR TO TRUE                     31665400
316655     END-EVALUATE.                                                31665500
316656                                                                  31665600
316657 7350-RETREIVE-VENDOR-RANK.                                       31665700
316658                                                                  31665800
316659     STRING ' 7350-RETREIVE-VENDOR-RANK'                          31665900
316660         DELIMITED BY SIZE                                        31666000
316661         INTO PV-CICS-MSG-AREA.                                   31666100
316662     PERFORM 9990-WRITE-CICS.                                     31666200
316663     EXEC SQL                                                     31666300
316664          SELECT B.VND_RNKG_CDE                                   31666400
316665              ,  B.PKGNG_TYP_CDE                                  31666500
316666              ,  EFF_BEG_TMST                                     31666600
316667              ,  AUD_PCT                                          31666700
316668              ,  CKD_PCT                                          31666800
316669              ,  MAX_CKD_QTY                                      31666900
316670              ,  MAX_CART_CKD_QTY                                 31667000
316671              ,  MIN_CART_CKD_QTY                                 31667100
316672              ,  CKD_DC_QTY                                       31667200
316673              ,  MAX_PO_LNE_QTY                                   31667300
316674              ,  CK_AFT_DAY_QTY                                   31667400
316675              ,  CK_AFT_RCVR_QTY                                  31667500
316676              ,  DAYS(CURRENT DATE) - (CK_AFT_DAY_QTY +1)         31667600
316677          INTO   :SUT00017-VND-RNKG-CDE                           31667700
316678              ,  :SUT00017-PKGNG-TYP-CDE                          31667800
316679              ,  :SUT00017-EFF-BEG-TMST                           31667900
316680              ,  :SUT00017-AUD-PCT                                31668000
316681              ,  :SUT00017-CKD-PCT                                31668100
316682              ,  :SUT00017-MAX-CKD-QTY                            31668200
316683              ,  :SUT00017-MAX-CART-CKD-QTY                       31668300
316684              ,  :SUT00017-MIN-CART-CKD-QTY                       31668400
316685              ,  :SUT00017-CKD-DC-QTY                             31668500
316686              ,  :SUT00017-MAX-PO-LNE-QTY                         31668600
316687              ,  :SUT00017-CK-AFT-DAY-QTY                         31668700
316688              ,  :SUT00017-CK-AFT-RCVR-QTY                        31668800
316689              ,  :PV-LIMIT-DAYS                                   31668900
316690          FROM   SUT_VND_RNKG      A                              31669000
316691             ,   SUT_PO_AUD_PARM   B                              31669100
316692          WHERE  A.ENT_ID        = :DK-ENT-ID                     31669200
316693            AND  A.PKGNG_TYP_CDE = :DK-PKGNG-TYP-CDE              31669300
316694            AND  A.VND_RNKG_CDE  = B.VND_RNKG_CDE                 31669400
316695            AND  A.PKGNG_TYP_CDE = B.PKGNG_TYP_CDE                31669500
316696            AND  B.EFF_BEG_TMST  =                                31669600
316697             (SELECT MAX(C.EFF_BEG_TMST)                          31669700
316698              FROM   SUT_PO_AUD_PARM   C                          31669800
316699              WHERE  B.VND_RNKG_CDE  = C.VND_RNKG_CDE             31669900
316700                AND  B.PKGNG_TYP_CDE = C.PKGNG_TYP_CDE)           31670000
316701     END-EXEC.                                                    31670100
316702                                                                  31670200
316703     EVALUATE TRUE                                                31670300
316704         WHEN SQLCODE = ZERO                                      31670400
316705             SET PS-VEND-RANK-FOUND TO TRUE                       31670500
316706         WHEN SQLCODE = +100                                      31670600
316707             SET PS-NO-VEND-RANK-FOUND TO TRUE                    31670700
316708         WHEN SQLWARN0 NOT = SPACES                               31670800
316709         WHEN SQLCODE NOT EQUAL ZERO                              31670900
316710             MOVE '7350-RETREIVE-VENDOR-RANK'                     31671000
316711                             TO DP013-PARAGRAPH                   31671100
316712             MOVE 'SUKCS720 - GET VENDOR RANK'                    31671200
316713                             TO DP013-MESSAGE-TEXT(1)             31671300
316714             MOVE DK-ENT-ID   TO PV-DISPLAY-ENT-ID                31671400
316715             STRING 'ENT ID: '         DELIMITED BY SIZE          31671500
316716                 PV-DISPLAY-ENT-ID     DELIMITED BY SIZE          31671600
316717                           INTO DP013-MESSAGE-TEXT(2)             31671700
316718             STRING 'PKGNG TYPE: '     DELIMITED BY SIZE          31671800
316719                 DK-PKGNG-TYP-CDE      DELIMITED BY SIZE          31671900
316720                           INTO DP013-MESSAGE-TEXT(3)             31672000
316721             MOVE SQLCA      TO DP013-SQLCA                       31672100
316722             MOVE 'SUT00019' TO DP013-DB2-TABLE-NAME(1)           31672200
316723             MOVE 'SUT00017' TO DP013-DB2-TABLE-NAME(2)           31672300
316724             SET DP013-DB2-ABEND                                  31672400
316725                             TO TRUE                              31672500
316726             SET DP013-NO-ROLLBACK                                31672600
316727                             TO TRUE                              31672700
316728             PERFORM 9999-WRITE-CICS-LOG-MSG                      31672800
316729             SET PS-DUMP-TO-LOG       TO TRUE                     31672900
316730             SET PS-NO-PO-INFO-FOUND TO TRUE                      31673000
316731             SET SU021-RFID-DB2-ERROR TO TRUE                     31673100
316732     END-EVALUATE.                                                31673200
316733                                                                  31673300
316734 7400-RETREIVE-DEFAULT-RANK.                                      31673400
316735                                                                  31673500
316736     STRING ' 7400-RETREIVE-DEFAULT-RANK'                         31673600
316737         DELIMITED BY SIZE                                        31673700
316738         INTO PV-CICS-MSG-AREA.                                   31673800
316739     PERFORM 9990-WRITE-CICS.                                     31673900
316740                                                                  31674000
316741     EXEC SQL                                                     31674100
316742          SELECT VND_RNKG_CDE                                     31674200
316743              ,  PKGNG_TYP_CDE                                    31674300
316744              ,  EFF_BEG_TMST                                     31674400
316745              ,  AUD_PCT                                          31674500
316746              ,  CKD_PCT                                          31674600
316747              ,  MAX_CKD_QTY                                      31674700
316748              ,  MAX_CART_CKD_QTY                                 31674800
316749              ,  MIN_CART_CKD_QTY                                 31674900
316750              ,  CKD_DC_QTY                                       31675000
316751              ,  MAX_PO_LNE_QTY                                   31675100
316752              ,  CK_AFT_DAY_QTY                                   31675200
316753              ,  CK_AFT_RCVR_QTY                                  31675300
316754              ,  DAYS(CURRENT DATE) - (CK_AFT_DAY_QTY +1)         31675400
316755          INTO   :SUT00017-VND-RNKG-CDE                           31675500
316756              ,  :SUT00017-PKGNG-TYP-CDE                          31675600
316757              ,  :SUT00017-EFF-BEG-TMST                           31675700
316758              ,  :SUT00017-AUD-PCT                                31675800
316759              ,  :SUT00017-CKD-PCT                                31675900
316760              ,  :SUT00017-MAX-CKD-QTY                            31676000
316761              ,  :SUT00017-MAX-CART-CKD-QTY                       31676100
316762              ,  :SUT00017-MIN-CART-CKD-QTY                       31676200
316763              ,  :SUT00017-CKD-DC-QTY                             31676300
316764              ,  :SUT00017-MAX-PO-LNE-QTY                         31676400
316765              ,  :SUT00017-CK-AFT-DAY-QTY                         31676500
316766              ,  :SUT00017-CK-AFT-RCVR-QTY                        31676600
316767              ,  :PV-LIMIT-DAYS                                   31676700
316768          FROM   SUT_PO_AUD_PARM                                  31676800
316769          WHERE  PKGNG_TYP_CDE   = :DK-PKGNG-TYP-CDE              31676900
316770            AND  VND_RNKG_CDE    = :PC-DEFAULT                    31677000
316771            AND  EFF_BEG_TMST    = :SUT00015-EFF-BEG-TMST         31677100
316772     END-EXEC.                                                    31677200
316773                                                                  31677300
316774     EVALUATE TRUE                                                31677400
316775         WHEN SQLCODE = ZERO                                      31677500
316776             SET PS-DEFAULT-RANK-FOUND TO TRUE                    31677600
316777         WHEN SQLCODE = +100                                      31677700
316778             SET PS-NO-DEFAULT-RANK-FOUND TO TRUE                 31677800
316779         WHEN SQLWARN0 NOT = SPACES                               31677900
316780         WHEN SQLCODE NOT EQUAL ZERO                              31678000
316781             MOVE '7400-RETREIVE-DEFAULT-RANK'                    31678100
316782                             TO DP013-PARAGRAPH                   31678200
316783             MOVE 'SUKCS720 - GET DEFAULT RANK'                   31678300
316784                             TO DP013-MESSAGE-TEXT(1)             31678400
316785             MOVE DK-ENT-ID   TO PV-DISPLAY-ENT-ID                31678500
316786             STRING 'ENT ID: '         DELIMITED BY SIZE          31678600
316787                 PV-DISPLAY-ENT-ID     DELIMITED BY SIZE          31678700
316788                           INTO DP013-MESSAGE-TEXT(2)             31678800
316789             STRING 'PKGNG TYPE: '     DELIMITED BY SIZE          31678900
316790                 DK-PKGNG-TYP-CDE      DELIMITED BY SIZE          31679000
316791                           INTO DP013-MESSAGE-TEXT(3)             31679100
316792             STRING 'TIMESTAMP: '      DELIMITED BY SIZE          31679200
316793                 SUT00015-EFF-BEG-TMST DELIMITED BY SIZE          31679300
316794                           INTO DP013-MESSAGE-TEXT(4)             31679400
316795             MOVE SQLCA      TO DP013-SQLCA                       31679500
316796             MOVE 'SUT00019' TO DP013-DB2-TABLE-NAME(1)           31679600
316797             MOVE 'SUT00017' TO DP013-DB2-TABLE-NAME(2)           31679700
316798             SET DP013-DB2-ABEND                                  31679800
316799                             TO TRUE                              31679900
316800             SET DP013-NO-ROLLBACK                                31680000
316801                             TO TRUE                              31680100
316802             PERFORM 9999-WRITE-CICS-LOG-MSG                      31680200
316803             SET PS-DUMP-TO-LOG       TO TRUE                     31680300
316804             SET PS-NO-PO-INFO-FOUND TO TRUE                      31680400
316805             SET SU021-RFID-DB2-ERROR TO TRUE                     31680500
316806     END-EVALUATE.                                                31680600
316807                                                                  31680700
316808 7450-RETREIVE-DEFAULT-RANK.                                      31680800
316809                                                                  31680900
316810     STRING ' 7450-RETREIVE-DEFAULT-RANK'                         31681000
316811         DELIMITED BY SIZE                                        31681100
316812         INTO PV-CICS-MSG-AREA.                                   31681200
316813     PERFORM 9990-WRITE-CICS.                                     31681300
316814     EXEC SQL                                                     31681400
316815          SELECT VND_RNKG_CDE                                     31681500
316816              ,  PKGNG_TYP_CDE                                    31681600
316817              ,  EFF_BEG_TMST                                     31681700
316818              ,  AUD_PCT                                          31681800
316819              ,  CKD_PCT                                          31681900
316820              ,  MAX_CKD_QTY                                      31682000
316821              ,  MAX_CART_CKD_QTY                                 31682100
316822              ,  MIN_CART_CKD_QTY                                 31682200
316823              ,  CKD_DC_QTY                                       31682300
316824              ,  MAX_PO_LNE_QTY                                   31682400
316825              ,  CK_AFT_DAY_QTY                                   31682500
316826              ,  CK_AFT_RCVR_QTY                                  31682600
316827              ,  DAYS(CURRENT DATE) - (CK_AFT_DAY_QTY +1)         31682700
316828          INTO   :SUT00017-VND-RNKG-CDE                           31682800
316829              ,  :SUT00017-PKGNG-TYP-CDE                          31682900
316830              ,  :SUT00017-EFF-BEG-TMST                           31683000
316831              ,  :SUT00017-AUD-PCT                                31683100
316832              ,  :SUT00017-CKD-PCT                                31683200
316833              ,  :SUT00017-MAX-CKD-QTY                            31683300
316834              ,  :SUT00017-MAX-CART-CKD-QTY                       31683400
316835              ,  :SUT00017-MIN-CART-CKD-QTY                       31683500
316836              ,  :SUT00017-CKD-DC-QTY                             31683600
316837              ,  :SUT00017-MAX-PO-LNE-QTY                         31683700
316838              ,  :SUT00017-CK-AFT-DAY-QTY                         31683800
316839              ,  :SUT00017-CK-AFT-RCVR-QTY                        31683900
316840              ,  :PV-LIMIT-DAYS                                   31684000
316841          FROM   SUT_PO_AUD_PARM A                                31684100
316842          WHERE  A.PKGNG_TYP_CDE = :DK-PKGNG-TYP-CDE              31684200
316843            AND  A.VND_RNKG_CDE  = :PC-DEFAULT                    31684300
316844            AND  A.EFF_BEG_TMST  =                                31684400
316845             (SELECT MAX(B.EFF_BEG_TMST)                          31684500
316846              FROM   SUT_PO_AUD_PARM   B                          31684600
316847              WHERE  A.VND_RNKG_CDE  = B.VND_RNKG_CDE             31684700
316848                AND  A.PKGNG_TYP_CDE = B.PKGNG_TYP_CDE)           31684800
316849     END-EXEC.                                                    31684900
316850                                                                  31685000
316851     EVALUATE TRUE                                                31685100
316852         WHEN SQLCODE = ZERO                                      31685200
316853             SET PS-DEFAULT-RANK-FOUND TO TRUE                    31685300
316854         WHEN SQLCODE = +100                                      31685400
316855             SET PS-NO-DEFAULT-RANK-FOUND TO TRUE                 31685500
316856         WHEN SQLWARN0 NOT = SPACES                               31685600
316857         WHEN SQLCODE NOT EQUAL ZERO                              31685700
316858             MOVE '7450-RETREIVE-DEFAULT-RANK'                    31685800
316859                             TO DP013-PARAGRAPH                   31685900
316860             MOVE 'SUKCS720 - GET DEFAULT RANK'                   31686000
316861                             TO DP013-MESSAGE-TEXT(1)             31686100
316862             MOVE DK-ENT-ID   TO PV-DISPLAY-ENT-ID                31686200
316863             STRING 'ENT ID: '         DELIMITED BY SIZE          31686300
316864                 PV-DISPLAY-ENT-ID     DELIMITED BY SIZE          31686400
316865                           INTO DP013-MESSAGE-TEXT(2)             31686500
316866             STRING 'PKGNG TYPE: '     DELIMITED BY SIZE          31686600
316867                 DK-PKGNG-TYP-CDE      DELIMITED BY SIZE          31686700
316868                           INTO DP013-MESSAGE-TEXT(3)             31686800
316869             MOVE SQLCA      TO DP013-SQLCA                       31686900
316870             MOVE 'SUT00019' TO DP013-DB2-TABLE-NAME(1)           31687000
316871             MOVE 'SUT00017' TO DP013-DB2-TABLE-NAME(2)           31687100
316872             SET DP013-DB2-ABEND                                  31687200
316873                             TO TRUE                              31687300
316874             SET DP013-NO-ROLLBACK                                31687400
316875                             TO TRUE                              31687500
316876             PERFORM 9999-WRITE-CICS-LOG-MSG                      31687600
316877             SET PS-DUMP-TO-LOG       TO TRUE                     31687700
316878             SET PS-NO-PO-INFO-FOUND TO TRUE                      31687800
316879             SET SU021-RFID-DB2-ERROR TO TRUE                     31687900
316880     END-EVALUATE.                                                31688000
316881                                                                  31688100
316882 7500-SELECT-BULK.                                                31688200
316883                                                                  31688300
316884     STRING ' 7500-SELECT-BULK'                                   31688400
316885         DELIMITED BY SIZE                                        31688500
316886         INTO PV-CICS-MSG-AREA.                                   31688600
316887     PERFORM 9990-WRITE-CICS.                                     31688700
316888     EXEC SQL                                                     31688800
316889          SELECT AUD_TYP_CDE                                      31688900
316890              ,  CRE_TMST                                         31689000
316891              ,  LAST_UPD_TMST                                    31689100
316892              ,  LAST_UPD_BY_USR_ID                               31689200
316893          INTO   :SUT00014-AUD-TYP-CDE                            31689300
316894              ,  :SUT00014-CRE-TMST                               31689400
316895              ,  :SUT00014-LAST-UPD-TMST                          31689500
316896              ,  :SUT00014-LAST-UPD-BY-USR-ID                     31689600
316897          FROM   SUT_PO_AUD_EXC                                   31689700
316898          WHERE  PO_NBR        = :DK-PO-NBR                       31689800
316899            AND  PO_LNE_NBR    = :DK-PO-LINE-NBR                  31689900
316900            AND  OPER_UNT_ID   = :DK-OPER-UNT-ID                  31690000
316901     END-EXEC.                                                    31690100
316902                                                                  31690200
316903     EVALUATE TRUE                                                31690300
316904         WHEN SQLCODE = ZERO                                      31690400
316905             SET PS-LINE-LEVEL-FOUND  TO TRUE                     31690500
316906             MOVE 'PS-LINE-LEVEL-FOUND ' TO PV-CICS-MSG-AREA      31690600
316907             PERFORM 9990-WRITE-CICS                              31690700
316908         WHEN SQLCODE = +100                                      31690800
316909             CONTINUE                                             31690900
316910         WHEN SQLWARN0 NOT = SPACES                               31691000
316911         WHEN SQLCODE NOT EQUAL ZERO                              31691100
316912             MOVE '7500-SELECT-BULK'                              31691200
316913                             TO DP013-PARAGRAPH                   31691300
316914             MOVE 'SUKCS720 - GET PRE-PACK'                       31691400
316915                             TO DP013-MESSAGE-TEXT(1)             31691500
316916             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 31691600
316917             STRING 'PO NBR: '         DELIMITED BY SIZE          31691700
316918                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          31691800
316919                           INTO DP013-MESSAGE-TEXT(2)             31691900
316920             MOVE DK-PO-LINE-NBR TO PV-DISPLAY-PO-LINE-NBR        31692000
316921             STRING 'PO LINE NBR: '    DELIMITED BY SIZE          31692100
316922                PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE          31692200
316923                           INTO DP013-MESSAGE-TEXT(3)             31692300
316924             MOVE DK-OPER-UNT-ID TO PV-DISPLAY-OPER-UNT-ID        31692400
316925             STRING 'OPER UNIT: '      DELIMITED BY SIZE          31692500
316926                PV-DISPLAY-OPER-UNT-ID DELIMITED BY SIZE          31692600
316927                           INTO DP013-MESSAGE-TEXT(4)             31692700
316928             MOVE SQLCA      TO DP013-SQLCA                       31692800
316929             MOVE 'SUT00014' TO DP013-DB2-TABLE-NAME(1)           31692900
316930             SET DP013-DB2-ABEND                                  31693000
316931                             TO TRUE                              31693100
316932             SET DP013-NO-ROLLBACK                                31693200
316933                             TO TRUE                              31693300
316934             PERFORM 9999-WRITE-CICS-LOG-MSG                      31693400
316935             SET PS-DUMP-TO-LOG       TO TRUE                     31693500
316936             SET PS-NO-PO-INFO-FOUND TO TRUE                      31693600
316937             SET SU021-RFID-DB2-ERROR TO TRUE                     31693700
316938     END-EVALUATE.                                                31693800
316939                                                                  31693900
316940 7550-SELECT-PRE-PACK.                                            31694000
316941                                                                  31694100
316942     STRING ' 7550-SELECT-PRE-PACK'                               31694200
316943         DELIMITED BY SIZE                                        31694300
316944         INTO PV-CICS-MSG-AREA.                                   31694400
316945     PERFORM 9990-WRITE-CICS.                                     31694500
316946     EXEC SQL                                                     31694600
316947          SELECT AUD_TYP_CDE                                      31694700
316948              ,  CRE_TMST                                         31694800
316949              ,  LAST_UPD_TMST                                    31694900
316950              ,  LAST_UPD_BY_USR_ID                               31695000
316951          INTO   :SUT00014-AUD-TYP-CDE                            31695100
316952              ,  :SUT00014-CRE-TMST                               31695200
316953              ,  :SUT00014-LAST-UPD-TMST                          31695300
316954              ,  :SUT00014-LAST-UPD-BY-USR-ID                     31695400
316955          FROM   SUT_PO_AUD_EXC                                   31695500
316956          WHERE  PO_NBR        = :DK-PO-NBR                       31695600
316957            AND  PO_PREPK_ID   = :DK-PREPK-ID                     31695700
316958            AND  OPER_UNT_ID   = :DK-OPER-UNT-ID                  31695800
316959     END-EXEC.                                                    31695900
316960                                                                  31696000
316961     EVALUATE TRUE                                                31696100
316962         WHEN SQLCODE = ZERO                                      31696200
316963             SET PS-LINE-LEVEL-FOUND  TO TRUE                     31696300
316964             MOVE 'PS-LINE-LEVEL-FOUND ' TO PV-CICS-MSG-AREA      31696400
316965             PERFORM 9990-WRITE-CICS                              31696500
316966         WHEN SQLCODE = +100                                      31696600
316967             CONTINUE                                             31696700
316968         WHEN SQLWARN0 NOT = SPACES                               31696800
316969         WHEN SQLCODE NOT EQUAL ZERO                              31696900
316970             MOVE '7550-SELECT-PRE-PACK'                          31697000
316971                             TO DP013-PARAGRAPH                   31697100
316972             MOVE 'SUKCS720 - GET PRE-PACK'                       31697200
316973                             TO DP013-MESSAGE-TEXT(1)             31697300
316974             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 31697400
316975             STRING 'PO NBR: '         DELIMITED BY SIZE          31697500
316976                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          31697600
316977                           INTO DP013-MESSAGE-TEXT(2)             31697700
316978             MOVE DK-PREPK-ID    TO PV-DISPLAY-PREPK-ID           31697800
316979             STRING 'PRE PACK ID: '    DELIMITED BY SIZE          31697900
316980                PV-DISPLAY-PREPK-ID    DELIMITED BY SIZE          31698000
316981                           INTO DP013-MESSAGE-TEXT(3)             31698100
316982             MOVE DK-OPER-UNT-ID TO PV-DISPLAY-OPER-UNT-ID        31698200
316983             STRING 'OPER UNIT: '      DELIMITED BY SIZE          31698300
316984                PV-DISPLAY-OPER-UNT-ID DELIMITED BY SIZE          31698400
316985                           INTO DP013-MESSAGE-TEXT(4)             31698500
316986             MOVE SQLCA      TO DP013-SQLCA                       31698600
316987             MOVE 'SUT00014' TO DP013-DB2-TABLE-NAME(1)           31698700
316988             SET DP013-DB2-ABEND                                  31698800
316989                             TO TRUE                              31698900
316990             SET DP013-NO-ROLLBACK                                31699000
316991                             TO TRUE                              31699100
316992             PERFORM 9999-WRITE-CICS-LOG-MSG                      31699200
316993             SET PS-DUMP-TO-LOG       TO TRUE                     31699300
316994             SET PS-NO-PO-INFO-FOUND TO TRUE                      31699400
316995             SET SU021-RFID-DB2-ERROR TO TRUE                     31699500
316996     END-EVALUATE.                                                31699600
316997                                                                  31699700
316998 7600-SELECT-PO-LEVEL.                                            31699800
316999                                                                  31699900
317000     STRING ' 7600-SELECT-PO-LEVEL'                               31700000
317001         DELIMITED BY SIZE                                        31700100
317002         INTO PV-CICS-MSG-AREA.                                   31700200
317003     PERFORM 9990-WRITE-CICS.                                     31700300
317004     EXEC SQL                                                     31700400
317005          SELECT AUD_TYP_CDE                                      31700500
317006              ,  CRE_TMST                                         31700600
317007              ,  LAST_UPD_TMST                                    31700700
317008              ,  LAST_UPD_BY_USR_ID                               31700800
317009          INTO   :SUT00014-AUD-TYP-CDE                            31700900
317010              ,  :SUT00014-CRE-TMST                               31701000
317011              ,  :SUT00014-LAST-UPD-TMST                          31701100
317012              ,  :SUT00014-LAST-UPD-BY-USR-ID                     31701200
317013          FROM   SUT_PO_AUD_EXC                                   31701300
317014          WHERE  PO_NBR        = :DK-PO-NBR                       31701400
317015            AND  PO_LNE_NBR    = 0                                31701500
317016            AND  PO_PREPK_ID   = 0                                31701600
317017            AND  OPER_UNT_ID   = :DK-OPER-UNT-ID                  31701700
317018     END-EXEC.                                                    31701800
317019                                                                  31701900
317020     EVALUATE TRUE                                                31702000
317021         WHEN SQLCODE = ZERO                                      31702100
317022             SET PS-PO-LEVEL-FOUND  TO TRUE                       31702200
317023             MOVE 'PS-PO-LEVEL-FOUND ' TO PV-CICS-MSG-AREA        31702300
317024             PERFORM 9990-WRITE-CICS                              31702400
317025         WHEN SQLCODE = +100                                      31702500
317026             CONTINUE                                             31702600
317027         WHEN SQLWARN0 NOT = SPACES                               31702700
317028         WHEN SQLCODE NOT EQUAL ZERO                              31702800
317029             MOVE '7600-SELECT-PO-LEVEL'                          31702900
317030                             TO DP013-PARAGRAPH                   31703000
317031             MOVE 'SUKCS720 - GET PRE-PACK'                       31703100
317032                             TO DP013-MESSAGE-TEXT(1)             31703200
317033             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 31703300
317034             STRING 'PO NBR: '         DELIMITED BY SIZE          31703400
317035                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          31703500
317036                           INTO DP013-MESSAGE-TEXT(2)             31703600
317037             MOVE SQLCA      TO DP013-SQLCA                       31703700
317038             MOVE 'SUT00014' TO DP013-DB2-TABLE-NAME(1)           31703800
317039             SET DP013-DB2-ABEND                                  31703900
317040                             TO TRUE                              31704000
317041             SET DP013-NO-ROLLBACK                                31704100
317042                             TO TRUE                              31704200
317043             PERFORM 9999-WRITE-CICS-LOG-MSG                      31704300
317044             SET PS-DUMP-TO-LOG       TO TRUE                     31704400
317045             SET PS-NO-PO-INFO-FOUND TO TRUE                      31704500
317046             SET SU021-RFID-DB2-ERROR TO TRUE                     31704600
317047     END-EVALUATE.                                                31704700
317048                                                                  31704800
317049 7700-SELECT-FAILED.                                              31704900
317050                                                                  31705000
317051     STRING ' 7700-SELECT-FAILED'                                 31705100
317052         DELIMITED BY SIZE                                        31705200
317053         INTO PV-CICS-MSG-AREA.                                   31705300
317054     PERFORM 9990-WRITE-CICS.                                     31705400
317055     EXEC SQL                                                     31705500
317056          SELECT AUD_CNTL_NBR                                     31705600
317057              ,  UNT_QTY                                          31705700
317058          INTO   :SUT00015-AUD-CNTL-NBR                           31705800
317059              ,  :SUT00015-UNT-QTY                                31705900
317060          FROM   SUT_PO_AUD_REQ                                   31706000
317061          WHERE  PO_NBR         = :DK-PO-NBR                      31706100
317062            AND  PO_LNE_NBR     = :DK-PO-LINE-NBR                 31706200
317063            AND  PO_PREPK_ID    = :DK-PREPK-ID                    31706300
317064            AND  AUD_STAT_CDE   = :PC-F                           31706400
317065            AND  DAYS(CRE_TMST) > :PV-LIMIT-DAYS                  31706500
317066     END-EXEC.                                                    31706600
317067                                                                  31706700
317068     EVALUATE TRUE                                                31706800
317069         WHEN SQLCODE = ZERO                                      31706900
317070         WHEN SQLCODE = -811                                      31707000
317071             SET PS-FAILED-AUDITS-FOUND TO TRUE                   31707100
317072             MOVE 'PS-FAILED-AUDITS-FOUND ' TO PV-CICS-MSG-AREA   31707200
317073             PERFORM 9990-WRITE-CICS                              31707300
317074         WHEN SQLCODE = +100                                      31707400
317075             CONTINUE                                             31707500
317076         WHEN SQLWARN0 NOT = SPACES                               31707600
317077         WHEN SQLCODE NOT EQUAL ZERO                              31707700
317078             MOVE '7700-SELECT-FAILED'                            31707800
317079                             TO DP013-PARAGRAPH                   31707900
317080             MOVE 'SUKCS720 - GET FAILED AUDITS'                  31708000
317081                             TO DP013-MESSAGE-TEXT(1)             31708100
317082             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 31708200
317083             STRING 'PO NBR: '         DELIMITED BY SIZE          31708300
317084                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          31708400
317085                           INTO DP013-MESSAGE-TEXT(2)             31708500
317086             MOVE DK-PO-LINE-NBR TO PV-DISPLAY-PO-LINE-NBR        31708600
317087             STRING 'PO LINE NBR: '    DELIMITED BY SIZE          31708700
317088                PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE          31708800
317089                           INTO DP013-MESSAGE-TEXT(3)             31708900
317090             MOVE SQLCA      TO DP013-SQLCA                       31709000
317091             MOVE 'SUT00015' TO DP013-DB2-TABLE-NAME(1)           31709100
317092             SET DP013-DB2-ABEND                                  31709200
317093                             TO TRUE                              31709300
317094             SET DP013-NO-ROLLBACK                                31709400
317095                             TO TRUE                              31709500
317096             PERFORM 9999-WRITE-CICS-LOG-MSG                      31709600
317097             SET PS-DUMP-TO-LOG       TO TRUE                     31709700
317098             SET SU021-RFID-DB2-ERROR TO TRUE                     31709800
317099     END-EVALUATE.                                                31709900
317100                                                                  31710000
317101 7800-SELECT-PASSED.                                              31710100
317102                                                                  31710200
317103     STRING ' 7700-SELECT-BC-PASSED'                              31710300
317104         DELIMITED BY SIZE                                        31710400
317105         INTO PV-CICS-MSG-AREA.                                   31710500
317106     PERFORM 9990-WRITE-CICS.                                     31710600
317107     MOVE 0         TO PV-PASSED-COUNT.                           31710700
317108     EXEC SQL                                                     31710800
317109          SELECT COUNT(DISTINCT OPER_UNT_ID)                      31710900
317110          INTO   :PV-PASSED-COUNT                                 31711000
317111          FROM   SUT_PO_AUD_REQ                                   31711100
317112          WHERE  PO_NBR         = :DK-PO-NBR                      31711200
317113            AND  PO_LNE_NBR     = :DK-PO-LINE-NBR                 31711300
317114            AND  PO_PREPK_ID    = :DK-PREPK-ID                    31711400
317115            AND  AUD_STAT_CDE   = :PC-P                           31711500
317116            AND  DAYS(CRE_TMST) > :PV-LIMIT-DAYS                  31711600
317117     END-EXEC.                                                    31711700
317118                                                                  31711800
317119     EVALUATE TRUE                                                31711900
317120         WHEN SQLCODE = ZERO                                      31712000
317121             IF PV-PASSED-COUNT > 0                               31712100
317122                 SET PS-PASSED-AUDITS-FOUND TO TRUE               31712200
317123                 MOVE 'PS-PASSED-AUDITS-FOUND '                   31712300
317124                                              TO PV-CICS-MSG-AREA 31712400
317125                 PERFORM 9990-WRITE-CICS                          31712500
317126             END-IF                                               31712600
317127         WHEN SQLWARN0 NOT = SPACES                               31712700
317128         WHEN SQLCODE NOT EQUAL ZERO                              31712800
317129             MOVE '7800-SELECT-PASSED'                            31712900
317130                             TO DP013-PARAGRAPH                   31713000
317131             MOVE 'SUKCS720 - GET PASSED AUDITS'                  31713100
317132                             TO DP013-MESSAGE-TEXT(1)             31713200
317133             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 31713300
317134             STRING 'PO NBR: '         DELIMITED BY SIZE          31713400
317135                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          31713500
317136                           INTO DP013-MESSAGE-TEXT(2)             31713600
317137             MOVE DK-PO-LINE-NBR TO PV-DISPLAY-PO-LINE-NBR        31713700
317138             STRING 'PO LINE NBR: '    DELIMITED BY SIZE          31713800
317139                PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE          31713900
317140                           INTO DP013-MESSAGE-TEXT(3)             31714000
317141             MOVE SQLCA      TO DP013-SQLCA                       31714100
317142             MOVE 'SUT00015' TO DP013-DB2-TABLE-NAME(1)           31714200
317143             SET DP013-DB2-ABEND                                  31714300
317144                             TO TRUE                              31714400
317145             SET DP013-NO-ROLLBACK                                31714500
317146                             TO TRUE                              31714600
317147             PERFORM 9999-WRITE-CICS-LOG-MSG                      31714700
317148             SET PS-DUMP-TO-LOG       TO TRUE                     31714800
317149             SET SU021-RFID-DB2-ERROR TO TRUE                     31714900
317150     END-EVALUATE.                                                31715000
317151                                                                  31715100
317152                                                                  31715200
317153 7850-SELECT-DC-PASSED.                                           31715300
317154                                                                  31715400
317155     STRING ' 7850-SELECT-DC-PASSED'                              31715500
317156         DELIMITED BY SIZE                                        31715600
317157         INTO PV-CICS-MSG-AREA.                                   31715700
317158     PERFORM 9990-WRITE-CICS.                                     31715800
317159     MOVE 0         TO PV-PASSED-COUNT.                           31715900
317160     EXEC SQL                                                     31716000
317161          SELECT COUNT(*)                                         31716100
317162          INTO   :PV-PASSED-COUNT                                 31716200
317163          FROM   SUT_PO_AUD_REQ                                   31716300
317164          WHERE  PO_NBR         = :DK-PO-NBR                      31716400
317165            AND  PO_LNE_NBR     = :DK-PO-LINE-NBR                 31716500
317166            AND  PO_PREPK_ID    = :DK-PREPK-ID                    31716600
317167            AND  OPER_UNT_ID    = :DK-OPER-UNT-ID                 31716700
317168            AND  AUD_STAT_CDE   = :PC-P                           31716800
317169            AND  DAYS(CRE_TMST) > :PV-LIMIT-DAYS                  31716900
317170            AND  PKGNG_TYP_CDE  = 'RF'                            31717005
317171     END-EXEC.                                                    31717100
317172                                                                  31717200
317173     EVALUATE TRUE                                                31717300
317174         WHEN SQLCODE = ZERO                                      31717400
317175             CONTINUE                                             31717500
317176         WHEN SQLWARN0 NOT = SPACES                               31717600
317177         WHEN SQLCODE NOT EQUAL ZERO                              31717700
317178             MOVE '7800-SELECT-PASSED'                            31717800
317179                             TO DP013-PARAGRAPH                   31717900
317180             MOVE 'SUKCS720 - GET PASSED AUDITS'                  31718000
317181                             TO DP013-MESSAGE-TEXT(1)             31718100
317182             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 31718200
317183             STRING 'PO NBR: '         DELIMITED BY SIZE          31718300
317184                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          31718400
317185                           INTO DP013-MESSAGE-TEXT(2)             31718500
317186             MOVE DK-PO-LINE-NBR TO PV-DISPLAY-PO-LINE-NBR        31718600
317187             STRING 'PO LINE NBR: '    DELIMITED BY SIZE          31718700
317188                PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE          31718800
317189                           INTO DP013-MESSAGE-TEXT(3)             31718900
317190             MOVE SQLCA      TO DP013-SQLCA                       31719000
317191             MOVE 'SUT00015' TO DP013-DB2-TABLE-NAME(1)           31719100
317192             SET DP013-DB2-ABEND                                  31719200
317193                             TO TRUE                              31719300
317194             SET DP013-NO-ROLLBACK                                31719400
317195                             TO TRUE                              31719500
317196             PERFORM 9999-WRITE-CICS-LOG-MSG                      31719600
317197             SET PS-DUMP-TO-LOG       TO TRUE                     31719700
317198             SET SU021-RFID-DB2-ERROR TO TRUE                     31719800
317199     END-EVALUATE.                                                31719900
317200                                                                  31720000
317201                                                                  31720100
317202                                                                  31720200
317203 7900-SELECT-THIS-FACILITY.                                       31720300
317204                                                                  31720400
317205     STRING ' 7900-SELECT-THIS-FACILITY'                          31720500
317206         DELIMITED BY SIZE                                        31720600
317207         INTO PV-CICS-MSG-AREA.                                   31720700
317208     PERFORM 9990-WRITE-CICS.                                     31720800
317209     EXEC SQL                                                     31720900
317210          SELECT AUD_CNTL_NBR                                     31721000
317211             ,   AUD_STAT_CDE                                     31721100
317212             ,   CART_QTY                                         31721200
317213             ,   UNT_QTY                                          31721300
317214          INTO   :SUT00015-AUD-CNTL-NBR                           31721400
317215             ,   :SUT00015-AUD-STAT-CDE                           31721500
317216             ,   :SUT00015-CART-QTY                               31721600
317217             ,   :SUT00015-UNT-QTY                                31721700
317218          FROM   SUT_PO_AUD_REQ                                   31721800
317219          WHERE  PO_NBR         = :DK-PO-NBR                      31721900
317220            AND  PO_LNE_NBR     = :DK-PO-LINE-NBR                 31722000
317221            AND  PO_PREPK_ID    = :DK-PREPK-ID                    31722100
317222            AND  RCVR_SEQ_NBR   = :DK-RCVR-SEQ-NBR                31722200
317223            AND  OPER_UNT_ID    = :DK-OPER-UNT-ID                 31722300
317224            AND  PKGNG_TYP_CDE  = 'RF'                            31722405
317225     END-EXEC.                                                    31722500
317226                                                                  31722600
317227     EVALUATE TRUE                                                31722700
317228         WHEN SQLCODE = ZERO                                      31722800
317229             SET PS-AUDIT-STARTED TO TRUE                         31722900
317230             MOVE 'RF-AUDIT-STARTED       '   TO PV-CICS-MSG-AREA 31723000
317231             PERFORM 9990-WRITE-CICS                              31723100
317232         WHEN SQLCODE = +100                                      31723200
317233             SET PS-NO-AUDIT-STARTED TO TRUE                      31723300
317234             MOVE 'RF-AUDIT-STARTED       '   TO PV-CICS-MSG-AREA 31723400
317235             PERFORM 9990-WRITE-CICS                              31723500
317236         WHEN SQLWARN0 NOT = SPACES                               31723600
317237         WHEN SQLCODE NOT EQUAL ZERO                              31723700
317238             MOVE '7900-SELECT-THIS-FACILITY'                     31723800
317239                             TO DP013-PARAGRAPH                   31723900
317240             MOVE 'SUKCS720 - GET AUDITS FOR THIS FACILITY'       31724000
317241                             TO DP013-MESSAGE-TEXT(1)             31724100
317242             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 31724200
317243             STRING 'PO NBR: '         DELIMITED BY SIZE          31724300
317244                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          31724400
317245                           INTO DP013-MESSAGE-TEXT(2)             31724500
317246             MOVE DK-PO-LINE-NBR TO PV-DISPLAY-PO-LINE-NBR        31724600
317247             STRING 'PO LINE NBR: '    DELIMITED BY SIZE          31724700
317248                PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE          31724800
317249                           INTO DP013-MESSAGE-TEXT(3)             31724900
317250             MOVE DK-RCVR-SEQ-NBR                                 31725000
317251                             TO PV-DISPLAY-RCVR-SEQ-NBR           31725100
317252             STRING 'RECV SEQ: '       DELIMITED BY SIZE          31725200
317253                 PV-DISPLAY-RCVR-SEQ-NBR                          31725300
317254                                       DELIMITED BY SIZE          31725400
317255                           INTO DP013-MESSAGE-TEXT(4)             31725500
317256             MOVE SQLCA      TO DP013-SQLCA                       31725600
317257             MOVE 'SUT00015' TO DP013-DB2-TABLE-NAME(1)           31725700
317258             SET DP013-DB2-ABEND                                  31725800
317259                             TO TRUE                              31725900
317260             SET DP013-NO-ROLLBACK                                31726000
317261                             TO TRUE                              31726100
317262             PERFORM 9999-WRITE-CICS-LOG-MSG                      31726200
317263             SET PS-DUMP-TO-LOG       TO TRUE                     31726300
317264             SET SU021-RFID-DB2-ERROR TO TRUE                     31726400
317265     END-EVALUATE.                                                31726500
317266                                                                  31726600
317267                                                                  31726700
317268*----------------------------------------------------------------*31726800
317269* COUNT THE NUMBER OF LINES ALREADY PROMPTED FOR THIS PO-RCVR    *31726900
317270*----------------------------------------------------------------*31727000
317271 7950-SELECT-PROMPTED-LINES.                                      31727100
317272                                                                  31727200
317273     STRING ' 7950-SELECT-PROMPTED-LINES'                         31727300
317274         DELIMITED BY SIZE                                        31727400
317275         INTO PV-CICS-MSG-AREA.                                   31727500
317276     PERFORM 9990-WRITE-CICS.                                     31727600
317277                                                                  31727700
317278     EXEC SQL                                                     31727800
317279          SELECT COUNT(*)                                         31727900
317280          INTO   :PV-PROMPTED-CNT                                 31728000
317281          FROM   SUT_PO_AUD_REQ                                   31728100
317282          WHERE  PO_NBR         = :DK-PO-NBR                      31728200
317283            AND  RCVR_SEQ_NBR   = :DK-RCVR-SEQ-NBR                31728300
317284            AND  PKGNG_TYP_CDE  = 'RF'                            31728405
317285     END-EXEC.                                                    31728500
317286                                                                  31728600
317287     EVALUATE TRUE                                                31728700
317288         WHEN SQLCODE = ZERO                                      31728800
317289         WHEN SQLCODE = +100                                      31728900
317290             CONTINUE                                             31729000
317291         WHEN SQLWARN0 NOT = SPACES                               31729100
317292         WHEN SQLCODE NOT EQUAL ZERO                              31729200
317293             MOVE '7950-SELECT-PROMPTED-LINES'                    31729300
317294                                        TO DP013-PARAGRAPH        31729400
317295             MOVE 'SUKCS720 - GET LINE COUNT FOR PO-RCVR  '       31729500
317296                                        TO DP013-MESSAGE-TEXT(1)  31729600
317297             MOVE DK-PO-NBR             TO PV-DISPLAY-PO-NBR      31729700
317298             MOVE DK-RCVR-SEQ-NBR       TO PV-DISPLAY-RCVR-SEQ-NBR31729800
317299             STRING 'PO-RCVR: '            DELIMITED BY SIZE      31729900
317300                 PV-DISPLAY-PO-NBR '-'     DELIMITED BY SIZE      31730000
317301                 PV-DISPLAY-RCVR-SEQ-NBR   DELIMITED BY SIZE      31730100
317302                                      INTO DP013-MESSAGE-TEXT(2)  31730200
317303             MOVE SQLCA      TO DP013-SQLCA                       31730300
317304             MOVE 'SUT00015' TO DP013-DB2-TABLE-NAME(1)           31730400
317305             SET DP013-DB2-ABEND                                  31730500
317306                             TO TRUE                              31730600
317307             SET DP013-NO-ROLLBACK                                31730700
317308                             TO TRUE                              31730800
317309             PERFORM 9999-WRITE-CICS-LOG-MSG                      31730900
317310             SET PS-DUMP-TO-LOG       TO TRUE                     31731000
317311             SET SU021-RFID-DB2-ERROR TO TRUE                     31731100
317312     END-EVALUATE.                                                31731200
317313                                                                  31731300
317314******************************************************************31731400
317315* 8000-SELECT-SHPUNT                                              31731500
317316*    GET THE STORE NUMBER FROM THE SHIPPING UNIT TABLE            31731600
317317******************************************************************31731700
317318 8000-SELECT-SHPUNT.                                              31731800
317319                                                                  31731900
317320     EXEC SQL                                                     31732000
317321         SELECT A.DEST_OPER_UNT_ID                                31732100
317322              , A.ACTV_IND                                        31732200
317323         INTO   :SHPUNT-DEST-OPER-UNT-ID                          31732300
317324              , :SHPUNT-ACTV-IND                                  31732400
317325          FROM  TSHPUNT A                                         31732500
317326          WHERE A.SHIPT_UNT_ID      = :DK-SHIPT-UNT-ID            31732600
317327     END-EXEC.                                                    31732700
317328                                                                  31732800
317329     EVALUATE TRUE                                                31732900
317330        WHEN SQLCODE = ZERO                                       31733000
317331             IF SHPUNT-ACTV-IND  = 'I'                            31733100
317332                 MOVE ZEROS        TO SHPUNT-DEST-OPER-UNT-ID     31733200
317333             END-IF                                               31733300
317334        WHEN SQLCODE = +100                                       31733400
317335             MOVE ZEROS         TO SHPUNT-DEST-OPER-UNT-ID        31733500
317336         WHEN SQLWARN0 NOT = SPACES                               31733600
317337         WHEN SQLCODE NOT EQUAL ZERO                              31733700
317338             MOVE '8000-SELECT-SHPUNT'                            31733800
317339                             TO DP013-PARAGRAPH                   31733900
317340             MOVE 'SUKCS720 - GET DEST OPER UNIT'                 31734000
317341                             TO DP013-MESSAGE-TEXT(1)             31734100
317342             MOVE DK-SHIPT-UNT-ID TO PV-DISPLAY-SHIPT-UNT-ID      31734200
317343             STRING 'SHIPT UNT ID: '   DELIMITED BY SIZE          31734300
317344               PV-DISPLAY-SHIPT-UNT-ID DELIMITED BY SIZE          31734400
317345                           INTO DP013-MESSAGE-TEXT(2)             31734500
317346             MOVE SQLCA      TO DP013-SQLCA                       31734600
317347             MOVE 'TSHPUNT ' TO DP013-DB2-TABLE-NAME(1)           31734700
317348             SET DP013-DB2-ABEND                                  31734800
317349                             TO TRUE                              31734900
317350             SET DP013-NO-ROLLBACK                                31735000
317351                             TO TRUE                              31735100
317352             PERFORM 9999-WRITE-CICS-LOG-MSG                      31735200
317353             SET PS-DUMP-TO-LOG       TO TRUE                     31735300
317354             SET SU021-RFID-DB2-ERROR TO TRUE                     31735400
317355     END-EVALUATE.                                                31735500
317356                                                                  31735600
317357                                                                  31735700
317358 8100-SUM-PROMPTED-UNITS.                                         31735800
317359                                                                  31735900
317360     STRING ' 8100-SUM-PROMPTED-UNITS'                            31736000
317361         DELIMITED BY SIZE                                        31736100
317362         INTO PV-CICS-MSG-AREA.                                   31736200
317363     PERFORM 9990-WRITE-CICS.                                     31736300
317364     EXEC SQL                                                     31736400
317365         SELECT SUM(B.SHPD_QTY)                                   31736500
317366           INTO :PV-SHPD-QTY-SUM :DN-SUM-NULL                     31736600
317367           FROM TSUATRN A                                         31736700
317368             ,  TSHUUPC B                                         31736800
317369         WHERE A.AUD_CNTL_NBR    = :DK-AUDIT-CNTL-NBR             31736900
317370           AND A.SHIPT_UNT_ID    = B.SHIPT_UNT_ID                 31737000
317371     END-EXEC.                                                    31737100
317372                                                                  31737200
317373     EVALUATE TRUE                                                31737300
317374         WHEN SQLCODE = ZERO                                      31737400
317375             IF DN-SUM-NULL = -1                                  31737500
317376                 MOVE 0     TO PV-SHPD-QTY-SUM                    31737600
317377             END-IF                                               31737700
317378         WHEN SQLWARN0 NOT = SPACES                               31737800
317379         WHEN SQLCODE NOT EQUAL ZERO                              31737900
317380             MOVE '8100-SUM-PROMPTED-UNITS'                       31738000
317381                             TO DP013-PARAGRAPH                   31738100
317382             MOVE 'SUM THE PROMPTED CARTONS'                      31738200
317383                             TO DP013-MESSAGE-TEXT(1)             31738300
317384             STRING 'AUDIT CONTROL NUMBER: ' DELIMITED BY SIZE    31738400
317385                    PV-AUDIT-CNTL-NBR-X      DELIMITED BY SIZE    31738500
317386                                       INTO DP013-MESSAGE-TEXT (2)31738600
317387             MOVE SUATRN-SHIPT-UNT-ID   TO PV-DISPLAY-SHIPT-UNT-ID31738700
317388             STRING 'SHIP UNIT ID: '         DELIMITED BY SIZE    31738800
317389                    PV-DISPLAY-SHIPT-UNT-ID  DELIMITED BY SIZE    31738900
317390                                       INTO DP013-MESSAGE-TEXT (3)31739000
317391             MOVE SQLCA      TO DP013-SQLCA                       31739100
317392             MOVE 'TSUATRN'  TO DP013-DB2-TABLE-NAME(1)           31739200
317393             MOVE 'TSHUUPC'  TO DP013-DB2-TABLE-NAME(1)           31739300
317394             SET DP013-DB2-ABEND                                  31739400
317395                             TO TRUE                              31739500
317396             SET DP013-NO-ROLLBACK                                31739600
317397                             TO TRUE                              31739700
317398             PERFORM 9999-WRITE-CICS-LOG-MSG                      31739800
317399             SET PS-DUMP-TO-LOG       TO TRUE                     31739900
317400             SET SU021-RFID-DB2-ERROR TO TRUE                     31740000
317401     END-EVALUATE.                                                31740100
317402                                                                  31740200
317403                                                                  31740300
317404 8150-SELECT-CURRENT-CARTON.                                      31740400
317405                                                                  31740500
317406     STRING ' 8150-SELECT-CURRENT-CARTON'                         31740600
317407         DELIMITED BY SIZE                                        31740700
317408         INTO PV-CICS-MSG-AREA.                                   31740800
317409     PERFORM 9990-WRITE-CICS.                                     31740900
317410     EXEC SQL                                                     31741000
317411         SELECT SUM(SHPD_QTY)                                     31741100
317412           INTO :SHUUPC-SHPD-QTY  :DN-SUM-NULL-UPC                31741200
317413           FROM TSHUUPC                                           31741300
317414         WHERE SHIPT_UNT_ID      = :DK-SHIPT-UNT-ID               31741400
317415           AND TRN_NBR           = :DK-PO-NBR                     31741500
317416           AND TRN_LNE_NBR       = :DK-PO-LINE-NBR                31741600
317417     END-EXEC.                                                    31741700
317418                                                                  31741800
317419     EVALUATE TRUE                                                31741900
317420         WHEN SQLCODE = ZERO                                      31742000
317421             IF DN-SUM-NULL-UPC = -1                              31742100
317422                 MOVE 0     TO SHUUPC-SHPD-QTY                    31742200
317423             END-IF                                               31742300
317424         WHEN SQLWARN0 NOT = SPACES                               31742400
317425         WHEN SQLCODE NOT EQUAL ZERO                              31742500
317426             MOVE '8150-SELECT-CURRENT-CARTON'                    31742600
317427                             TO DP013-PARAGRAPH                   31742700
317428             MOVE 'SELECT THE UNIT QTY - THIS CARTON'             31742800
317429                             TO DP013-MESSAGE-TEXT(1)             31742900
317430             MOVE DK-SHIPT-UNT-ID TO PV-DISPLAY-SHIPT-UNT-ID      31743000
317431             STRING 'SHIPT UNT ID: '   DELIMITED BY SIZE          31743100
317432               PV-DISPLAY-SHIPT-UNT-ID DELIMITED BY SIZE          31743200
317433                           INTO DP013-MESSAGE-TEXT(2)             31743300
317434             MOVE SQLCA      TO DP013-SQLCA                       31743400
317435             MOVE 'TSHUUPC'  TO DP013-DB2-TABLE-NAME(1)           31743500
317436             SET DP013-DB2-ABEND                                  31743600
317437                             TO TRUE                              31743700
317438             SET DP013-NO-ROLLBACK                                31743800
317439                             TO TRUE                              31743900
317440             PERFORM 9999-WRITE-CICS-LOG-MSG                      31744000
317441             SET PS-DUMP-TO-LOG       TO TRUE                     31744100
317442             SET SU021-RFID-DB2-ERROR TO TRUE                     31744200
317443     END-EVALUATE.                                                31744300
317444                                                                  31744400
317445                                                                  31744500
317446 8200-SUM-CARTONS.                                                31744600
317447                                                                  31744700
317448     STRING ' 8200-SUM-CARTONS'                                   31744800
317449         DELIMITED BY SIZE                                        31744900
317450         INTO PV-CICS-MSG-AREA.                                   31745000
317451     PERFORM 9990-WRITE-CICS.                                     31745100
317452     EXEC SQL                                                     31745200
317453         SELECT COUNT(*)                                          31745300
317454           INTO :PV-CARTON-COUNT                                  31745400
317455           FROM TSUATRN                                           31745500
317456         WHERE  AUD_CNTL_NBR     = :DK-AUDIT-CNTL-NBR             31745600
317457     END-EXEC.                                                    31745700
317458                                                                  31745800
317459     EVALUATE TRUE                                                31745900
317460         WHEN SQLCODE = ZERO                                      31746000
317461             CONTINUE                                             31746100
317462         WHEN SQLWARN0 NOT = SPACES                               31746200
317463         WHEN SQLCODE NOT EQUAL ZERO                              31746300
317464             MOVE '8200-SUM-CARTONS'                              31746400
317465                             TO DP013-PARAGRAPH                   31746500
317466             MOVE 'SUM THE PROMPTED CARTONS'                      31746600
317467                             TO DP013-MESSAGE-TEXT(1)             31746700
317468             STRING 'AUDIT CONTROL NUMBER: ' DELIMITED BY SIZE    31746800
317469                    PV-AUDIT-CNTL-NBR-X      DELIMITED BY SIZE    31746900
317470                                       INTO DP013-MESSAGE-TEXT (2)31747000
317471             MOVE SUATRN-SHIPT-UNT-ID   TO PV-DISPLAY-SHIPT-UNT-ID31747100
317472             STRING 'SHIP UNIT ID: '         DELIMITED BY SIZE    31747200
317473                    PV-DISPLAY-SHIPT-UNT-ID  DELIMITED BY SIZE    31747300
317474                                       INTO DP013-MESSAGE-TEXT (3)31747400
317475             MOVE SQLCA      TO DP013-SQLCA                       31747500
317476             MOVE 'TSUATRN'  TO DP013-DB2-TABLE-NAME(1)           31747600
317477             SET DP013-DB2-ABEND                                  31747700
317478                             TO TRUE                              31747800
317479             SET DP013-NO-ROLLBACK                                31747900
317480                             TO TRUE                              31748000
317481             PERFORM 9999-WRITE-CICS-LOG-MSG                      31748100
317482             SET PS-DUMP-TO-LOG       TO TRUE                     31748200
317483             SET SU021-RFID-DB2-ERROR TO TRUE                     31748300
317484     END-EVALUATE.                                                31748400
317485                                                                  31748500
317486                                                                  31748600
317487 8250-SELECT-EXPECTD-CNT.                                         31748700
317488                                                                  31748800
317489     STRING ' 8250-SELECT-EXPECTD-CNT'                            31748900
317490         DELIMITED BY SIZE                                        31749000
317491         INTO PV-CICS-MSG-AREA.                                   31749100
317492     PERFORM 9990-WRITE-CICS.                                     31749200
317493     INITIALIZE        PV-DB2-COUNT-EXP-SCN.                      31749300
317494                                                                  31749400
317495     EXEC SQL                                                     31749500
317496          SELECT  COUNT(*)                                        31749600
317497          INTO  :PV-DB2-COUNT-EXP-SCN                             31749700
317498          FROM   TSHPTPO B                                        31749800
317499                ,TPKSLIP C                                        31749900
317500                ,TINPKSU D                                        31750000
317501          WHERE B.PO_NBR         = :DK-PO-NBR                     31750100
317502            AND B.REC_SEQ_NBR    = :DK-RCVR-SEQ-NBR               31750200
317503            AND B.PO_NBR         = C.PO_NBR                       31750300
317504            AND B.REC_SEQ_NBR    = C.REC_SEQ_NBR                  31750400
317505            AND B.PRIM_SHIPT_IND = 'Y'                            31750500
317506            AND C.VER_STAT_CDE   = 'A'                            31750600
317507            AND B.PO_NBR         = D.PO_NBR                       31750700
317508            AND D.SEQ_NBR        = C.SEQ_NBR                      31750800
317509            AND NOT EXISTS                                        31750900
317510             (SELECT *                                            31751000
317511                FROM TSHUNLO E                                    31751100
317512               WHERE  E.SHIPT_UNT_ID   = D.SHIPT_UNT_ID           31751200
317513                 AND  E.ACTV_CDE       = 'A'                      31751300
317514                 AND  E.SCN_LOC_ID     = 'RECV')                  31751400
317515     END-EXEC                                                     31751500
317516                                                                  31751600
317517                                                                  31751700
317518     EVALUATE TRUE                                                31751800
317519         WHEN SQLCODE = ZERO                                      31751900
317520         WHEN SQLCODE = +100                                      31752000
317521              CONTINUE                                            31752100
317522         WHEN SQLWARN0 NOT = SPACE                                31752200
317523         WHEN SQLCODE NOT = ZERO                                  31752300
317524             MOVE '8250-SELECT-EXPECTD-CNT'                       31752400
317525                               TO DP013-PARAGRAPH                 31752500
317526             MOVE 'SUKCS720 - GET PO EXPECTED COUNT'              31752600
317527                             TO DP013-MESSAGE-TEXT(1)             31752700
317528             MOVE DK-INBND-TRIP-ID TO                             31752800
317529                                PV-DISPLAY-INBND-TRIP-ID          31752900
317530             STRING 'TRIP ID: '        DELIMITED BY SIZE          31753000
317531                 PV-DISPLAY-INBND-TRIP-ID                         31753100
317532                                       DELIMITED BY SIZE          31753200
317533                           INTO DP013-MESSAGE-TEXT(2)             31753300
317534             MOVE DK-PO-NBR  TO PV-DISPLAY-PO-NBR                 31753400
317535             STRING 'PO NBR: '         DELIMITED BY SIZE          31753500
317536                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          31753600
317537                           INTO DP013-MESSAGE-TEXT(3)             31753700
317538             MOVE DK-RCVR-SEQ-NBR                                 31753800
317539                             TO PV-DISPLAY-RCVR-SEQ-NBR           31753900
317540             STRING 'RECV SEQ: '       DELIMITED BY SIZE          31754000
317541                 PV-DISPLAY-RCVR-SEQ-NBR                          31754100
317542                                       DELIMITED BY SIZE          31754200
317543                           INTO DP013-MESSAGE-TEXT(4)             31754300
317544             MOVE SQLCA      TO DP013-SQLCA                       31754400
317545             MOVE 'TSHPTPO'  TO DP013-DB2-TABLE-NAME(1)           31754500
317546             MOVE 'TPKSLIP'  TO DP013-DB2-TABLE-NAME(2)           31754600
317547             MOVE 'TINPKSU'  TO DP013-DB2-TABLE-NAME(3)           31754700
317548             SET DP013-DB2-ABEND                                  31754800
317549                             TO TRUE                              31754900
317550             SET DP013-NO-ROLLBACK                                31755000
317551                             TO TRUE                              31755100
317552             PERFORM 9999-WRITE-CICS-LOG-MSG                      31755200
317553             SET PS-DUMP-TO-LOG       TO TRUE                     31755300
317554             SET SU021-RFID-DB2-ERROR TO TRUE                     31755400
317555     END-EVALUATE.                                                31755500
317556                                                                  31755600
317557                                                                  31755700
317558****************************************************************  31755800
317559* 8300-INSERT-TSUNAUD.                                         *  31755900
317560*   INSERT A NEW SHIPPING UNIT AUDIT RECORD                    *  31756000
317561****************************************************************  31756100
317562 8300-INSERT-TSUNAUD.                                             31756200
317563                                                                  31756300
317564     STRING ' 8300-INSERT-TSUNAUD'                                31756400
317565         DELIMITED BY SIZE                                        31756500
317566         INTO PV-CICS-MSG-AREA.                                   31756600
317567     PERFORM 9990-WRITE-CICS.                                     31756700
317568     EXEC SQL                                                     31756800
317569         INSERT INTO TSUNAUD                                      31756900
317570               (AUD_CNTL_NBR                                      31757000
317571             ,  AUD_STRT_TMST                                     31757100
317572             ,  AUD_STP_TMST                                      31757200
317573             ,  AUD_PSPND_MNIT_QTY                                31757300
317574             ,  AUD_CLO_MNIT_QTY                                  31757400
317575             ,  AUD_USR_ID                                        31757500
317576             ,  OPER_UNT_ID                                       31757600
317577             ,  FCLTY_ID                                          31757700
317578             ,  PRC_FCLTY_AREA_ID                                 31757800
317579             ,  AUD_STAT_CDE                                      31757900
317580             ,  AUD_TYP_CDE                                       31758000
317581             ,  AUD_CAT_CDE                                       31758100
317582             ,  DEST_TYP_CDE)                                     31758200
317583        VALUES (:SUNAUD-AUD-CNTL-NBR                              31758300
317584             ,  '9999-09-09-09.09.09.999999'                      31758400
317585             ,  '9999-09-09-09.09.09.999999'                      31758500
317586             ,  :SUNAUD-AUD-PSPND-MNIT-QTY                        31758600
317587             ,  :SUNAUD-AUD-CLO-MNIT-QTY                          31758700
317588             ,  :SUNAUD-AUD-USR-ID                                31758800
317589             ,  :SUNAUD-OPER-UNT-ID                               31758900
317590             ,  :SUNAUD-FCLTY-ID                                  31759000
317591             ,  :SUNAUD-PRC-FCLTY-AREA-ID                         31759100
317592             ,  :SUNAUD-AUD-STAT-CDE                              31759200
317593             ,  :SUNAUD-AUD-TYP-CDE                               31759300
317594             ,  :SUNAUD-AUD-CAT-CDE                               31759400
317595             ,  :SUNAUD-DEST-TYP-CDE)                             31759500
317596     END-EXEC.                                                    31759600
317597                                                                  31759700
317598     EVALUATE TRUE                                                31759800
317599         WHEN SQLCODE = ZERO                                      31759900
317600              CONTINUE                                            31760000
317601         WHEN SQLWARN0 NOT = SPACES                               31760100
317602         WHEN SQLCODE < ZERO                                      31760200
317603         WHEN SQLCODE > ZERO                                      31760300
317604             MOVE '8300-INSERT-TSUNAUD'  TO DP013-PARAGRAPH       31760400
317605             MOVE 'INSERT TSUNADU'       TO DP013-MESSAGE-TEXT (1)31760500
317606             STRING 'AUDIT CONTROL NUMBER: ' DELIMITED BY SIZE    31760600
317607                    PV-AUDIT-CNTL-NBR-X      DELIMITED BY SIZE    31760700
317608                                       INTO DP013-MESSAGE-TEXT (2)31760800
317609             MOVE SQLCA                  TO DP013-SQLCA           31760900
317610             MOVE 'TSUNAUD'            TO DP013-DB2-TABLE-NAME (1)31761000
317611             SET DP013-DB2-ABEND                                  31761100
317612                             TO TRUE                              31761200
317613             SET DP013-NO-ROLLBACK                                31761300
317614                             TO TRUE                              31761400
317615             PERFORM 9999-WRITE-CICS-LOG-MSG                      31761500
317616             SET PS-DUMP-TO-LOG       TO TRUE                     31761600
317617             SET SU021-RFID-DB2-ERROR TO TRUE                     31761700
317618     END-EVALUATE.                                                31761800
317619                                                                  31761900
317620                                                                  31762000
317621 8350-INSERT-TSUATRN.                                             31762100
317622                                                                  31762200
317623     STRING ' 8350-INSERT-TSUATRN'                                31762300
317624         DELIMITED BY SIZE                                        31762400
317625         INTO PV-CICS-MSG-AREA.                                   31762500
317626     PERFORM 9990-WRITE-CICS.                                     31762600
317627     EXEC SQL                                                     31762700
317628         INSERT INTO TSUATRN                                      31762800
317629               (AUD_CNTL_NBR                                      31762900
317630             ,  SHIPT_UNT_ID                                      31763000
317631             ,  UNT_AUD_STRT_TMST                                 31763100
317632             ,  UNT_AUD_STP_TMST                                  31763200
317633             ,  UNT_PSPND_MNIT_QTY                                31763300
317634             ,  UNT_CLO_MNIT_QTY                                  31763400
317635             ,  UNT_AUD_USR_ID                                    31763500
317636             ,  UNT_AUD_STAT_CDE                                  31763600
317637             ,  TRN_NBR                                           31763700
317638             ,  REC_SEQ_NBR                                       31763800
317639             ,  DEST_OPER_UNT_ID                                  31763900
317640             ,  DEST_FCLTY_ID                                     31764000
317641             ,  UNT_AUD_ERR_IND)                                  31764100
317642        VALUES (:SUATRN-AUD-CNTL-NBR                              31764200
317643             ,  :SUATRN-SHIPT-UNT-ID                              31764300
317644             ,  :PC-DEFAULT-DATE                                  31764400
317645             ,  :PC-DEFAULT-DATE                                  31764500
317646             ,   0                                                31764600
317647             ,   0                                                31764700
317648             ,  :SUATRN-UNT-AUD-USR-ID                            31764800
317649             ,  :SUATRN-UNT-AUD-STAT-CDE                          31764900
317650             ,  :SUATRN-TRN-NBR                                   31765000
317651             ,  :SUATRN-REC-SEQ-NBR                               31765100
317652             ,  :SUATRN-DEST-OPER-UNT-ID                          31765200
317653             ,  1                                                 31765300
317654             ,  :SUATRN-UNT-AUD-ERR-IND)                          31765400
317655     END-EXEC.                                                    31765500
317656                                                                  31765600
317657     EVALUATE TRUE                                                31765700
317658         WHEN SQLCODE = ZERO                                      31765800
317659             CONTINUE                                             31765900
317660         WHEN SQLWARN0 NOT = SPACES                               31766000
317661         WHEN SQLCODE NOT EQUAL ZERO                              31766100
317662             MOVE '8350-INSERT-TSUATRN'                           31766200
317663                             TO DP013-PARAGRAPH                   31766300
317664             MOVE 'INSERT AUDIT RECORD'                           31766400
317665                             TO DP013-MESSAGE-TEXT(1)             31766500
317666             STRING 'AUDIT CONTROL NUMBER: ' DELIMITED BY SIZE    31766600
317667                    PV-AUDIT-CNTL-NBR-X      DELIMITED BY SIZE    31766700
317668                                       INTO DP013-MESSAGE-TEXT (2)31766800
317669             MOVE SUATRN-SHIPT-UNT-ID   TO PV-DISPLAY-SHIPT-UNT-ID31766900
317670             STRING 'SHIP UNIT ID: '         DELIMITED BY SIZE    31767000
317671                    PV-DISPLAY-SHIPT-UNT-ID  DELIMITED BY SIZE    31767100
317672                                       INTO DP013-MESSAGE-TEXT (3)31767200
317673             MOVE SQLCA      TO DP013-SQLCA                       31767300
317674             MOVE 'TSUATRN'  TO DP013-DB2-TABLE-NAME(1)           31767400
317675             SET DP013-DB2-ABEND                                  31767500
317676                             TO TRUE                              31767600
317677             SET DP013-NO-ROLLBACK                                31767700
317678                             TO TRUE                              31767800
317679             PERFORM 9999-WRITE-CICS-LOG-MSG                      31767900
317680             SET PS-DUMP-TO-LOG       TO TRUE                     31768000
317681             SET SU021-RFID-DB2-ERROR TO TRUE                     31768100
317682     END-EVALUATE.                                                31768200
317683                                                                  31768300
317684                                                                  31768400
317685 8400-INSERT-PO-AUD-REQ.                                          31768500
317686                                                                  31768600
317687     IF SU021-USER-ID  = 'TKMA352' OR 'TKMA135' OR 'TKMA738'      31768705
317688        MOVE 'C'        TO SUT00015-CART-PRMPT-CDE                31768800
317689        MOVE  99        TO SUT00015-AUD-CART-QTY                  31768900
317690        MOVE  999       TO SUT00015-AUD-UNT-QTY                   31769000
317691     END-IF                                                       31769100
317692                                                                  31769200
317693     STRING ' 8400-INSERT-PO-AUD-REQ'                             31769300
317694         DELIMITED BY SIZE                                        31769400
317695         INTO PV-CICS-MSG-AREA.                                   31769500
317696     PERFORM 9990-WRITE-CICS.                                     31769600
317697     EXEC SQL                                                     31769700
317698         INSERT INTO SUT_PO_AUD_REQ                               31769800
317699               (PO_NBR                                            31769900
317700             ,  PO_LNE_NBR                                        31770000
317701             ,  PO_PREPK_ID                                       31770100
317702             ,  OPER_UNT_ID                                       31770200
317703             ,  INBND_TRIP_ID                                     31770300
317704             ,  RCVR_SEQ_NBR                                      31770400
317705             ,  AUD_CNTL_NBR                                      31770500
317706             ,  VND_RNKG_CDE                                      31770600
317707             ,  PKGNG_TYP_CDE                                     31770700
317708             ,  EFF_BEG_TMST                                      31770800
317709             ,  CART_QTY                                          31770900
317710             ,  UNT_QTY                                           31771000
317711             ,  AUD_CART_QTY                                      31771100
317712             ,  AUD_UNT_QTY                                       31771200
317713             ,  AUD_STAT_CDE                                      31771300
317714             ,  DFRD_AUD_IND                                      31771400
317715             ,  AUD_ERR_PCT                                       31771500
317716             ,  CRE_TMST                                          31771600
317717             ,  CART_PRMPT_CDE                                    31771700
317718             ,  ENT_ID                                            31771800
317719             ,  DEPT_NBR)                                         31771900
317720        VALUES (:SUT00015-PO-NBR                                  31772000
317721             ,  :SUT00015-PO-LNE-NBR                              31772100
317722             ,  :SUT00015-PO-PREPK-ID                             31772200
317723             ,  :SUT00015-OPER-UNT-ID                             31772300
317724             ,  :SUT00015-INBND-TRIP-ID                           31772400
317725             ,  :SUT00015-RCVR-SEQ-NBR                            31772500
317726             ,  :SUT00015-AUD-CNTL-NBR                            31772600
317727             ,  :SUT00015-VND-RNKG-CDE                            31772700
317728             ,  :SUT00015-PKGNG-TYP-CDE                           31772800
317729             ,  :SUT00015-EFF-BEG-TMST                            31772900
317730             ,  :SUT00015-CART-QTY                                31773000
317731             ,  :SUT00015-UNT-QTY                                 31773100
317732             ,  :SUT00015-AUD-CART-QTY                            31773200
317733             ,  :SUT00015-AUD-UNT-QTY                             31773300
317734             ,  :SUT00015-AUD-STAT-CDE                            31773400
317735             ,  :SUT00015-DFRD-AUD-IND                            31773500
317736             ,  :SUT00015-AUD-ERR-PCT                             31773600
317737             ,  CURRENT TIMESTAMP                                 31773700
317738             ,  :SUT00015-CART-PRMPT-CDE                          31773800
317739             ,  :SUT00015-ENT-ID                                  31773900
317740             ,  :SUT00015-DEPT-NBR)                               31774000
317741     END-EXEC.                                                    31774100
317742                                                                  31774200
317743     EVALUATE TRUE                                                31774300
317744         WHEN SQLCODE = ZERO                                      31774400
317745             CONTINUE                                             31774500
317746         WHEN SQLWARN0 NOT = SPACES                               31774600
317747         WHEN SQLCODE NOT EQUAL ZERO                              31774700
317748             MOVE '8400-INSERT-PO-AUD-REQ'                        31774800
317749                             TO DP013-PARAGRAPH                   31774900
317750             MOVE 'INSERT PO-AUD-REQ'                             31775000
317751                             TO DP013-MESSAGE-TEXT(1)             31775100
317752             MOVE SUT00015-PO-NBR TO PV-DISPLAY-PO-NBR            31775200
317753             STRING 'PO NBR: '         DELIMITED BY SIZE          31775300
317754                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          31775400
317755                           INTO DP013-MESSAGE-TEXT(2)             31775500
317756             MOVE SUT00015-PO-LNE-NBR TO PV-DISPLAY-PO-LINE-NBR   31775600
317757             STRING 'PO LINE NBR: '    DELIMITED BY SIZE          31775700
317758                PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE          31775800
317759                           INTO DP013-MESSAGE-TEXT(3)             31775900
317760             MOVE SQLCA      TO DP013-SQLCA                       31776000
317761             MOVE 'SUT00015' TO DP013-DB2-TABLE-NAME(1)           31776100
317762             SET DP013-DB2-ABEND                                  31776200
317763                             TO TRUE                              31776300
317764             SET DP013-NO-ROLLBACK                                31776400
317765                             TO TRUE                              31776500
317766             PERFORM 9999-WRITE-CICS-LOG-MSG                      31776600
317767             SET PS-DUMP-TO-LOG       TO TRUE                     31776700
317768             SET SU021-RFID-DB2-ERROR TO TRUE                     31776800
317769     END-EVALUATE.                                                31776900
317770                                                                  31777000
317771****************************************************************  31777105
317772* QC AUDIT ROW - PUT THE RFID AUDIT NUMBER IN THE              *  31777205
317773* RWRK_AUD_CNTL_NBR                                            *  31777305
317774****************************************************************  31777405
317775 8410-UPDATE-SUT-PO-AUD-REQ.                                      31777500
317776                                                                  31777600
317777*    AUDIT # IS UNIQUE WITHIN PO                                  31777705
317778     STRING ' 8410-UPDATE-SUT-PO-AUD-REQ'                         31777800
317779         DELIMITED BY SIZE                                        31777900
317780         INTO PV-CICS-MSG-AREA.                                   31778000
317781     PERFORM 9990-WRITE-CICS.                                     31778100
317782     MOVE SU021-AUDIT-NUMBER  TO   PV-AUDIT-NUMBER.               31778205
317783     EXEC SQL                                                     31778300
317784          UPDATE SUT_PO_AUD_REQ                                   31778400
317785          SET    RWRK_AUD_CNTL_NBR = :SUT00015-AUD-CNTL-NBR       31778500
317786          WHERE  AUD_CNTL_NBR   = :PV-AUDIT-NUMBER                31778600
317787            AND  PO_NBR         = :DK-PO-NBR                      31778700
317788            AND  RCVR_SEQ_NBR   = :DK-RCVR-SEQ-NBR                31778800
317789            AND  OPER_UNT_ID    = :DK-OPER-UNT-ID                 31778900
317790     END-EXEC.                                                    31779000
317791                                                                  31779100
317792     EVALUATE TRUE                                                31779200
317793         WHEN SQLCODE = ZERO                                      31779300
317794             CONTINUE                                             31779400
317795         WHEN SQLCODE = +100                                      31779500
317796             MOVE '8410- NO QC AUDIT EXISTS'  TO PV-CICS-MSG-AREA 31779600
317797             PERFORM 9990-WRITE-CICS                              31779700
317798         WHEN SQLWARN0 NOT = SPACES                               31779800
317799         WHEN SQLCODE NOT EQUAL ZERO                              31779900
317800             MOVE '8410-UPDATE-SUT-PO-AUD-REQ'                    31780000
317801                             TO DP013-PARAGRAPH                   31780100
317802             MOVE DK-PO-NBR           TO PV-DISPLAY-PO-NBR        31780200
317803             MOVE DK-PO-LINE-NBR      TO PV-DISPLAY-PO-LINE-NBR   31780300
317804             STRING 'PO NBR, LINE: '   DELIMITED BY SIZE          31780400
317805                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          31780500
317806                 '  '                  DELIMITED BY SIZE          31780600
317807                PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE          31780700
317808                           INTO DP013-MESSAGE-TEXT(1)             31780800
317809             MOVE DK-RCVR-SEQ-NBR                                 31780900
317810                             TO PV-DISPLAY-RCVR-SEQ-NBR           31781000
317811             STRING 'RECV SEQ: '       DELIMITED BY SIZE          31781100
317812                 PV-DISPLAY-RCVR-SEQ-NBR                          31781200
317813                                       DELIMITED BY SIZE          31781300
317814                           INTO DP013-MESSAGE-TEXT(2)             31781400
317815             MOVE DK-OPER-UNT-ID TO PV-DISPLAY-OPER-UNT-ID        31781500
317816             STRING 'OPER UNIT: '      DELIMITED BY SIZE          31781600
317817                PV-DISPLAY-OPER-UNT-ID DELIMITED BY SIZE          31781700
317818                           INTO DP013-MESSAGE-TEXT(3)             31781800
317819             MOVE DK-INBND-TRIP-ID TO                             31781900
317820                                PV-DISPLAY-INBND-TRIP-ID          31782000
317821             STRING 'TRIP ID: '        DELIMITED BY SIZE          31782100
317822                 PV-DISPLAY-INBND-TRIP-ID                         31782200
317823                                       DELIMITED BY SIZE          31782300
317824                           INTO DP013-MESSAGE-TEXT(4)             31782400
317825             MOVE SQLCA      TO DP013-SQLCA                       31782500
317826             MOVE 'SUT00015' TO DP013-DB2-TABLE-NAME(1)           31782600
317827             SET DP013-DB2-ABEND                                  31782700
317828                             TO TRUE                              31782800
317829             SET DP013-NO-ROLLBACK                                31782900
317830                             TO TRUE                              31783000
317831             PERFORM 9999-WRITE-CICS-LOG-MSG                      31783100
317832             SET PS-DUMP-TO-LOG       TO TRUE                     31783200
317833             SET SU021-RFID-DB2-ERROR TO TRUE                     31783300
317834     END-EVALUATE.                                                31783400
317835                                                                  31783505
317836                                                                  31783600
317837****************************************************************  31783700
317838* 8550-VALIDATE-AUDIT-NBR                                      *  31783800
317839*      CHECK THE USER ENTERED AUDIT CONTROL NUMBER - VALIDATE  *  31783900
317840*      EXISTENCE BY GETTING THE AUDIT STATUS                   *  31784000
317841****************************************************************  31784100
317842 8550-VALIDATE-AUDIT-NBR.                                         31784200
317843                                                                  31784300
317844     STRING ' 8550-VALIDATE-AUDIT-NBR'                            31784400
317845         DELIMITED BY SIZE                                        31784500
317846         INTO PV-CICS-MSG-AREA.                                   31784600
317847     PERFORM 9990-WRITE-CICS.                                     31784700
317848     INITIALIZE DCLTSUNAUD.                                       31784800
317849                                                                  31784900
317850     MOVE PV-AUDIT-CNTL-NBR   TO  DK-AUDIT-CNTL-NBR.              31785000
317851                                                                  31785100
317852     EXEC SQL                                                     31785200
317853         SELECT  AUD_TYP_CDE                                      31785300
317854              ,  AUD_STAT_CDE                                     31785400
317855              ,  PRC_FCLTY_AREA_ID                                31785500
317856           INTO  :SUNAUD-AUD-TYP-CDE                              31785600
317857             ,   :SUNAUD-AUD-STAT-CDE                             31785700
317858             ,   :SUNAUD-PRC-FCLTY-AREA-ID                        31785800
317859           FROM  TSUNAUD                                          31785900
317860          WHERE  AUD_CNTL_NBR      =  :DK-AUDIT-CNTL-NBR          31786000
317861     END-EXEC.                                                    31786100
317862                                                                  31786200
317863     EVALUATE TRUE                                                31786300
317864         WHEN SQLCODE = ZERO                                      31786400
317865             SET PS-AUDIT-NBR-EXISTS  TO TRUE                     31786500
317866             MOVE 'PS-AUDIT-NBR-EXISTS    '   TO PV-CICS-MSG-AREA 31786600
317867             PERFORM 9990-WRITE-CICS                              31786700
317868         WHEN SQLCODE = +100                                      31786800
317869             SET PS-AUDIT-NBR-NOT-EXISTS TO TRUE                  31786900
317870             MOVE 'PS-AUDIT-NBR-NOT-EXISTS'   TO PV-CICS-MSG-AREA 31787000
317871             PERFORM 9990-WRITE-CICS                              31787100
317872         WHEN SQLWARN0 NOT = SPACES                               31787200
317873         WHEN SQLCODE < ZERO                                      31787300
317874         WHEN SQLCODE > ZERO                                      31787400
317875             MOVE '8550-VALIDATE-AUDIT-NBR.'                      31787500
317876                 TO DP013-PARAGRAPH                               31787600
317877             MOVE 'SELECT OF TSUNAUD TABLE'                       31787700
317878                 TO DP013-MESSAGE-TEXT (1)                        31787800
317879             MOVE PV-AUDIT-CNTL-NBR-X                             31787900
317880                 TO DP013-MESSAGE-TEXT (2)                        31788000
317881             MOVE SQLCA            TO DP013-SQLCA                 31788100
317882             MOVE 'TSUNAUD'        TO DP013-DB2-TABLE-NAME (1)    31788200
317883             SET DP013-DB2-ABEND                                  31788300
317884                             TO TRUE                              31788400
317885             SET DP013-NO-ROLLBACK                                31788500
317886                             TO TRUE                              31788600
317887             PERFORM 9999-WRITE-CICS-LOG-MSG                      31788700
317888             SET PS-DUMP-TO-LOG       TO TRUE                     31788800
317889             SET SU021-RFID-DB2-ERROR TO TRUE                     31788900
317890     END-EVALUATE.                                                31789000
317891                                                                  31789100
317892 8700-UPDATE-SUT-PO-AUD-REQ.                                      31789200
317893                                                                  31789300
317894     STRING ' 8700-UPDATE-SUT-PO-AUD-REQ'                         31789400
317895         DELIMITED BY SIZE                                        31789500
317896         INTO PV-CICS-MSG-AREA.                                   31789600
317897     PERFORM 9990-WRITE-CICS.                                     31789700
317898     EXEC SQL                                                     31789800
317899          UPDATE SUT_PO_AUD_REQ                                   31789900
317900          SET    CART_PRMPT_CDE = :PC-D                           31790000
317901          WHERE  AUD_CNTL_NBR   = :DK-AUDIT-CNTL-NBR              31790100
317902            AND  PO_NBR         = :DK-PO-NBR                      31790200
317903            AND  PO_LNE_NBR     = :DK-PO-LINE-NBR                 31790300
317904            AND  PO_PREPK_ID    = :DK-PREPK-ID                    31790400
317905            AND  RCVR_SEQ_NBR   = :DK-RCVR-SEQ-NBR                31790500
317906            AND  OPER_UNT_ID    = :DK-OPER-UNT-ID                 31790600
317907     END-EXEC.                                                    31790700
317908                                                                  31790800
317909     EVALUATE TRUE                                                31790900
317910         WHEN SQLCODE = ZERO                                      31791000
317911             CONTINUE                                             31791100
317912         WHEN SQLWARN0 NOT = SPACES                               31791200
317913         WHEN SQLCODE NOT EQUAL ZERO                              31791300
317914             MOVE '8700-UPDATE-SUT-PO-AUD-REQ'                    31791400
317915                             TO DP013-PARAGRAPH                   31791500
317916             MOVE DK-PO-NBR           TO PV-DISPLAY-PO-NBR        31791600
317917             MOVE DK-PO-LINE-NBR      TO PV-DISPLAY-PO-LINE-NBR   31791700
317918             STRING 'PO NBR, LINE: '   DELIMITED BY SIZE          31791800
317919                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          31791900
317920                 '  '                  DELIMITED BY SIZE          31792000
317921                PV-DISPLAY-PO-LINE-NBR DELIMITED BY SIZE          31792100
317922                           INTO DP013-MESSAGE-TEXT(1)             31792200
317923             MOVE DK-RCVR-SEQ-NBR                                 31792300
317924                             TO PV-DISPLAY-RCVR-SEQ-NBR           31792400
317925             STRING 'RECV SEQ: '       DELIMITED BY SIZE          31792500
317926                 PV-DISPLAY-RCVR-SEQ-NBR                          31792600
317927                                       DELIMITED BY SIZE          31792700
317928                           INTO DP013-MESSAGE-TEXT(2)             31792800
317929             MOVE DK-OPER-UNT-ID TO PV-DISPLAY-OPER-UNT-ID        31792900
317930             STRING 'OPER UNIT: '      DELIMITED BY SIZE          31793000
317931                PV-DISPLAY-OPER-UNT-ID DELIMITED BY SIZE          31793100
317932                           INTO DP013-MESSAGE-TEXT(3)             31793200
317933             MOVE DK-INBND-TRIP-ID TO                             31793300
317934                                PV-DISPLAY-INBND-TRIP-ID          31793400
317935             STRING 'TRIP ID: '        DELIMITED BY SIZE          31793500
317936                 PV-DISPLAY-INBND-TRIP-ID                         31793600
317937                                       DELIMITED BY SIZE          31793700
317938                           INTO DP013-MESSAGE-TEXT(4)             31793800
317939             MOVE SQLCA      TO DP013-SQLCA                       31793900
317940             MOVE 'SUT00015' TO DP013-DB2-TABLE-NAME(1)           31794000
317941             SET DP013-DB2-ABEND                                  31794100
317942                             TO TRUE                              31794200
317943             SET DP013-NO-ROLLBACK                                31794300
317944                             TO TRUE                              31794400
317945             PERFORM 9999-WRITE-CICS-LOG-MSG                      31794500
317946             SET PS-DUMP-TO-LOG       TO TRUE                     31794600
317947             SET SU021-RFID-DB2-ERROR TO TRUE                     31794700
317948     END-EVALUATE.                                                31794800
317949                                                                  31794900
317950 8800-COUNT-CHECKED-IN-CRTNS.                                     31795000
317951                                                                  31795100
317952     STRING ' 8800-COUNT-CHECKED-IN-CRTNS'                        31795200
317953         DELIMITED BY SIZE                                        31795300
317954         INTO PV-CICS-MSG-AREA.                                   31795400
317955     PERFORM 9990-WRITE-CICS.                                     31795500
317956                                                                  31795600
317957     EXEC SQL                                                     31795700
317958          SELECT   COUNT (DISTINCT C.SHIPT_UNT_ID)                31795800
317959            INTO  :PV-CHECK-IN-COUNT                              31795900
317960            FROM  TPKSLIP A                                       31796000
317961               ,  TINPKSU B                                       31796100
317962               ,  TSHUUPC C                                       31796200
317963               ,  TSHUNLO D                                       31796300
317964           WHERE  A.PO_NBR         = :DK-PO-NBR                   31796400
317965             AND  A.REC_SEQ_NBR    = :DK-RCVR-SEQ-NBR             31796500
317966             AND  A.VER_STAT_CDE   = 'A'                          31796600
317967             AND  A.PKSL_STAT_CDE  = 'AC'                         31796700
317968             AND  B.PO_NBR         = A.PO_NBR                     31796800
317969             AND  B.SEQ_NBR        = A.SEQ_NBR                    31796900
317970             AND  C.SHIPT_UNT_ID   = B.SHIPT_UNT_ID               31797000
317971             AND  C.TRN_NBR        = B.PO_NBR                     31797100
317972             AND  C.TRN_LNE_NBR    = :DK-SHUUPC-LNE-NBR           31797200
317973             AND  C.SHIPT_UNT_ID   = D.SHIPT_UNT_ID               31797300
317974             AND  D.ACTV_CDE       = 'A'                          31797400
317975             AND  D.SCN_LOC_ID     = 'RECV'                       31797500
317976     END-EXEC.                                                    31797600
317977                                                                  31797700
317978     EVALUATE TRUE                                                31797800
317979         WHEN SQLCODE = ZERO                                      31797900
317980             CONTINUE                                             31798000
317981         WHEN SQLWARN0 NOT = SPACES                               31798100
317982         WHEN SQLCODE NOT EQUAL ZERO                              31798200
317983             MOVE '8800-COUNT-CHECKED-IN-CRTNS'                   31798300
317984                             TO DP013-PARAGRAPH                   31798400
317985             MOVE DK-PO-NBR           TO PV-DISPLAY-PO-NBR        31798500
317986             MOVE DK-RCVR-SEQ-NBR                                 31798600
317987                             TO PV-DISPLAY-RCVR-SEQ-NBR           31798700
317988             STRING 'PO NBR, RECV: '   DELIMITED BY SIZE          31798800
317989                 PV-DISPLAY-PO-NBR     DELIMITED BY SIZE          31798900
317990                 '  '                  DELIMITED BY SIZE          31799000
317991                PV-DISPLAY-RCVR-SEQ-NBR                           31799100
317992                                       DELIMITED BY SIZE          31799200
317993                           INTO DP013-MESSAGE-TEXT(1)             31799300
317994             MOVE SQLCA      TO DP013-SQLCA                       31799400
317995             MOVE 'TPKSLIP ' TO DP013-DB2-TABLE-NAME(1)           31799500
317996             MOVE 'TINPKSU ' TO DP013-DB2-TABLE-NAME(1)           31799600
317997             MOVE 'TSHUUPC ' TO DP013-DB2-TABLE-NAME(1)           31799700
317998             MOVE 'TSHUNLO ' TO DP013-DB2-TABLE-NAME(1)           31799800
317999             SET DP013-DB2-ABEND                                  31799900
318000                             TO TRUE                              31800000
318001             SET DP013-NO-ROLLBACK                                31800100
318002                             TO TRUE                              31800200
318003             PERFORM 9999-WRITE-CICS-LOG-MSG                      31800300
318004             SET PS-DUMP-TO-LOG       TO TRUE                     31800400
318005             SET SU021-RFID-DB2-ERROR TO TRUE                     31800500
318006     END-EVALUATE.                                                31800600
318007                                                                  31800700
318008 8850-SELECT-TKRPRPM.                                             31800800
318009                                                                  31800900
318010     STRING ' 8850-SELECT-TKRPRPM'                                31801000
318011         DELIMITED BY SIZE                                        31801100
318012         INTO PV-CICS-MSG-AREA.                                   31801200
318013     PERFORM 9990-WRITE-CICS.                                     31801300
318014                                                                  31801400
318015     EXEC SQL                                                     31801500
318016          SELECT FUNC_TXT                                         31801600
318017            INTO :KRPRPM-FUNC-TXT                                 31801700
318018            FROM TKRPRPM                                          31801800
318019           WHERE LOC_ID            = :DK-OPER-UNT-ID              31801900
318020             AND INTFC_SYS_CDE    = 'AUD'                         31802000
318021             AND SYS_PRC_FUNC_CDE = 'DMPAUD'                      31802100
318022             AND FUNC_PRC_STAT_CDE = 'AC'                         31802200
318023     END-EXEC.                                                    31802300
318024                                                                  31802400
318025     EVALUATE TRUE                                                31802500
318026         WHEN SQLCODE = ZERO                                      31802600
318027             IF KRPRPM-FUNC-TXT = 'Y'                             31802700
318028                 SET PS-SHOW-DEBUG-INFO                           31802800
318029                                      TO TRUE                     31802900
318030             ELSE                                                 31803000
318031                 SET PS-DONT-SHOW-DEBUG-INFO                      31803100
318032                                      TO TRUE                     31803200
318033             END-IF                                               31803300
318034         WHEN SQLWARN0 NOT = SPACES                               31803400
318035         WHEN SQLCODE NOT EQUAL ZERO                              31803500
318036             MOVE '8850-SELECT-TKRPRPM'                           31803600
318037                             TO DP013-PARAGRAPH                   31803700
318038             MOVE DK-OPER-UNT-ID TO PV-DISPLAY-OPER-UNT-ID        31803800
318039             STRING 'OPER UNIT: '      DELIMITED BY SIZE          31803900
318040                PV-DISPLAY-OPER-UNT-ID DELIMITED BY SIZE          31804000
318041                           INTO DP013-MESSAGE-TEXT(1)             31804100
318042             MOVE SQLCA      TO DP013-SQLCA                       31804200
318043             MOVE 'TKRPRPM ' TO DP013-DB2-TABLE-NAME(1)           31804300
318044             SET DP013-DB2-ABEND                                  31804400
318045                             TO TRUE                              31804500
318046             SET DP013-NO-ROLLBACK                                31804600
318047                             TO TRUE                              31804700
318048             PERFORM 9999-WRITE-CICS-LOG-MSG                      31804800
318049             SET PS-DUMP-TO-LOG       TO TRUE                     31804900
318050             SET SU021-RFID-DB2-ERROR TO TRUE                     31805000
318051     END-EVALUATE.                                                31805100
318052                                                                  31805200
318053 8900-SUM-PP-PROMPTED-UNITS.                                      31805300
318054                                                                  31805400
318055     STRING ' 8900-SUM-PP-PROMPTED-UNITS'                         31805500
318056         DELIMITED BY SIZE                                        31805600
318057         INTO PV-CICS-MSG-AREA.                                   31805700
318058     PERFORM 9990-WRITE-CICS.                                     31805800
318059     EXEC SQL                                                     31805900
318060         SELECT SUM(B.SHPD_QTY)                                   31806000
318061           INTO :PV-SHPD-QTY-SUM :DN-SUM-NULL                     31806100
318062           FROM TSUATRN A                                         31806200
318063             ,  TSHUUPC B                                         31806300
318064         WHERE A.AUD_CNTL_NBR    = :DK-AUDIT-CNTL-NBR             31806400
318065           AND A.SHIPT_UNT_ID    = B.SHIPT_UNT_ID                 31806500
318066           AND B.TRN_NBR         = :DK-PO-NBR                     31806600
318067           AND B.TRN_LNE_NBR     = :DK-PO-DRIVER-LINE             31806700
318068     END-EXEC.                                                    31806800
318069                                                                  31806900
318070     EVALUATE TRUE                                                31807000
318071         WHEN SQLCODE = ZERO                                      31807100
318072             IF DN-SUM-NULL = -1                                  31807200
318073                 MOVE 0     TO PV-SHPD-QTY-SUM                    31807300
318074             END-IF                                               31807400
318075         WHEN SQLWARN0 NOT = SPACES                               31807500
318076         WHEN SQLCODE NOT EQUAL ZERO                              31807600
318077             MOVE '8900-SUM-PP-PROMPTED-UNITS'                    31807700
318080                             TO DP013-PARAGRAPH                   31808000
318100             MOVE 'SUM THE PROMPTED CARTONS'                      31810000
318200                             TO DP013-MESSAGE-TEXT(1)             31820000
318300             STRING 'AUDIT CONTROL NUMBER: ' DELIMITED BY SIZE    31830000
318400                    PV-AUDIT-CNTL-NBR-X      DELIMITED BY SIZE    31840000
318500                                       INTO DP013-MESSAGE-TEXT (2)31850000
318600             MOVE SUATRN-SHIPT-UNT-ID   TO PV-DISPLAY-SHIPT-UNT-ID31860000
318700             STRING 'SHIP UNIT ID: '         DELIMITED BY SIZE    31870000
318800                    PV-DISPLAY-SHIPT-UNT-ID  DELIMITED BY SIZE    31880000
318900                                       INTO DP013-MESSAGE-TEXT (3)31890000
319000             MOVE SQLCA      TO DP013-SQLCA                       31900000
319100             MOVE 'TSUATRN'  TO DP013-DB2-TABLE-NAME(1)           31910000
319200             MOVE 'TSHUUPC'  TO DP013-DB2-TABLE-NAME(1)           31920000
319300             SET DP013-DB2-ABEND                                  31930000
319400                             TO TRUE                              31940000
319500             SET DP013-NO-ROLLBACK                                31950000
319600                             TO TRUE                              31960000
319700             PERFORM 9999-WRITE-CICS-LOG-MSG                      31970000
319800             SET PS-DUMP-TO-LOG       TO TRUE                     31980000
319900             SET SU021-RFID-DB2-ERROR TO TRUE                     31990000
320000     END-EVALUATE.                                                32000000
320100                                                                  32010000
320200 8950-SELECT-CURRENT-PP-CARTON.                                   32020000
320300                                                                  32030000
320400     STRING ' 8950-SELECT-CURRENT-PP-CARTON'                      32040000
320500         DELIMITED BY SIZE                                        32050000
320600         INTO PV-CICS-MSG-AREA.                                   32060000
320700     PERFORM 9990-WRITE-CICS.                                     32070000
320800     EXEC SQL                                                     32080000
320900         SELECT SUM(SHPD_QTY)                                     32090000
321000           INTO :SHUUPC-SHPD-QTY :DN-SUM-NULL-UPC                 32100000
321100           FROM TSHUUPC                                           32110000
321200         WHERE SHIPT_UNT_ID      = :DK-SHIPT-UNT-ID               32120000
321300           AND TRN_NBR           = :DK-PO-NBR                     32130000
321400           AND TRN_LNE_NBR       = :DK-PO-DRIVER-LINE             32140000
321500     END-EXEC.                                                    32150000
321600                                                                  32160000
321700     EVALUATE TRUE                                                32170000
321800         WHEN SQLCODE = ZERO                                      32180000
321900             IF DN-SUM-NULL-UPC = -1                              32190000
322000                 MOVE 0     TO SHUUPC-SHPD-QTY                    32200000
322100             END-IF                                               32210000
322200         WHEN SQLWARN0 NOT = SPACES                               32220000
322300         WHEN SQLCODE NOT EQUAL ZERO                              32230000
322400             MOVE '8950-SELECT-CURRENT-PP-CARTON'                 32240000
322500                             TO DP013-PARAGRAPH                   32250000
322600             MOVE 'SELECT THE UNIT QTY - THIS CARTON'             32260000
322700                             TO DP013-MESSAGE-TEXT(1)             32270000
322800             MOVE DK-SHIPT-UNT-ID TO PV-DISPLAY-SHIPT-UNT-ID      32280000
322900             STRING 'SHIPT UNT ID: '   DELIMITED BY SIZE          32290000
323000               PV-DISPLAY-SHIPT-UNT-ID DELIMITED BY SIZE          32300000
323100                           INTO DP013-MESSAGE-TEXT(2)             32310000
323200             MOVE SQLCA      TO DP013-SQLCA                       32320000
323300             MOVE 'TSHUUPC'  TO DP013-DB2-TABLE-NAME(1)           32330000
323400             SET DP013-DB2-ABEND                                  32340000
323500                             TO TRUE                              32350000
323600             SET DP013-NO-ROLLBACK                                32360000
323700                             TO TRUE                              32370000
323800             PERFORM 9999-WRITE-CICS-LOG-MSG                      32380000
323900             SET PS-DUMP-TO-LOG       TO TRUE                     32390000
324000             SET SU021-RFID-DB2-ERROR TO TRUE                     32400000
324100     END-EVALUATE.                                                32410000
324200                                                                  32420000
324300                                                                  32430000
324400 9000-SELECT-CARTON.                                              32440000
324500                                                                  32450000
324600     STRING ' 9000-SELECT-CARTON'                                 32460000
324700         DELIMITED BY SIZE                                        32470000
324800         INTO PV-CICS-MSG-AREA.                                   32480000
324900     PERFORM 9990-WRITE-CICS.                                     32490000
325000                                                                  32500000
325100     EXEC SQL                                                     32510000
325200         SELECT A.AUD_CNTL_NBR                                    32520000
325300           INTO :SUATRN-AUD-CNTL-NBR                              32530000
325400           FROM TSUATRN A                                         32540000
325500             ,  SUT_PO_AUD_REQ B                                  32550000
325600         WHERE  A.SHIPT_UNT_ID  = :DK-SHIPT-UNT-ID                32560000
325700           AND  A.AUD_CNTL_NBR  = B.AUD_CNTL_NBR                  32570000
325710           AND  B.PKGNG_TYP_CDE = 'RF'                            32571005
325800           WITH UR                                                32580000
325900     END-EXEC.                                                    32590000
326000                                                                  32600000
326100     EVALUATE TRUE                                                32610000
326200         WHEN SQLCODE = ZERO                                      32620000
326300             SET PS-CARTON-ALREADY-EXISTS TO TRUE                 32630000
326400         WHEN SQLCODE = -811                                      32640000
326500             PERFORM 9010-SELECT-CARTON-2                         32650000
326600         WHEN SQLCODE = +100                                      32660000
326700             SET PS-CARTON-DOESNT-EXIST   TO TRUE                 32670000
326800         WHEN SQLWARN0 NOT = SPACES                               32680000
326900         WHEN SQLCODE NOT EQUAL ZERO                              32690000
327000             MOVE '9000-SELECT-CARTON'                            32700000
327100                             TO DP013-PARAGRAPH                   32710000
327200             MOVE 'SELECT THE CARTON'                             32720000
327300                             TO DP013-MESSAGE-TEXT(1)             32730000
327400             MOVE DK-SHIPT-UNT-ID TO PV-DISPLAY-SHIPT-UNT-ID      32740000
327500             STRING 'SHIPT UNT ID: '   DELIMITED BY SIZE          32750000
327600               PV-DISPLAY-SHIPT-UNT-ID DELIMITED BY SIZE          32760000
327700                           INTO DP013-MESSAGE-TEXT(2)             32770000
327800             MOVE SQLCA      TO DP013-SQLCA                       32780000
327900             MOVE 'TSUATRN'  TO DP013-DB2-TABLE-NAME(1)           32790000
328000             SET DP013-DB2-ABEND                                  32800000
328100                             TO TRUE                              32810000
328200             SET DP013-NO-ROLLBACK                                32820000
328300                             TO TRUE                              32830000
328400             PERFORM 9999-WRITE-CICS-LOG-MSG                      32840000
328500             SET PS-DUMP-TO-LOG       TO TRUE                     32850000
328600             SET SU021-RFID-DB2-ERROR TO TRUE                     32860000
328700     END-EVALUATE.                                                32870000
328800                                                                  32880000
328900 9010-SELECT-CARTON-2.                                            32890000
329000                                                                  32900000
329100     STRING ' 9010-SELECT-CARTON-2'                               32910000
329200         DELIMITED BY SIZE                                        32920000
329300         INTO PV-CICS-MSG-AREA.                                   32930000
329400     PERFORM 9990-WRITE-CICS.                                     32940000
329500                                                                  32950000
329600     EXEC SQL                                                     32960000
329700         SELECT A.AUD_CNTL_NBR                                    32970000
329800           INTO :SUATRN-AUD-CNTL-NBR                              32980000
329900           FROM TSUATRN A                                         32990000
330000             ,  SUT_PO_AUD_REQ B                                  33000000
330100         WHERE  A.SHIPT_UNT_ID  = :DK-SHIPT-UNT-ID                33010000
330200           AND  A.AUD_CNTL_NBR  = B.AUD_CNTL_NBR                  33020000
330300           AND  A.REC_SEQ_NBR   = :DK-RCVR-SEQ-NBR                33030000
330400           AND  B.OPER_UNT_ID   = :DK-OPER-UNT-ID                 33040000
330410           AND  B.PKGNG_TYP_CDE = 'RF'                            33041005
330500           WITH UR                                                33050000
330600     END-EXEC.                                                    33060000
330700                                                                  33070000
330800     EVALUATE TRUE                                                33080000
330900         WHEN SQLCODE = ZERO                                      33090000
331000         WHEN SQLCODE = -811                                      33100000
331100             SET PS-CARTON-ALREADY-EXISTS TO TRUE                 33110000
331200         WHEN SQLCODE = +100                                      33120000
331300             SET PS-CARTON-DOESNT-EXIST   TO TRUE                 33130000
331400         WHEN SQLWARN0 NOT = SPACES                               33140000
331500         WHEN SQLCODE NOT EQUAL ZERO                              33150000
331600             MOVE '9010-SELECT-CARTON-2'                          33160000
331700                             TO DP013-PARAGRAPH                   33170000
331800             MOVE 'SELECT THE CARTON'                             33180000
331900                             TO DP013-MESSAGE-TEXT(1)             33190000
332000             MOVE DK-SHIPT-UNT-ID TO PV-DISPLAY-SHIPT-UNT-ID      33200000
332100             STRING 'SHIPT UNT ID: '   DELIMITED BY SIZE          33210000
332200               PV-DISPLAY-SHIPT-UNT-ID DELIMITED BY SIZE          33220000
332300                           INTO DP013-MESSAGE-TEXT(2)             33230000
332400             MOVE SQLCA      TO DP013-SQLCA                       33240000
332500             MOVE 'TSUATRN'  TO DP013-DB2-TABLE-NAME(1)           33250000
332600             SET DP013-DB2-ABEND                                  33260000
332700                             TO TRUE                              33270000
332800             SET DP013-NO-ROLLBACK                                33280000
332900                             TO TRUE                              33290000
333000             PERFORM 9999-WRITE-CICS-LOG-MSG                      33300000
333100             SET PS-DUMP-TO-LOG       TO TRUE                     33310000
333200             SET SU021-RFID-DB2-ERROR TO TRUE                     33320000
333300     END-EVALUATE.                                                33330000
333400                                                                  33340000
333500 9990-WRITE-CICS.                                                 33350000
333600                                                                  33360000
333700* IF YOU'RE AT THE LAST OCCURRENCE OF THE TABLE,                  33370000
333800* THE NEXT MESSAGE WILL GO INTO THE FIRST OCCURRENCE.  KEEP       33380000
333900* INCREMENTING THE SEQUENCE SO THAT IF THE TABLE IS DUMPED TO THE 33390000
334000* LOG YOU WILL BE ABLE TO SEE THE LAST 200 LINES AND HOW THEY     33400000
334100* WRAPPED AROUND.                                                 33410000
334200                                                                  33420000
334300     EVALUATE TRUE                                                33430000
334400     WHEN PT-MSG-IDX < PC-MSG-TABLE-SIZE                          33440000
334500         MOVE PV-CICS-MSG-AREA        TO PT-MSG-LINE (PT-MSG-IDX) 33450000
334600         MOVE PT-MSG-SEQ (PT-MSG-IDX) TO PV-PREV-SEQUENCE         33460000
334700         SET PT-MSG-IDX UP BY 1                                   33470000
334800     WHEN PT-MSG-IDX = PC-MSG-TABLE-SIZE                          33480000
334900         MOVE PV-CICS-MSG-AREA        TO PT-MSG-LINE (PT-MSG-IDX) 33490000
335000         MOVE PT-MSG-SEQ (PT-MSG-IDX) TO PV-PREV-SEQUENCE         33500000
335100         SET PT-MSG-IDX               TO 1                        33510000
335200     END-EVALUATE                                                 33520000
335300                                                                  33530000
335400     COMPUTE PV-NEXT-SEQUENCE = PV-PREV-SEQUENCE + 1              33540000
335500     MOVE PV-NEXT-SEQUENCE            TO PT-MSG-SEQ (PT-MSG-IDX)  33550000
335600                                                                  33560000
335700                                                                  33570000
335800*  IF THE DC HAS TRACE PROCESSING TURNED ON, ALL MESSAGES WILL    33580000
335900*  BE DISPLAYED AS THEY OCCUR.  DUMPING THE MESSAGE TABLE WILL    33590000
336000*  BE UNNECESSARY BECAUSE OF THE REAL-TIME DISPLAYS.              33600000
336100*                                                                 33610000
336200     IF PS-SHOW-DEBUG-INFO                                        33620000
336300         PERFORM 9991-WRITEQ                                      33630000
336400     END-IF                                                       33640000
336500     MOVE SPACES                      TO PV-CICS-MSG-AREA.        33650000
336600                                                                  33660000
336700                                                                  33670000
336800 9991-WRITEQ.                                                     33680000
336900     EXEC CICS                                                    33690000
337000         WRITEQ TD                                                33700000
337100         QUEUE(PC-LOG-QUEUE)                                      33710000
337200         FROM(PV-CICS-MSG-AREA)                                   33720000
337300         RESP(PV-CICS-RESPONSE)                                   33730000
337400     END-EXEC.                                                    33740000
337500                                                                  33750000
337600*-----------------------------------------------------------------33760000
337700*  RETURN TO CALLING PROGRAM                                      33770000
337800*-----------------------------------------------------------------33780000
337900 9998-RETURN.                                                     33790000
338000                                                                  33800000
338100     STRING ' 9998-RETURN'                                        33810000
338200         DELIMITED BY SIZE                                        33820000
338300         INTO PV-CICS-MSG-AREA.                                   33830000
338400     PERFORM 9990-WRITE-CICS.                                     33840000
338500     MOVE SU021-CARTON-AUDIT-RECORD     TO DFHCOMMAREA.           33850000
338600                                                                  33860000
338700     EXEC CICS                                                    33870000
338800          RETURN                                                  33880000
338900     END-EXEC.                                                    33890000
339000                                                                  33900000
339100                                                                  33910000
339200 9999-WRITE-TO-CSSL.                                              33920000
339300     STRING ' 9999-WRITE-TO-CSSL'                                 33930000
339400         DELIMITED BY SIZE                                        33940000
339500         INTO PV-CICS-MSG-AREA.                                   33950000
339600     PERFORM 9990-WRITE-CICS.                                     33960000
339700     MOVE LENGTH OF PV-CICS-MSG-AREA2                             33970000
339800       TO PV-COMMAREA-LENGTH                                      33980000
339900     EXEC CICS                                                    33990000
340000          WRITEQ TD                                               34000000
340100           QUEUE   ('CSSL')                                       34010000
340200            FROM   (PV-CICS-MSG-AREA2)                            34020000
340300          LENGTH   (PV-COMMAREA-LENGTH)                           34030000
340400            RESP   (PV-CICS-RESP)                                 34040000
340500     END-EXEC.                                                    34050000
340600                                                                  34060000
340700*                                                                 34070000
340800 9999-WRITE-CICS-LOG-MSG.                                         34080000
340900     STRING ' 9999-WRITE-CICS-LOG-MSG'                            34090000
341000         DELIMITED BY SIZE                                        34100000
341100         INTO PV-CICS-MSG-AREA.                                   34110000
341200     PERFORM 9990-WRITE-CICS.                                     34120000
341300     MOVE 'SUKCS720'                 TO DP013-PROGRAM.            34130000
341400     MOVE DFHEIBLK                   TO DP013-DFHEIBLK.           34140000
341500     INITIALIZE DP013-SRC-TASK-NUMBER                             34150000
341600                DP013-STACK.                                      34160000
341700     SET DP013-LINK-RETURN           TO TRUE.                     34170000
341800                                                                  34180000
341900     EXEC CICS                                                    34190000
342000         LINK                                                     34200000
342100             PROGRAM   (DP013-NAME)                               34210000
342200             COMMAREA  (DP013-PARAMETERS)                         34220000
342300             LENGTH    (DP013-LENGTH)                             34230000
342400     END-EXEC.                                                    34240000
342500                                                                  34250000
342600                                                                  34260000
342700 9999-FINAL-DUMP.                                                 34270000
342800*  IF AN ERROR HAS OCCURRED, DUMP THE MESSAGE TABLE WHICH WILL    34280000
342900*  CONTAIN THE LAST 200 TRACE DISPLAYS.  IF THE TABLE EVER        34290000
343000*  OVERFLOW, YOU WILL SEE THE SEQUENCE NUMBERS WRAP.  UNUSED      34300000
343100*  OCCRENCES ARE NOT DISPLAYED.                                   34310000
343200*                                                                 34320000
343300                                                                  34330000
343400     STRING ' 9999-FINAL-DUMP'                                    34340000
343500         DELIMITED BY SIZE                                        34350000
343600         INTO PV-CICS-MSG-AREA                                    34360000
343700     PERFORM 9990-WRITE-CICS.                                     34370000
343800                                                                  34380000
343900     EXEC CICS ENQ                                                34390000
344000         RESOURCE(PC-LOG-QUEUE)                                   34400000
344100     END-EXEC                                                     34410000
344200                                                                  34420000
344300     MOVE PV-EIBTASKN             TO PV-DISPLAY-TASK.             34430000
344400     PERFORM VARYING PT-MSG-IDX FROM 1 BY 1 UNTIL                 34440000
344500                     PT-MSG-IDX > PC-MSG-TABLE-SIZE               34450000
344600         IF PT-MSG-SEQ (PT-MSG-IDX) > ZERO                        34460000
344700             MOVE PT-MSG-SEQ (PT-MSG-IDX)                         34470000
344800                                  TO PV-DISPLAY-MSG-NBR           34480000
344900             STRING ' ' PV-DISPLAY-TASK ' '                       34490000
345000                  PV-DISPLAY-MSG-NBR ' '                          34500000
345100                  PT-MSG-LINE (PT-MSG-IDX)                        34510000
345200                  DELIMITED BY SIZE                               34520000
345300                                INTO PV-CICS-MSG-AREA             34530000
345400             PERFORM 9991-WRITEQ                                  34540000
345500         END-IF                                                   34550000
345600     END-PERFORM.                                                 34560000
345700                                                                  34570000
345800     SET PT-MSG-IDX               TO 1.                           34580000
345900     SET PS-DONT-DUMP-TO-LOG      TO TRUE.                        34590000
346000                                                                  34600000
346100     EXEC CICS DEQ                                                34610000
346200         RESOURCE(PC-LOG-QUEUE)                                   34620000
346300     END-EXEC.                                                    34630000
346400                                                                  34640000
