       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.         INKRP183.                                            
       INSTALLATION.       KOHLS DEPARTMENT STORES.                             
       DATE-WRITTEN.       11/29/2000.                                          
       DATE-COMPILED.                                                           
                                                                                
      ******************************************************************        
      *PURPOSE:                                                                 
      *                                                                         
      *    THIS PROGRAM WILL CREATE PHYSICAL INVENTORY DETAIL                   
      * REPORT FROM THE SORTED INPUT BOOKING SUMMARY FILE.                      
      *                                                                         
      ******************** HISTORY OF CHANGES **************************00111027
      * WR/PROJ  DATE        DESCRIPTION OF CHANGES                     00113027
      * -------  ----------  ----------------------------------------   00114027
      * 21591    03-01-2002  MANIFEST PROJECT CHANGE FOR IN-TRANSIT     00119027
      *                      REVERSAL FROM INVENTORY LEDGER             00119127
013102* WR22960  01/31/02    RONNA BUTZ (LOOK FOR 013102 TO IDENTIFY            
013102*                      CHANGES) BREAK REPORT BY STORE SO THAT LP          
013102*                      IS ABLE TO GO DIRECTLY TO A STORE SECTION          
W21732* WR21732  12/10/02    ASHOK,IGSI.                                        
W21732*                      THE CODE LOGIC WHICH CREATES                       
W21732*                      SUMMARIZED INVENTORY AUDIT TRIAL REPORT            
W21732*                      WAS DELETED AND WAS CODED IN A NEW PROGRAM         
W21732*                      INKRP283.                                          
W26600* W26600   08-01-2004  ROD JANSSEN INVENTORY STORE EXPANSION              
W26006* W26006   02-24-2005  REMOVE REFERENCES TO OBSOLETE STORE TABLE.         
W26006*                      - ERIN SEARL                                       
W27808* W27808   08-08-2005  MODIFIED FOR UPDATED COPYBOOK INWS016 AND          
W27808*                      STORE-EXPECTED CHANGES                             
30272 * W30272   03-31-2006  STORE NUMBER ISSUE WITH STORE TABLE LOAD           
30272 *                      - ROD JANSSEN                                      
P40463*PRB40463 22-03-2013  INCLUDED 'WITH UR' IN THE QUERIES                   
P40463******************************************************************        
                                                                                
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
                                                                                
           SELECT BOOK-INPUT-SUMMARY-FILE                                       
               ASSIGN TO INP01.                                                 
                                                                                
           SELECT ADJ-PHYINV-DETAIL-REPORT                                      
               ASSIGN TO RPT01.                                                 
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       FD  BOOK-INPUT-SUMMARY-FILE                                              
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
W21732     RECORD CONTAINS 80 CHARACTERS                                        
           DATA RECORD IS BOOK-INPUT-SUMMARY-RECORD.                            
                                                                                
W21732 01  BOOK-INPUT-SUMMARY-RECORD       PIC X(80).                           
                                                                                
       FD  ADJ-PHYINV-DETAIL-REPORT                                             
W26600     RECORDING MODE IS F                                                  
           LABEL RECORDS ARE OMITTED                                            
           RECORD CONTAINS 132 CHARACTERS                                       
           DATA RECORD IS ADJ-PHYINV-DETAIL-RECORD.                             
                                                                                
       01  ADJ-PHYINV-DETAIL-RECORD      PIC X(132).                            
                                                                                
      /*****************************************************************        
       WORKING-STORAGE SECTION.                                                 
      ******************************************************************        
                                                                                
       01  ABEND-CODE                  PIC S9(04)  VALUE ZERO COMP SYNC.        
                                                                                
       01  PC-PRINT-CONTROL.                                                    
           05  PC-PAGE-COUNT             PIC S9(05) VALUE ZERO.                 
           05  PC-LINE-COUNT             PIC S9(03) VALUE ZERO COMP-3.          
           05  PC-LINE-SPACE             PIC S9(05) VALUE ZERO.                 
           05  PC-PAGE-COUNT2            PIC S9(05) VALUE ZERO.                 
           05  PC-LINE-COUNT2            PIC S9(03) VALUE ZERO COMP-3.          
                                                                                
       01  PV-PROGRAM-VARIABLES.                                                
           05  PV-PARA                   PIC X(30)  VALUE SPACES.               
           05  PV-DB2-OPER-ATTEMPTED     PIC X(30)  VALUE SPACES.               
W21732     05  PV-TAB-MAX                PIC 9(04)  VALUE 9999.                 
W26600     05  MAX-STORES                PIC 9(05)  VALUE 10000.                
W26600     05  PV-STR-NDX                PIC S9(04) COMP VALUE ZEROS.           
W21732     05  PV-DEPT-SUB               PIC 9(05)  VALUE ZEROES.               
           05  PV-COMPUTED-FIELDS.                                              
               10  PV-ADJUSTMENT-QTY     PIC S9(15) COMP-3 VALUE ZEROS.         
               10  PV-OLD-ONHAND-QTY     PIC S9(15) COMP-3 VALUE ZEROS.         
               10  PV-QTY                PIC S9(15) COMP-3 VALUE ZEROS.         
               10  PV-AFTER-RCPT         PIC S9(15) COMP-3 VALUE ZEROS.         
21591          10  PV-CUTOFF-INTRANS     PIC S9(15) COMP-3 VALUE ZEROS.         
               10  PV-STR-EXPTED         PIC S9(15) COMP-3 VALUE ZEROS.         
               10  PV-STR-EXPECTED-CUTOFF                                       
                                         PIC S9(15) COMP-3 VALUE ZEROS.         
               10  PV-CUTOFF-STR-EXPTED  PIC S9(15) COMP-3 VALUE ZEROS.         
               10  PV-TOT-ADJUSTMENT-QTY PIC S9(15) COMP-3 VALUE ZEROS.         
               10  PV-TOT-OLD-ONHAND-QTY PIC S9(15) COMP-3 VALUE ZEROS.         
               10  PV-TOT-QTY            PIC S9(15) COMP-3 VALUE ZEROS.         
               10  PV-TOT-AFTER-RCPT     PIC S9(15) COMP-3 VALUE ZEROS.         
21591          10  PV-TOT-CUTOFF-INTRANS PIC S9(15) COMP-3 VALUE ZEROS.         
               10  PV-WRK-ADJUSTMENT-QTY PIC S9(15) COMP-3 VALUE ZEROS.         
               10  PV-DTL-ADJUSTMENT-QTY PIC S9(15) COMP-3 VALUE ZEROS.         
               10  PV-DTL-OLD-ONHAND-QTY PIC S9(15) COMP-3 VALUE ZEROS.         
               10  PV-DTL-QTY            PIC S9(15) COMP-3 VALUE ZEROS.         
               10  PV-DTL-AFTER-RCPT     PIC S9(15) COMP-3 VALUE ZEROS.         
21591          10  PV-DTL-CUTOFF-INTRANS PIC S9(15) COMP-3 VALUE ZEROS.         
               10  PV-DTL-STR-EXPECTED   PIC S9(15) COMP-3 VALUE ZEROS.         
               10  PV-DTL-CUTOFF-STR-EXPTED                                     
                                         PIC S9(15) COMP-3 VALUE ZEROS.         
               10  PV-TB-STR-EXPTED      PIC S9(15) COMP-3 VALUE ZEROS.         
               10  PV-TB-STR-CUTOFF-STR-EXPTED                                  
                                         PIC S9(15) COMP-3 VALUE ZEROS.         
W21732     05  PV-DEPT-NMBR              PIC X(04).                             
           05  PV-DEPT-NMBR-NUM REDEFINES                                       
W21732         PV-DEPT-NMBR              PIC 9(04).                             
W26600     05  PV-STORE-NMBR             PIC 9(05).                             
           05  PV-STORE-NMBR-ALPH REDEFINES                                     
W26600         PV-STORE-NMBR             PIC X(05).                             
W26600     05  PV-STORE-NMBR-SAVE        PIC X(04).                             
                                                                                
       01  SWITCHES.                                                            
           05  WS-PHYINV-DONE-SW         PIC X(01) VALUE 'N'.                   
               88  PHYINV-PROCESSING-COMPLETE      VALUE 'Y'.                   
           05  WS-FIRST-TIME-SW          PIC X(01) VALUE 'N'.                   
               88  FIRST-TIME-THRU                 VALUE 'N'.                   
               88  CONTINUED-PROCESSING            VALUE 'Y'.                   
                                                                                
       01  TB-DEPT-TABLE.                                                       
W21732     05 TB-DEPT-TAB                OCCURS 10000 TIMES.                    
              10  TB-ADJUSTMENT-QTY      PIC S9(15) COMP-3 VALUE ZEROS.         
              10  TB-QTY                 PIC S9(15) COMP-3 VALUE ZEROS.         
              10  TB-OLD-ONHAND-QTY      PIC S9(15) COMP-3 VALUE ZEROS.         
              10  TB-AFTER-RCPT          PIC S9(15) COMP-3 VALUE ZEROS.         
              10  TB-CUTOFF-STR-EXPTED   PIC S9(15) COMP-3 VALUE ZEROS.         
                                                                                
       01  TB-STORE-ACCUM-TABLE.                                                
W26600     05  TB-STR-ELEMENTS           OCCURS 10000 TIMES.                    
               10  TB-STR-ADJUSTMENT-QTY PIC S9(15) COMP-3 VALUE ZEROS.         
               10  TB-STR-QTY            PIC S9(15) COMP-3 VALUE ZEROS.         
               10  TB-STR-OLD-ONHAND     PIC S9(15) COMP-3 VALUE ZEROS.         
               10  TB-STR-AFTER-RCPT     PIC S9(15) COMP-3 VALUE ZEROS.         
               10  TB-STR-CUTOFF-STR-EXPTED                                     
                                         PIC S9(15) COMP-3 VALUE ZEROS.         
                                                                                
       01  CPU-DATE.                                                            
           05  CPU-YEAR                  PIC X(02)  VALUE SPACES.               
           05  CPU-MONTH                 PIC X(02)  VALUE SPACES.               
           05  CPU-DAY                   PIC X(02)  VALUE SPACES.               
                                                                                
       01  CPU-TIME.                                                            
           05  CPU-HOUR                  PIC X(02)  VALUE SPACES.               
           05  CPU-MINUTE                PIC X(02)  VALUE SPACES.               
           05  FILLER                    PIC X(02)  VALUE SPACES.               
                                                                                
       01  H1-HEADING.                                                          
           05  FILLER              PIC X(40)   VALUE SPACES.                    
           05  FILLER              PIC X(97)   VALUE                            
              'SUMMARIZED INVENTORY ADJUSTMENT AUDIT REPORT - UNITS'.           
                                                                                
       01  H1A-HEADING.                                                         
           05  FILLER              PIC X(40)   VALUE SPACES.                    
           05  FILLER              PIC X(97)   VALUE                            
              'PHYSICAL INVENTORY ADJUSTMENT DETAIL AUDIT RPT UNITS'.           
                                                                                
       01  H1B-HEADING.                                                         
           05  FILLER              PIC X(56)   VALUE SPACES.                    
           05  FILLER              PIC X(06)   VALUE 'STORE '.                  
           05  FILLER              PIC X(01)   VALUE SPACES.                    
W26600     05  H1B-STORE           PIC X(04)   VALUE SPACES.                    
           05  FILLER              PIC X(03)   VALUE SPACES.                    
           05  H1B-STORE-NAME      PIC X(13)   VALUE SPACES.                    
                                                                                
       01  H2-HEADING.                                                          
21591      05  FILLER               PIC X(04)     VALUE 'DEPT'.                 
21591      05  FILLER               PIC X(14)     VALUE SPACES.                 
21591      05  FILLER               PIC X(06)     VALUE SPACES.                 
21591      05  FILLER               PIC X(06)     VALUE SPACES.                 
21591      05  FILLER               PIC X(08)     VALUE 'PHYSICAL'.             
21591      05  FILLER               PIC X(06)     VALUE SPACES.                 
21591      05  FILLER               PIC X(09)     VALUE SPACES.                 
21591      05  FILLER               PIC X(06)     VALUE 'CUTOFF'.               
21591      05  FILLER               PIC X(06)     VALUE SPACES.                 
21591      05  FILLER               PIC X(05)     VALUE SPACES.                 
21591      05  FILLER               PIC X(10)     VALUE 'POST AFTER'.           
21591      05  FILLER               PIC X(06)     VALUE SPACES.                 
21591      05  FILLER               PIC X(05)     VALUE SPACES.                 
27808      05  FILLER               PIC X(10)     VALUE 'STR EXPECT'.           
21591      05  FILLER               PIC X(06)     VALUE SPACES.                 
21591      05  FILLER               PIC X(02)     VALUE SPACES.                 
21591      05  FILLER               PIC X(13)     VALUE 'FASHION SALES'.        
21591      05  FILLER               PIC X(11)     VALUE SPACES.                 
                                                                                
       01  H2B-HEADING.                                                         
21591      05  FILLER               PIC X(05)     VALUE 'STORE'.                
21591      05  FILLER               PIC X(13)     VALUE SPACES.                 
21591      05  FILLER               PIC X(06)     VALUE SPACES.                 
21591      05  FILLER               PIC X(06)     VALUE SPACES.                 
21591      05  FILLER               PIC X(08)     VALUE 'PHYSICAL'.             
21591      05  FILLER               PIC X(06)     VALUE SPACES.                 
21591      05  FILLER               PIC X(09)     VALUE SPACES.                 
21591      05  FILLER               PIC X(06)     VALUE 'CUTOFF'.               
21591      05  FILLER               PIC X(06)     VALUE SPACES.                 
21591      05  FILLER               PIC X(05)     VALUE SPACES.                 
21591      05  FILLER               PIC X(10)     VALUE 'POST AFTER'.           
21591      05  FILLER               PIC X(06)     VALUE SPACES.                 
21591      05  FILLER               PIC X(05)     VALUE SPACES.                 
21591      05  FILLER               PIC X(10)     VALUE 'STR EXPECT'.           
21591      05  FILLER               PIC X(06)     VALUE SPACES.                 
21591      05  FILLER               PIC X(02)     VALUE SPACES.                 
21591      05  FILLER               PIC X(13)     VALUE 'FASHION SALES'.        
21591      05  FILLER               PIC X(10)     VALUE SPACES.                 
                                                                                
       01  H3-HEADING.                                                          
21591      05  FILLER               PIC X(04)     VALUE SPACES.                 
21591      05  FILLER               PIC X(14)     VALUE SPACES.                 
21591      05  FILLER               PIC X(06)     VALUE SPACES.                 
21591      05  FILLER               PIC X(06)     VALUE SPACES.                 
21591      05  FILLER               PIC X(08)     VALUE 'QUANTITY'.             
21591      05  FILLER               PIC X(06)     VALUE SPACES.                 
21591      05  FILLER               PIC X(09)     VALUE SPACES.                 
21591      05  FILLER               PIC X(06)     VALUE 'ONHAND'.               
21591      05  FILLER               PIC X(06)     VALUE SPACES.                 
21591      05  FILLER               PIC X(05)     VALUE SPACES.                 
21591      05  FILLER               PIC X(10)     VALUE 'FLUSH RCPT'.           
21591      05  FILLER               PIC X(06)     VALUE SPACES.                 
21591      05  FILLER               PIC X(06)     VALUE SPACES.                 
21591      05  FILLER               PIC X(09)     VALUE 'QUANTITY'.             
21591      05  FILLER               PIC X(06)     VALUE SPACES.                 
21591      05  FILLER               PIC X(04)     VALUE SPACES.                 
21591      05  FILLER               PIC X(11)     VALUE 'ADJUSTMENT'.           
21591      05  FILLER               PIC X(10)     VALUE SPACES.                 
                                                                                
       01  H4-HEADING.                                                          
21591      05  FILLER               PIC X(05)     VALUE 'STORE'.                
W21732     05  FILLER               PIC X(04)     VALUE SPACES.                 
W21732     05  FILLER               PIC X(03)     VALUE 'SKU'.                  
W21732     05  FILLER               PIC X(11)     VALUE SPACES.                 
21591      05  FILLER               PIC X(07)     VALUE SPACES.                 
21591      05  FILLER               PIC X(06)     VALUE SPACES.                 
21591      05  FILLER               PIC X(08)     VALUE 'PHYSICAL'.             
21591      05  FILLER               PIC X(06)     VALUE SPACES.                 
21591      05  FILLER               PIC X(09)     VALUE SPACES.                 
21591      05  FILLER               PIC X(06)     VALUE 'CUTOFF'.               
21591      05  FILLER               PIC X(06)     VALUE SPACES.                 
21591      05  FILLER               PIC X(05)     VALUE SPACES.                 
21591      05  FILLER               PIC X(10)     VALUE 'POST AFTER'.           
21591      05  FILLER               PIC X(06)     VALUE SPACES.                 
21591      05  FILLER               PIC X(05)     VALUE SPACES.                 
21591      05  FILLER               PIC X(10)     VALUE 'STR EXPECT'.           
21591      05  FILLER               PIC X(06)     VALUE SPACES.                 
21591      05  FILLER               PIC X(02)     VALUE SPACES.                 
21591      05  FILLER               PIC X(13)     VALUE 'FASHION SALES'.        
21591      05  FILLER               PIC X(04)     VALUE SPACES.                 
                                                                                
       01  H5-HEADING.                                                          
21591      05  FILLER               PIC X(05)     VALUE SPACES.                 
21591      05  FILLER               PIC X(02)     VALUE SPACES.                 
21591      05  FILLER               PIC X(04)     VALUE SPACES.                 
21591      05  FILLER               PIC X(02)     VALUE SPACES.                 
21591      05  FILLER               PIC X(05)     VALUE SPACES.                 
21591      05  FILLER               PIC X(02)     VALUE SPACES.                 
21591      05  FILLER               PIC X(03)     VALUE SPACES.                 
21591      05  FILLER               PIC X(07)     VALUE SPACES.                 
21591      05  FILLER               PIC X(06)     VALUE SPACES.                 
21591      05  FILLER               PIC X(08)     VALUE 'QUANTITY'.             
21591      05  FILLER               PIC X(06)     VALUE SPACES.                 
21591      05  FILLER               PIC X(09)     VALUE SPACES.                 
21591      05  FILLER               PIC X(06)     VALUE 'ONHAND'.               
21591      05  FILLER               PIC X(06)     VALUE SPACES.                 
21591      05  FILLER               PIC X(05)     VALUE SPACES.                 
21591      05  FILLER               PIC X(10)     VALUE 'FLUSH RCPT'.           
21591      05  FILLER               PIC X(06)     VALUE SPACES.                 
21591      05  FILLER               PIC X(05)     VALUE SPACES.                 
21591      05  FILLER               PIC X(10)     VALUE 'QUANTITY'.             
21591      05  FILLER               PIC X(06)     VALUE SPACES.                 
21591      05  FILLER               PIC X(02)     VALUE SPACES.                 
21591      05  FILLER               PIC X(13)     VALUE 'ADJUSTMENT'.           
21591      05  FILLER               PIC X(04)     VALUE SPACES.                 
                                                                                
       01  C1-COMMENT.                                                          
W26600     05  C1-STORE-NBR        PIC X(04)   VALUE SPACES.                    
           05  FILLER              PIC X(01)   VALUE SPACES.                    
           05  FILLER              PIC X(10)   VALUE                            
               'STR TTL **'.                                                    
                                                                                
       01  D2-DETAIL-LINE.                                                      
W26600     05  D2-STORE-NBR         PIC Z999.                                   
W26600     05  FILLER               PIC X(03)        VALUE SPACES.              
           05  D2-SKU.                                                          
W21732         10  D2-SKU-NMBR      PIC X(08).                                  
W21732         10  FILLER           PIC X(09).                                  
21591      05  D2-COMMENT REDEFINES D2-SKU  PIC X(17).                          
21591      05  FILLER               PIC X(06)        VALUE SPACES.              
           05  D2-QTY               PIC ZZ,ZZZ,ZZZ,ZZ9-.                        
           05  FILLER               PIC X(06)        VALUE SPACES.              
           05  D2-ONHAND-QTY        PIC ZZ,ZZZ,ZZZ,ZZ9-.                        
           05  FILLER               PIC X(06)        VALUE SPACES.              
           05  D2-AFTER-RCPT        PIC ZZ,ZZZ,ZZZ,ZZ9-.                        
           05  FILLER               PIC X(06)        VALUE SPACES.              
21591      05  D2-CUTOFF-STR-EXPTED PIC ZZ,ZZZ,ZZZ,ZZ9-.                        
21591      05  FILLER               PIC X(06)        VALUE SPACES.              
           05  D2-ADJUSTMENT-QTY    PIC ZZ,ZZZ,ZZZ,ZZ9-.                        
                                                                                
      /****************************************************************         
      * COPY FOR STANDARD HEADING                                               
      *****************************************************************         
                                                                                
           COPY DPWS133O.                                                       
                                                                                
      *****************************************************************         
      *  SQL ABEND ROUTINE WORKING STORAGE                                      
      *****************************************************************         
                                                                                
           COPY DPWS004.                                                        
                                                                                
21591 *****************************************************************         
21591 * 01  IN016-PHYSICAL-COUNT-RECORD                                         
21591 *****************************************************************         
W26600     COPY INWS016.                                                        
21591                                                                           
      *****************************************************************         
      * DB2 STORE TABLE DCLGEN.                                                 
      *****************************************************************         
           EXEC SQL                                                             
W26600         INCLUDE XMT00001                                                 
           END-EXEC.                                                            
                                                                                
      *****************************************************************         
      * DB2 MERCHANDISE DEPARTMENT                                              
      *****************************************************************         
           EXEC SQL                                                             
               INCLUDE SQLCA                                                    
           END-EXEC.                                                            
                                                                                
           COPY SQLCA2.                                                         
                                                                                
      *****************************************************************         
      *FLOW:    SEQUENTIALLY READ THE SORTED INPUT BOOKING SUMMARY FILE.        
      *      ACCUMULATE TOTALS FOR PHYSICAL INVENTORY, CUTOFF ONHAND,           
      *      POST AFTER FLUSH RECEIPTS, AND FASHION SALES ADJUSTMENTS.          
      *      FASHION SALES ADJUSTMENTS ARE CALCULATED FROM THE LATER.           
      *      NUMBERS ARE ACCUMULATED BY DEPARTMENT FOR A GIVEN STORE.           
      *                                                                         
      *         WHEN A STORE BREAK OCCURS, PRINT A DETAIL LINE FOR EACH         
      *      DEPARTMENT BY DUMPING THE CONTENTS OF THE DEPARTMENT TABLE         
      *      FOR THE STORE BEING PROCESSED. TOTAL UP FOR THE STORE.             
      *                                                                         
      *         THE MODULE GENERATES TWO REPORTS. A SUMMARIZED AUDIT            
      *      REPORT AND A DETAIL AUDIT REPORT. AS WE ACCUMULATE FOR THE         
      *      SUMMARY, WRITE A DETAIL LINE FOR EACH SKU BEING PROCESSED.         
      *                                                                         
      *         AT END OF FILE, PROVIDE COMPANY TOTALS; AS WELL, AS A           
      *      STORE LEVEL SUMMARY REPORT FOR REPORT 1.                           
      *                                                                         
      *         TABLES USED IN THE RPEORT.                                      
W26600*      XMT_LOC - LOCATION TABLE.                                          
      *                                                                         
      *****************************************************************         
      *****************************************************************         
       PROCEDURE DIVISION.                                                      
      *****************************************************************         
                                                                                
       A100-MAIN-MODULE.                                                        
                                                                                
           PERFORM B100-HOUSEKEEPING.                                           
                                                                                
           PERFORM B200-PRINT-REPORT                                            
               UNTIL PHYINV-PROCESSING-COMPLETE.                                
                                                                                
           PERFORM B600-EOJ.                                                    
                                                                                
       A999-EXIT-PROGRAM.                                                       
           STOP RUN.                                                            
                                                                                
      /****************************************************************         
      * B100-HOUSEKEEPING.......                                                
      *****************************************************************         
       B100-HOUSEKEEPING.                                                       
           MOVE '*B100-HOUSEKEEPING.              *' TO PV-PARA                 
                                                                                
           OPEN  INPUT BOOK-INPUT-SUMMARY-FILE                                  
                OUTPUT ADJ-PHYINV-DETAIL-REPORT.                                
                                                                                
           ACCEPT CPU-DATE FROM DATE.                                           
           MOVE CPU-YEAR   TO DP133O-RUN-YEAR.                                  
           MOVE CPU-MONTH  TO DP133O-RUN-MONTH.                                 
           MOVE CPU-DAY    TO DP133O-RUN-DAY.                                   
                                                                                
           ACCEPT CPU-TIME FROM TIME.                                           
           MOVE CPU-HOUR   TO DP133O-RUN-HOUR.                                  
           MOVE CPU-MINUTE TO DP133O-RUN-MINUTE.                                
                                                                                
           MOVE 'INKRP183' TO DP133O-PROGRAM-NAME.                              
           MOVE ZEROS      TO PC-PAGE-COUNT.                                    
           MOVE ZEROS      TO PC-PAGE-COUNT2.                                   
                                                                                
           MOVE 'N'        TO WS-PHYINV-DONE-SW.                                
           MOVE 'N'        TO WS-FIRST-TIME-SW.                                 
                                                                                
           INITIALIZE TB-DEPT-TABLE.                                            
           INITIALIZE TB-STORE-ACCUM-TABLE.                                     
21591      INITIALIZE IN016-PHYSICAL-COUNT-RECORD.                              
                                                                                
           PERFORM Z200-READ-BOOKING-INPUT-FILE.                                
                                                                                
W26600     MOVE IN016-STORE-9 TO XMT00001-LOC-NBR.                              
013102     PERFORM B500-GET-STR-NAME.                                           
           PERFORM Z810-PRINT-HEADINGS.                                         
                                                                                
      /****************************************************************         
      * B200-PRINT-REPORT.                                                      
      *     READ THE SORTED BOOKING INPUT SUMMARY UNTIL END OF FILE.            
      * GENERATE THE DETAIL PHYSICAL INVENTORY AUDIT REPORT. ACCUMULATE         
      * NUMBER BY DEPARTMENT FOR THE STORE BEING PROCESSED. WHEN A STORE        
      * BREAK OCCURS, PRINT THE STORE'S SUMMARIZED PHYSICAL INVENTORY           
      * AUDIT REPORT BY DEPARTMENT. PROVIDE TOTALS FOR THE STORE. INIT          
      * ACCUMULATORS AND RESET SWITCHES FOR THE NEXT STORE.                     
      *****************************************************************         
       B200-PRINT-REPORT.                                                       
           MOVE '*B200-PRINT-REPORT.              *' TO PV-PARA                 
                                                                                
21591      IF IN016-STORE NOT EQUAL PV-STORE-NMBR-SAVE                          
             IF (PV-ADJUSTMENT-QTY NOT EQUAL ZEROS) OR                          
                (PV-OLD-ONHAND-QTY NOT EQUAL ZEROS) OR                          
                (PV-QTY NOT EQUAL ZEROS)            OR                          
                (PV-AFTER-RCPT NOT EQUAL ZEROS)     OR                          
21591           (PV-CUTOFF-INTRANS NOT EQUAL ZEROS) OR                          
                (PV-CUTOFF-STR-EXPTED NOT EQUAL ZEROS)                          
21591          PERFORM B430-PRINT-DETAIL-TOTAL                                  
013102*        PERFORM Z810-PRINT-HEADINGS                                      
             END-IF                                                             
21591        MOVE IN016-STORE TO PV-STORE-NMBR-SAVE                             
W26600       MOVE IN016-STORE-9 TO XMT00001-LOC-NBR                             
013102       PERFORM B500-GET-STR-NAME                                          
013102       PERFORM Z810-PRINT-HEADINGS                                        
             INITIALIZE TB-DEPT-TABLE                                           
             MOVE ZEROS       TO PV-ADJUSTMENT-QTY                              
             MOVE ZEROS       TO PV-OLD-ONHAND-QTY                              
             MOVE ZEROS       TO PV-QTY                                         
             MOVE ZEROS       TO PV-AFTER-RCPT                                  
21591        MOVE ZEROS       TO PV-CUTOFF-INTRANS                              
             MOVE ZEROS       TO PV-CUTOFF-STR-EXPTED                           
           END-IF.                                                              
                                                                                
           PERFORM C100-ACCUM-DEPT-TOTALS.                                      
                                                                                
           PERFORM B420-PRINT-DETAIL-LINE-2.                                    
                                                                                
           PERFORM Z200-READ-BOOKING-INPUT-FILE.                                
                                                                                
      /****************************************************************         
      * B420-PRINT-DETAIL-LINE-2.                                               
      *     PRINT THE DETAILS INVENTORY AUDIT REPORT. THE REPORT DEVELOP        
      * REPORT TWO. IT WILL CONTAIN A DETAIL LINE FOR EACH STORE/SKU            
      * BEING PROCESSED.                                                        
      *****************************************************************         
       B420-PRINT-DETAIL-LINE-2.                                                
           MOVE '*B420-PRINT-DETAIL-LINE-2.       *' TO PV-PARA.                
                                                                                
           MOVE SPACES                TO D2-DETAIL-LINE.                        
W26600     MOVE IN016-STORE-9         TO D2-STORE-NBR.                          
W21732     MOVE IN016-SKU             TO D2-SKU-NMBR.                           
                                                                                
           MOVE PV-WRK-ADJUSTMENT-QTY TO D2-ADJUSTMENT-QTY.                     
21591      MOVE IN016-QTY             TO D2-QTY.                                
21591      MOVE IN016-OLD-ONHAND-QTY  TO D2-ONHAND-QTY.                         
21591      MOVE IN016-AFTER-RECEIPTS  TO D2-AFTER-RCPT.                         
21591 *    MOVE IN016-CUTOFF-INTRANSIT TO D2-CUTOFF-INTRANS.                    
           COMPUTE PV-STR-EXPECTED-CUTOFF =                                     
W27808           (IN016-STR-EXP-OH-QTY    - IN016-CUTOFF-INTRANSIT).            
           MOVE PV-STR-EXPECTED-CUTOFF TO D2-CUTOFF-STR-EXPTED.                 
                                                                                
           ADD PV-WRK-ADJUSTMENT-QTY  TO PV-DTL-ADJUSTMENT-QTY.                 
21591      ADD IN016-QTY              TO PV-DTL-QTY.                            
21591      ADD IN016-OLD-ONHAND-QTY   TO PV-DTL-OLD-ONHAND-QTY.                 
21591      ADD IN016-AFTER-RECEIPTS   TO PV-DTL-AFTER-RCPT.                     
21591 *    ADD IN016-CUTOFF-INTRANSIT TO PV-DTL-CUTOFF-INTRANS.                 
           COMPUTE PV-DTL-STR-EXPECTED =                                        
W27808           (IN016-STR-EXP-OH-QTY    - IN016-CUTOFF-INTRANSIT).            
           ADD PV-DTL-STR-EXPECTED TO PV-DTL-CUTOFF-STR-EXPTED.                 
                                                                                
           IF PC-LINE-COUNT2 > +59                                              
               PERFORM Z810-PRINT-HEADINGS                                      
           END-IF.                                                              
                                                                                
           MOVE D2-DETAIL-LINE        TO ADJ-PHYINV-DETAIL-RECORD.              
           MOVE 1                     TO PC-LINE-SPACE.                         
           PERFORM Z710-WRITE-REPORT-LINE.                                      
           ADD 1                      TO PC-LINE-COUNT2.                        
                                                                                
21591 /****************************************************************         
21591 * B430-PRINT-DETAIL-TOTAL.                                                
21591 *****************************************************************         
21591  B430-PRINT-DETAIL-TOTAL.                                                 
21591      MOVE '*B430-PRINT-DETAIL-TOTAL.         *' TO PV-PARA                
21591                                                                           
21591      MOVE SPACES                   TO D2-DETAIL-LINE.                     
21591      MOVE 'STR TOTAL'              TO D2-COMMENT.                         
21591      MOVE PV-ADJUSTMENT-QTY        TO D2-ADJUSTMENT-QTY.                  
21591      MOVE PV-AFTER-RCPT            TO D2-AFTER-RCPT.                      
21591      MOVE PV-CUTOFF-STR-EXPTED     TO D2-CUTOFF-STR-EXPTED.               
21591      MOVE PV-QTY                   TO D2-QTY.                             
21591      MOVE PV-OLD-ONHAND-QTY        TO D2-ONHAND-QTY.                      
21591                                                                           
21591      IF PC-LINE-COUNT2 > +59                                              
21591          PERFORM Z810-PRINT-HEADINGS                                      
21591      END-IF.                                                              
21591                                                                           
21591      MOVE D2-DETAIL-LINE           TO ADJ-PHYINV-DETAIL-RECORD.           
21591      MOVE 2                        TO PC-LINE-SPACE.                      
21591      PERFORM Z710-WRITE-REPORT-LINE.                                      
21591      ADD 2                         TO PC-LINE-COUNT2.                     
21591                                                                           
21591                                                                           
013102/****************************************************************         
013102* B500-GET-STR-NAME.                                                      
013102*     USED TO PRINT HEADINGS FOR THE SUMMARIZED INVENTORY AUDIT           
013102* REPORT. THE ROUTINE GRABS INFORMATION OFF THE LOCATION TABLE            
013102* XMT_LOC.                                                                
013102*****************************************************************         
013102 B500-GET-STR-NAME.                                                       
013102                                                                          
013102     EXEC SQL                                                             
W26600         SELECT LOC_NBR,                                                  
W26600                LOC_10_ABBR_NM                                            
W26600         INTO :XMT00001-LOC-NBR,                                          
W26600              :XMT00001-LOC-10-ABBR-NM                                    
W26600         FROM XMT_LOC                                                     
W26600         WHERE LOC_NBR = :XMT00001-LOC-NBR                                
P40463         WITH UR                                                          
013102     END-EXEC.                                                            
013102                                                                          
013102     EVALUATE TRUE                                                        
013102         WHEN SQLCODE IS EQUAL TO ZERO                                    
013102           CONTINUE                                                       
013102         WHEN SQLCODE IS EQUAL TO +100                                    
W26600           MOVE ZEROS TO XMT00001-LOC-NBR                                 
W26600           MOVE '***' TO XMT00001-LOC-10-ABBR-NM                          
013102         WHEN SQLWARN IS NOT EQUAL TO SPACES                              
013102         WHEN SQLCODE IS NOT EQUAL TO ZERO                                
013102           DISPLAY SPACES                                                 
013102           DISPLAY '** ABEND IN PROGRAM INKRP183'                         
013102           DISPLAY '** ERROR PROCESSING DB2 STORE TABLE.'                 
W26600           DISPLAY 'STORE NUMBER: ', IN016-STORE-9                        
013102           PERFORM Z900-SQL-ABEND                                         
013102     END-EVALUATE.                                                        
013102                                                                          
      /****************************************************************         
      * B600-EOJ.                                                               
      *     PRINT THE SUMMARIZED INVENTORY AUDIT TRAIL REPORT, BY DEPT,         
      * FOR THE LAST STORE PROCESSED.                                           
      *     GENERATE A TOTAL PAGE FOR ALL STORES.                               
      *     GENERATE A SUMMARY PAGE, BY STORE NUMBER, OF THE INFORMATION        
      * CREATED BY DEPARTMENT. TOTAL UP FOR ALL STORES.                         
      *     TOTAL UP FOR THE DETAILS INVENTORY AUDIT TRAIL REPORT.              
      *     CLOSE THE FILES.                                                    
      *****************************************************************         
       B600-EOJ.                                                                
      *** FINAL TOTAL UP......                                                  
                                                                                
           IF (PV-ADJUSTMENT-QTY NOT EQUAL ZEROS) OR                            
              (PV-OLD-ONHAND-QTY NOT EQUAL ZEROS) OR                            
              (PV-QTY NOT EQUAL ZEROS)            OR                            
              (PV-AFTER-RCPT NOT EQUAL ZEROS)     OR                            
21591         (PV-CUTOFF-INTRANS NOT EQUAL ZEROS) OR                            
              (PV-CUTOFF-STR-EXPTED NOT EQUAL ZEROS)                            
21591          PERFORM B430-PRINT-DETAIL-TOTAL                                  
           END-IF.                                                              
                                                                                
      *** NORMAL END OF JOB. PRINT STORE/DEPT TOTALS....                        
                                                                                
           MOVE '*B600-EOJ.                        ' TO PV-PARA                 
                                                                                
      *** PRINT A TOTALS SUMMARY PAGE FOR THE DETAIL REPORT....                 
                                                                                
           MOVE SPACES                        TO D2-DETAIL-LINE.                
           MOVE 'GRAND TOTAL'                 TO D2-COMMENT.                    
           MOVE PV-DTL-ADJUSTMENT-QTY         TO D2-ADJUSTMENT-QTY.             
           MOVE PV-DTL-AFTER-RCPT             TO D2-AFTER-RCPT.                 
21591      MOVE PV-DTL-CUTOFF-STR-EXPTED      TO D2-CUTOFF-STR-EXPTED.          
           MOVE PV-DTL-QTY                    TO D2-QTY.                        
           MOVE PV-DTL-OLD-ONHAND-QTY         TO D2-ONHAND-QTY.                 
                                                                                
           IF PC-LINE-COUNT2 > +59                                              
              PERFORM Z810-PRINT-HEADINGS                                       
           END-IF.                                                              
                                                                                
           MOVE D2-DETAIL-LINE           TO ADJ-PHYINV-DETAIL-RECORD.           
           MOVE 2                        TO PC-LINE-SPACE.                      
           PERFORM Z710-WRITE-REPORT-LINE.                                      
           ADD 2                         TO PC-LINE-COUNT2.                     
                                                                                
      *** CLOSE THE FILES.....                                                  
                                                                                
           CLOSE BOOK-INPUT-SUMMARY-FILE                                        
                 ADJ-PHYINV-DETAIL-REPORT.                                      
                                                                                
      /****************************************************************         
      * C100-ACCUM-DEPT-TOTALS.                                                 
      *     REFORMAT THE STORE NUMBER AND THE DEPARTMENT NUMBER TO A            
      * NUMERIC VALUE TO BE USED TO SUBSCRIPT THE DEPARTMENT AND STORE          
      * TABLES. IF EITHER VALUE EXCEEDS 999, THE MODULE WILL ABEND AND          
      * AN THE JOB WILL STOP.                                                   
      *     CALCULATE THE FASHION SALES ADJUSTMENTS IN A SIMILAR                
      * FASHION AS INKUT117 DOES.                                               
      *     ACCUMUALTE THE VALUES IN THE DEPARTMENT TABLE AND THE STORE         
      * TABLE.                                                                  
      *****************************************************************         
       C100-ACCUM-DEPT-TOTALS.                                                  
           MOVE '*C100-ACCUM-DEPT-TOTALS.          ' TO PV-PARA                 
                                                                                
      *** ACCUMULATE TO THE DEPARTMENT TABLE.....                               
                                                                                
21591      MOVE IN016-DEPT       TO PV-DEPT-NMBR.                               
           INSPECT PV-DEPT-NMBR REPLACING ALL ' ' BY '0'.                       
                                                                                
           MOVE IN016-STORE      TO PV-STORE-NMBR.                              
30272      INSPECT PV-STORE-NMBR-ALPH REPLACING ALL ' ' BY '0'.                 
                                                                                
           MOVE PV-DEPT-NMBR-NUM  TO PV-DEPT-SUB.                               
           IF PV-DEPT-SUB IS GREATER THAN PV-TAB-MAX                            
               DISPLAY '* * * * * * * * * * * * * * * '                         
               DISPLAY 'C100-ACCUM-DEPT-TOTALS.....   '                         
W26600         DISPLAY 'MORE THAN 9999 DEPARTMENTS EXIST'                       
               DISPLAY 'MUST EXPAND TABLE             '                         
               DISPLAY '* * * * * * * * * * * * * * * '                         
               DISPLAY '* * * * * * * * * * * * * * * '                         
               DISPLAY 'A B E N D                   * '                         
               PERFORM Z900-SQL-ABEND                                           
           END-IF.                                                              
                                                                                
21591 *                                                                         
21591 * THIS COMPUTE STATEMENT WILL TAKE INTO CONSIDERATION BOTH                
21591 * MANIFESTED AND NON-MANIFESTED STORES.  MANIFESTED STORES WILL           
21591 * HAVE ZERO AFTER FLUSH RECEIPT AND NON-ZERO IN CUTOFF IN-TRANSIT.        
21591 * NON-MANIFESTED STORES WILL HAVE ZERO IN CUTOFF IN-TRANSIT               
21591 * AND NON-ZERO IN AFTER FLUSH RECEIPT.                                    
21591 *                                                                         
21591      COMPUTE PV-WRK-ADJUSTMENT-QTY = IN016-QTY -                          
21591                                      (IN016-OLD-ONHAND-QTY                
21591                                    -  IN016-AFTER-RECEIPTS                
W27808                                   - (IN016-STR-EXP-OH-QTY -              
21591                                       IN016-CUTOFF-INTRANSIT)).           
                                                                                
           ADD PV-WRK-ADJUSTMENT-QTY TO TB-ADJUSTMENT-QTY (PV-DEPT-SUB).        
21591      ADD IN016-QTY             TO TB-QTY (PV-DEPT-SUB).                   
21591      ADD IN016-OLD-ONHAND-QTY  TO TB-OLD-ONHAND-QTY (PV-DEPT-SUB).        
21591      ADD IN016-AFTER-RECEIPTS  TO TB-AFTER-RCPT (PV-DEPT-SUB).            
21591 *    ADD IN016-CUTOFF-INTRANSIT TO TB-CUTOFF-INTRANS(PV-DEPT-SUB).        
           COMPUTE PV-TB-STR-EXPTED =                                           
W27808           (IN016-STR-EXP-OH-QTY    - IN016-CUTOFF-INTRANSIT).            
           ADD PV-TB-STR-EXPTED TO TB-CUTOFF-STR-EXPTED (PV-DEPT-SUB).          
                                                                                
           ADD PV-WRK-ADJUSTMENT-QTY TO PV-ADJUSTMENT-QTY.                      
21591      ADD IN016-QTY             TO PV-QTY.                                 
21591      ADD IN016-OLD-ONHAND-QTY  TO PV-OLD-ONHAND-QTY.                      
21591      ADD IN016-AFTER-RECEIPTS  TO PV-AFTER-RCPT.                          
21591 *    ADD IN016-CUTOFF-INTRANSIT TO PV-CUTOFF-INTRANS.                     
           COMPUTE PV-STR-EXPTED =                                              
W27808           (IN016-STR-EXP-OH-QTY - IN016-CUTOFF-INTRANSIT).               
           ADD PV-STR-EXPTED TO PV-CUTOFF-STR-EXPTED.                           
                                                                                
      *** ACCUMULATE TO THE STORE TABLE.....                                    
                                                                                
30272      MOVE PV-STORE-NMBR TO PV-STR-NDX.                                    
           IF PV-STR-NDX IS GREATER THAN MAX-STORES                             
               DISPLAY 'PV-STORE-NMBR-ALPH ', PV-STORE-NMBR-ALPH                
               DISPLAY 'PV-STR-NDX        ', PV-STR-NDX                         
               DISPLAY 'MAX-STORES        ', MAX-STORES                         
               DISPLAY '* * * * * * * * * * * * * * * '                         
               DISPLAY 'C100-ACCUM-DEPT-TOTALS.....   '                         
W26600         DISPLAY 'MORE THAN 9999 STORES EXIST    '                        
               DISPLAY 'MUST EXPAND TABLE             '                         
               DISPLAY '* * * * * * * * * * * * * * * '                         
               DISPLAY '* * * * * * * * * * * * * * * '                         
               DISPLAY 'A B E N D                   * '                         
               PERFORM Z900-SQL-ABEND                                           
           END-IF.                                                              
                                                                                
           ADD PV-WRK-ADJUSTMENT-QTY                                            
                         TO TB-STR-ADJUSTMENT-QTY (PV-STR-NDX).                 
21591      ADD IN016-QTY            TO TB-STR-QTY (PV-STR-NDX).                 
21591      ADD IN016-OLD-ONHAND-QTY TO TB-STR-OLD-ONHAND (PV-STR-NDX).          
21591      ADD IN016-AFTER-RECEIPTS TO TB-STR-AFTER-RCPT (PV-STR-NDX).          
21591 *    ADD IN016-CUTOFF-INTRANSIT                                           
21591 *        TO TB-STR-CUTOFF-INTRANS(PV-STR-NDX).                            
           COMPUTE PV-TB-STR-CUTOFF-STR-EXPTED =                                
W27808           (IN016-STR-EXP-OH-QTY    - IN016-CUTOFF-INTRANSIT).            
           ADD PV-TB-STR-CUTOFF-STR-EXPTED                                      
                             TO TB-STR-CUTOFF-STR-EXPTED (PV-STR-NDX).          
                                                                                
      /****************************************************************         
      * Z200-READ-BOOKING-INPUT-FILE....                                        
      *****************************************************************         
       Z200-READ-BOOKING-INPUT-FILE.                                            
           MOVE '*Z200-READ-BOOKING-INPUT-FILE     *' TO PV-PARA                
                                                                                
21591      READ BOOK-INPUT-SUMMARY-FILE INTO IN016-PHYSICAL-COUNT-RECORD        
               AT END  MOVE 'Y'  TO WS-PHYINV-DONE-SW.                          
                                                                                
           IF FIRST-TIME-THRU                                                   
21591          MOVE IN016-STORE  TO PV-STORE-NMBR-SAVE                          
               MOVE 'Y'          TO WS-FIRST-TIME-SW.                           
                                                                                
      /****************************************************************         
      * Z710-WRITE-REPORT-LINE.                                                 
      *****************************************************************         
       Z710-WRITE-REPORT-LINE.                                                  
                                                                                
           IF PC-LINE-SPACE IS EQUAL TO 999                                     
               WRITE ADJ-PHYINV-DETAIL-RECORD AFTER ADVANCING PAGE              
           ELSE                                                                 
               WRITE ADJ-PHYINV-DETAIL-RECORD                                   
                                 AFTER ADVANCING PC-LINE-SPACE LINES            
           END-IF.                                                              
                                                                                
      /****************************************************************         
      * Z810-PRINT-HEADINGS.                                                    
      *     USED TO PRINT HEADINGS FOR THE DETAILEDINVENTORY AUDIT              
      * REPORT.                                                                 
      *****************************************************************         
       Z810-PRINT-HEADINGS.                                                     
                                                                                
           ADD 1              TO PC-PAGE-COUNT2.                                
                                                                                
           MOVE PC-PAGE-COUNT2 TO DP133O-PAGE-NUMBER.                           
W21732     MOVE 1             TO DP133O-REPORT-NUMBER.                          
           MOVE DP133O-STANDRD-HEADER-133-COLS                                  
                              TO ADJ-PHYINV-DETAIL-RECORD.                      
           MOVE 999           TO PC-LINE-SPACE.                                 
           PERFORM Z710-WRITE-REPORT-LINE.                                      
           MOVE 1             TO PC-LINE-COUNT2.                                
                                                                                
           MOVE H1A-HEADING   TO ADJ-PHYINV-DETAIL-RECORD.                      
           MOVE 1             TO PC-LINE-SPACE.                                 
           PERFORM Z710-WRITE-REPORT-LINE.                                      
           ADD 1              TO PC-LINE-COUNT2.                                
                                                                                
W26600     MOVE XMT00001-LOC-NBR         TO H1B-STORE.                          
W26600     MOVE XMT00001-LOC-10-ABBR-NM  TO H1B-STORE-NAME.                     
013102     MOVE H1B-HEADING TO ADJ-PHYINV-DETAIL-RECORD.                        
013102     MOVE 1           TO PC-LINE-SPACE.                                   
013102     PERFORM Z710-WRITE-REPORT-LINE.                                      
013102     ADD 1              TO PC-LINE-COUNT.                                 
013102                                                                          
           MOVE H4-HEADING    TO ADJ-PHYINV-DETAIL-RECORD.                      
           MOVE 1             TO PC-LINE-SPACE.                                 
           PERFORM Z710-WRITE-REPORT-LINE.                                      
           ADD 1              TO PC-LINE-COUNT.                                 
                                                                                
           MOVE H5-HEADING    TO ADJ-PHYINV-DETAIL-RECORD.                      
           MOVE 1             TO PC-LINE-SPACE.                                 
           PERFORM Z710-WRITE-REPORT-LINE.                                      
           ADD 1              TO PC-LINE-COUNT.                                 
                                                                                
           MOVE SPACES        TO ADJ-PHYINV-DETAIL-RECORD.                      
           MOVE 1             TO PC-LINE-SPACE.                                 
           PERFORM Z710-WRITE-REPORT-LINE.                                      
           ADD 1              TO PC-LINE-COUNT.                                 
                                                                                
      /****************************************************************         
      * Z900-SQL-ABEND.                                                         
      *  STANDARD DB2 ERROR ABEND ROUTINE                                       
      *  THIS ROUTINE FORCES AN ABEND DUE TO A DB2 PROBLEM.                     
      ******************************************************************        
       Z900-SQL-ABEND.                                                          
                                                                                
           MOVE +4013                 TO ABEND-CODE.                            
           DISPLAY '**  ABEND     **'.                                          
           DISPLAY '**  PROGRAM   **  =  INKRP183'.                             
           DISPLAY '**  PARAGRAPH **  = ' PV-PARA.                              
           DISPLAY '**  OPERATION **  = ' PV-DB2-OPER-ATTEMPTED.                
                                                                                
      *    THE FOLLOWING COPYBOOK UTILIZES THE DB2 ABEND MODULE                 
      *    DSNTIAR TO CONVERT SQLCA INTO UNDERSTANDABLE VERBAGE.                
                                                                                
           COPY DPPD004.                                                        
                                                                                
           CALL 'ILBOABN0'  USING ABEND-CODE.                                   
