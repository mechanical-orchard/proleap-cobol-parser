000100 IDENTIFICATION DIVISION.                                         00010000
000200                                                                  00020000
000300 PROGRAM-ID.      SSKUT027.                                       00030000
000400 AUTHOR.          BARB SCHULTZ.                                   00040000
000500 INSTALLATION.    KOHLS DEPARTMENT STORES.                        00050000
000600 DATE-WRITTEN.    02/15/2007.                                     00060000
000700 DATE-COMPILED.                                                   00070000
000800                                                                  00080000
000900******************************************************************00090000
001000*  MODULE TYPE:   COBOL2 DB2 BATCH                                00100000
001100*                                                                 00110000
001200*  DESCRIPTION:   CREATES THE STORE MANAGEMENT SALES SUMMARY      00120000
001300*         REPORT EXTRACT FILE, WHICH WILL BE SORTED, THEN         00130000
001400*         FORMATTED AND PRINTED BY PROGRAM SSKRP027.              00140000
001500*                                                                 00150000
001600*  1. READ DATE CTCLD AND VALIDATE DATE                           00160000
001700*  2. LOAD ALL TERRITORY KEYS INTO TERRITORY TABLE                00170000
001800*  3. LOAD ALL REGN KEYS INTO REGN TABLE                          00180000
001900*  4. LOAD ALL STORE KEYS INTO STORE TABLE                        00190000
002000*  5. READ DAILY FLASH SALES FOR THIS YEAR                        00200000
002100*     IF ECOM                                                     00210000
002200*       - ADD SALES TO ECOM TOTALS                                00220000
002100*     ELSE                                                        00220100
002100*       - LOAD SALES TO TERR, REGN AND STORE TABLES               00220200
002200*     - ADD ALL SALES TO COMPANY TOTALS                           00220300
002300*  6. READ DAILY FLASH SALES FOR LAST YEAR                        00220400
002100*     IF ECOM                                                     00220500
002200*       - ADD SALES TO ECOM TOTALS                                00220600
002100*     ELSE                                                        00220700
002100*       - LOAD SALES TO TERR, REGN AND STORE TABLES               00220800
002500*     - ADD ALL SALES TO COMPANY TOTALS                           00220900
002600*  7. WRITE TERR TOTALS TO OUTPUT EXTRACT FILE                    00221000
002700*  8. WRITE REGN TOTALS TO OUTPUT EXTRACT FILE                    00222000
002800*  9. WRITE STORE TOTALS TO OUTPUT EXTRACT FILE                   00223000
002800* 10. WRITE ECOM TOTALS TO OUTPUT EXTRACT FILE                    00224000
002900* 11. WRITE COMPANY TOTALS TO OUTPUT EXTRACT FILE                 00225000
003000*                                                                 00226000
003100*  NOTES:                                                         00227000
003200*  1. IF A STORE WAS CLOSED IN THE LAST YEAR, DO NOT REPORT ON    00228000
003300*     IT (THIS YEAR OR LAST YEAR SALES).                          00229000
003400*  2. IF A STORE WAS REPLACED IN THE CURRENT YEAR, REPORT ON THE  00230000
003500*     SUM OF THE NEW (CURRENT) STORE'S 'THIS YEAR' SALES AND THE  00240000
003600*     OLD (REPLACED) STORE'S 'THIS YEAR' SALES, AND THE OLD       00250099
004000*     (REPLACED) STORE'S 'LAST YEAR' SALES.                       00251099
003700*  3. IF A STORE WAS REPLACED IN THE LAST YEAR, REPORT ON THE     00260000
003800*     NEW (CURRENT) STORE'S 'THIS YEAR' SALES AND THE SUM OF THE  00270000
003900*     NEW (CURRENT) STORE'S 'LAST YEAR' SALES AND THE OLD         00280000
004000*     (REPLACED) STORE'S 'LAST YEAR' SALES.                       00290000
004100*                                                                 00300000
REPL53*  4. REPLACEMENT STORE LOGIC MUST BE DRIVEN FROM THE 'THIS YEAR' 00301099
REPL53*     2200- PARA, WHICH WILL FETCH ALL ACTIVE STORES.  TRYING TO  00302099
REPL53*     DRIVE IT FROM THE 'LAST YEAR' 3200- AND 4200- PARA'S WILL   00303099
REPL53*     RESULT IN MISSED DATA WHEN THE CURRENT STORE WAS NOT OPEN   00304099
REPL53*     BY THE 'LAST YEAR' COMP DATE FOR SALES, OR THE 'LAST YEAR'  00305099
REPL53*     LAST FISCAL DATE FOR TOTALS.  THIS IS BECAUSE THE           00306099
REPL53*     'LAST YEAR' CURSORS WILL NOT PICK UP EITHER STORE SINCE     00307099
REPL53*     NEITHER WAS BOTH OPEN ON THE CURRENT DATE AND HAD SALES LAST00308099
REPL53*     YEAR.                                                       00309099
004100*                                                                 00309199
004200*  5. COMPARING TO THE FLASH SALES SCREENS -                      00310099
004300*     THE REPORT CREATED BY THIS PROGRAM AND SSKRP027 SHOULD MATCH00320000
004400*     THE FLASH SALES SCREEN NUMBERS.  THE ONE KNOWN EXCEPTION    00330000
004500*     IS WHEN THE REPORT IS RUN WITH A CTLCD DATE OLDER THAN 1    00340000
004600*     MONTH.  THIS PROGRAM ALWAYS PULLS 'THIS YEAR' SALES FROM    00350000
004700*     THE DFT_DLY_FLSH_SUM TABLE AND 'LAST YEAR' SALES FROM THE   00360000
004800*     THE DFT_ML_FINCL_SUM TABLE.  THE FLASH SALES SCREENS HAVE   00370000
004900*     LOGIC TO PULL 'THIS YEAR' SALES FROM THE DFT_ML_FINCL_SUM   00380000
005000*     TABLE WHEN THE PROCESS DATE IS MORE THAN 1 MONTH OLD. THE   00390000
005100*     REPORT WILL NORMALLY BE RUN FOR THE PREVIOUS DATE AND DOES  00400000
005200*     NOT HAVE THIS LOGIC.  THE NUMBERS WILL PROBABLY NOT CHANGE  00410000
005300*     SINCE THEY ARE REPORTED IN THOUSANDS, BUT THE PERCENTS COULD00420000
005400*     DIFFER.                                                     00430000
      *                                                                 00440000
004200*  6. REPORT ON ECOM BY ITSELF -                                  00450099
004300*     ECOM SALES WILL BE REMOVED FROM OHIO AND BE REPORTED ON     00460000
004400*     SEPERATELY JUST BEFORE THE COMPANY TOTALS.  THIS IS         00470000
004400*     DIFFERENT THAN HOW THEY ARE SHOWN ON THE FLASH SCREENS.     00480000
004500*                                                                 00490000
WEEK53*  7. 53 WEEK PROCESSING -                                        00500099
WEEK53*     NORMALLY, THE PROGRAM WILL CALL THE TDTATTR TABLE TO GET    00510000
WEEK53*     LAST YEAR'S DATE THAT THE CURRENT DATE IS TO BE COMPARED    00520000
WEEK53*     TO.  IF THE DATE RETURNED IS '9999-09-09', THEN WE ARE      00530000
WEEK53*     IN WEEK 53 AND THE FOLLOWING MUST BE DONE:                  00540000
WEEK53*     - SET THE DAILY COMPARISON PERCENTS TO N/A.                 00541000
WEEK53*     - USE THE CURRENT DATE FOR MTD AND YTD "ALL" COMPARES, BUT  00542000
WEEK53*       USE THE LAST DAY OF WEEK 52 FOR THE MTD AND YTD "COMP"    00543000
WEEK53*       COMPARES.                                                 00544000
WEEK53*     - IF THE DATE CTLCD 53 WEEK IND IS SET TO '53', USE SPECIAL 00545000
WEEK53*       53 WEEK PROCESSING TO DETERMINE THE DATE FROM LAST YEAR   00546000
WEEK53*       TO COMPARE TO (ADD 7 DAYS TO THE LAST YEAR DATE FOUND ON  00547000
WEEK53*       THE TDTATTR TABLE).                                       00548000
006200******************************************************************00614000
006300                                                                  00615000
006400 ENVIRONMENT DIVISION.                                            00616000
006500 CONFIGURATION SECTION.                                           00617000
006600                                                                  00618000
006700 SOURCE-COMPUTER.        IBM-3090.                                00619000
006800 OBJECT-COMPUTER.        IBM-3090.                                00620000
006900                                                                  00630000
007000 INPUT-OUTPUT SECTION.                                            00640000
007100 FILE-CONTROL.                                                    00650000
007200                                                                  00660000
007300     SELECT CTLCD-DATE-FILE       ASSIGN TO INP01                 00670000
007400         FILE STATUS IS WS-DATE-FILE-STATUS.                      00680000
007500     SELECT REPORT-EXTRACT-FILE   ASSIGN TO OUT01                 00690000
007600         FILE STATUS IS WS-RPT-FILE-STATUS.                       00700000
007700                                                                  00710000
007800 DATA DIVISION.                                                   00720000
007900 FILE SECTION.                                                    00730000
008000                                                                  00740000
008100 FD  CTLCD-DATE-FILE                                              00750000
008200     RECORDING MODE IS F                                          00760000
008300     LABEL RECORDS ARE STANDARD                                   00770000
008400     BLOCK CONTAINS 0 RECORDS                                     00780000
008500     RECORD CONTAINS 80 CHARACTERS.                               00790000
008600                                                                  00800000
008700 01  CTLCD-DATE-RECORD                 PIC  X(80).                00810000
008800                                                                  00820000
008900 FD  REPORT-EXTRACT-FILE                                          00830000
009000     RECORDING MODE IS F                                          00840000
009100     LABEL RECORDS ARE STANDARD                                   00850000
009200     BLOCK CONTAINS 0 RECORDS                                     00860000
009300     RECORD CONTAINS 263 CHARACTERS.                              00870092
009400                                                                  00880000
009500 01  REPORT-EXTRACT-RECORD             PIC  X(263).               00890091
009600                                                                  00900000
009700******************************************************************00910000
009800*                       WORKING STORAGE                           00920000
009900******************************************************************00930000
010000 WORKING-STORAGE SECTION.                                         00940000
010100                                                                  00950000
010200 01  WS-START                         PIC  X(40)                  00960000
010300     VALUE 'SSKUT027 - WORKING STORAGE BEGINS HERE'.              00970000
010400                                                                  00980000
010500                                                                  00990000
010600******************************************************************01000000
010700*                         SWITCHES                                01010000
010800******************************************************************01020000
010900 01  PS-PROGRAM-SWITCHES.                                         01030000
011000     05  PS-END-OF-CTLCD-FILE-SW      PIC  X(01)    VALUE 'N'.    01040000
011100         88  PS-END-OF-CTLCD-FILE                   VALUE 'Y'.    01050000
011200                                                                  01060000
011300     05  PS-END-OF-TERR-SW            PIC  X(01)    VALUE 'N'.    01070000
011400         88  PS-END-OF-TERR                         VALUE 'Y'.    01080000
011500                                                                  01090000
011600     05  PS-END-OF-REGN-SW            PIC  X(01)    VALUE 'N'.    01100000
011700         88  PS-END-OF-REGN                         VALUE 'Y'.    01110000
011800                                                                  01120000
011600     05  PS-END-OF-DIST-SW            PIC  X(01)    VALUE 'N'.    01121008
011700         88  PS-END-OF-DIST                         VALUE 'Y'.    01122008
011800                                                                  01123008
011900     05  PS-END-OF-STORE-SW           PIC  X(01)    VALUE 'N'.    01130000
012000         88  PS-END-OF-STORE                        VALUE 'Y'.    01140000
012100                                                                  01150000
012200     05  PS-END-OF-SALES-SW           PIC  X(01)    VALUE 'N'.    01160000
012300         88  PS-NOT-END-OF-SALES                    VALUE 'N'.    01170000
012400         88  PS-END-OF-SALES                        VALUE 'Y'.    01180000
012500                                                                  01190000
012600     05  PS-END-OF-SALES-TOTALS-SW    PIC  X(01)    VALUE 'N'.    01200000
012700         88  PS-NOT-END-OF-SALES-TOTALS             VALUE 'N'.    01210000
012800         88  PS-END-OF-SALES-TOTALS                 VALUE 'Y'.    01220000
012900                                                                  01230000
WEEK53     05  PS-53-WEEK-SW                PIC  X(01)    VALUE 'N'.    01240000
WEEK53         88  PS-NOT-IN-WEEK-53                      VALUE 'N'.    01250000
WEEK53         88  PS-IN-WEEK-53                          VALUE 'Y'.    01260000
012900                                                                  01270000
013000                                                                  01280000
013100******************************************************************01290000
013200*                        CONSTANTS                                01300000
013300******************************************************************01310000
013400 01  PC-PROGRAM-CONSTANTS.                                        01320000
013500     05  PC-PROGRAM-NAME            PIC  X(08)   VALUE 'SSKUT027'.01330000
013600     05  PC-ROW-NOT-FOUND           PIC S9(03)   VALUE +100.      01340000
013600     05  PC-NULL-RETURNED           PIC S9(03)   VALUE -305.      01341099
INCFIX     05  PC-TERR-MAX                PIC  S9(4)   VALUE +1000.     01350099
INCFIX     05  PC-REGN-MAX                PIC  S9(4)   VALUE +1000.     01360099
INCFIX     05  PC-DIST-MAX                PIC  S9(4)   VALUE +1000.     01361099
013900     05  PC-STORE-MAX               PIC  S9(4)   VALUE +5000.     01370081
014000                                                                  01380000
014100                                                                  01390000
014200******************************************************************01400000
014300*                        VARIABLES                                01410000
014400******************************************************************01420000
014500 01  PC-PROGRAM-VARIABLES.                                        01430000
014600     05  PV-SQLCODE                 PIC +9(04)    VALUE ZEROES.   01440000
014700     05  PV-PARAGRAPH-NAME          PIC  X(30)    VALUE SPACES.   01450000
014800     05  PV-TABLE-NAME              PIC  X(12)    VALUE SPACES.   01460000
014900     05  PV-OPERATION-MSG           PIC  X(60)    VALUE SPACES.   01470000
WEEK53     05  PV-53-WEEK-COMP-MTD-DOL-AMT                              01480000
WEEK53                                    PIC S9(11)V99 COMP-3 VALUE 0. 01490000
WEEK53     05  PV-SAVE-53-WEEK-COMP-MTD-DOL                             01491000
WEEK53                                    PIC S9(11)V99 COMP-3 VALUE 0. 01492000
WEEK53     05  PV-53-WEEK-COMP-YTD-DOL-AMT                              01493000
WEEK53                                    PIC S9(13)V99 COMP-3 VALUE 0. 01494000
WEEK53     05  PV-SAVE-53-WEEK-COMP-YTD-DOL                             01495000
WEEK53                                    PIC S9(13)V99 COMP-3 VALUE 0. 01496000
015000     05  PV-SAVE-DLY-DOL-AMT        PIC S9(11)V99 COMP-3 VALUE 0. 01497000
015100     05  PV-SAVE-MTD-DOL-AMT        PIC S9(11)V99 COMP-3 VALUE 0. 01498000
015200     05  PV-SAVE-YTD-DOL-AMT        PIC S9(13)V99 COMP-3 VALUE 0. 01499000
015300     05  PV-COMPANY-TY-DLY-AMT      PIC S9(11)V99 COMP-3 VALUE 0. 01500000
015400     05  PV-COMPANY-LY-DLY-AMT      PIC S9(11)V99 COMP-3 VALUE 0. 01510000
015500     05  PV-COMPANY-TY-MTD-AMT      PIC S9(11)V99 COMP-3 VALUE 0. 01520000
015600     05  PV-COMPANY-LY-MTD-AMT      PIC S9(11)V99 COMP-3 VALUE 0. 01530000
015700     05  PV-COMPANY-TY-YTD-AMT      PIC S9(13)V99 COMP-3 VALUE 0. 01540000
015800     05  PV-COMPANY-LY-YTD-AMT      PIC S9(13)V99 COMP-3 VALUE 0. 01550000
015900     05  PV-COMPANY-TY-COMP-DLY-AMT PIC S9(11)V99 COMP-3 VALUE 0. 01560000
016000     05  PV-COMPANY-LY-COMP-DLY-AMT PIC S9(11)V99 COMP-3 VALUE 0. 01570000
016100     05  PV-COMPANY-TY-COMP-MTD-AMT PIC S9(11)V99 COMP-3 VALUE 0. 01580000
016200     05  PV-COMPANY-LY-COMP-MTD-AMT PIC S9(11)V99 COMP-3 VALUE 0. 01590000
016300     05  PV-COMPANY-TY-COMP-YTD-AMT PIC S9(13)V99 COMP-3 VALUE 0. 01600000
016400     05  PV-COMPANY-LY-COMP-YTD-AMT PIC S9(13)V99 COMP-3 VALUE 0. 01610000
016500     05  PV-COMPANY-LY-TOTAL-SALES  PIC S9(13)V99 COMP-3 VALUE 0. 01620000
016600     05  PV-SEARCH-TERR             PIC  X(4)     VALUE SPACES.   01630058
016700     05  PV-SEARCH-REGN             PIC  X(4)     VALUE SPACES.   01640058
016700     05  PV-SEARCH-DIST             PIC  X(4)     VALUE SPACES.   01641058
016800     05  PV-DISPLAY-STORE           PIC  9(4)     VALUE ZEROES.   01650000
016900                                                                  01660000
017000     05  PV-RUN-DATE-CCYY-MM-DD     PIC  X(10)    VALUE SPACES.   01670000
WEEK53     05  PV-53-WEEK-LY-COMP-DATE    PIC  X(10)    VALUE SPACES.   01680000
WEEK53     05  PV-53-WEEK-TY-COMP-DATE    PIC  X(10)    VALUE SPACES.   01690000
017100     05  PV-LY-FISCAL-BEGIN-DATE    PIC  X(10)    VALUE SPACES.   01700000
017200     05  PV-LY-FISCAL-END-DATE      PIC  X(10)    VALUE SPACES.   01710000
017300     05  PV-LY-SAME-FISCAL-DATE     PIC  X(10)    VALUE SPACES.   01720000
017400     05  PV-TY-FISCAL-BEGIN-DATE    PIC  X(10)    VALUE SPACES.   01730000
017500     05  PV-TY-FISCAL-END-DATE      PIC  X(10)    VALUE SPACES.   01740000
017600                                                                  01750000
017700******************************************************************01760000
017800*                        WORK AREA                                01770000
017900******************************************************************01780000
018000 01  WS-WORK-AREA.                                                01790000
018100                                                                  01800000
018200     05  WS-DATE-FILE-STATUS        PIC  X(02)    VALUE ZEROES.   01810000
018300     05  WS-RPT-FILE-STATUS         PIC  X(02)    VALUE ZEROES.   01820000
018400                                                                  01830000
018500******************************************************************01840000
018600*                        ACCUMULATORS                             01850000
018700******************************************************************01860000
018800 01  PA-PROGRAM-ACCUMS.                                           01870000
018900                                                                  01880000
019000     05  PA-TERR-WRITTEN            PIC  9(5)     VALUE ZEROES.   01890000
019100     05  PA-REGN-WRITTEN            PIC  9(5)     VALUE ZEROES.   01900000
019200     05  PA-DIST-WRITTEN            PIC  9(5)     VALUE ZEROES.   01910004
019200     05  PA-STORE-WRITTEN           PIC  9(5)     VALUE ZEROES.   01911004
019300     05  PA-ECOM-WRITTEN            PIC  9(5)     VALUE ZEROES.   01920000
019300     05  PA-COMPANY-WRITTEN         PIC  9(5)     VALUE ZEROES.   01930000
019400     05  PA-TOTAL-WRITTEN           PIC  9(5)     VALUE ZEROES.   01940000
019500                                                                  01950000
019600     05  PA-STORE-SUB               PIC S9(04)    VALUE ZEROES.   01960068
019800     05  PA-DIST-SUB                PIC S9(04)    VALUE ZEROES.   01961015
019700     05  PA-REGN-SUB                PIC S9(04)    VALUE ZEROES.   01970000
019800     05  PA-TERR-SUB                PIC S9(04)    VALUE ZEROES.   01980000
019900                                                                  01990000
020000                                                                  02000000
020100 01  PA-STORE-TOTALS-TABLE.                                       02010000
020200*        SUBSCRIPTED BY STORE NUMBER                              02020000
020300    05  PA-STORE-TOTALS OCCURS 9999 TIMES.                        02030061
020400       10  PA-STORE-NUMBER          PIC 9(4)      VALUE ZEROES.   02040000
020500       10  PA-STORE-NAME            PIC X(10)     VALUE SPACES.   02050000
020700       10  PA-STORE-TERR            PIC 9(4)      VALUE ZEROES.   02051057
020700       10  PA-STORE-TERR-MGR-NM     PIC X(32)     VALUE SPACES.   02051191
020600       10  PA-STORE-REGN            PIC 9(4)      VALUE ZEROES.   02052057
020600       10  PA-STORE-REGN-MGR-NM     PIC X(32)     VALUE SPACES.   02053091
020600       10  PA-STORE-DIST            PIC 9(4)      VALUE ZEROES.   02060057
020600       10  PA-STORE-DIST-MGR-NM     PIC X(32)     VALUE SPACES.   02070091
020800       10  PA-STORE-TY-DAILY-SALES  PIC S9(11)V99 COMP-3 VALUE 0. 02080000
020900       10  PA-STORE-TY-MTD-SALES    PIC S9(11)V99 COMP-3 VALUE 0. 02090000
021000       10  PA-STORE-TY-YTD-SALES    PIC S9(13)V99 COMP-3 VALUE 0. 02100000
021100       10  PA-STORE-TY-COMP-DLY-SALES                             02110000
021200                                    PIC S9(11)V99 COMP-3 VALUE 0. 02120000
021300       10  PA-STORE-TY-COMP-MTD-SALES                             02130000
021400                                    PIC S9(11)V99 COMP-3 VALUE 0. 02140000
021500       10  PA-STORE-TY-COMP-YTD-SALES                             02150000
021600                                    PIC S9(13)V99 COMP-3 VALUE 0. 02160000
021700       10  PA-STORE-LY-DAILY-SALES  PIC S9(11)V99 COMP-3 VALUE 0. 02170000
021800       10  PA-STORE-LY-MTD-SALES    PIC S9(11)V99 COMP-3 VALUE 0. 02180000
021900       10  PA-STORE-LY-YTD-SALES    PIC S9(13)V99 COMP-3 VALUE 0. 02190000
022000       10  PA-STORE-LY-COMP-DLY-SALES                             02200000
022100                                    PIC S9(11)V99 COMP-3 VALUE 0. 02210000
022200       10  PA-STORE-LY-COMP-MTD-SALES                             02220000
022300                                    PIC S9(11)V99 COMP-3 VALUE 0. 02230000
022400       10  PA-STORE-LY-COMP-YTD-SALES                             02240000
022500                                    PIC S9(13)V99 COMP-3 VALUE 0. 02250000
022600       10  PA-STORE-LY-TOTAL-SALES  PIC S9(13)V99 COMP-3 VALUE 0. 02260000
022700       10  PA-STORE-COMP-MONTH-DATE PIC X(10)     VALUE SPACES.   02270000
022800       10  PA-STORE-COMP-YEAR-DATE  PIC X(10)     VALUE SPACES.   02280000
022800       10  PA-STORE-E-BUS-IND       PIC X         VALUE SPACES.   02281000
022900                                                                  02282000
023000                                                                  02283000
026400 01  PA-DIST-TOTALS-TABLE.                                        02283140
INCFIX    05  PA-DIST-TOTALS OCCURS 1000 TIMES.                         02283699
027100       10  PA-DIST                  PIC 9(4).                     02284169
027100       10  PA-DIST-MGR-NM           PIC X(32)  VALUE SPACES.      02284294
027100       10  PA-DIST-REGN             PIC 9(4)   VALUE ZEROES.      02284391
027100       10  PA-DIST-REGN-MGR-NM      PIC X(32)  VALUE SPACES.      02284491
027100       10  PA-DIST-TERR             PIC 9(4)   VALUE ZEROES.      02284591
027100       10  PA-DIST-TERR-MGR-NM      PIC X(32)  VALUE SPACES.      02284691
027200       10  PA-DIST-TY-DAILY-SALES   PIC S9(11)V99 COMP-3 VALUE 0. 02284731
027300       10  PA-DIST-TY-MTD-SALES     PIC S9(11)V99 COMP-3 VALUE 0. 02284831
027400       10  PA-DIST-TY-YTD-SALES     PIC S9(13)V99 COMP-3 VALUE 0. 02284931
027500       10  PA-DIST-TY-COMP-DLY-SALES                              02285031
027600                                    PIC S9(11)V99 COMP-3 VALUE 0. 02285131
027700       10  PA-DIST-TY-COMP-MTD-SALES                              02285231
027800                                    PIC S9(11)V99 COMP-3 VALUE 0. 02285331
027900       10  PA-DIST-TY-COMP-YTD-SALES                              02285431
028000                                    PIC S9(13)V99 COMP-3 VALUE 0. 02285531
028100       10  PA-DIST-LY-DAILY-SALES   PIC S9(11)V99 COMP-3 VALUE 0. 02285631
028200       10  PA-DIST-LY-MTD-SALES     PIC S9(11)V99 COMP-3 VALUE 0. 02285731
028300       10  PA-DIST-LY-YTD-SALES     PIC S9(13)V99 COMP-3 VALUE 0. 02285831
028400       10  PA-DIST-LY-COMP-DLY-SALES                              02285931
028500                                    PIC S9(11)V99 COMP-3 VALUE 0. 02286031
028600       10  PA-DIST-LY-COMP-MTD-SALES                              02286131
028700                                    PIC S9(11)V99 COMP-3 VALUE 0. 02286231
028800       10  PA-DIST-LY-COMP-YTD-SALES                              02286331
028900                                    PIC S9(13)V99 COMP-3 VALUE 0. 02286431
029000       10  PA-DIST-LY-TOTAL-SALES   PIC S9(13)V99 COMP-3 VALUE 0. 02286531
022800       10  PA-DIST-E-BUS-IND        PIC X         VALUE SPACES.   02286632
029100                                                                  02286731
023100 01  PA-REGN-TOTALS-TABLE.                                        02286831
INCFIX    05  PA-REGN-TOTALS OCCURS 1000 TIMES.                         02288099
027100       10  PA-REGN                  PIC 9(4)    VALUE ZEROES.     02293091
027100       10  PA-REGN-MGR-NM           PIC X(32)   VALUE SPACES.     02294091
024100       10  PA-REGN-TERR             PIC 9(4)    VALUE ZEROES.     02311057
027100       10  PA-REGN-TERR-MGR-NM      PIC X(32)   VALUE SPACES.     02312091
024300       10  PA-REGN-TY-DAILY-SALES   PIC S9(11)V99 COMP-3 VALUE 0. 02350000
024400       10  PA-REGN-TY-MTD-SALES     PIC S9(11)V99 COMP-3 VALUE 0. 02360000
024500       10  PA-REGN-TY-YTD-SALES     PIC S9(13)V99 COMP-3 VALUE 0. 02370099
024600       10  PA-REGN-TY-COMP-DLY-SALES                              02380000
024700                                    PIC S9(11)V99 COMP-3 VALUE 0. 02390000
024800       10  PA-REGN-TY-COMP-MTD-SALES                              02400000
024900                                    PIC S9(11)V99 COMP-3 VALUE 0. 02410000
025000       10  PA-REGN-TY-COMP-YTD-SALES                              02420000
025100                                    PIC S9(13)V99 COMP-3 VALUE 0. 02430000
025200       10  PA-REGN-LY-DAILY-SALES   PIC S9(11)V99 COMP-3 VALUE 0. 02440000
025300       10  PA-REGN-LY-MTD-SALES     PIC S9(11)V99 COMP-3 VALUE 0. 02450000
025400       10  PA-REGN-LY-YTD-SALES     PIC S9(13)V99 COMP-3 VALUE 0. 02460000
025500       10  PA-REGN-LY-COMP-DLY-SALES                              02470000
025600                                    PIC S9(11)V99 COMP-3 VALUE 0. 02480000
025700       10  PA-REGN-LY-COMP-MTD-SALES                              02490000
025800                                    PIC S9(11)V99 COMP-3 VALUE 0. 02500000
025900       10  PA-REGN-LY-COMP-YTD-SALES                              02510000
026000                                    PIC S9(13)V99 COMP-3 VALUE 0. 02520000
026100       10  PA-REGN-LY-TOTAL-SALES   PIC S9(13)V99 COMP-3 VALUE 0. 02530000
022800       10  PA-REGN-E-BUS-IND        PIC X         VALUE 'N'.      02540024
026200                                                                  02550000
026300                                                                  02560000
026400 01  PA-TERR-TOTALS-TABLE.                                        02570000
INXFIX    05  PA-TERR-TOTALS OCCURS 1000 TIMES.                         02610099
027100       10  PA-TERR                  PIC 9(4)      VALUE ZEROES.   02633091
027100       10  PA-TERR-MGR-NM           PIC X(32)     VALUE SPACES.   02634091
027200       10  PA-TERR-TY-DAILY-SALES   PIC S9(11)V99 COMP-3 VALUE 0. 02650000
027300       10  PA-TERR-TY-MTD-SALES     PIC S9(11)V99 COMP-3 VALUE 0. 02660000
027400       10  PA-TERR-TY-YTD-SALES     PIC S9(13)V99 COMP-3 VALUE 0. 02670000
027500       10  PA-TERR-TY-COMP-DLY-SALES                              02680000
027600                                    PIC S9(11)V99 COMP-3 VALUE 0. 02690000
027700       10  PA-TERR-TY-COMP-MTD-SALES                              02700000
027800                                    PIC S9(11)V99 COMP-3 VALUE 0. 02710000
027900       10  PA-TERR-TY-COMP-YTD-SALES                              02720000
028000                                    PIC S9(13)V99 COMP-3 VALUE 0. 02730000
028100       10  PA-TERR-LY-DAILY-SALES   PIC S9(11)V99 COMP-3 VALUE 0. 02740099
028200       10  PA-TERR-LY-MTD-SALES     PIC S9(11)V99 COMP-3 VALUE 0. 02750000
028300       10  PA-TERR-LY-YTD-SALES     PIC S9(13)V99 COMP-3 VALUE 0. 02760000
028400       10  PA-TERR-LY-COMP-DLY-SALES                              02770000
028500                                    PIC S9(11)V99 COMP-3 VALUE 0. 02780000
028600       10  PA-TERR-LY-COMP-MTD-SALES                              02790000
028700                                    PIC S9(11)V99 COMP-3 VALUE 0. 02800000
028800       10  PA-TERR-LY-COMP-YTD-SALES                              02810000
028900                                    PIC S9(13)V99 COMP-3 VALUE 0. 02820000
029000       10  PA-TERR-LY-TOTAL-SALES   PIC S9(13)V99 COMP-3 VALUE 0. 02830000
022800       10  PA-TERR-E-BUS-IND        PIC X         VALUE SPACES.   02831032
029100                                                                  02840000
029200                                                                  02851004
029300******************************************************************02860000
029400*                      CONTROL CARD                               02870000
029500******************************************************************02880000
029600 01  CC-CONTROL-CARD.                                             02890000
029700     05  CC-DB2-CTLCD-DATE-ISO.                                   02900000
029800         10  CC-DB2-REPORT-CC          PIC X(02).                 02910000
029900         10  CC-DB2-REPORT-YY          PIC X(02).                 02920000
030000         10  FILLER                    PIC X(01).                 02930000
030100         10  CC-DB2-REPORT-MM          PIC X(02).                 02940000
030200         10  FILLER                    PIC X(01).                 02950000
030300         10  CC-DB2-REPORT-DD          PIC X(02).                 02960000
030400     05  FILLER                        PIC X.                     02970000
WEEK53     05  CC-53-WEEK-IND                PIC XX.                    02980000
030400     05  FILLER                        PIC X(67).                 02990000
030500                                                                  03000000
030600                                                                  03010000
030700******************************************************************03020000
030800*                OUTPUT EXTRACT RECORD                            03030000
030900******************************************************************03040000
031000 01  WS-OUT-RECORD.                                               03050000
031100     05  WS-OUT-REC-CODE            PIC 9(2)      VALUE 0.        03060028
031200**       00 = TERR RECORD                                         03070000
031300**       02 = REGN RECORD                                         03080000
031300**       03 = DIST RECORD                                         03081004
031400**       04 = STORE RECORD                                        03090000
031400**       05 = ECOM RECORD                                         03100000
031500**       06 = COMPANY RECORD                                      03110000
031600     05  WS-OUT-TERR                PIC 9(4)      VALUE 0.        03120028
031600     05  WS-OUT-TERR-MGR-NM         PIC X(32)     VALUE SPACES.   03121091
031700     05  WS-OUT-REGN                PIC 9(4)      VALUE 0.        03130028
031700     05  WS-OUT-REGN-MGR-NM         PIC X(32)     VALUE SPACES.   03130191
031700     05  WS-OUT-DIST                PIC 9(4)      VALUE 0.        03131028
031700     05  WS-OUT-DIST-MGR-NM         PIC X(32)     VALUE SPACES.   03132091
031800     05  WS-OUT-STORE               PIC 9(4)      VALUE 0.        03140028
031900     05  WS-OUT-SORT-KEY.                                         03150000
032000**       THE SORT FIELDS WILL REFLECT THIS YEAR'S TOTAL SALES.    03160000
032100         10  WS-OUT-SORT-TERR-SALES       PIC S9(13)V99 COMP-3    03170000
032200                                                  VALUE 0.        03180000
032300         10  WS-OUT-SORT-REGN-SALES       PIC S9(13)V99 COMP-3    03190000
032400                                                  VALUE 0.        03200000
032300         10  WS-OUT-SORT-DIST-SALES       PIC S9(13)V99 COMP-3    03201004
032400                                                  VALUE 0.        03202004
032500         10  WS-OUT-SORT-STORE-SALES      PIC S9(13)V99 COMP-3    03210000
032600                                                  VALUE 0.        03220000
032700     05  WS-OUT-TY-DAILY-SALES      PIC S9(11)V99 COMP-3 VALUE 0. 03230000
032800     05  WS-OUT-TY-MTD-SALES        PIC S9(11)V99 COMP-3 VALUE 0. 03240000
032900     05  WS-OUT-TY-YTD-SALES        PIC S9(13)V99 COMP-3 VALUE 0. 03250000
033000     05  WS-OUT-TY-COMP-DLY-SALES   PIC S9(11)V99 COMP-3 VALUE 0. 03260000
033100     05  WS-OUT-TY-COMP-MTD-SALES   PIC S9(11)V99 COMP-3 VALUE 0. 03270000
033200     05  WS-OUT-TY-COMP-YTD-SALES   PIC S9(13)V99 COMP-3 VALUE 0. 03280000
033300     05  WS-OUT-LY-DAILY-SALES      PIC S9(11)V99 COMP-3 VALUE 0. 03290000
033400     05  WS-OUT-LY-MTD-SALES        PIC S9(11)V99 COMP-3 VALUE 0. 03300000
033500     05  WS-OUT-LY-YTD-SALES        PIC S9(13)V99 COMP-3 VALUE 0. 03310000
033600     05  WS-OUT-LY-COMP-DLY-SALES   PIC S9(11)V99 COMP-3 VALUE 0. 03320000
033700     05  WS-OUT-LY-COMP-MTD-SALES   PIC S9(11)V99 COMP-3 VALUE 0. 03330000
033800     05  WS-OUT-LY-COMP-YTD-SALES   PIC S9(13)V99 COMP-3 VALUE 0. 03340000
033900     05  WS-OUT-LY-TOTAL-SALES      PIC S9(13)V99 COMP-3 VALUE 0. 03350000
034100     05  WS-OUT-STORE-NAME          PIC X(10)     VALUE SPACES.   03370000
WEEK53     05  WS-OUT-DURING-WEEK-53      PIC X         VALUE SPACES.   03390000
WEEK53**       Y = RUN DATE IS DURING WEEK 53                           03400000
WEEK53     05  WS-OUT-LY-SAME-FISCAL-DATE PIC X(10)     VALUE SPACES.   03410000
034400                                                                  03430000
034500                                                                  03440000
034600******************************************************************03450000
034700*               SYSTEM TIME AND DATE VARIABLES                    03460000
034800******************************************************************03470000
034900 01  SYS-DATE-TIME.                                               03480000
035000     05  SYS-DATE                      PIC  X(08)    VALUE SPACES.03490000
035100     05  SYS-TIME                      PIC  X(08)    VALUE SPACES.03500000
035200                                                                  03510000
035300 01  ST-BEG-TIME.                                                 03520000
035400     05  ST-BEG-HR                     PIC  9(02)    VALUE ZEROES.03530000
035500     05  FILLER                        PIC  X(01)    VALUE ':'.   03540000
035600     05  ST-BEG-MN                     PIC  9(02)    VALUE ZEROES.03550000
035700     05  FILLER                        PIC  X(01)    VALUE ':'.   03560000
035800     05  ST-BEG-SS                     PIC  9(02)    VALUE ZEROES.03570000
035900                                                                  03580000
036000 01  ST-END-TIME.                                                 03590000
036100     05  ST-END-HR                     PIC  9(02)    VALUE ZEROES.03600000
036200     05  FILLER                        PIC  X(01)    VALUE ':'.   03610000
036300     05  ST-END-MN                     PIC  9(02)    VALUE ZEROES.03620000
036400     05  FILLER                        PIC  X(01)    VALUE ':'.   03630000
036500     05  ST-END-SS                     PIC  9(02)    VALUE ZEROES.03640000
036600                                                                  03650000
036700 01  SD-EDIT-DATE.                                                03660000
036800     05  SD-MONTH                      PIC  9(02)    VALUE ZEROES.03670000
036900     05  FILLER                        PIC  X(01)    VALUE '-'.   03680000
037000     05  SD-DAY                        PIC  9(02)    VALUE ZEROES.03690000
037100     05  FILLER                        PIC  X(01)    VALUE '-'.   03700000
037200     05  SD-CENT                       PIC  9(02)    VALUE ZEROES.03710000
037300     05  SD-YEAR                       PIC  9(02)    VALUE ZEROES.03720000
037400                                                                  03730000
037500******************************************************************03740000
037600*                        ERROR HANDLING                           03750000
037700******************************************************************03760000
037800 01  ABEND-CODE                        PIC S9(04)    VALUE ZEROES 03770000
037900                                                     COMP SYNC.   03780000
038000     88  ABEND-1111-TABLE-OVERFLOW                   VALUE +1111. 03790000
038100     88  ABEND-2222-MISSING-TABLE-ENTRY              VALUE +2222. 03800000
038200     88  ABEND-3333-INVALID-CTLCD-DATE               VALUE +3333. 03810000
038300     88  ABEND-4013-DB2-ERROR                        VALUE +4013. 03820000
038400                                                                  03830000
038500                                                                  03840000
038600******************************************************************03850000
038700* PARAMETER LIST FOR THE CALENDAR ROUTINE                         03860000
038800******************************************************************03870000
038900     COPY DPWS500.                                                03880000
039000                                                                  03890000
039100******************************************************************03900000
039200* VARIABLES REQUIRED FOR THE FORMAT SQLCA ROUTINE DPPD004         03910000
039300******************************************************************03920000
039400     COPY DPWS004.                                                03930000
039500                                                                  03940000
039600******************************************************************03950000
039700* DB2 MESSAGE AREA                                                03960000
039800******************************************************************03970000
039900     COPY SQLCA2.                                                 03980000
040000                                                                  03990000
040100******************************************************************04000000
040200* DB2 COMMUNICATION AREA                                          04010000
040300******************************************************************04020000
040400     EXEC SQL                                                     04030000
040500          INCLUDE SQLCA                                           04040000
040600     END-EXEC.                                                    04050000
040700                                                                  04060000
040800******************************************************************04070000
040900* STORE LOCATION TABLE (XST_LOC)                                  04080000
041000******************************************************************04090000
041100     EXEC SQL                                                     04100000
041200          INCLUDE XST00001                                        04110000
041300     END-EXEC.                                                    04120000
041400                                                                  04130000
040800******************************************************************04131001
040900* STORE LOCATION DISTRICT TABLE (XST_LOC_DIST)                    04132001
041000******************************************************************04133001
041100     EXEC SQL                                                     04134001
041200          INCLUDE XST00002                                        04135001
041300     END-EXEC.                                                    04136001
041400                                                                  04137001
040800******************************************************************04138001
040900* DISTRICT TABLE (XST_DIST)                                       04139001
041000******************************************************************04139101
041100     EXEC SQL                                                     04139201
041200          INCLUDE XST00003                                        04139301
041300     END-EXEC.                                                    04139401
041400                                                                  04139501
040800******************************************************************04139601
040900* DISTRICT REGION TABLE (XST_DIST_REGN)                           04139701
041000******************************************************************04139801
041100     EXEC SQL                                                     04139901
041200          INCLUDE XST00004                                        04140001
041300     END-EXEC.                                                    04140101
041400                                                                  04140201
040800******************************************************************04140301
040900* REGION TABLE (XST_REGN)                                         04140401
041000******************************************************************04140501
041100     EXEC SQL                                                     04140601
041200          INCLUDE XST00005                                        04140701
041300     END-EXEC.                                                    04140801
041400                                                                  04140901
040800******************************************************************04141001
040900* REGION TERRITORY TABLE (XST_REGN_TERR)                          04141101
041000******************************************************************04141201
041100     EXEC SQL                                                     04141301
041200          INCLUDE XST00006                                        04141401
041300     END-EXEC.                                                    04141501
041400                                                                  04141601
040800******************************************************************04141701
040900* TERRITORY TABLE (XST_TERR)                                      04141801
041000******************************************************************04141901
041100     EXEC SQL                                                     04142001
041200          INCLUDE XST00007                                        04142101
041300     END-EXEC.                                                    04142201
041400                                                                  04142301
042100                                                                  04200000
042900******************************************************************04280000
043000* DAILY FLASH SUMMARY TABLE (DFT_DLY_FLSH_SUM)                    04290000
043100******************************************************************04300000
043200     EXEC SQL                                                     04310000
043300          INCLUDE DFT00000                                        04320000
043400     END-EXEC.                                                    04330000
043600                                                                  04350000
043700******************************************************************04360000
043800* DAILY FINANCIAL SUMMARY TABLE (DFT_ML_FINCL_SUM)                04370000
043900******************************************************************04380000
044000     EXEC SQL                                                     04390000
044100          INCLUDE DFT00002                                        04400000
044200     END-EXEC.                                                    04410000
044300                                                                  04420000
044400                                                                  04430000
044500******************************************************************04440000
044600* DATE ATTRIBUTES TABLE (TDTATTR)                                 04450000
044700******************************************************************04460000
044800     EXEC SQL                                                     04470000
044900          INCLUDE TDTATTR                                         04480000
045000     END-EXEC.                                                    04490000
045100                                                                  04500000
045200                                                                  04510000
045300******************************************************************04520000
045400*  STORE-CURSOR - USED TO LOAD VALID STORE VALUES TO WS TABLE.    04530000
045500******************************************************************04540000
045600     EXEC SQL                                                     04784002
045700         DECLARE   STORE-CURSOR  CURSOR FOR                       04785002
045800             SELECT  F.LOC_NBR                                    04786005
045900                   , LOC_10_ABBR_NM                               04787002
046200                   , F.MN_SLS_INCL_DTE                            04789105
046300                   , F.YR_SLS_INCL_DTE                            04789205
046300                   , F.E_BUS_IND                                  04789305
046300                   , A.TERR_NBR                                   04789405
046300                   , B.REGN_NBR                                   04789505
046300                   , D.DIST_NBR                                   04789605
046300                   , G.DIST_MGR_NM                                04789790
046300                   , C.REGN_MGR_NM                                04789890
046300                   , A.TERR_MGR_NM                                04789990
046400              FROM   XST_TERR      A                              04790005
046400                   , XST_REGN_TERR B                              04790105
046500                   , XST_REGN      C                              04790205
046400                   , XST_DIST_REGN D                              04790305
046500                   , XST_LOC_DIST  E                              04790590
046400                   , XST_LOC       F                              04790690
046400                   , XST_DIST      G                              04790790
046600              WHERE  A.TERR_NBR        =  B.TERR_NBR              04790890
046700                AND  B.REGN_NBR        =  C.REGN_NBR              04790990
046700                AND  C.REGN_NBR        =  D.REGN_NBR              04791090
046700                AND  D.DIST_NBR        =  E.DIST_NBR              04791190
046700                AND  D.DIST_NBR        =  G.DIST_NBR              04791290
046700                AND  E.LOC_NBR         =  F.LOC_NBR               04791390
046700                AND  F.LOC_TYP_CDE     =  'DS'                    04791590
046800                AND  B.END_DTE        IS NULL                     04791690
046800                AND  D.END_DTE        IS NULL                     04791790
046800                AND  E.END_DTE        IS NULL                     04791890
046800                AND  F.OPN_DTE        <= :PV-RUN-DATE-CCYY-MM-DD  04791990
046900                AND  F.CLO_DTE        >= :PV-RUN-DATE-CCYY-MM-DD  04792099
047400           ORDER BY F.LOC_NBR                                     04792246
047500                                                                  04792604
047600       WITH UR                                                    04792704
047700     END-EXEC.                                                    04792804
047800                                                                  04793004
048000******************************************************************04800000
048100*  DIST-CURSOR - USED TO LOAD VALID DISTRICTS IN SEQ TO WS TABLE. 04810048
048200******************************************************************04820000
048300     EXEC SQL                                                     04830000
048400         DECLARE   DIST-CURSOR   CURSOR FOR                       04840006
046300             SELECT  DISTINCT D.DIST_NBR                          04850146
046300                   , B.REGN_NBR                                   04850246
046300                   , A.TERR_NBR                                   04850346
046300                   , F.E_BUS_IND                                  04850531
083700                   , G.DIST_MGR_NM                                04850698
046300                   , C.REGN_MGR_NM                                04850790
046300                   , A.TERR_MGR_NM                                04850890
046400              FROM   XST_TERR      A                              04851631
046400                   , XST_REGN_TERR B                              04852031
046500                   , XST_REGN      C                              04853031
046400                   , XST_DIST_REGN D                              04854031
046500                   , XST_LOC_DIST  E                              04855031
046400                   , XST_LOC       F                              04856031
046400                   , XST_DIST      G                              04856198
046600              WHERE  A.TERR_NBR        =  B.TERR_NBR              04857031
046700                AND  B.REGN_NBR        =  C.REGN_NBR              04858031
046700                AND  C.REGN_NBR        =  D.REGN_NBR              04859031
046700                AND  D.DIST_NBR        =  E.DIST_NBR              04859131
046700                AND  D.DIST_NBR        =  G.DIST_NBR              04859298
046700                AND  E.LOC_NBR         =  F.LOC_NBR               04859398
046700                AND  F.LOC_TYP_CDE     =  'DS'                    04859498
046800                AND  B.END_DTE        IS NULL                     04859598
046800                AND  D.END_DTE        IS NULL                     04859698
046800                AND  E.END_DTE        IS NULL                     04859798
046800                AND  F.OPN_DTE        <= :PV-RUN-DATE-CCYY-MM-DD  04859898
046900                AND  F.CLO_DTE        >= :PV-RUN-DATE-CCYY-MM-DD  04859999
049000             ORDER BY D.DIST_NBR                                  04874146
050800       WITH UR                                                    05020000
050900     END-EXEC.                                                    05030000
051000                                                                  05040000
048000******************************************************************05041006
048100*  REGN-CURSOR - USED TO LOAD VALID REGNS IN SEQ TO WS TABLE.     05042006
048200******************************************************************05043006
048300     EXEC SQL                                                     05044006
048400         DECLARE   REGN-CURSOR   CURSOR FOR                       05045006
048500          SELECT  DISTINCT B.REGN_NBR                             05045346
048500               ,  A.TERR_NBR                                      05045546
048500               ,  F.E_BUS_IND                                     05045746
046300               ,  C.REGN_MGR_NM                                   05045890
046300               ,  A.TERR_MGR_NM                                   05045990
046300               ,  G.DIST_MGR_NM                                   05046098
049800          FROM   XST_TERR      A                                  05046198
050400               , XST_REGN_TERR B                                  05046298
050700               , XST_REGN      C                                  05046398
050700               , XST_DIST_REGN D                                  05046498
050700               , XST_LOC_DIST  E                                  05046598
051000               , XST_LOC       F                                  05046698
051000               , XST_DIST      G                                  05046798
051000          WHERE  A.TERR_NBR        =  B.TERR_NBR                  05046898
051000            AND  B.REGN_NBR        =  C.REGN_NBR                  05046998
051000            AND  C.REGN_NBR        =  D.REGN_NBR                  05047098
051000            AND  D.DIST_NBR        =  E.DIST_NBR                  05047198
051000            AND  E.LOC_NBR         =  F.LOC_NBR                   05047298
051000            AND  F.LOC_TYP_CDE     =  'DS'                        05047398
051000            AND  B.END_DTE        IS NULL                         05047498
051000            AND  D.END_DTE        IS NULL                         05047598
051000            AND  E.END_DTE        IS NULL                         05047698
046800            AND  F.OPN_DTE        <= :PV-RUN-DATE-CCYY-MM-DD      05047798
046900            AND  F.CLO_DTE        >= :PV-RUN-DATE-CCYY-MM-DD      05047899
046300          ORDER BY   B.REGN_NBR                                   05048046
050800       WITH UR                                                    05049530
050900     END-EXEC.                                                    05049630
051000                                                                  05049730
048000******************************************************************05050005
048100*  TERR-CURSOR - USED TO LOAD VALID REGNS IN SEQ TO WS TABLE.     05051005
048200******************************************************************05052005
048300     EXEC SQL                                                     05053005
048400         DECLARE   TERR-CURSOR   CURSOR FOR                       05054005
048500          SELECT  DISTINCT A.TERR_NBR                             05055031
048900               ,  F.E_BUS_IND                                     05058031
046300               ,  A.TERR_MGR_NM                                   05059090
049800          FROM   XST_TERR      A                                  05059831
050400               , XST_REGN_TERR B                                  05060131
050700               , XST_REGN      C                                  05060431
050700               , XST_DIST_REGN D                                  05060531
050700               , XST_LOC_DIST  E                                  05060631
051000               , XST_LOC       F                                  05060931
051000          WHERE  A.TERR_NBR        =  B.TERR_NBR                  05061031
051000            AND  B.REGN_NBR        =  C.REGN_NBR                  05061131
051000            AND  C.REGN_NBR        =  D.REGN_NBR                  05061231
051000            AND  D.DIST_NBR        =  E.DIST_NBR                  05061331
051000            AND  E.LOC_NBR         =  F.LOC_NBR                   05061431
051000            AND  F.LOC_TYP_CDE     =  'DS'                        05061531
051000            AND  B.END_DTE        IS NULL                         05062031
051000            AND  D.END_DTE        IS NULL                         05062131
051000            AND  E.END_DTE        IS NULL                         05062231
046800            AND  F.OPN_DTE        <= :PV-RUN-DATE-CCYY-MM-DD      05062331
046900            AND  F.CLO_DTE        >= :PV-RUN-DATE-CCYY-MM-DD      05062499
050800          ORDER BY  A.TERR_NBR                                    05064131
050800       WITH UR                                                    05064231
050900     END-EXEC.                                                    05064331
051000                                                                  05065031
052900******************************************************************05230000
053000*  TY-SALES-CURSOR - USED TO GET DAILY SALES FOR THIS YEAR ONLY.  05240000
053100******************************************************************05250000
053200     EXEC SQL                                                     05260000
053300         DECLARE   TY-SALES-CURSOR CURSOR FOR                     05270000
053400             SELECT  D.STR_NBR                                    05280000
053500                   , MIN(L.OPN_DTE)                               05290000
053600                   , SUM(D.DLY_DOL_AMT)                           05300000
053700                   , SUM(D.MTD_DOL_AMT)                           05310000
053800                   , SUM(D.YTD_DOL_AMT)                           05320000
053900               FROM  DFT_DLY_FLSH_SUM D                           05330000
054000                   , XST_LOC L                                    05340000
054100              WHERE  D.STR_NBR         = L.LOC_NBR                05350000
054200                AND  L.LOC_TYP_CDE     = 'DS'                     05360000
054300                AND  L.OPN_DTE        <= :PV-RUN-DATE-CCYY-MM-DD  05370000
054400                AND  L.CLO_DTE        >= :PV-RUN-DATE-CCYY-MM-DD  05380099
054500                AND  D.SLS_DTE         = :PV-RUN-DATE-CCYY-MM-DD  05390000
054600           GROUP BY  D.STR_NBR                                    05400000
054700           ORDER BY  D.STR_NBR                                    05410000
054800                                                                  05420000
054900       WITH UR                                                    05430000
055000     END-EXEC.                                                    05440000
055100                                                                  05450000
055200                                                                  05460000
055300******************************************************************05470000
055400*  LY-SALES-CURSOR - USED TO GET DAILY SALES FOR LAST YEAR ONLY.  05480000
REPL53*  NOTE: THIS WILL PICK UP LAST YEAR SALES FOR A STORE THAT       05481099
REPL53*        REPLACED ANOTHER BEFORE THE LY COMPARE DATE, BUT NOT     05482099
REPL53*        BEFORE.                                                  05483099
055500******************************************************************05490000
055600     EXEC SQL                                                     05500000
055700         DECLARE   LY-SALES-CURSOR CURSOR FOR                     05510000
055800             SELECT  D.STR_NBR                                    05520000
055900                   , MIN(L.OPN_DTE)                               05530000
056000                   , SUM(D.DLY_DOL_AMT)                           05540000
056100                   , SUM(D.MTD_DOL_AMT)                           05550000
056200                   , SUM(D.YTD_DOL_AMT)                           05560000
056300               FROM  DFT_ML_FINCL_SUM D                           05570000
056400                   , XST_LOC L                                    05580000
056500              WHERE  D.STR_NBR         = L.LOC_NBR                05590000
056600                AND  L.LOC_TYP_CDE     = 'DS'                     05600000
056700                AND  L.OPN_DTE        <= :PV-RUN-DATE-CCYY-MM-DD  05610000
056800                AND  L.CLO_DTE        >= :PV-RUN-DATE-CCYY-MM-DD  05620099
056900                AND  D.SLS_DTE         = :PV-LY-SAME-FISCAL-DATE  05630000
057000           GROUP BY  D.STR_NBR                                    05640000
057100           ORDER BY  D.STR_NBR                                    05650000
057200                                                                  05660000
057300       WITH UR                                                    05670000
057400     END-EXEC.                                                    05680000
057500                                                                  05690000
057600                                                                  05700000
057700******************************************************************05710000
057800*  SALES-TOTAL-CURSOR - USED TO GET TOTAL SALES FOR LAST YEAR.    05720000
057900******************************************************************05730000
058000     EXEC SQL                                                     05740000
058100         DECLARE   SALES-TOTAL-CURSOR  CURSOR FOR                 05750000
058200             SELECT  D.STR_NBR                                    05760000
058300                   , MIN(L.OPN_DTE)                               05770000
058400                   , SUM(D.YTD_DOL_AMT)                           05780000
058500               FROM  DFT_ML_FINCL_SUM D                           05790000
058600                   , XST_LOC L                                    05800000
058700              WHERE  D.STR_NBR         = L.LOC_NBR                05810000
058800                AND  L.LOC_TYP_CDE     = 'DS'                     05820000
058900                AND  L.OPN_DTE        <= :PV-RUN-DATE-CCYY-MM-DD  05830000
059000                AND  L.CLO_DTE        >= :PV-RUN-DATE-CCYY-MM-DD  05840099
059100                AND  D.SLS_DTE         = :PV-LY-FISCAL-END-DATE   05850000
059200           GROUP BY  D.STR_NBR                                    05860000
059300           ORDER BY  D.STR_NBR                                    05870000
059400                                                                  05880000
059500       WITH UR                                                    05890000
059600     END-EXEC.                                                    05900000
059700                                                                  05910000
059800                                                                  05920000
059900 PROCEDURE DIVISION.                                              05930000
060000******************************************************************05940000
060100* MAIN DRIVER                                                     05950000
060200******************************************************************05960000
060300                                                                  05970000
060400     PERFORM 1000-INITIALIZE.                                     05980000
060500                                                                  05990000
060600**   GET THIS YEAR'S SALES FOR THE DAY                            06000000
060700     PERFORM 2000-PROCESS-TY-DAILY-SALES.                         06010000
060800                                                                  06020000
060900**   GET LAST YEAR'S SALES FOR THE DAY                            06030000
061000     PERFORM 3000-PROCESS-LY-DAILY-SALES.                         06040000
061100                                                                  06050000
061200**   GET LAST YEAR'S TOTAL SALES FOR REPORTING                    06060000
061300     PERFORM 4000-PROCESS-LY-TOTAL-SALES.                         06070000
061400                                                                  06080000
061500     PERFORM 7000-WRITE-REPORT-EXTRACT.                           06090000
061600                                                                  06100000
061700     PERFORM 9000-END-OF-JOB.                                     06110000
061800                                                                  06120000
061900     STOP RUN.                                                    06130000
062000                                                                  06140000
062100                                                                  06150000
062200******************************************************************06160000
062300* PERFORMS TASK INITIATION PROCESSING                             06170000
062400******************************************************************06180000
062500 1000-INITIALIZE.                                                 06190000
062600                                                                  06200000
062700     OPEN INPUT  CTLCD-DATE-FILE                                  06210000
062800          OUTPUT REPORT-EXTRACT-FILE.                             06220000
062900                                                                  06230000
020100     INITIALIZE PA-STORE-TOTALS-TABLE.                            06231063
063000     MOVE FUNCTION CURRENT-DATE TO SYS-DATE-TIME.                 06240000
063100                                                                  06250000
063200     MOVE SYS-TIME (1:2) TO ST-BEG-HR.                            06260000
063300     MOVE SYS-TIME (3:2) TO ST-BEG-MN.                            06270000
063400                                                                  06280000
063500     MOVE SYS-DATE (1:2) TO SD-CENT.                              06290000
063600     MOVE SYS-DATE (3:2) TO SD-YEAR.                              06300000
063700     MOVE SYS-DATE (5:2) TO SD-MONTH.                             06310000
063800     MOVE SYS-DATE (7:2) TO SD-DAY.                               06320000
063900                                                                  06330000
064000     PERFORM 1100-READ-CTLCD.                                     06340000
064100     PERFORM 1200-EDIT-DATE.                                      06350000
064200     PERFORM 1300-LOAD-TERR-TABLE-KEYS.                           06360000
064300     PERFORM 1400-LOAD-REGN-TABLE-KEYS.                           06370000
064300     PERFORM 1450-LOAD-DIST-TABLE-KEYS.                           06371006
064400     PERFORM 1500-LOAD-STORE-TABLE-KEYS.                          06380000
WEEK53**   THIS PROGRAM WILL BE EXECUTED TWICE FOR THE ENTIRE FISCAL    06390000
WEEK53**   FOLLOWING A FISCAL YEAR THAT HAD 53 WEEKS - ONCE IN          06400000
WEEK53**   "NORMAL" MODE WITH CC-53-WEEK-IND = '52' OR SPACES, AND      06410000
WEEK53**   ONCE WITH CC-53-WEEK-IND = '53' TO CREATE A "CALENDAR"       06420000
WEEK53**   VERSION OF THE REPORT WITH "LAST YEAR'S SAME FISCAL DATE"    06430000
WEEK53**   OFFSET BY 1 WEEK.                                            06440000
WEEK53     IF CC-53-WEEK-IND   = '53'                                   06441000
WEEK53         PERFORM 1620-GET-OFFSET-DATES                            06442000
WEEK53     ELSE                                                         06443000
064500         PERFORM 1600-GET-THIS-YEARS-DATES                        06444000
WEEK53     END-IF.                                                      06445000
064600     PERFORM 1700-GET-LAST-YEARS-END-DATE.                        06446000
064700                                                                  06447000
064800                                                                  06448000
064900******************************************************************06449000
065000* READ THE DATE FILE INTO THE CONTROL CARD                        06450000
065100******************************************************************06460000
065200 1100-READ-CTLCD.                                                 06470000
065300                                                                  06480000
065400     READ CTLCD-DATE-FILE INTO CC-CONTROL-CARD                    06490000
065500        AT END SET PS-END-OF-CTLCD-FILE TO TRUE.                  06500000
065600                                                                  06510000
065700     IF  PS-END-OF-CTLCD-FILE                                     06520000
065800         SET ABEND-3333-INVALID-CTLCD-DATE     TO TRUE            06530000
065900         DISPLAY 'PARA NAME = 1100-READ-CTLCD'                    06540000
066000         DISPLAY 'INPUT CTLCD DATE FILE IS EMPTY'                 06550000
066100         PERFORM 8100-ABEND                                       06560000
066200     END-IF.                                                      06570000
066300                                                                  06580000
066400                                                                  06590000
066500******************************************************************06600000
066600* EDIT THE DB2 DATE TO MAKE SURE THAT IT IS VALID.                06610000
066700******************************************************************06620000
066800 1200-EDIT-DATE.                                                  06630000
066900                                                                  06640000
067000     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              06650000
067100                                                                  06660000
067200     SET DPG51-ACTUAL-CALENDAR-ONLY    TO TRUE.                   06670000
067300     SET DPG51-DO-NOT-INCR-DECR-DATE   TO TRUE.                   06680000
067400     SET DPG52-LK-DTE-ISO-FMT          TO TRUE.                   06690000
067500                                                                  06700000
067600     MOVE CC-DB2-CTLCD-DATE-ISO        TO DPG52-LK-DATE-INPUT.    06710000
067700                                                                  06720000
067800     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    06730000
067900                                             DPG54 DPG55 DPG56.   06740000
068000                                                                  06750000
068100     EVALUATE TRUE                                                06760000
068200        WHEN DPG54-NO-ERROR                                       06770000
068400           MOVE CC-DB2-CTLCD-DATE-ISO TO PV-RUN-DATE-CCYY-MM-DD   06790000
068500                                                                  06800000
068600        WHEN DPG54-SEVERE-ERROR                                   06810000
068700        WHEN DPG54-DATE-INVALID                                   06820000
068800           SET ABEND-3333-INVALID-CTLCD-DATE     TO TRUE          06830000
068900           DISPLAY 'PARA NAME = 1200-EDIT-DATE - CALL DPKUT500'   06840000
069000           DISPLAY 'INPUT CTLCD DATE  ' CC-DB2-CTLCD-DATE-ISO     06850000
069100                   '  IS INVALID'                                 06860000
069200           DISPLAY 'CALENDAR MODULE ERROR IND = ' DPG54-ERROR-IND 06870000
069300           PERFORM 8100-ABEND                                     06880000
069400     END-EVALUATE.                                                06890000
069500                                                                  06900000
069600                                                                  06910000
069700******************************************************************06920000
069800* FETCH ALL VALID TERR CODES IN ORDER AND LOAD THEM TO THE        06930000
069900* TERR TABLE.                                                     06940000
070000******************************************************************06950000
070100 1300-LOAD-TERR-TABLE-KEYS.                                       06960000
070200                                                                  06970000
070300     MOVE 0 TO PA-TERR-SUB.                                       06980000
070400                                                                  06990000
070500     PERFORM 1310-OPEN-TERR-CURSOR.                               07000000
070600                                                                  07010000
070700     PERFORM 1320-FETCH-TERR-CURSOR                               07020000
070800        UNTIL PS-END-OF-TERR.                                     07030000
070900                                                                  07040000
071000     PERFORM 1330-CLOSE-TERR-CURSOR.                              07050000
071100                                                                  07060000
071200                                                                  07070000
071300******************************************************************07080000
071400* OPEN TERR CURSOR                                                07090000
071500******************************************************************07100000
071600 1310-OPEN-TERR-CURSOR.                                           07110000
071700                                                                  07120000
071800     EXEC SQL                                                     07130000
071900          OPEN TERR-CURSOR                                        07140000
072000     END-EXEC.                                                    07150000
072100                                                                  07160000
072200     IF SQLCODE NOT EQUAL ZERO                                    07170000
072300        MOVE SQLCODE                  TO PV-SQLCODE               07180000
072400        MOVE 'XST_LOC'                TO PV-TABLE-NAME            07190000
072500        MOVE '1310-OPEN-TERR-CURSOR' TO PV-PARAGRAPH-NAME         07200000
072600        STRING 'ERROR ON OPEN OF TERR CURSOR - SQLCODE= '         07210000
072700                PV-SQLCODE DELIMITED BY SIZE INTO                 07220000
072800                PV-OPERATION-MSG                                  07230000
072900        END-STRING                                                07240000
073000        PERFORM 8000-DB2-ABEND                                    07250000
073100     END-IF.                                                      07260000
073200                                                                  07270000
073300                                                                  07280000
073400******************************************************************07290000
073500* FETCH TERR CURSOR                                               07300000
073600******************************************************************07310000
073700 1320-FETCH-TERR-CURSOR.                                          07320000
073800                                                                  07330000
073900     EXEC SQL                                                     07340000
074000         FETCH TERR-CURSOR                                        07350000
048500          INTO :XST00007-TERR-NBR                                 07361005
048500             , :XST00001-E-BUS-IND                                07362031
048500             , :XST00007-TERR-MGR-NM                              07363090
074200     END-EXEC.                                                    07370000
074300                                                                  07380000
074400     EVALUATE TRUE                                                07390000
074500        WHEN SQLCODE = ZERO                                       07400000
074700           IF PA-TERR-SUB > PC-TERR-MAX                           07420000
074800               SET ABEND-1111-TABLE-OVERFLOW  TO TRUE             07430000
074900               DISPLAY 'PARA NAME = 1320-FETCH-TERR-CURSOR'       07440000
075000               DISPLAY 'TERR TABLE OVERFLOW - NBR OF ENTRIES = '  07450000
075100                        PA-TERR-SUB                               07460000
075200               PERFORM 8100-ABEND                                 07470000
075300           ELSE                                                   07480000
075400               MOVE XST00007-TERR-NBR TO PA-TERR-SUB              07490073
075400               MOVE XST00007-TERR-NBR TO PA-TERR (PA-TERR-SUB)    07490273
075400               MOVE XST00007-TERR-MGR-NM                          07490391
075400                               TO PA-TERR-MGR-NM (PA-TERR-SUB)    07490491
075400               MOVE XST00001-E-BUS-IND                            07491031
075400                               TO PA-TERR-E-BUS-IND (PA-TERR-SUB) 07492031
075500           END-IF                                                 07500000
075600                                                                  07510000
075700        WHEN SQLCODE = PC-ROW-NOT-FOUND                           07520000
075800           SET PS-END-OF-TERR TO TRUE                             07530000
075900                                                                  07540000
076000        WHEN OTHER                                                07550000
076100           MOVE SQLCODE                   TO PV-SQLCODE           07560000
076200           MOVE 'XST_LOC'                 TO PV-TABLE-NAME        07570000
076300           MOVE '1320-FETCH-TERR-CURSOR' TO PV-PARAGRAPH-NAME     07580000
076400           STRING 'ERROR ON FETCH OF TERR CURSOR - SQLCODE= '     07590000
076500                   PV-SQLCODE DELIMITED BY SIZE INTO              07600000
076600                   PV-OPERATION-MSG                               07610000
076700           END-STRING                                             07620000
076800           PERFORM 8000-DB2-ABEND                                 07630000
076900     END-EVALUATE.                                                07640000
077000                                                                  07650000
077100                                                                  07660000
077200******************************************************************07670000
077300* CLOSE TERR CURSOR                                               07680000
077400******************************************************************07690000
077500 1330-CLOSE-TERR-CURSOR.                                          07700000
077600                                                                  07710000
077700     EXEC SQL                                                     07720000
077800          CLOSE TERR-CURSOR                                       07730000
077900     END-EXEC.                                                    07740000
078000                                                                  07750000
078100     IF SQLCODE NOT EQUAL ZERO                                    07760000
078200        MOVE SQLCODE                   TO PV-SQLCODE              07770000
078300        MOVE 'XST_LOC'                 TO PV-TABLE-NAME           07780000
078400        MOVE '1330-CLOSE-TERR-CURSOR' TO PV-PARAGRAPH-NAME        07790000
078500        STRING 'ERROR ON CLOSE OF TERR CURSOR - SQLCODE= '        07800000
078600                PV-SQLCODE DELIMITED BY SIZE INTO                 07810000
078700                PV-OPERATION-MSG                                  07820000
078800        END-STRING                                                07830000
078900        PERFORM 8000-DB2-ABEND                                    07840000
079000     END-IF.                                                      07850000
079100                                                                  07860000
079200                                                                  07870000
079300******************************************************************07880000
079400* FETCH ALL VALID REGN CODES IN ORDER AND LOAD THEM TO THE        07890000
079500* REGN TABLE.                                                     07900000
079600******************************************************************07910000
079700 1400-LOAD-REGN-TABLE-KEYS.                                       07920000
079800                                                                  07930000
079900     MOVE 0 TO PA-REGN-SUB.                                       07940000
023100     INITIALIZE PA-REGN-TOTALS-TABLE.                             07941047
080000                                                                  07950000
080100     PERFORM 1410-OPEN-REGN-CURSOR.                               07960000
080200                                                                  07970000
080300     PERFORM 1420-FETCH-REGN-CURSOR                               07980000
080400        UNTIL PS-END-OF-REGN.                                     07990000
080500                                                                  08000000
080600     PERFORM 1430-CLOSE-REGN-CURSOR.                              08010000
080700                                                                  08020000
080800                                                                  08030000
080900******************************************************************08040000
081000* OPEN REGN CURSOR                                                08050000
081100******************************************************************08060000
081200 1410-OPEN-REGN-CURSOR.                                           08070000
081300                                                                  08080000
081400     EXEC SQL                                                     08090000
081500          OPEN REGN-CURSOR                                        08100000
081600     END-EXEC.                                                    08110000
081700                                                                  08120000
081800     IF SQLCODE NOT EQUAL ZERO                                    08130000
081900        MOVE SQLCODE                  TO PV-SQLCODE               08140000
082000        MOVE 'XST_REGN  '             TO PV-TABLE-NAME            08150006
082100        MOVE '1410-OPEN-REGN-CURSOR' TO PV-PARAGRAPH-NAME         08160000
082200        STRING 'ERROR ON OPEN OF REGN CURSOR - SQLCODE= '         08170000
082300                PV-SQLCODE DELIMITED BY SIZE INTO                 08180000
082400                PV-OPERATION-MSG                                  08190000
082500        END-STRING                                                08200000
082600        PERFORM 8000-DB2-ABEND                                    08210000
082700     END-IF.                                                      08220000
082800                                                                  08230000
082900                                                                  08240000
083000******************************************************************08250000
083100* FETCH REGN CURSOR                                               08260000
083200******************************************************************08270000
083300 1420-FETCH-REGN-CURSOR.                                          08280000
083400                                                                  08290000
083500     EXEC SQL                                                     08300000
083600         FETCH REGN-CURSOR                                        08310000
083700          INTO :XST00006-REGN-NBR                                 08320006
083700             , :XST00007-TERR-NBR                                 08330031
083700             , :XST00001-E-BUS-IND                                08340031
083700             , :XST00005-REGN-MGR-NM                              08350093
083700             , :XST00007-TERR-MGR-NM                              08351191
083700             , :XST00003-DIST-MGR-NM                              08351298
084000     END-EXEC.                                                    08360000
084100                                                                  08370000
084200     EVALUATE TRUE                                                08380000
084300        WHEN SQLCODE = ZERO                                       08390000
084500           IF PA-REGN-SUB > PC-REGN-MAX                           08410000
084600               SET ABEND-1111-TABLE-OVERFLOW  TO TRUE             08420000
084700               DISPLAY 'PARA NAME = 1420-FETCH-REGN-CURSOR'       08430000
084800               DISPLAY 'REGN TABLE OVERFLOW - NBR OF ENTRIES = '  08440000
084900                        PA-REGN-SUB                               08450000
085000               PERFORM 8100-ABEND                                 08460000
085100           ELSE                                                   08470000
085200               MOVE XST00006-REGN-NBR                             08490173
085300                              TO PA-REGN-SUB                      08490273
085200               MOVE XST00006-REGN-NBR                             08490573
085300                              TO PA-REGN (PA-REGN-SUB)            08490673
085200               MOVE XST00005-REGN-MGR-NM                          08490993
085300                              TO PA-REGN-MGR-NM (PA-REGN-SUB)     08491091
075400               MOVE XST00007-TERR-NBR                             08492031
085500                              TO PA-REGN-TERR (PA-REGN-SUB)       08510030
075400               MOVE XST00007-TERR-MGR-NM                          08520091
085500                          TO PA-REGN-TERR-MGR-NM (PA-REGN-SUB)    08530091
094200               MOVE XST00001-E-BUS-IND                            08540031
094200                              TO PA-REGN-E-BUS-IND(PA-REGN-SUB)   08550031
085800           END-IF                                                 08560000
085900                                                                  08570000
086000        WHEN SQLCODE = PC-ROW-NOT-FOUND                           08580000
086100           SET PS-END-OF-REGN TO TRUE                             08590000
086200                                                                  08600000
086300        WHEN OTHER                                                08610000
086400           MOVE SQLCODE                   TO PV-SQLCODE           08620000
086500           MOVE 'XST_STR_GP'              TO PV-TABLE-NAME        08630000
086600           MOVE '1420-FETCH-REGN-CURSOR' TO PV-PARAGRAPH-NAME     08640000
086700           STRING 'ERROR ON FETCH OF REGN CURSOR - SQLCODE= '     08650000
086800                   PV-SQLCODE DELIMITED BY SIZE INTO              08660000
086900                   PV-OPERATION-MSG                               08670000
087000           END-STRING                                             08680000
087100           PERFORM 8000-DB2-ABEND                                 08690000
087200     END-EVALUATE.                                                08700000
087300                                                                  08710000
087400                                                                  08720000
087500******************************************************************08730000
087600* CLOSE REGN CURSOR                                               08740000
087700******************************************************************08750000
087800 1430-CLOSE-REGN-CURSOR.                                          08760000
087900                                                                  08770000
088000     EXEC SQL                                                     08780000
088100          CLOSE REGN-CURSOR                                       08790000
088200     END-EXEC.                                                    08800000
088300                                                                  08810000
088400     IF SQLCODE NOT EQUAL ZERO                                    08820000
088500        MOVE SQLCODE                   TO PV-SQLCODE              08830000
088600        MOVE 'XST_STR_GP'              TO PV-TABLE-NAME           08840000
088700        MOVE '1430-CLOSE-REGN-CURSOR' TO PV-PARAGRAPH-NAME        08850000
088800        STRING 'ERROR ON CLOSE OF REGN CURSOR - SQLCODE= '        08860000
088900                PV-SQLCODE DELIMITED BY SIZE INTO                 08870000
089000                PV-OPERATION-MSG                                  08880000
089100        END-STRING                                                08890000
089200        PERFORM 8000-DB2-ABEND                                    08900000
089300     END-IF.                                                      08910000
089400                                                                  08920000
079300******************************************************************08921006
079400* FETCH ALL VALID DIST CODES IN ORDER AND LOAD THEM TO THE        08922006
079500* DIST TABLE.                                                     08923006
079600******************************************************************08924006
079700 1450-LOAD-DIST-TABLE-KEYS.                                       08925006
079800                                                                  08926006
079900     MOVE 0 TO PA-DIST-SUB.                                       08927006
080000                                                                  08928006
080100     PERFORM 1460-OPEN-DIST-CURSOR.                               08929006
080200                                                                  08929106
080300     PERFORM 1470-FETCH-DIST-CURSOR                               08929206
080400        UNTIL PS-END-OF-DIST.                                     08929306
080500                                                                  08929406
080600     PERFORM 1480-CLOSE-DIST-CURSOR.                              08929506
080700                                                                  08929606
080800                                                                  08929706
080900******************************************************************08929806
081000* OPEN DIST CURSOR                                                08929906
081100******************************************************************08930006
081200 1460-OPEN-DIST-CURSOR.                                           08930106
081300                                                                  08930206
081400     EXEC SQL                                                     08930306
081500          OPEN DIST-CURSOR                                        08930406
081600     END-EXEC.                                                    08930506
081700                                                                  08930606
081800     IF SQLCODE NOT EQUAL ZERO                                    08930706
081900        MOVE SQLCODE                  TO PV-SQLCODE               08930806
082000        MOVE 'XST_DIST'               TO PV-TABLE-NAME            08930906
082100        MOVE '1460-OPEN-DIST-CURSOR' TO PV-PARAGRAPH-NAME         08931006
082200        STRING 'ERROR ON OPEN OF DIST CURSOR - SQLCODE= '         08931106
082300                PV-SQLCODE DELIMITED BY SIZE INTO                 08931206
082400                PV-OPERATION-MSG                                  08931306
082500        END-STRING                                                08931406
082600        PERFORM 8000-DB2-ABEND                                    08931506
082700     END-IF.                                                      08931606
082800                                                                  08931706
082900                                                                  08931806
083000******************************************************************08931906
083100* FETCH DIST CURSOR                                               08932006
083200******************************************************************08932106
083300 1470-FETCH-DIST-CURSOR.                                          08932206
083400                                                                  08932306
083500     EXEC SQL                                                     08932406
083600         FETCH DIST-CURSOR                                        08932506
083700          INTO :XST00004-DIST-NBR                                 08933231
083700             , :XST00006-REGN-NBR                                 08933331
083700             , :XST00007-TERR-NBR                                 08933431
083700             , :XST00001-E-BUS-IND                                08933593
083700             , :XST00003-DIST-MGR-NM                              08933690
083700             , :XST00005-REGN-MGR-NM                              08933790
083700             , :XST00007-TERR-MGR-NM                              08933890
084000     END-EXEC.                                                    08933990
084100                                                                  08934090
084200     EVALUATE TRUE                                                08934190
084300        WHEN SQLCODE = ZERO                                       08934290
084500           IF PA-DIST-SUB > PC-DIST-MAX                           08934390
084600               SET ABEND-1111-TABLE-OVERFLOW  TO TRUE             08934490
084700               DISPLAY 'PARA NAME = 1470-FETCH-DIST-CURSOR'       08934590
084800               DISPLAY 'DIST TABLE OVERFLOW - NBR OF ENTRIES = '  08934690
084900                        PA-DIST-SUB                               08934790
085000               PERFORM 8100-ABEND                                 08934890
085100           ELSE                                                   08934990
085200               MOVE XST00004-DIST-NBR                             08935073
085300                              TO PA-DIST-SUB                      08935173
085200               MOVE XST00004-DIST-NBR                             08935273
085300                              TO PA-DIST (PA-DIST-SUB)            08935373
085200               MOVE XST00003-DIST-MGR-NM                          08935493
085300                              TO PA-DIST-MGR-NM (PA-DIST-SUB)     08935591
085400               MOVE XST00006-REGN-NBR                             08935691
085500                              TO PA-DIST-REGN (PA-DIST-SUB)       08935791
085400               MOVE XST00005-REGN-MGR-NM                          08935893
085500                       TO PA-DIST-REGN-MGR-NM (PA-DIST-SUB)       08935991
085400               MOVE XST00007-TERR-NBR                             08936091
085500                              TO PA-DIST-TERR (PA-DIST-SUB)       08936191
085400               MOVE XST00007-TERR-MGR-NM                          08936291
085500                       TO PA-DIST-TERR-MGR-NM (PA-DIST-SUB)       08936391
094200               MOVE XST00001-E-BUS-IND                            08936491
094200                              TO PA-DIST-E-BUS-IND(PA-DIST-SUB)   08936591
085800           END-IF                                                 08936691
085900                                                                  08936791
086000        WHEN SQLCODE = PC-ROW-NOT-FOUND                           08936891
086100           SET PS-END-OF-DIST TO TRUE                             08936991
086200                                                                  08937091
086300        WHEN OTHER                                                08937191
086400           MOVE SQLCODE                   TO PV-SQLCODE           08937291
086500           MOVE 'XST_DIST'                TO PV-TABLE-NAME        08937391
086600           MOVE '1420-FETCH-DIST-CURSOR'  TO PV-PARAGRAPH-NAME    08937491
086700           STRING 'ERROR ON FETCH OF DIST CURSOR - SQLCODE= '     08937591
086800                   PV-SQLCODE DELIMITED BY SIZE INTO              08937691
086900                   PV-OPERATION-MSG                               08937791
087000           END-STRING                                             08937891
087100           PERFORM 8000-DB2-ABEND                                 08937991
087200     END-EVALUATE.                                                08938091
087300                                                                  08938191
087400                                                                  08938291
087500******************************************************************08938391
087600* CLOSE DIST CURSOR                                               08938491
087700******************************************************************08938591
087800 1480-CLOSE-DIST-CURSOR.                                          08938691
087900                                                                  08938791
088000     EXEC SQL                                                     08938891
088100          CLOSE DIST-CURSOR                                       08938991
088200     END-EXEC.                                                    08939091
088300                                                                  08939191
088400     IF SQLCODE NOT EQUAL ZERO                                    08939291
088500        MOVE SQLCODE                   TO PV-SQLCODE              08939391
088600        MOVE 'XST_DIST'                TO PV-TABLE-NAME           08939491
088700        MOVE '1430-CLOSE-DIST-CURSOR'  TO PV-PARAGRAPH-NAME       08939591
088800        STRING 'ERROR ON CLOSE OF DIST CURSOR - SQLCODE= '        08939691
088900                PV-SQLCODE DELIMITED BY SIZE INTO                 08939791
089000                PV-OPERATION-MSG                                  08939891
089100        END-STRING                                                08939991
089200        PERFORM 8000-DB2-ABEND                                    08940091
089300     END-IF.                                                      08940191
089400                                                                  08940291
089500                                                                  08940391
089600******************************************************************08941091
089700* FETCH ALL VALID STORE NUMBERS AND LOAD THEM TO THE STORE TABLE. 08950000
089800******************************************************************08960000
089900 1500-LOAD-STORE-TABLE-KEYS.                                      08970000
090000                                                                  08980000
020100     INITIALIZE PA-STORE-TOTALS-TABLE.                            08981062
079900     MOVE 0 TO PA-STORE-SUB.                                      08982067
090100     PERFORM 1510-OPEN-STORE-CURSOR.                              08990000
090200                                                                  09000000
090300     PERFORM 1520-FETCH-STORE-CURSOR                              09010000
090400        UNTIL PS-END-OF-STORE.                                    09020000
090500                                                                  09030000
090600     PERFORM 1530-CLOSE-STORE-CURSOR.                             09040000
090700                                                                  09050000
090800                                                                  09060000
090900******************************************************************09070000
091000* OPEN STORE CURSOR                                               09080000
091100******************************************************************09090000
091200 1510-OPEN-STORE-CURSOR.                                          09100000
091300                                                                  09110000
091400     EXEC SQL                                                     09120000
091500          OPEN STORE-CURSOR                                       09130000
091600     END-EXEC.                                                    09140000
091700                                                                  09150000
091800     IF SQLCODE NOT EQUAL ZERO                                    09160000
091900        MOVE SQLCODE                  TO PV-SQLCODE               09170000
092000        MOVE 'XST_LOC'                TO PV-TABLE-NAME            09180000
092100        MOVE '1510-OPEN-STORE-CURSOR' TO PV-PARAGRAPH-NAME        09190000
092200        STRING 'ERROR ON OPEN OF STORE CURSOR - SQLCODE= '        09200000
092300                PV-SQLCODE DELIMITED BY SIZE INTO                 09210000
092400                PV-OPERATION-MSG                                  09220000
092500        END-STRING                                                09230000
092600        PERFORM 8000-DB2-ABEND                                    09240000
092700     END-IF.                                                      09250000
092800                                                                  09260000
092900                                                                  09270000
093000******************************************************************09280000
093100* FETCH STORE CURSOR                                              09290000
093200******************************************************************09300000
093300 1520-FETCH-STORE-CURSOR.                                         09310000
093400                                                                  09320000
093500     EXEC SQL                                                     09330000
093600         FETCH STORE-CURSOR                                       09340000
093700          INTO :XST00001-LOC-NBR                                  09350000
093800             , :XST00001-LOC-10-ABBR-NM                           09360000
094100             , :XST00001-MN-SLS-INCL-DTE                          09390000
094200             , :XST00001-YR-SLS-INCL-DTE                          09400000
094200             , :XST00001-E-BUS-IND                                09410000
046300             , :XST00007-TERR-NBR                                 09417006
046300             , :XST00006-REGN-NBR                                 09418006
046300             , :XST00004-DIST-NBR                                 09419006
083700             , :XST00003-DIST-MGR-NM                              09419191
083700             , :XST00005-REGN-MGR-NM                              09419291
083700             , :XST00007-TERR-MGR-NM                              09419391
094300     END-EXEC.                                                    09420000
094400                                                                  09430000
094500     EVALUATE TRUE                                                09440000
094600        WHEN SQLCODE = ZERO                                       09450000
094700           MOVE XST00001-LOC-NBR TO PA-STORE-SUB                  09460000
094700           MOVE XST00001-LOC-NBR TO PA-STORE-NUMBER(PA-STORE-SUB) 09461073
094900           MOVE XST00001-LOC-10-ABBR-NM                           09480000
095000                                 TO PA-STORE-NAME  (PA-STORE-SUB) 09490000
095300           MOVE XST00007-TERR-NBR TO PA-STORE-TERR (PA-STORE-SUB) 09520006
083700           MOVE XST00003-DIST-MGR-NM                              09520191
095300                       TO PA-STORE-DIST-MGR-NM (PA-STORE-SUB)     09520291
083700           MOVE XST00005-REGN-MGR-NM                              09520391
095300                       TO PA-STORE-REGN-MGR-NM (PA-STORE-SUB)     09520491
083700           MOVE XST00007-TERR-MGR-NM                              09520591
095300                       TO PA-STORE-TERR-MGR-NM (PA-STORE-SUB)     09520691
095300           MOVE XST00006-REGN-NBR TO PA-STORE-REGN (PA-STORE-SUB) 09521006
093900           MOVE XST00004-DIST-NBR                                 09522006
095200                                 TO PA-STORE-DIST (PA-STORE-SUB)  09523006
095400           MOVE XST00001-MN-SLS-INCL-DTE                          09530000
095500                       TO PA-STORE-COMP-MONTH-DATE (PA-STORE-SUB) 09540000
095600           MOVE XST00001-YR-SLS-INCL-DTE                          09550000
095700                       TO PA-STORE-COMP-YEAR-DATE  (PA-STORE-SUB) 09560000
094200           MOVE XST00001-E-BUS-IND                                09570000
094200                              TO PA-STORE-E-BUS-IND(PA-STORE-SUB) 09571000
095800                                                                  09572000
095900        WHEN SQLCODE = PC-ROW-NOT-FOUND                           09573000
096000           SET PS-END-OF-STORE   TO TRUE                          09574000
096100                                                                  09575000
096200        WHEN OTHER                                                09576000
096300           MOVE SQLCODE                   TO PV-SQLCODE           09577000
096400           MOVE 'XST_LOC'                 TO PV-TABLE-NAME        09578000
096500           MOVE '1520-FETCH-STORE-CURSOR' TO PV-PARAGRAPH-NAME    09579000
096600           STRING 'ERROR ON FETCH OF STORE CURSOR - SQLCODE= '    09580000
096700                   PV-SQLCODE DELIMITED BY SIZE INTO              09590000
096800                   PV-OPERATION-MSG                               09600000
096900           END-STRING                                             09610000
097000           PERFORM 8000-DB2-ABEND                                 09620000
097100     END-EVALUATE.                                                09630000
097200                                                                  09640000
097300                                                                  09650000
097400******************************************************************09660000
097500* CLOSE STORE CURSOR                                              09670000
097600******************************************************************09680000
097700 1530-CLOSE-STORE-CURSOR.                                         09690000
097800                                                                  09700000
097900     EXEC SQL                                                     09710000
098000          CLOSE STORE-CURSOR                                      09720000
098100     END-EXEC.                                                    09730000
098200                                                                  09740000
098300     IF SQLCODE NOT EQUAL ZERO                                    09750000
098400        MOVE SQLCODE                   TO PV-SQLCODE              09760000
098500        MOVE 'XST_LOC'                 TO PV-TABLE-NAME           09770000
098600        MOVE '1530-CLOSE-STORE-CURSOR' TO PV-PARAGRAPH-NAME       09780000
098700        STRING 'ERROR ON CLOSE OF STORE CURSOR - SQLCODE= '       09790000
098800                PV-SQLCODE DELIMITED BY SIZE INTO                 09800000
098900                PV-OPERATION-MSG                                  09810000
099000        END-STRING                                                09820000
099100        PERFORM 8000-DB2-ABEND                                    09830000
099200     END-IF.                                                      09840000
099300                                                                  09850000
099400                                                                  09860000
099500******************************************************************09870000
099600* GET SAME FISCAL DAY FROM LAST YEAR FOR COMPARING.               09880000
099700* ALSO, GET THIS FISCAL YEAR'S BEGIN DATE - IT WILL BE USED       09890000
099800* TO SEE IF THE STORE WAS OPENED DURING THE YEAR.  IF IT WAS,     09900000
099900* A CHECK WILL BE DONE TO SEE IF IT REPLACED ANOTHER STORE.       09910000
WEEK53* THE YEAR AND WEEK NUMBERS WILL BE REQUIRED FOR 53 WEEK YEARS.   09920000
100000******************************************************************09930000
100100 1600-GET-THIS-YEARS-DATES.                                       09940000
100200                                                                  09950000
100300     EXEC SQL                                                     09960000
100400         SELECT  FSCL_YR_BEG_DTE                                  09970000
100500               , FSCL_YR_END_DTE                                  09980000
100600               , LY_THIS_DAY_KY_DTE                               09990000
WEEK53               , FSCL_YR_NBR                                      10000000
WEEK53               , FSCL_WK_NBR                                      10010000
100700           INTO :DTATTR-FSCL-YR-BEG-DTE                           10020000
100800               ,:DTATTR-FSCL-YR-END-DTE                           10030000
100900               ,:DTATTR-LY-THIS-DAY-KY-DTE                        10040000
WEEK53               ,:DTATTR-FSCL-YR-NBR                               10050000
WEEK53               ,:DTATTR-FSCL-WK-NBR                               10060000
101000           FROM  TDTATTR                                          10070000
101100          WHERE  KY_DTE = :PV-RUN-DATE-CCYY-MM-DD                 10080000
101200                                                                  10090000
101300       WITH UR                                                    10100000
101400     END-EXEC.                                                    10110000
101500                                                                  10120000
101600     EVALUATE TRUE                                                10130000
101700        WHEN SQLCODE = ZERO                                       10140000
101800           MOVE DTATTR-FSCL-YR-BEG-DTE                            10150000
101900                                      TO PV-TY-FISCAL-BEGIN-DATE  10160000
102000           MOVE DTATTR-FSCL-YR-END-DTE                            10170000
102100                                      TO PV-TY-FISCAL-END-DATE    10180000
WEEK53           IF DTATTR-LY-THIS-DAY-KY-DTE = '9999-09-09'            10190000
WEEK53**             THIS IS WEEK 53                                    10200000
WEEK53               SET PS-IN-WEEK-53      TO TRUE                     10210000
WEEK53               PERFORM 1610-GET-53-WEEK-COMP-DATES                10220000
WEEK53           ELSE                                                   10220100
102200               MOVE DTATTR-LY-THIS-DAY-KY-DTE                     10220200
102300                                      TO PV-LY-SAME-FISCAL-DATE   10220300
WEEK53           END-IF                                                 10220400
102400                                                                  10220500
102500        WHEN OTHER                                                10220600
102600           MOVE SQLCODE                     TO PV-SQLCODE         10220700
102700           MOVE 'TDTATTR'                   TO PV-TABLE-NAME      10220800
102800           MOVE '1600-GET-THIS-YEARS-DATES' TO PV-PARAGRAPH-NAME  10220900
102900           STRING 'THIS YEARS DATE ' PV-RUN-DATE-CCYY-MM-DD       10221000
103000                  ' NOT FOUND - SQLCODE= '                        10222000
103100                   PV-SQLCODE DELIMITED BY SIZE INTO              10223000
103200                   PV-OPERATION-MSG                               10224000
103300           END-STRING                                             10225000
103400           PERFORM 8000-DB2-ABEND                                 10226000
103500     END-EVALUATE.                                                10227000
103600                                                                  10228000
099400                                                                  10229000
WEEK53******************************************************************10230000
WEEK53* THIS PARAGRAPH IS PERFORMED WHEN WE ARE IN WEEK 53 TO GET THE   10240000
WEEK53* TY AND LY COMP DATES TO BE USED FOR THE MTD AND YTD TOTALS.     10250000
WEEK53******************************************************************10260000
WEEK53 1610-GET-53-WEEK-COMP-DATES.                                     10270000
WEEK53                                                                  10280000
WEEK53     EXEC SQL                                                     10290000
WEEK53         SELECT  KY_DTE                                           10300000
WEEK53               , LY_THIS_DAY_KY_DTE                               10310000
WEEK53           INTO :PV-53-WEEK-TY-COMP-DATE                          10320000
WEEK53               ,:PV-53-WEEK-LY-COMP-DATE                          10330000
WEEK53           FROM  TDTATTR                                          10340000
WEEK53          WHERE  FSCL_YR_NBR   = :DTATTR-FSCL-YR-NBR              10350000
WEEK53            AND  FSCL_WK_NBR   = '52'                             10360000
WEEK53            AND  DAY_OF_WK_NBR = '7'                              10370000
WEEK53                                                                  10370100
WEEK53       WITH UR                                                    10370200
WEEK53     END-EXEC.                                                    10370300
WEEK53                                                                  10370400
WEEK53     EVALUATE TRUE                                                10370500
WEEK53        WHEN SQLCODE = ZERO                                       10370600
WEEK53***        ALL CURSORS WILL USE THE SAME VALUE FOR LAST YEAR'S    10370700
WEEK53***        "SAME DATE".  DAILY TOTALS WILL BE IGNORED.            10370800
WEEK53           MOVE PV-53-WEEK-LY-COMP-DATE TO PV-LY-SAME-FISCAL-DATE 10370900
WEEK53        WHEN OTHER                                                10371000
WEEK53           MOVE SQLCODE                     TO PV-SQLCODE         10372000
WEEK53           MOVE 'TDTATTR'                   TO PV-TABLE-NAME      10373000
WEEK53           MOVE '1610-GET-53-WEEK-COMP-DATES'                     10373100
WEEK53                                            TO PV-PARAGRAPH-NAME  10373200
WEEK53           STRING 'THIS YEAR ' DTATTR-FSCL-YR-NBR                 10373300
WEEK53                  ' FOR WEEK 52 / DAY 7 NOT FOUND - SQLCODE = '   10373400
WEEK53                   PV-SQLCODE DELIMITED BY SIZE INTO              10373500
WEEK53                   PV-OPERATION-MSG                               10373600
WEEK53           END-STRING                                             10373700
WEEK53           PERFORM 8000-DB2-ABEND                                 10373800
WEEK53     END-EVALUATE.                                                10373900
WEEK53                                                                  10374000
099400                                                                  10374100
WEEK53******************************************************************10374200
WEEK53* PROCESSING DURING THE FISCAL YEAR FOLLOWING A 53 WEEK YEAR -    10374300
WEEK53* IN 53 WEEK MODE (DETERMINED BY THE DATE CTLCD INDICATOR), USE   10374400
WEEK53* LAST YEAR'S DATE OFFSET BY 1 WEEK.                              10374500
WEEK53* GET SAME FISCAL DAY FROM LAST YEAR FOR COMPARING.               10374600
WEEK53* ALSO, GET THIS FISCAL YEAR'S BEGIN DATE - IT WILL BE USED       10374700
WEEK53* TO SEE IF THE STORE WAS OPENED DURING THE YEAR.  IF IT WAS,     10374800
WEEK53* A CHECK WILL BE DONE TO SEE IF IT REPLACED ANOTHER STORE.       10374900
WEEK53* THE YEAR AND WEEK NUMBERS WILL BE REQUIRED FOR 53 WEEK YEARS.   10375000
WEEK53******************************************************************10375100
WEEK53 1620-GET-OFFSET-DATES.                                           10375200
WEEK53                                                                  10375300
WEEK53     EXEC SQL                                                     10375400
WEEK53         SELECT  FSCL_YR_BEG_DTE                                  10375500
WEEK53               , FSCL_YR_END_DTE                                  10375600
WEEK53               , LY_THIS_DAY_KY_DTE + 7 DAYS                      10375700
WEEK53               , FSCL_YR_NBR                                      10375800
WEEK53               , FSCL_WK_NBR                                      10375900
WEEK53           INTO :DTATTR-FSCL-YR-BEG-DTE                           10376000
WEEK53               ,:DTATTR-FSCL-YR-END-DTE                           10376100
WEEK53               ,:DTATTR-LY-THIS-DAY-KY-DTE                        10376200
WEEK53               ,:DTATTR-FSCL-YR-NBR                               10376300
WEEK53               ,:DTATTR-FSCL-WK-NBR                               10376400
WEEK53           FROM  TDTATTR                                          10376500
WEEK53          WHERE  KY_DTE = :PV-RUN-DATE-CCYY-MM-DD                 10376600
WEEK53                                                                  10376700
WEEK53       WITH UR                                                    10376800
WEEK53     END-EXEC.                                                    10376900
WEEK53                                                                  10377000
WEEK53     EVALUATE TRUE                                                10377100
WEEK53        WHEN SQLCODE = ZERO                                       10377200
WEEK53           MOVE DTATTR-FSCL-YR-BEG-DTE                            10377300
WEEK53                                      TO PV-TY-FISCAL-BEGIN-DATE  10377400
WEEK53           MOVE DTATTR-FSCL-YR-END-DTE                            10377500
WEEK53                                      TO PV-TY-FISCAL-END-DATE    10377600
WEEK53           MOVE DTATTR-LY-THIS-DAY-KY-DTE                         10377700
WEEK53                                      TO PV-LY-SAME-FISCAL-DATE   10377800
WEEK53                                                                  10377900
WEEK53        WHEN OTHER                                                10378000
WEEK53           MOVE SQLCODE                     TO PV-SQLCODE         10378100
WEEK53           MOVE 'TDTATTR'                   TO PV-TABLE-NAME      10378200
WEEK53           MOVE '1620-GET-OFFSET-DATES'     TO PV-PARAGRAPH-NAME  10378300
WEEK53           STRING 'THIS YEARS DATE ' PV-RUN-DATE-CCYY-MM-DD       10378400
WEEK53                  ' NOT FOUND - SQLCODE= '                        10378500
WEEK53                   PV-SQLCODE DELIMITED BY SIZE INTO              10378600
WEEK53                   PV-OPERATION-MSG                               10378700
WEEK53           END-STRING                                             10378800
WEEK53           PERFORM 8000-DB2-ABEND                                 10378900
WEEK53     END-EVALUATE.                                                10379000
WEEK53                                                                  10379100
103700                                                                  10379200
103800******************************************************************10379300
103900* GET LAST FISCAL YEAR'S END DATE - IT'S YTD SALES WILL REFLECT   10379400
104000* TOTAL SALES FOR THE YEAR.  THE FISCAL BEGIN DATE WILL BE USED   10379500
104100* TO SEE IF THE STORE WAS OPENED DURING THE YEAR.  IF IT WAS,     10379600
104200* A CHECK WILL BE DONE TO SEE IF IT REPLACED ANOTHER STORE.       10379700
104300******************************************************************10379800
104400 1700-GET-LAST-YEARS-END-DATE.                                    10379900
104500                                                                  10380000
104600     EXEC SQL                                                     10390000
104700         SELECT  FSCL_YR_BEG_DTE                                  10400000
104800               , FSCL_YR_END_DTE                                  10410000
104900           INTO :DTATTR-FSCL-YR-BEG-DTE                           10420000
105000               ,:DTATTR-FSCL-YR-END-DTE                           10430000
105100           FROM  TDTATTR                                          10440000
105200          WHERE  KY_DTE = :PV-LY-SAME-FISCAL-DATE                 10450000
105300                                                                  10460000
105400       WITH UR                                                    10470000
105500     END-EXEC.                                                    10480000
105600                                                                  10490000
105700     EVALUATE TRUE                                                10500000
105800        WHEN SQLCODE = ZERO                                       10510000
105900           MOVE DTATTR-FSCL-YR-BEG-DTE                            10520000
106000                                      TO PV-LY-FISCAL-BEGIN-DATE  10530000
106100           MOVE DTATTR-FSCL-YR-END-DTE                            10540000
106200                                      TO PV-LY-FISCAL-END-DATE    10550000
106300                                                                  10560000
106400        WHEN OTHER                                                10570000
106500           MOVE SQLCODE                    TO PV-SQLCODE          10580000
106600           MOVE 'TDTATTR'                  TO PV-TABLE-NAME       10590000
106700           MOVE '1700-GET-LAST-YEARS-END-DATE'                    10600000
106800                                           TO PV-PARAGRAPH-NAME   10610000
106900           STRING 'LAST YEARS DATE ' PV-LY-SAME-FISCAL-DATE       10620000
107000                  ' NOT FOUND - SQLCODE= '                        10630000
107100                   PV-SQLCODE DELIMITED BY SIZE INTO              10640000
107200                   PV-OPERATION-MSG                               10650000
107300           END-STRING                                             10660000
107400           PERFORM 8000-DB2-ABEND                                 10670000
107500     END-EVALUATE.                                                10680000
107600                                                                  10690000
107700                                                                  10700000
107800******************************************************************10710000
107900* FETCH THIS YEAR'S DAILY SALES AND LOAD THEM TO THE STORE, REGN, 10720049
108000* DIST AND TERR TABLES.                                           10730049
108100******************************************************************10740000
108200 2000-PROCESS-TY-DAILY-SALES.                                     10750000
108300                                                                  10760000
108400     SET PS-NOT-END-OF-SALES         TO TRUE.                     10770000
108500                                                                  10780000
108600     PERFORM 2100-OPEN-TY-SALES-CURSOR.                           10790000
108700                                                                  10800000
108800     PERFORM 2200-FETCH-TY-SALES-CURSOR                           10810000
108900        UNTIL PS-END-OF-SALES.                                    10820000
109000                                                                  10830000
109100     PERFORM 2300-CLOSE-TY-SALES-CURSOR.                          10840000
109200                                                                  10850000
109300                                                                  10860000
109400******************************************************************10870000
109500* OPEN SALES CURSOR FOR THIS YEAR                                 10880000
109600******************************************************************10890000
109700 2100-OPEN-TY-SALES-CURSOR.                                       10900000
109800                                                                  10910000
109900     EXEC SQL                                                     10920000
110000          OPEN TY-SALES-CURSOR                                    10930000
110100     END-EXEC.                                                    10940000
110200                                                                  10950000
110300     IF SQLCODE NOT EQUAL ZERO                                    10960000
110400        MOVE SQLCODE                     TO PV-SQLCODE            10970000
110500        MOVE 'DFT_DLY_FLSH_SUM'          TO PV-TABLE-NAME         10980000
110600        MOVE '2100-OPEN-TY-SALES-CURSOR' TO PV-PARAGRAPH-NAME     10990000
110700        STRING 'ERROR ON OPEN OF SALES CURSOR - SQLCODE= '        11000000
110800                PV-SQLCODE DELIMITED BY SIZE INTO                 11010000
110900                PV-OPERATION-MSG                                  11020000
111000        END-STRING                                                11030000
111100        PERFORM 8000-DB2-ABEND                                    11040000
111200     END-IF.                                                      11050000
111300                                                                  11060000
111400                                                                  11070000
111500******************************************************************11080000
111600* FETCH SALES CURSOR FOR THIS YEAR.                               11090000
111700******************************************************************11100000
111800 2200-FETCH-TY-SALES-CURSOR.                                      11110000
111900                                                                  11120000
112000     EXEC SQL                                                     11130000
112100         FETCH TY-SALES-CURSOR                                    11140000
112200          INTO :DFT00000-STR-NBR                                  11150000
112300             , :XST00001-OPN-DTE                                  11160000
112400             , :DFT00000-DLY-DOL-AMT                              11170000
112500             , :DFT00000-MTD-DOL-AMT                              11180000
112600             , :DFT00000-YTD-DOL-AMT                              11190000
112700     END-EXEC.                                                    11200000
112800                                                                  11210000
112900     EVALUATE TRUE                                                11220000
113000        WHEN SQLCODE = ZERO                                       11230000
WEEK53           IF PS-IN-WEEK-53                                       11240000
WEEK53               PERFORM 2210-GET-WEEK-53-MTD-YTD-COMP              11250000
WEEK53           END-IF                                                 11260000
                                                                        11270000
113100**         IF THE STORE OPENED DURING THE CURRENT FISCAL YEAR,    11280000
113200**         THEN A CHECK IS REQUIRED TO SEE IF IT REPLACED ANOTHER 11290000
113300**         STORE.  IF IT DID, THEN THE 2 STORES DLY, MTD AND STD  11300000
113400**         SALES FIGURES MUST BE ADDED TOGETHER.                  11310000
WEEK53**         THIS SHOULD HANDLE THE OPENING OF A STORE IN WEEK 53.  11320000
113500           IF  XST00001-OPN-DTE  >= PV-TY-FISCAL-BEGIN-DATE       11330099
113600               MOVE DFT00000-DLY-DOL-AMT TO PV-SAVE-DLY-DOL-AMT   11340000
113700               MOVE DFT00000-MTD-DOL-AMT TO PV-SAVE-MTD-DOL-AMT   11350000
113800               MOVE DFT00000-YTD-DOL-AMT TO PV-SAVE-YTD-DOL-AMT   11360000
WEEK53               MOVE PV-53-WEEK-COMP-MTD-DOL-AMT                   11370000
WEEK53                                 TO PV-SAVE-53-WEEK-COMP-MTD-DOL  11380000
WEEK53               MOVE PV-53-WEEK-COMP-YTD-DOL-AMT                   11381000
WEEK53                                 TO PV-SAVE-53-WEEK-COMP-YTD-DOL  11382000
113900               MOVE ZEROES       TO DFT00000-DLY-DOL-AMT          11383000
114000                                    DFT00000-MTD-DOL-AMT          11384000
114100                                    DFT00000-YTD-DOL-AMT          11385000
WEEK53                                    PV-53-WEEK-COMP-MTD-DOL-AMT   11386000
WEEK53                                    PV-53-WEEK-COMP-YTD-DOL-AMT   11387000
114200               PERFORM 2500-CHECK-FOR-REPLACED-STORE              11388000
114300               ADD PV-SAVE-DLY-DOL-AMT   TO DFT00000-DLY-DOL-AMT  11389000
114400               ADD PV-SAVE-MTD-DOL-AMT   TO DFT00000-MTD-DOL-AMT  11390000
114500               ADD PV-SAVE-YTD-DOL-AMT   TO DFT00000-YTD-DOL-AMT  11400000
WEEK53               ADD PV-SAVE-53-WEEK-COMP-MTD-DOL                   11410000
WEEK53                                 TO PV-53-WEEK-COMP-MTD-DOL-AMT   11420000
WEEK53               ADD PV-SAVE-53-WEEK-COMP-YTD-DOL                   11430000
WEEK53                                 TO PV-53-WEEK-COMP-YTD-DOL-AMT   11440000
114600           END-IF                                                 11450000
114700           PERFORM 6000-ADD-TO-THIS-YEARS-SALES                   11460000
114800                                                                  11470000
REPL53**         IF STORE OPENED THIS YEAR OR LAST YEAR, CHECK IF IT    11471099
REPL53**         REPLACED ANOTHER STORE.  IF IT DID, GET THE LAST YEAR  11472099
REPL53**         TOTALS FOR THE REPLACED STORE SO THAT THEY CAN BE      11473099
REPL53**         ADDED TO THE CURRENT STORE'S TOTALS, WHICH WILL BE     11474099
REPL53**         FETCHED IN THE LAST YEAR SALES AND TOTAL CURSORS.      11475099
REPL53           IF  XST00001-OPN-DTE >= PV-LY-FISCAL-BEGIN-DATE        11476099
REPL53**         AND XST00001-OPN-DTE < PV-TY-FISCAL-BEGIN-DATE         11477099
REPL53               MOVE DFT00000-STR-NBR TO DFT00002-STR-NBR          11478099
REPL53               PERFORM 3500-CHECK-FOR-REPLACED-STORE              11479099
REPL53           END-IF                                                 11479199
114800                                                                  11479299
114900        WHEN SQLCODE = PC-ROW-NOT-FOUND                           11480000
REPL53        WHEN SQLCODE = PC-NULL-RETURNED                           11481099
115000           SET PS-END-OF-SALES TO TRUE                            11490000
115100                                                                  11500000
115200        WHEN OTHER                                                11510000
115300           MOVE SQLCODE                      TO PV-SQLCODE        11520000
115400           MOVE 'DFT_DLY_FLSH_SUM'           TO PV-TABLE-NAME     11530000
115500           MOVE '2200-FETCH-TY-SALES-CURSOR' TO PV-PARAGRAPH-NAME 11540000
115600           STRING 'ERROR ON FETCH OF SALES CURSOR - SQLCODE= '    11550000
115700                   PV-SQLCODE DELIMITED BY SIZE INTO              11560000
115800                   PV-OPERATION-MSG                               11570000
115900           END-STRING                                             11580000
116000           PERFORM 8000-DB2-ABEND                                 11590000
116100     END-EVALUATE.                                                11600000
116200                                                                  11610000
111400                                                                  11620000
WEEK53******************************************************************11621000
WEEK53* GET THE MTD AND YTD SALES AT THE END OF WEEK 52, WHICH WILL BE  11622000
WEEK53* USED FOR COMP STORE COMPARISONS DURING WEEK 53.                 11623000
WEEK53******************************************************************11624000
WEEK53 2210-GET-WEEK-53-MTD-YTD-COMP.                                   11625000
WEEK53                                                                  11626000
WEEK53     EXEC SQL                                                     11627000
WEEK53         SELECT  SUM(MTD_DOL_AMT)                                 11628000
WEEK53               , SUM(YTD_DOL_AMT)                                 11629000
WEEK53           INTO :PV-53-WEEK-COMP-MTD-DOL-AMT                      11630000
WEEK53              , :PV-53-WEEK-COMP-YTD-DOL-AMT                      11631000
WEEK53           FROM  DFT_DLY_FLSH_SUM                                 11631100
WEEK53          WHERE  STR_NBR         = :DFT00000-STR-NBR              11631200
WEEK53            AND  SLS_DTE         = :PV-53-WEEK-TY-COMP-DATE       11631300
WEEK53       WITH UR                                                    11631400
WEEK53     END-EXEC.                                                    11631500
WEEK53                                                                  11631600
WEEK53     EVALUATE TRUE                                                11631700
WEEK53        WHEN SQLCODE = ZERO                                       11631800
WEEK53           CONTINUE                                               11631900
WEEK53                                                                  11632000
WEEK53        WHEN SQLCODE = PC-ROW-NOT-FOUND                           11633000
REPL53        WHEN SQLCODE = PC-NULL-RETURNED                           11633199
REPL53           MOVE ZEROES TO PV-53-WEEK-COMP-MTD-DOL-AMT             11633299
REPL53                          PV-53-WEEK-COMP-YTD-DOL-AMT             11633399
WEEK53                                                                  11634100
WEEK53        WHEN OTHER                                                11634200
WEEK53           MOVE SQLCODE                    TO PV-SQLCODE          11634300
WEEK53           MOVE 'DFT_DLY_FLSH_SUM'         TO PV-TABLE-NAME       11634400
WEEK53           MOVE '2210-GET-WEEK-53-MTD-YTD-COMP'                   11634500
WEEK53                                           TO PV-PARAGRAPH-NAME   11634600
WEEK53           MOVE DFT00000-STR-NBR           TO PV-DISPLAY-STORE    11634700
WEEK53           STRING 'STORE ' PV-DISPLAY-STORE                       11634800
WEEK53                  ' FOR DATE ' PV-53-WEEK-TY-COMP-DATE            11634900
WEEK53                  ' RECEIVED SQLCODE = '                          11635000
WEEK53                   PV-SQLCODE DELIMITED BY SIZE INTO              11635100
WEEK53                   PV-OPERATION-MSG                               11635200
WEEK53           END-STRING                                             11635300
WEEK53           PERFORM 8000-DB2-ABEND                                 11635400
WEEK53     END-EVALUATE.                                                11635500
WEEK53                                                                  11635600
WEEK53                                                                  11635700
116400******************************************************************11635800
116500* CLOSE SALES CURSOR                                              11635900
116600******************************************************************11636000
116700 2300-CLOSE-TY-SALES-CURSOR.                                      11637000
116800                                                                  11638000
116900     EXEC SQL                                                     11639000
117000          CLOSE TY-SALES-CURSOR                                   11640000
117100     END-EXEC.                                                    11650000
117200                                                                  11660000
117300     IF SQLCODE NOT EQUAL ZERO                                    11670000
117400        MOVE SQLCODE                      TO PV-SQLCODE           11680000
117500        MOVE 'DFT_DLY_FLSH_SUM'           TO PV-TABLE-NAME        11690000
117600        MOVE '2300-CLOSE-TY-SALES-CURSOR' TO PV-PARAGRAPH-NAME    11700000
117700        STRING 'ERROR ON CLOSE OF SALES CURSOR - SQLCODE= '       11710000
117800                PV-SQLCODE DELIMITED BY SIZE INTO                 11720000
117900                PV-OPERATION-MSG                                  11730000
118000        END-STRING                                                11740000
118100        PERFORM 8000-DB2-ABEND                                    11750000
118200     END-IF.                                                      11760000
118300                                                                  11770000
118400                                                                  11780000
118500******************************************************************11790000
118600* IF A STORE OPENED DURING THE CURRENT FISCAL YEAR, CHECK TO SEE  11800000
118700* IF IT REPLACED A DIFFERENT STORE.                               11810000
118800* IF IT DID, GET THE REPLACED STORE'S SALES FOR THE CURRENT YEAR. 11820000
118900******************************************************************11830000
119000 2500-CHECK-FOR-REPLACED-STORE.                                   11840000
119100                                                                  11850000
119200     EXEC SQL                                                     11860000
119300         SELECT  LOC_NBR                                          11870000
119400           INTO :XST00001-LOC-NBR                                 11880000
119500           FROM  XST_LOC                                          11890000
119600          WHERE  REPLT_STR_NBR  = :DFT00000-STR-NBR               11900000
119700            AND  CLO_DTE       >= :PV-TY-FISCAL-BEGIN-DATE        11910000
119800                                                                  11920000
119900       WITH UR                                                    11930000
120000     END-EXEC.                                                    11940000
120100                                                                  11950000
120200     EVALUATE TRUE                                                11960000
120300        WHEN SQLCODE = ZERO                                       11970000
120400           PERFORM 2600-GET-REPLACED-STORE-SALES                  11980000
120500                                                                  11990000
120600        WHEN SQLCODE = PC-ROW-NOT-FOUND                           12000000
120700           CONTINUE                                               12010000
120800                                                                  12020000
120900        WHEN OTHER                                                12030000
121000           MOVE SQLCODE                    TO PV-SQLCODE          12040000
121100           MOVE 'XST_LOC'                  TO PV-TABLE-NAME       12050000
121200           MOVE '2500-CHECK-FOR-REPLACED-STORE'                   12060000
121300                                           TO PV-PARAGRAPH-NAME   12070000
121400           MOVE DFT00002-STR-NBR           TO PV-DISPLAY-STORE    12080000
121500           STRING 'STORE ' PV-DISPLAY-STORE                       12090000
121600                  ' SINCE DATE ' PV-TY-FISCAL-BEGIN-DATE          12100000
121700                  ' RECEIVED SQLCODE = '                          12110000
121800                   PV-SQLCODE DELIMITED BY SIZE INTO              12120000
121900                   PV-OPERATION-MSG                               12130000
122000           END-STRING                                             12140000
122100           PERFORM 8000-DB2-ABEND                                 12150000
122200     END-EVALUATE.                                                12160000
122300                                                                  12170000
122400                                                                  12180000
122500******************************************************************12190000
122600* A STORE WAS REPLACED BY ANOTHER.                                12200000
122700* GET THE REPLACED STORE'S SALES FOR THIS YEAR TO REPORT UNDER    12210000
122800* THE NEW STORE.                                                  12220000
122900******************************************************************12230000
123000 2600-GET-REPLACED-STORE-SALES.                                   12240000
123100                                                                  12250000
123200     EXEC SQL                                                     12260000
123300         SELECT  SUM(DLY_DOL_AMT)                                 12270000
123400               , SUM(MTD_DOL_AMT)                                 12280000
123500               , SUM(YTD_DOL_AMT)                                 12290000
123600           INTO :DFT00000-DLY-DOL-AMT                             12300000
123700              , :DFT00000-MTD-DOL-AMT                             12310000
123800              , :DFT00000-YTD-DOL-AMT                             12320000
123900           FROM  DFT_DLY_FLSH_SUM                                 12330000
124000          WHERE  STR_NBR         = :XST00001-LOC-NBR              12340000
124100            AND  SLS_DTE         = :PV-RUN-DATE-CCYY-MM-DD        12350000
124200       WITH UR                                                    12360000
124300     END-EXEC.                                                    12370000
124400                                                                  12380000
124500     EVALUATE TRUE                                                12390000
124600        WHEN SQLCODE = ZERO                                       12400000
124700           DISPLAY 'PAR 2600- FOUND REPLACEMENT FOR '             12410000
124800                   'STORE ' XST00001-LOC-NBR                      12420000
WEEK53           IF PS-IN-WEEK-53                                       12430000
WEEK53               PERFORM 2610-GET-WEEK-53-MTD-YTD-COMP              12440000
WEEK53           ELSE                                                   12450000
WEEK53               MOVE ZEROES TO PV-53-WEEK-COMP-MTD-DOL-AMT         12451000
WEEK53                              PV-53-WEEK-COMP-YTD-DOL-AMT         12452000
WEEK53           END-IF                                                 12453000
124900**         THE REPLACED STORE TOTALS WILL NOW BE ADDED TO THE     12454000
125000**         NEW STORE'S "THIS YEAR" TOTALS BY PARA 2200-.          12455000
125200                                                                  12456000
125300        WHEN SQLCODE = PC-ROW-NOT-FOUND                           12457000
REPL53        WHEN SQLCODE = PC-NULL-RETURNED                           12457199
125400**         THE NEW STORE'S "THIS YEAR" TOTALS WILL BE USED        12458000
125500           MOVE ZEROES TO DFT00000-DLY-DOL-AMT                    12459000
125600                          DFT00000-MTD-DOL-AMT                    12460000
125700                          DFT00000-YTD-DOL-AMT                    12470000
WEEK53                          PV-53-WEEK-COMP-MTD-DOL-AMT             12480000
WEEK53                          PV-53-WEEK-COMP-YTD-DOL-AMT             12490000
125800                                                                  12500000
125900        WHEN OTHER                                                12510000
126000           MOVE SQLCODE                    TO PV-SQLCODE          12520000
126100           MOVE 'DFT_DLY_FLSH_SUM'         TO PV-TABLE-NAME       12530000
126200           MOVE '2600-GET-REPLACED-STORE-SALES'                   12540000
126300                                           TO PV-PARAGRAPH-NAME   12550000
126400           MOVE XST00001-LOC-NBR           TO PV-DISPLAY-STORE    12560000
126500           STRING 'STORE ' PV-DISPLAY-STORE                       12570000
126600                  ' SINCE DATE ' PV-RUN-DATE-CCYY-MM-DD           12580000
126700                  ' RECEIVED SQLCODE = '                          12590000
126800                   PV-SQLCODE DELIMITED BY SIZE INTO              12600000
126900                   PV-OPERATION-MSG                               12610000
127000           END-STRING                                             12620000
127100           PERFORM 8000-DB2-ABEND                                 12630000
127200     END-EVALUATE.                                                12640000
127300                                                                  12650000
127300                                                                  12660000
WEEK53******************************************************************12670000
WEEK53* A STORE WAS REPLACED BY ANOTHER AND WE ARE IN WEEK 53.          12680000
WEEK53* THIS PARAGRAPH IS REQUIRED IN CASE THE ORIGINAL STORE           12690000
WEEK53* CLOSED DURING WEEK 53 - COMP SALES STOP AT THE END OF WEEK 52.  12700000
WEEK53* GET THE REPLACED STORE'S SALES FOR THIS YEAR TO REPORT UNDER    12710000
WEEK53* THE NEW STORE AS OF THE END OF WEEK 52 FOR COMP REPORTING.      12720000
WEEK53******************************************************************12730000
WEEK53 2610-GET-WEEK-53-MTD-YTD-COMP.                                   12731000
WEEK53                                                                  12732000
WEEK53     EXEC SQL                                                     12733000
WEEK53         SELECT  SUM(MTD_DOL_AMT)                                 12734000
WEEK53               , SUM(YTD_DOL_AMT)                                 12735000
WEEK53           INTO :PV-53-WEEK-COMP-MTD-DOL-AMT                      12736000
WEEK53              , :PV-53-WEEK-COMP-YTD-DOL-AMT                      12737000
WEEK53           FROM  DFT_DLY_FLSH_SUM                                 12738000
WEEK53          WHERE  STR_NBR         = :XST00001-LOC-NBR              12739000
WEEK53            AND  SLS_DTE         = :PV-53-WEEK-TY-COMP-DATE       12739100
WEEK53       WITH UR                                                    12739200
WEEK53     END-EXEC.                                                    12739300
WEEK53                                                                  12739400
WEEK53     EVALUATE TRUE                                                12739500
WEEK53        WHEN SQLCODE = ZERO                                       12739600
WEEK53**         THE REPLACED STORE TOTALS WILL NOW BE ADDED TO THE     12739700
WEEK53**         NEW STORE'S "THIS YEAR" TOTALS BY PARA 2200-.          12739800
WEEK53           CONTINUE                                               12739900
WEEK53                                                                  12740000
WEEK53        WHEN SQLCODE = PC-ROW-NOT-FOUND                           12741000
REPL53        WHEN SQLCODE = PC-NULL-RETURNED                           12741199
WEEK53**         THE NEW STORE'S "THIS YEAR" TOTALS WILL BE USED        12741200
WEEK53           MOVE ZEROES TO PV-53-WEEK-COMP-MTD-DOL-AMT             12741300
WEEK53                          PV-53-WEEK-COMP-YTD-DOL-AMT             12741400
WEEK53                                                                  12741500
WEEK53        WHEN OTHER                                                12741600
WEEK53           MOVE SQLCODE                    TO PV-SQLCODE          12741700
WEEK53           MOVE 'DFT_DLY_FLSH_SUM'         TO PV-TABLE-NAME       12741800
WEEK53           MOVE '2610-GET-WEEK-53-MTD-YTD-COMP'                   12741900
WEEK53                                           TO PV-PARAGRAPH-NAME   12742000
WEEK53           MOVE XST00001-LOC-NBR           TO PV-DISPLAY-STORE    12742100
WEEK53           STRING 'STORE ' PV-DISPLAY-STORE                       12742200
WEEK53                  ' SINCE DATE ' PV-53-WEEK-TY-COMP-DATE          12742300
WEEK53                  ' RECEIVED SQLCODE = '                          12742400
WEEK53                   PV-SQLCODE DELIMITED BY SIZE INTO              12742500
WEEK53                   PV-OPERATION-MSG                               12742600
WEEK53           END-STRING                                             12742700
WEEK53           PERFORM 8000-DB2-ABEND                                 12742800
WEEK53     END-EVALUATE.                                                12742900
WEEK53                                                                  12743000
127400                                                                  12743100
127500******************************************************************12744000
127600* FETCH LAST YEAR'S DAILY SALES AND LOAD THEM TO THE STORE, REGN  12745000
127700* AND TERR TABLES.                                                12746000
127800******************************************************************12747000
127900 3000-PROCESS-LY-DAILY-SALES.                                     12748000
128000                                                                  12749000
128100     SET PS-NOT-END-OF-SALES         TO TRUE.                     12750000
128200                                                                  12760000
128300     PERFORM 3100-OPEN-LY-SALES-CURSOR.                           12770000
128400                                                                  12780000
128500     PERFORM 3200-FETCH-LY-SALES-CURSOR                           12790000
128600        UNTIL PS-END-OF-SALES.                                    12800000
128700                                                                  12810000
128800     PERFORM 3300-CLOSE-LY-SALES-CURSOR.                          12820000
128900                                                                  12830000
129000                                                                  12840000
129100******************************************************************12850000
129200* OPEN SALES CURSOR FOR LAST YEAR                                 12860000
129300******************************************************************12870000
129400 3100-OPEN-LY-SALES-CURSOR.                                       12880000
129500                                                                  12890000
129600     EXEC SQL                                                     12900000
129700          OPEN LY-SALES-CURSOR                                    12910000
129800     END-EXEC.                                                    12920000
129900                                                                  12930000
130000     IF SQLCODE NOT EQUAL ZERO                                    12940000
130100        MOVE SQLCODE                     TO PV-SQLCODE            12950000
130200        MOVE 'DFT_ML_FINCL_SUM'          TO PV-TABLE-NAME         12960000
130300        MOVE '3100-OPEN-LY-SALES-CURSOR' TO PV-PARAGRAPH-NAME     12970000
130400        STRING 'ERROR ON OPEN OF SALES CURSOR - SQLCODE= '        12980000
130500                PV-SQLCODE DELIMITED BY SIZE INTO                 12990000
130600                PV-OPERATION-MSG                                  13000000
130700        END-STRING                                                13010000
130800        PERFORM 8000-DB2-ABEND                                    13020000
130900     END-IF.                                                      13030000
131000                                                                  13040000
131100                                                                  13050000
131200******************************************************************13060000
131300* FETCH SALES CURSOR FOR LAST YEAR.                               13070000
131400******************************************************************13080000
131500 3200-FETCH-LY-SALES-CURSOR.                                      13090000
131600                                                                  13100000
131700     EXEC SQL                                                     13110000
131800         FETCH LY-SALES-CURSOR                                    13120000
131900          INTO :DFT00002-STR-NBR                                  13130000
132000             , :XST00001-OPN-DTE                                  13140000
132100             , :DFT00002-DLY-DOL-AMT                              13150000
132200             , :DFT00002-MTD-DOL-AMT                              13160000
132300             , :DFT00002-YTD-DOL-AMT                              13170000
132400     END-EXEC.                                                    13180000
132500                                                                  13190000
132600     EVALUATE TRUE                                                13200000
132700        WHEN SQLCODE = ZERO                                       13210000
132800**         IF THE STORE OPENED DURING THE LAST FISCAL YEAR, THEN  13220000
132900**         A CHECK IS REQUIRED TO SEE IF IT REPLACED ANOTHER      13230000
133000**         STORE.  IF IT DID, THEN THE 2 STORES DLY, MTD AND YTD  13240000
133100**         SALES FIGURES MUST BE ADDED TOGETHER.                  13250000
REPL53***   REPLACED STORES WILL BE HANDLED FROM PARA 2200-             13251099
REPL53**         IF  XST00001-OPN-DTE  > PV-LY-FISCAL-BEGIN-DATE        13260099
REPL53**         AND XST00001-OPN-DTE <= PV-TY-FISCAL-BEGIN-DATE        13270099
REPL53**             MOVE DFT00002-DLY-DOL-AMT   TO PV-SAVE-DLY-DOL-AMT 13280099
REPL53**             MOVE DFT00002-MTD-DOL-AMT   TO PV-SAVE-MTD-DOL-AMT 13290099
REPL53**             MOVE DFT00002-YTD-DOL-AMT TO PV-SAVE-YTD-DOL-AMT   13300099
REPL53**             MOVE ZEROES              TO DFT00002-DLY-DOL-AMT   13310099
REPL53**                                         DFT00002-MTD-DOL-AMT   13320099
REPL53**                                         DFT00002-YTD-DOL-AMT   13330099
REPL53**             PERFORM 3500-CHECK-FOR-REPLACED-STORE              13340099
REPL53**             ADD PV-SAVE-DLY-DOL-AMT  TO DFT00002-DLY-DOL-AMT   13350099
REPL53**             ADD PV-SAVE-MTD-DOL-AMT  TO DFT00002-MTD-DOL-AMT   13360099
REPL53**             ADD PV-SAVE-YTD-DOL-AMT  TO DFT00002-YTD-DOL-AMT   13370099
REPL53**         END-IF                                                 13380099
134500           PERFORM 6100-ADD-TO-LAST-YEARS-SALES                   13390000
134600                                                                  13400000
134700        WHEN SQLCODE = PC-ROW-NOT-FOUND                           13410000
134800           SET PS-END-OF-SALES TO TRUE                            13420000
134900                                                                  13430000
135000        WHEN OTHER                                                13440000
135100           MOVE SQLCODE                      TO PV-SQLCODE        13450000
135200           MOVE 'DFT_ML_FINCL_SUM'           TO PV-TABLE-NAME     13460000
135300           MOVE '3200-FETCH-LY-SALES-CURSOR' TO PV-PARAGRAPH-NAME 13470000
135400           STRING 'ERROR ON FETCH OF SALES CURSOR - SQLCODE= '    13480000
135500                   PV-SQLCODE DELIMITED BY SIZE INTO              13490000
135600                   PV-OPERATION-MSG                               13500000
135700           END-STRING                                             13510000
135800           PERFORM 8000-DB2-ABEND                                 13520000
135900     END-EVALUATE.                                                13530000
136000                                                                  13540000
136100                                                                  13550000
136200******************************************************************13560000
136300* CLOSE SALES CURSOR FOR LAST YEAR                                13570000
136400******************************************************************13580000
136500 3300-CLOSE-LY-SALES-CURSOR.                                      13590000
136600                                                                  13600000
136700     EXEC SQL                                                     13610000
136800          CLOSE LY-SALES-CURSOR                                   13620000
136900     END-EXEC.                                                    13630000
137000                                                                  13640000
137100     IF SQLCODE NOT EQUAL ZERO                                    13650000
137200        MOVE SQLCODE                      TO PV-SQLCODE           13660000
137300        MOVE 'DFT_ML_FINCL_SUM'           TO PV-TABLE-NAME        13670000
137400        MOVE '3300-CLOSE-LY-SALES-CURSOR' TO PV-PARAGRAPH-NAME    13680000
137500        STRING 'ERROR ON CLOSE OF SALES CURSOR - SQLCODE= '       13690000
137600                PV-SQLCODE DELIMITED BY SIZE INTO                 13700000
137700                PV-OPERATION-MSG                                  13710000
137800        END-STRING                                                13720000
137900        PERFORM 8000-DB2-ABEND                                    13730000
138000     END-IF.                                                      13740000
138100                                                                  13750000
138200                                                                  13760000
138300******************************************************************13770000
138400* IF A STORE OPENED DURING THE LAST FISCAL YEAR, CHECK TO SEE IF  13780000
138500* IT REPLACED A DIFFERENT STORE.                                  13790000
138600* IF IT DID, GET THE REPLACED STORE'S SALES FROM LAST YEAR.       13800000
138700******************************************************************13810000
138800 3500-CHECK-FOR-REPLACED-STORE.                                   13820000
138900                                                                  13830000
139000     EXEC SQL                                                     13840000
139100         SELECT  LOC_NBR                                          13850000
139200           INTO :XST00001-LOC-NBR                                 13860000
139300           FROM  XST_LOC                                          13870000
139400          WHERE  REPLT_STR_NBR  = :DFT00002-STR-NBR               13880000
139500            AND  CLO_DTE       >= :PV-LY-FISCAL-BEGIN-DATE        13890000
139600                                                                  13900000
139700       WITH UR                                                    13910000
139800     END-EXEC.                                                    13920000
139900                                                                  13930000
140000     EVALUATE TRUE                                                13940000
140100        WHEN SQLCODE = ZERO                                       13950000
140200           PERFORM 3600-GET-REPLACED-STORE-SALES                  13960000
REPL53           PERFORM 6100-ADD-TO-LAST-YEARS-SALES                   13961099
159400           PERFORM 4600-GET-REPLACED-STORE-TOTAL                  13962099
REPL53           PERFORM 6200-ADD-TO-LAST-YEARS-TOTALS                  13963099
140300                                                                  13970000
140400        WHEN SQLCODE = PC-ROW-NOT-FOUND                           13980000
140500           CONTINUE                                               13990000
140600                                                                  14000000
140700        WHEN OTHER                                                14010000
140800           MOVE SQLCODE                    TO PV-SQLCODE          14020000
140900           MOVE 'XST_LOC'                  TO PV-TABLE-NAME       14030000
141000           MOVE '3500-CHECK-FOR-REPLACED-STORE'                   14040000
141100                                           TO PV-PARAGRAPH-NAME   14050000
141200           MOVE DFT00002-STR-NBR           TO PV-DISPLAY-STORE    14060000
141300           STRING 'STORE ' PV-DISPLAY-STORE                       14070000
141400                  ' SINCE DATE ' PV-LY-FISCAL-BEGIN-DATE          14080000
141500                  ' RECEIVED SQLCODE = '                          14090000
141600                   PV-SQLCODE DELIMITED BY SIZE INTO              14100000
141700                   PV-OPERATION-MSG                               14110000
141800           END-STRING                                             14120000
141900           PERFORM 8000-DB2-ABEND                                 14130000
142000     END-EVALUATE.                                                14140000
142100                                                                  14150000
142200                                                                  14160000
142300******************************************************************14170000
142400* A STORE WAS REPLACED BY ANOTHER.                                14180000
142500* GET THE REPLACED STORE'S SALES FROM LAST YEAR TO REPORT UNDER   14190000
142600* THE NEW STORE.                                                  14200000
142700******************************************************************14210000
142800 3600-GET-REPLACED-STORE-SALES.                                   14220000
142900                                                                  14230000
143000     EXEC SQL                                                     14240000
143100         SELECT  SUM(DLY_DOL_AMT)                                 14250000
143200               , SUM(MTD_DOL_AMT)                                 14260000
143300               , SUM(YTD_DOL_AMT)                                 14270000
143400           INTO :DFT00002-DLY-DOL-AMT                             14280000
143500              , :DFT00002-MTD-DOL-AMT                             14290000
143600              , :DFT00002-YTD-DOL-AMT                             14300000
143700           FROM  DFT_ML_FINCL_SUM                                 14310000
143800          WHERE  STR_NBR         = :XST00001-LOC-NBR              14320000
143900            AND  SLS_DTE         = :PV-LY-SAME-FISCAL-DATE        14330000
144000       WITH UR                                                    14340000
144100     END-EXEC.                                                    14350000
144200                                                                  14360000
144300     EVALUATE TRUE                                                14370000
144400        WHEN SQLCODE = ZERO                                       14380000
144500           DISPLAY 'PAR 3600- FOUND REPLACEMENT FOR '             14390000
144600                   'STORE ' XST00001-LOC-NBR                      14400000
144700**         THE REPLACED STORE TOTALS WILL NOW BE ADDED TO THE     14410000
144800**         NEW STORE'S "LAST YEAR" BUCKETS BY PARA 3200-.         14420000
144900           CONTINUE                                               14430000
145000                                                                  14440000
145100        WHEN SQLCODE = PC-ROW-NOT-FOUND                           14450000
REPL53        WHEN SQLCODE = PC-NULL-RETURNED                           14451099
145200**         THE NEW STORE'S "LAST YEAR" TOTALS WILL BE USED        14460000
145300           MOVE ZEROES        TO DFT00002-DLY-DOL-AMT             14470000
145400                                 DFT00002-MTD-DOL-AMT             14480000
145500                                 DFT00002-YTD-DOL-AMT             14490000
145600                                                                  14500000
145700        WHEN OTHER                                                14510000
145800           MOVE SQLCODE                    TO PV-SQLCODE          14520000
145900           MOVE 'DFT_ML_FINCL_SUM'         TO PV-TABLE-NAME       14530000
146000           MOVE '3600-GET-REPLACED-STORE-SALES'                   14540000
146100                                           TO PV-PARAGRAPH-NAME   14550000
146200           MOVE XST00001-LOC-NBR           TO PV-DISPLAY-STORE    14560000
146300           STRING 'STORE ' PV-DISPLAY-STORE                       14570000
146400                  ' SINCE DATE ' PV-LY-SAME-FISCAL-DATE           14580000
146500                  ' RECEIVED SQLCODE = '                          14590000
146600                   PV-SQLCODE DELIMITED BY SIZE INTO              14600000
146700                   PV-OPERATION-MSG                               14610000
146800           END-STRING                                             14620000
146900           PERFORM 8000-DB2-ABEND                                 14630000
147000     END-EVALUATE.                                                14640000
147100                                                                  14650000
147200                                                                  14660000
147300******************************************************************14670000
147400* FETCH ALL OF LAST YEAR'S TOTAL SALES AND LOAD THEM INTO THE     14680000
147500* STORE, REGN AND TERR TABLES TO BE SORTED ON.                    14690000
147600******************************************************************14700000
147700 4000-PROCESS-LY-TOTAL-SALES.                                     14710000
147800                                                                  14720000
147900     SET PS-NOT-END-OF-SALES-TOTALS  TO TRUE.                     14730000
148000                                                                  14740000
148100     PERFORM 4100-OPEN-SALES-TOTAL-CURSOR.                        14750000
148200                                                                  14760000
148300     PERFORM 4200-FETCH-SALES-TOTAL-CURSOR                        14770000
148400        UNTIL PS-END-OF-SALES-TOTALS.                             14780000
148500                                                                  14790000
148600     PERFORM 4300-CLOSE-SALES-TOTAL-CURSOR.                       14800000
148700                                                                  14810000
148800                                                                  14820000
148900******************************************************************14830000
149000* OPEN SALES TOTAL CURSOR                                         14840000
149100******************************************************************14850000
149200 4100-OPEN-SALES-TOTAL-CURSOR.                                    14860000
149300                                                                  14870000
149400     EXEC SQL                                                     14880000
149500          OPEN SALES-TOTAL-CURSOR                                 14890000
149600     END-EXEC.                                                    14900000
149700                                                                  14910000
149800     IF SQLCODE NOT EQUAL ZERO                                    14920000
149900        MOVE SQLCODE                  TO PV-SQLCODE               14930000
150000        MOVE 'DFT_ML_FINCL_SUM'       TO PV-TABLE-NAME            14940000
150100        MOVE '4100-OPEN-SALES-TOTAL-CURSOR' TO PV-PARAGRAPH-NAME  14950000
150200        STRING 'ERROR ON OPEN OF SALES TOTAL CURSOR - SQLCODE= '  14960000
150300                PV-SQLCODE DELIMITED BY SIZE INTO                 14970000
150400                PV-OPERATION-MSG                                  14980000
150500        END-STRING                                                14990000
150600        PERFORM 8000-DB2-ABEND                                    15000000
150700     END-IF.                                                      15010000
150800                                                                  15020000
150900                                                                  15030000
151000******************************************************************15040000
151100* FETCH SALES TOTAL CURSOR                                        15050000
151200******************************************************************15060000
151300 4200-FETCH-SALES-TOTAL-CURSOR.                                   15070000
151400                                                                  15080000
151500     EXEC SQL                                                     15090000
151600         FETCH SALES-TOTAL-CURSOR                                 15100000
151700          INTO :DFT00002-STR-NBR                                  15110000
151800             , :XST00001-OPN-DTE                                  15120000
151900             , :DFT00002-YTD-DOL-AMT                              15130000
152000     END-EXEC.                                                    15140000
152100                                                                  15150000
152200     EVALUATE TRUE                                                15160000
152300        WHEN SQLCODE = ZERO                                       15170000
152400**         IF THE STORE OPENED DURING THE LAST FISCAL YEAR, THEN  15180000
152500**         A CHECK IS REQUIRED TO SEE IF IT REPLACED ANOTHER      15190000
152600**         STORE.  IF IT DID, THEN THE 2 STORES YTD SALES FIGURES 15200000
152700**         MUST BE ADDED TOGETHER.                                15210000
REPL53***   REPLACED STORES WILL BE HANDLED FROM PARA 2200-             15211099
REPL53**         IF  XST00001-OPN-DTE  > PV-LY-FISCAL-BEGIN-DATE        15220099
REPL53**         AND XST00001-OPN-DTE <= PV-TY-FISCAL-BEGIN-DATE        15230099
REPL53**             MOVE DFT00002-YTD-DOL-AMT TO PV-SAVE-YTD-DOL-AMT   15240099
REPL53**             MOVE ZEROES               TO DFT00002-YTD-DOL-AMT  15250099
REPL53**             PERFORM 4500-CHECK-FOR-REPLACED-STORE              15260099
REPL53**             ADD PV-SAVE-YTD-DOL-AMT   TO DFT00002-YTD-DOL-AMT  15270099
REPL53**         END-IF                                                 15280099
153500           PERFORM 6200-ADD-TO-LAST-YEARS-TOTALS                  15290000
153600                                                                  15300000
153700        WHEN SQLCODE = PC-ROW-NOT-FOUND                           15310000
153800           SET PS-END-OF-SALES-TOTALS TO TRUE                     15320000
153900                                                                  15330000
154000        WHEN OTHER                                                15340000
154100           MOVE SQLCODE                   TO PV-SQLCODE           15350000
154200           MOVE 'DFT_ML_FINCL_SUM'        TO PV-TABLE-NAME        15360000
154300           MOVE '4200-FETCH-SALES-TOTAL-CURSOR'                   15370000
154400                                          TO PV-PARAGRAPH-NAME    15380000
154500           STRING 'ERROR ON FETCH OF SALES TOTAL CURSOR - '       15390000
154600                  'SQLCODE= ' PV-SQLCODE                          15400000
154700               DELIMITED BY SIZE INTO PV-OPERATION-MSG            15410000
154800           END-STRING                                             15420000
154900           PERFORM 8000-DB2-ABEND                                 15430000
155000     END-EVALUATE.                                                15440000
155100                                                                  15450000
155200                                                                  15460000
155300******************************************************************15470000
155400* CLOSE SALES TOTAL CURSOR                                        15480000
155500******************************************************************15490000
155600 4300-CLOSE-SALES-TOTAL-CURSOR.                                   15500000
155700                                                                  15510000
155800     EXEC SQL                                                     15520000
155900          CLOSE SALES-TOTAL-CURSOR                                15530000
156000     END-EXEC.                                                    15540000
156100                                                                  15550000
156200     IF SQLCODE NOT EQUAL ZERO                                    15560000
156300        MOVE SQLCODE                   TO PV-SQLCODE              15570000
156400        MOVE 'DFT_ML_FINCL_SUM'        TO PV-TABLE-NAME           15580000
156500        MOVE '4300-CLOSE-SALES-TOTAL-CURSOR' TO PV-PARAGRAPH-NAME 15590000
156600        STRING 'ERROR ON CLOSE OF SALES TOTAL CURSOR - SQLCODE= ' 15600000
156700                PV-SQLCODE DELIMITED BY SIZE INTO                 15610000
156800                PV-OPERATION-MSG                                  15620000
156900        END-STRING                                                15630000
157000        PERFORM 8000-DB2-ABEND                                    15640000
157100     END-IF.                                                      15650000
157200                                                                  15660000
157300                                                                  15670000
REPL53******************************************************************15680099
REPL53* IF A STORE WAS OPENED DURING THE PREVIOUS YEAR'S FISCAL YEAR,   15690099
REPL53* CHECK TO SEE IF IT REPLACED A DIFFERENT STORE.                  15700099
REPL53* IF IT DID, GET THE REPLACED STORE'S TOTAL SALES FROM LAST YEAR. 15710099
REPL53* THEY NEED TO BE ADDED TO THE NEW STORE'S TOTAL SALES.           15720099
REPL53******************************************************************15730099
REPL53*4500-CHECK-FOR-REPLACED-STORE.                                   15740099
REPL53*                                                                 15750099
REPL53*    EXEC SQL                                                     15760099
REPL53*        SELECT  LOC_NBR                                          15770099
REPL53*          INTO :XST00001-LOC-NBR                                 15780099
REPL53*          FROM  XST_LOC                                          15790099
REPL53*         WHERE  REPLT_STR_NBR  = :DFT00002-STR-NBR               15800099
REPL53*           AND  CLO_DTE       >= :DTATTR-FSCL-YR-BEG-DTE         15810099
REPL53*      WITH UR                                                    15830099
REPL53*    END-EXEC.                                                    15840099
REPL53*                                                                 15850099
REPL53*    EVALUATE TRUE                                                15860099
REPL53*       WHEN SQLCODE = ZERO                                       15870099
REPL53*          PERFORM 4600-GET-REPLACED-STORE-TOTAL                  15880099
REPL53*                                                                 15890099
REPL53*       WHEN SQLCODE = PC-ROW-NOT-FOUND                           15900099
REPL53*          CONTINUE                                               15910099
REPL53*                                                                 15920099
REPL53*       WHEN OTHER                                                15930099
REPL53*          MOVE SQLCODE                    TO PV-SQLCODE          15940099
REPL53*          MOVE 'XST_LOC'                  TO PV-TABLE-NAME       15950099
REPL53*          MOVE '4500-CHECK-FOR-REPLACED-STORE'                   15960099
REPL53*                                          TO PV-PARAGRAPH-NAME   15970099
REPL53*          MOVE DFT00002-STR-NBR           TO PV-DISPLAY-STORE    15980099
REPL53*          STRING 'STORE ' PV-DISPLAY-STORE                       15990099
REPL53*                 ' SINCE DATE ' DTATTR-FSCL-YR-BEG-DTE           16000099
REPL53*                 ' RECEIVED SQLCODE = '                          16010099
REPL53*                  PV-SQLCODE DELIMITED BY SIZE INTO              16020099
REPL53*                  PV-OPERATION-MSG                               16030099
REPL53*          END-STRING                                             16040099
REPL53*          PERFORM 8000-DB2-ABEND                                 16050099
REPL53*    END-EVALUATE.                                                16060099
REPL53*                                                                 16070099
161400                                                                  16080000
161500******************************************************************16090000
161600* A STORE WAS REPLACED BY ANOTHER.                                16100000
161700* GET THE REPLACED STORE'S SALES TOTAL FROM LAST YEAR TO ADD      16110000
161800* TO THE NEW STORE FOR SORTING PURPOSES.                          16120000
161900******************************************************************16130000
162000 4600-GET-REPLACED-STORE-TOTAL.                                   16140000
162100                                                                  16150000
162200     EXEC SQL                                                     16160000
162300         SELECT  SUM(YTD_DOL_AMT)                                 16170000
162400           INTO :DFT00002-YTD-DOL-AMT                             16180000
162500           FROM  DFT_ML_FINCL_SUM                                 16190000
162600          WHERE  STR_NBR         = :XST00001-LOC-NBR              16200000
162700            AND  SLS_DTE         = :PV-LY-FISCAL-END-DATE         16210000
162800       WITH UR                                                    16220000
162900     END-EXEC.                                                    16230000
163000                                                                  16240000
163100     EVALUATE TRUE                                                16250000
163200        WHEN SQLCODE = ZERO                                       16260000
163300           DISPLAY 'PAR 4600- FOUND REPLACEMENT FOR '             16270000
163400                   'STORE ' XST00001-LOC-NBR                      16280000
163500**         THE REPLACED STORE'S TOTAL WILL NOW BE ADDED INTO THE  16290000
163600**         NEW STORE'S TOTAL BY PARA 4200-.                       16300000
163700           CONTINUE                                               16310000
163800                                                                  16320000
163900        WHEN SQLCODE = PC-ROW-NOT-FOUND                           16330000
REPL53        WHEN SQLCODE = PC-NULL-RETURNED                           16331099
164000           MOVE ZEROES           TO DFT00002-YTD-DOL-AMT          16340000
164100                                                                  16350000
164200        WHEN OTHER                                                16360000
164300           MOVE SQLCODE                    TO PV-SQLCODE          16370000
164400           MOVE 'DFT_ML_FINCL_SUM'         TO PV-TABLE-NAME       16380000
164500           MOVE '4600-GET-REPLACED-STORE-TOTAL'                   16390000
164600                                           TO PV-PARAGRAPH-NAME   16400000
164700           MOVE XST00001-LOC-NBR           TO PV-DISPLAY-STORE    16410000
164800           STRING 'STORE ' PV-DISPLAY-STORE                       16420000
164900                  ' SINCE DATE ' PV-LY-FISCAL-END-DATE            16430000
165000                  ' RECEIVED SQLCODE = '                          16440000
165100                   PV-SQLCODE DELIMITED BY SIZE INTO              16450000
165200                   PV-OPERATION-MSG                               16460000
165300           END-STRING                                             16470000
165400           PERFORM 8000-DB2-ABEND                                 16480000
165500     END-EVALUATE.                                                16490000
165600                                                                  16500000
165700                                                                  16510000
165800                                                                  16520000
165900******************************************************************16530000
166000* ADD DAILY FLASH SALES TO THIS YEAR'S STORE, REGN AND TERR       16540000
166100* TOTALS.                                                         16550000
166200******************************************************************16560000
166300 6000-ADD-TO-THIS-YEARS-SALES.                                    16570000
166400                                                                  16580000
166500     MOVE DFT00000-STR-NBR        TO PA-STORE-SUB.                16590000
166600     ADD DFT00000-DLY-DOL-AMT                                     16600000
166700                       TO PA-STORE-TY-DAILY-SALES (PA-STORE-SUB)  16610000
166800                          PV-COMPANY-TY-DLY-AMT.                  16620000
166900     ADD DFT00000-MTD-DOL-AMT                                     16630000
167000                       TO PA-STORE-TY-MTD-SALES (PA-STORE-SUB)    16640000
167100                          PV-COMPANY-TY-MTD-AMT.                  16650000
167200     ADD DFT00000-YTD-DOL-AMT                                     16660000
167300                       TO PA-STORE-TY-YTD-SALES (PA-STORE-SUB)    16670000
167400                          PV-COMPANY-TY-YTD-AMT.                  16680000
167500                                                                  16690000
167600     MOVE PA-STORE-DIST (PA-STORE-SUB)  TO PA-DIST-SUB.           16700072
169000     ADD DFT00000-DLY-DOL-AMT                                     16840000
166700                       TO PA-DIST-TY-DAILY-SALES (PA-DIST-SUB).   16851071
169200     ADD DFT00000-MTD-DOL-AMT                                     16860000
169300                       TO PA-DIST-TY-MTD-SALES (PA-DIST-SUB).     16870071
169400     ADD DFT00000-YTD-DOL-AMT                                     16880000
169500                       TO PA-DIST-TY-YTD-SALES (PA-DIST-SUB).     16890071
169600                                                                  16900000
167600     MOVE PA-STORE-REGN (PA-STORE-SUB) TO PA-REGN-SUB.            16900172
169000     ADD DFT00000-DLY-DOL-AMT                                     16909636
169100                       TO PA-REGN-TY-DAILY-SALES (PA-REGN-SUB).   16909771
169200     ADD DFT00000-MTD-DOL-AMT                                     16909836
169300                       TO PA-REGN-TY-MTD-SALES (PA-REGN-SUB).     16909971
169400     ADD DFT00000-YTD-DOL-AMT                                     16910036
169500                       TO PA-REGN-TY-YTD-SALES (PA-REGN-SUB).     16910171
169600                                                                  16910236
169700     MOVE PA-STORE-TERR (PA-STORE-SUB) TO PA-TERR-SUB.            16930086
171000     ADD DFT00000-DLY-DOL-AMT                                     17080086
171100                       TO PA-TERR-TY-DAILY-SALES (PA-TERR-SUB).   17090086
171200     ADD DFT00000-MTD-DOL-AMT                                     17100086
171300                       TO PA-TERR-TY-MTD-SALES (PA-TERR-SUB).     17110086
171400     ADD DFT00000-YTD-DOL-AMT                                     17120086
171500                       TO PA-TERR-TY-YTD-SALES (PA-TERR-SUB).     17130086
171600                                                                  17150000
171700**   ADD TO COMP TOTALS AFTER CHECKING COMP DATES.                17160000
171800**   DAILY AND MONTHLY COMP USE THE SAME DATE.                    17170000
WEEK53**   SPECIAL LOGIC IS NEEDED FOR WEEK 53                          17180000
WEEK53     IF PS-NOT-IN-WEEK-53                                         17190000
171900         IF PV-RUN-DATE-CCYY-MM-DD  >=                            17191000
172000            PA-STORE-COMP-MONTH-DATE (PA-STORE-SUB)               17192000
172100              ADD DFT00000-DLY-DOL-AMT                            17193000
172200               TO PA-STORE-TY-COMP-DLY-SALES (PA-STORE-SUB)       17194000
172300                  PA-DIST-TY-COMP-DLY-SALES (PA-DIST-SUB)         17195071
172300                  PA-REGN-TY-COMP-DLY-SALES (PA-REGN-SUB)         17195171
172500                  PV-COMPANY-TY-COMP-DLY-AMT                      17196000
172600              ADD DFT00000-MTD-DOL-AMT                            17197000
172700               TO PA-STORE-TY-COMP-MTD-SALES (PA-STORE-SUB)       17198000
172800                  PA-DIST-TY-COMP-MTD-SALES (PA-DIST-SUB)         17199071
172800                  PA-REGN-TY-COMP-MTD-SALES (PA-REGN-SUB)         17199171
173000                  PV-COMPANY-TY-COMP-MTD-AMT                      17200000
172100              ADD DFT00000-DLY-DOL-AMT                            17230087
172400                   TO PA-TERR-TY-COMP-DLY-SALES (PA-TERR-SUB)     17240071
172600              ADD DFT00000-MTD-DOL-AMT                            17250087
172900                   TO PA-TERR-TY-COMP-MTD-SALES (PA-TERR-SUB)     17260071
173100         END-IF                                                   17280000
WEEK53     ELSE                                                         17290000
WEEK53**       IN WEEK 53                                               17300000
171900         IF PV-RUN-DATE-CCYY-MM-DD  >=                            17310000
172000            PA-STORE-COMP-MONTH-DATE (PA-STORE-SUB)               17310100
WEEK53**           CURRENT DATE WILL BE USED FOR DAILY COMP EVEN DURING 17310200
WEEK53**           WEEK 53.                                             17310300
WEEK53             ADD DFT00000-DLY-DOL-AMT                             17310400
WEEK53              TO PA-STORE-TY-COMP-DLY-SALES (PA-STORE-SUB)        17310500
WEEK53                 PA-DIST-TY-COMP-DLY-SALES (PA-DIST-SUB)          17310671
WEEK53                 PA-REGN-TY-COMP-DLY-SALES (PA-REGN-SUB)          17310771
WEEK53                 PV-COMPANY-TY-COMP-DLY-AMT                       17310834
WEEK53             ADD DFT00000-DLY-DOL-AMT                             17311187
WEEK53                  TO PA-TERR-TY-COMP-DLY-SALES (PA-TERR-SUB)      17311271
WEEK53         END-IF                                                   17311434
WEEK53**       DURING WEEK 53 - COMPARE TO END OF WEEK 52 FOR MTD       17311534
REPL53**       IF PV-53-WEEK-TY-COMP-DATE >=                            17311699
REPL53         IF PV-RUN-DATE-CCYY-MM-DD  >=                            17311799
WEEK53            PA-STORE-COMP-MONTH-DATE (PA-STORE-SUB)               17311834
WEEK53              ADD PV-53-WEEK-COMP-MTD-DOL-AMT                     17311934
WEEK53               TO PA-STORE-TY-COMP-MTD-SALES (PA-STORE-SUB)       17312034
WEEK53                  PA-DIST-TY-COMP-MTD-SALES (PA-DIST-SUB)         17312171
WEEK53                  PA-REGN-TY-COMP-MTD-SALES (PA-REGN-SUB)         17312271
WEEK53                  PV-COMPANY-TY-COMP-MTD-AMT                      17312334
WEEK53              ADD PV-53-WEEK-COMP-MTD-DOL-AMT                     17312587
WEEK53                   TO PA-TERR-TY-COMP-MTD-SALES (PA-TERR-SUB)     17312671
WEEK53         END-IF                                                   17312834
WEEK53     END-IF.                                                      17312934
173200                                                                  17313034
WEEK53     IF PS-NOT-IN-WEEK-53                                         17313134
173300         IF PV-RUN-DATE-CCYY-MM-DD  >=                            17313234
173400            PA-STORE-COMP-YEAR-DATE  (PA-STORE-SUB)               17314000
173500              ADD DFT00000-YTD-DOL-AMT                            17315000
173600               TO PA-STORE-TY-COMP-YTD-SALES (PA-STORE-SUB)       17316000
173700                  PA-DIST-TY-COMP-YTD-SALES (PA-DIST-SUB)         17317071
173700                  PA-REGN-TY-COMP-YTD-SALES (PA-REGN-SUB)         17317171
173900                  PV-COMPANY-TY-COMP-YTD-AMT                      17318000
173500              ADD DFT00000-YTD-DOL-AMT                            17330087
173800                   TO PA-TERR-TY-COMP-YTD-SALES (PA-TERR-SUB)     17340071
174000         END-IF                                                   17360000
WEEK53     ELSE                                                         17370000
WEEK53**       DURING WEEK 53 - COMPARE TO END OF WEEK 52               17380000
REPL53**       IF PV-53-WEEK-TY-COMP-DATE >=                            17390099
REPL53         IF PV-RUN-DATE-CCYY-MM-DD  >=                            17391099
WEEK53            PA-STORE-COMP-YEAR-DATE  (PA-STORE-SUB)               17400000
WEEK53              ADD PV-53-WEEK-COMP-YTD-DOL-AMT                     17400100
WEEK53               TO PA-STORE-TY-COMP-YTD-SALES (PA-STORE-SUB)       17400200
WEEK53                  PA-DIST-TY-COMP-YTD-SALES (PA-DIST-SUB)         17400371
WEEK53                  PA-REGN-TY-COMP-YTD-SALES (PA-REGN-SUB)         17400471
WEEK53                  PV-COMPANY-TY-COMP-YTD-AMT                      17400534
WEEK53**                DON'T INCREMENT TERR TOTALS FOR ECOM            17400734
WEEK53              ADD PV-53-WEEK-COMP-YTD-DOL-AMT                     17400887
WEEK53                   TO PA-TERR-TY-COMP-YTD-SALES (PA-TERR-SUB)     17400971
WEEK53         END-IF                                                   17401134
174000     END-IF.                                                      17402000
174100                                                                  17403000
174200                                                                  17404000
174300******************************************************************17405000
174400* ADD DAILY FLASH SALES TO LAST YEAR'S STORE, REGN, DIST AND TERR 17406052
174500* TOTALS.                                                         17407000
174600******************************************************************17408000
174700 6100-ADD-TO-LAST-YEARS-SALES.                                    17409000
174800                                                                  17410000
174900     MOVE DFT00002-STR-NBR     TO PA-STORE-SUB.                   17420000
175000     ADD DFT00002-DLY-DOL-AMT                                     17430000
175100                       TO PA-STORE-LY-DAILY-SALES (PA-STORE-SUB)  17440000
175200                          PV-COMPANY-LY-DLY-AMT.                  17450000
175300     ADD DFT00002-MTD-DOL-AMT                                     17460000
175400                       TO PA-STORE-LY-MTD-SALES (PA-STORE-SUB)    17470000
175500                          PV-COMPANY-LY-MTD-AMT.                  17480000
175600     ADD DFT00002-YTD-DOL-AMT                                     17490000
175700                       TO PA-STORE-LY-YTD-SALES (PA-STORE-SUB)    17500000
175800                          PV-COMPANY-LY-YTD-AMT.                  17510000
175900                                                                  17520000
176000     MOVE PA-STORE-DIST (PA-STORE-SUB) TO PA-DIST-SUB.            17530071
177400     ADD DFT00002-DLY-DOL-AMT                                     17670000
177500                       TO PA-DIST-LY-DAILY-SALES (PA-DIST-SUB).   17680071
177600     ADD DFT00002-MTD-DOL-AMT                                     17690000
177700                       TO PA-DIST-LY-MTD-SALES (PA-DIST-SUB).     17700071
177800     ADD DFT00002-YTD-DOL-AMT                                     17710000
177900                       TO PA-DIST-LY-YTD-SALES (PA-DIST-SUB).     17720071
178000                                                                  17730000
176000     MOVE PA-STORE-REGN (PA-STORE-SUB) TO PA-REGN-SUB.            17731071
177400     ADD DFT00002-DLY-DOL-AMT                                     17739552
177500                       TO PA-REGN-LY-DAILY-SALES (PA-REGN-SUB).   17739671
177600     ADD DFT00002-MTD-DOL-AMT                                     17739752
177700                       TO PA-REGN-LY-MTD-SALES (PA-REGN-SUB).     17739871
177800     ADD DFT00002-YTD-DOL-AMT                                     17739952
177900                       TO PA-REGN-LY-YTD-SALES (PA-REGN-SUB).     17740071
178000                                                                  17740152
178100     MOVE PA-STORE-TERR (PA-STORE-SUB) TO PA-TERR-SUB             17760087
179400     ADD DFT00002-DLY-DOL-AMT                                     17910087
179500                       TO PA-TERR-LY-DAILY-SALES (PA-TERR-SUB)    17920071
179600     ADD DFT00002-MTD-DOL-AMT                                     17930087
179700                       TO PA-TERR-LY-MTD-SALES (PA-TERR-SUB)      17940071
179800     ADD DFT00002-YTD-DOL-AMT                                     17950087
179900                       TO PA-TERR-LY-YTD-SALES (PA-TERR-SUB)      17960071
180000                                                                  17980000
180100**   ADD TO COMP TOTALS AFTER CHECKING COMP DATES                 17990000
180200     IF PV-RUN-DATE-CCYY-MM-DD  >=                                18000000
180300        PA-STORE-COMP-MONTH-DATE (PA-STORE-SUB)                   18010000
180400          ADD DFT00002-DLY-DOL-AMT                                18020000
180500           TO PA-STORE-LY-COMP-DLY-SALES (PA-STORE-SUB)           18030000
180600              PA-DIST-LY-COMP-DLY-SALES (PA-DIST-SUB)             18040071
180600              PA-REGN-LY-COMP-DLY-SALES (PA-REGN-SUB)             18041071
180800              PV-COMPANY-LY-COMP-DLY-AMT                          18050000
180900          ADD DFT00002-MTD-DOL-AMT                                18060000
181000           TO PA-STORE-LY-COMP-MTD-SALES (PA-STORE-SUB)           18070000
181100              PA-DIST-LY-COMP-MTD-SALES (PA-DIST-SUB)             18080071
181100              PA-REGN-LY-COMP-MTD-SALES (PA-REGN-SUB)             18081071
181300              PV-COMPANY-LY-COMP-MTD-AMT                          18090000
180400          ADD DFT00002-DLY-DOL-AMT                                18120087
180700               TO PA-TERR-LY-COMP-DLY-SALES (PA-TERR-SUB)         18130071
180900          ADD DFT00002-MTD-DOL-AMT                                18131087
181200               TO PA-TERR-LY-COMP-MTD-SALES (PA-TERR-SUB)         18132071
181400     END-IF.                                                      18134000
181500                                                                  18135000
181600     IF PV-RUN-DATE-CCYY-MM-DD  >=                                18136000
181700        PA-STORE-COMP-YEAR-DATE  (PA-STORE-SUB)                   18137000
181800          ADD DFT00002-YTD-DOL-AMT                                18138000
181900           TO PA-STORE-LY-COMP-YTD-SALES (PA-STORE-SUB)           18139000
182000              PA-DIST-LY-COMP-YTD-SALES (PA-DIST-SUB)             18140071
182000              PA-REGN-LY-COMP-YTD-SALES (PA-REGN-SUB)             18141071
182200              PV-COMPANY-LY-COMP-YTD-AMT                          18150000
181800          ADD DFT00002-YTD-DOL-AMT                                18180087
182100               TO PA-TERR-LY-COMP-YTD-SALES (PA-TERR-SUB)         18190071
182300     END-IF.                                                      18210000
182400                                                                  18220000
182500                                                                  18230000
182600******************************************************************18240000
182700* ADD TOTAL DAILY FLASH SALES FROM LAST YEAR TO STORE, DIST, REGN 18250052
182800* AND TERR SORT KEY TOTALS.   THE OUTPUT FILE WILL BE SORTED ON   18260000
182900* THEM IN DESCENDING SEQUENCE.                                    18270000
183000******************************************************************18280000
183100 6200-ADD-TO-LAST-YEARS-TOTALS.                                   18290000
183200                                                                  18300000
183300     MOVE DFT00002-STR-NBR     TO PA-STORE-SUB.                   18310000
REPL53     ADD  DFT00002-YTD-DOL-AMT                                    18320099
183500                       TO PA-STORE-LY-TOTAL-SALES (PA-STORE-SUB). 18330000
183600                                                                  18340000
183700     MOVE PA-STORE-DIST (PA-STORE-SUB) TO PA-DIST-SUB.            18350071
185100     ADD DFT00002-YTD-DOL-AMT                                     18490000
185200                       TO PA-DIST-LY-TOTAL-SALES (PA-DIST-SUB).   18500071
185300                                                                  18510000
183700     MOVE PA-STORE-REGN (PA-STORE-SUB) TO PA-REGN-SUB.            18512071
185100     ADD DFT00002-YTD-DOL-AMT                                     18519652
185200                       TO PA-REGN-LY-TOTAL-SALES (PA-REGN-SUB).   18519771
185300                                                                  18519852
185400     MOVE PA-STORE-TERR (PA-STORE-SUB) TO PA-TERR-SUB.            18540088
186700     ADD DFT00002-YTD-DOL-AMT                                     18600087
186800          TO PA-TERR-LY-TOTAL-SALES (PA-TERR-SUB)                 18610071
186900             PV-COMPANY-LY-TOTAL-SALES.                           18620088
187000                                                                  18640000
187100                                                                  18650000
187200******************************************************************18660000
187300* WRITE CONTENTS OF TERR, REGN, DIST AND STORE TABLES TO THE      18670034
187400* REPORT EXTRACT OUTPUT FILE.  ALSO, WRITE THE COMPANY TOTALS.    18680000
187500******************************************************************18690000
187600 7000-WRITE-REPORT-EXTRACT.                                       18700000
187700                                                                  18710000
187800     INITIALIZE                 WS-OUT-RECORD.                    18720000
187900     MOVE 00               TO WS-OUT-REC-CODE.                    18730026
188000**   MOVING NINES TO THE DIST, REGN, STORE SALES WILL ENSURE THAT 18740052
188100**   THE TERR RECORDS WILL BE SORTED BEFORE THE REGN AND STORE    18750000
188200**   RECORDS ENTERING THE REPORT PROGRAM.                         18760000
188300     MOVE 9999999999999.99   TO WS-OUT-SORT-REGN-SALES            18770000
188400                                WS-OUT-SORT-DIST-SALES            18780054
188400                                WS-OUT-SORT-STORE-SALES.          18781052
188500     PERFORM                                                      18790074
188600         VARYING PA-TERR-SUB FROM 1 BY 1                          18800000
188700             UNTIL PA-TERR-SUB > PC-TERR-MAX                      18810000
190900             IF PA-TERR (PA-TERR-SUB) > ZEROES                    18822074
191000                 PERFORM 7100-UNLOAD-TERR-TABLE                   18823074
191100             END-IF                                               18824074
191200     END-PERFORM.                                                 18825074
188900                                                                  18830000
189000     INITIALIZE                 WS-OUT-RECORD.                    18840000
187900     MOVE  02                TO WS-OUT-REC-CODE.                  18850026
189200**   MOVING NINES TO THE STORE SALES WILL ENSURE THAT THE         18860000
189300**   REGN RECORDS WILL BE SORTED BEFORE THE STORE RECORDS         18870000
189400**   ENTERING THE REPORT PROGRAM.                                 18880000
189500     MOVE 9999999999999.99   TO WS-OUT-SORT-STORE-SALES           18890000
188400                                WS-OUT-SORT-DIST-SALES.           18891052
189600     PERFORM                                                      18900074
189700         VARYING PA-REGN-SUB FROM 1 BY 1                          18910000
189800             UNTIL PA-REGN-SUB > PC-REGN-MAX                      18920000
190900             IF PA-REGN (PA-REGN-SUB) > ZEROES                    18930176
191000                 PERFORM 7200-UNLOAD-REGN-TABLE                   18930274
191100             END-IF                                               18930374
191200     END-PERFORM.                                                 18937074
190000                                                                  18940000
189000     INITIALIZE                 WS-OUT-RECORD.                    18941052
187900     MOVE  03                TO WS-OUT-REC-CODE.                  18942052
189200**   MOVING NINES TO THE STORE SALES WILL ENSURE THAT THE         18943052
189300**   REGN RECORDS WILL BE SORTED BEFORE THE STORE RECORDS         18944052
189400**   ENTERING THE REPORT PROGRAM.                                 18945052
189500     MOVE 9999999999999.99   TO WS-OUT-SORT-STORE-SALES.          18946052
189600     PERFORM                                                      18947074
189700         VARYING PA-DIST-SUB FROM 1 BY 1                          18948052
189800             UNTIL PA-DIST-SUB > PC-DIST-MAX                      18949052
190900             IF PA-DIST (PA-DIST-SUB) > ZEROES                    18949276
191000                 PERFORM 7250-UNLOAD-DIST-TABLE                   18949375
191100             END-IF                                               18949474
189600     END-PERFORM.                                                 18949574
190000                                                                  18949652
190100     INITIALIZE                 WS-OUT-RECORD.                    18950000
190200     MOVE  04                TO WS-OUT-REC-CODE.                  18960026
190300**   MUST GET THE STORE'S ASSOCIATED REGN AND TERR TOTALS SO      18970000
190400**   THAT THE STORE RECORD WILL BE SORTED AFTER THE CORRECT       18980000
190500**   TERR, REGN, AND DIST RECORDS.                                18990052
190600     PERFORM                                                      19000000
190700       VARYING PA-STORE-SUB FROM 1 BY 1                           19010000
190800         UNTIL PA-STORE-SUB > PC-STORE-MAX                        19020000
190900             IF PA-STORE-NUMBER (PA-STORE-SUB) > ZEROES           19030000
191000                 PERFORM 7300-UNLOAD-STORE-TABLE                  19040000
191100             END-IF                                               19050000
191200     END-PERFORM.                                                 19060000
191300                                                                  19070000
191400     PERFORM 7500-FORMAT-COMPANY-RECORD.                          19080000
191500                                                                  19090000
191600                                                                  19100000
191700******************************************************************19110000
191800* WRITE CONTENTS OF TERR TABLE TO THE REPORT EXTRACT OUTPUT  FILE.19120000
191900******************************************************************19130000
192000 7100-UNLOAD-TERR-TABLE.                                          19140000
192100                                                                  19150000
192200     MOVE PA-TERR (PA-TERR-SUB)    TO WS-OUT-TERR.                19160000
192200     MOVE PA-TERR-MGR-NM(PA-TERR-SUB) TO WS-OUT-TERR-MGR-NM.      19161096
192300**   SORTING WILL BE BASED ON LAST YEAR'S DAILY SALES.            19170000
192400     MOVE PA-TERR-TY-YTD-SALES    (PA-TERR-SUB)                   19180000
192500                                   TO WS-OUT-SORT-TERR-SALES.     19190000
192600     MOVE PA-TERR-TY-DAILY-SALES (PA-TERR-SUB)                    19200000
192700                                   TO WS-OUT-TY-DAILY-SALES.      19210000
192800     MOVE PA-TERR-TY-MTD-SALES    (PA-TERR-SUB)                   19220000
192900                                   TO WS-OUT-TY-MTD-SALES.        19230000
193000     MOVE PA-TERR-TY-YTD-SALES    (PA-TERR-SUB)                   19240000
193100                                   TO WS-OUT-TY-YTD-SALES.        19250000
193200     MOVE PA-TERR-LY-DAILY-SALES (PA-TERR-SUB)                    19260000
193300                                   TO WS-OUT-LY-DAILY-SALES.      19270000
193400     MOVE PA-TERR-LY-MTD-SALES    (PA-TERR-SUB)                   19280000
193500                                   TO WS-OUT-LY-MTD-SALES.        19290000
193600     MOVE PA-TERR-LY-YTD-SALES    (PA-TERR-SUB)                   19300000
193700                                   TO WS-OUT-LY-YTD-SALES.        19310000
193800     MOVE PA-TERR-TY-COMP-DLY-SALES (PA-TERR-SUB)                 19320000
193900                                   TO WS-OUT-TY-COMP-DLY-SALES.   19330000
194000     MOVE PA-TERR-LY-COMP-DLY-SALES (PA-TERR-SUB)                 19340000
194100                                   TO WS-OUT-LY-COMP-DLY-SALES.   19350000
194200     MOVE PA-TERR-TY-COMP-MTD-SALES (PA-TERR-SUB)                 19360000
194300                                   TO WS-OUT-TY-COMP-MTD-SALES.   19370000
194400     MOVE PA-TERR-LY-COMP-MTD-SALES (PA-TERR-SUB)                 19380000
194500                                   TO WS-OUT-LY-COMP-MTD-SALES.   19390000
194600     MOVE PA-TERR-TY-COMP-YTD-SALES (PA-TERR-SUB)                 19400000
194700                                   TO WS-OUT-TY-COMP-YTD-SALES.   19410000
194800     MOVE PA-TERR-LY-COMP-YTD-SALES (PA-TERR-SUB)                 19420000
194900                                   TO WS-OUT-LY-COMP-YTD-SALES.   19430000
195000     MOVE PA-TERR-LY-TOTAL-SALES (PA-TERR-SUB)                    19440000
195100                                   TO WS-OUT-LY-TOTAL-SALES.      19450000
195200     PERFORM 7600-WRITE-OUTPUT-RECORD.                            19460000
195300                                                                  19470000
195400                                                                  19480000
195500******************************************************************19490000
195600* WRITE CONTENTS OF REGN TABLE TO THE REPORT EXTRACT OUTPUT  FILE.19500000
195700* REGNS CAN SPAN TERRS.    REGN TOTALS WILL ONLY REFLECT THE      19510000
195800* STORES IN THE TERR BEING REPORTED ON.                           19520000
195900* AT THIS POINT THE TOTAL FOR THE REGN HAS BEEN CALCULATED.   NOW,19530000
196000* THE REGN MUST BE WRITTEN FOR EACH TERR.                         19540000
196100******************************************************************19550000
196200 7200-UNLOAD-REGN-TABLE.                                          19560000
196300                                                                  19570000
189100     MOVE  02                            TO WS-OUT-REC-CODE.      19590084
202800     MOVE PA-REGN-TERR (PA-REGN-SUB)     TO WS-OUT-TERR.          19600084
202800     MOVE PA-REGN-TERR-MGR-NM (PA-REGN-SUB)                       19601096
202800                   TO WS-OUT-TERR-MGR-NM.                         19602096
196400     MOVE PA-REGN (PA-REGN-SUB)    TO WS-OUT-REGN.                19634024
196400     MOVE PA-REGN-MGR-NM(PA-REGN-SUB) TO WS-OUT-REGN-MGR-NM.      19634196
196700**   SORTING WILL BE BASED ON LAST YEAR'S DAILY SALES.            19637000
196800     MOVE PA-REGN-TY-YTD-SALES       (PA-REGN-SUB)                19638000
196900                                   TO WS-OUT-SORT-REGN-SALES.     19639000
197000     MOVE PA-REGN-TY-DAILY-SALES     (PA-REGN-SUB)                19640000
197100                                   TO WS-OUT-TY-DAILY-SALES.      19650000
197200     MOVE PA-REGN-TY-MTD-SALES       (PA-REGN-SUB)                19660000
197300                                   TO WS-OUT-TY-MTD-SALES.        19670000
197400     MOVE PA-REGN-TY-YTD-SALES       (PA-REGN-SUB)                19680000
197500                                   TO WS-OUT-TY-YTD-SALES.        19690000
197600     MOVE PA-REGN-LY-DAILY-SALES     (PA-REGN-SUB)                19700000
197700                                   TO WS-OUT-LY-DAILY-SALES.      19710000
197800     MOVE PA-REGN-LY-MTD-SALES       (PA-REGN-SUB)                19720000
197900                                   TO WS-OUT-LY-MTD-SALES.        19730000
198000     MOVE PA-REGN-LY-YTD-SALES       (PA-REGN-SUB)                19740000
198100                                   TO WS-OUT-LY-YTD-SALES.        19750000
198200     MOVE PA-REGN-TY-COMP-DLY-SALES (PA-REGN-SUB)                 19760000
198300                                   TO WS-OUT-TY-COMP-DLY-SALES.   19770000
198400     MOVE PA-REGN-LY-COMP-DLY-SALES (PA-REGN-SUB)                 19780000
198500                                   TO WS-OUT-LY-COMP-DLY-SALES.   19790000
198600     MOVE PA-REGN-TY-COMP-MTD-SALES (PA-REGN-SUB)                 19800000
198700                                   TO WS-OUT-TY-COMP-MTD-SALES.   19810000
198800     MOVE PA-REGN-LY-COMP-MTD-SALES (PA-REGN-SUB)                 19820000
198900                                   TO WS-OUT-LY-COMP-MTD-SALES.   19830000
199000     MOVE PA-REGN-TY-COMP-YTD-SALES (PA-REGN-SUB)                 19840000
199100                                   TO WS-OUT-TY-COMP-YTD-SALES.   19850000
199200     MOVE PA-REGN-LY-COMP-YTD-SALES (PA-REGN-SUB)                 19860000
199300                                   TO WS-OUT-LY-COMP-YTD-SALES.   19870000
199400     MOVE PA-REGN-LY-TOTAL-SALES (PA-REGN-SUB)                    19880000
199500                                   TO WS-OUT-LY-TOTAL-SALES.      19890000
202600                                                                  20200000
202800     MOVE PA-REGN      (PA-REGN-SUB)     TO PA-REGN-SUB           20230087
204000     MOVE PA-REGN-TY-YTD-SALES (PA-REGN-SUB)                      20340095
204100                                   TO WS-OUT-SORT-REGN-SALES      20350076
204300                                                                  20400000
204200     PERFORM 7600-WRITE-OUTPUT-RECORD.                            20410000
204300                                                                  20420000
204400                                                                  20430000
195500******************************************************************20431052
195600* WRITE CONTENTS OF DIST TABLE TO THE REPORT EXTRACT OUTPUT  FILE.20432052
195700* DIST TOTALS WILL ONLY REFLECT THE                               20433052
195800* STORES IN THE TERR BEING REPORTED ON.                           20434052
195900* AT THIS POINT THE TOTAL FOR THE DIST HAS BEEN CALCULATED.   NOW,20435052
196000* THE DIST MUST BE WRITTEN FOR EACH REGN, TERR.                   20436052
196100******************************************************************20437052
196200 7250-UNLOAD-DIST-TABLE.                                          20438052
196300                                                                  20439052
189100     MOVE  03                            TO WS-OUT-REC-CODE.      20439284
202800     MOVE PA-DIST-TERR (PA-DIST-SUB)     TO WS-OUT-TERR.          20439384
202800     MOVE PA-DIST-TERR-MGR-NM (PA-REGN-SUB)                       20439496
202800                                   TO WS-OUT-TERR-MGR-NM.         20439597
202800     MOVE PA-DIST-REGN (PA-DIST-SUB)     TO WS-OUT-REGN.          20439684
196400     MOVE PA-DIST-REGN-MGR-NM (PA-REGN-SUB)                       20439997
196400                                   TO WS-OUT-REGN-MGR-NM.         20440097
196400     MOVE PA-DIST (PA-DIST-SUB)    TO WS-OUT-DIST.                20440776
196400     MOVE PA-DIST-MGR-NM (PA-DIST-SUB) TO WS-OUT-DIST-MGR-NM.     20440897
196700**   SORTING WILL BE BASED ON LAST YEAR'S DAILY SALES.            20440996
196800     MOVE PA-DIST-TY-YTD-SALES       (PA-DIST-SUB)                20441096
196900                                   TO WS-OUT-SORT-DIST-SALES.     20441196
197000     MOVE PA-DIST-TY-DAILY-SALES     (PA-DIST-SUB)                20441296
197100                                   TO WS-OUT-TY-DAILY-SALES.      20441396
197200     MOVE PA-DIST-TY-MTD-SALES       (PA-DIST-SUB)                20441496
197300                                   TO WS-OUT-TY-MTD-SALES.        20441596
197400     MOVE PA-DIST-TY-YTD-SALES       (PA-DIST-SUB)                20441696
197500                                   TO WS-OUT-TY-YTD-SALES.        20441796
197600     MOVE PA-DIST-LY-DAILY-SALES     (PA-DIST-SUB)                20441896
197700                                   TO WS-OUT-LY-DAILY-SALES.      20441996
197800     MOVE PA-DIST-LY-MTD-SALES       (PA-DIST-SUB)                20442096
197900                                   TO WS-OUT-LY-MTD-SALES.        20442196
198000     MOVE PA-DIST-LY-YTD-SALES       (PA-DIST-SUB)                20442296
198100                                   TO WS-OUT-LY-YTD-SALES.        20442396
198200     MOVE PA-DIST-TY-COMP-DLY-SALES (PA-DIST-SUB)                 20442496
198300                                   TO WS-OUT-TY-COMP-DLY-SALES.   20442596
198400     MOVE PA-DIST-LY-COMP-DLY-SALES (PA-DIST-SUB)                 20442696
198500                                   TO WS-OUT-LY-COMP-DLY-SALES.   20442796
198600     MOVE PA-DIST-TY-COMP-MTD-SALES (PA-DIST-SUB)                 20442896
198700                                   TO WS-OUT-TY-COMP-MTD-SALES.   20442996
198800     MOVE PA-DIST-LY-COMP-MTD-SALES (PA-DIST-SUB)                 20443096
198900                                   TO WS-OUT-LY-COMP-MTD-SALES.   20443196
199000     MOVE PA-DIST-TY-COMP-YTD-SALES (PA-DIST-SUB)                 20443296
199100                                   TO WS-OUT-TY-COMP-YTD-SALES.   20443396
199200     MOVE PA-DIST-LY-COMP-YTD-SALES (PA-DIST-SUB)                 20443496
199300                                   TO WS-OUT-LY-COMP-YTD-SALES.   20443596
199400     MOVE PA-DIST-LY-TOTAL-SALES (PA-DIST-SUB)                    20443696
199500                                   TO WS-OUT-LY-TOTAL-SALES.      20443796
202600                                                                  20446452
202800     MOVE PA-DIST (PA-DIST-SUB)     TO PA-DIST-SUB                20446787
204000     MOVE PA-DIST-TY-YTD-SALES (PA-DIST-SUB)                      20447987
204100                                   TO WS-OUT-SORT-DIST-SALES      20448076
204300                                                                  20448571
204200     PERFORM 7600-WRITE-OUTPUT-RECORD.                            20448671
204300                                                                  20448771
204400                                                                  20448871
204500 7300-UNLOAD-STORE-TABLE.                                         20449052
204600                                                                  20450000
196400     IF PA-STORE-E-BUS-IND (PA-STORE-SUB) = 'N'                   20460000
189100         MOVE  04                            TO WS-OUT-REC-CODE   20461026
196400     ELSE                                                         20463000
189100         MOVE  05                            TO WS-OUT-REC-CODE   20467184
196400     END-IF.                                                      20468000
204700     MOVE PA-STORE-NUMBER (PA-STORE-SUB)  TO WS-OUT-STORE.        20469000
204800     MOVE PA-STORE-NAME   (PA-STORE-SUB)  TO WS-OUT-STORE-NAME.   20470000
205000     MOVE PA-STORE-REGN   (PA-STORE-SUB)  TO WS-OUT-REGN.         20480000
196400     MOVE PA-STORE-REGN-MGR-NM (PA-STORE-SUB)                     20480196
196400                                    TO WS-OUT-REGN-MGR-NM.        20480296
205000     MOVE PA-STORE-DIST   (PA-STORE-SUB)  TO WS-OUT-DIST.         20481077
196400     MOVE PA-STORE-DIST-MGR-NM(PA-STORE-SUB)                      20481196
196400                                    TO WS-OUT-DIST-MGR-NM.        20481296
202800     MOVE PA-STORE-TERR   (PA-STORE-SUB)  TO WS-OUT-TERR.         20482084
202800     MOVE PA-STORE-TERR-MGR-NM (PA-STORE-SUB)                     20483096
202800                   TO WS-OUT-TERR-MGR-NM.                         20484096
205100**   SORTING WILL BE BASED ON LAST YEAR'S DAILY SALES.            20490000
205200     MOVE PA-STORE-TY-YTD-SALES   (PA-STORE-SUB)                  20500000
205300                                   TO WS-OUT-SORT-STORE-SALES.    20510000
205400     MOVE PA-STORE-TY-DAILY-SALES (PA-STORE-SUB)                  20520000
205500                                   TO WS-OUT-TY-DAILY-SALES.      20530000
205600     MOVE PA-STORE-TY-MTD-SALES   (PA-STORE-SUB)                  20540000
205700                                   TO WS-OUT-TY-MTD-SALES.        20550000
205800     MOVE PA-STORE-TY-YTD-SALES   (PA-STORE-SUB)                  20560000
205900                                   TO WS-OUT-TY-YTD-SALES.        20570000
206000     MOVE PA-STORE-LY-DAILY-SALES (PA-STORE-SUB)                  20580000
206100                                   TO WS-OUT-LY-DAILY-SALES.      20590000
206200     MOVE PA-STORE-LY-MTD-SALES   (PA-STORE-SUB)                  20600000
206300                                   TO WS-OUT-LY-MTD-SALES.        20610000
206400     MOVE PA-STORE-LY-YTD-SALES   (PA-STORE-SUB)                  20620000
206500                                   TO WS-OUT-LY-YTD-SALES.        20630000
206600     MOVE PA-STORE-TY-COMP-DLY-SALES (PA-STORE-SUB)               20640000
206700                                   TO WS-OUT-TY-COMP-DLY-SALES.   20650000
206800     MOVE PA-STORE-LY-COMP-DLY-SALES (PA-STORE-SUB)               20660000
206900                                   TO WS-OUT-LY-COMP-DLY-SALES.   20670000
207000     MOVE PA-STORE-TY-COMP-MTD-SALES (PA-STORE-SUB)               20680000
207100                                   TO WS-OUT-TY-COMP-MTD-SALES.   20690000
207200     MOVE PA-STORE-LY-COMP-MTD-SALES (PA-STORE-SUB)               20700000
207300                                   TO WS-OUT-LY-COMP-MTD-SALES.   20710000
207400     MOVE PA-STORE-TY-COMP-YTD-SALES (PA-STORE-SUB)               20720000
207500                                   TO WS-OUT-TY-COMP-YTD-SALES.   20730000
207600     MOVE PA-STORE-LY-COMP-YTD-SALES (PA-STORE-SUB)               20740000
207700                                   TO WS-OUT-LY-COMP-YTD-SALES.   20750000
207800     MOVE PA-STORE-LY-TOTAL-SALES (PA-STORE-SUB)                  20760000
207900                                   TO WS-OUT-LY-TOTAL-SALES.      20770000
208000                                                                  20780000
208100**   FIND TERR SALES                                              20790076
208200     MOVE PA-STORE-TERR (PA-STORE-SUB) TO PA-TERR-SUB.            20800076
209600     MOVE PA-TERR-TY-YTD-SALES (PA-TERR-SUB)                      20940076
209700                                   TO WS-OUT-SORT-TERR-SALES.     20950076
208000                                                                  20951052
208100**   FIND DIST SALES                                              20951176
208200     MOVE PA-STORE-DIST (PA-STORE-SUB) TO PA-DIST-SUB.            20951276
209600     MOVE PA-DIST-TY-YTD-SALES (PA-DIST-SUB)                      20951376
209700                                   TO WS-OUT-SORT-DIST-SALES.     20951476
208000                                                                  20951576
208100**   FIND REGN SALES                                              20952052
208200     MOVE PA-STORE-REGN (PA-STORE-SUB) TO PA-REGN-SUB.            20953071
209600     MOVE PA-REGN-TY-YTD-SALES (PA-REGN-SUB)                      20959771
209700                                   TO WS-OUT-SORT-REGN-SALES.     20959852
210000                                                                  20980000
210200     MOVE PA-STORE-REGN (PA-STORE-SUB) TO PA-REGN-SUB.            21010087
211500     MOVE PA-REGN-TY-YTD-SALES (PA-REGN-SUB)                      21150087
211600                                   TO WS-OUT-SORT-REGN-SALES.     21160087
211700                                                                  21165000
211800     PERFORM 7600-WRITE-OUTPUT-RECORD.                            21166000
211900                                                                  21167000
214900                                                                  21168000
212100 7500-FORMAT-COMPANY-RECORD.                                      21169000
212200                                                                  21170000
212300     INITIALIZE                         WS-OUT-RECORD.            21180000
212400     MOVE  06                        TO WS-OUT-REC-CODE.          21190026
212500**   MOVING ZEROES TO THE TERR, REGN, DIST AND STORE SALES AND    21200052
212600**   9999 TO THE TERR NAME WILL ENSURE THAT THE COMPANY TOTALS    21210021
212700**   RECORD WILL BE SORTED TO THE END OF THE FILE ENTERING THE    21220000
212800**   REPORT PROGRAM.                                              21230000
212900     MOVE ZEROES                     TO WS-OUT-SORT-TERR-SALES    21240000
213000                                        WS-OUT-SORT-REGN-SALES    21250000
213000                                        WS-OUT-SORT-DIST-SALES    21251035
213100                                        WS-OUT-SORT-STORE-SALES.  21260000
213200     MOVE 9999                       TO WS-OUT-TERR.              21270021
192200     MOVE 9999                       TO WS-OUT-REGN.              21271083
192200     MOVE 9999                       TO WS-OUT-DIST.              21272083
192200     MOVE 9999                       TO WS-OUT-STORE.             21273083
213300     MOVE PV-COMPANY-TY-DLY-AMT      TO WS-OUT-TY-DAILY-SALES.    21280000
213400     MOVE PV-COMPANY-LY-DLY-AMT      TO WS-OUT-LY-DAILY-SALES.    21290000
213500     MOVE PV-COMPANY-TY-MTD-AMT      TO WS-OUT-TY-MTD-SALES.      21300000
213600     MOVE PV-COMPANY-LY-MTD-AMT      TO WS-OUT-LY-MTD-SALES.      21310000
213700     MOVE PV-COMPANY-TY-YTD-AMT      TO WS-OUT-TY-YTD-SALES.      21320000
213800     MOVE PV-COMPANY-LY-YTD-AMT      TO WS-OUT-LY-YTD-SALES.      21330000
213900     MOVE PV-COMPANY-TY-COMP-DLY-AMT TO WS-OUT-TY-COMP-DLY-SALES. 21340000
214000     MOVE PV-COMPANY-LY-COMP-DLY-AMT TO WS-OUT-LY-COMP-DLY-SALES. 21350000
214100     MOVE PV-COMPANY-TY-COMP-MTD-AMT TO WS-OUT-TY-COMP-MTD-SALES. 21360000
214200     MOVE PV-COMPANY-LY-COMP-MTD-AMT TO WS-OUT-LY-COMP-MTD-SALES. 21370000
214300     MOVE PV-COMPANY-TY-COMP-YTD-AMT TO WS-OUT-TY-COMP-YTD-SALES. 21380000
214400     MOVE PV-COMPANY-LY-COMP-YTD-AMT TO WS-OUT-LY-COMP-YTD-SALES. 21390000
214500     MOVE PV-COMPANY-LY-TOTAL-SALES  TO WS-OUT-LY-TOTAL-SALES.    21400000
214600                                                                  21410000
214700     PERFORM 7600-WRITE-OUTPUT-RECORD.                            21420000
214800                                                                  21430000
214900                                                                  21440000
215000                                                                  21450000
215100 7600-WRITE-OUTPUT-RECORD.                                        21460000
215200                                                                  21470000
WEEK53     IF PS-IN-WEEK-53                                             21480000
WEEK53**       NOTIFY REPORT MODULE THAT DAILY PERCENT CHANGES          21490000
WEEK53**       SHOULD BE N/A - LAST YEAR'S DAILY SALES WILL REFLECT     21500000
WEEK53**       THE LAST DAY OF WEEK 52, NOT THE CURRENT DATE FOR        21510000
WEEK53**       WHICH THERE WAS NO 53 WEEK DATE THE PREVIOUS YEAR.       21520000
WEEK53         MOVE 'Y'     TO WS-OUT-DURING-WEEK-53                    21521000
WEEK53     END-IF.                                                      21522000
WEEK53     MOVE PV-LY-SAME-FISCAL-DATE   TO WS-OUT-LY-SAME-FISCAL-DATE. 21523000
215300     WRITE REPORT-EXTRACT-RECORD FROM WS-OUT-RECORD.              21524000
215400     IF WS-OUT-REC-CODE =  00                                     21525026
215500         ADD +1      TO   PA-TERR-WRITTEN                         21526000
215600     ELSE                                                         21527000
215700         IF WS-OUT-REC-CODE =  02                                 21528026
215800             ADD +1      TO   PA-REGN-WRITTEN                     21529000
215900         ELSE                                                     21530000
216000           IF WS-OUT-REC-CODE =  03                               21540052
216100              ADD +1      TO   PA-DIST-WRITTEN                    21550082
215900           ELSE                                                   21551052
216000             IF WS-OUT-REC-CODE =  04                             21552052
216100                 ADD +1      TO   PA-STORE-WRITTEN                21553052
216200             ELSE                                                 21560000
216300                 IF WS-OUT-REC-CODE =  05                         21570026
216400                     ADD +1      TO   PA-ECOM-WRITTEN             21580000
                       ELSE                                             21590000
216300                     IF WS-OUT-REC-CODE =  06                     21600026
216400                         ADD +1      TO   PA-COMPANY-WRITTEN      21610000
216500                     END-IF                                       21620000
216500                 END-IF                                           21630000
216600             END-IF                                               21640000
216700         END-IF                                                   21650000
216800     END-IF.                                                      21660000
216900     ADD +1          TO   PA-TOTAL-WRITTEN.                       21670000
217000                                                                  21680000
217100                                                                  21690000
217200******************************************************************21700000
217300* DB2 ABEND ROUTINE                                               21710000
217400******************************************************************21720000
217500 8000-DB2-ABEND.                                                  21730000
217600                                                                  21740000
217700     MOVE SQLCODE TO SQLCODE2.                                    21750000
217800     MOVE SQLERRD(3) TO SQLERRD3.                                 21760000
217900                                                                  21770000
218000     DISPLAY '8000-DB2-ABEND'.                                    21780000
218100     DISPLAY '** ABEND           ** = SQLABEND'.                  21790000
218200     DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.          21800000
218300     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        21810000
218400     DISPLAY '** TABLES AFFECTED ** = ' PV-TABLE-NAME.            21820000
218500     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG.         21830000
218600     DISPLAY '** SQLCODE         ** = ' SQLCODE2.                 21840000
218700     DISPLAY '** ROWS PROCESSED  ** = ' SQLERRD3.                 21850000
218800     DISPLAY '** SQLERRM         ** = ' SQLERRM.                  21860000
218900     DISPLAY '** SQLERRMC        ** = ' SQLERRMC.                 21870000
219000                                                                  21880000
219100******************************************************************21890000
219200*  THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION TERR-    21900000
219300*  MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE        21910000
219400* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     21920000
219500*  FORMAT.                                                        21930000
219600******************************************************************21940000
219700     COPY DPPD004.                                                21950000
219800                                                                  21960000
219900     SET ABEND-4013-DB2-ERROR TO TRUE.                            21970000
220000                                                                  21980000
220100     PERFORM 8100-ABEND.                                          21990000
220200                                                                  22000000
220300                                                                  22010000
220400******************************************************************22020000
220500* ABEND ROUTINE                                                   22030000
220600******************************************************************22040000
220700 8100-ABEND.                                                      22050000
220800                                                                  22060000
220900     PERFORM 9000-END-OF-JOB.                                     22070000
221000                                                                  22080000
221100     CALL 'ILBOABN0' USING ABEND-CODE.                            22090000
221200                                                                  22100000
221300                                                                  22110000
221400******************************************************************22120000
221500* PERFORMS END OF JOB PROCESSING                                  22130000
221600******************************************************************22140000
221700 9000-END-OF-JOB.                                                 22150000
221800                                                                  22160000
221900     CLOSE CTLCD-DATE-FILE                                        22170000
222000           REPORT-EXTRACT-FILE.                                   22180000
222100                                                                  22190000
222200     MOVE FUNCTION CURRENT-DATE TO SYS-DATE-TIME.                 22200000
222300                                                                  22210000
222400     MOVE SYS-TIME (1:2) TO ST-END-HR.                            22220000
222500     MOVE SYS-TIME (3:2) TO ST-END-MN.                            22230000
222600                                                                  22240000
222700     DISPLAY '                    '.                              22250000
222800     DISPLAY '**********************'.                            22260000
222900     DISPLAY '   SSKUT027 CONTROLS  '.                            22270000
223000     DISPLAY '**********************'.                            22280000
223100     DISPLAY 'RUN DATE  = ' SD-EDIT-DATE.                         22290000
223200     DISPLAY 'BEG TIME  = ' ST-BEG-TIME.                          22300000
223300     DISPLAY 'END TIME  = ' ST-END-TIME.                          22310000
223400     DISPLAY '======================'.                            22320000
223500     DISPLAY 'CONTROL CARD DATE: ' CC-DB2-CTLCD-DATE-ISO.         22330000
WEEK53     DISPLAY 'CONTROL CARD 53 WEEK IND: ' CC-53-WEEK-IND.         22340000
223600     DISPLAY '            '.                                      22350000
223700     DISPLAY 'TERR   RECORDS WRITTEN = ' PA-TERR-WRITTEN.         22360000
223800     DISPLAY 'REGN   RECORDS WRITTEN = ' PA-REGN-WRITTEN.         22370000
223800     DISPLAY 'DIST   RECORDS WRITTEN = ' PA-DIST-WRITTEN.         22371035
223900     DISPLAY 'STORE   RECORDS WRITTEN = ' PA-STORE-WRITTEN.       22380000
224000     DISPLAY 'ECOM    RECORDS WRITTEN = ' PA-ECOM-WRITTEN.        22390000
224000     DISPLAY 'COMPANY RECORDS WRITTEN = ' PA-COMPANY-WRITTEN.     22400000
224100     DISPLAY 'TOTAL   RECORDS WRITTEN = ' PA-TOTAL-WRITTEN.       22410000
224200     DISPLAY '                    '.                              22420000
224300                                                                  22430000
