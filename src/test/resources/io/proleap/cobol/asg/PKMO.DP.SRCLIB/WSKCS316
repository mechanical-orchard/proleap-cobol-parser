000100 TITLE 'W316 - WMS SHIPMENT XREF DETAILS'.                        00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300 PROGRAM-ID.    WSKCS316.                                         00030000
000400 AUTHOR.        JEAN KURKOWSKI.                                   00040000
000500 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00050000
000600 DATE-WRITTEN.  JUNE, 2007.                                       00060000
000700 DATE-COMPILED.                                                   00070000
263627*---------------------------------------------------------------* 00071099
263627* CHANGED 11/05/2021    BY JIM HUNTER      WR: CHG0263627         00072099
263627* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00073099
263627* MAKING THE CALL DYNAMIC VS STATIC.                              00074099
263627*---------------------------------------------------------------* 00075099
CICS  *  CHANGED 11/04/2022    BY BARB SCHULTZ    WR: CHG0278176      * 00076099
CICS  *                                                               * 00077099
CICS  *  ADDED COPYBOOK DPWS930 AND MADE THE CICS ARCHITECTURE CALL   * 00078099
CICS  *  DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.    * 00078199
CICS  *---------------------------------------------------------------* 00079099
000800 ENVIRONMENT DIVISION.                                            00080000
000900 DATA DIVISION.                                                   00090000
001000                                                                  00100000
001100 WORKING-STORAGE SECTION.                                         00110000
001200 01  DK-DB2-KEYS.                                                 00120000
002300     05  DK-TRIP-ID                     PIC S9(09)  VALUE ZERO    00130000
005200                                                 COMP.            00140000
005201     05  DK-EXT-SHP-ID                  PIC  X(20)  VALUE SPACES. 00150099
005202     05  DK-PO-NBR                      PIC S9(09)  VALUE ZERO    00160099
005203                                                 COMP.            00170099
171410     05  DK-SKU-NBR                     PIC S9(08)  VALUE ZERO    00180099
171410                                                 COMP-3.          00190099
537000**AMIT**21/07/2013**INITIAL                                       00200000
005202     05  DK-REC-SEQ-NBR                 PIC S9(09)  VALUE ZERO    00210000
005203                                                 COMP.            00220000
005202     05  DK-ORD-LNE-NBR                 PIC S9(09)  VALUE ZERO    00230000
005203                                                 COMP.            00240000
537000**AMIT**21/07/2013**FINAL                                         00250000
005204     05  DK-PO-LNE-NBR                  PIC S9(09)  VALUE ZERO    00260000
005205                                                 COMP.            00270000
005300 01  PC-PROGRAM-CONSTANTS.                                        00280000
005400     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'WS316A  '.  00290000
005500     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'WSKM316'.   00300000
005600     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'WSKCS316'.  00310000
0AMIT0     05  PC-ASN-RCVNG              PIC  X(16)                     00320099
                                           VALUE 'ASN IN RECEIVING'.    00330099
006300     05  PC-CRIT-SPEC-FORMAT       PIC  X(01)  VALUE '1'.         00340000
006400     05  PC-LIST-FORMAT            PIC  X(01)  VALUE '2'.         00350000
006500     05  PC-ITEMS-PER-PANEL        PIC S9(04)  VALUE +12          00360000
006600                                               COMP SYNC.         00370000
006700     05  PC-MAX-BLOCKS-IN-ARRAY    PIC S9(04)  VALUE +2           00380000
006800                                               COMP SYNC.         00390000
006900     05  PC-MAX-ITEMS              PIC S9(09)  VALUE +1000000     00400000
007000                                               COMP-3.            00410000
007100     05  PC-MSG-NUMBER-LENGTH      PIC S9(04)  VALUE +5           00420000
007200                                               COMP SYNC.         00430000
007300     05  PC-MAX-RETRIES            PIC S9(03)  VALUE 3            00440000
007400                                               COMP-3.            00450000
007500     05  PC-INQ                    PIC  X(03)  VALUE 'INQ'.       00460000
007600     05  PC-UPD                    PIC  X(03)  VALUE 'UPD'.       00470000
007700     05  PC-DEL                    PIC  X(03)  VALUE 'DEL'.       00480000
007800     05  PC-ERR                    PIC  X(03)  VALUE 'ERR'.       00490000
007900     05  PC-NEW                    PIC  X(02)  VALUE 'NW'.        00500000
008000     05  PC-SLASH                  PIC  X(01)  VALUE '/'.         00510000
008100     05  PC-ZERO                   PIC S9(04)  VALUE ZEROES       00520000
008200                                               COMP.              00530000
008800     05  PC-DEFAULT-NINES            PIC X(26)  VALUE             00540000
008801                              '9999-09-09-09.09.09.999999'.       00550000
537000**AMIT**21/07/2013**INITIAL                                       00560000
008000     05  PC-B                      PIC  X(01)  VALUE 'B'.         00570000
008000     05  PC-C                      PIC  X(01)  VALUE 'C'.         00580000
537000**AMIT**21/07/2013**FINAL                                         00590000
008803*                                                                 00600000
008804*----------------------------------------------------------------*00610000
008805*  SYSTEM MESSAGES                                               *00620000
008806*----------------------------------------------------------------*00630000
008807*   00005 = INVALID VALUE                                        *00640000
010500*   99901 = INVALID COMMAND WAS ENTERED                          *00650000
010600*----------------------------------------------------------------*00660000
010700     05  PC-TSYMSG-NUMBERS.                                       00670000
010800         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  00680000
010801         10  PC-TSYMSG-00007            PIC  9(05)  VALUE 00007.  00690000
010802         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  00700000
010803         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  00710000
010804         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  00720000
010805         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  00730000
013302         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  00740000
013303         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  00750000
013304         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  00760000
013305         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  00770000
013306         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  00780000
013307         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  00790000
013308         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  00800000
013309         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  00810000
013310         10  PC-TSYMSG-00840            PIC  9(05)  VALUE 00840.  00820000
171410         10  PC-TSYMSG-02512            PIC  9(05)  VALUE 02512.  00830099
171410         10  PC-TSYMSG-02949            PIC  9(05)  VALUE 02949.  00840099
013311*                                                                 00850000
013312 01  PS-PROGRAM-SWITCHES.                                         00860000
013400     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    00870000
013500         88  PS-NO-ERROR                            VALUE 'Y'.    00880000
013600         88  PS-ERROR                               VALUE 'N'.    00890000
014000     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    00900000
014100         88  PS-COMMAREA-VALID                      VALUE 'Y'.    00910000
014200         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    00920000
014300     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    00930000
014400         88  PS-DONE                                VALUE 'Y'.    00940000
014500         88  PS-NOT-DONE                            VALUE 'N'.    00950000
014600     05  PS-ACCESS-SW                   PIC  X(01)  VALUE  'N'.   00960000
014700         88  PS-ACCESS-ALLOWED                      VALUE  'Y'.   00970000
014800         88  PS-ACCESS-NOT-ALLOWED                  VALUE  'N'.   00980000
014900     05  PS-EOF-WMS-CSR-IND          PIC X(01)  VALUE 'N'.        00990000
015000         88 PS-EOF-WMS-CSR-NO                   VALUE 'N'.        01000000
015100         88 PS-EOF-WMS-CSR-YES                  VALUE 'Y'.        01010000
015200     05  PS-CICS-SWITCH-IND          PIC X(01)  VALUE 'N'.        01020000
015300         88 PS-CICS-SWITCH-NO                   VALUE 'N'.        01030000
015400         88 PS-CICS-SWITCH-YES                  VALUE 'Y'.        01040000
015500     05  PS-LIST-END-SW                 PIC  X(01)  VALUE 'N'.    01050000
015600         88  PS-LIST-END                            VALUE 'Y'.    01060000
015700         88  PS-NO-LIST-END                         VALUE 'N'.    01070000
016603*                                                                 01080000
016604*                                                                 01090000
016605 01  PV-PROGRAM-VARIABLES.                                        01100000
016610     05  PV-ITEMS-HOLD                   PIC S9(03)  COMP-3.      01110000
016611     05  PV-ITEMS-DIFF                   PIC S9(03)  COMP-3.      01120000
016612     05  PV-RACF-ERROR-CODE             PIC  9(04)  VALUE ZEROES. 01130000
016613     05  PV-SRC-TASK-NUMBER             PIC  9(07)  VALUE ZEROES. 01140000
016900     05  PV-SUB                         PIC S9(04)  VALUE +0      01150000
017000                                                    COMP SYNC.    01160000
017100     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      01170000
017200                                                    COMP SYNC.    01180000
017300     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      01190000
017400                                                    COMP-3.       01200000
017500     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      01210000
017600                                                    COMP-3.       01220000
017700     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      01230000
017800                                                    COMP-3.       01240000
017900     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      01250000
018000                                                    COMP-3.       01260000
018100     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      01270000
018200                                                    COMP-3.       01280000
018300     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      01290000
018400                                                    COMP-3.       01300000
018500     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      01310000
018600                                                    COMP-3.       01320000
018700     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      01330000
018800                                                    COMP SYNC.    01340000
018900     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01350000
019000                                                    COMP SYNC.    01360000
019100     05  PV-ITEM                        PIC S9(04)  VALUE +0      01370000
019200                                                    COMP SYNC.    01380000
019300     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      01390000
019400                                                    COMP SYNC.    01400000
019500     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      01410000
019600                                                    COMP SYNC.    01420000
019700     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      01430000
019800                                                    COMP SYNC.    01440000
019900     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      01450000
020000                                                    COMP SYNC.    01460000
020100     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      01470000
020200                                                    COMP SYNC.    01480000
020300     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01490000
020400                                                    COMP SYNC.    01500000
020500     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01510000
020600                                                    COMP SYNC.    01520000
020700     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      01530000
020800                                                    COMP SYNC.    01540000
020900     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      01550000
021000                                                    COMP SYNC.    01560000
021100     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      01570000
021200                                                    COMP SYNC.    01580000
021300     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      01590000
021400                                                    COMP SYNC.    01600000
021700     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      01610000
021800                                                    COMP SYNC.    01620000
023100     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     01630000
023200                                                     COMP SYNC.   01640000
171410     05  PV-PO-NBR                       PIC S9(09)  VALUE +0     01650099
171410                                                     COMP.        01660099
171410     05  PV-SKU-NBR                      PIC S9(08)  VALUE +0     01670099
171410                                                     COMP-3.      01680099
023300     05  PV-CICS-MSG-AREA                PIC  X(100) VALUE SPACE. 01690000
023400     05  PV-DISPLAY-1                    PIC -Z(08)9.             01700000
023500     05  PV-DISPLAY-2                    PIC -Z(08)9.             01710000
023600     05  PV-DISPLAY-3                    PIC -Z(08)9.             01720000
171410     05  PV-DISPLAY-4                    PIC -Z(08)9.             01730099
023700     05  PV-DISPLAY                      PIC -Z(03)9.             01740000
537000**AMIT**21/07/2013**INITIAL                                       01750000
023700     05  PV-PKGNG-CODE                   PIC  X(01).              01760000
023700     05  PV-OUTER-PACK                   PIC  9(02).              01770000
023700     05  PV-TRANSCRIBE-SUM               PIC  S9(9) COMP VALUE +0.01780000
023700     05  PV-TRANSCRIBE-SUM-N             PIC   9(04).             01790099
023700     05  PV-CARTON-COUNT                 PIC  S9(04) COMP-3.      01800099
023700     05  PV-CARTON-COUNT-REM             PIC  9(02).              01810000
023700     05  PV-NUMBER-OF-ITEMS-READ         PIC  9(09).              01820099
023700     05  PV-EXT-SHP-ID                   PIC  X(20).              01830099
0AMIT5*    05  PV-ASN-RCVNG                    PIC  X(01).              01840099
537000**AMIT**21/07/2013**FINAL                                         01850000
029302                                                                  01860000
029400******************************************************************01870000
029500**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **01880000
029600**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **01890000
029700**  APPLICATION-SPECIFIC COMMAREA.                              **01900000
029800******************************************************************01910000
029900 01  LQW-LIST-QUEUE-WORK-AREA.                                    01920000
030000     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  01930000
030100     05  LQW-ITEM-ENTRIES               OCCURS 12 TIMES           01940000
030200                                        INDEXED BY LQW-IDX.       01950000
030300         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       01960000
030400         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               01970000
030500         10  LQW-SELECTED-SW            PIC  X(01).               01980000
030600             88  LQW-SELECT                         VALUE 'S'.    01990000
030700             88  LQW-DESELECT                       VALUE ' '.    02000000
031300         10  LQW-PO-NBR                 PIC  X(09).               02010000
031400         10  LQW-RCVR-NBR               PIC  X(03).               02020000
031401         10  LQW-PO-LNE-NBR             PIC  X(03).               02030000
031402         10  LQW-PREPK-ID               PIC  X(03).               02040000
031403         10  LQW-SKU-NBR                PIC  X(08).               02050000
537000**AMIT**21/07/2013**INITIAL                                       02060000
031404         10  LQW-CARTON-COUNT           PIC  9(04).               02070000
537000**AMIT**21/07/2013**FINAL                                         02080000
031404         10  LQW-ASN-LVL-CDE            PIC  X(01).               02090000
031900         10  LQW-CREATE-BY              PIC  X(08).               02100000
031901         10  LQW-DWNLD-IND              PIC  X(04).               02110000
031902         10  LQW-DWNLD-DATE             PIC  X(05).               02120000
031903         10  LQW-DWNLD-TIME             PIC  X(05).               02130000
031904         10  LQW-CRE-DATE               PIC  X(05).               02140000
031905         10  LQW-CRE-TIME               PIC  X(05).               02150000
032100                                                                  02160000
032200*---------------------------------------------------------------* 02170000
032300* SELECTON QUEUE LAYOUT                                         * 02180000
032400*---------------------------------------------------------------* 02190000
032500     COPY WSWS011.                                                02200000
032600                                                                  02210000
032700*---------------------------------------------------------------* 02220000
032800*    MAP LAYOUT                                                 * 02230000
032900*---------------------------------------------------------------* 02240099
033000     COPY WSKM316.                                                02250000
033100*                                                                 02260000
033200 01  MR-OCCURS-LAYOUT                   REDEFINES  WS316AO.       02270000
171410     05  FILLER                         PIC X(169).               02280099
033400     05  MR-SCROLL-AREA                 OCCURS 12 TIMES.          02290000
033500         10  MR-SELECTL                 PIC S9(04) COMP.          02300000
033600         10  MR-SELECTA                 PIC  X(01).               02310000
033700         10  MR-SELECTC                 PIC  X(01).               02320000
033800         10  MR-SELECTH                 PIC  X(01).               02330000
033900         10  MR-SELECTI                 PIC  X(01).               02340000
034000                                                                  02350000
034700         10  MR-PO-NBRL                 PIC S9(04) COMP.          02360000
034800         10  MR-PO-NBRA                 PIC  X(01).               02370000
034900         10  MR-PO-NBRC                 PIC  X(01).               02380000
035000         10  MR-PO-NBRH                 PIC  X(01).               02390000
035100         10  MR-PO-NBR.                                           02400000
035110             15  MR-PO-NBR-N            PIC  Z(08)9.              02410000
035200                                                                  02420000
035300         10  MR-RCVR-NBRL               PIC S9(04) COMP.          02430000
035400         10  MR-RCVR-NBRA               PIC  X(01).               02440000
035500         10  MR-RCVR-NBRC               PIC  X(01).               02450000
035600         10  MR-RCVR-NBRH               PIC  X(01).               02460000
035700         10  MR-RCVR-NBR                PIC  X(03).               02470000
035800                                                                  02480000
035801         10  MR-PO-LNEL                 PIC S9(04) COMP.          02490000
035802         10  MR-PO-LNEA                 PIC  X(01).               02500000
035803         10  MR-PO-LNEC                 PIC  X(01).               02510000
035804         10  MR-PO-LNEH                 PIC  X(01).               02520000
035805         10  MR-PO-LNE                  PIC  X(03).               02530000
035806                                                                  02540000
035807         10  MR-PREPKL                  PIC S9(04) COMP.          02550000
035808         10  MR-PREPKA                  PIC  X(01).               02560000
035809         10  MR-PREPKC                  PIC  X(01).               02570000
035810         10  MR-PREPKH                  PIC  X(01).               02580000
035811         10  MR-PREPK                   PIC  X(03).               02590000
035812                                                                  02600000
035813         10  MR-SKU-NBRL                PIC S9(04) COMP.          02610000
035814         10  MR-SKU-NBRA                PIC  X(01).               02620000
035815         10  MR-SKU-NBRC                PIC  X(01).               02630000
035816         10  MR-SKU-NBRH                PIC  X(01).               02640000
035817         10  MR-SKU-NBR                 PIC  X(08).               02650000
537000**AMIT**21/07/2013**INITIAL                                       02660000
035813         10  MR-CARTON-COUNTL           PIC S9(04) COMP.          02670000
035814         10  MR-CARTON-COUNTA           PIC  X(01).               02680000
035815         10  MR-CARTON-COUNTC           PIC  X(01).               02690000
035816         10  MR-CARTON-COUNTH           PIC  X(01).               02700000
035100         10  MR-CARTON-COUNT.                                     02710000
035110             15  MR-CARTON-COUNT-N      PIC  Z(03)9.              02720000
537000**AMIT**21/07/2013**FINAL                                         02730000
035818                                                                  02740000
035819         10  MR-ASN-LVLL                PIC S9(04) COMP.          02750000
035820         10  MR-ASN-LVLA                PIC  X(01).               02760000
035821         10  MR-ASN-LVLC                PIC  X(01).               02770000
035822         10  MR-ASN-LVLH                PIC  X(01).               02780000
035823         10  MR-ASN-LVL                 PIC  X(01).               02790000
035824                                                                  02800000
035900         10  MR-DNLD-CDEL               PIC S9(04) COMP.          02810000
036000         10  MR-DNLD-CDEA               PIC  X(01).               02820000
036100         10  MR-DNLD-CDEC               PIC  X(01).               02830000
036200         10  MR-DNLD-CDEH               PIC  X(01).               02840000
036300         10  MR-DNLD-CDE                PIC  X(04).               02850000
036400                                                                  02860000
036500         10  MR-CRE-BYL                 PIC S9(04) COMP.          02870000
036600         10  MR-CRE-BYA                 PIC  X(01).               02880000
036700         10  MR-CRE-BYC                 PIC  X(01).               02890000
036800         10  MR-CRE-BYH                 PIC  X(01).               02900000
036900         10  MR-CRE-BY                  PIC  X(08).               02910000
039400                                                                  02920000
039401         10  MR-DNLD-DTEL               PIC S9(04) COMP.          02930000
039402         10  MR-DNLD-DTEA               PIC  X(01).               02940000
039403         10  MR-DNLD-DTEC               PIC  X(01).               02950000
039404         10  MR-DNLD-DTEH               PIC  X(01).               02960000
039405         10  MR-DNLD-DTE                PIC  X(05).               02970000
039406                                                                  02980000
039407         10  MR-DNLD-TMEL               PIC S9(04) COMP.          02990000
039408         10  MR-DNLD-TMEA               PIC  X(01).               03000000
039409         10  MR-DNLD-TMEC               PIC  X(01).               03010000
039410         10  MR-DNLD-TMEH               PIC  X(01).               03020000
039411         10  MR-DNLD-TME                PIC  X(05).               03030000
039412                                                                  03040000
039413         10  MR-CRE-DTEL                PIC S9(04) COMP.          03050000
039414         10  MR-CRE-DTEA                PIC  X(01).               03060000
039415         10  MR-CRE-DTEC                PIC  X(01).               03070000
039416         10  MR-CRE-DTEH                PIC  X(01).               03080000
039417         10  MR-CRE-DTE                 PIC  X(05).               03090000
039418                                                                  03100000
039419         10  MR-CRE-TMEL                PIC S9(04) COMP.          03110000
039420         10  MR-CRE-TMEA                PIC  X(01).               03120000
039421         10  MR-CRE-TMEC                PIC  X(01).               03130000
039422         10  MR-CRE-TMEH                PIC  X(01).               03140000
039423         10  MR-CRE-TME                 PIC  X(05).               03150000
039424                                                                  03160000
039602*---------------------------------------------------------------* 03170000
039603*    ATTRIBUTE SETTINGS COPYBOOK.                               * 03180000
039700*---------------------------------------------------------------* 03190000
039800     COPY DPWS015.                                                03200000
039900                                                                  03210000
040000*---------------------------------------------------------------* 03220000
040100*    FUNCTION KEYS COPYBOOK.                                    * 03230000
040200*---------------------------------------------------------------* 03240000
040300     COPY DPWS016.                                                03250000
040400                                                                  03260000
040500*---------------------------------------------------------------* 03270000
040600*    NUMERIC EDIT LAYOUT.                                       * 03280000
040700*---------------------------------------------------------------* 03290000
040800     COPY DPWS010I.                                               03300000
040900                                                                  03310000
041000*----------------------------------------------------------------*03320000
041100**  SECURITY SUBROUTINE PARAMETERS                                03330000
041200*----------------------------------------------------------------*03340000
041300     COPY DPWS008.                                                03350000
041400                                                                  03360000
041500*---------------------------------------------------------------* 03370000
CICS  *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * 03380099
041700*---------------------------------------------------------------* 03390000
041800     COPY DPWS030.                                                03400000
CICS       COPY DPWS930.                                                03401099
041900                                                                  03410000
042000*---------------------------------------------------------------* 03420000
042100*    STANDARD COMMAREA.                                         * 03430000
042200*---------------------------------------------------------------* 03440000
042300     COPY DPWS020.                                                03450000
042400     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                03460000
042500                                                                  03470000
042600*---------------------------------------------------------------* 03480000
042700* INTER-APPLICATION COMMAREA.                                   * 03490000
043000*   WSWS010 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 03500000
043100*             THIS MODULE TO OTHER WS MODULES.                  * 03510000
043200*---------------------------------------------------------------* 03520000
043300                                                                  03530000
043400         10  INTER-APPL-COMM-AREA       PIC X(200).               03540099
043600     COPY WSWS010.                                                03550000
043700*---------------------------------------------------------------* 03560000
043800*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 03570000
043900*---------------------------------------------------------------* 03580000
044000         10  ASC-SPECIFIC-COMMAREA.                               03590000
044100*  KEYS PASSED FROM SHPMT XREF SCREEN                             03600000
044400             15  ASC-KEY-SHPMT-ID            PIC  X(20).          03610000
044410             15  ASC-KEY-TRIP-ID             PIC  9(09).          03620000
044500             15  ASC-KEY-VEH-NBR             PIC  9(09).          03630000
044900             15  ASC-CARRIER                 PIC  X(04).          03640000
045200             15  ASC-TRAILER                 PIC  X(10).          03650000
045300             15  ASC-TRIP-ID                 PIC  X(09).          03660000
045600             15  ASC-ARRIVAL-DATE            PIC  X(10).          03670000
046900             15  ASC-USER-ID                 PIC  X(08).          03680000
046902             15  ASC-DWNLD-DATE              PIC  X(10).          03690000
046903             15  ASC-DWNLD-TIME              PIC  X(05).          03700000
046903             15  ASC-ASN-RCVNG               PIC  X(01).          03710099
047203*-----------------------------------------------------------------03720099
171410             15  ASC-PO-SRCH                 PIC  X(08).          03730099
171410             15  ASC-PO-NBR-N REDEFINES ASC-PO-SRCH               03740099
171410                                             PIC  Z(08).          03750099
171410             15  ASC-SKU-SRCH                PIC  X(08).          03760099
171410             15  ASC-SKU-NBR-N REDEFINES ASC-SKU-SRCH             03770099
171410                                             PIC  Z(08).          03780099
171410             15  ASC-SEQUENCE-SW             PIC  X(01).          03790099
171410                 88  ASC-PO-SEQ                    VALUE 'P'.     03800099
171410                 88  ASC-LEVEL-SEQ                 VALUE 'L'.     03810099
171410             15  ASC-QUERY-SW                PIC  X(03).          03820099
171410                 88  ASC-WMS-SHIP-CURSOR           VALUE 'WMS'.   03830099
171410                 88  ASC-PO-CURSOR                 VALUE 'POL'.   03840099
171410                 88  ASC-PO-SKU-CURSOR             VALUE 'POS'.   03850099
171410                 88  ASC-SKU-CURSOR                VALUE 'SKU'.   03860099
047300             15  ASC-BLK-SUB                  PIC S9(04) COMP     03870000
047400                                                         SYNC.    03880000
047500             15  ASC-ITEM-SUB                 PIC S9(04) COMP     03890000
047600                                                         SYNC.    03900000
047700             15  ASC-NUMBER-OF-ITEMS-READ     PIC S9(09) COMP-3.  03910000
047800             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09) COMP-3.  03920000
047900             15  ASC-ITEMS-DISPLAYED          PIC S9(03) COMP-3.  03930000
048000             15  ASC-ITEM-AT-TOP-OF-PANEL     PIC S9(09) COMP-3.  03940000
048100             15  ASC-ITEM-AT-BOT-OF-PANEL     PIC S9(09) COMP-3.  03950000
048200             15  ASC-HIGHEST-BLOCK-WRITTEN    PIC S9(04) COMP     03960000
048300                                                         SYNC.    03970000
048400             15  ASC-START-OF-SELECTED-RANGE  PIC S9(09) COMP-3.  03980000
048500             15  ASC-END-OF-SELECTED-RANGE    PIC S9(09) COMP-3.  03990000
048600             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         04000000
048700                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     04010000
048800                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     04020000
048900             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         04030000
049000                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     04040000
049100                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     04050000
049200             15  ASC-LIST-QUEUE-NAME.                             04060000
049300                 20  ASC-LIST-TERM-ID         PIC  X(04).         04070000
049400                 20  ASC-LIST-TASK-NUMBER     PIC S9(05) COMP-3.  04080000
049500                 20  ASC-SEL-SEQ              PIC  9(01).         04090000
049600                                                                  04100000
049700             15  ASC-START-ITEM-REQUEST.                          04110000
049800                 20  ASC-START-ITEM-REQUEST-N PIC  9(05).         04120000
049900                                                                  04130000
050000             15  ASC-SEL-SUB                  PIC S9(4) COMP.     04140000
050100             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     04150000
050200             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          04160000
050300                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 04170000
050400             15  ASC-SEL-QUEUE-NAME-IN.                           04180000
050500                 20  ASC-SEL-TERM-ID-IN       PIC  X(04).         04190000
050600                 20  ASC-SEL-TASK-NUMBER-IN   PIC S9(05) COMP-3.  04200000
050700                 20  ASC-SEL-SEQ              PIC  9(01).         04210000
050800             15  ASC-SEL-QUEUE-NAME-OUT.                          04220000
050900                 20  ASC-SEL-TERM-ID-OUT      PIC  X(04).         04230000
051000                 20  ASC-SEL-TASK-NUMBER-OUT  PIC S9(05) COMP-3.  04240000
051100                 20  ASC-SEL-SEQ              PIC  9(01).         04250000
051200             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  04260000
051300                                                                  04270000
051400*-----------------------------------------------------------------04280000
051500             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                04290000
051600                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  04300000
051700                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   04310000
051800                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   04320000
051900                                                                  04330000
052000                 20  ASC-ITEM-ARRAY.                              04340000
052100                     25  ASC-ITEM-ENTRIES OCCURS 12 TIMES.        04350000
052200                         30  ASC-LIST-ITEM-NUMBER                 04360000
052300                                                     PIC S9(09)   04370000
052400                                                     COMP-3.      04380000
052500                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  04390000
052600                             88  ASC-VALID-SELECT    VALUE ' '    04400000
052700                                                           'S'    04410000
052800                                                           'B'    04420000
052900                                                           'E'.   04430000
053000                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   04440000
053100                             88  ASC-TEMP-SELECT     VALUE 'S'.   04450000
053200                             88  ASC-TEMP-BEGIN      VALUE 'B'.   04460000
053300                             88  ASC-TEMP-END        VALUE 'E'.   04470000
053400                         30  ASC-SELECTED-SW         PIC  X(01).  04480000
053500                             88  ASC-NO-SELECT       VALUE ' '.   04490000
053600                             88  ASC-SELECT          VALUE 'S'.   04500000
053700                             88  ASC-BEGIN           VALUE 'B'.   04510000
053800                             88  ASC-END             VALUE 'E'.   04520000
054000                         30  ASC-SCREEN-PO-NBR       PIC  Z(09).  04530000
054001                         30  ASC-SCREEN-RCVR-NBR     PIC  9(03).  04540000
054002                         30  ASC-SCREEN-PO-LNE-NBR   PIC  9(03).  04550000
054003                         30  ASC-SCREEN-PREPK        PIC  9(03).  04560000
054004                         30  ASC-SCREEN-SKU-NBR      PIC  9(08).  04570000
537000**AMIT**21/07/2013**INITIAL                                       04580000
054004                         30  ASC-SCREEN-CARTON-COUNT PIC  ZZZ9.   04590000
537000**AMIT**21/07/2013**FINAL                                         04600000
054005                         30  ASC-SCREEN-ASN-LVL      PIC  X(01).  04610000
054700                         30  ASC-SCREEN-CRE-BY       PIC  X(08).  04620000
054701                         30  ASC-SCREEN-DNLD-IND     PIC  X(04).  04630000
054702                         30  ASC-SCREEN-DNLD-DTE     PIC  X(05).  04640000
054703                         30  ASC-SCREEN-DNLD-TME     PIC  X(05).  04650000
054704                         30  ASC-SCREEN-CRE-DTE      PIC  X(05).  04660000
054705                         30  ASC-SCREEN-CRE-TME      PIC  X(05).  04670000
054800                                                                  04680000
054900*---------------------------------------------------------------* 04690000
055000*    ABEND PROCESSING COPYBOOK.                                 * 04700000
055100*---------------------------------------------------------------* 04710000
055200     COPY DPWS013.                                                04720000
055300                                                                  04730000
059700*---------------------------------------------------------------* 04740000
059800*    WMS SHIPMENT CROSS REFERENCE DETAIL - WST_SHPMT_XREF_DTL     04750000
059900*---------------------------------------------------------------* 04760000
060000     EXEC SQL                                                     04770000
060100          INCLUDE WST00002                                        04780000
060200     END-EXEC.                                                    04790000
060200                                                                  04800000
060201**AMIT**21/07/2013**INITIAL                                       04810000
059700*---------------------------------------------------------------* 04820099
059800*    WMS SHIPMENT CROSS REFERENCE HEADER - WST_SHPMT_XREF_HDR     04830099
059900*---------------------------------------------------------------* 04840099
060000     EXEC SQL                                                     04850099
060100          INCLUDE WST00001                                        04860099
060200     END-EXEC.                                                    04870099
059700*---------------------------------------------------------------* 04880000
059800*    RC-RECEIVER TABLE                                            04890000
059900*---------------------------------------------------------------* 04900000
060000     EXEC SQL                                                     04910000
060100          INCLUDE TRECEIV                                         04920000
060200     END-EXEC.                                                    04930000
059700*---------------------------------------------------------------* 04940000
059800*    RC-RECEIPT DISTRIBUTION                                      04950000
059900*---------------------------------------------------------------* 04960000
060000     EXEC SQL                                                     04970000
060100          INCLUDE TRECDIS                                         04980000
060200     END-EXEC.                                                    04990000
060201**AMIT**21/07/2013**FINAL                                         05000000
060202*---------------------------------------------------------------* 05010000
060203*    PURCHASE ORDER LINE ITEM TABLE                               05020000
060204*---------------------------------------------------------------* 05030000
060205     EXEC SQL                                                     05040000
060206          INCLUDE TPURITM                                         05050000
060207     END-EXEC.                                                    05060000
060208                                                                  05070000
060209*---------------------------------------------------------------* 05080000
060210*    SKU TABLE - XLT_SKU                                          05090000
060211*---------------------------------------------------------------* 05100000
060212     EXEC SQL                                                     05110000
060213          INCLUDE XLT00003                                        05120000
060214     END-EXEC.                                                    05130000
060215                                                                  05140000
060216*---------------------------------------------------------------* 05150000
060217*    WST_ATTR_ELEM                                                05160000
060218*---------------------------------------------------------------* 05170000
060219     EXEC SQL                                                     05180000
060220          INCLUDE WST00010                                        05190000
060221     END-EXEC.                                                    05200000
060222                                                                  05210000
060223*---------------------------------------------------------------* 05220000
060224*    WST_ATTR_DEFN                                                05230000
060225*---------------------------------------------------------------* 05240000
060226     EXEC SQL                                                     05250000
060227          INCLUDE WST00009                                        05260000
060228     END-EXEC.                                                    05270000
060229                                                                  05280000
060223*AMIT **INITIAL-----------------------------------------------*   05290099
060223*---------------------------------------------------------------* 05300099
060224*    TABLES                                                       05310099
060225*---------------------------------------------------------------* 05320099
060226     EXEC SQL                                                     05330099
060227          INCLUDE TSHUUPC                                         05340099
060228     END-EXEC.                                                    05350099
060226     EXEC SQL                                                     05360099
060227          INCLUDE TINPKSU                                         05370099
060228     END-EXEC.                                                    05380099
060226     EXEC SQL                                                     05390099
060227          INCLUDE TPKSLIP                                         05400099
060228     END-EXEC.                                                    05410099
060223*AMIT **FINALLL ----------------------------------------------*   05420099
060230*---------------------------------------------------------------* 05430099
060231*    WST_INTGRTN_TYP                                              05440099
060232*---------------------------------------------------------------* 05450099
060233     EXEC SQL                                                     05460099
060234          INCLUDE WST00008                                        05470099
060235     END-EXEC.                                                    05480099
060236                                                                  05490099
060237*---------------------------------------------------------------* 05500099
060238*    DB2 AREA FOR COMMUNICATIONS                                * 05510099
060239*---------------------------------------------------------------* 05520099
060240     EXEC SQL                                                     05530099
060241          INCLUDE SQLCA                                           05540099
060242     END-EXEC.                                                    05550099
060243                                                                  05560099
060244*---------------------------------------------------------------* 05570099
060245*    WMS SHIPMENT CURSOR                                          05580099
060246*---------------------------------------------------------------* 05590099
060247     EXEC SQL                                                     05600099
060248          DECLARE WMS-SHIP-CSR CURSOR FOR                         05610099
060249              SELECT  A.PO_NBR                                    05620099
060250                     ,A.RCVR_SEQ_NBR                              05630099
060251                     ,A.PO_LNE_NBR                                05640099
060252                     ,A.PREPK_ID                                  05650099
060253                     ,A.ASN_LVL_CDE                               05660099
060300                     ,A.DWNLD_CDE                                 05670099
060400                     ,A.CRE_TMST                                  05680099
060500                     ,A.CRE_USR_ID                                05690099
171410                     ,C.SKU_NBR                                   05700099
061000                FROM  WST_SHPMT_XREF_DTL A                        05710099
171410                     ,TPURITM            B                        05720099
171410                     ,XLT_SKU            C                        05730099
061300               WHERE  A.EXT_SHP_ID       = :DK-EXT-SHP-ID         05740099
061301                 AND  A.ACTV_CDE         = 'A'                    05750099
171410                 AND  A.PO_NBR           = B.PO_NBR               05760099
171410                 AND  A.PO_LNE_NBR       = B.PO_LNE_NBR           05770099
171410                 AND  B.ITM_NBR          = C.ITM_NBR              05780099
171410                 AND  B.VER_STATUS_CDE   = 'A'                    05790099
061302            ORDER BY  A.PO_NBR                                    05800099
061303                     ,A.RCVR_SEQ_NBR                              05810099
061304                     ,A.PO_LNE_NBR                                05820099
063500     END-EXEC.                                                    05830000
063600                                                                  05840000
171410*---------------------------------------------------------------* 05850099
171410*    ASN LEVEL CODE SEQUENCE                                      05860099
171410*---------------------------------------------------------------* 05870099
171410     EXEC SQL                                                     05880099
171410          DECLARE WMS-ASNLEVEL-CSR CURSOR FOR                     05890099
171410              SELECT  A.PO_NBR                                    05900099
171410                     ,A.RCVR_SEQ_NBR                              05910099
171410                     ,A.PO_LNE_NBR                                05920099
171410                     ,A.PREPK_ID                                  05930099
171410                     ,A.ASN_LVL_CDE                               05940099
171410                     ,A.DWNLD_CDE                                 05950099
171410                     ,A.CRE_TMST                                  05960099
171410                     ,A.CRE_USR_ID                                05970099
171410                     ,C.SKU_NBR                                   05980099
171410                FROM  WST_SHPMT_XREF_DTL A                        05990099
171410                     ,TPURITM            B                        06000099
171410                     ,XLT_SKU            C                        06010099
171410               WHERE  A.EXT_SHP_ID       = :DK-EXT-SHP-ID         06020099
171410                 AND  A.ACTV_CDE         = 'A'                    06030099
171410                 AND  A.PO_NBR           = B.PO_NBR               06040099
171410                 AND  A.PO_LNE_NBR       = B.PO_LNE_NBR           06050099
171410                 AND  B.ITM_NBR          = C.ITM_NBR              06060099
171410                 AND  B.VER_STATUS_CDE   = 'A'                    06070099
171410            ORDER BY  A.ASN_LVL_CDE DESC                          06080099
171410                     ,A.PO_NBR                                    06090099
171410                     ,A.RCVR_SEQ_NBR                              06100099
171410                     ,A.PO_LNE_NBR                                06110099
171410     END-EXEC.                                                    06120099
171410                                                                  06130099
171410*---------------------------------------------------------------* 06140099
171410*    PO CURSOR                                                    06150099
171410*---------------------------------------------------------------* 06160099
171410     EXEC SQL                                                     06170099
171410          DECLARE WMS-PO-CSR CURSOR FOR                           06180099
171410              SELECT  A.PO_NBR                                    06190099
171410                     ,A.RCVR_SEQ_NBR                              06200099
171410                     ,A.PO_LNE_NBR                                06210099
171410                     ,A.PREPK_ID                                  06220099
171410                     ,A.ASN_LVL_CDE                               06230099
171410                     ,A.DWNLD_CDE                                 06240099
171410                     ,A.CRE_TMST                                  06250099
171410                     ,A.CRE_USR_ID                                06260099
171410                     ,C.SKU_NBR                                   06270099
171410                FROM  WST_SHPMT_XREF_DTL A                        06280099
171410                     ,TPURITM            B                        06290099
171410                     ,XLT_SKU            C                        06300099
171410               WHERE  A.EXT_SHP_ID       = :DK-EXT-SHP-ID         06310099
171410                 AND  A.ACTV_CDE         = 'A'                    06320099
171410                 AND  A.PO_NBR           = :DK-PO-NBR             06330099
171410                 AND  A.PO_NBR           = B.PO_NBR               06340099
171410                 AND  A.PO_LNE_NBR       = B.PO_LNE_NBR           06350099
171410                 AND  B.ITM_NBR          = C.ITM_NBR              06360099
171410                 AND  B.VER_STATUS_CDE   = 'A'                    06370099
171410            ORDER BY  A.PO_NBR                                    06380099
171410                     ,A.RCVR_SEQ_NBR                              06390099
171410                     ,A.PO_LNE_NBR                                06400099
171410     END-EXEC.                                                    06410099
171410                                                                  06420099
171410*---------------------------------------------------------------* 06430099
171410*    PO - ASN SEQUENCE CURSOR                                     06440099
171410*---------------------------------------------------------------* 06450099
171410     EXEC SQL                                                     06460099
171410          DECLARE WMS-POASN-CSR CURSOR FOR                        06470099
171410              SELECT  A.PO_NBR                                    06480099
171410                     ,A.RCVR_SEQ_NBR                              06490099
171410                     ,A.PO_LNE_NBR                                06500099
171410                     ,A.PREPK_ID                                  06510099
171410                     ,A.ASN_LVL_CDE                               06520099
171410                     ,A.DWNLD_CDE                                 06530099
171410                     ,A.CRE_TMST                                  06540099
171410                     ,A.CRE_USR_ID                                06550099
171410                     ,C.SKU_NBR                                   06560099
171410                FROM  WST_SHPMT_XREF_DTL A                        06570099
171410                     ,TPURITM            B                        06580099
171410                     ,XLT_SKU            C                        06590099
171410               WHERE  A.EXT_SHP_ID       = :DK-EXT-SHP-ID         06600099
171410                 AND  A.ACTV_CDE         = 'A'                    06610099
171410                 AND  A.PO_NBR           = :DK-PO-NBR             06620099
171410                 AND  A.PO_NBR           = B.PO_NBR               06630099
171410                 AND  A.PO_LNE_NBR       = B.PO_LNE_NBR           06640099
171410                 AND  B.ITM_NBR          = C.ITM_NBR              06650099
171410                 AND  B.VER_STATUS_CDE   = 'A'                    06660099
171410            ORDER BY  A.ASN_LVL_CDE DESC                          06670099
171410                     ,A.PO_NBR                                    06680099
171410                     ,A.RCVR_SEQ_NBR                              06690099
171410                     ,A.PO_LNE_NBR                                06700099
171410     END-EXEC.                                                    06710099
171410                                                                  06720099
171410*---------------------------------------------------------------* 06730099
171410*    PO - SKU CURSOR                                              06740099
171410*---------------------------------------------------------------* 06750099
171410     EXEC SQL                                                     06760099
171410          DECLARE WMS-POSKU-CSR CURSOR FOR                        06770099
171410              SELECT  A.PO_NBR                                    06780099
171410                     ,A.RCVR_SEQ_NBR                              06790099
171410                     ,A.PO_LNE_NBR                                06800099
171410                     ,A.PREPK_ID                                  06810099
171410                     ,A.ASN_LVL_CDE                               06820099
171410                     ,A.DWNLD_CDE                                 06830099
171410                     ,A.CRE_TMST                                  06840099
171410                     ,A.CRE_USR_ID                                06850099
171410                     ,C.SKU_NBR                                   06860099
171410                FROM  WST_SHPMT_XREF_DTL A                        06870099
171410                     ,TPURITM            B                        06880099
171410                     ,XLT_SKU            C                        06890099
171410               WHERE  A.EXT_SHP_ID       = :DK-EXT-SHP-ID         06900099
171410                 AND  A.ACTV_CDE         = 'A'                    06910099
171410                 AND  A.PO_NBR           = :DK-PO-NBR             06920099
171410                 AND  C.SKU_NBR          = :DK-SKU-NBR            06930099
171410                 AND  A.PO_NBR           = B.PO_NBR               06940099
171410                 AND  A.PO_LNE_NBR       = B.PO_LNE_NBR           06950099
171410                 AND  B.ITM_NBR          = C.ITM_NBR              06960099
171410                 AND  B.VER_STATUS_CDE   = 'A'                    06970099
171410            ORDER BY  A.PO_NBR                                    06980099
171410                     ,A.RCVR_SEQ_NBR                              06990099
171410                     ,A.PO_LNE_NBR                                07000099
171410     END-EXEC.                                                    07010099
171410                                                                  07020099
171410*---------------------------------------------------------------* 07030099
171410*    PO - SKU ASN SEQUENCE CURSOR                                 07040099
171410*---------------------------------------------------------------* 07050099
171410     EXEC SQL                                                     07060099
171410          DECLARE WMS-POSKU-ASN-CSR CURSOR FOR                    07070099
171410              SELECT  A.PO_NBR                                    07080099
171410                     ,A.RCVR_SEQ_NBR                              07090099
171410                     ,A.PO_LNE_NBR                                07100099
171410                     ,A.PREPK_ID                                  07110099
171410                     ,A.ASN_LVL_CDE                               07120099
171410                     ,A.DWNLD_CDE                                 07130099
171410                     ,A.CRE_TMST                                  07140099
171410                     ,A.CRE_USR_ID                                07150099
171410                     ,C.SKU_NBR                                   07160099
171410                FROM  WST_SHPMT_XREF_DTL A                        07170099
171410                     ,TPURITM            B                        07180099
171410                     ,XLT_SKU            C                        07190099
171410               WHERE  A.EXT_SHP_ID       = :DK-EXT-SHP-ID         07200099
171410                 AND  A.ACTV_CDE         = 'A'                    07210099
171410                 AND  A.PO_NBR           = :DK-PO-NBR             07220099
171410                 AND  C.SKU_NBR          = :DK-SKU-NBR            07230099
171410                 AND  A.PO_NBR           = B.PO_NBR               07240099
171410                 AND  A.PO_LNE_NBR       = B.PO_LNE_NBR           07250099
171410                 AND  B.ITM_NBR          = C.ITM_NBR              07260099
171410                 AND  B.VER_STATUS_CDE   = 'A'                    07270099
171410            ORDER BY  A.ASN_LVL_CDE DESC                          07280099
171410                     ,A.PO_NBR                                    07290099
171410                     ,A.RCVR_SEQ_NBR                              07300099
171410                     ,A.PO_LNE_NBR                                07310099
171410     END-EXEC.                                                    07320099
171410                                                                  07330099
171410*---------------------------------------------------------------* 07340099
171410*    SKU CURSOR                                                   07350099
171410*---------------------------------------------------------------* 07360099
171410     EXEC SQL                                                     07370099
171410          DECLARE WMS-SKU-CSR CURSOR FOR                          07380099
171410              SELECT  A.PO_NBR                                    07390099
171410                     ,A.RCVR_SEQ_NBR                              07400099
171410                     ,A.PO_LNE_NBR                                07410099
171410                     ,A.PREPK_ID                                  07420099
171410                     ,A.ASN_LVL_CDE                               07430099
171410                     ,A.DWNLD_CDE                                 07440099
171410                     ,A.CRE_TMST                                  07450099
171410                     ,A.CRE_USR_ID                                07460099
171410                     ,C.SKU_NBR                                   07470099
171410                FROM  WST_SHPMT_XREF_DTL A                        07480099
171410                     ,TPURITM            B                        07490099
171410                     ,XLT_SKU            C                        07500099
171410               WHERE  A.EXT_SHP_ID       = :DK-EXT-SHP-ID         07510099
171410                 AND  A.ACTV_CDE         = 'A'                    07520099
171410                 AND  C.SKU_NBR          = :DK-SKU-NBR            07530099
171410                 AND  A.PO_NBR           = B.PO_NBR               07540099
171410                 AND  A.PO_LNE_NBR       = B.PO_LNE_NBR           07550099
171410                 AND  B.ITM_NBR          = C.ITM_NBR              07560099
171410                 AND  B.VER_STATUS_CDE   = 'A'                    07570099
171410            ORDER BY  A.PO_NBR                                    07580099
171410                     ,A.RCVR_SEQ_NBR                              07590099
171410                     ,A.PO_LNE_NBR                                07600099
171410     END-EXEC.                                                    07610099
171410                                                                  07620099
171410*---------------------------------------------------------------* 07630099
171410*    SKU ASN SEQUENCE CURSOR                                      07640099
171410*---------------------------------------------------------------* 07650099
171410     EXEC SQL                                                     07660099
171410          DECLARE WMS-SKUASN-CSR CURSOR FOR                       07670099
171410              SELECT  A.PO_NBR                                    07680099
171410                     ,A.RCVR_SEQ_NBR                              07690099
171410                     ,A.PO_LNE_NBR                                07700099
171410                     ,A.PREPK_ID                                  07710099
171410                     ,A.ASN_LVL_CDE                               07720099
171410                     ,A.DWNLD_CDE                                 07730099
171410                     ,A.CRE_TMST                                  07740099
171410                     ,A.CRE_USR_ID                                07750099
171410                     ,C.SKU_NBR                                   07760099
171410                FROM  WST_SHPMT_XREF_DTL A                        07770099
171410                     ,TPURITM            B                        07780099
171410                     ,XLT_SKU            C                        07790099
171410               WHERE  A.EXT_SHP_ID       = :DK-EXT-SHP-ID         07800099
171410                 AND  A.ACTV_CDE         = 'A'                    07810099
171410                 AND  C.SKU_NBR          = :DK-SKU-NBR            07820099
171410                 AND  A.PO_NBR           = B.PO_NBR               07830099
171410                 AND  A.PO_LNE_NBR       = B.PO_LNE_NBR           07840099
171410                 AND  B.ITM_NBR          = C.ITM_NBR              07850099
171410                 AND  B.VER_STATUS_CDE   = 'A'                    07860099
171410            ORDER BY  A.ASN_LVL_CDE DESC                          07870099
171410                     ,A.PO_NBR                                    07880099
171410                     ,A.RCVR_SEQ_NBR                              07890099
171410                     ,A.PO_LNE_NBR                                07900099
171410     END-EXEC.                                                    07910099
086700                                                                  07920000
086710                                                                  07930000
086800*-----------------------------------------------------------------07940000
086900 LINKAGE SECTION.                                                 07950000
087000                                                                  07960000
087100 01  DFHCOMMAREA.                                                 07970000
087200     05  FILLER                         OCCURS  1 TO 4072 TIMES   07980000
087300                                        DEPENDING ON EIBCALEN.    07990000
087400         10  FILLER                     PIC X.                    08000000
087500                                                                  08010000
087600                                                                  08020000
087700 PROCEDURE DIVISION.                                              08030000
087710                                                                  08040000
087800 0000-MAIN-MODULE.                                                08050000
087900     PERFORM 0520-CICS-LOGGING.                                   08060000
088000     IF PS-CICS-SWITCH-YES                                        08070000
088100         INITIALIZE PV-CICS-MSG-AREA                              08080000
088200         STRING ' ' PV-SRC-TASK-NUMBER                            08090000
088300                ' WSKCS316-0000: STARTED PROGRAM'                 08100000
088400                DELIMITED BY SIZE                                 08110000
088500                          INTO PV-CICS-MSG-AREA                   08120000
088600         PERFORM 7000-WRITE-TO-CICS-LOG                           08130000
088610     END-IF.                                                      08140000
088700*                                                                 08150000
088701     INITIALIZE DP030-CICS-API-FIELDS.                            08160000
088702     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       08170000
088703     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          08180000
088704     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         08190000
088705     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       08200000
088706     MOVE LENGTH OF WS316AI        TO DP030-MAP-LENGTH (1).       08210000
088707     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     08220000
088708     IF PS-CICS-SWITCH-YES                                        08230000
088709         INITIALIZE PV-CICS-MSG-AREA                              08240000
088710         STRING ' ' PV-SRC-TASK-NUMBER                            08250000
088720                ' WSKCS316-0000: PROGRAM ENTRY CALL'              08260000
088730                ' MAPSET=' PC-CURRENT-MAPSET-NAME                 08270000
088740                ' MAP=' PC-CURRENT-MAP-NAME                       08280000
088750                DELIMITED BY SIZE                                 08290000
088760                          INTO PV-CICS-MSG-AREA                   08300000
088770         PERFORM 7000-WRITE-TO-CICS-LOG                           08310000
088771     END-IF.                                                      08320000
088772*                                                                 08330000
088773     PERFORM 0001-CALL-CICS-ARCH-API.                             08340000
088774*                                                                 08350000
088800     PERFORM 1000-CONTROL-PROCESSING                              08360000
088900*                                                                 08370000
089000     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     08380000
089100     PERFORM 0001-CALL-CICS-ARCH-API.                             08390000
089200                                                                  08400000
089300******************************************************************08410000
089400**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **08420000
089500**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **08430000
089600******************************************************************08440000
089700 0001-CALL-CICS-ARCH-API.                                         08450000
089800     IF PS-CICS-SWITCH-YES                                        08460000
089900         INITIALIZE PV-CICS-MSG-AREA                              08470000
090000         STRING ' ' PV-SRC-TASK-NUMBER                            08480000
090100                ' WSKCS316-0001'                                  08490000
090200                DELIMITED BY SIZE                                 08500000
090300                          INTO PV-CICS-MSG-AREA                   08510000
090400         PERFORM 7000-WRITE-TO-CICS-LOG                           08520000
090401     END-IF.                                                      08530000
090402*                                                                 08540000
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      08550099
090404                                    DFHCOMMAREA                   08560099
090405                                    DP030-CICS-API-FIELDS         08570099
090406                                    DP020-STANDARD-COMMAREA       08580099
090407                                    WS316AI.                      08590099
090408*                                                                 08600000
090409     IF DP030-RC-CALL-SUCCESSFUL                                  08610000
090500         CONTINUE                                                 08620000
090600     ELSE                                                         08630000
090700         SET DP013-NO-ROLLBACK                                    08640000
090800             DP013-XCTL-DISPLAY-RESTART                           08650000
090900             DP013-CICS-ABEND      TO TRUE                        08660000
091000         MOVE '0001-CALL-CICS-ARCH-API'                           08670000
091100                                   TO DP013-PARAGRAPH             08680000
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O08690099
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      08700099
091400         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      08710000
091500         PERFORM DP013-0000-PROCESS-ABEND                         08720000
091600     END-IF.                                                      08730000
091700                                                                  08740000
091701     MOVE WS010-SRC-TASK-NUMBER     TO PV-SRC-TASK-NUMBER.        08750000
091702                                                                  08760000
091703 0520-CICS-LOGGING.                                               08770000
091704                                                                  08780000
091705* READ PARM TO DETERMINE CICS LOGGING                             08790000
091706     EXEC SQL                                                     08800000
091707         SELECT  D.ATTR_ELEM_TXT                                  08810000
091708         INTO  :PS-CICS-SWITCH-IND                                08820000
091709         FROM   WST_INTGRTN_TYP A                                 08830000
091710              , WST_ATTR_DEFN   B                                 08840000
091720              , WST_ATTR_ELEM   C                                 08850000
091730              , WST_ATTR_ELEM   D                                 08860000
091740         WHERE  A.INTGRTN_TYP_CDE   = 'CSSLLOG'                   08870000
091750           AND  A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE           08880000
091760           AND  B.ATTR_DEFN_SEQ_NBR = 1                           08890000
091770           AND  B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE           08900000
091780           AND  C.ATTR_DEFN_SEQ_NBR = 1                           08910000
091790           AND  B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE           08920000
091800           AND  D.ATTR_DEFN_SEQ_NBR = 2                           08930000
091900           AND  C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR         08940000
092000           AND  C.ATTR_ELEM_TXT     = 'WSKCS316'                  08950000
092100     END-EXEC.                                                    08960000
092200                                                                  08970000
092300     EVALUATE TRUE                                                08980000
092400         WHEN SQLCODE = ZERO                                      08990000
092500             IF PS-CICS-SWITCH-YES                                09000000
092600                 INITIALIZE PV-CICS-MSG-AREA                      09010000
092700                 STRING   ' ' PV-SRC-TASK-NUMBER                  09020000
092800                          ' WSKCS316-0520:'                       09030000
092900                          ' CICS LOGGING: '                       09040000
093000                          PS-CICS-SWITCH-IND                      09050000
093100                          DELIMITED BY SIZE                       09060000
093200                          INTO PV-CICS-MSG-AREA                   09070000
093300                 PERFORM 7000-WRITE-TO-CICS-LOG                   09080000
093400             END-IF                                               09090000
093500         WHEN SQLCODE = -904                                      09100000
093600         WHEN SQLCODE = -913                                      09110000
093700         WHEN SQLCODE = -911                                      09120000
093800         WHEN SQLCODE = -803                                      09130000
093900             CONTINUE                                             09140000
094000         WHEN SQLWARN0 NOT = SPACES                               09150000
094100         WHEN SQLCODE NOT = ZERO                                  09160000
094200             INITIALIZE PV-CICS-MSG-AREA                          09170000
094300             MOVE SQLCODE               TO PV-DISPLAY             09180000
094400             STRING   ' ' PV-SRC-TASK-NUMBER                      09190000
094500                      ' WSKCS316-0520 ERROR:'                     09200000
094600                      ' SQL='                                     09210000
094700                      PV-DISPLAY                                  09220000
094800                      DELIMITED BY SIZE                           09230000
094900                                      INTO PV-CICS-MSG-AREA       09240000
095000             PERFORM 7000-WRITE-TO-CICS-LOG                       09250000
095100                                                                  09260000
095200             STRING 'SQL='                                        09270000
095300                  PV-DISPLAY                                      09280000
095400                  DELIMITED BY SIZE                               09290000
095500                                      INTO DP013-MESSAGE-TEXT(1)  09300000
095600             MOVE SQLCA                 TO DP013-SQLCA            09310000
095700             MOVE '0520-CICS-LOGGING'   TO DP013-PARAGRAPH        09320000
095800             MOVE 'WST_INTGRTN_TYP'     TO                        09330000
095900                                       DP013-DB2-TABLE-NAME (1)   09340000
096000             MOVE 'WST_ATTR_DEFN'       TO                        09350000
096100                                       DP013-DB2-TABLE-NAME (2)   09360000
096200             MOVE 'WST_ATTR_ELEM'       TO                        09370000
096300                                       DP013-DB2-TABLE-NAME (3)   09380000
096400             SET DP013-DB2-ABEND        TO TRUE                   09390000
108500             PERFORM DP013-0000-PROCESS-ABEND                     09400000
108600                                                                  09410000
108601     END-EVALUATE.                                                09420000
108602                                                                  09430000
108603*----------------------------------------------------------------*09440000
108604* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *09450000
108605* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *09460000
108606*                                                                *09470000
108607* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *09480000
108608*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *09490000
108609*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *09500000
108610*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *09510000
108611*----------------------------------------------------------------*09520000
108612                                                                  09530000
108613 1000-CONTROL-PROCESSING.                                         09540000
108614                                                                  09550000
108615     IF PS-CICS-SWITCH-YES                                        09560000
108616         INITIALIZE PV-CICS-MSG-AREA                              09570000
108617         STRING ' ' PV-SRC-TASK-NUMBER                            09580000
108618                ' WSKCS316-1000'                                  09590000
108619                DELIMITED BY SIZE                                 09600000
108620                          INTO PV-CICS-MSG-AREA                   09610000
108630         PERFORM 7000-WRITE-TO-CICS-LOG                           09620000
108631     END-IF.                                                      09630000
108632*                                                                 09640000
108633     EVALUATE TRUE                                                09650000
108634         WHEN DP020-NEXT-ACT-INITIAL                              09660000
108635             INITIALIZE ASC-SPECIFIC-COMMAREA                     09670000
108636             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            09680000
108637                                      ASC-SEL-TERM-ID-OUT         09690000
108638             MOVE DP020-SRC-TASK-NUMBER                           09700000
108639                                   TO ASC-LIST-TASK-NUMBER        09710000
108640                                      ASC-SEL-TASK-NUMBER-OUT     09720000
171410             SET ASC-PO-SEQ        TO TRUE                        09730099
171410             SET ASC-WMS-SHIP-CURSOR                              09740099
171410                                   TO TRUE                        09750099
108641             PERFORM 1100-PROCESS-INTER-APPL-COMM                 09760000
108642             IF PS-COMMAREA-NOT-VALID                             09770000
108643                 SET DP020-NEXT-ACT-APPL-ERROR                    09780000
108644                                   TO TRUE                        09790000
108645             ELSE                                                 09800000
108646                 PERFORM 4000-BUILD-INITIAL-PANEL                 09810000
108647             END-IF                                               09820000
108648                                                                  09830000
108649         WHEN DP020-NEXT-ACT-READ-MAP                             09840000
108650             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        09850000
108651                                   TO PV-TOP-ITEM                 09860000
108652             PERFORM 2000-PROCESS-PANEL                           09870000
108653                                                                  09880000
108654         WHEN DP020-NEXT-ACT-RETURN                               09890000
108655             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        09900000
108656                                   TO PV-TOP-ITEM                 09910000
108657             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    09920000
108658                                                                  09930000
108659             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 09940000
108660             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09950000
108661                                                                  09960000
108662         WHEN OTHER                                               09970000
108663             SET DP013-LOGIC-ABEND TO TRUE                        09980000
108664             SET DP013-NO-ROLLBACK TO TRUE                        09990000
108665             MOVE '1000-CONTROL-PROCESSING'                       10000000
108666                                   TO DP013-PARAGRAPH             10010000
108667             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    10020000
108668                                   TO DP013-MESSAGE-TEXT(1)       10030000
108669             PERFORM DP013-0000-PROCESS-ABEND                     10040000
108670     END-EVALUATE.                                                10050000
108671                                                                  10060000
108672 EJECT                                                            10070000
108673*----------------------------------------------------------------*10080000
108674* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *10090000
108675* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *10100000
108676*----------------------------------------------------------------*10110000
108677                                                                  10120000
108678 1100-PROCESS-INTER-APPL-COMM.                                    10130000
108679                                                                  10140000
108680     IF PS-CICS-SWITCH-YES                                        10150000
108690         INITIALIZE PV-CICS-MSG-AREA                              10160000
108700         STRING ' ' PV-SRC-TASK-NUMBER                            10170000
108800                ' WSKCS316-1100'                                  10180000
108900                ' WS010-EXT-SHP-ID=' WS010-EXT-SHP-ID             10190000
109000                DELIMITED BY SIZE                                 10200000
109100                          INTO PV-CICS-MSG-AREA                   10210000
109200         PERFORM 7000-WRITE-TO-CICS-LOG                           10220000
109201     END-IF.                                                      10230000
109202*                                                                 10240000
109203     SET PS-COMMAREA-VALID        TO TRUE.                        10250000
109204     MOVE SPACE                   TO ASC-START-ITEM-REQUEST.      10260000
109205                                                                  10270000
109206     IF WS010-NUMBER-OF-SELECTED-ITEMS > 0                        10280000
109207         MOVE WS010-EXT-SHP-ID        TO ASC-KEY-SHPMT-ID         10290000
109208                                         DK-EXT-SHP-ID            10300099
109209         MOVE WS010-SCAC              TO ASC-CARRIER              10310000
109210         MOVE WS010-TRLR-ID           TO ASC-TRAILER              10320000
109211         MOVE WS010-TRIP-ID           TO ASC-TRIP-ID              10330000
      **AMIT                                                            10340099
                                               DK-TRIP-ID               10350099
      **AMIT                                                            10360099
109212         MOVE WS010-DWNLD-TIME        TO ASC-DWNLD-TIME           10370099
516200*        MM/YY FORMAT                                             10380000
516201         IF WS010-DWNLD-DATE = SPACES                             10390000
516202             MOVE SPACES           TO ASC-DWNLD-DATE              10400000
516203         ELSE                                                     10410000
516204             STRING WS010-DWNLD-DATE(1:2)                         10420000
516205                    '/'                                           10430000
516206                    WS010-DWNLD-DATE(4:2)                         10440000
516207                    DELIMITED BY SIZE                             10450000
516208                                 INTO ASC-DWNLD-DATE              10460000
516209         END-IF                                                   10470000
      **AMIT                                                            10480099
516679         PERFORM 1113-GET-RECEIVING                               10490099
      **AMIT                                                            10500099
516210         SET ASC-USE-SELECTION-QUEUE   TO TRUE                    10510099
516220         MOVE WS010-NUMBER-OF-TS-ITEMS TO ASC-NUMBER-OF-TS-ITEMS  10520000
516230         MOVE WS010-NUMBER-OF-SELECTED-ITEMS                      10530000
516240                                TO ASC-NUMBER-OF-SELECTED-ITEMS   10540000
516250         MOVE WS010-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME-IN   10550000
516260         MOVE SPACES                   TO ASC-SEL-QUEUE-NAME-OUT  10560000
516270         PERFORM 1120-PREPARE-LIST-ENTRY                          10570000
516280     ELSE                                                         10580000
516290         MOVE PC-TSYMSG-00057       TO DP020-MSG-NUMBER           10590000
516300         SET PS-COMMAREA-NOT-VALID TO TRUE                        10600000
516301     END-IF.                                                      10610000
516302/                                                                 10620000
516303*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*10630000
516304 1120-PREPARE-LIST-ENTRY.                                         10640000
516305                                                                  10650000
516306     IF PS-CICS-SWITCH-YES                                        10660000
516307         INITIALIZE PV-CICS-MSG-AREA                              10670000
516308         STRING ' ' PV-SRC-TASK-NUMBER                            10680000
516309                ' WSKCS316-1120'                                  10690000
516310                DELIMITED BY SIZE                                 10700000
516320                          INTO PV-CICS-MSG-AREA                   10710000
516330         PERFORM 7000-WRITE-TO-CICS-LOG                           10720000
516331     END-IF.                                                      10730000
516332*                                                                 10740000
516333     MOVE WS011-MAX-ITEMS          TO ASC-SEL-SUB.                10750000
516334     MOVE ZERO                     TO ASC-SEL-ITEM.               10760000
516335     PERFORM 1130-GET-NEXT-RECORD.                                10770000
516336                                                                  10780000
516337*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*10790000
516338* GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED   *10800000
516339*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*10810000
516340 1130-GET-NEXT-RECORD.                                            10820000
516350                                                                  10830000
516360     IF PS-CICS-SWITCH-YES                                        10840000
516370         INITIALIZE PV-CICS-MSG-AREA                              10850000
516380         STRING ' ' PV-SRC-TASK-NUMBER                            10860000
516390                ' WSKCS316-1130'                                  10870000
516400                DELIMITED BY SIZE                                 10880000
516500                          INTO PV-CICS-MSG-AREA                   10890000
516600         PERFORM 7000-WRITE-TO-CICS-LOG                           10900000
516601     END-IF.                                                      10910000
516602*                                                                 10920000
516603     ADD +1                       TO ASC-SEL-SUB.                 10930000
516604                                                                  10940000
516605     IF ASC-SEL-SUB > WS011-MAX-ITEMS                             10950000
516606         ADD +1                   TO ASC-SEL-ITEM                 10960000
516607         MOVE +1                  TO ASC-SEL-SUB                  10970000
516608     END-IF.                                                      10980000
516609                                                                  10990000
516610     IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                 11000000
516620         PERFORM 9100-READ-SEL-QUEUE                              11010000
516630         IF WS011-ITEM (ASC-SEL-SUB) > ZERO                       11020000
516640             MOVE WS011-EXT-SHP-ID (ASC-SEL-SUB)                  11030000
516650                                  TO ASC-KEY-SHPMT-ID             11040000
516660                                     DK-EXT-SHP-ID                11050000
516670**GB 12/7/07 BEG                                                  11060000
516671             IF WS011-DWNLD-DATE (ASC-SEL-SUB) = SPACES           11070000
516672                 MOVE SPACES           TO ASC-DWNLD-DATE          11080000
516673             ELSE                                                 11090000
516674                 STRING WS011-DWNLD-DATE (ASC-SEL-SUB) (1:2)      11100000
516675                       '/'                                        11110000
516676                       WS011-DWNLD-DATE  (ASC-SEL-SUB) (4:2)      11120000
516677                        DELIMITED BY SIZE                         11130000
516678                                     INTO ASC-DWNLD-DATE          11140000
516679                 MOVE WS011-DWNLD-TIME  (ASC-SEL-SUB)             11150000
516680                                  TO    ASC-DWNLD-TIME            11160000
516681             END-IF                                               11170099
516682**GB 12/7/07 END                                                  11180099
516683                                                                  11190099
516684         ELSE                                                     11200099
516690             SUBTRACT +1 FROM ASC-SEL-SUB                         11210000
516700             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             11220000
516800             SET DP020-MSG-INFORMATIONAL                          11230000
516900                 PS-LIST-END             TO TRUE                  11240000
517000         END-IF                                                   11250000
517100     ELSE                                                         11260000
517200         SUBTRACT +1 FROM ASC-SEL-ITEM                            11270000
517300         MOVE WS011-MAX-ITEMS     TO ASC-SEL-SUB                  11280000
517400         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             11290000
517500         SET DP020-MSG-INFORMATIONAL                              11300000
517600             PS-LIST-END             TO TRUE                      11310000
517700     END-IF.                                                      11320000
517800*                                                                 11330000
517900*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*11340000
518000*    GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING      *11350000
518100*    PROCESSED.                                                  *11360000
518200*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*11370000
518300 1140-GET-PREV-RECORD.                                            11380000
518400                                                                  11390000
518500     IF PS-CICS-SWITCH-YES                                        11400000
518600         INITIALIZE PV-CICS-MSG-AREA                              11410000
518700         STRING ' ' PV-SRC-TASK-NUMBER                            11420000
518800                ' WSKCS316-1140'                                  11430000
518900                DELIMITED BY SIZE                                 11440000
519000                          INTO PV-CICS-MSG-AREA                   11450000
519100         PERFORM 7000-WRITE-TO-CICS-LOG                           11460000
519101     END-IF.                                                      11470000
519102*                                                                 11480000
519103     SUBTRACT +1 FROM ASC-SEL-SUB.                                11490000
519104                                                                  11500000
519105     IF ASC-SEL-SUB < +1                                          11510000
519106         SUBTRACT +1 FROM ASC-SEL-ITEM                            11520000
519107         MOVE WS011-MAX-ITEMS     TO ASC-SEL-SUB                  11530000
519108     END-IF.                                                      11540000
519109                                                                  11550000
519110     IF ASC-SEL-ITEM > ZERO                                       11560000
519120         PERFORM 9100-READ-SEL-QUEUE                              11570000
519130         MOVE WS011-EXT-SHP-ID (ASC-SEL-SUB)                      11580000
519140                                  TO ASC-KEY-SHPMT-ID             11590000
519150                                     DK-EXT-SHP-ID                11600000
519160     ELSE                                                         11610000
519170         MOVE +1                  TO ASC-SEL-ITEM                 11620000
519180                                     ASC-SEL-SUB                  11630000
519190         MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             11640000
519200         SET DP020-MSG-INFORMATIONAL                              11650000
519300             PS-LIST-END             TO TRUE                      11660000
519400     END-IF.                                                      11670000
519401*                                                                 11680000
519402*----------------------------------------------------------------*11690000
519403* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *11700000
519404* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *11710000
519405* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *11720000
519406* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *11730000
519407* FUNCTION KEYS CAN GET THIS FAR.                                *11740000
519408*----------------------------------------------------------------*11750000
519409                                                                  11760000
519410 2000-PROCESS-PANEL.                                              11770000
519420                                                                  11780000
519430     IF PS-CICS-SWITCH-YES                                        11790000
519440         INITIALIZE PV-CICS-MSG-AREA                              11800000
519450         STRING ' ' PV-SRC-TASK-NUMBER                            11810000
519460                ' WSKCS316-2000'                                  11820000
519470                DELIMITED BY SIZE                                 11830000
519480                          INTO PV-CICS-MSG-AREA                   11840000
519490         PERFORM 7000-WRITE-TO-CICS-LOG                           11850000
519491     END-IF.                                                      11860000
519492*                                                                 11870000
519493     EVALUATE TRUE                                                11880000
519494         WHEN DP020-SRC-AID = DP016-CLEAR                         11890000
519495             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    11900000
519496             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   11910000
519497             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11920000
519498                                                                  11930000
519499         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    11940099
519500             PERFORM 2050-DELETE-LIST-QUEUE                       11950000
171410             MOVE SPACES             TO ASC-PO-SRCH               11960099
171410                                        ASC-SKU-SRCH              11970099
171410             SET ASC-PO-SEQ          TO TRUE                      11980099
171410             SET ASC-WMS-SHIP-CURSOR TO TRUE                      11990099
519501             PERFORM 4000-BUILD-INITIAL-PANEL                     12000000
519502                                                                  12010000
519503         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    12020000
519504             PERFORM 2140-DESELECT-ALL-ITEMS                      12030000
519505             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12040000
519506*F21                                                              12050000
519507         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  12060000
519508             PERFORM 2150-SELECT-ALL-ITEMS                        12070000
519509             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12080000
519510                                                                  12090000
519520*F20                                                              12100000
519521         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             12110000
519522*                                                                 12120000
519523             IF ASC-USE-SELECTION-QUEUE                           12130000
519524                 PERFORM 1130-GET-NEXT-RECORD                     12140000
519525                 IF PS-LIST-END                                   12150000
519526                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         12160000
519527                     SET PS-NO-LIST-END TO TRUE                   12170000
519528                 ELSE                                             12180000
519529                     PERFORM 2050-DELETE-LIST-QUEUE               12190000
519530                     PERFORM 3200-RESET-ATTRIBUTES                12200000
519540                     PERFORM 3205-RESET-ATTRIBUTES-2              12210000
519550                     PERFORM 4000-BUILD-INITIAL-PANEL             12220000
519560                 END-IF                                           12230000
519570              ELSE                                                12240000
519580                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             12250000
519590*                --- BOTTOM OF LIST ---                           12260000
519600                 MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER         12270000
519700                 SET DP020-MSG-INFORMATIONAL TO TRUE              12280000
519800             END-IF                                               12290000
519900*F19                                                              12300000
520000         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             12310000
520100             IF ASC-USE-SELECTION-QUEUE                           12320000
520200                 PERFORM 1140-GET-PREV-RECORD                     12330000
520300                 IF PS-LIST-END                                   12340000
520400                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         12350000
520500                     SET PS-NO-LIST-END TO TRUE                   12360000
520600                 ELSE                                             12370000
520700                     PERFORM 2050-DELETE-LIST-QUEUE               12380000
520800                     PERFORM 3200-RESET-ATTRIBUTES                12390000
520900                     PERFORM 3205-RESET-ATTRIBUTES-2              12400000
521000                     PERFORM 4000-BUILD-INITIAL-PANEL             12410000
521100                 END-IF                                           12420000
521200             ELSE                                                 12430000
521300                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             12440000
521400                 MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER         12450000
521500                 SET DP020-MSG-INFORMATIONAL TO TRUE              12460000
521600             END-IF                                               12470000
521601                                                                  12480000
521602         WHEN OTHER                                               12490000
521603             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 12500000
521604             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   12510000
521605             IF PS-NO-ERROR                                       12520000
521606                 SET DP030-CONTINUE-GO                            12530000
521607                                 TO TRUE                          12540000
521608                 PERFORM 2100-CHECK-FUNCTION-KEY                  12550000
521609             ELSE                                                 12560000
521610                 SET DP030-OVERRIDE-GO                            12570000
521611                                 TO TRUE                          12580000
521612             END-IF                                               12590000
521613     END-EVALUATE.                                                12600000
521614 EJECT                                                            12610000
521615*----------------------------------------------------------------*12620000
521616*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *12630000
521617*----------------------------------------------------------------*12640000
521618 2050-DELETE-LIST-QUEUE.                                          12650000
521619                                                                  12660000
521620     IF PS-CICS-SWITCH-YES                                        12670000
521630         INITIALIZE PV-CICS-MSG-AREA                              12680000
521640         STRING ' ' PV-SRC-TASK-NUMBER                            12690000
521650                ' WSKCS316-2050'                                  12700099
521660                ' DELETE QUEUE=' ASC-LIST-QUEUE-NAME              12710000
521670                DELIMITED BY SIZE                                 12720000
521680                          INTO PV-CICS-MSG-AREA                   12730000
521690         PERFORM 7000-WRITE-TO-CICS-LOG                           12740000
521691     END-IF.                                                      12750000
521692*                                                                 12760000
521693     EXEC CICS                                                    12770000
521694         DELETEQ TS                                               12780000
521695             QUEUE (ASC-LIST-QUEUE-NAME)                          12790000
521696             RESP  (PV-CICS-RESP)                                 12800000
521697     END-EXEC.                                                    12810000
521698                                                                  12820000
521699     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       12830000
521700        (PV-CICS-RESP = DFHRESP(QIDERR))                          12840000
521701         CONTINUE                                                 12850000
521702     ELSE                                                         12860000
521703         IF PS-CICS-SWITCH-YES                                    12870000
521704             INITIALIZE PV-CICS-MSG-AREA                          12880000
521705             MOVE PV-CICS-RESP TO PV-DISPLAY                      12890000
521706             STRING ' ' PV-SRC-TASK-NUMBER                        12900000
521707                    ' WSKCS316-2050'                              12910000
521708                    ' ERROR, PV-CICS-RESP=' PV-DISPLAY            12920000
521709                    DELIMITED BY SIZE                             12930000
521710                              INTO PV-CICS-MSG-AREA               12940000
521720             PERFORM 7000-WRITE-TO-CICS-LOG                       12950000
521721         END-IF                                                   12960000
521722         SET DP013-CICS-ABEND      TO TRUE                        12970000
521723         SET DP013-NO-ROLLBACK     TO TRUE                        12980000
521724                                                                  12990000
521725         MOVE '2050-DELETE-LIST-QUEUE'                            13000000
521726                                   TO DP013-PARAGRAPH             13010000
521727         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    13020000
521728                                   TO DP013-MESSAGE-TEXT (1)      13030000
521729         PERFORM DP013-0000-PROCESS-ABEND                         13040000
521730     END-IF.                                                      13050000
521731                                                                  13060000
521732     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  13070000
521733/                                                                 13080000
521734*----------------------------------------------------------------*13090000
521735* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*13100000
521736* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *13110000
521737* CICS ARCHITECTURE API.                                         *13120000
521738*----------------------------------------------------------------*13130000
521739 2100-CHECK-FUNCTION-KEY.                                         13140000
521740                                                                  13150000
521750     IF PS-CICS-SWITCH-YES                                        13160000
521760         INITIALIZE PV-CICS-MSG-AREA                              13170000
521770         STRING ' ' PV-SRC-TASK-NUMBER                            13180000
521780                ' WSKCS316-2100'                                  13190000
521790                DELIMITED BY SIZE                                 13200000
521800                          INTO PV-CICS-MSG-AREA                   13210000
521900         PERFORM 7000-WRITE-TO-CICS-LOG                           13220000
521901     END-IF.                                                      13230000
521902*                                                                 13240000
521903     EVALUATE TRUE                                                13250000
171410         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              13260099
171410             IF ASC-PO-SEQ                                        13270099
171410                SET ASC-LEVEL-SEQ      TO TRUE                    13280099
171410             ELSE                                                 13290099
171410                SET ASC-PO-SEQ         TO TRUE                    13300099
171410             END-IF                                               13310099
171410             PERFORM 2050-DELETE-LIST-QUEUE                       13320099
171410             PERFORM 4005-PREPARE-CURSOR                          13330099
171410             PERFORM 4000-BUILD-INITIAL-PANEL                     13340099
171410                                                                  13350099
171410         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              13360099
171410             PERFORM 2050-DELETE-LIST-QUEUE                       13370099
171410             PERFORM 4005-PREPARE-CURSOR                          13380099
171410             PERFORM 4000-BUILD-INITIAL-PANEL                     13390099
171410                                                                  13400099
521904         WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)              13410099
521905                                                                  13420000
521906             PERFORM 2050-DELETE-LIST-QUEUE                       13430000
521907             PERFORM 4000-BUILD-INITIAL-PANEL                     13440000
521908                                                                  13450000
521909         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  13460000
521910             MOVE +1               TO PV-TOP-ITEM                 13470000
521911             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13480000
521912                                                                  13490000
521913         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   13500000
521914             PERFORM 2110-BROWSE-BACKWARD                         13510000
521915             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13520000
521916                                                                  13530000
521917         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   13540000
521918             PERFORM 2120-BROWSE-FORWARD                          13550000
521919             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13560000
521920                                                                  13570000
521921         WHEN DP020-SRC-AID = DP016-ENTER                         13580000
521922             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   13590000
521923             IF PS-ERROR                                          13600000
521924                 CONTINUE                                         13610000
521925             ELSE                                                 13620000
521926                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             13630000
521927             END-IF                                               13640000
521928                                                                  13650000
521929         WHEN OTHER                                               13660000
521930             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   13670000
521931             IF PS-ERROR                                          13680000
521932                 CONTINUE                                         13690000
521933             ELSE                                                 13700000
521934                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             13710000
521935             END-IF                                               13720000
521936                                                                  13730000
521937     END-EVALUATE.                                                13740000
521938*                                                                 13750000
521939*----------------------------------------------------------------*13760000
521940* CHECK TO SEE IF USER HAS RACF AUTHORIZATION                     13770000
521941*----------------------------------------------------------------*13780000
521942 2105-RACF-ACCESS.                                                13790000
521943                                                                  13800000
521944     IF PS-CICS-SWITCH-YES                                        13810000
521945         INITIALIZE PV-CICS-MSG-AREA                              13820000
521946         STRING ' ' PV-SRC-TASK-NUMBER                            13830000
521947                ' WSKCS316-2105'                                  13840000
521948                DELIMITED BY SIZE                                 13850000
521949                          INTO PV-CICS-MSG-AREA                   13860000
521950         PERFORM 7000-WRITE-TO-CICS-LOG                           13870000
521951     END-IF.                                                      13880000
521952*                                                                 13890000
521953      SET DP008-RSRC-TYPE-FUNC           TO TRUE                  13900000
521954      SET DP008-ACCESS-TYPE-USE          TO TRUE                  13910000
521955                                                                  13920000
521956      EXEC CICS                                                   13930000
521957         LINK PROGRAM (DP008-SECURITY-SUBROUTINE)                 13940000
521958              COMMAREA (DP008-SECURITY-COMMAREA)                  13950000
521959              LENGTH (DP008-SECURITY-COMMAREA-LENGTH)             13960000
521960      END-EXEC                                                    13970000
521961                                                                  13980000
521962      IF DP008-CALL-SUCCESSFUL                                    13990000
521963         IF DP008-ACCESS-ALLOWED                                  14000000
521964             SET PS-ACCESS-ALLOWED TO TRUE                        14010000
521965         ELSE                                                     14020000
521966             SET PS-ACCESS-NOT-ALLOWED TO TRUE                    14030000
521967             MOVE DP008-ERROR-CODE TO PV-RACF-ERROR-CODE          14040000
521968             INITIALIZE PV-CICS-MSG-AREA                          14050000
521969             STRING ' ' PV-SRC-TASK-NUMBER                        14060000
521970                    ' WSKCS316- RACF -'                           14070000
521971                    ' DP008-ACCESS-SW- '                          14080000
521972                      DP008-ACCESS-SW                             14090000
521973                    ' RACF ERROR CODE-'                           14100000
521974                      PV-RACF-ERROR-CODE                          14110000
521975                      DELIMITED BY SIZE                           14120000
521976                                    INTO PV-CICS-MSG-AREA         14130000
521977             PERFORM 7000-WRITE-TO-CICS-LOG                       14140000
521978         END-IF                                                   14150000
521979     ELSE                                                         14160000
521980         MOVE ' 2105-RACF-ACCESS' TO DP013-PARAGRAPH              14170000
521981          MOVE 'UNABLE TO ACCESS CICS'                            14180000
521982                               TO DP013-MESSAGE-TEXT (1)          14190000
521983          MOVE SQLCA           TO DP013-SQLCA                     14200000
521984          SET DP013-DB2-ABEND                                     14210000
521985              DP013-XCTL-DISPLAY-RESTART TO TRUE                  14220000
521986          PERFORM DP013-0000-PROCESS-ABEND                        14230000
521987      END-IF.                                                     14240000
521988                                                                  14250000
521989*                                                                 14260000
521990*----------------------------------------------------------------*14270000
521991*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *14280000
521992*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *14290000
521993*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *14300000
521994*    MESSAGE.                                                    *14310000
521995*----------------------------------------------------------------*14320000
521996                                                                  14330000
521997 2110-BROWSE-BACKWARD.                                            14340000
521998                                                                  14350000
521999     IF PS-CICS-SWITCH-YES                                        14360000
522000         INITIALIZE PV-CICS-MSG-AREA                              14370000
522100         STRING ' ' PV-SRC-TASK-NUMBER                            14380000
522200                ' WSKCS316-2110'                                  14390000
522300                DELIMITED BY SIZE                                 14400000
522400                          INTO PV-CICS-MSG-AREA                   14410000
522500         PERFORM 7000-WRITE-TO-CICS-LOG                           14420000
522501     END-IF.                                                      14430000
522502*                                                                 14440000
522503     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    14450000
522504         GIVING PV-TOP-ITEM.                                      14460000
522505*                                                                 14470000
522506     IF ((PV-TOP-ITEM < +1)                                       14480000
522507       OR (PV-TOP-ITEM = +1))                                     14490000
522508         MOVE +1                   TO PV-TOP-ITEM                 14500000
522509*        -- TOP OF LIST --                                        14510000
522510         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            14520000
522511         SET DP020-MSG-INFORMATIONAL TO TRUE                      14530000
522512     END-IF.                                                      14540000
522513                                                                  14550000
522514 EJECT                                                            14560000
522515*----------------------------------------------------------------*14570000
522516*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *14580000
522517*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *14590000
522518*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *14600000
522519*----------------------------------------------------------------*14610000
522520                                                                  14620000
522521 2120-BROWSE-FORWARD.                                             14630000
522522                                                                  14640000
522523     IF PS-CICS-SWITCH-YES                                        14650000
522524         INITIALIZE PV-CICS-MSG-AREA                              14660000
522525         STRING ' ' PV-SRC-TASK-NUMBER                            14670000
522526                ' WSKCS316-2120'                                  14680000
522527                DELIMITED BY SIZE                                 14690000
522528                          INTO PV-CICS-MSG-AREA                   14700000
522529         PERFORM 7000-WRITE-TO-CICS-LOG                           14710000
522530     END-IF.                                                      14720000
522531*                                                                 14730000
522532     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              14740000
522533         GIVING PV-TOP-ITEM.                                      14750000
522534     IF PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                    14760000
522535         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            14770000
522536                                   TO PV-TOP-ITEM                 14780000
522537*        -- BOTTOM OF LIST --                                     14790000
522538         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            14800000
522539         SET DP020-MSG-INFORMATIONAL                              14810000
522540                                   TO TRUE                        14820000
522541     ELSE                                                         14830000
522542         COMPUTE PV-BOTTOM-ITEM =                                 14840000
522543             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 14850000
522544         IF PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ             14860000
522545*            -- BOTTOM OF LIST --                                 14870000
522546             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            14880000
522547             SET DP020-MSG-INFORMATIONAL                          14890000
522548                                   TO TRUE                        14900000
522549         END-IF                                                   14910000
522550     END-IF.                                                      14920000
522551 EJECT                                                            14930000
522552*----------------------------------------------------------------*14940000
522553*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *14950000
522554*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *14960000
522555*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *14970000
522556*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *14980000
522557*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *14990000
522558*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *15000000
522559*----------------------------------------------------------------*15010000
522560                                                                  15020000
522561 2130-CHECK-FOR-JUMP-BROWSE.                                      15030000
522562                                                                  15040000
522563     IF PS-CICS-SWITCH-YES                                        15050000
522564         INITIALIZE PV-CICS-MSG-AREA                              15060000
522565         STRING ' ' PV-SRC-TASK-NUMBER                            15070000
522566                ' WSKCS316-2130'                                  15080000
522567                DELIMITED BY SIZE                                 15090000
522568                          INTO PV-CICS-MSG-AREA                   15100000
522569         PERFORM 7000-WRITE-TO-CICS-LOG                           15110000
522570     END-IF.                                                      15120000
522571*                                                                 15130000
522572     SET PS-NO-ERROR               TO TRUE.                       15140000
522573     IF (ASC-START-ITEM-REQUEST = SPACE)                          15150000
522574         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            15160000
522575                                   TO PV-TOP-ITEM                 15170000
522576     ELSE                                                         15180000
522577         MOVE ASC-START-ITEM-REQUEST                              15190000
522578                                   TO DP010I-UNEDITED-FIELD       15200000
522579         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       15210000
522580         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     15220000
522581         SET DP010I-NEGATIVE-NOT-ALLOWED                          15230000
522582                                   TO TRUE                        15240000
263627         CALL DP010I-NUMERIC-EDIT-ROUTINE                         15251099
263627              USING DP010I-NUMERIC-EDIT-AREA                      15252099
522584                                                                  15260000
522585         IF NOT DP010I-ERROR-DETECTED                             15270000
522586             MOVE DP010I-NUMERIC-FIELD                            15280000
522587                                   TO  ASC-START-ITEM-REQUEST-N   15290000
522588             IF ASC-START-ITEM-REQUEST-N > ZERO                   15300000
522589                 IF ASC-START-ITEM-REQUEST-N >                    15310000
522590                                          ASC-NUMBER-OF-ITEMS-READ15320000
522591                     MOVE SPACE TO ASC-START-ITEM-REQUEST         15330000
522592                     COMPUTE PV-TOP-ITEM =                        15340000
522593                             ASC-NUMBER-OF-ITEMS-READ             15350000
522594                             - PC-ITEMS-PER-PANEL + 1             15360000
522595                     IF PV-TOP-ITEM < +1                          15370000
522596                         MOVE +1   TO PV-TOP-ITEM                 15380000
522597                         MOVE PC-TSYMSG-00070                     15390000
522598                                   TO DP020-MSG-NUMBER            15400000
522599                         SET DP020-MSG-INFORMATIONAL              15410000
522600                                   TO TRUE                        15420000
522601                     END-IF                                       15430000
522602                 ELSE                                             15440000
522603                     MOVE ASC-START-ITEM-REQUEST-N                15450000
522604                                   TO PV-TOP-ITEM                 15460000
522605                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      15470000
522606                     COMPUTE PV-BOTTOM-ITEM =                     15480000
522607                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     15490000
522608                     IF PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ 15500000
522609*                        -- BOTTOM OF LIST --                     15510000
522610                         MOVE PC-TSYMSG-00070                     15520000
522611                                   TO DP020-MSG-NUMBER            15530000
522612                         SET DP020-MSG-INFORMATIONAL              15540000
522613                                   TO TRUE                        15550000
522614                     END-IF                                       15560000
522615                 END-IF                                           15570000
522616             ELSE                                                 15580000
522617*                --- VALUE OUT OF RANGE ----                      15590000
522618                 MOVE PC-TSYMSG-00101                             15600000
522619                                   TO DP020-MSG-NUMBER            15610000
522620                 MOVE -1           TO ASTRITL                     15620000
522621                 SET DP030-SET-CURSOR-APPL-1                      15630000
522622                                   TO TRUE                        15640000
522623                 MOVE DP015-REVERSE                               15650000
522624                                   TO ASTRITH                     15660000
522625                 MOVE DP015-RED    TO ASTRITC                     15670000
522626                 MOVE DP015-UNP-NUM-BRT-MDT                       15680000
522627                                   TO ASTRITA                     15690000
522628                 SET DP020-MSG-FATAL                              15700000
522629                                   TO TRUE                        15710000
522630                 SET PS-ERROR      TO TRUE                        15720000
522631             END-IF                                               15730000
522632                                                                  15740000
522633         ELSE                                                     15750000
522634             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            15760000
522635             MOVE -1               TO ASTRITL                     15770000
522636             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  15780000
522637             MOVE DP015-REVERSE    TO ASTRITH                     15790000
522638             MOVE DP015-RED        TO ASTRITC                     15800000
522639             MOVE DP015-UNP-NUM-BRT-MDT                           15810000
522640                                   TO ASTRITA                     15820000
522641             SET DP020-MSG-FATAL   TO TRUE                        15830000
522642             SET PS-ERROR          TO TRUE                        15840000
522643         END-IF                                                   15850000
522644     END-IF.                                                      15860000
522645 EJECT                                                            15870000
522646*----------------------------------------------------------------*15880000
522647*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *15890000
522648*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *15900000
522649*----------------------------------------------------------------*15910000
522650 2140-DESELECT-ALL-ITEMS.                                         15920000
522660                                                                  15930000
522670     IF PS-CICS-SWITCH-YES                                        15940000
522680         INITIALIZE PV-CICS-MSG-AREA                              15950000
522690         STRING ' ' PV-SRC-TASK-NUMBER                            15960000
522700                ' WSKCS316-2140'                                  15970000
522800                DELIMITED BY SIZE                                 15980000
522900                          INTO PV-CICS-MSG-AREA                   15990000
523000         PERFORM 7000-WRITE-TO-CICS-LOG                           16000000
523001     END-IF.                                                      16010000
523002*                                                                 16020000
523003     MOVE +1                       TO ASC-BLK-SUB.                16030000
523004                                                                  16040000
523005     PERFORM 2141-CLEAR-SELECTED-INDS                             16050000
523006         VARYING ASC-ITEM-SUB                                     16060000
523007         FROM 1 BY 1                                              16070000
523008         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 16080000
523009                                                                  16090000
523010     ADD +1                        TO ASC-BLK-SUB.                16100000
523011                                                                  16110000
523012     PERFORM 2141-CLEAR-SELECTED-INDS                             16120000
523013         VARYING ASC-ITEM-SUB                                     16130000
523014         FROM 1 BY 1                                              16140000
523015         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 16150000
523016                                                                  16160000
523017     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               16170000
523018                                   TO PV-LIST-ITEM-NUMBER.        16180000
523019                                                                  16190000
523020     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            16200000
523021         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    16210000
523022                                                                  16220000
523023     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     16230000
523024        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      16240000
523025         MOVE +1                   TO ASC-BLK-SUB                 16250000
523026                                                                  16260000
523027         PERFORM 5100-WRITE-TEMP-STORAGE                          16270000
523028                                                                  16280000
523029         MOVE +1                   TO PV-BLOCK-NUMBER             16290000
523030                                                                  16300000
523031         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         16310000
523032             PV-FIRST-BLOCK-IN-ARRAY - 1                          16320000
523033                                                                  16330000
523034         PERFORM                                                  16340000
523035             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       16350000
523036                                                                  16360000
523037             PERFORM 4410-READ-TEMP-STORAGE                       16370000
523038                                                                  16380000
523039             PERFORM 2141-CLEAR-SELECTED-INDS                     16390000
523040                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 16400000
523041                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          16410000
523042                                                                  16420000
523043             PERFORM 5100-WRITE-TEMP-STORAGE                      16430000
523044                                                                  16440000
523045             ADD +1                TO PV-BLOCK-NUMBER             16450000
523046                                                                  16460000
523047         END-PERFORM                                              16470000
523048                                                                  16480000
523049         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         16490000
523050             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     16500000
523051                                                                  16510000
523052         PERFORM                                                  16520000
523053             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       16530000
523054                   ASC-HIGHEST-BLOCK-WRITTEN                      16540000
523055                                                                  16550000
523056             MOVE PV-NEXT-BLOCK-IN-ARRAY                          16560000
523057                                   TO PV-BLOCK-NUMBER             16570000
523058                                                                  16580000
523059             PERFORM 4410-READ-TEMP-STORAGE                       16590000
523060                                                                  16600000
523061             PERFORM 2141-CLEAR-SELECTED-INDS                     16610000
523062                 VARYING ASC-ITEM-SUB                             16620000
523063                 FROM 1 BY 1                                      16630000
523064                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          16640000
523065                                                                  16650000
523066             PERFORM 5100-WRITE-TEMP-STORAGE                      16660000
523067                                                                  16670000
523068             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      16680000
523069                                                                  16690000
523070         END-PERFORM                                              16700000
523071                                                                  16710000
523072         MOVE PV-FIRST-BLOCK-IN-ARRAY                             16720000
523073                                   TO PV-BLOCK-NUMBER             16730000
523074                                                                  16740000
523075         PERFORM 4410-READ-TEMP-STORAGE                           16750000
523076     END-IF.                                                      16760000
523077                                                                  16770000
523078                                                                  16780000
523079     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 16790000
523080     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.16800000
523081     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  16810000
523082                                                                  16820000
523083     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        16830000
523084                                                                  16840000
523085 EJECT                                                            16850000
523086*----------------------------------------------------------------*16860000
523087*    MARK EACH ITEM AS BEING NOT SELECTED.                       *16870000
523088*----------------------------------------------------------------*16880000
523089 2141-CLEAR-SELECTED-INDS.                                        16890000
523090                                                                  16900000
523100     IF PS-CICS-SWITCH-YES                                        16910000
523200         INITIALIZE PV-CICS-MSG-AREA                              16920000
523300         STRING ' ' PV-SRC-TASK-NUMBER                            16930000
523400                ' WSKCS316-2141'                                  16940000
523500                DELIMITED BY SIZE                                 16950000
523600                          INTO PV-CICS-MSG-AREA                   16960000
523700         PERFORM 7000-WRITE-TO-CICS-LOG                           16970000
523701     END-IF.                                                      16980000
523702*                                                                 16990000
523703     IF ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)            17000000
523704             NOT EQUAL ZERO                                       17010000
523705         IF NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)           17020000
523706             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          17030000
523707                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    17040000
523708                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  17050000
523709                                   TO TRUE                        17060000
523710         END-IF                                                   17070000
523711     END-IF.                                                      17080000
523712                                                                  17090000
523713 EJECT                                                            17100000
523714*----------------------------------------------------------------*17110000
523715*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *17120000
523716*  FOR ALL ITEMS.                                                *17130000
523717*----------------------------------------------------------------*17140000
523718 2150-SELECT-ALL-ITEMS.                                           17150000
523719                                                                  17160000
523720     IF PS-CICS-SWITCH-YES                                        17170000
523730         INITIALIZE PV-CICS-MSG-AREA                              17180000
523740         STRING ' ' PV-SRC-TASK-NUMBER                            17190000
523750                ' WSKCS316-2150'                                  17200000
523760                DELIMITED BY SIZE                                 17210000
523770                          INTO PV-CICS-MSG-AREA                   17220000
523780         PERFORM 7000-WRITE-TO-CICS-LOG                           17230000
523781     END-IF.                                                      17240000
523782*                                                                 17250000
523783     MOVE +1                       TO ASC-BLK-SUB.                17260000
523784                                                                  17270000
523785     PERFORM 2151-SET-SELECTED-INDS                               17280000
523786         VARYING ASC-ITEM-SUB                                     17290000
523787         FROM 1 BY 1                                              17300000
523788         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 17310000
523789                                                                  17320000
523790     ADD +1                        TO ASC-BLK-SUB.                17330000
523791                                                                  17340000
523792     PERFORM 2151-SET-SELECTED-INDS                               17350000
523793         VARYING ASC-ITEM-SUB                                     17360000
523794         FROM 1 BY 1                                              17370000
523795         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 17380000
523796                                                                  17390000
523797     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               17400000
523798                                   TO PV-LIST-ITEM-NUMBER.        17410000
523799                                                                  17420000
523800     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            17430000
523801         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    17440000
523802                                                                  17450000
523803     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     17460000
523804        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    17470000
523805         MOVE +1                   TO ASC-BLK-SUB                 17480000
523806                                                                  17490000
523807         PERFORM 5100-WRITE-TEMP-STORAGE                          17500000
523808                                                                  17510000
523809         MOVE +1                   TO PV-BLOCK-NUMBER             17520000
523810                                                                  17530000
523811         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         17540000
523812             PV-FIRST-BLOCK-IN-ARRAY - 1                          17550000
523813                                                                  17560000
523814         PERFORM                                                  17570000
523815             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       17580000
523816                                                                  17590000
523817             PERFORM 4410-READ-TEMP-STORAGE                       17600000
523818                                                                  17610000
523819             PERFORM 2151-SET-SELECTED-INDS                       17620000
523820                 VARYING ASC-ITEM-SUB                             17630000
523821                 FROM 1 BY 1                                      17640000
523822                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          17650000
523823                                                                  17660000
523824             PERFORM 5100-WRITE-TEMP-STORAGE                      17670000
523825                                                                  17680000
523826             ADD +1                TO PV-BLOCK-NUMBER             17690000
523827                                                                  17700000
523828         END-PERFORM                                              17710000
523829                                                                  17720000
523830         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         17730000
523831             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     17740000
523832                                                                  17750000
523833         PERFORM                                                  17760000
523834             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       17770000
523835                   ASC-HIGHEST-BLOCK-WRITTEN                      17780000
523836                                                                  17790000
523837             MOVE PV-NEXT-BLOCK-IN-ARRAY                          17800000
523838                                   TO PV-BLOCK-NUMBER             17810000
523839                                                                  17820000
523840             PERFORM 4410-READ-TEMP-STORAGE                       17830000
523841                                                                  17840000
523842             PERFORM 2151-SET-SELECTED-INDS                       17850000
523843                 VARYING ASC-ITEM-SUB                             17860000
523844                 FROM 1 BY 1                                      17870000
523845                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          17880000
523846                                                                  17890000
523847             PERFORM 5100-WRITE-TEMP-STORAGE                      17900000
523848                                                                  17910000
523849             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      17920000
523850                                                                  17930000
523851         END-PERFORM                                              17940000
523852                                                                  17950000
523853         MOVE PV-FIRST-BLOCK-IN-ARRAY                             17960000
523854                                   TO PV-BLOCK-NUMBER             17970000
523855                                                                  17980000
523856         PERFORM 4410-READ-TEMP-STORAGE                           17990000
523857     END-IF.                                                      18000000
523858                                                                  18010000
523859                                                                  18020000
523860     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             18030000
523861                       ASC-NUMBER-OF-SELECTED-ITEMS.              18040000
523862                                                                  18050000
523863     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        18060000
523864                                                                  18070000
523865 EJECT                                                            18080000
523866*----------------------------------------------------------------*18090000
523867*    MARK EACH ITEM AS BEING SELECTED.                           *18100000
523868*----------------------------------------------------------------*18110000
523869 2151-SET-SELECTED-INDS.                                          18120000
523870                                                                  18130000
523880     IF PS-CICS-SWITCH-YES                                        18140000
523890         INITIALIZE PV-CICS-MSG-AREA                              18150000
523900         STRING ' ' PV-SRC-TASK-NUMBER                            18160000
524000                ' WSKCS316-2151'                                  18170000
524100                DELIMITED BY SIZE                                 18180000
524200                          INTO PV-CICS-MSG-AREA                   18190000
524300         PERFORM 7000-WRITE-TO-CICS-LOG                           18200000
524301     END-IF.                                                      18210000
524302*                                                                 18220000
524303     IF ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)            18230000
524304             NOT EQUAL ZERO                                       18240000
524305         IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)              18250000
524306             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             18260000
524307                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        18270000
524308                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  18280000
524309                               TO  TRUE                           18290000
524310         END-IF                                                   18300000
524311     END-IF.                                                      18310000
524312******************************************************************18320000
524313** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **18330000
524314** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **18340000
524315******************************************************************18350000
524316 2200-MOVE-SCREEN-TO-COMMAREA.                                    18360000
524317                                                                  18370000
524318     IF PS-CICS-SWITCH-YES                                        18380000
524319         INITIALIZE PV-CICS-MSG-AREA                              18390000
524320         STRING ' ' PV-SRC-TASK-NUMBER                            18400000
524330                ' WSKCS316-2200'                                  18410000
524340                DELIMITED BY SIZE                                 18420000
524350                          INTO PV-CICS-MSG-AREA                   18430000
524360         PERFORM 7000-WRITE-TO-CICS-LOG                           18440000
524361     END-IF.                                                      18450000
524362*                                                                 18460000
524363     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             18470000
524364     MOVE +1                       TO PV-SUB.                     18480000
524365*                                                                 18490000
524366     PERFORM 3100-SET-SUBSCRIPTS.                                 18500000
171410     IF APOSRCHL > ZERO                                           18510099
171410         MOVE APOSRCHI        TO ASC-PO-SRCH                      18520099
171410     ELSE                                                         18530099
171410         IF APOSRCHF = DP015-ERASE-EOF                            18540099
171410            MOVE SPACES       TO ASC-PO-SRCH                      18550099
171410         END-IF                                                   18560099
171410     END-IF.                                                      18570099
171410     IF ASKSRCHL > ZERO                                           18580099
171410         MOVE ASKSRCHI        TO ASC-SKU-SRCH                     18590099
171410     ELSE                                                         18600099
171410         IF ASKSRCHF = DP015-ERASE-EOF                            18610099
171410            MOVE SPACES       TO ASC-SKU-SRCH                     18620099
171410         END-IF                                                   18630099
171410     END-IF.                                                      18640099
524367     IF ASTRITL > ZERO                                            18650099
524368         MOVE ASTRITI         TO ASC-START-ITEM-REQUEST           18660099
524369     ELSE                                                         18670099
524370         IF ASTRITF = DP015-ERASE-EOF                             18680099
524371             INITIALIZE ASC-START-ITEM-REQUEST                    18690099
524372         END-IF                                                   18700099
524373     END-IF.                                                      18710099
524374     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          18720000
524375         VARYING PV-SUB                                           18730000
524376         FROM 1 BY 1                                              18740000
524377         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      18750000
524378                                                                  18760000
524379******************************************************************18770000
524380** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**18780000
524381******************************************************************18790000
524382 2210-MOVE-LINES-TO-COMMAREA.                                     18800000
524383                                                                  18810000
524384     IF PS-CICS-SWITCH-YES                                        18820000
524385         INITIALIZE PV-CICS-MSG-AREA                              18830000
524386         STRING ' ' PV-SRC-TASK-NUMBER                            18840000
524387                ' WSKCS316-2210'                                  18850000
524388                DELIMITED BY SIZE                                 18860000
524389                          INTO PV-CICS-MSG-AREA                   18870000
524390         PERFORM 7000-WRITE-TO-CICS-LOG                           18880000
524391     END-IF.                                                      18890000
524392*                                                                 18900000
524393     IF MR-SELECTL (PV-SUB) > ZERO                                18910000
524394         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             18920000
524395         MOVE MR-SELECTI (PV-SUB)                                 18930000
524396                                   TO ASC-TEMP-SELECTED-SW        18940000
524397                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      18950000
524398     ELSE                                                         18960000
524399         IF MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                 18970000
524400             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE         18980000
524401             MOVE SPACE        TO ASC-TEMP-SELECTED-SW            18990000
524402                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      19000000
524403         END-IF                                                   19010000
524404     END-IF.                                                      19020000
524405     ADD +1                        TO ASC-ITEM-SUB.               19030000
524406     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         19040000
524407         ADD +1                    TO ASC-BLK-SUB                 19050000
524408         MOVE +1                   TO ASC-ITEM-SUB                19060000
524409     END-IF.                                                      19070000
524410******************************************************************19080000
524411** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **19090000
524412** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **19100000
524413******************************************************************19110000
524414 3000-EDIT-DATA-IN-COMMAREA.                                      19120000
524415*                                                                 19130000
524416     IF PS-CICS-SWITCH-YES                                        19140000
524417         INITIALIZE PV-CICS-MSG-AREA                              19150000
524418         STRING ' ' PV-SRC-TASK-NUMBER                            19160000
524419                ' WSKCS316-3000'                                  19170000
524420                DELIMITED BY SIZE                                 19180000
524430                          INTO PV-CICS-MSG-AREA                   19190000
524440         PERFORM 7000-WRITE-TO-CICS-LOG                           19200000
524441     END-IF.                                                      19210000
524442*                                                                 19220000
524443     SET PS-NO-ERROR               TO TRUE.                       19230000
524444     PERFORM 3200-RESET-ATTRIBUTES.                               19240000
171410                                                                  19250099
171410     IF ASC-SKU-SRCH NOT = SPACES                                 19260099
171410         MOVE ASC-SKU-SRCH       TO DP010I-UNEDITED-FIELD         19270099
171410         MOVE LENGTH OF ASC-SKU-SRCH                              19280099
171410                                 TO DP010I-MAXIMUM-DIGITS         19290099
171410         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       19300099
171410         SET DP010I-NEGATIVE-NOT-ALLOWED                          19310099
171410                                 TO TRUE                          19320099
263627         CALL DP010I-NUMERIC-EDIT-ROUTINE                         19331099
263627              USING DP010I-NUMERIC-EDIT-AREA                      19332099
171410         IF  DP010I-ERROR-DETECTED                                19340099
171410             SET PS-ERROR                                         19350099
171410                 DP020-MSG-FATAL TO TRUE                          19360099
171410             MOVE PC-TSYMSG-00008                                 19370099
171410                                 TO DP020-MSG-NUMBER              19380099
171410             MOVE DP015-UNP-ALP-BRT-OFF                           19390099
171410                                 TO ASKSRCHA                      19400099
171410             MOVE DP015-RED      TO ASKSRCHC                      19410099
171410             MOVE DP015-REVERSE  TO ASKSRCHH                      19420099
171410             MOVE -1             TO ASKSRCHL                      19430099
171410             SET DP030-SET-CURSOR-APPL-1                          19440099
171410                                 TO TRUE                          19450099
171410         ELSE                                                     19460099
171410             MOVE DP010I-NUMERIC-FIELD                            19470099
171410                                 TO ASC-SKU-NBR-N                 19480099
171410                                    DK-SKU-NBR                    19490099
171410             PERFORM 3025-VALIDATE-SKU-NBR                        19500099
171410             IF SQLCODE = +100                                    19510099
171410                 SET PS-ERROR                                     19520099
171410                     DP020-MSG-FATAL TO TRUE                      19530099
171410                 MOVE PC-TSYMSG-02512                             19540099
171410                                     TO DP020-MSG-NUMBER          19550099
171410                 MOVE DP015-UNP-ALP-BRT-OFF                       19560099
171410                                     TO ASKSRCHA                  19570099
171410                 MOVE DP015-RED      TO ASKSRCHC                  19580099
171410                 MOVE DP015-REVERSE  TO ASKSRCHH                  19590099
171410                 MOVE -1             TO ASKSRCHL                  19600099
171410                 SET DP030-SET-CURSOR-APPL-1                      19610099
171410                                     TO TRUE                      19620099
171410                 MOVE ASC-SKU-SRCH   TO ASKSRCHO                  19630099
171410             END-IF                                               19640099
171410         END-IF                                                   19650099
171410     END-IF.                                                      19660099
171410                                                                  19670099
171410     IF ASC-PO-SRCH NOT = SPACES                                  19680099
171410         MOVE ASC-PO-SRCH        TO DP010I-UNEDITED-FIELD         19690099
171410         MOVE LENGTH OF ASC-PO-SRCH                               19700099
171410                                 TO DP010I-MAXIMUM-DIGITS         19710099
171410         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       19720099
171410         SET DP010I-NEGATIVE-NOT-ALLOWED                          19730099
171410                                 TO TRUE                          19740099
263627         CALL DP010I-NUMERIC-EDIT-ROUTINE                         19751099
263627              USING DP010I-NUMERIC-EDIT-AREA                      19752099
171410         IF  DP010I-ERROR-DETECTED                                19760099
171410             SET PS-ERROR                                         19770099
171410                 DP020-MSG-FATAL TO TRUE                          19780099
171410             MOVE PC-TSYMSG-00008                                 19790099
171410                                 TO DP020-MSG-NUMBER              19800099
171410             MOVE DP015-UNP-ALP-BRT-OFF                           19810099
171410                                 TO APOSRCHA                      19820099
171410             MOVE DP015-RED      TO APOSRCHC                      19830099
171410             MOVE DP015-REVERSE  TO APOSRCHH                      19840099
171410             MOVE -1             TO APOSRCHL                      19850099
171410             SET DP030-SET-CURSOR-APPL-1                          19860099
171410                                 TO TRUE                          19870099
171410         ELSE                                                     19880099
171410             MOVE DP010I-NUMERIC-FIELD                            19890099
171410                                 TO ASC-PO-NBR-N                  19900099
171410                                    DK-PO-NBR                     19910099
171410             MOVE ASC-KEY-SHPMT-ID                                19920099
171410                                 TO DK-EXT-SHP-ID                 19930099
171410             PERFORM 3020-VALIDATE-PO-NBR                         19940099
171410             IF SQLCODE = +100                                    19950099
171410                 SET PS-ERROR                                     19960099
171410                     DP020-MSG-FATAL TO TRUE                      19970099
171410                 MOVE PC-TSYMSG-02949                             19980099
171410                                     TO DP020-MSG-NUMBER          19990099
171410                 MOVE DP015-UNP-ALP-BRT-OFF                       20000099
171410                                     TO APOSRCHA                  20010099
171410                 MOVE DP015-RED      TO APOSRCHC                  20020099
171410                 MOVE DP015-REVERSE  TO APOSRCHH                  20030099
171410                 MOVE -1             TO APOSRCHL                  20040099
171410                 SET DP030-SET-CURSOR-APPL-1                      20050099
171410                                     TO TRUE                      20060099
171410                 MOVE ASC-PO-SRCH    TO APOSRCHO                  20070099
171410             END-IF                                               20080099
171410         END-IF                                                   20090099
171410     END-IF.                                                      20100099
171410                                                                  20110099
524445     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     20120000
524446**                                                                20130000
524447* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              20140000
524448* EDITTING IS DONE FROM THE BOTTOM UP.                            20150000
524449**                                                                20160000
524450     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       20170000
524451         ASC-ITEMS-DISPLAYED - 1.                                 20180000
524452     PERFORM 3100-SET-SUBSCRIPTS.                                 20190000
524453     PERFORM 3300-EDIT-SELECTIONS                                 20200000
524454         VARYING PV-SUB                                           20210000
524455         FROM PV-SUB BY -1                                        20220000
524456         UNTIL PV-SUB < +1                                        20230000
524457*                                                                 20240000
524458     IF PS-NO-ERROR                                               20250000
524459         PERFORM 3400-CHECK-RANGE-SEQUENCE                        20260000
524460     END-IF.                                                      20270000
524461*                                                                 20280000
524462     IF ((PS-NO-ERROR)                                            20290000
524463       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   20300000
524464       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    20310000
524465             PERFORM 3500-MARK-RANGE-AS-SELECTED                  20320000
524466     END-IF.                                                      20330000
524467/                                                                 20340000
524468*----------------------------------------------------------------*20350099
171410 3020-VALIDATE-PO-NBR.                                            20360099
171410                                                                  20370099
171410     IF PS-CICS-SWITCH-YES                                        20380099
171410         INITIALIZE PV-CICS-MSG-AREA                              20390099
171410         MOVE DK-PO-NBR   TO PV-DISPLAY-1                         20400099
171410         STRING ' ' PV-SRC-TASK-NUMBER                            20410099
171410                ' WSKCS316-3020 VALIDATE PO'                      20420099
171410                ' SHPMT=' DK-EXT-SHP-ID                           20430099
171410                ' PO='    PV-DISPLAY-1                            20440099
171410                DELIMITED BY SIZE                                 20450099
171410                          INTO PV-CICS-MSG-AREA                   20460099
171410         PERFORM 7000-WRITE-TO-CICS-LOG                           20470099
171410     END-IF.                                                      20480099
171410                                                                  20490099
171410     EXEC SQL                                                     20500099
171410         SELECT DISTINCT PO_NBR                                   20510099
171410           INTO :PV-PO-NBR                                        20520099
171410           FROM WST_SHPMT_XREF_DTL                                20530099
171410          WHERE EXT_SHP_ID = :DK-EXT-SHP-ID                       20540099
171410            AND ACTV_CDE   = 'A'                                  20550099
171410            AND PO_NBR     = :DK-PO-NBR                           20560099
171410     END-EXEC.                                                    20570099
171410                                                                  20580099
171410     EVALUATE TRUE                                                20590099
171410         WHEN SQLCODE = ZERO                                      20600099
171410         WHEN SQLCODE = +100                                      20610099
171410         WHEN SQLCODE = -904                                      20620099
171410         WHEN SQLCODE = -913                                      20630099
171410             CONTINUE                                             20640099
171410                                                                  20650099
171410         WHEN SQLWARN0 NOT = SPACES                               20660099
171410         WHEN SQLCODE < ZERO                                      20670099
171410         WHEN SQLCODE > ZERO                                      20680099
171410             INITIALIZE PV-CICS-MSG-AREA                          20690099
171410             MOVE SQLCODE TO PV-DISPLAY                           20700099
171410             STRING ' ' PV-SRC-TASK-NUMBER                        20710099
171410                    ' WSKCS316-3020'                              20720099
171410                    ' SQL=' PV-DISPLAY                            20730099
171410                    DELIMITED BY SIZE                             20740099
171410                          INTO PV-CICS-MSG-AREA                   20750099
171410             PERFORM 7000-WRITE-TO-CICS-LOG                       20760099
171410             MOVE '3020-VALIDATE-PO-NBR'                          20770099
171410                                   TO DP013-PARAGRAPH             20780099
171410             MOVE 'VALIDATE PO NBR    - '                         20790099
171410                                   TO DP013-MESSAGE-TEXT (1)      20800099
171410             MOVE SQLCA        TO DP013-SQLCA                     20810099
171410             MOVE 'WST_SHPMT_XREF_DTL'                            20820099
171410                               TO DP013-DB2-TABLE-NAME (1)        20830099
171410             SET DP013-DB2-ABEND                                  20840099
171410                 DP013-XCTL-DISPLAY-RESTART TO TRUE               20850099
171410             PERFORM DP013-0000-PROCESS-ABEND                     20860099
171410     END-EVALUATE.                                                20870099
171410                                                                  20880099
171410*----------------------------------------------------------------*20890099
171410 3025-VALIDATE-SKU-NBR.                                           20900099
171410                                                                  20910099
171410     IF PS-CICS-SWITCH-YES                                        20920099
171410         MOVE DK-SKU-NBR  TO PV-DISPLAY-1                         20930099
171410         INITIALIZE PV-CICS-MSG-AREA                              20940099
171410         STRING ' ' PV-SRC-TASK-NUMBER                            20950099
171410                ' WSKCS316-3025 VALIDATE SKU'                     20960099
171410                ' SHPMT=' DK-EXT-SHP-ID                           20970099
171410                ' SKU='   PV-DISPLAY-1                            20980099
171410                DELIMITED BY SIZE                                 20990099
171410                          INTO PV-CICS-MSG-AREA                   21000099
171410         PERFORM 7000-WRITE-TO-CICS-LOG                           21010099
171410     END-IF.                                                      21020099
171410                                                                  21030099
171410     EXEC SQL                                                     21040099
171410         SELECT SKU_NBR                                           21050099
171410           INTO :PV-SKU-NBR                                       21060099
171410           FROM XLT_SKU                                           21070099
171410          WHERE SKU_NBR    = :DK-SKU-NBR                          21080099
171410     END-EXEC.                                                    21090099
171410                                                                  21100099
171410     EVALUATE TRUE                                                21110099
171410         WHEN SQLCODE = ZERO                                      21120099
171410         WHEN SQLCODE = +100                                      21130099
171410         WHEN SQLCODE = -904                                      21140099
171410         WHEN SQLCODE = -913                                      21150099
171410             CONTINUE                                             21160099
171410                                                                  21170099
171410         WHEN SQLWARN0 NOT = SPACES                               21180099
171410         WHEN SQLCODE < ZERO                                      21190099
171410         WHEN SQLCODE > ZERO                                      21200099
171410             INITIALIZE PV-CICS-MSG-AREA                          21210099
171410             MOVE SQLCODE TO PV-DISPLAY                           21220099
171410             STRING ' ' PV-SRC-TASK-NUMBER                        21230099
171410                    ' WSKCS316-3025'                              21240099
171410                    ' SQL=' PV-DISPLAY                            21250099
171410                    DELIMITED BY SIZE                             21260099
171410                          INTO PV-CICS-MSG-AREA                   21270099
171410             PERFORM 7000-WRITE-TO-CICS-LOG                       21280099
171410             MOVE '3025-VALIDATE-SKU-NBR'                         21290099
171410                                   TO DP013-PARAGRAPH             21300099
171410             MOVE 'VALIDATE SKU NBR   - '                         21310099
171410                                   TO DP013-MESSAGE-TEXT (1)      21320099
171410             MOVE SQLCA        TO DP013-SQLCA                     21330099
171410             MOVE 'XLT_SKU'    TO DP013-DB2-TABLE-NAME (1)        21340099
171410             SET DP013-DB2-ABEND                                  21350099
171410                 DP013-XCTL-DISPLAY-RESTART TO TRUE               21360099
171410             PERFORM DP013-0000-PROCESS-ABEND                     21370099
171410     END-EVALUATE.                                                21380099
171410                                                                  21390099
524468*----------------------------------------------------------------*21400099
524469*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *21410000
524470*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*21420000
524471*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *21430000
524472*                                                                *21440000
524473*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *21450000
524474*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *21460000
524475*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *21470000
524476*    US IN THE 2ND BLOCK OF THE ARRAY.                           *21480000
524477*----------------------------------------------------------------*21490000
524478                                                                  21500000
524479 3100-SET-SUBSCRIPTS.                                             21510000
524480                                                                  21520000
524490     IF PS-CICS-SWITCH-YES                                        21530000
524500         INITIALIZE PV-CICS-MSG-AREA                              21540000
524600         STRING ' ' PV-SRC-TASK-NUMBER                            21550000
524700                ' WSKCS316-3100'                                  21560000
524800                DELIMITED BY SIZE                                 21570000
524900                          INTO PV-CICS-MSG-AREA                   21580000
525000         PERFORM 7000-WRITE-TO-CICS-LOG                           21590000
525001     END-IF.                                                      21600000
525002*                                                                 21610000
525003     COMPUTE ASC-ITEM-SUB =                                       21620000
525004         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        21630000
525005                                                                  21640000
525006     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         21650000
525007         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            21660000
525008                                                                  21670000
525009         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               21680000
525010     ELSE                                                         21690000
525011         MOVE +1                     TO ASC-BLK-SUB               21700000
525012     END-IF.                                                      21710000
525013*                                                                 21720000
525014******************************************************************21730000
525015** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **21740000
525016******************************************************************21750000
525017 3200-RESET-ATTRIBUTES.                                           21760000
525018                                                                  21770000
525019     IF PS-CICS-SWITCH-YES                                        21780000
525020         INITIALIZE PV-CICS-MSG-AREA                              21790000
525030         STRING ' ' PV-SRC-TASK-NUMBER                            21800000
525040                ' WSKCS316-3200'                                  21810000
525050                DELIMITED BY SIZE                                 21820000
525060                          INTO PV-CICS-MSG-AREA                   21830000
525070         PERFORM 7000-WRITE-TO-CICS-LOG                           21840000
525071     END-IF.                                                      21850000
525072*                                                                 21860000
525073     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRITA.                    21870000
525074     MOVE DP015-GREEN              TO ASTRITC.                    21880000
525075     MOVE DP015-UNDERLINE          TO ASTRITH.                    21890000
525076*                                                                 21900000
171410     MOVE DP015-UNP-ALP-NOR-OFF    TO APOSRCHA                    21910099
171410                                      ASKSRCHA.                   21920099
171410     MOVE DP015-GREEN              TO APOSRCHC                    21930099
171410                                      ASKSRCHC.                   21940099
171410     MOVE DP015-UNDERLINE          TO APOSRCHH                    21950099
171410                                      ASKSRCHH.                   21960099
171410                                                                  21970099
525077     PERFORM                                                      21980000
525078         VARYING PV-SUB                                           21990000
525079         FROM 1 BY 1                                              22000000
525080         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        22010000
525081         MOVE DP015-UNP-ALP-NOR-OFF                               22020000
525082                                   TO MR-SELECTA (PV-SUB)         22030000
525083         MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)         22040000
525084         MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)         22050000
525085     END-PERFORM.                                                 22060000
525086*                                                                 22070000
525087 3205-RESET-ATTRIBUTES-2.                                         22080000
525088*                                                                 22090000
525089     IF PS-CICS-SWITCH-YES                                        22100000
525090         INITIALIZE PV-CICS-MSG-AREA                              22110000
525100         STRING ' ' PV-SRC-TASK-NUMBER                            22120000
525200                ' WSKCS316-3205'                                  22130000
525300                DELIMITED BY SIZE                                 22140000
525400                          INTO PV-CICS-MSG-AREA                   22150000
525500         PERFORM 7000-WRITE-TO-CICS-LOG                           22160000
525501     END-IF.                                                      22170000
525502*                                                                 22180000
525503     PERFORM                                                      22190000
525504         VARYING PV-SUB                                           22200000
525505         FROM 1 BY 1                                              22210000
525506         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        22220000
525507             MOVE DP015-BLUE    TO MR-PO-NBRC (PV-SUB)            22230000
525508                                   MR-RCVR-NBRC (PV-SUB)          22240000
525509                                   MR-PO-LNEC (PV-SUB)            22250000
525510                                   MR-PREPKC (PV-SUB)             22260000
525520                                   MR-SKU-NBRC (PV-SUB)           22270000
525530                                   MR-ASN-LVLC (PV-SUB)           22280000
525540                                   MR-DNLD-CDEC (PV-SUB)          22290000
525550                                   MR-DNLD-DTEC (PV-SUB)          22300000
525560                                   MR-DNLD-TMEC (PV-SUB)          22310000
525570                                   MR-CRE-BYC (PV-SUB)            22320000
525580                                   MR-CRE-DTEC (PV-SUB)           22330000
525590                                   MR-CRE-TMEC (PV-SUB)           22340000
525591     END-PERFORM.                                                 22350000
525592******************************************************************22360000
525593** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **22370000
525594** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **22380000
525595** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **22390000
525596** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **22400000
525597******************************************************************22410000
525598 3300-EDIT-SELECTIONS.                                            22420000
525599*                                                                 22430000
525600     IF PS-CICS-SWITCH-YES                                        22440000
525700         INITIALIZE PV-CICS-MSG-AREA                              22450000
525800         STRING ' ' PV-SRC-TASK-NUMBER                            22460000
525900                ' WSKCS316-3300'                                  22470000
526000                DELIMITED BY SIZE                                 22480000
526100                          INTO PV-CICS-MSG-AREA                   22490000
526200         PERFORM 7000-WRITE-TO-CICS-LOG                           22500000
526201     END-IF.                                                      22510000
526202*                                                                 22520000
526203     EVALUATE TRUE                                                22530000
526204         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     22540000
526205             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         22550000
526206                 CONTINUE                                         22560000
526207         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         22570000
526208             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        22580000
526209                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   22590000
526210                 MOVE ASC-TEMP-SELECTED-SW                        22600000
526211                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22610000
526212                                TO ASC-SELECTED-SW                22620000
526213                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22630000
526214             END-IF                                               22640000
526215         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     22650000
526216                 = SPACE                                          22660000
526217             EVALUATE TRUE                                        22670000
526218                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       22680000
526219                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS22690000
526220                     MOVE SPACE TO ASC-SELECTED-SW                22700000
526221                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22710000
526222                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        22720000
526223                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    22730000
526224                     MOVE SPACE TO ASC-SELECTED-SW                22740000
526225                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22750000
526226                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          22760000
526227                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      22770000
526228                     MOVE SPACE TO ASC-SELECTED-SW                22780000
526229                                      (ASC-BLK-SUB ASC-ITEM-SUB)  22790000
526230             END-EVALUATE                                         22800000
526231         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           22810000
526232             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            22820000
526233                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    22830000
526234             END-IF                                               22840000
526235             PERFORM 3310-EDIT-RANGE                              22850000
526236         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             22860000
526237             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            22870000
526238                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    22880000
526239             END-IF                                               22890000
526240             PERFORM 3310-EDIT-RANGE                              22900000
526241         WHEN OTHER                                               22910000
526242             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           22920000
526243             SET DP020-MSG-FATAL    TO TRUE                       22930000
526244             MOVE -1                TO MR-SELECTL (PV-SUB)        22940000
526245             SET DP030-SET-CURSOR-APPL-1                          22950000
526246                                    TO TRUE                       22960000
526247             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        22970000
526248             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        22980000
526249             SET PS-ERROR TO TRUE                                 22990000
526250             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            23000000
526251                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     23010000
526252                 MOVE SPACE         TO ASC-SELECTED-SW            23020000
526253                                        (ASC-BLK-SUB ASC-ITEM-SUB)23030000
526254             END-IF                                               23040000
526255     END-EVALUATE.                                                23050000
526256                                                                  23060000
526257     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 23070000
526258     SUBTRACT +1 FROM ASC-ITEM-SUB.                               23080000
526259     IF ASC-ITEM-SUB < 1                                          23090000
526260         SUBTRACT +1 FROM ASC-BLK-SUB                             23100000
526261         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                23110000
526262     END-IF.                                                      23120000
526263*                                                                 23130000
526264******************************************************************23140000
526265** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **23150000
526266** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **23160000
526267** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**23170000
526268** THE ENDING.                                                  **23180000
526269******************************************************************23190000
526270 3310-EDIT-RANGE.                                                 23200000
526280*                                                                 23210000
526290     IF PS-CICS-SWITCH-YES                                        23220000
526300         INITIALIZE PV-CICS-MSG-AREA                              23230000
526400         STRING ' ' PV-SRC-TASK-NUMBER                            23240000
526500                ' WSKCS316-3310'                                  23250000
526600                DELIMITED BY SIZE                                 23260000
526700                          INTO PV-CICS-MSG-AREA                   23270000
526800         PERFORM 7000-WRITE-TO-CICS-LOG                           23280000
526801     END-IF.                                                      23290000
526802*                                                                 23300000
526803     IF ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                 23310000
526804         IF ASC-START-OF-SELECTED-RANGE = ZERO                    23320000
526805             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)23330000
526806                                   TO ASC-SELECTED-SW             23340000
526807                                        (ASC-BLK-SUB ASC-ITEM-SUB)23350000
526808             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 23360000
526809         ELSE                                                     23370000
526810             IF ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE      23380000
526811                 CONTINUE                                         23390000
526812             ELSE                                                 23400000
526813*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        23410000
526814                 MOVE PC-TSYMSG-00054                             23420000
526815                                   TO DP020-MSG-NUMBER            23430000
526816                 SET DP020-MSG-FATAL                              23440000
526817                                   TO TRUE                        23450000
526818                 MOVE -1           TO MR-SELECTL (PV-SUB)         23460000
526819                 SET DP030-SET-CURSOR-APPL-1                      23470000
526820                                   TO TRUE                        23480000
526821                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         23490000
526822                 MOVE DP015-UNDERLINE                             23500000
526823                                   TO MR-SELECTH (PV-SUB)         23510000
526824                 SET PS-ERROR      TO TRUE                        23520000
526825             END-IF                                               23530000
526826         END-IF                                                   23540000
526827     ELSE                                                         23550000
526828         IF ASC-END-OF-SELECTED-RANGE = ZERO                      23560000
526829             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 23570000
526830                                   TO ASC-SELECTED-SW             23580000
526831                                     (ASC-BLK-SUB ASC-ITEM-SUB)   23590000
526832             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   23600000
526833         ELSE                                                     23610000
526834             IF ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE        23620000
526835                 CONTINUE                                         23630000
526836             ELSE                                                 23640000
526837*                -- ONLY ONE END-OF-RANGE ALLOWED --              23650000
526838                 MOVE PC-TSYMSG-00055                             23660000
526839                                   TO DP020-MSG-NUMBER            23670000
526840                 SET DP020-MSG-FATAL                              23680000
526841                                   TO TRUE                        23690000
526842                 MOVE -1           TO MR-SELECTL (PV-SUB)         23700000
526843                 SET DP030-SET-CURSOR-APPL-1                      23710000
526844                                   TO TRUE                        23720000
526845                 SET PS-ERROR      TO TRUE                        23730000
526846             END-IF                                               23740000
526847         END-IF                                                   23750000
526848     END-IF.                                                      23760000
526849*                                                                 23770000
526850******************************************************************23780000
526851** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **23790000
526852** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **23800000
526853******************************************************************23810000
526854 3400-CHECK-RANGE-SEQUENCE.                                       23820000
526855*                                                                 23830000
526856     IF PS-CICS-SWITCH-YES                                        23840000
526857         INITIALIZE PV-CICS-MSG-AREA                              23850000
526858         STRING ' ' PV-SRC-TASK-NUMBER                            23860000
526859                ' WSKCS316-3400'                                  23870000
526860                DELIMITED BY SIZE                                 23880000
526870                          INTO PV-CICS-MSG-AREA                   23890000
526880         PERFORM 7000-WRITE-TO-CICS-LOG                           23900000
526881     END-IF.                                                      23910000
526882*                                                                 23920000
526883     IF ASC-START-OF-SELECTED-RANGE > ZERO                        23930000
526884       AND ASC-END-OF-SELECTED-RANGE > ZERO                       23940000
526885       AND ASC-START-OF-SELECTED-RANGE >                          23950000
526886                                         ASC-END-OF-SELECTED-RANGE23960000
526887*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                23970000
526888         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 23980000
526889         SET DP020-MSG-FATAL TO TRUE                              23990000
526890         SET PS-ERROR TO TRUE                                     24000000
526891         PERFORM 3410-POSITION-AT-ERROR                           24010000
526892     END-IF.                                                      24020000
526893******************************************************************24030000
526894** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **24040000
526895** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **24050000
526896** SHOULD BE POSITIONED ON A RANGE ERROR.                       **24060000
526897******************************************************************24070000
526898 3410-POSITION-AT-ERROR.                                          24080000
526899*                                                                 24090000
526900     IF PS-CICS-SWITCH-YES                                        24100000
527000         INITIALIZE PV-CICS-MSG-AREA                              24110000
527100         STRING ' ' PV-SRC-TASK-NUMBER                            24120000
527200                ' WSKCS316-3410'                                  24130000
527300                DELIMITED BY SIZE                                 24140000
527400                          INTO PV-CICS-MSG-AREA                   24150000
527500         PERFORM 7000-WRITE-TO-CICS-LOG                           24160000
527501     END-IF.                                                      24170000
527502*                                                                 24180000
527503     SET DP030-SET-CURSOR-APPL-1                                  24190000
527504                                   TO TRUE.                       24200000
527505     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 24210000
527506                    - PV-TOP-ITEM + 1.                            24220000
527507     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       24230000
527508         CONTINUE                                                 24240000
527509     ELSE                                                         24250000
527510         MOVE -1                   TO MR-SELECTL (PV-SUB)         24260000
527511         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         24270000
527512         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         24280000
527513     END-IF.                                                      24290000
527514*                                                                 24300000
527515     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   24310000
527516                    - PV-TOP-ITEM + 1.                            24320000
527517     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       24330000
527518         CONTINUE                                                 24340000
527519     ELSE                                                         24350000
527520         MOVE -1                   TO MR-SELECTL (PV-SUB)         24360000
527521         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         24370000
527522         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         24380000
527523     END-IF.                                                      24390000
527524 EJECT                                                            24400000
527525*----------------------------------------------------------------*24410000
527526*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *24420000
527527*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *24430000
527528*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *24440000
527529*----------------------------------------------------------------*24450000
527530 3500-MARK-RANGE-AS-SELECTED.                                     24460000
527540                                                                  24470000
527550     IF PS-CICS-SWITCH-YES                                        24480000
527560         INITIALIZE PV-CICS-MSG-AREA                              24490000
527570         STRING ' ' PV-SRC-TASK-NUMBER                            24500000
527580                ' WSKCS316-3500'                                  24510000
527590                DELIMITED BY SIZE                                 24520000
527600                          INTO PV-CICS-MSG-AREA                   24530000
527700         PERFORM 7000-WRITE-TO-CICS-LOG                           24540000
527701     END-IF.                                                      24550000
527702*                                                                 24560000
527703     MOVE +1                       TO  ASC-BLK-SUB.               24570000
527704     PERFORM 3510-MARK-SELECTED-INDS                              24580000
527705         VARYING ASC-ITEM-SUB                                     24590000
527706         FROM 1 BY 1                                              24600000
527707         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 24610000
527708                                                                  24620000
527709     ADD +1                        TO ASC-BLK-SUB.                24630000
527710     PERFORM 3510-MARK-SELECTED-INDS                              24640000
527711         VARYING ASC-ITEM-SUB                                     24650000
527712         FROM 1 BY 1                                              24660000
527713         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 24670000
527714                                                                  24680000
527715     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               24690000
527716                                   TO  PV-LIST-ITEM-NUMBER.       24700000
527717     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            24710000
527718         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         24720000
527719               PC-ITEMS-PER-PANEL).                               24730000
527720                                                                  24740000
527721     MOVE ASC-START-OF-SELECTED-RANGE                             24750000
527722                                   TO PV-START-OF-SELECTED-RANGE. 24760000
527723     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            24770000
527724         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  24780000
527725               PC-ITEMS-PER-PANEL).                               24790000
527726                                                                  24800000
527727     MOVE ASC-END-OF-SELECTED-RANGE                               24810000
527728                                   TO  PV-END-OF-SELECTED-RANGE.  24820000
527729     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             24830000
527730         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    24840000
527731               PC-ITEMS-PER-PANEL).                               24850000
527732     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             24860000
527733         PV-FIRST-BLOCK-IN-ARRAY + 1.                             24870000
527734                                                                  24880000
527735     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    24890000
527736        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        24900000
527737         MOVE +1                   TO ASC-BLK-SUB                 24910000
527738         PERFORM 5100-WRITE-TEMP-STORAGE                          24920000
527739         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         24930000
527740             PV-FIRST-BLOCK-IN-ARRAY - 1                          24940000
527741                                                                  24950000
527742         PERFORM                                                  24960000
527743             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      24970000
527744                   PV-PREV-BLOCK-IN-ARRAY                         24980000
527745             MOVE PV-FIRST-BLOCK-IN-RANGE                         24990000
527746                                   TO PV-BLOCK-NUMBER             25000000
527747             PERFORM 4410-READ-TEMP-STORAGE                       25010000
527748             PERFORM 3510-MARK-SELECTED-INDS                      25020000
527749                 VARYING ASC-ITEM-SUB                             25030000
527750                 FROM 1 BY 1                                      25040000
527751                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          25050000
527752             PERFORM 5100-WRITE-TEMP-STORAGE                      25060000
527753             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     25070000
527754         END-PERFORM                                              25080000
527755                                                                  25090000
527756         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         25100000
527757             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     25110000
527758         PERFORM                                                  25120000
527759             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       25130000
527760                   PV-LAST-BLOCK-IN-RANGE                         25140000
527761             MOVE PV-NEXT-BLOCK-IN-ARRAY                          25150000
527762                                   TO PV-BLOCK-NUMBER             25160000
527763             PERFORM 4410-READ-TEMP-STORAGE                       25170000
527764             PERFORM 3510-MARK-SELECTED-INDS                      25180000
527765                 VARYING ASC-ITEM-SUB                             25190000
527766                 FROM 1 BY 1                                      25200000
527767                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          25210000
527768             PERFORM 5100-WRITE-TEMP-STORAGE                      25220000
527769             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      25230000
527770         END-PERFORM                                              25240000
527771                                                                  25250000
527772         MOVE PV-FIRST-BLOCK-IN-ARRAY                             25260000
527773                                   TO PV-BLOCK-NUMBER             25270000
527774         PERFORM 4410-READ-TEMP-STORAGE                           25280000
527775     END-IF.                                                      25290000
527776                                                                  25300000
527777     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 25310000
527778                                      ASC-END-OF-SELECTED-RANGE.  25320000
527779                                                                  25330000
527780 EJECT                                                            25340000
527781*----------------------------------------------------------------*25350000
527782* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *25360000
527783*----------------------------------------------------------------*25370000
527784 3510-MARK-SELECTED-INDS.                                         25380000
527785                                                                  25390000
527786     IF PS-CICS-SWITCH-YES                                        25400000
527787         INITIALIZE PV-CICS-MSG-AREA                              25410000
527788         STRING ' ' PV-SRC-TASK-NUMBER                            25420000
527789                ' WSKCS316-3510'                                  25430000
527790                DELIMITED BY SIZE                                 25440000
527800                          INTO PV-CICS-MSG-AREA                   25450000
527900         PERFORM 7000-WRITE-TO-CICS-LOG                           25460000
527901     END-IF.                                                      25470000
527902*                                                                 25480000
527903     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         25490000
527904                                ASC-ITEM-SUB) >                   25500000
527905         ASC-START-OF-SELECTED-RANGE)                             25510000
527906     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         25520000
527907                                ASC-ITEM-SUB) =                   25530000
527908         ASC-START-OF-SELECTED-RANGE)                             25540000
527909                                                                  25550000
527910         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     25560000
527911                                    ASC-ITEM-SUB) <               25570000
527912             ASC-END-OF-SELECTED-RANGE)                           25580000
527913         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     25590000
527914                                    ASC-ITEM-SUB) =               25600000
527915             ASC-END-OF-SELECTED-RANGE)                           25610000
527916                                                                  25620000
527917             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          25630000
527918                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   25640000
527919                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   25650000
527920                               TO TRUE                            25660000
527921                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              25670000
527922                               TO TRUE                            25680000
527923                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    25690000
527924             END-IF                                               25700000
527925         END-IF                                                   25710000
527926     END-IF.                                                      25720000
527927                                                                  25730000
527928 EJECT                                                            25740000
527929*----------------------------------------------------------------*25750000
527930*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *25760000
527931*    INITIALIZE ALL COUNTERS AND FLAGS.                          *25770000
527932*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *25780000
527933*    DISPLAY THE PANEL TO USER.                                  *25790000
527934*----------------------------------------------------------------*25800000
527935 4000-BUILD-INITIAL-PANEL.                                        25810000
527936                                                                  25820000
527937     IF PS-CICS-SWITCH-YES                                        25830000
527938         INITIALIZE PV-CICS-MSG-AREA                              25840000
527939         STRING ' ' PV-SRC-TASK-NUMBER                            25850000
527940                ' WSKCS316-4000'                                  25860000
527950                DELIMITED BY SIZE                                 25870000
527960                          INTO PV-CICS-MSG-AREA                   25880000
527970         PERFORM 7000-WRITE-TO-CICS-LOG                           25890000
527971     END-IF.                                                      25900000
527972*                                                                 25910000
527973     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            25920000
527974                                 ASC-BLOCK-ENTRIES (2).           25930000
527975     MOVE +1                  TO ASC-BLK-SUB.                     25940000
527976     SET ASC-ITEMS-LEFT-ON-DB TO TRUE.                            25950000
527977                                                                  25960000
527978     MOVE +0                  TO ASC-ITEM-SUB                     25970000
527979                                 ASC-NUMBER-OF-ITEMS-READ         25980000
527980                                 ASC-NUMBER-OF-SELECTED-ITEMS     25990000
527981                                 ASC-HIGHEST-BLOCK-WRITTEN        26000000
527982                                 ASC-START-OF-SELECTED-RANGE      26010000
527983                                 ASC-END-OF-SELECTED-RANGE        26020000
527984                                 ASC-ITEM-AT-TOP-OF-PANEL.        26030000
527985                                                                  26040000
527986     MOVE ASC-KEY-SHPMT-ID    TO DK-EXT-SHP-ID.                   26050000
527987                                                                  26060000
171410     PERFORM 4005-PREPARE-CURSOR.                                 26070099
171410                                                                  26080099
171410     EVALUATE TRUE                                                26090099
171410        WHEN ASC-WMS-SHIP-CURSOR                                  26100099
171410          IF ASC-PO-SEQ                                           26110099
527988             PERFORM 4010-OPEN-CURSOR                             26120099
171410          ELSE                                                    26130099
171410             PERFORM 4011-OPEN-CURSOR                             26140099
171410          END-IF                                                  26150099
171410        WHEN ASC-PO-CURSOR                                        26160099
171410          IF ASC-PO-SEQ                                           26170099
171410             PERFORM 4012-OPEN-CURSOR                             26180099
171410          ELSE                                                    26190099
171410             PERFORM 4013-OPEN-CURSOR                             26200099
171410          END-IF                                                  26210099
171410        WHEN ASC-PO-SKU-CURSOR                                    26220099
171410          IF ASC-PO-SEQ                                           26230099
171410             PERFORM 4014-OPEN-CURSOR                             26240099
171410          ELSE                                                    26250099
171410             PERFORM 4015-OPEN-CURSOR                             26260099
171410          END-IF                                                  26270099
171410        WHEN ASC-SKU-CURSOR                                       26280099
171410          IF ASC-PO-SEQ                                           26290099
171410             PERFORM 4016-OPEN-CURSOR                             26300099
171410          ELSE                                                    26310099
171410             PERFORM 4017-OPEN-CURSOR                             26320099
171410          END-IF                                                  26330099
171410     END-EVALUATE.                                                26340099
527988                                                                  26350099
527989     PERFORM 4300-READ-ITEMS-FROM-DB.                             26360000
                                                                        26370099
171410     EVALUATE TRUE                                                26380099
171410        WHEN ASC-WMS-SHIP-CURSOR                                  26390099
171410          IF ASC-PO-SEQ                                           26400099
171410             PERFORM 4020-CLOSE-CURSOR                            26410099
171410          ELSE                                                    26420099
171410             PERFORM 4021-CLOSE-CURSOR                            26430099
171410          END-IF                                                  26440099
171410        WHEN ASC-PO-CURSOR                                        26450099
171410          IF ASC-PO-SEQ                                           26460099
171410             PERFORM 4022-CLOSE-CURSOR                            26470099
171410          ELSE                                                    26480099
171410             PERFORM 4023-CLOSE-CURSOR                            26490099
171410          END-IF                                                  26500099
171410        WHEN ASC-PO-SKU-CURSOR                                    26510099
171410          IF ASC-PO-SEQ                                           26520099
171410             PERFORM 4024-CLOSE-CURSOR                            26530099
171410          ELSE                                                    26540099
171410             PERFORM 4025-CLOSE-CURSOR                            26550099
171410          END-IF                                                  26560099
171410        WHEN ASC-SKU-CURSOR                                       26570099
171410          IF ASC-PO-SEQ                                           26580099
171410             PERFORM 4026-CLOSE-CURSOR                            26590099
171410          ELSE                                                    26600099
171410             PERFORM 4027-CLOSE-CURSOR                            26610099
171410          END-IF                                                  26620099
171410     END-EVALUATE.                                                26630099
527991                                                                  26640000
527992     MOVE +1                   TO  PV-TOP-ITEM.                   26650000
527993     IF ASC-NUMBER-OF-ITEMS-READ = ZERO                           26660000
171410         IF  ASC-WMS-SHIP-CURSOR                                  26670099
527994            SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                 26680099
527995            SET DP020-MSG-FATAL   TO  TRUE                        26690099
527996            MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER            26700099
171410         ELSE                                                     26710099
171410             SET PS-ERROR                                         26720099
171410                 DP020-MSG-FATAL TO TRUE                          26730099
171410             MOVE PC-TSYMSG-00050                                 26740099
171410                                 TO DP020-MSG-NUMBER              26750099
171410             MOVE DP015-UNP-ALP-BRT-OFF                           26760099
171410                                 TO ASKSRCHA                      26770099
171410             MOVE DP015-RED      TO ASKSRCHC                      26780099
171410             MOVE DP015-REVERSE  TO ASKSRCHH                      26790099
171410             MOVE -1             TO ASKSRCHL                      26800099
171410             SET DP030-SET-CURSOR-APPL-1                          26810099
171410                                 TO TRUE                          26820099
519497             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 26830099
527997         END-IF                                                   26840099
527997     ELSE                                                         26850099
527998         MOVE -1               TO MR-SELECTL (1)                  26860000
527999         SET DP030-SET-CURSOR-APPL-1                              26870000
528000                               TO TRUE                            26880000
528001         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     26890000
528002     END-IF.                                                      26900000
528003/                                                                 26910000
528004                                                                  26920000
171410***************************************************************** 26930099
171410 4005-PREPARE-CURSOR.                                             26940099
171410                                                                  26950099
171410     IF ASC-PO-SEQ                                                26960099
171410        MOVE 'PO SEQUENCE'            TO ASRTORDO                 26970099
171410        MOVE DP015-YELLOW             TO ASRTORDC                 26980099
171410     ELSE                                                         26990099
171410        MOVE 'LVL SEQUENCE'           TO ASRTORDO                 27000099
171410        MOVE DP015-YELLOW             TO ASRTORDC                 27010099
171410     END-IF.                                                      27020099
171410                                                                  27030099
171410     IF  ASC-PO-SRCH  > SPACES                                    27040099
171410     AND ASC-SKU-SRCH > SPACES                                    27050099
171410        SET ASC-PO-SKU-CURSOR         TO TRUE                     27060099
171410     ELSE                                                         27070099
171410        IF  ASC-PO-SRCH  > SPACES                                 27080099
171410        AND ASC-SKU-SRCH = SPACES                                 27090099
171410           SET ASC-PO-CURSOR          TO TRUE                     27100099
171410        ELSE                                                      27110099
171410           IF  ASC-PO-SRCH  = SPACES                              27120099
171410           AND ASC-SKU-SRCH > SPACES                              27130099
171410              SET ASC-SKU-CURSOR      TO TRUE                     27140099
171410           ELSE                                                   27150099
171410              SET ASC-WMS-SHIP-CURSOR TO TRUE                     27160099
171410******        MOVE SPACES             TO ASRTORDO                 27170099
171410           END-IF                                                 27180099
171410        END-IF                                                    27190099
171410     END-IF.                                                      27200099
171410                                                                  27210099
171410***************************************************************** 27220099
528005 4010-OPEN-CURSOR.                                                27230000
528006                                                                  27240000
528007     IF PS-CICS-SWITCH-YES                                        27250000
528008         INITIALIZE PV-CICS-MSG-AREA                              27260000
528009         STRING ' ' PV-SRC-TASK-NUMBER                            27270000
528010                ' WSKCS316-4010 OPEN CURSOR'                      27280000
528020                ' SHPMT=' DK-EXT-SHP-ID                           27290000
528030                DELIMITED BY SIZE                                 27300000
528040                          INTO PV-CICS-MSG-AREA                   27310000
528050         PERFORM 7000-WRITE-TO-CICS-LOG                           27320000
528051     END-IF.                                                      27330000
528052*                                                                 27340000
528053     EXEC SQL                                                     27350000
528054         OPEN  WMS-SHIP-CSR                                       27360000
528055     END-EXEC.                                                    27370000
528056                                                                  27380000
528057     EVALUATE TRUE                                                27390000
528058         WHEN SQLCODE = ZERO                                      27400000
528059             SET PS-EOF-WMS-CSR-NO TO TRUE                        27410000
528060         WHEN SQLCODE = -904                                      27420000
528061         WHEN SQLCODE = -913                                      27430000
528062             CONTINUE                                             27440000
528063         WHEN SQLWARN0 NOT = SPACES                               27450000
528064         WHEN SQLCODE < ZERO                                      27460000
528065         WHEN SQLCODE > ZERO                                      27470000
528066             INITIALIZE PV-CICS-MSG-AREA                          27480000
528067             MOVE SQLCODE TO PV-DISPLAY                           27490000
528068             STRING ' ' PV-SRC-TASK-NUMBER                        27500000
528069                    ' WSKCS316-4010'                              27510000
528070                    ' SQL=' PV-DISPLAY                            27520000
528080                    DELIMITED BY SIZE                             27530000
528090                          INTO PV-CICS-MSG-AREA                   27540000
528091             PERFORM 7000-WRITE-TO-CICS-LOG                       27550000
528092*                                                                 27560000
528093             MOVE '4010-OPEN-CURSOR' TO DP013-PARAGRAPH           27570000
528094             MOVE 'OPEN CURSOR PROBLEM    - '                     27580000
528095                                   TO DP013-MESSAGE-TEXT (1)      27590000
528096             MOVE SQLCA        TO DP013-SQLCA                     27600000
528097             MOVE 'WST_SHPMT_XREF_DTL'                            27610000
528098                               TO DP013-DB2-TABLE-NAME (1)        27620000
171410             MOVE 'TPURITM'    TO DP013-DB2-TABLE-NAME (2)        27630099
171410             MOVE 'XLT_SKU'    TO DP013-DB2-TABLE-NAME (3)        27640099
528099             SET DP013-DB2-ABEND                                  27650000
528100                 DP013-XCTL-DISPLAY-RESTART TO TRUE               27660000
528101             PERFORM DP013-0000-PROCESS-ABEND                     27670000
528102     END-EVALUATE.                                                27680000
528103*                                                                 27690099
528006                                                                  27700099
171410***************************************************************** 27710099
171410 4011-OPEN-CURSOR.                                                27720099
171410                                                                  27730099
171410     IF PS-CICS-SWITCH-YES                                        27740099
171410         INITIALIZE PV-CICS-MSG-AREA                              27750099
171410         STRING ' ' PV-SRC-TASK-NUMBER                            27760099
171410                ' WSKCS316-4011 OPEN CURSOR'                      27770099
171410                ' SHPMT=' DK-EXT-SHP-ID                           27780099
171410                DELIMITED BY SIZE                                 27790099
171410                          INTO PV-CICS-MSG-AREA                   27800099
171410         PERFORM 7000-WRITE-TO-CICS-LOG                           27810099
171410     END-IF.                                                      27820099
171410                                                                  27830099
171410     EXEC SQL                                                     27840099
171410         OPEN  WMS-ASNLEVEL-CSR                                   27850099
171410     END-EXEC.                                                    27860099
171410                                                                  27870099
171410     EVALUATE TRUE                                                27880099
171410         WHEN SQLCODE = ZERO                                      27890099
171410             SET PS-EOF-WMS-CSR-NO TO TRUE                        27900099
171410                                                                  27910099
171410         WHEN SQLCODE = -904                                      27920099
171410         WHEN SQLCODE = -913                                      27930099
171410             CONTINUE                                             27940099
171410                                                                  27950099
171410         WHEN SQLWARN0 NOT = SPACES                               27960099
171410         WHEN SQLCODE < ZERO                                      27970099
171410         WHEN SQLCODE > ZERO                                      27980099
171410             INITIALIZE PV-CICS-MSG-AREA                          27990099
171410             MOVE SQLCODE TO PV-DISPLAY                           28000099
171410             STRING ' ' PV-SRC-TASK-NUMBER                        28010099
171410                    ' WSKCS316-4011'                              28020099
171410                    ' SQL=' PV-DISPLAY                            28030099
171410                    DELIMITED BY SIZE                             28040099
171410                          INTO PV-CICS-MSG-AREA                   28050099
171410             PERFORM 7000-WRITE-TO-CICS-LOG                       28060099
171410                                                                  28070099
171410             MOVE '4011-OPEN-CURSOR' TO DP013-PARAGRAPH           28080099
171410             MOVE 'OPEN CURSOR PROBLEM    - '                     28090099
171410                                   TO DP013-MESSAGE-TEXT (1)      28100099
171410             MOVE SQLCA        TO DP013-SQLCA                     28110099
171410             MOVE 'WST_SHPMT_XREF_DTL'                            28120099
171410                               TO DP013-DB2-TABLE-NAME (1)        28130099
171410             MOVE 'TPURITM'    TO DP013-DB2-TABLE-NAME (2)        28140099
171410             MOVE 'XLT_SKU'    TO DP013-DB2-TABLE-NAME (3)        28150099
171410             SET DP013-DB2-ABEND                                  28160099
171410                 DP013-XCTL-DISPLAY-RESTART TO TRUE               28170099
171410             PERFORM DP013-0000-PROCESS-ABEND                     28180099
171410     END-EVALUATE.                                                28190099
171410                                                                  28200099
171410***************************************************************** 28210099
171410 4012-OPEN-CURSOR.                                                28220099
171410                                                                  28230099
171410     IF PS-CICS-SWITCH-YES                                        28240099
171410         INITIALIZE PV-CICS-MSG-AREA                              28250099
171410         MOVE DK-PO-NBR   TO PV-DISPLAY-1                         28260099
171410         STRING ' ' PV-SRC-TASK-NUMBER                            28270099
171410                ' WSKCS316-4012 OPEN CURSOR'                      28280099
171410                ' SHPMT=' DK-EXT-SHP-ID                           28290099
171410                ' PO='    PV-DISPLAY-1                            28300099
171410                DELIMITED BY SIZE                                 28310099
171410                          INTO PV-CICS-MSG-AREA                   28320099
171410         PERFORM 7000-WRITE-TO-CICS-LOG                           28330099
171410     END-IF.                                                      28340099
171410                                                                  28350099
171410     EXEC SQL                                                     28360099
171410         OPEN  WMS-PO-CSR                                         28370099
171410     END-EXEC.                                                    28380099
171410                                                                  28390099
171410     EVALUATE TRUE                                                28400099
171410         WHEN SQLCODE = ZERO                                      28410099
171410             SET PS-EOF-WMS-CSR-NO TO TRUE                        28420099
171410                                                                  28430099
171410         WHEN SQLCODE = -904                                      28440099
171410         WHEN SQLCODE = -913                                      28450099
171410             CONTINUE                                             28460099
171410                                                                  28470099
171410         WHEN SQLWARN0 NOT = SPACES                               28480099
171410         WHEN SQLCODE < ZERO                                      28490099
171410         WHEN SQLCODE > ZERO                                      28500099
171410             INITIALIZE PV-CICS-MSG-AREA                          28510099
171410             MOVE SQLCODE TO PV-DISPLAY                           28520099
171410             STRING ' ' PV-SRC-TASK-NUMBER                        28530099
171410                    ' WSKCS316-4012'                              28540099
171410                    ' SQL=' PV-DISPLAY                            28550099
171410                    DELIMITED BY SIZE                             28560099
171410                          INTO PV-CICS-MSG-AREA                   28570099
171410             PERFORM 7000-WRITE-TO-CICS-LOG                       28580099
171410                                                                  28590099
171410             MOVE '4012-OPEN-CURSOR' TO DP013-PARAGRAPH           28600099
171410             MOVE 'OPEN CURSOR PROBLEM    - '                     28610099
171410                                   TO DP013-MESSAGE-TEXT (1)      28620099
171410             MOVE SQLCA        TO DP013-SQLCA                     28630099
171410             MOVE 'WST_SHPMT_XREF_DTL'                            28640099
171410                               TO DP013-DB2-TABLE-NAME (1)        28650099
171410             MOVE 'TPURITM'    TO DP013-DB2-TABLE-NAME (2)        28660099
171410             MOVE 'XLT_SKU'    TO DP013-DB2-TABLE-NAME (3)        28670099
171410             SET DP013-DB2-ABEND                                  28680099
171410                 DP013-XCTL-DISPLAY-RESTART TO TRUE               28690099
171410             PERFORM DP013-0000-PROCESS-ABEND                     28700099
171410     END-EVALUATE.                                                28710099
171410                                                                  28720099
171410***************************************************************** 28730099
171410 4013-OPEN-CURSOR.                                                28740099
171410                                                                  28750099
171410     IF PS-CICS-SWITCH-YES                                        28760099
171410         INITIALIZE PV-CICS-MSG-AREA                              28770099
171410         MOVE DK-PO-NBR   TO PV-DISPLAY-1                         28780099
171410         STRING ' ' PV-SRC-TASK-NUMBER                            28790099
171410                ' WSKCS316-4013 OPEN CURSOR'                      28800099
171410                ' SHPMT=' DK-EXT-SHP-ID                           28810099
171410                ' PO='    PV-DISPLAY-1                            28820099
171410                DELIMITED BY SIZE                                 28830099
171410                          INTO PV-CICS-MSG-AREA                   28840099
171410         PERFORM 7000-WRITE-TO-CICS-LOG                           28850099
171410     END-IF.                                                      28860099
171410                                                                  28870099
171410     EXEC SQL                                                     28880099
171410         OPEN  WMS-POASN-CSR                                      28890099
171410     END-EXEC.                                                    28900099
171410                                                                  28910099
171410     EVALUATE TRUE                                                28920099
171410         WHEN SQLCODE = ZERO                                      28930099
171410             SET PS-EOF-WMS-CSR-NO TO TRUE                        28940099
171410                                                                  28950099
171410         WHEN SQLCODE = -904                                      28960099
171410         WHEN SQLCODE = -913                                      28970099
171410             CONTINUE                                             28980099
171410                                                                  28990099
171410         WHEN SQLWARN0 NOT = SPACES                               29000099
171410         WHEN SQLCODE < ZERO                                      29010099
171410         WHEN SQLCODE > ZERO                                      29020099
171410             INITIALIZE PV-CICS-MSG-AREA                          29030099
171410             MOVE SQLCODE TO PV-DISPLAY                           29040099
171410             STRING ' ' PV-SRC-TASK-NUMBER                        29050099
171410                    ' WSKCS316-4013'                              29060099
171410                    ' SQL=' PV-DISPLAY                            29070099
171410                    DELIMITED BY SIZE                             29080099
171410                          INTO PV-CICS-MSG-AREA                   29090099
171410             PERFORM 7000-WRITE-TO-CICS-LOG                       29100099
171410                                                                  29110099
171410             MOVE '4013-OPEN-CURSOR' TO DP013-PARAGRAPH           29120099
171410             MOVE 'OPEN CURSOR PROBLEM    - '                     29130099
171410                                   TO DP013-MESSAGE-TEXT (1)      29140099
171410             MOVE SQLCA        TO DP013-SQLCA                     29150099
171410             MOVE 'WST_SHPMT_XREF_DTL'                            29160099
171410                               TO DP013-DB2-TABLE-NAME (1)        29170099
171410             MOVE 'TPURITM'    TO DP013-DB2-TABLE-NAME (2)        29180099
171410             MOVE 'XLT_SKU'    TO DP013-DB2-TABLE-NAME (3)        29190099
171410             SET DP013-DB2-ABEND                                  29200099
171410                 DP013-XCTL-DISPLAY-RESTART TO TRUE               29210099
171410             PERFORM DP013-0000-PROCESS-ABEND                     29220099
171410     END-EVALUATE.                                                29230099
171410                                                                  29240099
171410***************************************************************** 29250099
171410 4014-OPEN-CURSOR.                                                29260099
171410                                                                  29270099
171410     IF PS-CICS-SWITCH-YES                                        29280099
171410         INITIALIZE PV-CICS-MSG-AREA                              29290099
171410         MOVE DK-PO-NBR   TO PV-DISPLAY-1                         29300099
171410         MOVE DK-SKU-NBR  TO PV-DISPLAY-2                         29310099
171410         STRING ' ' PV-SRC-TASK-NUMBER                            29320099
171410                ' WSKCS316-4014 OPEN CURSOR'                      29330099
171410                ' SHPMT=' DK-EXT-SHP-ID                           29340099
171410                ' PO='    PV-DISPLAY-1                            29350099
171410                ' SKU='   PV-DISPLAY-2                            29360099
171410                DELIMITED BY SIZE                                 29370099
171410                          INTO PV-CICS-MSG-AREA                   29380099
171410         PERFORM 7000-WRITE-TO-CICS-LOG                           29390099
171410     END-IF.                                                      29400099
171410                                                                  29410099
171410     EXEC SQL                                                     29420099
171410         OPEN  WMS-POSKU-CSR                                      29430099
171410     END-EXEC.                                                    29440099
171410                                                                  29450099
171410     EVALUATE TRUE                                                29460099
171410         WHEN SQLCODE = ZERO                                      29470099
171410             SET PS-EOF-WMS-CSR-NO TO TRUE                        29480099
171410                                                                  29490099
171410         WHEN SQLCODE = -904                                      29500099
171410         WHEN SQLCODE = -913                                      29510099
171410             CONTINUE                                             29520099
171410                                                                  29530099
171410         WHEN SQLWARN0 NOT = SPACES                               29540099
171410         WHEN SQLCODE < ZERO                                      29550099
171410         WHEN SQLCODE > ZERO                                      29560099
171410             INITIALIZE PV-CICS-MSG-AREA                          29570099
171410             MOVE SQLCODE TO PV-DISPLAY                           29580099
171410             STRING ' ' PV-SRC-TASK-NUMBER                        29590099
171410                    ' WSKCS316-4014'                              29600099
171410                    ' SQL=' PV-DISPLAY                            29610099
171410                    DELIMITED BY SIZE                             29620099
171410                          INTO PV-CICS-MSG-AREA                   29630099
171410             PERFORM 7000-WRITE-TO-CICS-LOG                       29640099
171410                                                                  29650099
171410             MOVE '4014-OPEN-CURSOR' TO DP013-PARAGRAPH           29660099
171410             MOVE 'OPEN CURSOR PROBLEM    - '                     29670099
171410                                   TO DP013-MESSAGE-TEXT (1)      29680099
171410             MOVE SQLCA        TO DP013-SQLCA                     29690099
171410             MOVE 'WST_SHPMT_XREF_DTL'                            29700099
171410                               TO DP013-DB2-TABLE-NAME (1)        29710099
171410             MOVE 'TPURITM'    TO DP013-DB2-TABLE-NAME (2)        29720099
171410             MOVE 'XLT_SKU'    TO DP013-DB2-TABLE-NAME (3)        29730099
171410             SET DP013-DB2-ABEND                                  29740099
171410                 DP013-XCTL-DISPLAY-RESTART TO TRUE               29750099
171410             PERFORM DP013-0000-PROCESS-ABEND                     29760099
171410     END-EVALUATE.                                                29770099
171410                                                                  29780099
171410***************************************************************** 29790099
171410 4015-OPEN-CURSOR.                                                29800099
171410                                                                  29810099
171410     IF PS-CICS-SWITCH-YES                                        29820099
171410         INITIALIZE PV-CICS-MSG-AREA                              29830099
171410         MOVE DK-PO-NBR   TO PV-DISPLAY-1                         29840099
171410         MOVE DK-SKU-NBR  TO PV-DISPLAY-2                         29850099
171410         STRING ' ' PV-SRC-TASK-NUMBER                            29860099
171410                ' WSKCS316-4015 OPEN CURSOR'                      29870099
171410                ' SHPMT=' DK-EXT-SHP-ID                           29880099
171410                ' PO='    PV-DISPLAY-1                            29890099
171410                ' SKU='   PV-DISPLAY-2                            29900099
171410                DELIMITED BY SIZE                                 29910099
171410                          INTO PV-CICS-MSG-AREA                   29920099
171410         PERFORM 7000-WRITE-TO-CICS-LOG                           29930099
171410     END-IF.                                                      29940099
171410                                                                  29950099
171410     EXEC SQL                                                     29960099
171410         OPEN  WMS-POSKU-ASN-CSR                                  29970099
171410     END-EXEC.                                                    29980099
171410                                                                  29990099
171410     EVALUATE TRUE                                                30000099
171410         WHEN SQLCODE = ZERO                                      30010099
171410             SET PS-EOF-WMS-CSR-NO TO TRUE                        30020099
171410                                                                  30030099
171410         WHEN SQLCODE = -904                                      30040099
171410         WHEN SQLCODE = -913                                      30050099
171410             CONTINUE                                             30060099
171410                                                                  30070099
171410         WHEN SQLWARN0 NOT = SPACES                               30080099
171410         WHEN SQLCODE < ZERO                                      30090099
171410         WHEN SQLCODE > ZERO                                      30100099
171410             INITIALIZE PV-CICS-MSG-AREA                          30110099
171410             MOVE SQLCODE TO PV-DISPLAY                           30120099
171410             STRING ' ' PV-SRC-TASK-NUMBER                        30130099
171410                    ' WSKCS316-4015'                              30140099
171410                    ' SQL=' PV-DISPLAY                            30150099
171410                    DELIMITED BY SIZE                             30160099
171410                          INTO PV-CICS-MSG-AREA                   30170099
171410             PERFORM 7000-WRITE-TO-CICS-LOG                       30180099
171410                                                                  30190099
171410             MOVE '4015-OPEN-CURSOR' TO DP013-PARAGRAPH           30200099
171410             MOVE 'OPEN CURSOR PROBLEM    - '                     30210099
171410                                   TO DP013-MESSAGE-TEXT (1)      30220099
171410             MOVE SQLCA        TO DP013-SQLCA                     30230099
171410             MOVE 'WST_SHPMT_XREF_DTL'                            30240099
171410                               TO DP013-DB2-TABLE-NAME (1)        30250099
171410             MOVE 'TPURITM'    TO DP013-DB2-TABLE-NAME (2)        30260099
171410             MOVE 'XLT_SKU'    TO DP013-DB2-TABLE-NAME (3)        30270099
171410             SET DP013-DB2-ABEND                                  30280099
171410                 DP013-XCTL-DISPLAY-RESTART TO TRUE               30290099
171410             PERFORM DP013-0000-PROCESS-ABEND                     30300099
171410     END-EVALUATE.                                                30310099
171410                                                                  30320099
171410***************************************************************** 30330099
171410 4016-OPEN-CURSOR.                                                30340099
171410                                                                  30350099
171410     IF PS-CICS-SWITCH-YES                                        30360099
171410         INITIALIZE PV-CICS-MSG-AREA                              30370099
171410         MOVE DK-SKU-NBR  TO PV-DISPLAY-1                         30380099
171410         STRING ' ' PV-SRC-TASK-NUMBER                            30390099
171410                ' WSKCS316-4016 OPEN CURSOR'                      30400099
171410                ' SHPMT=' DK-EXT-SHP-ID                           30410099
171410                ' SKU='   PV-DISPLAY-1                            30420099
171410                DELIMITED BY SIZE                                 30430099
171410                          INTO PV-CICS-MSG-AREA                   30440099
171410         PERFORM 7000-WRITE-TO-CICS-LOG                           30450099
171410     END-IF.                                                      30460099
171410                                                                  30470099
171410     EXEC SQL                                                     30480099
171410         OPEN  WMS-SKU-CSR                                        30490099
171410     END-EXEC.                                                    30500099
171410                                                                  30510099
171410     EVALUATE TRUE                                                30520099
171410         WHEN SQLCODE = ZERO                                      30530099
171410             SET PS-EOF-WMS-CSR-NO TO TRUE                        30540099
171410                                                                  30550099
171410         WHEN SQLCODE = -904                                      30560099
171410         WHEN SQLCODE = -913                                      30570099
171410             CONTINUE                                             30580099
171410                                                                  30590099
171410         WHEN SQLWARN0 NOT = SPACES                               30600099
171410         WHEN SQLCODE < ZERO                                      30610099
171410         WHEN SQLCODE > ZERO                                      30620099
171410             INITIALIZE PV-CICS-MSG-AREA                          30630099
171410             MOVE SQLCODE TO PV-DISPLAY                           30640099
171410             STRING ' ' PV-SRC-TASK-NUMBER                        30650099
171410                    ' WSKCS316-4016'                              30660099
171410                    ' SQL=' PV-DISPLAY                            30670099
171410                    DELIMITED BY SIZE                             30680099
171410                          INTO PV-CICS-MSG-AREA                   30690099
171410             PERFORM 7000-WRITE-TO-CICS-LOG                       30700099
171410                                                                  30710099
171410             MOVE '4016-OPEN-CURSOR' TO DP013-PARAGRAPH           30720099
171410             MOVE 'OPEN CURSOR PROBLEM    - '                     30730099
171410                                   TO DP013-MESSAGE-TEXT (1)      30740099
171410             MOVE SQLCA        TO DP013-SQLCA                     30750099
171410             MOVE 'WST_SHPMT_XREF_DTL'                            30760099
171410                               TO DP013-DB2-TABLE-NAME (1)        30770099
171410             MOVE 'TPURITM'    TO DP013-DB2-TABLE-NAME (2)        30780099
171410             MOVE 'XLT_SKU'    TO DP013-DB2-TABLE-NAME (3)        30790099
171410             SET DP013-DB2-ABEND                                  30800099
171410                 DP013-XCTL-DISPLAY-RESTART TO TRUE               30810099
171410             PERFORM DP013-0000-PROCESS-ABEND                     30820099
171410     END-EVALUATE.                                                30830099
171410                                                                  30840099
171410***************************************************************** 30850099
171410 4017-OPEN-CURSOR.                                                30860099
171410                                                                  30870099
171410     IF PS-CICS-SWITCH-YES                                        30880099
171410         INITIALIZE PV-CICS-MSG-AREA                              30890099
171410         MOVE DK-SKU-NBR  TO PV-DISPLAY-1                         30900099
171410         STRING ' ' PV-SRC-TASK-NUMBER                            30910099
171410                ' WSKCS316-4017 OPEN CURSOR'                      30920099
171410                ' SHPMT=' DK-EXT-SHP-ID                           30930099
171410                ' SKU='   PV-DISPLAY-1                            30940099
171410                DELIMITED BY SIZE                                 30950099
171410                          INTO PV-CICS-MSG-AREA                   30960099
171410         PERFORM 7000-WRITE-TO-CICS-LOG                           30970099
171410     END-IF.                                                      30980099
171410                                                                  30990099
171410     EXEC SQL                                                     31000099
171410         OPEN  WMS-SKUASN-CSR                                     31010099
171410     END-EXEC.                                                    31020099
171410                                                                  31030099
171410     EVALUATE TRUE                                                31040099
171410         WHEN SQLCODE = ZERO                                      31050099
171410             SET PS-EOF-WMS-CSR-NO TO TRUE                        31060099
171410                                                                  31070099
171410         WHEN SQLCODE = -904                                      31080099
171410         WHEN SQLCODE = -913                                      31090099
171410             CONTINUE                                             31100099
171410                                                                  31110099
171410         WHEN SQLWARN0 NOT = SPACES                               31120099
171410         WHEN SQLCODE < ZERO                                      31130099
171410         WHEN SQLCODE > ZERO                                      31140099
171410             INITIALIZE PV-CICS-MSG-AREA                          31150099
171410             MOVE SQLCODE TO PV-DISPLAY                           31160099
171410             STRING ' ' PV-SRC-TASK-NUMBER                        31170099
171410                    ' WSKCS316-4017'                              31180099
171410                    ' SQL=' PV-DISPLAY                            31190099
171410                    DELIMITED BY SIZE                             31200099
171410                          INTO PV-CICS-MSG-AREA                   31210099
171410             PERFORM 7000-WRITE-TO-CICS-LOG                       31220099
171410                                                                  31230099
171410             MOVE '4017-OPEN-CURSOR' TO DP013-PARAGRAPH           31240099
171410             MOVE 'OPEN CURSOR PROBLEM    - '                     31250099
171410                                   TO DP013-MESSAGE-TEXT (1)      31260099
171410             MOVE SQLCA        TO DP013-SQLCA                     31270099
171410             MOVE 'WST_SHPMT_XREF_DTL'                            31280099
171410                               TO DP013-DB2-TABLE-NAME (1)        31290099
171410             MOVE 'TPURITM'    TO DP013-DB2-TABLE-NAME (2)        31300099
171410             MOVE 'XLT_SKU'    TO DP013-DB2-TABLE-NAME (3)        31310099
171410             SET DP013-DB2-ABEND                                  31320099
171410                 DP013-XCTL-DISPLAY-RESTART TO TRUE               31330099
171410             PERFORM DP013-0000-PROCESS-ABEND                     31340099
171410     END-EVALUATE.                                                31350099
171410                                                                  31360099
171410****************************************************************  31370099
528105 4020-CLOSE-CURSOR.                                               31380000
528106                                                                  31390000
528107     IF PS-CICS-SWITCH-YES                                        31400000
528108         INITIALIZE PV-CICS-MSG-AREA                              31410000
528109         STRING ' ' PV-SRC-TASK-NUMBER                            31420000
528110                ' WSKCS316-4020 CLOSE CURSOR'                     31430000
528120                DELIMITED BY SIZE                                 31440000
528130                          INTO PV-CICS-MSG-AREA                   31450000
528140         PERFORM 7000-WRITE-TO-CICS-LOG                           31460000
528141     END-IF.                                                      31470000
528142*                                                                 31480099
528143     EXEC SQL                                                     31490000
528144         CLOSE  WMS-SHIP-CSR                                      31500000
528145     END-EXEC.                                                    31510000
528146                                                                  31520000
528147     EVALUATE TRUE                                                31530000
528148         WHEN SQLCODE = ZERO                                      31540000
528149         WHEN SQLCODE = +100                                      31550000
528150             CONTINUE                                             31560000
528151         WHEN SQLWARN0 NOT = SPACES                               31570000
528152         WHEN SQLCODE < ZERO                                      31580000
528153         WHEN SQLCODE > ZERO                                      31590000
528154             INITIALIZE PV-CICS-MSG-AREA                          31600000
528155             MOVE SQLCODE TO PV-DISPLAY                           31610000
528156             STRING ' ' PV-SRC-TASK-NUMBER                        31620000
528157                    ' WSKCS316-4020'                              31630000
528158                    ' SQL=' PV-DISPLAY                            31640000
528159                    DELIMITED BY SIZE                             31650000
528160                          INTO PV-CICS-MSG-AREA                   31660000
528161             PERFORM 7000-WRITE-TO-CICS-LOG                       31670000
528162*                                                                 31680000
528163             MOVE '4020-CLOSE-CURSOR' TO DP013-PARAGRAPH          31690000
528164             MOVE 'CLOSE CURSOR PROBLEM   '                       31700000
528165                               TO DP013-MESSAGE-TEXT (1)          31710000
528166             MOVE SQLCA        TO DP013-SQLCA                     31720000
528167             MOVE 'WST_SHPMT_XREF_DTL'                            31730000
528168                               TO DP013-DB2-TABLE-NAME (1)        31740000
171410             MOVE 'TPURITM'    TO DP013-DB2-TABLE-NAME (2)        31750099
171410             MOVE 'XLT_SKU'    TO DP013-DB2-TABLE-NAME (3)        31760099
528169             SET DP013-DB2-ABEND                                  31770000
528170                 DP013-XCTL-DISPLAY-RESTART TO TRUE               31780000
528171             PERFORM DP013-0000-PROCESS-ABEND                     31790000
528172     END-EVALUATE.                                                31800000
528173                                                                  31810000
171410****************************************************************  31820099
171410 4021-CLOSE-CURSOR.                                               31830099
171410                                                                  31840099
171410     IF PS-CICS-SWITCH-YES                                        31850099
171410         INITIALIZE PV-CICS-MSG-AREA                              31860099
171410         STRING ' ' PV-SRC-TASK-NUMBER                            31870099
171410                ' WSKCS316-4021 CLOSE CURSOR'                     31880099
171410                DELIMITED BY SIZE                                 31890099
171410                          INTO PV-CICS-MSG-AREA                   31900099
171410         PERFORM 7000-WRITE-TO-CICS-LOG                           31910099
171410     END-IF.                                                      31920099
171410                                                                  31930099
171410     EXEC SQL                                                     31940099
171410         CLOSE  WMS-ASNLEVEL-CSR                                  31950099
171410     END-EXEC.                                                    31960099
171410                                                                  31970099
171410     EVALUATE TRUE                                                31980099
171410         WHEN SQLCODE = ZERO                                      31990099
171410         WHEN SQLCODE = +100                                      32000099
171410             CONTINUE                                             32010099
171410                                                                  32020099
171410         WHEN SQLWARN0 NOT = SPACES                               32030099
171410         WHEN SQLCODE < ZERO                                      32040099
171410         WHEN SQLCODE > ZERO                                      32050099
171410             INITIALIZE PV-CICS-MSG-AREA                          32060099
171410             MOVE SQLCODE TO PV-DISPLAY                           32070099
171410             STRING ' ' PV-SRC-TASK-NUMBER                        32080099
171410                    ' WSKCS316-4021'                              32090099
171410                    ' SQL=' PV-DISPLAY                            32100099
171410                    DELIMITED BY SIZE                             32110099
171410                          INTO PV-CICS-MSG-AREA                   32120099
171410             PERFORM 7000-WRITE-TO-CICS-LOG                       32130099
171410                                                                  32140099
171410             MOVE '4021-CLOSE-CURSOR' TO DP013-PARAGRAPH          32150099
171410             MOVE 'CLOSE CURSOR PROBLEM   '                       32160099
171410                               TO DP013-MESSAGE-TEXT (1)          32170099
171410             MOVE SQLCA        TO DP013-SQLCA                     32180099
171410             MOVE 'WST_SHPMT_XREF_DTL'                            32190099
171410                               TO DP013-DB2-TABLE-NAME (1)        32200099
171410             MOVE 'TPURITM'    TO DP013-DB2-TABLE-NAME (2)        32210099
171410             MOVE 'XLT_SKU'    TO DP013-DB2-TABLE-NAME (3)        32220099
171410             SET DP013-DB2-ABEND                                  32230099
171410                 DP013-XCTL-DISPLAY-RESTART TO TRUE               32240099
171410             PERFORM DP013-0000-PROCESS-ABEND                     32250099
171410     END-EVALUATE.                                                32260099
171410                                                                  32270099
171410****************************************************************  32280099
171410 4022-CLOSE-CURSOR.                                               32290099
171410                                                                  32300099
171410     IF PS-CICS-SWITCH-YES                                        32310099
171410         INITIALIZE PV-CICS-MSG-AREA                              32320099
171410         STRING ' ' PV-SRC-TASK-NUMBER                            32330099
171410                ' WSKCS316-4022 CLOSE CURSOR'                     32340099
171410                DELIMITED BY SIZE                                 32350099
171410                          INTO PV-CICS-MSG-AREA                   32360099
171410         PERFORM 7000-WRITE-TO-CICS-LOG                           32370099
171410     END-IF.                                                      32380099
171410                                                                  32390099
171410     EXEC SQL                                                     32400099
171410         CLOSE  WMS-PO-CSR                                        32410099
171410     END-EXEC.                                                    32420099
171410                                                                  32430099
171410     EVALUATE TRUE                                                32440099
171410         WHEN SQLCODE = ZERO                                      32450099
171410         WHEN SQLCODE = +100                                      32460099
171410             CONTINUE                                             32470099
171410                                                                  32480099
171410         WHEN SQLWARN0 NOT = SPACES                               32490099
171410         WHEN SQLCODE < ZERO                                      32500099
171410         WHEN SQLCODE > ZERO                                      32510099
171410             INITIALIZE PV-CICS-MSG-AREA                          32520099
171410             MOVE SQLCODE TO PV-DISPLAY                           32530099
171410             STRING ' ' PV-SRC-TASK-NUMBER                        32540099
171410                    ' WSKCS316-4022'                              32550099
171410                    ' SQL=' PV-DISPLAY                            32560099
171410                    DELIMITED BY SIZE                             32570099
171410                          INTO PV-CICS-MSG-AREA                   32580099
171410             PERFORM 7000-WRITE-TO-CICS-LOG                       32590099
171410                                                                  32600099
171410             MOVE '4022-CLOSE-CURSOR' TO DP013-PARAGRAPH          32610099
171410             MOVE 'CLOSE CURSOR PROBLEM   '                       32620099
171410                               TO DP013-MESSAGE-TEXT (1)          32630099
171410             MOVE SQLCA        TO DP013-SQLCA                     32640099
171410             MOVE 'WST_SHPMT_XREF_DTL'                            32650099
171410                               TO DP013-DB2-TABLE-NAME (1)        32660099
171410             MOVE 'TPURITM'    TO DP013-DB2-TABLE-NAME (2)        32670099
171410             MOVE 'XLT_SKU'    TO DP013-DB2-TABLE-NAME (3)        32680099
171410             SET DP013-DB2-ABEND                                  32690099
171410                 DP013-XCTL-DISPLAY-RESTART TO TRUE               32700099
171410             PERFORM DP013-0000-PROCESS-ABEND                     32710099
171410     END-EVALUATE.                                                32720099
171410                                                                  32730099
171410****************************************************************  32740099
171410 4023-CLOSE-CURSOR.                                               32750099
171410                                                                  32760099
171410     IF PS-CICS-SWITCH-YES                                        32770099
171410         INITIALIZE PV-CICS-MSG-AREA                              32780099
171410         STRING ' ' PV-SRC-TASK-NUMBER                            32790099
171410                ' WSKCS316-4023 CLOSE CURSOR'                     32800099
171410                DELIMITED BY SIZE                                 32810099
171410                          INTO PV-CICS-MSG-AREA                   32820099
171410         PERFORM 7000-WRITE-TO-CICS-LOG                           32830099
171410     END-IF.                                                      32840099
171410                                                                  32850099
171410     EXEC SQL                                                     32860099
171410         CLOSE  WMS-POASN-CSR                                     32870099
171410     END-EXEC.                                                    32880099
171410                                                                  32890099
171410     EVALUATE TRUE                                                32900099
171410         WHEN SQLCODE = ZERO                                      32910099
171410         WHEN SQLCODE = +100                                      32920099
171410             CONTINUE                                             32930099
171410                                                                  32940099
171410         WHEN SQLWARN0 NOT = SPACES                               32950099
171410         WHEN SQLCODE < ZERO                                      32960099
171410         WHEN SQLCODE > ZERO                                      32970099
171410             INITIALIZE PV-CICS-MSG-AREA                          32980099
171410             MOVE SQLCODE TO PV-DISPLAY                           32990099
171410             STRING ' ' PV-SRC-TASK-NUMBER                        33000099
171410                    ' WSKCS316-4023'                              33010099
171410                    ' SQL=' PV-DISPLAY                            33020099
171410                    DELIMITED BY SIZE                             33030099
171410                          INTO PV-CICS-MSG-AREA                   33040099
171410             PERFORM 7000-WRITE-TO-CICS-LOG                       33050099
171410                                                                  33060099
171410             MOVE '4023-CLOSE-CURSOR' TO DP013-PARAGRAPH          33070099
171410             MOVE 'CLOSE CURSOR PROBLEM   '                       33080099
171410                               TO DP013-MESSAGE-TEXT (1)          33090099
171410             MOVE SQLCA        TO DP013-SQLCA                     33100099
171410             MOVE 'WST_SHPMT_XREF_DTL'                            33110099
171410                               TO DP013-DB2-TABLE-NAME (1)        33120099
171410             MOVE 'TPURITM'    TO DP013-DB2-TABLE-NAME (2)        33130099
171410             MOVE 'XLT_SKU'    TO DP013-DB2-TABLE-NAME (3)        33140099
171410             SET DP013-DB2-ABEND                                  33150099
171410                 DP013-XCTL-DISPLAY-RESTART TO TRUE               33160099
171410             PERFORM DP013-0000-PROCESS-ABEND                     33170099
171410     END-EVALUATE.                                                33180099
171410                                                                  33190099
171410****************************************************************  33200099
171410 4024-CLOSE-CURSOR.                                               33210099
171410                                                                  33220099
171410     IF PS-CICS-SWITCH-YES                                        33230099
171410         INITIALIZE PV-CICS-MSG-AREA                              33240099
171410         STRING ' ' PV-SRC-TASK-NUMBER                            33250099
171410                ' WSKCS316-4024 CLOSE CURSOR'                     33260099
171410                DELIMITED BY SIZE                                 33270099
171410                          INTO PV-CICS-MSG-AREA                   33280099
171410         PERFORM 7000-WRITE-TO-CICS-LOG                           33290099
171410     END-IF.                                                      33300099
171410                                                                  33310099
171410     EXEC SQL                                                     33320099
171410         CLOSE  WMS-POSKU-CSR                                     33330099
171410     END-EXEC.                                                    33340099
171410                                                                  33350099
171410     EVALUATE TRUE                                                33360099
171410         WHEN SQLCODE = ZERO                                      33370099
171410         WHEN SQLCODE = +100                                      33380099
171410             CONTINUE                                             33390099
171410                                                                  33400099
171410         WHEN SQLWARN0 NOT = SPACES                               33410099
171410         WHEN SQLCODE < ZERO                                      33420099
171410         WHEN SQLCODE > ZERO                                      33430099
171410             INITIALIZE PV-CICS-MSG-AREA                          33440099
171410             MOVE SQLCODE TO PV-DISPLAY                           33450099
171410             STRING ' ' PV-SRC-TASK-NUMBER                        33460099
171410                    ' WSKCS316-4024'                              33470099
171410                    ' SQL=' PV-DISPLAY                            33480099
171410                    DELIMITED BY SIZE                             33490099
171410                          INTO PV-CICS-MSG-AREA                   33500099
171410             PERFORM 7000-WRITE-TO-CICS-LOG                       33510099
171410                                                                  33520099
171410             MOVE '4024-CLOSE-CURSOR' TO DP013-PARAGRAPH          33530099
171410             MOVE 'CLOSE CURSOR PROBLEM   '                       33540099
171410                               TO DP013-MESSAGE-TEXT (1)          33550099
171410             MOVE SQLCA        TO DP013-SQLCA                     33560099
171410             MOVE 'WST_SHPMT_XREF_DTL'                            33570099
171410                               TO DP013-DB2-TABLE-NAME (1)        33580099
171410             MOVE 'TPURITM'    TO DP013-DB2-TABLE-NAME (2)        33590099
171410             MOVE 'XLT_SKU'    TO DP013-DB2-TABLE-NAME (3)        33600099
171410             SET DP013-DB2-ABEND                                  33610099
171410                 DP013-XCTL-DISPLAY-RESTART TO TRUE               33620099
171410             PERFORM DP013-0000-PROCESS-ABEND                     33630099
171410     END-EVALUATE.                                                33640099
171410                                                                  33650099
171410****************************************************************  33660099
171410 4025-CLOSE-CURSOR.                                               33670099
171410                                                                  33680099
171410     IF PS-CICS-SWITCH-YES                                        33690099
171410         INITIALIZE PV-CICS-MSG-AREA                              33700099
171410         STRING ' ' PV-SRC-TASK-NUMBER                            33710099
171410                ' WSKCS316-4025 CLOSE CURSOR'                     33720099
171410                DELIMITED BY SIZE                                 33730099
171410                          INTO PV-CICS-MSG-AREA                   33740099
171410         PERFORM 7000-WRITE-TO-CICS-LOG                           33750099
171410     END-IF.                                                      33760099
171410                                                                  33770099
171410     EXEC SQL                                                     33780099
171410         CLOSE  WMS-POSKU-ASN-CSR                                 33790099
171410     END-EXEC.                                                    33800099
171410                                                                  33810099
171410     EVALUATE TRUE                                                33820099
171410         WHEN SQLCODE = ZERO                                      33830099
171410         WHEN SQLCODE = +100                                      33840099
171410             CONTINUE                                             33850099
171410                                                                  33860099
171410         WHEN SQLWARN0 NOT = SPACES                               33870099
171410         WHEN SQLCODE < ZERO                                      33880099
171410         WHEN SQLCODE > ZERO                                      33890099
171410             INITIALIZE PV-CICS-MSG-AREA                          33900099
171410             MOVE SQLCODE TO PV-DISPLAY                           33910099
171410             STRING ' ' PV-SRC-TASK-NUMBER                        33920099
171410                    ' WSKCS316-4025'                              33930099
171410                    ' SQL=' PV-DISPLAY                            33940099
171410                    DELIMITED BY SIZE                             33950099
171410                          INTO PV-CICS-MSG-AREA                   33960099
171410             PERFORM 7000-WRITE-TO-CICS-LOG                       33970099
171410                                                                  33980099
171410             MOVE '4025-CLOSE-CURSOR' TO DP013-PARAGRAPH          33990099
171410             MOVE 'CLOSE CURSOR PROBLEM   '                       34000099
171410                               TO DP013-MESSAGE-TEXT (1)          34010099
171410             MOVE SQLCA        TO DP013-SQLCA                     34020099
171410             MOVE 'WST_SHPMT_XREF_DTL'                            34030099
171410                               TO DP013-DB2-TABLE-NAME (1)        34040099
171410             MOVE 'TPURITM'    TO DP013-DB2-TABLE-NAME (2)        34050099
171410             MOVE 'XLT_SKU'    TO DP013-DB2-TABLE-NAME (3)        34060099
171410             SET DP013-DB2-ABEND                                  34070099
171410                 DP013-XCTL-DISPLAY-RESTART TO TRUE               34080099
171410             PERFORM DP013-0000-PROCESS-ABEND                     34090099
171410     END-EVALUATE.                                                34100099
171410                                                                  34110099
171410****************************************************************  34120099
171410 4026-CLOSE-CURSOR.                                               34130099
171410                                                                  34140099
171410     IF PS-CICS-SWITCH-YES                                        34150099
171410         INITIALIZE PV-CICS-MSG-AREA                              34160099
171410         STRING ' ' PV-SRC-TASK-NUMBER                            34170099
171410                ' WSKCS316-4026 CLOSE CURSOR'                     34180099
171410                DELIMITED BY SIZE                                 34190099
171410                          INTO PV-CICS-MSG-AREA                   34200099
171410         PERFORM 7000-WRITE-TO-CICS-LOG                           34210099
171410     END-IF.                                                      34220099
171410                                                                  34230099
171410     EXEC SQL                                                     34240099
171410         CLOSE  WMS-SKU-CSR                                       34250099
171410     END-EXEC.                                                    34260099
171410                                                                  34270099
171410     EVALUATE TRUE                                                34280099
171410         WHEN SQLCODE = ZERO                                      34290099
171410         WHEN SQLCODE = +100                                      34300099
171410             CONTINUE                                             34310099
171410                                                                  34320099
171410         WHEN SQLWARN0 NOT = SPACES                               34330099
171410         WHEN SQLCODE < ZERO                                      34340099
171410         WHEN SQLCODE > ZERO                                      34350099
171410             INITIALIZE PV-CICS-MSG-AREA                          34360099
171410             MOVE SQLCODE TO PV-DISPLAY                           34370099
171410             STRING ' ' PV-SRC-TASK-NUMBER                        34380099
171410                    ' WSKCS316-4026'                              34390099
171410                    ' SQL=' PV-DISPLAY                            34400099
171410                    DELIMITED BY SIZE                             34410099
171410                          INTO PV-CICS-MSG-AREA                   34420099
171410             PERFORM 7000-WRITE-TO-CICS-LOG                       34430099
171410                                                                  34440099
171410             MOVE '4026-CLOSE-CURSOR' TO DP013-PARAGRAPH          34450099
171410             MOVE 'CLOSE CURSOR PROBLEM   '                       34460099
171410                               TO DP013-MESSAGE-TEXT (1)          34470099
171410             MOVE SQLCA        TO DP013-SQLCA                     34480099
171410             MOVE 'WST_SHPMT_XREF_DTL'                            34490099
171410                               TO DP013-DB2-TABLE-NAME (1)        34500099
171410             MOVE 'TPURITM'    TO DP013-DB2-TABLE-NAME (2)        34510099
171410             MOVE 'XLT_SKU'    TO DP013-DB2-TABLE-NAME (3)        34520099
171410             SET DP013-DB2-ABEND                                  34530099
171410                 DP013-XCTL-DISPLAY-RESTART TO TRUE               34540099
171410             PERFORM DP013-0000-PROCESS-ABEND                     34550099
171410     END-EVALUATE.                                                34560099
171410                                                                  34570099
171410****************************************************************  34580099
171410 4027-CLOSE-CURSOR.                                               34590099
171410                                                                  34600099
171410     IF PS-CICS-SWITCH-YES                                        34610099
171410         INITIALIZE PV-CICS-MSG-AREA                              34620099
171410         STRING ' ' PV-SRC-TASK-NUMBER                            34630099
171410                ' WSKCS316-4027 CLOSE CURSOR'                     34640099
171410                DELIMITED BY SIZE                                 34650099
171410                          INTO PV-CICS-MSG-AREA                   34660099
171410         PERFORM 7000-WRITE-TO-CICS-LOG                           34670099
171410     END-IF.                                                      34680099
171410                                                                  34690099
171410     EXEC SQL                                                     34700099
171410         CLOSE  WMS-SKUASN-CSR                                    34710099
171410     END-EXEC.                                                    34720099
171410                                                                  34730099
171410     EVALUATE TRUE                                                34740099
171410         WHEN SQLCODE = ZERO                                      34750099
171410         WHEN SQLCODE = +100                                      34760099
171410             CONTINUE                                             34770099
171410                                                                  34780099
171410         WHEN SQLWARN0 NOT = SPACES                               34790099
171410         WHEN SQLCODE < ZERO                                      34800099
171410         WHEN SQLCODE > ZERO                                      34810099
171410             INITIALIZE PV-CICS-MSG-AREA                          34820099
171410             MOVE SQLCODE TO PV-DISPLAY                           34830099
171410             STRING ' ' PV-SRC-TASK-NUMBER                        34840099
171410                    ' WSKCS316-4027'                              34850099
171410                    ' SQL=' PV-DISPLAY                            34860099
171410                    DELIMITED BY SIZE                             34870099
171410                          INTO PV-CICS-MSG-AREA                   34880099
171410             PERFORM 7000-WRITE-TO-CICS-LOG                       34890099
171410                                                                  34900099
171410             MOVE '4027-CLOSE-CURSOR' TO DP013-PARAGRAPH          34910099
171410             MOVE 'CLOSE CURSOR PROBLEM   '                       34920099
171410                               TO DP013-MESSAGE-TEXT (1)          34930099
171410             MOVE SQLCA        TO DP013-SQLCA                     34940099
171410             MOVE 'WST_SHPMT_XREF_DTL'                            34950099
171410                               TO DP013-DB2-TABLE-NAME (1)        34960099
171410             MOVE 'TPURITM'    TO DP013-DB2-TABLE-NAME (2)        34970099
171410             MOVE 'XLT_SKU'    TO DP013-DB2-TABLE-NAME (3)        34980099
171410             SET DP013-DB2-ABEND                                  34990099
171410                 DP013-XCTL-DISPLAY-RESTART TO TRUE               35000099
171410             PERFORM DP013-0000-PROCESS-ABEND                     35010099
171410     END-EVALUATE.                                                35020099
171410                                                                  35030099
528174*----------------------------------------------------------------*35040000
528175*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *35050000
528176*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *35060000
528177*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *35070000
528178*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *35080000
528179*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *35090000
528180*                                                                *35100000
528181*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *35110000
528182*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *35120000
528183*    UPON INITIALIZATION.                                        *35130000
528184*----------------------------------------------------------------*35140000
528185                                                                  35150000
528186 4300-READ-ITEMS-FROM-DB.                                         35160000
528187                                                                  35170000
528188     IF PS-CICS-SWITCH-YES                                        35180000
528189         INITIALIZE PV-CICS-MSG-AREA                              35190000
528190         STRING ' ' PV-SRC-TASK-NUMBER                            35200000
528200                ' WSKCS316-4300'                                  35210000
528300                DELIMITED BY SIZE                                 35220000
528400                          INTO PV-CICS-MSG-AREA                   35230000
528500         PERFORM 7000-WRITE-TO-CICS-LOG                           35240000
528501     END-IF.                                                      35250000
528502*                                                                 35260000
171410     EVALUATE TRUE                                                35270099
171410        WHEN ASC-WMS-SHIP-CURSOR                                  35280099
171410          IF ASC-PO-SEQ                                           35290099
528503             PERFORM 4310-PROCESS-DATA                            35300099
528504               UNTIL PS-EOF-WMS-CSR-YES                           35310099
171410          ELSE                                                    35320099
171410             PERFORM 4311-PROCESS-DATA                            35330099
171410               UNTIL PS-EOF-WMS-CSR-YES                           35340099
171410          END-IF                                                  35350099
171410        WHEN ASC-PO-CURSOR                                        35360099
171410          IF ASC-PO-SEQ                                           35370099
171410             PERFORM 4312-PROCESS-DATA                            35380099
171410               UNTIL PS-EOF-WMS-CSR-YES                           35390099
171410          ELSE                                                    35400099
171410             PERFORM 4313-PROCESS-DATA                            35410099
171410               UNTIL PS-EOF-WMS-CSR-YES                           35420099
171410          END-IF                                                  35430099
171410        WHEN ASC-PO-SKU-CURSOR                                    35440099
171410          IF ASC-PO-SEQ                                           35450099
171410             PERFORM 4314-PROCESS-DATA                            35460099
171410               UNTIL PS-EOF-WMS-CSR-YES                           35470099
171410          ELSE                                                    35480099
171410             PERFORM 4315-PROCESS-DATA                            35490099
171410               UNTIL PS-EOF-WMS-CSR-YES                           35500099
171410          END-IF                                                  35510099
171410        WHEN ASC-SKU-CURSOR                                       35520099
171410          IF ASC-PO-SEQ                                           35530099
171410             PERFORM 4316-PROCESS-DATA                            35540099
171410               UNTIL PS-EOF-WMS-CSR-YES                           35550099
171410          ELSE                                                    35560099
171410             PERFORM 4317-PROCESS-DATA                            35570099
171410               UNTIL PS-EOF-WMS-CSR-YES                           35580099
171410          END-IF                                                  35590099
171410     END-EVALUATE.                                                35600099
527991                                                                  35610099
528506     IF ASC-NUMBER-OF-ITEMS-READ > ZERO                           35620000
528507         MOVE +1               TO ASC-BLK-SUB                     35630000
528508         PERFORM 5100-WRITE-TEMP-STORAGE                          35640000
528509         ADD +1                TO ASC-BLK-SUB                     35650000
528510         PERFORM 5100-WRITE-TEMP-STORAGE                          35660000
528511                                                                  35670000
528512         MOVE 1                TO ASC-BLK-SUB                     35680000
528513                                  PV-BLOCK-NUMBER                 35690000
528514         PERFORM 4410-READ-TEMP-STORAGE                           35700000
528515         IF ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1              35710000
528516             MOVE 2            TO ASC-BLK-SUB                     35720000
528517                                  PV-BLOCK-NUMBER                 35730000
528518             PERFORM 4410-READ-TEMP-STORAGE                       35740000
528519         END-IF                                                   35750000
528520     END-IF.                                                      35760000
528521 EJECT                                                            35770000
528522                                                                  35780000
528523*----------------------------------------------------------------*35790000
528524*    FETCH DATA FROM THE CURSOR                                   35800000
528525*----------------------------------------------------------------*35810000
528526 4310-PROCESS-DATA.                                               35820000
528527*                                                                 35830000
528528     EXEC SQL                                                     35840000
528529          FETCH   WMS-SHIP-CSR                                    35850000
528530           INTO  :WST00002-PO-NBR                                 35860000
528531              ,  :WST00002-RCVR-SEQ-NBR                           35870000
528532              ,  :WST00002-PO-LNE-NBR                             35880000
528533              ,  :WST00002-PREPK-ID                               35890000
528534              ,  :WST00002-ASN-LVL-CDE                            35900000
528535              ,  :WST00002-DWNLD-CDE                              35910000
528536              ,  :WST00002-CRE-TMST                               35920000
528537              ,  :WST00002-CRE-USR-ID                             35930000
171410              ,  :XLT00003-SKU-NBR                                35940099
528538     END-EXEC.                                                    35950000
535000                                                                  35960000
535100     EVALUATE TRUE                                                35970000
535200         WHEN SQLCODE = ZERO                                      35980000
535300              IF PS-CICS-SWITCH-YES                               35990000
535400                  INITIALIZE PV-CICS-MSG-AREA                     36000000
535500                  MOVE WST00002-PO-NBR       TO PV-DISPLAY-1      36010000
535600                  MOVE WST00002-RCVR-SEQ-NBR TO PV-DISPLAY-2      36020000
535700                  MOVE WST00002-PO-LNE-NBR   TO PV-DISPLAY-3      36030000
535800                  STRING ' ' PV-SRC-TASK-NUMBER                   36040000
535900                         ' WSKCS316-4310'                         36050000
536000                         ' PO='   PV-DISPLAY-1                    36060099
536100                         '-'      PV-DISPLAY-2                    36070099
536200                         ' LINE=' PV-DISPLAY-3                    36080000
536300                       DELIMITED BY SIZE                          36090000
536400                                INTO PV-CICS-MSG-AREA             36100000
536500                  PERFORM 7000-WRITE-TO-CICS-LOG                  36110000
536501              END-IF                                              36120000
171410**            PERFORM 4330-GET-SKU-NBR                            36130099
536300**AMIT**21/07/2013**INITIAL                                       36140000
536400              PERFORM 4370-GET-CARTON-COUNT                       36150000
536500**AMIT**21/07/2013**FINAL                                         36160000
536501              PERFORM 4320-PROCESS-DATA                           36170000
536504         WHEN SQLCODE = +100                                      36180000
536505              SET PS-EOF-WMS-CSR-YES TO TRUE                      36190000
536506         WHEN SQLWARN0 NOT = SPACE                                36200000
536507         WHEN SQLCODE NOT = ZERO                                  36210000
536508             INITIALIZE PV-CICS-MSG-AREA                          36220000
536509             MOVE SQLCODE TO PV-DISPLAY                           36230000
536510             STRING ' ' PV-SRC-TASK-NUMBER                        36240000
536520                    ' WSKCS316-4310'                              36250000
536530                    ' SQL=' PV-DISPLAY                            36260000
536540                    DELIMITED BY SIZE                             36270000
536550                          INTO PV-CICS-MSG-AREA                   36280000
536551             PERFORM 7000-WRITE-TO-CICS-LOG                       36290000
536552*                                                                 36300000
536553              MOVE '4310-PROCESS-DATA'                            36310000
536554                               TO DP013-PARAGRAPH                 36320000
536555              MOVE 'FETCH MESSAGE CURSOR'                         36330000
536556                               TO DP013-MESSAGE-TEXT (1)          36340000
536557              MOVE SQLCA       TO DP013-SQLCA                     36350000
536558              SET DP013-DB2-ABEND                                 36360000
536559                               TO TRUE                            36370000
536560              PERFORM DP013-0000-PROCESS-ABEND                    36380000
536570     END-EVALUATE.                                                36390000
536570                                                                  36400099
171410*----------------------------------------------------------------*36410099
171410*    FETCH DATA FROM THE CURSOR                                   36420099
171410*----------------------------------------------------------------*36430099
171410 4311-PROCESS-DATA.                                               36440099
171410                                                                  36450099
171410     EXEC SQL                                                     36460099
171410          FETCH   WMS-ASNLEVEL-CSR                                36470099
171410           INTO  :WST00002-PO-NBR                                 36480099
171410              ,  :WST00002-RCVR-SEQ-NBR                           36490099
171410              ,  :WST00002-PO-LNE-NBR                             36500099
171410              ,  :WST00002-PREPK-ID                               36510099
171410              ,  :WST00002-ASN-LVL-CDE                            36520099
171410              ,  :WST00002-DWNLD-CDE                              36530099
171410              ,  :WST00002-CRE-TMST                               36540099
171410              ,  :WST00002-CRE-USR-ID                             36550099
171410              ,  :XLT00003-SKU-NBR                                36560099
171410     END-EXEC.                                                    36570099
171410                                                                  36580099
171410     EVALUATE TRUE                                                36590099
171410         WHEN SQLCODE = ZERO                                      36600099
171410              IF PS-CICS-SWITCH-YES                               36610099
171410                  INITIALIZE PV-CICS-MSG-AREA                     36620099
171410                  MOVE WST00002-PO-NBR       TO PV-DISPLAY-1      36630099
171410                  MOVE WST00002-RCVR-SEQ-NBR TO PV-DISPLAY-2      36640099
171410                  MOVE WST00002-PO-LNE-NBR   TO PV-DISPLAY-3      36650099
171410                  STRING ' ' PV-SRC-TASK-NUMBER                   36660099
171410                         ' WSKCS316-4311'                         36670099
171410                         ' PO='   PV-DISPLAY-1                    36680099
171410                         '-'      PV-DISPLAY-2                    36690099
171410                         ' LINE=' PV-DISPLAY-3                    36700099
171410                       DELIMITED BY SIZE                          36710099
171410                                INTO PV-CICS-MSG-AREA             36720099
171410                  PERFORM 7000-WRITE-TO-CICS-LOG                  36730099
171410              END-IF                                              36740099
171410              PERFORM 4370-GET-CARTON-COUNT                       36750099
171410              PERFORM 4320-PROCESS-DATA                           36760099
171410                                                                  36770099
171410         WHEN SQLCODE = +100                                      36780099
171410              SET PS-EOF-WMS-CSR-YES TO TRUE                      36790099
171410                                                                  36800099
171410         WHEN SQLWARN0 NOT = SPACE                                36810099
171410         WHEN SQLCODE NOT = ZERO                                  36820099
171410             INITIALIZE PV-CICS-MSG-AREA                          36830099
171410             MOVE SQLCODE TO PV-DISPLAY                           36840099
171410             STRING ' ' PV-SRC-TASK-NUMBER                        36850099
171410                    ' WSKCS316-4311'                              36860099
171410                    ' SQL=' PV-DISPLAY                            36870099
171410                    DELIMITED BY SIZE                             36880099
171410                          INTO PV-CICS-MSG-AREA                   36890099
171410              PERFORM 7000-WRITE-TO-CICS-LOG                      36900099
171410              MOVE '4311-PROCESS-DATA'                            36910099
171410                               TO DP013-PARAGRAPH                 36920099
171410              MOVE 'FETCH MESSAGE CURSOR'                         36930099
171410                               TO DP013-MESSAGE-TEXT (1)          36940099
171410              MOVE SQLCA       TO DP013-SQLCA                     36950099
171410              SET DP013-DB2-ABEND                                 36960099
171410                               TO TRUE                            36970099
171410              PERFORM DP013-0000-PROCESS-ABEND                    36980099
171410     END-EVALUATE.                                                36990099
171410                                                                  37000099
171410*----------------------------------------------------------------*37010099
171410*    FETCH DATA FROM THE CURSOR                                   37020099
171410*----------------------------------------------------------------*37030099
171410 4312-PROCESS-DATA.                                               37040099
171410                                                                  37050099
171410     EXEC SQL                                                     37060099
171410          FETCH   WMS-PO-CSR                                      37070099
171410           INTO  :WST00002-PO-NBR                                 37080099
171410              ,  :WST00002-RCVR-SEQ-NBR                           37090099
171410              ,  :WST00002-PO-LNE-NBR                             37100099
171410              ,  :WST00002-PREPK-ID                               37110099
171410              ,  :WST00002-ASN-LVL-CDE                            37120099
171410              ,  :WST00002-DWNLD-CDE                              37130099
171410              ,  :WST00002-CRE-TMST                               37140099
171410              ,  :WST00002-CRE-USR-ID                             37150099
171410              ,  :XLT00003-SKU-NBR                                37160099
171410     END-EXEC.                                                    37170099
171410                                                                  37180099
171410     EVALUATE TRUE                                                37190099
171410         WHEN SQLCODE = ZERO                                      37200099
171410              IF PS-CICS-SWITCH-YES                               37210099
171410                  INITIALIZE PV-CICS-MSG-AREA                     37220099
171410                  MOVE WST00002-PO-NBR       TO PV-DISPLAY-1      37230099
171410                  MOVE WST00002-RCVR-SEQ-NBR TO PV-DISPLAY-2      37240099
171410                  MOVE WST00002-PO-LNE-NBR   TO PV-DISPLAY-3      37250099
171410                  STRING ' ' PV-SRC-TASK-NUMBER                   37260099
171410                         ' WSKCS316-4312'                         37270099
171410                         ' PO='   PV-DISPLAY-1                    37280099
171410                         '-'      PV-DISPLAY-2                    37290099
171410                         ' LINE=' PV-DISPLAY-3                    37300099
171410                       DELIMITED BY SIZE                          37310099
171410                                INTO PV-CICS-MSG-AREA             37320099
171410                  PERFORM 7000-WRITE-TO-CICS-LOG                  37330099
171410              END-IF                                              37340099
171410              PERFORM 4370-GET-CARTON-COUNT                       37350099
171410              PERFORM 4320-PROCESS-DATA                           37360099
171410                                                                  37370099
171410         WHEN SQLCODE = +100                                      37380099
171410              SET PS-EOF-WMS-CSR-YES TO TRUE                      37390099
171410                                                                  37400099
171410         WHEN SQLWARN0 NOT = SPACE                                37410099
171410         WHEN SQLCODE NOT = ZERO                                  37420099
171410             INITIALIZE PV-CICS-MSG-AREA                          37430099
171410             MOVE SQLCODE TO PV-DISPLAY                           37440099
171410             STRING ' ' PV-SRC-TASK-NUMBER                        37450099
171410                    ' WSKCS316-4312'                              37460099
171410                    ' SQL=' PV-DISPLAY                            37470099
171410                    DELIMITED BY SIZE                             37480099
171410                          INTO PV-CICS-MSG-AREA                   37490099
171410              PERFORM 7000-WRITE-TO-CICS-LOG                      37500099
171410                                                                  37510099
171410              MOVE '4312-PROCESS-DATA'                            37520099
171410                               TO DP013-PARAGRAPH                 37530099
171410              MOVE 'FETCH MESSAGE CURSOR'                         37540099
171410                               TO DP013-MESSAGE-TEXT (1)          37550099
171410              MOVE SQLCA       TO DP013-SQLCA                     37560099
171410              SET DP013-DB2-ABEND                                 37570099
171410                               TO TRUE                            37580099
171410              PERFORM DP013-0000-PROCESS-ABEND                    37590099
171410     END-EVALUATE.                                                37600099
171410                                                                  37610099
171410*----------------------------------------------------------------*37620099
171410*    FETCH DATA FROM THE CURSOR                                   37630099
171410*----------------------------------------------------------------*37640099
171410 4313-PROCESS-DATA.                                               37650099
171410                                                                  37660099
171410     EXEC SQL                                                     37670099
171410          FETCH   WMS-POASN-CSR                                   37680099
171410           INTO  :WST00002-PO-NBR                                 37690099
171410              ,  :WST00002-RCVR-SEQ-NBR                           37700099
171410              ,  :WST00002-PO-LNE-NBR                             37710099
171410              ,  :WST00002-PREPK-ID                               37720099
171410              ,  :WST00002-ASN-LVL-CDE                            37730099
171410              ,  :WST00002-DWNLD-CDE                              37740099
171410              ,  :WST00002-CRE-TMST                               37750099
171410              ,  :WST00002-CRE-USR-ID                             37760099
171410              ,  :XLT00003-SKU-NBR                                37770099
171410     END-EXEC.                                                    37780099
171410                                                                  37790099
171410     EVALUATE TRUE                                                37800099
171410         WHEN SQLCODE = ZERO                                      37810099
171410              IF PS-CICS-SWITCH-YES                               37820099
171410                  INITIALIZE PV-CICS-MSG-AREA                     37830099
171410                  MOVE WST00002-PO-NBR       TO PV-DISPLAY-1      37840099
171410                  MOVE WST00002-RCVR-SEQ-NBR TO PV-DISPLAY-2      37850099
171410                  MOVE WST00002-PO-LNE-NBR   TO PV-DISPLAY-3      37860099
171410                  STRING ' ' PV-SRC-TASK-NUMBER                   37870099
171410                         ' WSKCS316-4313'                         37880099
171410                         ' PO='   PV-DISPLAY-1                    37890099
171410                         '-'      PV-DISPLAY-2                    37900099
171410                         ' LINE=' PV-DISPLAY-3                    37910099
171410                       DELIMITED BY SIZE                          37920099
171410                                INTO PV-CICS-MSG-AREA             37930099
171410                  PERFORM 7000-WRITE-TO-CICS-LOG                  37940099
171410              END-IF                                              37950099
171410              PERFORM 4370-GET-CARTON-COUNT                       37960099
171410              PERFORM 4320-PROCESS-DATA                           37970099
171410                                                                  37980099
171410         WHEN SQLCODE = +100                                      37990099
171410              SET PS-EOF-WMS-CSR-YES TO TRUE                      38000099
171410                                                                  38010099
171410         WHEN SQLWARN0 NOT = SPACE                                38020099
171410         WHEN SQLCODE NOT = ZERO                                  38030099
171410             INITIALIZE PV-CICS-MSG-AREA                          38040099
171410             MOVE SQLCODE TO PV-DISPLAY                           38050099
171410             STRING ' ' PV-SRC-TASK-NUMBER                        38060099
171410                    ' WSKCS316-4313'                              38070099
171410                    ' SQL=' PV-DISPLAY                            38080099
171410                    DELIMITED BY SIZE                             38090099
171410                          INTO PV-CICS-MSG-AREA                   38100099
171410              PERFORM 7000-WRITE-TO-CICS-LOG                      38110099
171410              MOVE '4313-PROCESS-DATA'                            38120099
171410                               TO DP013-PARAGRAPH                 38130099
171410              MOVE 'FETCH MESSAGE CURSOR'                         38140099
171410                               TO DP013-MESSAGE-TEXT (1)          38150099
171410              MOVE SQLCA       TO DP013-SQLCA                     38160099
171410              SET DP013-DB2-ABEND                                 38170099
171410                               TO TRUE                            38180099
171410              PERFORM DP013-0000-PROCESS-ABEND                    38190099
171410     END-EVALUATE.                                                38200099
171410                                                                  38210099
171410*----------------------------------------------------------------*38220099
171410*    FETCH DATA FROM THE CURSOR                                   38230099
171410*----------------------------------------------------------------*38240099
171410 4314-PROCESS-DATA.                                               38250099
171410                                                                  38260099
171410     EXEC SQL                                                     38270099
171410          FETCH   WMS-POSKU-CSR                                   38280099
171410           INTO  :WST00002-PO-NBR                                 38290099
171410              ,  :WST00002-RCVR-SEQ-NBR                           38300099
171410              ,  :WST00002-PO-LNE-NBR                             38310099
171410              ,  :WST00002-PREPK-ID                               38320099
171410              ,  :WST00002-ASN-LVL-CDE                            38330099
171410              ,  :WST00002-DWNLD-CDE                              38340099
171410              ,  :WST00002-CRE-TMST                               38350099
171410              ,  :WST00002-CRE-USR-ID                             38360099
171410              ,  :XLT00003-SKU-NBR                                38370099
171410     END-EXEC.                                                    38380099
171410                                                                  38390099
171410     EVALUATE TRUE                                                38400099
171410         WHEN SQLCODE = ZERO                                      38410099
171410              IF PS-CICS-SWITCH-YES                               38420099
171410                  INITIALIZE PV-CICS-MSG-AREA                     38430099
171410                  MOVE WST00002-PO-NBR       TO PV-DISPLAY-1      38440099
171410                  MOVE WST00002-RCVR-SEQ-NBR TO PV-DISPLAY-2      38450099
171410                  MOVE WST00002-PO-LNE-NBR   TO PV-DISPLAY-3      38460099
171410                  MOVE XLT00003-SKU-NBR      TO PV-DISPLAY-4      38470099
171410                  STRING ' ' PV-SRC-TASK-NUMBER                   38480099
171410                         ' WSKCS316-4314'                         38490099
171410                         ' PO='   PV-DISPLAY-1                    38500099
171410                         '-'      PV-DISPLAY-2                    38510099
171410                         ' LINE=' PV-DISPLAY-3                    38520099
171410                         ' SKU='  PV-DISPLAY-4                    38530099
171410                       DELIMITED BY SIZE                          38540099
171410                                INTO PV-CICS-MSG-AREA             38550099
171410                  PERFORM 7000-WRITE-TO-CICS-LOG                  38560099
171410              END-IF                                              38570099
171410              PERFORM 4370-GET-CARTON-COUNT                       38580099
171410              PERFORM 4320-PROCESS-DATA                           38590099
171410                                                                  38600099
171410         WHEN SQLCODE = +100                                      38610099
171410              SET PS-EOF-WMS-CSR-YES TO TRUE                      38620099
171410                                                                  38630099
171410         WHEN SQLWARN0 NOT = SPACE                                38640099
171410         WHEN SQLCODE NOT = ZERO                                  38650099
171410             INITIALIZE PV-CICS-MSG-AREA                          38660099
171410             MOVE SQLCODE TO PV-DISPLAY                           38670099
171410             STRING ' ' PV-SRC-TASK-NUMBER                        38680099
171410                    ' WSKCS316-4314'                              38690099
171410                    ' SQL=' PV-DISPLAY                            38700099
171410                    DELIMITED BY SIZE                             38710099
171410                          INTO PV-CICS-MSG-AREA                   38720099
171410              PERFORM 7000-WRITE-TO-CICS-LOG                      38730099
171410              MOVE '4314-PROCESS-DATA'                            38740099
171410                               TO DP013-PARAGRAPH                 38750099
171410              MOVE 'FETCH MESSAGE CURSOR'                         38760099
171410                               TO DP013-MESSAGE-TEXT (1)          38770099
171410              MOVE SQLCA       TO DP013-SQLCA                     38780099
171410              SET DP013-DB2-ABEND                                 38790099
171410                               TO TRUE                            38800099
171410              PERFORM DP013-0000-PROCESS-ABEND                    38810099
171410     END-EVALUATE.                                                38820099
171410                                                                  38830099
171410*----------------------------------------------------------------*38840099
171410*    FETCH DATA FROM THE CURSOR                                   38850099
171410*----------------------------------------------------------------*38860099
171410 4315-PROCESS-DATA.                                               38870099
171410                                                                  38880099
171410     EXEC SQL                                                     38890099
171410          FETCH   WMS-POSKU-ASN-CSR                               38900099
171410           INTO  :WST00002-PO-NBR                                 38910099
171410              ,  :WST00002-RCVR-SEQ-NBR                           38920099
171410              ,  :WST00002-PO-LNE-NBR                             38930099
171410              ,  :WST00002-PREPK-ID                               38940099
171410              ,  :WST00002-ASN-LVL-CDE                            38950099
171410              ,  :WST00002-DWNLD-CDE                              38960099
171410              ,  :WST00002-CRE-TMST                               38970099
171410              ,  :WST00002-CRE-USR-ID                             38980099
171410              ,  :XLT00003-SKU-NBR                                38990099
171410     END-EXEC.                                                    39000099
171410                                                                  39010099
171410     EVALUATE TRUE                                                39020099
171410         WHEN SQLCODE = ZERO                                      39030099
171410              IF PS-CICS-SWITCH-YES                               39040099
171410                  INITIALIZE PV-CICS-MSG-AREA                     39050099
171410                  MOVE WST00002-PO-NBR       TO PV-DISPLAY-1      39060099
171410                  MOVE WST00002-RCVR-SEQ-NBR TO PV-DISPLAY-2      39070099
171410                  MOVE WST00002-PO-LNE-NBR   TO PV-DISPLAY-3      39080099
171410                  MOVE XLT00003-SKU-NBR      TO PV-DISPLAY-4      39090099
171410                  STRING ' ' PV-SRC-TASK-NUMBER                   39100099
171410                         ' WSKCS316-4315'                         39110099
171410                         ' PO='   PV-DISPLAY-1                    39120099
171410                         '-'      PV-DISPLAY-2                    39130099
171410                         ' LINE=' PV-DISPLAY-3                    39140099
171410                         ' SKU='  PV-DISPLAY-4                    39150099
171410                       DELIMITED BY SIZE                          39160099
171410                                INTO PV-CICS-MSG-AREA             39170099
171410                  PERFORM 7000-WRITE-TO-CICS-LOG                  39180099
171410              END-IF                                              39190099
171410              PERFORM 4370-GET-CARTON-COUNT                       39200099
171410              PERFORM 4320-PROCESS-DATA                           39210099
171410                                                                  39220099
171410         WHEN SQLCODE = +100                                      39230099
171410              SET PS-EOF-WMS-CSR-YES TO TRUE                      39240099
171410                                                                  39250099
171410         WHEN SQLWARN0 NOT = SPACE                                39260099
171410         WHEN SQLCODE NOT = ZERO                                  39270099
171410             INITIALIZE PV-CICS-MSG-AREA                          39280099
171410             MOVE SQLCODE TO PV-DISPLAY                           39290099
171410             STRING ' ' PV-SRC-TASK-NUMBER                        39300099
171410                    ' WSKCS316-4315'                              39310099
171410                    ' SQL=' PV-DISPLAY                            39320099
171410                    DELIMITED BY SIZE                             39330099
171410                          INTO PV-CICS-MSG-AREA                   39340099
171410              PERFORM 7000-WRITE-TO-CICS-LOG                      39350099
171410              MOVE '4315-PROCESS-DATA'                            39360099
171410                               TO DP013-PARAGRAPH                 39370099
171410              MOVE 'FETCH MESSAGE CURSOR'                         39380099
171410                               TO DP013-MESSAGE-TEXT (1)          39390099
171410              MOVE SQLCA       TO DP013-SQLCA                     39400099
171410              SET DP013-DB2-ABEND                                 39410099
171410                               TO TRUE                            39420099
171410              PERFORM DP013-0000-PROCESS-ABEND                    39430099
171410     END-EVALUATE.                                                39440099
171410                                                                  39450099
171410*----------------------------------------------------------------*39460099
171410*    FETCH DATA FROM THE CURSOR                                   39470099
171410*----------------------------------------------------------------*39480099
171410 4316-PROCESS-DATA.                                               39490099
171410                                                                  39500099
171410     EXEC SQL                                                     39510099
171410          FETCH   WMS-SKU-CSR                                     39520099
171410           INTO  :WST00002-PO-NBR                                 39530099
171410              ,  :WST00002-RCVR-SEQ-NBR                           39540099
171410              ,  :WST00002-PO-LNE-NBR                             39550099
171410              ,  :WST00002-PREPK-ID                               39560099
171410              ,  :WST00002-ASN-LVL-CDE                            39570099
171410              ,  :WST00002-DWNLD-CDE                              39580099
171410              ,  :WST00002-CRE-TMST                               39590099
171410              ,  :WST00002-CRE-USR-ID                             39600099
171410              ,  :XLT00003-SKU-NBR                                39610099
171410     END-EXEC.                                                    39620099
171410                                                                  39630099
171410     EVALUATE TRUE                                                39640099
171410         WHEN SQLCODE = ZERO                                      39650099
171410              IF PS-CICS-SWITCH-YES                               39660099
171410                  INITIALIZE PV-CICS-MSG-AREA                     39670099
171410                  MOVE WST00002-PO-NBR       TO PV-DISPLAY-1      39680099
171410                  MOVE WST00002-RCVR-SEQ-NBR TO PV-DISPLAY-2      39690099
171410                  MOVE WST00002-PO-LNE-NBR   TO PV-DISPLAY-3      39700099
171410                  MOVE XLT00003-SKU-NBR      TO PV-DISPLAY-4      39710099
171410                  STRING ' ' PV-SRC-TASK-NUMBER                   39720099
171410                         ' WSKCS316-4316'                         39730099
171410                         ' PO='   PV-DISPLAY-1                    39740099
171410                         '-'      PV-DISPLAY-2                    39750099
171410                         ' LINE=' PV-DISPLAY-3                    39760099
171410                         ' SKU='  PV-DISPLAY-4                    39770099
171410                       DELIMITED BY SIZE                          39780099
171410                                INTO PV-CICS-MSG-AREA             39790099
171410                  PERFORM 7000-WRITE-TO-CICS-LOG                  39800099
171410              END-IF                                              39810099
171410              PERFORM 4370-GET-CARTON-COUNT                       39820099
171410              PERFORM 4320-PROCESS-DATA                           39830099
171410                                                                  39840099
171410         WHEN SQLCODE = +100                                      39850099
171410              SET PS-EOF-WMS-CSR-YES TO TRUE                      39860099
171410                                                                  39870099
171410         WHEN SQLWARN0 NOT = SPACE                                39880099
171410         WHEN SQLCODE NOT = ZERO                                  39890099
171410             INITIALIZE PV-CICS-MSG-AREA                          39900099
171410             MOVE SQLCODE TO PV-DISPLAY                           39910099
171410             STRING ' ' PV-SRC-TASK-NUMBER                        39920099
171410                    ' WSKCS316-4316'                              39930099
171410                    ' SQL=' PV-DISPLAY                            39940099
171410                    DELIMITED BY SIZE                             39950099
171410                          INTO PV-CICS-MSG-AREA                   39960099
171410              PERFORM 7000-WRITE-TO-CICS-LOG                      39970099
171410              MOVE '4316-PROCESS-DATA'                            39980099
171410                               TO DP013-PARAGRAPH                 39990099
171410              MOVE 'FETCH MESSAGE CURSOR'                         40000099
171410                               TO DP013-MESSAGE-TEXT (1)          40010099
171410              MOVE SQLCA       TO DP013-SQLCA                     40020099
171410              SET DP013-DB2-ABEND                                 40030099
171410                               TO TRUE                            40040099
171410              PERFORM DP013-0000-PROCESS-ABEND                    40050099
171410     END-EVALUATE.                                                40060099
171410                                                                  40070099
171410*----------------------------------------------------------------*40080099
171410*    FETCH DATA FROM THE CURSOR                                   40090099
171410*----------------------------------------------------------------*40100099
171410 4317-PROCESS-DATA.                                               40110099
171410                                                                  40120099
171410     EXEC SQL                                                     40130099
171410          FETCH   WMS-SKUASN-CSR                                  40140099
171410           INTO  :WST00002-PO-NBR                                 40150099
171410              ,  :WST00002-RCVR-SEQ-NBR                           40160099
171410              ,  :WST00002-PO-LNE-NBR                             40170099
171410              ,  :WST00002-PREPK-ID                               40180099
171410              ,  :WST00002-ASN-LVL-CDE                            40190099
171410              ,  :WST00002-DWNLD-CDE                              40200099
171410              ,  :WST00002-CRE-TMST                               40210099
171410              ,  :WST00002-CRE-USR-ID                             40220099
171410              ,  :XLT00003-SKU-NBR                                40230099
171410     END-EXEC.                                                    40240099
171410                                                                  40250099
171410     EVALUATE TRUE                                                40260099
171410         WHEN SQLCODE = ZERO                                      40270099
171410              IF PS-CICS-SWITCH-YES                               40280099
171410                  INITIALIZE PV-CICS-MSG-AREA                     40290099
171410                  MOVE WST00002-PO-NBR       TO PV-DISPLAY-1      40300099
171410                  MOVE WST00002-RCVR-SEQ-NBR TO PV-DISPLAY-2      40310099
171410                  MOVE WST00002-PO-LNE-NBR   TO PV-DISPLAY-3      40320099
171410                  MOVE XLT00003-SKU-NBR      TO PV-DISPLAY-4      40330099
171410                  STRING ' ' PV-SRC-TASK-NUMBER                   40340099
171410                         ' WSKCS316-4317'                         40350099
171410                         ' PO='   PV-DISPLAY-1                    40360099
171410                         '-'      PV-DISPLAY-2                    40370099
171410                         ' LINE=' PV-DISPLAY-3                    40380099
171410                         ' SKU='  PV-DISPLAY-4                    40390099
171410                       DELIMITED BY SIZE                          40400099
171410                                INTO PV-CICS-MSG-AREA             40410099
171410                  PERFORM 7000-WRITE-TO-CICS-LOG                  40420099
171410              END-IF                                              40430099
171410              PERFORM 4370-GET-CARTON-COUNT                       40440099
171410              PERFORM 4320-PROCESS-DATA                           40450099
171410                                                                  40460099
171410         WHEN SQLCODE = +100                                      40470099
171410              SET PS-EOF-WMS-CSR-YES TO TRUE                      40480099
171410                                                                  40490099
171410         WHEN SQLWARN0 NOT = SPACE                                40500099
171410         WHEN SQLCODE NOT = ZERO                                  40510099
171410             INITIALIZE PV-CICS-MSG-AREA                          40520099
171410             MOVE SQLCODE TO PV-DISPLAY                           40530099
171410             STRING ' ' PV-SRC-TASK-NUMBER                        40540099
171410                    ' WSKCS316-4317'                              40550099
171410                    ' SQL=' PV-DISPLAY                            40560099
171410                    DELIMITED BY SIZE                             40570099
171410                          INTO PV-CICS-MSG-AREA                   40580099
171410              PERFORM 7000-WRITE-TO-CICS-LOG                      40590099
171410              MOVE '4317-PROCESS-DATA'                            40600099
171410                               TO DP013-PARAGRAPH                 40610099
171410              MOVE 'FETCH MESSAGE CURSOR'                         40620099
171410                               TO DP013-MESSAGE-TEXT (1)          40630099
171410              MOVE SQLCA       TO DP013-SQLCA                     40640099
171410              SET DP013-DB2-ABEND                                 40650099
171410                               TO TRUE                            40660099
171410              PERFORM DP013-0000-PROCESS-ABEND                    40670099
171410     END-EVALUATE.                                                40680099
171410                                                                  40690099
536600******************************************************************40700099
536600**AMIT**21/07/2013**INITIAL                                       40710000
145600 1113-GET-RECEIVING.                                              40720099
145900                                                                  40730000
537220                                                                  40740000
146000     EXEC SQL                                                     40750000
146100          SELECT EXT_SHP_ID                                       40760099
146100            INTO :PV-EXT-SHP-ID                                   40770099
146200            FROM WST_SHPMT_XREF_HDR                               40780099
146300           WHERE INTR_TRIP_ID = :DK-TRIP-ID                       40790099
146400             AND SOR_CDE = 'RC'                                   40800099
146500             AND RCPT_TMST <> :PC-DEFAULT-NINES                   40810099
146900     END-EXEC.                                                    40820000
147000                                                                  40830000
147100     EVALUATE TRUE                                                40840000
147200         WHEN SQLCODE = ZERO                                      40850000
147200         WHEN SQLCODE = -811                                      40860099
147300              MOVE 'Y'      TO ASC-ASN-RCVNG                      40870099
147200         WHEN SQLCODE = +100                                      40880099
147300              MOVE 'N'      TO ASC-ASN-RCVNG                      40890099
147510         WHEN OTHER                                               40900099
147540              MOVE  WS010-TRIP-ID   TO  PV-DISPLAY-1              40910099
147530              MOVE  SPACES  TO DP013-MESSAGE-TEXT (2)             40920000
147540              STRING  PV-DISPLAY-1    '-'                         40930000
147550                      PV-DISPLAY-2       DELIMITED BY SIZE        40940000
147560                          INTO DP013-MESSAGE-TEXT (2)             40950000
147570                                                                  40960000
147600              MOVE '1113-GET-RECEIVING'                           40970099
147700                               TO DP013-PARAGRAPH                 40980000
147800              MOVE 'SELECT WST_SHPMT_XREF_HDR'                    40990099
147900                               TO DP013-MESSAGE-TEXT (1)          41000000
148000              MOVE SQLCA       TO DP013-SQLCA                     41010000
148100              MOVE 'WST_SHPMT_XREF_HDR'                           41020099
148100                               TO DP013-DB2-TABLE-NAME (1)        41030099
148200              SET DP013-DB2-ABEND                                 41040000
148300                               TO TRUE                            41050000
148400              PERFORM DP013-0000-PROCESS-ABEND                    41060000
148500     END-EVALUATE.                                                41070000
148100                                                                  41080000
148200                                                                  41090000
248300/                                                                 41100000
148300*----------------------------------------------------------------*41110000
148400*    CALCULATE CARTON COUNT                                      *41120000
148500*----------------------------------------------------------------*41130000
242000 4370-GET-CARTON-COUNT.                                           41140000
242100                                                                  41150000
242100              INITIALIZE PV-CARTON-COUNT                          41160099
               EXEC SQL                                                 41170099
                   SELECT COUNT(DISTINCT C.SHIPT_UNT_ID)                41180099
                          INTO :PV-CARTON-COUNT                         41190099
                     FROM TPKSLIP A                                     41200099
                         ,TINPKSU B                                     41210099
                         ,TSHUUPC C                                     41220099
                    WHERE A.PO_NBR        = :WST00002-PO-NBR            41230099
                      AND A.REC_SEQ_NBR   = :WST00002-RCVR-SEQ-NBR      41240099
                      AND A.VER_STAT_CDE  = 'A'                         41250099
                      AND A.PKSL_STAT_CDE = 'AC'                        41260099
                      AND B.PO_NBR        = A.PO_NBR                    41270099
                      AND B.SEQ_NBR       = A.SEQ_NBR                   41280099
                      AND C.SHIPT_UNT_ID  = B.SHIPT_UNT_ID              41290099
                      AND C.TRN_NBR       = A.PO_NBR                    41300099
                      AND C.TRN_LNE_NBR   = :WST00002-PO-LNE-NBR        41310099
               END-EXEC                                                 41320099
                                                                        41330099
                                                                        41340099
244300         EVALUATE TRUE                                            41350099
244400             WHEN SQLCODE = +0                                    41360099
244500             WHEN SQLCODE = +100                                  41370099
244800                   CONTINUE                                       41380099
244900                                                                  41390099
245000             WHEN SQLWARN0 NOT = SPACE                            41400099
245100             WHEN SQLCODE < +0                                    41410099
245200             WHEN SQLCODE > +0                                    41420099
245300                 MOVE '4370-GET-CARTON-COUNT'                     41430099
245400                                 TO DP013-PARAGRAPH               41440099
245500                 MOVE 'SELECT ON TRECDIS'                         41450099
245600                                 TO DP013-MESSAGE-TEXT (1)        41460099
245700                 MOVE SQLCA      TO DP013-SQLCA                   41470099
245800                 MOVE 'TRECDIS'  TO DP013-DB2-TABLE-NAME (1)      41480099
245900                 SET DP013-DB2-ABEND                              41490099
246000                                 TO TRUE                          41500099
246100                 SET DP013-XCTL-DISPLAY-RESTART                   41510099
246200                                 TO TRUE                          41520099
246300                 PERFORM DP013-0000-PROCESS-ABEND                 41530099
246400         END-EVALUATE.                                            41540099
246600                                                                  41550099
                                                                        41560099
                                                                        41570099
233600*                                                                 41580099
537000**AMIT**21/07/2013**FINAL                                         41590000
537001*----------------------------------------------------------------*41600000
537002*    PROCESS THE CURSOR DATA                                      41610000
537003*----------------------------------------------------------------*41620000
537004 4320-PROCESS-DATA.                                               41630000
537005                                                                  41640000
537006     IF ASC-ITEMS-LEFT-ON-DB                                      41650000
537007         IF ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                     41660000
537008             ADD +1            TO ASC-ITEM-SUB                    41670000
537009         ELSE                                                     41680000
537010             ADD +1            TO ASC-BLK-SUB                     41690000
537011             MOVE +1           TO ASC-ITEM-SUB                    41700000
537012                                                                  41710000
537013             IF ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY              41720000
537014                 MOVE +1       TO ASC-BLK-SUB                     41730000
537015                 SET ASC-BLOCK-MODIFIED (1)                       41740000
537016                                   TO TRUE                        41750000
537017                 PERFORM 5100-WRITE-TEMP-STORAGE                  41760000
537018                 MOVE ASC-BLOCK-ENTRIES                           41770000
537019                               (PC-MAX-BLOCKS-IN-ARRAY)           41780000
537020                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 41790000
537021                 ADD +1        TO ASC-BLK-SUB                     41800000
537022                 INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)       41810000
537023                 SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)          41820000
537024                                   TO TRUE                        41830000
537025             END-IF                                               41840000
537026         END-IF                                                   41850000
537027                                                                  41860000
537028         ADD +1                     TO ASC-NUMBER-OF-ITEMS-READ   41870000
537029         MOVE ASC-NUMBER-OF-ITEMS-READ                            41880000
537030                                    TO ASC-LIST-ITEM-NUMBER       41890000
537031                                       (ASC-BLK-SUB ASC-ITEM-SUB) 41900000
537032         MOVE WST00002-PO-NBR       TO ASC-SCREEN-PO-NBR          41910000
537033                                       (ASC-BLK-SUB ASC-ITEM-SUB) 41920000
537034         MOVE WST00002-RCVR-SEQ-NBR TO ASC-SCREEN-RCVR-NBR        41930000
537035                                       (ASC-BLK-SUB ASC-ITEM-SUB) 41940000
537036         MOVE WST00002-PO-LNE-NBR   TO ASC-SCREEN-PO-LNE-NBR      41950000
537037                                       (ASC-BLK-SUB ASC-ITEM-SUB) 41960000
537038         MOVE WST00002-PREPK-ID     TO ASC-SCREEN-PREPK           41970000
537039                                       (ASC-BLK-SUB ASC-ITEM-SUB) 41980000
537040         MOVE WST00002-ASN-LVL-CDE  TO ASC-SCREEN-ASN-LVL         41990000
537041                                       (ASC-BLK-SUB ASC-ITEM-SUB) 42000000
537042         EVALUATE WST00002-DWNLD-CDE                              42010000
537043             WHEN 'N'                                             42020000
537044                 MOVE 'NDWD'        TO ASC-SCREEN-DNLD-IND        42030000
537045                                       (ASC-BLK-SUB ASC-ITEM-SUB) 42040000
537046             WHEN 'D'                                             42050000
537047                 MOVE 'DWLD'        TO ASC-SCREEN-DNLD-IND        42060000
537048                                       (ASC-BLK-SUB ASC-ITEM-SUB) 42070000
537049             WHEN 'T'                                             42080000
537050                 MOVE 'TRBL'        TO ASC-SCREEN-DNLD-IND        42090000
537051                                       (ASC-BLK-SUB ASC-ITEM-SUB) 42100000
537052             WHEN OTHER                                           42110000
537053                 MOVE '    '        TO ASC-SCREEN-DNLD-IND        42120000
537054                                       (ASC-BLK-SUB ASC-ITEM-SUB) 42130000
537055         END-EVALUATE                                             42140000
537056*        MM/YY FORMAT                                             42150000
537057         IF WST00002-CRE-TMST = PC-DEFAULT-NINES                  42160000
537058             MOVE SPACES          TO ASC-SCREEN-CRE-DTE           42170000
537059                                  (ASC-BLK-SUB ASC-ITEM-SUB)      42180000
537060             MOVE SPACES          TO ASC-SCREEN-CRE-TME           42190000
537061                                  (ASC-BLK-SUB ASC-ITEM-SUB)      42200000
537062         ELSE                                                     42210000
537063             STRING WST00002-CRE-TMST(6:2)                        42220000
537064                    '/'                                           42230000
537065                    WST00002-CRE-TMST(9:2)                        42240000
537066                    DELIMITED BY SIZE                             42250000
537067                                INTO ASC-SCREEN-CRE-DTE           42260000
537068                                  (ASC-BLK-SUB ASC-ITEM-SUB)      42270000
537069             STRING WST00002-CRE-TMST(12:2)                       42280000
537070                    ':'                                           42290000
537080                    WST00002-CRE-TMST(15:2)                       42300000
537081                    DELIMITED BY SIZE                             42310000
537082                                INTO ASC-SCREEN-CRE-TME           42320000
537083                                   (ASC-BLK-SUB ASC-ITEM-SUB)     42330000
537084         END-IF                                                   42340000
537085         MOVE WST00002-CRE-USR-ID TO ASC-SCREEN-CRE-BY            42350000
537086                                   (ASC-BLK-SUB ASC-ITEM-SUB)     42360000
537087         MOVE XLT00003-SKU-NBR      TO ASC-SCREEN-SKU-NBR         42370000
537088                                       (ASC-BLK-SUB ASC-ITEM-SUB) 42380000
537000**AMIT**21/07/2013**INITIAL                                       42390000
537087         MOVE PV-CARTON-COUNT       TO ASC-SCREEN-CARTON-COUNT    42400000
537088                                       (ASC-BLK-SUB ASC-ITEM-SUB) 42410000
537000**AMIT**21/07/2013**FINAL                                         42420000
537089                                                                  42430000
537090         IF PS-CICS-SWITCH-YES                                    42440000
537100             INITIALIZE PV-CICS-MSG-AREA                          42450000
537200             STRING ' ' PV-SRC-TASK-NUMBER                        42460000
537201                    ' WSKCS316-4320'                              42470000
537202                    ' PO=' ASC-SCREEN-PO-NBR                      42480000
537203                                   (ASC-BLK-SUB ASC-ITEM-SUB)     42490000
537204                    ' RCVR=' ASC-SCREEN-RCVR-NBR                  42500000
537205                                   (ASC-BLK-SUB ASC-ITEM-SUB)     42510000
537206                    ' LINE=' ASC-SCREEN-PO-LNE-NBR                42520000
537207                                  (ASC-BLK-SUB ASC-ITEM-SUB)      42530000
537208                    DELIMITED BY SIZE                             42540000
537209                              INTO PV-CICS-MSG-AREA               42550000
537210             PERFORM 7000-WRITE-TO-CICS-LOG                       42560000
537211         END-IF                                                   42570000
537212     END-IF.                                                      42580000
537213                                                                  42590000
537214*----------------------------------------------------------------*42600000
537215*    GET SKU NBR                                                  42610000
537216*----------------------------------------------------------------*42620000
537217 4330-GET-SKU-NBR.                                                42630000
537218                                                                  42640000
537219     MOVE WST00002-PO-NBR         TO DK-PO-NBR.                   42650000
537220     MOVE WST00002-PO-LNE-NBR     TO DK-PO-LNE-NBR.               42660000
537221                                                                  42670000
537222     EXEC SQL                                                     42680000
537223          SELECT B.SKU_NBR                                        42690000
537224           INTO  :XLT00003-SKU-NBR                                42700000
537225           FROM  TPURITM A                                        42710000
537226               , XLT_SKU B                                        42720000
537227          WHERE  A.PO_NBR         = :DK-PO-NBR                    42730000
537228            AND  A.APP_PO_LNE_NBR = :DK-PO-LNE-NBR                42740000
537229            AND  A.ITM_NBR        = B.ITM_NBR                     42750000
537230            AND  A.VER_STATUS_CDE = 'A'                           42760000
537231     END-EXEC.                                                    42770000
537232                                                                  42780000
537233     EVALUATE TRUE                                                42790000
537234         WHEN SQLCODE = ZERO                                      42800000
537235         WHEN SQLCODE = -811                                      42810000
537236              IF PS-CICS-SWITCH-YES                               42820000
537237                  INITIALIZE PV-CICS-MSG-AREA                     42830000
537238                  MOVE XLT00003-SKU-NBR      TO PV-DISPLAY-1      42840000
537239                  STRING ' ' PV-SRC-TASK-NUMBER                   42850000
537240                         ' WSKCS316-4330'                         42860000
537250                         ' SKU=' PV-DISPLAY-1                     42870000
537260                       DELIMITED BY SIZE                          42880000
537270                                INTO PV-CICS-MSG-AREA             42890000
537280                  PERFORM 7000-WRITE-TO-CICS-LOG                  42900000
537281              END-IF                                              42910000
537282         WHEN SQLCODE = +100                                      42920000
537283              MOVE 0              TO XLT00003-SKU-NBR             42930000
537284         WHEN SQLWARN0 NOT = SPACE                                42940000
537285         WHEN SQLCODE NOT = ZERO                                  42950000
537286             INITIALIZE PV-CICS-MSG-AREA                          42960000
537287             MOVE SQLCODE TO PV-DISPLAY                           42970000
537288             STRING ' ' PV-SRC-TASK-NUMBER                        42980000
537289                    ' WSKCS316-4330'                              42990000
537290                    ' SQL=' PV-DISPLAY                            43000000
537300                    DELIMITED BY SIZE                             43010000
537400                          INTO PV-CICS-MSG-AREA                   43020000
537401             PERFORM 7000-WRITE-TO-CICS-LOG                       43030000
537402*                                                                 43040000
537403              MOVE '4330-GET-SKU-NBR'                             43050000
537404                               TO DP013-PARAGRAPH                 43060000
537405              MOVE 'SELECT TPURITM'                               43070000
537406                               TO DP013-MESSAGE-TEXT (1)          43080000
537407              MOVE SQLCA       TO DP013-SQLCA                     43090000
537408              SET DP013-DB2-ABEND                                 43100000
537409                               TO TRUE                            43110000
537410              PERFORM DP013-0000-PROCESS-ABEND                    43120000
537411     END-EVALUATE.                                                43130000
537412                                                                  43140000
537413*----------------------------------------------------------------*43150000
537414* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *43160000
537415*----------------------------------------------------------------*43170000
537600 4400-MOVE-COMMAREA-TO-SCREEN.                                    43180000
537700                                                                  43190000
537800     IF PS-CICS-SWITCH-YES                                        43200000
537900         INITIALIZE PV-CICS-MSG-AREA                              43210000
538000         STRING ' ' PV-SRC-TASK-NUMBER                            43220000
538100                ' WSKCS316-4400'                                  43230000
538200                DELIMITED BY SIZE                                 43240000
538300                          INTO PV-CICS-MSG-AREA                   43250000
538400         PERFORM 7000-WRITE-TO-CICS-LOG                           43260000
538401     END-IF.                                                      43270000
538402*                                                                 43280000
538403     IF (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))              43290000
538404         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          43300000
538405         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          43310000
538406             MOVE +1    TO ASC-BLK-SUB                            43320000
538407             PERFORM 5100-WRITE-TEMP-STORAGE                      43330000
538408             ADD +1     TO ASC-BLK-SUB                            43340000
538409             PERFORM 5100-WRITE-TEMP-STORAGE                      43350000
538410             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             43360000
538500                 GIVING PV-BLOCK-NUMBER                           43370000
538600                 REMAINDER PV-REMAINDER                           43380000
538700             IF PV-REMAINDER > ZERO                               43390000
538800                 ADD +1 TO PV-BLOCK-NUMBER                        43400000
538900             END-IF                                               43410000
539000             MOVE +1    TO ASC-BLK-SUB                            43420000
539100             PERFORM 4410-READ-TEMP-STORAGE                       43430000
539200             ADD +1     TO ASC-BLK-SUB                            43440000
539300                           PV-BLOCK-NUMBER                        43450000
539400             PERFORM 4410-READ-TEMP-STORAGE                       43460000
539500     END-IF.                                                      43470000
539600     MOVE +1            TO ASC-BLK-SUB.                           43480000
539700     COMPUTE ASC-ITEM-SUB =                                       43490000
539800         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              43500000
539900         + PC-ITEMS-PER-PANEL).                                   43510000
540000*                                                                 43520000
540100     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         43530000
540200         ADD +1         TO ASC-BLK-SUB                            43540000
540300         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            43550000
540400     END-IF.                                                      43560000
540500*                                                                 43570000
540600     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           43580000
540700         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                43590000
540800     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        43600000
540900     PERFORM 4420-FORMAT-LIST-LINES                               43610000
541000         VARYING PV-SUB                                           43620000
541100         FROM PC-ITEMS-PER-PANEL BY -1                            43630000
541200         UNTIL PV-SUB < +1.                                       43640000
541300*                                                                 43650000
541400     COMPUTE ASC-ITEMS-DISPLAYED =                                43660000
541500         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          43670000
541600     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    43680000
541700                                      ASTRITO.                    43690000
541800     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    43700000
541900*    MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    43710099
541900     MOVE ASC-NUMBER-OF-ITEMS-READ TO PV-NUMBER-OF-ITEMS-READ.    43720099
541900     MOVE PV-NUMBER-OF-ITEMS-READ TO ATOTITO.                     43730099
542000     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            43740000
542100                                   TO ASELITO.                    43750000
542200                                                                  43760000
542300     MOVE ASC-CARRIER                TO ACARRO.                   43770000
542400     MOVE ASC-TRAILER                TO ATRLRO.                   43780000
542401     MOVE ASC-TRIP-ID                TO ATRIPO.                   43790000
542402     MOVE ASC-KEY-SHPMT-ID           TO ASHIPO.                   43800000
      *AMIT                                                             43810099
           IF ASC-ASN-RCVNG   EQUAL  'N'                                43820099
                                                                        43830099
              MOVE SPACES                  TO ASNFLGO                   43840099
           ELSE                                                         43850099
                                                                        43860099
              MOVE PC-ASN-RCVNG            TO ASNFLGO                   43870099
           END-IF.                                                      43880099
      *AMIT                                                             43890099
542500                                                                  43900000
542600*                                                                 43910000
542700     IF DP020-MSG-NUMBER-X = SPACE                                43920000
542800         IF ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ   43930000
542900*            --- MORE ITEMS TO DISPLAY ----                       43940000
543000             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            43950000
543100             SET DP020-MSG-INFORMATIONAL TO TRUE                  43960000
543200         END-IF                                                   43970000
543300     END-IF.                                                      43980000
543400*----------------------------------------------------------------*43990000
543500*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *44000000
543600*----------------------------------------------------------------*44010000
543700                                                                  44020000
543800 4410-READ-TEMP-STORAGE.                                          44030000
543900                                                                  44040000
544000     IF PS-CICS-SWITCH-YES                                        44050000
544100         INITIALIZE PV-CICS-MSG-AREA                              44060000
544200         MOVE ASC-BLK-SUB TO PV-DISPLAY                           44070000
544300         MOVE PV-BLOCK-NUMBER TO PV-DISPLAY-1                     44080000
544400         STRING ' ' PV-SRC-TASK-NUMBER                            44090000
544500                ' WSKCS316-4410'                                  44100000
544600                ' READ QUEUE=' ASC-LIST-QUEUE-NAME                44110000
544700                ' INTO ASC-BLOCK-ENTRIES:' PV-DISPLAY             44120000
544800                ' ITEM=' PV-DISPLAY-1                             44130000
544900                DELIMITED BY SIZE                                 44140000
545000                          INTO PV-CICS-MSG-AREA                   44150000
545100         PERFORM 7000-WRITE-TO-CICS-LOG                           44160000
545101     END-IF.                                                      44170000
545102*                                                                 44180000
545103     EXEC CICS                                                    44190000
545104         READQ TS                                                 44200000
545105             QUEUE (ASC-LIST-QUEUE-NAME)                          44210000
545106             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               44220000
545107             ITEM  (PV-BLOCK-NUMBER)                              44230000
545108             RESP  (PV-CICS-RESP)                                 44240000
545109     END-EXEC.                                                    44250000
545110                                                                  44260000
545111     IF ((PV-CICS-RESP = DFHRESP (NORMAL))                        44270000
545112       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     44280000
545113         CONTINUE                                                 44290000
545114     ELSE                                                         44300000
545115         IF PS-CICS-SWITCH-YES                                    44310000
545116             INITIALIZE PV-CICS-MSG-AREA                          44320000
545117             MOVE PV-CICS-RESP TO PV-DISPLAY                      44330000
545118             STRING ' ' PV-SRC-TASK-NUMBER                        44340000
545119                    ' WSKCS316-4410'                              44350000
545120                    ' ERROR, PV-CICS-RESP=' PV-DISPLAY            44360000
545130                    DELIMITED BY SIZE                             44370000
545140                              INTO PV-CICS-MSG-AREA               44380000
545150             PERFORM 7000-WRITE-TO-CICS-LOG                       44390000
545160         END-IF                                                   44400000
545200         SET DP013-CICS-ABEND     TO TRUE                         44410000
545300         SET DP013-NO-ROLLBACK    TO TRUE                         44420000
545400         MOVE '4410-READ-TEMP-STORAGE'                            44430000
545500                                  TO DP013-PARAGRAPH              44440000
545600         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      44450000
545700                                  TO DP013-MESSAGE-TEXT(1)        44460000
545800         PERFORM DP013-0000-PROCESS-ABEND                         44470000
545900     END-IF.                                                      44480000
546000                                                                  44490000
546100     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             44500000
546200*                                                                 44510000
546300     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         44520000
546400         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               44530000
546500     END-IF.                                                      44540000
546600 EJECT                                                            44550000
546700*----------------------------------------------------------------*44560000
546800*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *44570000
546900*----------------------------------------------------------------*44580000
547100 4420-FORMAT-LIST-LINES.                                          44590000
547200                                                                  44600000
547300     IF PS-CICS-SWITCH-YES                                        44610000
547400         INITIALIZE PV-CICS-MSG-AREA                              44620000
547500         STRING ' ' PV-SRC-TASK-NUMBER                            44630000
547600                ' WSKCS316-4420'                                  44640000
547700                DELIMITED BY SIZE                                 44650000
547800                          INTO PV-CICS-MSG-AREA                   44660000
547900         PERFORM 7000-WRITE-TO-CICS-LOG                           44670000
547901     END-IF.                                                      44680000
547902*                                                                 44690000
547903     IF ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ       44700000
547904         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                44710000
547905         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA  (PV-SUB)          44720000
547906         MOVE DP015-HL-OFF       TO MR-SELECTH  (PV-SUB)          44730000
547907         MOVE SPACE              TO MR-SELECTI  (PV-SUB)          44740000
547908                                    MR-PO-NBR   (PV-SUB)          44750000
547909                                    MR-RCVR-NBR (PV-SUB)          44760000
547910                                    MR-PO-LNE   (PV-SUB)          44770000
547911                                    MR-PREPK    (PV-SUB)          44780000
547912                                    MR-ASN-LVL  (PV-SUB)          44790000
547913                                    MR-SKU-NBR  (PV-SUB)          44800000
547914                                    MR-DNLD-CDE (PV-SUB)          44810000
548000                                    MR-DNLD-DTE (PV-SUB)          44820000
548100                                    MR-DNLD-TME (PV-SUB)          44830000
548200                                    MR-CRE-DTE  (PV-SUB)          44840000
548300                                    MR-CRE-TME  (PV-SUB)          44850000
548400                                    MR-CRE-BY   (PV-SUB)          44860000
5AMIT0                                    MR-CARTON-COUNT (PV-SUB)      44870000
548600     ELSE                                                         44880000
548700         IF ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)       44890000
548800                                                   > SPACE        44900000
548900             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 44910000
549000                                 TO MR-SELECTI (PV-SUB)           44920000
549100         ELSE                                                     44930000
549200             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      44940000
549300                                 TO MR-SELECTI (PV-SUB)           44950000
549400         END-IF                                                   44960000
549500*                                                                 44970000
549600         IF DP030-SET-CURSOR-TRAILER                              44980000
549700             IF ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 44990000
549800                 > SPACE)                                         45000000
549900               OR (PV-SUB = 1))                                   45010000
550000                SET DP030-SET-CURSOR-APPL-1 TO TRUE               45020000
550100                MOVE -1          TO MR-SELECTL (PV-SUB)           45030000
550200             END-IF                                               45040000
550300         END-IF                                                   45050000
550400*                                                                 45060000
550500         IF PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL            45070000
550600             MOVE ASC-SCREEN-PO-NBR (ASC-BLK-SUB ASC-ITEM-SUB)    45080000
550700                                         TO MR-PO-NBR (PV-SUB)    45090000
550800             MOVE ASC-SCREEN-RCVR-NBR (ASC-BLK-SUB ASC-ITEM-SUB)  45100000
550900                                         TO MR-RCVR-NBR (PV-SUB)  45110000
551000             MOVE ASC-SCREEN-PO-LNE-NBR (ASC-BLK-SUB ASC-ITEM-SUB)45120000
551100                                         TO MR-PO-LNE  (PV-SUB)   45130000
551200             MOVE ASC-SCREEN-PREPK (ASC-BLK-SUB ASC-ITEM-SUB)     45140000
551300                                         TO MR-PREPK (PV-SUB)     45150000
551400             MOVE ASC-SCREEN-ASN-LVL (ASC-BLK-SUB ASC-ITEM-SUB)   45160000
551500                                         TO MR-ASN-LVL (PV-SUB)   45170000
551600             MOVE ASC-SCREEN-SKU-NBR (ASC-BLK-SUB ASC-ITEM-SUB)   45180000
551700                                         TO MR-SKU-NBR (PV-SUB)   45190000
537000**AMIT**21/07/2013**INITIAL                                       45200000
551600             MOVE ASC-SCREEN-CARTON-COUNT                         45210000
551600                                     (ASC-BLK-SUB ASC-ITEM-SUB)   45220000
551700                                     TO MR-CARTON-COUNT(PV-SUB)   45230000
537000**AMIT**21/07/2013**FINAL                                         45240000
551800             MOVE ASC-SCREEN-DNLD-IND (ASC-BLK-SUB ASC-ITEM-SUB)  45250000
551900                                         TO MR-DNLD-CDE (PV-SUB)  45260000
552000             MOVE ASC-DWNLD-TIME         TO MR-DNLD-TME (PV-SUB)  45270000
552100             MOVE ASC-DWNLD-DATE         TO MR-DNLD-DTE (PV-SUB)  45280000
552200             MOVE ASC-SCREEN-CRE-DTE (ASC-BLK-SUB ASC-ITEM-SUB)   45290000
552300                                         TO MR-CRE-DTE (PV-SUB)   45300000
552400             MOVE ASC-SCREEN-CRE-TME (ASC-BLK-SUB ASC-ITEM-SUB)   45310000
552500                                         TO MR-CRE-TME (PV-SUB)   45320000
552600             MOVE ASC-SCREEN-CRE-BY (ASC-BLK-SUB ASC-ITEM-SUB)    45330000
552601                                         TO MR-CRE-BY (PV-SUB)    45340000
552602         END-IF                                                   45350000
552603     END-IF.                                                      45360000
552604                                                                  45370000
552700     SUBTRACT +1 FROM ASC-ITEM-SUB                                45380000
552800     IF  ASC-ITEM-SUB < + 1                                       45390000
552900         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  45400000
553000         MOVE +1                 TO ASC-BLK-SUB                   45410000
553100     END-IF.                                                      45420000
553200******************************************************************45430000
553300** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **45440000
553400** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **45450000
553500** ISSUE A WARNING.                                             **45460000
553600******************************************************************45470000
553700 4430-CHECK-FOR-BEGIN-AND-END.                                    45480000
553800*                                                                 45490000
553900     IF PS-CICS-SWITCH-YES                                        45500000
554000         INITIALIZE PV-CICS-MSG-AREA                              45510000
554100         STRING ' ' PV-SRC-TASK-NUMBER                            45520000
554200                ' WSKCS316-4430'                                  45530000
554300                DELIMITED BY SIZE                                 45540000
554400                          INTO PV-CICS-MSG-AREA                   45550000
554500         PERFORM 7000-WRITE-TO-CICS-LOG                           45560000
554501     END-IF.                                                      45570000
554502*                                                                 45580000
554503     IF ASC-START-OF-SELECTED-RANGE > ZERO                        45590000
554504         IF ASC-END-OF-SELECTED-RANGE = ZERO                      45600000
554505*            -- NO END-OF-RANGE SPECFIED ---                      45610000
554506             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            45620000
554507             SET DP020-MSG-WARNING TO TRUE                        45630000
554508             PERFORM 4431-POSITION-AT-WARNING                     45640000
554509         END-IF                                                   45650000
554510     ELSE                                                         45660000
554600         IF ASC-END-OF-SELECTED-RANGE > ZERO                      45670000
554700*            -- NO BEGINNING-OF-RANGE SPECFIED ---                45680000
554800             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            45690000
554900             SET DP020-MSG-WARNING TO TRUE                        45700000
555000             PERFORM 4431-POSITION-AT-WARNING                     45710000
555100         END-IF                                                   45720000
555200     END-IF.                                                      45730000
555300******************************************************************45740000
555400** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **45750000
555500** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **45760000
555600** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **45770000
555700** POSITION THE CURSOR THERE.                                   **45780000
555800******************************************************************45790000
555900 4431-POSITION-AT-WARNING.                                        45800000
556000*                                                                 45810000
556100     IF PS-CICS-SWITCH-YES                                        45820000
556200         INITIALIZE PV-CICS-MSG-AREA                              45830000
556300         STRING ' ' PV-SRC-TASK-NUMBER                            45840000
556400                ' WSKCS316-4431'                                  45850000
556500                DELIMITED BY SIZE                                 45860000
556600                          INTO PV-CICS-MSG-AREA                   45870000
556700         PERFORM 7000-WRITE-TO-CICS-LOG                           45880000
556701     END-IF.                                                      45890000
556702*                                                                 45900000
556703     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 45910000
556704                    - PV-TOP-ITEM + 1.                            45920000
556705     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       45930000
556706         CONTINUE                                                 45940000
556707     ELSE                                                         45950000
556708         SET DP030-SET-CURSOR-APPL-1                              45960000
556709                                   TO TRUE                        45970000
556710         MOVE -1                   TO MR-SELECTL (PV-SUB)         45980000
556800         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         45990000
556900         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         46000000
557000     END-IF.                                                      46010000
557100*                                                                 46020000
557200     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   46030000
557300                    - PV-TOP-ITEM + 1.                            46040000
557400     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       46050000
557500         CONTINUE                                                 46060000
557600     ELSE                                                         46070000
557700         SET DP030-SET-CURSOR-APPL-1                              46080000
557800                                   TO TRUE                        46090000
557900         MOVE -1                   TO MR-SELECTL (PV-SUB)         46100000
558000         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         46110000
558100         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         46120000
558200     END-IF.                                                      46130000
561900*                                                                 46140000
562000*----------------------------------------------------------------*46150000
562100*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *46160000
562200*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *46170000
562300*----------------------------------------------------------------*46180000
562500 5100-WRITE-TEMP-STORAGE.                                         46190000
562510                                                                  46200000
562600     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     46210000
562700                                   TO PV-LIST-ITEM-NUMBER.        46220000
562800     COMPUTE PV-BLOCK-NUMBER =                                    46230000
562900         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    46240000
563000                                                                  46250000
563100     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             46260000
563200     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             46270000
563300         IF ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                       46280000
563400             PERFORM 5105-REWRITE-ASC-LISTQ                       46290000
563500         END-IF                                                   46300000
563600     ELSE                                                         46310000
563700         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       46320000
563800         ASC-HIGHEST-BLOCK-WRITTEN + 1                            46330000
563900         PERFORM 5110-WRITE-ASC-LISTQ                             46340000
564000         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   46350000
564100     END-IF.                                                      46360000
564200                                                                  46370000
564300     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             46380000
564400******************************************************************46390000
564500** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **46400000
564600** SPECIFIC COMMAREA.                                           **46410000
564700******************************************************************46420000
564800 5105-REWRITE-ASC-LISTQ.                                          46430000
564900*                                                                 46440000
565000     IF PS-CICS-SWITCH-YES                                        46450000
565100         INITIALIZE PV-CICS-MSG-AREA                              46460000
565200         MOVE ASC-BLK-SUB TO PV-DISPLAY                           46470000
565300         MOVE PV-BLOCK-NUMBER TO PV-DISPLAY-1                     46480000
565400         STRING ' ' PV-SRC-TASK-NUMBER                            46490000
565500                ' WSKCS316-5105'                                  46500000
565600                ' WRITE QUEUE=' ASC-LIST-QUEUE-NAME               46510000
565700                ' FROM ASC-BLOCK-ENTRIES=' PV-DISPLAY             46520000
565800                ' ITEM=' PV-DISPLAY-1                             46530000
565900                DELIMITED BY SIZE                                 46540000
566000                          INTO PV-CICS-MSG-AREA                   46550000
566100         PERFORM 7000-WRITE-TO-CICS-LOG                           46560000
566101     END-IF.                                                      46570000
566102*                                                                 46580000
566103     EXEC CICS                                                    46590000
566104         WRITEQ TS                                                46600000
566105             QUEUE (ASC-LIST-QUEUE-NAME)                          46610000
566106             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               46620000
566107             ITEM  (PV-BLOCK-NUMBER)                              46630000
566108             REWRITE                                              46640000
566109             RESP  (PV-CICS-RESP)                                 46650000
566110     END-EXEC.                                                    46660000
566111                                                                  46670000
566112     IF PV-CICS-RESP = DFHRESP(NORMAL)                            46680000
566113         CONTINUE                                                 46690000
566114     ELSE                                                         46700000
566115         IF PS-CICS-SWITCH-YES                                    46710000
566116             INITIALIZE PV-CICS-MSG-AREA                          46720000
566117             MOVE PV-CICS-RESP TO PV-DISPLAY                      46730000
566118             STRING ' ' PV-SRC-TASK-NUMBER                        46740000
566119                    ' WSKCS316-5105'                              46750000
566120                    ' ERROR, PV-CICS-RESP=' PV-DISPLAY            46760000
566130                    DELIMITED BY SIZE                             46770000
566140                              INTO PV-CICS-MSG-AREA               46780000
566150             PERFORM 7000-WRITE-TO-CICS-LOG                       46790000
566151         END-IF                                                   46800000
566152         SET DP013-CICS-ABEND            TO TRUE                  46810000
566200         SET DP013-NO-ROLLBACK           TO TRUE                  46820000
566300         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       46830000
566400         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     46840000
566500                                         TO DP013-MESSAGE-TEXT(1) 46850000
566600         PERFORM DP013-0000-PROCESS-ABEND                         46860000
566700     END-IF.                                                      46870000
566800                                                                  46880000
566900******************************************************************46890000
567000** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **46900000
567100** SPECIFIC COMMAREA.                                           **46910000
567200******************************************************************46920000
567300 5110-WRITE-ASC-LISTQ.                                            46930000
567400                                                                  46940000
567500     IF PS-CICS-SWITCH-YES                                        46950000
567600         INITIALIZE PV-CICS-MSG-AREA                              46960000
567700         MOVE ASC-BLK-SUB TO PV-DISPLAY                           46970000
567800         MOVE PV-BLOCK-NUMBER TO PV-DISPLAY-1                     46980000
567900         STRING ' ' PV-SRC-TASK-NUMBER                            46990000
568000                ' WSKCS316-5110'                                  47000000
568100                ' WRITE QUEUE=' ASC-LIST-QUEUE-NAME               47010000
568200                ' FROM ASC-BLOCK-ENTRIES=' PV-DISPLAY             47020000
568300                ' ITEM=' PV-DISPLAY-1                             47030000
568400                DELIMITED BY SIZE                                 47040000
568500                          INTO PV-CICS-MSG-AREA                   47050000
568600         PERFORM 7000-WRITE-TO-CICS-LOG                           47060000
568601     END-IF.                                                      47070000
568602*                                                                 47080000
568603     EXEC CICS                                                    47090000
568604         WRITEQ TS                                                47100000
568605             QUEUE (ASC-LIST-QUEUE-NAME)                          47110000
568606             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               47120000
568607             ITEM  (PV-BLOCK-NUMBER)                              47130000
568608             RESP  (PV-CICS-RESP)                                 47140000
568609     END-EXEC.                                                    47150000
568610     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       47160000
568620         IF PS-CICS-SWITCH-YES                                    47170000
568630             INITIALIZE PV-CICS-MSG-AREA                          47180000
568640             MOVE PV-CICS-RESP TO PV-DISPLAY                      47190000
568650             STRING ' ' PV-SRC-TASK-NUMBER                        47200000
568660                    ' WSKCS316-5110'                              47210000
568670                    ' ERROR, PV-CICS-RESP=' PV-DISPLAY            47220000
568680                    DELIMITED BY SIZE                             47230000
568690                              INTO PV-CICS-MSG-AREA               47240000
568700             PERFORM 7000-WRITE-TO-CICS-LOG                       47250000
568701         END-IF                                                   47260000
568702         SET DP013-CICS-ABEND      TO TRUE                        47270000
568703         SET DP013-NO-ROLLBACK     TO TRUE                        47280000
568704         MOVE '5110-WRITE-ASC-LISTQ'                              47290000
568705                                   TO DP013-PARAGRAPH             47300000
568706         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           47310000
568707                                   TO DP013-MESSAGE-TEXT(1)       47320000
568800         PERFORM DP013-0000-PROCESS-ABEND                         47330000
568900     END-IF.                                                      47340000
573500                                                                  47350000
576500******************************************************************47360000
576600** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **47370000
576700** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **47380000
576800** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **47390000
576900** THE USER.                                                    **47400000
577000******************************************************************47410000
577100 6000-REFRESH-PANEL-FROM-TEMP.                                    47420000
577200*                                                                 47430000
577300     IF PS-CICS-SWITCH-YES                                        47440000
577400         INITIALIZE PV-CICS-MSG-AREA                              47450000
577500         STRING ' ' PV-SRC-TASK-NUMBER                            47460000
577600                ' WSKCS316-6000'                                  47470000
577700                DELIMITED BY SIZE                                 47480000
577800                          INTO PV-CICS-MSG-AREA                   47490000
577900         PERFORM 7000-WRITE-TO-CICS-LOG                           47500000
577901     END-IF.                                                      47510000
577902*                                                                 47520000
577903     IF ASC-UPDATE-TSQ                                            47530000
577904         SET ASC-NO-TSQ-UPDATE TO TRUE                            47540000
577905         MOVE ZERO                 TO PV-SAVE-ITEM                47550000
577906                                      PV-SEL-QUEUE-ITEM           47560000
577907         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        47570000
577908                                   TO PV-HOLD-SELECTED-ITEMS      47580000
577909         MOVE +1                   TO PV-ITEMS-PROCESSED          47590000
577910         PERFORM 6100-UPDATE-TSQ                                  47600000
578000             UNTIL PV-ITEMS-PROCESSED >                           47610000
578100                                     PV-HOLD-SELECTED-ITEMS       47620000
578200         PERFORM 6010-DELETE-SEL-QUEUE                            47630000
578300         INITIALIZE ASC-BLOCK-ENTRIES (1)                         47640000
578400                    ASC-BLOCK-ENTRIES (2)                         47650000
578500     END-IF.                                                      47660000
578600                                                                  47670000
578700*----------------------------------------------------------------*47680000
578800*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *47690000
578900*----------------------------------------------------------------*47700000
579000 6010-DELETE-SEL-QUEUE.                                           47710000
579100                                                                  47720000
579200     IF PS-CICS-SWITCH-YES                                        47730000
579300         INITIALIZE PV-CICS-MSG-AREA                              47740000
579400         STRING ' ' PV-SRC-TASK-NUMBER                            47750000
579500                ' WSKCS316-6010'                                  47760000
579600                ' DELETE QUEUE=' ASC-SEL-QUEUE-NAME-OUT           47770000
579700                DELIMITED BY SIZE                                 47780000
579800                          INTO PV-CICS-MSG-AREA                   47790000
579900         PERFORM 7000-WRITE-TO-CICS-LOG                           47800000
579901     END-IF.                                                      47810000
579902*                                                                 47820000
579903     EXEC CICS                                                    47830000
579904         DELETEQ TS                                               47840000
579905             QUEUE (ASC-SEL-QUEUE-NAME-OUT)                       47850000
579906             RESP  (PV-CICS-RESP)                                 47860000
579907     END-EXEC.                                                    47870000
579908*                                                                 47880000
579909     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      47890000
579910        (PV-CICS-RESP = DFHRESP(QIDERR)))                         47900000
580000         CONTINUE                                                 47910000
580100     ELSE                                                         47920000
580200         IF PS-CICS-SWITCH-YES                                    47930000
580300             INITIALIZE PV-CICS-MSG-AREA                          47940000
580400             MOVE PV-CICS-RESP TO PV-DISPLAY                      47950000
580500             STRING ' ' PV-SRC-TASK-NUMBER                        47960000
580600                    ' WSKCS316-6010'                              47970000
580700                    ' ERROR, PV-CICS-RESP=' PV-DISPLAY            47980000
580800                    DELIMITED BY SIZE                             47990000
580900                              INTO PV-CICS-MSG-AREA               48000000
581000             PERFORM 7000-WRITE-TO-CICS-LOG                       48010000
581001         END-IF                                                   48020000
581002         SET DP013-CICS-ABEND TO TRUE                             48030000
581003         SET DP013-NO-ROLLBACK TO TRUE                            48040000
581004         MOVE '6010-DELETE-SEL-QUEUE'                             48050000
581005                        TO DP013-PARAGRAPH                        48060000
581006         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         48070000
581007                        TO DP013-MESSAGE-TEXT (1)                 48080000
581008         PERFORM DP013-0000-PROCESS-ABEND                         48090000
581009     END-IF.                                                      48100000
581010                                                                  48110000
581100*----------------------------------------------------------------*48120000
581200*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *48130000
581300*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *48140000
581400*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *48150000
581500*    THE TEMP QUEUE.                                             *48160000
581600*----------------------------------------------------------------*48170000
581700                                                                  48180000
581800 6100-UPDATE-TSQ.                                                 48190000
581900                                                                  48200000
582000     IF PS-CICS-SWITCH-YES                                        48210000
582100         INITIALIZE PV-CICS-MSG-AREA                              48220000
582200         STRING ' ' PV-SRC-TASK-NUMBER                            48230000
582300                ' WSKCS316-6100'                                  48240000
582400                DELIMITED BY SIZE                                 48250000
582500                          INTO PV-CICS-MSG-AREA                   48260000
582600         PERFORM 7000-WRITE-TO-CICS-LOG                           48270000
582601     END-IF.                                                      48280000
582602*                                                                 48290000
582603     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             48300000
582604     PERFORM 6105-READ-SEL-QUEUE.                                 48310000
582605     PERFORM                                                      48320000
582606         VARYING WS011-IDX                                        48330000
582607         FROM 1 BY 1                                              48340000
582608         UNTIL ((PV-ITEMS-PROCESSED >                             48350000
582609                              PV-HOLD-SELECTED-ITEMS)             48360000
582700         OR (WS011-IDX GREATER THAN WS011-MAX-ITEMS))             48370000
582900             PERFORM 6110-PROCESS-ITEMS                           48380000
583100         ADD +1                TO PV-ITEMS-PROCESSED              48390000
583200     END-PERFORM.                                                 48400000
583300     PERFORM 6111-WRITE-LIST-QUEUE.                               48410000
583700                                                                  48420000
583701*----------------------------------------------------------------*48430000
583702*    READ THE LIST QUEUE RECORD.                                 *48440000
583703*----------------------------------------------------------------*48450000
583704                                                                  48460000
583800 6105-READ-SEL-QUEUE.                                             48470000
583900                                                                  48480000
584000     INITIALIZE WS011-SELECT-RECORD.                              48490000
584100     IF PS-CICS-SWITCH-YES                                        48500000
584200         INITIALIZE PV-CICS-MSG-AREA                              48510000
584300         MOVE PV-SEL-QUEUE-ITEM TO PV-DISPLAY                     48520000
584400         STRING ' ' PV-SRC-TASK-NUMBER                            48530000
584500                ' WSKCS316-6105'                                  48540000
584600                ' READ QUEUE=' ASC-SEL-QUEUE-NAME-IN              48550000
584700                ' INTO WS011, ITEM=' PV-DISPLAY                   48560000
584800                DELIMITED BY SIZE                                 48570000
584900                          INTO PV-CICS-MSG-AREA                   48580000
585000         PERFORM 7000-WRITE-TO-CICS-LOG                           48590000
585001     END-IF.                                                      48600000
585002*                                                                 48610000
585003     EXEC CICS                                                    48620000
585004          READQ TS                                                48630000
585005              QUEUE (ASC-SEL-QUEUE-NAME-IN)                       48640000
585006              INTO  (WS011-SELECT-RECORD)                         48650000
585007              ITEM  (PV-SEL-QUEUE-ITEM)                           48660000
585008              RESP  (PV-CICS-RESP)                                48670000
585009     END-EXEC.                                                    48680000
585010*                                                                 48690000
585011     IF PV-CICS-RESP = DFHRESP (NORMAL)                           48700000
585012         CONTINUE                                                 48710000
585013     ELSE                                                         48720000
585014         IF PS-CICS-SWITCH-YES                                    48730000
585015             INITIALIZE PV-CICS-MSG-AREA                          48740000
585016             MOVE PV-CICS-RESP TO PV-DISPLAY                      48750000
585017             STRING ' ' PV-SRC-TASK-NUMBER                        48760000
585018                    ' WSKCS316-6105'                              48770000
585019                    ' ERROR, PV-CICS-RESP=' PV-DISPLAY            48780000
585020                    DELIMITED BY SIZE                             48790000
585030                              INTO PV-CICS-MSG-AREA               48800000
585040             PERFORM 7000-WRITE-TO-CICS-LOG                       48810000
585050         END-IF                                                   48820000
585100         SET DP013-CICS-ABEND      TO  TRUE                       48830000
585200         SET DP013-NO-ROLLBACK     TO  TRUE                       48840000
585300         MOVE '6105-READ-SEL-QUEUE'                               48850000
585400                                   TO  DP013-PARAGRAPH            48860000
585500         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           48870000
585600                                   TO  DP013-MESSAGE-TEXT(1)      48880000
585700         PERFORM DP013-0000-PROCESS-ABEND                         48890000
585800     END-IF.                                                      48900000
585900/                                                                 48910000
586000*----------------------------------------------------------------*48920000
586100*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*48930000
586200*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*48940000
586300*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *48950000
586400*----------------------------------------------------------------*48960000
586500                                                                  48970000
586600 6110-PROCESS-ITEMS.                                              48980000
586700                                                                  48990000
586800     IF PS-CICS-SWITCH-YES                                        49000000
586900         INITIALIZE PV-CICS-MSG-AREA                              49010000
587000         STRING ' ' PV-SRC-TASK-NUMBER                            49020000
587100                ' WSKCS316-6110'                                  49030000
587200                DELIMITED BY SIZE                                 49040000
587300                          INTO PV-CICS-MSG-AREA                   49050000
587400         PERFORM 7000-WRITE-TO-CICS-LOG                           49060000
587401     END-IF.                                                      49070000
587402*                                                                 49080000
587403     COMPUTE PV-ITEM = 1 + ((WS011-ITEM (WS011-IDX) - 1)          49090000
587404                     / PC-ITEMS-PER-PANEL).                       49100000
587405                                                                  49110000
587406     IF PV-ITEM NOT EQUAL PV-SAVE-ITEM                            49120000
587407         IF PV-SAVE-ITEM NOT EQUAL ZERO                           49130000
587408             PERFORM 6111-WRITE-LIST-QUEUE                        49140000
587409         END-IF                                                   49150000
587500         MOVE PV-ITEM          TO PV-SAVE-ITEM                    49160000
587600                                                                  49170000
587700         PERFORM 6112-READ-LIST-QUEUE                             49180000
587800         IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                49190000
587900             CONTINUE                                             49200000
588000         END-IF                                                   49210000
588100     END-IF.                                                      49220000
588200                                                                  49230000
588300     COMPUTE PV-SUB = (WS011-ITEM (WS011-IDX)                     49240000
588400                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              49250000
588500     SET LQW-DESELECT (PV-SUB) TO    TRUE                         49260000
588600     MOVE LQW-SELECTED-SW (PV-SUB)                                49270000
588700                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  49280000
590200                                                                  49290000
590300     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                49300000
590400                                                                  49310000
590500*----------------------------------------------------------------*49320000
590600*    WRITE THE TS QUEUE RECORD JUST UPDATED IN 6100.             *49330000
590700*----------------------------------------------------------------*49340000
590800                                                                  49350000
590900 6111-WRITE-LIST-QUEUE.                                           49360000
591000                                                                  49370000
591100     IF PS-CICS-SWITCH-YES                                        49380000
591200         INITIALIZE PV-CICS-MSG-AREA                              49390000
591300         MOVE PV-SAVE-ITEM TO PV-DISPLAY                          49400000
591400         STRING ' ' PV-SRC-TASK-NUMBER                            49410000
591500                ' WSKCS316-6111'                                  49420000
591600                ' WRITE QUEUE=' ASC-LIST-QUEUE-NAME               49430000
591700                ' FROM LQW, ITEM =' PV-DISPLAY                    49440000
591800                DELIMITED BY SIZE                                 49450000
591900                          INTO PV-CICS-MSG-AREA                   49460000
592000         PERFORM 7000-WRITE-TO-CICS-LOG                           49470000
592001     END-IF.                                                      49480000
592002*                                                                 49490000
592003     EXEC CICS                                                    49500000
592004         WRITEQ TS                                                49510000
592005             QUEUE (ASC-LIST-QUEUE-NAME)                          49520000
592006             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     49530000
592007             ITEM  (PV-SAVE-ITEM)                                 49540000
592008             REWRITE                                              49550000
592009             RESP  (PV-CICS-RESP)                                 49560000
592010     END-EXEC.                                                    49570000
592011*                                                                 49580000
592012     IF PV-CICS-RESP = DFHRESP (NORMAL)                           49590000
592100         CONTINUE                                                 49600000
592200     ELSE                                                         49610000
592300         IF PS-CICS-SWITCH-YES                                    49620000
592400             INITIALIZE PV-CICS-MSG-AREA                          49630000
592500             MOVE PV-CICS-RESP TO PV-DISPLAY                      49640000
592600             STRING ' ' PV-SRC-TASK-NUMBER                        49650000
592700                    ' WSKCS316-6111'                              49660000
592800                    ' ERROR, PV-CICS-RESP=' PV-DISPLAY            49670000
592900                    DELIMITED BY SIZE                             49680000
593000                              INTO PV-CICS-MSG-AREA               49690000
593100             PERFORM 7000-WRITE-TO-CICS-LOG                       49700000
593101         END-IF                                                   49710000
593102         SET DP013-CICS-ABEND  TO  TRUE                           49720000
593103         SET DP013-NO-ROLLBACK TO  TRUE                           49730000
593104         MOVE '6111-WRITE-LIST-QUEUE'                             49740000
593105                               TO  DP013-PARAGRAPH                49750000
593106         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  49760000
593107                               TO  DP013-MESSAGE-TEXT(1)          49770000
593108         PERFORM DP013-0000-PROCESS-ABEND                         49780000
593109     END-IF.                                                      49790000
593110                                                                  49800000
593200/                                                                 49810000
593300*----------------------------------------------------------------*49820000
593400*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*49830000
593500*----------------------------------------------------------------*49840000
593600                                                                  49850000
593700 6112-READ-LIST-QUEUE.                                            49860000
593800                                                                  49870000
593900     IF PS-CICS-SWITCH-YES                                        49880000
594000         INITIALIZE PV-CICS-MSG-AREA                              49890000
594100         MOVE PV-ITEM TO PV-DISPLAY                               49900000
594200         STRING ' ' PV-SRC-TASK-NUMBER                            49910000
594300                ' WSKCS316-6112'                                  49920000
594400                ' READ QUEUE=' ASC-LIST-QUEUE-NAME                49930000
594500                ' INTO LQW, ITEM=' PV-DISPLAY                     49940000
594600                DELIMITED BY SIZE                                 49950000
594700                          INTO PV-CICS-MSG-AREA                   49960000
594800         PERFORM 7000-WRITE-TO-CICS-LOG                           49970000
594801     END-IF.                                                      49980000
594802*                                                                 49990000
594803     EXEC CICS                                                    50000000
594804         READQ TS                                                 50010000
594805             QUEUE (ASC-LIST-QUEUE-NAME)                          50020000
594806             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     50030000
594807             ITEM  (PV-ITEM)                                      50040000
594808             RESP  (PV-CICS-RESP)                                 50050000
594809     END-EXEC.                                                    50060000
594810*                                                                 50070000
594811     IF PV-CICS-RESP = DFHRESP (NORMAL)                           50080000
594812         CONTINUE                                                 50090000
594900     ELSE                                                         50100000
595000         IF PS-CICS-SWITCH-YES                                    50110000
595100             INITIALIZE PV-CICS-MSG-AREA                          50120000
595200             MOVE PV-CICS-RESP TO PV-DISPLAY                      50130000
595300             STRING ' ' PV-SRC-TASK-NUMBER                        50140000
595400                    ' WSKCS316-6112'                              50150000
595500                    ' ERROR, PV-CICS-RESP=' PV-DISPLAY            50160000
595600                    DELIMITED BY SIZE                             50170000
595700                              INTO PV-CICS-MSG-AREA               50180000
595800             PERFORM 7000-WRITE-TO-CICS-LOG                       50190000
595801         END-IF                                                   50200000
595802         SET DP013-CICS-ABEND        TO TRUE                      50210000
595803         SET DP013-NO-ROLLBACK       TO TRUE                      50220000
595804         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           50230000
595805         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    50240000
595806                                     TO DP013-MESSAGE-TEXT(1)     50250000
595807         PERFORM DP013-0000-PROCESS-ABEND                         50260000
595808     END-IF.                                                      50270000
595809                                                                  50280000
595810 7000-WRITE-TO-CICS-LOG.                                          50290000
595820                                                                  50300000
595830     MOVE LENGTH OF PV-CICS-MSG-AREA TO PV-COMMAREA-LENGTH.       50310000
595840                                                                  50320000
595850     EXEC CICS                                                    50330000
595860          WRITEQ TD                                               50340000
595870          QUEUE  ('CSSL')                                         50350000
595880          FROM  (PV-CICS-MSG-AREA)                                50360000
595890          LENGTH  (PV-COMMAREA-LENGTH)                            50370000
595900          RESP  (PV-CICS-RESP)                                    50380000
596000     END-EXEC.                                                    50390000
596100                                                                  50400000
596200     MOVE SPACES TO PV-CICS-MSG-AREA.                             50410000
596300                                                                  50420000
596400*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 50430000
596500* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *50440000
596600*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 50450000
596601 9100-READ-SEL-QUEUE.                                             50460000
596602*                                                                 50470000
596603     INITIALIZE WS011-SELECT-RECORD.                              50480000
596604     IF PS-CICS-SWITCH-YES                                        50490000
596605         INITIALIZE PV-CICS-MSG-AREA                              50500000
596606         MOVE ASC-SEL-ITEM TO PV-DISPLAY                          50510000
596607         STRING ' ' PV-SRC-TASK-NUMBER                            50520000
596608                ' WSKCS316-9100'                                  50530000
596609                ' READ QUEUE=' ASC-SEL-QUEUE-NAME-IN              50540000
596610                ' INTO WS011, ITEM=' PV-DISPLAY                   50550000
596620                DELIMITED BY SIZE                                 50560000
596630                          INTO PV-CICS-MSG-AREA                   50570000
596640         PERFORM 7000-WRITE-TO-CICS-LOG                           50580000
596641     END-IF.                                                      50590000
596642*                                                                 50600000
596643     EXEC CICS                                                    50610000
596644         READQ TS                                                 50620000
596645             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        50630000
596646             INTO  (WS011-SELECT-RECORD)                          50640000
596647             ITEM  (ASC-SEL-ITEM)                                 50650000
596648             RESP  (PV-CICS-RESP)                                 50660000
596649     END-EXEC.                                                    50670000
596650*                                                                 50680000
596660     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        50690000
596670         CONTINUE                                                 50700000
596680     ELSE                                                         50710000
596690         IF PS-CICS-SWITCH-YES                                    50720000
596700             INITIALIZE PV-CICS-MSG-AREA                          50730000
596800             MOVE PV-CICS-RESP TO PV-DISPLAY                      50740000
596900             STRING ' ' PV-SRC-TASK-NUMBER                        50750000
597000                    ' WSKCS316-9100'                              50760000
597100                    ' ERROR, PV-CICS-RESP=' PV-DISPLAY            50770000
597200                    DELIMITED BY SIZE                             50780000
597300                              INTO PV-CICS-MSG-AREA               50790000
597400             PERFORM 7000-WRITE-TO-CICS-LOG                       50800000
597500         END-IF                                                   50810000
597600         SET DP013-LOGIC-ABEND                                    50820000
597700             DP013-NO-ROLLBACK   TO   TRUE                        50830000
597800         MOVE '9100-READ-SEL-QUEUE'                               50840000
597900                                 TO   DP013-PARAGRAPH             50850000
598000         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   50860000
598100                                 TO   DP013-MESSAGE-TEXT (1)      50870000
598200         PERFORM DP013-0000-PROCESS-ABEND                         50880000
598300     END-IF.                                                      50890000
598400                                                                  50900000
598500                                                                  50910000
624401                                                                  50920000
624402*----------------------------------------------------------------*50930000
624403*    ABEND PROCESSOR MODULE                                      *50940000
624404*----------------------------------------------------------------*50950000
624405                                                                  50960000
624406     COPY DPPD013.                                                50970000
