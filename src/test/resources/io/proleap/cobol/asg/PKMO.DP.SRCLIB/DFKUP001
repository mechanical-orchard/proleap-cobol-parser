000100 IDENTIFICATION DIVISION.                                         00010002
000200                                                                  00020002
000300 PROGRAM-ID.      DFKUP001.                                       00030002
000400 AUTHOR.          STEVEN NOWAK.                                   00040002
000500 INSTALLATION.    KOHLS DEPARTMENT STORES.                        00050002
000600 DATE-WRITTEN.    12/15/09.                                       00060002
000700 DATE-COMPILED.                                                   00070002
000800                                                                  00080002
000900******************************************************************00090002
001000*  MODULE TYPE:   COBOL2 DB2 BATCH.                               00100002
001100*                                                                 00110002
001000*  DAILY UPDATE OF XSTW_DF_LOC_HIER FOR CLOSED STORES THAT HAVE   00120005
001100*  BEEN REPLACED IN THE LAST 4 YEARS.                             00130005
001400*                                                                 00140002
001500*========================== CHANGE LOG ===========================00150002
001600*  AUTH        BY             DATE     DESCRIPTION                00160008
001700*=================================================================00170002
001800* WR37120     S. NOWAK      12-15-09   CREATE PROGRAM             00180008
001900*                                                                 00190002
260107* CHG0260107  JIM HUNTER    08-18-21                              00191008
260107* ADDING COPYBOOK DPWS991 TO MAKE CALL TO DPKUT901 DYNAMIC.       00192008
002000******************************************************************00200002
002100                                                                  00210002
002200 ENVIRONMENT DIVISION.                                            00220002
002300 CONFIGURATION SECTION.                                           00230002
002400                                                                  00240002
002500 SOURCE-COMPUTER.    IBM-3090.                                    00250002
002600 OBJECT-COMPUTER.    IBM-3090.                                    00260002
002700                                                                  00270002
002800 INPUT-OUTPUT SECTION.                                            00280002
002900 FILE-CONTROL.                                                    00290002
003000                                                                  00300002
003100 DATA DIVISION.                                                   00310002
003200 FILE SECTION.                                                    00320002
003300                                                                  00330002
003400                                                                  00340002
003500***************************************************************** 00350002
003600*                       WORKING STORAGE                           00360002
003700***************************************************************** 00370002
003800 WORKING-STORAGE SECTION.                                         00380002
003900                                                                  00390002
004000 01  W-START                          PIC  X(40)                  00400002
004100     VALUE 'DFKUP001 - WORKING STORAGE BEGINS HERE'.              00410002
004200                                                                  00420002
004300                                                                  00430002
004400***************************************************************** 00440002
004500*                         SWITCHES                                00450002
004600***************************************************************** 00460002
004700 01  PROGRAM-SWITCHES.                                            00470002
004800     05  PS-RESTART-REQUIRED-SW       PIC  X(01) VALUE 'N'.       00480002
004900         88  PS-RESTART-REQUIRED                 VALUE 'Y'.       00490002
005000         88  PS-RESTART-NOT-REQUIRED             VALUE 'N'.       00500002
005100                                                                  00510002
005200******************************************************************00520002
005300*                       ACCUMULATORS                              00530002
005400******************************************************************00540002
005500 01  PROGRAM-ACCUM.                                               00550002
005600     05  PA-READ                      PIC  9(11) VALUE ZEROS.     00560002
005700     05  PA-CKPT                      PIC  9(11) VALUE ZEROS.     00570002
005800                                                                  00580002
005900******************************************************************00590002
006000*                           CONSTANTS                             00600002
006100******************************************************************00610002
006200 01  PROGRAM-CONSTANTS.                                           00620002
006300     05  PC-MAX-RETRIES               PIC S9(04) VALUE +3         00630002
006400                                                 COMP SYNC.       00640002
006500     05  PC-MAX-DEADLOCKS             PIC S9(04) VALUE +3         00650002
006600                                                 COMP SYNC.       00660002
006700                                                                  00670002
006800     05  PC-CKPT-JOB-NAME             PIC  X(08) VALUE 'DFK030  '.00680002
006900     05  PC-CKPT-PLAN-NAME            PIC  X(08) VALUE 'DFKUP001'.00690002
007000     05  PC-PROGRAM-NAME              PIC  X(08) VALUE 'DFKUP001'.00700002
007100                                                                  00710002
007200     05  PC-TRAN-PRES-FUNC-CODES.                                 00720002
007300         10  PC-TRAN-PRES-FUNC-OPEN   PIC  X(05) VALUE 'OPEN '.   00730002
007400         10  PC-TRAN-PRES-FUNC-TRANS  PIC  X(05) VALUE 'TRANS'.   00740002
007500         10  PC-TRAN-PRES-FUNC-RSTRT  PIC  X(05) VALUE 'RSTRT'.   00750002
007600         10  PC-TRAN-PRES-FUNC-CLOSE  PIC  X(05) VALUE 'CLOSE'.   00760002
007700                                                                  00770002
007800     05  PC-MINUS-ONE                 PIC S9(01) VALUE -1.        00780002
007900     05  PC-SYSTEM                    PIC  X(08) VALUE 'SYSTEM  '.00790002
008000                                                                  00800002
008100******************************************************************00810002
008200*                          VARIABLES                              00820002
008300******************************************************************00830002
008400 01  PROGRAM-VARIABLES.                                           00840002
008500     05  PV-SQL-SUB                   PIC  9(03) VALUE ZERO.      00850002
008600     05  PV-DEADLOCK-COUNTER          PIC  9(03) VALUE ZERO.      00860002
008700     05  PV-RETRY-CNT                 PIC  9(03) VALUE ZERO.      00870002
008800     05  PV-PARAGRAPH-NAME            PIC  X(30) VALUE SPACE.     00880002
008900     05  PV-DB2-OPER-ATTEMPTED        PIC  X(30) VALUE SPACE.     00890002
009000     05  PV-OPERATION-MSG             PIC  X(35) VALUE SPACE.     00900002
009100     05  PV-RET-CODE                  PIC  9(04) VALUE ZEROS.     00910002
009200                                                                  00920002
009300******************************************************************00930002
009400*               SYSTEM TIME AND DATE VARIABLES                    00940002
009500******************************************************************00950002
009600 01  SYS-DATE-TIME.                                               00960002
009700     05  SYS-DATE                     PIC  X(08) VALUE SPACES.    00970002
009800     05  SYS-TIME                     PIC  X(08) VALUE SPACES.    00980002
009900                                                                  00990002
010000 01  ST-BEG-TIME.                                                 01000002
010100     05  ST-BEG-HR                    PIC  9(02) VALUE ZEROS.     01010002
010200     05  FILLER                       PIC  X(01) VALUE ':'.       01020002
010300     05  ST-BEG-MN                    PIC  9(02) VALUE ZEROS.     01030002
010400                                                                  01040002
010500 01  ST-END-TIME.                                                 01050002
010600     05  ST-END-HR                    PIC  9(02) VALUE ZEROS.     01060002
010700     05  FILLER                       PIC  X(01) VALUE ':'.       01070002
010800     05  ST-END-MN                    PIC  9(02) VALUE ZEROS.     01080002
010900                                                                  01090002
011000 01  SD-EDIT-DATE.                                                01100002
011100     05  SD-MONTH                     PIC  9(02) VALUE ZEROS.     01110002
011200     05  FILLER                       PIC  X(01) VALUE '-'.       01120002
011300     05  SD-DAY                       PIC  9(02) VALUE ZEROS.     01130002
011400     05  FILLER                       PIC  X(01) VALUE '-'.       01140002
011500     05  SD-CENT                      PIC  9(02) VALUE ZEROS.     01150002
011600     05  SD-YEAR                      PIC  9(02) VALUE ZEROS.     01160002
011700                                                                  01170002
011800******************************************************************01180002
011900*                        ERROR HANDLING                           01190002
012000******************************************************************01200002
012100 01  ABEND-CODE                       PIC S9(04) VALUE ZEROS      01210002
012200                                                 COMP SYNC.       01220002
012400     88  ABEND-4013-DB2-ERROR                    VALUE +4013.     01240002
012500     88  ABEND-4444-FORCED-ABEND                 VALUE +4444.     01251007
012600                                                                  01260002
012700                                                                  01270002
012800******************************************************************01280002
012900*  UPDATE RECORD                                                  01290002
013000******************************************************************01300002
013100     COPY DFRD018.                                                01310006
013200                                                                  01320002
013300******************************************************************01330002
013400*  DB2 FORMATTED ERROR MESSAGE                                    01340002
013500******************************************************************01350002
013600     COPY DPWS004.                                                01360002
013700                                                                  01370002
013800******************************************************************01380002
013900*  SQL COMMUNICATIONS WORK AREA                                   01390002
014000******************************************************************01400002
014100     COPY SQLCA2.                                                 01410002
014200                                                                  01420002
014300******************************************************************01430002
014400*  COMMUNICATIONS AREA FOR DB2                                    01440002
014500******************************************************************01450002
014600     EXEC SQL                                                     01460002
014700         INCLUDE SQLCA                                            01470002
014800     END-EXEC.                                                    01480002
014900                                                                  01490002
015000******************************************************************01500002
015100*  DCLGEN FOR DAILY FLASH LOCATION HIERARCHY TBL- XSTW_DF_LOC_HIER01510002
015200******************************************************************01520002
015300     EXEC SQL                                                     01530002
015400          INCLUDE XST00125                                        01540002
015500     END-EXEC.                                                    01550002
015600                                                                  01560002
015700                                                                  01570002
015800******************************************************************01580002
015900*  TRANSACTION PREPARATION MODULE COMMUNICATIONS AREA             01590002
016000******************************************************************01600002
260107     COPY DPWS991.                                                01610008
016100                                                                  01610108
016100     COPY DPLS001.                                                01611008
016200     05  WORK-STORAGE-PASSED.                                     01620002
016300******************************************************************01630002
016400*PA - PROGRAM ACCUMULATORS                                        01640002
016500******************************************************************01650002
016600         10  PROGRAM-ACCUMULATORS.                                01660002
016700             15  PA-ROWS-UPDATE   PIC S9(11)           VALUE ZERO 01670002
016800                                                       COMP-3.    01680002
016900                                                                  01690002
017000 01  FILLER                          PIC X(4096)  VALUE SPACE.    01700002
017100                                                                  01710002
017200                                                                  01720002
017300                                                                  01730002
017400 PROCEDURE DIVISION.                                              01740002
017500******************************************************************01750002
017600* MAINLINE-PROCESSING                                             01760002
017700******************************************************************01770002
017800                                                                  01780002
017900     PERFORM A100-INITIALIZE.                                     01790002
018000                                                                  01800002
018100     PERFORM B100-PROCESS-RECORDS                                 01810002
018200       UNTIL DP001-PREP-TRANS-EOF.                                01820002
018300                                                                  01830002
018400     PERFORM Z990-EOJ-ROUTINE.                                    01840002
018500                                                                  01850002
018600     GOBACK.                                                      01860002
018700                                                                  01870002
018800                                                                  01880002
018900******************************************************************01890002
019000* PREFORMS TASK INITIATION                                        01900002
019100******************************************************************01910002
019200 A100-INITIALIZE.                                                 01920002
019300                                                                  01930002
019400     MOVE FUNCTION CURRENT-DATE TO SYS-DATE-TIME.                 01940002
019500                                                                  01950002
019600     MOVE SYS-TIME (1:2) TO ST-BEG-HR.                            01960002
019700     MOVE SYS-TIME (3:2) TO ST-BEG-MN.                            01970002
019800                                                                  01980002
019900     MOVE SYS-DATE (1:2) TO SD-CENT.                              01990002
020000     MOVE SYS-DATE (3:2) TO SD-YEAR.                              02000002
020100     MOVE SYS-DATE (5:2) TO SD-MONTH.                             02010002
020200     MOVE SYS-DATE (7:2) TO SD-DAY.                               02020002
020300                                                                  02030002
020400     MOVE PC-TRAN-PRES-FUNC-OPEN TO DP001-FUNC-CODE.              02040002
020500                                                                  02050002
020600     PERFORM X100-BUILD-COMM-AREA-TRAN-PRES.                      02060002
020700                                                                  02070002
020800                                                                  02080002
020900******************************************************************02090002
021000* PROCESS RECORDS                                                 02100002
021100******************************************************************02110002
021200 B100-PROCESS-RECORDS.                                            02120002
021300                                                                  02130002
021400     SET PS-RESTART-NOT-REQUIRED TO TRUE.                         02140002
021500                                                                  02150002
021600     PERFORM C100-UPDATE-RECS.                                    02160002
021700                                                                  02170002
021800*----------------------------------------------------------------*02180002
021900*  IF A RESTART IS REQUIRED, ISSUE A RESTART CALL RATHER THAN A  *02190002
022000*  TRANS CALL.  THIS WILL ALLOW PROCESSING TO RESUME WITH THE    *02200002
022100*  FIRST TRANSACTION AFTER THE LAST COMMIT.                      *02210002
022200*----------------------------------------------------------------*02220002
022300     IF  PS-RESTART-REQUIRED                                      02230002
022400         MOVE PC-TRAN-PRES-FUNC-RSTRT TO DP001-FUNC-CODE          02240002
022500     ELSE                                                         02250002
022600         MOVE PC-TRAN-PRES-FUNC-TRANS TO DP001-FUNC-CODE          02260002
022700     END-IF.                                                      02270002
022800                                                                  02280002
022900     PERFORM X100-BUILD-COMM-AREA-TRAN-PRES.                      02290002
023000                                                                  02300002
023100     ADD 1 TO PA-READ.                                            02310002
023200                                                                  02320002
023300                                                                  02330002
023400******************************************************************02340002
023500* UPDATE RECORDS                                                  02350002
023600******************************************************************02360002
023700 C100-UPDATE-RECS.                                                02370002
023800                                                                  02380002
023900     IF  DF018-NULL-IND = 'N'                                     02390006
024000         PERFORM C200-UPDATE-REPLT-STORE                          02400002
024100     ELSE                                                         02410002
024200         PERFORM C300-UPDATE-LOC-HIER                             02420002
024300     END-IF.                                                      02430002
024400                                                                  02440002
024500                                                                  02450002
024600******************************************************************02460002
024700* UPDATE THE XST_DF_LOC_HIER TABLE REPLACEMENT STR NBN TO NULL    02470002
024800******************************************************************02480002
024900 C200-UPDATE-REPLT-STORE.                                         02490002
025000                                                                  02500002
025100     EXEC SQL                                                     02510002
025200                                                                  02520002
025300       UPDATE XSTW_DF_LOC_HIER                                    02530002
025400                                                                  02540002
025500          SET REPLT_STR_NBR = NULL                                02550002
025600                                                                  02560002
025700          WHERE LOC_NBR = :DF018-LOC-NBR                          02570006
025800     END-EXEC.                                                    02580002
025900                                                                  02590002
026000     EVALUATE TRUE                                                02600002
026100        WHEN SQLCODE = 0                                          02610002
026200            ADD 1 TO PA-ROWS-UPDATE                               02620002
026300                                                                  02630002
026400            DISPLAY 'C200-UPDATE-REPLT-STR'                       02640002
026500                    ' STR NBR= ' DF018-LOC-NBR                    02650006
022100                    ' RPL NBR= ' DF018-REPLT-STR                  02651006
022200                    ' CLO DTE= ' DF018-CLO-DTE                    02652006
026600                                                                  02660002
026700        WHEN SQLCODE = +100                                       02670002
026800            CONTINUE                                              02680002
026900                                                                  02690002
027000        WHEN OTHER                                                02700002
027100            DISPLAY '                     '                       02710002
027200            DISPLAY 'C200-UPDATE-REPLT-STR'                       02720002
027300                    ' STR NBR= ' DF018-LOC-NBR                    02730006
022100                    ' RPL NBR= ' DF018-REPLT-STR                  02731006
022200                    ' CLO DTE= ' DF018-CLO-DTE                    02732006
027400                                                                  02740002
027500            MOVE 'C200-UPDATE-REPLT-STR'                          02750002
027600                                        TO PV-PARAGRAPH-NAME      02760002
027700            MOVE 'XSTW_DF_LOC_HIER UPDATE'                        02770002
027800                                        TO PV-DB2-OPER-ATTEMPTED  02780002
027900                                                                  02790002
028000            PERFORM Z200-SQL-ABEND                                02800002
028100     END-EVALUATE.                                                02810002
028200                                                                  02820002
028300                                                                  02830002
028400******************************************************************02840002
028500* UPDATE THE XST_DF_LOC_HIER TABLE WITH THE REPLACEMENT STORE     02850002
028600* HIERARCHY INFO.                                                 02860002
028700******************************************************************02870002
028800 C300-UPDATE-LOC-HIER.                                            02880002
028900                                                                  02890002
029000     EXEC SQL                                                     02900002
029100                                                                  02910002
029200       UPDATE XSTW_DF_LOC_HIER                                    02920002
029300                                                                  02930002
029400          SET DIST_NBR   = :DF018-DIST-NBR                        02940006
029500             ,DIST_NM    = :DF018-DIST-NM                         02950006
029600             ,REGN_NBR   = :DF018-REGN-NBR                        02960006
029700             ,REGN_NM    = :DF018-REGN-NM                         02970006
029800             ,TERR_NBR   = :DF018-TERR-NBR                        02980006
029900             ,TERR_NM    = :DF018-TERR-NM                         02990006
030000             ,METRO_ID   = :DF018-METRO-ID                        03000006
030100             ,METRO_NM   = :DF018-METRO-NM                        03010006
030200             ,GEO_REG_ID = :DF018-GEO-ID                          03020006
030300             ,GEO_REG_NM = :DF018-GEO-NM                          03030006
030400             ,CLMT_ID    = :DF018-CLMT-ID                         03040006
030500             ,CLMT_NM    = :DF018-CLMT-NM                         03050006
030600                                                                  03060002
030700          WHERE LOC_NBR   = :DF018-LOC-NBR                        03070006
030800     END-EXEC.                                                    03080002
030900                                                                  03090002
031000     EVALUATE TRUE                                                03100002
031100        WHEN SQLCODE = 0                                          03110002
031200            ADD 1 TO PA-ROWS-UPDATE                               03120002
031300                                                                  03130002
031400            DISPLAY 'C300-UPDATE-LOC-HIER'                        03140002
031500                    '  STR NBR= ' DF018-LOC-NBR                   03150006
022100                    ' RPL NBR= ' DF018-REPLT-STR                  03151006
022200                    ' CLO DTE= ' DF018-CLO-DTE                    03152006
031600                                                                  03160002
031700        WHEN SQLCODE = +100                                       03170002
031800            CONTINUE                                              03180002
031900                                                                  03190002
032000        WHEN OTHER                                                03200002
032100            DISPLAY '                    '                        03210002
032200            DISPLAY 'C300-UPDATE-LOC-HIER'                        03220002
032300                    ' STR NBR= ' DF018-LOC-NBR                    03230006
022100                    ' RPL NBR= ' DF018-REPLT-STR                  03231006
022200                    ' CLO DTE= ' DF018-CLO-DTE                    03232006
032400                                                                  03240002
032500            MOVE 'C300-UPDATE-LOC-HIER'                           03250002
032600                                        TO PV-PARAGRAPH-NAME      03260002
032700            MOVE 'XSTW_DF_LOC_HIER UPDATE'                        03270002
032800                                        TO PV-DB2-OPER-ATTEMPTED  03280002
032900                                                                  03290002
033000            PERFORM Z200-SQL-ABEND                                03300002
033100     END-EVALUATE.                                                03310002
033200                                                                  03320002
033300                                                                  03330002
033400******************************************************************03340002
033500* BUILD THE COMMUNICATION AREA FOR A CALL TO THE TRANSACTION      03350002
033600* PRESENTATION MODULE                                             03360002
033700******************************************************************03370002
033800 X100-BUILD-COMM-AREA-TRAN-PRES.                                  03380002
033900                                                                  03390002
034000     MOVE LENGTH OF                                               03400002
034100          WORK-STORAGE-PASSED TO DP001-WORK-STRG-LENGTH.          03410002
034200     MOVE PC-CKPT-JOB-NAME    TO DP001-JOB-NAME.                  03420002
034300     MOVE PC-CKPT-PLAN-NAME   TO DP001-PLAN-NAME.                 03430002
034400                                                                  03440002
034500     PERFORM X200-CALL-TRANS-PRES-MODULE.                         03450002
034600                                                                  03460002
034700     MOVE DP001-TRANS-RECORD  TO DF018-UPDT-REC.                  03470006
034800                                                                  03480002
034900     IF  DP001-CKPT-TAKEN                                         03490002
035000         ADD 1 TO PA-CKPT                                         03500002
035100                                                                  03510002
035200         INITIALIZE PV-DEADLOCK-COUNTER                           03520002
035300     END-IF.                                                      03530002
035400                                                                  03540002
035500                                                                  03550002
035600******************************************************************03560002
035700* VERIFY THE RETURN CODE ON THE CALLED MODULE                     03570002
035800******************************************************************03580002
035900 X200-CALL-TRANS-PRES-MODULE.                                     03590002
036000                                                                  03600002
036100     PERFORM Z900-CALL-TRANS-PRES-MODULE.                         03610002
036200                                                                  03620002
036300     IF  DP001-GOOD-RET-CODE                                      03630002
036400     OR  DP001-CKPT-TAKEN                                         03640002
036500     OR  DP001-RESTART                                            03650002
036600         CONTINUE                                                 03660002
036700                                                                  03670002
036800     ELSE                                                         03680002
036900         MOVE 'X200-CALL-TRANS-PRES-MODULE' TO PV-PARAGRAPH-NAME  03690002
037000         MOVE '** BAD CALL TO TRANS PREP MODULE **'               03700002
037100                                            TO PV-OPERATION-MSG   03710002
037200         MOVE DP001-RET-CODE                TO PV-RET-CODE        03720002
037300                                                                  03730002
037400         SET ABEND-4444-FORCED-ABEND TO TRUE                      03740007
037500                                                                  03750002
037600         PERFORM Z100-ABEND                                       03760002
037700     END-IF.                                                      03770002
037800                                                                  03780002
037900                                                                  03790002
038000******************************************************************03800002
038100* NON-DB2 ABEND                                                   03810002
038200******************************************************************03820002
038300 Z100-ABEND.                                                      03830002
038400                                                                  03840002
038500     PERFORM Z999-CONTROLS.                                       03850002
038600                                                                  03860002
038700     DISPLAY '                     '.                             03870002
038800     DISPLAY '** ABEND           **'.                             03880002
038900     DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.          03890002
039000     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        03900002
039100     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG.         03910002
039200     DISPLAY '** RETURN CODE     ** = ' PV-RET-CODE.              03920002
039300                                                                  03930002
039400     CALL 'ILBOABN0' USING ABEND-CODE.                            03940002
039500                                                                  03950002
039600                                                                  03960002
039700******************************************************************03970002
039800* ABEND THE PROGRAM IN THE EVENT THAT A SQL ERROR OR WARNING      03980002
039900* CODE OCCURS.                                                    03990002
040000******************************************************************04000002
040100 Z200-SQL-ABEND.                                                  04010002
040200                                                                  04020002
040300     PERFORM Z999-CONTROLS.                                       04030002
040400                                                                  04040002
040500     DISPLAY '** ABEND     **'.                                   04050002
040600     DISPLAY '** PROGRAM   ** = ' PC-PROGRAM-NAME.                04060002
040700     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              04070002
040800     DISPLAY '** OPERATION ** = ' PV-DB2-OPER-ATTEMPTED.          04080002
040900                                                                  04090002
041000******************************************************************04100002
041100* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    04110002
041200* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         04120002
041300* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     04130002
041400* FORMAT.                                                         04140002
041500******************************************************************04150002
041600     COPY DPPD004.                                                04160002
041700                                                                  04170002
041800     SET ABEND-4013-DB2-ERROR TO TRUE.                            04180002
041900                                                                  04190002
042000     CALL 'ILBOABN0' USING ABEND-CODE.                            04200002
042100                                                                  04210002
042200                                                                  04220002
042300******************************************************************04230002
042400* PREFORMS TASK TERMINATION PROCESSING                            04240002
042500******************************************************************04250002
042600 Z990-EOJ-ROUTINE.                                                04260002
042700                                                                  04270002
042800     MOVE PC-TRAN-PRES-FUNC-CLOSE TO DP001-FUNC-CODE.             04280002
042900                                                                  04290002
043000     PERFORM X100-BUILD-COMM-AREA-TRAN-PRES.                      04300002
043100                                                                  04310002
043200     PERFORM Z999-CONTROLS.                                       04320002
043300                                                                  04330002
043400                                                                  04340002
043500******************************************************************04350002
043600* DISPLAY CONTROLS FROM THE PROGRAM                               04360002
043700******************************************************************04370002
043800 Z999-CONTROLS.                                                   04380002
043900                                                                  04390002
044000     MOVE FUNCTION CURRENT-DATE TO SYS-DATE-TIME.                 04400002
044100                                                                  04410002
044200     MOVE SYS-TIME (1:2) TO ST-END-HR.                            04420002
044300     MOVE SYS-TIME (3:2) TO ST-END-MN.                            04430002
044400                                                                  04440002
044500     DISPLAY '                    '.                              04450002
044600     DISPLAY '**********************'.                            04460002
044700     DISPLAY '   DFKUP001 CONTROLS  '.                            04470002
044800     DISPLAY '**********************'.                            04480002
044900     DISPLAY 'RUN DATE  = ' SD-EDIT-DATE.                         04490002
045000     DISPLAY 'BEG TIME  = ' ST-BEG-TIME.                          04500002
045100     DISPLAY 'END TIME  = ' ST-END-TIME.                          04510002
045200     DISPLAY '======================'.                            04520002
045300     DISPLAY 'RECORDS READ   = ' PA-READ.                         04530002
045400     DISPLAY 'CHECKPOINTS    = ' PA-CKPT.                         04540002
045500     DISPLAY '                '.                                  04550002
045600     DISPLAY 'ROWS UPDATE  = ' PA-ROWS-UPDATE.                    04560002
045700     DISPLAY '                '.                                  04570002
045800                                                                  04580002
045900******************************************************************04590002
046000* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    04600002
046100* MENTS THAT ARE REQUIRED TO INVOKE THE TRANSACTION PRESENTATION  04610002
046200* MODULE (DPKUT901) OF THE DB2 CHECKPOINT RESTART SYSTEM.         04620002
046300******************************************************************04630002
046400     COPY DPPD001.                                                04640002
046500                                                                  04650002
046600                                                                  04660002
