000100 TITLE 'VENDOR UCC128 VIOLATION REPORT'.                          00010039
******* CHECKED OUT BY DAVID WELLER (TKMA602) ON 12/3/2013              00011039
000200 IDENTIFICATION DIVISION.                                         00012039
000300                                                                  00013039
000400 PROGRAM-ID.             SUKRP030.                                00014039
000500 AUTHOR.                 DENNIS STEFFEN.                          00015039
000600 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00016039
000700 DATE-WRITTEN            MARCH, 2002.                             00017039
000800 DATE-COMPILED.                                                   00018039
000900*                                                                 00019039
001000 ENVIRONMENT DIVISION.                                            00020039
001100                                                                  00030039
001200 CONFIGURATION SECTION.                                           00040039
001300                                                                  00050039
001400 SOURCE-COMPUTER.        IBM-3090.                                00060039
001500 OBJECT-COMPUTER.        IBM-3090.                                00070039
001600                                                                  00080039
001700 INPUT-OUTPUT SECTION.                                            00090039
001800                                                                  00100039
001900 FILE-CONTROL.                                                    00110039
002000     SELECT VIOLATION-EXTRACT-FILE                                00120039
002100         ASSIGN TO INP01.                                         00130039
002200                                                                  00140039
002300     SELECT REPORT-FILE                                           00150039
002400         ASSIGN TO RPT01.                                         00160039
002500                                                                  00170039
002600 DATA DIVISION.                                                   00180039
002700                                                                  00190039
002800 FILE SECTION.                                                    00200039
002900 FD  VIOLATION-EXTRACT-FILE                                       00210039
003000     LABEL RECORDS ARE STANDARD                                   00220039
003100     RECORDING MODE IS F                                          00230039
003200     BLOCK CONTAINS 0 RECORDS                                     00240039
003300     RECORD CONTAINS 150 CHARACTERS.                              00250039
003400 01  VIOLATION-EXTRACT-RECORD         PIC X(150).                 00260039
003500                                                                  00270039
003600 FD  REPORT-FILE                                                  00280039
003700     RECORDING MODE IS F                                          00290039
003800     LABEL RECORDS ARE STANDARD                                   00300039
003900     BLOCK CONTAINS 0 RECORDS.                                    00310039
004000 01  REPORT-RECORD                   PIC X(200).                  00320039
004100*                                                                 00330039
004200*                                                                 00340039
004300 WORKING-STORAGE SECTION.                                         00350039
004400 01  PROGRAM-SWITCHES.                                            00360039
004500                                                                  00370039
004600*    THESE SWITCHES SIGNAL WHEN END-OF-FILE IS REACHED            00380039
004700     05  PS-EOF-EXTRACT-SW            PIC X(01) VALUE 'N'.        00390039
004800         88  PS-EOF-EXTRACT                     VALUE 'Y'.        00400039
004900     05  PS-NO-DATA-SW                PIC X(01) VALUE 'Y'.        00410039
005000         88  PS-NO-DATA                         VALUE 'N'.        00420039
005100                                                                  00430039
005200*    CONTROLS PRINTING OF SUBHEADER RATHER THAN DETAIL LINE       00440039
005300     05  PS-SUBHEADER-SW              PIC X(01) VALUE 'N'.        00450039
005400         88  PS-PRINT-SUBHEADER                 VALUE 'Y'.        00460039
005500         88  PS-DONT-PRINT-SUBHEADER            VALUE 'N'.        00470039
005600*    CONTROLS PRINTING OF 'VENDOR TOTAL:'                         00480039
005700     05  PS-SUBTOTAL-SW               PIC X(01) VALUE 'N'.        00490039
005800         88  PS-PRINT-VEND-TOTAL                  VALUE 'Y'.      00500039
005900         88  PS-DONT-PRINT-VEND-TOTAL             VALUE 'N'.      00510039
006000                                                                  00520039
006100/                                                                 00530039
006200 01  PV-CURR-KEY.                                                 00540039
006300     05  PV-CURR-VENDOR-KEY.                                      00550039
006400         10 PV-CURR-VEND-SALES-RANK   PIC 9(04) VALUE ZERO.       00560039
006500         10 PV-CURR-VENDOR-ID         PIC 9(09) VALUE ZERO.       00570039
006600     05  PV-CURR-PKGNG-TYPE           PIC X(02) VALUE SPACES.     00580039
006700     05  PV-CURR-VEND-AUDIT-RANK      PIC X(06) VALUE ZERO.       00590039
006800 01  PV-PREV-KEY.                                                 00600039
006900     05  PV-PREV-VENDOR-KEY.                                      00610039
007000         10 PV-PREV-VEND-SALES-RANK   PIC 9(04) VALUE ZERO.       00620039
007100         10 PV-PREV-VENDOR-ID         PIC 9(09) VALUE ZERO.       00630039
007200     05  PV-PREV-PKGNG-TYPE           PIC X(02) VALUE SPACES.     00640039
007300     05  PV-PREV-VEND-AUDIT-RANK      PIC X(06) VALUE ZERO.       00650039
007400/                                                                 00660039
007500 01  PV-PROGRAM-VARIABLES.                                        00670039
007600     05  PV-PAGE-COUNT               PIC S9(04)   VALUE ZERO      00680039
007700                                                  COMP-3.         00690039
007800     05  PV-LINE-COUNT               PIC S9(03)   VALUE ZERO      00700039
007900                                                  COMP-3.         00710039
008000     05  PV-READ-COUNT               PIC S9(09)   VALUE ZERO      00720039
008100                                                  COMP-3.         00730039
008200     05  PV-DISP-COUNT                PIC ZZZ,ZZZ,ZZ9.            00740039
008300                                                                  00750039
008400     05  PV-TIMESTAMP                PIC X(26) VALUE SPACES.      00760039
008500     05  PV-DB2-FUNCTION             PIC X(30) VALUE SPACE.       00770039
008600     05  PV-PARAGRAPH-NAME           PIC X(30) VALUE SPACE.       00780039
008700     05  PV-ERROR-MESSAGE-1          PIC X(50) VALUE SPACE.       00790039
008800     05  PV-ERROR-MESSAGE-2          PIC X(50) VALUE SPACE.       00800039
008900                                                                  00810039
009000     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     00820039
009100                                                   COMP SYNC.     00830039
009200     05  PV-ABEND-PARA-NAME          PIC X(30)     VALUE SPACES.  00840039
009300     05  PV-DB2-OPERATION-MSG-1      PIC X(40)     VALUE SPACES.  00850039
009400     05  PV-DB2-OPERATION-MSG-2      PIC X(40)     VALUE SPACES.  00860039
009500     05  PV-DB2-TABLE-NAME           PIC X(12)     VALUE SPACES.  00870039
009600     05  PV-PERCENT                   PIC S9(4)V99   COMP-3       00880039
009700                                                     VALUE ZERO.  00890039
009710     05  PV-PERCENT-WORK              PIC S9(4)V99   COMP-3       00900039
009720                                                     VALUE ZERO.  00910039
009800     05  PV-AUD-CRTN-QTY-COMPLT       PIC S9(9) COMP VALUE ZERO.  00920039
009900     05  PV-AUD-UNIT-QTY-COMPLT       PIC S9(9) COMP VALUE ZERO.  00930039
010000     05  PV-UNITS-PER-HOUR            PIC S9(6)V99                00940039
010100                                                COMP VALUE ZERO.  00950039
010200     05  PV-SAVE-VENDOR-RANK          PIC X(6) VALUE SPACES.      00960039
010300     05  PV-SAVE-PKGNG-TYPE           PIC X(2) VALUE SPACES.      00970039
010400                                                                  00980039
010500     05  PV-NUMERIC-3                 PIC Z(02)9 VALUE ZEROES.    00990039
010600     05  PV-NUMERIC-4                 PIC Z(03)9 VALUE ZEROES.    01000039
010700     05  PV-NUMERIC-5                 PIC Z(04)9 VALUE ZEROES.    01010039
010800     05  PV-NUMERIC-6                 PIC Z(05)9 VALUE ZEROES.    01020039
010900     05  PV-NUMERIC-7                 PIC Z(06)9 VALUE ZEROES.    01030039
011000     05  PV-NUMERIC-8                 PIC Z(07)9 VALUE ZEROES.    01040039
011100     05  PV-NUMERIC-9                 PIC Z(08)9 VALUE ZEROES.    01050039
011200     05  PV-NUMERIC-10                PIC Z(09)9 VALUE ZEROES.    01060039
011300                                                                  01070039
011400                                                                  01080039
011500 01  PC-CONSTANTS.                                                01090039
011600     05  PC-MAX-RETRIES          PIC S9(4)     COMP SYNC VALUE +2.01100039
011700                                                                  01110039
011800     05  PC-END-OF-PAGE              PIC S9(3) COMP-3 VALUE +66.  01120039
011810     05  PC-VNDR-MIN-LINES           PIC S9(3) COMP-3 VALUE +60.  01130039
011900     05  PC-SLASH                    PIC  X(01)    VALUE '/'.     01140039
012000     05  PC-SPACE                    PIC  X(01)    VALUE ' '.     01150039
012100     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          01160039
012200         'SUKRP030'.                                              01170039
012300     05  PC-REPORT-NBR               PIC  9(01)    VALUE 1.       01180039
012400                                                                  01190039
012500                                                                  01200039
012600     05 ABEND-CODE                    PIC S9(04) VALUE ZERO       01210039
012700                                                 COMP SYNC.       01220039
012800     88  ABEND-4013-DB2-ERROR                    VALUE +4013.     01230039
012900                                                                  01240039
013000                                                                  01250039
013100     05  PV-TODAYS-DATE.                                          01260039
013200         10  PV-TODAYS-DATE-CCYY     PIC  9(04)    VALUE ZEROS.   01270039
013300         10  PV-TODAYS-DATE-MM       PIC  9(02)    VALUE ZEROS.   01280039
013400         10  PV-TODAYS-DATE-DD       PIC  9(02)    VALUE ZEROS.   01290039
013500     05  PV-TODAYS-TIME.                                          01300039
013600         10  PV-TODAYS-TIME-HH       PIC  9(02)    VALUE ZEROS.   01310039
013700         10  PV-TODAYS-TIME-MM       PIC  9(02)    VALUE ZEROS.   01320039
013800         10  PV-TODAYS-TIME-SS       PIC  9(02)    VALUE ZEROS.   01330039
013900         10  FILLER                  PIC  9(02)    VALUE ZEROS.   01340039
014000     05  PV-FORMAT-DATE.                                          01350039
014100         10  PV-FORMAT-DATE-MM       PIC  X(02)    VALUE SPACES.  01360039
014200         10  FILLER                  PIC  X(01)    VALUE '/'.     01370039
014300         10  PV-FORMAT-DATE-DD       PIC  X(02)    VALUE SPACES.  01380039
014400         10  FILLER                  PIC  X(01)    VALUE '/'.     01390039
014500         10  PV-FORMAT-DATE-YYYY     PIC  X(04)    VALUE SPACES.  01400039
014600                                                                  01410039
014700*                                                                 01420039
014800 01  WS-BATCH-PROC-DATE.                                          01430039
014900     05  WS-BATCH-PROC-CC            PIC X(02)     VALUE SPACE.   01440039
015000     05  WS-BATCH-PROC-YY            PIC X(02)     VALUE SPACE.   01450039
015100     05  FILLER                      PIC X(01)     VALUE SPACE.   01460039
015200     05  WS-BATCH-PROC-MM            PIC X(02)     VALUE SPACE.   01470039
015300     05  FILLER                      PIC X(01)     VALUE SPACE.   01480039
015400     05  WS-BATCH-PROC-DD            PIC X(02)     VALUE SPACE.   01490039
015500                                                                  01500039
015600 01 WS-CALC-FIELDS.                                               01510039
015700    05  WS-RECORDS-READ-QTY          PIC S9(07)    COMP-3         01520039
015800                                                   VALUE ZEROS.   01530039
015900    05  WS-RECORDS-WRITE-QTY         PIC S9(07)    COMP-3         01540039
016000                                                   VALUE ZEROS.   01550039
016100 01  PV-ABEND-FIELDS.                                             01560039
016200     05  PV-ABEND-PROGRAM             PIC X(8)   VALUE 'SUKRP030'.01570039
016300     05  PV-ABEND-PARAGRAPH           PIC X(50)  VALUE SPACES.    01580039
016400     05  PV-ABEND-OPERATION           PIC X(50)  VALUE SPACES.    01590039
016500     05  PV-ABEND-STRUCTURE-1         PIC X(8)   VALUE SPACES.    01600039
016600     05  PV-ABEND-STRUCTURE-2         PIC X(8)   VALUE SPACES.    01610039
016700     05  PV-ABEND-STRUCTURE-3         PIC X(8)   VALUE SPACES.    01620039
016800     05  PV-ABEND-STATUS              PIC XX     VALUE SPACES.    01630039
016900     05  PV-DB2-OPERATION-MESSAGE-1   PIC  X(79) VALUE SPACES.    01640039
017000     05  PV-DB2-OPERATION-MESSAGE-2   PIC  X(79) VALUE SPACES.    01650039
017100     05  PV-DB2-OPERATION-MESSAGE-3   PIC  X(79) VALUE SPACES.    01660039
017200     05  PV-DB2-OPERATION-MESSAGE-4   PIC  X(79) VALUE SPACES.    01670039
017300                                                                  01680039
017400/                                                                 01690039
017500*    DATE CONTROL CARD                                            01700039
017600     COPY SURD032.                                                01710039
017700                                                                  01720039
017800*  VENDOR SUMMARY RECORD                                          01730039
017900     COPY SURD034.                                                01740039
018000/                                                                 01750039
00067 *                                                                 01760039
00068 *  STANDARD REPORT HEADER FOR 200 COLUMN REPORT                   01770039
00069 *                                                                 01780039
00070      COPY DPWS200O.                                               01790039
018100*STANDARD REPORT HEADER FOR 132 COLUMN REPORT                     01800039
018200*    COPY DPWS132.                                                01810039
018300                                                                  01820039
018400*MAIN HEADINGS                                                    01830039
018500 01  HEADING-LINE1.                                               01840039
018600     05  FILLER                  PIC  X(51)    VALUE SPACE.       01850039
018700     05  FILLER                  PIC  X(30)    VALUE              01860039
018800         'VENDOR UCC128 VIOLATION REPORT'.                        01870039
018900     05  FILLER                  PIC  X(51)    VALUE SPACE.       01880039
019000                                                                  01890039
019100 01  HEADING-LINE2.                                               01900039
019200     05  FILLER                  PIC  X(54)    VALUE SPACE.       01910039
019300*        (SUCH AS 'WEEK', 'MONTH', 'YEAR')                        01920039
019400     05  HL2-PERIOD-TYPE         PIC  X(07)    VALUE              01930039
019500         '  WEEK '.                                               01940039
019600     05  FILLER                  PIC  X(07)    VALUE              01950039
019700         'ENDING '.                                               01960039
019800     05  HL2-WEEK-ENDING-DATE    PIC X(10)     VALUE SPACES.      01970039
019900     05  FILLER                  PIC  X(54)    VALUE SPACE.       01980039
020000                                                                  01990039
020100 01  HEADING-LINE3.                                               02000039
020200     05  FILLER                  PIC  X(17)    VALUE              02010039
020300         'RANK  VENDOR NAME'.                                     02020039
020400     05  FILLER                  PIC  X(115)   VALUE SPACE.       02030039
020500                                                                  02040039
020600 01  HEADING-LINE4.                                               02050039
020700     05  FILLER                  PIC  X(16)    VALUE              02060039
020800         'PACK TYPE/RATING'.                                      02070039
020900     05  FILLER                  PIC  X(116)   VALUE SPACE.       02080039
021000                                                                  02090039
021100 01  HEADING-LINE5.                                               02100039
021200     05  FILLER                  PIC  X(24)    VALUE              02110039
021300         ' CARTONS (PICKING ONLY) '.                              02120039
021400     05  FILLER                  PIC  X(33)    VALUE              02130040
021500         '   -------------------------UNIT '.                     02140040
021400     05  FILLER                  PIC  X(32)    VALUE              02150040
021500         'ERRORS--------------------------'.                      02151040
021600     05  FILLER                  PIC  X(26)    VALUE              02152040
021700         '    ---------PACK-------- '.                            02153040
021800     05  FILLER                  PIC  X(23)    VALUE              02154040
021900         '  ------#  AUDITS----- '.                               02155040
022000     05  FILLER                  PIC  X(13)    VALUE              02156040
022100         ' --------# PO'.                                         02157040
022200     05  FILLER                  PIC  X(01)    VALUE QUOTE.       02158039
022300     05  FILLER                  PIC  X(10)    VALUE              02159040
022400         'S-------  '.                                            02160040
022500     05  FILLER                  PIC  X(21)    VALUE              02170040
022600         '--------# REC--------'.                                 02180040
022700                                                                  02190039
022800 01  HEADING-LINE6.                                               02200039
022900     05  FILLER                  PIC  X(24)    VALUE              02210039
023000        '    QTY     QTY W/     '.                                02220039
022900     05  FILLER                  PIC  X(41)    VALUE              02230039
023000        '   QC UNITS  RFID UNITS      ----------- '.              02240039
023100     05  FILLER                  PIC  X(44)    VALUE              02250039
023200         'ERROR TYPES ------------      PACKS     PACK'.          02260039
023300     05  FILLER                  PIC  X(38)    VALUE              02270040
023400         '         TOTAL    QTY          QTY    '.                02280040
023500     05  FILLER                  PIC  X(34)   VALUE               02290040
023600         '  QTY W/        QTY      QTY W/   '.                    02300040
023700                                                                  02310039
023800 01  HEADING-LINE7.                                               02320039
023900     05  FILLER                  PIC  X(48)    VALUE              02330039
024000         '  AUDITED   ERRORS    %     AUDITED     AUDITED '.      02340039
024100     05  FILLER                  PIC  X(41)    VALUE              02350039
024200         '     PICK    %     TICK    %    RFID    %'.             02360039
024100     05  FILLER                  PIC  X(20)    VALUE              02370039
024200         '    AUDITED   ERRORS'.                                  02380039
024300     05  FILLER                  PIC  X(46)    VALUE              02390039
024400         '    %   AUDITS   FAILED    %  AUDITED   ERRORS'.        02400039
024500     05  FILLER                  PIC  X(28)    VALUE              02410039
024600         '    %  AUDITED   ERRORS    %'.                          02420039
024700                                                                  02430039
024800 01  VENDOR-LINE.                                                 02440039
024900     05  VL-VENDOR-SALES-RANK         PIC ZZZ9.                   02450039
025000     05  FILLER                       PIC X(02) VALUE SPACES.     02460039
025100     05  VL-VENDOR-NAME               PIC X(30) VALUE SPACES.     02470039
025200                                                                  02480039
025300                                                                  02490039
025400 01  SUBHEADING-LINE1.                                            02500039
025500     05  SH1-PKGNG-TYPE          PIC  X(17)    VALUE SPACES.      02510039
025600         88  SH1-BULK-CASEPACK                 VALUE              02520039
025700             '** BULK/CASEPACK:'.                                 02530039
025800         88  SH1-PREPACK                       VALUE              02540039
025900             '** PREPACK:      '.                                 02550039
026000         88  SH1-PACK-BY-STORE                 VALUE              02560039
026100             '** PACK BY STORE:'.                                 02570039
026000         88  SH1-RFID                          VALUE              02580039
026100             '** RFID:         '.                                 02590040
026200         88  SH1-VEND-TOTALS                   VALUE              02600039
026300             '** VENDOR TOTAL: '.                                 02610039
026400     05  FILLER                  PIC  X(005)   VALUE SPACES.      02620039
026500     05  SH1-VEND-AUDIT-RANKING  PIC  X(06)    VALUE SPACES.      02630039
026600     05  FILLER                  PIC  X(104)   VALUE SPACES.      02640039
026700                                                                  02650039
026800 01  DETAIL-LINES.                                                02660039
026900     05  DL-LINE1.                                                02670039
027000         10  FILLER                   PIC X(02) VALUE SPACES.     02680039
027100         10  DL1-PICK-CTNS-AUDITED    PIC Z(06)9.                 02690039
027200         10  FILLER                   PIC X(03) VALUE SPACES.     02700039
027300         10  DL1-PICK-CTNS-ERRORS     PIC X(06).                  02710039
027400         10  FILLER                   PIC X(02) VALUE SPACES.     02720039
027500         10  DL1-PICK-CTNS-ERR-PCT    PIC X(03).                  02730039
027600         10  FILLER                   PIC X(03) VALUE SPACES.     02740039
027700                                                                  02750039
027800         10  DL1-QC-UNITS-AUDITED     PIC Z(08)9.                 02760039
027900         10  FILLER                   PIC X(03) VALUE SPACES.     02770039
027800         10  DL1-RFID-UNITS-AUDITED   PIC Z(08)9.                 02780039
027900         10  FILLER                   PIC X(04) VALUE SPACES.     02790039
028000         10  DL1-UNIT-PICK-ERRORS     PIC X(06).                  02800039
028100         10  FILLER                   PIC X(02) VALUE SPACES.     02810040
028200         10  DL1-UNIT-PICK-ERR-PCT    PIC X(03).                  02820039
028300         10  FILLER                   PIC X(03) VALUE SPACES.     02830040
028400         10  DL1-UNIT-TICK-ERRORS     PIC X(06).                  02840039
028500         10  FILLER                   PIC X(02) VALUE SPACES.     02850040
028600         10  DL1-UNIT-TICK-ERR-PCT    PIC X(03).                  02860039
028700         10  FILLER                   PIC X(02) VALUE SPACES.     02870040
028400         10  DL1-UNIT-RFID-ERRORS     PIC X(06).                  02871039
028500         10  FILLER                   PIC X(02) VALUE SPACES.     02872040
028600         10  DL1-UNIT-RFID-ERR-PCT    PIC X(03).                  02873039
028700         10  FILLER                   PIC X(03) VALUE SPACES.     02874040
028800                                                                  02875039
028900         10  DL1-PACKS-AUDITED        PIC Z(07)9.                 02876039
029000         10  FILLER                   PIC X(03) VALUE SPACES.     02877040
029100         10  DL1-PACK-ERRORS          PIC X(06).                  02878039
029200         10  FILLER                   PIC X(02) VALUE SPACES.     02879039
029300         10  DL1-PACK-AUD-ERR-PCT     PIC X(03).                  02880039
029400         10  FILLER                   PIC X(03) VALUE SPACES.     02890040
029500                                                                  02900039
029600         10  DL1-TOTAL-AUDITS         PIC Z(06).                  02910039
029700         10  FILLER                   PIC X(03) VALUE SPACES.     02920040
029800         10  DL1-AUDITS-FAILED        PIC X(06).                  02930039
029900         10  FILLER                   PIC X(02) VALUE SPACES.     02940040
030000         10  DL1-AUDIT-FAIL-PCT       PIC X(03).                  02950039
030100         10  FILLER                   PIC X(03) VALUE SPACES.     02960040
030200                                                                  02970039
030300         10  DL1-PO-AUDITS            PIC Z(5)9.                  02980040
030400         10  FILLER                   PIC X(03) VALUE SPACES.     02990040
030500         10  DL1-PO-AUDIT-ERRORS      PIC X(06).                  03000039
030600         10  FILLER                   PIC X(02) VALUE SPACES.     03010040
030700         10  DL1-PO-AUDIT-ERR-PCT     PIC X(03).                  03020039
030800         10  FILLER                   PIC X(03) VALUE SPACES.     03030040
030900                                                                  03040039
031000         10  DL1-REC-AUDITS           PIC Z(5)9.                  03050040
031100         10  FILLER                   PIC X(03) VALUE SPACES.     03060040
031200         10  DL1-REC-AUDIT-ERRORS     PIC X(06).                  03070039
031300         10  FILLER                   PIC X(02) VALUE SPACES.     03080040
031400         10  DL1-REC-AUDIT-ERR-PCT    PIC X(03).                  03090039
031500                                                                  03100039
031600 01  TOTAL-LINES.                                                 03110039
031700                                                                  03120039
031800     05  TL-LINE1.                                                03130039
031900         10  FILLER                   PIC X(01) VALUE SPACES.     03140039
032000         10  TL1-PICK-CTNS-AUDITED    PIC Z(08).                  03150039
031900         10  FILLER                   PIC X(02) VALUE SPACES.     03160039
034900         10  TL1-PICK-CTNS-ERRORS     PIC X(07).                  03170039
032100         10  FILLER                   PIC X(02) VALUE SPACES.     03180039
032200         10  TL1-PICK-CTNS-ERR-PCT    PIC X(03).                  03190039
032300         10  FILLER                   PIC X(02) VALUE SPACES.     03200039
032400                                                                  03210039
035200         10  TL1-QC-UNITS-AUDITED     PIC Z(10).                  03220039
032500         10  FILLER                   PIC X(02) VALUE SPACES.     03230039
035200         10  TL1-RFID-UNITS-AUDITED   PIC Z(9)9.                  03240040
035300         10  FILLER                   PIC X(02) VALUE SPACES.     03250039
032600         10  TL1-UNIT-PICK-ERRORS     PIC X(08).                  03260039
035300         10  FILLER                   PIC X(02) VALUE SPACES.     03260139
035400         10  TL1-UNIT-PICK-ERR-PCT    PIC X(03).                  03260239
032700         10  FILLER                   PIC X(02) VALUE SPACES.     03260339
032800         10  TL1-UNIT-TICK-ERRORS     PIC X(07).                  03260439
035300         10  FILLER                   PIC X(02) VALUE SPACES.     03260539
035600         10  TL1-UNIT-TICK-ERR-PCT    PIC X(03).                  03260639
033000                                                                  03260739
032500         10  FILLER                   PIC X(02) VALUE SPACES.     03260839
032600         10  TL1-UNIT-RFID-ERRORS     PIC X(06).                  03260939
032900         10  FILLER                   PIC X(02) VALUE SPACES.     03261039
035600         10  TL1-UNIT-RFID-ERR-PCT    PIC X(03).                  03262039
035700         10  FILLER                   PIC X(02) VALUE SPACES.     03263039
033000                                                                  03264039
033100         10  TL1-PACKS-AUDITED        PIC Z(08)9.                 03265039
033200         10  FILLER                   PIC X(02) VALUE SPACES.     03266039
035900         10  TL1-PACK-ERRORS          PIC X(07).                  03267039
036000         10  FILLER                   PIC X(02) VALUE SPACES.     03268039
033300         10  TL1-PACK-AUD-ERR-PCT     PIC X(03).                  03269039
033400         10  FILLER                   PIC X(02) VALUE SPACES.     03270039
033500                                                                  03280039
036200         10  TL1-TOTAL-AUDITS         PIC Z(07).                  03290039
033700         10  FILLER                   PIC X(02) VALUE SPACES.     03300039
033600         10  TL1-AUDITS-FAILED        PIC X(07).                  03310039
033700         10  FILLER                   PIC X(02) VALUE SPACES.     03320039
036400         10  TL1-AUDIT-FAIL-PCT       PIC X(03).                  03330039
033700         10  FILLER                   PIC X(02) VALUE SPACES.     03340039
033800                                                                  03350039
033900         10  TL1-PO-AUDITS            PIC Z(07).                  03360039
 34000         10  FILLER                   PIC X(02) VALUE SPACES.     03370039
036700         10  TL1-PO-AUDIT-ERRORS      PIC X(07).                  03380039
 34000         10  FILLER                   PIC X(02) VALUE SPACES.     03390039
034100         10  TL1-PO-AUDIT-ERR-PCT     PIC X(03).                  03400039
034200         10  FILLER                   PIC X(02) VALUE SPACES.     03410039
034300                                                                  03420039
037000         10  TL1-REC-AUDITS           PIC Z(07).                  03430039
034200         10  FILLER                   PIC X(02) VALUE SPACES.     03431039
034400         10  TL1-REC-AUDIT-ERRORS     PIC X(07).                  03432039
034500         10  FILLER                   PIC X(02) VALUE SPACES.     03433039
037200         10  TL1-REC-AUDIT-ERR-PCT    PIC X(03).                  03434039
037300                                                                  03435039
037400 01  MISCELLANEOUS-LINES.                                         03436039
037500     05  END-OF-REPORT-LINE.                                      03437039
037600         10  FILLER                  PIC  X(44)    VALUE SPACES.  03438039
037700         10  FILLER                  PIC  X(45)    VALUE          03439039
037800             '*******   E N D   O F   R E P O R T   *******'.     03440039
037900         10  FILLER                  PIC  X(43)    VALUE SPACES.  03450039
038000     05  NO-DATA-TO-REPORT-LINE.                                  03460039
038100         10  FILLER                  PIC  X(40)    VALUE SPACES.  03470039
038200         10  FILLER                  PIC  X(52)    VALUE          03480039
038300         '*******  N O   D A T A   T O   R E P O R T   *******'.  03490039
038400         10  FILLER                  PIC  X(40)    VALUE SPACES.  03500039
038500     05  BL-BLANK-LINE               PIC X(132)    VALUE SPACE.   03510039
038600                                                                  03520039
038700                                                                  03530039
038800/                                                                 03540039
038900*    OCCURRENCE 1 IS FOR EACH DETAIL LINE                         03550039
039000*    OCCURRENCE 2 IS FOR THE WHOLE VENDOR                         03560039
039100*                                                                 03570039
039200 01  PT-TOTALS-TABLE.                                             03580039
039300     05  PT-TOTALS OCCURS 2 TIMES INDEXED BY PT-IDX.              03590039
039400         10 PT-CRTNS-AUDITED          PIC S9(9) COMP-3.           03600039
039500         10 PT-CRTNS-W-PICK-ERR       PIC S9(9) COMP-3.           03610039
039600         10 PT-QC-UNITS-AUDITED       PIC S9(9) COMP-3.           03620039
039600         10 PT-RFID-UNITS-AUDITED     PIC S9(9) COMP-3.           03630039
039700         10 PT-UNITS-PICK-ERR         PIC S9(9) COMP-3.           03640039
039800         10 PT-UNITS-TICK-ERR         PIC S9(9) COMP-3.           03650039
039800         10 PT-UNITS-RFID-ERR         PIC S9(9) COMP-3.           03660039
039900         10 PT-PACKS-AUDITED          PIC S9(9) COMP-3.           03670039
040000         10 PT-PACKS-W-PACK-ERR       PIC S9(9) COMP-3.           03680039
040100         10 PT-TOTAL-NBR-AUDITS       PIC S9(9) COMP-3.           03690039
040200         10 PT-TOTAL-FAILED-AUDITS    PIC S9(9) COMP-3.           03700039
040300         10 PT-TOTAL-NBR-PO           PIC S9(9) COMP-3.           03710039
040400         10 PT-TOTAL-NBR-PO-FAIL      PIC S9(9) COMP-3.           03720039
040500         10 PT-TOTAL-NBR-RCVR         PIC S9(9) COMP-3.           03730039
040600         10 PT-TOTAL-NBR-RCVR-FAIL    PIC S9(9) COMP-3.           03740039
040700                                                                  03750039
040800     COPY DPWS004.                                                03760039
040900                                                                  03770039
041000     EXEC SQL                                                     03780039
041100          INCLUDE SQLCA                                           03790039
041200     END-EXEC.                                                    03800039
041300                                                                  03810039
041400     COPY SQLCA2.                                                 03820039
041500/                                                                 03830039
041600 PROCEDURE DIVISION.                                              03840039
041700                                                                  03850039
041800 0000-MAINLINE.                                                   03860039
041900     PERFORM 1000-INITIALIZE.                                     03870039
042000                                                                  03880039
042100     PERFORM 2000-MAIN-PROCESS                                    03890039
042200         UNTIL PS-EOF-EXTRACT                                     03900039
042300                                                                  03910039
042400     PERFORM 9000-END-PROCESS.                                    03920039
042500                                                                  03930039
042600     GOBACK.                                                      03940039
042700/                                                                 03950039
042800 1000-INITIALIZE.                                                 03960039
042900     OPEN INPUT VIOLATION-EXTRACT-FILE                            03970039
043000          OUTPUT REPORT-FILE.                                     03980039
043100                                                                  03990039
043200     EXEC SQL                                                     04000039
043300         SET :PV-TIMESTAMP = CURRENT TIMESTAMP                    04010039
043400     END-EXEC.                                                    04020039
043500                                                                  04030039
043600     ACCEPT PV-TODAYS-DATE FROM DATE YYYYMMDD.                    04040039
043700     ACCEPT PV-TODAYS-TIME FROM TIME.                             04050039
043800                                                                  04060039
043900     MOVE PV-TODAYS-DATE-MM        TO DP200O-RUN-MONTH.           04070039
044000     MOVE PV-TODAYS-DATE-DD        TO DP200O-RUN-DAY.             04080039
044100     MOVE PV-TODAYS-DATE-CCYY      TO DP200O-RUN-YEAR.            04090039
044200     MOVE PV-TODAYS-TIME-HH        TO DP200O-RUN-HOUR.            04100039
044300     MOVE PV-TODAYS-TIME-MM        TO DP200O-RUN-MINUTE.          04110039
044400     MOVE PC-CURRENT-PROGRAM-NAME  TO DP200O-PROGRAM-NAME.        04120039
044500                                                                  04130039
044600     ACCEPT SU032-DATE-CONTROL-REC FROM SYSIN.                    04140039
044700                                                                  04150039
044800     DISPLAY 'CONTROL CARD IS:'                                   04160039
044900     DISPLAY SU032-DATE-CONTROL-REC                               04170039
045000                                                                  04180039
045100     STRING SU032-TO-DATE (6:2) '/'                               04190039
045200            SU032-TO-DATE (9:2) '/'                               04200039
045300            SU032-TO-DATE (1:4)                                   04210039
045400             DELIMITED BY SIZE                                    04220039
045500         INTO HL2-WEEK-ENDING-DATE                                04230039
045600                                                                  04240039
045700     EVALUATE SU032-RPT-TYPE                                      04250039
045800     WHEN 'D'                                                     04260039
045900         MOVE '   DAY '               TO HL2-PERIOD-TYPE          04270039
046000     WHEN 'W'                                                     04280039
046100         MOVE '  WEEK '               TO HL2-PERIOD-TYPE          04290039
046200     WHEN 'M'                                                     04300039
046300         MOVE ' MONTH '               TO HL2-PERIOD-TYPE          04310039
046400     WHEN 'S'                                                     04320039
046500         MOVE 'SEASON '               TO HL2-PERIOD-TYPE          04330039
046600     WHEN 'C'                                                     04340039
046700     WHEN 'F'                                                     04350039
046800         MOVE '  YEAR '               TO HL2-PERIOD-TYPE          04360039
046900     WHEN OTHER                                                   04370039
047000         MOVE '1000-INITIALIZE'       TO PV-PARAGRAPH-NAME        04380039
047100         MOVE 'INVALID REPORT TYPE  ' TO PV-ERROR-MESSAGE-1       04390039
047200         PERFORM 9200-ABEND                                       04400039
047300     END-EVALUATE                                                 04410039
047400                                                                  04420039
047500     PERFORM 8000-READ-VENDOR-EXTRACT.                            04430039
047600                                                                  04440039
047700     PERFORM 8100-PRINT-REPORT-HEADINGS                           04450039
047800                                                                  04460039
047900     IF PS-EOF-EXTRACT                                            04470039
048000         SET PS-NO-DATA               TO TRUE                     04480039
048100         WRITE REPORT-RECORD                                      04490039
048200           FROM NO-DATA-TO-REPORT-LINE                            04500039
048300         AFTER ADVANCING 3 LINE                                   04510039
048400                                                                  04520039
048500     ELSE                                                         04530039
048600                                                                  04540039
048700         MOVE PV-CURR-KEY             TO PV-PREV-KEY              04550039
048800         INITIALIZE PT-TOTALS-TABLE                               04560039
048900         PERFORM 8310-VENDOR-LINE                                 04570039
049000         PERFORM 8300-SUBHEADER                                   04580039
049100     END-IF.                                                      04590039
049200                                                                  04600039
049300/                                                                 04610039
049400 2000-MAIN-PROCESS.                                               04620039
049500                                                                  04630039
049600     EVALUATE TRUE                                                04640039
049700     WHEN PV-CURR-KEY = PV-PREV-KEY                               04650039
049800         PERFORM 2100-ADD-TO-BUCKETS                              04660039
049900     WHEN PV-CURR-KEY > PV-PREV-KEY                               04670039
050000         IF PV-CURR-VENDOR-KEY > PV-PREV-VENDOR-KEY               04680039
050100             PERFORM 3000-VENDOR-BREAK                            04690039
050200             PERFORM 2100-ADD-TO-BUCKETS                          04700039
050300         ELSE                                                     04710039
050400             PERFORM 2200-BUILD-DETAIL-LINE                       04720039
050500             PERFORM 8200-WRITE-DETAIL-LINE                       04730039
050600             INITIALIZE PT-TOTALS (1)                             04740039
050700             PERFORM 8300-SUBHEADER                               04750039
050800             PERFORM 2100-ADD-TO-BUCKETS                          04760039
050900         END-IF                                                   04770039
051000     END-EVALUATE.                                                04780039
051100                                                                  04790039
051200     PERFORM 8000-READ-VENDOR-EXTRACT.                            04800039
051300                                                                  04810039
051400 2100-ADD-TO-BUCKETS.                                             04820039
051500                                                                  04830039
051600     ADD SU034-CRTNS-AUDITED          TO PT-CRTNS-AUDITED(1)      04840039
051700                                         PT-CRTNS-AUDITED(2)      04850039
051800                                                                  04860039
051900     ADD SU034-CRTNS-W-PICK-ERR       TO PT-CRTNS-W-PICK-ERR(1)   04870039
052000                                         PT-CRTNS-W-PICK-ERR(2)   04880039
052100                                                                  04890039
           IF SU034-RFID                                                04900039
052200         ADD SU034-UNITS-AUDITED      TO PT-RFID-UNITS-AUDITED(1) 04910039
052300                                         PT-RFID-UNITS-AUDITED(2) 04920039
           ELSE                                                         04930039
052200         ADD SU034-UNITS-AUDITED      TO PT-QC-UNITS-AUDITED(1)   04940039
052300                                         PT-QC-UNITS-AUDITED(2)   04950039
           END-IF                                                       04960039
052400                                                                  04970039
052500     ADD SU034-UNITS-PICK-ERR         TO PT-UNITS-PICK-ERR(1)     04980039
052600                                         PT-UNITS-PICK-ERR(2)     04990039
052700                                                                  05000039
           IF SU034-RFID                                                05010039
052800         ADD SU034-UNITS-TICK-ERR     TO PT-UNITS-RFID-ERR(1)     05020039
052900                                         PT-UNITS-RFID-ERR(2)     05030039
           ELSE                                                         05040039
052800         ADD SU034-UNITS-TICK-ERR     TO PT-UNITS-TICK-ERR(1)     05050039
052900                                         PT-UNITS-TICK-ERR(2)     05060039
           END-IF                                                       05070039
053000                                                                  05080039
053100     ADD SU034-PACKS-AUDITED          TO PT-PACKS-AUDITED(1)      05090039
053200                                         PT-PACKS-AUDITED(2)      05100039
053300                                                                  05110039
053400     ADD SU034-PACKS-W-PACK-ERR       TO PT-PACKS-W-PACK-ERR(1)   05120039
053500                                         PT-PACKS-W-PACK-ERR(2)   05130039
053600                                                                  05140039
053700     ADD SU034-TOTAL-NBR-AUDITS       TO PT-TOTAL-NBR-AUDITS(1)   05150039
053800                                         PT-TOTAL-NBR-AUDITS(2)   05160039
053900                                                                  05170039
054000     ADD SU034-TOTAL-FAILED-AUDITS    TO PT-TOTAL-FAILED-AUDITS(1)05180039
054100                                         PT-TOTAL-FAILED-AUDITS(2)05190039
054200                                                                  05200039
054300     ADD SU034-TOTAL-NBR-PO           TO PT-TOTAL-NBR-PO(1)       05210039
054400                                         PT-TOTAL-NBR-PO(2)       05220039
054500                                                                  05230039
054600     ADD SU034-TOTAL-NBR-PO-FAIL      TO PT-TOTAL-NBR-PO-FAIL(1)  05240039
054700                                         PT-TOTAL-NBR-PO-FAIL(2)  05250039
054800                                                                  05260039
054900     ADD SU034-TOTAL-NBR-RCVR         TO PT-TOTAL-NBR-RCVR(1)     05270039
055000                                         PT-TOTAL-NBR-RCVR(2)     05280039
055100                                                                  05290039
055200     ADD SU034-TOTAL-NBR-RCVR-FAIL TO PT-TOTAL-NBR-RCVR-FAIL(1)   05300039
055300                                      PT-TOTAL-NBR-RCVR-FAIL(2).  05310039
055400                                                                  05320039
055500                                                                  05330039
055600 2200-BUILD-DETAIL-LINE.                                          05340039
055700                                                                  05350039
055800     PERFORM 2210-MOVE-AUDIT-FIELDS.                              05360039
055900                                                                  05370039
056000 2210-MOVE-AUDIT-FIELDS.                                          05380039
056100                                                                  05390039
056110*** CARTONS AUDITED QTY / CARTONS AUDITED W ERRORS / ERROR %      05400039
056120                                                                  05410039
056200     MOVE PT-CRTNS-AUDITED (1)        TO DL1-PICK-CTNS-AUDITED    05420039
056300                                                                  05430039
056400     IF  PT-CRTNS-AUDITED (1)  >  0                               05440039
056500         MOVE PT-CRTNS-W-PICK-ERR(1)  TO PV-NUMERIC-6             05450039
056600         MOVE PV-NUMERIC-6            TO DL1-PICK-CTNS-ERRORS     05460039
056700                                                                  05470039
056800         IF  PT-CRTNS-W-PICK-ERR(1)  >  0  AND                    05480039
056810             PT-CRTNS-AUDITED (1)    >  0                         05490039
056900             DIVIDE  PT-CRTNS-W-PICK-ERR(1)                       05500039
057000                 BY  PT-CRTNS-AUDITED (1)                         05510039
057010             GIVING  PV-PERCENT-WORK ROUNDED                      05520039
057020             MULTIPLY PV-PERCENT-WORK  BY  100                    05530039
057040             GIVING   PV-PERCENT                                  05540039
057050             MOVE PV-PERCENT   TO PV-NUMERIC-3                    05550039
057060             MOVE PV-NUMERIC-3 TO DL1-PICK-CTNS-ERR-PCT           05560039
057070         ELSE                                                     05570039
057200             MOVE ZERO         TO PV-NUMERIC-3                    05580039
057300             MOVE PV-NUMERIC-3 TO DL1-PICK-CTNS-ERR-PCT           05590039
057600         END-IF                                                   05600039
057700     ELSE                                                         05610039
057800         MOVE  '     0'               TO DL1-PICK-CTNS-ERRORS     05620039
057900         MOVE  '  0'                  TO DL1-PICK-CTNS-ERR-PCT    05630039
058000     END-IF.                                                      05640039
058100                                                                  05650039
058101*** UNITS AUDITED QTY / UNITS W PICKING ERRORS / ERROR %          05660039
058120                                                                  05670039
058200     MOVE PT-QC-UNITS-AUDITED (1)     TO DL1-QC-UNITS-AUDITED     05680039
058200     MOVE PT-RFID-UNITS-AUDITED (1)   TO DL1-RFID-UNITS-AUDITED   05690039
058210                                                                  05700039
058220     IF  PT-QC-UNITS-AUDITED (1) > 0                              05710039
058300         MOVE PT-UNITS-PICK-ERR (1)   TO PV-NUMERIC-6             05720039
058310         MOVE PV-NUMERIC-6            TO DL1-UNIT-PICK-ERRORS     05730039
058400                                                                  05740039
058410         IF  PT-UNITS-PICK-ERR (1)  >  0  AND                     05750039
058420             PT-QC-UNITS-AUDITED (1) > 0                          05760039
058600             DIVIDE  PT-UNITS-PICK-ERR (1)                        05770039
058700                 BY  PT-QC-UNITS-AUDITED (1)                      05780039
058710             GIVING  PV-PERCENT-WORK ROUNDED                      05790039
058720             MULTIPLY PV-PERCENT-WORK  BY  100                    05800039
058730             GIVING  PV-PERCENT                                   05810039
058740             MOVE PV-PERCENT      TO PV-NUMERIC-3                 05820039
058750             MOVE PV-NUMERIC-3    TO DL1-UNIT-PICK-ERR-PCT        05830039
058800         ELSE                                                     05840039
058900             MOVE ZERO            TO PV-NUMERIC-3                 05850039
058910             MOVE PV-NUMERIC-3    TO DL1-UNIT-PICK-ERR-PCT        05860039
059200         END-IF                                                   05870039
059210     ELSE                                                         05880039
059220         MOVE  '     0'               TO  DL1-UNIT-PICK-ERRORS    05890039
059230         MOVE  '  0'                  TO  DL1-UNIT-PICK-ERR-PCT   05900039
059240     END-IF.                                                      05910039
059300                                                                  05920039
059301***  UNITS W TICKETING ERRORS / ERROR %                           05930039
059320                                                                  05931039
059330     IF  PT-QC-UNITS-AUDITED (1) > 0                              05932039
059400         MOVE PT-UNITS-TICK-ERR(1)    TO PV-NUMERIC-6             05933039
059401         MOVE PV-NUMERIC-6            TO DL1-UNIT-TICK-ERRORS     05934039
059410                                                                  05935039
059420         IF  PT-UNITS-TICK-ERR(1)  >  0  AND                      05936039
059430             PT-QC-UNITS-AUDITED (1) > 0                          05937039
059600             DIVIDE  PT-UNITS-TICK-ERR (1)                        05938039
059700                 BY  PT-QC-UNITS-AUDITED (1)                      05939039
059710             GIVING  PV-PERCENT-WORK  ROUNDED                     05940039
059720             MULTIPLY PV-PERCENT-WORK  BY  100                    05950039
059730             GIVING   PV-PERCENT                                  05960039
059740             MOVE PV-PERCENT   TO PV-NUMERIC-3                    05970039
059750             MOVE PV-NUMERIC-3 TO DL1-UNIT-TICK-ERR-PCT           05971039
059800         ELSE                                                     05972039
059900             MOVE ZERO         TO PV-NUMERIC-3                    05973039
059910             MOVE PV-NUMERIC-3 TO DL1-UNIT-TICK-ERR-PCT           05974039
060210         END-IF                                                   05975039
060240     ELSE                                                         05976039
060250         MOVE  '     0'               TO  DL1-UNIT-TICK-ERRORS    05977039
060260         MOVE  '  0'                  TO  DL1-UNIT-TICK-ERR-PCT   05978039
060270     END-IF.                                                      05979039
060300                                                                  05980039
059301***  UNITS W RFID ERRORS / RFID ERROR %                           05990039
059320                                                                  06000039
059330     IF  PT-RFID-UNITS-AUDITED (1) > 0                            06010039
059400         MOVE PT-UNITS-RFID-ERR(1)    TO PV-NUMERIC-6             06020039
059401         MOVE PV-NUMERIC-6            TO DL1-UNIT-RFID-ERRORS     06030039
059410                                                                  06030139
059420         IF  PT-UNITS-RFID-ERR(1)  >  0  AND                      06030239
059430             PT-RFID-UNITS-AUDITED (1) > 0                        06030339
059600             DIVIDE  PT-UNITS-RFID-ERR (1)                        06030439
059700                 BY  PT-RFID-UNITS-AUDITED (1)                    06030539
059710             GIVING  PV-PERCENT-WORK  ROUNDED                     06030639
059720             MULTIPLY PV-PERCENT-WORK  BY  100                    06030739
059730             GIVING   PV-PERCENT                                  06030839
059740             MOVE PV-PERCENT   TO PV-NUMERIC-3                    06030939
059750             MOVE PV-NUMERIC-3 TO DL1-UNIT-RFID-ERR-PCT           06031039
059800         ELSE                                                     06031139
059900             MOVE ZERO         TO PV-NUMERIC-3                    06031239
059910             MOVE PV-NUMERIC-3 TO DL1-UNIT-RFID-ERR-PCT           06031339
060210         END-IF                                                   06031439
060240     ELSE                                                         06031539
060250         MOVE  '     0'               TO  DL1-UNIT-RFID-ERRORS    06031639
060260         MOVE  '  0'                  TO  DL1-UNIT-RFID-ERR-PCT   06031739
060270     END-IF.                                                      06031839
060300                                                                  06031939
060310***  PACKS AUDITED / PACKS W ERRORS / ERROR %                     06032039
060400                                                                  06033039
060500     MOVE PT-PACKS-AUDITED (1)        TO DL1-PACKS-AUDITED        06034039
060510                                                                  06035039
060520     IF  PT-PACKS-AUDITED (1)  >  0                               06036039
060600         MOVE PT-PACKS-W-PACK-ERR(1)  TO PV-NUMERIC-6             06037039
060610         MOVE PV-NUMERIC-6            TO DL1-PACK-ERRORS          06038039
060620                                                                  06039039
060700         IF  PT-PACKS-W-PACK-ERR(1)  >  0  AND                    06040039
060710             PT-PACKS-AUDITED (1)    >  0                         06050039
060800             DIVIDE  PT-PACKS-W-PACK-ERR(1)                       06060039
060900                 BY  PT-PACKS-AUDITED (1)                         06070039
060910             GIVING  PV-PERCENT-WORK  ROUNDED                     06080039
060920             MULTIPLY PV-PERCENT-WORK  BY  100                    06090039
060930             GIVING   PV-PERCENT                                  06091039
060940             MOVE PV-PERCENT      TO PV-NUMERIC-3                 06092039
060950             MOVE PV-NUMERIC-3    TO DL1-PACK-AUD-ERR-PCT         06093039
061000         ELSE                                                     06094039
061100             MOVE ZERO            TO PV-NUMERIC-3                 06095039
061110             MOVE PV-NUMERIC-3    TO DL1-PACK-AUD-ERR-PCT         06096039
061400         END-IF                                                   06097039
061401     ELSE                                                         06098039
061410         MOVE  '     0'               TO DL1-PACK-ERRORS          06099039
061420         MOVE  '  0'                  TO DL1-PACK-AUD-ERR-PCT     06100039
061430     END-IF.                                                      06110039
061500                                                                  06120039
061501***  TOT # AUDITS / AUDITS W FAILURE ERRORS / ERROR %             06130039
061520                                                                  06140039
061600     MOVE PT-TOTAL-NBR-AUDITS (1)     TO DL1-TOTAL-AUDITS         06150039
061610                                                                  06160039
061620     IF  PT-TOTAL-NBR-AUDITS (1)  >  0                            06161039
061700         MOVE PT-TOTAL-FAILED-AUDITS (1)  TO PV-NUMERIC-6         06162039
061710         MOVE PV-NUMERIC-6                TO DL1-AUDITS-FAILED    06163039
061720                                                                  06164039
061730         IF  PT-TOTAL-FAILED-AUDITS (1)  >  0  AND                06165039
061740             PT-TOTAL-NBR-AUDITS (1)     >  0                     06166039
061900             DIVIDE  PT-TOTAL-FAILED-AUDITS (1)                   06167039
062000                 BY  PT-TOTAL-NBR-AUDITS (1)                      06168039
062010             GIVING  PV-PERCENT-WORK  ROUNDED                     06169039
062020             MULTIPLY PV-PERCENT-WORK  BY  100                    06170039
062030             GIVING   PV-PERCENT                                  06180039
062040             MOVE PV-PERCENT      TO PV-NUMERIC-3                 06190039
062050             MOVE PV-NUMERIC-3    TO DL1-AUDIT-FAIL-PCT           06200039
062100         ELSE                                                     06210039
062200             MOVE ZERO            TO PV-NUMERIC-3                 06220039
062210             MOVE PV-NUMERIC-3    TO DL1-AUDIT-FAIL-PCT           06230039
062500         END-IF                                                   06240039
062510     ELSE                                                         06250039
062520         MOVE  '     0'               TO DL1-AUDITS-FAILED        06251039
062530         MOVE  '  0'                  TO DL1-AUDIT-FAIL-PCT       06252039
062540     END-IF.                                                      06253039
062600                                                                  06254039
062610***  # PO'S AUDITED / PO AUDITS W ERRORS / ERROR %                06255039
062620                                                                  06256039
062700     MOVE PT-TOTAL-NBR-PO (1)         TO DL1-PO-AUDITS            06257039
062710                                                                  06258039
062720     IF  PT-TOTAL-NBR-PO (1)  >  0                                06259039
062800         MOVE PT-TOTAL-NBR-PO-FAIL (1)  TO PV-NUMERIC-6           06260039
062810         MOVE PV-NUMERIC-6              TO DL1-PO-AUDIT-ERRORS    06270039
062900                                                                  06280039
063000         IF  PT-TOTAL-NBR-PO-FAIL (1)  >  0  AND                  06290039
063010             PT-TOTAL-NBR-PO (1)       >  0                       06300039
063100             DIVIDE  PT-TOTAL-NBR-PO-FAIL (1)                     06310039
063200                 BY  PT-TOTAL-NBR-PO (1)                          06320039
063210             GIVING  PV-PERCENT-WORK  ROUNDED                     06321039
063220             MULTIPLY PV-PERCENT-WORK  BY  100                    06322039
063230             GIVING   PV-PERCENT                                  06323039
063240             MOVE PV-PERCENT      TO PV-NUMERIC-3                 06324039
063250             MOVE PV-NUMERIC-3    TO DL1-PO-AUDIT-ERR-PCT         06325039
063300         ELSE                                                     06326039
063400             MOVE ZERO            TO PV-NUMERIC-3                 06327039
063410             MOVE PV-NUMERIC-3    TO DL1-PO-AUDIT-ERR-PCT         06328039
063700         END-IF                                                   06329039
063701     ELSE                                                         06330039
063710         MOVE  '     0'               TO DL1-PO-AUDIT-ERRORS      06340039
063720         MOVE  '  0'                  TO DL1-PO-AUDIT-ERR-PCT     06350039
063730     END-IF.                                                      06360039
063740                                                                  06370039
063741***  # RCVR'S AUDITED / RCVR'S AUDITS W ERRORS / ERROR %          06371039
063800                                                                  06372039
063900     MOVE PT-TOTAL-NBR-RCVR (1)       TO DL1-REC-AUDITS           06373039
063910                                                                  06374039
063920     IF  PT-TOTAL-NBR-RCVR (1)   >  0                             06375039
064000         MOVE PT-TOTAL-NBR-RCVR-FAIL (1) TO PV-NUMERIC-6          06376039
064010         MOVE PV-NUMERIC-6               TO DL1-REC-AUDIT-ERRORS  06377039
064100                                                                  06378039
064200         IF  PT-TOTAL-NBR-RCVR-FAIL (1)  >  0  AND                06379039
064210             PT-TOTAL-NBR-RCVR (1)       >  0                     06380039
064300             DIVIDE  PT-TOTAL-NBR-RCVR-FAIL (1)                   06390039
064400                 BY  PT-TOTAL-NBR-RCVR (1)                        06400039
064410             GIVING  PV-PERCENT-WORK  ROUNDED                     06410039
064420             MULTIPLY PV-PERCENT-WORK BY  100                     06420039
064430             GIVING   PV-PERCENT                                  06430039
064440             MOVE PV-PERCENT      TO PV-NUMERIC-3                 06440039
064450             MOVE PV-NUMERIC-3    TO DL1-REC-AUDIT-ERR-PCT        06441039
064500         ELSE                                                     06442039
064510             MOVE ZERO            TO PV-NUMERIC-3                 06443039
064610             MOVE PV-NUMERIC-3    TO DL1-REC-AUDIT-ERR-PCT        06444039
064900         END-IF                                                   06445039
064910     ELSE                                                         06446039
064920         MOVE  '     0'               TO DL1-REC-AUDIT-ERRORS     06447039
064930         MOVE  '  0'                  TO DL1-REC-AUDIT-ERR-PCT    06448039
064940     END-IF.                                                      06449039
065000                                                                  06450039
065010                                                                  06460039
065100 3000-VENDOR-BREAK.                                               06470039
065200     PERFORM 2200-BUILD-DETAIL-LINE                               06480039
065300     PERFORM 8200-WRITE-DETAIL-LINE.                              06490039
065400     INITIALIZE PT-TOTALS (1)                                     06500039
065500     PERFORM 3100-BUILD-TOTAL-LINES.                              06510039
065600     SET PS-PRINT-VEND-TOTAL          TO TRUE                     06520039
065700     PERFORM 8300-SUBHEADER                                       06530039
065800     PERFORM 3200-PRINT-TOTAL-LINES.                              06540039
065900     MOVE PV-CURR-KEY                 TO PV-PREV-KEY.             06550039
066000     INITIALIZE PT-TOTALS-TABLE.                                  06560039
066001                                                                  06570039
066002     INITIALIZE  REPORT-RECORD                                    06580039
066010         WRITE REPORT-RECORD                                      06590039
066030         AFTER ADVANCING 2 LINES                                  06600039
066040     ADD  2  TO PV-LINE-COUNT.                                    06601039
066050                                                                  06602039
066060     IF  PV-LINE-COUNT  >  PC-VNDR-MIN-LINES                      06603039
066062         PERFORM 8100-PRINT-REPORT-HEADINGS                       06604039
066063     END-IF.                                                      06605039
066064                                                                  06606039
066070                                                                  06607039
066100     PERFORM 8310-VENDOR-LINE.                                    06608039
066200     PERFORM 8300-SUBHEADER.                                      06609039
066300                                                                  06610039
066400 3100-BUILD-TOTAL-LINES.                                          06620039
066410                                                                  06630039
066420*** CARTONS AUDITED QTY / CARTONS AUDITED W ERRORS / ERROR %      06640039
066430                                                                  06641039
066500     MOVE PT-CRTNS-AUDITED (2)        TO TL1-PICK-CTNS-AUDITED    06642039
066501                                                                  06643039
066510     IF  PT-CRTNS-AUDITED (2)  >  0                               06644039
066600         MOVE PT-CRTNS-W-PICK-ERR(2)  TO PV-NUMERIC-7             06645039
066610         MOVE PV-NUMERIC-7            TO TL1-PICK-CTNS-ERRORS     06646039
066700                                                                  06647039
066800         IF  PT-CRTNS-W-PICK-ERR(2) >  0  AND                     06648039
066810             PT-CRTNS-AUDITED (2)   >  0                          06649039
066900             DIVIDE PT-CRTNS-W-PICK-ERR(2)                        06650039
067000                 BY PT-CRTNS-AUDITED (2)                          06660039
067010             GIVING PV-PERCENT-WORK ROUNDED                       06670039
067020             MULTIPLY PV-PERCENT-WORK  BY 100                     06680039
067030             GIVING   PV-PERCENT                                  06690039
067040             MOVE PV-PERCENT      TO PV-NUMERIC-3                 06700039
067050             MOVE PV-NUMERIC-3    TO TL1-PICK-CTNS-ERR-PCT        06701039
067100         ELSE                                                     06702039
067200             MOVE ZERO            TO PV-NUMERIC-3                 06703039
067210             MOVE PV-NUMERIC-3    TO TL1-PICK-CTNS-ERR-PCT        06704039
067500         END-IF                                                   06705039
067510     ELSE                                                         06706039
067520         MOVE '      0'               TO TL1-PICK-CTNS-ERRORS     06707039
067530         MOVE '  0'                   TO TL1-PICK-CTNS-ERR-PCT    06708039
067600     END-IF.                                                      06709039
067610                                                                  06710039
067611*** UNITS AUDITED QTY / UNITS W PICKING ERRORS / ERROR %          06720039
067620                                                                  06730039
067700     MOVE PT-QC-UNITS-AUDITED (2)     TO TL1-QC-UNITS-AUDITED     06740039
067700     MOVE PT-RFID-UNITS-AUDITED (2)   TO TL1-RFID-UNITS-AUDITED   06741040
067701                                                                  06750039
067710     IF  PT-QC-UNITS-AUDITED (2) > 0                              06760039
067800         MOVE PT-UNITS-PICK-ERR (2)   TO PV-NUMERIC-8             06770039
067810         MOVE PV-NUMERIC-8            TO TL1-UNIT-PICK-ERRORS     06780039
067900                                                                  06790039
068000         IF  PT-UNITS-PICK-ERR (2)  >  0  AND                     06800039
068010             PT-QC-UNITS-AUDITED (2) > 0                          06801039
068100             DIVIDE  PT-UNITS-PICK-ERR (2)                        06802039
068200                 BY  PT-QC-UNITS-AUDITED (2)                      06803039
068210             GIVING  PV-PERCENT-WORK  ROUNDED                     06804039
068220             MULTIPLY PV-PERCENT-WORK BY  100                     06805039
068230             GIVING   PV-PERCENT                                  06806039
068240             MOVE PV-PERCENT      TO PV-NUMERIC-3                 06807039
068250             MOVE PV-NUMERIC-3    TO TL1-UNIT-PICK-ERR-PCT        06808039
068300         ELSE                                                     06809039
068400             MOVE ZERO            TO PV-NUMERIC-3                 06810039
068410             MOVE PV-NUMERIC-3    TO TL1-UNIT-PICK-ERR-PCT        06820039
068700         END-IF                                                   06830039
068701     ELSE                                                         06840039
068710         MOVE '       0'              TO TL1-UNIT-PICK-ERRORS     06850039
068720         MOVE '  0'                   TO TL1-UNIT-PICK-ERR-PCT    06860039
068730     END-IF.                                                      06870039
068740                                                                  06871039
068750***  UNITS W TICKETING ERRORS / ERROR %                           06872039
068800                                                                  06873039
068810     IF  PT-QC-UNITS-AUDITED (2) > 0                              06874039
068900         MOVE PT-UNITS-TICK-ERR(2)    TO PV-NUMERIC-7             06875039
068910         MOVE PV-NUMERIC-7            TO TL1-UNIT-TICK-ERRORS     06876039
068920                                                                  06877039
069000         IF  PT-UNITS-TICK-ERR (2)  >  0  AND                     06878039
069010             PT-QC-UNITS-AUDITED (2) > 0                          06879039
069100             DIVIDE  PT-UNITS-TICK-ERR (2)                        06880039
069200                 BY  PT-QC-UNITS-AUDITED (2)                      06890039
069210             GIVING  PV-PERCENT-WORK  ROUNDED                     06900039
069220             MULTIPLY PV-PERCENT-WORK  BY 100                     06910039
069230             GIVING   PV-PERCENT                                  06920039
069240             MOVE PV-PERCENT      TO PV-NUMERIC-3                 06921039
069250             MOVE PV-NUMERIC-3    TO TL1-UNIT-TICK-ERR-PCT        06922039
069300         ELSE                                                     06923039
069400             MOVE ZERO            TO PV-NUMERIC-3                 06924039
069410             MOVE PV-NUMERIC-3    TO TL1-UNIT-TICK-ERR-PCT        06925039
069700         END-IF                                                   06926039
069710     ELSE                                                         06927039
069711         MOVE '      0'               TO TL1-UNIT-TICK-ERRORS     06928039
069712         MOVE '  0'                   TO TL1-UNIT-TICK-ERR-PCT    06929039
069720     END-IF                                                       06930039
069800                                                                  06940039
068750***  UNITS W RFID ERRORS / RFID ERROR %                           06950039
068800                                                                  06960039
068810     IF  PT-RFID-UNITS-AUDITED (2) > 0                            06970039
068900         MOVE PT-UNITS-RFID-ERR(2)    TO PV-NUMERIC-6             06980039
068910         MOVE PV-NUMERIC-6            TO TL1-UNIT-RFID-ERRORS     06980139
068920                                                                  06980239
069000         IF  PT-UNITS-RFID-ERR (2)  >  0  AND                     06980339
069010             PT-RFID-UNITS-AUDITED (2) > 0                        06980439
069100             DIVIDE  PT-UNITS-RFID-ERR (2)                        06980539
069200                 BY  PT-RFID-UNITS-AUDITED (2)                    06980639
069210             GIVING  PV-PERCENT-WORK  ROUNDED                     06980739
069220             MULTIPLY PV-PERCENT-WORK  BY 100                     06980839
069230             GIVING   PV-PERCENT                                  06980939
069240             MOVE PV-PERCENT      TO PV-NUMERIC-3                 06981039
069250             MOVE PV-NUMERIC-3    TO TL1-UNIT-RFID-ERR-PCT        06981139
069300         ELSE                                                     06981239
069400             MOVE ZERO            TO PV-NUMERIC-3                 06981339
069410             MOVE PV-NUMERIC-3    TO TL1-UNIT-RFID-ERR-PCT        06981439
069700         END-IF                                                   06981539
069710     ELSE                                                         06981639
069711         MOVE '     0'                TO TL1-UNIT-RFID-ERRORS     06981739
069712         MOVE '  0'                   TO TL1-UNIT-RFID-ERR-PCT    06981839
069720     END-IF                                                       06981939
069800                                                                  06982039
069810***  PACKS AUDITED / PACKS W ERRORS / ERROR %                     06982139
069820                                                                  06982239
069900     MOVE PT-PACKS-AUDITED (2)        TO TL1-PACKS-AUDITED        06982339
069901                                                                  06982439
069910     IF  PT-PACKS-AUDITED (2)> 0                                  06982539
070000         MOVE PT-PACKS-W-PACK-ERR(2)  TO PV-NUMERIC-7             06982639
070010         MOVE PV-NUMERIC-7            TO TL1-PACK-ERRORS          06982739
070020                                                                  06982839
070100         IF  PT-PACKS-W-PACK-ERR(2)  >  0  AND                    06982939
070110             PT-PACKS-AUDITED (2)    >  0                         06983039
070200             DIVIDE PT-PACKS-W-PACK-ERR(2)                        06984039
070300                 BY PT-PACKS-AUDITED (2)                          06985039
070310             GIVING PV-PERCENT-WORK  ROUNDED                      06986039
070320             MULTIPLY PV-PERCENT-WORK  BY 100                     06987039
070330             GIVING   PV-PERCENT                                  06988039
070340             MOVE PV-PERCENT      TO PV-NUMERIC-3                 06989039
070350             MOVE PV-NUMERIC-3    TO TL1-PACK-AUD-ERR-PCT         06990039
070400         ELSE                                                     07000039
070500             MOVE ZERO            TO PV-NUMERIC-3                 07010039
070510             MOVE PV-NUMERIC-3    TO TL1-PACK-AUD-ERR-PCT         07020039
070800         END-IF                                                   07030039
070810     ELSE                                                         07040039
070811         MOVE '      0'               TO TL1-PACK-ERRORS          07050039
070812         MOVE '  0'                   TO TL1-PACK-AUD-ERR-PCT     07060039
070820     END-IF.                                                      07070039
070900                                                                  07080039
070901***  TOT # AUDITS / AUDITS W FAILURE ERRORS / ERROR %             07090039
070910                                                                  07091039
071000     MOVE PT-TOTAL-NBR-AUDITS (2)     TO TL1-TOTAL-AUDITS         07092039
071001                                                                  07093039
071010     IF  PT-TOTAL-NBR-AUDITS (2) > 0                              07094039
071100         MOVE PT-TOTAL-FAILED-AUDITS (2) TO PV-NUMERIC-7          07095039
071110         MOVE PV-NUMERIC-7               TO TL1-AUDITS-FAILED     07096039
071120                                                                  07097039
071200         IF  PT-TOTAL-FAILED-AUDITS (2)  >  0  AND                07098039
071210             PT-TOTAL-NBR-AUDITS (2)     >  0                     07099039
071300             DIVIDE  PT-TOTAL-FAILED-AUDITS (2)                   07100039
071400                 BY  PT-TOTAL-NBR-AUDITS (2)                      07110039
071410             GIVING  PV-PERCENT-WORK  ROUNDED                     07120039
071420             MULTIPLY PV-PERCENT-WORK  BY  100                    07130039
071430             GIVING   PV-PERCENT                                  07140039
071440             MOVE PV-PERCENT      TO PV-NUMERIC-3                 07141039
071450             MOVE PV-NUMERIC-3    TO TL1-AUDIT-FAIL-PCT           07142039
071500         ELSE                                                     07143039
071600             MOVE ZERO            TO PV-NUMERIC-3                 07144039
071610             MOVE PV-NUMERIC-3    TO TL1-AUDIT-FAIL-PCT           07145039
071900         END-IF                                                   07146039
071910     ELSE                                                         07147039
071911         MOVE '      0'               TO TL1-AUDITS-FAILED        07148039
071912         MOVE '  0'                   TO TL1-AUDIT-FAIL-PCT       07149039
071920     END-IF.                                                      07150039
072000                                                                  07160039
072001***  # PO'S AUDITED / PO AUDITS W ERRORS / ERROR %                07170039
072010                                                                  07180039
072100     MOVE PT-TOTAL-NBR-PO (2)         TO TL1-PO-AUDITS            07190039
072101                                                                  07200039
072110     IF  PT-TOTAL-NBR-PO (2) > 0                                  07210039
072200         MOVE PT-TOTAL-NBR-PO-FAIL (2)  TO PV-NUMERIC-7           07220039
072210         MOVE PV-NUMERIC-7              TO TL1-PO-AUDIT-ERRORS    07221039
072300                                                                  07222039
072400         IF  PT-TOTAL-NBR-PO-FAIL (2)  >  0  AND                  07223039
072410             PT-TOTAL-NBR-PO (2)       >  0                       07224039
072500             DIVIDE  PT-TOTAL-NBR-PO-FAIL (2)                     07225039
072600                 BY  PT-TOTAL-NBR-PO (2)                          07226039
072610             GIVING  PV-PERCENT-WORK  ROUNDED                     07227039
072620             MULTIPLY PV-PERCENT-WORK  BY 100                     07228039
072630             GIVING   PV-PERCENT                                  07229039
072640             MOVE PV-PERCENT      TO PV-NUMERIC-3                 07230039
072650             MOVE PV-NUMERIC-3    TO TL1-PO-AUDIT-ERR-PCT         07240039
072700         ELSE                                                     07250039
072800             MOVE ZERO            TO PV-NUMERIC-3                 07260039
072810             MOVE PV-NUMERIC-3    TO TL1-PO-AUDIT-ERR-PCT         07270039
073100         END-IF                                                   07280039
073110     ELSE                                                         07290039
073111         MOVE '      0'               TO TL1-PO-AUDIT-ERRORS      07300039
073112         MOVE '  0'                   TO TL1-PO-AUDIT-ERR-PCT     07310039
073120     END-IF.                                                      07311039
073200                                                                  07312039
073201***  # RCVR'S AUDITED / RCVR'S AUDITS W ERRORS / ERROR %          07313039
073210                                                                  07314039
073300     MOVE PT-TOTAL-NBR-RCVR (2)       TO TL1-REC-AUDITS           07315039
073301                                                                  07316039
073310     IF  PT-TOTAL-NBR-RCVR (2)  >  0                              07317039
073400         MOVE PT-TOTAL-NBR-RCVR-FAIL (2) TO PV-NUMERIC-7          07318039
073410         MOVE PV-NUMERIC-7               TO TL1-REC-AUDIT-ERRORS  07319039
073500                                                                  07320039
073600         IF  PT-TOTAL-NBR-RCVR-FAIL (2)  >  0  AND                07330039
073610             PT-TOTAL-NBR-RCVR (2)       >  0                     07340039
073700             DIVIDE  PT-TOTAL-NBR-RCVR-FAIL (2)                   07350039
073800                 BY  PT-TOTAL-NBR-RCVR (2)                        07360039
073810             GIVING  PV-PERCENT-WORK  ROUNDED                     07370039
073820             MULTIPLY PV-PERCENT-WORK  BY 100                     07380039
073830             GIVING   PV-PERCENT                                  07381039
073840             MOVE PV-PERCENT      TO PV-NUMERIC-3                 07382039
073850             MOVE PV-NUMERIC-3    TO TL1-REC-AUDIT-ERR-PCT        07383039
073900         ELSE                                                     07384039
074000             MOVE ZERO            TO PV-NUMERIC-3                 07385039
074010             MOVE PV-NUMERIC-3    TO TL1-REC-AUDIT-ERR-PCT        07386039
074300         END-IF                                                   07387039
074310     ELSE                                                         07388039
074311         MOVE '      0'               TO TL1-REC-AUDIT-ERRORS     07389039
074312         MOVE '  0'                   TO TL1-REC-AUDIT-ERR-PCT    07390039
074320     END-IF.                                                      07400039
074400                                                                  07410039
074410                                                                  07420039
074500 3200-PRINT-TOTAL-LINES.                                          07430039
074600                                                                  07440039
074700     PERFORM 8210-WRITE-TOTAL-LINE1.                              07450039
074900/                                                                 07460039
075000 8000-READ-VENDOR-EXTRACT.                                        07470039
075100                                                                  07480039
075200     READ VIOLATION-EXTRACT-FILE INTO SU034-RECORD                07490039
075300         AT END                                                   07500039
075400             SET PS-EOF-EXTRACT       TO TRUE                     07510039
075500         NOT AT END                                               07520039
075600             MOVE SU034-VENDOR-SALES-RANK                         07530039
075700                                      TO PV-CURR-VEND-SALES-RANK  07540039
075800             MOVE SU034-VENDOR-ID     TO PV-CURR-VENDOR-ID        07550039
075900             MOVE SU034-PKGNG-TYPE    TO PV-CURR-PKGNG-TYPE       07560039
076000             MOVE SU034-VENDOR-AUDIT-RANK                         07570039
076100                                      TO PV-CURR-VEND-AUDIT-RANK  07580039
076200             ADD 1                    TO PV-READ-COUNT            07590039
076300     END-READ.                                                    07600039
076400/                                                                 07610039
076500 8100-PRINT-REPORT-HEADINGS.                                      07620039
076600     ADD 1                        TO PV-PAGE-COUNT.               07630039
076700     MOVE PV-PAGE-COUNT           TO DP200O-PAGE-NUMBER.          07640039
076800                                                                  07650039
076900     MOVE ZERO                    TO PV-LINE-COUNT.               07660039
077000     MOVE 1                       TO DP200O-REPORT-NUMBER.        07670039
077100                                                                  07680039
077200     WRITE REPORT-RECORD                                          07690039
077300       FROM DP200O-STANDRD-HEADER-200-COLS                        07700039
077400         AFTER ADVANCING PAGE.                                    07710039
077500                                                                  07720039
077600     WRITE REPORT-RECORD                                          07730039
077700       FROM HEADING-LINE1                                         07740039
077800         AFTER ADVANCING 2 LINES.                                 07750039
077900                                                                  07760039
078000     WRITE REPORT-RECORD                                          07770039
078100       FROM HEADING-LINE2                                         07780039
078200         AFTER ADVANCING 1 LINE.                                  07790039
078300                                                                  07800039
078400     WRITE REPORT-RECORD                                          07810039
078500       FROM HEADING-LINE3                                         07820039
078600         AFTER ADVANCING 2 LINE.                                  07830039
078700                                                                  07840039
078800     WRITE REPORT-RECORD                                          07850039
078900       FROM HEADING-LINE4                                         07860039
079000         AFTER ADVANCING 1 LINE.                                  07870039
079100                                                                  07880039
079200     WRITE REPORT-RECORD                                          07890039
079300       FROM HEADING-LINE5                                         07900039
079400         AFTER ADVANCING 1 LINE.                                  07910039
079500                                                                  07920039
079600     WRITE REPORT-RECORD                                          07930039
079700       FROM HEADING-LINE6                                         07940039
079800         AFTER ADVANCING 1 LINE.                                  07950039
079900                                                                  07960039
080000     WRITE REPORT-RECORD                                          07970039
080100       FROM HEADING-LINE7                                         07980039
080200         AFTER ADVANCING 1 LINE.                                  07990039
080210                                                                  08000039
080220     INITIALIZE  REPORT-RECORD                                    08010039
080221     WRITE REPORT-RECORD                                          08020039
080240         AFTER ADVANCING 1 LINE.                                  08021039
080250                                                                  08022039
080300     ADD 10                           TO PV-LINE-COUNT.           08023039
080400                                                                  08024039
080500 8200-WRITE-DETAIL-LINE.                                          08025039
080900                                                                  08026039
081000     WRITE REPORT-RECORD                                          08027039
081100       FROM DL-LINE1                                              08028039
081200         AFTER ADVANCING 1 LINE.                                  08029039
081300     ADD 1                            TO PV-LINE-COUNT.           08030039
081301                                                                  08040039
081310     IF  PV-LINE-COUNT > PC-END-OF-PAGE                           08050039
081320       PERFORM 8100-PRINT-REPORT-HEADINGS                         08060039
081330     END-IF.                                                      08070039
081400                                                                  08080039
081500 8210-WRITE-TOTAL-LINE1.                                          08090039
081510                                                                  08100039
082000     WRITE REPORT-RECORD                                          08110039
082100       FROM TL-LINE1                                              08120039
082200         AFTER ADVANCING 1 LINE.                                  08130039
082300     ADD 1                            TO PV-LINE-COUNT.           08140039
082340                                                                  08150039
082400                                                                  08160039
083500 8300-SUBHEADER.                                                  08170039
083600                                                                  08180039
083700     IF PS-PRINT-VEND-TOTAL                                       08190039
083800         SET SH1-VEND-TOTALS                                      08200039
083900             PS-DONT-PRINT-VEND-TOTAL TO TRUE                     08210039
084000         MOVE SPACES                  TO SH1-VEND-AUDIT-RANKING   08220039
084100     ELSE                                                         08230039
084200     EVALUATE SU034-PKGNG-TYPE                                    08240039
084300         WHEN 'BC'                                                08250039
084400             SET SH1-BULK-CASEPACK    TO TRUE                     08260039
084500         WHEN 'PP'                                                08270039
084600             SET SH1-PREPACK          TO TRUE                     08280039
084700         WHEN 'PS'                                                08290039
084800             SET SH1-PACK-BY-STORE    TO TRUE                     08300039
084700         WHEN 'RF'                                                08310039
084800             SET SH1-RFID             TO TRUE                     08320039
084900     END-EVALUATE                                                 08330039
085000     MOVE SU034-VENDOR-AUDIT-RANK TO SH1-VEND-AUDIT-RANKING       08340039
085100*    SET PS-DONT-PRINT-SUBHEADER  TO TRUE                         08350039
085200                                                                  08360039
085300     END-IF.                                                      08370039
085400                                                                  08380039
085500     IF PS-PRINT-VEND-TOTAL                                       08390039
085600         SET PS-DONT-PRINT-VEND-TOTAL   TO TRUE                   08400039
085700         WRITE REPORT-RECORD                                      08410039
085800             FROM SUBHEADING-LINE1                                08420039
085900                 AFTER ADVANCING 3 LINE                           08430039
086000         ADD 3                        TO PV-LINE-COUNT            08440039
086100     ELSE                                                         08450039
086200         WRITE REPORT-RECORD                                      08460039
086300             FROM SUBHEADING-LINE1                                08470039
086400                 AFTER ADVANCING 1 LINE                           08480039
086500         ADD 2                        TO PV-LINE-COUNT            08490039
086600     END-IF.                                                      08500039
086617                                                                  08510039
086620                                                                  08520039
086700 8310-VENDOR-LINE.                                                08530039
086800                                                                  08540039
086900     MOVE SU034-VENDOR-SALES-RANK     TO VL-VENDOR-SALES-RANK     08550039
087000     MOVE SU034-VENDOR-NAME           TO VL-VENDOR-NAME           08560039
087100     WRITE REPORT-RECORD                                          08570039
087200         FROM VENDOR-LINE                                         08580039
087300         AFTER ADVANCING 1 LINE.                                  08590039
087400     ADD 1                            TO PV-LINE-COUNT.           08600039
087500                                                                  08610039
087600 9000-END-PROCESS.                                                08620039
087700                                                                  08630039
087710     IF  PS-NO-DATA                                               08640039
087720         CONTINUE                                                 08650039
087730     ELSE                                                         08660039
087800         PERFORM 2200-BUILD-DETAIL-LINE                           08670039
087900         PERFORM 8200-WRITE-DETAIL-LINE                           08680039
088000         PERFORM 3100-BUILD-TOTAL-LINES                           08690039
088100         SET PS-PRINT-VEND-TOTAL          TO TRUE                 08700039
088200         PERFORM 8300-SUBHEADER                                   08710039
088300         PERFORM 3200-PRINT-TOTAL-LINES                           08720039
088310     END-IF.                                                      08730039
088400                                                                  08740039
088500     MOVE PV-READ-COUNT               TO PV-DISP-COUNT            08750039
088600     DISPLAY ALL '*'                                              08760039
088700     DISPLAY SPACES                                               08770039
088800     DISPLAY 'SUKRP030'                                           08780039
088900     DISPLAY 'RECORDS READ = ' PV-DISP-COUNT                      08790039
089000     DISPLAY SPACES                                               08800039
089100     DISPLAY ALL '*'                                              08810039
089200                                                                  08820039
089300     IF PS-NO-DATA                                                08830039
089400         CONTINUE                                                 08840039
089500     ELSE                                                         08850039
089600         WRITE REPORT-RECORD                                      08860039
089700             FROM END-OF-REPORT-LINE                              08870039
089800             AFTER ADVANCING 3 LINES                              08880039
089900     END-IF                                                       08890039
090000                                                                  08900039
090100                                                                  08910039
090200     CLOSE VIOLATION-EXTRACT-FILE                                 08920039
090300           REPORT-FILE.                                           08930039
090400                                                                  08940039
090500 9100-SQL-ABEND.                                                  08950039
090600     MOVE SQLCODE                     TO SQLCODE2.                08960039
090700     MOVE SQLERRD(3)                  TO SQLERRD3.                08970039
090800                                                                  08980039
090900     DISPLAY '** ABEND **         ** = SQLERROR'.                 08990039
091000     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        09000039
091100     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              09010039
091200     DISPLAY '** OPERATION ** = ' PV-DB2-FUNCTION.                09020039
091300                                                                  09030039
091400     DISPLAY '** SQLCODE          ** = ' SQLCODE2.                09040039
091500     DISPLAY '** ROWS PROCESSED   ** = ' SQLERRD3.                09050039
091600     DISPLAY '** SQLERRM          ** = ' SQLERRM.                 09060039
091700     DISPLAY '** SQLERRMC         ** = ' SQLERRMC.                09070039
091800                                                                  09080039
091900                                                                  09090039
092000     MOVE +4013                       TO ABEND-CODE.              09100039
092100     CALL 'ILBOABN0' USING ABEND-CODE.                            09110039
092200                                                                  09120039
092300 9200-ABEND.                                                      09130039
092400******************************************************************09140039
092500*  PERFORMS A NON-SQL ABEND FOR THE PROGRAM                       09150039
092600******************************************************************09160039
092700     DISPLAY '***************************'.                       09170039
092800     DISPLAY '**       ABEND           **'.                       09180039
092900     DISPLAY '**  IN PROGRAM SUKRP030  **'.                       09190039
093000     DISPLAY '***************************'.                       09200039
093100     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        09210039
093200     DISPLAY '**                 ** = ' PV-ERROR-MESSAGE-1.       09220039
093300     DISPLAY '**                 ** = ' PV-ERROR-MESSAGE-2.       09230039
093400                                                                  09240039
093500     MOVE +4014                  TO PV-ABEND-CODE.                09250039
093600     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         09260039
093700                                                                  09270039
