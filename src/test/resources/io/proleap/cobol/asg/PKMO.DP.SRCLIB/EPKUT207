000100*----------------------------------------------------------       00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*----------------------------------------------------------       00030000
000400 PROGRAM-ID.    EPKUT207.                                         00040005
000500 AUTHOR.        LARRY WEISS.                                      00050000
000600 DATE-WRITTEN.  OCTOBER 30, 2007.                                 00060000
000700                                                                  00070000
000800*----------------------------------------------------------       00080000
000900*    BATCH CONTROL CARD POPULATOR FOR NEXT/FUTURE DAY             00090000
001000*       OFFER PROCESSING                                          00100000
001100*----------------------------------------------------------       00110000
001200* THIS PROGRAM WILL CREATE A BATCH CONTROL CARD WITH DATES        00120000
001300* AND OFFSET NUMBERS WHICH WILL BE USED BY AN EXTRACT             00130000
001400* PROGRAM TO EXTRACT ALL NEXT/FUTURE DAY OFFERS.  TO DO SO,       00140000
001500* THIS PROGRAM RETRIEVES THE FUTURE DAY OFFSET NUMBER FROM        00150000
001600* XST_INTFC_CNTL TABLE, WHICH WILL THEN BE USED TO                00160000
001700* CALCULATE THE FUTURE OFFSET DATE FOR THE BATCH                  00170000
001800* PROCESSING.                                                     00180000
001900*----------------------------------------------------------       00190000
002000* HISTORY LOG:                                                    00200000
002100*                                                                 00210000
002200*----------------------------------------------------------       00220000
002300* DATE:                                                           00230000
002400* WR/IR#:                                                         00240000
002500* PROGRAMMER:                                                     00250000
002600* DESCRIPTION:                                                    00260000
002700*                                                                 00270000
002800*----------------------------------------------------------       00280000
002900 ENVIRONMENT DIVISION.                                            00290000
003000*----------------------------------------------------------       00300000
003100 CONFIGURATION SECTION.                                           00310000
003200 SOURCE-COMPUTER. IBM-3090.                                       00320000
003300 OBJECT-COMPUTER. IBM-3090.                                       00330000
003400                                                                  00340000
003500 INPUT-OUTPUT SECTION.                                            00350000
003600                                                                  00360000
003700 FILE-CONTROL.                                                    00370000
003800                                                                  00380000
003900     SELECT CC-BATCH-DTE-FILE                                     00390000
004000       ASSIGN TO INP01.                                           00400000
004100                                                                  00410000
004200     SELECT CC-FUT-OFFSET-FILE                                    00420000
004300       ASSIGN TO INP02.                                           00430001
004400                                                                  00440000
004410     SELECT CC-NEXT-FUT-CC-FILE                                   00441001
004420       ASSIGN TO OUT01.                                           00442001
004430                                                                  00443001
004500*----------------------------------------------------------       00450000
004600 DATA DIVISION.                                                   00460000
004700*----------------------------------------------------------       00470000
004800 FILE SECTION.                                                    00480000
004900                                                                  00490000
005000 FD  CC-BATCH-DTE-FILE                                            00500000
005100     RECORDING MODE IS F                                          00510000
005200     LABEL RECORDS ARE STANDARD                                   00520000
005300     RECORD CONTAINS 80 CHARACTERS                                00530000
005400     DATA RECORD IS CC-BATCH-DTE-RECORD.                          00540000
005500                                                                  00550000
005600 01  CC-BATCH-DTE-RECORD          PIC X(80).                      00560000
005700                                                                  00570000
005800 FD  CC-FUT-OFFSET-FILE                                           00580000
005900     RECORDING MODE IS F                                          00590000
006000     LABEL RECORDS ARE STANDARD                                   00600000
006100     RECORD CONTAINS 80 CHARACTERS                                00610000
006200     DATA RECORD IS CC-FUT-OFFSET-RECORD.                         00620000
006300                                                                  00630000
006400 01  CC-FUT-OFFSET-RECORD         PIC X(80).                      00640000
006500                                                                  00650000
006510 FD  CC-NEXT-FUT-CC-FILE                                          00651001
006520     RECORDING MODE IS F                                          00652001
006530     LABEL RECORDS ARE STANDARD                                   00653001
006540     RECORD CONTAINS 80 CHARACTERS                                00654001
006550     DATA RECORD IS CC-NEXT-FUT-RECORD.                           00655001
006560                                                                  00656001
006570 01  CC-NEXT-FUT-RECORD           PIC X(80).                      00657001
006580                                                                  00658001
006600*----------------------------------------------------------       00660000
006700 WORKING-STORAGE SECTION.                                         00670000
006800                                                                  00680000
006900 01  AC-ABEND-CODE                     PIC S9(04) VALUE ZERO      00690000
007000                                                  COMP SYNC.      00700000
007100     88  AC-4003-IN-CTRL-CD-ERROR                 VALUE +4003.    00710000
007300     88  AC-4013-DB2-ERROR                        VALUE +4013.    00730000
007500     88  AC-4019-CALENDAR-ERROR                   VALUE +4019.    00750000
007600                                                                  00760000
007700*----------------------------------------------------------       00770000
007800* PC- PROGRAM CONSTANTS                                           00780000
007900*----------------------------------------------------------       00790000
008000 01  PC-PROGRAM-CONSTANTS.                                        00800000
008100     05  PC-PROGRAM-NAME              PIC X(08) VALUE 'EPKUT207'. 00810000
008200     05  PC-MAX-RETRIES               PIC S9(04) VALUE +5 COMP.   00820000
008300                                                                  00830000
009200*----------------------------------------------------------       00920000
009300* PV- PROGRAM VARIABLES                                           00930000
009400*----------------------------------------------------------       00940000
009500 01  PV-PROGRAM-VARIABLES.                                        00950000
009600     05  PV-PARAGRAPH-NAME            PIC X(30) VALUE SPACES.     00960000
009700     05  PV-OPERATION-MSG-1           PIC X(40) VALUE SPACES.     00970000
009800     05  PV-OPERATION-MSG-2           PIC X(40) VALUE SPACES.     00980000
009900     05  PV-DB2-OPERATION             PIC X(30) VALUE SPACES.     00990000
010000     05  PV-SQL-SUB                   PIC S9(4) VALUE +0 COMP.    01000000
010100     05  PV-BATCH-OFFSET-DTE          PIC X(10) VALUE SPACES.     01010000
010200     05  PV-FUTURE-OFFSET-DTE         PIC X(10) VALUE SPACES.     01020000
010300     05  PV-FUT-OFFST-NBR             PIC S9(05) VALUE +0.        01030000
010400     05  PV-SAVE-FUT-OFFST-NBR        PIC 9(02) VALUE 0.          01040000
010500     05  PV-SAVE-DAYS-AHEAD           PIC X(05) VALUE SPACES.     01050000
010600     05  PV-SAVE-DATE                 PIC X(10) VALUE SPACES.     01060000
010700     05  PV-SAVE-CCYY-MM-DD           PIC X(10) VALUE SPACES.     01070000
010800     05  PV-WORK-DATE.                                            01080000
010900         10  PV-WORK-YYYY             PIC X(04) VALUE SPACES.     01090000
011000         10  PV-WORK-FILLER-1         PIC X(01) VALUE '-'.        01100000
011100         10  PV-WORK-MO               PIC X(02) VALUE SPACES.     01110000
011200         10  PV-WORK-FILLER-2         PIC X(01) VALUE SPACES.     01120000
011300         10  PV-WORK-DY               PIC X(02) VALUE SPACES.     01130000
011400                                                                  01140000
011500                                                                  01150000
011600*----------------------------------------------------------       01160000
011700* CONTROL CARD EPCC255 LAYOUT                                     01170000
011800*----------------------------------------------------------       01180000
011900     COPY EPRD255.                                                01190000
012000                                                                  01200000
012100*----------------------------------------------------------       01210000
012200* CONTROL CARD EPCC252 LAYOUT, THE FOLLOWING COPY WILL BE         01220001
012210* USED TO WRITE THE DATA OUT TO THE TEMPORARY CONTROL CARD        01221001
012300*----------------------------------------------------------       01230000
012400     COPY EPRD252 REPLACING EP252 BY PV252.                       01240001
012500                                                                  01250000
012510*----------------------------------------------------------       01251001
012520* CONTROL CARD EPCC252 LAYOUT                                     01252001
012530*----------------------------------------------------------       01253001
012540     COPY EPRD252.                                                01254001
012550                                                                  01255001
012600*----------------------------------------------------------       01260000
012700* DATE ROUTINE COPY MEMBERS                                       01270000
012800*----------------------------------------------------------       01280000
012900     COPY DPWS500.                                                01290000
013000                                                                  01300000
013100*----------------------------------------------------------       01310000
013200* VARIABLES REQUIRED FOR THE FORMAT SQLCA ROUTINE DPPD004         01320000
013300*----------------------------------------------------------       01330000
013400     COPY DPWS004.                                                01340000
013500                                                                  01350000
013600*----------------------------------------------------------       01360000
013700* DB2 ABEND COPYBOOK                                              01370000
013800*----------------------------------------------------------       01380000
013900     COPY SQLCA2.                                                 01390000
014000                                                                  01400000
014100*----------------------------------------------------------       01410000
014200* DB2 COMMUNICATIONS AREA                                         01420000
014300*----------------------------------------------------------       01430000
014400     EXEC SQL                                                     01440000
014500          INCLUDE SQLCA                                           01450000
014600     END-EXEC.                                                    01460000
014700                                                                  01470000
014800*----------------------------------------------------------       01480000
014900* DB2 TABLE XST00037(XST_INTFC_CNTL) - PROMO INTERFACE CONTROL    01490001
015000*                                             TABLE               01500000
015100*----------------------------------------------------------       01510000
015200     EXEC SQL                                                     01520000
015300          INCLUDE XST00037                                        01530000
015400     END-EXEC.                                                    01540000
015500                                                                  01550000
015600*----------------------------------------------------------       01560000
015700 PROCEDURE DIVISION.                                              01570000
015800*----------------------------------------------------------       01580000
015900 0000-MAINLINE.                                                   01590000
016000                                                                  01600000
016100     PERFORM 1000-INITIALIZATION.                                 01610000
016200                                                                  01620000
016300     PERFORM 2000-PROCESS-CNTL-CARDS.                             01630000
016400                                                                  01640000
016500     PERFORM 9000-WRAPUP.                                         01650000
016600                                                                  01660000
016700     GOBACK.                                                      01670000
016800                                                                  01680000
016900*0000-EXIT.                                                       01690000
017000 EJECT.                                                           01700000
017100                                                                  01710000
017200*----------------------------------------------------------       01720000
017300* 1000-INITIALIZATION.                                            01730000
017400*     INITIALIZES VARIABLES, OPENS ANY FILES, AND READS           01740000
017500*     THE INPUT FILES, SAVES VARIABLES, AND CLOSES THE INPUT      01750000
017600*     FILES.                                                      01760000
017700*----------------------------------------------------------       01770000
017800 1000-INITIALIZATION.                                             01780000
017900                                                                  01790000
018000     INITIALIZE EP255-CC-CONTROL-CARD                             01800000
018100                EP252-CC-CONTROL-CARD.                            01810000
018200                                                                  01820000
018300     OPEN INPUT CC-BATCH-DTE-FILE                                 01830000
018400                CC-FUT-OFFSET-FILE.                               01840001
018500     OPEN OUTPUT CC-NEXT-FUT-CC-FILE.                             01850001
018510                                                                  01851001
018520     DISPLAY '*******************************************'.       01852008
018530     DISPLAY '*   PROGRAM EPKUT207 STARTS               *'.       01853008
018540     DISPLAY '*******************************************'.       01854008
018550                                                                  01855008
018600     PERFORM 8000-READ-BATCH-DTE-CARD.                            01860000
018700     PERFORM 8100-CHECK-FOR-VALID-DATE.                           01870000
018800                                                                  01880000
018900     PERFORM 8200-READ-FUT-OFFSET-CARD.                           01890000
019000     PERFORM 8100-CHECK-FOR-VALID-DATE.                           01900000
019100                                                                  01910000
019200     MOVE EP255-CC-CRNT-DTE                                       01920000
019300       TO PV-SAVE-DATE.                                           01930000
019400                                                                  01940000
019500*1000-EXIT.                                                       01950000
019600 EJECT.                                                           01960000
019700                                                                  01970000
019800*----------------------------------------------------------       01980000
019900* 2000-PROCESS-CNTL-CARDS                                         01990000
020000*     UPDATES EPCC252 CONTROL CARD FOR PROCESSING                 02000000
020100*----------------------------------------------------------       02010000
020200 2000-PROCESS-CNTL-CARDS.                                         02020000
020300                                                                  02030000
020400     MOVE PV-SAVE-DATE                                            02040000
020500       TO PV-SAVE-CCYY-MM-DD.                                     02050000
020600                                                                  02060000
020700     PERFORM 3000-SELECT-FUT-OFFSET-NBR.                          02070000
020800                                                                  02080000
020900     PERFORM 3100-FUTURE-OFFSET-DTE.                              02090000
021000                                                                  02100000
021100     MOVE PV-FUTURE-OFFSET-DTE TO PV-BATCH-OFFSET-DTE.            02110001
021200                                                                  02120001
021300     MOVE PV-FUT-OFFST-NBR    TO PV-SAVE-FUT-OFFST-NBR.           02130001
021500                                                                  02150000
021600     PERFORM 3200-UPDATE-CNTL-CARDS.                              02160000
021700                                                                  02170000
021800*2000-EXIT.                                                       02180000
021900 EJECT.                                                           02190000
022000                                                                  02200000
022100*----------------------------------------------------------       02210000
022200* 3000-SELECT-FUT-OFFSET-NBR.                                     02220000
022300*     SELECT THE FUTURE DAY OFFSET NUMBER FROM THE                02230000
022400*     XST_INTFC_CNTL TABLE.                                       02240000
022500*----------------------------------------------------------       02250000
022600 3000-SELECT-FUT-OFFSET-NBR.                                      02260000
022610                                                                  02261001
022700     PERFORM                                                      02270000
022800         WITH TEST AFTER                                          02280000
022900         VARYING PV-SQL-SUB                                       02290000
023000         FROM 1 BY 1                                              02300000
023100         UNTIL (PV-SQL-SUB GREATER PC-MAX-RETRIES                 02310000
023200                   OR SQLCODE = 0)                                02320000
023300                                                                  02330000
023400         EXEC SQL                                                 02340000
023500             SELECT FUT_DAY_OFFST_NBR                             02350000
023600               INTO :XST00037-FUT-DAY-OFFST-NBR                   02360000
023700               FROM XST_INTFC_CNTL                                02370000
023800              WHERE APLSYS_CDE = 'OM'                             02380000
023900               WITH UR                                            02390000
024000         END-EXEC                                                 02400000
024100                                                                  02410000
024200         EVALUATE TRUE                                            02420000
024300             WHEN SQLCODE = -904                                  02430000
024400             WHEN SQLCODE = -911                                  02440000
024500             WHEN SQLCODE = -913                                  02450000
024600                  CONTINUE                                        02460000
024700             WHEN SQLCODE = 0                                     02470000
024800                  MOVE XST00037-FUT-DAY-OFFST-NBR                 02480000
024900                    TO PV-FUT-OFFST-NBR                           02490000
025000                  MOVE PV-FUT-OFFST-NBR                           02500000
025100                    TO PV-SAVE-DAYS-AHEAD                         02510000
025200             WHEN OTHER                                           02520000
025300                  MOVE '3000-SELECT-FUT-OFFSET-NBR'               02530000
025400                    TO PV-PARAGRAPH-NAME                          02540000
025500                  MOVE 'SELECT MAX-OFFSET NBR'                    02550000
025600                    TO PV-DB2-OPERATION                           02560000
025700                  PERFORM 9200-SQL-ABEND                          02570000
025800         END-EVALUATE                                             02580000
025900     END-PERFORM.                                                 02590000
026000                                                                  02600000
026100     IF PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                    02610000
026200        MOVE '3000-SELECT-FUT-OFFSET-NBR'  TO PV-PARAGRAPH-NAME   02620001
026400        MOVE 'SELECT RETRIES EXCEEDED' TO PV-DB2-OPERATION        02640001
026600        PERFORM 9200-SQL-ABEND                                    02660000
026700     END-IF.                                                      02670000
026800                                                                  02680000
026900*3000-EXIT.                                                       02690000
027000 EJECT.                                                           02700000
027100                                                                  02710000
027200*----------------------------------------------------------       02720000
027300* 3100-FUTURE-OFFSET-DTE.                                         02730000
027400*     GETS THE FUTURE OFFSET DATE BASED ON THE NUMBER FOUND       02740000
027500*     IN THE XST_INTFC_CNTL TABLE.                                02750000
027600*----------------------------------------------------------       02760000
027700 3100-FUTURE-OFFSET-DTE.                                          02770000
027800                                                                  02780000
027900     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              02790000
028000     MOVE PV-SAVE-CCYY-MM-DD  TO DPG52-LK-DATE-INPUT.             02800001
028100                                                                  02810001
028200     SET DPG51-ACTUAL-CALENDAR-ONLY  TO TRUE.                     02820001
028300                                                                  02830001
028400     SET DPG52-LK-DTE-ISO-FMT  TO TRUE.                           02840001
028500                                                                  02850001
028600     SET DPG51-INCREMENT-DATE  TO TRUE.                           02860001
028700                                                                  02870001
028800     MOVE PV-SAVE-DAYS-AHEAD TO DPG51-INCR-DECR-DAYS-X.           02880001
028900                                                                  02890001
029000                                                                  02900000
029100     CALL DP500-KOHLS-CALENDAR-ROUTINE                            02910000
029200       USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.                 02920000
029300                                                                  02930000
029400     EVALUATE TRUE                                                02940000
029500         WHEN DPG54-NO-ERROR                                      02950000
029600             DISPLAY 'DAYS AHEAD NEEDED: ' PV-SAVE-DAYS-AHEAD     02960000
029700             DISPLAY 'RETRIEVING FUTURE OFFSET DATE'              02970000
029800         WHEN OTHER                                               02980000
029900             DISPLAY ' '                                          02990000
030000             DISPLAY '** ABEND ** IN XSKUT034'                    03000000
030100             DISPLAY '** INVALID RETURN FROM CALENDAR ROUTINE'    03010000
030300             DISPLAY '** ERROR MESSAGE = '                        03030000
030400                               DPG54-ERROR-MESSAGE                03040000
030600             DISPLAY '** DPG52 = ' DPG52                          03060000
031100             MOVE '3100-FUTURE-OFFSET-DTE'                        03110000
031200               TO PV-PARAGRAPH-NAME                               03120000
031300             MOVE 'ERROR VALIDATING INPUT DATE'                   03130000
031400               TO PV-OPERATION-MSG-1                              03140000
031500             SET AC-4019-CALENDAR-ERROR                           03150000
031600               TO TRUE                                            03160000
031700             MOVE DPG54-ERROR-MESSAGE                             03170000
031800               TO PV-OPERATION-MSG-2                              03180000
031900             PERFORM 9100-ABEND                                   03190000
032000     END-EVALUATE.                                                03200000
032100                                                                  03210000
032200     MOVE DPG55-DB2-ISO-DATE-FMT                                  03220000
032300       TO PV-FUTURE-OFFSET-DTE.                                   03230000
032400                                                                  03240000
032500*3100-EXIT.                                                       03250000
032600 EJECT.                                                           03260000
032700                                                                  03270000
032800*----------------------------------------------------------       03280000
032900* 3200-UPDATE-CNTL-CARDS.                                         03290000
033000*     UPDATES CONTROL CARD EPCC252                                03300000
033100*----------------------------------------------------------       03310000
033200 3200-UPDATE-CNTL-CARDS.                                          03320000
033300                                                                  03330000
033400     MOVE EP252-CC-FILLER-4  TO PV252-CC-FILLER-4.                03340001
033500                                                                  03350001
033600     MOVE EP255-CC-CRNT-DTE  TO PV252-CC-CURRENT-BATCH-DATE.      03360001
033700                                                                  03370001
033800     MOVE EP252-CC-FILLER-3  TO PV252-CC-FILLER-3.                03380001
033900                                                                  03390001
034000     MOVE EP252-CC-FUTURE-DATE  TO PV252-CC-PREVIOUS-FUTURE-DATE. 03400001
034100                                                                  03410001
034200     MOVE EP252-CC-FILLER-2  TO PV252-CC-FILLER-2.                03420001
034300                                                                  03430001
034400     MOVE PV-BATCH-OFFSET-DTE TO PV252-CC-FUTURE-DATE.            03440001
034500                                                                  03450001
034600     MOVE EP252-CC-FILLER-1  TO PV252-CC-FILLER-1.                03460002
034700                                                                  03470001
034800     MOVE PV-SAVE-FUT-OFFST-NBR    TO PV252-CC-OFFSET-NBR.        03480004
035000                                                                  03500012
035100     WRITE CC-NEXT-FUT-RECORD   FROM PV252-CC-CONTROL-CARD.       03510001
035300                                                                  03530000
035400*3200-EXIT.                                                       03540000
035500 EJECT.                                                           03550000
035600                                                                  03560000
035700*----------------------------------------------------------       03570000
035800* 8000-READ-BATCH-DTE-CARD.                                       03580000
035900*     READS IN THE CURRENT SYSTEM-BATCH DATE(EPCC255)             03590000
036000*     CONTROL CARD.                                               03600000
036100*----------------------------------------------------------       03610000
036200 8000-READ-BATCH-DTE-CARD.                                        03620000
036300                                                                  03630000
036400     READ CC-BATCH-DTE-FILE                                       03640000
036500         INTO EP255-CC-CONTROL-CARD                               03650000
036600           AT END                                                 03660000
036700             SET AC-4003-IN-CTRL-CD-ERROR                         03670000
036800               TO TRUE                                            03680000
036810             MOVE 'INPUT CONTROL CARD EPCC255 IS EMPTY'           03681013
036820               TO PV-OPERATION-MSG-1                              03682006
036830             MOVE '8000-READ-BATCH-DTE-CARD      '                03683006
036840               TO PV-PARAGRAPH-NAME                               03684006
036900             PERFORM 9100-ABEND                                   03690000
037000     END-READ.                                                    03700000
037100                                                                  03710000
037101     DISPLAY ' '.                                                 03710108
037110     DISPLAY '  INPUT EPRD255 CONTROL CARD  '.                    03711006
037120     DISPLAY EP255-CC-CONTROL-CARD-DISPLY.                        03712006
037200     MOVE EP255-CC-CRNT-DTE                                       03720000
037300       TO PV-WORK-DATE.                                           03730000
037400                                                                  03740000
037500*8000-EXIT.                                                       03750000
037600 EJECT.                                                           03760000
037700                                                                  03770000
037800*----------------------------------------------------------       03780000
037900* 8100-CHECK-FOR-VALID-DATE.                                      03790000
038000*----------------------------------------------------------       03800000
038100 8100-CHECK-FOR-VALID-DATE.                                       03810000
038400                                                                  03840000
038500     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              03850000
038600     SET DPG51-ACTUAL-CALENDAR-ONLY                               03860000
038700       TO TRUE.                                                   03870000
038800     SET DPG52-LK-DTE-ISO-FMT                                     03880000
038900       TO TRUE.                                                   03890000
039000                                                                  03900000
039100     MOVE PV-WORK-DATE                                            03910000
039200       TO DPG52-LK-DATE-INPUT.                                    03920000
039300     CALL DP500-KOHLS-CALENDAR-ROUTINE                            03930000
039400       USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56                  03940000
039500                                                                  03950000
039600     EVALUATE TRUE                                                03960000
039700       WHEN DPG54-NO-ERROR                                        03970000
039800         CONTINUE                                                 03980000
039900       WHEN OTHER                                                 03990000
040000         DISPLAY ' '                                              04000000
040100         DISPLAY '** INVALID RETURN FROM CALENDAR ROUTINE'        04010000
040300         DISPLAY '** ERROR MESSAGE = '                            04030000
040400                     DPG54-ERROR-MESSAGE                          04040000
040600         DISPLAY '** DPG52 = ' DPG52                              04060000
040900         MOVE 'INVALID DATE PASSED IN CC'                         04090000
041000           TO PV-OPERATION-MSG-1                                  04100000
041100         MOVE DPG54-ERROR-MESSAGE                                 04110000
041200           TO PV-OPERATION-MSG-2                                  04120000
041300         SET AC-4003-IN-CTRL-CD-ERROR                             04130000
041400           TO TRUE                                                04140000
041410         MOVE '8100-CHECK-FOR-VALID-DATE     '                    04141009
041420           TO  PV-PARAGRAPH-NAME                                  04142009
041500         PERFORM 9100-ABEND                                       04150000
041600     END-EVALUATE.                                                04160000
041700                                                                  04170000
041800*8100-EXIT.                                                       04180000
041900 EJECT.                                                           04190000
042000                                                                  04200000
042100*----------------------------------------------------------       04210000
042200* 8200-READ-FUT-OFFSET-CARD.                                      04220000
042300*     READS IN THE FUTURE OFFSET(EPCC252) CONTROL CARD            04230000
042400*----------------------------------------------------------       04240000
042500 8200-READ-FUT-OFFSET-CARD.                                       04250000
042600                                                                  04260000
042700     READ CC-FUT-OFFSET-FILE                                      04270000
042800       INTO EP252-CC-CONTROL-CARD                                 04280000
042900         AT END                                                   04290000
043000             SET AC-4003-IN-CTRL-CD-ERROR                         04300000
043100               TO TRUE                                            04310000
043110             MOVE 'INPUT CONTROL CARD EPCC252 IS EMPTY'           04311013
043120               TO PV-OPERATION-MSG-1                              04312006
043130             MOVE '8200-READ-FUT-OFFSET-CARD     '                04313006
043140               TO PV-PARAGRAPH-NAME                               04314006
043200             PERFORM 9100-ABEND                                   04320000
043300     END-READ.                                                    04330000
043400                                                                  04340000
043401     DISPLAY ' '.                                                 04340108
043410     DISPLAY 'INPUT EPRD252 CONTROL CARD'.                        04341008
043420     DISPLAY EP252-CC-CONTROL-CARD-DISPLY.                        04342008
043500     MOVE EP252-CC-FUTURE-DATE                                    04350000
043600       TO PV-WORK-DATE.                                           04360000
043700                                                                  04370000
043800*8200-EXIT.                                                       04380000
043900 EJECT.                                                           04390000
044000                                                                  04400000
044100*----------------------------------------------------------       04410000
044200* 9000-WRAPUP.                                                    04420000
044300*     DISPLAYS ANY NEEDED INFORMATION                             04430000
044400*----------------------------------------------------------       04440000
044500 9000-WRAPUP.                                                     04450000
044600                                                                  04460000
044700     CLOSE CC-BATCH-DTE-FILE                                      04470000
044800           CC-FUT-OFFSET-FILE                                     04480003
044810           CC-NEXT-FUT-CC-FILE.                                   04481003
044900                                                                  04490000
044901     DISPLAY ' '.                                                 04490108
044910     DISPLAY ' NEXT/FUTURE DAY CONTROL CARD :'.                   04491008
044920     DISPLAY PV252-CC-CONTROL-CARD-DISPLY.                        04492011
044930     DISPLAY '***********************************'.               04493008
045000     DISPLAY '*     PROGRAM EPKUT207 ENDS       *'.               04500008
045010     DISPLAY '***********************************'.               04501008
045100                                                                  04510006
045800*9000-EXIT.                                                       04580000
045900 EJECT.                                                           04590000
046000                                                                  04600000
046100*----------------------------------------------------------       04610000
046200* 9100-ABEND.                                                     04620000
046300*     ABEND PROGRAM WHEN A NON DB2 ERROR OCCURS.                  04630000
046400*----------------------------------------------------------       04640000
046500 9100-ABEND.                                                      04650000
046600                                                                  04660000
046700     DISPLAY '** ABEND           **'.                             04670000
046800     DISPLAY '** PROGRAM         **' PC-PROGRAM-NAME.             04680000
046900     DISPLAY '** PARAGRAPH       **' PV-PARAGRAPH-NAME.           04690000
047000     DISPLAY '** OPERATION       **' PV-OPERATION-MSG-1.          04700000
047100     DISPLAY '**                 **' PV-OPERATION-MSG-2.          04710000
047200     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         04720000
047300                                                                  04730000
047400*9100-EXIT.                                                       04740000
047500 EJECT.                                                           04750000
047600                                                                  04760000
047700*----------------------------------------------------------       04770000
047800* 9200-SQL-ABEND.                                                 04780000
047900*     ABEND PROGRAM WHEN AN SQL ERROR CODE OR WARNING CODE        04790000
048000*     OCCURS.                                                     04800000
048100*----------------------------------------------------------       04810000
048200 9200-SQL-ABEND.                                                  04820000
048300                                                                  04830000
048400     SET AC-4013-DB2-ERROR TO TRUE.                               04840000
048500                                                                  04850000
048600     DISPLAY '** ABEND     **'.                                   04860000
048700     DISPLAY '** PROGRAM   **' PC-PROGRAM-NAME.                   04870000
048800     DISPLAY '** PARAGRAPH **' PV-PARAGRAPH-NAME.                 04880000
048900     DISPLAY '** OPERATION **' PV-DB2-OPERATION.                  04890000
049000                                                                  04900000
049100     COPY DPPD004.                                                04910000
049200     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         04920000
049300                                                                  04930000
049400*9200-EXIT.                                                       04940000
049500 EJECT.                                                           04950000
049600                                                                  04960000
