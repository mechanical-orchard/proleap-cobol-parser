       IDENTIFICATION DIVISION.                                                 
       PROGRAM-ID.           FSKUT150.                                          
       AUTHOR.               RICH KELLEN.                                       
       INSTALLATION.         KOHLS DEPARTMENT STORES.                           
       DATE-WRITTEN          07/07/2006.                                        
       DATE-COMPILED.                                                           
                                                                                
      ******************************************************************        
      *   FSKUT150 - COMMA DELIMIT ECOM SKU EXTRACT FILE CREATE        *        
      *   THIS PROGRAM TAKES IN A FILE CONTAINING ESSENTIALLY THE SAME *        
      *   DATA AS THAT ON THE FSKRP111 REPORT AND SPLITS IT INTO MANY  *        
      *   FILES, ONE FOR EACH UNIQUE DMA ON THE FILE. 2 OTHER FILES ARE*        
      *   CREATED TO ALLOW THE MFT'ING OF THESE FILES AND LATER THE    *        
      *   DELETION AFTER MFT'ING IS DONE. THE SPLIT FILES ARE CREATED  *        
      *   BY DYNAMICALLY ALLOCATING EACH ONE AS A NEW DMA IS TO BE     *        
      *   PROCESSED USING THE DPPD023 ROUTINE. A HEADER RECORD IS PUT  *        
      *   IN THE FRONT OF EACH FILE TO FACILITATE VIEWING IN EXCEL.    *        
      ******************** HISTORY OF CHANGES **************************        
      * CHG ID/                                                        *        
      * WR/PROJ  DATE        DESCRIPTION OF CHANGES                    *        
      * -------  ----------  ----------------------------------------  *        
      * WR30938  08/24/2006  INITIAL IMPLEMENTATION                    *        
      *                                                                *        
      * WR31955  07-05-2007  SHARON SZPISZAR (STRATAGEM)               *        
      *                      POPULATE NEW DIRECT SHIP INDICATOR FIELD  *        
      *                      ON OUTPUT RECORD.                         *        
      *                                                                *        
      * WR34688  08-07-2009  VENKAT MALLANNAGARI (GENESIS10)           *        
      *                      POPULATE NEW WEB EXCLUSIVE INDICATOR      *        
      *                      & EXTENDED SIZE DESCRIPTION ON OUTPUT     *        
      *                      RECORD.                                   *        
      * WR38082  03-09-2011  JACK KRAMER                               *        
      *                      ADD AN ADDITIONAL ECOMM CSV FILE          *        
      *                      CONTAINING ALL DMM FILE DATA - PLUS       *        
      *                      SOME ADDITIONAL FIELDS FOR THE PURPOSE    *        
      *                      OF LOADING AN ACCESS DATABASE             *        
      *                                                                *        
      * CRQ39001 01-13-2013  COGNIZANT                                 *        
      *                      INCREASED THE RECORD COUNT IN THE         *        
      *                      PROGRAM FOR THE DYNAMICALLY CREATED FILE  *        
      *                      OUT04                                     *        
63276 * INC63276             COGNIZANT                                          
63276 *                      CHANGED THE MFT PATH NAME SINCE IT IS CASE         
63276 *                      SENSITIVE AFTER THE KSMS105 MIGRATION TO           
63276 *                      VNX                                                
ronna * CHG54099 04/24/2013  Ronna                                              
ronna *                      ATG - needs the same file that blue                
ronna *                      martini gets.  Will be replacing the               
ronna *                      hard coding for all the the MFT'ing                
ronna *                      with a FSSIxxx control card so this                
ronna *                      program will not need to be changed if             
ronna *                      the path needs to change.  Note: ATG and           
ronna *                      Blue Martini will be running in parallel           
ronna *                      so at a later date, changes will need to           
ronna *                      be made to the job to remove the blue              
ronna *                      martini code                                       
ronna *                      ATG will need files MFT'd to Bizlink.              
ronna *                      With Bizlink, the file need to be MFT'd            
ronna *                      as a temporary file then then renamed              
ronna *                      with a suffix of '.zzesk416'                       
ronna *                                                                         
ronna ******************************************************************        
MFTTST******************************************************************        
MFTTST*  DATE:                                                                  
MFTTST*  WR/IR#:                                                                
MFTTST*  PROGRAMMER: COGNIZANT                                                  
MFTTST*  DESCRIPTION: CHANGED THE FTP TO MFT CONTROL CARD                       
MFTTST*                                                                         
MFTTST******************************************************************        
208057*  DATE: 9/10/2018                                                        
208057*  WR/IR#:  CHG0208057                                                    
208057*  PROGRAMMER: Jim Hunter                                                 
208057*  DESCRIPTION: MAINFRAME REFACTORING -                                   
208057*               CONVERT FROM CALLING MLPD502 TO CALLING DPKUT085          
208057*               TO GET CURRENT JOB NAME.                                  
236242******************************************************************        
236242*  DATE: 11/25/2019                                                       
236242*  WR/IR#: CHG0236242                                                     
236242*  PROGRAMMER: COGNIZANT                                                  
236242*  DESCRIPTION: INCREASING THE RECORD COUNT OF FILE OUT04 FROM            
236242*               250000 TO 500000 TO FIX THE SPACE ISSUE                   
236242******************************************************************        
236242*  DATE: 08/03/2023                                                       
236242*  WR/IR#: CHG0291690                                                     
236242*  PROGRAMMER: BOB MCASEY                                                 
236242*  DESCRIPTION: ADDED THE CALL TO 9990-ABEND IN 9999-SQL-ERROR.           
236242*               ADDED CALL TO 9999-SQL-ERROR IN A PARAGRAPH.              
236242*               ADDED WITH UR TO ALL SQL THAT DID NOT HAVE IT.            
236242*               THIS WAS IN RESPONSE TO INC14485250 WHERE THIS            
236242*               PROGRAM CAUSED THE MAINFRAME TO LOCK AND REQUIRED         
236242*               AN IPL.                                                   
236242******************************************************************        
                                                                                
                                                                                
       ENVIRONMENT DIVISION.                                                    
                                                                                
       CONFIGURATION SECTION.                                                   
                                                                                
       SOURCE-COMPUTER. IBM-3090.                                               
       OBJECT-COMPUTER. IBM-3090.                                               
                                                                                
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
           SELECT ECOM-SKU-EXTR-FILE                                            
               ASSIGN TO INP01.                                                 
                                                                                
ronna *    this is the path for the G drive                                     
ronna      SELECT ECOM-MFT-PATH1-FILE                                           
ronna          ASSIGN TO INP02.                                                 
ronna                                                                           
ronna *    this is the path for Blue Martini                                    
MFTTST*    SELECT ECOM-MFT-PATH2-FILE                                           
MFTTST*        ASSIGN TO INP03.                                                 
ronna                                                                           
ronna *    this is the path for ATG                                             
ronna      SELECT ECOM-MFT-PATH3-FILE                                           
ronna          ASSIGN TO INP04.                                                 
                                                                                
           SELECT ECOM-MFT-PARM-FILE                                            
               ASSIGN TO OUT01.                                                 
                                                                                
MFTTST*    SELECT ECOM-MFT-PARM-FILE2                                           
MFTTST*        ASSIGN TO OUT02.                                                 
                                                                                
           SELECT ECOM-IDCAMS-PARM-FILE                                         
               ASSIGN TO OUT03.                                                 
                                                                                
      ******************************************************************        
      * THIS OUTPUT IS DYNAMICALLY ALLOCATED THROUGH CODES IN DPPD023           
      ******************************************************************        
           SELECT ECOM-COMMA-DEL-SKU-EXTR-FILE                                  
               ASSIGN TO OUT04.                                                 
                                                                                
           SELECT ECOM-COMMA-DEL-SKU-EXTR-FIL2                                  
               ASSIGN TO OUT05.                                                 
                                                                                
      ******************************************************************        
      * THIS OUTPUT IS the MFT parameters file for ATG                          
      * The dynamically allocated files are built into here                     
      ******************************************************************        
           SELECT ECOM-MFT-PARM-FILE3                                           
               ASSIGN TO OUT06.                                                 
                                                                                
       DATA DIVISION.                                                           
                                                                                
       FILE SECTION.                                                            
       FD  ECOM-SKU-EXTR-FILE                                                   
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE STANDARD                                           
           BLOCK CONTAINS 0 RECORDS.                                            
       01  ECOM-SKU-EXTR-REC               PIC X(300).                          
                                                                                
RONNA  FD  ECOM-MFT-PATH1-FILE                                                  
RONNA      LABEL RECORDS ARE STANDARD                                           
RONNA      RECORDING MODE IS F                                                  
RONNA      BLOCK CONTAINS 0 RECORDS.                                            
RONNA  01  ECOM-MFT-PATH1-REC              PIC X(080).                          
RONNA                                                                           
MFTTST*FD  ECOM-MFT-PATH2-FILE                                                  
MFTTST*    LABEL RECORDS ARE STANDARD                                           
MFTTST*    RECORDING MODE IS F                                                  
MFTTST*    BLOCK CONTAINS 0 RECORDS.                                            
MFTTST*01  ECOM-MFT-PATH2-REC              PIC X(080).                          
RONNA                                                                           
RONNA  FD  ECOM-MFT-PATH3-FILE                                                  
RONNA      LABEL RECORDS ARE STANDARD                                           
RONNA      RECORDING MODE IS F                                                  
RONNA      BLOCK CONTAINS 0 RECORDS.                                            
RONNA  01  ECOM-MFT-PATH3-REC              PIC X(080).                          
                                                                                
       FD  ECOM-MFT-PARM-FILE                                                   
           LABEL RECORDS ARE STANDARD                                           
           RECORDING MODE IS F                                                  
           BLOCK CONTAINS 0 RECORDS.                                            
       01  ECOM-MFT-PARM-REC               PIC X(080).                          
                                                                                
MFTTST*FD  ECOM-MFT-PARM-FILE2                                                  
MFTTST*    LABEL RECORDS ARE STANDARD                                           
MFTTST*    RECORDING MODE IS F                                                  
MFTTST*    BLOCK CONTAINS 0 RECORDS.                                            
MFTTST*01  ECOM-MFT-PARM-REC2              PIC X(080).                          
                                                                                
       FD  ECOM-IDCAMS-PARM-FILE                                                
           LABEL RECORDS ARE STANDARD                                           
           RECORDING MODE IS F                                                  
           BLOCK CONTAINS 0 RECORDS.                                            
       01  ECOM-IDCAMS-PARM-REC            PIC X(080).                          
                                                                                
       FD  ECOM-COMMA-DEL-SKU-EXTR-FILE                                         
           LABEL RECORDS ARE STANDARD                                           
           RECORDING MODE IS F                                                  
           BLOCK CONTAINS 0 RECORDS.                                            
SS0707*01  ECOM-COMMA-DEL-SKU-EXTR-REC     PIC X(590).                          
SS0707*01  ECOM-COMMA-DEL-SKU-EXTR-REC     PIC X(605).                          
W34688 01  ECOM-COMMA-DEL-SKU-EXTR-REC     PIC X(626).                          
                                                                                
       FD  ECOM-COMMA-DEL-SKU-EXTR-FIL2                                         
           LABEL RECORDS ARE STANDARD                                           
           RECORDING MODE IS F                                                  
           BLOCK CONTAINS 0 RECORDS.                                            
       01  ECOM-COMMA-DEL-SKU-EXTR-REC2    PIC X(816).                          
                                                                                
ronna  FD  ECOM-MFT-PARM-FILE3                                                  
ronna      LABEL RECORDS ARE STANDARD                                           
ronna      RECORDING MODE IS F                                                  
ronna      BLOCK CONTAINS 0 RECORDS.                                            
ronna  01  ECOM-MFT-PARM-REC3              PIC X(080).                          
                                                                                
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
       01  ABEND-CODE                      PIC S9(04)    VALUE ZERO             
                                                         COMP SYNC.             
      *****************************************************************         
      *  ECOM SKU EXTRACT LAYOUT                                      *         
      *****************************************************************         
           COPY FSRD126.                                                        
                                                                                
      *****************************************************************         
      *  COMMA DELIMITED ECOM SKU EXTRACT LAYOUT                      *         
      *****************************************************************         
           COPY FSRD127.                                                        
                                                                                
      *****************************************************************         
      *  COMMA DELIMITED ECOM SKU EXTRACT HEADER LAYOUT               *         
      *****************************************************************         
           COPY FSRD128.                                                        
                                                                                
      *****************************************************************         
      *  COMMA DELIMITED ECOM SKU EXTRACT LAYOUT - ALL DATA           *         
      *****************************************************************         
           COPY FSRD133.                                                        
                                                                                
      *****************************************************************         
      *  COMMA DELIMITED ECOM SKU EXTRACT HEADER LAYOUT - ALL DATA    *         
      *****************************************************************         
           COPY FSRD134.                                                        
                                                                                
      *****************************************************************         
      *  KOHLS CALENDAR ROUTINE COPYBOOK                              *         
      *****************************************************************         
      *01  DP500-KOHLS-CALENDAR-ROUTINE.                                        
      *01  DPG51.                                                               
      *01  DPG52.                                                               
      *01  DPG53.                                                               
      *01  DPG54.                                                               
      *01  DPG55.                                                               
      *01  DPG56.                                                               
           COPY DPWS500.                                                        
                                                                                
      ******************************************************************        
      *  PARAMETER LIST FOR THE DYNAMIC ALLOCATION ROUTINE                      
      ******************************************************************        
      *01  DP023-DYNALC.                                                        
      *01  DP023-DYNALC-PARMS.                                                  
      *01  DP023-DYNALC-PD-PARMS.                                               
      *01  DP023-ABEND-CODE                                                     
      *01  DP023-SUB                                                            
      *01  DP023-MAX                                                            
      *01  DP023-RETURN-CODES.                                                  
      *01  DP023-RETURN-CODE-CONSTANTS.                                         
           COPY DPWS023.                                                        
                                                                                
208057*****************************************************************         
208057* JOB NAME                                                                
208057*****************************************************************         
208057*01  DP085-GET-CURR-JOB-INFO-PGM.                                         
208057*01  DP085-GET-CURR-JOB-INFO-PARMS.                                       
208057     COPY DPWS085.                                                        
                                                                                
      *****************************************************************         
      *  PROGRAM'S CONSTANTS                                          *         
      *****************************************************************         
       01  PC-PROGRAM-CONSTANTS.                                                
           05  PC-PROGRAM-NAME             PIC X(08)       VALUE                
               'FSKUT150'.                                                      
           05  PC-MFT-CD-REC.                                                   
             10  PC-MFT-CD-REC-1           PIC X(33)       VALUE                
63276          'CD /share/corp/E-Commerce/Team058'.                             
             10  PC-MFT-CD-REC-2           PIC X(40)       VALUE                
63276          '/ABM Shared/Ecom Assortment Spreadsheets'.                      
           05  PC-MFT-CD-REC2.                                                  
      *****************************************************************         
      **  hard coding path due to timelines.  In future should look   *         
      **  into using a control card instead. -bt                      *         
      *****************************************************************         
      ***    10  PC-MFT-CD-REC2-LINE1       PIC X(42)       VALUE               
      ***      'CD /accept/file/es/webAnalytics/inputFiles'.                    
      ***    10  PC-MFT-CD-REC2-LINE2       PIC X(16)       VALUE               
      ***      '/prod_attributes'.                                              
             10  PC-MFT-CD-REC2-LINE1       PIC X(40)       VALUE               
               'CD /prod/file/es/webAnalytics/inputFiles'.                      
             10  PC-MFT-CD-REC2-LINE2       PIC X(16)       VALUE               
               '/prod_attributes'.                                              
MFTTST*    05  PC-QUIT-REC                 PIC X(04)       VALUE                
MFTTST*        'QUIT'.                                                          
MFTTST     05  PC-RF-REC                   PIC X(80)       VALUE                
MFTTST         ' SET %RF = %DIR2 + %DIR3                            '.          
MFTTST     05  PC-RF1-REC                  PIC X(80)       VALUE                
MFTTST         ' SET %RF1 = %DIR2 + %DIR4                           '.          
MFTTST     05  PC-QUOTE-REC                PIC X(80)       VALUE                
MFTTST         ' QUOTE OFF                                          '.          
MFTTST     05  PC-DONE-REC                 PIC X(80)       VALUE                
MFTTST         ':DONE                                               '.          
MFTTST     05  PC-EXIT-REC                 PIC X(80)       VALUE                
MFTTST         '  EXIT                                              '.          
MFTTST     05  PC-SEND-REC                 PIC X(80)       VALUE                
MFTTST         '   CALL SENDFILE                                    '.          
MFTTST     05  PC-RENAME-REC               PIC X(80)       VALUE                
MFTTST         '   CALL RENAMEFILE                                  '.          
           05  PC-DEPT-CODE                PIC X(03)       VALUE 'DPT'.         
           05  PC-MANAGER-CODE             PIC X(03)       VALUE 'DMA'.         
           05  PC-GMA-CODE                 PIC X(03)       VALUE 'GMA'.         
           05  PC-RSPLVL-BUYER             PIC X(03)       VALUE 'BYR'.         
           05  PC-RSPLVL-MANAGER           PIC X(03)       VALUE 'DMM'.         
           05  PC-RSPLVL-GMM               PIC X(03)       VALUE 'GMM'.         
           05  PC-SUB-CLASS                PIC X(03)       VALUE 'SCL'.         
           05  PC-MAJ-CLASS                PIC X(03)       VALUE 'MCL'.         
           05  PC-OPERCO-NBR               PIC X(02)       VALUE '03'.          
           05  PC-RSPLVL-CDE               PIC X(03)       VALUE 'BYR'.         
           05  PC-SPACE                    PIC X(01)       VALUE SPACE.         
           05  PC-FIRST-NAME-DELIM         PIC X(02)       VALUE '  '.          
           05  PC-MORE-THAN-MAX-RETRY      PIC S9(04)      VALUE 4              
                                                           COMP SYNC.           
           05  PC-MAX-RETRY-CNT            PIC S9(04)      VALUE 3              
                                                           COMP SYNC.           
           05  PC-TWO-CENTS                PIC S9V99       VALUE +0.02          
                                                           COMP-3.              
           05  PC-VNDR-UPC-TYPE            PIC X(01)       VALUE 'V'.           
RONNA      05  PC-MAX-PATH-LINES           PIC S9(04)      VALUE 5              
RONNA                                                      COMP SYNC.           
      *****************************************************************         
      *  PROGRAM'S SWITCHES                                           *         
      *****************************************************************         
       01  PS-PROGRAM-SWITCHES.                                                 
           05  PS-END-OF-ECOM-FILE-SW      PIC X(01)       VALUE 'N'.           
               88  PS-END-OF-ECOM-FILE                     VALUE 'Y'.           
               88  PS-NOT-END-OF-ECOM-FILE                 VALUE 'N'.           
           05  PS-EOF-UPC-CSR-SW           PIC X(01)       VALUE 'N'.           
               88  PS-EOF-UPC-CSR                          VALUE 'Y'.           
               88  PS-NOT-EOF-UPC-CSR                      VALUE 'N'.           
           05  PS-FIRST-HEADER-SW          PIC X(01)       VALUE 'Y'.           
               88  PS-FIRST-HEADER                         VALUE 'Y'.           
               88  PS-NOT-FIRST-HEADER                     VALUE 'N'.           
RONNA      05  PS-END-OF-PATH1-FILE-SW    PIC X(01)        VALUE 'N'.           
RONNA          88  PS-END-OF-MFT-PATH1-FILE                VALUE 'Y'.           
RONNA          88  PS-NOT-END-OF-MFT-PATH1-FILE            VALUE 'N'.           
RONNA      05  PS-END-OF-PATH2-FILE-SW    PIC X(01)        VALUE 'N'.           
RONNA          88  PS-END-OF-MFT-PATH2-FILE                VALUE 'Y'.           
RONNA          88  PS-NOT-END-OF-MFT-PATH2-FILE            VALUE 'N'.           
RONNA      05  PS-END-OF-PATH3-FILE-SW    PIC X(01)        VALUE 'N'.           
RONNA          88  PS-END-OF-MFT-PATH3-FILE                VALUE 'Y'.           
RONNA          88  PS-NOT-END-OF-MFT-PATH3-FILE            VALUE 'N'.           
       01  FS-FILE-STATUS-CODES                            COMP-4 SYNC.         
           05  FS-MANAGER-NAME-CODE        PIC S9(9)       VALUE ZERO.          
               88  FS-MANAGER-NAME-NOT-FOUND               VALUE +100.          
           05  FS-BUYER-NAME-CODE          PIC S9(9)       VALUE ZERO.          
               88  FS-BUYER-NAME-NOT-FOUND                 VALUE +100.          
                                                                                
RONNA  01  PATH1-TABLE.                                                 03100000
RONNA      05  PATH1-LINE              OCCURS     005 TIMES             03110000
RONNA                                  ASCENDING KEY IS PATH1-LINE              
RONNA                                  INDEXED    PATH1-IDX             03120000
RONNA                                  PIC X(80).                       03130000
RONNA  01  PATH2-TABLE.                                                 03100000
RONNA      05  PATH2-LINE              OCCURS     005 TIMES             03110000
RONNA                                  ASCENDING KEY IS PATH2-LINE              
RONNA                                  INDEXED    PATH2-IDX             03120000
RONNA                                  PIC X(80).                       03130000
RONNA  01  PATH3-TABLE.                                                 03100000
RONNA      05  PATH3-LINE              OCCURS     005 TIMES             03110000
RONNA                                  ASCENDING KEY IS PATH3-LINE              
RONNA                                  INDEXED    PATH3-IDX             03120000
RONNA                                  PIC X(80).                       03130000
      *****************************************************************         
      *  PROGRAM'S VARIABLES                                          *         
      *****************************************************************         
       01  PV-PROGRAM-VARIABLES.                                                
           05  PV-DKEY                     PIC +9(08)      VALUE ZEROES.        
           05  PV-MDSEAR-DKEY              PIC S9(06)      VALUE ZEROES         
                                                           COMP-3.              
           05  PV-ACTV-IND                 PIC X(01)       VALUE SPACE.         
           05  PV-SKU-X                    PIC X(08).                           
           05  PV-SKU-9 REDEFINES PV-SKU-X PIC 9(08).                           
           05  PV-INTR-UPC-ID              PIC  S9(9)      VALUE +0             
                                                           COMP SYNC.           
           05  PV-UPC-COUNT                PIC S9(02)      VALUE ZEROES.        
           05  PV-SQLCODE                  PIC +9(08)      VALUE ZEROES.        
           05  PV-SELL-THRU-PCT            PIC S9(03)V9    VALUE +0.            
           05  PV-MDSE-LBL-DESC            PIC X(10)       VALUE SPACE.         
           05  PV-UNIT-SALES               PIC S9(09)V999  VALUE +0             
                                                           COMP-3.              
           05  PV-AVG-WEEK-SLS-QTY         PIC S9(09)      VALUE +0             
                                                           COMP-3.              
           05  PV-TEMP-ONHAND              PIC S9(08)      VALUE ZEROES         
                                                           COMP-3.              
           05  PV-TEMP-SELL-THRU           PIC S9(03)V999  VALUE +0             
                                                           COMP-3.              
           05  PV-BEGINNING-ONHAND         PIC S9(09)V999  VALUE +0             
                                                           COMP-3.              
           05  PV-TEMP-SLS-CURR            PIC S9(08)      VALUE ZEROES         
                                                           COMP-3.              
           05  PV-TEMP-SLS-WK-1            PIC S9(08)      VALUE ZEROES         
                                                           COMP-3.              
           05  PV-TEMP-SLS-WK-2            PIC S9(08)      VALUE ZEROES         
                                                           COMP-3.              
           05  PV-TEMP-SLS-WK-3            PIC S9(08)      VALUE ZEROES         
                                                           COMP-3.              
           05  PV-UNIT-ONHAND              PIC S9(09)V999  VALUE +0             
                                                           COMP-3.              
           05  PV-WEEKS-ONHAND-X.                                               
               10  PV-WEEKS-ONHAND-9       PIC S9(09).                          
           05  PV-RETRY-CNT                PIC S9(04)      VALUE ZEROES.        
           05  PV-PARA-NAME                PIC X(40)       VALUE SPACES.        
           05  PV-BUYER-NAME               PIC X(20)       VALUE SPACES.        
           05  PV-CURR-DMM                 PIC X(02)       VALUE SPACES.        
           05  PV-CALL-DEPT                PIC X(03)       VALUE SPACES.        
           05  PV-GMM-MANAGER              PIC X(02)       VALUE SPACES.        
           05  PV-CALL-MANAGER             PIC X(02)       VALUE SPACES.        
           05  PV-CHARTC-CDE               PIC S9(04)      COMP SYNC            
                                                           VALUE +0.            
           05  PV-MDSE-LBL-SEQ-NBR         PIC S9(04)      COMP SYNC            
                                                           VALUE +0.            
           05  PV-CHARTC-SEQ-NBR           PIC S9(04)      COMP SYNC            
                                                           VALUE +0.            
           05  PV-CONVERT-DATE             PIC 9(07)       VALUE 0.             
           05  PV-JOBNAME                  PIC X(08)       VALUE SPACES.        
           05  FILLER REDEFINES PV-JOBNAME.                                     
               10  PV-JOBNAME-APPL         PIC X(02).                           
                   88  PV-PROD-JOBS                        VALUES ARE           
                       'DA' 'IN' 'MJ' 'ML' 'CF' 'FS'.                           
               10  FILLER                  PIC X(06).                           
           05  PV-FORMATTED-DATE.                                               
               10  PV-FORMATTED-MM         PIC XX.                              
               10  FILLER                  PIC X           VALUE '/'.           
               10  PV-FORMATTED-DD         PIC XX.                              
               10  FILLER                  PIC X           VALUE '/'.           
               10  PV-FORMATTED-YY         PIC XX.                              
RONNA      05  PV-PATH-REC-IN              PIC X(80)       VALUE SPACES.        
RONNA      05  PV-PATH1-LINE-CNT           PIC S9(04)      VALUE 0              
RONNA                                                      COMP SYNC.           
RONNA      05  PV-PATH2-LINE-CNT           PIC S9(04)      VALUE 0              
RONNA                                                      COMP SYNC.           
RONNA      05  PV-PATH3-LINE-CNT           PIC S9(04)      VALUE 0              
RONNA                                                      COMP SYNC.           
                                                                                
       01  PV-ABEND-CODE                   PIC S9(04)      VALUE ZEROES         
                                                           COMP SYNC.           
           88  ABEND-4001-INV-WRITE-KEY                    VALUE +4001.         
           88  ABEND-4002-INV-READ-KEY                     VALUE +4002.         
           88  ABEND-4003-CNTL-CARD-ERRORS                 VALUE +4003.         
           88  ABEND-4004-INTERNAL-ERROR                   VALUE +4004.         
           88  ABEND-4005-OPEN-FILE-ERROR                  VALUE +4005.         
           88  ABEND-4006-CLOSE-FILE-ERROR                 VALUE +4006.         
           88  ABEND-4007-SEQUENCE-ERROR                   VALUE +4007.         
           88  ABEND-4009-INVALID-DATA                     VALUE +4009.         
           88  ABEND-4012-BAD-INTR-SORT                    VALUE +4012.         
           88  ABEND-4013-DB-ERROR                         VALUE +4013.         
                                                                                
       01  CB-CALL-BUYER                   PIC X(03)       VALUE ZEROES.        
      *                                                                         
       01  TC-TMDSEAR-CLASS                PIC X(2)        VALUE ZEROES.        
       01  FILLER REDEFINES TC-TMDSEAR-CLASS.                                   
           05  FILLER                      PIC X(01).                           
           05  TC-DIGIT-2                  PIC X(01).                           
      *                                                                         
       01  CS-CURRENT-SUBCLASS             PIC 9(02)       VALUE ZEROES.        
       01  FILLER REDEFINES CS-CURRENT-SUBCLASS.                                
           05  CS-DIGIT-1                  PIC 9(01).                           
           05  FILLER                      PIC 9(01).                           
      *                                                                         
       01  TS-TMDSEAR-SUBCLASS             PIC X(03)       VALUE ZEROES.        
       01  FILLER REDEFINES TS-TMDSEAR-SUBCLASS.                                
           05  FILLER                      PIC X(01).                           
           05  TS-SUBCLASS                 PIC X(02).                           
      *                                                                         
           EXEC SQL                                                             
                INCLUDE TRSPBAR                                                 
           END-EXEC.                                                            
      *                                                                         
           EXEC SQL                                                             
                INCLUDE TMDSEAR                                                 
           END-EXEC.                                                            
      *                                                                         
           EXEC SQL                                                             
                INCLUDE TVSCHVL                                                 
           END-EXEC.                                                            
      *                                                                         
W34688     EXEC SQL                                                             
W34688          INCLUDE TSIZE                                                   
W34688     END-EXEC.                                                            
W34688*                                                                         
W34688     EXEC SQL                                                             
W34688          INCLUDE IMT00025                                                
W34688     END-EXEC.                                                            
      *                                                                         
           EXEC SQL                                                             
                INCLUDE TMDARVS                                                 
           END-EXEC.                                                            
      *                                                                         
           EXEC SQL                                                             
                INCLUDE TVNDSTL                                                 
           END-EXEC.                                                            
      *                                                                         
           EXEC SQL                                                             
                INCLUDE TEXTENT                                                 
           END-EXEC.                                                            
      *                                                                         
           EXEC SQL                                                             
                INCLUDE TSKXREF                                                 
           END-EXEC.                                                            
      *                                                                         
           EXEC SQL                                                             
                INCLUDE TUPC                                                    
           END-EXEC.                                                            
      *                                                                         
           EXEC SQL                                                             
                INCLUDE TWEBITM                                                 
           END-EXEC.                                                            
      *                                                                         
           EXEC SQL                                                             
                INCLUDE SQLCA                                                   
           END-EXEC.                                                            
      *                                                                         
           EXEC SQL                                                             
               DECLARE UPC_CURSOR CURSOR FOR                                    
               SELECT UPC_NBR                                                   
                 FROM TUPC                                                      
                WHERE INTR_UPC_ID = :PV-INTR-UPC-ID                             
                  AND EFF_END_DTE IS NULL                                       
                  AND UPC_TYP_CDE = :PC-VNDR-UPC-TYPE                           
                ORDER BY EFF_BEG_DTE DESC                                       
                        ,UPC_NBR ASC                                            
                FETCH FIRST 2 ROWS ONLY                                         
0823RM         WITH UR                                                          
           END-EXEC.                                                            
      ******************************************************************        
      *  DB2 ERROR MESSAGES FORMAT AREA.                                        
      ******************************************************************        
           COPY DPWS004.                                                        
                                                                                
       LINKAGE SECTION.                                                         
                                                                                
       PROCEDURE DIVISION.                                                      
                                                                                
      ******************************************************************        
      *    MAINLINE LOGIC                                              *        
      ******************************************************************        
                                                                                
       0000-MAINLINE.                                                           
                                                                                
           PERFORM 1000-INITIALIZATION.                                         
                                                                                
      ******************************************************************        
      * SET UP PARMS TO MFT SPLIT FILES TO PROPER SERVER.                       
      ******************************************************************        
           MOVE SPACE TO ECOM-MFT-PARM-REC.                                     
MFTTST*    MOVE SPACE TO ECOM-MFT-PARM-REC2.                                    
           MOVE SPACE TO ECOM-MFT-PARM-REC3.                                    
ronna *    MOVE PC-MFT-CD-REC  TO ECOM-MFT-PARM-REC.                            
RONNA *    THIS IS TO TAKE THE PATH CONTENTS FROM CONTROL CARD INP03            
RONNA *    AND USE IT TO BUILD MFT PARAMETERS FOR OUT02                         
RONNA *                                                                         
RONNA      PERFORM VARYING PATH1-IDX FROM +1 BY +1                              
RONNA        UNTIL PATH1-IDX > PV-PATH1-LINE-CNT                                
RONNA          MOVE PATH1-LINE (PATH1-IDX) TO ECOM-MFT-PARM-REC                 
RONNA          PERFORM 7310-WRITE-ECOM-MFT-PARM-FILE1                           
RONNA          MOVE SPACE TO ECOM-MFT-PARM-REC                                  
RONNA      END-PERFORM.                                                         
RONNA *                                                                         
RONNA *                                                                         
RONNA *    MOVE PC-MFT-CD-REC2 TO ECOM-MFT-PARM-REC2.                           
RONNA *    THIS IS TO TAKE THE PATH CONTENTS FROM CONTROL CARD INP03            
RONNA *    AND USE IT TO BUILD MFT PARAMETERS FOR OUT02                         
RONNA *                                                                         
MFTTST*   PERFORM VARYING PATH2-IDX FROM +1 BY +1                               
MFTTST*      UNTIL PATH2-IDX > PV-PATH2-LINE-CNT                                
MFTTST*        MOVE PATH2-LINE (PATH2-IDX) TO ECOM-MFT-PARM-REC2                
MFTTST*        PERFORM 7320-WRITE-ECOM-MFT-PARM-FILE2                           
MFTTST*        MOVE SPACE TO ECOM-MFT-PARM-REC2                                 
MFTTST*    END-PERFORM.                                                         
RONNA *                                                                         
RONNA *    THIS IS TO TAKE THE PATH CONTENTS FROM CONTROL CARD INP04            
RONNA *    AND USE IT TO BUILD MFT PARAMETERS FOR OUT06                         
RONNA *                                                                         
RONNA      PERFORM VARYING PATH3-IDX FROM +1 BY +1                              
RONNA        UNTIL PATH3-IDX > PV-PATH3-LINE-CNT                                
RONNA          MOVE PATH3-LINE (PATH3-IDX) TO ECOM-MFT-PARM-REC3                
RONNA          PERFORM 7330-WRITE-ECOM-MFT-PARM-FILE3                           
RONNA          MOVE SPACE TO ECOM-MFT-PARM-REC3                                 
RONNA      END-PERFORM.                                                         
                                                                                
      *                                                                         
           PERFORM 2000-PROCESS-DMAS                                            
               UNTIL PS-END-OF-ECOM-FILE.                                       
           DISPLAY 'PROCESS DONE'                                               
MFTTST*    MOVE PC-QUIT-REC TO ECOM-MFT-PARM-REC.                               
MFTTST*    MOVE PC-QUIT-REC TO ECOM-MFT-PARM-REC2.                              
MFTTST*    MOVE PC-QUIT-REC TO ECOM-MFT-PARM-REC3.                              
MFTTST*    PERFORM 7300-WRITE-ECOM-MFT-PARM-FILE.                               
MFTTST*    PERFORM 7330-WRITE-ECOM-MFT-PARM-FILE3.                              
MFTTST     MOVE SPACES      TO ECOM-MFT-PARM-REC                                
MFTTST*                        ECOM-MFT-PARM-REC2                               
MFTTST                         ECOM-MFT-PARM-REC3                               
MFTTST     MOVE PC-DONE-REC TO ECOM-MFT-PARM-REC                                
MFTTST*                        ECOM-MFT-PARM-REC2                               
MFTTST                         ECOM-MFT-PARM-REC3                               
MFTTST     PERFORM 7300-WRITE-ECOM-MFT-PARM-FILE                                
MFTTST     PERFORM 7330-WRITE-ECOM-MFT-PARM-FILE3                               
MFTTST     MOVE SPACES      TO ECOM-MFT-PARM-REC                                
MFTTST*                        ECOM-MFT-PARM-REC2                               
MFTTST                         ECOM-MFT-PARM-REC3                               
MFTTST     MOVE PC-EXIT-REC TO ECOM-MFT-PARM-REC                                
MFTTST*                        ECOM-MFT-PARM-REC2                               
MFTTST                         ECOM-MFT-PARM-REC3                               
MFTTST     PERFORM 7300-WRITE-ECOM-MFT-PARM-FILE                                
MFTTST     PERFORM 7330-WRITE-ECOM-MFT-PARM-FILE3.                              
                                                                                
           PERFORM 9900-EOJ-LOGIC.                                              
                                                                                
           GOBACK.                                                              
                                                                                
      ******************************************************************        
      *    LOGON TO ORACLE, AND DECLARE THE ORACLE CURSORS.            *        
      ******************************************************************        
       1000-INITIALIZATION.                                                     
                                                                                
           INITIALIZE DPG51                                                     
                      DPG52                                                     
                      DPG53                                                     
                      DPG54                                                     
                      DPG55                                                     
                      DPG56.                                                    
                                                                                
                                                                                
           OPEN INPUT  ECOM-SKU-EXTR-FILE                                       
ronna                  ECOM-MFT-PATH1-FILE                                      
MFTTST*                ECOM-MFT-PATH2-FILE                                      
ronna                  ECOM-MFT-PATH3-FILE                                      
                OUTPUT ECOM-MFT-PARM-FILE                                       
MFTTST*                ECOM-MFT-PARM-FILE2                                      
                       ECOM-COMMA-DEL-SKU-EXTR-FIL2                             
                       ECOM-IDCAMS-PARM-FILE                                    
ronna                  ECOM-MFT-PARM-FILE3.                                     
                                                                                
           DISPLAY ' '.                                                         
                                                                                
           PERFORM 7100-READ-ECOM-SKU-EXTR-FILE.                                
           IF PS-END-OF-ECOM-FILE                                               
               DISPLAY ' *** NO ECOM EXTRACT RECORDS TO PROCESS ***'            
               DISPLAY ' '                                                      
           END-IF.                                                              
                                                                                
RONNA *    READ IN THE CONTROL CARDS WITH THE PATH FILE NAME.  THIS             
RONNA *    PROCESS CAN HANDLE UP TO 5 LINES OF CODE FOR A PATH.                 
RONNA *    IF THERE ARE MORE LINES THAN THAT NEEDED, THEN THIS PROGRAM          
RONNA *    WILL NEED TO BE CHANGED TO HANDLE MORE LINES.                        
RONNA *                                                                         
RONNA      INITIALIZE PATH1-TABLE                                               
RONNA                 PATH2-TABLE                                               
RONNA                 PATH3-TABLE.                                              
RONNA      MOVE HIGH-VALUES  TO  PATH1-TABLE                            08110000
RONNA                            PATH2-TABLE                            08110000
RONNA                            PATH3-TABLE.                           08110000
RONNA                                                                           
ronna *    INP02 path1 file                                                     
RONNA      PERFORM 7110-READ-ECOM-MFT-PATH1-FILE.                               
RONNA                                                                           
RONNA      PERFORM VARYING PATH1-IDX FROM +1 BY +1                      08280000
RONNA *      UNTIL PATH1-IDX > PC-MAX-PATH-LINES OR                     08290000
RONNA        UNTIL PS-END-OF-MFT-PATH1-FILE                             08300000
RONNA                                                                   08310000
RONNA          ADD 1 TO PV-PATH1-LINE-CNT                                       
RONNA          MOVE PV-PATH-REC-IN TO PATH1-LINE (PATH1-IDX)            08420000
RONNA          PERFORM 7110-READ-ECOM-MFT-PATH1-FILE                    08430000
RONNA                                                                   08440000
RONNA      END-PERFORM.                                                 08450000
RONNA                                                                   08460000
RONNA      IF PV-PATH1-LINE-CNT > PC-MAX-PATH-LINES                     08470000
RONNA          DISPLAY '** PROGRAM ABEND **'                            08480000
RONNA          DISPLAY 'FSKUT150  - INP02 Control Card issue.     '     08490000
RONNA          DISPLAY '            Max number of lines is 5.     '     08490000
RONNA          DISPLAY '            Either change file or increase'     08490000
RONNA          DISPLAY '            the internal table PATH1-TABLE.'    08490000
RONNA          MOVE +4003              TO ABEND-CODE                    08500000
RONNA          PERFORM 9990-ABEND                                       08510000
RONNA      END-IF.                                                      08520000
RONNA                                                                   08530000
MFTTST*    INP03 PATH2 FILE                                                     
MFTTST*    PERFORM 7120-READ-ECOM-MFT-PATH2-FILE.                               
RONNA                                                                           
MFTTST*    PERFORM VARYING PATH2-IDX FROM +1 BY +1                      08280000
RONNA *      UNTIL PATH2-IDX > PC-MAX-PATH-LINES OR                     08290000
MFTTST*      until PS-END-OF-MFT-PATH2-FILE                             08300000
MFTTST*                                                                 08310000
MFTTST*        ADD 1 TO PV-PATH2-LINE-CNT                                       
MFTTST**       MOVE PV-PATH-REC-IN TO PATH2-LINE (PATH2-IDX)            08420000
MFTTST*        PERFORM 7120-READ-ECOM-MFT-PATH2-FILE                    08430000
MFTTST*                                                                 08440000
MFTTST*    END-PERFORM.                                                 08450000
MFTTST*                                                                 08460000
MFTTST*    IF PV-PATH2-LINE-CNT > PC-MAX-PATH-LINES                     08470000
MFTTST*        DISPLAY '** PROGRAM ABEND **'                            08480000
MFTTST*        DISPLAY 'FSKUT150  - INP03 Control Card issue.     '     08490000
MFTTST*        DISPLAY '            Max number of lines is 5.     '     08490000
MFTTST*        DISPLAY '            Either change file or increase'     08490000
MFTTST*        DISPLAY '            the internal table PATH2-TABLE.'    08490000
MFTTST*        MOVE +4003              TO ABEND-CODE                    08500000
MFTTST*        PERFORM 9990-ABEND                                       08510000
MFTTST*    END-IF.                                                      08520000
RONNA                                                                   08530000
RONNA *    INP04 PATH3 FILE                                                     
RONNA      PERFORM 7130-READ-ECOM-MFT-PATH3-FILE.                               
RONNA                                                                           
RONNA      PERFORM VARYING PATH3-IDX FROM +1 BY +1                      08280000
RONNA *      UNTIL PATH3-IDX > PC-MAX-PATH-LINES OR                     08290000
RONNA        until PS-END-OF-MFT-PATH3-FILE                             08300000
RONNA                                                                   08310000
RONNA          ADD 1 TO PV-PATH3-LINE-CNT                                       
RONNA          MOVE PV-PATH-REC-IN TO PATH3-LINE (PATH3-IDX)            08420000
RONNA          PERFORM 7130-READ-ECOM-MFT-PATH3-FILE                    08430000
RONNA                                                                   08440000
RONNA      END-PERFORM.                                                 08450000
RONNA                                                                   08460000
RONNA      IF PV-PATH3-LINE-CNT > PC-MAX-PATH-LINES                     08470000
RONNA          DISPLAY '** PROGRAM ABEND **'                            08480000
RONNA          DISPLAY 'FSKUT150  - INP04 Control Card issue.     '     08490000
RONNA          DISPLAY '            Max number of lines is 5.     '     08490000
RONNA          DISPLAY '            Either change file or increase'     08490000
RONNA          DISPLAY '            the internal table PATH3-TABLE.'    08490000
RONNA          MOVE +4003              TO ABEND-CODE                    08500000
RONNA          PERFORM 9990-ABEND                                       08510000
RONNA      END-IF.                                                      08520000
RONNA                                                                   08530000
208057*                                                                         
208057*  GET CURRENT JOB NAME                                                   
208057     CALL DP085-GET-CURR-JOB-INFO-PGM                                     
208057         USING DP085-GET-CURR-JOB-INFO-PARMS.                             
208057     MOVE DP085-JOB-NAME     TO PV-JOBNAME.                               
208057                                                                          
208057     DISPLAY 'DP085 JOBNAME - ' PV-JOBNAME.                               
                                                                                
                                                                                
      ******************************************************************        
      *    2000-PROCESS-DMAS                                           *        
      *      THIS IS PERFORMED ONLY VIA THE 0000-MAINLINE              *        
      *      PURPOSE: ALLOCATE A NEW FILE FOR EACH UNIQUE DMM          *        
      *               (FS126-DMM-NMBR) AND CREATE PARMS TO MFT THE     *        
      *               NEWLY CREATE FILES SO EACH DMA GETS ITS' DATA    *        
      *               ONLY.                                            *        
      ******************************************************************        
       2000-PROCESS-DMAS.                                                       
                                                                                
           MOVE FS126-DMM-NMBR TO PV-CURR-DMM.                                  
                                                                                
      ******************************************************************        
      * SET UP PARMS TO ALLOCATE SPLIT FILE.                                    
      ******************************************************************        
           INITIALIZE DP023-DYNALC-PARMS.                                       
           MOVE 'OUT04' TO DP023-DDNAME.                                        
           SET DP023-DSNAME-SYSOUT TO TRUE.                                     
           SET DP023-FREE-CLOSE-YES TO TRUE.                                    
           SET DP023-RECFM-FIXED-BLOCK TO TRUE.                                 
           SET DP023-DISP-NEW          TO TRUE.                                 
      ******************************************************************        
      * THE FILE LENGTH IS DETERMINED BY THE LENGTH OF FSRD128 LAYOUT           
      * AS THE HEADER RECORD IS LONGER THAN THE DETAIL RECORD WHICH IS          
      * IS DEFINED IN FSRD127.                                                  
      ******************************************************************        
SS0707*    MOVE 590    TO DP023-RECSZ.                                          
SS0707*    MOVE 605    TO DP023-RECSZ.                                          
W34688     MOVE 626    TO DP023-RECSZ.                                          
taisak*    MOVE 20000  TO DP023-RECOUNT.                                        
C39001*    MOVE 250000  TO DP023-RECOUNT.                                       
236242     MOVE 500000  TO DP023-RECOUNT.                                       
           IF PV-PROD-JOBS                                                      
               MOVE 'B'    TO DP023-PRINT-CLASS                                 
               STRING 'PKMT.FS.ECOM.SKUEXTR.DMM' DELIMITED BY SIZE              
                      , FS126-DMM-NMBR DELIMITED BY SIZE                        
               INTO DP023-DSNAME                                                
           ELSE                                                                 
               MOVE 'X'    TO DP023-PRINT-CLASS                                 
               STRING 'TKMA.FS.ECOM.SKUEXTR.DMM' DELIMITED BY SIZE              
                      , FS126-DMM-NMBR DELIMITED BY SIZE                        
               INTO DP023-DSNAME                                                
           END-IF.                                                              
                                                                                
           MOVE 'SMTP' TO DP023-PRINT-WRITER.                                   
**TEMP*    DISPLAY 'DP023-DYNALC-PARMS ' DP023-DYNALC-PARMS.                    
           PERFORM DP023-0000-DYNALC.                                           
           OPEN OUTPUT ECOM-COMMA-DEL-SKU-EXTR-FILE.                            
                                                                                
      ******************************************************************        
      * SET UP PARMS TO MFT SPLIT FILES TO PROPER STORE SERVER.                 
      ******************************************************************        
           MOVE SPACE                    TO ECOM-MFT-PARM-REC                   
MFTTST*    MOVE SPACE                    TO ECOM-MFT-PARM-REC2                  
MFTTST     MOVE SPACE                    TO ECOM-MFT-PARM-REC3                  
MFTTST*                                                                         
MFTTST* SET UP Local File name (Mainframe file) - To transfer file to           
MFTTST* VNX, Ecom and Bizlink Servers using MFT                                 
MFTTST*                                                                         
MFTTST     STRING ' SET %LF = "' DELIMITED BY SIZE                              
MFTTST            , DP023-DSNAME DELIMITED BY ' '                               
MFTTST            , '"' DELIMITED BY SIZE                                       
MFTTST       INTO ECOM-MFT-PARM-REC                                             
MFTTST     END-STRING                                                           
MFTTST*                                                                         
MFTTST*    MOVE ECOM-MFT-PARM-REC        TO ECOM-MFT-PARM-REC2                  
MFTTST     MOVE ECOM-MFT-PARM-REC        TO ECOM-MFT-PARM-REC3                  
MFTTST     PERFORM 7300-WRITE-ECOM-MFT-PARM-FILE                                
MFTTST     PERFORM 7330-WRITE-ECOM-MFT-PARM-FILE3                               
MFTTST*                                                                         
MFTTST* SETUP Remotefile name (Destination file) - To transfer file to          
MFTTST* VNX, Ecom and Bizlink Servers using MFT                                 
MFTTST*                                                                         
MFTTST     MOVE SPACE                    TO ECOM-MFT-PARM-REC                   
MFTTST*                                     ECOM-MFT-PARM-REC2                  
MFTTST                                      ECOM-MFT-PARM-REC3                  
MFTTST*                                                                         
MFTTST     STRING ' SET %DIR3 = "' DELIMITED BY SIZE                            
MFTTST           , 'ECOM_DMM' DELIMITED BY SIZE                                 
MFTTST           , FS126-DMM-NMBR DELIMITED BY SIZE                             
MFTTST           , '.CSV' DELIMITED BY SIZE                                     
MFTTST           , '"' DELIMITED BY SIZE                                        
MFTTST       INTO ECOM-MFT-PARM-REC                                             
MFTTST     END-STRING                                                           
MFTTST*                                                                         
MFTTST*    MOVE ECOM-MFT-PARM-REC        TO ECOM-MFT-PARM-REC2                  
MFTTST     PERFORM 7300-WRITE-ECOM-MFT-PARM-FILE                                
MFTTST*                                                                         
MFTTST     STRING ' SET %DIR3 = "'     DELIMITED BY SIZE                        
MFTTST           , 'tmp_ecom_dmm' DELIMITED BY SIZE                             
MFTTST           , FS126-DMM-NMBR DELIMITED BY SIZE                             
MFTTST           , '.csv' DELIMITED BY SIZE                                     
MFTTST           , '"' DELIMITED BY SIZE                                        
MFTTST       INTO ECOM-MFT-PARM-REC3                                            
MFTTST     END-STRING                                                           
MFTTST     PERFORM 7330-WRITE-ECOM-MFT-PARM-FILE3                               
MFTTST*                                                                         
MFTTST     MOVE SPACE                    TO ECOM-MFT-PARM-REC3                  
MFTTST     STRING ' SET %DIR4 = "' DELIMITED BY SIZE                            
MFTTST           , 'ecom_dmm' DELIMITED BY SIZE                                 
MFTTST           , FS126-DMM-NMBR DELIMITED BY SIZE                             
MFTTST           , '.csv.zzesk416' DELIMITED BY SIZE                            
MFTTST           , '"' DELIMITED BY SIZE                                        
MFTTST       INTO ECOM-MFT-PARM-REC3                                            
MFTTST     END-STRING                                                           
MFTTST*                                                                         
MFTTST     PERFORM 7330-WRITE-ECOM-MFT-PARM-FILE3                               
MFTTST                                                                          
MFTTST     MOVE SPACE                    TO ECOM-MFT-PARM-REC                   
MFTTST*                                     ECOM-MFT-PARM-REC2                  
MFTTST                                      ECOM-MFT-PARM-REC3                  
MFTTST     MOVE PC-RF-REC                TO ECOM-MFT-PARM-REC                   
MFTTST*                                     ECOM-MFT-PARM-REC2                  
MFTTST                                      ECOM-MFT-PARM-REC3                  
MFTTST     PERFORM 7300-WRITE-ECOM-MFT-PARM-FILE                                
MFTTST     PERFORM 7330-WRITE-ECOM-MFT-PARM-FILE3                               
MFTTST                                                                          
MFTTST     MOVE SPACE                    TO ECOM-MFT-PARM-REC3                  
MFTTST     MOVE PC-RF1-REC               TO ECOM-MFT-PARM-REC3                  
MFTTST     PERFORM 7330-WRITE-ECOM-MFT-PARM-FILE3                               
MFTTST*                                                                         
MFTTST     MOVE SPACE                    TO ECOM-MFT-PARM-REC                   
MFTTST*                                     ECOM-MFT-PARM-REC2                  
MFTTST                                      ECOM-MFT-PARM-REC3                  
MFTTST     MOVE PC-QUOTE-REC             TO ECOM-MFT-PARM-REC                   
MFTTST*                                     ECOM-MFT-PARM-REC2                  
MFTTST                                      ECOM-MFT-PARM-REC3                  
MFTTST     PERFORM 7300-WRITE-ECOM-MFT-PARM-FILE                                
MFTTST     PERFORM 7330-WRITE-ECOM-MFT-PARM-FILE3                               
MFTTST*                                                                         
MFTTST     MOVE SPACE                    TO ECOM-MFT-PARM-REC                   
MFTTST*                                     ECOM-MFT-PARM-REC2                  
MFTTST                                      ECOM-MFT-PARM-REC3                  
MFTTST     MOVE PC-SEND-REC              TO ECOM-MFT-PARM-REC                   
MFTTST*                                     ECOM-MFT-PARM-REC2                  
MFTTST                                      ECOM-MFT-PARM-REC3                  
MFTTST     PERFORM 7300-WRITE-ECOM-MFT-PARM-FILE                                
MFTTST     PERFORM 7330-WRITE-ECOM-MFT-PARM-FILE3                               
MFTTST     MOVE SPACE                    TO ECOM-MFT-PARM-REC3                  
MFTTST     MOVE PC-RENAME-REC            TO ECOM-MFT-PARM-REC3                  
MFTTST     PERFORM 7330-WRITE-ECOM-MFT-PARM-FILE3                               
MFTTST                                                                          
MFTTST*                                                                         
MFTTST*    STRING "PUT '" DELIMITED BY SIZE                                     
MFTTST*          , DP023-DSNAME DELIMITED BY ' '                                
MFTTST*          , "' ECOM_DMM" DELIMITED BY SIZE                               
MFTTST*          , FS126-DMM-NMBR DELIMITED BY SIZE                             
MFTTST*          , '.CSV' DELIMITED BY SIZE                                     
MFTTST*    INTO ECOM-MFT-PARM-REC.                                              
MFTTST*    STRING "PUT '" DELIMITED BY SIZE                                     
MFTTST*          , DP023-DSNAME DELIMITED BY ' '                                
MFTTST*          , "' ECOM_DMM" DELIMITED BY SIZE                               
MFTTST*          , FS126-DMM-NMBR DELIMITED BY SIZE                             
MFTTST*          , '.CSV' DELIMITED BY SIZE                                     
MFTTST*    INTO ECOM-MFT-PARM-REC2.                                             
                                                                                
MFTTST******************************************************************        
MFTTST* SET UP PARMS TO MFT for ATG to bizlink.                                 
MFTTST* this will need to put the file then rename the file for bizlink         
MFTTST******************************************************************        
MFTTST*    put command                                                          
MFTTST*    MOVE SPACE TO ECOM-MFT-PARM-REC3.                                    
MFTTST*    STRING "PUT '" DELIMITED BY SIZE                                     
MFTTST*          , DP023-DSNAME DELIMITED BY ' '                                
MFTTST*          , "' tmp_ecom_dmm" DELIMITED BY SIZE                           
MFTTST*          , FS126-DMM-NMBR DELIMITED BY SIZE                             
MFTTST*          , '.csv' DELIMITED BY SIZE                                     
MFTTST*    INTO ECOM-MFT-PARM-REC3.                                             
MFTTST*    PERFORM 7330-WRITE-ECOM-MFT-PARM-FILE3.                              
MFTTST*    rename command                                                       
MFTTST*    MOVE SPACE TO ECOM-MFT-PARM-REC3.                                    
MFTTST*    STRING "RENAME " DELIMITED BY SIZE                                   
MFTTST*          , "tmp_ecom_dmm" DELIMITED BY SIZE                             
MFTTST*          , FS126-DMM-NMBR DELIMITED BY SIZE                             
MFTTST*          , '.csv' DELIMITED BY SIZE                                     
MFTTST*          , " ecom_dmm" DELIMITED BY SIZE                                
MFTTST*          , FS126-DMM-NMBR DELIMITED BY SIZE                             
MFTTST*          , '.csv.zzesk416' DELIMITED BY SIZE                            
MFTTST*    INTO ECOM-MFT-PARM-REC3.                                             
MFTTST*    PERFORM 7330-WRITE-ECOM-MFT-PARM-FILE3.                              
MFTTST*                                                                         
MFTTST******************************************************************        
      * SET UP PARMS TO IDCAMS DELETE FILES ALLOCATED BELOW.                    
      ******************************************************************        
           MOVE SPACE TO ECOM-IDCAMS-PARM-REC.                                  
           STRING '  DELETE ' DELIMITED BY SIZE                                 
                 , DP023-DSNAME DELIMITED BY ' '                                
                , ' NONVSAM' DELIMITED BY SIZE                                  
           INTO ECOM-IDCAMS-PARM-REC.                                           
           PERFORM 7400-ECOM-IDCAMS-PARM-FILE.                                  
                                                                                
      ******************************************************************        
      * WRITE HEADER RECORD FOR THE STORE FILE.                                 
      ******************************************************************        
           PERFORM 7250-WRITE-COMMA-DEL-SKU-HEAD.                               
           IF PS-FIRST-HEADER                                                   
               PERFORM 7255-WRITE-COMMA-DEL-SKU-HEAD2                           
               SET PS-NOT-FIRST-HEADER     TO TRUE                              
           END-IF.                                                              
      ******************************************************************        
      * WRITE RECORDS TO NEWLY ALLOCATED FILE UNTIL DMA CHANGES OR              
      * ALL RECORDS HAVE BEEN READ ON THE INPUT FILE.                           
      ******************************************************************        
           PERFORM 2200-WRITE-SPLIT-FILE                                        
               UNTIL FS126-DMM-NMBR NOT = PV-CURR-DMM                           
               OR PS-END-OF-ECOM-FILE                                           
           CLOSE ECOM-COMMA-DEL-SKU-EXTR-FILE.                                  
                                                                                
      ******************************************************************        
      *  WRITE RECORDS TO SPLIT FILE ALLOCATED EARLIER                 *        
      ******************************************************************        
       2200-WRITE-SPLIT-FILE.                                                   
           MOVE FS126-DMM-NMBR           TO FS127-DMM-NMBR                      
                                            FS133-DMM-NMBR.                     
           MOVE FS126-BUYER-NMBR         TO FS127-BUYER-NMBR                    
                                            FS133-BUYER-NMBR.                   
           MOVE FS126-MERCH-DEPT-NMBR    TO FS127-MERCH-DEPT-NMBR               
                                            FS133-MERCH-DEPT-NMBR.              
           MOVE FS126-SUBCLASS           TO FS127-SUBCLASS                      
                                            FS133-SUBCLASS.                     
           MOVE FS126-SKU                TO FS127-SKU                           
                                            FS133-SKU                           
                                            PV-SKU-X.                           
           MOVE PV-SKU-9                 TO SKXREF-SKU.                         
           MOVE FS126-GROUP-CODE         TO FS127-GROUP-CODE                    
                                            FS133-GROUP-CODE.                   
           MOVE FS126-LONG-VENDOR-STYLE  TO FS127-LONG-VENDOR-STYLE.            
           INSPECT FS127-LONG-VENDOR-STYLE REPLACING ALL ','                    
               BY ' '.                                                          
           MOVE FS127-LONG-VENDOR-STYLE  TO FS133-LONG-VENDOR-STYLE.            
           MOVE FS126-STATUS-CODE        TO FS127-STATUS-CODE                   
                                            FS133-STATUS-CODE.                  
           MOVE FS126-SKU-DESCRIPTION    TO FS127-SKU-DESCRIPTION.              
           INSPECT FS127-SKU-DESCRIPTION REPLACING ALL ','                      
               BY ' '.                                                          
           MOVE FS127-SKU-DESCRIPTION    TO FS133-SKU-DESCRIPTION.              
           MOVE FS126-UNIT-COST-AMT      TO FS127-UNIT-COST-AMT                 
                                            FS133-UNIT-COST-AMT.                
           MOVE FS126-CUR-UNIT-RTL-AMT   TO FS127-CUR-UNIT-RTL-AMT              
                                            FS133-CUR-UNIT-RTL-AMT.             
           IF FS126-CUR-UNIT-RTL-AMT < PC-TWO-CENTS                             
               MOVE 'N'                  TO FS133-SALEABLE-IND                  
           ELSE                                                                 
               MOVE 'Y'                  TO FS133-SALEABLE-IND                  
           END-IF.                                                              
           MOVE FS126-GP-QTY             TO FS127-GP-QTY                        
                                            FS133-GP-QTY.                       
           MOVE FS126-GP-RTL-AMT         TO FS127-GP-RTL-AMT                    
                                            FS133-GP-RTL-AMT.                   
           IF   FS126-STICKER-NBR = ZERO                                        
             MOVE SPACE                  TO FS127-STICKER-NBR-X                 
                                            FS133-STICKER-NBR-X                 
           ELSE                                                                 
             MOVE FS126-STICKER-NBR      TO FS127-STICKER-NBR                   
                                            FS133-STICKER-NBR.                  
           MOVE FS126-IN-HSE-VNDR-NAME   TO FS127-IN-HSE-VNDR-NAME.             
           INSPECT FS127-IN-HSE-VNDR-NAME REPLACING ALL ','                     
               BY ' '.                                                          
           MOVE FS127-IN-HSE-VNDR-NAME   TO FS133-IN-HSE-VNDR-NAME.             
           MOVE FS126-COLOR-DESC         TO FS127-COLOR-DESC                    
                                            FS133-COLOR-DESC.                   
           MOVE FS126-SIZE-DESC          TO FS127-SIZE-DESC                     
                                            FS133-SIZE-DESC.                    
           MOVE FS126-CUR-ONHAND-QTY     TO FS127-CUR-ONHAND-QTY                
                                            FS133-CUR-ONHAND-QTY.               
           MOVE FS126-LAST-RCVD-DATE     TO PV-CONVERT-DATE.                    
           MOVE PV-CONVERT-DATE (2:2)    TO PV-FORMATTED-YY.                    
           MOVE PV-CONVERT-DATE (4:2)    TO PV-FORMATTED-MM.                    
           MOVE PV-CONVERT-DATE (6:2)    TO PV-FORMATTED-DD.                    
           IF PV-FORMATTED-MM = SPACE                                           
             MOVE '00'                   TO PV-FORMATTED-YY                     
                                            PV-FORMATTED-MM                     
                                            PV-FORMATTED-DD.                    
           MOVE PV-FORMATTED-DATE        TO FS127-LAST-RCVD-DATE                
                                            FS133-LAST-RCVD-DATE.               
           MOVE FS126-YTD-SALES-UNIT-QTY TO FS127-YTD-SALES-UNIT-QTY            
                                            FS133-YTD-SALES-UNIT-QTY.           
           MOVE FS126-CUR-WK-ENDING-DATE (1:2) TO PV-FORMATTED-MM.              
           MOVE FS126-CUR-WK-ENDING-DATE (3:2) TO PV-FORMATTED-DD.              
           MOVE FS126-CUR-WK-ENDING-DATE (5:2) TO PV-FORMATTED-YY.              
           IF PV-FORMATTED-MM = SPACE                                           
             MOVE '00'                   TO PV-FORMATTED-YY                     
                                            PV-FORMATTED-MM                     
                                            PV-FORMATTED-DD.                    
           MOVE PV-FORMATTED-DATE        TO FS127-CUR-WK-ENDING-DATE            
                                            FS133-CUR-WK-ENDING-DATE.           
           MOVE FS126-CUR-SALES-UNIT-QTY TO FS127-CUR-SALES-UNIT-QTY            
                                            FS133-CUR-SALES-UNIT-QTY.           
           MOVE FS126-WK1-SALES-UNIT-QTY TO FS127-WK1-SALES-UNIT-QTY            
                                            FS133-WK1-SALES-UNIT-QTY.           
           MOVE FS126-WK2-SALES-UNIT-QTY TO FS127-WK2-SALES-UNIT-QTY            
                                            FS133-WK2-SALES-UNIT-QTY.           
           MOVE FS126-WK3-SALES-UNIT-QTY TO FS127-WK3-SALES-UNIT-QTY            
                                            FS133-WK3-SALES-UNIT-QTY.           
           MOVE FS126-WK4-SALES-UNIT-QTY TO FS127-WK4-SALES-UNIT-QTY            
                                            FS133-WK4-SALES-UNIT-QTY.           
           MOVE FS126-ON-ORD-QTY         TO FS127-ON-ORD-QTY                    
                                            FS133-ON-ORD-QTY.                   
           MOVE FS126-ORD-BGHT-MM        TO FS127-ORD-BGHT-MM                   
                                            FS133-ORD-BGHT-MM.                  
           MOVE FS126-ORD-BGHT-YY        TO FS127-ORD-BGHT-YY                   
                                            FS133-ORD-BGHT-YY.                  
           MOVE FS126-RPLNMT-IND         TO FS127-RPLNMT-IND                    
                                            FS133-RPLNMT-IND.                   
           MOVE FS126-FIRST-RCVD-DATE    TO PV-CONVERT-DATE.                    
           MOVE PV-CONVERT-DATE (2:2)    TO PV-FORMATTED-YY.                    
           MOVE PV-CONVERT-DATE (4:2)    TO PV-FORMATTED-MM.                    
           MOVE PV-CONVERT-DATE (6:2)    TO PV-FORMATTED-DD.                    
           MOVE PV-FORMATTED-DATE        TO FS127-FIRST-RCVD-DATE               
                                            FS133-FIRST-RCVD-DATE.              
           IF PV-FORMATTED-MM = SPACE                                           
             MOVE '00'                   TO PV-FORMATTED-YY                     
                                            PV-FORMATTED-MM                     
                                            PV-FORMATTED-DD.                    
           MOVE FS126-FIRST-SALE-DATE    TO PV-CONVERT-DATE.                    
           MOVE PV-CONVERT-DATE (2:2)    TO PV-FORMATTED-YY.                    
           MOVE PV-CONVERT-DATE (4:2)    TO PV-FORMATTED-MM.                    
           MOVE PV-CONVERT-DATE (6:2)    TO PV-FORMATTED-DD.                    
           IF PV-FORMATTED-MM = SPACE                                           
             MOVE '00'                   TO PV-FORMATTED-YY                     
                                            PV-FORMATTED-MM                     
                                            PV-FORMATTED-DD.                    
           MOVE PV-FORMATTED-DATE        TO FS127-FIRST-SALE-DATE               
                                            FS133-FIRST-SALE-DATE.              
           MOVE FS126-LAST-SALE-DATE     TO PV-CONVERT-DATE.                    
           MOVE PV-CONVERT-DATE (2:2)    TO PV-FORMATTED-YY.                    
           MOVE PV-CONVERT-DATE (4:2)    TO PV-FORMATTED-MM.                    
           MOVE PV-CONVERT-DATE (6:2)    TO PV-FORMATTED-DD.                    
           IF PV-FORMATTED-MM = SPACE                                           
             MOVE '00'                   TO PV-FORMATTED-YY                     
                                            PV-FORMATTED-MM                     
                                            PV-FORMATTED-DD.                    
           MOVE PV-FORMATTED-DATE        TO FS127-LAST-SALE-DATE                
                                            FS133-LAST-SALE-DATE.               
           MOVE FS126-KY-ITM-IND         TO FS127-KY-ITM-IND                    
                                            FS133-KY-ITM-IND.                   
           MOVE FS126-MERCH-DIV-CODE     TO FS127-MERCH-DIV-CODE                
                                            FS133-MERCH-DIV-CODE.               
           MOVE FS126-PRD-GP-IND         TO FS127-PRD-GP-IND                    
                                            FS133-PRD-GP-IND.                   
           MOVE FS126-PRD-GP-NBR         TO FS127-PRD-GP-NBR                    
                                            FS133-PRD-GP-NBR.                   
           MOVE FS126-ASRT-BEG-DTE (3:2) TO PV-FORMATTED-YY.                    
           MOVE FS126-ASRT-BEG-DTE (6:2) TO PV-FORMATTED-MM.                    
           MOVE FS126-ASRT-BEG-DTE (9:2) TO PV-FORMATTED-DD.                    
           IF PV-FORMATTED-MM = SPACE                                           
             MOVE '00'                   TO PV-FORMATTED-YY                     
                                            PV-FORMATTED-MM                     
                                            PV-FORMATTED-DD.                    
           MOVE PV-FORMATTED-DATE        TO FS127-ASRT-BEG-DTE                  
                                            FS133-ASRT-BEG-DTE.                 
           MOVE FS126-ASRT-END-DTE (3:2) TO PV-FORMATTED-YY.                    
           MOVE FS126-ASRT-END-DTE (6:2) TO PV-FORMATTED-MM.                    
           MOVE FS126-ASRT-END-DTE (9:2) TO PV-FORMATTED-DD.                    
           IF PV-FORMATTED-MM = SPACE                                           
             MOVE '00'                   TO PV-FORMATTED-YY                     
                                            PV-FORMATTED-MM                     
                                            PV-FORMATTED-DD.                    
           MOVE PV-FORMATTED-DATE        TO FS127-ASRT-END-DTE                  
                                            FS133-ASRT-END-DTE.                 
SS0707     MOVE FS126-DIRECT-SHIP-IND    TO FS127-DIRECT-SHIP-IND               
                                            FS133-DIRECT-SHIP-IND.              
                                                                                
W34688******************************************************************        
W34688*   GET THE ITEM'S EXTENDED SIZE DESCRIPTION FROM IMT_EXTD_SZ             
W34688*   TABLE                                                                 
W34688******************************************************************        
W34688       MOVE FS126-WEB-EXCLV-IND      TO FS127-WEB-EXCLV-IND               
                                              FS133-WEB-EXCLV-IND.              
W34688       MOVE FS126-KOHLS-SIZE-CDE     TO SIZE-KOHLS-SIZE-CDE.              
W34688       IF SIZE-KOHLS-SIZE-CDE > 0                                         
W34688          PERFORM 8500-SELECT-EXTD-SIZE                                   
W34688          MOVE IMT00025-EXTD-SZ-DESC  TO FS127-EXT-SIZE-DESC              
                                               FS133-EXT-SIZE-DESC              
                MOVE IMT00025-EXTD-SZ-CDE   TO FS133-EXT-SIZE-CDE               
W34688       ELSE                                                               
W34688          MOVE SPACES                 TO FS127-EXT-SIZE-DESC              
                                               FS133-EXT-SIZE-DESC              
                                               FS133-EXT-SIZE-CDE               
W34688       END-IF.                                                            
                                                                                
      ******************************************************************        
      *   GET DATA FROM DB2 TABLES THAT IS NOT ON INPUT RECORD.                 
      *   GET GM NAME                                                           
      ******************************************************************        
           IF FS126-MERCH-DIV-CODE NOT = PV-GMM-MANAGER                         
             MOVE FS126-MERCH-DIV-CODE     TO PV-GMM-MANAGER                    
             PERFORM 8000-SELECT-MANAGER-NAME                                   
             MOVE PV-BUYER-NAME            TO FS127-GMM-NAME                    
                                              FS133-GMM-NAME                    
             MOVE MDSEAR-DESC              TO FS133-GMM-DESC.                   
      ******************************************************************        
      *   GET DM NAME                                                           
      ******************************************************************        
           IF FS126-DMM-NMBR NOT = PV-CALL-MANAGER                              
             MOVE FS126-DMM-NMBR           TO PV-CALL-MANAGER                   
             PERFORM 8005-SELECT-MANAGER-NAME                                   
             MOVE PV-BUYER-NAME            TO FS127-DMM-NAME                    
                                              FS133-DMM-NAME                    
             MOVE MDSEAR-DESC              TO FS133-DMM-DESC.                   
      ******************************************************************        
      *   GET BUYER NAME                                                        
      ******************************************************************        
           IF FS126-MERCH-DEPT-NMBR NOT = PV-CALL-DEPT                          
            OR FS126-BUYER-NMBR   NOT = CB-CALL-BUYER                           
             MOVE FS126-MERCH-DEPT-NMBR    TO PV-CALL-DEPT                      
             MOVE FS126-BUYER-NMBR         TO CB-CALL-BUYER                     
             PERFORM 8100-SELECT-BUYER-NAME                                     
             MOVE PV-BUYER-NAME            TO FS127-BUYER-NAME                  
                                              FS133-BUYER-NAME.                 
      ******************************************************************        
      *   GET SUBCLASS DESCRIPTION                                              
      ******************************************************************        
           MOVE FS126-SUBCLASS(1:1)      TO TC-TMDSEAR-CLASS(1:1).              
           MOVE '0'                      TO TC-TMDSEAR-CLASS(2:1).              
           MOVE FS126-SUBCLASS           TO TS-SUBCLASS.                        
           PERFORM 8200-SELECT-SUBCLASS-DESC.                                   
           MOVE MDSEAR-DESC              TO FS127-SUBCLASS-DESC                 
                                            FS133-SUBCLASS-DESC.                
           MOVE MDSEAR-DKEY              TO PV-MDSEAR-DKEY.                     
           MOVE TC-TMDSEAR-CLASS         TO FS133-MAJCLASS.                     
      ******************************************************************        
      *   GET MAJOR CLASS DESCRIPTION                                           
      ******************************************************************        
           PERFORM 8250-SELECT-MAJCLASS-DESC.                                   
           INSPECT MDSEAR-DESC REPLACING ALL ',' BY ' '.                        
           MOVE MDSEAR-DESC              TO FS133-MAJCLASS-DESC.                
      ******************************************************************        
      *   GET SEASONALITY DESCRIPTION                                           
      ******************************************************************        
           PERFORM 8300-SELECT-DEPT-NAME.                                       
           MOVE MDSEAR-DESC              TO FS127-DEPT-DESC                     
                                            FS133-DEPT-DESC.                    
           IF FS126-SEA-SEQ-NBR   NOT = PV-CHARTC-SEQ-NBR                       
             MOVE FS126-SEA-SEQ-NBR        TO PV-CHARTC-SEQ-NBR                 
             MOVE 4                        TO PV-CHARTC-CDE                     
             PERFORM 8400-GET-VSM-DESC                                          
             IF  SQLCODE = +0                                                   
                 MOVE VSCHVL-CHARTC-VAL-DESC                                    
                      TO FS127-SEASON-DESC                                      
                 INSPECT FS127-SEASON-DESC REPLACING ALL ','                    
                     BY ' '                                                     
                 MOVE FS127-SEASON-DESC    to FS133-SEASON-DESC                 
             ELSE                                                               
               MOVE SPACE                    TO FS127-SEASON-DESC               
                                                FS133-SEASON-DESC.              
      ******************************************************************        
      *   GET BRAND DESCRIPTION                                                 
      ******************************************************************        
           IF  FS126-LBL-SEQ-NBR = PV-MDSE-LBL-SEQ-NBR                          
               MOVE PV-MDSE-LBL-DESC           TO FS127-MDSE-LBL-DESC           
                                                  FS133-MDSE-LBL-DESC           
           ELSE                                                                 
               MOVE FS126-LBL-SEQ-NBR          TO PV-MDSE-LBL-SEQ-NBR           
               MOVE 3                          TO PV-CHARTC-CDE                 
               PERFORM 8450-GET-VSM-DESC                                        
               IF  SQLCODE = +0                                                 
                   MOVE VSCHVL-CHARTC-VAL-DESC (1:10)                           
                                               TO FS127-MDSE-LBL-DESC           
                                                  FS133-MDSE-LBL-DESC           
                                                  PV-MDSE-LBL-DESC              
               END-IF                                                           
           END-IF                                                               
      ******************************************************************        
      *   CALC CURR SELL THRU PCT                                               
      ******************************************************************        
           MOVE FS126-CUR-SALES-UNIT-QTY TO PV-UNIT-SALES                       
           MOVE FS126-CUR-ONHAND-QTY     TO PV-UNIT-ONHAND                      
           PERFORM 2300-CALC-SELL-THRU-PERCENT.                                 
           MOVE PV-SELL-THRU-PCT         TO FS127-SELL-THRU-PCT                 
                                            FS133-SELL-THRU-PCT.                
      ******************************************************************        
      *   CALC YTD  SELL THRU PCT                                               
      ******************************************************************        
           MOVE FS126-YTD-SALES-UNIT-QTY TO PV-UNIT-SALES                       
           MOVE FS126-CUR-ONHAND-QTY     TO PV-UNIT-ONHAND                      
           PERFORM 2300-CALC-SELL-THRU-PERCENT.                                 
           MOVE PV-SELL-THRU-PCT         TO FS127-YTD-SELL-THRU-PCT             
                                            FS133-YTD-SELL-THRU-PCT.            
      ******************************************************************        
      *   CALC MARK UP PCT                                                      
      ******************************************************************        
           COMPUTE FS127-MU-PCT ROUNDED = ((FS126-CUR-UNIT-RTL-AMT)             
           - (FS126-UNIT-COST-AMT )) * 100                                      
           / (FS126-CUR-UNIT-RTL-AMT)                                           
           ON SIZE ERROR MOVE ZEROES TO FS127-MU-PCT.                           
           MOVE FS127-MU-PCT         TO FS133-MU-PCT.                           
      ******************************************************************        
      *   CALC WKS ONHAND QTY                                                   
      ******************************************************************        
           MOVE FS126-CUR-ONHAND-QTY     TO PV-TEMP-ONHAND                      
           PERFORM 2400-CALC-WEEKS-ONHAND                                       
           MOVE PV-WEEKS-ONHAND-9        TO FS127-WKS-ONHAND-QTY                
                                            FS133-WKS-ONHAND-QTY.               
      ******************************************************************        
      *   GET VS_DESCRIPTION, ENT_ID & UPC INFO                                 
      ******************************************************************        
           PERFORM 8600-SELECT-INTR-UPC.                                        
           MOVE SKXREF-INTR-UPC-ID       TO PV-INTR-UPC-ID.                     
           MOVE UPC-UPC-NBR              TO FS133-INTR-UPC-NBR.                 
           PERFORM 8650-POPULATE-VENDOR-STYLE.                                  
           INSPECT MDARVS-VS-DESC REPLACING ALL ',' BY ' '.                     
           MOVE MDARVS-VS-DESC           TO FS133-STYLE-DESC.                   
           MOVE MDARVS-ACTV-IND          TO PV-ACTV-IND.                        
           MOVE VNDSTL-ENT-ID            TO FS133-ENT-ID.                       
           MOVE EXTENT-DUN-NBR           TO FS133-DUN-NBR.                      
           IF PV-ACTV-IND = 'Y'                                                 
               PERFORM 8700-SELECT-VENDOR-UPCS                                  
           ELSE                                                                 
               MOVE ZEROES               TO FS133-VNDR-UPC-1                    
                                            FS133-VNDR-UPC-2                    
           END-IF.                                                              
           PERFORM 8800-SELECT-WEBITM-INFO.                                     
           MOVE WEBITM-SHIP-SRVC-SEQ-NBR  TO FS133-SHIP-SRVC-CDE.               
           MOVE WEBITM-SHIP-RSTRC-SEQ-NBR TO FS133-SHIP-RSTRCT-NBR.             
           MOVE WEBITM-SHIP-GP-SEQ-NBR    TO FS133-SHIP-GP-SEQ-NBR.             
           MOVE WEBITM-SHIP-SRCHG-FEE-AMT TO FS133-SHIP-SRCHG-FEE.              
      *                                                                         
           PERFORM 7200-WRITE-COMMA-DEL-SKU-EXTR.                               
           PERFORM 7205-WRITE-COMMA-DEL-SKU-EXTR2.                              
           PERFORM 7100-READ-ECOM-SKU-EXTR-FILE.                                
                                                                                
      ******************************************************************        
      *   CALCULATE SELL THRU PERCENTAGES                                       
      ******************************************************************        
       2300-CALC-SELL-THRU-PERCENT.                                             
           IF  PV-UNIT-SALES NOT POSITIVE                                       
               MOVE ZEROES          TO PV-TEMP-SELL-THRU                        
           ELSE                                                                 
               ADD PV-UNIT-ONHAND PV-UNIT-SALES                                 
                   GIVING PV-BEGINNING-ONHAND                                   
               IF  PV-BEGINNING-ONHAND NOT POSITIVE                             
                   MOVE 100.0       TO PV-TEMP-SELL-THRU                        
               ELSE                                                             
                   COMPUTE PV-TEMP-SELL-THRU ROUNDED =                          
                    (PV-UNIT-SALES * 100.00 / PV-BEGINNING-ONHAND)              
               END-IF                                                           
           END-IF                                                               
           COMPUTE PV-SELL-THRU-PCT ROUNDED = PV-TEMP-SELL-THRU.                
      *                                                                         
      ******************************************************************        
      *   CALCULATE WEEKS ONHAND QTY                                            
      ******************************************************************        
       2400-CALC-WEEKS-ONHAND.                                                  
                                                                                
           MOVE FS126-CUR-SALES-UNIT-QTY TO PV-TEMP-SLS-CURR.                   
           MOVE FS126-WK1-SALES-UNIT-QTY TO PV-TEMP-SLS-WK-1.                   
           MOVE FS126-WK2-SALES-UNIT-QTY TO PV-TEMP-SLS-WK-2.                   
           MOVE FS126-WK3-SALES-UNIT-QTY TO PV-TEMP-SLS-WK-3.                   
           MOVE FS126-CUR-ONHAND-QTY     TO PV-TEMP-ONHAND.                     
           COMPUTE PV-AVG-WEEK-SLS-QTY ROUNDED =                                
                                       (PV-TEMP-SLS-CURR                        
                                       + PV-TEMP-SLS-WK-1                       
                                       + PV-TEMP-SLS-WK-2                       
                                       + PV-TEMP-SLS-WK-3) / 4                  
                                                                                
           IF  PV-AVG-WEEK-SLS-QTY = +0 OR                                      
               PV-TEMP-ONHAND = +0                                              
               MOVE +0                   TO PV-WEEKS-ONHAND-9                   
           ELSE                                                                 
               DIVIDE PV-TEMP-ONHAND BY PV-AVG-WEEK-SLS-QTY                     
                   GIVING PV-WEEKS-ONHAND-9 ROUNDED                             
           END-IF.                                                              
      *                                                                         
      ******************************************************************        
      *  READ ECOM SKU EXTRACT FILE                                    *        
      ******************************************************************        
       7100-READ-ECOM-SKU-EXTR-FILE.                                            
                                                                                
           READ ECOM-SKU-EXTR-FILE INTO FS126-ECOM-SKU-EXTRACT-RECORD           
               AT END SET PS-END-OF-ECOM-FILE TO TRUE.                          
                                                                                
      *                                                                         
      ******************************************************************        
      *  READ ECOM SKU EXTRACT FILE                                    *        
      ******************************************************************        
       7110-READ-ECOM-MFT-PATH1-FILE.                                           
                                                                                
           INITIALIZE PV-PATH-REC-IN.                                           
                                                                                
           READ ECOM-MFT-PATH1-FILE INTO PV-PATH-REC-IN                         
               AT END SET PS-END-OF-MFT-PATH1-FILE TO TRUE.                     
                                                                                
      ******************************************************************        
      *  READ ECOM SKU EXTRACT FILE                                    *        
      ******************************************************************        
MFTTST*7120-READ-ECOM-MFT-PATH2-FILE.                                           
MFTTST*                                                                         
MFTTST*    INITIALIZE PV-PATH-REC-IN.                                           
MFTTST*                                                                         
MFTTST*    READ ECOM-MFT-PATH2-FILE into PV-PATH-REC-IN                         
MFTTST*        AT END SET PS-END-OF-MFT-PATH2-FILE TO TRUE.                     
                                                                                
      ******************************************************************        
      *  READ ECOM SKU EXTRACT FILE                                    *        
      ******************************************************************        
       7130-READ-ECOM-MFT-PATH3-FILE.                                           
                                                                                
           INITIALIZE PV-PATH-REC-IN.                                           
                                                                                
           READ ECOM-MFT-PATH3-FILE INTO PV-PATH-REC-IN                         
               AT END SET PS-END-OF-MFT-PATH3-FILE TO TRUE.                     
                                                                                
      ******************************************************************        
      *  WRITE THE ECOM COMMA DELIMITED SKU EXTRACT FILE               *        
      ******************************************************************        
       7200-WRITE-COMMA-DEL-SKU-EXTR.                                           
                                                                                
           WRITE ECOM-COMMA-DEL-SKU-EXTR-REC FROM                               
                 FS127-ECOM-SKU-EXTRACT-RECORD.                                 
                                                                                
      ******************************************************************        
      *  WRITE THE ECOM COMMA DELIMITED SKU EXTRACT FILE2 (FULL FILE)  *        
      ******************************************************************        
       7205-WRITE-COMMA-DEL-SKU-EXTR2.                                          
                                                                                
           WRITE ECOM-COMMA-DEL-SKU-EXTR-REC2 FROM                              
                 FS133-ECOM-SKU-EXTRACT-RECORD.                                 
                                                                                
      ******************************************************************        
      *  WRITE THE ECOM COMMA DELIMITED SKU EXTRACT HEADER             *        
      ******************************************************************        
       7250-WRITE-COMMA-DEL-SKU-HEAD.                                           
                                                                                
           WRITE ECOM-COMMA-DEL-SKU-EXTR-REC FROM                               
                 FS128-ECOM-SKU-EXT-HEAD-REC.                                   
                                                                                
      ******************************************************************        
      *  WRITE THE ECOM COMMA DELIMITED SKU EXTRACT HEADER             *        
      ******************************************************************        
       7255-WRITE-COMMA-DEL-SKU-HEAD2.                                          
                                                                                
           WRITE ECOM-COMMA-DEL-SKU-EXTR-REC2 FROM                              
                 FS134-ECOM-SKU-EXT-HEAD-REC.                                   
                                                                                
      ******************************************************************        
      *  WRITE THE ECOM PLANNER MFT PARMS                              *        
      ******************************************************************        
       7300-WRITE-ECOM-MFT-PARM-FILE.                                           
                                                                                
RONNA      PERFORM 7310-WRITE-ECOM-MFT-PARM-FILE1.                              
MFTTST*    PERFORM 7320-WRITE-ECOM-MFT-PARM-FILE2.                              
RONNA *    PERFORM 7330-WRITE-ECOM-MFT-PARM-FILE3.                              
RONNA                                                                           
RONNA ******************************************************************        
RONNA *  WRITE THE ECOM PLANNER MFT PARMS                              *        
RONNA ******************************************************************        
RONNA  7310-WRITE-ECOM-MFT-PARM-FILE1.                                          
RONNA                                                                           
RONNA      WRITE ECOM-MFT-PARM-REC.                                             
RONNA                                                                           
RONNA ******************************************************************        
RONNA *  WRITE THE ECOM PLANNER MFT PARMS                              *        
RONNA ******************************************************************        
MFTTST*7320-WRITE-ECOM-MFT-PARM-FILE2.                                          
MFTTST*                                                                         
MFTTST*    WRITE ECOM-MFT-PARM-REC2.                                            
MFTTST*                                                                         
RONNA ******************************************************************        
RONNA *  WRITE THE ECOM PLANNER MFT PARMS                              *        
RONNA ******************************************************************        
RONNA  7330-WRITE-ECOM-MFT-PARM-FILE3.                                          
RONNA                                                                           
RONNA      WRITE ECOM-MFT-PARM-REC3.                                            
RONNA                                                                           
      ******************************************************************        
      *  WRITE THE ECOM IDCAMS DELETE PARMS                            *        
      ******************************************************************        
       7400-ECOM-IDCAMS-PARM-FILE.                                              
                                                                                
           WRITE ECOM-IDCAMS-PARM-REC.                                          
                                                                                
      ******************************************************************        
      * SELECT THE GENERAL MERCHANDISE MANAGER NAME                    *        
      ******************************************************************        
       8000-SELECT-MANAGER-NAME.                                                
           MOVE '*8000-SELECT-MANAGER-NAME.       *' TO PV-PARA-NAME.           
           PERFORM VARYING PV-RETRY-CNT FROM 1 BY 1                             
             UNTIL PV-RETRY-CNT > PC-MAX-RETRY-CNT                              
             EXEC SQL                                                           
              SELECT B.WORKER_FIR_NAME,                                         
                     B.WORKER_LAST_NAME,                                        
                     A.MDSEAR_DESC                                              
               INTO  :RSPBAR-WORKER-FIR-NAME,                                   
                     :RSPBAR-WORKER-LAST-NAME,                                  
                     :MDSEAR-DESC                                               
               FROM  TMDSEAR A                                                  
                   , TRSPBAR B                                                  
               WHERE A.OPERCO_NBR  = :PC-OPERCO-NBR                             
                 AND A.GMA_NBR     = :PV-GMM-MANAGER                            
                 AND A.MDSELV_CDE  = :PC-GMA-CODE                               
                 AND A.MDSEAR_DKEY = B.MDSEAR_DKEY                              
                 AND A.OPERCO_NBR  = B.OPERCO_NBR                               
                 AND CURRENT DATE BETWEEN A.STRT_DTE AND A.END_DTE              
                 AND B.RSPLVL_CDE  = :PC-RSPLVL-GMM                             
                 AND CURRENT DATE BETWEEN B.WORKER_STRT_DTE AND                 
                     B.WORKER_END_DTE                                           
0823RM         WITH UR                                                          
             END-EXEC                                                           
      *                                                                         
             MOVE SQLCODE              TO FS-MANAGER-NAME-CODE                  
             EVALUATE TRUE                                                      
                WHEN SQLCODE = +0                                               
                   MOVE PC-MORE-THAN-MAX-RETRY TO PV-RETRY-CNT                  
                   STRING RSPBAR-WORKER-FIR-NAME                                
                          DELIMITED BY PC-FIRST-NAME-DELIM                      
                          PC-SPACE                                              
                          DELIMITED BY SIZE                                     
                      RSPBAR-WORKER-LAST-NAME                                   
                          DELIMITED BY SIZE                                     
                      INTO PV-BUYER-NAME                                        
                   END-STRING                                                   
                WHEN FS-MANAGER-NAME-NOT-FOUND                                  
                   MOVE PC-MORE-THAN-MAX-RETRY TO PV-RETRY-CNT                  
                   MOVE 'NOT ON TRSPBAR' TO PV-BUYER-NAME                       
                WHEN SQLCODE = -911                                             
                WHEN SQLCODE = -913                                             
                   CONTINUE                                                     
                WHEN OTHER                                                      
                   PERFORM 9999-SQL-ERROR                                       
             END-EVALUATE                                                       
           END-PERFORM.                                                         
      *                                                                         
           IF (SQLWARN0 NOT = SPACES                                            
             OR (SQLCODE > 0 AND SQLCODE NOT = +100)                            
             OR SQLCODE < 0)                                                    
               PERFORM 9999-SQL-ERROR                                           
           END-IF.                                                              
           EJECT                                                                
      *                                                                         
      ******************************************************************        
      * SELECT THE DIVISIONAL MERCHANDISE MANAGER NAME                 *        
      ******************************************************************        
       8005-SELECT-MANAGER-NAME.                                                
           MOVE '*8005-SELECT-MANAGER-NAME.       *' TO PV-PARA-NAME.           
           PERFORM VARYING PV-RETRY-CNT FROM 1 BY 1                             
             UNTIL PV-RETRY-CNT > PC-MAX-RETRY-CNT                              
             EXEC SQL                                                           
              SELECT B.WORKER_FIR_NAME,                                         
                     B.WORKER_LAST_NAME,                                        
                     A.MDSEAR_DESC                                              
               INTO  :RSPBAR-WORKER-FIR-NAME,                                   
                     :RSPBAR-WORKER-LAST-NAME,                                  
                     :MDSEAR-DESC                                               
               FROM  TMDSEAR A                                                  
                   , TRSPBAR B                                                  
               WHERE A.OPERCO_NBR  = :PC-OPERCO-NBR                             
                 AND A.DMA_NBR     = :PV-CALL-MANAGER                           
                 AND A.MDSELV_CDE  = :PC-MANAGER-CODE                           
                 AND A.MDSEAR_DKEY = B.MDSEAR_DKEY                              
                 AND A.OPERCO_NBR  = B.OPERCO_NBR                               
                 AND CURRENT DATE BETWEEN A.STRT_DTE AND A.END_DTE              
                 AND B.RSPLVL_CDE  = :PC-RSPLVL-MANAGER                         
                 AND CURRENT DATE BETWEEN B.WORKER_STRT_DTE AND                 
                     B.WORKER_END_DTE                                           
0823RM         WITH UR                                                          
             END-EXEC                                                           
      *                                                                         
             MOVE SQLCODE              TO FS-MANAGER-NAME-CODE                  
             EVALUATE TRUE                                                      
                WHEN SQLCODE = +0                                               
                   MOVE PC-MORE-THAN-MAX-RETRY TO PV-RETRY-CNT                  
                   STRING RSPBAR-WORKER-FIR-NAME                                
                          DELIMITED BY PC-FIRST-NAME-DELIM                      
                          PC-SPACE                                              
                          DELIMITED BY SIZE                                     
                      RSPBAR-WORKER-LAST-NAME                                   
                          DELIMITED BY SIZE                                     
                      INTO PV-BUYER-NAME                                        
                   END-STRING                                                   
                WHEN FS-MANAGER-NAME-NOT-FOUND                                  
                   MOVE PC-MORE-THAN-MAX-RETRY TO PV-RETRY-CNT                  
                   MOVE 'NOT ON TRSPBAR' TO PV-BUYER-NAME                       
                WHEN SQLCODE = -911                                             
                WHEN SQLCODE = -913                                             
                   CONTINUE                                                     
                WHEN OTHER                                                      
                   PERFORM 9999-SQL-ERROR                                       
             END-EVALUATE                                                       
           END-PERFORM.                                                         
      *                                                                         
           IF (SQLWARN0 NOT = SPACES                                            
             OR (SQLCODE > 0 AND SQLCODE NOT = +100)                            
             OR SQLCODE < 0)                                                    
               PERFORM 9999-SQL-ERROR                                           
           END-IF.                                                              
           EJECT                                                                
      *                                                                         
      ******************************************************************        
      * SELECT THE BUYER NAME                                          *        
      ******************************************************************        
       8100-SELECT-BUYER-NAME.                                                  
           MOVE '*8100-SELECT-BUYER-NAME.       *' TO PV-PARA-NAME.             
           PERFORM VARYING PV-RETRY-CNT FROM 1 BY 1                             
             UNTIL PV-RETRY-CNT > PC-MAX-RETRY-CNT                              
             EXEC SQL                                                           
              SELECT B.WORKER_FIR_NAME,                                         
                     B.WORKER_LAST_NAME                                         
               INTO  :RSPBAR-WORKER-FIR-NAME,                                   
                     :RSPBAR-WORKER-LAST-NAME                                   
               FROM  TMDSEAR A                                                  
                   , TRSPBAR B                                                  
               WHERE A.OPERCO_NBR  = :PC-OPERCO-NBR                             
                 AND A.DEPT_NBR    = :PV-CALL-DEPT                              
                 AND A.MDSELV_CDE  = :PC-DEPT-CODE                              
                 AND A.BYR_NBR     = :CB-CALL-BUYER                             
                 AND A.MDSEAR_DKEY = B.MDSEAR_DKEY                              
                 AND A.OPERCO_NBR  = B.OPERCO_NBR                               
                 AND B.RSPLVL_CDE  = :PC-RSPLVL-BUYER                           
                 AND CURRENT DATE BETWEEN A.STRT_DTE AND A.END_DTE              
                 AND CURRENT DATE BETWEEN B.WORKER_STRT_DTE AND                 
                     B.WORKER_END_DTE                                           
0823RM         WITH UR                                                          
             END-EXEC                                                           
      *                                                                         
             MOVE SQLCODE              TO FS-BUYER-NAME-CODE                    
             EVALUATE TRUE                                                      
                WHEN SQLCODE = +0                                               
                   MOVE PC-MORE-THAN-MAX-RETRY TO PV-RETRY-CNT                  
                   STRING RSPBAR-WORKER-FIR-NAME                                
                          DELIMITED BY PC-FIRST-NAME-DELIM                      
                      PC-SPACE                                                  
                          DELIMITED BY SIZE                                     
                      RSPBAR-WORKER-LAST-NAME                                   
                          DELIMITED BY SIZE                                     
                      INTO PV-BUYER-NAME                                        
                   END-STRING                                                   
                WHEN FS-BUYER-NAME-NOT-FOUND                                    
                   MOVE PC-MORE-THAN-MAX-RETRY TO PV-RETRY-CNT                  
                   MOVE 'NOT ON TRSPBAR' TO PV-BUYER-NAME                       
                WHEN SQLCODE = -911                                             
                WHEN SQLCODE = -913                                             
                   CONTINUE                                                     
                WHEN OTHER                                                      
                   PERFORM 9999-SQL-ERROR                                       
             END-EVALUATE                                                       
           END-PERFORM.                                                         
      *                                                                         
           IF (SQLWARN0 NOT = SPACES                                            
             OR (SQLCODE > 0 AND SQLCODE NOT = +100)                            
             OR SQLCODE < 0)                                                    
               PERFORM 9999-SQL-ERROR                                           
           END-IF.                                                              
      *                                                                         
      ******************************************************************        
      *  RETRIEVE SUBCLASSS DESCRIPTION FROM MBS TABLES                *        
      ******************************************************************        
       8200-SELECT-SUBCLASS-DESC.                                               
           MOVE '*8200-SELECT-SUBCLASS-DESC     *' TO PV-PARA-NAME.             
           PERFORM                                                              
              VARYING PV-RETRY-CNT                                              
              FROM 1 BY 1                                                       
              UNTIL   PV-RETRY-CNT > PC-MAX-RETRY-CNT                           
                                                                                
               EXEC SQL                                                         
                  SELECT MDSEAR_DESC                                            
                        ,MDSEAR_DKEY                                            
                   INTO  :MDSEAR-DESC                                           
                        ,:MDSEAR-DKEY                                           
                   FROM  TMDSEAR                                                
                   WHERE OPERCO_NBR = :PC-OPERCO-NBR                            
                     AND DEPT_NBR   = :PV-CALL-DEPT                             
                     AND MAJ_CL_NBR = :TC-TMDSEAR-CLASS                         
                     AND SUB_CL_NBR = :TS-TMDSEAR-SUBCLASS                      
                     AND MDSELV_CDE = :PC-SUB-CLASS                             
                     AND CURRENT DATE BETWEEN STRT_DTE AND END_DTE              
0823RM             WITH UR                                                      
               END-EXEC                                                         
                                                                                
             EVALUATE TRUE                                                      
                WHEN SQLCODE = +0                                               
                   MOVE PC-MORE-THAN-MAX-RETRY TO PV-RETRY-CNT                  
                WHEN SQLCODE = +100                                             
                   MOVE PC-MORE-THAN-MAX-RETRY TO PV-RETRY-CNT                  
                   MOVE ZEROES TO MDSEAR-DKEY                                   
                   MOVE 'NOT ON TMDSEAR' TO MDSEAR-DESC                         
                WHEN SQLCODE = -911                                             
                WHEN SQLCODE = -913                                             
                   CONTINUE                                                     
                WHEN OTHER                                                      
                   PERFORM 9999-SQL-ERROR                                       
             END-EVALUATE                                                       
           END-PERFORM.                                                         
                                                                                
           IF (SQLWARN0 NOT = SPACES                                            
             OR (SQLCODE > 0 AND SQLCODE NOT = +100)                            
             OR SQLCODE < 0)                                                    
               PERFORM 9999-SQL-ERROR                                           
           END-IF.                                                              
                                                                                
      *                                                                         
      ******************************************************************        
      *  RETRIEVE MAJOR CLASSS DESCRIPTION FROM MBS TABLES             *        
      ******************************************************************        
       8250-SELECT-MAJCLASS-DESC.                                               
           MOVE '*8250-SELECT-MAJCLASS-DESC     *' TO PV-PARA-NAME.             
           PERFORM                                                              
              VARYING PV-RETRY-CNT                                              
              FROM 1 BY 1                                                       
              UNTIL   PV-RETRY-CNT > PC-MAX-RETRY-CNT                           
                                                                                
               EXEC SQL                                                         
                  SELECT MDSEAR_DESC                                            
                   INTO  :MDSEAR-DESC                                           
                   FROM  TMDSEAR                                                
                   WHERE OPERCO_NBR = :PC-OPERCO-NBR                            
                     AND DEPT_NBR   = :PV-CALL-DEPT                             
                     AND MAJ_CL_NBR = :TC-TMDSEAR-CLASS                         
                     AND MDSELV_CDE = :PC-MAJ-CLASS                             
                     AND CURRENT DATE BETWEEN STRT_DTE AND END_DTE              
0823RM             WITH UR                                                      
               END-EXEC                                                         
                                                                                
             EVALUATE TRUE                                                      
                WHEN SQLCODE = +0                                               
                   MOVE PC-MORE-THAN-MAX-RETRY TO PV-RETRY-CNT                  
                WHEN SQLCODE = +100                                             
                   MOVE PC-MORE-THAN-MAX-RETRY TO PV-RETRY-CNT                  
                   MOVE 'NOT ON TMDSEAR' TO MDSEAR-DESC                         
                WHEN SQLCODE = -911                                             
                WHEN SQLCODE = -913                                             
                   CONTINUE                                                     
                WHEN OTHER                                                      
                   PERFORM 9999-SQL-ERROR                                       
             END-EVALUATE                                                       
           END-PERFORM.                                                         
                                                                                
           IF (SQLWARN0 NOT = SPACES                                            
             OR (SQLCODE > 0 AND SQLCODE NOT = +100)                            
             OR SQLCODE < 0)                                                    
               PERFORM 9999-SQL-ERROR                                           
           END-IF.                                                              
      *                                                                         
      ******************************************************************        
      *  RETRIEVE DEPARTMENT DESCRIPTION FROM MBS TABLES               *        
      ******************************************************************        
       8300-SELECT-DEPT-NAME.                                                   
           MOVE '*8300-SELECT-DEPT-NAME         *' TO PV-PARA-NAME.             
           PERFORM                                                              
              VARYING PV-RETRY-CNT                                              
              FROM 1 BY 1                                                       
              UNTIL   PV-RETRY-CNT > PC-MAX-RETRY-CNT                           
                                                                                
               EXEC SQL                                                         
                  SELECT MDSEAR_DESC                                            
                   INTO  :MDSEAR-DESC                                           
                   FROM  TMDSEAR                                                
                   WHERE OPERCO_NBR = :PC-OPERCO-NBR                            
                     AND DEPT_NBR   = :PV-CALL-DEPT                             
                     AND MDSELV_CDE = :PC-DEPT-CODE                             
                     AND CURRENT DATE BETWEEN STRT_DTE AND END_DTE              
0823RM             WITH UR                                                      
               END-EXEC                                                         
              EVALUATE TRUE                                                     
                 WHEN SQLCODE = +0                                              
                    MOVE PC-MORE-THAN-MAX-RETRY TO PV-RETRY-CNT                 
                 WHEN SQLCODE = +100                                            
                    MOVE PC-MORE-THAN-MAX-RETRY TO PV-RETRY-CNT                 
                    MOVE 'NOT ON TMDSEAR' TO MDSEAR-DESC                        
                 WHEN SQLCODE = -911                                            
                 WHEN SQLCODE = -913                                            
                    CONTINUE                                                    
                 WHEN OTHER                                                     
                    PERFORM 9999-SQL-ERROR                                      
              END-EVALUATE                                                      
           END-PERFORM.                                                         
                                                                                
           IF (SQLWARN0 NOT = SPACES                                            
             OR (SQLCODE > 0 AND SQLCODE NOT = +100)                            
             OR SQLCODE < 0)                                                    
               PERFORM 9999-SQL-ERROR                                           
           END-IF.                                                              
                                                                                
      *                                                                         
      ******************************************************************        
      * GET VENDOR STYLE MANAGEMENT CHARACTERISTIC DESCRIPTIONS                 
      ******************************************************************        
       8400-GET-VSM-DESC.                                                       
           MOVE '*8400-GET-VSM-DESC.   *' TO PV-PARA-NAME.                      
                                                                                
           MOVE SPACES TO VSCHVL-CHARTC-VAL-DESC                                
           PERFORM VARYING PV-RETRY-CNT FROM 1 BY 1                             
             UNTIL PV-RETRY-CNT > PC-MAX-RETRY-CNT                              
                                                                                
             EXEC SQL                                                           
                 SELECT  CHARTC_VAL_DESC                                        
                   INTO  :VSCHVL-CHARTC-VAL-DESC                                
                   FROM  TVSCHVL                                                
                  WHERE  CHARTC_CDE       = :PV-CHARTC-CDE                      
                    AND  CHARTC_SEQ_NBR   = :PV-CHARTC-SEQ-NBR                  
0823RM             WITH UR                                                      
             END-EXEC                                                           
                                                                                
             EVALUATE TRUE                                                      
                 WHEN SQLCODE = +0                                              
                 WHEN SQLCODE = +100                                            
                   MOVE PC-MORE-THAN-MAX-RETRY TO PV-RETRY-CNT                  
                 WHEN SQLCODE = -911                                            
                 WHEN SQLCODE = -913                                            
                   CONTINUE                                                     
                 WHEN OTHER                                                     
                   PERFORM 9999-SQL-ERROR                                       
             END-EVALUATE                                                       
           END-PERFORM.                                                         
                                                                                
           IF  (SQLWARN0 NOT = SPACES                                           
               OR (SQLCODE > 0 AND SQLCODE NOT = +100)                          
               OR SQLCODE < 0)                                                  
               PERFORM 9999-SQL-ERROR                                           
           END-IF.                                                              
                                                                                
      ******************************************************************        
      * GET VENDOR STYLE MANAGEMENT CHARACTERISTIC DESCRIPTIONS                 
      ******************************************************************        
       8450-GET-VSM-DESC.                                                       
           MOVE '*8450-GET-VSM-DESC.   *' TO PV-PARA-NAME.                      
                                                                                
           MOVE SPACES TO VSCHVL-CHARTC-VAL-DESC                                
           PERFORM VARYING PV-RETRY-CNT FROM 1 BY 1                             
             UNTIL PV-RETRY-CNT > PC-MAX-RETRY-CNT                              
                                                                                
             EXEC SQL                                                           
                 SELECT  CHARTC_VAL_DESC                                        
                   INTO  :VSCHVL-CHARTC-VAL-DESC                                
                   FROM  TVSCHVL                                                
                  WHERE  CHARTC_CDE       = :PV-CHARTC-CDE                      
                    AND  CHARTC_SEQ_NBR   = :PV-MDSE-LBL-SEQ-NBR                
0823RM             WITH UR                                                      
             END-EXEC                                                           
                                                                                
             EVALUATE TRUE                                                      
                 WHEN SQLCODE = +0                                              
                 WHEN SQLCODE = +100                                            
                   MOVE PC-MORE-THAN-MAX-RETRY TO PV-RETRY-CNT                  
                 WHEN SQLCODE = -911                                            
                 WHEN SQLCODE = -913                                            
                   CONTINUE                                                     
                 WHEN OTHER                                                     
                   PERFORM 9999-SQL-ERROR                                       
             END-EVALUATE                                                       
           END-PERFORM.                                                         
                                                                                
           IF  (SQLWARN0 NOT = SPACES                                           
               OR (SQLCODE > 0 AND SQLCODE NOT = +100)                          
               OR SQLCODE < 0)                                                  
               PERFORM 9999-SQL-ERROR                                           
           END-IF.                                                              
                                                                                
W34688******************************************************************        
W34688* GET THE ITEM'S EXTENDED SIZE DESCRIPTION FROM IMT_EXTD_SZ               
W34688* TABLE                                                                   
W34688******************************************************************        
W34688 8500-SELECT-EXTD-SIZE.                                                   
W34688     MOVE '*8500-SELECT-EXTD-SIZE*' TO PV-PARA-NAME.                      
W34688     MOVE SPACES                    TO IMT00025-EXTD-SZ-DESC              
                                             IMT00025-EXTD-SZ-CDE.              
W34688                                                                          
W34688     PERFORM VARYING PV-RETRY-CNT FROM 1 BY 1                             
W34688       UNTIL PV-RETRY-CNT > PC-MAX-RETRY-CNT                              
W34688                                                                          
W34688       EXEC SQL                                                           
W34688           SELECT  EXTD_SZ_DESC                                           
                        ,A.EXTD_SZ_CDE                                          
W34688             INTO  :IMT00025-EXTD-SZ-DESC                                 
                        ,:IMT00025-EXTD-SZ-CDE                                  
W34688             FROM  IMT_EXTD_SZ  A ,                                       
W34688                   TSIZE        B                                         
W34688            WHERE  B.KOHLS_SIZE_CDE = :SIZE-KOHLS-SIZE-CDE                
W34688            AND B.EXTD_SZ_CDE = A.EXTD_SZ_CDE                             
W34688            AND B.EXTD_SZ_CDE IS NOT NULL                                 
0823RM          WITH UR                                                         
W34688       END-EXEC                                                           
W34688                                                                          
W34688       EVALUATE TRUE                                                      
W34688           WHEN SQLCODE = +0                                              
W34688           WHEN SQLCODE = +100                                            
W34688             MOVE PC-MORE-THAN-MAX-RETRY TO PV-RETRY-CNT                  
W34688           WHEN SQLCODE = -911                                            
W34688           WHEN SQLCODE = -913                                            
W34688             CONTINUE                                                     
W34688           WHEN OTHER                                                     
W34688             PERFORM 9999-SQL-ERROR                                       
W34688       END-EVALUATE                                                       
W34688     END-PERFORM.                                                         
W34688                                                                          
W34688     IF  (SQLWARN0 NOT = SPACES                                           
W34688         OR (SQLCODE > 0 AND SQLCODE NOT = +100)                          
W34688         OR SQLCODE < 0)                                                  
W34688         PERFORM 9999-SQL-ERROR                                           
W34688     END-IF.                                                              
                                                                                
      ******************************************************************        
      * SELECT INTERNAL UPC_ID, INTERNAL UPC_NBR AND VS_ID             *        
      ******************************************************************        
       8600-SELECT-INTR-UPC.                                                    
**TEMP*    DISPLAY '8600-SELECT-INTR-UPC  SKU: ' SKXREF-SKU                     
                                                                                
           MOVE '8600-SELECT-INTR-UPC' TO PV-PARA-NAME.                         
                                                                                
           PERFORM VARYING PV-RETRY-CNT FROM 1 BY 1                             
             UNTIL PV-RETRY-CNT > PC-MAX-RETRY-CNT                              
                                                                                
               EXEC SQL                                                         
                  SELECT A.INTR_UPC_ID                                          
                        ,B.UPC_NBR                                              
                        ,B.VS_ID                                                
                   INTO :SKXREF-INTR-UPC-ID                                     
                       ,:UPC-UPC-NBR                                            
                       ,:UPC-VS-ID                                              
                    FROM TSKXREF A                                              
                        ,TUPC B                                                 
                 WHERE   A.SKU = :SKXREF-SKU                                    
                   AND   A.INTR_UPC_ID = B.INTR_UPC_ID                          
                   AND   B.UPC_TYP_CDE = 'I'                                    
                  WITH UR                                                       
               END-EXEC                                                         
**TEMP**** FORCE A SQL RETURN CODE OF -911                                      
**TEMP*    MOVE -911 TO SQLCODE                                                 
              EVALUATE TRUE                                                     
                 WHEN SQLCODE = +0                                              
                    MOVE PC-MORE-THAN-MAX-RETRY TO PV-RETRY-CNT                 
                 WHEN SQLCODE = +100                                            
                    MOVE PC-MORE-THAN-MAX-RETRY TO PV-RETRY-CNT                 
                    MOVE ZEROS  TO SKXREF-INTR-UPC-ID                           
                 WHEN SQLCODE = -911                                            
                 WHEN SQLCODE = -913                                            
                    CONTINUE                                                    
                 WHEN OTHER                                                     
                    PERFORM 9999-SQL-ERROR                                      
              END-EVALUATE                                                      
           END-PERFORM.                                                         
                                                                                
**TEMP*    DISPLAY 'SQLWARN0 ' SQLWARN0.                                        
**TEMP*    DISPLAY 'SQLCODE  ' SQLCODE.                                         
**TEMP*    DISPLAY 'SKXREF-INTR-UPC-ID ' SKXREF-INTR-UPC-ID.                    
                                                                                
           IF (SQLWARN0 NOT = SPACES                                            
             OR (SQLCODE > 0 AND SQLCODE NOT = +100)                            
             OR SQLCODE < 0)                                                    
               PERFORM 9999-SQL-ERROR                                           
           END-IF.                                                              
                                                                                
      ******************************************************************        
      * POPULATE DATA FROM TABLES TMDARVS, TVNDSTL, TEXTENT            *        
      ******************************************************************        
       8650-POPULATE-VENDOR-STYLE.                                              
                                                                                
           MOVE '8650-POPULATE-VENDOR-STYLE' TO PV-PARA-NAME.                   
**TEMP*    DISPLAY PV-PARA-NAME.                                                
           MOVE PV-MDSEAR-DKEY           TO MDARVS-SUB-CL-MDSEAR-ID.            
           MOVE FS126-LONG-VENDOR-STYLE  TO VNDSTL-VS-NBR.                      
**TEMP*    DISPLAY 'MDARVS-SUB-CL-MDSEAR-ID ' MDARVS-SUB-CL-MDSEAR-ID           
**TEMP*    DISPLAY 'VNDSTL-VS-NBR           ' VNDSTL-VS-NBR                     
**TEMP*    DISPLAY 'UPC-VS-ID               ' UPC-VS-ID                         
                                                                                
           PERFORM VARYING PV-RETRY-CNT FROM 1 BY 1                             
             UNTIL PV-RETRY-CNT > PC-MAX-RETRY-CNT                              
                                                                                
               EXEC SQL                                                         
                  SELECT A.VS_DESC                                              
                       , A.ACTV_IND                                             
                       , B.ENT_ID                                               
                       , C.DUN_NBR                                              
                   INTO :MDARVS-VS-DESC                                         
                       ,:MDARVS-ACTV-IND                                        
                       ,:VNDSTL-ENT-ID                                          
                       ,:EXTENT-DUN-NBR                                         
                    FROM TMDARVS A                                              
                       , TVNDSTL B                                              
                       , TEXTENT C                                              
                 WHERE   A.SUB_CL_MDSEAR_ID = :MDARVS-SUB-CL-MDSEAR-ID          
                   AND   B.VS_NBR           = :VNDSTL-VS-NBR                    
                   AND   A.VS_ID            = :UPC-VS-ID                        
                   AND   A.VS_ID            = B.VS_ID                           
                   AND   C.ENT_ID           = B.ENT_ID                          
                   AND ((B.EFF_BEG_DTE     <= CURRENT DATE)                     
                   AND ((B.EFF_END_DTE     >= CURRENT DATE)                     
                    OR  (B.EFF_END_DTE     IS NULL)))                           
                  WITH UR                                                       
               END-EXEC                                                         
**TEMP**** FORCE A SQL RETURN CODE OF -911                                      
**TEMP*    MOVE -911 TO SQLCODE                                                 
**TEMP*       DISPLAY 'SQLCODE ' SQLCODE                                        
**TEMP*    DISPLAY 'MDARVS-VS-DESC          ' MDARVS-VS-DESC                    
**TEMP*    DISPLAY 'MDARVS-ACTV-IND         ' MDARVS-ACTV-IND                   
**TEMP*    DISPLAY 'VNDSTL-ENT-ID           ' VNDSTL-ENT-ID                     
**TEMP*    DISPLAY 'EXTENT-DUN-NBR          ' EXTENT-DUN-NBR                    
              EVALUATE TRUE                                                     
                 WHEN SQLCODE = +0                                              
                    MOVE PC-MORE-THAN-MAX-RETRY TO PV-RETRY-CNT                 
                 WHEN SQLCODE = +100                                            
                    MOVE PC-MORE-THAN-MAX-RETRY TO PV-RETRY-CNT                 
                    MOVE SPACES TO MDARVS-VS-DESC                               
                                   EXTENT-DUN-NBR                               
                    MOVE ZEROS  TO VNDSTL-ENT-ID                                
                 WHEN SQLCODE = -911                                            
                 WHEN SQLCODE = -913                                            
                    CONTINUE                                                    
                 WHEN OTHER                                                     
                    PERFORM 9999-SQL-ERROR                                      
              END-EVALUATE                                                      
           END-PERFORM.                                                         
                                                                                
           IF (SQLWARN0 NOT = SPACES                                            
             OR (SQLCODE > 0 AND SQLCODE NOT = +100)                            
             OR SQLCODE < 0)                                                    
               PERFORM 9999-SQL-ERROR                                           
           END-IF.                                                              
      **************************************************************            
      * PROCESS A CURSOR TO GET VENDOR UPC NUMBERS                              
      **************************************************************            
       8700-SELECT-VENDOR-UPCS.                                                 
**TEMP*    DISPLAY '8700-SELECT-VENDOR-UPCS '.                                  
           MOVE '*8700-SELECT-VENDOR-UPCS      *' TO PV-PARA-NAME.              
           SET PS-NOT-EOF-UPC-CSR    TO TRUE.                                   
           PERFORM 8710-OPEN-UPC-CSR.                                           
           PERFORM 8720-PROCESS-UPC-CSR                                         
               UNTIL PS-EOF-UPC-CSR.                                            
           PERFORM 8730-CLOSE-UPC-CSR.                                          
      ******************************************************************        
      *  OPENS UPC CURSOR                                                       
      ******************************************************************        
       8710-OPEN-UPC-CSR.                                                       
**temp*    DISPLAY '8710-OPEN-UPC-CSR'.                                         
                                                                                
           MOVE '8710-OPEN-UPC-CSR' TO PV-PARA-NAME.                            
                                                                                
           PERFORM VARYING PV-RETRY-CNT FROM 1 BY 1                             
             UNTIL PV-RETRY-CNT > PC-MAX-RETRY-CNT                              
                                                                                
               EXEC SQL                                                         
                   OPEN UPC_CURSOR                                              
               END-EXEC                                                         
                                                                                
**TEMP**** FORCE A SQL RETURN CODE OF -911                                      
**TEMP*    MOVE -911 TO SQLCODE                                                 
**TEMP*    DISPLAY 'SQLWARN0 ' SQLWARN0                                         
**TEMP*    DISPLAY 'SQLCODE  ' SQLCODE                                          
                                                                                
              EVALUATE TRUE                                                     
                 WHEN SQLCODE = +0                                              
                    MOVE PC-MORE-THAN-MAX-RETRY TO PV-RETRY-CNT                 
                 WHEN SQLCODE = +100                                            
                    MOVE PC-MORE-THAN-MAX-RETRY TO PV-RETRY-CNT                 
                    MOVE SPACES TO MDARVS-VS-DESC                               
                                   EXTENT-DUN-NBR                               
                    MOVE ZEROS  TO VNDSTL-ENT-ID                                
                 WHEN SQLCODE = -911                                            
                 WHEN SQLCODE = -913                                            
                    CONTINUE                                                    
                 WHEN OTHER                                                     
                    PERFORM 9999-SQL-ERROR                                      
              END-EVALUATE                                                      
           END-PERFORM.                                                         
                                                                                
0823RM*    IF (SQLWARN0 NOT = SPACES                                            
0823RM*      OR (SQLCODE > 0 AND SQLCODE NOT = +100)                            
0823RM*      OR SQLCODE < 0)                                                    
0823RM*        PERFORM 9999-SQL-ERROR                                           
0823RM*    END-IF.                                                              
0823RM     IF (SQLWARN0 NOT = SPACES)                                           
0823RM       OR (SQLCODE > 0 AND SQLCODE NOT = +100)                            
0823RM       OR (SQLCODE < 0)                                                   
0823RM         PERFORM 9999-SQL-ERROR                                           
0823RM     END-IF.                                                              
                                                                                
      ******************************************************************        
      *  FETCHS UPC CURSOR                                                      
      *****************************************************************         
       8720-PROCESS-UPC-CSR.                                                    
**TEMP*    DISPLAY '8720-PROCESS-UPC-CSR'.                                      
           MOVE '8720-PROCESS-UPC-CSR' TO PV-PARA-NAME.                         
           MOVE ZEROES TO FS133-VNDR-UPC-1                                      
                          FS133-VNDR-UPC-2.                                     
           MOVE +1     TO PV-UPC-COUNT.                                         
                                                                                
           PERFORM VARYING PV-RETRY-CNT FROM 1 BY 1                             
             UNTIL PV-RETRY-CNT > PC-MAX-RETRY-CNT                              
               EXEC SQL                                                         
                  FETCH UPC_CURSOR                                              
                   INTO :UPC-UPC-NBR                                            
               END-EXEC                                                         
                                                                                
**TEMP**** FORCE A SQL RETURN CODE OF -911                                      
**TEMP*    MOVE -911 TO SQLCODE                                                 
**TEMP*    DISPLAY 'SQLWARN0 ' SQLWARN0                                         
**TEMP*    DISPLAY 'SQLCODE  ' SQLCODE                                          
**TEMP*    DISPLAY ':UPC-UPC-NBR ' UPC-UPC-NBR                                  
                                                                                
              EVALUATE TRUE                                                     
                 WHEN SQLCODE = +0                                              
                    IF PV-UPC-COUNT = +1                                        
                       MOVE UPC-UPC-NBR  TO FS133-VNDR-UPC-1                    
                       MOVE +2     TO PV-UPC-COUNT                              
                    ELSE                                                        
                    IF PV-UPC-COUNT = +2                                        
                       MOVE UPC-UPC-NBR  TO FS133-VNDR-UPC-2                    
                       MOVE PC-MORE-THAN-MAX-RETRY TO PV-RETRY-CNT              
                       SET PS-EOF-UPC-CSR   TO TRUE                             
                    END-IF                                                      
                    END-IF                                                      
                 WHEN SQLCODE = +100                                            
                       MOVE PC-MORE-THAN-MAX-RETRY TO PV-RETRY-CNT              
                       SET PS-EOF-UPC-CSR   TO TRUE                             
                 WHEN SQLCODE = -911                                            
                 WHEN SQLCODE = -913                                            
**TEMP*             DISPLAY 'HITTING -911 / -913 RETURN CODE CONTINUE'          
                    CONTINUE                                                    
                 WHEN OTHER                                                     
                    PERFORM 9999-SQL-ERROR                                      
              END-EVALUATE                                                      
           END-PERFORM.                                                         
0823RM     IF (SQLWARN0 NOT = SPACES)                                           
0823RM       OR (SQLCODE > 0 AND SQLCODE NOT = +100)                            
0823RM       OR (SQLCODE < 0)                                                   
0823RM         PERFORM 9999-SQL-ERROR                                           
0823RM     END-IF.                                                              
      ******************************************************************        
      *  CLOSE UPC CURSOR                                                       
      ******************************************************************        
       8730-CLOSE-UPC-CSR.                                                      
**TEMP*    DISPLAY '8730-CLOSE-UPC-CSR'.                                        
           MOVE '8730-CLOSE-UPC-CSR' TO PV-PARA-NAME.                           
                                                                                
           EXEC SQL                                                             
               CLOSE UPC_CURSOR                                                 
           END-EXEC.                                                            
                                                                                
                                                                                
**TEMP*    DISPLAY 'SQLWARN0 ' SQLWARN0                                         
**TEMP*    DISPLAY 'SQLCODE  ' SQLCODE                                          
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = +0                                                
                   CONTINUE                                                     
               WHEN OTHER                                                       
                   PERFORM 9999-SQL-ERROR                                       
           END-EVALUATE.                                                        
                                                                                
      **************************************************************            
      * RETREIVE TWEBITM INFO                                                   
      **************************************************************            
       8800-SELECT-WEBITM-INFO.                                                 
           MOVE '*8800-SELECT-WEBITM-INFO.     *' TO PV-PARA-NAME.              
                                                                                
           PERFORM VARYING PV-RETRY-CNT FROM 1 BY 1                             
             UNTIL PV-RETRY-CNT > PC-MAX-RETRY-CNT                              
                                                                                
               EXEC SQL                                                         
                  SELECT  SHIP_SRVC_SEQ_NBR                                     
                        , SHIP_RSTRC_SEQ_NBR                                    
                        , SHIP_GP_SEQ_NBR                                       
                        , SHIP_SRCHG_FEE_AMT                                    
                    INTO :WEBITM-SHIP-SRVC-SEQ-NBR                              
                        ,:WEBITM-SHIP-RSTRC-SEQ-NBR                             
                        ,:WEBITM-SHIP-GP-SEQ-NBR                                
                        ,:WEBITM-SHIP-SRCHG-FEE-AMT                             
                    FROM TWEBITM                                                
                  WHERE INTR_UPC_ID   = :PV-INTR-UPC-ID                         
                    AND EFF_END_TMST IS NULL                                    
0823RM            WITH UR                                                       
               END-EXEC                                                         
**TEMP**** FORCE A SQL RETURN CODE OF -911                                      
**TEMP*    MOVE -911 TO SQLCODE                                                 
              EVALUATE TRUE                                                     
                 WHEN SQLCODE = +0                                              
                    MOVE PC-MORE-THAN-MAX-RETRY TO PV-RETRY-CNT                 
                 WHEN SQLCODE = +100                                            
                    MOVE PC-MORE-THAN-MAX-RETRY TO PV-RETRY-CNT                 
                    MOVE ZEROS  TO WEBITM-SHIP-SRVC-SEQ-NBR                     
                                   WEBITM-SHIP-RSTRC-SEQ-NBR                    
                                   WEBITM-SHIP-GP-SEQ-NBR                       
                                   WEBITM-SHIP-SRCHG-FEE-AMT                    
                 WHEN SQLCODE = -911                                            
                 WHEN SQLCODE = -913                                            
                    CONTINUE                                                    
                 WHEN OTHER                                                     
                    PERFORM 9999-SQL-ERROR                                      
              END-EVALUATE                                                      
           END-PERFORM.                                                         
                                                                                
0823RM     IF (SQLWARN0 NOT = SPACES)                                           
0823RM       OR (SQLCODE > 0 AND SQLCODE NOT = +100)                            
0823RM       OR (SQLCODE < 0)                                                   
0823RM         PERFORM 9999-SQL-ERROR                                           
0823RM     END-IF.                                                              
      ******************************************************************        
      *    9900-EOJ-LOGIC.                                             *        
      *      THIS IS PERFORMED AT END OF INPUT FILE.                   *        
      *      PURPOSE: CLOSE ALL FILES                                  *        
      ******************************************************************        
       9900-EOJ-LOGIC.                                                          
                                                                                
           CLOSE ECOM-SKU-EXTR-FILE                                             
                 ECOM-MFT-PARM-FILE                                             
MFTTST*          ECOM-MFT-PARM-FILE2                                            
                 ECOM-COMMA-DEL-SKU-EXTR-FIL2                                   
                 ECOM-IDCAMS-PARM-FILE.                                         
                                                                                
      ******************************************************************        
      * PROGRAM ABEND PARAGRAPH                                                 
      ******************************************************************        
       9990-ABEND.                                                              
                                                                                
           CALL 'ILBOABN0'  USING PV-ABEND-CODE.                                
                                                                                
      ******************************************************************        
      * ABEND ROUTINE FOR BAD SQL CALLS                                *        
      ******************************************************************        
       9999-SQL-ERROR.                                                          
           DISPLAY '** ABEND **          = SQL ERROR'.                          
           DISPLAY '** PROGRAM **        = FSKUT150'                            
           DISPLAY '** PARAGRAPH **      = ' PV-PARA-NAME.                      
           MOVE    SQLCODE  TO PV-SQLCODE.                                      
           DISPLAY '** SQLCODE   **      = ' PV-SQLCODE.                        
0823RM     PERFORM 9990-ABEND.                                                  
      *                                                                         
                                                                                
      *----------------------------------------------------------               
      *  DYNAMIC ALLOCATION ROUTINE                                             
      *----------------------------------------------------------               
      *DP023-0000-DYNALC.                                                       
           COPY DPPD023.                                                        
                                                                                
      ******************************************************************        
      *    END OF SOURCE CODE FOR FSKUT150                             *        
      ******************************************************************        
