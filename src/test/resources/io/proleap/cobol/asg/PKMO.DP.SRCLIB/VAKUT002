       IDENTIFICATION DIVISION.                                         00010005
W34517 PROGRAM-ID.    VAKUT002.                                         00020026
       AUTHOR.        PAUL KEBER - STRATAGEM.                           00030005
       INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040005
       DATE-WRITTEN.  01-25-99.                                         00050005
       DATE-COMPILED.                                                   00060005
                                                                        00070015
W34517****IMPORTANT*****************************************************00071026
W34517* THIS IS A CLONE OF THE INKUT002 CREATED FOR THE VA PROJECT     *00072026
W34517* THE MAJOR CHANGES ARE .....                                    *00073026
W34517******************************************************************00074026
      ******************************************************************00080005
      *      INKUT002 - CREATE MONTHLY DEPT/SUBCLASS TABLE UNLOAD       00090005
      *                 CONTROL CARD                                    00100005
      ******************************************************************00110005
      *                                                                 00120005
      *  THIS PROGRAM WILL CREATE A PLATINUM UNLOAD WHERE CLAUSE DATE   00130005
W34517*  CONTROL CARD TO BE USED IN UNLOADING MLT_MNLY_VND RECS FOR THE 00140027
      *  SALES BASE FOR INVENTORY REPORT PROGRAM.                       00150005
      *                                                                 00160005
      *CHANGE HISTORY:                                                  00170010
      * WR/PROJ DATE       PGMR        DESCRIPTION OF CHANGES           00180010
      * ------- ---------- ----------- -------------------------------- 00190010
      ******************************************************************00200010
      *    MODIFIED  02/18/1999  BY: TESS BESTE      PROJECT: WR20839   00210005
      *                                                                 00220005
      *  - CHANGES FOR CREATION OF COMMON SALES BASE PROCESS.           00230005
      *    PROGRAM WAS USING THE MONTH-END DATE OF THE MONTH PRIOR TO   00240005
      *    THE OPEN MONTH IN THE WHERE CLAUSE. CHANGED IT TO USE THE    00250005
      *    MONTH-END DATE OF THE OPEN MONTH.                            00260005
      *                                                                 00270005
      ******************************************************************00280010
RB0600*    MODIFIED  06/02/2000  BY: RONNA BUTZ      PROJECT: WR21015   00290005
RB0600*                                                                 00300005
RB0600*  - CREATE ANOTHER OUTPUT FILE THAT CONTAINS A WHERE CLAUSE      00310005
RB0600*    WITH FISCAL WEEK END DATE BETWEEN THE FIRST DAY OF THE OPEN  00320005
RB0600*    MONTH AND THE LAST DAY OF THE OPEN MONTH.                    00330005
RB0600*                                                                 00340005
      ******************************************************************00350005
RB0901*    MODIFIED  09/27/2001  BY: RONNA BUTZ      PROJECT: WR        00360007
RB0901*                                                                 00370007
RB0901*  - NEEDED TO MAKE MODIFICATIONS TO THE WHERE CLAUSE FOR THE     00380007
RB0901*    SHRINK TABLE UNLOAD BECAUSE IT HAD THE WORD 'BETWEEN' IN IT. 00390007
RB0901*    "BETWEEN" IS NOT SUPPORTED IN THE VERSION OF BMC THAT IS     00400007
RB0901*    GETTING INSTALLED.  MODIFIED THE BETWEEN TO USE >= AND <=.   00410007
RB0901*                                                                 00420007
W20445* W20445  09-01-2004 ROD JANSSEN DETAILED INVNENTORY ADJUSTMENT   00430010
W27710* W27710  02-20-2005 S JACKSON PARTN-NBR-CSR SELECT CURR MN PARTS 00440021
W27710*                    PGM WILL ONLY SELECT CURRENT MONTH DATA.     00450021
W34517* W34517  10-14-2008 IN-VA INVENTORY STREAM SPLIT                 00451026
W35378* W35378  04-15-2009 T KONTAROVICH BMC TO DSNTIAUL CONVERSION     00452028
W35378*                    CHANGE 'PART' TO 'WHERE PARTN_NBR IN' CLAUSE.00453028
      ******************************************************************00460007
      *                                                                 00470005
       ENVIRONMENT DIVISION.                                            00480005
       CONFIGURATION SECTION.                                           00490005
       SOURCE-COMPUTER.        IBM-3090.                                00500005
       OBJECT-COMPUTER.        IBM-3090.                                00510005
       INPUT-OUTPUT SECTION.                                            00520005
       FILE-CONTROL.                                                    00530005
                                                                        00540005
W02445     SELECT MLTMNLYSUM-DATE-CNTL-FILE                             00550010
               ASSIGN TO OUT01.                                         00560005
                                                                        00570005
RB0600     SELECT TWKSHNK-DATE-CNTL-FILE                                00580005
RB0600         ASSIGN TO OUT02.                                         00590005
RB0600                                                                  00600005
       DATA DIVISION.                                                   00610005
       FILE SECTION.                                                    00620005
                                                                        00630005
W20445 FD  MLTMNLYSUM-DATE-CNTL-FILE                                    00640010
           RECORDING MODE IS F                                          00650005
           LABEL RECORDS ARE STANDARD                                   00660005
           BLOCK CONTAINS 0 RECORDS.                                    00670005
                                                                        00680005
W20445 01  MLTMNLYSUM-DATE-CNTL-RECORD PIC X(80).                       00690010
      *                                                                 00700005
RB0600 FD  TWKSHNK-DATE-CNTL-FILE                                       00710005
RB0600     RECORDING MODE IS F                                          00720005
RB0600     LABEL RECORDS ARE STANDARD                                   00730005
RB0600     BLOCK CONTAINS 0 RECORDS.                                    00740005
RB0600                                                                  00750005
RB0600 01  TWKSHNK-DATE-CNTL-RECORD    PIC X(80).                       00760005
RB0600*                                                                 00770005
      ******************************************************************00780005
       WORKING-STORAGE SECTION.                                         00790005
      ******************************************************************00800005
                                                                        00810005
W20445 01  MLTMNLYSUM-SELECT-VERBIAGE-1.                                00820010
W35378     05  FILLER                  PIC X(23)   VALUE                00821028
W35378         '  WHERE PARTN_NBR IN ( '.                               00822028
W35378*        '  PART                '.                                00823028
W35378     05  FILLER                  PIC X(57)  VALUE SPACES.         00824028
W20445                                                                  00860010
W20445*01  MLTMNLYSUM-SELECT-VERBIAGE-2.                                00870018
W20445*    05  FILLER                  PIC X(04)  VALUE '  );'.         00880018
W20445*    05  FILLER                  PIC X(76)  VALUE SPACES.         00890018
W20445*                                                                 00900018
W20445 01  MLTMNLYSUM-SELECT-VERBIAGE-3.                                00910011
W20445     05  FILLER                  PIC X(04)  VALUE SPACES.         00920013
W20445     05  MLTMNLYSUMM-COMMA       PIC X(01)  VALUE SPACES.         00930011
W20445     05  MLTMNLYSUM-PARTN-NBR    PIC Z99.                         00940011
W20445     05  FILLER                  PIC X(72)  VALUE SPACES.         00950013
W20445                                                                  00960011
W20445*    05  FILLER                  PIC X(28)   VALUE                00970010
W20445*        '  WHERE FSCL_MN_END_DTE <= '''.                         00980010
W20445*    05  PV-TMNSCLS-END-DATE     PIC X(10)   VALUE SPACES.        00990010
W20445*    05  FILLER                  PIC X(42)   VALUE ''';'.         01000010
W20445*                                                                 01010010
RB0600 01  PV-TWKSHNK-DATE-CNTL-RECORD1.                                01020007
RB0600     05  FILLER                  PIC X(28)   VALUE                01030008
RB0901         '  WHERE FSCL_WK_END_DTE >= '''.                         01040007
RB0600     05  PV-TWKSHNK-BEG-DATE     PIC X(10)   VALUE SPACES.        01050005
RB0600     05  FILLER                  PIC X(06)   VALUE ''' AND '.     01060008
RB0901     05  FILLER                  PIC X(10)   VALUE SPACES.        01070007
RB0600     05  FILLER                  PIC X(26)   VALUE SPACES.        01080008
RB0600                                                                  01090005
RB0901 01  PV-TWKSHNK-DATE-CNTL-RECORD2.                                01100007
RB0901     05  FILLER                  PIC X(28)   VALUE                01110008
RB0901         '        FSCL_WK_END_DTE <= '''.                         01120008
RB0901     05  PV-TWKSHNK-END-DATE     PIC X(10)   VALUE SPACES.        01130007
RB0901     05  FILLER                  PIC X(26)   VALUE ''';'.         01140009
RB0901     05  FILLER                  PIC X(06)   VALUE SPACES.        01150008
RB0901     05  FILLER                  PIC X(10)   VALUE SPACES.        01160007
RB0901                                                                  01170007
W20445 01  PV-PARTN-NBR-COUNT          PIC S9(15) COMP-3 VALUE ZEROS.   01180010
W20445                                                                  01190010
W20445 01  PS-PROGRAM-SWITCHES.                                         01200010
W20445     05  PS-PARTN-NBR-DONE-SW      PIC X(01)   VALUE 'N'.         01210010
W20445         88  PS-PARTN-NBR-COMPLETE             VALUE 'Y'.         01220010
W20445     05  PS-FIRST-TIME-SW          PIC X(01)   VALUE 'N'.         01230010
W20445         88  PS-FIRST-TIME-THRU                VALUE 'N'.         01240010
W20445         88  PS-CONTINUED-PROCESSING           VALUE 'Y'.         01250010
W20445                                                                  01260010
       01 ABEND-AREAS.                                                  01270005
           05 ABEND-CODE               PIC S9(04)  VALUE ZERO           01280005
                                                   COMP SYNC.           01290005
               88  AC-BAD-DATA                     VALUE +4003.         01300005
               88  AC-DB2-ERROR                    VALUE +4013.         01310005
           05  AA-ABEND-LIT            PIC X(40)   VALUE                01320005
                 '*****       ABEND'.                                   01330005
           05  AA-PROGRAM-LIT          PIC X(40)   VALUE                01340005
W34517             '*****   PROGRAM: VAKUT002'.                         01350026
           05  AA-PARAGRAPH-LIT.                                        01360005
               10  FILLER              PIC X(17)   VALUE                01370005
                   '***** PARAGRAPH: '.                                 01380005
               10  AA-PARAGRAPH-NAME   PIC X(35)   VALUE SPACES.        01390005
           05  AA-MESSAGE-LINE.                                         01400005
               10  FILLER              PIC X(06)   VALUE '*****'.       01410005
               10  AA-MESSAGE          PIC X(127)  VALUE SPACES.        01420005
           05  AA-DB2-ERROR-LIT        PIC X(40)   VALUE                01430005
                   '*****    DB2 ERROR'.                                01440005
           05  AA-DB2-OPERATION-LIT.                                    01450005
               10  FILLER              PIC X(17)   VALUE                01460005
                   '***** OPERATION: '.                                 01470005
               10  AA-DB2-OPERATION.                                    01480005
                   15  AA-DB2-OP-1     PIC X(25)   VALUE SPACES.        01490005
                   15  AA-DB2-OP-2     PIC X(25)   VALUE SPACES.        01500005
           05  AA-DB2-TABLE-1          PIC X(08)   VALUE SPACES.        01510005
           05  AA-DB2-TABLE-2          PIC X(08)   VALUE SPACES.        01520005
           05  AA-DB2-TABLE-3          PIC X(08)   VALUE SPACES.        01530005
           05  AA-DB2-TABLE-4          PIC X(08)   VALUE SPACES.        01540005
                                                                        01550005
      ******************************************************************01560005
      *  DB2 ERROR MESSAGES FORMAT AREA.                                01570005
      ******************************************************************01580005
           COPY DPWS004.                                                01590005
                                                                        01600005
      ******************************************************************01610005
      *  DB2 ERRORS                                                     01620005
      ******************************************************************01630005
           COPY SQLCA2.                                                 01640005
                                                                        01650005
      ******************************************************************01660005
      *  DB2 MLCNTL TABLE LAYOUT                                        01670005
      ******************************************************************01680005
           EXEC SQL                                                     01690005
                INCLUDE TMLCNTL                                         01700005
           END-EXEC.                                                    01710005
                                                                        01720005
      ******************************************************************01730005
      *  DB2 DTATTR TABLE LAYOUT                                        01740005
      ******************************************************************01750005
           EXEC SQL                                                     01760005
                INCLUDE TDTATTR                                         01770005
           END-EXEC.                                                    01780005
                                                                        01790005
W20445******************************************************************01800010
W20445*  DB2 - M/L DETAIL LEDGER PARTITION BALANCE TBL (MLT_PARTN_BAL)  01810010
W20445******************************************************************01820010
W20445     EXEC SQL                                                     01830010
W20445         INCLUDE MLT00002                                         01840010
W20445     END-EXEC.                                                    01850010
W20445                                                                  01860010
W20445******************************************************************01870010
W20445*  DB2 - M/L DETAIL LEDGER PARTITION CONTROL TBL (MLT_PARTN_CNTL) 01880010
W20445******************************************************************01890010
W20445     EXEC SQL                                                     01900010
W20445         INCLUDE MLT00003                                         01910010
W20445     END-EXEC.                                                    01920010
W20445                                                                  01930010
      ******************************************************************01940005
      *  DB2 COMMUNICATION AREA                                         01950010
      ******************************************************************01960005
           EXEC SQL                                                     01970005
                INCLUDE SQLCA                                           01980005
           END-EXEC.                                                    01990005
                                                                        02000005
W20445******************************************************************02010010
W20445*  DB2 - M/L DETAIL LEDGER PARTITION CURSOR.                      02020010
W20445******************************************************************02030010
W20445     EXEC SQL                                                     02040010
W20445       DECLARE PARTN-NBR-CSR CURSOR FOR                           02050010
W20445         SELECT DISTINCT PARTN_NBR                                02060010
W20445         FROM MLT_PARTN_CNTL A,                                   02070010
W20445              MLT_PARTN_BAL B                                     02080010
W20445         WHERE A.TBL_TM_LVL_CDE = B.TBL_TM_LVL_CDE                02090010
W20445           AND :MLCNTL-OPN-FSCL-MN-DTE >= B.EFF_BEG_DTE           02100017
W20445           AND :MLCNTL-OPN-FSCL-MN-DTE <=  B.EFF_END_DTE          02110017
W20445           AND A.DEPT_GP_CDE = B.DEPT_GP_CDE                      02120010
W20445           AND A.TBL_TM_LVL_CDE = 'M'                             02130010
W20445******     AND A.FSCL_DTE <= :MLCNTL-OPN-FSCL-MN-DTE              02140020
W27710           AND A.FSCL_DTE  = :MLCNTL-OPN-FSCL-MN-DTE              02150021
W20445     END-EXEC.                                                    02160010
W20445                                                                  02170010
      /*****************************************************************02180010
       PROCEDURE DIVISION.                                              02190005
      ******************************************************************02200005
       0100-MAINLINE.                                                   02210005
      *                                                                 02220005
W20445*** DETERMINE THE FISCAL PERIOS TO BE PROCESSED....               02230010
           PERFORM 7000-SELECT-TMLCNTL.                                 02240005
                                                                        02250005
           DISPLAY ' '.                                                 02260005
           DISPLAY '*** OPEN FISCAL DATE USED IS:  '                    02270005
           DISPLAY '    MLCNTL-OPN-FSCL-MN-DTE = '                      02280005
             MLCNTL-OPN-FSCL-MN-DTE.                                    02290005
                                                                        02300005
RB0600     MOVE MLCNTL-OPN-FSCL-MN-DTE      TO DTATTR-KY-DTE.           02310005
RB0600     PERFORM 7100-SELECT-TDTATTR.                                 02320005
RB0600                                                                  02330005
RB0600     DISPLAY ' '.                                                 02340005
RB0600     DISPLAY '*** BEG OF OPEN FISCAL MONTH USED IS: '             02350005
RB0600     DISPLAY '    DTATTR-FSCL-MN-BEG-DTE = '                      02360005
RB0600       DTATTR-FSCL-MN-BEG-DTE.                                    02370005
RB0600     DISPLAY ' '.                                                 02380005
RB0600     DISPLAY '*** END OF OPEN FISCAL MONTH USED IS: '             02390005
RB0600     DISPLAY '    DTATTR-FSCL-MN-END-DTE = '                      02400005
RB0600       DTATTR-FSCL-MN-END-DTE.                                    02410005
RB0600                                                                  02420005
W20445*** OPEN FILES....                                                02430010
W20445     OPEN OUTPUT MLTMNLYSUM-DATE-CNTL-FILE                        02440010
RB0600                 TWKSHNK-DATE-CNTL-FILE.                          02450005
                                                                        02460005
W20445*** DETERMINE THE FISCAL PERIOD'S PARTITION NUMBERS FOR THE TABLE 02470016
W34517*** MLT_MNLY_VND....                                              02480027
W20445     MOVE ZEROS          TO PV-PARTN-NBR-COUNT.                   02490012
W20445     MOVE 'N'            TO PS-PARTN-NBR-DONE-SW.                 02500012
W20445                                                                  02510012
W20445     PERFORM 7200-OPEN-PARTN-NBR-CSR.                             02520012
W20445                                                                  02530012
W20445     PERFORM 2000-BUILD-PARTN-NBR                                 02540010
W20445         UNTIL PS-PARTN-NBR-COMPLETE.                             02550010
W20445                                                                  02560010
W20445     PERFORM 7300-CLOSE-PARTN-NBR-CSR.                            02570012
W20445                                                                  02580012
W20445*    IF PV-PARTN-NBR-COUNT IS GREATER THAN ZEROS                  02590018
W20445*        WRITE MLTMNLYSUM-DATE-CNTL-RECORD                        02600018
W20445*                           FROM MLTMNLYSUM-SELECT-VERBIAGE-2     02610018
W20445*    END-IF.                                                      02620018
W20445*                                                                 02630018
W20445*    MOVE MLCNTL-OPN-FSCL-MN-DTE TO MLTMNLYSUM-END-DATE.          02640010
W20445*                                                                 02650010
W20445*    WRITE MLTMNLYSUM-DATE-CNTL-RECORD                            02660010
W20445*        FROM  MLTMNLYSUM-DATE-CNTL-RECORD.                       02670010
W20445                                                                  02680010
W20445*** TWKSHNK FISCAL PERIOD SETUP...                                02690010
RB0600     MOVE DTATTR-FSCL-MN-BEG-DTE TO PV-TWKSHNK-BEG-DATE.          02700005
RB0600     MOVE DTATTR-FSCL-MN-END-DTE TO PV-TWKSHNK-END-DATE.          02710005
RB0600                                                                  02720005
RB0600     WRITE TWKSHNK-DATE-CNTL-RECORD                               02730005
RB0901         FROM  PV-TWKSHNK-DATE-CNTL-RECORD1.                      02740007
RB0600                                                                  02750005
RB0901     WRITE TWKSHNK-DATE-CNTL-RECORD                               02760007
RB0901         FROM  PV-TWKSHNK-DATE-CNTL-RECORD2.                      02770007
RB0901                                                                  02780007
W20445*** CLOSE FILES....                                               02790010
W20445     CLOSE MLTMNLYSUM-DATE-CNTL-FILE                              02800010
RB0600           TWKSHNK-DATE-CNTL-FILE.                                02810005
                                                                        02820005
           STOP RUN.                                                    02830005
                                                                        02840005
W20445/*****************************************************************02850010
W20445* 2000-BUILD-PARTN-NBR.                                           02860010
W20445******************************************************************02870010
W20445 2000-BUILD-PARTN-NBR.                                            02880010
W20445                                                                  02890010
W20445     EXEC SQL                                                     02900010
W20445         FETCH PARTN-NBR-CSR                                      02910010
W20445         INTO :MLT00003-PARTN-NBR                                 02920010
W20445     END-EXEC.                                                    02930010
W20445                                                                  02940010
W20445     EVALUATE TRUE                                                02950010
W20445         WHEN SQLCODE = ZERO                                      02960010
W20445             PERFORM 3000-FORMAT-SELECT-STATEMENT                 02970010
W20445         WHEN SQLCODE = +100                                      02980010
W20445             MOVE 'Y'         TO PS-PARTN-NBR-DONE-SW             02990010
W20445         WHEN SQLWARN0 NOT = SPACE                                03000010
W20445         WHEN SQLCODE  NOT = ZERO                                 03010010
W20445             MOVE '2000-BUILD-PARTN-NBR' TO AA-PARAGRAPH-NAME     03020010
W20445             MOVE 'FETCH'                TO AA-DB2-OPERATION      03030010
W20445             MOVE 'PARTN-NBR CSR'        TO AA-MESSAGE            03040010
W20445             PERFORM 9901-SQL-ERROR                               03050010
W20445     END-EVALUATE.                                                03060010
W20445                                                                  03070010
W20445/*****************************************************************03080010
W20445* 3000-FORMAT-SELECT-STATEMENT.                                   03090010
W34517*     THE ROUTINE BUILDS THE SELECT STATMENT FOR MLT_MNLY_VND. THE03100027
W20445* TABLE IS SETUP TO USE PARTITION NUMBER. THE ROUTINE BUILDS THE  03110010
W20445* PARTITION NUMBER SELECT STATMENTS FOR THE OPEN FISCAL MONTH...  03120010
W20445******************************************************************03130010
W20445 3000-FORMAT-SELECT-STATEMENT.                                    03140010
W20445                                                                  03150010
W20445     IF PS-FIRST-TIME-THRU                                        03160010
W20445         WRITE MLTMNLYSUM-DATE-CNTL-RECORD                        03170010
W20445                              FROM MLTMNLYSUM-SELECT-VERBIAGE-1   03180011
W20445         MOVE 'Y'             TO PS-FIRST-TIME-SW                 03190011
W20445     END-IF.                                                      03200010
W20445                                                                  03210010
W20445     IF PV-PARTN-NBR-COUNT IS GREATER THAN ZERO                   03220014
W20445         MOVE ','             TO MLTMNLYSUMM-COMMA                03230010
W20445     ELSE                                                         03240010
W20445         MOVE SPACE           TO MLTMNLYSUMM-COMMA                03250010
W20445     END-IF.                                                      03260010
W20445                                                                  03270010
W20445     MOVE MLT00003-PARTN-NBR  TO MLTMNLYSUM-PARTN-NBR             03280011
W20445                                                                  03290010
W20445     WRITE MLTMNLYSUM-DATE-CNTL-RECORD                            03300010
W20445                              FROM MLTMNLYSUM-SELECT-VERBIAGE-3.  03310011
W20445                                                                  03320010
W20445     ADD 1                    TO PV-PARTN-NBR-COUNT.              03330010
W20445                                                                  03340010
      /*****************************************************************03350010
       7000-SELECT-TMLCNTL.                                             03360005
      ******************************************************************03370005
                                                                        03380005
           EXEC SQL                                                     03390005
               SELECT OPN_FSCL_MN_DTE                                   03400005
               INTO  :MLCNTL-OPN-FSCL-MN-DTE                            03410005
               FROM TMLCNTL                                             03420005
           END-EXEC.                                                    03430005
                                                                        03440005
           EVALUATE TRUE                                                03450005
               WHEN SQLCODE = ZERO                                      03460005
                   CONTINUE                                             03470005
               WHEN OTHER                                               03480005
                   MOVE '7000-SELECT-TMLCNTL'                           03490005
                                       TO AA-PARAGRAPH-NAME             03500005
                   MOVE 'TMLCNTL ROW NOT FOUND'                         03510005
                                       TO AA-MESSAGE                    03520005
                   MOVE 'SELECT'       TO AA-DB2-OPERATION              03530005
                   PERFORM 9901-SQL-ERROR                               03540005
           END-EVALUATE.                                                03550005
                                                                        03560005
RB0600******************************************************************03570005
RB0600 7100-SELECT-TDTATTR.                                             03580005
RB0600******************************************************************03590005
RB0600                                                                  03600005
RB0600     EXEC SQL                                                     03610005
RB0600         SELECT FSCL_MN_BEG_DTE                                   03620005
RB0600               ,FSCL_MN_END_DTE                                   03630005
RB0600         INTO  :DTATTR-FSCL-MN-BEG-DTE                            03640005
RB0600              ,:DTATTR-FSCL-MN-END-DTE                            03650005
RB0600         FROM TDTATTR                                             03660005
RB0600         WHERE  KY_DTE = :DTATTR-KY-DTE                           03670005
RB0600     END-EXEC.                                                    03680005
RB0600                                                                  03690005
RB0600     EVALUATE TRUE                                                03700005
RB0600         WHEN SQLCODE = ZERO                                      03710005
RB0600             CONTINUE                                             03720005
RB0600         WHEN OTHER                                               03730005
RB0600             MOVE '7100-SELECT-TMLCNTL'                           03740005
RB0600                                 TO AA-PARAGRAPH-NAME             03750005
RB0600             MOVE 'TDTATTR ROW NOT FOUND'                         03760005
RB0600                                 TO AA-MESSAGE                    03770005
RB0600             MOVE 'SELECT'       TO AA-DB2-OPERATION              03780005
RB0600             PERFORM 9901-SQL-ERROR                               03790005
RB0600     END-EVALUATE.                                                03800005
                                                                        03810005
W20445***************************************************************** 03820012
W20445* 7200-OPEN-PARTN-NBR-CSR.                                        03830012
W20445***************************************************************** 03840012
W20445 7200-OPEN-PARTN-NBR-CSR.                                         03850012
W20445                                                                  03860012
W20445     EXEC SQL                                                     03870012
W20445         OPEN PARTN-NBR-CSR                                       03880012
W20445     END-EXEC.                                                    03890012
W20445                                                                  03900012
W20445     EVALUATE TRUE                                                03910012
W20445       WHEN SQLCODE = ZERO                                        03920012
W20445           CONTINUE                                               03930012
W20445       WHEN SQLWARN0 NOT = SPACE                                  03940012
W20445       WHEN SQLCODE  NOT = ZERO                                   03950012
W20445           MOVE '7200-OPEN-PARTN-NBR ' TO AA-PARAGRAPH-NAME       03960012
W20445           MOVE 'OPEN'                 TO AA-DB2-OPERATION        03970012
W20445           MOVE 'PARTN-NBR CSR'        TO AA-MESSAGE              03980012
W20445           MOVE 'Y'                    TO PS-PARTN-NBR-DONE-SW    03990012
W20445           PERFORM 9901-SQL-ERROR                                 04000012
W20445     END-EVALUATE.                                                04010012
W20445                                                                  04020012
W20445***************************************************************** 04030012
W20445* 7300-CLOSE-PARTN-NBR-CSR.                                       04040012
W20445***************************************************************** 04050012
W20445  7300-CLOSE-PARTN-NBR-CSR.                                       04060012
W20445                                                                  04070012
W20445     EXEC SQL                                                     04080012
W20445         CLOSE PARTN-NBR-CSR                                      04090012
W20445     END-EXEC.                                                    04100012
W20445                                                                  04110012
W20445     EVALUATE TRUE                                                04120012
W20445       WHEN SQLCODE = ZERO                                        04130012
W20445           CONTINUE                                               04140012
W20445       WHEN SQLWARN0 NOT = SPACE                                  04150012
W20445       WHEN SQLCODE  NOT = ZERO                                   04160012
W20445           MOVE '7300-OPEN-PARTN-NBR ' TO AA-PARAGRAPH-NAME       04170012
W20445           MOVE 'CLOSE'                TO AA-DB2-OPERATION        04180012
W20445           MOVE 'PARTN-NBR CSR'        TO AA-MESSAGE              04190012
W20445           PERFORM 9901-SQL-ERROR                                 04200012
W20445     END-EVALUATE.                                                04210012
W20445                                                                  04220012
      ******************************************************************04230005
       9901-SQL-ERROR.                                                  04240005
      ******************************************************************04250005
                                                                        04260005
                                                                        04270005
           DISPLAY AA-ABEND-LIT.                                        04280005
           DISPLAY AA-DB2-ERROR-LIT.                                    04290005
           DISPLAY AA-PROGRAM-LIT.                                      04300005
           DISPLAY AA-PARAGRAPH-LIT.                                    04310005
           DISPLAY AA-MESSAGE-LINE.                                     04320005
           DISPLAY AA-DB2-OPERATION-LIT.                                04330005
           SET AC-DB2-ERROR TO TRUE.                                    04340005
           MOVE +4013                  TO ABEND-CODE.                   04350005
                                                                        04360005
           COPY DPPD004.                                                04370005
           CALL 'ILBOABN0' USING ABEND-CODE.                            04380005
