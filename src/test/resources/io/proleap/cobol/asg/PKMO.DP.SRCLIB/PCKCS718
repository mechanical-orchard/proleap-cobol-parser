000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    PCKCS718.                                         00040099
000500 AUTHOR.        THERESE RAMSEYER.                                 00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  JUNE 2000.                                        00070000
000800 DATE-COMPILED.                                                   00080000
000900                                                                  00090000
001000*----------------------------------------------------------------*00100099
001100*    E718 - PROC CNTL PRINT RACK LOC LABEL                       *00110099
001200*----------------------------------------------------------------*00120000
001300*             T R O U B L E   S H O O T I N G                    *00130099
001400*----------------------------------------------------------------*00140099
001500* IF ANY ADJUSTMENTS ARE MADE TO THE PROGRAM, AND NO LABELS ARE  *00150099
001600* BEING PRINTED, EVEN THOUGH THE DATA WAS PASSED, AND THERE WAS  *00160099
001700* NO SOCKET ERROR, CHECK TO BE CERTAIN THAT A NUMBER GREATER     *00170099
001800* THAT 0 IS BEING PASSED IN THE TOT-LBLS FIELD. THERE ARE SOME   *00180099
001900* CALCS IN THE SOCKET PROGRAM THAT USE MULTIPLICATION TO         *00190099
002000* DETERMINE HOW MANY TIMES TO LOOP (SEND DATA), A 0 WILL MAKE    *00200099
002100* THE TOTAL-LABELS QTY 0, PROCESSING WON'T LOOP, NO LABELS PRINT.*00210099
002200* CHECK THE SWITCHES IN THE "SETS" LOGIC IN PARAGRAPH 2100- .    *00220099
002300* IF ONLY 1 SET IS BEING PRINTED WHEN MULTIPLE ARE REQUESTED OR  *00230099
002400* DATA IS BEING SENT (NOTICEABLE ON THE PTMS MONITOR), AND NO    *00240099
002500* LABELS ACTUALLY PRINT, CHANCES ARE THERE IS A PROBLEM IN       *00250099
002600* PARAGRAPH 2100- WHERE THE DEFAULT 1 IS BEING PUT INTO THE SETS *00260099
002700* FIELD WHEN IT SHOULDN'T.                                       *00270099
002800*----------------------------------------------------------------*00280099
002900*----------------------------------------------------------------*00290099
003000*    E718 - PROC CNTL PRINT RACK LOC LABEL                       *00300099
003100*                                                                *00310000
003200* THE RACK LABEL PROGRAM WILL PASS DATA TO THE SOCKET PROGRAM    *00320099
003300* PCKCS707. MULTIPLE SETS OF LABELS CAN BE PRINTED. THE LABEL    *00330099
003400* MUST HAVE A BUILDING FIELD (ALPHA), AN AISLE FIELD (NUM),      *00340099
003500* A SLOT (NUM) WHICH MAY INCLUDE A RANGE, THOUGH A RANGE IS NOT  *00350099
003600* REQUIRED, AND A TIER (NUM).                                    *00360099
003700* THE SETS VALUE WILL DEFAULT TO 1 WHEN THE SCREEN IS REFRESHED. *00370099
003800* A SINGLE SET IS ASSUMED UNLESS IT IS CHANGED. THE USER CAN PRESS00380099
003900* <ENTER> AND A DESCRIPTION OF THE LABEL WILL APPEAR, SHOWING THE*00390099
004000* RANGE IF ONE WAS SPECIFIED. PF1=ADD WILL EXECUTE THE PRINT     *00400099
004100* COMMAND. A CONFIRMATION WILL BE REQUIRED IF MULTIPLE SETS ARE  *00410099
004200* REQUESTED OR IF MORE THAN 99 LABELS ARE REQUESTED.             *00420099
004300* AFTER A SUCCESSFUL PRINT, THE SCREEN WILL BE CLEARED, AND WILL *00430099
004400* BE READY FOR ANOTHER LABEL PRINT REQUEST.                      *00440099
004500*----------------------------------------------------------------*00450000
004600* NOTE: NUMBERS APPEARING ON LABELS WILL HAVE LEADING ZEROES     *00460099
004700*       BUT IT IS NOT NECESSARY THAT THEY ARE ENTERED THAT WAY.  *00470099
004800*----------------------------------------------------------------*00480099
004810* DATE  11/04/2021                                                00481099
004820*            - CHANGE CALL OF 'DPKUT100' TO                     * 00482099
004830*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 00483099
004840*              MAKING THE CALL DYNAMIC VS STATIC                * 00484099
004850*     MADE BY: GERMAN BANDA            WR/IR #: CHG0264232        00485099
004860*-----------------------------------------------------------------00486099
1122RM* DATE  11/07/2022                                              * 00487099
1122RM*            - ADD COPYBOOK DPWS930                             * 00488099
1122RM*              CHANGE CALL TO DPWS030 FROM STATIC TO            * 00489099
1122RM*              DYNAMIC.                                         * 00489199
1122RM*     MADE BY: BOB MCASEY              WR/IR #: CHG0277910      * 00489299
1122RM*-----------------------------------------------------------------00489399
004900                                                                  00490000
005000 ENVIRONMENT DIVISION.                                            00500000
005100                                                                  00510000
005200 DATA DIVISION.                                                   00520000
005300                                                                  00530000
005400 WORKING-STORAGE SECTION.                                         00540000
005500                                                                  00550000
005600 01  PC-PROGRAM-CONSTANTS.                                        00560000
005700     05  PC-CURRENT-MAP-NAME      PIC  X(08)  VALUE  'PC718A  '.  00570099
005800     05  PC-CURRENT-MAPSET-NAME   PIC  X(08)  VALUE  'PCKM718 '.  00580099
005900     05  PC-CURRENT-PROGRAM-NAME  PIC  X(08)  VALUE  'PCKCS718'.  00590099
006000     05  PC-MAX-RETRIES           PIC S9(04)  VALUE  +3           00600000
006100                                              COMP.               00610000
006200     05  PC-ENROUTE               PIC  X(07)  VALUE  'ENROUTE'.   00620000
006300     05  PC-LABEL-FORMAT          PIC  9(03)  VALUE  2.           00630000
006400     05  PC-PROCESS-AREA          PIC  X(02)  VALUE  'P '.        00640000
006500     05  PC-ENTRY-FROM-PCAHDR     PIC  X(01)  VALUE  '1'.         00650000
006600     05  PC-STARTING-CNT          PIC  X(04)  VALUE  '1   '.      00660000
006700     05  PC-PRE-TICKETED          PIC  X(15)  VALUE               00670000
006800         'PRE TICKETED   '.                                       00680000
006900     05  PC-ON-HANGER             PIC  X(09)  VALUE               00690000
007000         'ON HANGER'.                                             00700000
007100     05  PC-MULTIPLE-SHIPMENTS    PIC  X(18)  VALUE               00710000
007200         'MULTIPLE SHIPMENTS'.                                    00720000
007300     05  PC-DETAIL-CHECK          PIC  X(12)  VALUE               00730000
007400         'DETAIL CHECK'.                                          00740000
007500     05  PC-Y                     PIC  X(01)  VALUE  'Y'.         00750000
007600     05  PC-N                     PIC  X(01)  VALUE  'N'.         00760000
007700     05  PC-A                     PIC  X(01)  VALUE  'A'.         00770000
007800     05  PC-T                     PIC  X(01)  VALUE  'T'.         00780099
007900     05  PC-TR                    PIC  X(02)  VALUE  'TR'.        00790099
008000     05  PC-F                     PIC  X(01)  VALUE  'F'.         00800000
008100     05  PC-S                     PIC  X(01)  VALUE  'S'.         00810000
008200     05  PC-DASH                  PIC  X(01)  VALUE  '-'.         00820099
008300     05  PC-THRU                  PIC  X(06)  VALUE  ' THRU '.    00830099
008400     05  PC-90                    PIC  X(02)  VALUE '90'.         00840000
008500     05  PC-01                    PIC  X(02)  VALUE  '01'.        00850000
008600     05  PC-1                     PIC  9(04)  VALUE  0001.        00860000
008700     05  PC-99                    PIC  9(04)  VALUE  0099.        00870000
008800     05  PC-2                     PIC  9(01)  VALUE  2.           00880000
008900     05  PC-3                     PIC  9(01)  VALUE  3.           00890000
009000     05  PC-4                     PIC  9(01)  VALUE  4.           00900000
009100     05  PC-PRTR-VALIDATION-PGM   PIC  X(08)  VALUE  'DPKCS060'.  00910000
009200                                                                  00920000
009300     05  PC-TSYMSG-NUMBERS.                                       00930000
009400         10  PC-TSYMSG-00005      PIC  9(05)  VALUE  00005.       00940000
009500*            INVALID VALUE                                        00950000
009600         10  PC-TSYMSG-00007      PIC  9(05)  VALUE  00007.       00960000
009700*            REQUIRED ENTRY                                       00970000
009800         10  PC-TSYMSG-00008      PIC  9(05)  VALUE  00008.       00980000
009900*            MUST BE NUMERIC                                      00990000
010000         10  PC-TSYMSG-00009      PIC  9(05)  VALUE  00009.       01000000
010100*            INVALID DATE                                         01010000
010200         10  PC-TSYMSG-00051      PIC  9(05)  VALUE  00052.       01020099
010300*            NO END OF RANGE HAS BEEN SPECIFIED                   01030099
010400         10  PC-TSYMSG-00052      PIC  9(05)  VALUE  00052.       01040099
010500*            END OF RANGE PRECEDES START OF RANGE                 01050099
010600         10  PC-TSYMSG-00053      PIC  9(05)  VALUE  00053.       01060000
010700*            NO START OF RANGE HAS BEEN SPECIFIED                 01070000
010800         10  PC-TSYMSG-00055      PIC  9(05)  VALUE  00055.       01080000
010900*            ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     01090000
011000         10  PC-TSYMSG-00083      PIC  9(05)  VALUE  00083.       01100000
011100*            PO NOT FOUND                                         01110000
011200         10  PC-TSYMSG-00098      PIC  9(05)  VALUE  00098.       01120000
011300*            PRINT SUCCESSFUL                                     01130000
011400         10  PC-TSYMSG-00342      PIC  9(05)  VALUE  00342.       01140000
011500*            MUST BE NUMERIC AND > ZERO                           01150000
011600         10  PC-TSYMSG-00746      PIC  9(05)  VALUE  00746.       01160000
011700*            INVALID PRINTER DESTINATION                          01170000
011800         10  PC-TSYMSG-02122      PIC  9(05)  VALUE  02122.       01180000
011900*            SOCKET ERROR                                         01190000
012000         10  PC-TSYMSG-02503      PIC  9(05)  VALUE  02503.       01200000
012100*            BARCODE GREATER THAN 12 CHARS (RANGE USES 4 CHARS)   01210000
012200         10  PC-TSYMSG-02504      PIC  9(05)  VALUE  02504.       01220000
012300*            CONFIRM > 1 SET  OF LABELS                           01230000
012400         10  PC-TSYMSG-02505      PIC  9(05)  VALUE  02505.       01240000
012500*            CONFIRM > 99 LABELS                                  01250000
012600     05  PC-OPER-UNT-ID               PIC S9(04) VALUE +0         01260000
012700                                                 COMP.            01270000
012800     05  PC-FCLTY-ID                  PIC S9(04) VALUE +0         01280000
012900                                                 COMP.            01290000
013000                                                                  01300000
013100 01  PM-PROGRAM-MESSAGES.                                         01310000
013200     05  PM-PROGRAM-MESSAGE-1.                                    01320000
013300         10  FILLER               PIC  X(54)  VALUE               01330000
013400         'ERROR TRYING TO SCHEDULE PSB - PCKCS113-RETURN CODE = '.01340000
013500         10  PM-IMS-CODE-1        PIC X(02)   VALUE SPACES.       01350000
013600         10  FILLER               PIC X(20)   VALUE SPACES.       01360000
013700     05  PM-PROGRAM-MESSAGE-2.                                    01370000
013800         10  FILLER               PIC  X(54)  VALUE               01380000
013900         'ERROR TRYING TO TERMINATE PSB- PCKCS113-RETURN CODE = '.01390000
014000         10  PM-IMS-CODE-2        PIC X(02)   VALUE SPACES.       01400000
014100         10  FILLER               PIC X(20)   VALUE SPACES.       01410000
014200     05  PM-PROGRAM-MESSAGE-3.                                    01420000
014300         10  FILLER               PIC  X(54)  VALUE               01430000
014400         'ERROR DURING GU OF CRC100DS - PCKCS113  RETURN CODE = '.01440000
014500         10  PM-IMS-CODE-3        PIC X(02)   VALUE SPACES.       01450000
014600         10  FILLER               PIC X(20)   VALUE SPACES.       01460000
014700     05  PM-PROGRAM-MESSAGE-4.                                    01470000
014800         10  FILLER               PIC  X(54)  VALUE               01480000
014900         'ERROR DURING GU OF CPO100DS - PCKCS113  RETURN CODE = '.01490000
015000         10  PM-IMS-CODE-4        PIC X(02)   VALUE SPACES.       01500000
015100         10  FILLER               PIC X(20)   VALUE SPACES.       01510000
015200     05  PM-PROGRAM-MESSAGE-5.                                    01520000
015300         10  FILLER               PIC  X(54)  VALUE               01530000
015400         'ERROR DURING GNP OF CRC320DS -PCKCS113- RETURN CODE = '.01540000
015500         10  PM-IMS-CODE-5        PIC X(02)   VALUE SPACES.       01550000
015600         10  FILLER               PIC X(20)   VALUE SPACES.       01560000
015700     05  PM-PROGRAM-MESSAGE-6.                                    01570000
015800         10  PM-RET-CDE           PIC  X(02)  VALUE SPACES.       01580000
015900         10  FILLER               PIC  X(01)  VALUE '-'.          01590000
016000         10  PM-RET-MSG           PIC  X(25)  VALUE SPACES.       01600000
016100         10  FILLER               PIC  X(48)  VALUE SPACES.       01610000
016200                                                                  01620000
016300 01  PS-PROGRAM-SWITCHES.                                         01630000
016400     05  PS-ERROR-SW              PIC  X(01)  VALUE  'N'.         01640000
016500         88  PS-ERROR                         VALUE  'Y'.         01650000
016600         88  PS-NO-ERROR                      VALUE  'N'.         01660000
016700     05  PS-PRINT-COMPLETE-SW     PIC  X(01)  VALUE  'N'.         01670099
016800         88  PS-PRINT-COMPLETE                VALUE  'Y'.         01680099
016900         88  PS-PRINT-COMPLETE-NO             VALUE  'N'.         01690099
017000     05  FACILITY-EDIT-SW         PIC  X(01)  VALUE  ' '.         01700000
017100         88  ERROR-ON-FACILITY-EDIT           VALUE  ' '.         01710000
017200         88  NO-ERROR-ON-FACILITY-EDIT        VALUE  'X'.         01720000
017300     05  OP-UNIT-EDIT-SW          PIC  X(01)  VALUE  ' '.         01730000
017400         88  ERROR-ON-OP-UNIT-EDIT            VALUE  ' '.         01740000
017500         88  NO-ERROR-ON-OP-UNIT-EDIT         VALUE  'X'.         01750000
017600     05  PRINTER-EDIT-SW          PIC  X(01)  VALUE  ' '.         01760000
017700         88  ERROR-ON-PRINTER-EDIT            VALUE  ' '.         01770000
017800         88  NO-ERROR-ON-PRINTER-EDIT         VALUE  'X'.         01780000
017900                                                                  01790000
018000 01  PV-PROGRAM-VARIABLES.                                        01800000
018100     05  PV-CICS-RESPONSE         PIC S9(04)  VALUE +0            01810000
018200                                              COMP SYNC.          01820000
018300     05  PV-RETRY-COUNTER         PIC S9(04)  VALUE +0            01830000
018400                                              COMP SYNC.          01840000
018500     05  PV-OPER-UNT-ID           PIC S9(04)  VALUE +0            01850000
018600                                              COMP.               01860000
018700     05  PV-PRINTER-ID            PIC S9(03)  VALUE +0            01870000
018800                                              COMP.               01880000
018900     05  PV-PRTR-DESC             PIC  X(25)  VALUE SPACE.        01890099
019000                                                                  01900099
019100     05  PV-HR-DESC               PIC  X(36)  VALUE SPACE.        01910099
019200                                                                  01920099
019300     05  PV-OPER-UNT-NME          PIC  X(25)  VALUE SPACE.        01930099
019400                                                                  01940099
019500     05  PV-FCLTY-ID              PIC S9(04)  VALUE +0            01950000
019600                                              COMP.               01960000
019700     05  PV-QUOTIENT              PIC 9(02)   VALUE ZERO          01970000
019800                                              COMP.               01980000
019900     05  PV-REMAIN                PIC 9(02)   VALUE ZERO          01990000
020000                                              COMP.               02000000
020100     05  PV-COMMAREA-LENGTH       PIC S9(04)  VALUE +0            02010000
020200                                              COMP.               02020000
020300     05  PV-NUMBER-OF-LABELS      PIC  9(04)  VALUE ZERO          02030000
020400                                              COMP.               02040000
020500     05  PV-TOTAL-LABELS          PIC  9(04)  VALUE ZERO          02050000
020600                                              COMP.               02060000
020700     05  PV-RANGE                 PIC  9(12)  VALUE ZERO.         02070000
020800                                                                  02080000
020900     05  PV-QUALIFIER             PIC  9(12)  VALUE ZERO.         02090000
021000                                                                  02100000
021100     05  PV-SETS                  PIC  9(04)  VALUE ZERO.         02110000
021200                                                                  02120000
021300     05  PV-2DIGIT-X              PIC  X(02)  VALUE SPACES.       02130099
021400                                                                  02140000
021500     05  PV-2DIGIT-N              PIC  9(02)  VALUE ZEROES.       02150099
021600                                                                  02160000
021700     05  PV-2DIGIT-N-TIER         PIC  9(02)  VALUE ZEROES.       02170099
021800                                                                  02180099
021900     05  PV-3DIGIT-X              PIC  X(03)  VALUE SPACES.       02190099
022000                                                                  02200099
022100     05  PV-3DIGIT-N              PIC  9(03)  VALUE ZEROES.       02210099
022200                                                                  02220099
022300     05  PV-COUNT                 PIC S9(04)  VALUE +0.           02230000
022400                                                                  02240000
022500     05  PV-BEGIN-RANGE-POSITION-HR  PIC  9(04)  VALUE  0.        02250000
022600                                                                  02260000
022700     05  PV-END-RANGE-POSITION-HR    PIC  9(04)  VALUE  0.        02270000
022800                                                                  02280000
022900     05  PV-BEGIN-RANGE-POSITION-BC  PIC  9(04)  VALUE  0.        02290000
023000                                                                  02300000
023100     05  PV-END-RANGE-POSITION-BC    PIC  9(04)  VALUE  0.        02310000
023200                                                                  02320000
023300     05  PV-HOLD-FOR-BC-RANGE-CALC   PIC  9(04)  VALUE  0.        02330000
023400                                                                  02340000
023500     05  PV-HOLD-FOR-HR-RANGE-CALC   PIC  9(04)  VALUE  0.        02350000
023600                                                                  02360000
023700     05  PV-CHAR-CNTR             PIC  9(04)  VALUE  0.           02370000
023800                                                                  02380000
023900     05  PV-TOT-CHARS-IN-QLFR     PIC  9(04)  VALUE  0.           02390000
024000                                                                  02400000
024100     05  PV-TOT-CHAR-CNTR-HR      PIC  9(04)  VALUE  0.           02410000
024200                                                                  02420000
024300     05  PV-TOT-CHAR-CNTR-BC      PIC  9(04)  VALUE  0.           02430000
024400                                                                  02440000
024500     05  PV-TOT-PRECEDING-CHARS   PIC  9(04)  VALUE  0.           02450000
024600                                                                  02460000
024700     05  PV-SPACE-CNTR            PIC  9(04)  VALUE  0.           02470000
024800                                                                  02480000
024900     05  PV-BEGIN-SLOT            PIC  9(03)  VALUE  0.           02490099
025000                                                                  02500099
025100     05  PV-END-SLOT              PIC  9(03)  VALUE  0.           02510099
025200                                                                  02520099
025300     05  PV-CONVERSION-FIELD-X    PIC  X(03)  VALUE SPACES.       02530099
025400                                                                  02540000
025500     05  PV-CONVERSION-FIELD-9    PIC  9(03)  VALUE ZEROES.       02550099
025600                                                                  02560000
025700     05  PV-ECA-POINTER           PIC S9(08)  VALUE ZEROS         02570000
025800                                              COMP.               02580000
025900     05  PV-PICX-FOUR             PIC X(04)   VALUE SPACES.       02590000
026000     05  PV-PIC9-FOUR REDEFINES                                   02600000
026100         PV-PICX-FOUR             PIC 9(04).                      02610000
026200     05  PV-SUPPRESS-TWO          PIC   ZZ.                       02620099
026300     05  PV-SUPPRESS-THREE        PIC  ZZZ.                       02630099
026400     05  PV-SUPPRESS-FOUR         PIC ZZZZ.                       02640099
026500     05 PV-DC-5-CHAR-ABBR            PIC X(05) VALUE SPACES.      02650000
026600     05 PV-DC-5-CHAR-ABBR-R REDEFINES PV-DC-5-CHAR-ABBR.          02660000
026700         10 FILLER                   PIC  X(03).                  02670000
026800         10 PV-2-DIGIT-DC-ABBR       PIC  X(02).                  02680000
026900                                                                  02690000
027000 EJECT                                                            02700000
027100*----------------------------------------------------------------*02710000
027200*  SENDING/RECEIVING AREA FOR THE                                *02720000
027300*  PRINTER VALIDATION ROUTING (DPKCS060)                         *02730000
027400*----------------------------------------------------------------*02740000
027500     COPY DPWS072.                                                02750000
027600                                                                  02760000
027700 EJECT                                                            02770000
027800*----------------------------------------------------------------*02780000
027900*    CALLING PARMS USED TO COMMUNICATE TO ARCH PROGRAM DPKCS030  *02790000
028000*----------------------------------------------------------------*02800000
028100     COPY DPWS030.                                                02810000
1122RM     COPY DPWS930.                                                02811099
028200                                                                  02820000
028300 EJECT                                                            02830000
028400*----------------------------------------------------------------*02840000
028500*    NUMERIC EDIT COPYBOOK                                       *02850000
028600*----------------------------------------------------------------*02860000
028700     COPY DPWS010I.                                               02870000
028800                                                                  02880000
028900 EJECT                                                            02890000
029000*----------------------------------------------------------------*02900000
029100*    DATE VALIDATION COPYBOOK FOR THE DATE ROUTINE DPKUT500      *02910000
029200*----------------------------------------------------------------*02920000
029300     COPY DPWS500.                                                02930000
029400                                                                  02940000
029500 EJECT                                                            02950000
029600*----------------------------------------------------------------*02960000
029700*    CURRENT DATE AND TIME COPYBOOK                              *02970000
029800*----------------------------------------------------------------*02980000
029900     COPY DPWS017.                                                02990000
030000                                                                  03000000
030100 EJECT                                                            03010000
030200*----------------------------------------------------------------*03020000
030300*    STANDARD COMMAREA.                                          *03030000
030400*----------------------------------------------------------------*03040000
030500                                                                  03050000
030600     COPY DPWS020.                                                03060000
030700     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                03070000
030800                                                                  03080000
030900*----------------------------------------------------------------*03090000
031000*    INTER-APPLICATION COMMAREA.                                 *03100000
031100*----------------------------------------------------------------*03110000
031200                                                                  03120000
031300         10  INTER-APPL-COMM-AREA PIC X(200).                     03130000
031400     COPY PCWS014.                                                03140000
031500*----------------------------------------------------------------*03150000
031600*    SPECIFIC COMMMAREA FOR PCKCS113.                            *03160000
031700*----------------------------------------------------------------*03170000
031800         10  ASC-SPECIFIC-COMMAREA.                               03180000
031900             15  ASC-AID-ENTER-SW            PIC  X(01).          03190099
032000                 88  ASC-AID-ENTER                      VALUE 'Y'.03200099
032100                 88  ASC-AID-ENTER-NO                   VALUE 'N'.03210099
032200             15  ASC-AID-ADD-SW              PIC  X(01).          03220099
032300                 88  ASC-AID-ADD                        VALUE 'Y'.03230099
032400                 88  ASC-AID-ADD-NO                     VALUE 'N'.03240099
032500             15  ASC-ADD-COMPLETE-SW         PIC  X(01).          03250099
032600                 88  ASC-ADD-COMPLETE                   VALUE 'Y'.03260099
032700                 88  ASC-ADD-PENDING                    VALUE 'N'.03270099
032800             15  ASC-RANGE-ERROR-SW          PIC  X(01).          03280000
032900                 88  ASC-RANGE-ERROR                    VALUE 'Y'.03290000
033000                 88  ASC-RANGE-ERROR-NO                 VALUE 'N'.03300000
033100             15  ASC-RANGE-SPECIFIED-SW      PIC  X(01).          03310099
033200                 88  ASC-RANGE-SPECIFIED                VALUE 'Y'.03320099
033300                 88  ASC-RANGE-SPECIFIED-NO             VALUE 'N'.03330099
033400             15  ASC-RANGE-VALID-SW          PIC  X(01).          03340000
033500                 88  ASC-RANGE-VALID                    VALUE 'Y'.03350000
033600                 88  ASC-RANGE-VALID-NO                 VALUE 'N'.03360000
033700             15  ASC-BLDG-SPECIFIED-SW       PIC  X(01).          03370099
033800                 88  ASC-BLDG-SPECIFIED                 VALUE 'Y'.03380099
033900                 88  ASC-BLDG-SPECIFIED-NO              VALUE 'N'.03390099
034000             15  ASC-AISLE-SPECIFIED-SW      PIC  X(01).          03400099
034100                 88  ASC-AISLE-SPECIFIED                VALUE 'Y'.03410099
034200                 88  ASC-AISLE-SPECIFIED-NO             VALUE 'N'.03420099
034300             15  ASC-AISLE-IS-NUMERIC-SW     PIC  X(01).          03430099
034400                 88  ASC-AISLE-IS-NUMERIC               VALUE 'Y'.03440099
034500                 88  ASC-AISLE-IS-NUMERIC-NO            VALUE 'N'.03450099
034600             15  ASC-BSLOT-SPECIFIED-SW      PIC  X(01).          03460099
034700                 88  ASC-BSLOT-SPECIFIED                VALUE 'Y'.03470099
034800                 88  ASC-BSLOT-SPECIFIED-NO             VALUE 'N'.03480099
034900             15  ASC-BSLOT-IS-NUMERIC-SW     PIC  X(01).          03490099
035000                 88  ASC-BSLOT-IS-NUMERIC               VALUE 'Y'.03500099
035100                 88  ASC-BSLOT-IS-NUMERIC-NO            VALUE 'N'.03510099
035200             15  ASC-ESLOT-SPECIFIED-SW      PIC  X(01).          03520099
035300                 88  ASC-ESLOT-SPECIFIED                VALUE 'Y'.03530099
035400                 88  ASC-ESLOT-SPECIFIED-NO             VALUE 'N'.03540099
035500             15  ASC-ESLOT-IS-NUMERIC-SW     PIC  X(01).          03550099
035600                 88  ASC-ESLOT-IS-NUMERIC               VALUE 'Y'.03560099
035700                 88  ASC-ESLOT-IS-NUMERIC-NO            VALUE 'N'.03570099
035800             15  ASC-TIER-SPECIFIED-SW       PIC  X(01).          03580099
035900                 88  ASC-TIER-SPECIFIED                 VALUE 'Y'.03590099
036000                 88  ASC-TIER-SPECIFIED-NO              VALUE 'N'.03600099
036100             15  ASC-TIER-IS-NUMERIC-SW      PIC  X(01).          03610099
036200                 88  ASC-TIER-IS-NUMERIC                VALUE 'Y'.03620099
036300                 88  ASC-TIER-IS-NUMERIC-NO             VALUE 'N'.03630099
036400             15  ASC-KEEP-SETS-VALUE-SW      PIC  X(01).          03640099
036500                 88  ASC-KEEP-SETS-VALUE                VALUE 'Y'.03650099
036600                 88  ASC-KEEP-SETS-VALUE-NO             VALUE 'N'.03660099
036700             15  ASC-MULT-SETS-CONFIRMED-SW  PIC  X(01).          03670000
036800                 88  ASC-MULT-SETS-CONFIRMED            VALUE 'Y'.03680000
036900                 88  ASC-MULT-SETS-CONFIRMED-NO         VALUE 'N'.03690000
037000             15  ASC-OVER-99-CHECK-DONE-SW   PIC  X(01).          03700000
037100                 88  ASC-OVER-99-CHECK-DONE             VALUE 'Y'.03710000
037200                 88  ASC-OVER-99-CHECK-DONE-NO          VALUE 'N'.03720000
037300             15  ASC-LABEL-PRINT-COMPLETE-SW PIC  X(01).          03730099
037400                 88  ASC-LABEL-PRINT-COMPLETE           VALUE 'Y'.03740099
037500                 88  ASC-LABEL-PRINT-COMPLETE-NO        VALUE 'N'.03750099
037600             15  ASC-HR-DESC-DISPLAYED-SW    PIC  X(01).          03760099
037700                 88  ASC-HR-DESC-DISPLAYED              VALUE 'Y'.03770099
037800                 88  ASC-HR-DESC-DISPLAYED-NO           VALUE 'N'.03780099
037900             15  ASC-EDITS-COMPLETE-SW       PIC  X(01).          03790099
038000                 88  ASC-EDITS-COMPLETE                 VALUE 'Y'.03800099
038100                 88  ASC-EDITS-COMPLETE-NO              VALUE 'N'.03810099
038200             15  ASC-OPER-UNT-ID           PIC X(04).             03820000
038300             15  ASC-OPER-UNT-ID-N    REDEFINES                   03830000
038400                 ASC-OPER-UNT-ID             PIC 9(04).           03840000
038500             15  ASC-OPER-UNT-NME          PIC X(25).             03850000
038600             15  ASC-FCLTY-ID                PIC X(04).           03860000
038700             15  ASC-FCLTY-ID-N       REDEFINES                   03870000
038800                 ASC-FCLTY-ID                PIC 9(04).           03880000
038900             15  ASC-PRTR-ID                 PIC X(03).           03890000
039000             15  ASC-PRTR-ID-N        REDEFINES                   03900000
039100                 ASC-PRTR-ID                 PIC  9(03).          03910000
039200             15  ASC-PRTR-DESC               PIC  X(25).          03920000
039300             15  ASC-SETS-OF-LABELS          PIC  X(04).          03930000
039400             15  ASC-SETS-OF-LABELS-N  REDEFINES                  03940000
039500                 ASC-SETS-OF-LABELS          PIC  9(04).          03950000
039600             15  ASC-BUILDING                PIC  X(01).          03960099
039700             15  ASC-BUILDING-N              PIC  9(01).          03970099
039800             15  ASC-AISLE                   PIC  X(02).          03980099
039900             15  ASC-AISLE-N                 PIC  9(02).          03990099
040000             15  ASC-BEGIN-SLOT             PIC  X(03) JUST RIGHT.04000099
040100             15  ASC-BEGIN-SLOT-N            PIC  9(03).          04010099
040200             15  ASC-BEGIN-SLOT-N-5          PIC  9(05).          04020099
040300             15  ASC-END-SLOT               PIC  X(03) JUST RIGHT.04030099
040400             15  ASC-END-SLOT-N              PIC  9(03).          04040099
040500             15  ASC-END-SLOT-N-5            PIC  9(05).          04050099
040600             15  ASC-TIER                    PIC  X(02).          04060099
040700             15  ASC-TIER-N                  PIC  9(02).          04070099
040800             15  ASC-TOTAL-LABELS            PIC  X(05).          04080000
040900             15  ASC-TOTAL-LABELS-N   REDEFINES                   04090000
041000                 ASC-TOTAL-LABELS            PIC  9(05).          04100000
041100                                                                  04110000
041200     EJECT                                                        04120000
041300*----------------------------------------------------------------*04130000
041400*    CARTON LABEL COPYBOOK  (SOCKETS)                            *04140000
041500*----------------------------------------------------------------*04150000
041600     COPY PCWS140.                                                04160000
041700                                                                  04170000
041800*----------------------------------------------------------------*04180000
041900*    ABEND PROCESSING COPYBOOK.                                  *04190000
042000*----------------------------------------------------------------*04200000
042100                                                                  04210000
042200     COPY DPWS013.                                                04220000
042300                                                                  04230000
042400     EJECT                                                        04240000
042500*----------------------------------------------------------------*04250000
042600*    ATTRIBUTE SETTINGS COPYBOOK.                                *04260000
042700*----------------------------------------------------------------*04270000
042800                                                                  04280000
042900     COPY DPWS015.                                                04290000
043000                                                                  04300000
043100*----------------------------------------------------------------*04310000
043200*    FUNCTION KEYS COPYBOOK                                      *04320000
043300*----------------------------------------------------------------*04330000
043400                                                                  04340000
043500     COPY DPWS016.                                                04350000
043600                                                                  04360000
043700*----------------------------------------------------------------*04370000
043800*    MAP LAYOUT                                                  *04380000
043900*----------------------------------------------------------------*04390000
044000                                                                  04400000
044100     COPY PCKM718.                                                04410099
044200                                                                  04420000
044300 EJECT                                                            04430000
044400                                                                  04440000
044500*    DB2 AREA FOR TSTATCD  (STATUS CODE)                          04450000
044600                                                                  04460000
044700     EXEC SQL                                                     04470000
044800          INCLUDE TSTATCD                                         04480000
044900     END-EXEC.                                                    04490000
045000                                                                  04500000
045100*    DB2 AREA FOR TRECEIV  (RECEIVER TABLE)                       04510000
045200                                                                  04520000
045300     EXEC SQL                                                     04530000
045400          INCLUDE TRECEIV                                         04540000
045500     END-EXEC.                                                    04550000
045600                                                                  04560000
045700                                                                  04570000
045800*    DB2 AREA FOR TPURCHS  (PURCHASE ORDER HEADER TABLE)          04580000
045900                                                                  04590000
046000     EXEC SQL                                                     04600000
046100          INCLUDE TPURCHS                                         04610000
046200     END-EXEC.                                                    04620000
046300                                                                  04630000
046400*    DB2 AREA FOR TPURITM  (PURCHASE ORDER ITEM TABLE)            04640000
046500                                                                  04650000
046600     EXEC SQL                                                     04660000
046700          INCLUDE TPURITM                                         04670000
046800     END-EXEC.                                                    04680000
046900                                                                  04690000
047000*    DB2 AREA FOR TWKORIN  (WORK ORDER INSTRUCTION TABLE)         04700000
047100                                                                  04710000
047200     EXEC SQL                                                     04720000
047300          INCLUDE TWKORIN                                         04730000
047400     END-EXEC.                                                    04740000
047500                                                                  04750000
047600                                                                  04760000
047700*    DB2 AREA FOR TPCLABL  (MISC FIELDS FOR LABEL VALIDATION)     04770000
047800                                                                  04780000
047900     EXEC SQL                                                     04790000
048000          INCLUDE TPCLABL                                         04800000
048100     END-EXEC.                                                    04810000
048200                                                                  04820000
048300*----------------------------------------------------------------*04830000
048400*    DB2 AREA FOR THE LOCATION TABLE - XLT_LOC                   *04840099
048500*----------------------------------------------------------------*04850000
048600     EXEC SQL                                                     04860000
048700          INCLUDE XLT00010                                        04870099
048800     END-EXEC.                                                    04880000
048900                                                                  04890000
049000*----------------------------------------------------------------*04900000
049100*    DB2 AREA FOR COMMUNICATIONS                                 *04910000
049200*----------------------------------------------------------------*04920000
049300                                                                  04930000
049400     EXEC SQL                                                     04940000
049500          INCLUDE SQLCA                                           04950000
049600     END-EXEC.                                                    04960000
049700                                                                  04970000
049800                                                                  04980000
049900 EJECT                                                            04990000
050000 LINKAGE SECTION.                                                 05000000
050100                                                                  05010000
050200 01  DFHCOMMAREA.                                                 05020000
050300     05  FILLER                         OCCURS  1 TO 4072 TIMES   05030000
050400                                        DEPENDING ON EIBCALEN.    05040000
050500         10  FILLER                     PIC X.                    05050000
050600                                                                  05060000
050700                                                                  05070000
050800 PROCEDURE DIVISION.                                              05080000
050900*----------------------------------------------------------------*05090000
051000*  THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM.   *05100000
051100*  THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API    *05110000
051200*  MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.              *05120000
051300*                                                                *05130000
051400*  THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE    *05140000
051500*  LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.         *05150000
051600*----------------------------------------------------------------*05160000
051700 0000-MAIN-MODULE.                                                05170000
051800                                                                  05180000
051900     INITIALIZE DP030-CICS-API-FIELDS.                            05190000
052000                                                                  05200000
052100     MOVE +1                     TO DP030-NUMBER-OF-MAPS.         05210000
052200     MOVE PC-CURRENT-MAPSET-NAME TO DP030-MAPSET-NAME.            05220000
052300     MOVE PC-CURRENT-MAP-NAME    TO DP030-MAP-NAME (1).           05230000
052400                                                                  05240000
052500     SET DP030-RECEIVE-APPL-MAP  TO TRUE.                         05250000
052600                                                                  05260000
052700     MOVE LENGTH OF PC718AI      TO DP030-MAP-LENGTH (1).         05270099
052800     MOVE 'PROGRAM ENTRY CALL'   TO DP013-MESSAGE-TEXT (1).       05280000
052900                                                                  05290000
053000     PERFORM 0001-CALL-CICS-ARCH-API.                             05300000
053100                                                                  05310000
053200     PERFORM 1000-CONTROL-PROCESSING.                             05320000
053300                                                                  05330000
053400     MOVE 'PROGRAM EXIT CALL'    TO DP013-MESSAGE-TEXT (1).       05340000
053500                                                                  05350000
053600     PERFORM 0001-CALL-CICS-ARCH-API.                             05360000
053700                                                                  05370000
053800                                                                  05380000
053900 0001-CALL-CICS-ARCH-API.                                         05390000
054000                                                                  05400000
1122RM*    CALL 'DPKCS030' USING DFHEIBLK                               05410099
1122RM     CALL DP930-CICS-ARCH-API                                     05411099
1122RM                     USING DFHEIBLK                               05412099
054200                           DFHCOMMAREA                            05420000
054300                           DP030-CICS-API-FIELDS                  05430000
054400                           DP020-STANDARD-COMMAREA                05440000
054500                           PC718AI.                               05450099
054600                                                                  05460000
054700     IF  DP030-RC-CALL-SUCCESSFUL                                 05470000
054800         CONTINUE                                                 05480000
054900     ELSE                                                         05490000
055000         SET DP013-NO-ROLLBACK   TO TRUE                          05500000
055100         SET DP013-XCTL-DISPLAY-RESTART                           05510000
055200                                 TO TRUE                          05520000
055300         SET DP013-CICS-ABEND    TO TRUE                          05530000
055400         MOVE 'BEFORE 0000-MAIN-MODULE'                           05540000
055500                                 TO DP013-PARAGRAPH               05550000
1122RM*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX05560099
1122RM*             'T LINE'           TO DP013-MESSAGE-TEXT (2)        05570099
1122rm         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O05571099
1122RM-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      05572099
055800         MOVE DP030-RETURN-CODE  TO DP013-MESSAGE-TEXT (3)        05580000
055900         PERFORM DP013-0000-PROCESS-ABEND                         05590000
056000     END-IF.                                                      05600000
056100 EJECT                                                            05610000
056200*----------------------------------------------------------------*05620000
056300*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *05630000
056400*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *05640000
056500*                                                                *05650000
056600*    PERFORMED BY 0000-MAIN-MODULE.                              *05660000
056700*----------------------------------------------------------------*05670000
056800                                                                  05680000
056900 1000-CONTROL-PROCESSING.                                         05690000
057000                                                                  05700000
057100     EVALUATE TRUE                                                05710000
057200         WHEN DP020-NEXT-ACT-INITIAL                              05720000
057300             INITIALIZE ASC-SPECIFIC-COMMAREA                     05730000
057400             INITIALIZE DP020-MSG-NUMBER                          05740000
057500             SET ASC-KEEP-SETS-VALUE-NO      TO TRUE              05750099
057600             SET ASC-OVER-99-CHECK-DONE-NO   TO TRUE              05760099
057700             SET ASC-LABEL-PRINT-COMPLETE-NO TO TRUE              05770099
057800             SET ASC-AID-ENTER-NO            TO TRUE              05780099
057900             SET ASC-AID-ADD-NO              TO TRUE              05790099
058000             SET ASC-HR-DESC-DISPLAYED-NO    TO TRUE              05800099
058100             SET ASC-EDITS-COMPLETE-NO       TO TRUE              05810099
058200             PERFORM 3000-BUILD-INITIAL-PANEL                     05820000
058300             PERFORM 2210-RESET-ATTRIBUTES                        05830000
058400                                                                  05840000
058500         WHEN DP020-NEXT-ACT-READ-MAP                             05850000
058600             PERFORM 2000-FKEY-PROCESSING                         05860000
058700                                                                  05870000
058800         WHEN DP020-NEXT-ACT-RETURN                               05880000
058900             PERFORM 2300-MOVE-COMMAREA-TO-SCREEN                 05890000
059000             PERFORM 2200-EDIT-DATA-IN-COMMAREA                   05900000
059100             PERFORM 3200-DISPLAY-PANEL                           05910000
059200                                                                  05920000
059300         WHEN OTHER                                               05930000
059400             SET DP013-LOGIC-ABEND                                05940000
059500                                 TO TRUE                          05950000
059600             SET DP013-NO-ROLLBACK                                05960000
059700                                 TO TRUE                          05970000
059800             MOVE '1000-CONTROL-PROCESSING'                       05980000
059900                                 TO DP013-PARAGRAPH               05990000
060000             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   06000000
060100                                 TO DP013-MESSAGE-TEXT(1)         06010000
060200             MOVE DP020-NEXT-APPL-ACTIVITY                        06020000
060300                                 TO DP013-MESSAGE-TEXT(2)         06030000
060400             PERFORM DP013-0000-PROCESS-ABEND                     06040000
060500     END-EVALUATE.                                                06050000
060600                                                                  06060000
060700 EJECT                                                            06070000
060800*----------------------------------------------------------------*06080000
060900*   DETERMINE THE PROCESSING PATH HERE.                          *06090000
061000*----------------------------------------------------------------*06100000
061100 2000-FKEY-PROCESSING.                                            06110000
061200                                                                  06120000
061300     EVALUATE TRUE                                                06130000
061400         WHEN DP020-SRC-AID = DP016-CLEAR                         06140000
061500              PERFORM 2300-MOVE-COMMAREA-TO-SCREEN                06150099
061600              PERFORM 2200-EDIT-DATA-IN-COMMAREA                  06160099
061700              PERFORM 3200-DISPLAY-PANEL                          06170099
061800              PERFORM 2210-RESET-ATTRIBUTES                       06180099
061900                                                                  06190000
062000         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     06200000
062100              MOVE ASC-PRTR-ID-N  TO PV-PRINTER-ID                06210099
062200              INITIALIZE ASC-SPECIFIC-COMMAREA                    06220099
062300              MOVE PV-PRINTER-ID  TO ASC-PRTR-ID-N                06230099
062400              MOVE SPACES         TO AOPUNITO                     06240099
062500                                     AFACILO                      06250099
062600                                     APRTRO                       06260099
062700                                     ASETSO                       06270099
062800                                     ABLDGO                       06280099
062900                                     AAISLEO                      06290099
063000                                     ABSLOTO                      06300099
063100                                     AESLOTO                      06310099
063200                                     ATIERO                       06320099
063300                                                                  06330000
063400              SET ASC-KEEP-SETS-VALUE-NO     TO TRUE              06340099
063500              SET ASC-OVER-99-CHECK-DONE-NO  TO TRUE              06350099
063600              SET ASC-AID-ENTER-NO           TO TRUE              06360099
063700              SET ASC-AID-ADD-NO             TO TRUE              06370099
063800              PERFORM 3000-BUILD-INITIAL-PANEL                    06380099
063900              PERFORM 2210-RESET-ATTRIBUTES                       06390099
064000                                                                  06400000
064100         WHEN DP020-SRC-AID = DP016-ENTER                         06410000
064200              SET ASC-AID-ENTER  TO TRUE                          06420099
064300              EVALUATE TRUE                                       06430099
064400                  WHEN DP020-NEXT-ACT-INITIAL                     06440099
064500                  PERFORM 2100-MOVE-SCREEN-TO-COMMAREA            06450099
064600                  PERFORM 2200-EDIT-DATA-IN-COMMAREA              06460099
064700              END-EVALUATE                                        06470099
064800              IF (ASC-LABEL-PRINT-COMPLETE AND                    06480099
064900                  ASC-AID-ENTER            AND                    06490099
065000                  ASC-HR-DESC-DISPLAYED-NO)                       06500099
065100                 IF ASC-EDITS-COMPLETE                            06510099
065200                    MOVE -1                     TO ABLDGL         06520099
065300                    SET DP030-SET-CURSOR-APPL-1 TO TRUE           06530099
065400                 END-IF                                           06540099
065500                 MOVE SPACES                 TO AHRDESCO          06550099
065600                 IF (ASC-SETS-OF-LABELS-N = 0   AND               06560099
065700                     ASC-LABEL-PRINT-COMPLETE   AND               06570099
065800                     ASC-HR-DESC-DISPLAYED-NO   AND               06580099
065900                     ASC-EDITS-COMPLETE)                          06590099
066000                    MOVE +0001          TO ASC-SETS-OF-LABELS-N   06600099
066100                    MOVE +0001               TO PV-SUPPRESS-FOUR  06610099
066200                    MOVE PV-SUPPRESS-FOUR    TO ASETSI            06620099
066300                 END-IF                                           06630099
066400              END-IF                                              06640099
066500              PERFORM 2100-MOVE-SCREEN-TO-COMMAREA                06650099
066600              PERFORM 2200-EDIT-DATA-IN-COMMAREA                  06660099
066700              PERFORM 2260-FIELD-EDITS                            06670099
066800              PERFORM 2280-CALCULATE-LABEL-TOTALS                 06680099
066900              PERFORM 2265-STRING-FREE-FORM-TEXT                  06690099
067000              PERFORM 2285-DISPLAY-HR-LABELS                      06700099
067100              PERFORM 3200-DISPLAY-PANEL                          06710099
067200              PERFORM 2210-RESET-ATTRIBUTES                       06720099
067300                                                                  06730000
067400         WHEN DP020-FK-LOCAL-GOTO    (DP020-SRC-AID)              06740000
067500         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              06750000
067600         WHEN DP020-FK-CONFIRM       (DP020-SRC-AID)              06760000
067700              SET ASC-AID-ENTER-NO  TO TRUE                       06770099
067800              SET ASC-AID-ADD       TO TRUE                       06780099
067900              PERFORM 2100-MOVE-SCREEN-TO-COMMAREA                06790099
068000              PERFORM 2200-EDIT-DATA-IN-COMMAREA                  06800099
068100              PERFORM 2260-FIELD-EDITS                            06810099
068200              PERFORM 2280-CALCULATE-LABEL-TOTALS                 06820099
068300                                                                  06830000
068400             IF  PS-ERROR                                         06840000
068500                 SET DP030-OVERRIDE-GO                            06850000
068600                                 TO TRUE                          06860000
068700                 PERFORM 3200-DISPLAY-PANEL                       06870000
068800             ELSE                                                 06880000
068900                 IF NOT  (DP020-FK-CONFIRM (DP020-SRC-AID))       06890000
069000                   IF (ASC-SETS-OF-LABELS-N > PC-1)               06900000
069100                    SET PS-ERROR          TO TRUE                 06910000
069200                    SET DP020-MSG-WARNING TO TRUE                 06920000
069300                    MOVE ASC-SETS-OF-LABELS-N TO PV-SUPPRESS-FOUR 06930000
069400                    MOVE PV-SUPPRESS-FOUR     TO DP020-MSG-TEXT   06940000
069500                    MOVE PC-TSYMSG-02504  TO DP020-MSG-NUMBER     06950000
069600                    SET ASC-KEEP-SETS-VALUE   TO TRUE             06960000
069700                    SET ASC-MULT-SETS-CONFIRMED-NO  TO TRUE       06970000
069800                    SET DP030-OVERRIDE-GO TO TRUE                 06980000
069900                    PERFORM 3200-DISPLAY-PANEL                    06990000
070000                   END-IF                                         07000000
070100                 ELSE                                             07010000
070200                   IF ((DP020-FK-CONFIRM (DP020-SRC-AID)) AND     07020000
070300                        (ASC-SETS-OF-LABELS-N > PC-1))            07030000
070400                        SET ASC-MULT-SETS-CONFIRMED TO TRUE       07040000
070500                   END-IF                                         07050000
070600                 END-IF                                           07060000
070700             END-IF                                               07070000
070800             IF  PS-ERROR                                         07080000
070900                 SET DP030-OVERRIDE-GO                            07090000
071000                                 TO TRUE                          07100000
071100                 PERFORM 3200-DISPLAY-PANEL                       07110000
071200             ELSE                                                 07120000
071300                 SET ASC-KEEP-SETS-VALUE-NO TO TRUE               07130000
071400                 IF ((ASC-SETS-OF-LABELS-N > PC-1)) AND           07140000
071500                     (ASC-MULT-SETS-CONFIRMED)                    07150000
071600                   IF ((PV-TOTAL-LABELS > PC-99 ) AND             07160000
071700                       (ASC-OVER-99-CHECK-DONE-NO))               07170000
071800                    SET PS-ERROR          TO TRUE                 07180000
071900                    SET DP020-MSG-WARNING TO TRUE                 07190000
072000                    MOVE PC-TSYMSG-02505  TO DP020-MSG-NUMBER     07200000
072100                    MOVE PV-TOTAL-LABELS  TO PV-SUPPRESS-FOUR     07210000
072200                    MOVE PV-SUPPRESS-FOUR TO DP020-MSG-TEXT       07220000
072300                    SET ASC-KEEP-SETS-VALUE    TO TRUE            07230000
072400                    SET ASC-OVER-99-CHECK-DONE TO TRUE            07240000
072500                    SET DP030-OVERRIDE-GO TO TRUE                 07250000
072600                    PERFORM 3200-DISPLAY-PANEL                    07260000
072700                   ELSE                                           07270000
072800                    IF ((PV-TOTAL-LABELS = PC-99 ) AND            07280000
072900                        (ASC-OVER-99-CHECK-DONE-NO))              07290000
073000                     SET PS-ERROR          TO TRUE                07300000
073100                     SET DP020-MSG-WARNING TO TRUE                07310000
073200                     MOVE PC-TSYMSG-02505  TO DP020-MSG-NUMBER    07320000
073300                     MOVE PV-TOTAL-LABELS  TO PV-SUPPRESS-FOUR    07330000
073400                     MOVE PV-SUPPRESS-FOUR TO DP020-MSG-TEXT      07340000
073500                     SET ASC-KEEP-SETS-VALUE    TO TRUE           07350000
073600                     SET ASC-OVER-99-CHECK-DONE TO TRUE           07360000
073700                     SET DP030-OVERRIDE-GO TO TRUE                07370000
073800                     PERFORM 3200-DISPLAY-PANEL                   07380000
073900                    END-IF                                        07390000
074000                   END-IF                                         07400000
074100                 ELSE                                             07410000
074200                   IF ((ASC-SETS-OF-LABELS-N = PC-1) AND          07420000
074300                       (PV-TOTAL-LABELS > PC-99 ) AND             07430000
074400                        ASC-OVER-99-CHECK-DONE-NO)                07440000
074500                    SET PS-ERROR          TO TRUE                 07450000
074600                    SET DP020-MSG-WARNING TO TRUE                 07460000
074700                    MOVE PC-TSYMSG-02505  TO DP020-MSG-NUMBER     07470000
074800                    MOVE PV-TOTAL-LABELS  TO PV-SUPPRESS-FOUR     07480000
074900                    MOVE PV-SUPPRESS-FOUR TO DP020-MSG-TEXT       07490000
075000                    SET ASC-KEEP-SETS-VALUE    TO TRUE            07500000
075100                    SET ASC-OVER-99-CHECK-DONE TO TRUE            07510000
075200                    SET DP030-OVERRIDE-GO TO TRUE                 07520000
075300                    PERFORM 3200-DISPLAY-PANEL                    07530000
075400                   ELSE                                           07540000
075500                      IF ((PV-TOTAL-LABELS > PC-99 ) AND          07550000
075600                          (ASC-OVER-99-CHECK-DONE) AND            07560000
075700                         (DP020-FK-CONFIRM (DP020-SRC-AID)))      07570000
075800                         CONTINUE                                 07580000
075900                      END-IF                                      07590000
076000                   END-IF                                         07600000
076100                 END-IF                                           07610000
076200             END-IF                                               07620000
076300             IF PS-NO-ERROR                                       07630000
076400                 SET DP030-CONTINUE-GO TO TRUE                    07640000
076500                 PERFORM 4000-SETUP-LABELS                        07650000
076600                 IF PC140-CRA-SUCCESSFUL                          07660000
076700                    SET ASC-ADD-COMPLETE TO TRUE                  07670000
076800                    SET DP020-MSG-INFORMATIONAL                   07680000
076900                                         TO TRUE                  07690000
077000                    PERFORM 2300-MOVE-COMMAREA-TO-SCREEN          07700000
077100                    PERFORM 3000-BUILD-INITIAL-PANEL              07710000
077200                 END-IF                                           07720000
077300             END-IF                                               07730000
077400                                                                  07740000
077500         WHEN OTHER                                               07750000
077600             SET DP013-NO-ROLLBACK                                07760000
077700                                 TO TRUE                          07770000
077800             SET DP013-XCTL-DISPLAY-RESTART                       07780000
077900                                 TO TRUE                          07790000
078000             SET DP013-CICS-ABEND                                 07800000
078100                                 TO TRUE                          07810000
078200             MOVE '2000-FKEY-PROCESSING'                          07820000
078300                                 TO DP013-PARAGRAPH               07830000
078400             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      07840000
078500                                 TO DP013-MESSAGE-TEXT (1)        07850000
078600             PERFORM DP013-0000-PROCESS-ABEND                     07860000
078700     END-EVALUATE.                                                07870000
078800                                                                  07880000
078900 EJECT                                                            07890000
079000*----------------------------------------------------------------*07900000
079100*    MOVE THE DATA ENTERED ON THE SCREEN TO THE COMMAREA.        *07910000
079200*                                                                *07920000
079300*    WHILE ABSORBING THE USER-ENTERED DATA FROM THE SCREEN,      *07930000
079400*    IT IS NECESSARY TO DETERMINE WHICH QUALIFIER, RANGE OR      *07940000
079500*    SEPARATOR FIELDS HAVE VALUES, AND IF THE QUALIFIER OR RANGE *07950000
079600*    FIELDS CONTAIN NUMERICS. THIS IS NECESSARY IN ORDER TO      *07960000
079700*    DETERMINE IF A RANGE WAS SPECIFIED, IF IT IS A VALID        *07970000
079800*    RANGE, AND WHERE ITS POSITION WILL BE IN THE HORIZONTAL     *07980000
079900*    HUMAN READABLE PORTION OF THE LABEL THAT IT BEING CREATED.  *07990000
080000*    THE CHECK FOR NUMERIC WILL CALL THE KOHLS NUMERIC EDIT      *08000000
080100*    ROUTINE DPKUT100.                                           *08010000
080200*                                                                *08020000
080300* !! I M P O R T A N T !!                                        *08030000
080400*                                                                *08040000
080500*   SIMILAR LOGIC THAT SETS SWITCHES HERE NEEDS TO BE EXECUTED   *08050000
080600*   AGAIN IN PARAGRAPH 2260-FIELD-EDITS BECAUSE                  *08060099
080700*   THE USER MAY HAVE ENTERED A RANGE VALUE W/O A CORRESPONDING  *08070000
080800*   NUMERIC QUALIFIER FIELD OR VICE VERSA, OR NO RANGE VALUE OR  *08080000
080900*   TOO MANY ETC. THE SCREEN WITH ERRORS WILL BE PRESENTED BACK  *08090000
081000*   TO THE USER. TO AVOID HAVING TO ENTER ALL OF THE FREE FORM   *08100000
081100*   TEXT EVERY TIME THERE IS AN ERROR, JUST EXECUTE TWICE THE    *08110000
081200*   LOGIC THAT DETERMINES IF A FIELD HAS A VALUE & IF IT IS      *08120000
081300*   NUMERIC ETC.                                                 *08130000
081400*----------------------------------------------------------------*08140000
081500 2100-MOVE-SCREEN-TO-COMMAREA.                                    08150000
081600                                                                  08160000
081700     IF AOPUNITL > ZERO                                           08170000
081800         MOVE AOPUNITI             TO ASC-OPER-UNT-ID             08180000
081900     ELSE                                                         08190000
082000         IF AOPUNITF = DP015-ERASE-EOF                            08200000
082100             MOVE SPACE            TO ASC-OPER-UNT-ID             08210000
082200         END-IF                                                   08220000
082300     END-IF.                                                      08230000
082400                                                                  08240000
082500     IF AFACILL  > ZERO                                           08250000
082600         MOVE AFACILI              TO ASC-FCLTY-ID                08260000
082700     ELSE                                                         08270000
082800         IF AFACILF  = DP015-ERASE-EOF                            08280000
082900             MOVE SPACE            TO ASC-FCLTY-ID                08290000
083000         END-IF                                                   08300000
083100     END-IF.                                                      08310000
083200                                                                  08320000
083300     IF  APRTRL > ZERO                                            08330000
083400         MOVE APRTRI               TO ASC-PRTR-ID                 08340000
083500     ELSE                                                         08350000
083600         IF  APRTRF = DP015-ERASE-EOF                             08360000
083700             MOVE SPACE            TO ASC-PRTR-ID                 08370000
083800         END-IF                                                   08380000
083900     END-IF.                                                      08390000
084000                                                                  08400000
084100     IF  ASETSL > ZERO                                            08410000
084200         MOVE ASETSI               TO PV-SUPPRESS-FOUR            08420000
084300         MOVE PV-SUPPRESS-FOUR     TO ASC-SETS-OF-LABELS          08430000
084400     ELSE                                                         08440000
084500        IF ASETSL = ZERO                                          08450000
084600          IF ((ASC-KEEP-SETS-VALUE-NO     AND                     08460099
084700               ASC-AID-ENTER-NO           AND                     08470099
084800               ASC-AID-ADD)                  OR                   08480099
084900              (ASC-AID-ENTER              AND                     08490099
085000               ASC-HR-DESC-DISPLAYED-NO   AND                     08500099
085100               ASC-EDITS-COMPLETE         AND                     08510099
085200               ASC-LABEL-PRINT-COMPLETE)        OR                08520099
085300              (ASC-KEEP-SETS-VALUE-NO     AND                     08530099
085400               ASC-SETS-OF-LABELS NOT > 0 AND                     08540099
085500               ASC-AID-ENTER))                                    08550099
085600               MOVE PC-1            TO ASC-SETS-OF-LABELS         08560099
085700          END-IF                                                  08570000
085800        ELSE                                                      08580000
085900           IF ASETSF = DP015-ERASE-EOF                            08590000
086000              MOVE SPACE           TO ASC-SETS-OF-LABELS          08600000
086100           END-IF                                                 08610000
086200        END-IF                                                    08620000
086300     END-IF.                                                      08630000
086400                                                                  08640000
086500     PERFORM 2250-RESET-FREE-FORM-SWITCHES.                       08650000
086600                                                                  08660000
086700     IF  (ABLDGL  > ZERO OR ABLDGL = -1)                          08670099
086800         MOVE ABLDGI               TO ASC-BUILDING                08680099
086900         SET ASC-BLDG-SPECIFIED    TO TRUE                        08690099
087000     ELSE                                                         08700099
087100         IF  ABLDGF  = DP015-ERASE-EOF                            08710099
087200             MOVE SPACE            TO ASC-BUILDING                08720099
087300         END-IF                                                   08730099
087400     END-IF.                                                      08740099
087500                                                                  08750099
087600     IF  AAISLEL > ZERO                                           08760099
087700         INITIALIZE PV-CONVERSION-FIELD-X                         08770099
087800         MOVE AAISLEI              TO PV-CONVERSION-FIELD-X       08780099
087900         PERFORM 2290-ALPHA-TO-NUM-CONVERSION                     08790099
088000         MOVE PV-CONVERSION-FIELD-9 TO ASC-AISLE-N                08800099
088100         INITIALIZE DP010I-UNEDITED-FIELD                         08810099
088200         MOVE ASC-AISLE            TO DP010I-UNEDITED-FIELD       08820099
088300         PERFORM 2101-NUMERIC-EDIT-ROUTINE                        08830099
088400         IF DP010I-NUM-FIELD-17-DIG-0-DEC > 0                     08840099
088500            SET ASC-AISLE-IS-NUMERIC TO TRUE                      08850099
088600            SET ASC-AISLE-SPECIFIED  TO TRUE                      08860099
088700            MOVE DP010I-NUMERIC-FIELD TO ASC-AISLE-N              08870099
088800         END-IF                                                   08880099
088900     ELSE                                                         08890000
089000         IF  AAISLEF = DP015-ERASE-EOF                            08900099
089100             MOVE SPACE            TO ASC-AISLE                   08910099
089200         END-IF                                                   08920000
089300     END-IF.                                                      08930000
089400                                                                  08940000
089500     IF  ABSLOTL > ZERO                                           08950099
089600         INITIALIZE PV-CONVERSION-FIELD-X                         08960099
089700         MOVE ABSLOTI              TO PV-CONVERSION-FIELD-X       08970099
089800         PERFORM 2290-ALPHA-TO-NUM-CONVERSION                     08980099
089900         MOVE PV-CONVERSION-FIELD-9 TO ASC-BEGIN-SLOT-N           08990099
090000         INITIALIZE DP010I-UNEDITED-FIELD                         09000000
090100         MOVE ASC-BEGIN-SLOT-N     TO DP010I-UNEDITED-FIELD       09010099
090200         PERFORM 2101-NUMERIC-EDIT-ROUTINE                        09020000
090300         IF DP010I-NUM-FIELD-17-DIG-0-DEC > 0                     09030099
090400               SET ASC-BSLOT-IS-NUMERIC TO TRUE                   09040099
090500               SET ASC-BSLOT-SPECIFIED  TO TRUE                   09050099
090600               MOVE DP010I-NUMERIC-FIELD TO ASC-BEGIN-SLOT-N      09060099
090700               MOVE ASC-BEGIN-SLOT-N    TO ASC-BEGIN-SLOT-N-5     09070099
090800         END-IF                                                   09080099
090900     ELSE                                                         09090000
091000         IF  ABSLOTF = DP015-ERASE-EOF                            09100099
091100             MOVE SPACE            TO ASC-BEGIN-SLOT              09110099
091200         END-IF                                                   09120000
091300     END-IF.                                                      09130000
091400                                                                  09140000
091500     IF  AESLOTL > ZERO                                           09150099
091600         MOVE AESLOTI              TO ASC-END-SLOT-N              09160099
091700         INITIALIZE PV-CONVERSION-FIELD-X                         09170099
091800         MOVE AESLOTI              TO PV-CONVERSION-FIELD-X       09180099
091900         PERFORM 2290-ALPHA-TO-NUM-CONVERSION                     09190099
092000         MOVE PV-CONVERSION-FIELD-9 TO ASC-END-SLOT-N             09200099
092100         INITIALIZE DP010I-UNEDITED-FIELD                         09210099
092200         MOVE ASC-END-SLOT-N       TO DP010I-UNEDITED-FIELD       09220099
092300         PERFORM 2101-NUMERIC-EDIT-ROUTINE                        09230099
092400         IF DP010I-NUM-FIELD-17-DIG-0-DEC > 0                     09240099
092500            SET ASC-ESLOT-SPECIFIED   TO TRUE                     09250099
092600            SET ASC-ESLOT-IS-NUMERIC  TO TRUE                     09260099
092700            MOVE DP010I-NUMERIC-FIELD TO ASC-END-SLOT-N           09270099
092800            MOVE ASC-END-SLOT-N       TO ASC-END-SLOT-N-5         09280099
092900         END-IF                                                   09290099
093000     ELSE                                                         09300099
093100         IF  ABSLOTF = DP015-ERASE-EOF                            09310099
093200             MOVE SPACE            TO ASC-END-SLOT                09320099
093300         END-IF                                                   09330099
093400     END-IF.                                                      09340099
093500                                                                  09350099
093600     IF  ATIERL  > ZERO                                           09360099
093700         INITIALIZE PV-CONVERSION-FIELD-X                         09370099
093800         MOVE ATIERI               TO PV-CONVERSION-FIELD-X       09380099
093900         PERFORM 2290-ALPHA-TO-NUM-CONVERSION                     09390099
094000         MOVE PV-CONVERSION-FIELD-9 TO ASC-TIER-N                 09400099
094100         INITIALIZE DP010I-UNEDITED-FIELD                         09410099
094200         MOVE ASC-TIER             TO DP010I-UNEDITED-FIELD       09420099
094300         PERFORM 2101-NUMERIC-EDIT-ROUTINE                        09430099
094400         IF DP010I-NUM-FIELD-17-DIG-0-DEC > 0                     09440099
094500            SET ASC-TIER-IS-NUMERIC TO TRUE                       09450099
094600            SET ASC-TIER-SPECIFIED  TO TRUE                       09460099
094700            MOVE DP010I-NUMERIC-FIELD TO ASC-TIER-N               09470099
094800         END-IF                                                   09480099
094900     ELSE                                                         09490099
095000         IF  ATIERF  = DP015-ERASE-EOF                            09500099
095100             MOVE SPACE            TO ASC-TIER                    09510099
095200         END-IF                                                   09520099
095300     END-IF.                                                      09530099
095400                                                                  09540000
095500 EJECT                                                            09550000
095600*----------------------------------------------------------------*09560000
095700* KOHLS STANDARD NUMERIC EDIT ROUTINE DPKUT100.                  *09570000
095800*----------------------------------------------------------------*09580000
095900 2101-NUMERIC-EDIT-ROUTINE.                                       09590000
096000                                                                  09600000
096100     MOVE +3                     TO DP010I-MAXIMUM-DIGITS.        09610099
096200     MOVE +0                     TO DP010I-MAXIMUM-DECIMALS.      09620000
096300                                                                  09630000
096400     SET DP010I-NEGATIVE-NOT-ALLOWED                              09640000
096500                                 TO TRUE.                         09650000
096600                                                                  09660000
096710     CALL DP010I-NUMERIC-EDIT-ROUTINE                             09671099
096720                         USING DP010I-NUMERIC-EDIT-AREA.          09672099
096800                                                                  09680000
096900 EJECT                                                            09690000
097000*----------------------------------------------------------------*09700000
097100*    ENSURE THAT THE DATA IS CORRECT AND ISSUE APPROPRIATE       *09710000
097200*    ERROR MESSAGES IF NECESSARY.                                *09720000
097300*----------------------------------------------------------------*09730000
097400 2200-EDIT-DATA-IN-COMMAREA.                                      09740000
097500                                                                  09750000
097600     PERFORM 2210-RESET-ATTRIBUTES.                               09760000
097700                                                                  09770000
097800     SET ERROR-ON-OP-UNIT-EDIT TO TRUE.                           09780000
097900     PERFORM 2213-EDIT-OPERATING-UNIT.                            09790000
098000                                                                  09800000
098100     SET ERROR-ON-FACILITY-EDIT TO TRUE.                          09810000
098200     PERFORM 2215-EDIT-FACILITY.                                  09820000
098300                                                                  09830000
098400     SET ERROR-ON-PRINTER-EDIT TO TRUE.                           09840000
098500     PERFORM 2240-EDIT-PRINTER-ID.                                09850000
098600                                                                  09860000
098700     INITIALIZE PC140-LABELMST.                                   09870000
098800                                                                  09880000
098900     IF NO-ERROR-ON-FACILITY-EDIT AND                             09890000
099000        NO-ERROR-ON-OP-UNIT-EDIT  AND                             09900000
099100        NO-ERROR-ON-PRINTER-EDIT                                  09910000
099200        PERFORM 2270-VALIDATE-PRINTER                             09920000
099300            IF PS-NO-ERROR                                        09930000
099400               PERFORM 2275-VALIDATE-PRINTER-ID                   09940000
099500               MOVE DP072-XMIT-INTFC-CDE TO PC140-XMIT-INTFC-CDE  09950000
099600               IF PC140-XMIT-INTFC-CDE = PC-F                     09960000
099700                  SET PS-ERROR                TO TRUE             09970000
099800                  SET DP020-MSG-FATAL         TO TRUE             09980000
099900                  MOVE PC-TSYMSG-00746        TO DP020-MSG-NUMBER 09990000
100000                  MOVE DP015-UNP-NUM-BRT-OFF  TO APRTRA           10000000
100100                  MOVE DP015-RED              TO APRTRC           10010000
100200                  MOVE DP015-REVERSE          TO APRTRH           10020000
100300                  MOVE -1                     TO APRTRL           10030000
100400                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             10040000
100500               ELSE                                               10050000
100600                  IF PC140-XMIT-INTFC-CDE = PC-S                  10060000
100700                     CONTINUE                                     10070000
100800                     MOVE DP072-PRTR-LOC-DESC                     10080000
100900                                              TO ASC-PRTR-DESC    10090000
101000                                                 APRDESCO         10100000
101100                  END-IF                                          10110000
101200               END-IF                                             10120000
101300            ELSE                                                  10130000
101400               SET DP030-OVERRIDE-GO   TO TRUE                    10140000
101500               PERFORM 3200-DISPLAY-PANEL                         10150000
101600            END-IF                                                10160000
101700       END-IF.                                                    10170000
101800                                                                  10180000
101900 EJECT                                                            10190000
102000*----------------------------------------------------------------*10200000
102100*   RESET ATTRIBUTES.                                            *10210000
102200*----------------------------------------------------------------*10220000
102300 2210-RESET-ATTRIBUTES.                                           10230000
102400                                                                  10240000
102500      MOVE DP015-UNP-NUM-NOR-OFF TO AOPUNITA                      10250000
102600                                    AFACILA                       10260000
102700                                    APRTRA                        10270000
102800                                    ASETSA.                       10280000
102900      MOVE DP015-UNP-ALP-NOR-OFF TO ABLDGA.                       10290099
103000      MOVE DP015-UNP-NUM-NOR-OFF TO AAISLEA                       10300099
103100                                    ABSLOTA                       10310099
103200                                    AESLOTA                       10320099
103300                                    ATIERA.                       10330099
103400      MOVE DP015-GREEN           TO AOPUNITC                      10340000
103500                                    AFACILC                       10350000
103600                                    APRTRC                        10360000
103700                                    ASETSC                        10370000
103800                                    ABLDGC                        10380099
103900                                    AAISLEC                       10390099
104000                                    ABSLOTC                       10400099
104100                                    AESLOTC                       10410099
104200                                    ATIERC.                       10420099
104300      MOVE DP015-UNDERLINE       TO AOPUNITH                      10430099
104400                                    AFACILH                       10440099
104500                                    APRTRH                        10450099
104600                                    ASETSH                        10460099
104700                                    ABLDGH                        10470099
104800                                    AAISLEH                       10480099
104900                                    ABSLOTH                       10490099
105000                                    AESLOTH                       10500099
105100                                    ATIERH.                       10510099
105200                                                                  10520099
105300 EJECT                                                            10530000
105400*----------------------------------------------------------------*10540000
105500*    EDIT THE OPERATING UNIT                                     *10550000
105600*----------------------------------------------------------------*10560000
105700 2213-EDIT-OPERATING-UNIT.                                        10570000
105800                                                                  10580000
105900     IF ASC-OPER-UNT-ID NOT > SPACES                              10590000
106000         SET PS-ERROR            TO TRUE                          10600000
106100         SET DP020-MSG-FATAL     TO TRUE                          10610000
106200         MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER              10620000
106300         MOVE DP015-UNP-NUM-BRT-OFF                               10630000
106400                                 TO AOPUNITA                      10640000
106500         MOVE DP015-RED          TO AOPUNITC                      10650000
106600         MOVE DP015-REVERSE      TO AOPUNITH                      10660000
106700         MOVE -1                 TO AOPUNITL                      10670000
106800         SET DP030-SET-CURSOR-APPL-1                              10680000
106900                                 TO TRUE                          10690000
107000     ELSE                                                         10700000
107100                                                                  10710000
107200         MOVE ASC-OPER-UNT-ID-N      TO DP010I-UNEDITED-FIELD     10720000
107300         MOVE +4                     TO DP010I-MAXIMUM-DIGITS     10730000
107400         MOVE +0                     TO DP010I-MAXIMUM-DECIMALS   10740000
107500                                                                  10750000
107600         SET DP010I-NEGATIVE-NOT-ALLOWED                          10760000
107700                                     TO TRUE                      10770000
107800                                                                  10780000
107910         CALL DP010I-NUMERIC-EDIT-ROUTINE                         10791099
107920                         USING DP010I-NUMERIC-EDIT-AREA           10792099
108000                                                                  10800000
108100         IF DP010I-NO-ERROR-DETECTED                              10810000
108200             MOVE DP010I-NUMERIC-FIELD                            10820000
108300                                     TO ASC-OPER-UNT-ID-N         10830000
108400                                        PV-SUPPRESS-FOUR          10840000
108500             MOVE PV-SUPPRESS-FOUR   TO AOPUNITO                  10850000
108600             EXEC CICS                                            10860000
108700                  SYNCPOINT                                       10870000
108800             END-EXEC                                             10880000
108900             PERFORM 2214-GET-OP-UNIT-NAME                        10890000
109000             SET NO-ERROR-ON-OP-UNIT-EDIT TO TRUE                 10900000
109100         ELSE                                                     10910000
109200             SET PS-ERROR            TO TRUE                      10920000
109300             SET DP020-MSG-FATAL     TO TRUE                      10930000
109400             MOVE PC-TSYMSG-00008    TO DP020-MSG-NUMBER          10940000
109500             MOVE DP015-UNP-NUM-BRT-OFF                           10950000
109600                                     TO AOPUNITA                  10960000
109700             MOVE DP015-RED          TO AOPUNITC                  10970000
109800             MOVE DP015-REVERSE      TO AOPUNITH                  10980000
109900             MOVE -1                 TO AOPUNITL                  10990000
110000             SET DP030-SET-CURSOR-APPL-1                          11000000
110100                                     TO TRUE                      11010000
110200         END-IF                                                   11020000
110300     END-IF.                                                      11030000
110400                                                                  11040000
110500 EJECT                                                            11050000
110600*----------------------------------------------------------------*11060000
110700* RETRIEVE THE OPERATING UNIT NAME DESCRIPTION.                  *11070000
110800*----------------------------------------------------------------*11080000
110900 2214-GET-OP-UNIT-NAME.                                           11090000
111000                                                                  11100000
111100     MOVE SPACES            TO ASC-OPER-UNT-NME                   11110000
111200     MOVE ASC-OPER-UNT-ID-N TO PC-OPER-UNT-ID                     11120000
111300     MOVE ASC-FCLTY-ID-N    TO PC-FCLTY-ID                        11130000
111400     MOVE ASC-FCLTY-ID-N    TO PC140-CRA-FACLTY-ID                11140000
111500                                                                  11150000
111600     PERFORM                                                      11160000
111700         WITH TEST AFTER                                          11170000
111800         VARYING PV-RETRY-COUNTER                                 11180000
111900         FROM 1 BY 1                                              11190000
112000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               11200000
112100                   OR (SQLCODE = +0)                              11210000
112200                   OR (SQLCODE = +100))                           11220000
112300                                                                  11230000
112400         EXEC SQL                                                 11240000
112500            SELECT  LOC_NM                                        11250099
112600              INTO :XLT00010-LOC-NM                               11260099
112700              FROM  XLT_LOC                                       11270099
112800             WHERE  LOC_NBR     = :PC-OPER-UNT-ID                 11280099
112900         END-EXEC                                                 11290000
113000                                                                  11300000
113100         EVALUATE TRUE                                            11310000
113200             WHEN SQLCODE = +0                                    11320000
113300                 MOVE XLT00010-LOC-NM  TO ASC-OPER-UNT-NME        11330099
113400                                          AOPDESCO                11340000
113500             WHEN SQLCODE = +100                                  11350000
113600                 MOVE SPACES           TO ASC-OPER-UNT-NME        11360000
113700                                          AOPDESCO                11370000
113800             WHEN SQLCODE = -811                                  11380000
113900             WHEN SQLCODE = -904                                  11390000
114000             WHEN SQLCODE = -913                                  11400000
114100                 CONTINUE                                         11410000
114200             WHEN SQLWARN0 NOT = SPACES                           11420000
114300             WHEN SQLCODE < +0                                    11430000
114400             WHEN SQLCODE > +0                                    11440000
114500                 MOVE '2214-GET-OP-UNIT-NAME'                     11450000
114600                                 TO DP013-PARAGRAPH               11460000
114700                 MOVE 'SELECT STORE NUMBER'                       11470000
114800                                 TO DP013-MESSAGE-TEXT (1)        11480000
114900                 MOVE SQLCA      TO DP013-SQLCA                   11490000
115000                 MOVE 'XLT_LOC'  TO DP013-DB2-TABLE-NAME (1)      11500099
115100                 SET DP013-DB2-ABEND                              11510000
115200                                 TO TRUE                          11520000
115300                 SET DP013-XCTL-DISPLAY-RESTART                   11530000
115400                                 TO TRUE                          11540000
115500                 PERFORM DP013-0000-PROCESS-ABEND                 11550000
115600         END-EVALUATE                                             11560000
115700     END-PERFORM.                                                 11570000
115800                                                                  11580000
115900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        11590000
116000         MOVE '2214-GET-OP-UNIT-NAME'                             11600000
116100                                 TO DP013-PARAGRAPH               11610000
116200         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     11620000
116300                                 TO DP013-MESSAGE-TEXT (1)        11630000
116400         MOVE 'STORE NUMBER  '   TO DP013-MESSAGE-TEXT (2)        11640000
116500         MOVE SQLCA              TO DP013-SQLCA                   11650000
116600         MOVE 'XLT_LOC'          TO DP013-DB2-TABLE-NAME (1)      11660099
116700         SET DP013-DB2-ABEND     TO TRUE                          11670000
116800         SET DP013-XCTL-DISPLAY-RESTART                           11680000
116900                                 TO TRUE                          11690000
117000         PERFORM DP013-0000-PROCESS-ABEND                         11700000
117100     END-IF.                                                      11710000
117200                                                                  11720000
117300 EJECT                                                            11730000
117400*----------------------------------------------------------------*11740000
117500*    EDIT THE FACILITY                                           *11750000
117600*----------------------------------------------------------------*11760000
117700 2215-EDIT-FACILITY.                                              11770000
117800                                                                  11780000
117900     IF ASC-FCLTY-ID    NOT > SPACES                              11790000
118000         SET PS-ERROR            TO TRUE                          11800000
118100         SET DP020-MSG-FATAL     TO TRUE                          11810000
118200         MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER              11820000
118300         MOVE DP015-UNP-NUM-BRT-OFF                               11830000
118400                                 TO AFACILA                       11840000
118500         MOVE DP015-RED          TO AFACILC                       11850000
118600         MOVE DP015-REVERSE      TO AFACILH                       11860000
118700         MOVE -1                 TO AFACILL                       11870000
118800         SET DP030-SET-CURSOR-APPL-1                              11880000
118900                                 TO TRUE                          11890000
119000     ELSE                                                         11900000
119100         MOVE ASC-FCLTY-ID-N         TO DP010I-UNEDITED-FIELD     11910000
119200         MOVE +4                     TO DP010I-MAXIMUM-DIGITS     11920000
119300         MOVE +0                     TO DP010I-MAXIMUM-DECIMALS   11930000
119400                                                                  11940000
119500         SET DP010I-NEGATIVE-NOT-ALLOWED                          11950000
119600                                     TO TRUE                      11960000
119700                                                                  11970000
119810         CALL DP010I-NUMERIC-EDIT-ROUTINE                         11981099
119820                         USING DP010I-NUMERIC-EDIT-AREA           11982099
119900                                                                  11990000
120000         IF DP010I-NO-ERROR-DETECTED                              12000000
120100             MOVE DP010I-NUMERIC-FIELD                            12010000
120200                                     TO ASC-FCLTY-ID-N            12020000
120300                                        PV-SUPPRESS-FOUR          12030000
120400             MOVE PV-SUPPRESS-FOUR   TO AFACILO                   12040000
120500             SET NO-ERROR-ON-FACILITY-EDIT TO TRUE                12050000
120600         ELSE                                                     12060000
120700             SET PS-ERROR            TO TRUE                      12070000
120800             SET DP020-MSG-FATAL     TO TRUE                      12080000
120900             MOVE PC-TSYMSG-00008    TO DP020-MSG-NUMBER          12090000
121000             MOVE DP015-UNP-NUM-BRT-OFF                           12100000
121100                                     TO AFACILA                   12110000
121200             MOVE DP015-RED          TO AFACILC                   12120000
121300             MOVE DP015-REVERSE      TO AFACILH                   12130000
121400             MOVE -1                 TO AFACILL                   12140000
121500             SET DP030-SET-CURSOR-APPL-1                          12150000
121600                                     TO TRUE                      12160000
121700         END-IF                                                   12170000
121800     END-IF.                                                      12180000
121900                                                                  12190000
122000*----------------------------------------------------------------*12200000
122100*    CHECK THE PRINTER NUMBER FOR NUMERIC                        *12210000
122200*----------------------------------------------------------------*12220000
122300 2240-EDIT-PRINTER-ID.                                            12230000
122400                                                                  12240000
122500     IF ASC-PRTR-ID     NOT > SPACES                              12250000
122600         SET PS-ERROR            TO TRUE                          12260000
122700         SET DP020-MSG-FATAL     TO TRUE                          12270000
122800         MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER              12280000
122900         MOVE DP015-UNP-NUM-BRT-OFF                               12290000
123000                                 TO APRTRA                        12300000
123100         MOVE DP015-RED          TO APRTRC                        12310000
123200         MOVE DP015-REVERSE      TO APRTRH                        12320000
123300         MOVE -1                 TO APRTRL                        12330000
123400         SET DP030-SET-CURSOR-APPL-1                              12340000
123500                                 TO TRUE                          12350000
123600     ELSE                                                         12360000
123700         MOVE ASC-PRTR-ID            TO DP010I-UNEDITED-FIELD     12370000
123800         MOVE +3                     TO DP010I-MAXIMUM-DIGITS     12380000
123900         MOVE +0                     TO DP010I-MAXIMUM-DECIMALS   12390000
124000                                                                  12400000
124100         SET DP010I-NEGATIVE-NOT-ALLOWED                          12410000
124200                                     TO TRUE                      12420000
124300                                                                  12430000
124410         CALL DP010I-NUMERIC-EDIT-ROUTINE                         12441099
124420                         USING DP010I-NUMERIC-EDIT-AREA           12442099
124500                                                                  12450000
124600         IF DP010I-ERROR-DETECTED                                 12460000
124700             SET PS-ERROR            TO TRUE                      12470000
124800             SET DP020-MSG-FATAL     TO TRUE                      12480000
124900             MOVE PC-TSYMSG-00008    TO DP020-MSG-NUMBER          12490000
125000             MOVE DP015-UNP-NUM-BRT-OFF                           12500000
125100                                     TO APRTRA                    12510000
125200             MOVE DP015-RED          TO APRTRC                    12520000
125300             MOVE DP015-REVERSE      TO APRTRH                    12530000
125400             MOVE -1                 TO APRTRL                    12540000
125500             SET DP030-SET-CURSOR-APPL-1                          12550000
125600                                     TO TRUE                      12560000
125700         ELSE                                                     12570000
125800             MOVE DP010I-NUMERIC-FIELD                            12580000
125900                                     TO ASC-PRTR-ID-N             12590000
126000             MOVE ASC-PRTR-ID        TO APRTRO                    12600000
126100             SET NO-ERROR-ON-PRINTER-EDIT TO TRUE                 12610000
126200         END-IF                                                   12620000
126300     END-IF.                                                      12630000
126400                                                                  12640000
126500 EJECT                                                            12650000
126600*----------------------------------------------------------------*12660000
126700* RESET THE FREE FORM TEXT SWITCHES                              *12670000
126800*----------------------------------------------------------------*12680000
126900 2250-RESET-FREE-FORM-SWITCHES.                                   12690000
127000                                                                  12700000
127100     SET ASC-BLDG-SPECIFIED-NO     TO TRUE.                       12710099
127200                                                                  12720099
127300     SET ASC-AISLE-SPECIFIED-NO    TO TRUE.                       12730099
127400     SET ASC-AISLE-IS-NUMERIC-NO   TO TRUE.                       12740099
127500                                                                  12750000
127600     SET ASC-BSLOT-SPECIFIED-NO    TO TRUE.                       12760099
127700     SET ASC-BSLOT-IS-NUMERIC-NO   TO TRUE.                       12770099
127800                                                                  12780000
127900     SET ASC-ESLOT-SPECIFIED-NO    TO TRUE.                       12790099
128000     SET ASC-ESLOT-IS-NUMERIC-NO   TO TRUE.                       12800099
128100                                                                  12810000
128200     SET ASC-TIER-SPECIFIED-NO     TO TRUE.                       12820099
128300     SET ASC-TIER-IS-NUMERIC-NO    TO TRUE.                       12830099
128400                                                                  12840000
128500     SET ASC-RANGE-SPECIFIED-NO    TO TRUE.                       12850099
128600     SET ASC-RANGE-VALID-NO        TO TRUE.                       12860000
128700                                                                  12870000
128800 EJECT                                                            12880000
128900*----------------------------------------------------------------*12890000
129000*  EDITS REQUIRE THAT ALL FIELDS CONTAIN DATA. THE RANGE VALUES  *12900099
129100*  MUST BE POSITIVE INTEGERS GREATER THAT ZERO.                  *12910099
129200*----------------------------------------------------------------*12920000
129300 2260-FIELD-EDITS.                                                12930099
129400                                                                  12940000
129500**** THIS NEEDS TO BE CHECKED IF THE SCREEN WAS                   12950000
129600**** PREVIOUSLY SENT BACK TO THE USER, WITH AN ERROR              12960000
129700**** BECAUSE CHECKING THE "LENGTH" OF THE BMS RANGE               12970000
129800**** INPUT FIELD WILL BE LESS THAN ZERO THE SECOND TIME           12980000
129900**** AROUND IF THE USER ONLY HAD TO ENTER A QUALIFIER             12990000
130000**** AND A RANGE VALUE WAS STILL LEFT FROM 'BEFORE'               13000000
130100     IF   (ASC-BUILDING > SPACE OR ASC-BUILDING-N > 0)            13010099
130200          SET ASC-BLDG-SPECIFIED    TO TRUE                       13020099
130300     END-IF.                                                      13030000
130400     IF   (ASC-AISLE > SPACE OR ASC-AISLE-N > 0)                  13040099
130500          SET ASC-AISLE-SPECIFIED   TO TRUE                       13050099
130600     END-IF.                                                      13060000
130700     IF   (ASC-BEGIN-SLOT > SPACE OR ASC-BEGIN-SLOT-N > 0)        13070099
130800          SET ASC-BSLOT-SPECIFIED   TO TRUE                       13080099
130900     END-IF.                                                      13090000
131000     IF   (ASC-END-SLOT > SPACE OR ASC-END-SLOT-N > 0)            13100099
131100          SET ASC-ESLOT-SPECIFIED   TO TRUE                       13110099
131200     END-IF.                                                      13120000
131300     IF   (ASC-TIER > SPACE OR ASC-TIER-N > 0)                    13130099
131400          SET ASC-TIER-SPECIFIED    TO TRUE                       13140099
131500     END-IF.                                                      13150099
131600                                                                  13160000
131700**** THIS NEEDS TO BE CHECKED IF THE SCREEN WAS                   13170000
131800**** PREVIOUSLY SENT BACK TO THE USER, WITH AN ERROR              13180000
131900**** BECAUSE CHECKING THE "LENGTH" OF THE BMS RANGE               13190000
132000**** INPUT FIELD WILL BE LESS THAN ZERO THE SECOND TIME           13200000
132100**** AROUND IF THE USER ONLY HAD TO ENTER A BEGIN SLOT VALUE      13210099
132200**** AND A RANGE VALUE WAS STILL LEFT FROM 'BEFORE'               13220000
132300**** TSYMSG 000342: "MUST BE NUMERIC AND > 0                      13230099
132400     IF  (ASC-BEGIN-SLOT-N  > 0 AND ASC-BSLOT-IS-NUMERIC-NO)      13240099
132500         INITIALIZE PV-CONVERSION-FIELD-X                         13250099
132600         MOVE ASC-BEGIN-SLOT-N     TO PV-SUPPRESS-THREE           13260099
132700         MOVE PV-SUPPRESS-THREE    TO PV-CONVERSION-FIELD-X       13270099
132800         PERFORM 2292-ALPHA-TO-NUM-CONVERSION-2                   13280099
132900         MOVE PV-CONVERSION-FIELD-9 TO ASC-BEGIN-SLOT-N           13290099
133000         INITIALIZE DP010I-UNEDITED-FIELD                         13300099
133100         MOVE ASC-BEGIN-SLOT-N     TO DP010I-UNEDITED-FIELD       13310099
133200         PERFORM 2101-NUMERIC-EDIT-ROUTINE                        13320099
133300         IF DP010I-NUM-FIELD-17-DIG-0-DEC > 0                     13330099
133400               SET ASC-BSLOT-IS-NUMERIC TO TRUE                   13340099
133500               SET ASC-BSLOT-SPECIFIED  TO TRUE                   13350099
133600               MOVE DP010I-NUMERIC-FIELD TO ASC-BEGIN-SLOT-N      13360099
133700               MOVE ASC-BEGIN-SLOT-N    TO ASC-BEGIN-SLOT-N-5     13370099
133800         ELSE                                                     13380099
133900             SET PS-ERROR            TO TRUE                      13390099
134000             SET DP020-MSG-FATAL     TO TRUE                      13400099
134100             MOVE PC-TSYMSG-00342    TO DP020-MSG-NUMBER          13410099
134200             MOVE DP015-UNP-NUM-BRT-OFF                           13420099
134300                                     TO ABSLOTA                   13430099
134400             MOVE DP015-RED          TO ABSLOTC                   13440099
134500             MOVE DP015-REVERSE      TO ABSLOTH                   13450099
134600             MOVE -1                 TO ABSLOTL                   13460099
134700             SET DP030-SET-CURSOR-APPL-1                          13470099
134800                                     TO TRUE                      13480099
134900             MOVE LOW-VALUES         TO ABSLOTI                   13490099
135000          END-IF                                                  13500099
135100     END-IF.                                                      13510000
135200     IF  (ASC-END-SLOT-N  > 0 AND ASC-ESLOT-IS-NUMERIC-NO)        13520099
135300         INITIALIZE PV-CONVERSION-FIELD-X                         13530099
135400         MOVE ASC-END-SLOT-N       TO PV-SUPPRESS-THREE           13540099
135500         MOVE PV-SUPPRESS-THREE    TO PV-CONVERSION-FIELD-X       13550099
135600         PERFORM 2292-ALPHA-TO-NUM-CONVERSION-2                   13560099
135700         MOVE PV-CONVERSION-FIELD-9 TO ASC-END-SLOT-N             13570099
135800         INITIALIZE DP010I-UNEDITED-FIELD                         13580099
135900         MOVE ASC-END-SLOT-N       TO DP010I-UNEDITED-FIELD       13590099
136000         PERFORM 2101-NUMERIC-EDIT-ROUTINE                        13600099
136100         IF DP010I-NUM-FIELD-17-DIG-0-DEC > 0                     13610099
136200               SET ASC-ESLOT-IS-NUMERIC TO TRUE                   13620099
136300               SET ASC-ESLOT-SPECIFIED  TO TRUE                   13630099
136400               MOVE DP010I-NUMERIC-FIELD TO ASC-END-SLOT-N        13640099
136500               MOVE ASC-END-SLOT-N      TO ASC-END-SLOT-N-5       13650099
136600         ELSE                                                     13660099
136700             SET PS-ERROR            TO TRUE                      13670099
136800             SET DP020-MSG-FATAL     TO TRUE                      13680099
136900             MOVE PC-TSYMSG-00342    TO DP020-MSG-NUMBER          13690099
137000             MOVE DP015-UNP-NUM-BRT-OFF                           13700099
137100                                     TO AESLOTA                   13710099
137200             MOVE DP015-RED          TO AESLOTC                   13720099
137300             MOVE DP015-REVERSE      TO AESLOTH                   13730099
137400             MOVE -1                 TO AESLOTL                   13740099
137500             SET DP030-SET-CURSOR-APPL-1                          13750099
137600                                     TO TRUE                      13760099
137700             MOVE LOW-VALUES         TO AESLOTI                   13770099
137800          END-IF                                                  13780099
137900     END-IF.                                                      13790099
138000                                                                  13800000
138100**** CHECK TO SEE IF BOTH SLOT FIELDS                             13810099
138200**** CONTAIN A VALUE.                                             13820099
138300**** ( RANGE WAS SPECIFIED)                                       13830099
138400     IF  (ASC-BSLOT-SPECIFIED AND                                 13840099
138500          ASC-ESLOT-SPECIFIED)                                    13850099
138600          SET ASC-RANGE-SPECIFIED  TO TRUE                        13860099
138700     END-IF.                                                      13870000
138800                                                                  13880000
138900**** IF A RANGE IS REQUESTED, MAKE SURE THE BEGIN RANGE           13890099
139000**** IS VALID                                                     13900099
139100**** TSYMSG 53 : "NO START OF RANGE HAS BEEN SPECIFIED"           13910099
139200     IF ((ASC-BSLOT-SPECIFIED AND ASC-BSLOT-IS-NUMERIC) AND       13920099
139300         (ASC-ESLOT-SPECIFIED AND ASC-ESLOT-IS-NUMERIC) AND       13930099
139400         (ASC-BEGIN-SLOT  = 0))                                   13940099
139500          SET PS-ERROR            TO TRUE                         13950000
139600          SET DP020-MSG-FATAL     TO TRUE                         13960000
139700          MOVE PC-TSYMSG-00053    TO DP020-MSG-NUMBER             13970099
139800          MOVE DP015-UNP-ALP-BRT-OFF                              13980000
139900                                  TO ABSLOTA                      13990099
140000          MOVE DP015-RED          TO ABSLOTC                      14000099
140100          MOVE DP015-REVERSE      TO ABSLOTH                      14010099
140200          MOVE -1                 TO ABSLOTL                      14020099
140300          SET DP030-SET-CURSOR-APPL-1                             14030000
140400                                  TO TRUE                         14040000
140500          MOVE LOW-VALUES         TO ABSLOTI                      14050099
140600     END-IF                                                       14060099
140700     IF ((ASC-ESLOT-SPECIFIED)       AND                          14070099
140800         (ASC-END-SLOT    = 0))                                   14080099
140900          SET PS-ERROR            TO TRUE                         14090099
141000          SET DP020-MSG-FATAL     TO TRUE                         14100099
141100          MOVE PC-TSYMSG-00051    TO DP020-MSG-NUMBER             14110099
141200          MOVE DP015-UNP-ALP-BRT-OFF                              14120099
141300                                  TO AESLOTA                      14130099
141400          MOVE DP015-RED          TO AESLOTC                      14140099
141500          MOVE DP015-REVERSE      TO AESLOTH                      14150099
141600          MOVE -1                 TO AESLOTL                      14160099
141700          SET DP030-SET-CURSOR-APPL-1                             14170099
141800                                  TO TRUE                         14180099
141900          MOVE LOW-VALUES         TO AESLOTI                      14190099
142000     END-IF                                                       14200099
142100                                                                  14210000
142200     IF  PS-NO-ERROR                                              14220000
142300         CONTINUE                                                 14230000
142400     ELSE                                                         14240000
142500         SET DP030-OVERRIDE-GO   TO TRUE                          14250000
142600         PERFORM 3200-DISPLAY-PANEL                               14260000
142700     END-IF.                                                      14270000
142800                                                                  14280000
142900**** MAKE SURE THAT THE RANGE BEGINNING IS                        14290000
143000**** LESS THAN THE RANGE END.                                     14300099
143100**** (52) "END OF RANGE PRECEDES START OF RANGE".                 14310000
143200     SET ASC-RANGE-ERROR-NO        TO TRUE                        14320000
143300       IF ((ASC-BEGIN-SLOT-N  NOT < ASC-END-SLOT-N) AND           14330099
143400           (ASC-END-SLOT-N > 0))                                  14340099
143500           SET ASC-RANGE-ERROR     TO TRUE                        14350000
143600           SET PS-ERROR            TO TRUE                        14360000
143700        IF ASC-RANGE-ERROR                                        14370000
143800           SET DP020-MSG-FATAL     TO TRUE                        14380000
143900           MOVE PC-TSYMSG-00052    TO DP020-MSG-NUMBER            14390000
144000           MOVE DP015-UNP-NUM-BRT-OFF                             14400000
144100                                   TO AESLOTA                     14410099
144200           MOVE DP015-RED          TO AESLOTC                     14420099
144300           MOVE DP015-REVERSE      TO AESLOTH                     14430099
144400           MOVE -1                 TO AESLOTL                     14440099
144500           SET DP030-SET-CURSOR-APPL-1                            14450000
144600                                   TO TRUE                        14460000
144700           MOVE LOW-VALUES         TO AESLOTI                     14470099
144800        END-IF                                                    14480000
144900       END-IF.                                                    14490099
145000                                                                  14500099
145100**** ALL FIELDS ON THE SCREEN ARE REQUIRED.                       14510099
145200**** TSYMSG 00007 : "REQUIRED FIELD"                              14520099
145300     IF ASC-BLDG-SPECIFIED-NO                                     14530099
145400        SET PS-ERROR            TO TRUE                           14540099
145500        SET DP020-MSG-FATAL     TO TRUE                           14550099
145600        MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER               14560099
145700        MOVE DP015-UNP-ALP-BRT-OFF                                14570099
145800                                TO ABLDGA                         14580099
145900        MOVE DP015-RED          TO ABLDGC                         14590099
146000        MOVE DP015-REVERSE      TO ABLDGH                         14600099
146100        MOVE -1                 TO ABLDGL                         14610099
146200        SET DP030-SET-CURSOR-APPL-1                               14620099
146300                                TO TRUE                           14630099
146400     END-IF.                                                      14640099
146500     IF ASC-AISLE-SPECIFIED-NO                                    14650099
146600        SET PS-ERROR            TO TRUE                           14660099
146700        SET DP020-MSG-FATAL     TO TRUE                           14670099
146800        MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER               14680099
146900        MOVE DP015-UNP-ALP-BRT-OFF                                14690099
147000                                TO AAISLEA                        14700099
147100        MOVE DP015-RED          TO AAISLEC                        14710099
147200        MOVE DP015-REVERSE      TO AAISLEH                        14720099
147300        MOVE -1                 TO AAISLEL                        14730099
147400        SET DP030-SET-CURSOR-APPL-1                               14740099
147500                                TO TRUE                           14750099
147600     END-IF.                                                      14760099
147700     IF ASC-BSLOT-SPECIFIED-NO                                    14770099
147800        SET PS-ERROR            TO TRUE                           14780099
147900        SET DP020-MSG-FATAL     TO TRUE                           14790099
148000        MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER               14800099
148100        MOVE DP015-UNP-ALP-BRT-OFF                                14810099
148200                                TO ABSLOTA                        14820099
148300        MOVE DP015-RED          TO ABSLOTC                        14830099
148400        MOVE DP015-REVERSE      TO ABSLOTH                        14840099
148500        MOVE -1                 TO ABSLOTL                        14850099
148600        SET DP030-SET-CURSOR-APPL-1                               14860099
148700                                TO TRUE                           14870099
148800        MOVE LOW-VALUES         TO ABSLOTI                        14880099
148900     END-IF.                                                      14890099
149000     IF ASC-TIER-SPECIFIED-NO                                     14900099
149100        SET PS-ERROR            TO TRUE                           14910099
149200        SET DP020-MSG-FATAL     TO TRUE                           14920099
149300        MOVE PC-TSYMSG-00007    TO DP020-MSG-NUMBER               14930099
149400        MOVE DP015-UNP-ALP-BRT-OFF                                14940099
149500                                TO ATIERA                         14950099
149600        MOVE DP015-RED          TO ATIERC                         14960099
149700        MOVE DP015-REVERSE      TO ATIERH                         14970099
149800        MOVE -1                 TO ATIERL                         14980099
149900        SET DP030-SET-CURSOR-APPL-1                               14990099
150000                                TO TRUE                           15000099
150100     END-IF.                                                      15010099
150200                                                                  15020099
150300     IF  PS-NO-ERROR                                              15030099
150400         SET ASC-RANGE-VALID    TO TRUE                           15040099
150500     ELSE                                                         15050099
150600         SET DP030-OVERRIDE-GO  TO TRUE                           15060099
150700         PERFORM 3200-DISPLAY-PANEL                               15070099
150800     END-IF.                                                      15080099
150900                                                                  15090099
151000      IF PS-NO-ERROR                                              15100099
151100         MOVE ASC-SETS-OF-LABELS-N TO PV-SUPPRESS-FOUR            15110099
151200         MOVE PV-SUPPRESS-FOUR   TO ASETSO                        15120099
151300         MOVE ASC-BUILDING       TO ABLDGO                        15130099
151400         MOVE ASC-AISLE-N        TO PV-SUPPRESS-TWO               15140099
151500         MOVE PV-SUPPRESS-TWO    TO AAISLEO                       15150099
151600         MOVE ASC-BEGIN-SLOT-N   TO PV-SUPPRESS-THREE             15160099
151700         MOVE PV-SUPPRESS-THREE  TO ABSLOTO                       15170099
151800         MOVE ASC-END-SLOT-N     TO PV-SUPPRESS-THREE             15180099
151900         MOVE PV-SUPPRESS-THREE  TO AESLOTO                       15190099
152000         MOVE ASC-TIER-N         TO PV-SUPPRESS-TWO               15200099
152100         MOVE PV-SUPPRESS-TWO    TO ATIERO                        15210099
152200     END-IF.                                                      15220099
152300                                                                  15230099
152400     IF  PS-NO-ERROR                                              15240099
152500         SET ASC-RANGE-VALID       TO TRUE                        15250099
152600         SET ASC-EDITS-COMPLETE    TO TRUE                        15260099
152700     ELSE                                                         15270099
152800         SET ASC-EDITS-COMPLETE-NO TO TRUE                        15280099
152900         SET DP030-OVERRIDE-GO     TO TRUE                        15290099
153000         PERFORM 3200-DISPLAY-PANEL                               15300099
153100     END-IF.                                                      15310099
153200                                                                  15320099
153300 EJECT                                                            15330000
153400*----------------------------------------------------------------*15340000
153500*  THERE ARE 4 FIELDS USED TO PASS THIS FREE FORM TEXT TO THE    *15350000
153600*  SOCKET PROGRAM. THEY ARE : PC140-RL-START-LABEL-ID            *15360099
153700*                             PC140-RL-END-LABEL-ID              *15370099
153800*                             PC140-RL-START-LABEL-ID-HR         *15380099
153900*                             PC140-RL-END-LABEL-ID-HR           *15390099
154000* THE "HR" HUMAN READABLE FIELDS 20 CHAR, AND WILL CONTAIN       *15400000
154100* '-' SEPARATORS BETWEEN THE BUILDING, AISLE, SLOT AND TIER.     *15410099
154200* THE BARCODE CAN BE 12 CHARS, BUT HERE WILL END UP BEING 10.    *15420099
154300* THE HR WILL BE 13 CHARS IN LENGTH. THE LENGTH WILL NOT CHANGE, *15430099
154400* ONLY THE VALUES PUT INTO THE RANGE VALUES WILL CHANGE.         *15440099
154500* THE BEGINNING AND END RANGE VALUES WILL BE SENT TO THE         *15450099
154600* SOCKET PROGRAM PCKCS707. A RANGE CALC WILL ALSO BE DONE IN     *15460099
154700* THAT PROGRAM TOO IN ORDER TO LOOP AS MANY TIMES AS WAS         *15470099
154800* SPECIFIED IN THE RANGE MULTIPLIED BY NUMBER OF SETS.           *15480099
154900*----------------------------------------------------------------*15490000
155000 2265-STRING-FREE-FORM-TEXT.                                      15500000
155100                                                                  15510000
155200     INITIALIZE PV-2DIGIT-N.                                      15520099
155300     MOVE ASC-AISLE-N         TO PV-2DIGIT-N.                     15530099
155400     INITIALIZE PV-3DIGIT-N.                                      15540099
155500     MOVE ASC-BEGIN-SLOT-N    TO PV-3DIGIT-N.                     15550099
155600     INITIALIZE PV-2DIGIT-N-TIER.                                 15560099
155700     MOVE ASC-TIER-N          TO PV-2DIGIT-N-TIER.                15570099
155800     STRING ASC-BUILDING              DELIMITED BY SIZE           15580099
155900            PC-DASH                   DELIMITED BY SIZE           15590099
156000            PC-A                      DELIMITED BY SIZE           15600099
156100            PV-2DIGIT-N               DELIMITED BY SIZE           15610099
156200            PC-DASH                   DELIMITED BY SIZE           15620099
156300            PC-S                      DELIMITED BY SIZE           15630099
156400            PV-3DIGIT-N               DELIMITED BY SIZE           15640099
156500            PC-DASH                   DELIMITED BY SIZE           15650099
156600            PC-TR                     DELIMITED BY SIZE           15660099
156700            PV-2DIGIT-N-TIER          DELIMITED BY SIZE           15670099
156800     INTO   PC140-RL-START-LABEL-ID-HR.                           15680099
156900                                                                  15690099
157000     STRING ASC-BUILDING              DELIMITED BY SIZE           15700099
157100            PC-A                      DELIMITED BY SIZE           15710099
157200            PV-2DIGIT-N               DELIMITED BY SIZE           15720099
157300            PC-S                      DELIMITED BY SIZE           15730099
157400            PV-3DIGIT-N               DELIMITED BY SIZE           15740099
157500            PC-TR                     DELIMITED BY SIZE           15750099
157600            PV-2DIGIT-N-TIER          DELIMITED BY SIZE           15760099
157700     INTO   PC140-RL-START-LABEL-ID.                              15770099
157800                                                                  15780099
157900     INITIALIZE PV-3DIGIT-N.                                      15790099
158000     MOVE ASC-END-SLOT-N TO PV-3DIGIT-N.                          15800099
158100     STRING ASC-BUILDING              DELIMITED BY SIZE           15810099
158200            PC-DASH                   DELIMITED BY SIZE           15820099
158300            PC-A                      DELIMITED BY SIZE           15830099
158400            PV-2DIGIT-N               DELIMITED BY SIZE           15840099
158500            PC-DASH                   DELIMITED BY SIZE           15850099
158600            PC-S                      DELIMITED BY SIZE           15860099
158700            PV-3DIGIT-N               DELIMITED BY SIZE           15870099
158800            PC-DASH                   DELIMITED BY SIZE           15880099
158900            PC-TR                     DELIMITED BY SIZE           15890099
159000            PV-2DIGIT-N-TIER          DELIMITED BY SIZE           15900099
159100     INTO   PC140-RL-END-LABEL-ID-HR.                             15910099
159200                                                                  15920099
159300     STRING ASC-BUILDING              DELIMITED BY SIZE           15930099
159400            PC-A                      DELIMITED BY SIZE           15940099
159500            PV-2DIGIT-N               DELIMITED BY SIZE           15950099
159600            PC-S                      DELIMITED BY SIZE           15960099
159700            PV-3DIGIT-N               DELIMITED BY SIZE           15970099
159800            PC-TR                     DELIMITED BY SIZE           15980099
159900            PV-2DIGIT-N-TIER          DELIMITED BY SIZE           15990099
160000     INTO   PC140-RL-END-LABEL-ID.                                16000099
160100                                                                  16010099
160200** NOTE: IF NO RANGE WAS REQUESTED, MAKE SURE THAT SPACES         16020099
160300** ARE PASSED TO THE SOCKET PROGRAM                               16030099
160400     IF (ASC-RANGE-SPECIFIED AND                                  16040099
160500         ASC-RANGE-VALID)                                         16050099
160600         MOVE ASC-BEGIN-SLOT-N-5 TO PC140-RL-BEGIN-RANGE-NBR      16060099
160700         MOVE ASC-END-SLOT-N-5   TO PC140-RL-END-RANGE-NBR        16070099
160800     END-IF.                                                      16080099
160900                                                                  16090000
161000 EJECT                                                            16100000
161100*----------------------------------------------------------------*16110000
161200* CALLS DPKCS060 TO VALIDATE THE PRINTER ID                      *16120000
161300*----------------------------------------------------------------*16130000
161400 2270-VALIDATE-PRINTER.                                           16140000
161500                                                                  16150000
161600     MOVE ASC-PRTR-ID-N           TO DP072-PRINTER-ID.            16160000
161700     MOVE PC-CURRENT-PROGRAM-NAME TO DP072-RPT-PGM-NME.           16170000
161800     MOVE PC-01                   TO DP072-RPT-PGM-TYP-ID.        16180000
161900     MOVE ASC-OPER-UNT-ID-N       TO DP072-ORIGIN-OPER-UNT-ID     16190000
162000                                     DP072-OPER-UNT-ID.           16200000
162100     MOVE ASC-FCLTY-ID-N          TO DP072-ORIGIN-FCLTY-ID        16210000
162200                                     DP072-FCLTY-ID.              16220000
162300                                                                  16230000
162400     SET DP072-VALIDATE           TO TRUE.                        16240000
162500                                                                  16250000
162600     EXEC CICS                                                    16260000
162700          LINK PROGRAM  (PC-PRTR-VALIDATION-PGM)                  16270000
162800               COMMAREA (DP072-COMM-AREA)                         16280000
162900               RESP     (PV-CICS-RESPONSE)                        16290000
163000     END-EXEC.                                                    16300000
163100                                                                  16310000
163200     EVALUATE TRUE                                                16320000
163300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 16330000
163400              CONTINUE                                            16340000
163500         WHEN OTHER                                               16350000
163600              SET PS-ERROR                TO TRUE                 16360000
163700              SET DP020-MSG-FATAL         TO TRUE                 16370000
163800              MOVE PC-TSYMSG-00746        TO DP020-MSG-NUMBER     16380000
163900              MOVE DP015-UNP-NUM-BRT-OFF  TO APRTRA               16390000
164000              MOVE DP015-RED              TO APRTRC               16400000
164100              MOVE DP015-REVERSE          TO APRTRH               16410000
164200              MOVE -1                     TO APRTRL               16420000
164300              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 16430000
164400              PERFORM DP013-0000-PROCESS-ABEND                    16440000
164500     END-EVALUATE.                                                16450000
164600                                                                  16460000
164700 EJECT                                                            16470000
164800*----------------------------------------------------------------*16480000
164900*  VALIDATE THE PRINTER NUMBER ENTERED ON THE SCREEN TO ENSURE   *16490000
165000*  THIS IS A VALID PRINTER AND THAT THESE LABELS CAN BE PRINTED  *16500000
165100*  ON THIS PRINTER.                                              *16510000
165200*----------------------------------------------------------------*16520000
165300 2275-VALIDATE-PRINTER-ID.                                        16530000
165400                                                                  16540000
165500     IF  DP072-PRTR-PRTR-TRK-STAT-CDE =  PC-A                     16550000
165600         CONTINUE                                                 16560000
165700     ELSE                                                         16570000
165800         SET  PS-ERROR                TO TRUE                     16580000
165900         SET  DP020-MSG-FATAL         TO TRUE                     16590000
166000         MOVE PC-TSYMSG-00746         TO DP020-MSG-NUMBER         16600000
166100         MOVE DP015-UNP-NUM-BRT-OFF   TO APRTRA                   16610000
166200         MOVE DP015-RED               TO APRTRC                   16620000
166300         MOVE DP015-REVERSE           TO APRTRH                   16630000
166400         MOVE -1                      TO APRTRL                   16640000
166500         SET DP030-SET-CURSOR-APPL-1  TO TRUE                     16650000
166600     END-IF.                                                      16660000
166700                                                                  16670000
166800 EJECT                                                            16680000
166900*----------------------------------------------------------------*16690000
167000* CALCULATE TOTAL NUMBER OF LABELS.                              *16700000
167100* FIELDS PV-NUMBER-OF-LABELS, PV-QUALIFIER AND PV-RANGE ARE WORK *16710000
167200* FIELDS.                                                        *16720000
167300*----------------------------------------------------------------*16730000
167400 2280-CALCULATE-LABEL-TOTALS.                                     16740000
167500                                                                  16750000
167600     INITIALIZE ASC-TOTAL-LABELS-N                                16760000
167700                PV-BEGIN-SLOT                                     16770099
167800                PV-END-SLOT                                       16780099
167900                PV-SETS                                           16790000
168000                PV-NUMBER-OF-LABELS                               16800000
168100                PV-TOTAL-LABELS.                                  16810000
168200                                                                  16820000
168300     IF (ASC-RANGE-SPECIFIED AND                                  16830099
168400         ASC-RANGE-VALID)                                         16840000
168500         MOVE ASC-BEGIN-SLOT-N      TO PV-BEGIN-SLOT              16850099
168600         MOVE ASC-END-SLOT-N        TO PV-END-SLOT                16860099
168700         MOVE ASC-SETS-OF-LABELS    TO PV-SETS                    16870099
168800            COMPUTE PV-NUMBER-OF-LABELS  =                        16880000
168900                   (PV-END-SLOT -  PV-BEGIN-SLOT)                 16890099
169000                    ADD +1            TO PV-NUMBER-OF-LABELS      16900000
169100            COMPUTE PV-TOTAL-LABELS      =                        16910000
169200                   (PV-NUMBER-OF-LABELS  * PV-SETS)               16920000
169300            MOVE PV-TOTAL-LABELS      TO ASC-TOTAL-LABELS-N       16930000
169400     ELSE                                                         16940099
169500            MOVE ASC-SETS-OF-LABELS   TO ASC-TOTAL-LABELS-N       16950099
169600     END-IF.                                                      16960000
169700                                                                  16970000
169800 EJECT                                                            16980000
169900*----------------------------------------------------------------*16990099
170000* DISPLAY THE HR LABEL (OR FIRST THRU LAST IF RANGE WAS USED)    *17000099
170100* WHEN THE USER HITS ENTER, BEFORE ACTUALLY CREATING THE LABELS, *17010099
170200* AND ALSO AFTER A SUCCESSFUL LABEL PRINT.                       *17020099
170300*----------------------------------------------------------------*17030099
170400 2285-DISPLAY-HR-LABELS.                                          17040099
170500                                                                  17050099
170600     IF PS-ERROR                                                  17060099
170700        CONTINUE                                                  17070099
170800     ELSE                                                         17080099
170900        IF (ASC-RANGE-SPECIFIED AND ASC-RANGE-VALID)              17090099
171000           INITIALIZE PV-HR-DESC                                  17100099
171100           STRING PC140-RL-START-LABEL-ID-HR DELIMITED BY SPACE   17110099
171200                  PC-THRU                    DELIMITED BY SIZE    17120099
171300                  PC140-RL-END-LABEL-ID-HR   DELIMITED BY SPACE   17130099
171400             INTO PV-HR-DESC                                      17140099
171500             MOVE PV-HR-DESC                  TO AHRDESCO         17150099
171600             SET ASC-HR-DESC-DISPLAYED        TO TRUE             17160099
171700        ELSE                                                      17170099
171800           IF ASC-RANGE-SPECIFIED-NO                              17180099
171900              MOVE PC140-RL-START-LABEL-ID-HR TO AHRDESCO         17190099
172000              SET ASC-HR-DESC-DISPLAYED       TO TRUE             17200099
172100           END-IF                                                 17210099
172200        END-IF                                                    17220099
172300     END-IF.                                                      17230099
172400                                                                  17240099
172500     SET ASC-KEEP-SETS-VALUE                  TO TRUE.            17250099
172600                                                                  17260099
172700 EJECT                                                            17270099
172800***************************************************************** 17280099
172900*  RIGHT JUSTIFY THE FIELD AND PAD IT WITH LEADING ZEROES.      * 17290099
173000***************************************************************** 17300099
173100 2290-ALPHA-TO-NUM-CONVERSION.                                    17310099
173200                                                                  17320099
173300                                                                  17330099
173400     INITIALIZE PV-SPACE-CNTR                                     17340099
173500                PV-CHAR-CNTR                                      17350099
173600                PV-CONVERSION-FIELD-9.                            17360099
173700                                                                  17370099
173800     INSPECT  PV-CONVERSION-FIELD-X                               17380099
173900     TALLYING PV-SPACE-CNTR                                       17390099
174000     FOR ALL ' '                                                  17400099
174100     COMPUTE PV-CHAR-CNTR =                                       17410099
174200             ( +3 - PV-SPACE-CNTR ).                              17420099
174300                                                                  17430099
174400     EVALUATE PV-CHAR-CNTR                                        17440099
174500         WHEN PC-1                                                17450099
174600              MOVE PV-CONVERSION-FIELD-X (1:1)                    17460099
174700                TO PV-CONVERSION-FIELD-9 (3:1)                    17470099
174800         WHEN PC-2                                                17480099
174900              MOVE PV-CONVERSION-FIELD-X (1:2)                    17490099
175000                TO PV-CONVERSION-FIELD-9 (2:2)                    17500099
175100         WHEN PC-3                                                17510099
175200              MOVE PV-CONVERSION-FIELD-X (1:3)                    17520099
175300                TO PV-CONVERSION-FIELD-9 (1:3)                    17530099
175400     END-EVALUATE.                                                17540099
175500                                                                  17550099
175600 EJECT                                                            17560099
175700                                                                  17570099
175800***************************************************************** 17580099
175900*  RIGHT JUSTIFY THE FIELD AND PAD IT WITH LEADING ZEROES.      * 17590099
176000***************************************************************** 17600099
176100 2292-ALPHA-TO-NUM-CONVERSION-2.                                  17610099
176200                                                                  17620099
176300                                                                  17630099
176400     INITIALIZE PV-SPACE-CNTR                                     17640099
176500                PV-CHAR-CNTR                                      17650099
176600                PV-CONVERSION-FIELD-9.                            17660099
176700                                                                  17670099
176800     INSPECT  PV-CONVERSION-FIELD-X                               17680099
176900     TALLYING PV-SPACE-CNTR                                       17690099
177000     FOR ALL ' '                                                  17700099
177100     COMPUTE PV-CHAR-CNTR =                                       17710099
177200             ( +3 - PV-SPACE-CNTR ).                              17720099
177300                                                                  17730099
177400     EVALUATE PV-CHAR-CNTR                                        17740099
177500         WHEN PC-1                                                17750099
177600              MOVE PV-CONVERSION-FIELD-X (3:1)                    17760099
177700                TO PV-CONVERSION-FIELD-9 (3:1)                    17770099
177800         WHEN PC-2                                                17780099
177900              MOVE PV-CONVERSION-FIELD-X (2:2)                    17790099
178000                TO PV-CONVERSION-FIELD-9 (2:2)                    17800099
178100         WHEN PC-3                                                17810099
178200              MOVE PV-CONVERSION-FIELD-X (1:3)                    17820099
178300                TO PV-CONVERSION-FIELD-9 (1:3)                    17830099
178400     END-EVALUATE.                                                17840099
178500                                                                  17850099
178600 EJECT                                                            17860099
178700                                                                  17870099
178800*----------------------------------------------------------------*17880099
178900*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *17890000
179000*----------------------------------------------------------------*17900000
179100 2300-MOVE-COMMAREA-TO-SCREEN.                                    17910000
179200                                                                  17920000
179300     MOVE ASC-OPER-UNT-ID-N      TO PV-SUPPRESS-FOUR.             17930000
179400     MOVE PV-SUPPRESS-FOUR       TO AOPUNITO.                     17940000
179500     MOVE ASC-OPER-UNT-NME       TO AOPDESCO.                     17950000
179600     MOVE ASC-FCLTY-ID-N         TO PV-SUPPRESS-FOUR.             17960000
179700     MOVE PV-SUPPRESS-FOUR       TO AFACILO.                      17970000
179800     MOVE ASC-PRTR-ID            TO APRTRO.                       17980000
179900     MOVE ASC-PRTR-DESC          TO APRDESCO.                     17990000
180000     MOVE ASC-SETS-OF-LABELS-N   TO PV-SUPPRESS-FOUR.             18000099
180100     MOVE PV-SUPPRESS-FOUR       TO ASETSO.                       18010099
180200     MOVE ASC-BUILDING           TO ABLDGO.                       18020099
180300     MOVE ASC-AISLE-N            TO PV-SUPPRESS-TWO.              18030099
180400     MOVE PV-SUPPRESS-TWO        TO AAISLEO.                      18040099
180500     MOVE ASC-BEGIN-SLOT         TO PV-SUPPRESS-FOUR.             18050099
180600     MOVE PV-SUPPRESS-FOUR       TO ABSLOTO.                      18060099
180700     MOVE ASC-END-SLOT           TO PV-SUPPRESS-FOUR.             18070099
180800     MOVE PV-SUPPRESS-FOUR       TO AESLOTO.                      18080099
180900     MOVE ASC-TIER-N             TO PV-SUPPRESS-TWO               18090099
181000     MOVE PV-SUPPRESS-TWO        TO ATIERO.                       18100099
181100                                                                  18110000
181200 EJECT                                                            18120000
181300*----------------------------------------------------------------*18130000
181400*    DISPLAY A BLANK MAP EXCEPT FOR THE 1 WHICH IS THE DEFAULT   *18140000
181500*    VALUE FOR THE "SETS OF LABELS" FIELD.                       *18150000
181600*----------------------------------------------------------------*18160000
181700 3000-BUILD-INITIAL-PANEL.                                        18170000
181800                                                                  18180000
181900     EVALUATE TRUE                                                18190000
182000         WHEN DP020-NEXT-ACT-INITIAL                              18200000
182100         WHEN DP020-NEXT-ACT-RETURN                               18210000
182200         WHEN DP020-NEXT-ACT-READ-MAP                             18220000
182300              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 18230000
182400              MOVE -1                     TO APRTRL               18240000
182500              MOVE +0001                  TO PV-SUPPRESS-FOUR     18250000
182600              MOVE PV-SUPPRESS-FOUR       TO ASETSI               18260000
182700         WHEN OTHER                                               18270000
182800           IF ASC-KEEP-SETS-VALUE-NO                              18280000
182900              SET DP030-SET-CURSOR-APPL-1 TO TRUE                 18290000
183000              MOVE -1                     TO APRTRL               18300000
183100              MOVE +0001                  TO PV-SUPPRESS-FOUR     18310000
183200              MOVE PV-SUPPRESS-FOUR       TO ASETSI               18320000
183300           ELSE                                                   18330000
183400              MOVE ASC-SETS-OF-LABELS-N   TO PV-SUPPRESS-FOUR     18340000
183500              MOVE PV-SUPPRESS-FOUR       TO ASETSI               18350000
183600           END-IF                                                 18360000
183700           IF ASC-LABEL-PRINT-COMPLETE                            18370099
183800              MOVE -1                     TO ABLDGL               18380099
183900              MOVE +0001                  TO PV-SUPPRESS-FOUR     18390099
184000              MOVE PV-SUPPRESS-FOUR       TO ASETSI               18400099
184100              SET ASC-LABEL-PRINT-COMPLETE-NO  TO TRUE            18410099
184200           END-IF                                                 18420099
184300     END-EVALUATE.                                                18430000
184400                                                                  18440000
184500     PERFORM DP017-0000-GET-CURR-DATE-TIME.                       18450000
184600                                                                  18460000
184700**** DEFAULT OPERATING UNIT AND FACILITY                          18470000
184800     PERFORM 3300-FORMAT-OP-UNIT.                                 18480000
184900     PERFORM 3400-FORMAT-FCLTY-ID.                                18490000
185000                                                                  18500000
185100     PERFORM 3200-DISPLAY-PANEL.                                  18510000
185200                                                                  18520000
185300 EJECT                                                            18530000
185400*----------------------------------------------------------------*18540000
185500*    FILL THE MAP WITH THE NECESSARY DATA AND WRITE IT OUT.      *18550000
185600*----------------------------------------------------------------*18560000
185700 3200-DISPLAY-PANEL.                                              18570000
185800                                                                  18580000
185900     MOVE PC-CURRENT-MAPSET-NAME TO DP030-MAPSET-NAME.            18590000
186000     MOVE PC-CURRENT-MAP-NAME    TO DP030-MAP-NAME (1).           18600000
186100                                                                  18610000
186200 EJECT                                                            18620000
186300*----------------------------------------------------------------*18630000
186400*  CALL DPKUT100 NUMERIC EDIT                                    *18640000
186500*----------------------------------------------------------------*18650000
186600 3300-FORMAT-OP-UNIT.                                             18660000
186700                                                                  18670000
186800     MOVE DP020-LOCATION-NBR     TO DP010I-UNEDITED-FIELD.        18680099
186900     MOVE +4                     TO DP010I-MAXIMUM-DIGITS.        18690000
187000     MOVE +0                     TO DP010I-MAXIMUM-DECIMALS.      18700000
187100                                                                  18710000
187200     SET DP010I-NEGATIVE-NOT-ALLOWED                              18720000
187300                                 TO TRUE.                         18730000
187400                                                                  18740000
187510     CALL DP010I-NUMERIC-EDIT-ROUTINE                             18751099
187520                         USING DP010I-NUMERIC-EDIT-AREA           18752099
187600                                                                  18760000
187700     IF DP010I-NO-ERROR-DETECTED                                  18770000
187800         MOVE DP010I-NUMERIC-FIELD                                18780000
187900                                 TO PV-PIC9-FOUR                  18790000
188000         MOVE PV-PICX-FOUR       TO PV-SUPPRESS-FOUR              18800000
188100         MOVE PV-SUPPRESS-FOUR   TO AOPUNITO                      18810000
188200                                    ASC-OPER-UNT-ID               18820000
188300     ELSE                                                         18830000
188400         MOVE DP020-LOCATION-NBR TO PV-PICX-FOUR                  18840099
188500         MOVE PV-PICX-FOUR       TO PV-SUPPRESS-FOUR              18850000
188600         MOVE PV-SUPPRESS-FOUR   TO AOPUNITO                      18860000
188700                                    ASC-OPER-UNT-ID               18870000
188800     END-IF.                                                      18880000
188900                                                                  18890000
189000 EJECT                                                            18900000
189100*----------------------------------------------------------------*18910000
189200* CALL DPKUT100 NUMERIC EDIT                                     *18920000
189300*----------------------------------------------------------------*18930000
189400 3400-FORMAT-FCLTY-ID.                                            18940000
189500                                                                  18950000
189600     MOVE DP020-FCLTY-ID         TO DP010I-UNEDITED-FIELD.        18960000
189700     MOVE +4                     TO DP010I-MAXIMUM-DIGITS.        18970000
189800     MOVE +0                     TO DP010I-MAXIMUM-DECIMALS.      18980000
189900                                                                  18990000
190000     SET DP010I-NEGATIVE-NOT-ALLOWED                              19000000
190100                                 TO TRUE.                         19010000
190200                                                                  19020000
190310     CALL DP010I-NUMERIC-EDIT-ROUTINE                             19031099
190320                         USING DP010I-NUMERIC-EDIT-AREA           19032099
190400                                                                  19040000
190500     IF DP010I-NO-ERROR-DETECTED                                  19050000
190600         MOVE DP010I-NUMERIC-FIELD                                19060000
190700                                 TO PV-PIC9-FOUR                  19070000
190800         MOVE PV-PICX-FOUR       TO PV-SUPPRESS-FOUR              19080000
190900         MOVE PV-SUPPRESS-FOUR   TO AFACILO                       19090000
191000                                    ASC-FCLTY-ID-N                19100000
191100     ELSE                                                         19110000
191200         MOVE DP020-FCLTY-ID     TO AFACILO                       19120099
191300                                    ASC-FCLTY-ID                  19130000
191400         SET PS-ERROR            TO TRUE                          19140000
191500         SET DP020-MSG-FATAL     TO TRUE                          19150000
191600         MOVE PC-TSYMSG-00005                                     19160000
191700                                 TO DP020-MSG-NUMBER              19170000
191800         MOVE DP015-UNP-ALP-BRT-OFF                               19180000
191900                                 TO AFACILA                       19190000
192000         MOVE DP015-RED          TO AFACILC                       19200000
192100         MOVE DP015-REVERSE      TO AFACILH                       19210000
192200         MOVE -1                 TO AFACILL                       19220000
192300         SET DP030-SET-CURSOR-APPL-1                              19230000
192400                                 TO TRUE                          19240000
192500     END-IF.                                                      19250000
192600                                                                  19260000
192700 EJECT                                                            19270000
192800*----------------------------------------------------------------*19280000
192900*  THIS WILL BE USED TO FORMAT PRINTER ID ON BOTTOM OF LABEL.    *19290000
193000*----------------------------------------------------------------*19300000
193100 3500-GET-DC-LOCATION.                                            19310000
193200     EXEC SQL                                                     19320000
193300          SELECT LOC_5_ABBR_NM                                    19330099
193400          INTO  :PV-DC-5-CHAR-ABBR                                19340000
193500          FROM   XLT_LOC                                          19350099
193600          WHERE  LOC_TYP_CDE = 'DC'                               19360099
193700          AND    LOC_NBR     = :PC-OPER-UNT-ID                    19370099
193800     END-EXEC.                                                    19380000
193900                                                                  19390000
194000     EVALUATE TRUE                                                19400000
194100         WHEN SQLCODE = ZERO                                      19410000
194200              MOVE  PV-2-DIGIT-DC-ABBR  TO  PC140-CRA-DC-ID       19420000
194300              MOVE  PC-OPER-UNT-ID      TO  PC140-CRA-OPER-UNT-ID 19430000
194400                                                                  19440000
194500         WHEN SQLCODE = +100                                      19450000
194600              MOVE  PC-90   TO  PC140-CRA-DC-ID                   19460000
194700                                PC140-CRA-OPER-UNT-ID             19470000
194800                                                                  19480000
194900         WHEN SQLWARN0 NOT = SPACES                               19490000
195000         WHEN SQLCODE NOT EQUAL ZERO                              19500000
195100             MOVE '3500-GET-DC-LOCATION'                          19510000
195200                             TO DP013-PARAGRAPH                   19520000
195300             MOVE 'PCKCS718 - GET DC LOCATION CODE'               19530099
195400                             TO DP013-MESSAGE-TEXT(1)             19540000
195500             MOVE PC140-CRA-DC-ID                                 19550000
195600                             TO DP013-MESSAGE-TEXT(2)             19560000
195700             MOVE SQLCA      TO DP013-SQLCA                       19570000
195800             MOVE 'XLT_LOC'  TO DP013-DB2-TABLE-NAME(1)           19580099
195900             SET DP013-DB2-ABEND                                  19590000
196000                             TO TRUE                              19600000
196100             SET DP013-NO-ROLLBACK                                19610000
196200                             TO TRUE                              19620000
196300             SET DP013-XCTL-DISPLAY-RESTART                       19630000
196400                             TO TRUE                              19640000
196500             PERFORM DP013-0000-PROCESS-ABEND                     19650000
196600     END-EVALUATE.                                                19660000
196700                                                                  19670000
196800 EJECT                                                            19680000
196900*----------------------------------------------------------------*19690000
197000*                                                                *19700000
197100*----------------------------------------------------------------*19710000
197200 4000-SETUP-LABELS.                                               19720000
197300                                                                  19730000
197400     SET PC140-COMMON-RACK-LBL-NBR TO TRUE.                       19740099
197500     MOVE ASC-PRTR-ID              TO PC140-RL-PRTR-ID.           19750099
197600     PERFORM 2265-STRING-FREE-FORM-TEXT.                          19760000
197700*** LABEL TOTAL IS CALCULATED IN SOCKET PGM (SETS X NBR IN RANGE).19770000
197800*** NOTE: IF MULTIPLE SETS ARE NOT REQUESTED, MAKE SURE THAT      19780099
197900*** THE NUMBER 1 GETS PASSED TO THE SOCKET PROGRAM IN THE         19790099
198000*** PC140-RL-TOT-LBLS FIELD, OTHERWISE THE CALULATIONS PERFORMED  19800099
198100*** IN THE SOCKET PROGRAM WILL MULTIPLY BY 0 AND WON'T LOOP AND NO19810099
198200*** LABELS WILL BE PRODUCED.                                      19820099
198300     MOVE ASC-SETS-OF-LABELS       TO PC140-RL-TOT-LBLS.          19830099
198400     MOVE DP072-PRTR-DATA-XFER-MODE-ID                            19840000
198500                                   TO PC140-RL-XFER-MODE-ID.      19850099
198600     MOVE DP072-PRTR-IP-ADDRESS                                   19860000
198700                                   TO PC140-RL-IP-ADDRESS.        19870099
198800     MOVE DP072-PRTR-CLUSTER-OS-RLSE-CDE                          19880000
198900                                   TO PC140-RL-OS-RLSE-CDE.       19890099
199000     MOVE DP072-PRTR-OPER-UNT-ID   TO PC-OPER-UNT-ID.             19900000
199100                                                                  19910000
199200     PERFORM 3500-GET-DC-LOCATION.                                19920000
199300     IF PC140-SOCKET-INTFC                                        19930000
199400         SET ASC-LABEL-PRINT-COMPLETE-NO  TO TRUE                 19940099
199500         PERFORM 4300-LINK-SOCKET-PRINT-ROUTINE                   19950000
199600     END-IF.                                                      19960000
199700                                                                  19970000
199800 EJECT                                                            19980000
199900*----------------------------------------------------------------*19990000
200000* THIS IS THE LINK TO PCKCS707 SOCKET PROGRAM.                   *20000099
200100*----------------------------------------------------------------*20010000
200200 4300-LINK-SOCKET-PRINT-ROUTINE.                                  20020000
200300                                                                  20030000
200400     MOVE DP020-USERID           TO PC140-CRA-USERID.             20040000
200500     MOVE 400                    TO PV-COMMAREA-LENGTH.           20050000
200600                                                                  20060000
200700     EXEC CICS                                                    20070099
200800          LINK PROGRAM  ('PCKCS707')                              20080099
200900               COMMAREA (PC140-LABELMST)                          20090099
201000               LENGTH   (PV-COMMAREA-LENGTH)                      20100099
201100               RESP     (PV-CICS-RESPONSE)                        20110099
201200     END-EXEC.                                                    20120099
201300                                                                  20130099
201400     EVALUATE TRUE                                                20140099
201500         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 20150099
201600              CONTINUE                                            20160099
201700         WHEN OTHER                                               20170099
201800              PERFORM DP013-0000-PROCESS-ABEND                    20180099
201900     END-EVALUATE.                                                20190099
202000     IF PC140-CRA-SOCKET-COMM-ERROR                               20200000
202100         SET PS-ERROR            TO TRUE                          20210000
202200         SET DP020-MSG-FATAL     TO TRUE                          20220000
202300         MOVE PC-TSYMSG-02122    TO DP020-MSG-NUMBER              20230000
202400         MOVE DP015-UNP-NUM-BRT-OFF                               20240000
202500                                 TO APRTRA                        20250000
202600         MOVE DP015-RED          TO APRTRC                        20260000
202700         MOVE DP015-REVERSE      TO APRTRH                        20270000
202800         MOVE -1                 TO APRTRL                        20280000
202900         SET DP030-SET-CURSOR-APPL-1                              20290000
203000                                 TO TRUE                          20300000
203100     ELSE                                                         20310000
203200     IF PC140-CRA-INVALID-PRT-FMT                                 20320000
203300         SET PS-ERROR            TO TRUE                          20330000
203400         SET DP020-MSG-FATAL     TO TRUE                          20340000
203500         MOVE DP015-UNP-NUM-BRT-OFF                               20350000
203600                                 TO APRTRA                        20360000
203700         MOVE DP015-RED          TO APRTRC                        20370000
203800         MOVE DP015-REVERSE      TO APRTRH                        20380000
203900         MOVE -1                 TO APRTRL                        20390000
204000         SET DP030-SET-CURSOR-APPL-1                              20400000
204100                                 TO TRUE                          20410000
204200         MOVE PC140-CRA-RET-CDE      TO PM-RET-CDE                20420000
204300         MOVE PC140-CRA-RET-MSG      TO PM-RET-MSG                20430000
204400         MOVE PM-PROGRAM-MESSAGE-1   TO DP020-MSG-TEXT            20440000
204500     ELSE                                                         20450000
204600         SET ASC-KEEP-SETS-VALUE-NO  TO TRUE                      20460000
204700         SET DP020-MSG-INFORMATIONAL TO TRUE                      20470000
204800         MOVE PC-TSYMSG-00098    TO DP020-MSG-NUMBER              20480000
204900         MOVE -1                 TO ABLDGL                        20490099
205000         SET DP030-SET-CURSOR-APPL-1                              20500000
205100                                 TO TRUE                          20510000
205200         SET ASC-LABEL-PRINT-COMPLETE TO TRUE                     20520099
205300     END-IF.                                                      20530000
205400                                                                  20540099
205500         PERFORM 4305-PARTIAL-REFRESH.                            20550099
205600                                                                  20560000
205700 EJECT                                                            20570000
205800*----------------------------------------------------------------*20580099
205900* CLEAR THE FREE FORM TEXT AREAS AND LEAVE OP UNT DESC,          *20590099
206000* PRTR DESC AND THE PRTR NUMBER THE USER HAD ENTERED.            *20600099
206100*----------------------------------------------------------------*20610099
206200 4305-PARTIAL-REFRESH.                                            20620099
206300                                                                  20630099
206400             MOVE ASC-PRTR-ID-N      TO PV-PRINTER-ID.            20640099
206500             MOVE ASC-PRTR-DESC      TO PV-PRTR-DESC.             20650099
206600             MOVE ASC-OPER-UNT-ID-N  TO PV-OPER-UNT-ID.           20660099
206700             MOVE ASC-OPER-UNT-NME   TO PV-OPER-UNT-NME.          20670099
206800             MOVE ASC-FCLTY-ID-N     TO PV-FCLTY-ID.              20680099
206900             SET PS-PRINT-COMPLETE-NO TO TRUE.                    20690099
207000             IF ASC-LABEL-PRINT-COMPLETE                          20700099
207100                SET PS-PRINT-COMPLETE TO TRUE                     20710099
207200             END-IF.                                              20720099
207300                                                                  20730099
207400             INITIALIZE ASC-SPECIFIC-COMMAREA.                    20740099
207500                                                                  20750099
207600             MOVE PV-PRINTER-ID    TO ASC-PRTR-ID-N.              20760099
207700             MOVE PV-PRTR-DESC     TO ASC-PRTR-DESC.              20770099
207800             MOVE PV-OPER-UNT-NME  TO ASC-OPER-UNT-NME.           20780099
207900             MOVE PV-OPER-UNT-ID   TO ASC-OPER-UNT-ID-N.          20790099
208000             MOVE PV-FCLTY-ID      TO ASC-FCLTY-ID-N.             20800099
208100             IF PS-PRINT-COMPLETE                                 20810099
208200                SET ASC-LABEL-PRINT-COMPLETE TO TRUE              20820099
208300                SET ASC-HR-DESC-DISPLAYED-NO TO TRUE              20830099
208400                SET ASC-EDITS-COMPLETE-NO    TO TRUE              20840099
208500             END-IF.                                              20850099
208600                                                                  20860099
208700             MOVE SPACES         TO ABLDGO                        20870099
208800                                    AAISLEO                       20880099
208900                                    ABSLOTO                       20890099
209000                                    AESLOTO                       20900099
209100                                    ATIERO                        20910099
209200                                    AHRDESCO                      20920099
209300                                    ASC-SETS-OF-LABELS.           20930099
209400                                                                  20940099
209500             MOVE SPACES                    TO ABSLOTI            20950099
209600                                               AESLOTI.           20960099
209700                                                                  20970099
209800             SET ASC-KEEP-SETS-VALUE-NO     TO TRUE.              20980099
209900             SET ASC-OVER-99-CHECK-DONE-NO  TO TRUE.              20990099
210000             SET ASC-AID-ENTER-NO           TO TRUE.              21000099
210100             SET ASC-AID-ADD-NO             TO TRUE.              21010099
210200             MOVE -1                        TO ABLDGL.            21020099
210300             MOVE +0001                     TO PV-SUPPRESS-FOUR.  21030099
210400             MOVE PV-SUPPRESS-FOUR          TO ASETSI.            21040099
210500             PERFORM 2210-RESET-ATTRIBUTES.                       21050099
210600                                                                  21060099
210700 EJECT                                                            21070099
210800*----------------------------------------------------------------*21080000
210900*    RETRY DELAY LOGIC.                                    S.T.  *21090000
211000*     -- THIS LOGIC INSTITUTES A ONE SECOND DELAY.               *21100000
211100*----------------------------------------------------------------*21110000
211200 Z100-DELAY-RETRY.                                                21120000
211300                                                                  21130000
211400     EXEC CICS                                                    21140000
211500         POST INTERVAL(1) SET(PV-ECA-POINTER)                     21150000
211600     END-EXEC.                                                    21160000
211700                                                                  21170000
211800     EXEC CICS                                                    21180000
211900         WAIT EVENT ECADDR(PV-ECA-POINTER)                        21190000
212000     END-EXEC.                                                    21200000
212100                                                                  21210000
212200** DEFINE PV-ECA-POINTER AS PIC S9(08) COMP.                      21220000
212300                                                                  21230000
212400/                                                                 21240000
212500*----------------------------------------------------------------*21250000
212600*    ABEND PROCESSOR MODULE                                      *21260000
212700*----------------------------------------------------------------*21270000
212800                                                                  21280000
212900     COPY DPPD013.                                                21290000
213000                                                                  21300000
213100 EJECT                                                            21310000
213200*----------------------------------------------------------------*21320000
213300*    UPDATE TIME AND DATE MODULE                                 *21330000
213400*----------------------------------------------------------------*21340000
213500                                                                  21350000
213600     COPY DPPD017.                                                21360000
