000100******************************************************************00010004
000200 IDENTIFICATION DIVISION.                                         00020004
000300******************************************************************00030004
000400                                                                  00040004
000500 PROGRAM-ID.             PCKUT078.                                00050004
000600 AUTHOR.                 DAN HINTZ.                               00060004
000700 INSTALLATION.           KOHLS.                                   00070004
000800 DATE-WRITTEN            FEBRUARY 2008.                           00080004
000900 DATE-COMPILED.                                                   00090004
001000                                                                  00100004
001100******************************************************************00110004
001200*   THE PURPOSE OF THIS PROGRAM IS TO PROCESS A PHYSICAL INVENTORY00120004
001300*   FILE CONTAINING SKU/STORE ENTRIES WHERE THE STORE EXPECTED    00130004
001400*   QUANTITY HAS BEEN REVERSED IN THE PHYSICAL INVENTORY PROCESS. 00140042
001500******************************************************************00150004
001600 ENVIRONMENT DIVISION.                                            00160004
001700                                                                  00170004
001800 CONFIGURATION SECTION.                                           00180004
001900                                                                  00190004
002000 SOURCE-COMPUTER.        IBM-3090.                                00200004
002100 OBJECT-COMPUTER.        IBM-3090.                                00210004
002200                                                                  00220004
002300 INPUT-OUTPUT SECTION.                                            00230004
002400                                                                  00240004
002500 FILE-CONTROL.                                                    00250004
002600                                                                  00260004
002700     SELECT INV-STORE-EXPECTED                                    00270004
002800         ASSIGN TO INP01.                                         00280004
002900                                                                  00290004
003000     SELECT PC-STORE-EXPECTED                                     00300004
003100         ASSIGN TO INP02.                                         00310004
003200                                                                  00320004
003300     SELECT STORE-EXPECTED-MATCH                                  00330004
003400         ASSIGN TO OUT01.                                         00340004
003500                                                                  00350004
003600     SELECT STORE-EXPECTED-NON-MATCH                              00360004
003700         ASSIGN TO OUT02.                                         00370004
003800                                                                  00380004
003900******************************************************************00390004
004000 DATA DIVISION.                                                   00400004
004100******************************************************************00410004
004200                                                                  00420004
004300 FILE SECTION.                                                    00430004
004400                                                                  00440004
004500 FD  INV-STORE-EXPECTED                                           00450004
004600     RECORDING MODE IS F                                          00460004
004700     RECORD CONTAINS 150 CHARACTERS                               00470004
004800     BLOCK CONTAINS 0 RECORDS                                     00480004
004900     LABEL RECORDS ARE STANDARD.                                  00490004
005000                                                                  00500004
005100 01  INV-STORE-EXPECTED-REC              PIC X(150).              00510004
005200                                                                  00520004
005300                                                                  00530004
005400 FD  PC-STORE-EXPECTED                                            00540004
005500     RECORDING MODE IS F                                          00550004
005600     RECORD CONTAINS 150 CHARACTERS                               00560004
005700     BLOCK CONTAINS 0 RECORDS                                     00570004
005800     LABEL RECORDS ARE STANDARD.                                  00580004
005900                                                                  00590004
006000 01  PC-STORE-EXPECTED-REC               PIC X(150).              00600004
006100                                                                  00610004
006200                                                                  00620004
006300 FD  STORE-EXPECTED-MATCH                                         00630004
006400     RECORDING MODE IS F                                          00640004
006500     RECORD CONTAINS 150 CHARACTERS                               00650004
006600     BLOCK CONTAINS 0 RECORDS                                     00660004
006700     LABEL RECORDS ARE STANDARD.                                  00670004
006800                                                                  00680004
006900 01  STORE-EXPECTED-MATCH-REC            PIC X(150).              00690004
007000                                                                  00700004
007100                                                                  00710004
007200 FD  STORE-EXPECTED-NON-MATCH                                     00720004
007300     RECORDING MODE IS F                                          00730004
007400     RECORD CONTAINS 150 CHARACTERS                               00740004
007500     BLOCK CONTAINS 0 RECORDS                                     00750004
007600     LABEL RECORDS ARE STANDARD.                                  00760004
007700                                                                  00770004
007800 01  STORE-EXPECTED-NON-MATCH-REC        PIC X(150).              00780004
007900                                                                  00790004
008000******************************************************************00800004
008100 WORKING-STORAGE SECTION.                                         00810004
008200******************************************************************00820004
008300                                                                  00830004
008400 01  PC-PROGRAM-CONSTANTS.                                        00840004
008500     05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)  VALUE        00850004
008600                                                     'PCKUT078'.  00860004
008700*                                                                 00870004
008800 01  PV-PROGRAM-VARIABLES.                                        00880004
008900     05  PV-IN030-LOC-NBR-SKU-KEY.                                00890004
009000         10  PV-IN030-LOC-NBR            PIC  9(04)  VALUE ZEROS. 00900004
009100         10  PV-IN030-SKU-NBR            PIC  9(08)  VALUE ZEROS. 00910004
009200     05  PV-PC038-LOC-NBR-SKU-KEY.                                00920004
009300         10  PV-PC038-LOC-NBR            PIC  9(04)  VALUE ZEROS. 00930004
009400         10  PV-PC038-SKU-NBR            PIC  9(08)  VALUE ZEROS. 00940004
009500     05  PV-CURR-LOC-NBR                 PIC  9(04)  VALUE ZEROS. 00950004
009600     05  PV-INRD030-RECS-READ-STR        PIC  9(05)  VALUE ZERO   00960004
009700                                                     COMP-3.      00970004
009800     05  PV-PCRD038-RECS-READ-STR        PIC  9(05)  VALUE ZERO   00980004
009900                                                     COMP-3.      00990004
010000     05  PV-PCRD038-OUT1-RECS-STR        PIC  9(05)  VALUE ZERO   01000004
010100                                                     COMP-3.      01010004
010200     05  PV-PCRD038-OUT1-RECS-MATCH      PIC  9(05)  VALUE ZERO   01020004
010300                                                     COMP-3.      01030004
010400     05  PV-PCRD038-OUT1-RECS-NON-MATCH  PIC  9(05)  VALUE ZERO   01040004
010500                                                     COMP-3.      01050004
010600     05  PV-INRD030-RECS-READ-TOTAL      PIC  9(07)  VALUE ZERO   01060004
010700                                                     COMP-3.      01070004
010800     05  PV-PCRD038-RECS-READ-TOTAL      PIC  9(07)  VALUE ZERO   01080004
010900                                                     COMP-3.      01090004
011000     05  PV-PCRD038-OUT1-RECS-WRITTEN    PIC  9(07)  VALUE ZERO   01100004
011100                                                     COMP-3.      01110004
011200     05  PV-PCRD038-OUT1-MATCH-TOT       PIC  9(07)  VALUE ZERO   01120032
011300                                                     COMP-3.      01130030
011400     05  PV-PCRD038-OUT1-NON-MATCH-TOT   PIC  9(07)  VALUE ZERO   01140032
011500                                                     COMP-3.      01150030
011600     05  PV-PCRD038-OUT2-RECS-WRITTEN    PIC  9(07)  VALUE ZERO   01160004
011700                                                     COMP-3.      01170004
011800     05  PV-PCRD038-TOTAL-RECS-WRITTEN   PIC  9(07)  VALUE ZERO   01180004
011900                                                     COMP-3.      01190004
012000 01  PS-PROGRAM-SWITCHES.                                         01200004
012100     05  PS-EOF-INV-STORE-EXTRACT-SW     PIC X(01)   VALUE 'N'.   01210004
012200         88  PS-EOF-INV-STORE-EXTRACT                VALUE 'Y'.   01220004
012300     05  PS-EOF-PC-STORE-EXTRACT-SW      PIC X(01)   VALUE 'N'.   01230004
012400         88  PS-EOF-PC-STORE-EXTRACT                 VALUE 'Y'.   01240004
012500     05  PS-INV-FILE-FIRST-REC-SW        PIC X(01)   VALUE 'Y'.   01250016
012600         88  PS-INV-FILE-FIRST-REC                   VALUE 'Y'.   01260016
012700         88  PS-NOT-INV-FILE-FIRST-REC               VALUE 'N'.   01270016
012800     05  PS-PC-FILE-FIRST-REC-SW         PIC X(01)   VALUE 'Y'.   01280016
012900         88  PS-PC-FILE-FIRST-REC                    VALUE 'Y'.   01290016
013000         88  PS-NOT-PC-FILE-FIRST-REC                VALUE 'N'.   01300016
013100     05  PS-INV-STORE-ON-PC-FILE-SW      PIC X(01)   VALUE 'N'.   01310014
013200         88  PS-INV-STORE-ON-PC-FILE                 VALUE 'Y'.   01320010
013300         88  PS-INV-STORE-NOT-ON-PC-FILE             VALUE 'N'.   01330010
013400     05  PS-SKU-STR-MATCH-SW             PIC X(01)   VALUE 'N'.   01340030
013500         88  PS-SKU-STR-MATCH                        VALUE 'Y'.   01350030
013600         88  PS-NOT-SKU-STR-MATCH                    VALUE 'N'.   01360030
013700*                                                                 01370004
013800*                                                                 01380004
013900******************************************************************01390004
014000***  REVERSED INVENTORY STORE EXPECTED QUANTITIES EXTRACT FILE    01400026
014100***  LAYOUT                                                       01410026
014200******************************************************************01420004
014300     COPY INRD030.                                                01430004
014400*                                                                 01440004
014500*                                                                 01450004
014600******************************************************************01460004
014700***  STORE EXPECTED QUANTITIES EXTRACT FILE LAYOUT                01470004
014800******************************************************************01480004
014900     COPY PCRD038.                                                01490007
015000*                                                                 01500004
015100*                                                                 01510004
015200 PROCEDURE DIVISION.                                              01520004
015300                                                                  01530004
015400******************************************************************01540004
015500*  0000-INITIAL-ROUTINE  -  MAIN LINE OF THE PROGRAM PERFORMS THE 01550004
015600*  INITIALIZATION ROUTINE AND CONTROLS THE PROCESSING OF THE PGM. 01560004
015700******************************************************************01570004
015800                                                                  01580004
015900 0000-MAINLINE.                                                   01590004
016000                                                                  01600004
016100     OPEN INPUT INV-STORE-EXPECTED                                01610004
016200                PC-STORE-EXPECTED                                 01620004
016300         OUTPUT STORE-EXPECTED-MATCH                              01630004
016400                STORE-EXPECTED-NON-MATCH.                         01640004
016500                                                                  01650004
016600     PERFORM 7000-READ-INV-STORE-EXPECTED.                        01660004
016700                                                                  01670004
016800     PERFORM 7100-READ-PC-STORE-EXPECTED.                         01680004
016900                                                                  01690004
017000     MOVE IN030-LOC-NBR TO PV-CURR-LOC-NBR.                       01700004
017100                                                                  01710004
017200     DISPLAY '***************************************************'01720039
017300             '******************************'.                    01730039
017400                                                                  01740039
017500     PERFORM 2000-PROCESS-RECS                                    01750004
017600         UNTIL (PS-EOF-INV-STORE-EXTRACT AND                      01760004
017700                PS-EOF-PC-STORE-EXTRACT).                         01770004
017800*                                                                 01780043
017801*** DMH ADDED 5/8/12 BEGIN                                        01780143
017802*                                                                 01780243
017810     PERFORM 2100-DISPLAY-STORE-COUNTS.                           01781043
017811*                                                                 01781143
017812*** DMH ADDED 5/8/12 END                                          01781243
017813*                                                                 01781343
017820                                                                  01782043
017900     CLOSE INV-STORE-EXPECTED                                     01790004
018000           PC-STORE-EXPECTED                                      01800004
018100           STORE-EXPECTED-MATCH                                   01810004
018200           STORE-EXPECTED-NON-MATCH.                              01820004
018300                                                                  01830004
018400     DISPLAY '* FINAL TOTALS'.                                    01840005
018500     DISPLAY '* ------------'.                                    01850023
018600     DISPLAY '*'.                                                 01860009
018700     DISPLAY '* TOTAL INVENTORY REVERSED STORE EXPECTED RECORDS ' 01870026
018800             'READ. . . . .: '                                    01880030
018900             PV-INRD030-RECS-READ-TOTAL.                          01890005
019000     DISPLAY '* TOTAL PC STORE EXPECTED RECORDS READ. . . . . . ' 01900022
019100             '. . . . . . .: '                                    01910030
019200             PV-PCRD038-RECS-READ-TOTAL.                          01920005
019300     DISPLAY '*'.                                                 01930030
019400     DISPLAY '* TOTAL PC STORE EXPECTED RECORDS WRITTEN '         01940030
019500             'TO OUT01. . . . . . .: '                            01950030
019600             PV-PCRD038-OUT1-RECS-WRITTEN.                        01960005
019700     DISPLAY '* TOTAL STORE EXPECTED INV REVERSE CODE Y '         01970030
019800             'RECS WRITTEN TO OUT01: '                            01980030
019900             PV-PCRD038-OUT1-MATCH-TOT.                           01990030
020000     DISPLAY '* TOTAL STORE EXPECTED INV REVERSE CODE N '         02000030
020100             'RECS WRITTEN TO OUT01: '                            02010030
020200             PV-PCRD038-OUT1-NON-MATCH-TOT.                       02020030
020300     DISPLAY '*'.                                                 02030030
020400     DISPLAY '* TOTAL UNMATCHED PC STORE EXPECTED RECORDS '       02040030
020500             'WRITTEN TO OUT02. .: '                              02050030
020600             PV-PCRD038-OUT2-RECS-WRITTEN.                        02060030
020700     DISPLAY '* TOTAL STORE EXPECTED RECORDS WRITTEN. . . . . . ' 02070030
020800             '. . . . . . .: '                                    02080030
020900             PV-PCRD038-TOTAL-RECS-WRITTEN.                       02090030
021000     DISPLAY '***************************************************'02100009
021100             '******************************'.                    02110037
021200     STOP RUN.                                                    02120004
021300                                                                  02130004
021400                                                                  02140004
021500 2000-PROCESS-RECS.                                               02150006
021600******************************************************************02160004
021700*  COMPARE THE TWO STORE EXPECTED EXTRACT FILES, LOOKING FOR      02170004
021800*  MATCHES ON THE STORE - SKU LEVEL.                              02180004
021900******************************************************************02190004
022000     IF  PV-IN030-LOC-NBR NOT = PV-CURR-LOC-NBR AND               02200024
022100         PV-PC038-LOC-NBR NOT = PV-CURR-LOC-NBR                   02210024
022200         PERFORM 2100-DISPLAY-STORE-COUNTS                        02220011
022300         MOVE PV-IN030-LOC-NBR   TO PV-CURR-LOC-NBR               02230014
022400         SET PS-INV-STORE-NOT-ON-PC-FILE                          02240014
022500                                 TO TRUE                          02250014
022600     END-IF.                                                      02260004
022700                                                                  02270004
022800     EVALUATE TRUE                                                02280004
022900*  MATCH FOUND BETWEEN THE TWO STORE EXPECTED EXTRACT FILES       02290005
023000         WHEN PV-IN030-LOC-NBR-SKU-KEY = PV-PC038-LOC-NBR-SKU-KEY 02300004
023100             SET PS-INV-STORE-ON-PC-FILE                          02310030
023200                 PC038-POST-INV-REVERSE                           02320014
023300                 PS-SKU-STR-MATCH                                 02330030
023400                                 TO TRUE                          02340028
023500             PERFORM 8000-WRITE-OUT01-EXTRACT-FILE                02350004
023600             ADD 1 TO PV-PCRD038-OUT1-RECS-MATCH                  02360004
023700                      PV-PCRD038-OUT1-MATCH-TOT                   02370030
023800             PERFORM 7100-READ-PC-STORE-EXPECTED                  02380004
023900                                                                  02390004
024000*  IF THE STORE/SKU FROM THE INVENTORY STORE EXPECTED FILE IS     02400030
024100*  LESS THAN THE STORE/SKU FROM THE PC STORE EXPECTED EXTRACT FILE02410030
024200*  THEN WE NEED TO CHECK IF THERE HAD BEEN A MATCH THE PREVIOUS   02420030
024300*  TIME THROUGH THIS CHECK.  IF THERE HAD BEEN A MATCH, RESET THE 02430030
024400*  FLAG AND READ ANOTHER RECORD FROM THE INVENTORY STORE EXPECTED 02440030
024500*  FILE.  IF THERE HAD NOT BEEN A MATCH THE PREVIOUS TIME THROUGH,02450030
024600*  THEN WE HAVE THE SITUATION WHERE THE STORE/SKU IS ON THE INV   02460030
024700*  STORE EXPECTED FILE, BUT NOT ON THE PC STORE EXPECTED FILE.    02470030
024800*  A MESSAGE WILL BE DISPLAYED HERE IF ONLY THE SKU IS NOT FOUND. 02480030
024900*  IF THE STORE IS NOT FOUND, THE PS-INV-STORE-ON-PC-FILE-SW WILL 02490030
025000*  STILL BE "N". THE STORE NOT FOUND MESSAGE WILL GET DISPLAYED   02500030
025100*  AS PART OF THE CONTROL BREAK TOTALS THAT ARE DISPLAYED WHENEVER02510030
025200*  A DIFFERENT STORE NUMBER IS FOUND ON THE INVENTORY FILE.       02520031
025300         WHEN PV-IN030-LOC-NBR-SKU-KEY < PV-PC038-LOC-NBR-SKU-KEY 02530030
025400             IF  PS-SKU-STR-MATCH                                 02540031
025500                 SET PS-NOT-SKU-STR-MATCH                         02550031
025600                                 TO TRUE                          02560028
025700             ELSE                                                 02570028
025800                 IF  PV-PC038-LOC-NBR = PV-CURR-LOC-NBR           02580028
025900                     SET PS-INV-STORE-ON-PC-FILE                  02590028
026000                                 TO TRUE                          02600028
026100                     DISPLAY '*'                                  02610039
026200                     DISPLAY '*  ** STORE ' PV-CURR-LOC-NBR       02620035
026300                             ' AND SKU ' PV-IN030-SKU-NBR         02630035
026400                             ' IS NOT FOUND ON THE PC STORE'      02640035
026500                             ' EXTRACT FILE **'                   02650035
026600                     DISPLAY '*'                                  02660035
026700                 ELSE                                             02670035
026800                     IF (PV-IN030-LOC-NBR = PV-CURR-LOC-NBR) AND  02680036
026900                         PS-INV-STORE-ON-PC-FILE                  02690036
027000                         DISPLAY '*'                              02700039
027100                         DISPLAY '*  ** STORE ' PV-CURR-LOC-NBR   02710036
027200                                 ' AND SKU ' PV-IN030-SKU-NBR     02720036
027300                                 ' IS NOT FOUND ON THE PC STORE'  02730036
027400                                 ' EXTRACT FILE **'               02740036
027500                         DISPLAY '*'                              02750036
027600                     END-IF                                       02760036
027700                 END-IF                                           02770033
027800             END-IF                                               02780033
027900             PERFORM 7000-READ-INV-STORE-EXPECTED                 02790005
028000                                                                  02800004
028100*  STORE/SKU FOUND ON PC STORE EXPECTED EXTRACT FILE, BUT NOT     02810005
028200*  FOUND ON INVENTORY STORE EXPECTED EXTRACT FILE.                02820005
028300         WHEN PV-IN030-LOC-NBR-SKU-KEY > PV-PC038-LOC-NBR-SKU-KEY 02830004
028400             IF  PV-PC038-LOC-NBR = PV-CURR-LOC-NBR               02840024
028500                 SET PS-INV-STORE-ON-PC-FILE                      02850014
028600                                 TO TRUE                          02860014
028700                 SET PC038-NO-POST-INV-REVERSE                    02870005
028800                                 TO TRUE                          02880014
028900                 PERFORM 8000-WRITE-OUT01-EXTRACT-FILE            02890014
029000                 ADD 1           TO PV-PCRD038-OUT1-RECS-NON-MATCH02900014
029100                                    PV-PCRD038-OUT1-NON-MATCH-TOT 02910030
029200             ELSE                                                 02920029
029300                 MOVE SPACES     TO PC038-POST-INV-REVERSE-CDE    02930029
029400                 PERFORM 8100-WRITE-OUT02-EXTRACT-FILE            02940029
029500             END-IF                                               02950005
029600             PERFORM 7100-READ-PC-STORE-EXPECTED                  02960004
029700     END-EVALUATE.                                                02970004
029800*                                                                 02980004
029900*                                                                 02990004
030000 2100-DISPLAY-STORE-COUNTS.                                       03000004
030100******************************************************************03010004
030200*  THIS CODE WILL DISPLAY THE COUNTS BROKEN DOWN BY EACH STORE    03020004
030300*  THAT IS FOUND ON THE INVENTORY STORE EXPECTED ADJUSTMENT FILE. 03030004
030400******************************************************************03040004
030500     DISPLAY '* STORE NUMBER ' PV-CURR-LOC-NBR ' TOTALS:        '.03050009
030600     DISPLAY '* -------------------------'.                       03060023
030700     DISPLAY '*'.                                                 03070009
030800                                                                  03080019
030900     IF  PS-INV-STORE-NOT-ON-PC-FILE                              03090019
031000         DISPLAY '*  (** STORE ' PV-CURR-LOC-NBR                  03100021
031100                 ' IS NOT FOUND ON THE'                           03110019
031200                 ' PC STORE EXPECTED EXTRACT FILE **)'            03120019
031300         DISPLAY '*'                                              03130019
031400         INITIALIZE PV-PCRD038-RECS-READ-STR                      03140019
031500     END-IF.                                                      03150019
031600                                                                  03160019
031700     DISPLAY '*   INV REVERSED STORE EXPECTED RECS . . . . . . . '03170040
031800             '. . .: '                                            03180040
031900              PV-INRD030-RECS-READ-STR.                           03190009
032000     DISPLAY '*   PC STORE EXPECTED RECS . . . . . . . . . . . . '03200040
032100             '. . .: '                                            03210040
032200              PV-PCRD038-RECS-READ-STR.                           03220009
032300     DISPLAY '*   TOTAL STORE EXPECTED RECS WRITTEN. . . . . . . '03230040
032400             '. . .: '                                            03240040
032500              PV-PCRD038-OUT1-RECS-STR.                           03250040
032600     DISPLAY '*   TOTAL STORE EXPECTED INV REVERSE CODE Y RECS '  03260040
032700             'WRITTEN: '                                          03270041
032800              PV-PCRD038-OUT1-RECS-MATCH.                         03280040
032900     DISPLAY '*   TOTAL STORE EXPECTED INV REVERSE CODE N RECS '  03290040
033000             'WRITTEN: '                                          03300041
033100              PV-PCRD038-OUT1-RECS-NON-MATCH.                     03310040
033200     DISPLAY '*'.                                                 03320009
033300     DISPLAY '***************************************************'03330039
033400             '******************************'.                    03340039
033500                                                                  03350010
033600     MOVE 1                          TO PV-INRD030-RECS-READ-STR. 03360016
033700     MOVE 1                          TO PV-PCRD038-RECS-READ-STR. 03370019
033800                                                                  03380016
033900     INITIALIZE PV-PCRD038-OUT1-RECS-STR                          03390015
034000                PV-PCRD038-OUT1-RECS-MATCH                        03400010
034100                PV-PCRD038-OUT1-RECS-NON-MATCH.                   03410009
034200*                                                                 03420004
034300*                                                                 03430004
034400 7000-READ-INV-STORE-EXPECTED.                                    03440004
034500******************************************************************03450004
034600*  READ THE INVENTORY REVERSED STORE EXPECTED FILE               *03460004
034700******************************************************************03470004
034800     READ INV-STORE-EXPECTED                                      03480004
034900       INTO IN030-REPORT-DETAIL                                   03490004
035000         AT END                                                   03500004
035100           SET PS-EOF-INV-STORE-EXTRACT                           03510006
035200                                     TO TRUE.                     03520006
035300                                                                  03530004
035400     IF  PS-EOF-INV-STORE-EXTRACT                                 03540004
035500         MOVE HIGH-VALUES            TO PV-IN030-LOC-NBR-SKU-KEY  03550006
035600     ELSE                                                         03560004
035700         IF  PS-INV-FILE-FIRST-REC                                03570016
035800             ADD 1                   TO PV-INRD030-RECS-READ-STR  03580016
035900             SET PS-NOT-INV-FILE-FIRST-REC                        03590016
036000                                     TO TRUE                      03600016
036100         ELSE                                                     03610016
036200             IF  IN030-LOC-NBR = PV-IN030-LOC-NBR                 03620016
036300                 ADD 1               TO PV-INRD030-RECS-READ-STR  03630016
036400             END-IF                                               03640016
036500         END-IF                                                   03650016
036600         MOVE IN030-LOC-NBR          TO PV-IN030-LOC-NBR          03660016
036700         MOVE IN030-SKU-NBR          TO PV-IN030-SKU-NBR          03670006
036800         ADD 1                       TO PV-INRD030-RECS-READ-TOTAL03680015
036900     END-IF.                                                      03690004
037000*                                                                 03700004
037100*                                                                 03710004
037200 7100-READ-PC-STORE-EXPECTED.                                     03720004
037300******************************************************************03730004
037400*  READ A RECORD FROM THE PC STORE EXPECTED EXTRACT FILE         *03740004
037500******************************************************************03750004
037600     READ PC-STORE-EXPECTED                                       03760004
037700       INTO PC038-SE-UNBALANCED-RPT-REC                           03770004
037800         AT END                                                   03780004
037900           SET PS-EOF-PC-STORE-EXTRACT                            03790006
038000                                     TO TRUE.                     03800006
038100                                                                  03810004
038200     IF  PS-EOF-PC-STORE-EXTRACT                                  03820004
038300         MOVE HIGH-VALUES            TO PV-PC038-LOC-NBR-SKU-KEY  03830006
038400     ELSE                                                         03840004
038500         IF  PS-PC-FILE-FIRST-REC                                 03850016
038600             ADD 1                   TO PV-PCRD038-RECS-READ-STR  03860016
038700             SET PS-NOT-PC-FILE-FIRST-REC                         03870016
038800                                     TO TRUE                      03880016
038900         ELSE                                                     03890016
039000             IF  PC038-LOC-NBR = PV-PC038-LOC-NBR                 03900016
039100                 IF  PS-INV-STORE-ON-PC-FILE                      03910018
039200                     ADD 1           TO PV-PCRD038-RECS-READ-STR  03920018
039300                 END-IF                                           03930018
039400             END-IF                                               03940018
039500         END-IF                                                   03950016
039600         MOVE PC038-LOC-NBR          TO PV-PC038-LOC-NBR          03960006
039700         MOVE PC038-SKU-9            TO PV-PC038-SKU-NBR          03970006
039800         ADD 1                       TO PV-PCRD038-RECS-READ-TOTAL03980015
039900     END-IF.                                                      03990004
040000*                                                                 04000004
040100*                                                                 04010004
040200 8000-WRITE-OUT01-EXTRACT-FILE.                                   04020004
040300******************************************************************04030004
040400*  WRITE TO THE MATCHED STORE EXPECTED EXTRACT FILE.             *04040004
040500******************************************************************04050004
040600     WRITE STORE-EXPECTED-MATCH-REC                               04060004
040700         FROM PC038-SE-UNBALANCED-RPT-REC.                        04070004
040800                                                                  04080004
040900     ADD 1 TO PV-PCRD038-OUT1-RECS-STR                            04090009
041000              PV-PCRD038-OUT1-RECS-WRITTEN                        04100009
041100              PV-PCRD038-TOTAL-RECS-WRITTEN.                      04110004
041200*                                                                 04120004
041300*                                                                 04130004
041400 8100-WRITE-OUT02-EXTRACT-FILE.                                   04140004
041500******************************************************************04150004
041600*  WRITE TO THE NON-MATCHED STORE EXPECTED EXTRACT FILE.         *04160004
041700******************************************************************04170004
041800     WRITE STORE-EXPECTED-NON-MATCH-REC                           04180004
041900         FROM PC038-SE-UNBALANCED-RPT-REC.                        04190004
042000                                                                  04200004
042100     ADD 1 TO PV-PCRD038-OUT2-RECS-WRITTEN                        04210004
042200              PV-PCRD038-TOTAL-RECS-WRITTEN.                      04220004
042300*                                                                 04230004
042400*                                                                 04240004
