000100*----------------------------------------------------------------*00010009
000200 IDENTIFICATION DIVISION.                                         00020009
000300*----------------------------------------------------------------*00030009
000400                                                                  00040009
000500 PROGRAM-ID.             SUKRF525.                                00050009
000600 AUTHOR.                 DENISE HAHN.                             00060009
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070009
000800 DATE-WRITTEN            APRIL, 1998.                             00080009
000900 DATE-COMPILED.                                                   00090009
001000                                                                  00100009
001100*----------------------------------------------------------------*00110009
001200* THIS PROGRAM DISPLAYS THE "CHECK-IN PRINT REQUEST" SCREEN ON THE00120009
001300* LRT (LASER RADIO TERMINAL).  THE OPERATOR CAN SELECT WHAT REPORT00130009
001400* TO PRINT.  CURRENTLY THIS IS ONLY SET UP TO PRINT THE STATISTICS00140009
001500* REPORT.                                                         00150009
001600*----------------------------------------------------------------*00160009
001700* CHANGED: 04/24/98  BY: DENISE HAHN                 WR# 6203     00170020
001800*          ADD FIELD TO CONTROL CARD INDICATING ONLY 1 REPORT IS  00180020
001900*          BEING PRINTED.  THIS WILL TRIGGER REPORT PROGRAM TO CUT00190086
002000*          THE PAPER AFTER REPORT IS COMPLETE.                    00200020
002100*          ADDITIONAL FIELD WAS ADDED TO JL-JCL-LINE-17           00210020
002200*----------------------------------------------------------------*00220009
002300* CHANGED: MM/DD/YY  BY: __________________________  WR#________  00230020
002400*          _______________________________________________________00240020
002500*----------------------------------------------------------------*00250020
002600                                                                  00260009
002700*----------------------------------------------------------------*00270009
002800 ENVIRONMENT DIVISION.                                            00280009
002900*----------------------------------------------------------------*00290009
003000                                                                  00300009
003100*----------------------------------------------------------------*00310009
003200 DATA DIVISION.                                                   00320009
003300*----------------------------------------------------------------*00330009
003400                                                                  00340009
003500*----------------------------------------------------------------*00350009
003600 WORKING-STORAGE SECTION.                                         00360009
003700*----------------------------------------------------------------*00370009
003800 01  CA-COMMAREA.                                                 00380009
003900     COPY SUWS001.                                                00390099
004000                                                                  00400054
004100 01  PC-PROGRAM-CONSTANTS.                                        00410009
004200     05  PC-STATISTICS-RPT-RECORD.                                00420055
004300         10  PC-STAT-RPT-NUMBER          PIC X(02)  VALUE '1.'.   00430029
004400         10  PC-STAT-RPT-DESC            PIC X(14)  VALUE         00440029
004500             'STATISTICS RPT'.                                    00450029
004600     05  PC-WORKSHEET-RPT-RECORD.                                 00460029
004700         10  PC-WRKS-RPT-NUMBER          PIC X(02)  VALUE '2.'.   00470029
004800         10  PC-WRKS-RPT-DESC            PIC X(14)  VALUE         00480029
004900             'PO/STR UNT ADJ'.                                    00490083
005000     05  PC-CARTONS-RPT-RECORD.                                   00500029
005100         10  PC-CRTN-RPT-NUMBER          PIC X(02)  VALUE '3.'.   00510029
005200         10  PC-CRTN-RPT-DESC            PIC X(14)  VALUE         00520029
005300             'CRTNS NOT RCVD'.                                    00530029
005400     05  PC-FREE-ASTRAY-RPT-RECORD.                               00540029
005500         10  PC-FREE-RPT-NUMBER          PIC X(02)  VALUE '4.'.   00550029
005600         10  PC-FREE-RPT-DESC            PIC X(14)  VALUE         00560029
005700             'FREE ASTRAY   '.                                    00570029
005800     05  PC-MISDIRECT-RPT-RECORD.                                 00580029
005900         10  PC-MSDR-RPT-NUMBER          PIC X(02)  VALUE '5.'.   00590029
006000         10  PC-MSDR-RPT-DESC            PIC X(14)  VALUE         00600029
006100             'MISDIRECT RPT '.                                    00610029
006200     05  PC-DUPLICATE-RPT-RECORD.                                 00620029
006300         10  PC-DUPL-RPT-NUMBER          PIC X(02)  VALUE '6.'.   00630029
006400         10  PC-DUPL-RPT-DESC            PIC X(14)  VALUE         00640029
006500             'DUPLICATE SCAN'.                                    00650029
006600     05  PC-SCAN-RPT-RECORD.                                      00660029
006700         10  PC-SCAN-RPT-NUMBER          PIC X(02)  VALUE '7.'.   00670029
006800         10  PC-SCAN-RPT-DESC            PIC X(14)  VALUE         00680029
006900             'SCAN NOT FOUND'.                                    00690029
007000*JPL                                                              00700081
007100     05  PC-UNUSED-RPT-RECORD.                                    00710080
007200         10  PC-ULBL-RPT-NUMBER          PIC X(02)  VALUE '8.'.   00720080
007300         10  PC-ULBL-RPT-DESC            PIC X(14)  VALUE         00730080
007400             'UNUSED LABELS '.                                    00740080
007500                                                                  00750080
007600     05  PC-LOGON-TRAN-ID                PIC  X(04)  VALUE 'Z028'.00760080
007700*    05  PC-COMMAREA-LENGTH              PIC S9(04)  VALUE +300   00770099
007800     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     00780099
007900                                                     COMP SYNC.   00790099
008000     05  PC-LEAVE-SYSTEM-LENGTH          PIC S9(04)  VALUE +160   00800009
008100                                                     COMP SYNC.   00810009
008200     05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)  VALUE        00820009
008300         'SUKRF525'.                                              00830009
008400     05  PC-PRTR-VALIDATION-PGM          PIC  X(08)  VALUE        00840009
008500         'DPKCS060'.                                              00850009
008600     05  PC-REPORT-PGM                   PIC  X(08)  VALUE        00860009
008700         'SUKRP002'.                                              00870009
008800     05  PC-DC-RF-APPL-PGM               PIC  X(08)  VALUE        00880009
008900         'MPKCS027'.                                              00890009
009000     05  PC-SU-TRAILER-PGM               PIC  X(08)  VALUE        00900009
009100         'SUKRF501'.                                              00910009
009200     05  PC-TRAILER-STOP-PGM             PIC  X(08)  VALUE        00920009
009300         'SUKRF503'.                                              00930009
009400     05  PC-SU-IND-RPT-PGM               PIC  X(08)  VALUE        00940009
009500         'SUKRF525'.                                              00950009
009600*LMM                                                              00960097
009700     05  PC-SU-PO-RPT-RQST-PGM           PIC  X(08)  VALUE        00970097
009800         'SUKRF531'.                                              00980097
009900     05  PC-SU-CHECK-IN-PRINT            PIC  X(04)  VALUE 'S525'.00990009
010000     05  PC-SU-TRAILER-STOP              PIC  X(04)  VALUE 'S503'.01000009
010100     05  PC-SU-MENU                      PIC  X(04)  VALUE 'S500'.01010009
010200     05  PC-01                           PIC  X(02)  VALUE '01'.  01020009
010300     05  PC-A                            PIC  X(01)  VALUE 'A'.   01030009
010400     05  PC-S                            PIC  X(01)  VALUE 'S'.   01040024
010500     05  PC-Y                            PIC  X(01)  VALUE 'Y'.   01050024
010600     05  PC-TEST                         PIC  X(01)  VALUE 'T'.   01060010
010700     05  PC-QA                           PIC  X(01)  VALUE 'Q'.   01070084
010710     05  PC-LEARN                        PIC  X(01)  VALUE 'L'.   01071099
010800     05  PC-NO-SELECTION-MADE-MSG        PIC  X(19)  VALUE        01080049
010900         'NO SELECTION MADE  '.                                   01090049
011000     05  PC-END-OF-SESSION-MSG           PIC  X(19)  VALUE        01100023
011100         'END OF SESSION     '.                                   01110023
011200     05  PC-INVALID-SELECTION-MSG        PIC  X(19)  VALUE        01120009
011300         'INVALID SELECTION  '.                                   01130009
011400     05  PC-INVALID-PRINT-ID-MSG         PIC  X(19)  VALUE        01140009
011500         'INVALID PRINTER ID '.                                   01150009
011600     05  PC-UNRECOGNIZED-PF-KEY-MSG      PIC  X(19)  VALUE        01160009
011700         'UNRECOGNIZED PF KEY'.                                   01170009
011800     05  PC-NON-NUMERIC-SELECTION-MSG    PIC  X(19)  VALUE        01180009
011900         'NUMERIC VALUE REQ. '.                                   01190009
012000     05  PC-TRANS-UNAVAILABLE-MSG        PIC  X(19)  VALUE        01200009
012100         'TRANS NOT AVAILABLE'.                                   01210009
012200     05  PC-CICS-ABEND-MSG               PIC  X(19)  VALUE        01220009
012300         'CICS ABEND -CALL DP'.                                   01230009
012400     05  PC-CICSAUTH-MSG                 PIC  X(19)  VALUE        01240009
012500         'CICSAUTH BAD RETURN'.                                   01250009
012600     05  PC-UNAVAIL-SELECTION-MSG        PIC  X(19)  VALUE        01260009
012700         'SELECTION NOT AVAIL'.                                   01270009
012800*LMM FOR TEST ONLY                                                01280099
012900*    05  PC-STATISTIC-RPT-PROC           PIC  X(07)  VALUE        01290099
013000     05  PC-STATISTIC-RPT-PROC           PIC  X(08)  VALUE        01300099
013100*        'SUK9451'.                                               01310099
013200         'SUK9001'.                                               01320099
013300     05  PC-STATISTIC-RPT-JOB            PIC  X(07)  VALUE        01330009
013400*        'SUK945 '.                                               01340099
013500         'SUK900 '.                                               01350099
013600     05  PC-STATISTIC-RPT-DESC           PIC  X(16)  VALUE        01360024
013700         'STATISTIC RPT   '.                                      01370024
013800*    05  PC-INDIVIDUAL-RPT-PROC          PIC  X(07)  VALUE        01380099
013900     05  PC-INDIVIDUAL-RPT-PROC          PIC  X(08)  VALUE        01390099
014000         'SUK9001'.                                               01400099
014100     05  PC-INDIVIDUAL-RPT-JOB           PIC  X(07)  VALUE        01410021
014200         'SUK900 '.                                               01420021
014300     05  PC-INDIVIDUAL-RPT-DESC          PIC  X(16)  VALUE        01430024
014400         'INDIVIDUAL RPTS '.                                      01440024
014500     05  PC-REPORT-SENT-MSG.                                      01450055
014600         10  FILLER                      PIC  X(10)  VALUE        01460058
014700             'RPTS SENT '.                                        01470058
014800         10  PC-MSG-PRTR-ID              PIC  X(08)  VALUE SPACES.01480055
014900                                                                  01490009
015000                                                                  01500009
015100 01  PS-PROGRAM-SWITCHES.                                         01510009
015200     05  PS-ACCESS-ALLOWED-IND           PIC  X(01)  VALUE 'N'.   01520009
015300         88  PS-NO-ACCESS-ALLOWED                    VALUE 'N'.   01530009
015400         88  PS-ACCESS-ALLOWED                       VALUE 'Y'.   01540009
015500     05  PS-ABEND-IND                    PIC  X(01)  VALUE 'N'.   01550009
015600         88  PS-NO-ABEND-IN-PROGRESS                 VALUE 'N'.   01560009
015700         88  PS-ABEND-IN-PROGRESS                    VALUE 'Y'.   01570009
015800     05  PS-INTERNAL-READER-ENQ-DEQ-IND  PIC  X(01)  VALUE 'D'.   01580009
015900         88  PS-INTERNAL-READER-ENQUEUED             VALUE 'E'.   01590009
016000         88  PS-INTERNAL-READER-DEQUEUED             VALUE 'D'.   01600009
016100     05  PS-VALID-SELECTION-IND          PIC  X(01)  VALUE 'N'.   01610022
016200         88  PS-NOT-VALID-SELECTION                  VALUE 'N'.   01620022
016300         88  PS-VALID-SELECTION                      VALUE 'Y'.   01630022
016400                                                                  01640009
016500                                                                  01650009
016600 01  PV-PROGRAM-VARIABLES.                                        01660009
016700*                                                                 01670090
016800     05  PV-SEL-IDX                      PIC S9(04)  VALUE ZERO   01680022
016900                                                     COMP.        01690022
017000     05  PV-TEMP-IDX                     PIC S9(04)  VALUE ZERO   01700022
017100                                                     COMP.        01710022
017200     05  PV-MESSAGE-AREA                 PIC  X(19)  VALUE SPACE. 01720022
017300     05  PV-CICS-RESPONSE                PIC S9(08)  VALUE ZEROS  01730009
017400                                                     COMP SYNC.   01740009
017500     05  PV-LEAVE-SYSTEM-MESSAGE         PIC X(160)  VALUE SPACES.01750009
017600     05  PV-TRANSFER-PROGRAM             PIC  X(08)  VALUE SPACE. 01760009
017700     05  PV-SYSTEM-ID.                                            01770009
017800         10  FILLER                      PIC  X(04)  VALUE SPACE. 01780009
017900         10  PV-REGION-IND               PIC  X(01).              01790009
018000             88  PV-TEST-CICS                        VALUE 'T'.   01800009
018100             88  PV-QA-CICS                          VALUE 'Q'.   01810009
018200             88  PV-PROD-CICS                        VALUE 'P'.   01820009
018300             88  PV-LEARN-CICS                       VALUE 'L'.   01830009
018400         10  FILLER                      PIC  X(03)  VALUE SPACES.01840009
018500     05  PV-PRINTER-DESTINATION          PIC  X(08)  VALUE SPACES.01850099
018600     05  PV-JOB-DESCRIPTION              PIC  X(16)  VALUE SPACES.01860022
018700     05  PV-JOB-PROC                     PIC  X(07)  VALUE SPACES.01870009
018800     05  PV-JOB-NAME                     PIC  X(07)  VALUE SPACES.01880009
018900     05  PV-RETURN-TRANSID               PIC  X(04)  VALUE SPACES.01890009
019000                                                                  01900009
019100 01  PV-SUKRP511-COMMAREA.                                        01910009
019200     05  PV-CA-ORD-NBR                   PIC  9(08)  VALUE ZEROS. 01920009
019300     05  PV-CA-RCVR-SEQ-NBR              PIC  9(03)  VALUE ZEROS. 01930009
019400     05  PV-CA-ORD-LNE-NBR               PIC  9(04)  VALUE ZEROS. 01940009
019500     05  PV-CA-WORK-ORD-SEQ-NBR          PIC  9(03)  VALUE ZEROS. 01950009
019600     05  PV-CA-PRINTER-DESTINATION       PIC  X(04)  VALUE SPACE. 01960009
019700     05  PV-CA-USER-ID                   PIC  X(08)  VALUE SPACE. 01970055
019800     05  PV-CA-OPERATING-ID              PIC  X(04)  VALUE SPACE. 01980009
019900     05  PV-CA-FACILITY-ID               PIC  X(04)  VALUE SPACE. 01990009
020000     05  PV-TS-ITEM                      PIC S9(04)  VALUE ZERO   02000009
020100                                                     COMP.        02010009
020200     05  PV-SIGN-ON-INFO-LENGTH          PIC S9(04)  VALUE ZERO   02020009
020300                                                     COMP SYNC.   02030009
020400     05  PV-SYSID                        PIC  X(04)  VALUE SPACE. 02040009
020500*                                                                 02050009
020600 01  TS-TEMP-STORAGE-QUEUE-INFO.                                  02060009
020700     05  TS-INFO-QUEUE-NAME.                                      02070009
020800         10  TS-INFO-QUEUE-TERMINAL      PIC  X(04)  VALUE SPACE. 02080009
020900         10  FILLER                      PIC  X(04)  VALUE 'INFO'.02090009
021000                                                                  02100009
021100*----------------------------------------------------------------*02110009
021200*  JCL LINES FOR REQUESTING THE COMPLETION/EXCEPTION REPORTS      02120009
021300*----------------------------------------------------------------*02130009
021400                                                                  02140009
021500 01  JL-JCL-LINE-AREA.                                            02150009
021600     05  JL-JCL-LINE-1           PIC X(80).                       02160009
021700     05  JL-JOB-LINE-PROD.                                        02170009
021800         10  FILLER              PIC X(02)    VALUE               02180009
021900             '//'.                                                02190009
022000         10  JL-PROD-JOB-NAME    PIC X(07)    VALUE SPACE.        02200009
022100         10  FILLER              PIC X(12)    VALUE               02210009
022200             '  JOB KOHLS,'.                                      02220009
022300         10  FILLER              PIC X(1)     VALUE QUOTE.        02230009
022400         10  JL-PROD-JOB-DESC    PIC X(16)    VALUE SPACES.       02240022
022500         10  FILLER              PIC X(1)     VALUE QUOTE.        02250009
022600         10  FILLER              PIC X(19)    VALUE               02260009
022700             ',MSGCLASS=P,CLASS=Q'.                               02270099
022800         10  FILLER              PIC X(13)    VALUE SPACES.       02280022
022900     05  JL-JOB-LINE-TEST.                                        02290009
023000         10  FILLER              PIC X(02)    VALUE               02300009
023100             '//'.                                                02310009
023200         10  JL-TEST-JOB-NAME    PIC X(07)    VALUE SPACES.       02320009
023300         10  FILLER              PIC X(01)    VALUE               02330009
023400             'Q'.                                                 02340009
023500         10  FILLER              PIC X(11)    VALUE               02350009
023600             ' JOB KOHLS,'.                                       02360009
023700         10  FILLER              PIC X(1)     VALUE QUOTE.        02370009
023800         10  JL-TEST-JOB-DESC    PIC X(16)    VALUE SPACES.       02380022
023900         10  FILLER              PIC X(1)     VALUE QUOTE.        02390009
024000         10  FILLER              PIC X(19)    VALUE               02400009
024100             ',MSGCLASS=X,CLASS=E'.                               02410009
024200         10  FILLER              PIC X(15)    VALUE SPACES.       02420022
024300     05  JL-JCL-LINE-3.                                           02430009
024400         10  FILLER              PIC X(13)    VALUE               02440009
024500             '/*JOBPARM K=0'.                                     02450009
024600         10  FILLER              PIC X(67)    VALUE SPACES.       02460009
024700     05  JL-JCL-LINE-4-PROD.                                      02470009
024800         10  FILLER              PIC X(39)    VALUE               02480009
024900             '//JOBLIB   DD DSN=PKMO.LOADLIB,DISP=SHR'.           02490009
025000         10  FILLER              PIC X(41)    VALUE SPACES.       02500009
025100     05  JL-JCL-LINE-4-TEST.                                      02510009
025200         10  FILLER              PIC X(39)    VALUE               02520009
025300             '//JOBLIB   DD DSN=TKMA.LOADLIB,DISP=SHR'.           02530009
025400         10  FILLER              PIC X(41)    VALUE SPACES.       02540009
025500     05  JL-JCL-LINE-4-QA.                                        02550084
025600         10  FILLER              PIC X(39)    VALUE               02560084
025700             '//JOBLIB   DD DSN=QKMO.LOADLIB,DISP=SHR'.           02570084
025800         10  FILLER              PIC X(41)    VALUE SPACES.       02580084
025810     05  JL-JCL-LINE-4-LEARN.                                     02581099
025820         10  FILLER              PIC X(39)    VALUE               02582099
025830             '//JOBLIB   DD DSN=LKMO.LOADLIB,DISP=SHR'.           02583099
025840         10  FILLER              PIC X(41)    VALUE SPACES.       02584099
026300     05  JL-JCL-LINE-12.                                          02630009
026400         10  FILLER              PIC X(16)    VALUE               02640009
026500             '//PS020    EXEC '.                                  02650009
026600         10  JL-LINE-12-PROC     PIC X(07)    VALUE SPACES.       02660009
026700         10  JL-LINE-12-PROC-T   PIC X(01)    VALUE SPACES.       02670010
026800         10  FILLER              PIC X(55)    VALUE SPACES.       02680084
026900     05  JL-JCL-LINE-13.                                          02690009
027000         10  FILLER              PIC  X(34)  VALUE                02700009
027100             '//JOBOUT01 OUTPUT FORMS=STD,FCB=8S'.                02710009
027200         10  FILLER              PIC  X(17)  VALUE                02720009
027300             ',CLASS=A,COPIES=1'.                                 02730009
027400         10  FILLER              PIC  X(06)  VALUE                02740009
027500             ',DEST='.                                            02750009
027600         10  JL-LINE-13-PRINTER  PIC  X(08)  VALUE SPACES.        02760009
027700         10  FILLER              PIC  X(16)  VALUE SPACE.         02770009
027800*    05  JL-JCL-LINE-AUTO-SCHD.                                   02780099
027900*        10  FILLER                     PIC X(40)  VALUE          02790099
028000*            '//$AUTO    EXEC PGM=$A,COND=(0,LE),PARM='.          02800099
028100*        10  FILLER                     PIC X(01)  VALUE QUOTE.   02810099
028200*        10  FILLER                     PIC X(01)  VALUE '>'.     02820099
028300*        10  FILLER                     PIC X(01)  VALUE QUOTE.   02830099
028400*        10  FILLER                     PIC X(37)  VALUE SPACES.  02840099
028500*BUILD TRIP CONTROL CARD-SUCC005                                  02850095
028600     05  JL-JCL-LINE-14.                                          02860009
028700         10  FILLER              PIC X(18)    VALUE               02870009
028800             '//S010.SYSUT1 DD *'.                                02880009
028900         10  FILLER              PIC X(62)    VALUE SPACES.       02890009
029000     05  JL-JCL-LINE-15.                                          02900009
029100         10  JL-LINE-15-MANIFEST PIC X(09).                       02910009
029200*LMM ADD TK NUMBER AND REQUEST TIMESTAMP                          02920087
029300         10  FILLER              PIC X(01)    VALUE SPACES.       02930087
029400         10  JL-LINE-15-USER-ID  PIC X(08).                       02940089
029500         10  FILLER              PIC X(01)    VALUE SPACES.       02950087
029600         10  JL-LINE-15-TIMESTMP PIC X(26).                       02960087
029700         10  FILLER              PIC X(35)    VALUE SPACES.       02970088
029800*BUILD PRINTER CONTROL CARD-SUCC006                               02980095
029900     05  JL-JCL-LINE-16.                                          02990009
030000         10  FILLER              PIC X(18)    VALUE               03000009
030100             '//S035.SYSUT1 DD *'.                                03010009
030200         10  FILLER              PIC X(62)    VALUE SPACES.       03020009
030300     05  JL-JCL-LINE-17.                                          03030009
030400         10  JL-LINE-17-PRINTER  PIC X(08)    VALUE SPACES.       03040009
030500         10  JL-LINE-17-PRTR-IND PIC X(01)    VALUE SPACES.       03050009
030600         10  JL-LINE-17-TRACK-NBR                                 03060009
030700                                 PIC  9(1)    VALUE 0.            03070009
030800         10  FILLER              PIC X(01)    VALUE SPACES.       03080020
030900         10  JL-LINE-17-CUT-RPT  PIC X(01)    VALUE SPACES.       03090020
031000         10  JL-LINE-17-USER-ID  PIC X(08)    VALUE SPACES.       03100024
031100         10  JL-LINE-17-STAT-RPT PIC X(01)    VALUE SPACES.       03110024
031200         10  JL-LINE-17-CRTN-RPT PIC X(01)    VALUE SPACES.       03120024
031300         10  JL-LINE-17-MSDR-RPT PIC X(01)    VALUE SPACES.       03130024
031400         10  JL-LINE-17-FREE-RPT PIC X(01)    VALUE SPACES.       03140048
031500         10  JL-LINE-17-DUPL-RPT PIC X(01)    VALUE SPACES.       03150024
031600         10  JL-LINE-17-WRKS-RPT PIC X(01)    VALUE SPACES.       03160024
031700         10  JL-LINE-17-SCAN-RPT PIC X(01)    VALUE SPACES.       03170024
031800         10  JL-LINE-17-ULBL-RPT PIC X(01)    VALUE SPACES.       03180081
031900*LMM ADD ALL PO INDICATOR                                         03190087
032000         10  FILLER              PIC X(01)    VALUE SPACES.       03200087
032100         10  JL-LINE-17-ALL-PO-IND                                03210087
032200                                 PIC X(01)    VALUE SPACES.       03220087
032300         10  FILLER              PIC X(50)    VALUE SPACES.       03230087
032400     05  JL-JCL-LINE-EOF.                                         03240009
032500         10  FILLER              PIC X(5)     VALUE '/*EOF'.      03250009
032600         10  FILLER              PIC X(75)    VALUE SPACES.       03260009
032700                                                                  03270009
032800 01  TD-TRANSIENT-DATA-AREA.                                      03280009
032900     05  TD-QUEUE-NAME           PIC X(4)     VALUE 'IRTD'.       03290009
033000     05  TD-QUEUE-NAME-LENGTH    PIC S9(4)    VALUE +4            03300009
033100                                 COMP SYNC.                       03310009
033200     05  TD-JCL-LINE             PIC X(80)    VALUE SPACES.       03320009
033300     05  TD-JCL-LINE-LENGTH      PIC S9(4)    VALUE +80           03330009
033400                                 COMP SYNC.                       03340009
033500                                                                  03350009
033600                                                                  03360009
033700 01  SE-SYSTEM-ERROR-MESSAGE.                                     03370009
033800     05  FILLER                  PIC X(43)    VALUE               03380009
033900         'A SYSTEM ERROR HAS OCCURRED - CONTACT DP - '.           03390009
034000     05  FILLER                  PIC X(33)    VALUE               03400009
034100         'PROGRAM RFKCS215       EIBRESP = '.                     03410009
034200     05  SE-CICS-RESPONSE        PIC 9(4)     VALUE ZERO.         03420009
034300     05  FILLER                  PIC X(5)     VALUE SPACES.       03430009
034400     05  FILLER                  PIC X(14)    VALUE               03440009
034500         'ATTEMPTING TO '.                                        03450009
034600     05  SE-ATTEMPTED-ACTION     PIC X(61)    VALUE SPACES.       03460009
034700*----------------------------------------------------------------*03470009
034800*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               03480009
034900*----------------------------------------------------------------*03490009
035000     COPY DPWS013.                                                03500099
035100                                                                  03510009
035200*----------------------------------------------------------------*03520009
035300*    COPY BOOK FOR THE CICSAUTH SUBROUTINE                        03530009
035400*----------------------------------------------------------------*03540009
035500     COPY DPWS008.                                                03550099
035600                                                                  03560009
035700*----------------------------------------------------------------*03570013
035800* COPY BOOK CONTAINING ERROR/WARNING/INFORMATIONAL MESSAGES       03580013
035900* TO BE DISPLAYED ON THE LRT                                      03590013
036000*----------------------------------------------------------------*03600013
036100     COPY SUWS005.                                                03610099
036200                                                                  03620013
036300*----------------------------------------------------------------*03630009
036400*  SENDING/RECEIVING AREA FOR THE NUMERIC EDIT ROUTINE (DPKUT100) 03640009
036500*----------------------------------------------------------------*03650009
036600     COPY DPWS010I.                                               03660099
036700                                                                  03670009
036800*----------------------------------------------------------------*03680009
036900*  TEMPORARY STORAGE QUEUE LAYOUT FOR LOGON/UNIT RELATED          03690009
037000*  INFORMATION CAPTURED BY THE NAVIGATOR AT LOGON TIME            03700009
037100*----------------------------------------------------------------*03710009
037200     COPY DPWS026.                                                03720099
037300                                                                  03730009
037400*----------------------------------------------------------------*03740009
037500*  SENDING/RECEIVING AREA FOR THE                                 03750009
037600*  PRINTER VALIDATION ROUTING (DPKCS060)                          03760009
037700*----------------------------------------------------------------*03770009
037800     COPY DPWS072.                                                03780099
037900                                                                  03790009
038000*----------------------------------------------------------------*03800009
038100*  GENERATED DSECT FOR THE SUMK503 MAPSET                         03810009
038200*----------------------------------------------------------------*03820009
038300     COPY SUKM503.                                                03830009
038400                                                                  03840009
038500*----------------------------------------------------------------*03850009
038600*  GENERATED DSECT FOR THE SUMK525 MAPSET                         03860009
038700*----------------------------------------------------------------*03870009
038800     COPY SUKM525.                                                03880009
038900                                                                  03890009
039000*----------------------------------------------------------------*03900009
039100*  KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST   03910009
039200*----------------------------------------------------------------*03920009
039300     COPY DPWS015.                                                03930099
039400                                                                  03940009
039500*----------------------------------------------------------------*03950009
039600*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      03960009
039700*----------------------------------------------------------------*03970009
039800     COPY DFHAID.                                                 03980009
039900                                                                  03990009
040000*----------------------------------------------------------------*04000009
040100*  COBOL DECLARATION AND DCLGEN MEMBER FOR THE COMPANY CONTROL    04010009
040200*  TABLE                                                          04020009
040300*----------------------------------------------------------------*04030009
040400     EXEC SQL                                                     04040009
040500          INCLUDE TCOCNTL                                         04050009
040600     END-EXEC.                                                    04060009
040700                                                                  04070009
040800*----------------------------------------------------------------*04080009
040900*  COMMUNICATIONS AREA FOR DB2                                    04090009
041000*----------------------------------------------------------------*04100009
041100     EXEC SQL                                                     04110009
041200          INCLUDE SQLCA                                           04120009
041300     END-EXEC.                                                    04130009
041400*----------------------------------------------------------------*04140009
041500 LINKAGE SECTION.                                                 04150009
041600*----------------------------------------------------------------*04160009
041700*01  DFHCOMMAREA                         PIC  X(200).             04170099
041800 01  DFHCOMMAREA.                                                 04180099
041900     05  FILLER                       OCCURS 1 TO 4072 TIMES      04190099
042000                                      DEPENDING ON EIBCALEN.      04200099
042100         10  FILLER                   PIC X.                      04210099
042200                                                                  04220099
042300*----------------------------------------------------------------*04230099
042400 PROCEDURE DIVISION.                                              04240099
042500*----------------------------------------------------------------*04250099
042600 0000-PROGRAM-MAINLINE.                                           04260099
042700*LMM                                                              04270099
042800     INITIALIZE CA-COMMAREA                                       04280099
042900     MOVE DFHCOMMAREA                TO CA-COMMAREA.              04290099
043000                                                                  04300099
043100     EVALUATE TRUE                                                04310099
043200         WHEN SU001-INITIALIZE-SCREEN                             04320099
043300              SET SU001-PROCESS-SCREEN       TO TRUE              04330099
043400              INITIALIZE SU001-525-SCREEN-SELECTION-TBL           04340099
043500                         SU001-525-REPORT-SELECTION-TBL           04350099
043600              MOVE SU001-PRINTER-ID       TO BPRNTIDO             04360099
043700              PERFORM 0100-SETUP-SCREEN                           04370099
043800              PERFORM 8000-SEND-MAP-IND                           04380099
043900              MOVE PC-SU-CHECK-IN-PRINT   TO PV-RETURN-TRANSID    04390099
044000              PERFORM 8200-RETURN-TRANID                          04400099
044100         WHEN EIBCALEN = ZERO                                     04410099
044200         WHEN EIBAID = DFHCLEAR                                   04420099
044300              SET SU001-PROCESS-SCREEN       TO TRUE              04430099
044400              INITIALIZE SU001-525-SCREEN-SELECTION-TBL           04440099
044500                         SU001-525-REPORT-SELECTION-TBL           04450099
044600              PERFORM 0500-SELECT-PRINTER                         04460099
044700              MOVE COCNTL-DFLT-SU-PRTR-ID TO APRNTIDO             04470099
044800              MOVE DP015-UNP-ALP-NOR-MDT  TO APRNTIDA             04480099
044900              PERFORM 8050-SEND-MAP-TRAILER                       04490099
045000*             MOVE PC-SU-TRAILER-STOP     TO PV-RETURN-TRANSID    04500099
045100*             PERFORM 8200-RETURN-TRANID                          04510099
045200         WHEN EIBAID = DFHPF3                                     04520099
045300              SET SU001-NO-RPT-REQUESTED     TO TRUE              04530099
045400              MOVE PC-TRAILER-STOP-PGM    TO PV-TRANSFER-PROGRAM  04540099
045500              PERFORM 3000-XCTL-TO-SELECTED-PROGRAM               04550099
045600         WHEN EIBAID = DFHPF4                                     04560099
045700              PERFORM 1000-RECEIVE-MAP                            04570099
045800              PERFORM 1100-EDIT-SELECTION                         04580099
045900              PERFORM 2000-PROCESS-SELECTION                      04590099
046000         WHEN EIBAID = DFHPF7                                     04600099
046100         WHEN EIBAID = DFHPF8                                     04610099
046200              PERFORM 1000-RECEIVE-MAP                            04620099
046300              PERFORM 1100-EDIT-SELECTION                         04630099
046400              SET SU001-PROCESS-SCREEN       TO TRUE              04640099
046500              MOVE SU001-PRINTER-ID          TO BPRNTIDO          04650099
046600              PERFORM 5000-SETUP-F7-F8-SCREEN                     04660099
046700              PERFORM 8000-SEND-MAP-IND                           04670099
046800              MOVE PC-SU-CHECK-IN-PRINT   TO PV-RETURN-TRANSID    04680099
046900              PERFORM 8200-RETURN-TRANID                          04690099
047000         WHEN EIBAID = DFHENTER                                   04700099
047100              PERFORM 1000-RECEIVE-MAP                            04710099
047200              PERFORM 1100-EDIT-SELECTION                         04720099
047300              PERFORM 8100-SEND-DATA-ONLY                         04730099
047400              MOVE PC-SU-CHECK-IN-PRINT TO PV-RETURN-TRANSID      04740099
047500              PERFORM 8200-RETURN-TRANID                          04750099
047600         WHEN OTHER                                               04760099
047700              MOVE PC-UNRECOGNIZED-PF-KEY-MSG                     04770099
047800                                     TO BMSGLNO                   04780099
047900              MOVE -1 TO BSLECT1L                                 04790099
048000              PERFORM 8100-SEND-DATA-ONLY                         04800099
048100              MOVE PC-SU-CHECK-IN-PRINT   TO PV-RETURN-TRANSID    04810099
048200              PERFORM 8200-RETURN-TRANID                          04820099
048300     END-EVALUATE.                                                04830099
048400                                                                  04840099
048500     GOBACK.                                                      04850099
048600                                                                  04860099
048700****************************************************************  04870099
048800* 0100-SETUP-SCREEN                                               04880099
048900*    SETUP THE INITIAL REPORT SELECTION LIST                      04890099
049000****************************************************************  04900099
049100 0100-SETUP-SCREEN.                                               04910099
049200                                                                  04920099
049300     MOVE +1 TO PV-SEL-IDX.                                       04930099
049400     MOVE  PC-STAT-RPT-DESC                                       04940099
049500       TO  SU001-525-RPT-DESC (PV-SEL-IDX).                       04950099
049600     MOVE  PC-STAT-RPT-NUMBER                                     04960099
049700       TO  SU001-525-RPT-NUMBER (PV-SEL-IDX).                     04970099
049800                                                                  04980099
049900     ADD +1 TO PV-SEL-IDX.                                        04990099
050000     MOVE  PC-WRKS-RPT-DESC                                       05000099
050100       TO  SU001-525-RPT-DESC (PV-SEL-IDX).                       05010099
050200     MOVE  PC-WRKS-RPT-NUMBER                                     05020099
050300       TO  SU001-525-RPT-NUMBER (PV-SEL-IDX).                     05030099
050400                                                                  05040099
050500     ADD +1 TO PV-SEL-IDX.                                        05050099
050600     MOVE  PC-CRTN-RPT-DESC                                       05060099
050700       TO  SU001-525-RPT-DESC (PV-SEL-IDX).                       05070099
050800     MOVE  PC-CRTN-RPT-NUMBER                                     05080099
050900       TO  SU001-525-RPT-NUMBER (PV-SEL-IDX).                     05090099
051000                                                                  05100099
051100     ADD +1 TO PV-SEL-IDX.                                        05110099
051200     MOVE  PC-FREE-RPT-DESC                                       05120099
051300       TO  SU001-525-RPT-DESC (PV-SEL-IDX).                       05130099
051400     MOVE  PC-FREE-RPT-NUMBER                                     05140099
051500       TO  SU001-525-RPT-NUMBER (PV-SEL-IDX).                     05150099
051600                                                                  05160099
051700     ADD +1 TO PV-SEL-IDX.                                        05170099
051800     MOVE  PC-MSDR-RPT-DESC                                       05180099
051900       TO  SU001-525-RPT-DESC (PV-SEL-IDX).                       05190099
052000     MOVE  PC-MSDR-RPT-NUMBER                                     05200099
052100       TO  SU001-525-RPT-NUMBER (PV-SEL-IDX).                     05210099
052200                                                                  05220099
052300     PERFORM 0200-MOVE-TO-SCREEN.                                 05230099
052400                                                                  05240099
052500                                                                  05250099
052600******************************************************************05260099
052700* 0200-MOVE-TO-SCREEN                                            *05270099
052800******************************************************************05280099
052900 0200-MOVE-TO-SCREEN.                                             05290099
053000                                                                  05300099
053100*    TAKE THE TABLE OF SELECTIONS, AND MOVE IT TO THE SCREEN      05310099
053200                                                                  05320099
053300*    FIRST OPTION                                                 05330099
053400     MOVE +1 TO PV-TEMP-IDX.                                      05340099
053500     MOVE SU001-525-RPT-NUMBER (PV-TEMP-IDX) TO BRPTNB1O.         05350099
053600     MOVE SU001-525-RPT-DESC (PV-TEMP-IDX)   TO BRPTNM1O.         05360099
053700     IF SU001-525-RPT-DESC (PV-TEMP-IDX) > SPACES                 05370099
053800         MOVE DP015-ASK-NOR-MDT           TO BRPTNB1A             05380099
053900                                             BRPTNM1A             05390099
054000         IF CA-525-PRINT-RPT-IND (PV-TEMP-IDX) > SPACES           05400099
054100             MOVE CA-525-PRINT-RPT-IND (PV-TEMP-IDX)              05410099
054200                                                     TO BSLECT1O  05420099
054300             MOVE DP015-UNP-ALP-NOR-MDT              TO BSLECT1A  05430099
054400         ELSE                                                     05440099
054500             MOVE SPACES TO BSLECT1O                              05450099
054600         END-IF                                                   05460099
054700     ELSE                                                         05470099
054800         MOVE DP015-ASK-DRK-OFF TO BRPTNB1A                       05480099
054900                                   BRPTNM1A                       05490099
055000                                   BSLECT1A                       05500099
055100     END-IF.                                                      05510099
055200                                                                  05520099
055300*    SECOND OPTION                                                05530099
055400     ADD +1 TO PV-TEMP-IDX.                                       05540099
055500     MOVE SU001-525-RPT-NUMBER (PV-TEMP-IDX) TO BRPTNB2O.         05550099
055600     MOVE SU001-525-RPT-DESC (PV-TEMP-IDX)   TO BRPTNM2O.         05560099
055700     IF SU001-525-RPT-DESC (PV-TEMP-IDX) > SPACES                 05570099
055800         MOVE DP015-ASK-NOR-MDT           TO BRPTNB2A             05580099
055900                                             BRPTNM2A             05590099
056000**RSC* REMOVE START                                               05600099
056100**RSC* REMOVE WHEN PROGRAM SUKRF007 IS READY FOR RELEASE TO PROD  05610099
056200**RSC* ADDED TO PREVENT SELECTION OF PC-WRKS-RPT-DESC             05620099
056300**RSC* UNTIL PROGRAM SUKRF007 IS COMPLETE                         05630099
056400***      IF SU001-525-RPT-DESC (PV-TEMP-IDX) = PC-WRKS-RPT-DESC   05640099
056500***          MOVE SPACES                         TO BSLECT2O      05650099
056600***          MOVE DP015-ASK-NOR-OFF              TO BSLECT2A      05660099
056700***      ELSE                                                     05670099
056800**RSC* REMOVE END                                                 05680099
056900         IF CA-525-PRINT-RPT-IND (PV-TEMP-IDX) > SPACES           05690099
057000             MOVE CA-525-PRINT-RPT-IND (PV-TEMP-IDX)              05700099
057100                                                     TO BSLECT2O  05710099
057200             MOVE DP015-UNP-ALP-NOR-MDT              TO BSLECT2A  05720099
057300         ELSE                                                     05730099
057400             MOVE SPACES TO BSLECT2O                              05740099
057500         END-IF                                                   05750099
057600**RSC* REMOVE START                                               05760099
057700***      END-IF                                                   05770099
057800**RSC* REMOVE END                                                 05780099
057900     ELSE                                                         05790099
058000         MOVE DP015-ASK-DRK-OFF TO BRPTNB2A                       05800099
058100                                   BRPTNM2A                       05810099
058200                                   BSLECT2A                       05820099
058300     END-IF.                                                      05830099
058400                                                                  05840099
058500*    THIRD OPTION                                                 05850099
058600     ADD +1 TO PV-TEMP-IDX.                                       05860099
058700     MOVE SU001-525-RPT-NUMBER (PV-TEMP-IDX) TO BRPTNB3O.         05870099
058800     MOVE SU001-525-RPT-DESC (PV-TEMP-IDX) TO BRPTNM3O.           05880099
058900     IF SU001-525-RPT-DESC (PV-TEMP-IDX) > SPACES                 05890099
059000         MOVE DP015-ASK-NOR-MDT           TO BRPTNB3A             05900099
059100                                             BRPTNM3A             05910099
059200         IF CA-525-PRINT-RPT-IND (PV-TEMP-IDX) > SPACES           05920099
059300             MOVE CA-525-PRINT-RPT-IND (PV-TEMP-IDX) TO BSLECT3O  05930099
059400             MOVE DP015-UNP-ALP-NOR-MDT              TO BSLECT3A  05940099
059500         ELSE                                                     05950099
059600             MOVE SPACES TO BSLECT3O                              05960099
059700         END-IF                                                   05970099
059800     ELSE                                                         05980099
059900         MOVE DP015-ASK-DRK-OFF TO BRPTNB3A                       05990099
060000                                   BRPTNM3A                       06000099
060100                                   BSLECT3A                       06010099
060200     END-IF.                                                      06020099
060300                                                                  06030099
060400*    FOURTH OPTION                                                06040099
060500     ADD +1 TO PV-TEMP-IDX.                                       06050099
060600     MOVE SU001-525-RPT-NUMBER (PV-TEMP-IDX) TO BRPTNB4O.         06060099
060700     MOVE SU001-525-RPT-DESC (PV-TEMP-IDX) TO BRPTNM4O.           06070099
060800     IF SU001-525-RPT-DESC (PV-TEMP-IDX) > SPACES                 06080099
060900         MOVE DP015-ASK-NOR-MDT           TO BRPTNB4A             06090099
061000                                             BRPTNM4A             06100099
061100         IF CA-525-PRINT-RPT-IND (PV-TEMP-IDX) > SPACES           06110099
061200             MOVE CA-525-PRINT-RPT-IND (PV-TEMP-IDX) TO BSLECT4O  06120099
061300             MOVE DP015-UNP-ALP-NOR-MDT              TO BSLECT4A  06130099
061400         ELSE                                                     06140099
061500             MOVE SPACES TO BSLECT4O                              06150099
061600         END-IF                                                   06160099
061700     ELSE                                                         06170099
061800         MOVE DP015-ASK-DRK-OFF TO BRPTNB4A                       06180099
061900                                   BRPTNM4A                       06190099
062000                                   BSLECT4A                       06200099
062100     END-IF.                                                      06210099
062200                                                                  06220099
062300*    FIFTH OPTION                                                 06230099
062400     ADD +1 TO PV-TEMP-IDX.                                       06240099
062500     MOVE SU001-525-RPT-NUMBER (PV-TEMP-IDX) TO BRPTNB5O.         06250099
062600     MOVE SU001-525-RPT-DESC (PV-TEMP-IDX) TO BRPTNM5O.           06260099
062700     IF SU001-525-RPT-DESC (PV-TEMP-IDX) > SPACES                 06270099
062800         MOVE DP015-ASK-NOR-MDT           TO BRPTNB5A             06280099
062900                                             BRPTNM5A             06290099
063000         IF CA-525-PRINT-RPT-IND (PV-TEMP-IDX) > SPACES           06300099
063100             MOVE CA-525-PRINT-RPT-IND (PV-TEMP-IDX) TO BSLECT5O  06310099
063200             MOVE DP015-UNP-ALP-NOR-MDT              TO BSLECT5A  06320099
063300         ELSE                                                     06330099
063400             MOVE SPACES TO BSLECT5O                              06340099
063500         END-IF                                                   06350099
063600     ELSE                                                         06360099
063700         MOVE DP015-ASK-DRK-OFF TO BRPTNB5A                       06370099
063800                                   BRPTNM5A                       06380099
063900                                   BSLECT5A                       06390099
064000     END-IF.                                                      06400099
064100                                                                  06410099
064200                                                                  06420099
064300*----------------------------------------------------------------*06430099
064400*  DETERMINE DEFAULT PRINTER SELECTION - WHEN RETURNING TO       *06440099
064500*  TRAILER STOP MENU                                             *06450099
064600*----------------------------------------------------------------*06460099
064700 0500-SELECT-PRINTER.                                             06470099
064800                                                                  06480099
064900     EXEC SQL                                                     06490099
065000          SELECT DFLT_SU_PRTR_ID                                  06500099
065100            INTO :COCNTL-DFLT-SU-PRTR-ID                          06510099
065200            FROM TCOCNTL                                          06520099
065300            WHERE OPER_UNT_ID = :SU001-OPER-UNT-ID                06530099
065400              AND FCLTY_ID    = :SU001-FCLTY-ID                   06540099
065500     END-EXEC.                                                    06550099
065600                                                                  06560099
065700     EVALUATE TRUE                                                06570099
065800         WHEN SQLCODE = ZERO                                      06580099
065900         CONTINUE                                                 06590099
066000         WHEN SQLWARN0 NOT = SPACES                               06600099
066100         WHEN SQLCODE < ZERO                                      06610099
066200         WHEN SQLCODE > ZERO                                      06620099
066300             MOVE '0500-SELECT-PRINTER'                           06630099
066400                             TO DP013-PARAGRAPH                   06640099
066500             MOVE 'SELECT DEFAULT PRINTER ID'                     06650099
066600                             TO DP013-MESSAGE-TEXT(1)             06660099
066700             MOVE SU001-OPER-UNT-ID                               06670099
066800                             TO DP013-MESSAGE-TEXT(2)             06680099
066900             MOVE SU001-FCLTY-ID                                  06690099
067000                             TO DP013-MESSAGE-TEXT(3)             06700099
067100             MOVE SQLCA      TO DP013-SQLCA                       06710099
067200             MOVE 'TCOCNTL'  TO DP013-DB2-TABLE-NAME(1)           06720099
067300             SET DP013-DB2-ABEND                                  06730099
067400                             TO TRUE                              06740099
067500             SET DP013-NO-ROLLBACK                                06750099
067600                             TO TRUE                              06760099
067700             SET DP013-XCTL-DISPLAY-RESTART                       06770099
067800                             TO TRUE                              06780099
067900             PERFORM DP014-0000-PROCESS-ABEND                     06790099
068000     END-EVALUATE.                                                06800099
068100                                                                  06810099
068200                                                                  06820099
068300*----------------------------------------------------------------*06830099
068400*  RECEIVE - CHECK-IN PRINT REQUEST SCREEN                       *06840099
068500*----------------------------------------------------------------*06850099
068600 1000-RECEIVE-MAP.                                                06860099
068700     MOVE -1 TO BSLECT1L.                                         06870099
068800                                                                  06880099
068900     EXEC CICS                                                    06890099
069000         RECEIVE MAP    ('SU525B')                                06900099
069100                 MAPSET ('SUKM525')                               06910099
069200                 RESP   (PV-CICS-RESPONSE)                        06920099
069300     END-EXEC.                                                    06930099
069400                                                                  06940099
069500     EVALUATE TRUE                                                06950099
069600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 06960099
069700              PERFORM 1010-RECEIVE-SCREEN-FIELDS                  06970099
069800         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                06980099
069900              CONTINUE                                            06990099
070000         WHEN OTHER                                               07000099
070100              MOVE '1000-RECEIVE-MAP'                             07010099
070200                                     TO DP013-PARAGRAPH           07020099
070300              MOVE 'UNABLE TO RECEIVE MAP'                        07030099
070400                                     TO DP013-MESSAGE-TEXT (1)    07040099
070500              SET DP013-LOGIC-ABEND  TO TRUE                      07050099
070600              SET DP013-NO-ROLLBACK  TO TRUE                      07060099
070700              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              07070099
070800     END-EVALUATE.                                                07080099
070900                                                                  07090099
071000*----------------------------------------------------------------*07100099
071100*  RECEIVE SCREEN ENTRY FIELDS                                   *07110099
071200*----------------------------------------------------------------*07120099
071300 1010-RECEIVE-SCREEN-FIELDS.                                      07130099
071400                                                                  07140099
071500     INITIALIZE SU001-525-SCREEN-SELECTION-TBL.                   07150099
071600                                                                  07160099
071700     MOVE +1 TO PV-SEL-IDX.                                       07170099
071800     IF BSLECT1L > ZERO                                           07180099
071900         MOVE BSLECT1I   TO CA-525-PRINT-RPT-IND (PV-SEL-IDX)     07190099
072000     ELSE                                                         07200099
072100         IF BSLECT1F = DP015-ERASE-EOF                            07210099
072200             MOVE SPACES TO CA-525-PRINT-RPT-IND (PV-SEL-IDX)     07220099
072300         END-IF                                                   07230099
072400     END-IF.                                                      07240099
072500     MOVE BRPTNB1I       TO SU001-525-RPT-NUMBER (PV-SEL-IDX).    07250099
072600     MOVE BRPTNM1I       TO SU001-525-RPT-DESC (PV-SEL-IDX).      07260099
072700                                                                  07270099
072800     ADD +1        TO PV-SEL-IDX.                                 07280099
072900     IF BSLECT2L > ZERO                                           07290099
073000         MOVE BSLECT2I   TO CA-525-PRINT-RPT-IND (PV-SEL-IDX)     07300099
073100     ELSE                                                         07310099
073200         IF BSLECT2F = DP015-ERASE-EOF                            07320099
073300             MOVE SPACES TO CA-525-PRINT-RPT-IND (PV-SEL-IDX)     07330099
073400         END-IF                                                   07340099
073500     END-IF.                                                      07350099
073600     MOVE BRPTNB2I TO SU001-525-RPT-NUMBER (PV-SEL-IDX).          07360099
073700     MOVE BRPTNM2I TO SU001-525-RPT-DESC (PV-SEL-IDX).            07370099
073800                                                                  07380099
073900     ADD +1 TO PV-SEL-IDX.                                        07390099
074000     IF BSLECT3L > ZERO                                           07400099
074100         MOVE BSLECT3I   TO CA-525-PRINT-RPT-IND (PV-SEL-IDX)     07410099
074200     ELSE                                                         07420099
074300         IF BSLECT3F = DP015-ERASE-EOF                            07430099
074400             MOVE SPACES TO CA-525-PRINT-RPT-IND (PV-SEL-IDX)     07440099
074500         END-IF                                                   07450099
074600     END-IF.                                                      07460099
074700     MOVE BRPTNB3I       TO SU001-525-RPT-NUMBER (PV-SEL-IDX).    07470099
074800     MOVE BRPTNM3I       TO SU001-525-RPT-DESC (PV-SEL-IDX).      07480099
074900                                                                  07490099
075000     ADD +1 TO PV-SEL-IDX.                                        07500099
075100     IF BSLECT4L > ZERO                                           07510099
075200         MOVE BSLECT4I   TO CA-525-PRINT-RPT-IND (PV-SEL-IDX)     07520099
075300     ELSE                                                         07530099
075400         IF BSLECT4F = DP015-ERASE-EOF                            07540099
075500             MOVE SPACES TO CA-525-PRINT-RPT-IND (PV-SEL-IDX)     07550099
075600         END-IF                                                   07560099
075700     END-IF.                                                      07570099
075800     MOVE BRPTNB4I       TO SU001-525-RPT-NUMBER (PV-SEL-IDX).    07580099
075900     MOVE BRPTNM4I       TO SU001-525-RPT-DESC (PV-SEL-IDX).      07590099
076000                                                                  07600099
076100     ADD +1 TO PV-SEL-IDX.                                        07610099
076200     IF BSLECT5L > ZERO                                           07620099
076300         MOVE BSLECT5I   TO CA-525-PRINT-RPT-IND (PV-SEL-IDX)     07630099
076400     ELSE                                                         07640099
076500         IF BSLECT5F = DP015-ERASE-EOF                            07650099
076600             MOVE SPACES TO CA-525-PRINT-RPT-IND (PV-SEL-IDX)     07660099
076700         END-IF                                                   07670099
076800     END-IF.                                                      07680099
076900     MOVE BRPTNB5I       TO SU001-525-RPT-NUMBER (PV-SEL-IDX).    07690099
077000     MOVE BRPTNM5I       TO SU001-525-RPT-DESC (PV-SEL-IDX).      07700099
077100                                                                  07710099
077200     MOVE SU001-PRINTER-ID  TO PV-PRINTER-DESTINATION.            07720099
077300                                                                  07730099
077400     IF  BPRNTIDL > ZERO                                          07740099
077500         MOVE BPRNTIDI         TO SU001-PRINTER-ID                07750099
077600         MOVE SU001-PRINTER-ID TO PV-PRINTER-DESTINATION          07760099
077700     ELSE                                                         07770099
077800         IF BPRNTIDF = DP015-ERASE-EOF                            07780099
077900             MOVE SPACES    TO SU001-PRINTER-ID                   07790099
078000             MOVE SPACES    TO PV-PRINTER-DESTINATION             07800099
078100         END-IF                                                   07810099
078200     END-IF.                                                      07820099
078300                                                                  07830099
078400******************************************************************07840099
078500*  VALIDATE SCREEN SELECTION                                     *07850099
078600******************************************************************07860099
078700 1100-EDIT-SELECTION.                                             07870099
078800                                                                  07880099
078900     PERFORM 1200-EDIT-REPORT-SELECTION.                          07890099
079000                                                                  07900099
079100     EVALUATE TRUE                                                07910099
079200     WHEN PS-VALID-SELECTION                                      07920099
079300         MOVE -1 TO BSLECT1L                                      07930099
079400     WHEN OTHER                                                   07940099
079500         EVALUATE TRUE                                            07950099
079600         WHEN PV-SEL-IDX = +1                                     07960099
079700             MOVE DP015-UNP-NUM-BRT-MDT TO BSLECT1A               07970099
079800             MOVE -1 TO BSLECT1L                                  07980099
079900         WHEN PV-SEL-IDX = +2                                     07990099
080000             MOVE DP015-UNP-NUM-BRT-MDT TO BSLECT2A               08000099
080100             MOVE -1 TO BSLECT2L                                  08010099
080200         WHEN PV-SEL-IDX = +3                                     08020099
080300             MOVE DP015-UNP-NUM-BRT-MDT TO BSLECT3A               08030099
080400             MOVE -1 TO BSLECT3L                                  08040099
080500         WHEN PV-SEL-IDX = +4                                     08050099
080600             MOVE DP015-UNP-NUM-BRT-MDT TO BSLECT4A               08060099
080700             MOVE -1 TO BSLECT4L                                  08070099
080800         WHEN PV-SEL-IDX = +5                                     08080099
080900             MOVE DP015-UNP-NUM-BRT-MDT TO BSLECT5A               08090099
081000             MOVE -1 TO BSLECT5L                                  08100099
081100         WHEN OTHER                                               08110099
081200             MOVE -1 TO BSLECT1L                                  08120099
081300         END-EVALUATE                                             08130099
081400         MOVE PC-INVALID-SELECTION-MSG  TO BMSGLNO                08140099
081500         PERFORM 8100-SEND-DATA-ONLY                              08150099
081600         MOVE PC-SU-CHECK-IN-PRINT   TO PV-RETURN-TRANSID         08160099
081700         PERFORM 8200-RETURN-TRANID                               08170099
081800     END-EVALUATE.                                                08180099
081900                                                                  08190099
082000*----------------------------------------------------------------*08200099
082100*    VALIDATE PRINTER ID                                          08210099
082200*----------------------------------------------------------------*08220099
082300     IF SU001-PRINTER-ID = SPACES                                 08230099
082400         MOVE -1  TO  BPRNTIDL                                    08240099
082500     ELSE                                                         08250099
082600         PERFORM 1310-VALIDATE-PRINTER                            08260099
082700         IF DP072-PRTR-PRTR-TRK-STAT-CDE  EQUAL 'A'               08270099
082800*WR-9900                                                          08280099
082900             MOVE SU001-PRINTER-ID TO SU001-PRINTER-ID-USE        08290099
083000*WR-9900                                                          08300099
083100         ELSE                                                     08310099
083200             MOVE PM-INVALID-PRINTER-ID-MSG TO  BMSGLNO           08320099
083300             MOVE -1                        TO  BPRNTIDL          08330099
083400             PERFORM 8100-SEND-DATA-ONLY                          08340099
083500             MOVE PC-SU-CHECK-IN-PRINT      TO PV-RETURN-TRANSID  08350099
083600             PERFORM 8200-RETURN-TRANID                           08360099
083700         END-IF                                                   08370099
083800     END-IF.                                                      08380099
083900                                                                  08390099
084000                                                                  08400099
084100******************************************************************08410099
084200*  EDIT SCREEN ENTRY FIELDS                                      *08420099
084300******************************************************************08430099
084400 1200-EDIT-REPORT-SELECTION.                                      08440099
084500                                                                  08450099
084600     SET PS-VALID-SELECTION TO TRUE.                              08460099
084700                                                                  08470099
084800     PERFORM VARYING PV-SEL-IDX FROM +1 BY +1                     08480099
084900       UNTIL PV-SEL-IDX > +5                                      08490099
085000       OR PS-NOT-VALID-SELECTION                                  08500099
085100         IF CA-525-PRINT-RPT-IND (PV-SEL-IDX) = ' '               08510099
085200         OR CA-525-PRINT-RPT-IND (PV-SEL-IDX) = 'S'               08520099
085300             EVALUATE TRUE                                        08530099
085400             WHEN SU001-525-RPT-NUMBER (PV-SEL-IDX)               08540099
085500                 = PC-STAT-RPT-NUMBER                             08550099
085600                 MOVE CA-525-PRINT-RPT-IND (PV-SEL-IDX)           08560099
085700                     TO CA-525-STATISTICS-RPT-IND                 08570099
085800             WHEN SU001-525-RPT-NUMBER (PV-SEL-IDX)               08580099
085900                 = PC-WRKS-RPT-NUMBER                             08590099
086000                 MOVE CA-525-PRINT-RPT-IND (PV-SEL-IDX)           08600099
086100                     TO CA-525-WORKSHEET-RPT-IND                  08610099
086200             WHEN SU001-525-RPT-NUMBER (PV-SEL-IDX)               08620099
086300                 = PC-CRTN-RPT-NUMBER                             08630099
086400                 MOVE CA-525-PRINT-RPT-IND (PV-SEL-IDX)           08640099
086500                     TO SU001-525-CARTONS-RPT-IND                 08650099
086600             WHEN SU001-525-RPT-NUMBER (PV-SEL-IDX)               08660099
086700                 = PC-FREE-RPT-NUMBER                             08670099
086800                 MOVE CA-525-PRINT-RPT-IND (PV-SEL-IDX)           08680099
086900                     TO CA-525-FREE-ASTRAY-RPT-IND                08690099
087000             WHEN SU001-525-RPT-NUMBER (PV-SEL-IDX)               08700099
087100                 = PC-MSDR-RPT-NUMBER                             08710099
087200                 MOVE CA-525-PRINT-RPT-IND (PV-SEL-IDX)           08720099
087300                     TO CA-525-MISDIRECT-RPT-IND                  08730099
087400             WHEN SU001-525-RPT-NUMBER (PV-SEL-IDX)               08740099
087500                 = PC-DUPL-RPT-NUMBER                             08750099
087600                 MOVE CA-525-PRINT-RPT-IND (PV-SEL-IDX)           08760099
087700                     TO CA-525-DUPLICATE-RPT-IND                  08770099
087800             WHEN SU001-525-RPT-NUMBER (PV-SEL-IDX)               08780099
087900                 = PC-SCAN-RPT-NUMBER                             08790099
088000                 MOVE CA-525-PRINT-RPT-IND (PV-SEL-IDX)           08800099
088100                     TO SU001-525-SCAN-RPT-IND                    08810099
088200             WHEN SU001-525-RPT-NUMBER (PV-SEL-IDX)               08820099
088300                 = PC-ULBL-RPT-NUMBER                             08830099
088400                 MOVE CA-525-PRINT-RPT-IND (PV-SEL-IDX)           08840099
088500                     TO SU001-525-UNUSED-RPT-IND                  08850099
088600             WHEN OTHER                                           08860099
088700                 CONTINUE                                         08870099
088800             END-EVALUATE                                         08880099
088900         ELSE                                                     08890099
089000             SET PS-NOT-VALID-SELECTION TO TRUE                   08900099
089100         END-IF                                                   08910099
089200     END-PERFORM.                                                 08920099
089300                                                                  08930099
089400                                                                  08940099
089500***************************************************************** 08950099
089600*   1310-VALIDATE-PRINTER                                       * 08960099
089700* CALLS DPKCS060 TO VALIDATE THE PRINTER ID                     * 08970099
089800***************************************************************** 08980099
089900 1310-VALIDATE-PRINTER.                                           08990099
090000                                                                  09000099
090100     MOVE SU001-PRINTER-ID           TO DP072-PRINTER-ID.         09010099
090200     MOVE PC-REPORT-PGM              TO DP072-RPT-PGM-NME.        09020099
090300     MOVE PC-01                      TO DP072-RPT-PGM-TYP-ID.     09030099
090400     MOVE SU001-ORIGIN-OPER-UNT-ID   TO DP072-ORIGIN-OPER-UNT-ID. 09040099
090500     MOVE SU001-OPER-UNT-ID          TO DP072-OPER-UNT-ID.        09050099
090600     MOVE 1                          TO DP072-ORIGIN-FCLTY-ID     09060099
090700                                        DP072-FCLTY-ID.           09070099
090800     SET DP072-VALIDATE              TO TRUE.                     09080099
090900                                                                  09090099
091000     EXEC CICS                                                    09100099
091100          LINK PROGRAM  (PC-PRTR-VALIDATION-PGM)                  09110099
091200               COMMAREA (DP072-COMM-AREA)                         09120099
091300               RESP     (PV-CICS-RESPONSE)                        09130099
091400     END-EXEC                                                     09140099
091500                                                                  09150099
091600     EVALUATE TRUE                                                09160099
091700         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 09170099
091800              MOVE SU001-PRINTER-ID TO PV-PRINTER-DESTINATION     09180099
091900         WHEN OTHER                                               09190099
092000              MOVE '1310-VALIDATE-PRINTER'                        09200099
092100                                   TO DP013-PARAGRAPH             09210099
092200              MOVE PV-CICS-RESPONSE                               09220099
092300                                   TO DP013-MESSAGE-TEXT(1)       09230099
092400              SET DP013-LINK-RETURN                               09240099
092500                  DP013-CICS-ABEND                                09250099
092600                  DP013-NO-ROLLBACK TO TRUE                       09260099
092700              PERFORM DP014-0000-PROCESS-ABEND                    09270099
092800     END-EVALUATE.                                                09280099
092900                                                                  09290099
093000                                                                  09300099
093100*----------------------------------------------------------------*09310099
093200*    GET THE LOCATION OPER UNT ID FROM THE TEMP STORAGE QUEUE     09320099
093300*    THAT IS SET-UP IN THE ARCHITECTURE.                          09330099
093400*----------------------------------------------------------------*09340099
093500 2000-PROCESS-SELECTION.                                          09350099
093600                                                                  09360099
093700     PERFORM 2100-EDIT-PRINTER.                                   09370099
093800     PERFORM 2300-FIND-SYSTEM-ID.                                 09380099
093900     PERFORM 2400-FIND-LOGON-INFO.                                09390099
094000                                                                  09400099
094100     IF CA-525-STATISTICS-RPT-IND         = PC-S                  09410099
094200       AND CA-525-WORKSHEET-RPT-IND   NOT = PC-S                  09420099
094300       AND SU001-525-CARTONS-RPT-IND  NOT = PC-S                  09430099
094400       AND CA-525-MISDIRECT-RPT-IND   NOT = PC-S                  09440099
094500       AND CA-525-FREE-ASTRAY-RPT-IND NOT = PC-S                  09450099
094600       AND CA-525-DUPLICATE-RPT-IND   NOT = PC-S                  09460099
094700       AND SU001-525-SCAN-RPT-IND     NOT = PC-S                  09470099
094800       AND SU001-525-UNUSED-RPT-IND   NOT = PC-S                  09480099
094900         MOVE PC-STATISTIC-RPT-DESC TO PV-JOB-DESCRIPTION         09490099
095000         MOVE PC-STATISTIC-RPT-PROC TO PV-JOB-PROC                09500099
095100         MOVE PC-STATISTIC-RPT-JOB  TO PV-JOB-NAME                09510099
095200         PERFORM 4000-PRINT-REPORTS                               09520099
095300     ELSE                                                         09530099
095400         IF CA-525-STATISTICS-RPT-IND    = PC-S                   09540099
095500           OR CA-525-WORKSHEET-RPT-IND   = PC-S                   09550099
095600           OR SU001-525-CARTONS-RPT-IND  = PC-S                   09560099
095700           OR CA-525-MISDIRECT-RPT-IND   = PC-S                   09570099
095800           OR CA-525-FREE-ASTRAY-RPT-IND = PC-S                   09580099
095900           OR CA-525-DUPLICATE-RPT-IND   = PC-S                   09590099
096000           OR SU001-525-SCAN-RPT-IND     = PC-S                   09600099
096100           OR SU001-525-UNUSED-RPT-IND   = PC-S                   09610099
096200             MOVE PC-INDIVIDUAL-RPT-DESC TO PV-JOB-DESCRIPTION    09620099
096300             MOVE PC-INDIVIDUAL-RPT-PROC TO PV-JOB-PROC           09630099
096400             MOVE PC-INDIVIDUAL-RPT-JOB  TO PV-JOB-NAME           09640099
096500             PERFORM 4000-PRINT-REPORTS                           09650099
096600         ELSE                                                     09660099
096700             MOVE PC-NO-SELECTION-MADE-MSG                        09670099
096800                                         TO BMSGLNO               09680099
096900             MOVE -1 TO BSLECT1L                                  09690099
097000             PERFORM 8100-SEND-DATA-ONLY                          09700099
097100             MOVE PC-SU-CHECK-IN-PRINT   TO PV-RETURN-TRANSID     09710099
097200             PERFORM 8200-RETURN-TRANID                           09720099
097300         END-IF                                                   09730099
097400     END-IF.                                                      09740099
097500                                                                  09750099
097600                                                                  09760099
097700******************************************************************09770099
097800*    EDIT PRINTER SELECTION                                       09780099
097900******************************************************************09790099
098000  2100-EDIT-PRINTER.                                              09800099
098100                                                                  09810099
098200     IF SU001-PRINTER-ID = SPACES                                 09820099
098300         MOVE PM-PRINTER-ID-REQUIRED-MSG  TO  BMSGLNO             09830099
098400         MOVE -1                          TO  BPRNTIDL            09840099
098500         PERFORM 8100-SEND-DATA-ONLY                              09850099
098600         MOVE PC-SU-CHECK-IN-PRINT   TO PV-RETURN-TRANSID         09860099
098700         PERFORM 8200-RETURN-TRANID                               09870099
098800     ELSE                                                         09880099
098900         PERFORM 1310-VALIDATE-PRINTER                            09890099
099000             IF DP072-PRTR-PRTR-TRK-STAT-CDE  EQUAL 'A'           09900099
099100                NEXT SENTENCE                                     09910099
099200             ELSE                                                 09920099
099300                MOVE PM-INVALID-PRINTER-ID-MSG                    09930099
099400                                             TO  BMSGLNO          09940099
099500                MOVE -1                      TO  BPRNTIDL         09950099
099600                PERFORM 8100-SEND-DATA-ONLY                       09960099
099700                MOVE PC-SU-CHECK-IN-PRINT   TO PV-RETURN-TRANSID  09970099
099800                PERFORM 8200-RETURN-TRANID                        09980099
099900             END-IF                                               09990099
100000     END-IF.                                                      10000099
100100                                                                  10010099
100200*----------------------------------------------------------------*10020099
100300*                                                                *10030099
100400*----------------------------------------------------------------*10040099
100500 2300-FIND-SYSTEM-ID.                                             10050099
100600     EXEC CICS                                                    10060099
100700         INQUIRE                                                  10070099
100800             TRANSACTION   (PC-LOGON-TRAN-ID)                     10080099
100900             REMOTESYSTEM  (PV-SYSID)                             10090099
101000             RESP          (PV-CICS-RESPONSE)                     10100099
101100     END-EXEC.                                                    10110099
101200                                                                  10120099
101300     EVALUATE TRUE                                                10130099
101400         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 10140099
101500             CONTINUE                                             10150099
101600         WHEN OTHER                                               10160099
101700             MOVE '2300-FIND-SYSTEM-ID'                           10170099
101800                 TO DP013-PARAGRAPH                               10180099
101900             MOVE 'UNABLE TO DETERMINE SYSTEM ID'                 10190099
102000                 TO DP013-MESSAGE-TEXT (1)                        10200099
102100             SET DP013-CICS-ABEND      TO  TRUE                   10210099
102200             SET DP013-NO-ROLLBACK     TO  TRUE                   10220099
102300             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               10230099
102400             MOVE PC-CICS-ABEND-MSG    TO  BMSGLNO                10240099
102500             MOVE -1 TO BSLECT1L                                  10250099
102600             PERFORM 8100-SEND-DATA-ONLY                          10260099
102700             MOVE PC-SU-CHECK-IN-PRINT   TO PV-RETURN-TRANSID     10270099
102800             PERFORM 8200-RETURN-TRANID                           10280099
102900     END-EVALUATE.                                                10290099
103000                                                                  10300099
103100*----------------------------------------------------------------*10310099
103200*                                                                *10320099
103300*----------------------------------------------------------------*10330099
103400 2400-FIND-LOGON-INFO.                                            10340099
103500     MOVE LENGTH OF DP026-SIGN-ON-INFO                            10350099
103600                    TO  PV-SIGN-ON-INFO-LENGTH.                   10360099
103700     MOVE EIBTRMID  TO  TS-INFO-QUEUE-TERMINAL.                   10370099
103800     MOVE +1        TO  PV-TS-ITEM.                               10380099
103900                                                                  10390099
104000     IF PV-SYSID = SPACES                                         10400099
104100         EXEC CICS                                                10410099
104200             READQ TS                                             10420099
104300                 QUEUE  (TS-INFO-QUEUE-NAME)                      10430099
104400                 ITEM   (PV-TS-ITEM)                              10440099
104500                 INTO   (DP026-SIGN-ON-INFO)                      10450099
104600                 RESP   (PV-CICS-RESPONSE)                        10460099
104700         END-EXEC                                                 10470099
104800     ELSE                                                         10480099
104900         EXEC CICS                                                10490099
105000             READQ TS                                             10500099
105100                 QUEUE   (TS-INFO-QUEUE-NAME)                     10510099
105200                 SYSID   (PV-SYSID)                               10520099
105300                 ITEM    (PV-TS-ITEM)                             10530099
105400                 INTO    (DP026-SIGN-ON-INFO)                     10540099
105500                 LENGTH  (PV-SIGN-ON-INFO-LENGTH)                 10550099
105600                 RESP    (PV-CICS-RESPONSE)                       10560099
105700         END-EXEC                                                 10570099
105800     END-IF.                                                      10580099
105900                                                                  10590099
106000     EVALUATE TRUE                                                10600099
106100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 10610099
106200             CONTINUE                                             10620099
106300         WHEN OTHER                                               10630099
106400             MOVE '2400-FIND-LOGON-INFO'                          10640099
106500                 TO DP013-PARAGRAPH                               10650099
106600             MOVE 'UNABLE TO READ LOGON TSQ'                      10660099
106700                 TO DP013-MESSAGE-TEXT (1)                        10670099
106800             SET DP013-CICS-ABEND     TO TRUE                     10680099
106900             SET DP013-NO-ROLLBACK    TO TRUE                     10690099
107000             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               10700099
107100             MOVE PC-CICS-ABEND-MSG    TO  BMSGLNO                10710099
107200             SET SU001-PROCESS-SCREEN  TO TRUE                    10720099
107300             MOVE -1 TO BSLECT1L                                  10730099
107400             PERFORM 8100-SEND-DATA-ONLY                          10740099
107500             MOVE PC-SU-CHECK-IN-PRINT   TO PV-RETURN-TRANSID     10750099
107600             PERFORM 8200-RETURN-TRANID                           10760099
107700     END-EVALUATE.                                                10770099
107800                                                                  10780099
107900                                                                  10790099
108000*----------------------------------------------------------------*10800099
108100* TRANSFER CONTROL TO ANOTHER PROGRAM                            *10810099
108200*----------------------------------------------------------------*10820099
108300 3000-XCTL-TO-SELECTED-PROGRAM.                                   10830099
108400                                                                  10840099
108500     SET SU001-INITIALIZE-SCREEN     TO TRUE.                     10850099
108600     MOVE PC-CURRENT-PROGRAM-NAME    TO SU001-LAST-PROGRAM.       10860099
108700                                                                  10870099
108900     MOVE LENGTH OF CA-COMMAREA  TO PV-COMMAREA-LENGTH.           10890099
109000     EXEC CICS                                                    10900099
109100         XCTL                                                     10910099
109200             PROGRAM   (PV-TRANSFER-PROGRAM)                      10920099
109300             COMMAREA  (CA-COMMAREA)                              10930099
109500             LENGTH    (PV-COMMAREA-LENGTH)                       10950099
109600             RESP      (PV-CICS-RESPONSE)                         10960099
109700     END-EXEC.                                                    10970099
109800                                                                  10980099
109900     EVALUATE TRUE                                                10990099
110000      WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                    11000099
110100           CONTINUE                                               11010099
110200      WHEN OTHER                                                  11020099
110300           MOVE '3000-XCTL-TO-SELECTED-PROGRAM'                   11030099
110400                                  TO DP013-PARAGRAPH              11040099
110500           MOVE 'UNABLE TO XCTL THE FOLLOWING PROGRAM: '          11050099
110600                                  TO DP013-MESSAGE-TEXT (1)       11060099
110700           MOVE PV-TRANSFER-PROGRAM                               11070099
110800                                  TO DP013-MESSAGE-TEXT (2)       11080099
110900           SET DP013-CICS-ABEND   TO TRUE                         11090099
111000           SET DP013-NO-ROLLBACK  TO TRUE                         11100099
111100           PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                 11110099
111200           MOVE PC-TRANS-UNAVAILABLE-MSG  TO  BMSGLNO             11120099
111300           SET SU001-PROCESS-SCREEN       TO TRUE                 11130099
111400           MOVE -1 TO BSLECT1L                                    11140099
111500           PERFORM 8100-SEND-DATA-ONLY                            11150099
111600           MOVE PC-SU-CHECK-IN-PRINT   TO PV-RETURN-TRANSID       11160099
111700           PERFORM 8200-RETURN-TRANID                             11170099
111800     END-EVALUATE.                                                11180099
111900                                                                  11190099
112000                                                                  11200099
112100*----------------------------------------------------------------*11210099
112200*    START JOB WHICH WILL CREATE REPORTS                         *11220099
112300*----------------------------------------------------------------*11230099
112400 4000-PRINT-REPORTS.                                              11240099
112500     PERFORM 9000-SUBMIT-REQUEST.                                 11250099
112600     MOVE PC-TRAILER-STOP-PGM    TO PV-TRANSFER-PROGRAM.          11260099
112700     PERFORM 3000-XCTL-TO-SELECTED-PROGRAM.                       11270099
112800                                                                  11280099
112900                                                                  11290099
113000****************************************************************  11300099
113100* 5000-SETUP-F7-F8-SCREEN                                         11310099
113200*    SETUP THE SCROLLING REPORT SELECTION LIST                    11320099
113300****************************************************************  11330099
113400 5000-SETUP-F7-F8-SCREEN.                                         11340099
113500                                                                  11350099
113600     MOVE +1 TO PV-SEL-IDX.                                       11360099
113700                                                                  11370099
113800     IF EIBAID = DFHPF7                                           11380099
113900         IF  SU001-525-RPT-DESC (PV-SEL-IDX) = PC-STAT-RPT-DESC   11390099
114000         AND SU001-525-RPT-NUMBER (PV-SEL-IDX)                    11400099
114100                                            = PC-STAT-RPT-NUMBER  11410099
114200             CONTINUE                                             11420099
114300         ELSE                                                     11430099
114400             INITIALIZE SU001-525-SCREEN-SELECTION-TBL            11440099
114500             MOVE CA-525-STATISTICS-RPT-IND                       11450099
114600                 TO CA-525-PRINT-RPT-IND (PV-SEL-IDX)             11460099
114700             MOVE PC-STAT-RPT-DESC                                11470099
114800                 TO SU001-525-RPT-DESC (PV-SEL-IDX)               11480099
114900             MOVE PC-STAT-RPT-NUMBER                              11490099
115000                 TO SU001-525-RPT-NUMBER (PV-SEL-IDX)             11500099
115100             ADD +1 TO PV-SEL-IDX                                 11510099
115200             MOVE CA-525-WORKSHEET-RPT-IND                        11520099
115300                 TO CA-525-PRINT-RPT-IND (PV-SEL-IDX)             11530099
115400             MOVE PC-WRKS-RPT-DESC                                11540099
115500                 TO SU001-525-RPT-DESC (PV-SEL-IDX)               11550099
115600             MOVE PC-WRKS-RPT-NUMBER                              11560099
115700                 TO SU001-525-RPT-NUMBER (PV-SEL-IDX)             11570099
115800             ADD +1 TO PV-SEL-IDX                                 11580099
115900             MOVE SU001-525-CARTONS-RPT-IND                       11590099
116000                 TO CA-525-PRINT-RPT-IND (PV-SEL-IDX)             11600099
116100             MOVE PC-CRTN-RPT-DESC                                11610099
116200                 TO SU001-525-RPT-DESC (PV-SEL-IDX)               11620099
116300             MOVE PC-CRTN-RPT-NUMBER                              11630099
116400                 TO SU001-525-RPT-NUMBER (PV-SEL-IDX)             11640099
116500             ADD +1 TO PV-SEL-IDX                                 11650099
116600             MOVE CA-525-FREE-ASTRAY-RPT-IND                      11660099
116700                 TO CA-525-PRINT-RPT-IND (PV-SEL-IDX)             11670099
116800             MOVE PC-FREE-RPT-DESC                                11680099
116900                 TO SU001-525-RPT-DESC (PV-SEL-IDX)               11690099
117000             MOVE PC-FREE-RPT-NUMBER                              11700099
117100                 TO SU001-525-RPT-NUMBER (PV-SEL-IDX)             11710099
117200             ADD +1 TO PV-SEL-IDX                                 11720099
117300             MOVE CA-525-MISDIRECT-RPT-IND                        11730099
117400                 TO CA-525-PRINT-RPT-IND (PV-SEL-IDX)             11740099
117500             MOVE PC-MSDR-RPT-DESC                                11750099
117600                 TO SU001-525-RPT-DESC (PV-SEL-IDX)               11760099
117700             MOVE PC-MSDR-RPT-NUMBER                              11770099
117800                 TO SU001-525-RPT-NUMBER (PV-SEL-IDX)             11780099
117900         END-IF                                                   11790099
118000     END-IF.                                                      11800099
118100                                                                  11810099
118200     IF EIBAID = DFHPF8                                           11820099
118300         IF  SU001-525-RPT-DESC (PV-SEL-IDX) = PC-DUPL-RPT-DESC   11830099
118400         AND SU001-525-RPT-NUMBER (PV-SEL-IDX)                    11840099
118500                                            = PC-DUPL-RPT-NUMBER  11850099
118600             CONTINUE                                             11860099
118700         ELSE                                                     11870099
118800             INITIALIZE SU001-525-SCREEN-SELECTION-TBL            11880099
118900             MOVE CA-525-DUPLICATE-RPT-IND                        11890099
119000                 TO CA-525-PRINT-RPT-IND (PV-SEL-IDX)             11900099
119100             MOVE PC-DUPL-RPT-DESC                                11910099
119200                 TO SU001-525-RPT-DESC (PV-SEL-IDX)               11920099
119300             MOVE PC-DUPL-RPT-NUMBER                              11930099
119400                 TO SU001-525-RPT-NUMBER (PV-SEL-IDX)             11940099
119500             ADD +1 TO PV-SEL-IDX                                 11950099
119600             MOVE SU001-525-SCAN-RPT-IND                          11960099
119700                 TO CA-525-PRINT-RPT-IND (PV-SEL-IDX)             11970099
119800             MOVE PC-SCAN-RPT-DESC                                11980099
119900                 TO SU001-525-RPT-DESC (PV-SEL-IDX)               11990099
120000             MOVE PC-SCAN-RPT-NUMBER                              12000099
120100                 TO SU001-525-RPT-NUMBER (PV-SEL-IDX)             12010099
120200             ADD +1 TO PV-SEL-IDX                                 12020099
120300             MOVE SU001-525-UNUSED-RPT-IND                        12030099
120400                 TO CA-525-PRINT-RPT-IND (PV-SEL-IDX)             12040099
120500             MOVE PC-ULBL-RPT-DESC                                12050099
120600                 TO SU001-525-RPT-DESC   (PV-SEL-IDX)             12060099
120700             MOVE PC-ULBL-RPT-NUMBER                              12070099
120800                 TO SU001-525-RPT-NUMBER (PV-SEL-IDX)             12080099
120900         END-IF                                                   12090099
121000     END-IF.                                                      12100099
121100                                                                  12110099
121200     PERFORM 0200-MOVE-TO-SCREEN.                                 12120099
121300                                                                  12130099
121400                                                                  12140099
121500*----------------------------------------------------------------*12150099
121600*  SEND "CHECK-IN PRINT RQST" SCREEN                             *12160099
121700*----------------------------------------------------------------*12170099
121800 8000-SEND-MAP-IND.                                               12180099
121900                                                                  12190099
122000     MOVE -1 TO BSLECT1L.                                         12200099
122100                                                                  12210099
122200     EXEC CICS                                                    12220099
122300         SEND MAP       ('SU525B')                                12230099
122400              MAPSET    ('SUKM525')                               12240099
122500              CURSOR                                              12250099
122600              ERASE                                               12260099
122700              RESP      (PV-CICS-RESPONSE)                        12270099
122800     END-EXEC.                                                    12280099
122900                                                                  12290099
123000     EVALUATE TRUE                                                12300099
123100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 12310099
123200              CONTINUE                                            12320099
123300         WHEN OTHER                                               12330099
123400              MOVE '8000-SEND-MAP-IND'   TO DP013-PARAGRAPH       12340099
123500              MOVE 'UNABLE TO SEND MAP'                           12350099
123600                                     TO DP013-MESSAGE-TEXT (1)    12360099
123700              SET DP013-CICS-ABEND   TO TRUE                      12370099
123800              SET DP013-NO-ROLLBACK  TO TRUE                      12380099
123900              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              12390099
124000     END-EVALUATE.                                                12400099
124100                                                                  12410099
124200*----------------------------------------------------------------*12420099
124300*  SEND "TRAILER STOP" MENU SCREEN                               *12430099
124400*----------------------------------------------------------------*12440099
124500 8050-SEND-MAP-TRAILER.                                           12450099
124600                                                                  12460099
124700     EXEC CICS                                                    12470099
124800         SEND MAP       ('SU503A')                                12480099
124900              MAPSET    ('SUKM503')                               12490099
125000              ERASE                                               12500099
125100              RESP      (PV-CICS-RESPONSE)                        12510099
125200     END-EXEC.                                                    12520099
125300                                                                  12530099
125400     EVALUATE TRUE                                                12540099
125500         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 12550099
125600              CONTINUE                                            12560099
125700         WHEN OTHER                                               12570099
125800              MOVE '8050-SEND-MAP-TRAILER'   TO DP013-PARAGRAPH   12580099
125900              MOVE 'UNABLE TO SEND MAP'                           12590099
126000                                     TO DP013-MESSAGE-TEXT (1)    12600099
126100              SET DP013-CICS-ABEND   TO TRUE                      12610099
126200              SET DP013-NO-ROLLBACK  TO TRUE                      12620099
126300              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              12630099
126400     END-EVALUATE.                                                12640099
126500                                                                  12650099
126600                                                                  12660099
126700*----------------------------------------------------------------*12670099
126800*                                                                *12680099
126900*----------------------------------------------------------------*12690099
127000 8100-SEND-DATA-ONLY.                                             12700099
127100                                                                  12710099
127200     EXEC CICS                                                    12720099
127300         SEND MAP       ('SU525B')                                12730099
127400              MAPSET    ('SUKM525')                               12740099
127500              CURSOR                                              12750099
127600              DATAONLY                                            12760099
127700              RESP      (PV-CICS-RESPONSE)                        12770099
127800     END-EXEC.                                                    12780099
127900                                                                  12790099
128000     EVALUATE TRUE                                                12800099
128100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 12810099
128200              CONTINUE                                            12820099
128300         WHEN OTHER                                               12830099
128400              MOVE '8100-SEND-DATA-ONLY'                          12840099
128500                                     TO DP013-PARAGRAPH           12850099
128600              MOVE 'UNABLE TO SEND DATA'                          12860099
128700                                     TO DP013-MESSAGE-TEXT (1)    12870099
128800              SET DP013-CICS-ABEND   TO TRUE                      12880099
128900              SET DP013-NO-ROLLBACK  TO TRUE                      12890099
129000              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              12900099
129100     END-EVALUATE.                                                12910099
129200                                                                  12920099
129300                                                                  12930099
129400*----------------------------------------------------------------*12940099
129500* RETURN CONTROL - AFTER SEND MAP                                *12950099
129600*----------------------------------------------------------------*12960099
129700 8200-RETURN-TRANID.                                              12970099
129800                                                                  12980099
129900     MOVE LENGTH OF CA-COMMAREA     TO PV-COMMAREA-LENGTH.        12990099
130000     EXEC CICS                                                    13000099
130100         RETURN TRANSID   (PV-RETURN-TRANSID)                     13010099
130200                COMMAREA  (CA-COMMAREA)                           13020099
130400                LENGTH    (PV-COMMAREA-LENGTH)                    13040099
130500                RESP      (PV-CICS-RESPONSE)                      13050099
130600     END-EXEC.                                                    13060099
130700                                                                  13070099
130800     EVALUATE TRUE                                                13080099
130900         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 13090099
131000              CONTINUE                                            13100099
131100         WHEN OTHER                                               13110099
131200              MOVE '8200-RETURN-TRANID'                           13120099
131300                                     TO DP013-PARAGRAPH           13130099
131400              MOVE 'UNABLE TO RETURN TO TRANID'                   13140099
131500                                     TO DP013-MESSAGE-TEXT (1)    13150099
131600              SET DP013-CICS-ABEND   TO TRUE                      13160099
131700              SET DP013-NO-ROLLBACK  TO TRUE                      13170099
131800              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              13180099
131900     END-EVALUATE.                                                13190099
132000                                                                  13200099
132100*----------------------------------------------------------------*13210099
132200*                                                                *13220099
132300*----------------------------------------------------------------*13230099
132400 9000-SUBMIT-REQUEST.                                             13240099
132500                                                                  13250099
132600     EXEC CICS ASSIGN                                             13260099
132700               APPLID(PV-SYSTEM-ID)                               13270099
132800               USERID(SU001-USER-ID)                              13280099
132900     END-EXEC.                                                    13290099
133000                                                                  13300099
133100     PERFORM 9500-ENQUEUE-INTERNAL-READER.                        13310099
133200                                                                  13320099
133300*-----------------------------------------------------------------13330099
133400* PROD/LEARN JCL SETUP                                            13340099
133500*     //SUK945   JOB KOHLS,'STATISTIC RPT',MSGCLASS=P,CLASS=Q     13350099
133600*     /*JOBPARM K=O                                               13360099
133700*     //JOBOUT01 OUTPUT FORMS=STD,FCB=8S                          13370099
133800*     //JOBLIB   DD DSN=PKMO.LOADLIB,DISP=SHR                     13380099
134000*     //PS020    EXEC SUK9451                                     13400099
134100*     //S010.SYSUT1 DD *                                          13410099
134200*     XXXXXXXXX                                                   13420099
134300*     //S035.SYSUT1 DD *                                          13430099
134400*     PPPPPPPPI0 C                                                13440099
134500*     //$AUTO    EXEC PGM=$A,COND=(0,LE),PARM='>'                 13450099
134600*     /*EOF                                                       13460099
134700*-----------------------------------------------------------------13470099
134800* TEST JCL SETUP                                                  13480099
134900*     //XXXXXXXQ JOB KOHLS,'STATISTIC RPT',MSGCLASS=X,CLASS=E     13490099
135000*     //JOBOUT01 OUTPUT FORMS=STD,FCB=8S                          13500099
135100*     //JOBLIB   DD DSN=TKMA.LOADLIB,DISP=SHR                     13510099
135200*     //PS020    EXEC SUK9451T                                    13520099
135300*     //S010.SYSUT1 DD *                                          13530099
135400*     XXXXXXXXX                                                   13540099
135500*     //S035.SYSUT1 DD *                                          13550099
135600*     PPPPPPPPI0 C                                                13560099
135700*     //$AUTO    EXEC PGM=$A,COND=(0,LE),PARM='>'                 13570099
135800*     /*EOF                                                       13580099
135900*-----------------------------------------------------------------13590099
136000                                                                  13600099
136100     IF PV-PROD-CICS                                              13610099
136300          MOVE PV-JOB-NAME            TO  JL-PROD-JOB-NAME        13630099
136400          MOVE PV-JOB-DESCRIPTION     TO  JL-PROD-JOB-DESC        13640099
136500          MOVE JL-JOB-LINE-PROD       TO  JL-JCL-LINE-1           13650099
136600          MOVE JL-JCL-LINE-1          TO  TD-JCL-LINE             13660099
136700          PERFORM 9100-WRITE-TD-LINE                              13670099
136800          MOVE JL-JCL-LINE-3          TO  TD-JCL-LINE             13680099
136900          PERFORM 9100-WRITE-TD-LINE                              13690099
137000*         MOVE PV-PRINTER-DESTINATION TO  JL-LINE-13-PRINTER      13700099
137100          MOVE SU001-PRINTER-ID       TO  JL-LINE-13-PRINTER      13710099
137200          MOVE JL-JCL-LINE-13         TO  TD-JCL-LINE             13720099
137300          PERFORM 9100-WRITE-TD-LINE                              13730099
137400          MOVE JL-JCL-LINE-4-PROD     TO  TD-JCL-LINE             13740099
137500          PERFORM 9100-WRITE-TD-LINE                              13750099
137800          MOVE PV-JOB-PROC            TO  JL-LINE-12-PROC         13780099
137900          MOVE ' '                    TO  JL-LINE-12-PROC-T       13790099
138000          MOVE JL-JCL-LINE-12         TO  TD-JCL-LINE             13800099
138100          PERFORM 9100-WRITE-TD-LINE                              13810099
138200     ELSE                                                         13820099
138300        IF PV-TEST-CICS                                           13830099
138400           MOVE SU001-USER-ID          TO  JL-TEST-JOB-NAME       13840099
138500           MOVE PV-JOB-DESCRIPTION     TO  JL-TEST-JOB-DESC       13850099
138600           MOVE JL-JOB-LINE-TEST       TO  JL-JCL-LINE-1          13860099
138700           MOVE JL-JCL-LINE-1          TO  TD-JCL-LINE            13870099
138800           PERFORM 9100-WRITE-TD-LINE                             13880099
138900*          MOVE PV-PRINTER-DESTINATION TO  JL-LINE-13-PRINTER     13890099
139000           MOVE SU001-PRINTER-ID       TO  JL-LINE-13-PRINTER     13900099
139100           MOVE JL-JCL-LINE-13         TO  TD-JCL-LINE            13910099
139200           PERFORM 9100-WRITE-TD-LINE                             13920099
139300                                                                  13930099
139400           MOVE JL-JCL-LINE-4-TEST     TO  TD-JCL-LINE            13940099
139500           PERFORM 9100-WRITE-TD-LINE                             13950099
139600           MOVE PV-JOB-PROC            TO  JL-LINE-12-PROC        13960099
139700           MOVE PC-TEST                TO  JL-LINE-12-PROC-T      13970099
139800           MOVE JL-JCL-LINE-12         TO  TD-JCL-LINE            13980099
139900           PERFORM 9100-WRITE-TD-LINE                             13990099
140000        ELSE                                                      14000099
140100           IF PV-QA-CICS                                          14010099
140200              MOVE SU001-USER-ID          TO  JL-TEST-JOB-NAME    14020099
140300              MOVE PV-JOB-DESCRIPTION     TO  JL-TEST-JOB-DESC    14030099
140400              MOVE JL-JOB-LINE-TEST       TO  JL-JCL-LINE-1       14040099
140500              MOVE JL-JCL-LINE-1          TO  TD-JCL-LINE         14050099
140600              PERFORM 9100-WRITE-TD-LINE                          14060099
140700*             MOVE PV-PRINTER-DESTINATION TO  JL-LINE-13-PRINTER  14070099
140800              MOVE SU001-PRINTER-ID       TO  JL-LINE-13-PRINTER  14080099
140900              MOVE JL-JCL-LINE-13         TO  TD-JCL-LINE         14090099
141000              PERFORM 9100-WRITE-TD-LINE                          14100099
141100                                                                  14110099
141200              MOVE JL-JCL-LINE-4-QA       TO  TD-JCL-LINE         14120099
141300              PERFORM 9100-WRITE-TD-LINE                          14130099
141400              MOVE PV-JOB-PROC            TO  JL-LINE-12-PROC     14140099
141500              MOVE PC-QA                  TO  JL-LINE-12-PROC-T   14150099
141600              MOVE JL-JCL-LINE-12         TO  TD-JCL-LINE         14160099
141700              PERFORM 9100-WRITE-TD-LINE                          14170099
141710           ELSE                                                   14171099
141720              IF PV-LEARN-CICS                                    14172099
141730                 MOVE SU001-USER-ID          TO  JL-TEST-JOB-NAME 14173099
141740                 MOVE PV-JOB-DESCRIPTION     TO  JL-TEST-JOB-DESC 14174099
141750                 MOVE JL-JOB-LINE-TEST       TO  JL-JCL-LINE-1    14175099
141760                 MOVE JL-JCL-LINE-1          TO  TD-JCL-LINE      14176099
141770                 PERFORM 9100-WRITE-TD-LINE                       14177099
141780*                MOVE PV-PRINTER-DESTINATION TO JL-LINE-13-PRINTER14178099
141790                 MOVE SU001-PRINTER-ID       TO JL-LINE-13-PRINTER14179099
141791                 MOVE JL-JCL-LINE-13         TO  TD-JCL-LINE      14179199
141792                 PERFORM 9100-WRITE-TD-LINE                       14179299
141793                                                                  14179399
141794                 MOVE JL-JCL-LINE-4-LEARN    TO  TD-JCL-LINE      14179499
141795                 PERFORM 9100-WRITE-TD-LINE                       14179599
141796                 MOVE PV-JOB-PROC            TO  JL-LINE-12-PROC  14179699
141797                 MOVE PC-LEARN               TO  JL-LINE-12-PROC-T14179799
141798                 MOVE JL-JCL-LINE-12         TO  TD-JCL-LINE      14179899
141799                 PERFORM 9100-WRITE-TD-LINE                       14179999
141800              END-IF                                              14180099
141810           END-IF                                                 14181099
141900        END-IF                                                    14190099
142000     END-IF.                                                      14200099
142100                                                                  14210099
142200     MOVE JL-JCL-LINE-14              TO  TD-JCL-LINE.            14220099
142300     PERFORM 9100-WRITE-TD-LINE.                                  14230099
142400                                                                  14240099
142500     MOVE SU001-MANIFEST              TO  JL-LINE-15-MANIFEST.    14250099
142600*LMM                                                              14260099
142700     MOVE SU001-USER-ID               TO  JL-LINE-15-USER-ID.     14270099
142800     MOVE SU001-RQST-TMST             TO  JL-LINE-15-TIMESTMP.    14280099
142900     MOVE JL-JCL-LINE-15              TO  TD-JCL-LINE.            14290099
143000     PERFORM 9100-WRITE-TD-LINE.                                  14300099
143100                                                                  14310099
143200     MOVE JL-JCL-LINE-16              TO  TD-JCL-LINE.            14320099
143300     PERFORM 9100-WRITE-TD-LINE.                                  14330099
143400                                                                  14340099
143500*    MOVE PV-PRINTER-DESTINATION      TO  JL-LINE-17-PRINTER.     14350099
143600     MOVE SU001-PRINTER-ID            TO  JL-LINE-17-PRINTER.     14360099
143700     MOVE DP072-PRTR-PRTR-CNTL-IND    TO  JL-LINE-17-PRTR-IND.    14370099
143800     MOVE DP072-PRTR-TRACK-NBR        TO  JL-LINE-17-TRACK-NBR.   14380099
143900     MOVE 'C'                         TO  JL-LINE-17-CUT-RPT.     14390099
144000     MOVE SU001-USER-ID               TO  JL-LINE-17-USER-ID.     14400099
144100     IF CA-525-STATISTICS-RPT-IND = PC-S                          14410099
144200         MOVE PC-Y                    TO  JL-LINE-17-STAT-RPT     14420099
144300     ELSE                                                         14430099
144400         MOVE SPACES                  TO  JL-LINE-17-STAT-RPT     14440099
144500     END-IF.                                                      14450099
144600     IF SU001-525-CARTONS-RPT-IND  = PC-S                         14460099
144700         MOVE PC-Y                    TO  JL-LINE-17-CRTN-RPT     14470099
144800     ELSE                                                         14480099
144900         MOVE SPACES                  TO  JL-LINE-17-CRTN-RPT     14490099
145000     END-IF.                                                      14500099
145100     IF CA-525-FREE-ASTRAY-RPT-IND = PC-S                         14510099
145200         MOVE PC-Y                    TO  JL-LINE-17-FREE-RPT     14520099
145300     ELSE                                                         14530099
145400         MOVE SPACES                  TO  JL-LINE-17-FREE-RPT     14540099
145500     END-IF.                                                      14550099
145600     IF CA-525-MISDIRECT-RPT-IND = PC-S                           14560099
145700         MOVE PC-Y                    TO  JL-LINE-17-MSDR-RPT     14570099
145800     ELSE                                                         14580099
145900         MOVE SPACES                  TO  JL-LINE-17-MSDR-RPT     14590099
146000     END-IF.                                                      14600099
146100     IF CA-525-DUPLICATE-RPT-IND = PC-S                           14610099
146200         MOVE PC-Y                    TO  JL-LINE-17-DUPL-RPT     14620099
146300     ELSE                                                         14630099
146400         MOVE SPACES                  TO  JL-LINE-17-DUPL-RPT     14640099
146500     END-IF.                                                      14650099
146600     IF CA-525-WORKSHEET-RPT-IND = PC-S                           14660099
146700         MOVE PC-Y                    TO  JL-LINE-17-WRKS-RPT     14670099
146800     ELSE                                                         14680099
146900         MOVE SPACES                  TO  JL-LINE-17-WRKS-RPT     14690099
147000     END-IF.                                                      14700099
147100     IF SU001-525-SCAN-RPT-IND    = PC-S                          14710099
147200         MOVE PC-Y                    TO  JL-LINE-17-SCAN-RPT     14720099
147300     ELSE                                                         14730099
147400         MOVE SPACES                  TO  JL-LINE-17-SCAN-RPT     14740099
147500     END-IF.                                                      14750099
147600     IF SU001-525-UNUSED-RPT-IND  = PC-S                          14760099
147700         MOVE PC-Y                    TO  JL-LINE-17-ULBL-RPT     14770099
147800     ELSE                                                         14780099
147900         MOVE SPACES                  TO  JL-LINE-17-ULBL-RPT     14790099
148000     END-IF.                                                      14800099
148100*LMM                                                              14810099
148200     MOVE SU001-ALL-PO-IND            TO  JL-LINE-17-ALL-PO-IND.  14820099
148300     MOVE JL-JCL-LINE-17              TO  TD-JCL-LINE.            14830099
148400     PERFORM 9100-WRITE-TD-LINE.                                  14840099
148500                                                                  14850099
148600*    MOVE JL-JCL-LINE-AUTO-SCHD       TO  TD-JCL-LINE.            14860099
148700*    PERFORM 9100-WRITE-TD-LINE.                                  14870099
148800                                                                  14880099
148900     MOVE JL-JCL-LINE-EOF             TO  TD-JCL-LINE.            14890099
149000     PERFORM 9100-WRITE-TD-LINE.                                  14900099
149100                                                                  14910099
149200     PERFORM 9600-DEQUEUE-INTERNAL-READER.                        14920099
149300                                                                  14930099
149400     SET  SU001-RPT-REQUESTED          TO  TRUE.                  14940099
149500     MOVE PV-PRINTER-DESTINATION       TO  PC-MSG-PRTR-ID.        14950099
149600     MOVE PC-REPORT-SENT-MSG           TO  BMSGLNO.               14960099
149700     MOVE -1                           TO  BSLECT1L.              14970099
149800     PERFORM 8100-SEND-DATA-ONLY.                                 14980099
149900                                                                  14990099
150000                                                                  15000099
150100*----------------------------------------------------------------*15010099
150200*  WRITE A JCL LINE TO THE TRANSIENT DATA QUEUE FOR THE INTERNAL *15020099
150300*  READER.  ON ANY ERROR, DEQUEUE THE INTERNAL READER, DELETE    *15030099
150400*  THE TEMPORARY STORAGE QUEUE (TO PREVENT OLD REQUEST           *15040099
150500*  INFORMATION FROM ACCIDENTALLY APPEARING ON A FUTURE REQUEST), *15050099
150600*  FORMAT AND DISPLAY AN ERROR MESSAGE, AND RETURN TO NATIVE     *15060099
150700*  CICS.                                                         *15070099
150800*----------------------------------------------------------------*15080099
150900 9100-WRITE-TD-LINE.                                              15090099
151000     EXEC CICS                                                    15100099
151100         WRITEQ TD                                                15110099
151200             QUEUE(TD-QUEUE-NAME)                                 15120099
151300             FROM(TD-JCL-LINE)                                    15130099
151400             LENGTH(TD-JCL-LINE-LENGTH)                           15140099
151500             RESP(PV-CICS-RESPONSE)                               15150099
151600     END-EXEC.                                                    15160099
151700                                                                  15170099
151800     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    15180099
151900         SET PS-ABEND-IN-PROGRESS TO TRUE                         15190099
152000         STRING 'WRITE TO TRANSIENT DATA QUEUE '                  15200099
152100                                                DELIMITED BY SIZE 15210099
152200                TD-QUEUE-NAME                   DELIMITED BY SIZE 15220099
152300                ' (INTERNAL READER)'            DELIMITED BY SIZE 15230099
152400             INTO SE-ATTEMPTED-ACTION                             15240099
152500         MOVE PV-CICS-RESPONSE TO SE-CICS-RESPONSE                15250099
152600         MOVE SE-SYSTEM-ERROR-MESSAGE TO PV-LEAVE-SYSTEM-MESSAGE  15260099
152700         PERFORM 9600-DEQUEUE-INTERNAL-READER                     15270099
152800         PERFORM 9900-LEAVE-SYSTEM                                15280099
152900     END-IF.                                                      15290099
153000                                                                  15300099
153100                                                                  15310099
153200*----------------------------------------------------------------*15320099
153300*  ENQUEUE THE TRANSIENT DATA QUEUE FOR THE INTERNAL READER.     *15330099
153400*  THIS WILL PREVENT INTERLEAVING OF JCL SUBMITTED CONCURRENTLY  *15340099
153500*  BY MULTIPLE USERS.  IF THE QUEUE IS BUSY, THIS PROGRAM WILL   *15350099
153600*  WAIT TO ENQUEUE IT, BY NOT SPECIFICALLY HANDLING THE QBUSY    *15360099
153700*  CONDITION.  IF ANY OTHER ERRORS OCCUR, DELETE THE TEMPORARY   *15370099
153800*  STORAGE QUEUE (TO PREVENT OLD REQUEST INFORMATION FROM        *15380099
153900*  ACCIDENTALLY APPEARING ON A FUTURE REQUEST), FORMAT AND       *15390099
154000*  DISPLAY AN ERROR MESSAGE, AND RETURN TO NATIVE CICS.          *15400099
154100*----------------------------------------------------------------*15410099
154200 9500-ENQUEUE-INTERNAL-READER.                                    15420099
154300     EXEC CICS                                                    15430099
154400         ENQ                                                      15440099
154500             RESOURCE(TD-QUEUE-NAME)                              15450099
154600             LENGTH(TD-QUEUE-NAME-LENGTH)                         15460099
154700             RESP(PV-CICS-RESPONSE)                               15470099
154800     END-EXEC.                                                    15480099
154900                                                                  15490099
155000     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    15500099
155100         SET PS-ABEND-IN-PROGRESS TO TRUE                         15510099
155200         STRING 'ENQUEUE '            DELIMITED BY SIZE           15520099
155300                TD-QUEUE-NAME         DELIMITED BY SIZE           15530099
155400                ' (INTERNAL READER)'  DELIMITED BY SIZE           15540099
155500             INTO SE-ATTEMPTED-ACTION                             15550099
155600         MOVE PV-CICS-RESPONSE TO SE-CICS-RESPONSE                15560099
155700         MOVE SE-SYSTEM-ERROR-MESSAGE TO PV-LEAVE-SYSTEM-MESSAGE  15570099
155800         PERFORM 9900-LEAVE-SYSTEM                                15580099
155900     END-IF.                                                      15590099
156000                                                                  15600099
156100     SET PS-INTERNAL-READER-ENQUEUED TO TRUE.                     15610099
156200                                                                  15620099
156300                                                                  15630099
156400*----------------------------------------------------------------*15640099
156500*  DEQUEUE THE TRANSIENT DATA QUEUE FOR THE INTERNAL READER.     *15650099
156600*  THIS SHOULD BE DONE FOLLOWING A SUCCESSFUL REPORT REQUEST     *15660099
156700*  SUBMISSION, A CANCELLATION OF THE CURRENT REPORT REQUEST, OR  *15670099
156800*  ANY DETECTED ABENDS.  THIS WILL FREE UP THE INTERNAL READER   *15680099
156900*  FOR THE NEXT USER.  IF ANY ERRORS OCCUR, CHECK TO SEE IF      *15690099
157000*  ANY OTHER ABEND SITUATIONS HAVE ALREADY OCCURRED.  IF SO, DO  *15700099
157100*  NOT FORCE THE ABEND FOR THIS ERROR, AND ALLOW PROGRAM CONTROL *15710099
157200*  TO RETURN TO THE POINT WHERE THE FIRST ABEND OCCURRED, AND    *15720099
157300*  DISPLAY THE MESSAGE RELATING TO THAT ABEND.  IF NOT, DELETE   *15730099
157400*  THE TEMPORARY STORAGE QUEUE (TO PREVENT OLD REQUEST           *15740099
157500*  INFORMATION FROM ACCIDENTALLY APPEARING ON A FUTURE REQUEST), *15750099
157600*  FORMAT AND DISPLAY AN ERROR MESSAGE, AND RETURN TO NATIVE     *15760099
157700*  CICS.                                                         *15770099
157800*----------------------------------------------------------------*15780099
157900 9600-DEQUEUE-INTERNAL-READER.                                    15790099
158000     SET PS-INTERNAL-READER-DEQUEUED TO TRUE.                     15800099
158100                                                                  15810099
158200     EXEC CICS                                                    15820099
158300         DEQ                                                      15830099
158400             RESOURCE(TD-QUEUE-NAME)                              15840099
158500             LENGTH(TD-QUEUE-NAME-LENGTH)                         15850099
158600             RESP(PV-CICS-RESPONSE)                               15860099
158700     END-EXEC.                                                    15870099
158800                                                                  15880099
158900     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    15890099
159000         IF PS-NO-ABEND-IN-PROGRESS                               15900099
159100             SET PS-ABEND-IN-PROGRESS TO TRUE                     15910099
159200             STRING 'DEQUEUE '            DELIMITED BY SIZE       15920099
159300                    TD-QUEUE-NAME         DELIMITED BY SIZE       15930099
159400                    ' (INTERNAL READER)'  DELIMITED BY SIZE       15940099
159500                 INTO SE-ATTEMPTED-ACTION                         15950099
159600             MOVE PV-CICS-RESPONSE TO SE-CICS-RESPONSE            15960099
159700             MOVE SE-SYSTEM-ERROR-MESSAGE TO                      15970099
159800                       PV-LEAVE-SYSTEM-MESSAGE                    15980099
159900             PERFORM 9900-LEAVE-SYSTEM                            15990099
160000         END-IF                                                   16000099
160100     END-IF.                                                      16010099
160200                                                                  16020099
160300                                                                  16030099
160400*----------------------------------------------------------------*16040099
160500*  EXIT THE SHIPT UNIT REPORT REQUEST SYSTEM, DISPLAYING A       *16050099
160600*  REASON FOR THE PROGRAM ABEND.                                 *16060099
160700*----------------------------------------------------------------*16070099
160800 9900-LEAVE-SYSTEM.                                               16080099
160900     EXEC CICS                                                    16090099
161000         SEND                                                     16100099
161100             FROM(PV-LEAVE-SYSTEM-MESSAGE)                        16110099
161200             LENGTH(PC-LEAVE-SYSTEM-LENGTH)                       16120099
161300             ERASE                                                16130099
161400     END-EXEC.                                                    16140099
161500                                                                  16150099
161600     EXEC CICS                                                    16160099
161700         RETURN                                                   16170099
161800     END-EXEC.                                                    16180099
161900                                                                  16190099
162000                                                                  16200099
162100*----------------------------------------------------------------*16210099
162200*                                                                *16220099
162300*----------------------------------------------------------------*16230099
162400 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  16240099
162500     MOVE PC-CURRENT-PROGRAM-NAME    TO DP013-PROGRAM.            16250099
162600     MOVE DFHEIBLK                   TO DP013-DFHEIBLK.           16260099
162700     INITIALIZE DP013-SRC-TASK-NUMBER                             16270099
162800                DP013-STACK.                                      16280099
162900     SET DP013-LINK-RETURN           TO TRUE.                     16290099
163000                                                                  16300099
163100     EXEC CICS                                                    16310099
163200         LINK                                                     16320099
163300             PROGRAM   (DP013-NAME)                               16330099
163400             COMMAREA  (DP013-PARAMETERS)                         16340099
163500             LENGTH    (DP013-LENGTH)                             16350099
163600     END-EXEC.                                                    16360099
163700*----------------------------------------------------------------*16370099
163800*    ABEND PROCESSOR MODULE                                      *16380099
163900*----------------------------------------------------------------*16390099
164000                                                                  16400099
164100     COPY DPPD014.                                                16410099
164200                                                                  16420099
