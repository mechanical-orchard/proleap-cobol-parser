000100 IDENTIFICATION DIVISION.                                         00010045
000200 PROGRAM-ID.    RCKUP811.                                         00020051
000300 AUTHOR.        JOE LAROSA.                                       00030045
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040045
000500 DATE-WRITTEN.  10-06-99.                                         00050045
000600 DATE-COMPILED.                                                   00060045
000700******************************************************************00070045
000800*  THIS WAS COPIED FROM RCKCS811 AND CONVERTED FOR USE IN BATCH.  00080056
000810*  IF EITHER THIS PROGRAM OR RCKCS811 CHANGE, THE OTHER SHOULD    00081098
000820*  BE CHECKED TO SEE IF THE SAME CHANGE SHOULD BE MADE            00082099
000900*                                                                 00090045
001000*  THIS CALLED ROUTINE WILL NOT REMOVE THE ALLOCATION IN RECDIS   00100045
001100*  BUT CONVERT THE ALLOCATION LINES IN A PACK TO KEEP RECITM      00110045
001200*  PACK AND RECDIS PACK IN SYNC BY LINE AND BY PACK ID.  THIS     00120045
001300*  PROGRAM WILL:                                                  00130045
001400*    1) CONVERT RECDIS WHENEVER A LINE IN TRECITM IS REMOVED      00140045
001500*       FROM THE PACK, ADDED TO A PACK OR HAS A RATIO CHANGE      00150045
001600*       IN A PACK.                                                00160045
001700*    2) DELETE A LINE OR AN ENTIRE PACKING RECDIS IN PREPARATION  00170045
001800*       OF PERFORMING 'TRANSCRIPTION' OR 'REDISTRO'.              00180045
001900*                                                                 00190045
002000******************************************************************00200045
002010* CHANGE HISTORY                                                 *00201099
002030*    CHANGES                                                     *00203098
002040*     MADE BY: PRITHIVIRAJ SUBRAMANIAN (COGNIZANT)               *00204098
002050*     DATE:    10/15/2014                                        *00205098
002060*                                                                *00206098
002070*      CHANGES THRU OUT THE PROGRAM TO INCREASE THE SIZE OF PO#  *00207098
002080*      FROM 7 DIGITS TO 8 DIGITS. TAGGED WITH *PS 10/15/2014     *00208098
002090******************************************************************00209098
002100 ENVIRONMENT DIVISION.                                            00210045
002200                                                                  00220045
002300 CONFIGURATION SECTION.                                           00230045
002400 SOURCE-COMPUTER.        IBM-3090.                                00240045
002500 OBJECT-COMPUTER.        IBM-3090.                                00250045
002600                                                                  00260045
002700******************************************************************00270045
002800 DATA DIVISION.                                                   00280045
002900                                                                  00290045
003000 WORKING-STORAGE SECTION.                                         00300045
003100                                                                  00310045
003200 01  PS-PROGRAM-SWITCHES.                                         00320045
003300     05  PS-DONE-SW                   PIC  X    VALUE 'N'.        00330045
003400         88  PS-NOT-DONE                        VALUE 'N'.        00340045
003500         88  PS-DONE                            VALUE 'Y'.        00350045
003600     05  PS-RECDIS-HOLD-CSR-SW        PIC  X    VALUE 'Y'.        00360045
003700         88  PS-RECDIS-HOLD-CSR-YES             VALUE 'Y'.        00370045
003800         88  PS-RECDIS-HOLD-CSR-EOF             VALUE 'N'.        00380045
003900     05  PS-RECDIS-CLONE-CSR-SW       PIC  X    VALUE 'Y'.        00390045
004000         88  PS-RECDIS-CLONE-CSR-YES            VALUE 'Y'.        00400045
004100         88  PS-RECDIS-CLONE-CSR-EOF            VALUE 'N'.        00410045
004200     05  PS-RECITM-CLONE-SW           PIC  X    VALUE 'N'.        00420045
004300         88  PS-RECITM-CLONE-NO                 VALUE 'N'.        00430045
004400         88  PS-RECITM-CLONE-YES                VALUE 'Y'.        00440045
004500     05  PS-RECITM-MODIFY-SW          PIC  X    VALUE 'N'.        00450045
004600         88  PS-RECITM-MODIFY-NO                VALUE 'N'.        00460045
004700         88  PS-RECITM-MODIFY-YES               VALUE 'Y'.        00470045
004800     05  PS-MORE-RECITM-SW            PIC  X    VALUE 'N'.        00480045
004900         88  PS-MORE-RECITM-NO                  VALUE 'N'.        00490045
005000         88  PS-MORE-RECITM-YES                 VALUE 'Y'.        00500045
005001                                                                  00500199
005010     05  PS-FIRST-PASS-SW             PIC  X    VALUE 'Y'.        00501099
005020         88  PS-FIRST-PASS                      VALUE 'Y'.        00502099
005030         88  PS-FIRST-PASS-NO                   VALUE 'N'.        00503099
005100                                                                  00510045
005200 01  PC-PROGRAM-CONSTANTS.                                        00520045
005300     05  PC-CURRENT-PROGRAM-NAME      PIC X(08) VALUE 'RCKUP811'. 00530051
005400     05  PC-CURR-PGM-NAME             PIC X(08) VALUE 'RCKUP811'. 00540051
005500     05  PC-RC811-UID                 PIC X(08) VALUE 'RCKUP811'. 00550051
005600     05  PC-TMKUT019                  PIC X(08) VALUE 'TMKUT019'. 00560096
005700     05  PC-DEFAULT-DATE              PIC X(10) VALUE             00570048
005710                                                '9999-09-09'.     00571048
005800     05  PC-A                         PIC X(01) VALUE 'A'.        00580045
005900     05  PC-ACTIVE                    PIC X(01) VALUE 'A'.        00590045
006000     05  PC-INACTIVE                  PIC X(01) VALUE 'I'.        00600045
006100     05  PC-F                         PIC X(01) VALUE 'F'.        00610045
006200     05  PC-N                         PIC X(01) VALUE 'N'.        00620045
006300     05  PC-Y                         PIC X(01) VALUE 'Y'.        00630045
006400     05  PC-MAX-RETRIES               PIC S9(4) VALUE +3          00640045
006500                                                COMP SYNC.        00650045
006600     05  PC-NULL-TMST                 PIC X(26) VALUE             00660045
006700                                    '0001-01-01-00.00.00.000000'. 00670045
006800                                                                  00680045
006900 01  PV-PROGRAM-VARIABLES.                                        00690045
007000     05  PV-RETRY-COUNTER             PIC S9(4) VALUE ZERO        00700045
007100                                                COMP SYNC.        00710045
007200     05  PV-DB2-COUNT                 PIC S9(9) VALUE +0          00720045
007300                                                COMP-3.           00730045
007400     05  PV-CLONE-COUNT               PIC S9(9) VALUE +0          00740045
007500                                                COMP-3.           00750045
007600     05  PV-MODIFY-COUNT              PIC S9(9) VALUE +0          00760045
007700                                                COMP-3.           00770045
007800     05  PV-EXPTED-ITM-QTY            PIC S9(9) COMP.             00780045
007900     05  PV-VERIFY-ITM-QTY            PIC S9(9) COMP.             00790045
008000     05  PV-PLAN-ITM-QTY              PIC S9(4) COMP.             00800045
008100     05  PV-HOLD-COMPUTED-QTY1        PIC S9(9)V9(5) COMP.        00810045
008200     05  PV-HOLD-COMPUTED-QTY2        PIC S9(9)V9(5) COMP.        00820045
008300     05  PV-FACTOR                    PIC S9(9)V9(5) COMP SYNC.   00830045
008400     05  PV-NEW-EXPTED-COMPUTED-QTY   PIC S9(9) COMP.             00840045
008500     05  PV-NEW-VERIFY-COMPUTED-QTY   PIC S9(9) COMP.             00850045
008600     05  PV-NEW-PLAN-COMPUTED-QTY     PIC S9(4) COMP.             00860045
008700     05  PV-CLONE-RATIO-QTY           PIC S9(4) COMP.             00870045
008800     05  PV-MODIFY-RATIO-QTY          PIC S9(4) COMP.             00880045
009000                                                                  00900045
009100*PS 10/15/2014 CHANGE STARTS                                      00910098
009110     05  PV-DISP-PO-NBR          PIC 9(8).                        00911098
009120*PS 10/15/2014 CHANGE ENDS                                        00912098
009200     05  PV-DISP-REC-SEQ-NBR     PIC 9(4).                        00920045
009300     05  PV-DISP-OPER-UNT-ID     PIC 9(4).                        00930045
009400     05  PV-DISP-FCLTY-ID        PIC 9(4).                        00940045
009500     05  PV-DISP-PREPK-ID        PIC 9(4).                        00950045
009600     05  PV-DISP-CLN-LINE        PIC 9(4).                        00960045
009700     05  PV-DISP-MOD-LINE        PIC 9(4).                        00970045
009800     05  PV-DISP-DLT-LINE        PIC 9(4).                        00980045
009900     05  PV-RETURN-MSG           PIC X(50).                       00990045
010000     05  PV-SQLCODE              PIC S9(9) COMP-4.                01000045
010100     05  PV-DISPLAY-SQLCODE      PIC -Z(8)9.                      01010045
010200     05  PV-DISPLAY-QTY          PIC Z(4)9.                       01020045
010201     05  PV-DISP-PLN-ITM         PIC Z(4)9.                       01020199
010210     05  PV-MESSAGE-TEXT         PIC X(79).                       01021052
010211                                                                  01021199
010220     05  PV-DISP-OPER            PIC 9(04).                       01022099
010230     05  PV-DISP-PO              PIC 9(09).                       01023099
010240     05  PV-DISP-RCVR            PIC 9(04).                       01024099
010250     05  PV-DISP-LINE            PIC 9(04).                       01025099
010260     05  PV-DISP-PREPK           PIC 9(04).                       01026099
010270     05  PV-DISP-CLONE-LINE      PIC 9(04).                       01027099
010290     05  PV-DISP-DEL-LINE        PIC 9(04).                       01029099
010291     05  PV-DISP-STR             PIC Z(04).                       01029199
010292     05  PV-DISP-EXPTED          PIC Z(09).                       01029299
010293     05  PV-DISP-VERIFY          PIC Z(09).                       01029399
010294     05  PV-DISP-PLAN            PIC Z(09).                       01029499
010295     05  PV-DISP-SQL             PIC -999.                        01029599
010300                                                                  01030045
010320     05  PV-DISP-TABLE-IDX               PIC S9(04) COMP.         01032099
010330     05  PV-DISP-TABLE.                                           01033099
010340         10  PV-DISP-TBL-SEQ             PIC 9(4).                01034099
010350         10  FILLER                      PIC X.                   01035099
010360         10  PV-DISP-TBL-STORE-NBR       PIC 9(4).                01036099
010370         10  FILLER                      PIC X.                   01037099
010380         10  PV-DISP-TBL-ALLOC-SEQ-CDE   PIC X.                   01038099
010390         10  FILLER                      PIC X.                   01039099
010391         10  PV-DISP-TBL-RNK-SEQ-NBR     PIC 9(4).                01039199
010392         10  FILLER                      PIC X.                   01039299
010393         10  PV-DISP-TBL-STR-CNSTR-CDE   PIC X.                   01039399
010394         10  FILLER                      PIC X.                   01039499
010395         10  PV-DISP-TBL-STR-CNSTR-QTY   PIC 9(9).                01039599
010396         10  FILLER                      PIC X.                   01039699
010397         10  PV-DISP-TBL-STR-DISTRO-QTY  PIC 9(9).                01039799
010398         10  FILLER                      PIC X.                   01039899
010399         10  PV-DISP-TBL-STR-DISTRO-PK   PIC 9(9).                01039999
010400         10  FILLER                      PIC X.                   01040099
010401         10  PV-DISP-TBL-STR-OTR-QTY     PIC 9(9).                01040199
010402         10  FILLER                      PIC X.                   01040299
010403         10  PV-DISP-TBL-STR-OTR-PK      PIC 9(9).                01040399
010404         10  FILLER                      PIC X.                   01040499
010405         10  PV-DISP-TBL-STR-DISTRO-OTR  PIC 9(9).                01040599
010406         10  FILLER                      PIC X.                   01040699
010407                                                                  01040799
010410 01  DK-DB2-KEYS.                                                 01041045
010500     05  DK-LINE-NBR-LOW              PIC S9(9) COMP VALUE +0.    01050045
010600     05  DK-LINE-NBR-HIGH             PIC S9(9) COMP VALUE +0.    01060045
010700     05  DK-CLONE-LINE-NBR            PIC S9(9) COMP VALUE +0.    01070045
010800     05  DK-MODIFY-LINE-NBR           PIC S9(9) COMP VALUE +0.    01080045
010900                                                                  01090045
011000 01  PM-PROGRAM-MESSAGES.                                         01100045
011100     05  PM-001                       PIC X(50) VALUE             01110045
011200         '001SUCCESSFUL UPDATE                              '.    01120045
011300     05  PM-002                       PIC X(50) VALUE             01130045
011400         '002ZERO VALUE IN OLD-DISTRO-RATIO OR NEW-RC-RATIO '.    01140045
011500     05  PM-003                       PIC X(50) VALUE             01150045
011600         '003NO RECDIS ROWS WERE FOUND                      '.    01160045
011700     05  PM-004                       PIC X(50) VALUE             01170045
011800         '004LINES IN A PACK ON RECDIS ALREADY VERIFIED     '.    01180045
011900     05  PM-005                       PIC X(50) VALUE             01190045
012000         '005DATABASE ERROR ON CONVERT-DISTRO-RATIO FUNCTION'.    01200045
012100     05  PM-006                       PIC X(50) VALUE             01210045
012200         '006SUCCESSFUL LINE DELETE                         '.    01220045
012300     05  PM-007                       PIC X(50) VALUE             01230045
012400         '007A ZERO VALUE IN THE DELETE LINE                '.    01240045
012500     05  PM-008                       PIC X(50) VALUE             01250045
012600         '008LINES IN A PACK ON RECDIS ALREADY VERIFIED     '.    01260045
012700     05  PM-009                       PIC X(50) VALUE             01270045
012800         '009RECDIS ROWS WITH THE LINE-NBR WERE NOT FOUND   '.    01280045
012900     05  PM-010                       PIC X(50) VALUE             01290045
013000         '010DATABASE ERROR ON DELETE-A-DISTRO-LINE FUNCTION'.    01300045
013100     05  PM-011                       PIC X(50) VALUE             01310045
013200         '011SUCCESSFUL LINE DELETE                         '.    01320045
013300     05  PM-012                       PIC X(50) VALUE             01330045
013400         '012                                               '.    01340045
013500     05  PM-013                       PIC X(50) VALUE             01350045
013600         '013RECDIS ROWS WITH THE PREPK-ID WERE NOT FOUND   '.    01360045
013700     05  PM-014                       PIC X(50) VALUE             01370045
013800         '014LINES IN A PACK ON RECDIS ALREADY VERIFIED     '.    01380045
013900     05  PM-015                       PIC X(50) VALUE             01390045
014000         '015DATABASE ERROR ON DELETE-A-DISTRO-PACK FUNCTION'.    01400045
014100     05  PM-016                       PIC X(50) VALUE             01410045
014200         '016SUCCESSFUL LINE COPY                           '.    01420045
014300     05  PM-017                       PIC X(50) VALUE             01430045
014400         '017THE RATIO FOR LINE BEING ADDED DOES NOT EXIST  '.    01440045
014500     05  PM-018                       PIC X(50) VALUE             01450045
014600         '018STORE ALLOCATION FOR LINE ADD ALREADY EXISTS   '.    01460045
014700     05  PM-019                       PIC X(50) VALUE             01470045
014800         '019STORE ALLOCATION FOR CLONE LINE DOES NOT EXIST '.    01480045
014900     05  PM-020                       PIC X(50) VALUE             01490045
015000         '020LINES IN A PACK ON RECDIS ALREADY VERIFIED     '.    01500045
015100     05  PM-021                       PIC X(50) VALUE             01510045
015200         '021DATABASE ERROR ON ADD-A-DISTRO-LINE FUNCTION   '.    01520045
015300     05  PM-022                       PIC X(50) VALUE             01530045
015400         '022FOR ADD, BOTH CLONE & MODIFY LINES ARE NEEDED  '.    01540045
015500     05  PM-023                       PIC X(50) VALUE             01550045
015600         '023FOR CONVERT, MODIFY LINE MUST BE PRESENT       '.    01560045
015700     05  PM-024                       PIC X(50) VALUE             01570045
015800         '024CANNOT ADD, RECDIS LINE ALREADY EXISTS         '.    01580045
015900     05  PM-025                       PIC X(50) VALUE             01590045
016000         '025BAD SQL RETURN WHEN COUNTING TRECITM           '.    01600045
016100     05  PM-026                       PIC X(50) VALUE             01610045
016200         '026NO LINE TO COPY IN RECDIS                      '.    01620045
016300     05  PM-027                       PIC X(50) VALUE             01630045
016400         '027BAD SQL RETURN WHEN COUNTING TDISTHD           '.    01640045
016500     05  PM-998                       PIC X(50) VALUE             01650045
016600         '998NOT ALL KEYS PASSED                            '.    01660045
016700     05  PM-999                       PIC X(50) VALUE             01670045
016800         '999INVALID FUNCTION                               '.    01680045
016900                                                                  01690045
017000******************************************************************01700045
017100*    COPYBOOK AREA                                                01710045
017200******************************************************************01720045
017300     COPY RCWS811.                                                01730045
017400                                                                  01740045
017500     COPY DPWS277.                                                01750045
018200                                                                  01820045
018210* ERROR DATA PASSED BACK UPSTREAM.                                01821074
018220     COPY TMRD007.                                                01822074
018230                                                                  01823074
018300******************************************************************01830045
018400*    DB2 SQL COMMUNICATION AREA                                   01840045
018500******************************************************************01850045
018600     EXEC SQL                                                     01860045
018700          INCLUDE SQLCA                                           01870045
018800     END-EXEC.                                                    01880045
018900                                                                  01890045
019000******************************************************************01900045
019100*    DB2 DCLGEN FOR DISTRIBUTION HEADER TABLE                     01910045
019200******************************************************************01920045
019300     EXEC SQL                                                     01930045
019400          INCLUDE TDISTHD                                         01940045
019500     END-EXEC.                                                    01950045
019600                                                                  01960045
019700******************************************************************01970045
019800*    DB2 DCLGEN FOR PACK SLIP HEADER TABLE                        01980045
019900******************************************************************01990045
020000     EXEC SQL                                                     02000045
020100          INCLUDE TPKSLIP                                         02010045
020200     END-EXEC.                                                    02020045
020300                                                                  02030045
020400******************************************************************02040045
020500*    DB2 DCLGEN FOR PACK SLIP ITEM TABLE                          02050045
020600******************************************************************02060045
020700     EXEC SQL                                                     02070045
020800          INCLUDE TPKITEM                                         02080045
020900     END-EXEC.                                                    02090045
021000                                                                  02100045
021100******************************************************************02110045
021200*    DB2 DCLGEN FOR RECEIVE ITEM TABLE                            02120045
021300******************************************************************02130045
021400     EXEC SQL                                                     02140045
021500          INCLUDE TRECITM                                         02150045
021600     END-EXEC.                                                    02160045
021700                                                                  02170045
021800******************************************************************02180045
021900*    DB2 DCLGEN FOR ITEM DISPOSITION TABLE                        02190045
022000******************************************************************02200045
022100     EXEC SQL                                                     02210045
022200          INCLUDE TRECDIS                                         02220045
022300     END-EXEC.                                                    02230045
022400                                                                  02240045
022500******************************************************************02250045
022600*    DB2 DCLGEN FOR ODD UNIT TABLE                                02260045
022700******************************************************************02270045
022800     EXEC SQL                                                     02280045
022900          INCLUDE RCT00009                                        02290045
023000     END-EXEC.                                                    02300045
023100                                                                  02310045
023200******************************************************************02320045
023300*    RECITM CURSOR                                                02330045
023400******************************************************************02340045
023500     EXEC SQL                                                     02350045
023600          DECLARE SELECT-RECITM-CSR CURSOR FOR                    02360045
023700           SELECT ORD_LNE_NBR                                     02370045
023800             FROM TRECITM                                         02380045
023900            WHERE ORD_NBR        = :RC811-PO-NBR                  02390045
024000              AND REC_SEQ_NBR    = :RC811-REC-SEQ-NBR             02400045
024100              AND OPER_UNT_ID    = :RC811-OPER-UNIT-ID            02410045
024200              AND FCLTY_ID       = :RC811-FACILITY-ID             02420045
024300              AND PREPK_ID       = :RC811-PREPK-ID                02430045
024400     END-EXEC.                                                    02440045
024500                                                                  02450045
024600******************************************************************02460045
024700*    RECDIS HOLD CURSOR                                           02470045
024800******************************************************************02480045
024900     EXEC SQL                                                     02490045
025000       DECLARE RECDIS-HOLD-CSR CURSOR WITH HOLD FOR               02500045
025100        SELECT STR_NBR                                            02510045
025200             , EXPTED_ITM_QTY                                     02520045
025300             , VERIFY_ITM_QTY                                     02530045
025400             , PLAN_ITM_QTY                                       02540045
025500          FROM TRECDIS                                            02550045
025600         WHERE ORD_NBR      = :RC811-PO-NBR                       02560045
025700           AND ORD_LNE_NBR  = :RC811-MODIFY-LINE-NBR              02570045
025800           AND REC_SEQ_NBR  = :RC811-REC-SEQ-NBR                  02580045
025900           AND OPER_UNT_ID  = :RC811-OPER-UNIT-ID                 02590045
026000           AND FCLTY_ID     = :RC811-FACILITY-ID                  02600045
026100           FOR UPDATE OF EXPTED_ITM_QTY                           02610045
026200                       , VERIFY_ITM_QTY                           02620045
026300     END-EXEC.                                                    02630045
026400                                                                  02640045
026500******************************************************************02650045
026600*    RECDIS CLONE CURSOR                                          02660045
026700******************************************************************02670045
026800     EXEC SQL                                                     02680045
026900       DECLARE RECDIS-CLONE-CSR CURSOR WITH HOLD FOR              02690045
027000        SELECT STR_NBR                                            02700045
027100             , EXPTED_ITM_QTY                                     02710045
027200             , VERIFY_ITM_QTY                                     02720045
027300             , PLAN_ITM_QTY                                       02730045
027400          FROM TRECDIS                                            02740045
027500         WHERE ORD_NBR      = :RC811-PO-NBR                       02750045
027600           AND ORD_LNE_NBR  = :DK-CLONE-LINE-NBR                  02760045
027700           AND REC_SEQ_NBR  = :RC811-REC-SEQ-NBR                  02770045
027800           AND OPER_UNT_ID  = :RC811-OPER-UNIT-ID                 02780045
027900           AND FCLTY_ID     = :RC811-FACILITY-ID                  02790045
028000     END-EXEC.                                                    02800045
028100                                                                  02810045
028200******************************************************************02820045
028300******************************************************************02830045
028400 LINKAGE SECTION.                                                 02840045
028500                                                                  02850045
028600 01  LINK-COMMAREA                    PIC X(34).                  02860068
028700 01  LINK-TMRD007                     PIC X(800).                 02870094
029100                                                                  02910045
029200 PROCEDURE DIVISION USING LINK-COMMAREA                           02920070
029210                          LINK-TMRD007.                           02921070
029300******************************************************************02930045
029400*  THIS PARAGRAPH DRIVES THE PROGRAM LOGIC.                       02940045
029500******************************************************************02950045
029600 0000-MAIN-MODULE.                                                02960045
029700                                                                  02970099
029800     PERFORM 0100-HOUSEKEEPING.                                   02980045
029900                                                                  02990045
030000*CHECK PASSED KEYS.                                               03000045
030100     SET PS-NOT-DONE TO TRUE.                                     03010045
030200                                                                  03020045
030300     IF RC811-PO-NBR         NOT > +0                             03030045
030400       OR RC811-REC-SEQ-NBR  NOT > +0                             03040045
030500       OR RC811-OPER-UNIT-ID NOT > +0                             03050045
030600       OR RC811-FACILITY-ID  NOT > +0                             03060045
030700       OR RC811-PREPK-ID     NOT > +0                             03070045
030800         SET PS-DONE TO TRUE                                      03080045
030900         MOVE 998 TO RC811-RETURN-CODE                            03090045
031000         MOVE 'F' TO RC811-SEVERITY-IND                           03100045
031110         MOVE '01'   TO TM007-RETURN-CODE                         03111075
031120         MOVE ZERO   TO TM007-SQLCODE                             03112074
031130         MOVE SPACES TO TM007-SQLCA                               03113074
031140         MOVE '0000' TO TM007-RETURNED-PARA                       03114074
031150         PERFORM 9900-SOFT-ABORT                                  03115076
031200     END-IF.                                                      03120076
031300                                                                  03130045
031400     IF RC811-ADD-A-DISTRO-LINE                                   03140045
031500         IF RC811-CLONE-LINE-NBR NOT > +0                         03150045
031600           OR RC811-MODIFY-LINE-NBR NOT > +0                      03160045
031700             SET PS-DONE TO TRUE                                  03170045
031800             MOVE 022 TO RC811-RETURN-CODE                        03180045
031900             MOVE 'F' TO RC811-SEVERITY-IND                       03190045
031910             MOVE '02'    TO TM007-RETURN-CODE                    03191076
031920             MOVE ZERO    TO TM007-SQLCODE                        03192077
031930             MOVE SPACES  TO TM007-SQLCA                          03193077
031940             MOVE '0000'  TO TM007-RETURNED-PARA                  03194076
032000             PERFORM 9900-SOFT-ABORT                              03200045
032100         END-IF                                                   03210045
032200     END-IF.                                                      03220045
032300                                                                  03230045
032400     IF RC811-CONVERT-DISTRO-RATIO                                03240045
032500         IF RC811-MODIFY-LINE-NBR NOT > +0                        03250045
032600             SET PS-DONE TO TRUE                                  03260045
032700             MOVE 023 TO RC811-RETURN-CODE                        03270045
032800             MOVE 'F' TO RC811-SEVERITY-IND                       03280045
032810             MOVE '03'    TO TM007-RETURN-CODE                    03281077
032820             MOVE ZERO    TO TM007-SQLCODE                        03282077
032830             MOVE SPACES  TO TM007-SQLCA                          03283077
032840             MOVE '0000'  TO TM007-RETURNED-PARA                  03284077
032900             PERFORM 9900-SOFT-ABORT                              03290045
033000         END-IF                                                   03300045
033100     END-IF.                                                      03310045
033200                                                                  03320045
033300     IF RC811-CONVERT-DISTRO-RATIO                                03330045
033400         IF RC811-OLD-DISTRO-RATIO NOT > +0                       03340045
033500           OR RC811-NEW-RC-RATIO NOT > +0                         03350045
033600             SET PS-DONE TO TRUE                                  03360045
033700             MOVE 002 TO RC811-RETURN-CODE                        03370045
033800             MOVE 'F' TO RC811-SEVERITY-IND                       03380045
033810             MOVE '04'    TO TM007-RETURN-CODE                    03381077
033820             MOVE ZERO    TO TM007-SQLCODE                        03382077
033830             MOVE SPACES  TO TM007-SQLCA                          03383077
033840             MOVE '0000'  TO TM007-RETURNED-PARA                  03384077
033900             PERFORM 9900-SOFT-ABORT                              03390045
034000         END-IF                                                   03400045
034100     END-IF.                                                      03410045
034200                                                                  03420045
034300     IF RC811-DELETE-A-DISTRO-LINE                                03430045
034400         IF RC811-DELETE-LINE-NBR NOT > +0                        03440045
034500             SET PS-DONE TO TRUE                                  03450045
034600             MOVE 007 TO RC811-RETURN-CODE                        03460045
034700             MOVE 'F' TO RC811-SEVERITY-IND                       03470045
034710             MOVE '05'    TO TM007-RETURN-CODE                    03471077
034720             MOVE ZERO    TO TM007-SQLCODE                        03472077
034730             MOVE SPACES  TO TM007-SQLCA                          03473077
034740             MOVE '0000'  TO TM007-RETURNED-PARA                  03474077
034800             PERFORM 9900-SOFT-ABORT                              03480045
034900         END-IF                                                   03490045
035000     END-IF.                                                      03500045
035100                                                                  03510045
035200*CHECK FOR VERIFIED ITEMS                                         03520045
035300*IF VERIFIED ITEMS - ERROR                                        03530045
035400     IF PS-NOT-DONE                                               03540045
035500         PERFORM 5000-COUNT-RECITM                                03550045
035600         IF PV-DB2-COUNT > +0                                     03560045
035700             SET PS-DONE TO TRUE                                  03570045
035800             MOVE 020 TO RC811-RETURN-CODE                        03580045
035900             MOVE 'F' TO RC811-SEVERITY-IND                       03590045
035910             MOVE '06'    TO TM007-RETURN-CODE                    03591077
035920             MOVE ZERO    TO TM007-SQLCODE                        03592077
035930             MOVE SPACES  TO TM007-SQLCA                          03593077
035940             MOVE '0000'  TO TM007-RETURNED-PARA                  03594077
036000             PERFORM 9900-SOFT-ABORT                              03600045
036100         END-IF                                                   03610045
036200     END-IF.                                                      03620045
036300                                                                  03630045
036400     IF PS-NOT-DONE                                               03640045
036500         PERFORM 5100-COUNT-DISTHD                                03650045
036600         IF PV-DB2-COUNT > +0                                     03660045
036700             SET PS-DONE TO TRUE                                  03670045
036800             MOVE 020 TO RC811-RETURN-CODE                        03680045
036900             MOVE 'F' TO RC811-SEVERITY-IND                       03690045
036910             MOVE '07'    TO TM007-RETURN-CODE                    03691077
036920             MOVE ZERO    TO TM007-SQLCODE                        03692077
036930             MOVE SPACES  TO TM007-SQLCA                          03693077
036940             MOVE '0000'  TO TM007-RETURNED-PARA                  03694077
037000             PERFORM 9900-SOFT-ABORT                              03700045
037100         END-IF                                                   03710045
037200     END-IF.                                                      03720045
037300                                                                  03730045
037400*CHECK REQUESTED FUNCTION.                                        03740045
037500     IF PS-NOT-DONE                                               03750045
037600         EVALUATE TRUE                                            03760045
037700           WHEN RC811-ADD-A-DISTRO-LINE                           03770045
037800               PERFORM 1000-ADD-LINE                              03780045
037900                                                                  03790045
038000           WHEN RC811-CONVERT-DISTRO-RATIO                        03800045
038100               PERFORM 2000-CONVERT-RATIO                         03810045
038200                                                                  03820045
038300           WHEN RC811-DELETE-A-DISTRO-LINE                        03830045
038400               PERFORM 3000-DELETE-LINE                           03840045
038500                                                                  03850045
038600           WHEN RC811-DELETE-A-DISTRO-PACK                        03860045
038700               PERFORM 4000-DELETE-PACK                           03870045
038800                                                                  03880045
038900           WHEN OTHER                                             03890045
039000               STRING ' INVALID FUNCTION (' RC811-FUNCTION ')'    03900045
039100                      DELIMITED BY SIZE INTO PV-RETURN-MSG        03910045
039200               MOVE 999 TO RC811-RETURN-CODE                      03920045
039300               MOVE 'F' TO RC811-SEVERITY-IND                     03930045
039310               MOVE '08'    TO TM007-RETURN-CODE                  03931077
039320               MOVE ZERO    TO TM007-SQLCODE                      03932077
039330               MOVE SPACES  TO TM007-SQLCA                        03933077
039340               MOVE '0000'  TO TM007-RETURNED-PARA                03934077
039400               PERFORM 9900-SOFT-ABORT                            03940045
039500         END-EVALUATE                                             03950045
039600     END-IF.                                                      03960045
039700                                                                  03970045
039710     PERFORM 9999-GOBACK.                                         03971072
040100                                                                  04010045
040200******************************************************************04020045
040300*  THIS PARAGRAPH SETS INITIAL VALUES FOR THE PROGRAM.            04030045
040400******************************************************************04040045
040500 0100-HOUSEKEEPING.                                               04050045
040540                                                                  04054099
040700     MOVE LINK-COMMAREA TO RC811-STORE-RECDIS-PROCESSING.         04070067
040710     MOVE LINK-TMRD007  TO TM007-COMMUNICATIONS-AREA.             04071071
040720     MOVE PC-CURRENT-PROGRAM-NAME                                 04072071
040730                        TO TM007-CALLED-MODULE                    04073071
040800                                                                  04080045
040900     INITIALIZE RC811-RETURN-DATA.                                04090045
040901                                                                  04090199
040910     SET  PS-FIRST-PASS  TO  TRUE.                                04091099
041000                                                                  04100045
041100******************************************************************04110045
041200*  THIS PARAGRAPH WILL CLONE ONE LINE                             04120045
041300*  FROM THE DRIVER OR ALTERNATE LINE                              04130045
041400******************************************************************04140045
041500 1000-ADD-LINE.                                                   04150045
041600                                                                  04160045
041700*CHECK RATIO QTY - 'CLONE' VS 'MODIFY'                            04170045
041800     IF PS-NOT-DONE                                               04180045
041900         MOVE RC811-CLONE-LINE-NBR  TO DK-CLONE-LINE-NBR          04190045
042000         MOVE RC811-MODIFY-LINE-NBR TO DK-MODIFY-LINE-NBR         04200045
042100                                                                  04210045
042200         INITIALIZE PV-CLONE-RATIO-QTY                            04220045
042300         PERFORM 1100-SELECT-RECITM-CLONE                         04230045
042400                                                                  04240045
042500         INITIALIZE PV-MODIFY-RATIO-QTY                           04250045
042600         PERFORM 1200-SELECT-RECITM-MODIFY                        04260045
042700                                                                  04270045
042800         IF PS-RECITM-MODIFY-NO                                   04280045
042900             SET PS-DONE TO TRUE                                  04290045
043000             MOVE 017 TO RC811-RETURN-CODE                        04300045
043100             MOVE 'F' TO RC811-SEVERITY-IND                       04310045
043110             MOVE '09'    TO TM007-RETURN-CODE                    04311078
043120             MOVE ZERO    TO TM007-SQLCODE                        04312078
043130             MOVE SPACES  TO TM007-SQLCA                          04313078
043140             MOVE '1000'  TO TM007-RETURNED-PARA                  04314078
043200             PERFORM 9900-SOFT-ABORT                              04320045
043300         END-IF                                                   04330045
043400     END-IF.                                                      04340045
043500                                                                  04350045
043600*COUNT RECDIS - 'CLONE' VS 'MODIFY'                               04360045
043700     IF PS-RECITM-CLONE-YES                                       04370045
043800       AND PS-RECITM-MODIFY-YES                                   04380045
043900         PERFORM 1300-COUNT-RECDIS-CLONE                          04390045
044000         PERFORM 1400-COUNT-RECDIS-MODIFY                         04400045
044100         IF PV-MODIFY-COUNT > +0                                  04410045
044200             SET PS-DONE TO TRUE                                  04420045
044300             MOVE 024 TO RC811-RETURN-CODE                        04430045
044400             MOVE 'F' TO RC811-SEVERITY-IND                       04440045
044410             MOVE '10'    TO TM007-RETURN-CODE                    04441078
044420             MOVE ZERO    TO TM007-SQLCODE                        04442078
044430             MOVE SPACES  TO TM007-SQLCA                          04443078
044440             MOVE '1000'  TO TM007-RETURNED-PARA                  04444078
044500             PERFORM 9900-SOFT-ABORT                              04450045
044600         END-IF                                                   04460045
044700     END-IF.                                                      04470045
044800                                                                  04480045
044900*CHECK FOR A LINE TO 'COPY'                                       04490045
045000     IF PS-NOT-DONE                                               04500045
045100         IF PV-CLONE-COUNT = +0                                   04510045
045200             PERFORM 1500-SELECT-RECITM-INACTIVE                  04520045
045300             IF PV-CLONE-COUNT = +0                               04530045
045400                 SET PS-DONE TO TRUE                              04540045
045500                 MOVE 003 TO RC811-RETURN-CODE                    04550045
045600                 MOVE 'F' TO RC811-SEVERITY-IND                   04560045
045610                 MOVE '11'    TO TM007-RETURN-CODE                04561078
045620                 MOVE ZERO    TO TM007-SQLCODE                    04562078
045630                 MOVE SPACES  TO TM007-SQLCA                      04563078
045640                 MOVE '1000'  TO TM007-RETURNED-PARA              04564078
045700                 PERFORM 9900-SOFT-ABORT                          04570045
045800             END-IF                                               04580045
045900         END-IF                                                   04590045
046000     END-IF.                                                      04600045
046100                                                                  04610045
046200*CREATE CLONE                                                     04620045
046300     IF PS-NOT-DONE                                               04630045
046400         PERFORM 1600-OPEN-CLONE-CSR                              04640045
046500         PERFORM 1700-FETCH-CLONE-CSR                             04650045
046600         PERFORM 1800-PROCESS-CLONE                               04660045
046700           UNTIL PS-RECDIS-CLONE-CSR-EOF                          04670045
046800         PERFORM 1900-CLOSE-CLONE-CSR                             04680045
046900     END-IF.                                                      04690045
047000                                                                  04700045
047100******************************************************************04710045
047200 1100-SELECT-RECITM-CLONE.                                        04720045
047300                                                                  04730045
047400     EXEC SQL                                                     04740045
047500         SELECT DISTINCT                                          04750045
047600                PREPK_RATO_QTY                                    04760045
047700           INTO :PV-CLONE-RATIO-QTY                               04770045
047800           FROM TRECITM                                           04780045
047900          WHERE ORD_NBR        = :RC811-PO-NBR                    04790045
048000            AND ORD_LNE_NBR    = :DK-CLONE-LINE-NBR               04800045
048100            AND REC_SEQ_NBR    = :RC811-REC-SEQ-NBR               04810045
048200            AND OPER_UNT_ID    = :RC811-OPER-UNIT-ID              04820045
048300            AND FCLTY_ID       = :RC811-FACILITY-ID               04830045
048400            AND PREPK_ID       = :RC811-PREPK-ID                  04840045
048500            AND VER_STATUS_CDE = :PC-A                            04850045
048600     END-EXEC.                                                    04860045
048700                                                                  04870045
048800     EVALUATE TRUE                                                04880045
048900       WHEN SQLCODE = ZERO                                        04890045
049000           SET PS-RECITM-CLONE-YES TO TRUE                        04900045
049100                                                                  04910045
049200       WHEN SQLCODE = +100                                        04920045
049300           SET PS-RECITM-CLONE-NO TO TRUE                         04930045
049400                                                                  04940045
049500       WHEN OTHER                                                 04950045
049600           SET PS-RECITM-CLONE-NO TO TRUE                         04960045
049700           MOVE 021 TO RC811-RETURN-CODE                          04970045
049800           MOVE 'F' TO RC811-SEVERITY-IND                         04980045
049810           MOVE '12'    TO TM007-RETURN-CODE                      04981078
049820           MOVE SQLCODE TO TM007-SQLCODE                          04982083
049830           MOVE SQLCA   TO TM007-SQLCA                            04983083
049840           MOVE '1100'  TO TM007-RETURNED-PARA                    04984078
049900           PERFORM 9900-SOFT-ABORT                                04990045
050000     END-EVALUATE.                                                05000045
050100                                                                  05010045
050200******************************************************************05020045
050300 1200-SELECT-RECITM-MODIFY.                                       05030045
050400                                                                  05040045
050500     EXEC SQL                                                     05050045
050600         SELECT DISTINCT                                          05060045
050700                PREPK_RATO_QTY                                    05070045
050800           INTO :PV-MODIFY-RATIO-QTY                              05080045
050900           FROM TRECITM                                           05090045
051000          WHERE ORD_NBR        = :RC811-PO-NBR                    05100045
051100            AND ORD_LNE_NBR    = :DK-MODIFY-LINE-NBR              05110045
051200            AND REC_SEQ_NBR    = :RC811-REC-SEQ-NBR               05120045
051300            AND OPER_UNT_ID    = :RC811-OPER-UNIT-ID              05130045
051400            AND FCLTY_ID       = :RC811-FACILITY-ID               05140045
051500            AND PREPK_ID       = :RC811-PREPK-ID                  05150045
051600            AND VER_STATUS_CDE = :PC-A                            05160045
051700     END-EXEC.                                                    05170045
051800                                                                  05180045
051900     EVALUATE TRUE                                                05190045
052000       WHEN SQLCODE = ZERO                                        05200045
052100           SET PS-RECITM-MODIFY-YES TO TRUE                       05210045
052200                                                                  05220045
052300       WHEN OTHER                                                 05230045
052400           SET PS-RECITM-MODIFY-NO TO TRUE                        05240045
052500     END-EVALUATE.                                                05250045
052600                                                                  05260045
052700******************************************************************05270045
052800 1300-COUNT-RECDIS-CLONE.                                         05280045
052900                                                                  05290045
053000     EXEC SQL                                                     05300045
053100         SELECT COUNT(*)                                          05310045
053200           INTO :PV-CLONE-COUNT                                   05320045
053300           FROM TRECDIS                                           05330045
053400          WHERE ORD_NBR     = :RC811-PO-NBR                       05340045
053500            AND ORD_LNE_NBR = :DK-CLONE-LINE-NBR                  05350045
053600            AND REC_SEQ_NBR = :RC811-REC-SEQ-NBR                  05360045
053700            AND OPER_UNT_ID = :RC811-OPER-UNIT-ID                 05370045
053800            AND FCLTY_ID    = :RC811-FACILITY-ID                  05380045
053900     END-EXEC.                                                    05390045
054000                                                                  05400045
054100     EVALUATE TRUE                                                05410045
054200       WHEN SQLCODE = +0                                          05420045
054300           CONTINUE                                               05430045
054400                                                                  05440045
054500       WHEN OTHER                                                 05450045
054600           MOVE 021 TO RC811-RETURN-CODE                          05460045
054700           MOVE 'F' TO RC811-SEVERITY-IND                         05470045
054710           MOVE '13'    TO TM007-RETURN-CODE                      05471079
054720           MOVE SQLCODE TO TM007-SQLCODE                          05472083
054730           MOVE SQLCA   TO TM007-SQLCA                            05473083
054740           MOVE '1300'  TO TM007-RETURNED-PARA                    05474079
054800           PERFORM 9900-SOFT-ABORT                                05480045
054900     END-EVALUATE.                                                05490045
055000                                                                  05500045
055100******************************************************************05510045
055200 1400-COUNT-RECDIS-MODIFY.                                        05520045
055300                                                                  05530045
055400     EXEC SQL                                                     05540045
055500         SELECT COUNT(*)                                          05550045
055600           INTO :PV-MODIFY-COUNT                                  05560045
055700           FROM TRECDIS                                           05570045
055800          WHERE ORD_NBR     = :RC811-PO-NBR                       05580045
055900            AND ORD_LNE_NBR = :DK-MODIFY-LINE-NBR                 05590045
056000            AND REC_SEQ_NBR = :RC811-REC-SEQ-NBR                  05600045
056100            AND OPER_UNT_ID = :RC811-OPER-UNIT-ID                 05610045
056200            AND FCLTY_ID    = :RC811-FACILITY-ID                  05620045
056300     END-EXEC.                                                    05630045
056400                                                                  05640045
056500     EVALUATE TRUE                                                05650045
056600       WHEN SQLCODE = +0                                          05660045
056700           CONTINUE                                               05670045
056800                                                                  05680045
056900       WHEN OTHER                                                 05690045
057000           MOVE 021 TO RC811-RETURN-CODE                          05700045
057100           MOVE 'F' TO RC811-SEVERITY-IND                         05710045
057110           MOVE '14'    TO TM007-RETURN-CODE                      05711079
057120           MOVE SQLCODE TO TM007-SQLCODE                          05712083
057130           MOVE SQLCA   TO TM007-SQLCA                            05713083
057140           MOVE '1400'  TO TM007-RETURNED-PARA                    05714079
057200           PERFORM 9900-SOFT-ABORT                                05720045
057300     END-EVALUATE.                                                05730045
057400                                                                  05740045
057500******************************************************************05750045
057600 1500-SELECT-RECITM-INACTIVE.                                     05760045
057700                                                                  05770045
057800     EXEC SQL                                                     05780045
057900         SELECT DISTINCT                                          05790045
058000                PREPK_RATO_QTY                                    05800045
058100              , ORD_LNE_NBR                                       05810045
058200           INTO :PV-CLONE-RATIO-QTY                               05820045
058300              , :DK-CLONE-LINE-NBR                                05830045
058400           FROM TRECITM                                           05840045
058500          WHERE ORD_NBR           = :RC811-PO-NBR                 05850045
058600            AND REC_SEQ_NBR       = :RC811-REC-SEQ-NBR            05860045
058700            AND OPER_UNT_ID       = :RC811-OPER-UNIT-ID           05870045
058800            AND FCLTY_ID          = :RC811-FACILITY-ID            05880045
058900            AND PREPK_ID          = :RC811-PREPK-ID               05890045
059000            AND PREPK_DRV_LNE_CDE = :PC-INACTIVE                  05900045
059100            AND VER_STATUS_CDE    = :PC-A                         05910045
059200     END-EXEC.                                                    05920045
059300                                                                  05930045
059400     EVALUATE TRUE                                                05940045
059500       WHEN SQLCODE = ZERO                                        05950045
059600       WHEN SQLCODE = -811                                        05960045
059700           CONTINUE                                               05970045
059800                                                                  05980045
059900       WHEN SQLCODE = +100                                        05990045
060000           SET PS-DONE TO TRUE                                    06000045
060100           MOVE 026 TO RC811-RETURN-CODE                          06010045
060200           MOVE 'W' TO RC811-SEVERITY-IND                         06020045
060210           MOVE '15'    TO TM007-RETURN-CODE                      06021079
060220           MOVE SQLCODE TO TM007-SQLCODE                          06022083
060230           MOVE SQLCA   TO TM007-SQLCA                            06023083
060240           MOVE '1500'  TO TM007-RETURNED-PARA                    06024079
060300           PERFORM 9900-SOFT-ABORT                                06030045
060400                                                                  06040045
060500       WHEN OTHER                                                 06050045
060600           SET PS-DONE TO TRUE                                    06060045
060700           MOVE 021 TO RC811-RETURN-CODE                          06070045
060800           MOVE 'F' TO RC811-SEVERITY-IND                         06080045
060810           MOVE '16'    TO TM007-RETURN-CODE                      06081079
060820           MOVE SQLCODE TO TM007-SQLCODE                          06082083
060830           MOVE SQLCA   TO TM007-SQLCA                            06083083
060840           MOVE '1500'  TO TM007-RETURNED-PARA                    06084079
060900           PERFORM 9900-SOFT-ABORT                                06090045
061000     END-EVALUATE.                                                06100045
061100                                                                  06110045
061200*CHECK FOR LINE TO COPY                                           06120045
061300     EXEC SQL                                                     06130045
061400         SELECT COUNT(*)                                          06140045
061500           INTO :PV-CLONE-COUNT                                   06150045
061600           FROM TRECDIS                                           06160045
061700          WHERE ORD_NBR     = :RC811-PO-NBR                       06170045
061800            AND ORD_LNE_NBR = :DK-CLONE-LINE-NBR                  06180045
061900            AND REC_SEQ_NBR = :RC811-REC-SEQ-NBR                  06190045
062000            AND OPER_UNT_ID = :RC811-OPER-UNIT-ID                 06200045
062100            AND FCLTY_ID    = :RC811-FACILITY-ID                  06210045
062200     END-EXEC.                                                    06220045
062300                                                                  06230045
062400     EVALUATE TRUE                                                06240045
062500       WHEN SQLCODE = +0                                          06250045
062600           CONTINUE                                               06260045
062700                                                                  06270045
062800       WHEN SQLCODE = +100                                        06280045
062900           SET PS-DONE TO TRUE                                    06290045
063000           MOVE 003 TO RC811-RETURN-CODE                          06300045
063100           MOVE 'F' TO RC811-SEVERITY-IND                         06310045
063110           MOVE '17'    TO TM007-RETURN-CODE                      06311080
063120           MOVE SQLCODE TO TM007-SQLCODE                          06312083
063130           MOVE SQLCA   TO TM007-SQLCA                            06313083
063140           MOVE '1500'  TO TM007-RETURNED-PARA                    06314080
063200           PERFORM 9900-SOFT-ABORT                                06320045
063300                                                                  06330045
063400       WHEN OTHER                                                 06340045
063500           SET PS-DONE TO TRUE                                    06350045
063600           MOVE 021 TO RC811-RETURN-CODE                          06360045
063700           MOVE 'F' TO RC811-SEVERITY-IND                         06370045
063710           MOVE '18'    TO TM007-RETURN-CODE                      06371080
063720           MOVE SQLCODE TO TM007-SQLCODE                          06372083
063730           MOVE SQLCA   TO TM007-SQLCA                            06373083
063740           MOVE '1500'  TO TM007-RETURNED-PARA                    06374080
063800           PERFORM 9900-SOFT-ABORT                                06380045
063900     END-EVALUATE.                                                06390045
064000                                                                  06400045
064100******************************************************************06410045
064200 1600-OPEN-CLONE-CSR.                                             06420045
064300                                                                  06430045
064400     EXEC SQL                                                     06440045
064500         OPEN RECDIS-CLONE-CSR                                    06450045
064600     END-EXEC.                                                    06460045
064700                                                                  06470045
064800     EVALUATE TRUE                                                06480045
064900       WHEN SQLCODE = ZERO                                        06490045
065000           SET PS-RECDIS-CLONE-CSR-YES TO TRUE                    06500045
065100                                                                  06510045
065200       WHEN OTHER                                                 06520045
065300           SET PS-RECDIS-CLONE-CSR-EOF TO TRUE                    06530045
065400           MOVE 021 TO RC811-RETURN-CODE                          06540045
065500           MOVE 'F' TO RC811-SEVERITY-IND                         06550045
065510           MOVE '19'    TO TM007-RETURN-CODE                      06551081
065520           MOVE SQLCODE TO TM007-SQLCODE                          06552083
065530           MOVE SQLCA   TO TM007-SQLCA                            06553083
065540           MOVE '1600'  TO TM007-RETURNED-PARA                    06554081
065600           PERFORM 9900-SOFT-ABORT                                06560045
065700     END-EVALUATE.                                                06570045
065800                                                                  06580045
065900************************S*****************************************06590099
066000 1700-FETCH-CLONE-CSR.                                            06600045
066100                                                                  06610045
066200     EXEC SQL                                                     06620045
066300         FETCH RECDIS-CLONE-CSR                                   06630045
066400          INTO :RECDIS-STR-NBR                                    06640045
066500             , :PV-EXPTED-ITM-QTY                                 06650045
066600             , :PV-VERIFY-ITM-QTY                                 06660045
066700             , :RECDIS-PLAN-ITM-QTY                               06670045
066800     END-EXEC.                                                    06680045
066900                                                                  06690045
067000     EVALUATE TRUE                                                06700045
067100       WHEN SQLCODE = ZERO                                        06710045
067200           SET PS-RECDIS-CLONE-CSR-YES TO TRUE                    06720045
067300                                                                  06730045
067400       WHEN SQLCODE = +100                                        06740045
067500           SET PS-RECDIS-CLONE-CSR-EOF TO TRUE                    06750045
067600                                                                  06760045
067700       WHEN OTHER                                                 06770045
067710           SET PS-RECDIS-CLONE-CSR-EOF TO TRUE                    06771050
067800           MOVE 021 TO RC811-RETURN-CODE                          06780045
067900           MOVE 'F' TO RC811-SEVERITY-IND                         06790045
067910           MOVE '20'    TO TM007-RETURN-CODE                      06791081
067920           MOVE SQLCODE TO TM007-SQLCODE                          06792083
067930           MOVE SQLCA   TO TM007-SQLCA                            06793083
067940           MOVE '1700'  TO TM007-RETURNED-PARA                    06794081
068000           PERFORM 9900-SOFT-ABORT                                06800045
068100     END-EVALUATE.                                                06810045
068200                                                                  06820045
068300******************************************************************06830045
068400 1800-PROCESS-CLONE.                                              06840045
068500                                                                  06850045
068600*CALL DPKCS277 FOR STORE 'OTR'/PLAN-QTY                           06860045
068700*10/11 - ONLY CALL DP277 IF PLAN-ITM-QTY > ZERO                   06870045
068710                                                                  06871099
068720     IF  PS-FIRST-PASS                                            06872099
068800         INITIALIZE DP277-COMMAREA                                06880099
068810     END-IF.                                                      06881099
068820                                                                  06882099
068900     IF RECDIS-PLAN-ITM-QTY > +0                                  06890045
068910         IF  PS-FIRST-PASS                                        06891099
069000             PERFORM 1810-CALL-OTR-SUBROUTINE                     06900099
069010             SET  PS-FIRST-PASS-NO  TO  TRUE                      06901099
069400         END-IF                                                   06940099
069410     END-IF.                                                      06941099
069500                                                                  06950045
069600*PREPARE RECDIS FOR INSERT                                        06960045
069700     PERFORM 1820-LOAD-RECDIS-VALUES.                             06970045
069800                                                                  06980045
069900*INSERT RECDIS (CLONE)                                            06990045
070000     PERFORM 1830-INSERT-RECDIS.                                  07000045
070100                                                                  07010045
070200*GET NEXT RECDIS ROW                                              07020045
070300     PERFORM 1700-FETCH-CLONE-CSR.                                07030045
070400                                                                  07040045
070500******************************************************************07050045
070600 1810-CALL-OTR-SUBROUTINE.                                        07060045
070700                                                                  07070045
070800     MOVE 'S'                   TO   DP277-OTR-TYPE.              07080045
070900     MOVE 'R'                   TO   DP277-OTR-SCOPE.             07090045
071000     MOVE 'M'                   TO   DP277-STORE-PLAN-SCOPE.      07100045
071100                                                                  07110045
071200     INITIALIZE                 DP277-KEYS.                       07120045
071300                                                                  07130045
071400     MOVE RC811-PO-NBR          TO   DP277-PO-NBR.                07140045
071500     MOVE RC811-MODIFY-LINE-NBR TO   DP277-PO-LNE-NBR.            07150045
071600     MOVE RC811-REC-SEQ-NBR     TO   DP277-REC-SEQ-NBR.           07160045
071700     MOVE RC811-OPER-UNIT-ID    TO   DP277-OPER-UNT-ID.           07170045
071800     MOVE RC811-PREPK-ID        TO   DP277-PO-PREPK-ID.           07180045
071900     MOVE RC811-FACILITY-ID     TO   DP277-FCLTY-ID.              07190045
072000                                                                  07200045
072121     CALL PC-TMKUT019 USING DP277-COMMAREA                        07212196
072130                            TM007-COMMUNICATIONS-AREA             07213096
072211                                                                  07221199
072212*  CHECK DP277-RETURN-CODE                                        07221299
072213     EVALUATE TRUE                                                07221399
072214     WHEN DP277-RETURN-CODE = ZERO                                07221499
072215         CONTINUE                                                 07221599
072216     WHEN OTHER                                                   07221699
072217         EVALUATE TRUE                                            07221799
072218         WHEN DP277-SOFT-ABORT                                    07221899
072219             PERFORM 9999-GOBACK                                  07221999
072220                                                                  07222099
072221         WHEN DP277-NO-DISTRO                                     07222199
072222             CONTINUE                                             07222299
072223                                                                  07222399
072224         WHEN OTHER                                               07222499
072225             MOVE 997 TO RC811-RETURN-CODE                        07222599
072226             PERFORM 9999-GOBACK                                  07222699
072227         END-EVALUATE                                             07222799
072228     END-EVALUATE.                                                07222899
072229                                                                  07222999
072263                                                                  07226399
072264 4210-SEARCH-OTR.                                                 07226499
072265                                                                  07226599
072270     IF DP277-LINE-LEVEL-OTR                                      07227099
072271                                                                  07227199
072276         SET DP277-LNE-IDX TO 1                                   07227699
072277         SEARCH DP277-LNE-WORK-AREA                               07227799
072278         AT END                                                   07227899
072279             CONTINUE                                             07227999
072280         WHEN DP277-LNE-NBR (DP277-LNE-IDX) = ZERO                07228099
072281*  LINE NUMBER IS ZERO WHEN THERE IS NO STORE DISTRIBUTION        07228199
072282             MOVE ALL '*'            TO DP277-OTR-OUT-X           07228299
072283                                        DP277-ORDER-QTY-X         07228399
072284         WHEN DP277-LNE-NBR (DP277-LNE-IDX) = DP277-SEARCH-NBR    07228499
072285*  PROCESS OTR UNITS                                              07228599
072286             MOVE DP277-LNE-OTR-QTY (DP277-LNE-IDX)               07228699
072287                                     TO DP277-OTR-OUT             07228799
072288             MOVE DP277-LNE-DISTRO-OTR (DP277-LNE-IDX)            07228899
072289                                     TO DP277-DISTRO-OTR-OUT      07228999
072290             ADD  DP277-LNE-OTR-QTY (DP277-LNE-IDX)               07229099
072291                                     TO DP277-TOTAL-OTR           07229199
072292             ADD  DP277-LNE-DISTRO-OTR (DP277-LNE-IDX)            07229299
072293                                     TO DP277-TOTAL-DISTRO-OTR    07229399
072294*  PROCESS OTR PACK QUANTITY                                      07229499
072295             MOVE DP277-LNE-OTR-PK  (DP277-LNE-IDX)               07229599
072296                                     TO DP277-PK-OTR-OUT          07229699
072297             ADD  DP277-LNE-OTR-PK  (DP277-LNE-IDX)               07229799
072298                                     TO DP277-TOTAL-PK-OTR        07229899
072299             MOVE DP277-LNE-OTR-QTY-X (DP277-LNE-IDX)             07229999
072300                                     TO DP277-OTR-OUT-X           07230099
072301*  PROCESS STORE DISTRO UNITS                                     07230199
072302             MOVE DP277-LNE-DISTRO-QTY (DP277-LNE-IDX)            07230299
072303                                     TO DP277-ORDER-QTY           07230399
072304             MOVE DP277-LNE-DISTRO-QTY-X (DP277-LNE-IDX)          07230499
072305                                     TO DP277-ORDER-QTY-X         07230599
072306*  PROCESS STORE DISTRO PACK QUANTITY                             07230699
072307             MOVE DP277-LNE-DISTRO-PK  (DP277-LNE-IDX)            07230799
072308                                     TO DP277-ORDER-PK-QTY        07230899
072309         END-SEARCH                                               07230999
072310     END-IF.                                                      07231099
072311                                                                  07231199
072312     IF DP277-STORE-LEVEL-OTR                                     07231299
072317                                                                  07231799
072318         SET DP277-STR-IDX TO 1                                   07231899
072319         SEARCH DP277-STR-WORK-AREA                               07231999
072320         AT END                                                   07232099
072321             CONTINUE                                             07232199
072322         WHEN DP277-STORE-NBR (DP277-STR-IDX) = ZERO              07232299
072323*  STORE NUMBER IS ZERO WHEN THERE IS NO STORE DISTRIBUTION       07232399
072324             MOVE ALL '*'            TO DP277-OTR-OUT-X           07232499
072325                                        DP277-ORDER-QTY-X         07232599
072326         WHEN DP277-STORE-NBR (DP277-STR-IDX) = DP277-SEARCH-NBR  07232699
072327*  PROCESS OTR UNITS                                              07232799
072332                                                                  07233299
072333             MOVE DP277-STR-OTR-QTY (DP277-STR-IDX)               07233399
072334                                     TO DP277-OTR-OUT             07233499
072335             MOVE DP277-STR-DISTRO-OTR (DP277-STR-IDX)            07233599
072336                                     TO DP277-DISTRO-OTR-OUT      07233699
072337             ADD  DP277-STR-OTR-QTY (DP277-STR-IDX)               07233799
072338                                     TO DP277-TOTAL-OTR           07233899
072339             ADD  DP277-STR-DISTRO-OTR (DP277-STR-IDX)            07233999
072340                                     TO DP277-TOTAL-DISTRO-OTR    07234099
072341*  PROCESS OTR PACK QUANTITY                                      07234199
072342             MOVE DP277-STR-OTR-PK  (DP277-STR-IDX)               07234299
072343                                     TO DP277-PK-OTR-OUT          07234399
072344             ADD  DP277-STR-OTR-PK  (DP277-STR-IDX)               07234499
072345                                     TO DP277-TOTAL-PK-OTR        07234599
072346             MOVE DP277-STR-OTR-QTY-X (DP277-STR-IDX)             07234699
072347                                     TO DP277-OTR-OUT-X           07234799
072348*  PROCESS STORE DISTRO UNITS                                     07234899
072349             MOVE DP277-STR-DISTRO-QTY (DP277-STR-IDX)            07234999
072350                                     TO DP277-ORDER-QTY           07235099
072351             MOVE DP277-STR-DISTRO-QTY-X (DP277-STR-IDX)          07235199
072352                                     TO DP277-ORDER-QTY-X         07235299
072353*  PROCESS STORE DISTRO PACK QUANTITY                             07235399
072354             MOVE DP277-STR-DISTRO-PK  (DP277-STR-IDX)            07235499
072355                                     TO DP277-ORDER-PK-QTY        07235599
072356         END-SEARCH                                               07235699
072357     END-IF.                                                      07235799
072358                                                                  07235899
072359                                                                  07235999
072360******************************************************************07236045
072400 1820-LOAD-RECDIS-VALUES.                                         07240045
072500                                                                  07250045
072600     MOVE RC811-PO-NBR          TO RECDIS-ORD-NBR.                07260045
072700     MOVE RC811-MODIFY-LINE-NBR TO RECDIS-ORD-LNE-NBR.            07270045
072800     MOVE RC811-REC-SEQ-NBR     TO RECDIS-REC-SEQ-NBR.            07280045
072900     MOVE RC811-OPER-UNIT-ID    TO RECDIS-OPER-UNT-ID.            07290045
073000     MOVE 1                     TO RECDIS-FCLTY-ID.               07300045
073100                                                                  07310045
073200     MOVE PC-RC811-UID          TO RECDIS-CRE-UID.                07320045
073300     MOVE PC-ACTIVE             TO RECDIS-VER-STATUS-CDE.         07330045
073400                                                                  07340045
073500*CALCULATE RATIOS.                                                07350045
073600     COMPUTE PV-FACTOR = PV-MODIFY-RATIO-QTY                      07360045
073700                       / PV-CLONE-RATIO-QTY.                      07370045
073800     COMPUTE PV-NEW-EXPTED-COMPUTED-QTY ROUNDED =                 07380045
073900                         PV-EXPTED-ITM-QTY                        07390045
074000                       * PV-FACTOR.                               07400045
074100     COMPUTE PV-NEW-VERIFY-COMPUTED-QTY ROUNDED =                 07410045
074200                         PV-VERIFY-ITM-QTY                        07420045
074300                       * PV-FACTOR.                               07430045
074400     MOVE PV-NEW-EXPTED-COMPUTED-QTY TO RECDIS-EXPTED-ITM-QTY.    07440045
074500     MOVE PV-NEW-VERIFY-COMPUTED-QTY TO RECDIS-VERIFY-ITM-QTY.    07450045
074600                                                                  07460045
074700     MOVE 0                     TO RECDIS-AP-VERIFY-ITM-QTY.      07470045
074800                                                                  07480045
074900     IF RECDIS-PLAN-ITM-QTY > +0                                  07490045
075000       MOVE RECDIS-STR-NBR        TO DP277-SEARCH-NBR             07500045
075100       PERFORM 4210-SEARCH-OTR                                    07510045
075200     ELSE                                                         07520099
075300         MOVE  ZEROES           TO DP277-OTR-OUT                  07530099
075400     END-IF.                                                      07540045
075500                                                                  07550045
075800     MOVE 1                     TO RECDIS-STR-FCLTY-ID.           07580045
075900     MOVE SPACES                TO RECDIS-AP-PRC-CDE.             07590045
076000                                                                  07600045
076100     COMPUTE PV-NEW-PLAN-COMPUTED-QTY ROUNDED =                   07610045
076200                                DP277-OTR-OUT.                    07620099
076400     MOVE PV-NEW-PLAN-COMPUTED-QTY TO RECDIS-PLAN-ITM-QTY.        07640045
076500                                                                  07650045
076800     MOVE PC-DEFAULT-DATE            TO RECDIS-AP-PRC-DTE.        07680045
076900                                                                  07690045
077000******************************************************************07700045
077100 1830-INSERT-RECDIS.                                              07710045
077200                                                                  07720045
077300     EXEC SQL                                                     07730045
077400         INSERT                                                   07740045
077500           INTO TRECDIS                                           07750045
077600                (ORD_NBR                                          07760045
077700                ,ORD_LNE_NBR                                      07770045
077800                ,REC_SEQ_NBR                                      07780045
077900                ,OPER_UNT_ID                                      07790045
078000                ,FCLTY_ID                                         07800045
078100                ,CRE_TMST                                         07810045
078200                ,CRE_UID                                          07820045
078300                ,VER_STATUS_CDE                                   07830045
078400                ,EXPTED_ITM_QTY                                   07840045
078500                ,VERIFY_ITM_QTY                                   07850045
078600                ,AP_VERIFY_ITM_QTY                                07860045
078700                ,STR_NBR                                          07870045
078800                ,STR_FCLTY_ID                                     07880045
078900                ,PLAN_ITM_QTY                                     07890045
079000                ,AP_PRC_CDE                                       07900045
079100                ,AP_PRC_DTE                                       07910045
079200                  )                                               07920045
079300          VALUES                                                  07930045
079400                 (:RECDIS-ORD-NBR                                 07940045
079500                , :RECDIS-ORD-LNE-NBR                             07950045
079600                , :RECDIS-REC-SEQ-NBR                             07960045
079700                , :RECDIS-OPER-UNT-ID                             07970045
079800                , :RECDIS-FCLTY-ID                                07980045
079900                , CURRENT TIMESTAMP                               07990045
080000                , :RECDIS-CRE-UID                                 08000045
080100                , :RECDIS-VER-STATUS-CDE                          08010045
080200                , :RECDIS-EXPTED-ITM-QTY                          08020045
080300                , :RECDIS-VERIFY-ITM-QTY                          08030045
080400                , :RECDIS-AP-VERIFY-ITM-QTY                       08040045
080500                , :RECDIS-STR-NBR                                 08050045
080600                , :RECDIS-STR-FCLTY-ID                            08060045
080700                , :RECDIS-PLAN-ITM-QTY                            08070045
080800                , :RECDIS-AP-PRC-CDE                              08080045
080900                , :RECDIS-AP-PRC-DTE                              08090045
081000                  )                                               08100045
081100     END-EXEC.                                                    08110045
081200                                                                  08120045
081300     EVALUATE TRUE                                                08130045
081400       WHEN SQLCODE = ZERO                                        08140045
081500           CONTINUE                                               08150045
081600                                                                  08160045
081700       WHEN SQLCODE = -904                                        08170045
081800       WHEN SQLCODE = -911                                        08180045
081900       WHEN SQLCODE = -913                                        08190045
081910           SET PS-RECDIS-CLONE-CSR-EOF TO TRUE                    08191050
082000           MOVE 021 TO RC811-RETURN-CODE                          08200045
082100           MOVE 'F' TO RC811-SEVERITY-IND                         08210045
082110           MOVE '21'    TO TM007-RETURN-CODE                      08211081
082120           MOVE SQLCODE TO TM007-SQLCODE                          08212083
082130           MOVE SQLCA   TO TM007-SQLCA                            08213083
082140           MOVE '1830'  TO TM007-RETURNED-PARA                    08214081
082200           PERFORM 9900-SOFT-ABORT                                08220045
082300                                                                  08230045
082400       WHEN OTHER                                                 08240045
082410           SET PS-RECDIS-CLONE-CSR-EOF TO TRUE                    08241050
082500           MOVE '1830-INSERT-RECDIS' TO PV-MESSAGE-TEXT           08250066
082510           DISPLAY PV-MESSAGE-TEXT                                08251066
082600           MOVE 'INSERT NEW ROW IN TRECDIS TABLE'                 08260045
082700                                     TO PV-MESSAGE-TEXT           08270066
082710           DISPLAY PV-MESSAGE-TEXT                                08271066
082800           MOVE 021 TO RC811-RETURN-CODE                          08280066
082900           MOVE 'F' TO RC811-SEVERITY-IND                         08290066
082910           MOVE '22'    TO TM007-RETURN-CODE                      08291081
082920           MOVE SQLCODE TO TM007-SQLCODE                          08292083
082930           MOVE SQLCA   TO TM007-SQLCA                            08293083
082940           MOVE '1830'  TO TM007-RETURNED-PARA                    08294081
083000           PERFORM 9900-SOFT-ABORT                                08300066
083200     END-EVALUATE.                                                08320045
083300                                                                  08330045
083400******************************************************************08340045
083500 1900-CLOSE-CLONE-CSR.                                            08350045
083600                                                                  08360045
083700     EXEC SQL                                                     08370045
083800         CLOSE RECDIS-CLONE-CSR                                   08380045
083900     END-EXEC.                                                    08390045
084000                                                                  08400045
084100     EVALUATE TRUE                                                08410045
084200       WHEN SQLCODE = ZERO                                        08420045
084300           CONTINUE                                               08430045
084400                                                                  08440045
084500       WHEN OTHER                                                 08450045
084600           MOVE 021 TO RC811-RETURN-CODE                          08460045
084700           MOVE 'F' TO RC811-SEVERITY-IND                         08470045
084710           MOVE '23'    TO TM007-RETURN-CODE                      08471081
084720           MOVE SQLCODE TO TM007-SQLCODE                          08472083
084730           MOVE SQLCA   TO TM007-SQLCA                            08473083
084740           MOVE '1900'  TO TM007-RETURNED-PARA                    08474081
084800           PERFORM 9900-SOFT-ABORT                                08480045
084900     END-EVALUATE.                                                08490045
085000                                                                  08500045
085100******************************************************************08510045
085200*  THIS PARAGRAPH WILL RECALIBRATE A PACK'S LINE QUANTITIES IN    08520045
085300*  RECDIS TO CORRESPOND TO THE RECEIPT RATIO UPDATED IN RECITM    08530045
085400******************************************************************08540045
085500 2000-CONVERT-RATIO.                                              08550045
085600                                                                  08560045
085700     PERFORM 2100-OPEN-RECDIS-HOLD-CSR.                           08570045
085800                                                                  08580045
085900*MODIFY PASSED LINE NBR                                           08590045
086000     PERFORM 2200-FETCH-RECDIS-HOLD-CSR.                          08600045
086100     IF PS-RECDIS-HOLD-CSR-EOF                                    08610045
086200         MOVE 003 TO RC811-RETURN-CODE                            08620045
086300         MOVE 'W' TO RC811-SEVERITY-IND                           08630045
086400     ELSE                                                         08640045
086500         PERFORM 2300-PROCESS-RECDIS                              08650045
086600           UNTIL PS-RECDIS-HOLD-CSR-EOF                           08660045
086700     END-IF.                                                      08670045
086800                                                                  08680045
086900     PERFORM 2400-CLOSE-RECDIS-HOLD-CSR.                          08690045
087000                                                                  08700045
087100******************************************************************08710045
087200 2100-OPEN-RECDIS-HOLD-CSR.                                       08720045
087300                                                                  08730045
087400     EXEC SQL                                                     08740045
087500         OPEN RECDIS-HOLD-CSR                                     08750045
087600     END-EXEC.                                                    08760045
087700                                                                  08770045
087800     EVALUATE TRUE                                                08780045
087900       WHEN SQLCODE = ZERO                                        08790045
088000           SET PS-RECDIS-HOLD-CSR-YES TO TRUE                     08800045
088100                                                                  08810045
088200       WHEN OTHER                                                 08820045
088300           SET PS-RECDIS-HOLD-CSR-EOF TO TRUE                     08830045
088400           MOVE 005 TO RC811-RETURN-CODE                          08840045
088500           MOVE 'F' TO RC811-SEVERITY-IND                         08850045
088510           MOVE '24'    TO TM007-RETURN-CODE                      08851085
088520           MOVE SQLCODE TO TM007-SQLCODE                          08852083
088530           MOVE SQLCA   TO TM007-SQLCA                            08853083
088540           MOVE '2100'  TO TM007-RETURNED-PARA                    08854082
088600           PERFORM 9900-SOFT-ABORT                                08860045
088700     END-EVALUATE.                                                08870045
088800                                                                  08880045
088900******************************************************************08890045
089000 2200-FETCH-RECDIS-HOLD-CSR.                                      08900045
089100                                                                  08910045
089200     EXEC SQL                                                     08920045
089300         FETCH RECDIS-HOLD-CSR                                    08930045
089400          INTO :RECDIS-STR-NBR                                    08940045
089500             , :PV-EXPTED-ITM-QTY                                 08950045
089600             , :PV-VERIFY-ITM-QTY                                 08960045
089700             , :PV-PLAN-ITM-QTY                                   08970045
089800     END-EXEC.                                                    08980045
089900                                                                  08990045
090000     EVALUATE TRUE                                                09000045
090100       WHEN SQLCODE = ZERO                                        09010045
090200           SET PS-RECDIS-HOLD-CSR-YES TO TRUE                     09020045
090300                                                                  09030045
090400       WHEN SQLCODE = +100                                        09040045
090500           SET PS-RECDIS-HOLD-CSR-EOF TO TRUE                     09050045
090600                                                                  09060045
090700       WHEN OTHER                                                 09070045
090800           MOVE 005 TO RC811-RETURN-CODE                          09080045
090900           MOVE 'F' TO RC811-SEVERITY-IND                         09090045
090910           MOVE '25'    TO TM007-RETURN-CODE                      09091085
090920           MOVE SQLCODE TO TM007-SQLCODE                          09092083
090930           MOVE SQLCA   TO TM007-SQLCA                            09093083
090940           MOVE '2200'  TO TM007-RETURNED-PARA                    09094082
091000           PERFORM 9900-SOFT-ABORT                                09100045
091100     END-EVALUATE.                                                09110045
091200                                                                  09120045
091300******************************************************************09130045
091400 2300-PROCESS-RECDIS.                                             09140045
091500                                                                  09150045
091600*CALCULATE NEW RATIOS.                                            09160045
091700     COMPUTE PV-FACTOR = RC811-NEW-RC-RATIO                       09170045
091800                       / RC811-OLD-DISTRO-RATIO.                  09180045
091900     COMPUTE PV-NEW-EXPTED-COMPUTED-QTY ROUNDED =                 09190045
092000                         PV-EXPTED-ITM-QTY                        09200045
092100                       * PV-FACTOR.                               09210045
092200     COMPUTE PV-NEW-VERIFY-COMPUTED-QTY ROUNDED =                 09220045
092300                         PV-VERIFY-ITM-QTY                        09230045
092400                       * PV-FACTOR.                               09240045
092500                                                                  09250045
092600*MODIFY RECDIS                                                    09260045
092700     EXEC SQL                                                     09270045
092800         UPDATE TRECDIS                                           09280045
092900            SET EXPTED_ITM_QTY = :PV-NEW-EXPTED-COMPUTED-QTY      09290045
093000              , VERIFY_ITM_QTY = :PV-NEW-VERIFY-COMPUTED-QTY      09300045
093100          WHERE CURRENT OF RECDIS-HOLD-CSR                        09310045
093200     END-EXEC.                                                    09320045
093300                                                                  09330045
093400     EVALUATE TRUE                                                09340045
093500       WHEN SQLCODE = ZERO                                        09350045
093600           MOVE 001 TO RC811-RETURN-CODE                          09360045
093700           MOVE 'N' TO RC811-SEVERITY-IND                         09370045
093800                                                                  09380045
093900       WHEN OTHER                                                 09390045
094000           SET PS-RECDIS-HOLD-CSR-EOF TO TRUE                     09400045
094100           MOVE 005 TO RC811-RETURN-CODE                          09410045
094200           MOVE 'F' TO RC811-SEVERITY-IND                         09420045
094210           MOVE '26'    TO TM007-RETURN-CODE                      09421085
094220           MOVE SQLCODE TO TM007-SQLCODE                          09422084
094230           MOVE SQLCA   TO TM007-SQLCA                            09423084
094240           MOVE '2300'  TO TM007-RETURNED-PARA                    09424084
094300           PERFORM 9900-SOFT-ABORT                                09430045
094400     END-EVALUATE.                                                09440045
094500                                                                  09450045
094600*GET NEXT RECDIS ROW                                              09460045
094700     IF PS-RECDIS-HOLD-CSR-YES                                    09470045
094800         PERFORM 2600-UPDATE-ODD-UNIT                             09480045
094900         PERFORM 2200-FETCH-RECDIS-HOLD-CSR                       09490045
095000     END-IF.                                                      09500045
095100                                                                  09510045
095200******************************************************************09520045
095300 2400-CLOSE-RECDIS-HOLD-CSR.                                      09530045
095400                                                                  09540045
095500     EXEC SQL                                                     09550045
095600         CLOSE RECDIS-HOLD-CSR                                    09560045
095700     END-EXEC.                                                    09570045
095800                                                                  09580045
095900     EVALUATE TRUE                                                09590045
096000       WHEN SQLCODE = ZERO                                        09600045
096100           CONTINUE                                               09610045
096200                                                                  09620045
096300       WHEN OTHER                                                 09630045
096400           MOVE 005 TO RC811-RETURN-CODE                          09640045
096500           MOVE 'F' TO RC811-SEVERITY-IND                         09650045
096510           MOVE '27'    TO TM007-RETURN-CODE                      09651085
096520           MOVE SQLCODE TO TM007-SQLCODE                          09652084
096530           MOVE SQLCA   TO TM007-SQLCA                            09653084
096540           MOVE '2400'  TO TM007-RETURNED-PARA                    09654084
096600           PERFORM 9900-SOFT-ABORT                                09660045
096700     END-EVALUATE.                                                09670045
096800                                                                  09680045
096900 2600-UPDATE-ODD-UNIT.                                            09690045
097000                                                                  09700045
097100     EXEC SQL                                                     09710045
097200          UPDATE RCT_VRFD_ODD_UNT                                 09720045
097300            SET  DC_VRFY_ODU_QTY = :PV-NEW-EXPTED-COMPUTED-QTY    09730045
097400                ,AP_VRFY_ODU_QTY = :PV-NEW-VERIFY-COMPUTED-QTY    09740045
097500                                                                  09750045
097600            WHERE PO_NBR         = :RC811-PO-NBR                  09760045
097700              AND PO_LNE_NBR     = :RC811-MODIFY-LINE-NBR         09770045
097800              AND RCVR_SEQ_NBR   = :RC811-REC-SEQ-NBR             09780045
097900     END-EXEC.                                                    09790045
098000                                                                  09800045
098100     EVALUATE TRUE                                                09810045
098200         WHEN SQLCODE = ZERO                                      09820045
098300         WHEN SQLCODE = +100                                      09830045
098400              CONTINUE                                            09840045
098500                                                                  09850045
098600         WHEN SQLWARN0 NOT = SPACES                               09860045
098700         WHEN SQLCODE  NOT = ZERO                                 09870045
098800              MOVE 005 TO RC811-RETURN-CODE                       09880045
098900              MOVE 'F' TO RC811-SEVERITY-IND                      09890045
098910              MOVE '28'    TO TM007-RETURN-CODE                   09891085
098920              MOVE SQLCODE TO TM007-SQLCODE                       09892085
098930              MOVE SQLCA   TO TM007-SQLCA                         09893085
098940              MOVE '2600'  TO TM007-RETURNED-PARA                 09894085
099000              PERFORM 9900-SOFT-ABORT                             09900045
099100                                                                  09910045
099200     END-EVALUATE.                                                09920045
099300                                                                  09930045
099400                                                                  09940045
099500******************************************************************09950045
099600*  THIS PARAGRAPH WILL DELETE ONE LINE                            09960045
099700*  FOR ALL STORE ALLOCATIONS IN RECDIS                            09970045
099800******************************************************************09980045
099900 3000-DELETE-LINE.                                                09990045
100000                                                                  10000045
100100*DELETE PASSED LINE NBR                                           10010045
100200     MOVE RC811-DELETE-LINE-NBR TO DK-LINE-NBR-LOW                10020045
100300                                   DK-LINE-NBR-HIGH.              10030045
100400     PERFORM 3100-DELETE-RECDIS.                                  10040045
100500     PERFORM 3200-DELETE-ODD-UNIT.                                10050045
100600                                                                  10060045
100700******************************************************************10070045
100800 3100-DELETE-RECDIS.                                              10080045
100900                                                                  10090045
101000     PERFORM WITH TEST AFTER                                      10100045
101100       VARYING PV-RETRY-COUNTER FROM 1 BY 1                       10110045
101200         UNTIL (PV-RETRY-COUNTER > PC-MAX-RETRIES                 10120045
101300          OR SQLCODE = 0 OR SQLCODE = +100)                       10130045
101400                                                                  10140045
101500         EXEC SQL                                                 10150045
101600             DELETE FROM TRECDIS                                  10160045
101700              WHERE ORD_NBR      = :RC811-PO-NBR                  10170045
101800                AND REC_SEQ_NBR  = :RC811-REC-SEQ-NBR             10180045
101900                AND OPER_UNT_ID  = :RC811-OPER-UNIT-ID            10190045
102000                AND FCLTY_ID     = :RC811-FACILITY-ID             10200045
102100                AND (ORD_LNE_NBR > :DK-LINE-NBR-LOW               10210045
102200                 OR  ORD_LNE_NBR = :DK-LINE-NBR-LOW)              10220045
102300                AND (ORD_LNE_NBR < :DK-LINE-NBR-HIGH              10230045
102400                 OR  ORD_LNE_NBR = :DK-LINE-NBR-HIGH)             10240045
102500         END-EXEC                                                 10250045
102600                                                                  10260045
102700         EVALUATE TRUE                                            10270045
102800           WHEN SQLCODE = 0                                       10280045
102900               MOVE 006 TO RC811-RETURN-CODE                      10290045
103000               MOVE 'N' TO RC811-SEVERITY-IND                     10300045
103100                                                                  10310045
103200           WHEN SQLCODE = +100                                    10320045
103300               MOVE 009 TO RC811-RETURN-CODE                      10330045
103400               MOVE 'W' TO RC811-SEVERITY-IND                     10340045
103410               MOVE SQLCODE TO TM007-SQLCODE                      10341095
103420               MOVE SQLCA   TO TM007-SQLCA                        10342095
103500                                                                  10350045
103600           WHEN OTHER                                             10360045
103700               MOVE 010 TO RC811-RETURN-CODE                      10370045
103800               MOVE 'F' TO RC811-SEVERITY-IND                     10380045
103810               MOVE '29'    TO TM007-RETURN-CODE                  10381085
103820               MOVE SQLCODE TO TM007-SQLCODE                      10382085
103830               MOVE SQLCA   TO TM007-SQLCA                        10383085
103840               MOVE '3100'  TO TM007-RETURNED-PARA                10384085
103900               PERFORM 9900-SOFT-ABORT                            10390045
104000         END-EVALUATE                                             10400045
104100     END-PERFORM.                                                 10410045
104200                                                                  10420045
104300 3200-DELETE-ODD-UNIT.                                            10430045
104400                                                                  10440045
104500     EXEC SQL                                                     10450045
104600          DELETE                                                  10460045
104700            FROM RCT_VRFD_ODD_UNT                                 10470045
104800            WHERE PO_NBR       = :RC811-PO-NBR                    10480045
104900              AND RCVR_SEQ_NBR = :RC811-REC-SEQ-NBR               10490045
105000              AND (PO_LNE_NBR  > :DK-LINE-NBR-LOW                 10500045
105100               OR  PO_LNE_NBR  = :DK-LINE-NBR-LOW)                10510045
105200              AND (PO_LNE_NBR  < :DK-LINE-NBR-HIGH                10520045
105300               OR  PO_LNE_NBR  = :DK-LINE-NBR-HIGH)               10530045
105400     END-EXEC.                                                    10540045
105500                                                                  10550045
105600     EVALUATE TRUE                                                10560045
105700         WHEN SQLCODE = ZERO                                      10570045
105800         WHEN SQLCODE = +100                                      10580045
105900              CONTINUE                                            10590045
106000                                                                  10600045
106100         WHEN SQLWARN0 NOT = SPACES                               10610045
106200         WHEN SQLCODE  NOT = ZERO                                 10620045
106300              MOVE 010 TO RC811-RETURN-CODE                       10630045
106400              MOVE 'F' TO RC811-SEVERITY-IND                      10640045
106410              MOVE '30'    TO TM007-RETURN-CODE                   10641086
106420              MOVE SQLCODE TO TM007-SQLCODE                       10642086
106430              MOVE SQLCA   TO TM007-SQLCA                         10643086
106440              MOVE '3200'  TO TM007-RETURNED-PARA                 10644086
106500              PERFORM 9900-SOFT-ABORT                             10650045
106600                                                                  10660045
106700     END-EVALUATE.                                                10670045
106800                                                                  10680045
106900                                                                  10690045
107000******************************************************************10700045
107100*  THIS PARAGRAPH WILL DELETE THE ENTIRE PACK                     10710045
107200*  FOR ALL STORE ALLOCATIONS IN RECDIS                            10720045
107300******************************************************************10730045
107400 4000-DELETE-PACK.                                                10740045
107500                                                                  10750045
107600     SET PS-MORE-RECITM-YES TO TRUE.                              10760045
107700                                                                  10770045
107800     PERFORM 4100-OPEN-SELECT-RECITM-CSR.                         10780045
107900                                                                  10790045
108000*PROCESS ALL RECITM/RECDIS WITH PREPK-ID.                         10800045
108100     PERFORM 4200-PROCESS-SELECT-RECITM                           10810045
108200       UNTIL PS-MORE-RECITM-NO.                                   10820045
108300                                                                  10830045
108400     PERFORM 4300-CLOSE-SELECT-RECITM-CSR.                        10840045
108500                                                                  10850045
108600******************************************************************10860045
108700 4100-OPEN-SELECT-RECITM-CSR.                                     10870045
108800                                                                  10880045
108900     EXEC SQL                                                     10890045
109000         OPEN SELECT-RECITM-CSR                                   10900045
109100     END-EXEC.                                                    10910045
109200                                                                  10920045
109300     EVALUATE TRUE                                                10930045
109400       WHEN SQLCODE = ZERO                                        10940045
109500           CONTINUE                                               10950045
109600                                                                  10960045
109700       WHEN OTHER                                                 10970045
109800           SET PS-MORE-RECITM-NO TO TRUE                          10980045
109900           MOVE 015 TO RC811-RETURN-CODE                          10990045
110000           MOVE 'F' TO RC811-SEVERITY-IND                         11000045
110010           MOVE '31'    TO TM007-RETURN-CODE                      11001086
110020           MOVE SQLCODE TO TM007-SQLCODE                          11002086
110030           MOVE SQLCA   TO TM007-SQLCA                            11003086
110040           MOVE '4100'  TO TM007-RETURNED-PARA                    11004086
110100           PERFORM 9900-SOFT-ABORT                                11010045
110200                                                                  11020045
110300     END-EVALUATE.                                                11030045
110400                                                                  11040045
110500******************************************************************11050045
110600 4200-PROCESS-SELECT-RECITM.                                      11060045
110700                                                                  11070045
110800     PERFORM 4210-FETCH-SELECT-RECITM.                            11080045
110900                                                                  11090045
111000*DELETE PACK LINES                                                11100045
111100     IF PS-MORE-RECITM-YES                                        11110045
111200         MOVE RECITM-ORD-LNE-NBR TO DK-LINE-NBR-LOW               11120045
111300         PERFORM 4220-DELETE-RECDIS                               11130045
111400         PERFORM 4230-DELETE-ODD-UNIT                             11140045
111500     END-IF.                                                      11150045
111600                                                                  11160045
111700******************************************************************11170045
111800 4210-FETCH-SELECT-RECITM.                                        11180045
111900                                                                  11190045
112000     EXEC SQL                                                     11200045
112100         FETCH  SELECT-RECITM-CSR                                 11210045
112200          INTO :RECITM-ORD-LNE-NBR                                11220045
112300     END-EXEC.                                                    11230045
112400                                                                  11240045
112500     EVALUATE TRUE                                                11250045
112600       WHEN SQLCODE = ZERO                                        11260045
112700           CONTINUE                                               11270045
112800                                                                  11280045
112900       WHEN SQLCODE = +100                                        11290045
113000           SET PS-MORE-RECITM-NO TO TRUE                          11300045
113100                                                                  11310045
113200       WHEN OTHER                                                 11320045
113300           SET PS-MORE-RECITM-NO TO TRUE                          11330045
113400           MOVE 015 TO RC811-RETURN-CODE                          11340045
113500           MOVE 'F' TO RC811-SEVERITY-IND                         11350045
113510           MOVE '32'    TO TM007-RETURN-CODE                      11351086
113520           MOVE SQLCODE TO TM007-SQLCODE                          11352086
113530           MOVE SQLCA   TO TM007-SQLCA                            11353086
113540           MOVE '4210'  TO TM007-RETURNED-PARA                    11354086
113600           PERFORM 9900-SOFT-ABORT                                11360045
113700                                                                  11370045
113800     END-EVALUATE.                                                11380045
113900                                                                  11390045
114000******************************************************************11400045
114100 4220-DELETE-RECDIS.                                              11410045
114200                                                                  11420045
114300     PERFORM WITH TEST AFTER                                      11430045
114400       VARYING PV-RETRY-COUNTER FROM 1 BY 1                       11440045
114500         UNTIL (PV-RETRY-COUNTER > PC-MAX-RETRIES                 11450045
114600          OR SQLCODE = 0 OR SQLCODE = +100)                       11460045
114700                                                                  11470045
114800         EXEC SQL                                                 11480045
114900             DELETE FROM TRECDIS                                  11490045
115000              WHERE ORD_NBR      = :RC811-PO-NBR                  11500045
115100                AND REC_SEQ_NBR  = :RC811-REC-SEQ-NBR             11510045
115200                AND OPER_UNT_ID  = :RC811-OPER-UNIT-ID            11520045
115300                AND FCLTY_ID     = :RC811-FACILITY-ID             11530045
115400                AND ORD_LNE_NBR  = :DK-LINE-NBR-LOW               11540045
115500         END-EXEC                                                 11550045
115600                                                                  11560045
115700         EVALUATE TRUE                                            11570045
115800           WHEN SQLCODE = 0                                       11580045
115900               MOVE 016 TO RC811-RETURN-CODE                      11590045
116000               MOVE 'N' TO RC811-SEVERITY-IND                     11600045
116100                                                                  11610045
116200           WHEN SQLCODE = +100                                    11620045
116300               MOVE 013 TO RC811-RETURN-CODE                      11630045
116400               MOVE 'W' TO RC811-SEVERITY-IND                     11640045
116500                                                                  11650045
116600           WHEN OTHER                                             11660045
116700               SET PS-MORE-RECITM-NO TO TRUE                      11670045
116800               MOVE 015 TO RC811-RETURN-CODE                      11680045
116900               MOVE 'F' TO RC811-SEVERITY-IND                     11690045
116910               MOVE '33'    TO TM007-RETURN-CODE                  11691087
116920               MOVE SQLCODE TO TM007-SQLCODE                      11692087
116930               MOVE SQLCA   TO TM007-SQLCA                        11693087
116940               MOVE '4220'  TO TM007-RETURNED-PARA                11694087
117000               PERFORM 9900-SOFT-ABORT                            11700045
117100         END-EVALUATE                                             11710045
117200     END-PERFORM.                                                 11720045
117300                                                                  11730045
117400******************************************************************11740045
117500 4230-DELETE-ODD-UNIT.                                            11750045
117600                                                                  11760045
117700     EXEC SQL                                                     11770045
117800          DELETE                                                  11780045
117900            FROM RCT_VRFD_ODD_UNT                                 11790045
118000            WHERE PO_NBR       = :RC811-PO-NBR                    11800045
118100              AND RCVR_SEQ_NBR = :RC811-REC-SEQ-NBR               11810045
118200              AND PO_LNE_NBR   = :DK-LINE-NBR-LOW                 11820045
118300     END-EXEC.                                                    11830045
118400                                                                  11840045
118500     EVALUATE TRUE                                                11850045
118600         WHEN SQLCODE = ZERO                                      11860045
118700         WHEN SQLCODE = +100                                      11870045
118800              CONTINUE                                            11880045
118900                                                                  11890045
119000         WHEN SQLWARN0 NOT = SPACES                               11900045
119100         WHEN SQLCODE  NOT = ZERO                                 11910045
119200              MOVE 010 TO RC811-RETURN-CODE                       11920045
119300              MOVE 'F' TO RC811-SEVERITY-IND                      11930045
119310              MOVE '34'    TO TM007-RETURN-CODE                   11931088
119320              MOVE SQLCODE TO TM007-SQLCODE                       11932088
119330              MOVE SQLCA   TO TM007-SQLCA                         11933088
119340              MOVE '4230'  TO TM007-RETURNED-PARA                 11934088
119400              PERFORM 9900-SOFT-ABORT                             11940045
119500                                                                  11950045
119600     END-EVALUATE.                                                11960045
119700                                                                  11970045
119800                                                                  11980045
119900******************************************************************11990045
120000 4300-CLOSE-SELECT-RECITM-CSR.                                    12000045
120100                                                                  12010045
120200     EXEC SQL                                                     12020045
120300         CLOSE SELECT-RECITM-CSR                                  12030045
120400     END-EXEC.                                                    12040045
120500                                                                  12050045
120600     EVALUATE TRUE                                                12060045
120700       WHEN SQLCODE = ZERO                                        12070045
120800           CONTINUE                                               12080045
120900                                                                  12090045
121000       WHEN OTHER                                                 12100045
121100           MOVE 015 TO RC811-RETURN-CODE                          12110045
121200           MOVE 'F' TO RC811-SEVERITY-IND                         12120045
121210           MOVE '35'    TO TM007-RETURN-CODE                      12121088
121220           MOVE SQLCODE TO TM007-SQLCODE                          12122088
121230           MOVE SQLCA   TO TM007-SQLCA                            12123088
121240           MOVE '4300'  TO TM007-RETURNED-PARA                    12124089
121300           PERFORM 9900-SOFT-ABORT                                12130045
121400                                                                  12140045
121500     END-EVALUATE.                                                12150045
121600                                                                  12160045
121700******************************************************************12170045
121800*  THIS PARAGRAPH CHECKS FOR VERIFIED LINES IN A PACK             12180045
121900******************************************************************12190045
122000 5000-COUNT-RECITM.                                               12200045
122100                                                                  12210045
122200     MOVE ZEROES TO PV-DB2-COUNT.                                 12220045
122300                                                                  12230045
122400     EXEC SQL                                                     12240045
122500         SELECT COUNT(*)                                          12250045
122600           INTO :PV-DB2-COUNT                                     12260045
122700           FROM TRECITM                                           12270045
122800          WHERE ORD_NBR         = :RC811-PO-NBR                   12280045
122900            AND REC_SEQ_NBR     = :RC811-REC-SEQ-NBR              12290045
123000            AND OPER_UNT_ID     = :RC811-OPER-UNIT-ID             12300045
123100            AND FCLTY_ID        = :RC811-FACILITY-ID              12310045
123200            AND PREPK_ID        = :RC811-PREPK-ID                 12320045
123300            AND STATUS_CDE     IN ('VE')                          12330045
123400            AND VER_STATUS_CDE  = :PC-A                           12340045
123500     END-EXEC.                                                    12350045
123600                                                                  12360045
123700     EVALUATE TRUE                                                12370045
123800       WHEN SQLCODE = +0                                          12380045
123900       WHEN SQLCODE = +100                                        12390045
124000           CONTINUE                                               12400045
124100                                                                  12410045
124500       WHEN OTHER                                                 12450045
124600           SET PS-DONE TO TRUE                                    12460045
124700           MOVE 025 TO RC811-RETURN-CODE                          12470045
124800           MOVE 'F' TO RC811-SEVERITY-IND                         12480045
124810           MOVE '36'    TO TM007-RETURN-CODE                      12481089
124820           MOVE SQLCODE TO TM007-SQLCODE                          12482089
124830           MOVE SQLCA   TO TM007-SQLCA                            12483089
124840           MOVE '5000'  TO TM007-RETURNED-PARA                    12484089
124900           PERFORM 9900-SOFT-ABORT                                12490045
125000                                                                  12500045
126100     END-EVALUATE.                                                12610045
126200                                                                  12620045
126300******************************************************************12630045
126400 5100-COUNT-DISTHD.                                               12640045
126500                                                                  12650045
126600     MOVE ZEROES TO PV-DB2-COUNT.                                 12660045
126700                                                                  12670045
128600     EXEC SQL                                                     12860045
128700         SELECT COUNT(*)                                          12870045
128800           INTO :PV-DB2-COUNT                                     12880045
128900           FROM TRECITM A,                                        12890045
129000                TDISTHD B                                         12900045
129100          WHERE  A.ORD_NBR        = :RC811-PO-NBR                 12910045
129200            AND  A.REC_SEQ_NBR    = :RC811-REC-SEQ-NBR            12920045
129300            AND  A.PREPK_ID       = :RC811-PREPK-ID               12930045
129400                                                                  12940045
129500            AND  B.ORD_NBR        =  A.ORD_NBR                    12950045
129600            AND  B.RCVR_SEQ_NBR   =  A.REC_SEQ_NBR                12960045
129700            AND  B.ORD_LNE_NBR    =  A.ORD_LNE_NBR                12970045
129800                                                                  12980045
129900            AND  CRE_USR_ID NOT IN ('TRLRUNLD','HOTCMPLT')        12990097
130000            AND  B.TOT_CART_CNT   >  0                            13000045
130100     END-EXEC.                                                    13010045
130200                                                                  13020045
130300     EVALUATE TRUE                                                13030045
130400       WHEN SQLCODE = ZERO                                        13040045
130500       WHEN SQLCODE = +100                                        13050045
130600           CONTINUE                                               13060045
130700                                                                  13070045
131100       WHEN OTHER                                                 13110045
131200           SET PS-DONE TO TRUE                                    13120045
131300           MOVE 027 TO RC811-RETURN-CODE                          13130045
131400           MOVE 'F' TO RC811-SEVERITY-IND                         13140045
131410           MOVE '37'    TO TM007-RETURN-CODE                      13141090
131420           MOVE SQLCODE TO TM007-SQLCODE                          13142090
131430           MOVE SQLCA   TO TM007-SQLCA                            13143090
131440           MOVE '5100'  TO TM007-RETURNED-PARA                    13144090
131500           PERFORM 9900-SOFT-ABORT                                13150045
131600                                                                  13160045
132700         END-EVALUATE.                                            13270045
132800                                                                  13280045
133400******************************************************************13340045
133500*                                                                *13350045
133600*                  A B E N D   R O U T I N E S                   *13360045
133700*                                                                *13370045
133800******************************************************************13380045
133900 9900-SOFT-ABORT.                                                 13390045
134000                                                                  13400045
134100     SET RC811-FATAL-ERROR TO TRUE.                               13410045
134200                                                                  13420045
134300     PERFORM 9950-FORMAT-ERROR-MSG.                               13430045
134400     PERFORM 9999-GOBACK.                                         13440075
134900                                                                  13490045
135000******************************************************************13500045
135100 9950-FORMAT-ERROR-MSG.                                           13510045
135200                                                                  13520045
135300     MOVE SQLCODE                TO PV-SQLCODE                    13530045
135400                                    PV-DISPLAY-SQLCODE.           13540045
135500                                                                  13550045
135600     MOVE RC811-PO-NBR           TO PV-DISP-PO-NBR.               13560045
135700     MOVE RC811-REC-SEQ-NBR      TO PV-DISP-REC-SEQ-NBR.          13570045
135800     MOVE RC811-OPER-UNIT-ID     TO PV-DISP-OPER-UNT-ID.          13580045
135900     MOVE RC811-FACILITY-ID      TO PV-DISP-FCLTY-ID.             13590045
136000     MOVE RC811-PREPK-ID         TO PV-DISP-PREPK-ID.             13600045
136100                                                                  13610045
136200     MOVE RC811-CLONE-LINE-NBR   TO PV-DISP-CLN-LINE.             13620045
136300     MOVE RC811-MODIFY-LINE-NBR  TO PV-DISP-MOD-LINE.             13630045
136400     MOVE RC811-DELETE-LINE-NBR  TO PV-DISP-DLT-LINE.             13640045
136500                                                                  13650045
136600     STRING '** RCKUP811 ** ERROR; ' PV-RETURN-MSG                13660051
136700         DELIMITED BY SIZE                                        13670045
136800         INTO PV-MESSAGE-TEXT.                                    13680063
136810     DISPLAY PV-MESSAGE-TEXT.                                     13681064
136900                                                                  13690045
137000     STRING  ' RC811-RC = ' RC811-RETURN-CODE                     13700045
137100                            '; SQLCODE = ' PV-DISPLAY-SQLCODE     13710045
137200         DELIMITED BY SIZE                                        13720045
137300         INTO PV-MESSAGE-TEXT.                                    13730063
137310     DISPLAY PV-MESSAGE-TEXT.                                     13731064
137400                                                                  13740045
137500     MOVE '  PO    REC  OPER FCLTY PPK   CLONE MDFY DLET'         13750045
137600         TO PV-MESSAGE-TEXT.                                      13760063
137610     DISPLAY PV-MESSAGE-TEXT.                                     13761064
137700                                                                  13770045
137800     STRING PV-DISP-PO-NBR '-' PV-DISP-REC-SEQ-NBR '-'            13780045
137900            PV-DISP-OPER-UNT-ID '-' PV-DISP-FCLTY-ID '-'          13790045
138000            PV-DISP-PREPK-ID '*** ' PV-DISP-CLN-LINE '-'          13800045
138100            PV-DISP-MOD-LINE '-' PV-DISP-DLT-LINE                 13810045
138200         DELIMITED BY SIZE                                        13820045
138300         INTO PV-MESSAGE-TEXT.                                    13830063
138310     DISPLAY PV-MESSAGE-TEXT.                                     13831064
138311                                                                  13831172
138312 9999-GOBACK.                                                     13831291
138320     MOVE RC811-STORE-RECDIS-PROCESSING TO LINK-COMMAREA.         13832072
138330     MOVE TM007-COMMUNICATIONS-AREA     TO LINK-TMRD007.          13833072
138340                                                                  13834072
138345                                                                  13834599
138350     GOBACK.                                                      13835072
