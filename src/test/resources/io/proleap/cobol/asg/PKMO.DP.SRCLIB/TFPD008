      ******************************************************************00010000
      * PROCEDURE DIVISION PORTION OF TRANSFER NUMBER CHECK DIGIT       00020000
      * CALCULATION ROUTINE.                                            00030000
      * ALSO REQUIRES TFWS008.                                          00040000
      * USAGE:                                                          00041000
021605* 1)  MOVE YOUR FROM STORE NUMBER TO TF008-XFER-FROM-STORE-NBR    00042000
021605* 2)  MOVE YOUR SEQUENCE NUMBER TO TF008-XFER-SEQ-NBR             00043000
      * 3)  PERFORM TFPD008-GET-CHK-DIGIT                               00044000
021605* 4)  MOVE TF008-XFER-DIGIT TO YOUR CHECK DIGIT FIELD.            00045000
      ******************************************************************00046000
      * 11/15/2004 - DAVE WELLER - CREATED                              00047000
      ******************************************************************00048000
      * 01/19/2005 - DAVE WELLER - FIXED PROBLEM                        00049000
      ******************************************************************00050000
021605* 02/16/2005 - DAVE WELLER - FIXED PROBLEM                        00060000
      ******************************************************************00070000
      *----------------------------------------------------------------*00080000
      * CALCULATE THE CHECK DIGIT FOR THE TRANSFER NUMBER.              00090000
      *----------------------------------------------------------------*00100000
       TFPD008-GET-CHK-DIGIT.                                           00110000
           PERFORM TFPD008-SUM-XFER-DIGITS                              00120000
021605         VARYING TF008-XFER-IDX                                   00130000
               FROM 1 BY 1                                              00140000
021605         UNTIL TF008-XFER-IDX > 11.                               00150000
                                                                        00160000
           PERFORM TFPD008-COMPUTE-CHK-DIGIT.                           00170000
      *                                                                 00180000
       TFPD008-SUM-XFER-DIGITS.                                         00190000
021605     IF TF008-XFER-DIGIT (TF008-XFER-IDX) > 4                     00200000
021605         COMPUTE TF008-DBL-DIGIT =                                00210000
021605             ((TF008-XFER-DIGIT (TF008-XFER-IDX) * 2) - 9)        00220000
           ELSE                                                         00230000
021605         COMPUTE TF008-DBL-DIGIT =                                00240000
021605             TF008-XFER-DIGIT (TF008-XFER-IDX) * 2                00250000
           END-IF.                                                      00260000
                                                                        00270000
021605     SET TF008-IDX-VALUE     TO  TF008-XFER-IDX.                  00280000
                                                                        00290000
021605     DIVIDE  TF008-IDX-VALUE BY 2                                 00300000
021605         GIVING TF008-QUOTIENT                                    00310000
021605         REMAINDER TF008-REMAINDER                                00320000
           END-DIVIDE.                                                  00330000
                                                                        00340000
021605     IF TF008-REMAINDER = ZERO                                    00350000
021605         COMPUTE TF008-DIGIT-SUM =                                00360000
021605             TF008-DIGIT-SUM + TF008-DBL-DIGIT                    00370000
           ELSE                                                         00380000
021605         COMPUTE TF008-DIGIT-SUM =                                00390000
021605             TF008-DIGIT-SUM +                                    00400000
021605                     TF008-XFER-DIGIT (TF008-XFER-IDX)            00410000
           END-IF.                                                      00420000
      *                                                                 00430000
       TFPD008-COMPUTE-CHK-DIGIT.                                       00440000
021605     DIVIDE  TF008-DIGIT-SUM BY 10                                00450000
021605         GIVING TF008-QUOTIENT                                    00460000
021605         REMAINDER TF008-REMAINDER                                00470000
           END-DIVIDE.                                                  00480000
      *                                                                 00490000
021605     IF TF008-REMAINDER = ZERO                                    00500000
021605         MOVE ZERO           TO TF008-CHK-DIGIT                   00510000
           ELSE                                                         00520000
021605         COMPUTE TF008-CHK-DIGIT =                                00530000
021605             10  -  TF008-REMAINDER                               00540000
           END-IF.                                                      00550000
