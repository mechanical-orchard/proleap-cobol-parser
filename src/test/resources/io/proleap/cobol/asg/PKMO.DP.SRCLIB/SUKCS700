000100******************************************************************00010000
000200 IDENTIFication DIVISION.                                         00020000
000300******************************************************************00030000
000400 PROGRAM-ID.             SUKCS700.                                00040000
000500 AUTHOR.                 DENISE HAHN.                             00050000
000600 INSTALLATION.           KOHLS DEPARTMENT STORE.                  00060000
000700 DATE-WRITTEN            MAY, 2023.                               00070000
000800 DATE-COMPILED.                                                   00080000
000810******************************************************************00081000
000820* CALLED MODULE - THIN SLICE LOGIC                               *00082000
000830*  MAINFRAME MODERNIZATION                                       *00083000
000840******************************************************************00084000
000841*                                                                *00084100
000842* This module will be used for the Mainframe Modernization       *00084200
000843* process to determine if a carton being received will be        *00084300
000844* selected for thin slice - to be processed (received) by new    *00084400
000845* application.  This is for PNA receiving.  It will eventually   *00084500
000846* be rolled out to rf receiving.                                 *00084600
000847*                                                                *00084700
000848******************************************************************00084800
000849*                                                                *00084900
000850*  SUKCS700 is called by PNA SUKCS771                            *00085000
000860*  -  TKRPRPM - THNSLC is set to Y for DC                        *00086000
000870*             this parm says the DC it using the thin slice      *00087000
000880*             process                                            *00088000
000890*                                                                *00089000
000900*  -  WST parm:  THNSLCCKIN this parm is set up by DC/PNA/Door   *00090000
000910*             if the carton being checked in is from the         *00091000
000920*             DC/PNA Station/Receiving door                      *00092000
000930*             NOte: for RF Checkin PNA Station is 0              *00093000
000940*                                                                *00094000
000950*  - If both parms are Y - then SUKCS771 will call SUKCS700      *00095000
000960*                                                                *00096000
000970*                                                                *00097000
000980* 1.  check po tracking to see if the po-rcvr has already been   *00098000
000990*     selected or rejected for thin slice.                       *00099000
001000*     RCT_PO_RCVR_TRKG                                           *00100000
001100*         0L - Receiver Not Eligible for Thin Slice              *00110000
001200*         0M - Receiver selected for Thin Slice                  *00120000
001210*     If there is a row for the po-rcvr for either code then no  *00121000
001220*     additional checking is needed.  Send the data back to the  *00122000
001230*     calling program.                                           *00123000
001240*     If there is NOT a 0L or 0M row for the PO-RCVR then        *00124000
001250*     continue to the next step.                                 *00125000
001260*                                                                *00126000
001270* 2.  Check PO-RCVR Packaging Type                               *00127000
001280*                                                                *00128000
001290*     If PBS receiver check WST Parm THNSLCPBS to see if the     *00129000
001291*     DC is checking PBS orders for Thin Slice.  This sql will   *00129100
001292*     also bring back the max # of carton that can be on the     *00129200
001293*     Rcvr                                                       *00129300
001294*     --- PBS check---                                           *00129400
001295*     PBS order & DC is NOT checking PBS Thin Slice then insert  *00129500
001296*     a row into the tracking table RCT_PO_RCVR_TRKG (0L)        *00129600
001297*     No additional checking will be needed,  Send the data back *00129700
001298*     to the calling program.                                    *00129800
001299*                                                                *00129900
001300*     PBS order & DC is checking PBS Thin Slice then continue    *00130000
001301*     with Step 3.                                               *00130100
001302*                                                                *00130200
001303*     --- BULK check ---                                         *00130300
001304*     If BULK receiver check WST Parm THNSLCBULK to see if the   *00130400
001305*     DC is checking BULK orders for Thin Slice.  This sql will  *00130500
001306*     also bring back the max # of carton that can be on the     *00130600
001307*     Rcvr                                                       *00130700
001308*                                                                *00130800
001309*     Bulk order & DC is NOT checking BULK Thin Slice then insert*00130900
001310*     a row into the tracking table RCT_PO_RCVR_TRKG (0L)        *00131000
001311*     No additional checking will be needed,  Send the data back *00131100
001312*     to the calling program.                                    *00131200
001313*                                                                *00131300
001314*     BULK order & DC is checking BULK Thin Slice then continue  *00131400
001315*     with Step 3. Note inital process will ONLY be checking PBS.*00131500
001316*                                                                *00131600
001317*     --- PREPK check ---                                        *00131700
001318*     If Prepk receiver check WST Parm THNSLCPRPK to see if the  *00131800
001319*     DC is checking PREPK orders for Thin Slice.  This sql will *00131900
001320*     also bring back the max # of carton that can be on the     *00132000
001321*     Rcvr                                                       *00132100
001322*                                                                *00132200
001323*     PREPK order & DC is NOT checking Prepk thin Slice then     *00132300
001324*     insert a row into the tracking table RCT_PO_RCVR_TRKG (0L) *00132400
001325*     No additional checking will be needed,  Send the data back *00132500
001326*     to the calling program.                                    *00132600
001327*                                                                *00132700
001328*     PREPK order & DC is checking PREPK Thin Slice then continue*00132800
001329*     with Step 3. Note inital process will ONLY be checking PBS.*00132900
001330*                                                                *00133000
001331* 3.  Count the number of cartons(SSCC's) that are part of the   *00133100
001332*     po-rcvr.                                                   *00133200
001333*     If the number of cartons on the PO-Receiver is MORE the    *00133300
001334*     the max number of cartons on the parm, then this PO-RCVR   *00133400
001335*     is not eligible for thin slice.                            *00133500
001336*     insert a row into the tracking table RCT_PO_RCVR_TRKG (0L) *00133600
001337*     No additional checking will be needed,  Send the data back *00133700
001338*     to the calling program.                                    *00133800
001339*                                                                *00133900
001340*     If the number of cartons on the PO-RCVR is less than (<=)  *00134000
001341*     the max number of cartons on the parm, then continue       *00134100
001342*     checking Step 4.                                           *00134200
001343*                                                                *00134300
001344* 4.  Have receiving already started for the PO-RCVR.            *00134400
001345*     If cartons have already been checked in for the po-rcvr    *00134500
001346*     the the po-rcvr is NOT eligible for thin slice.            *00134600
001347*     insert a row into the tracking table RCT_PO_RCVR_TRKG (0L) *00134700
001348*     No additional checking will be needed,  Send the data back *00134800
001349*     to the calling program.                                    *00134900
001350*                                                                *00135000
001351*     If NO cartons have been check in for the PO-RCVR then      *00135100
001352*     continue checking Step 5.                                  *00135200
001353*                                                                *00135300
001354* 5.  PBS Order - and there are PBS errors for the po-rcvr then  *00135400
001355*     the po-rcvr is not eligible for thin slice.                *00135500
001356*     insert a row into the tracking table RCT_PO_RCVR_TRKG (0L) *00135600
001357*     No additional checking will be needed,  Send the data back *00135700
001358*     to the calling program.                                    *00135800
001359*                                                                *00135900
001360*     PBS Order and NO PBS Errors, continue checking step 6.     *00136000
001361*                                                                *00136100
001362* 6.  EAS Tagging for PO-RCVR?  If EAS Tagging is required then  *00136200
001363*     the po-rcvr is not eligible for thin slice.                *00136300
001364*     insert a row into the tracking table RCT_PO_RCVR_TRKG (0L) *00136400
001365*     No additional checking will be needed,  Send the data back *00136500
001366*     to the calling program.                                    *00136600
001367*                                                                *00136700
001368*     if NO EAS Tagging is required, continue checking step 7.   *00136800
001369*                                                                *00136900
001370* 7.  call new audit module (SUKCS752-no update) to see if the   *00137000
001371*     po-rcvr needs a carton audit.  If carton audit is needed   *00137100
001372*     then the po-rcvr is not eligible for thin slice.           *00137200
001373*     insert a row into the tracking table RCT_PO_RCVR_TRKG (0L) *00137300
001374*     No additional checking will be needed,  Send the data back *00137400
001375*     to the calling program.                                    *00137500
001376*                                                                *00137600
001377*     if NO AUDIT is required, then this order is eligible for   *00137700
001378*     thin slice.                                                *00137800
001379*     insert a row into the tracking table RCT_PO_RCVR_TRKG (0M) *00137900
001380*     No additional checking will be needed,  Send the data back *00138000
001381*     to the calling program.                                    *00138100
001382*                                                                *00138200
001383******************************************************************00138300
001384* 6/7/2023 - add logic to add stop ve trouble when the order has *00138400
001385* been selected for thin slice.                                  *00138500
001386******************************************************************00138600
001387 ENVIRONMENT DIVISION.                                            00138700
001388 DATA DIVISION.                                                   00138800
001389******************************************************************00138900
001390 WORKING-STORAGE SECTION.                                         00139000
001391*                                                                 00139100
001392 01  DK-DB2-KEYS.                                                 00139200
001400     05  DK-OPER-UNT-ID           PIC  S9(04)       COMP.         00140000
001500     05  DK-TRIP-ID               PIC  S9(09)       COMP.         00150000
001600     05  DK-DOOR-NUMBER           PIC   X(04) VALUE SPACE.        00160000
001700     05  DK-ACM-LBL-STA-NBR       PIC  S9(09)       COMP.         00170000
001800     05  DK-BAR-CODE              PIC  S9(18) VALUE ZEROS.        00180000
001900     05  DK-ORD-NBR               PIC  S9(9)        COMP.         00190000
002000     05  DK-REC-SEQ-NBR           PIC  S9(9)        COMP.         00200000
002100     05  DK-ORD-LNE-NBR           PIC  S9(9)        COMP.         00210000
002200     05  DK-PREPK-ID              PIC  S9(4)        COMP.         00220000
002300     05  DK-PACK-BY-ST-IND        PIC   X(01).                    00230000
002400     05  DK-PBS-CDE               PIC   X(01).                    00240000
002500         88  DK-PBS                              VALUE 'Y'.       00250000
002600         88  DK-PBS-NO                           VALUE ' ', 'N'.  00260000
002700     05  DK-PKGNG-CDE             PIC   X(1).                     00270000
002800         88  DK-PREPACK                          VALUE 'M'.       00280000
002900         88  DK-BULK                             VALUE 'B'.       00290000
003000                                                                  00300000
003100                                                                  00310000
003200*----------------------------------------------------------------*00320000
003300* COMMAREA USED FOR THIN SLICE MODULE                             00330000
003400*----------------------------------------------------------------*00340000
003500     COPY SUWS109.                                                00350000
003600                                                                  00360000
003700*----------------------------------------------------------------*00370000
003800* COMMAREA USED FOR CARTON AUDIT CHECK MODULE                     00380000
003900*----------------------------------------------------------------*00390000
004000     COPY SURD021.                                                00400000
004100                                                                  00410000
004110*----------------------------------------------------------------*00411008
004120* COMMAREA USED FOR SUKUT149 - EAS TAGGING MODULE                 00412008
004130*----------------------------------------------------------------*00413008
004140     COPY SUWS093.                                                00414008
004150                                                                  00415008
004200******************************************************************00420000
004300*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA                00430000
004400******************************************************************00440000
004500     COPY DPWS013.                                                00450000
004600                                                                  00460000
004610*----------------------------------------------------------------*00461000
004620* COMMAREA USED FOR TROUBLE MODULE - TMKCS521                     00462000
004630*----------------------------------------------------------------*00463000
004640     COPY TMWS500.                                                00464000
004650                                                                  00465000
004700*----------------------------------------------------------------*00470000
004800*  PROGRAM CONSTANTS                                             *00480000
004900*----------------------------------------------------------------*00490000
005000 01  PC-PROGRAM-CONSTANTS.                                        00500000
005100     05  PC-THIN-SLICE-MOD        PIC  X(08)  VALUE 'SUKCS700'.   00510000
005200     05  PC-SUKCS752              PIC  X(08)  VALUE 'SUKCS752'.   00520000
005210     05  PC-TMKCS521              PIC  X(08)  VALUE 'TMKCS521'.   00521000
005211     05  PC-433                   PIC S9(04)  COMP VALUE +433.    00521101
005300     05  PC-NOT-ELIGIBLE-THN-SLC  PIC  X(02)  VALUE '0L'.         00530000
005400     05  PC-ELIGIBLE-THN-SLC      PIC  X(02)  VALUE '0M'.         00540000
005500                                                                  00550000
005600     05  PC-LOG-QUEUE             PIC  X(04)  VALUE 'CSSL'.       00560000
005700     05  PC-MSG-TABLE-SIZE        PIC S9(03) COMP-3 VALUE 200.    00570000
005800                                                                  00580000
005900                                                                  00590000
006000*----------------------------------------------------------------*00600000
006100*  PROGRAM SWITCHES                                              *00610000
006200*----------------------------------------------------------------*00620000
006300 01  PS-PROGRAM-SWITCHES.                                         00630000
006400     05  PS-SHOW-DEBUG-SW                PIC  X(01)  VALUE 'N'.   00640000
006500         88  PS-DONT-SHOW-DEBUG-INFO                 VALUE 'N'.   00650000
006600         88  PS-SHOW-DEBUG-INFO                      VALUE 'Y'.   00660000
006700     05  PS-DC-PO-BYPASSED-SW            PIC  X(01)  VALUE 'N'.   00670000
006800         88  PS-DC-PO-BYPASSED-YES                   VALUE 'Y'.   00680000
006900         88  PS-DC-PO-BYPASSED-NO                    VALUE 'N'.   00690000
007000     05  PS-DC-THIN-SLICE-PBS-SW         PIC  X(01)  VALUE 'N'.   00700000
007100         88  PS-DC-THIN-SLICE-PBS-YES                VALUE 'Y'.   00710000
007200         88  PS-DC-THIN-SLICE-PBS-NO                 VALUE 'N'.   00720000
007300     05  PS-DC-THIN-SLICE-BULK-SW        PIC  X(01)  VALUE 'N'.   00730000
007400         88  PS-DC-THIN-SLICE-BULK-YES               VALUE 'Y'.   00740000
007500         88  PS-DC-THIN-SLICE-BULK-NO                VALUE 'N'.   00750000
007600     05  PS-DC-THIN-SLICE-PREPK-SW       PIC  X(01)  VALUE 'N'.   00760000
007700         88  PS-DC-THIN-SLICE-PREPK-YES              VALUE 'Y'.   00770000
007800         88  PS-DC-THIN-SLICE-PREPK-NO               VALUE 'N'.   00780000
007900     05  PS-BLD-INTERNAL-TABLE-SW        PIC  X(01)  VALUE 'N'.   00790000
008000         88  PS-BLD-INTERNAL-TABLE-YES               VALUE 'Y'.   00800000
008100         88  PS-BLD-INTERNAL-TABLE-NO                VALUE 'N'.   00810000
008200     05  PS-DUMP-TO-LOG-SW               PIC X(01)   VALUE 'N'.   00820000
008300         88  PS-DONT-DUMP-TO-LOG                     VALUE 'N'.   00830000
008310         88  PS-DUMP-TO-LOG                          VALUE 'Y'.   00831000
008320                                                                  00832000
008330                                                                  00833000
008340                                                                  00834000
008350*----------------------------------------------------------------*00835000
008360*  PROGRAM VARIABLES                                             *00836000
008370*----------------------------------------------------------------*00837000
008380 01  PV-PROGRAM-VARIABLES.                                        00838000
008390     05  PV-PARM-SECONDS                 PIC S9(09) COMP VALUE 0. 00839000
008400     05  PV-CURRENT-PARA-TMST            PIC  X(26).              00840000
008500     05  PV-RECEIVE-RQST-TMST            PIC X(26).               00850000
008600     05  PV-RECEIVE-RQST-TMST-R REDEFINES PV-RECEIVE-RQST-TMST.   00860000
008700         10  FILLER                      PIC  X(11).              00870000
008800         10  PV-INIT-HH                  PIC  9(02).              00880000
008900         10  FILLER                      PIC  X(01).              00890000
009000         10  PV-INIT-MM                  PIC  9(02).              00900000
009100         10  FILLER                      PIC  X(01).              00910000
009200         10  PV-INIT-SS                  PIC  9(02).              00920000
009300         10  FILLER                      PIC  X(07).              00930000
009400     05  PV-INIT-TIME-KEY.                                        00940000
009500         10  PV-INIT-KEY-HH              PIC  9(02).              00950000
009600         10  PV-INIT-KEY-MM              PIC  9(02).              00960000
009700         10  PV-INIT-KEY-SS              PIC  9(02).              00970000
009800     05  PV-CICS-MSG-AREA                PIC  X(100) VALUE SPACES.00980000
009900                                                                  00990000
010000     05  PV-OPER-UNT-ID                  PIC  S9(4) COMP.         01000005
010001                                                                  01000105
010010     05  pv-DISP-OPER                    PIC 9(04).               01001004
010100     05  PV-DISP-PO                      PIC 9(09).               01010000
010200     05  PV-DISP-RCVR                    PIC 9(04).               01020000
010300     05  PV-DISP-LINE                    PIC 9(04).               01030000
010400     05  PV-DISP-PREPK                   PIC 9(04).               01040000
010500     05  PV-DISP-SSCC                    PIC 9(18).               01050000
010600     05  PV-DISP-PNA-STA                 PIC 9(04).               01060000
010700     05  PV-DISP-TRIP                    PIC 9(09).               01070000
010800     05  PV-DISP-TASK                    PIC 9(07).               01080000
010900     05  PV-DISP-MSG-NBR                 PIC 9(03).               01090000
011000     05  PV-DISP-SQL                     PIC -999.                01100000
011100     05  PV-DISP-COUNT                   PIC ZZZ,ZZZ,ZZ9.         01110000
011200                                                                  01120000
011300     05  PV-DC-FUNC-CDE                  PIC X(02).               01130000
011400         88 PV-NOT-THIN-SLICE-ELIGIBLE               VALUE '0L'.  01140000
011500         88 PV-THIN-SLICE-ELIGIBLE                   VALUE '0M'.  01150000
011600         88 PV-THIN-SLICE-NOT-CHECKED                VALUE '  '.  01160000
011700                                                                  01170000
011800     05  PV-MAX-CRTNS                     PIC S9(10)V9(5) COMP-3. 01180000
011900     05  PV-MAX-RCVRS                     PIC S9(10)V9(5) COMP-3. 01190000
012000     05  PV-CARTONS-ON-RCVR               PIC S9(09)  COMP.       01200000
012100     05  PV-ELIGIBLE-PBS-RCVRS            PIC S9(09)  COMP.       01210000
012200     05  PV-ELIGIBLE-BULK-RCVRS           PIC S9(09)  COMP.       01220000
012300     05  PV-ELIGIBLE-PREPK-RCVRS          PIC S9(09)  COMP.       01230000
012400                                                                  01240000
012500     05  PV-PBS-ERROR-CNT                 PIC S9(09)  COMP.       01250000
012600     05  PV-PBS-CHECKED-IN-CNT            PIC S9(09)  COMP.       01260000
012700     05  PV-PBS-EAS-CNT                   PIC S9(09)  COMP.       01270000
012800     05  PV-PBS-AUDIT-CNT                 PIC S9(09)  COMP.       01280000
012900                                                                  01290000
013000     05  PV-BULK-ERROR-CNT                PIC S9(09)  COMP.       01300000
013100     05  PV-BULK-CHECKED-IN-CNT           PIC S9(09)  COMP.       01310000
013200     05  PV-BULK-EAS-CNT                  PIC S9(09)  COMP.       01320000
013300     05  PV-BULK-AUDIT-CNT                PIC S9(09)  COMP.       01330000
013400                                                                  01340000
013500     05  PV-PREPK-ERROR-CNT               PIC S9(09)  COMP.       01350000
013600     05  PV-PREPK-CHECKED-IN-CNT          PIC S9(09)  COMP.       01360000
013700     05  PV-PREPK-EAS-CNT                 PIC S9(09)  COMP.       01370000
013800     05  PV-PREPK-AUDIT-CNT               PIC S9(09)  COMP.       01380000
013900                                                                  01390000
014000     05  PV-DISP-DURATION                 PIC  9(09) VALUE ZEROS. 01400000
014010     05  PV-DISP-PARM-SECONDS             PIC  9(09) VALUE ZEROS. 01401000
014020     05  PV-DURATION-SEC                  PIC S9(09) COMP VALUE 0.01402000
014030     05  PV-DURATION-NANO-SEC             PIC S9(10) COMP VALUE 0.01403000
014031     05  PV-WORK-NANO-SEC                 PIC  9(10) VALUE ZEROES.01403100
014032     05  PV-WORK-NANO-SEC-REDEF REDEFINES PV-WORK-NANO-SEC.       01403200
014033         10  PV-WORK-NANO-MIN-1-2         PIC  9(02).             01403300
014034         10  PV-WORK-NANO-SEC-3-4         PIC  9(02).             01403400
014035         10  PV-WORK-NANO-MICRO-5-10      PIC  9(06).             01403500
014036     05  PV-DISP-NANO-SEC                 PIC  X(12).             01403600
014037     05  PV-DISP-NANO-SEC-REDEF REDEFINES PV-DISP-NANO-SEC.       01403700
014038         10  PV-DISP-NANO-MIN-1-2         PIC  9(02).             01403800
014039         10  PV-DISP-NANO-DASH-1          PIC  X(01).             01403900
014040         10  PV-DISP-NANO-SEC-3-4         PIC  9(02).             01404000
014041         10  PV-DISP-NANO-DASH-2          PIC  X(01).             01404100
014042         10  PV-DISP-NANO-MICRO-5-10      PIC  9(06).             01404200
014043                                                                  01404300
014044     05  PV-EIBTASKN                      PIC Z(06)9.             01404400
014045     05  PV-CSSL-PARA                     PIC  X(04) VALUE SPACES.01404500
014046     05  PV-PREV-SEQUENCE                 PIC S9(05) COMP-3       01404600
014047                                                      VALUE ZERO. 01404700
014048     05  PV-NEXT-SEQUENCE                 PIC S9(05) COMP-3       01404800
014049                                                     VALUE ZERO.  01404900
014050                                                                  01405000
014060                                                                  01406000
014070 01  TS-TEMP-STORAGE-QUEUE-INFO.                                  01407000
014080     05  TS-INFO-QUEUE-NAME.                                      01408000
014090         10  TS-INFO-QUEUE-TERMINAL      PIC  X(04)  VALUE SPACE. 01409000
014100         10  FILLER                      PIC  X(04)  VALUE 'INFO'.01410000
014200                                                                  01420000
014300                                                                  01430000
014400*----------------------------------------------------------------*01440000
014500* PARAGRAPH TRACKING TABLE - USED FOR DEBUGGING                  *01450000
014600* WILL TRACK PARAGRAPHS IN THIS TABLE - IF WE SEE TRANSACTION    *01460000
014700* IF TAKING LONGER THEN X SECONDS TO RESPOND, WILL DUMP THE      *01470000
014800* TABLE TO CSSL                                                  *01480000
014900* PARM PATIM4                                                    *01490000
015000*----------------------------------------------------------------*01500000
015100 01  PT-PARA-TRACKING-TABLE.                                      01510000
015200     05  PT-ENTRIES               OCCURS 1500 TIMES               01520000
015300                                  INDEXED BY PT-TRACK-IDX.        01530000
015400         10 FILLER                PIC  X(01) VALUE SPACE.         01540000
015500         10 PT-PROGRAM            PIC  X(08) VALUE 'SUKCS771'.    01550000
015600         10 FILLER                PIC  X(01) VALUE SPACE.         01560000
015700         10 pt-dc                 PIC  9(04) VALUE zeroes.        01570000
015800         10 filler                PIC  X(01) VALUE '-'.           01580000
015900         10 PT-crtn-oper          PIC  9(04) VALUE zeroes.        01590000
016000         10 filler                PIC  X(01) VALUE '-'.           01600000
016100         10 pt-start-hhmmss       PIC  9(06) VALUE zeroes.        01610000
016200         10 FILLER                PIC  X(01) VALUE SPACE.         01620000
016300         10 PT-INDEX-NBR          PIC  9(05) VALUE ZEROES.        01630000
016400         10 FILLER                PIC  X(01) VALUE SPACE.         01640000
016500         10 PT-paragraph          PIC  X(04) VALUE SPACE.         01650000
016600         10 FILLER                PIC  X(01) VALUE SPACE.         01660000
016700         10 PT-TIMESTAMP          PIC  X(26) VALUE SPACE.         01670000
016800         10 FILLER                PIC  X(01) VALUE SPACE.         01680000
016900         10 PT-DURATION           PIC  9(09) VALUE ZEROES.        01690000
017000         10 FILLER                PIC  X(01) VALUE SPACE.         01700000
017100         10 PT-nano-sec           PIC  x(12) VALUE ZEROES.        01710000
017200     05  PT-MAX-PARA-ENTRIES      PIC  9(04) VALUE 1500.          01720000
017300     05  PT-CURR-ENTRIES          PIC  9(04) VALUE ZEROES.        01730000
017400     05  PT-CURR-PARA             PIC  X(04) VALUE SPACES.        01740000
017500                                                                  01750000
017600                                                                  01760000
017700 01  PT-MSG-TABLE.                                                01770000
017800     05  PT-MSG-LINES OCCURS 200 TIMES                            01780000
017900                              INDEXED BY PT-MSG-IDX.              01790000
018000         10  PT-MSG-SEQ                  PIC S9(05) COMP-3.       01800000
018100         10  PT-MSG-LINE                 PIC X(69).               01810000
018200                                                                  01820000
018300     05  PV-COMMAREA-LENGTH              PIC S9(04)  COMP         01830000
018400                                                     VALUE ZERO.  01840000
018500     05  PV-CICS-RESP                    PIC S9(08)  VALUE ZEROS  01850000
018600                                                     COMP SYNC.   01860000
018700                                                                  01870000
018800*---------------------------------------------------------------* 01880000
018900*    PO TRACKING TABLE - RCT_PO_RCVR_TRKG                       * 01890000
019000*---------------------------------------------------------------* 01900000
019100     EXEC SQL                                                     01910000
019200          INCLUDE RCT00017                                        01920000
019300     END-EXEC.                                                    01930000
019400                                                                  01940000
019500*---------------------------------------------------------------* 01950000
019600*    PARM TABLE                                                 * 01960000
019700*---------------------------------------------------------------* 01970000
019800     EXEC SQL                                                     01980000
019900         INCLUDE TKRPRPM                                          01990000
020000     END-EXEC.                                                    02000000
020100                                                                  02010000
020200*---------------------------------------------------------------* 02020000
020300*    WST PARM:  WST_INTGRTN_TYP                                   02030000
020400*---------------------------------------------------------------* 02040000
020500     EXEC SQL                                                     02050000
020600         INCLUDE WST00008                                         02060000
020700     END-EXEC.                                                    02070000
020800                                                                  02080000
020900*---------------------------------------------------------------* 02090000
021000*    WST PARM FIELD DEFINITIONS:   WST_ATTR_DEFN                * 02100000
021100*---------------------------------------------------------------* 02110000
021200     EXEC SQL                                                     02120000
021300         INCLUDE WST00009                                         02130000
021400     END-EXEC.                                                    02140000
021500                                                                  02150000
021600*---------------------------------------------------------------* 02160000
021700*    WST PARM ELEMENTS:  WST_ATTR_ELEM                          * 02170000
021800*---------------------------------------------------------------* 02180000
021900     EXEC SQL                                                     02190000
022000         INCLUDE WST00010                                         02200000
022100     END-EXEC.                                                    02210000
022200                                                                  02220000
022300*---------------------------------------------------------------* 02230000
022400*    PACKSLIP                                                   * 02240000
022500*---------------------------------------------------------------* 02250000
022600     EXEC SQL                                                     02260000
022700          INCLUDE TPKSLIP                                         02270000
022800     END-EXEC.                                                    02280000
022900                                                                  02290000
023000*---------------------------------------------------------------* 02300000
023100*    TINPKSU - PACKSLIP TO SSCC ASSOCIATION                       02310000
023200*---------------------------------------------------------------* 02320000
023300     EXEC SQL                                                     02330000
023400          INCLUDE TINPKSU                                         02340000
023500     END-EXEC.                                                    02350000
023600                                                                  02360000
023700*---------------------------------------------------------------* 02370000
023800*  INBOUND CARTON LOCATION (tshunlo)                              02380000
023900*---------------------------------------------------------------* 02390000
024000     EXEC SQL                                                     02400000
024100         INCLUDE TSHUNLO                                          02410000
024200     END-EXEC.                                                    02420000
024300                                                                  02430000
024400*---------------------------------------------------------------* 02440000
024500*    RECEIVER                                                   * 02450000
024600*---------------------------------------------------------------* 02460000
024700     EXEC SQL                                                     02470000
024800         INCLUDE TRECEIV                                          02480000
024900     END-EXEC.                                                    02490000
025000                                                                  02500000
025100*---------------------------------------------------------------* 02510000
025200*    RECEIVER ITEM                                              * 02520000
025300*---------------------------------------------------------------* 02530000
025400     EXEC SQL                                                     02540000
025500         INCLUDE TRECITM                                          02550000
025600     END-EXEC.                                                    02560000
025700                                                                  02570000
025800*---------------------------------------------------------------* 02580000
025900*    PURCHASE ORDER                                             * 02590000
026000*---------------------------------------------------------------* 02600000
026100     EXEC SQL                                                     02610000
026200         INCLUDE TPURCHS                                          02620000
026300     END-EXEC.                                                    02630000
026400                                                                  02640000
026500*---------------------------------------------------------------* 02650000
026600*    PURCHASE ORDER ITEM                                        * 02660000
026700*---------------------------------------------------------------* 02670000
026800     EXEC SQL                                                     02680000
026900         INCLUDE TPURITM                                          02690000
027000     END-EXEC.                                                    02700000
027100                                                                  02710000
027200*---------------------------------------------------------------* 02720000
027300*    XLT_SKU                                                    * 02730000
027400*---------------------------------------------------------------* 02740000
027500     EXEC SQL                                                     02750000
027600         INCLUDE XLT00003                                         02760000
027700     END-EXEC.                                                    02770000
027800                                                                  02780000
027900*---------------------------------------------------------------* 02790000
028000*    XLT_VND_STYL                                               * 02800000
028100*---------------------------------------------------------------* 02810000
028200     EXEC SQL                                                     02820000
028300         INCLUDE XLT00004                                         02830000
028400     END-EXEC.                                                    02840000
028500                                                                  02850000
028600*---------------------------------------------------------------* 02860000
028700*    SFT_EAS_TG_MDSE - EAS TAG INFO                             * 02870000
028800*---------------------------------------------------------------* 02880000
028900     EXEC SQL                                                     02890000
029000         INCLUDE SFT00000                                         02900000
029100     END-EXEC.                                                    02910000
029200                                                                  02920000
029300*---------------------------------------------------------------* 02930000
029400*  TSHIPMT                                                        02940000
029500*---------------------------------------------------------------* 02950000
029600     EXEC SQL                                                     02960000
029700         INCLUDE TSHIPMT                                          02970000
029800     END-EXEC.                                                    02980000
029900                                                                  02990000
030000*---------------------------------------------------------------* 03000000
030100*  PO-RCVR TO SHIPMENT/TRIP ASSOCIATION                           03010000
030200*---------------------------------------------------------------* 03020000
030300     EXEC SQL                                                     03030000
030400         INCLUDE TSHPTPO                                          03040000
030500     END-EXEC.                                                    03050000
030600                                                                  03060000
030700*----------------------------------------------------------------*03070000
030800*  COMMUNICATIONS AREA FOR DB2                                   *03080000
030900*----------------------------------------------------------------*03090000
031000     EXEC SQL                                                     03100000
031100         INCLUDE SQLCA                                            03110000
031200     END-EXEC.                                                    03120000
031300                                                                  03130000
031400                                                                  03140000
031500******************************************************************03150000
031600 LINKAGE SECTION.                                                 03160000
031700******************************************************************03170000
031800 01  DFHCOMMAREA.                                                 03180000
031900     05  FILLER                         OCCURS  1 TO 4072 TIMES   03190000
032000                                      DEPENDING ON EIBCALEN.      03200000
032100         10  FILLER                   PIC X.                      03210000
032200                                                                  03220000
032300******************************************************************03230000
032400 PROCEDURE DIVISION.                                              03240000
032500******************************************************************03250000
032600 0000-PROGRAM-MAINLINE.                                           03260000
032700     MOVE EIBTASKN                 TO  PV-EIBTASKN.               03270000
032800     INITIALIZE                        SU109-THIN-SLICE-COMM.     03280000
032900     MOVE DFHCOMMAREA              TO  SU109-THIN-SLICE-COMM.     03290000
033000                                                                  03300000
033100     PERFORM 0010-CHECK-PARA-TRACKING.                            03310000
033200     SET SU109-SUCCESSFUL          TO TRUE.                       03320000
033300                                                                  03330000
033400     PERFORM 0500-CHECK-PO-BYPASSED.                              03340000
033500                                                                  03350000
033600* WAS PACKAGING GROUP PREVIOUSLY SELECTED FOR THIN SLICE          03360000
033700*     PV-NOT-THIN-SLICE-ELIGIBLE = '0L'                           03370000
033800*     PV-THIN-SLICE-ELIGIBLE     = '0M'                           03380000
033900*      PV-THIN-SLICE-NOT-CHECKED = '  '                           03390000
034000                                                                  03400000
034100     IF  PS-DC-PO-BYPASSED-NO                                     03410000
034200         PERFORM 1000-CHECK-PREV-SELECT                           03420000
034300     END-IF.                                                      03430000
034400                                                                  03440000
034500     IF  PS-DC-PO-BYPASSED-YES        OR                          03450000
034600         PV-NOT-THIN-SLICE-ELIGIBLE                               03460000
034700         SET SU109-THIN-SLICE-SELECTED-NO  tO  TRUE               03470000
034800     ELSE                                                         03480000
034900         IF PV-THIN-SLICE-ELIGIBLE                                03490000
035000            SET SU109-THIN-SLICE-SELECTED  TO  TRUE               03500000
035100         ELSE                                                     03510000
035200             IF  SU109-SUCCESSFUL                                 03520000
035300                 PERFORM 1100-PKG-PROCESS                         03530000
035400             END-IF                                               03540000
035500         END-IF                                                   03550000
035600     END-IF.                                                      03560000
035700                                                                  03570000
035800     IF PS-SHOW-DEBUG-INFO                                        03580000
035900         STRING ' SUKCS700-0000:  '                               03590000
036000                  SU109-THIN-SLICE-COMM                           03600000
036100                  DELIMITED BY SIZE                               03610000
036200             INTO PV-CICS-MSG-AREA                                03620000
036300         PERFORM 9990-WRITE-CICS                                  03630000
036400         move spaces to  pv-cics-msg-area                         03640000
036500         PERFORM 9990-WRITE-CICS                                  03650000
036600     END-IF.                                                      03660000
036700                                                                  03670000
036800                                                                  03680000
036900     MOVE SU109-THIN-SLICE-COMM         TO DFHCOMMAREA.           03690000
037000                                                                  03700000
037100     IF  PS-BLD-INTERNAL-TABLE-YES  AND                           03710000
037200         PV-DURATION-SEC     >=  PV-PARM-SECONDS                  03720000
037300                                                                  03730000
037400         MOVE '0000'  TO  PV-CSSL-PARA                            03740000
037500         PERFORM 8110-WRITE-SUWS109-TO-CSSL                       03750000
037600                                                                  03760000
037700         STRING ' SUKCS700-DID NOT MEET SLA'                      03770000
037800                ' DC:'        PV-DISP-OPER                        03780000
037900                ' SSCC:'      PV-DISP-SSCC                        03790000
038000                              DELIMITED BY SIZE                   03800000
038100                         INTO PV-CICS-MSG-AREA                    03810000
038200         PERFORM 9997-WRITE-TO-CSSL                               03820000
038300                                                                  03830000
038400         INITIALIZE PV-CICS-MSG-AREA                              03840000
038500         STRING ' SUKCS700 '                                      03850000
038600                ' START:'     PV-RECEIVE-RQST-TMST                03860000
038700                ' END:'       PV-CURRENT-PARA-TMST                03870000
038800                ' KEY:'       PV-INIT-TIME-KEY                    03880000
038900                ' DURATION:'  PV-DISP-NANO-SEC                    03890000
039000                              DELIMITED BY SIZE                   03900000
039100                         INTO PV-CICS-MSG-AREA                    03910000
039200         PERFORM 9997-WRITE-TO-CSSL                               03920000
039300                                                                  03930000
039400         PERFORM 8140-DUMP-TABLE-TO-CSSL                          03940000
039500         VARYING PT-TRACK-IDX                                     03950000
039600            FROM 1 BY 1                                           03960000
039700           UNTIL PT-TRACK-IDX >   PT-CURR-ENTRIES                 03970000
039800              OR PT-TRACK-IDX >   PT-MAX-PARA-ENTRIES             03980000
039900                                                                  03990000
040000         PERFORM 8150-CLEAR-TABLE                                 04000000
040100         VARYING PT-TRACK-IDX                                     04010000
040200            FROM 1 BY 1                                           04020000
040300            UNTIL PT-TRACK-IDX >   PT-CURR-ENTRIES                04030000
040400               OR PT-TRACK-IDX >   PT-MAX-PARA-ENTRIES            04040000
040500                                                                  04050000
040600         MOVE ZEROES TO PT-CURR-ENTRIES                           04060000
040700         SET  PT-TRACK-IDX  TO  PT-CURR-ENTRIES                   04070000
040800                                                                  04080000
040900         INITIALIZE PV-CICS-MSG-AREA                              04090000
041000         MOVE PV-DURATION-SEC TO  PV-DISP-DURATION                04100000
041100         STRING ' SUKCS700-DID NOT MEET SLA'                      04110000
041200                ' DC:'        PV-DISP-OPER                        04120000
041300                ' SSCC:'      PV-DISP-SSCC                        04130000
041400                ' DONE'                                           04140000
041500                              DELIMITED BY SIZE                   04150000
041600                         INTO PV-CICS-MSG-AREA                    04160000
041700         PERFORM 9997-WRITE-TO-CSSL                               04170000
041800                                                                  04180000
041900         MOVE SPACES TO  PV-CICS-MSG-AREA                         04190000
042000         PERFORM 9997-WRITE-TO-CSSL                               04200000
042100     END-IF.                                                      04210000
042200                                                                  04220000
042300     IF  PS-BLD-INTERNAL-TABLE-YES  AND                           04230000
042400         PV-DURATION-SEC     <   PV-PARM-SECONDS                  04240000
042500                                                                  04250000
042600         MOVE '0000'  TO  PV-CSSL-PARA                            04260000
042700         PERFORM 8110-WRITE-SUWS109-TO-CSSL                       04270000
042800                                                                  04280000
042900         STRING ' SUKCS700-met SLA '                              04290000
043000                ' DC:'        PV-DISP-OPER                        04300000
043100                ' SSCC:'      PV-DISP-SSCC                        04310000
043200                              DELIMITED BY SIZE                   04320000
043300                         INTO PV-CICS-MSG-AREA                    04330000
043400         PERFORM 9997-WRITE-TO-CSSL                               04340000
043500                                                                  04350000
043600         INITIALIZE PV-CICS-MSG-AREA                              04360000
043700         STRING ' SUKCS700 '                                      04370000
043800                ' START:'     PV-RECEIVE-RQST-TMST                04380000
043900                ' END:'       PV-CURRENT-PARA-TMST                04390000
044000                ' KEY:'       PV-INIT-TIME-KEY                    04400000
044100                ' DURATION:'  PV-DISP-NANO-SEC                    04410000
044200                              DELIMITED BY SIZE                   04420000
044300                         INTO PV-CICS-MSG-AREA                    04430000
044400         PERFORM 9997-WRITE-TO-CSSL                               04440000
044500                                                                  04450000
044600         PERFORM 8140-DUMP-TABLE-TO-CSSL                          04460000
044700         VARYING PT-TRACK-IDX                                     04470000
044800            FROM 1 BY 1                                           04480000
044900           UNTIL PT-TRACK-IDX >   PT-CURR-ENTRIES                 04490000
045000              OR PT-TRACK-IDX >   PT-MAX-PARA-ENTRIES             04500000
045100                                                                  04510000
045200         PERFORM 8150-CLEAR-TABLE                                 04520000
045300         VARYING PT-TRACK-IDX                                     04530000
045400            FROM 1 BY 1                                           04540000
045500            UNTIL PT-TRACK-IDX >   PT-CURR-ENTRIES                04550000
045600               OR PT-TRACK-IDX >   PT-MAX-PARA-ENTRIES            04560000
045700                                                                  04570000
045800         MOVE ZEROES TO PT-CURR-ENTRIES                           04580000
045900         SET  PT-TRACK-IDX  TO  PT-CURR-ENTRIES                   04590000
046000                                                                  04600000
046100         INITIALIZE PV-CICS-MSG-AREA                              04610000
046200         MOVE PV-DURATION-SEC TO  PV-DISP-DURATION                04620000
046300         STRING ' SUKCS700-met SLA '                              04630000
046400                ' DC:'        PV-DISP-OPER                        04640000
046500                ' SSCC:'      PV-DISP-SSCC                        04650000
046600                ' DONE'                                           04660000
046700                              DELIMITED BY SIZE                   04670000
046800                         INTO PV-CICS-MSG-AREA                    04680000
046900         PERFORM 9997-WRITE-TO-CSSL                               04690000
047000                                                                  04700000
047100         MOVE SPACES TO  PV-CICS-MSG-AREA                         04710000
047200         PERFORM 9997-WRITE-TO-CSSL                               04720000
047300     END-IF.                                                      04730000
047400                                                                  04740000
047500                                                                  04750000
047600     GOBACK.                                                      04760000
047700                                                                  04770000
047800*----------------------------------------------------------------*04780000
047900* CHECK FOR PARAGRAPH TRACKING - CHECKING TO SEE WHAT PARAGRAPH  *04790000
048000* THE PROGRAM IS MOST OF THE TIME IN.                            *04800000
048100*-----------------------------------------T----------------------*04810000
048200 0010-CHECK-PARA-TRACKING.                                        04820000
048300                                                                  04830000
048400     MOVE 999999999                TO  PV-PARM-SECONDS.           04840000
048500     SET PS-BLD-INTERNAL-TABLE-NO  TO  TRUE.                      04850000
048600                                                                  04860000
048700     EXEC SQL                                                     04870000
048800          SET :PV-CURRENT-PARA-TMST = CURRENT TIMESTAMP           04880000
048900     END-EXEC.                                                    04890000
049000                                                                  04900000
049100     MOVE  PV-CURRENT-PARA-TMST  TO  PV-RECEIVE-RQST-TMST.        04910000
049200                                                                  04920000
049300     MOVE  PV-INIT-HH            TO  PV-INIT-KEY-HH.              04930000
049400     MOVE  PV-INIT-MM            TO  PV-INIT-KEY-MM.              04940000
049500     MOVE  PV-INIT-SS            TO  PV-INIT-KEY-SS.              04950000
049600                                                                  04960000
049700     MOVE SPACES                   TO PV-CICS-MSG-AREA.           04970000
049800     INITIALIZE PT-MSG-TABLE.                                     04980000
049900     MOVE 1                        TO PT-MSG-SEQ (PT-MSG-IDX).    04990000
050000                                                                  05000000
050100     MOVE SU109-OPER-UNT-ID        TO DK-OPER-UNT-ID.             05010000
050200     MOVE SU109-TRIP-ID            TO DK-TRIP-ID.                 05020000
050300     MOVE SU109-DOOR-NUMBER        TO DK-DOOR-NUMBER.             05030000
050400     MOVE SU109-ACM-LBL-STA-NBR    TO DK-ACM-LBL-STA-NBR.         05040000
050500     MOVE SU109-BAR-CODE           TO DK-BAR-CODE.                05050000
050600     MOVE SU109-ORD-NBR            TO DK-ORD-NBR.                 05060000
050700     MOVE SU109-REC-SEQ-NBR        TO DK-REC-SEQ-NBR.             05070000
050800     MOVE SU109-ORD-LNE-NBR        TO DK-ORD-LNE-NBR.             05080000
050900     MOVE SU109-PREPK-ID           TO DK-PREPK-ID.                05090000
051000     MOVE SU109-PACK-BY-ST-IND     TO DK-PACK-BY-ST-IND.          05100000
051100     MOVE SU109-PKGNG-CDE          TO DK-PKGNG-CDE.               05110000
051200                                                                  05120000
051300     PERFORM 8000-CHECK-FOR-LOGGING.                              05130000
051400     IF PS-SHOW-DEBUG-INFO                                        05140000
051500         MOVE SU109-ORD-NBR          TO  PV-DISP-PO               05150000
051600         MOVE SU109-REC-SEQ-NBR      TO  PV-DISP-RCVR             05160000
051700         MOVE SU109-BAR-CODE         TO  PV-DISP-SSCC             05170000
051800         MOVE SU109-TRIP-ID          TO  PV-DISP-TRIP             05180000
051900         STRING   ' SUKCS700 PROGRAM STARTED -'                   05190000
052000                  ' PO='                                          05200000
052100                  PV-DISP-PO                                      05210000
052200                  ' RCVR='                                        05220000
052300                  PV-DISP-RCVR                                    05230000
052400                  DELIMITED BY SIZE                               05240000
052500                                  INTO PV-CICS-MSG-AREA           05250000
052600         PERFORM 9990-WRITE-CICS                                  05260000
052700         STRING   ' SUKCS700 PROGRAM STARTED -'                   05270000
052800                  PV-DISP-RCVR                                    05280000
052900                  ' CARTON='                                      05290000
053000                  PV-disp-sscc                                    05300000
053100                  DELIMITED BY SIZE                               05310000
053200                                  INTO PV-CICS-MSG-AREA           05320000
053300         PERFORM 9990-WRITE-CICS                                  05330000
053400         STRING   ' SUKCS700 PROGRAM STARTED -'                   05340000
053500                  ' TRIP='                                        05350000
053600                  PV-DISP-TRIP                                    05360000
053700                  DELIMITED BY SIZE                               05370000
053800                                  INTO PV-CICS-MSG-AREA           05380000
053900         PERFORM 9990-WRITE-CICS                                  05390000
054000         PERFORM 8110-WRITE-SUWS109-TO-CSSL                       05400000
054100     END-IF.                                                      05410000
054200                                                                  05420000
054300     PERFORM 8100-CHECK-PARA-TRACK-SEC.                           05430000
054400                                                                  05440000
054500                                                                  05450000
054600*----------------------------------------------------------------*05460000
054700* CHECK IF po is being bypassed due to some issue                *05470000
054800*----------------------------------------------------------------*05480000
054900 0500-CHECK-PO-BYPASSED.                                          05490000
055000                                                                  05500000
055100     IF  PS-BLD-INTERNAL-TABLE-YES                                05510000
055200         MOVE  '0500'  TO  PT-CURR-PARA                           05520000
055300         PERFORM 8120-INTERNAL-TABLE                              05530000
055400     END-IF.                                                      05540000
055500                                                                  05550000
055600     IF PS-SHOW-DEBUG-INFO                                        05560000
055700         STRING ' SUKCS700-0500-PO-BYPASSED    '                  05570000
055800             DELIMITED BY SIZE                                    05580000
055900             INTO PV-CICS-MSG-AREA                                05590000
056000         PERFORM 9990-WRITE-CICS                                  05600000
056100     END-IF.                                                      05610000
056200                                                                  05620000
056300     EXEC SQL                                                     05630000
056400        SELECT  E.ATTR_ELEM_TXT                                   05640000
056500          INTO :PS-DC-PO-BYPASSED-SW                              05650000
056600          FROM                                                    05660000
056700                WST_INTGRTN_TYP  A                                05670000
056800             ,  WST_ATTR_DEFN    B                                05680000
056900             ,  WST_ATTR_ELEM    C    -- DC                       05690000
057000             ,  WST_ATTR_ELEM    D    -- PO NUMBER                05700000
057100             ,  WST_ATTR_ELEM    E    -- Y/N                      05710000
057200             ,  WST_ATTR_ELEM    F    -- BEGIN TMST               05720000
057300             ,  WST_ATTR_ELEM    G    -- END TMST                 05730000
057400             ,  WST_ATTR_ELEM    H    -- SETUP TK                 05740000
057500             ,  WST_ATTR_ELEM    I    -- REQUEST TK               05750000
057600             ,  WST_ATTR_ELEM    J    -- FREEFORM INFO            05760000
057700          WHERE                                                   05770000
057800                A.INTGRTN_TYP_CDE   = 'THNSLCBYP'                 05780000
057900            AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE           05790000
058000            AND B.ATTR_DEFN_SEQ_NBR = 1                           05800000
058100            AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE           05810000
058200            AND C.ATTR_DEFN_SEQ_NBR = 1                           05820000
058300            AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE           05830000
058400            AND D.ATTR_DEFN_SEQ_NBR = 2                           05840000
058500            AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE           05850000
058600            AND E.ATTR_DEFN_SEQ_NBR = 3                           05860000
058700            AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE           05870000
058800            AND F.ATTR_DEFN_SEQ_NBR = 4                           05880000
058900            AND B.INTGRTN_TYP_CDE   = G.INTGRTN_TYP_CDE           05890000
059000            AND G.ATTR_DEFN_SEQ_NBR = 5                           05900000
059100            AND B.INTGRTN_TYP_CDE   = H.INTGRTN_TYP_CDE           05910000
059200            AND H.ATTR_DEFN_SEQ_NBR = 6                           05920000
059300            AND B.INTGRTN_TYP_CDE   = I.INTGRTN_TYP_CDE           05930000
059400            AND I.ATTR_DEFN_SEQ_NBR = 7                           05940000
059500            AND B.INTGRTN_TYP_CDE   = J.INTGRTN_TYP_CDE           05950000
059600            AND J.ATTR_DEFN_SEQ_NBR = 8                           05960000
059700            AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR         05970000
059800            AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR         05980000
059900            AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR         05990000
060000            AND C.ATTR_ELEM_SEQ_NBR = G.ATTR_ELEM_SEQ_NBR         06000000
060100            AND C.ATTR_ELEM_SEQ_NBR = H.ATTR_ELEM_SEQ_NBR         06010000
060200            AND C.ATTR_ELEM_SEQ_NBR = I.ATTR_ELEM_SEQ_NBR         06020000
060300            AND C.ATTR_ELEM_SEQ_NBR = J.ATTR_ELEM_SEQ_NBR         06030000
060400            AND C.ATTR_ELEM_NBR     = :DK-OPER-UNT-ID             06040000
060500            AND D.ATTR_ELEM_NBR     = :DK-ORD-NBR                 06050000
060600            AND E.ATTR_ELEM_TXT     = 'Y'                         06060000
060700            AND F.ATTR_ELEM_TMST   <= CURRENT TIMESTAMP           06070000
060800            AND G.ATTR_ELEM_TMST   >= CURRENT TIMESTAMP           06080000
060900           WITH UR                                                06090000
061000     END-EXEC.                                                    06100000
061100                                                                  06110000
061200     EVALUATE TRUE                                                06120000
061300         WHEN SQLCODE = ZERO                                      06130000
061400              SET  PV-NOT-THIN-SLICE-ELIGIBLE                     06140000
061500                   SU109-THIN-SLICE-SELECTED-NO                   06150000
061600                   SU109-SUCCESSFUL        TO  TRUE               06160000
061700                                                                  06170000
061800         WHEN SQLCODE = +100                                      06180000
061900              CONTINUE                                            06190000
062000                                                                  06200000
062100         WHEN SQLWARN0 NOT = SPACES                               06210000
062200         WHEN SQLCODE NOT EQUAL ZERO                              06220000
062300              move '0500'  to  PV-CSSL-PARA                       06230000
062400              perform 8110-WRITE-SUWS109-TO-CSSL                  06240000
062500                                                                  06250000
062600             MOVE '0500-CHECK-PO-BYPASSED '                       06260000
062700                                   TO DP013-PARAGRAPH             06270000
062800             MOVE 'SUKCS700 - SELECT PO BYPASSING'                06280000
062900                                   TO DP013-MESSAGE-TEXT(1)       06290000
063000             MOVE DK-ORD-NBR       TO PV-DISP-PO                  06300000
063100             MOVE DK-REC-SEQ-NBR   TO PV-DISP-RCVR                06310000
063200                                                                  06320000
063300             STRING 'RCVR:'                                       06330000
063400                     PV-DISP-PO      '-'                          06340000
063500                     PV-DISP-RCVR DELIMITED BY SIZE               06350000
063600                                     INTO DP013-MESSAGE-TEXT(2)   06360000
063700                                                                  06370000
063800             MOVE SQLCA            TO DP013-SQLCA                 06380000
063900             MOVE 'WST-008-010'    TO DP013-DB2-TABLE-NAME(1)     06390000
064000             SET DP013-DB2-ABEND   TO TRUE                        06400000
064100             SET DP013-ROLLBACK    TO TRUE                        06410000
064200             PERFORM 9999-WRITE-CICS-LOG-MSG                      06420000
064300             SET PS-DUMP-TO-LOG    TO TRUE                        06430000
064400             SET SU109-INVALID-SQL TO TRUE                        06440000
064500     END-EVALUATE.                                                06450000
064600                                                                  06460000
064700     IF PS-SHOW-DEBUG-INFO                                        06470000
064800         STRING ' SUKCS700-0500-PO-BYPASSED  '                    06480000
064900                PS-DC-PO-BYPASSED-SW                              06490000
065000             DELIMITED BY SIZE                                    06500000
065100             INTO PV-CICS-MSG-AREA                                06510000
065200         PERFORM 9990-WRITE-CICS                                  06520000
065300     END-IF.                                                      06530000
065400                                                                  06540000
065500                                                                  06550000
065600*----------------------------------------------------------------*06560000
065700* CHECK IF ORDER WAS PREVIOUSLY CHECK FOR THIN SLICE ELIGIBILITY *06570000
065800*----------------------------------------------------------------*06580000
065900 1000-CHECK-PREV-SELECT.                                          06590000
066000                                                                  06600000
066100     IF  PS-BLD-INTERNAL-TABLE-YES                                06610000
066200         MOVE  '1000'  TO  PT-CURR-PARA                           06620000
066300         PERFORM 8120-INTERNAL-TABLE                              06630000
066400     END-IF.                                                      06640000
066500                                                                  06650000
066600     IF PS-SHOW-DEBUG-INFO                                        06660000
066700         STRING ' SUKCS700-1000-CHECK-PREV-SELECT'                06670000
066800             DELIMITED BY SIZE                                    06680000
066900             INTO PV-CICS-MSG-AREA                                06690000
067000         PERFORM 9990-WRITE-CICS                                  06700000
067100     END-IF.                                                      06710000
067200                                                                  06720000
067300     MOVE SU109-OPER-UNT-ID        TO DK-OPER-UNT-ID.             06730000
067400     MOVE SU109-TRIP-ID            TO DK-TRIP-ID.                 06740000
067500     MOVE SU109-DOOR-NUMBER        TO DK-DOOR-NUMBER.             06750000
067600     MOVE SU109-ACM-LBL-STA-NBR    TO DK-ACM-LBL-STA-NBR.         06760000
067700     MOVE SU109-BAR-CODE           TO DK-BAR-CODE.                06770000
067800     MOVE SU109-ORD-NBR            TO DK-ORD-NBR.                 06780000
067900     MOVE SU109-REC-SEQ-NBR        TO DK-REC-SEQ-NBR.             06790000
068000     MOVE SU109-ORD-LNE-NBR        TO DK-ORD-LNE-NBR.             06800000
068100     MOVE SU109-PREPK-ID           TO DK-PREPK-ID.                06810000
068200     MOVE SU109-PACK-BY-ST-IND     TO DK-PACK-BY-ST-IND.          06820000
068300     MOVE SU109-PKGNG-CDE          TO DK-PKGNG-CDE.               06830000
068400     INITIALIZE DCLRCT00017.                                      06840000
068500                                                                  06850000
068600     EXEC SQL                                                     06860000
068700          SELECT  DC_FUNC_CDE                                     06870000
068800            INTO :PV-DC-FUNC-CDE                                  06880000
068900            FROM  RCT_PO_RCVR_TRKG                                06890000
069000           WHERE  PO_NBR         = :DK-ORD-NBR                    06900000
069100             AND  RCVR_SEQ_NBR   = :DK-REC-SEQ-NBR                06910000
069200             AND  DC_FUNC_CDE IN ('0L','0M')                      06920000
069300            WITH UR                                               06930000
069400     END-EXEC.                                                    06940000
069500                                                                  06950000
069600                                                                  06960000
069700     EVALUATE TRUE                                                06970000
069800         WHEN SQLCODE = ZERO                                      06980000
069900              SET  SU109-SUCCESSFUL        TO  TRUE               06990000
070000                                                                  07000000
070100         WHEN SQLCODE = +100                                      07010000
070200              SET  PV-THIN-SLICE-NOT-CHECKED    TO  TRUE          07020000
070300                                                                  07030000
070400         WHEN SQLWARN0 NOT = SPACES                               07040000
070500         WHEN SQLCODE NOT EQUAL ZERO                              07050000
070600              move '1000'  to  PV-CSSL-PARA                       07060000
070700              perform 8110-WRITE-SUWS109-TO-CSSL                  07070000
070800                                                                  07080000
070900             MOVE '1000-CHECK-PREV-SELECT'                        07090000
071000                                   TO DP013-PARAGRAPH             07100000
071100             MOVE 'SUKCS700 - SELECT PO TRACKING '                07110000
071200                                   TO DP013-MESSAGE-TEXT(1)       07120000
071300             MOVE DK-ORD-NBR       TO PV-DISP-PO                  07130000
071400             MOVE DK-REC-SEQ-NBR   TO PV-DISP-RCVR                07140000
071500                                                                  07150000
071600             STRING 'RCVR:'                                       07160000
071700                     PV-DISP-PO      '-'                          07170000
071800                     PV-DISP-RCVR DELIMITED BY SIZE               07180000
071900                                     INTO DP013-MESSAGE-TEXT(2)   07190000
072000                                                                  07200000
072100             MOVE SQLCA            TO DP013-SQLCA                 07210000
072200             MOVE 'RCT00017'       TO DP013-DB2-TABLE-NAME(1)     07220000
072300             SET DP013-DB2-ABEND   TO TRUE                        07230000
072400             SET DP013-ROLLBACK    TO TRUE                        07240000
072500             PERFORM 9999-WRITE-CICS-LOG-MSG                      07250000
072600             SET PS-DUMP-TO-LOG    TO TRUE                        07260000
072700             SET SU109-INVALID-SQL TO TRUE                        07270000
072800     END-EVALUATE.                                                07280000
072900                                                                  07290000
073000     IF PS-SHOW-DEBUG-INFO                                        07300000
073100         STRING ' SUKCS700-1000-'                                 07310000
073200                'THIN SLICE CHECK - '                             07320000
073300                PV-DC-FUNC-CDE                                    07330000
073400             DELIMITED BY SIZE                                    07340000
073500             INTO PV-CICS-MSG-AREA                                07350000
073600         PERFORM 9990-WRITE-CICS                                  07360000
073700     END-IF.                                                      07370000
073800                                                                  07380000
073900                                                                  07390000
074000                                                                  07400000
074001*----------------------------------------------------------------*07400100
074002* CHECKS BASED ON PACKAGE TYPE                                   *07400200
074003*-----------------------------------------T----------------------*07400300
074004 1100-PKG-PROCESS.                                                07400400
074005                                                                  07400500
074006     IF  PS-BLD-INTERNAL-TABLE-YES                                07400600
074007         MOVE  '1100'  TO  PT-CURR-PARA                           07400700
074008         PERFORM 8120-INTERNAL-TABLE                              07400800
074009     END-IF.                                                      07400900
074010                                                                  07401000
074011     IF PS-SHOW-DEBUG-INFO                                        07401100
074012         STRING ' SUKCS700-1100-PKG-PROCESS      '                07401200
074013             DELIMITED BY SIZE                                    07401300
074014             INTO PV-CICS-MSG-AREA                                07401400
074015         PERFORM 9990-WRITE-CICS                                  07401500
074016     END-IF.                                                      07401600
074017                                                                  07401700
074018                                                                  07401800
074019     IF  SU109-PBS                                                07401900
074020         PERFORM 2000-PBS-CHECKS                                  07402000
074021     ELSE                                                         07402100
074022         IF  SU109-BULK                                           07402200
074023             PERFORM 3000-BULK-CHECKS                             07402300
074024         ELSE                                                     07402400
074025             PERFORM 4000-PREPACK-CHECKS                          07402500
074026         END-IF                                                   07402600
074027     END-IF.                                                      07402700
074028                                                                  07402800
074029                                                                  07402900
074030*----------------------------------------------------------------*07403000
074031* PBS PACK-BY-STORE CHECKS                                       *07403100
074032*----------------------------------------------------------------*07403200
074033 2000-PBS-CHECKS.                                                 07403300
074034                                                                  07403400
074035     IF  PS-BLD-INTERNAL-TABLE-YES                                07403500
074036         MOVE  '2000'  TO  PT-CURR-PARA                           07403600
074037         PERFORM 8120-INTERNAL-TABLE                              07403700
074038     END-IF.                                                      07403800
074039                                                                  07403900
074040     IF PS-SHOW-DEBUG-INFO                                        07404000
074041         STRING ' SUKCS700-2000-PBS-CHECKS      '                 07404100
074042             DELIMITED BY SIZE                                    07404200
074043             INTO PV-CICS-MSG-AREA                                07404300
074044         PERFORM 9990-WRITE-CICS                                  07404400
074045     END-IF.                                                      07404500
074046                                                                  07404600
074047* CHECK IF DC IS CHECKING PBA ORDERS FOR THIN SLICE               07404700
074048     PERFORM 2100-THNSLCPBS.                                      07404800
074049                                                                  07404900
074050* CHECK IF CARTONS ON RECEIVER IS > MAX ALLOWED FOR THIN SLICE    07405000
074060     IF  PS-DC-THIN-SLICE-PBS-YES  AND                            07406000
074070         SU109-SUCCESSFUL                                         07407000
074071         PERFORM 2110-PBS-COUNT-SSCC                              07407100
074072         IF  PS-DC-THIN-SLICE-PBS-YES                             07407200
074073             IF  PV-CARTONS-ON-RCVR  >  PV-MAX-CRTNS              07407300
074074                 SET  PS-DC-THIN-SLICE-PBS-NO  TO  TRUE           07407400
074075             END-IF                                               07407500
074076         END-IF                                                   07407600
074077     END-IF.                                                      07407700
074078                                                                  07407800
074079* CHECK IF NUMBER OF PBS RECEIVERS IS GREATER THEN MAX            07407900
074080     IF  PS-DC-THIN-SLICE-PBS-YES  AND                            07408000
074081         SU109-SUCCESSFUL                                         07408100
074082         PERFORM 2115-PBS-ELIGIBLE-COUNT                          07408200
074083         IF  PS-DC-THIN-SLICE-PBS-YES                             07408300
074084             IF  PV-ELIGIBLE-PBS-RCVRS  >=  PV-MAX-rcvrs          07408400
074085                 SET  PS-DC-THIN-SLICE-PBS-NO  TO  TRUE           07408500
074086             END-IF                                               07408600
074087         END-IF                                                   07408700
074088     END-IF.                                                      07408800
074089                                                                  07408900
074090* CHECK IF ANY CARTONS HAVE PBS ERRORS                            07409000
074091     IF  PS-DC-THIN-SLICE-PBS-YES  AND                            07409100
074092         SU109-SUCCESSFUL                                         07409200
074093         PERFORM 2120-PBS-ERROR-CHECK                             07409300
074094         IF  PV-PBS-ERROR-CNT  >  0                               07409400
074095             SET  PS-DC-THIN-SLICE-PBS-NO  TO  TRUE               07409500
074096         END-IF                                                   07409600
074097     END-IF.                                                      07409700
074098                                                                  07409800
074099* CHECK IF ANY CARTONS HAVE ALREADY BEEN CHECKED IN FOR RCVR      07409900
074100     IF  PS-DC-THIN-SLICE-PBS-YES  AND                            07410000
074101         SU109-SUCCESSFUL                                         07410100
074102         PERFORM 2130-PBS-CHECKED-IN                              07410200
074103         IF  PV-PBS-CHECKED-IN-CNT   >  0                         07410300
074104             SET  PS-DC-THIN-SLICE-PBS-NO  TO  TRUE               07410400
074105         END-IF                                                   07410500
074106     END-IF.                                                      07410600
074107                                                                  07410700
074108* CHECK IF PO-RCVR REQUIRES EAS TAGGING                           07410800
074109     IF  PS-DC-THIN-SLICE-PBS-YES  AND                            07410900
074110         SU109-SUCCESSFUL                                         07411000
074111         PERFORM 2140-PBS-EAS-CHECK                               07411100
074112         IF  SU093-RFID-YES   OR                                  07411211
074113             SU093-PRINT-EAS  or                                  07411311
074114             SU093-PRINT-RFID-EAS                                 07411411
074115             SET  PS-DC-THIN-SLICE-PBS-NO  TO  TRUE               07411511
074116         END-IF                                                   07411611
074117     END-IF.                                                      07411711
074118                                                                  07411811
074119* CHECK IF PO-RCVR REQUIRES AUDIT                                 07411911
074120     IF  PS-DC-THIN-SLICE-PBS-YES  AND                            07412011
074121         SU109-SUCCESSFUL                                         07412111
074122         PERFORM 2150-CHECK-PBS-AUDIT                             07412211
074123         IF  SU021-AUDIT-REQUIRED-SW  =  'Y'                      07412311
074124             MOVE PC-NOT-ELIGIBLE-THN-SLC                         07412411
074125                                    TO RCT00017-DC-FUNC-CDE       07412511
074126             SET PS-DC-THIN-SLICE-PBS-NO       TO  TRUE           07412611
074127             SET SU109-THIN-SLICE-SELECTED-NO  tO  TRUE           07412711
074128         else                                                     07412811
074129             IF  SU109-SUCCESSFUL                                 07412911
074130                 SET  PS-DC-THIN-SLICE-PBS-YES  TO  TRUE          07413011
074131                 PERFORM 6050-CREATE-TROUBLE                      07413111
074132             ELSE                                                 07413211
074133                 SET  PS-DC-THIN-SLICE-PBS-NO  TO  TRUE           07413311
074134             END-IF                                               07413411
074135         END-IF                                                   07413511
074136     END-IF.                                                      07413611
074137                                                                  07413711
074138*                                                                 07413811
074139     MOVE SU109-ORD-NBR         TO RCT00017-PO-NBR.               07413911
074140     MOVE SU109-REC-SEQ-NBR     TO RCT00017-RCVR-SEQ-NBR.         07414011
074141     MOVE SU109-USER-ID         TO RCT00017-CRE-BY-USR-ID.        07414111
074142     MOVE SU109-OPER-UNT-ID     TO RCT00017-LOC-NBR.              07414211
074143     MOVE ZEROES                TO RCT00017-PO-LNE-NBR.           07414311
074144     MOVE ZEROES                TO RCT00017-PREPK-ID.             07414411
074145     MOVE ZEROES                TO RCT00017-QTY-TRKD-NBR.         07414511
074146     MOVE ZEROES                TO RCT00017-PKSL-SEQ-NBR.         07414611
074147     MOVE ZEROES                TO RCT00017-DEST-LOC-NBR.         07414711
074148                                                                  07414811
074149     IF  PS-DC-THIN-SLICE-PBS-NO                                  07414911
074150         MOVE PC-NOT-ELIGIBLE-THN-SLC                             07415011
074151                                TO RCT00017-DC-FUNC-CDE           07415111
074152         SET SU109-THIN-SLICE-SELECTED-NO  tO  TRUE               07415211
074153     ELSE                                                         07415311
074154         MOVE PC-ELIGIBLE-THN-SLC                                 07415411
074155                                    TO RCT00017-DC-FUNC-CDE       07415511
074156         SET  SU109-THIN-SLICE-SELECTED    to  TRUE               07415611
074157     END-IF.                                                      07415711
074158                                                                  07415811
074159     PERFORM 7000-INSERT-PO-TRKG.                                 07415911
074160                                                                  07416011
074161                                                                  07416111
074162*----------------------------------------------------------------*07416211
074163* PARM THNSLCPBS - CHECKING THIN SLICE FOR PBS                   *07416311
074164*----------------------------------------------------------------*07416411
074165 2100-THNSLCPBS.                                                  07416511
074166                                                                  07416611
074167     IF  PS-BLD-INTERNAL-TABLE-YES                                07416711
074168         MOVE  '2100'  TO  PT-CURR-PARA                           07416811
074169         PERFORM 8120-INTERNAL-TABLE                              07416911
074170     END-IF.                                                      07417011
074171                                                                  07417111
074172     IF PS-SHOW-DEBUG-INFO                                        07417211
074173         STRING ' SUKCS700-2100-THNSLCPBS      '                  07417311
074174             DELIMITED BY SIZE                                    07417411
074175             INTO PV-CICS-MSG-AREA                                07417511
074176         PERFORM 9990-WRITE-CICS                                  07417611
074177     END-IF.                                                      07417711
074178                                                                  07417811
074179                                                                  07417911
074180     EXEC SQL                                                     07418011
074181        SELECT  D.ATTR_ELEM_NBR                                   07418111
074182             ,  E.ATTR_ELEM_TXT                                   07418211
074183             ,  K.ATTR_ELEM_NBR                                   07418311
074184          INTO :PV-MAX-CRTNS                                      07418411
074185             , :PS-DC-THIN-SLICE-PBS-SW                           07418511
074186             , :PV-MAX-RCVRS                                      07418611
074187          FROM                                                    07418711
074188                WST_INTGRTN_TYP  A                                07418811
074189             ,  WST_ATTR_DEFN    B                                07418911
074190             ,  WST_ATTR_ELEM    C    -- DC                       07419011
074191             ,  WST_ATTR_ELEM    D    -- MAX CARTONS              07419111
074192             ,  WST_ATTR_ELEM    E    -- Y/N                      07419211
074193             ,  WST_ATTR_ELEM    F    -- BEGIN TMST               07419311
074194             ,  WST_ATTR_ELEM    G    -- END TMST                 07419411
074195             ,  WST_ATTR_ELEM    H    -- SETUP TK                 07419511
074196             ,  WST_ATTR_ELEM    I    -- REQUEST TK               07419611
074197             ,  WST_ATTR_ELEM    J    -- FREEFORM INFO            07419711
074198             ,  WST_ATTR_ELEM    K    -- MAX RECEIVERS            07419811
074199          WHERE                                                   07419911
074200                A.INTGRTN_TYP_CDE   = 'THNSLCPBS'                 07420011
074201            AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE           07420111
074202            AND B.ATTR_DEFN_SEQ_NBR = 1                           07420211
074203            AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE           07420311
074204            AND C.ATTR_DEFN_SEQ_NBR = 1                           07420411
074205            AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE           07420511
074206            AND D.ATTR_DEFN_SEQ_NBR = 2                           07420611
074207            AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE           07420711
074208            AND E.ATTR_DEFN_SEQ_NBR = 3                           07420811
074209            AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE           07420911
074210            AND F.ATTR_DEFN_SEQ_NBR = 4                           07421011
074211            AND B.INTGRTN_TYP_CDE   = G.INTGRTN_TYP_CDE           07421111
074212            AND G.ATTR_DEFN_SEQ_NBR = 5                           07421211
074213            AND B.INTGRTN_TYP_CDE   = H.INTGRTN_TYP_CDE           07421311
074214            AND H.ATTR_DEFN_SEQ_NBR = 6                           07421411
074215            AND B.INTGRTN_TYP_CDE   = I.INTGRTN_TYP_CDE           07421511
074216            AND I.ATTR_DEFN_SEQ_NBR = 7                           07421611
074217            AND B.INTGRTN_TYP_CDE   = J.INTGRTN_TYP_CDE           07421711
074218            AND J.ATTR_DEFN_SEQ_NBR = 8                           07421811
074219            AND B.INTGRTN_TYP_CDE   = K.INTGRTN_TYP_CDE           07421911
074220            AND K.ATTR_DEFN_SEQ_NBR = 9                           07422011
074221            AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR         07422111
074222            AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR         07422211
074223            AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR         07422311
074224            AND C.ATTR_ELEM_SEQ_NBR = G.ATTR_ELEM_SEQ_NBR         07422411
074225            AND C.ATTR_ELEM_SEQ_NBR = H.ATTR_ELEM_SEQ_NBR         07422511
074226            AND C.ATTR_ELEM_SEQ_NBR = I.ATTR_ELEM_SEQ_NBR         07422611
074227            AND C.ATTR_ELEM_SEQ_NBR = J.ATTR_ELEM_SEQ_NBR         07422711
074228            AND C.ATTR_ELEM_SEQ_NBR = K.ATTR_ELEM_SEQ_NBR         07422811
074229            AND C.ATTR_ELEM_NBR     = :DK-OPER-UNT-ID             07422911
074230            AND E.ATTR_ELEM_TXT     = 'Y'                         07423011
074231            AND F.ATTR_ELEM_TMST   <= CURRENT TIMESTAMP           07423111
074232            AND G.ATTR_ELEM_TMST   >= CURRENT TIMESTAMP           07423211
074233           WITH UR                                                07423311
074234     END-EXEC.                                                    07423411
074235                                                                  07423511
074236     EVALUATE TRUE                                                07423611
074237         WHEN SQLCODE = ZERO                                      07423711
074238              SET  PS-DC-THIN-SLICE-PBS-YES                       07423811
074239                   SU109-SUCCESSFUL        TO  TRUE               07423911
074240                                                                  07424011
074241         WHEN SQLCODE = +100                                      07424111
074242              SET  PS-DC-THIN-SLICE-PBS-NO                        07424211
074243                   SU109-SUCCESSFUL        TO  TRUE               07424311
074244                                                                  07424411
074245         WHEN SQLWARN0 NOT = SPACES                               07424511
074246         WHEN SQLCODE NOT EQUAL ZERO                              07424611
074247              move '2100'  to  PV-CSSL-PARA                       07424711
074248              perform 8110-WRITE-SUWS109-TO-CSSL                  07424811
074249                                                                  07424911
074250             MOVE '2100-THNSLCPBS         '                       07425011
074251                                   TO DP013-PARAGRAPH             07425111
074252             MOVE 'SUKCS700 - SELECT PO TRACKING '                07425211
074253                                   TO DP013-MESSAGE-TEXT(1)       07425311
074254             MOVE DK-ORD-NBR       TO PV-DISP-PO                  07425411
074255             MOVE DK-REC-SEQ-NBR   TO PV-DISP-RCVR                07425511
074256                                                                  07425611
074257             STRING 'RCVR:'                                       07425711
074258                     PV-DISP-PO      '-'                          07425811
074259                     PV-DISP-RCVR DELIMITED BY SIZE               07425911
074260                                     INTO DP013-MESSAGE-TEXT(2)   07426011
074261                                                                  07426111
074262             MOVE SQLCA            TO DP013-SQLCA                 07426211
074263             MOVE 'WST-008-010'    TO DP013-DB2-TABLE-NAME(1)     07426311
074264             SET DP013-DB2-ABEND   TO TRUE                        07426411
074265             SET DP013-ROLLBACK    TO TRUE                        07426511
074266             PERFORM 9999-WRITE-CICS-LOG-MSG                      07426611
074267             SET PS-DUMP-TO-LOG    TO TRUE                        07426711
074268             SET SU109-INVALID-SQL TO TRUE                        07426811
074269     END-EVALUATE.                                                07426911
074270                                                                  07427011
074271     IF PS-SHOW-DEBUG-INFO                                        07427111
074272         STRING ' SUKCS700-2100-THNSLCPBS - '                     07427211
074273                PS-DC-THIN-SLICE-PBS-SW                           07427311
074274             DELIMITED BY SIZE                                    07427411
074275             INTO PV-CICS-MSG-AREA                                07427511
074276         PERFORM 9990-WRITE-CICS                                  07427611
074277     END-IF.                                                      07427711
074278                                                                  07427811
074279                                                                  07427911
074280                                                                  07428011
074281*----------------------------------------------------------------*07428111
074282* COUNT PBS SSCC                                                 *07428211
074283*----------------------------------------------------------------*07428311
074284* CHECK IF NUMBER OF PBS RECEIVERS IS GREATER THEN MAX            07428411
074285 2110-PBS-COUNT-SSCC.                                             07428511
074286                                                                  07428611
074287     IF  PS-BLD-INTERNAL-TABLE-YES                                07428711
074288         MOVE  '2110'  TO  PT-CURR-PARA                           07428811
074289         PERFORM 8120-INTERNAL-TABLE                              07428911
074290     END-IF.                                                      07429011
074291                                                                  07429111
074292     IF PS-SHOW-DEBUG-INFO                                        07429211
074293         STRING ' SUKCS700-2110-PBS-COUNT-SSCC  '                 07429311
074294             DELIMITED BY SIZE                                    07429411
074295             INTO PV-CICS-MSG-AREA                                07429511
074296         PERFORM 9990-WRITE-CICS                                  07429611
074297     END-IF.                                                      07429711
074298                                                                  07429811
074299                                                                  07429911
074300     EXEC SQL                                                     07430011
074301        SELECT  COUNT(DISTINCT(b.SHIPT_UNT_ID))                   07430111
074302          INTO :PV-CARTONS-ON-RCVR                                07430211
074303          FROM                                                    07430311
074304                TPKSLIP A                                         07430411
074305             ,  TINPKSU B                                         07430511
074306           where a.PO_NBR         = :DK-ORD-NBR                   07430611
074307             and a.REC_SEQ_NBR    = :DK-REC-SEQ-NBR               07430711
074308             and a.VER_STAT_CDE   = 'A'                           07430811
074309             and a.PKSL_STAT_CDE  = 'AC'                          07430911
074310             and a.PO_NBR         =  b.PO_NBR                     07431011
074311             and a.SEQ_NBR        =  b.SEQ_NBR                    07431111
074312           WITH UR                                                07431211
074313     END-EXEC.                                                    07431311
074314                                                                  07431411
074315     EVALUATE TRUE                                                07431511
074316         WHEN SQLCODE = ZERO                                      07431611
074317              SET  PS-DC-THIN-SLICE-PBS-YES                       07431711
074318                   SU109-SUCCESSFUL        TO  TRUE               07431811
074319                                                                  07431911
074320         WHEN SQLCODE = +100                                      07432011
074321              SET  PS-DC-THIN-SLICE-PBS-NO                        07432111
074322                   SU109-SUCCESSFUL        TO  TRUE               07432211
074323                                                                  07432311
074324         WHEN SQLWARN0 NOT = SPACES                               07432411
074325         WHEN SQLCODE NOT EQUAL ZERO                              07432511
074326              move '2110'  to  PV-CSSL-PARA                       07432611
074327              perform 8110-WRITE-SUWS109-TO-CSSL                  07432711
074328                                                                  07432811
074329             MOVE '2110-PBS-COUNT-SSCC    '                       07432911
074330                                   TO DP013-PARAGRAPH             07433011
074331             MOVE 'SUKCS700 - COUNT RCVR SSCC    '                07433111
074332                                   TO DP013-MESSAGE-TEXT(1)       07433211
074333             MOVE DK-ORD-NBR       TO PV-DISP-PO                  07433311
074334             MOVE DK-REC-SEQ-NBR   TO PV-DISP-RCVR                07433411
074335                                                                  07433511
074336             STRING 'RCVR:'                                       07433611
074337                     PV-DISP-PO      '-'                          07433711
074338                     PV-DISP-RCVR DELIMITED BY SIZE               07433811
074339                                     INTO DP013-MESSAGE-TEXT(2)   07433911
074340                                                                  07434011
074341             MOVE SQLCA            TO DP013-SQLCA                 07434111
074342             MOVE 'TPKSLIP    '    TO DP013-DB2-TABLE-NAME(1)     07434211
074343             MOVE 'TINPKSU    '    TO DP013-DB2-TABLE-NAME(2)     07434311
074344             SET DP013-DB2-ABEND   TO TRUE                        07434411
074345             SET DP013-ROLLBACK    TO TRUE                        07434511
074346             PERFORM 9999-WRITE-CICS-LOG-MSG                      07434611
074347             SET PS-DUMP-TO-LOG    TO TRUE                        07434711
074348             SET SU109-INVALID-SQL TO TRUE                        07434811
074349     END-EVALUATE.                                                07434911
074350                                                                  07435011
074351     IF PS-SHOW-DEBUG-INFO                                        07435111
074352         MOVE PV-CARTONS-ON-RCVR   TO  PV-DISP-COUNT              07435211
074353         STRING ' SUKCS700-2110-PBS-COUNT-SSCC - '                07435311
074354                 PV-DISP-COUNT                                    07435411
074355             DELIMITED BY SIZE                                    07435511
074356             INTO PV-CICS-MSG-AREA                                07435611
074357         PERFORM 9990-WRITE-CICS                                  07435711
074358     END-IF.                                                      07435811
074359                                                                  07435911
074360                                                                  07436011
074361*----------------------------------------------------------------*07436111
074362* COUNT NUMBER OF ELIGIBLE PBS RCVRS ON TRAILER                  *07436211
074363*----------------------------------------------------------------*07436311
074370 2115-PBS-ELIGIBLE-COUNT.                                         07437000
074371                                                                  07437100
074372     IF  PS-BLD-INTERNAL-TABLE-YES                                07437200
074373         MOVE  '2115'  TO  PT-CURR-PARA                           07437300
074374         PERFORM 8120-INTERNAL-TABLE                              07437400
074375     END-IF.                                                      07437500
074376                                                                  07437600
074377     IF PS-SHOW-DEBUG-INFO                                        07437700
074378         STRING ' SUKCS700-2115-PBS-ELIGIBLE-COUNT '              07437800
074379             DELIMITED BY SIZE                                    07437900
074380             INTO PV-CICS-MSG-AREA                                07438000
074381         PERFORM 9990-WRITE-CICS                                  07438100
074382     END-IF.                                                      07438200
074383                                                                  07438300
074384     MOVE  ZEROES  TO  PV-ELIGIBLE-PBS-RCVRS.                     07438400
074385                                                                  07438500
074386     EXEC SQL                                                     07438600
074387        SELECT  COUNT(*)                                          07438700
074388          INTO :PV-ELIGIBLE-PBS-RCVRS                             07438800
074389          FROM                                                    07438900
074390                RCT_PO_RCVR_TRKG A                                07439000
074391             ,  TSHPTPO B                                         07439100
074392             ,  TSHIPMT C                                         07439200
074393             ,  TRECEIV D                                         07439300
074394           WHERE A.DC_FUNC_CDE    = '0M'                          07439400
074395             AND A.PO_NBR         =  B.PO_NBR                     07439500
074396             AND A.RCVR_SEQ_NBR   =  B.REC_SEQ_NBR                07439600
074397             AND B.SHIPT_ID       =  C.SHIPT_ID                   07439700
074398             AND C.TRIP_ID        = :DK-TRIP-ID                   07439800
074399             AND A.PO_NBR         =  D.ORD_NBR                    07439900
074400             AND A.RCVR_SEQ_NBR   =  D.REC_SEQ_NBR                07440000
074401             AND D.VER_STATUS_CDE = 'A'                           07440100
074402             AND D.PACK_BY_ST_IND = 'Y'                           07440200
074403            WITH UR                                               07440300
074404     END-EXEC.                                                    07440400
074405                                                                  07440500
074406     EVALUATE TRUE                                                07440600
074407         WHEN SQLCODE = ZERO                                      07440700
074408              CONTINUE                                            07440800
074409                                                                  07440900
074410         WHEN SQLCODE = +100                                      07441000
074411              MOVE ZEROES  TO  PV-ELIGIBLE-PBS-RCVRS              07441100
074412                                                                  07441200
074413         WHEN SQLWARN0 NOT = SPACES                               07441300
074414         WHEN SQLCODE NOT EQUAL ZERO                              07441400
074415              move '2115'  to  PV-CSSL-PARA                       07441500
074416              perform 8110-WRITE-SUWS109-TO-CSSL                  07441600
074417                                                                  07441700
074418             MOVE '2115-PBS-ELIGIBLE-COUNT '                      07441800
074419                                   TO DP013-PARAGRAPH             07441900
074420             MOVE 'SUKCS700 - COUNT PBS ELIGIBLE RCVRS '          07442000
074421                                   TO DP013-MESSAGE-TEXT(1)       07442100
074422             MOVE DK-ORD-NBR       TO PV-DISP-PO                  07442200
074423             MOVE DK-REC-SEQ-NBR   TO PV-DISP-RCVR                07442300
074424                                                                  07442400
074425             STRING 'RCVR:'                                       07442500
074426                     PV-DISP-PO      '-'                          07442600
074427                     PV-DISP-RCVR DELIMITED BY SIZE               07442700
074428                                     INTO DP013-MESSAGE-TEXT(2)   07442800
074429                                                                  07442900
074430             MOVE SQLCA            TO DP013-SQLCA                 07443000
074431             MOVE 'TPKSLIP    '    TO DP013-DB2-TABLE-NAME(1)     07443100
074432             MOVE 'TINPKSU    '    TO DP013-DB2-TABLE-NAME(2)     07443200
074433             SET DP013-DB2-ABEND   TO TRUE                        07443300
074434             SET DP013-ROLLBACK    TO TRUE                        07443400
074435             PERFORM 9999-WRITE-CICS-LOG-MSG                      07443500
074436             SET PS-DUMP-TO-LOG    TO TRUE                        07443600
074437             SET SU109-INVALID-SQL TO TRUE                        07443700
074438     END-EVALUATE.                                                07443800
074439                                                                  07443900
074440     IF PS-SHOW-DEBUG-INFO                                        07444000
074441         MOVE PV-ELIGIBLE-PBS-RCVRS TO  PV-DISP-COUNT             07444100
074442         STRING ' SUKCS700-2115-PBS-ELIGIBLE-COUNT '              07444200
074443                 PV-DISP-COUNT                                    07444300
074444             DELIMITED BY SIZE                                    07444400
074445             INTO PV-CICS-MSG-AREA                                07444500
074446         PERFORM 9990-WRITE-CICS                                  07444600
074447     END-IF.                                                      07444700
074448                                                                  07444800
074449                                                                  07444900
074450*----------------------------------------------------------------*07445000
074451* CHECK IF THE RECEIVER HAS ANY PBS ERRORS                       *07445100
074452*----------------------------------------------------------------*07445200
074453 2120-PBS-ERROR-CHECK.                                            07445300
074454                                                                  07445400
074455     IF  PS-BLD-INTERNAL-TABLE-YES                                07445500
074456         MOVE  '2120'  TO  PT-CURR-PARA                           07445600
074457         PERFORM 8120-INTERNAL-TABLE                              07445700
074458     END-IF.                                                      07445800
074459                                                                  07445900
074460     IF PS-SHOW-DEBUG-INFO                                        07446000
074461         STRING ' SUKCS700-2120-PBS-ERRORS '                      07446100
074462             DELIMITED BY SIZE                                    07446200
074463             INTO PV-CICS-MSG-AREA                                07446300
074464         PERFORM 9990-WRITE-CICS                                  07446400
074465     END-IF.                                                      07446500
074466                                                                  07446600
074467     MOVE  ZEROES  TO  PV-PBS-ERROR-CNT.                          07446700
074468                                                                  07446800
074469     EXEC SQL                                                     07446900
074470        SELECT  COUNT(*)                                          07447000
074471          INTO :PV-PBS-ERROR-CNT                                  07447100
074472          FROM                                                    07447200
074473                TPKSLIP A                                         07447300
074474             ,  TINPKSU B                                         07447400
074475             ,  TSHUNLO C                                         07447500
074476           WHERE A.PO_NBR         = :DK-ORD-NBR                   07447600
074477             AND A.REC_SEQ_NBR    = :DK-REC-SEQ-NBR               07447700
074478             AND A.VER_STAT_CDE   = 'A'                           07447800
074479             AND A.PKSL_STAT_CDE  = 'AC'                          07447900
074480             AND A.PO_NBR         =  B.PO_NBR                     07448000
074481             AND A.SEQ_NBR        =  B.SEQ_NBR                    07448100
074482             AND B.SHIPT_UNT_ID   =  C.SHIPT_UNT_ID               07448200
074483             AND C.SCN_LOC_ID    IN ('PBSA','PBSB','PBSC',        07448300
074484                                      'PBSD','PBSE')              07448400
074485           FETCH FIRST 1 ROW ONLY                                 07448500
074486           WITH UR                                                07448600
074487     END-EXEC.                                                    07448700
074488                                                                  07448800
074489     EVALUATE TRUE                                                07448900
074490         WHEN SQLCODE = ZERO                                      07449000
074491              SET  SU109-SUCCESSFUL        TO  TRUE               07449100
074492                                                                  07449200
074493         WHEN SQLCODE = +100                                      07449300
074494              MOVE ZEROES  TO  PV-PBS-ERROR-CNT                   07449400
074495              SET  SU109-SUCCESSFUL        TO  TRUE               07449500
074496                                                                  07449600
074497         WHEN SQLWARN0 NOT = SPACES                               07449700
074498         WHEN SQLCODE NOT EQUAL ZERO                              07449800
074499              MOVE ZEROES  TO  PV-PBS-ERROR-CNT                   07449900
074500              move '2120'  to  PV-CSSL-PARA                       07450000
074501              perform 8110-WRITE-SUWS109-TO-CSSL                  07450100
074502                                                                  07450200
074503             MOVE '2120-PBS-ERRORS        '                       07450300
074504                                   TO DP013-PARAGRAPH             07450400
074505             MOVE 'SUKCS700 - PBS ERROR CHECK    '                07450500
074506                                   TO DP013-MESSAGE-TEXT(1)       07450600
074507             MOVE DK-ORD-NBR       TO PV-DISP-PO                  07450700
074508             MOVE DK-REC-SEQ-NBR   TO PV-DISP-RCVR                07450800
074509                                                                  07450900
074510             STRING 'RCVR:'                                       07451000
074511                     PV-DISP-PO      '-'                          07451100
074512                     PV-DISP-RCVR DELIMITED BY SIZE               07451200
074513                                     INTO DP013-MESSAGE-TEXT(2)   07451300
074514                                                                  07451400
074515             MOVE SQLCA            TO DP013-SQLCA                 07451500
074516             MOVE 'TPKSLIP    '    TO DP013-DB2-TABLE-NAME(1)     07451600
074517             MOVE 'TINPKSU    '    TO DP013-DB2-TABLE-NAME(2)     07451700
074518             MOVE 'TSHUNLO    '    TO DP013-DB2-TABLE-NAME(3)     07451800
074519             SET DP013-DB2-ABEND   TO TRUE                        07451900
074520             SET DP013-ROLLBACK    TO TRUE                        07452000
074521             PERFORM 9999-WRITE-CICS-LOG-MSG                      07452100
074522             SET PS-DUMP-TO-LOG    TO TRUE                        07452200
074523             SET SU109-INVALID-SQL TO TRUE                        07452300
074524     END-EVALUATE.                                                07452400
074525                                                                  07452500
074526     IF PS-SHOW-DEBUG-INFO                                        07452600
074527         MOVE PV-PBS-ERROR-CNT     TO  PV-DISP-COUNT              07452700
074528         STRING ' SUKCS700-2120-PBS-ERRORS  -    '                07452800
074529                 PV-DISP-COUNT                                    07452900
074530             DELIMITED BY SIZE                                    07453000
074531             INTO PV-CICS-MSG-AREA                                07453100
074532         PERFORM 9990-WRITE-CICS                                  07453200
074533     END-IF.                                                      07453300
074534                                                                  07453400
074535                                                                  07453500
074536*----------------------------------------------------------------*07453600
074537* CHECK IF ANY CARTONS HAVE ALREADY BEEN CHECKED IN FOR THE RCVR *07453700
074538*----------------------------------------------------------------*07453800
074539 2130-PBS-CHECKED-IN.                                             07453900
074540                                                                  07454000
074541     IF  PS-BLD-INTERNAL-TABLE-YES                                07454100
074542         MOVE  '2130'  TO  PT-CURR-PARA                           07454200
074543         PERFORM 8120-INTERNAL-TABLE                              07454300
074544     END-IF.                                                      07454400
074545                                                                  07454500
074546     IF PS-SHOW-DEBUG-INFO                                        07454600
074547         STRING ' SUKCS700-2130-PBS-CHECKED-IN '                  07454700
074548             DELIMITED BY SIZE                                    07454800
074549             INTO PV-CICS-MSG-AREA                                07454900
074550         PERFORM 9990-WRITE-CICS                                  07455000
074551     END-IF.                                                      07455100
074552                                                                  07455200
074553     MOVE  ZEROES  TO  PV-PBS-CHECKED-IN-CNT                      07455300
074554                                                                  07455400
074555     EXEC SQL                                                     07455500
074556        SELECT  COUNT(*)                                          07455600
074557          INTO :PV-PBS-CHECKED-IN-CNT                             07455700
074558          FROM                                                    07455800
074559                TPKSLIP A                                         07455900
074560             ,  TINPKSU B                                         07456000
074561             ,  TSHUNLO C                                         07456100
074562           WHERE A.PO_NBR         = :DK-ORD-NBR                   07456200
074563             AND A.REC_SEQ_NBR    = :DK-REC-SEQ-NBR               07456300
074564             AND A.VER_STAT_CDE   = 'A'                           07456400
074565             AND A.PKSL_STAT_CDE  = 'AC'                          07456500
074566             AND A.PO_NBR         =  B.PO_NBR                     07456600
074567             AND A.SEQ_NBR        =  B.SEQ_NBR                    07456700
074568             AND B.SHIPT_UNT_ID   =  C.SHIPT_UNT_ID               07456800
074569             AND C.SCN_LOC_ID    IN ('RECV','WRCV')               07456900
074570             AND C.ACTV_CDE       =  'A'                          07457000
074571             AND C.TRIP_ID        = :DK-TRIP-ID                   07457100
074572           FETCH FIRST 1 ROW ONLY                                 07457200
074573           WITH UR                                                07457300
074574     END-EXEC.                                                    07457400
074575                                                                  07457500
074576     EVALUATE TRUE                                                07457600
074577         WHEN SQLCODE = ZERO                                      07457700
074578              SET  SU109-SUCCESSFUL        TO  TRUE               07457800
074579                                                                  07457900
074580         WHEN SQLCODE = +100                                      07458000
074581              MOVE ZEROES  TO  PV-PBS-CHECKED-IN-CNT              07458100
074582              SET  SU109-SUCCESSFUL        TO  TRUE               07458200
074583                                                                  07458300
074584         WHEN SQLWARN0 NOT = SPACES                               07458400
074585         WHEN SQLCODE NOT EQUAL ZERO                              07458500
074586              MOVE ZEROES  TO  PV-PBS-CHECKED-IN-CNT              07458600
074587              move '2130'  to  PV-CSSL-PARA                       07458700
074588              perform 8110-WRITE-SUWS109-TO-CSSL                  07458800
074589                                                                  07458900
074590             MOVE '2130-PBS-CHECKED-IN    '                       07459000
074591                                   TO DP013-PARAGRAPH             07459100
074592             MOVE 'SUKCS700 - PBS CHECK IN COUNT '                07459200
074593                                   TO DP013-MESSAGE-TEXT(1)       07459300
074594             MOVE DK-ORD-NBR       TO PV-DISP-PO                  07459400
074595             MOVE DK-REC-SEQ-NBR   TO PV-DISP-RCVR                07459500
074596                                                                  07459600
074597             STRING 'RCVR:'                                       07459700
074598                     PV-DISP-PO      '-'                          07459800
074599                     PV-DISP-RCVR DELIMITED BY SIZE               07459900
074600                                     INTO DP013-MESSAGE-TEXT(2)   07460000
074601                                                                  07460100
074602             MOVE SQLCA            TO DP013-SQLCA                 07460200
074603             MOVE 'TPKSLIP    '    TO DP013-DB2-TABLE-NAME(1)     07460300
074604             MOVE 'TINPKSU    '    TO DP013-DB2-TABLE-NAME(2)     07460400
074605             MOVE 'TSHUNLO    '    TO DP013-DB2-TABLE-NAME(3)     07460500
074606             SET DP013-DB2-ABEND   TO TRUE                        07460600
074607             SET DP013-ROLLBACK    TO TRUE                        07460700
074608             PERFORM 9999-WRITE-CICS-LOG-MSG                      07460800
074609             SET PS-DUMP-TO-LOG    TO TRUE                        07460900
074610             SET SU109-INVALID-SQL TO TRUE                        07461000
074611     END-EVALUATE.                                                07461100
074612                                                                  07461200
074613     IF PS-SHOW-DEBUG-INFO                                        07461300
074614         MOVE PV-PBS-CHECKED-IN-CNT  TO  PV-DISP-COUNT            07461400
074615         STRING ' SUKCS700-2130-PBS-CHECKED-IN - '                07461500
074616                 PV-DISP-COUNT                                    07461600
074617             DELIMITED BY SIZE                                    07461700
074618             INTO PV-CICS-MSG-AREA                                07461800
074619         PERFORM 9990-WRITE-CICS                                  07461900
074620     END-IF.                                                      07462000
074621                                                                  07462100
074622                                                                  07462200
074623*----------------------------------------------------------------*07462300
074624* CHECK IF PO-RCVR REQUIRES EAS TAGGING                          *07462400
074625*----------------------------------------------------------------*07462500
074626 2140-PBS-EAS-CHECK.                                              07462600
074627                                                                  07462700
074628     IF  PS-BLD-INTERNAL-TABLE-YES                                07462800
074629         MOVE  '2140'  TO  PT-CURR-PARA                           07462900
074630         PERFORM 8120-INTERNAL-TABLE                              07463000
074631     END-IF.                                                      07463100
074632                                                                  07463200
074633     IF PS-SHOW-DEBUG-INFO                                        07463300
074634         STRING ' SUKCS700-2140-PBS-EAS-CHECK '                   07463400
074635             DELIMITED BY SIZE                                    07463500
074636             INTO PV-CICS-MSG-AREA                                07463600
074637         PERFORM 9990-WRITE-CICS                                  07463700
074638     END-IF.                                                      07463800
074639                                                                  07463900
074642*** rfid logic from SUKRF502 - begin                              07464208
074643     INITIALIZE SU093-ITEM-COMMAREA.                              07464308
074644     SET SU093-RFID-KOHL-DPT-IN-STR-NO         TO TRUE.           07464408
074645     SET SU093-RFID-KOHL-DEPT-SUBCL-NO         TO TRUE.           07464508
074646     SET SU093-VNDR-DPT-RFID-COMPLI-NO         TO TRUE.           07464608
074647     SET SU093-VNDR-DPT-RFID-TAGS-NO           TO TRUE.           07464708
074648     SET SU093-DC-DEPT-TAGS-NO                 TO TRUE.           07464808
074649     SET SU093-DC-USE-RFID-CART-LBL-NO         TO TRUE.           07464908
074650     SET SU093-RFID-DC-AUTO-CONVEYR-NO         TO TRUE.           07465008
074651     SET SU093-DPT-STR-P2L-FIRST-NO            TO TRUE.           07465108
074653     SET SU093-IR-CHK-IN-NO                    TO TRUE.           07465308
074656     SET SU093-P2L-CHK-IN-NO                   TO TRUE.           07465608
074657                                                                  07465708
074676     SET SU093-CHECK-IN                        TO TRUE.           07467610
074687     SET SU093-CHECK-BY-DEPT-SUBCLS-YES        TO TRUE.           07468710
074688     SET SU093-CHECK-BY-DEPT-IN-STR-NO         TO TRUE.           07468811
074689     SET SU093-RFID-STR-CHK-NEEDED-NO          TO TRUE.           07468911
074690     SET SU093-CHECK-BY-DC                     TO TRUE.           07469010
074691                                                                  07469110
074692     MOVE SU109-OPER-UNT-ID      TO SU093-KEY-OPER-UNT-ID.        07469210
074693     MOVE SU109-ORD-NBR          TO SU093-KEY-PO.                 07469310
074694     MOVE SU109-REC-SEQ-NBR      TO SU093-KEY-REC-SEQ-NBR.        07469410
074695     MOVE SU109-ORD-LNE-NBR      TO SU093-KEY-LNE-NBR.            07469510
074696     MOVE SU109-PREPK-ID         TO SU093-KEY-PREPK-ID.           07469610
074698     MOVE ZEROES                 TO SU093-KEY-DEST-LOC.           07469811
074699     MOVE SU109-BAR-CODE         TO SU093-KEY-CARTON-ID.          07469910
074700                                                                  07470010
074701     CALL SU093-RFID-PGM       USING DFHEIBLK                     07470110
074702                                     SU093-COMMAREA               07470210
074703                                     SU093-ITEM-COMMAREA.         07470310
074704                                                                  07470410
074705*** rfid logic from SUKRF502 - end                                07470510
074710                                                                  07471008
074716     IF PS-SHOW-DEBUG-INFO                                        07471600
074718         MOVE SU093-SQLCODE          TO  PV-DISP-SQL              07471810
074719         STRING ' SUKCS700-2140-PBS-EAS-CHECK '                   07471910
074720                '  RFID:'         SU093-RFID-IND                  07472010
074721                '  lbl:'          SU093-LABEL-PRINT-IND           07472110
074722                '  RC:'           SU093-RETURN-CODE               07472210
074723                '  ERR:'          SU093-ERROR-NBR                 07472310
074724                '  SQL:'          PV-DISP-SQL                     07472410
074725             DELIMITED BY SIZE                                    07472510
074726             INTO PV-CICS-MSG-AREA                                07472610
074727         PERFORM 9990-WRITE-CICS                                  07472710
074728     END-IF.                                                      07472810
074729                                                                  07472910
074730                                                                  07473010
074731*----------------------------------------------------------------*07473110
074732* CHECK IF pbs po-rcvr required a carton audit                   *07473210
074733*----------------------------------------------------------------*07473310
074734 2150-CHECK-PBS-AUDIT.                                            07473410
074735                                                                  07473510
074736     IF  PS-BLD-INTERNAL-TABLE-YES                                07473610
074737         MOVE  '2150'  TO  PT-CURR-PARA                           07473710
074738         PERFORM 8120-INTERNAL-TABLE                              07473810
074739     END-IF.                                                      07473910
074740                                                                  07474010
074741     IF PS-SHOW-DEBUG-INFO                                        07474110
074742         STRING ' SUKCS700-2150-CHECK-PBS-AUDIT '                 07474210
074743             DELIMITED BY SIZE                                    07474310
074744             INTO PV-CICS-MSG-AREA                                07474410
074745         PERFORM 9990-WRITE-CICS                                  07474510
074746     END-IF.                                                      07474610
074747                                                                  07474710
074748     MOVE ZEROES  TO  SU021-PO-NUMBER                             07474810
074749                      SU021-LINE-NBR                              07474910
074750                      SU021-DRIVER-LINE-NBR                       07475010
074751                      SU021-PRE-PACK-ID                           07475110
074752                      SU021-OPER-UNT-ID                           07475210
074753                      SU021-REC-SEQ-NBR                           07475310
074754                      SU021-INBOUND-TRIP-ID                       07475410
074755                      SU021-SHIPT-UNT-ID                          07475510
074756                      SU021-AUDIT-NUMBER                          07475610
074757                      SU021-RFID-AUDIT-NUMBER.                    07475710
074758                                                                  07475810
074759     MOVE SPACES  TO  SU021-AUDIT-REQUEST-TYPE                    07475910
074760                      SU021-PACKAGE-TYPE-CODE                     07476010
074761                      SU021-USER-ID                               07476110
074762                      SU021-DEFERRED-AUDIT-IND                    07476210
074763                      SU021-AUDIT-REQUIRED-SW                     07476310
074764                      SU021-AUDIT-VALIDATION-SW                   07476410
074765                      SU021-PRINT-APPLY-SW                        07476510
074766                      SU021-RFID-AUDIT-REQUIRED-SW                07476610
074767                      SU021-RFID-AUDIT-VALIDATION-SW.             07476710
074768                                                                  07476810
074769     MOVE SU109-OPER-UNT-ID        TO SU021-OPER-UNT-ID.          07476910
074770     MOVE SU109-ORD-NBR            TO SU021-PO-NUMBER.            07477010
074771     MOVE SU109-REC-SEQ-NBR        TO SU021-REC-SEQ-NBR.          07477110
074772     MOVE SU109-TRIP-ID            TO SU021-INBOUND-TRIP-ID.      07477210
074773     MOVE SU109-BAR-CODE           TO SU021-SHIPT-UNT-ID.         07477310
074774     MOVE 'PS'                     TO SU021-PACKAGE-TYPE-CODE.    07477410
074775                                                                  07477510
074776     IF  SU109-ACM-LBL-STA-NBR > 0                                07477610
074777         SET SU021-PRINT-APPLY     TO TRUE                        07477710
074778     END-IF.                                                      07477810
074779                                                                  07477910
074780     PERFORM 6000-CALL-SUKCS752.                                  07478010
074781                                                                  07478110
074782     IF PS-SHOW-DEBUG-INFO                                        07478210
074783         STRING ' SUKCS700-2150-CHECK-PBS-AUDIT - '               07478310
074784                  SU021-AUDIT-REQUEST-TYPE '-'                    07478410
074785                  SU021-AUDIT-VALIDATION-SW '-'                   07478510
074786                  SU021-AUDIT-REQUIRED-SW '-'                     07478610
074787             DELIMITED BY SIZE                                    07478710
074788             INTO PV-CICS-MSG-AREA                                07478810
074789         PERFORM 9990-WRITE-CICS                                  07478910
074790                                                                  07479010
074791         MOVE SPACES  TO  PV-CICS-MSG-AREA                        07479110
074792         PERFORM 9990-WRITE-CICS                                  07479210
074793     END-IF.                                                      07479310
074794                                                                  07479410
074795                                                                  07479510
074800*----------------------------------------------------------------*07480000
074810* BULK CHECKS                                                    *07481000
074820*----------------------------------------------------------------*07482000
074830 3000-BULK-CHECKS.                                                07483000
074831                                                                  07483100
074832     IF  PS-BLD-INTERNAL-TABLE-YES                                07483200
074833         MOVE  '3000'  TO  PT-CURR-PARA                           07483300
074834         PERFORM 8120-INTERNAL-TABLE                              07483400
074835     END-IF.                                                      07483500
074836                                                                  07483600
074837     IF PS-SHOW-DEBUG-INFO                                        07483700
074838         STRING ' SUKCS700-3000-BULK-CHECKS '                     07483800
074839             DELIMITED BY SIZE                                    07483900
074840             INTO PV-CICS-MSG-AREA                                07484000
074841         PERFORM 9990-WRITE-CICS                                  07484100
074842     END-IF.                                                      07484200
074843                                                                  07484300
074844* CHECK IF DC IS CHECKING BULK ORDERS FOR THIN SLICE              07484400
074845     PERFORM 3100-THNSLCBULK.                                     07484500
074846                                                                  07484600
074847* CHECK IF CARTONS ON RECEIVER IS > MAX ALLOWED FOR THIN SLICE    07484700
074848     IF  PS-DC-THIN-SLICE-BULK-YES  AND                           07484800
074849         SU109-SUCCESSFUL                                         07484900
074850         PERFORM 3110-BULK-COUNT-SSCC                             07485000
074851         IF  PS-DC-THIN-SLICE-BULK-YES                            07485100
074852             IF  PV-CARTONS-ON-RCVR  >  PV-MAX-CRTNS              07485200
074853                 SET  PS-DC-THIN-SLICE-BULK-NO  TO  TRUE          07485300
074854             END-IF                                               07485400
074855         END-IF                                                   07485500
074856     END-IF.                                                      07485600
074857                                                                  07485700
074858* CHECK IF NUMBER OF BULK RECEIVERS IS GREATER THEN MAX           07485800
074859     IF  PS-DC-THIN-SLICE-BULK-YES  AND                           07485900
074860         SU109-SUCCESSFUL                                         07486000
074861         PERFORM 3115-BULK-ELIGIBLE-COUNT                         07486100
074862         IF  PS-DC-THIN-SLICE-BULK-YES                            07486200
074863             IF  PV-ELIGIBLE-BULK-RCVRS  >=  PV-MAX-rcvrs         07486300
074864                 SET  PS-DC-THIN-SLICE-BULK-NO  TO  TRUE          07486400
074865             END-IF                                               07486500
074866         END-IF                                                   07486600
074867     END-IF.                                                      07486700
074868                                                                  07486800
074869* CHECK IF ANY CARTONS HAVE ALREADY BEEN CHECKED IN FOR RCVR      07486900
074870     IF  PS-DC-THIN-SLICE-BULK-YES  AND                           07487000
074871         SU109-SUCCESSFUL                                         07487100
074872         PERFORM 3130-BULK-CHECKED-IN                             07487200
074873         IF  PV-BULK-CHECKED-IN-CNT   >  0                        07487300
074874             SET  PS-DC-THIN-SLICE-BULK-NO  TO  TRUE              07487400
074875         END-IF                                                   07487500
074876     END-IF.                                                      07487600
074877                                                                  07487700
074878* CHECK IF PO-RCVR REQUIRES EAS TAGGING                           07487800
074879     IF  PS-DC-THIN-SLICE-BULK-YES  AND                           07487900
074880         SU109-SUCCESSFUL                                         07488000
074881         PERFORM 3140-BULK-EAS-CHECK                              07488100
074882         IF  SU093-RFID-YES   OR                                  07488211
074883             SU093-PRINT-EAS  or                                  07488311
074884             SU093-PRINT-RFID-EAS                                 07488410
074885             SET  PS-DC-THIN-SLICE-BULK-NO  TO  TRUE              07488500
074886         END-IF                                                   07488600
074887     END-IF.                                                      07488700
074888                                                                  07488800
074889* CHECK IF PO-RCVR REQUIRES AUDIT                                 07488900
074890     IF  PS-DC-THIN-SLICE-BULK-YES  AND                           07489000
074891         SU109-SUCCESSFUL                                         07489100
074892         PERFORM 3150-CHECK-BULK-AUDIT                            07489200
074893         IF  SU021-AUDIT-REQUIRED-SW  =  'Y'                      07489300
074894             MOVE PC-NOT-ELIGIBLE-THN-SLC                         07489400
074895                                    TO RCT00017-DC-FUNC-CDE       07489500
074896             SET  PS-DC-THIN-SLICE-bulk-NO  TO  TRUE              07489600
074897             SET SU109-THIN-SLICE-SELECTED-NO  tO  TRUE           07489700
074898         else                                                     07489800
074899             IF  SU109-SUCCESSFUL                                 07489900
074900                 set  PS-DC-THIN-SLICE-bulk-YES  to  true         07490000
074901                 PERFORM 6050-CREATE-TROUBLE                      07490100
074902             ELSE                                                 07490200
074903                 SET  PS-DC-THIN-SLICE-bulk-NO  TO  TRUE          07490300
074904             END-IF                                               07490400
074905         END-IF                                                   07490500
074906     END-IF.                                                      07490600
074907                                                                  07490700
074908*                                                                 07490800
074909     IF  SU109-SUCCESSFUL                                         07490900
074910         MOVE SU109-ORD-NBR         TO RCT00017-PO-NBR            07491000
074911         MOVE SU109-REC-SEQ-NBR     TO RCT00017-RCVR-SEQ-NBR      07491100
074912         MOVE SU109-USER-ID         TO RCT00017-CRE-BY-USR-ID     07491200
074913         MOVE SU109-OPER-UNT-ID     TO RCT00017-LOC-NBR           07491300
074914         MOVE ZEROES                TO RCT00017-PO-LNE-NBR        07491400
074915         MOVE ZEROES                TO RCT00017-PREPK-ID          07491500
074916         MOVE ZEROES                TO RCT00017-QTY-TRKD-NBR      07491600
074917         MOVE ZEROES                TO RCT00017-PKSL-SEQ-NBR      07491700
074918         MOVE ZEROES                TO RCT00017-DEST-LOC-NBR      07491800
074919                                                                  07491900
074920         IF  PS-DC-THIN-SLICE-BULK-NO                             07492000
074921             MOVE PC-NOT-ELIGIBLE-THN-SLC                         07492100
074922                                    TO RCT00017-DC-FUNC-CDE       07492200
074923             SET SU109-THIN-SLICE-SELECTED-NO  tO  TRUE           07492300
074924         ELSE                                                     07492400
074925             MOVE PC-ELIGIBLE-THN-SLC                             07492500
074926                                    TO RCT00017-DC-FUNC-CDE       07492600
074927             SET  SU109-THIN-SLICE-SELECTED    TO  TRUE           07492700
074928         END-IF                                                   07492800
074929                                                                  07492900
074930         PERFORM 7000-INSERT-PO-TRKG                              07493000
074931        END-IF.                                                   07493100
074932                                                                  07493200
074933                                                                  07493300
074934*----------------------------------------------------------------*07493400
074935* PARM THNSLCBULK - CHECKING THIN SLICE FOR BULK                 *07493500
074936*----------------------------------------------------------------*07493600
074937 3100-THNSLCBULK.                                                 07493700
074938                                                                  07493800
074939     IF  PS-BLD-INTERNAL-TABLE-YES                                07493900
074940         MOVE  '3100'  TO  PT-CURR-PARA                           07494000
074941         PERFORM 8120-INTERNAL-TABLE                              07494100
074942     END-IF.                                                      07494200
074943                                                                  07494300
074944     IF PS-SHOW-DEBUG-INFO                                        07494400
074945         STRING ' SUKCS700-3100-THNSLCBULK '                      07494500
074946             DELIMITED BY SIZE                                    07494600
074947             INTO PV-CICS-MSG-AREA                                07494700
074948         PERFORM 9990-WRITE-CICS                                  07494800
074949     END-IF.                                                      07494900
074950                                                                  07495000
074951                                                                  07495100
074952     EXEC SQL                                                     07495200
074953        SELECT  D.ATTR_ELEM_NBR                                   07495300
074954             ,  E.ATTR_ELEM_TXT                                   07495400
074955             ,  K.ATTR_ELEM_NBR                                   07495500
074956          INTO :PV-MAX-CRTNS                                      07495600
074957             , :PS-DC-THIN-SLICE-BULK-SW                          07495700
074958             , :PV-MAX-RCVRS                                      07495800
074959          FROM                                                    07495900
074960                WST_INTGRTN_TYP  A                                07496000
074961             ,  WST_ATTR_DEFN    B                                07496100
074962             ,  WST_ATTR_ELEM    C    -- DC                       07496200
074963             ,  WST_ATTR_ELEM    D    -- MAX CARTONS              07496300
074964             ,  WST_ATTR_ELEM    E    -- Y/N                      07496400
074965             ,  WST_ATTR_ELEM    F    -- BEGIN TMST               07496500
074966             ,  WST_ATTR_ELEM    G    -- END TMST                 07496600
074967             ,  WST_ATTR_ELEM    H    -- SETUP TK                 07496700
074968             ,  WST_ATTR_ELEM    I    -- REQUEST TK               07496800
074969             ,  WST_ATTR_ELEM    J    -- FREEFORM INFO            07496900
074970             ,  WST_ATTR_ELEM    K    -- MAX RCVRS                07497000
074971          WHERE                                                   07497100
074972                A.INTGRTN_TYP_CDE   = 'THNSLCBULK'                07497200
074973            AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE           07497300
074974            AND B.ATTR_DEFN_SEQ_NBR = 1                           07497400
074975            AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE           07497500
074976            AND C.ATTR_DEFN_SEQ_NBR = 1                           07497600
074977            AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE           07497700
074978            AND D.ATTR_DEFN_SEQ_NBR = 2                           07497800
074979            AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE           07497900
074980            AND E.ATTR_DEFN_SEQ_NBR = 3                           07498000
074981            AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE           07498100
074982            AND F.ATTR_DEFN_SEQ_NBR = 4                           07498200
074983            AND B.INTGRTN_TYP_CDE   = G.INTGRTN_TYP_CDE           07498300
074984            AND G.ATTR_DEFN_SEQ_NBR = 5                           07498400
074985            AND B.INTGRTN_TYP_CDE   = H.INTGRTN_TYP_CDE           07498500
074986            AND H.ATTR_DEFN_SEQ_NBR = 6                           07498600
074987            AND B.INTGRTN_TYP_CDE   = I.INTGRTN_TYP_CDE           07498700
074988            AND I.ATTR_DEFN_SEQ_NBR = 7                           07498800
074989            AND B.INTGRTN_TYP_CDE   = J.INTGRTN_TYP_CDE           07498900
074990            AND J.ATTR_DEFN_SEQ_NBR = 8                           07499000
074991            AND B.INTGRTN_TYP_CDE   = K.INTGRTN_TYP_CDE           07499100
074992            AND K.ATTR_DEFN_SEQ_NBR = 9                           07499200
074993            AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR         07499300
074994            AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR         07499400
074995            AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR         07499500
074996            AND C.ATTR_ELEM_SEQ_NBR = G.ATTR_ELEM_SEQ_NBR         07499600
074997            AND C.ATTR_ELEM_SEQ_NBR = H.ATTR_ELEM_SEQ_NBR         07499700
074998            AND C.ATTR_ELEM_SEQ_NBR = I.ATTR_ELEM_SEQ_NBR         07499800
074999            AND C.ATTR_ELEM_SEQ_NBR = J.ATTR_ELEM_SEQ_NBR         07499900
075000            AND C.ATTR_ELEM_SEQ_NBR = K.ATTR_ELEM_SEQ_NBR         07500000
075001            AND C.ATTR_ELEM_NBR     = :DK-OPER-UNT-ID             07500100
075002            AND E.ATTR_ELEM_TXT     = 'Y'                         07500200
075003            AND F.ATTR_ELEM_TMST   <= CURRENT TIMESTAMP           07500300
075004            AND G.ATTR_ELEM_TMST   >= CURRENT TIMESTAMP           07500400
075005           WITH UR                                                07500500
075006     END-EXEC.                                                    07500600
075007                                                                  07500700
075008     EVALUATE TRUE                                                07500800
075009         WHEN SQLCODE = ZERO                                      07500900
075010              SET  PS-DC-THIN-SLICE-BULK-YES                      07501000
075011                   SU109-SUCCESSFUL        TO  TRUE               07501100
075012                                                                  07501200
075013         WHEN SQLCODE = +100                                      07501300
075014              SET  PS-DC-THIN-SLICE-BULK-NO                       07501400
075015                   SU109-SUCCESSFUL        TO  TRUE               07501500
075016                                                                  07501600
075017         WHEN SQLWARN0 NOT = SPACES                               07501700
075018         WHEN SQLCODE NOT EQUAL ZERO                              07501800
075019              move '3100'  to  PV-CSSL-PARA                       07501900
075020              perform 8110-WRITE-SUWS109-TO-CSSL                  07502000
075021                                                                  07502100
075022             MOVE '3100-THNSLCBULK        '                       07502200
075023                                   TO DP013-PARAGRAPH             07502300
075024             MOVE 'SUKCS700 - SELECT PO TRACKING '                07502400
075025                                   TO DP013-MESSAGE-TEXT(1)       07502500
075026             MOVE DK-ORD-NBR       TO PV-DISP-PO                  07502600
075027             MOVE DK-REC-SEQ-NBR   TO PV-DISP-RCVR                07502700
075028                                                                  07502800
075029             STRING 'RCVR:'                                       07502900
075030                     PV-DISP-PO      '-'                          07503000
075031                     PV-DISP-RCVR DELIMITED BY SIZE               07503100
075032                                     INTO DP013-MESSAGE-TEXT(2)   07503200
075033                                                                  07503300
075034             MOVE SQLCA            TO DP013-SQLCA                 07503400
075035             MOVE 'WST-008-010'    TO DP013-DB2-TABLE-NAME(1)     07503500
075036             SET DP013-DB2-ABEND   TO TRUE                        07503600
075037             SET DP013-ROLLBACK    TO TRUE                        07503700
075038             PERFORM 9999-WRITE-CICS-LOG-MSG                      07503800
075039             SET PS-DUMP-TO-LOG    TO TRUE                        07503900
075040             SET SU109-INVALID-SQL TO TRUE                        07504000
075041     END-EVALUATE.                                                07504100
075042                                                                  07504200
075043     IF PS-SHOW-DEBUG-INFO                                        07504300
075044         STRING ' SUKCS700-3100-THNSLBULK - '                     07504400
075045                PS-DC-THIN-SLICE-BULK-SW                          07504500
075046             DELIMITED BY SIZE                                    07504600
075047             INTO PV-CICS-MSG-AREA                                07504700
075048         PERFORM 9990-WRITE-CICS                                  07504800
075049     END-IF.                                                      07504900
075050                                                                  07505000
075051                                                                  07505100
075052*----------------------------------------------------------------*07505200
075053* COUNT BULK SSCC                                                *07505300
075054*                                                                *07505400
075055* NOTe:  bulk and prepack logic is not complete --- need to      *07505500
075056*        need to determine if the checks are at receover level   *07505600
075057*        or at PO-line/prepack                                   *07505700
075058*----------------------------------------------------------------*07505800
075059 3110-BULK-COUNT-SSCC.                                            07505900
075060                                                                  07506000
075061     IF  PS-BLD-INTERNAL-TABLE-YES                                07506100
075062         MOVE  '3110'  TO  PT-CURR-PARA                           07506200
075063         PERFORM 8120-INTERNAL-TABLE                              07506300
075064     END-IF.                                                      07506400
075065                                                                  07506500
075066     IF PS-SHOW-DEBUG-INFO                                        07506600
075067         STRING ' SUKCS700-3110-BULK-COUNT-SSCC  '                07506700
075068             DELIMITED BY SIZE                                    07506800
075069             INTO PV-CICS-MSG-AREA                                07506900
075070         PERFORM 9990-WRITE-CICS                                  07507000
075071     END-IF.                                                      07507100
075072                                                                  07507200
075073                                                                  07507300
075074     EXEC SQL                                                     07507400
075075        SELECT  COUNT(DISTINCT(b.SHIPT_UNT_ID))                   07507500
075076          INTO :PV-CARTONS-ON-RCVR                                07507600
075077          FROM                                                    07507700
075078                TPKSLIP A                                         07507800
075079             ,  TINPKSU B                                         07507900
075080           where a.PO_NBR         = :DK-ORD-NBR                   07508000
075081             and a.REC_SEQ_NBR    = :DK-REC-SEQ-NBR               07508100
075082             and a.VER_STAT_CDE   = 'A'                           07508200
075083             and a.PKSL_STAT_CDE  = 'AC'                          07508300
075084             and a.PO_NBR         =  b.PO_NBR                     07508400
075085             and a.SEQ_NBR        =  b.SEQ_NBR                    07508500
075086           WITH UR                                                07508600
075087     END-EXEC.                                                    07508700
075088                                                                  07508800
075089     EVALUATE TRUE                                                07508900
075090         WHEN SQLCODE = ZERO                                      07509000
075091              SET  PS-DC-THIN-SLICE-PBS-YES                       07509100
075092                   SU109-SUCCESSFUL        TO  TRUE               07509200
075093                                                                  07509300
075094         WHEN SQLCODE = +100                                      07509400
075095              SET  PS-DC-THIN-SLICE-PBS-NO                        07509500
075096                   SU109-SUCCESSFUL        TO  TRUE               07509600
075097                                                                  07509700
075098         WHEN SQLWARN0 NOT = SPACES                               07509800
075099         WHEN SQLCODE NOT EQUAL ZERO                              07509900
075100              move '3110'  to  PV-CSSL-PARA                       07510000
075101              perform 8110-WRITE-SUWS109-TO-CSSL                  07510100
075102                                                                  07510200
075103             MOVE '3110-BULK-COUNT-SSCC   '                       07510300
075104                                   TO DP013-PARAGRAPH             07510400
075105             MOVE 'SUKCS700 - COUNT RCVR SSCC    '                07510500
075106                                   TO DP013-MESSAGE-TEXT(1)       07510600
075107             MOVE DK-ORD-NBR       TO PV-DISP-PO                  07510700
075108             MOVE DK-REC-SEQ-NBR   TO PV-DISP-RCVR                07510800
075109                                                                  07510900
075110             STRING 'RCVR:'                                       07511000
075111                     PV-DISP-PO      '-'                          07511100
075112                     PV-DISP-RCVR DELIMITED BY SIZE               07511200
075113                                     INTO DP013-MESSAGE-TEXT(2)   07511300
075114                                                                  07511400
075115             MOVE SQLCA            TO DP013-SQLCA                 07511500
075116             MOVE 'TPKSLIP    '    TO DP013-DB2-TABLE-NAME(1)     07511600
075117             MOVE 'TINPKSU    '    TO DP013-DB2-TABLE-NAME(2)     07511700
075118             SET DP013-DB2-ABEND   TO TRUE                        07511800
075119             SET DP013-ROLLBACK    TO TRUE                        07511900
075120             PERFORM 9999-WRITE-CICS-LOG-MSG                      07512000
075121             SET PS-DUMP-TO-LOG    TO TRUE                        07512100
075122             SET SU109-INVALID-SQL TO TRUE                        07512200
075123     END-EVALUATE.                                                07512300
075124                                                                  07512400
075125     IF PS-SHOW-DEBUG-INFO                                        07512500
075126         MOVE PV-CARTONS-ON-RCVR   TO  PV-DISP-COUNT              07512600
075127         STRING ' SUKCS700-3110-BULK-COUNT-SSCC - '               07512700
075128                 PV-DISP-COUNT                                    07512800
075129             DELIMITED BY SIZE                                    07512900
075130             INTO PV-CICS-MSG-AREA                                07513000
075131         PERFORM 9990-WRITE-CICS                                  07513100
075132     END-IF.                                                      07513200
075133                                                                  07513300
075134                                                                  07513400
075135*----------------------------------------------------------------*07513500
075136* COUNT NUMBER OF ELIGIBLE BULK RCVRS ON TRAILER                 *07513600
075137*----------------------------------------------------------------*07513700
075138 3115-BULK-ELIGIBLE-COUNT.                                        07513800
075139                                                                  07513900
075140     IF  PS-BLD-INTERNAL-TABLE-YES                                07514000
075141         MOVE  '3115'  TO  PT-CURR-PARA                           07514100
075142         PERFORM 8120-INTERNAL-TABLE                              07514200
075143     END-IF.                                                      07514300
075144                                                                  07514400
075145     IF PS-SHOW-DEBUG-INFO                                        07514500
075146         STRING ' SUKCS700-3115-BULK-ELIGIBLE-COUNT '             07514600
075147             DELIMITED BY SIZE                                    07514700
075148             INTO PV-CICS-MSG-AREA                                07514800
075149         PERFORM 9990-WRITE-CICS                                  07514900
075150     END-IF.                                                      07515000
075151                                                                  07515100
075152     MOVE  ZEROES  TO  PV-ELIGIBLE-BULK-RCVRS.                    07515200
075153                                                                  07515300
075154     EXEC SQL                                                     07515400
075155        SELECT  COUNT(*)                                          07515500
075156          INTO :PV-ELIGIBLE-BULK-RCVRS                            07515600
075157          FROM                                                    07515700
075158                RCT_PO_RCVR_TRKG A                                07515800
075159             ,  TSHPTPO B                                         07515900
075160             ,  TSHIPMT C                                         07516000
075161             ,  TRECEIV D                                         07516100
075162           WHERE A.DC_FUNC_CDE    = '0M'                          07516200
075163             AND A.PO_NBR         =  B.PO_NBR                     07516300
075164             AND A.RCVR_SEQ_NBR   =  B.REC_SEQ_NBR                07516400
075165             AND B.SHIPT_ID       =  C.SHIPT_ID                   07516500
075166             AND C.TRIP_ID        = :DK-TRIP-ID                   07516600
075167             AND A.PO_NBR         =  D.ORD_NBR                    07516700
075168             AND A.RCVR_SEQ_NBR   =  D.REC_SEQ_NBR                07516800
075169             AND D.VER_STATUS_CDE = 'A'                           07516900
075170             AND D.PKGNG_CDE      = 'B'                           07517000
075171            WITH UR                                               07517100
075172     END-EXEC.                                                    07517200
075173                                                                  07517300
075174     EVALUATE TRUE                                                07517400
075175         WHEN SQLCODE = ZERO                                      07517500
075176              CONTINUE                                            07517600
075177                                                                  07517700
075178         WHEN SQLCODE = +100                                      07517800
075179              MOVE ZEROES  TO  PV-ELIGIBLE-BULK-RCVRS             07517900
075180                                                                  07518000
075181         WHEN SQLWARN0 NOT = SPACES                               07518100
075182         WHEN SQLCODE NOT EQUAL ZERO                              07518200
075183              move '3115'  to  PV-CSSL-PARA                       07518300
075184              perform 8110-WRITE-SUWS109-TO-CSSL                  07518400
075185                                                                  07518500
075186             MOVE '2315-BULK-ELIGIBLE-COUNT '                     07518600
075187                                   TO DP013-PARAGRAPH             07518700
075188             MOVE 'SUKCS700 - COUNT BULK ELIGIBLE RCVRS '         07518800
075189                                   TO DP013-MESSAGE-TEXT(1)       07518900
075190             MOVE DK-ORD-NBR       TO PV-DISP-PO                  07519000
075191             MOVE DK-REC-SEQ-NBR   TO PV-DISP-RCVR                07519100
075192                                                                  07519200
075193             STRING 'RCVR:'                                       07519300
075194                     PV-DISP-PO      '-'                          07519400
075195                     PV-DISP-RCVR DELIMITED BY SIZE               07519500
075196                                     INTO DP013-MESSAGE-TEXT(2)   07519600
075197                                                                  07519700
075198             MOVE SQLCA            TO DP013-SQLCA                 07519800
075199             MOVE 'RCT_PO_RCVR'    TO DP013-DB2-TABLE-NAME(1)     07519900
075200             MOVE 'TSHPTPO    '    TO DP013-DB2-TABLE-NAME(2)     07520000
075201             MOVE 'TSHIPMT    '    TO DP013-DB2-TABLE-NAME(3)     07520100
075202             MOVE 'TRECEIV    '    TO DP013-DB2-TABLE-NAME(4)     07520200
075203             SET DP013-DB2-ABEND   TO TRUE                        07520300
075204             SET DP013-ROLLBACK    TO TRUE                        07520400
075205             PERFORM 9999-WRITE-CICS-LOG-MSG                      07520500
075206             SET PS-DUMP-TO-LOG    TO TRUE                        07520600
075207             SET SU109-INVALID-SQL TO TRUE                        07520700
075208     END-EVALUATE.                                                07520800
075209                                                                  07520900
075210     IF PS-SHOW-DEBUG-INFO                                        07521000
075211         MOVE PV-ELIGIBLE-BULK-RCVRS TO PV-DISP-COUNT             07521100
075212         STRING ' SUKCS700-3115-BULK-ELIGIBLE-COUNT '             07521200
075213                 PV-DISP-COUNT                                    07521300
075214             DELIMITED BY SIZE                                    07521400
075215             INTO PV-CICS-MSG-AREA                                07521500
075216         PERFORM 9990-WRITE-CICS                                  07521600
075217     END-IF.                                                      07521700
075218                                                                  07521800
075219                                                                  07521900
075220*----------------------------------------------------------------*07522000
075221* CHECK IF ANY CARTONS HAVE ALREADY BEEN CHECKED IN FOR THE RCVR *07522100
075222*                                                                *07522200
075223* NOTe:  bulk and prepack logic is not complete --- need to      *07522300
075224*        need to determine if the checks are at receover level   *07522400
075225*        or at PO-line/prepack                                   *07522500
075226*----------------------------------------------------------------*07522600
075227 3130-BULK-CHECKED-IN.                                            07522700
075228                                                                  07522800
075229     IF  PS-BLD-INTERNAL-TABLE-YES                                07522900
075230         MOVE  '3130'  TO  PT-CURR-PARA                           07523000
075231         PERFORM 8120-INTERNAL-TABLE                              07523100
075232     END-IF.                                                      07523200
075233                                                                  07523300
075234     IF PS-SHOW-DEBUG-INFO                                        07523400
075235         STRING ' SUKCS700-3130-BULK-CHECKED-IN  '                07523500
075236             DELIMITED BY SIZE                                    07523600
075237             INTO PV-CICS-MSG-AREA                                07523700
075238         PERFORM 9990-WRITE-CICS                                  07523800
075239     END-IF.                                                      07523900
075240                                                                  07524000
075241     MOVE  ZEROES  TO  PV-BULK-CHECKED-IN-CNT                     07524100
075242                                                                  07524200
075243     EXEC SQL                                                     07524300
075244        SELECT  COUNT(*)                                          07524400
075245          INTO :PV-BULK-CHECKED-IN-CNT                            07524500
075246          FROM                                                    07524600
075247                TPKSLIP A                                         07524700
075248             ,  TINPKSU B                                         07524800
075249             ,  TSHUNLO C                                         07524900
075250           WHERE A.PO_NBR         = :DK-ORD-NBR                   07525000
075251             AND A.REC_SEQ_NBR    = :DK-REC-SEQ-NBR               07525100
075252             AND A.VER_STAT_CDE   = 'A'                           07525200
075253             AND A.PKSL_STAT_CDE  = 'AC'                          07525300
075254             AND A.PO_NBR         =  B.PO_NBR                     07525400
075255             AND A.SEQ_NBR        =  B.SEQ_NBR                    07525500
075256             AND B.SHIPT_UNT_ID   =  C.SHIPT_UNT_ID               07525600
075257             AND C.SCN_LOC_ID    IN ('RECV','WRCV')               07525700
075258             AND C.ACTV_CDE       =  'A'                          07525800
075259             AND C.TRIP_ID        = :DK-TRIP-ID                   07525900
075260           FETCH FIRST 1 ROW ONLY                                 07526000
075261           WITH UR                                                07526100
075262     END-EXEC.                                                    07526200
075263                                                                  07526300
075264     EVALUATE TRUE                                                07526400
075265         WHEN SQLCODE = ZERO                                      07526500
075266              SET  SU109-SUCCESSFUL        TO  TRUE               07526600
075267                                                                  07526700
075268         WHEN SQLCODE = +100                                      07526800
075269              MOVE ZEROES  TO  PV-BULK-CHECKED-IN-CNT             07526900
075270              SET  SU109-SUCCESSFUL        TO  TRUE               07527000
075271                                                                  07527100
075272         WHEN SQLWARN0 NOT = SPACES                               07527200
075273         WHEN SQLCODE NOT EQUAL ZERO                              07527300
075274              MOVE ZEROES  TO  PV-BULK-CHECKED-IN-CNT             07527400
075275              move '3130'  to  PV-CSSL-PARA                       07527500
075276              perform 8110-WRITE-SUWS109-TO-CSSL                  07527600
075277                                                                  07527700
075278             MOVE '3130-BULK-CHECKED-IN    '                      07527800
075279                                   TO DP013-PARAGRAPH             07527900
075280             MOVE 'SUKCS700 - BULK CHECK IN COUNT '               07528000
075281                                   TO DP013-MESSAGE-TEXT(1)       07528100
075282             MOVE DK-ORD-NBR       TO PV-DISP-PO                  07528200
075283             MOVE DK-REC-SEQ-NBR   TO PV-DISP-RCVR                07528300
075284                                                                  07528400
075285             STRING 'RCVR:'                                       07528500
075286                     PV-DISP-PO      '-'                          07528600
075287                     PV-DISP-RCVR DELIMITED BY SIZE               07528700
075288                                     INTO DP013-MESSAGE-TEXT(2)   07528800
075289                                                                  07528900
075290             MOVE SQLCA            TO DP013-SQLCA                 07529000
075291             MOVE 'TPKSLIP    '    TO DP013-DB2-TABLE-NAME(1)     07529100
075292             MOVE 'TINPKSU    '    TO DP013-DB2-TABLE-NAME(2)     07529200
075293             MOVE 'TSHUNLO    '    TO DP013-DB2-TABLE-NAME(3)     07529300
075294             SET DP013-DB2-ABEND   TO TRUE                        07529400
075295             SET DP013-ROLLBACK    TO TRUE                        07529500
075296             PERFORM 9999-WRITE-CICS-LOG-MSG                      07529600
075297             SET PS-DUMP-TO-LOG    TO TRUE                        07529700
075298             SET SU109-INVALID-SQL TO TRUE                        07529800
075299     END-EVALUATE.                                                07529900
075300                                                                  07530000
075301     IF PS-SHOW-DEBUG-INFO                                        07530100
075302         MOVE PV-BULK-CHECKED-IN-CNT  TO  PV-DISP-COUNT           07530200
075303         STRING ' SUKCS700-3130-BULK-CHECKED-IN '                 07530300
075304                 PV-DISP-COUNT                                    07530400
075305             DELIMITED BY SIZE                                    07530500
075306             INTO PV-CICS-MSG-AREA                                07530600
075307         PERFORM 9990-WRITE-CICS                                  07530700
075308     END-IF.                                                      07530800
075309                                                                  07530900
075310                                                                  07531000
075311*----------------------------------------------------------------*07531100
075312* CHECK IF PO-RCVR REQUIRES EAS TAGGING                          *07531200
075313*                                                                *07531300
075314* NOTe:  bulk and prepack logic is not complete --- need to      *07531400
075315*        need to determine if the checks are at receover level   *07531500
075316*        or at PO-line/prepack                                   *07531600
075317*----------------------------------------------------------------*07531700
075318 3140-BULK-EAS-CHECK.                                             07531800
075319                                                                  07531900
075320     IF  PS-BLD-INTERNAL-TABLE-YES                                07532000
075321         MOVE  '3140'  TO  PT-CURR-PARA                           07532100
075322         PERFORM 8120-INTERNAL-TABLE                              07532200
075323     END-IF.                                                      07532300
075324                                                                  07532400
075325     IF PS-SHOW-DEBUG-INFO                                        07532500
075326         STRING ' SUKCS700-3140-BULK-EAS-CHECK  '                 07532600
075327             DELIMITED BY SIZE                                    07532700
075328             INTO PV-CICS-MSG-AREA                                07532800
075329         PERFORM 9990-WRITE-CICS                                  07532900
075330     END-IF.                                                      07533000
075331                                                                  07533100
075332*** rfid logic from SUKRF502 - begin                              07533210
075333     INITIALIZE SU093-ITEM-COMMAREA.                              07533310
075334     SET SU093-RFID-KOHL-DPT-IN-STR-NO         TO TRUE.           07533410
075335     SET SU093-RFID-KOHL-DEPT-SUBCL-NO         TO TRUE.           07533510
075336     SET SU093-VNDR-DPT-RFID-COMPLI-NO         TO TRUE.           07533610
075337     SET SU093-VNDR-DPT-RFID-TAGS-NO           TO TRUE.           07533710
075338     SET SU093-DC-DEPT-TAGS-NO                 TO TRUE.           07533810
075339     SET SU093-DC-USE-RFID-CART-LBL-NO         TO TRUE.           07533910
075340     SET SU093-RFID-DC-AUTO-CONVEYR-NO         TO TRUE.           07534010
075341     SET SU093-DPT-STR-P2L-FIRST-NO            TO TRUE.           07534110
075342     SET SU093-IR-CHK-IN-NO                    TO TRUE.           07534210
075343     SET SU093-P2L-CHK-IN-NO                   TO TRUE.           07534310
075344                                                                  07534410
075345     SET SU093-CHECK-IN                        TO TRUE.           07534510
075346     SET SU093-CHECK-BY-DEPT-SUBCLS-YES        TO TRUE.           07534610
075347     SET SU093-CHECK-BY-DEPT-IN-STR-NO         TO TRUE.           07534711
075348     SET SU093-RFID-STR-CHK-NEEDED-NO          TO TRUE.           07534811
075349     SET SU093-CHECK-BY-DC                     TO TRUE.           07534910
075350                                                                  07535010
075351     MOVE SU109-OPER-UNT-ID      TO SU093-KEY-OPER-UNT-ID.        07535110
075352     MOVE SU109-ORD-NBR          TO SU093-KEY-PO.                 07535210
075353     MOVE SU109-REC-SEQ-NBR      TO SU093-KEY-REC-SEQ-NBR.        07535310
075354     MOVE SU109-ORD-LNE-NBR      TO SU093-KEY-LNE-NBR.            07535410
075355     MOVE SU109-PREPK-ID         TO SU093-KEY-PREPK-ID.           07535510
075356     MOVE ZEROES                 TO SU093-KEY-DEST-LOC.           07535611
075357     MOVE SU109-BAR-CODE         TO SU093-KEY-CARTON-ID.          07535710
075358                                                                  07535810
075359     CALL SU093-RFID-PGM       USING DFHEIBLK                     07535910
075360                                     SU093-COMMAREA               07536010
075361                                     SU093-ITEM-COMMAREA.         07536110
075362                                                                  07536210
075363*** rfid logic from SUKRF502 - end                                07536310
075364                                                                  07536410
075365     IF PS-SHOW-DEBUG-INFO                                        07536510
075366         MOVE SU093-SQLCODE          TO  PV-DISP-SQL              07536610
075367         STRING ' SUKCS700-3140-BULK-EAS-CHECK '                  07536710
075368                '  RFID:'         SU093-RFID-IND                  07536810
075369                '  lbl:'          SU093-LABEL-PRINT-IND           07536910
075370                '  RC:'           SU093-RETURN-CODE               07537010
075371                '  ERR:'          SU093-ERROR-NBR                 07537110
075372                '  SQL:'          PV-DISP-SQL                     07537210
075373             DELIMITED BY SIZE                                    07537310
075374             INTO PV-CICS-MSG-AREA                                07537410
075375         PERFORM 9990-WRITE-CICS                                  07537510
075376     END-IF.                                                      07537610
075457                                                                  07545700
075458                                                                  07545800
075459*----------------------------------------------------------------*07545900
075460* CHECK IF bulk po-rcvr required a carton audit                  *07546000
075461*                                                                *07546100
075462* NOTe:  bulk and prepack logic is not complete --- need to      *07546200
075463*        need to determine if the checks are at receover level   *07546300
075464*        or at PO-line/prepack                                   *07546400
075465*----------------------------------------------------------------*07546500
075466 3150-CHECK-BULK-AUDIT.                                           07546600
075467                                                                  07546700
075468     IF  PS-BLD-INTERNAL-TABLE-YES                                07546800
075469         MOVE  '3150'  TO  PT-CURR-PARA                           07546900
075470         PERFORM 8120-INTERNAL-TABLE                              07547000
075471     END-IF.                                                      07547100
075472                                                                  07547200
075473     IF PS-SHOW-DEBUG-INFO                                        07547300
075474         STRING ' SUKCS700-3150-CHECK-BULK-AUDIT '                07547400
075475             DELIMITED BY SIZE                                    07547500
075476             INTO PV-CICS-MSG-AREA                                07547600
075477         PERFORM 9990-WRITE-CICS                                  07547700
075478     END-IF.                                                      07547800
075479                                                                  07547900
075480     MOVE ZEROES  TO  SU021-PO-NUMBER                             07548000
075481                      SU021-LINE-NBR                              07548100
075482                      SU021-DRIVER-LINE-NBR                       07548200
075483                      SU021-PRE-PACK-ID                           07548300
075484                      SU021-OPER-UNT-ID                           07548400
075485                      SU021-REC-SEQ-NBR                           07548500
075486                      SU021-INBOUND-TRIP-ID                       07548600
075487                      SU021-SHIPT-UNT-ID                          07548700
075488                      SU021-AUDIT-NUMBER                          07548800
075489                      SU021-RFID-AUDIT-NUMBER.                    07548900
075490                                                                  07549000
075491     MOVE SPACES  TO  SU021-AUDIT-REQUEST-TYPE                    07549100
075492                      SU021-PACKAGE-TYPE-CODE                     07549200
075493                      SU021-USER-ID                               07549300
075494                      SU021-DEFERRED-AUDIT-IND                    07549400
075495                      SU021-AUDIT-REQUIRED-SW                     07549500
075496                      SU021-AUDIT-VALIDATION-SW                   07549600
075497                      SU021-PRINT-APPLY-SW                        07549700
075498                      SU021-RFID-AUDIT-REQUIRED-SW                07549800
075499                      SU021-RFID-AUDIT-VALIDATION-SW.             07549900
075500                                                                  07550000
075501     MOVE SU109-OPER-UNT-ID        TO SU021-OPER-UNT-ID.          07550100
075502     MOVE SU109-ORD-NBR            TO SU021-PO-NUMBER.            07550200
075503     MOVE SU109-REC-SEQ-NBR        TO SU021-REC-SEQ-NBR.          07550300
075504     MOVE SU109-TRIP-ID            TO SU021-INBOUND-TRIP-ID.      07550400
075505     MOVE SU109-BAR-CODE           TO SU021-SHIPT-UNT-ID.         07550500
075506     MOVE 'BC'                     TO SU021-PACKAGE-TYPE-CODE.    07550600
075507                                                                  07550700
075508     IF  SU109-ACM-LBL-STA-NBR > 0                                07550800
075509         SET SU021-PRINT-APPLY     TO TRUE                        07550900
075510     END-IF.                                                      07551000
075511                                                                  07551100
075512     PERFORM 6000-CALL-SUKCS752.                                  07551200
075513                                                                  07551300
075514     IF PS-SHOW-DEBUG-INFO                                        07551400
075515         STRING ' SUKCS700-3150-CHECK-BULK-AUDIT - '              07551500
075516                  SU021-AUDIT-REQUEST-TYPE '-'                    07551600
075517                  SU021-AUDIT-VALIDATION-SW                       07551700
075518             DELIMITED BY SIZE                                    07551800
075519             INTO PV-CICS-MSG-AREA                                07551900
075520         PERFORM 9990-WRITE-CICS                                  07552000
075521     END-IF.                                                      07552100
075522                                                                  07552200
075523                                                                  07552300
075524*----------------------------------------------------------------*07552400
075525* PREPACK CHECKS                                                 *07552500
075526*----------------------------------------------------------------*07552600
075527 4000-PREPACK-CHECKS.                                             07552700
075528                                                                  07552800
075529     IF  PS-BLD-INTERNAL-TABLE-YES                                07552900
075530         MOVE  '4000'  TO  PT-CURR-PARA                           07553000
075531         PERFORM 8120-INTERNAL-TABLE                              07553100
075532     END-IF.                                                      07553200
075533                                                                  07553300
075534     IF PS-SHOW-DEBUG-INFO                                        07553400
075535         STRING ' SUKCS700-4000-PREPACK-CHECKS  '                 07553500
075536             DELIMITED BY SIZE                                    07553600
075537             INTO PV-CICS-MSG-AREA                                07553700
075538         PERFORM 9990-WRITE-CICS                                  07553800
075539     END-IF.                                                      07553900
075540                                                                  07554000
075541* CHECK IF DC IS CHECKING PREPK ORDERS FOR THIN SLICE             07554100
075542     PERFORM 4100-THNSLCPRPK.                                     07554200
075543                                                                  07554300
075544* CHECK IF CARTONS ON RECEIVER IS > MAX ALLOWED FOR THIN SLICE    07554400
075545     IF  PS-DC-THIN-SLICE-PREPK-YES  AND                          07554500
075546         SU109-SUCCESSFUL                                         07554600
075547         PERFORM 4110-PREPK-COUNT-SSCC                            07554700
075548         IF  PS-DC-THIN-SLICE-PREPK-YES                           07554800
075549             IF  PV-CARTONS-ON-RCVR  >  PV-MAX-CRTNS              07554900
075550                 SET  PS-DC-THIN-SLICE-PREPK-NO  TO  TRUE         07555000
075551             END-IF                                               07555100
075552         END-IF                                                   07555200
075553     END-IF.                                                      07555300
075554                                                                  07555400
075555* CHECK IF NUMBER OF PRPK RECEIVERS IS GREATER THEN MAX           07555500
075556     IF  PS-DC-THIN-SLICE-PREPK-YES  AND                          07555600
075557         SU109-SUCCESSFUL                                         07555700
075558         PERFORM 4115-PREPK-ELIGIBLE-COUNT                        07555800
075559         IF  PS-DC-THIN-SLICE-PREPK-YES                           07555900
075560             IF  PV-ELIGIBLE-PREPK-RCVRS  >=  PV-MAX-RCVRS        07556000
075561                 SET  PS-DC-THIN-SLICE-PREPK-NO  TO  TRUE         07556100
075562             END-IF                                               07556200
075563         END-IF                                                   07556300
075564     END-IF.                                                      07556400
075565                                                                  07556500
075566* CHECK IF ANY CARTONS HAVE ALREADY BEEN CHECKED IN FOR RCVR      07556600
075567     IF  PS-DC-THIN-SLICE-PREPK-YES  AND                          07556700
075568         SU109-SUCCESSFUL                                         07556800
075569         PERFORM 4130-PREPK-CHECKED-IN                            07556900
075570         IF  PV-PREPK-CHECKED-IN-CNT   >  0                       07557000
075571             SET  PS-DC-THIN-SLICE-PREPK-NO  TO  TRUE             07557100
075572         END-IF                                                   07557200
075573     END-IF.                                                      07557300
075574                                                                  07557400
075575* CHECK IF PO-RCVR REQUIRES EAS TAGGING                           07557500
075576     IF  PS-DC-THIN-SLICE-PREPK-YES  AND                          07557600
075577         SU109-SUCCESSFUL                                         07557700
075578         PERFORM 4140-PREPK-EAS-CHECK                             07557800
075579         IF  SU093-RFID-YES   OR                                  07557911
075580             SU093-PRINT-EAS  OR                                  07558011
075581             SU093-PRINT-RFID-EAS                                 07558110
075582             SET  PS-DC-THIN-SLICE-PREPK-NO  TO  TRUE             07558200
075583         END-IF                                                   07558300
075584     END-IF.                                                      07558400
075585                                                                  07558500
075586* CHECK IF PO-RCVR REQUIRES AUDIT                                 07558600
075587     IF  PS-DC-THIN-SLICE-PREPK-YES  AND                          07558700
075588         SU109-SUCCESSFUL                                         07558800
075589         PERFORM 4150-CHECK-PREPK-AUDIT                           07558900
075590         IF  SU021-AUDIT-REQUIRED-SW  =  'Y'                      07559000
075591             MOVE PC-NOT-ELIGIBLE-THN-SLC                         07559100
075592                                    TO RCT00017-DC-FUNC-CDE       07559200
075593             SET PS-DC-THIN-SLICE-PREPK-NO     TO  TRUE           07559300
075594             SET SU109-THIN-SLICE-SELECTED-NO  tO  TRUE           07559400
075595         else                                                     07559500
075596             IF  SU109-SUCCESSFUL                                 07559600
075597                 set  PS-DC-THIN-SLICE-PREPK-yes to  true         07559700
075598                 PERFORM 6050-CREATE-TROUBLE                      07559800
075599             ELSE                                                 07559900
075600                 SET  pS-DC-THIN-SLICE-PREPK-NO tO  TRUE          07560000
075601             END-IF                                               07560100
075602         END-IF                                                   07560200
075603     END-IF.                                                      07560300
075604                                                                  07560400
075605*                                                                 07560500
075606     IF  SU109-SUCCESSFUL                                         07560600
075607         MOVE SU109-ORD-NBR         TO RCT00017-PO-NBR            07560700
075608         MOVE SU109-REC-SEQ-NBR     TO RCT00017-RCVR-SEQ-NBR      07560800
075609         MOVE SU109-USER-ID         TO RCT00017-CRE-BY-USR-ID     07560900
075610         MOVE SU109-OPER-UNT-ID     TO RCT00017-LOC-NBR           07561000
075611         MOVE ZEROES                TO RCT00017-PO-LNE-NBR        07561100
075612         MOVE ZEROES                TO RCT00017-PREPK-ID          07561200
075613         MOVE ZEROES                TO RCT00017-QTY-TRKD-NBR      07561300
075614         MOVE ZEROES                TO RCT00017-PKSL-SEQ-NBR      07561400
075615         MOVE ZEROES                TO RCT00017-DEST-LOC-NBR      07561500
075616                                                                  07561600
075617         IF  PS-DC-THIN-SLICE-PREPK-NO                            07561700
075618             MOVE PC-NOT-ELIGIBLE-THN-SLC                         07561800
075619                                    TO RCT00017-DC-FUNC-CDE       07561900
075620             SET SU109-THIN-SLICE-SELECTED-NO  tO  TRUE           07562000
075621         ELSE                                                     07562100
075622             MOVE PC-ELIGIBLE-THN-SLC                             07562200
075623                                    TO RCT00017-DC-FUNC-CDE       07562300
075624             SET  SU109-THIN-SLICE-SELECTED    to  TRUE           07562400
075625         END-IF                                                   07562500
075626                                                                  07562600
075627         PERFORM 7000-INSERT-PO-TRKG                              07562700
075628        END-IF.                                                   07562800
075629                                                                  07562900
075630                                                                  07563000
075631*----------------------------------------------------------------*07563100
075632* PARM THNSLCPRPK - CHECKING THIN SLICE FOR PREPACK              *07563200
075633*----------------------------------------------------------------*07563300
075634 4100-THNSLCPRPK.                                                 07563400
075635                                                                  07563500
075636     IF  PS-BLD-INTERNAL-TABLE-YES                                07563600
075637         MOVE  '4100'  TO  PT-CURR-PARA                           07563700
075638         PERFORM 8120-INTERNAL-TABLE                              07563800
075639     END-IF.                                                      07563900
075640                                                                  07564000
075641     IF PS-SHOW-DEBUG-INFO                                        07564100
075642         STRING ' SUKCS700-4100-THNSLCPRPK '                      07564200
075643             DELIMITED BY SIZE                                    07564300
075644             INTO PV-CICS-MSG-AREA                                07564400
075645         PERFORM 9990-WRITE-CICS                                  07564500
075646     END-IF.                                                      07564600
075647                                                                  07564700
075648                                                                  07564800
075649     EXEC SQL                                                     07564900
075650        SELECT  D.ATTR_ELEM_NBR                                   07565000
075651             ,  E.ATTR_ELEM_TXT                                   07565100
075652             ,  K.ATTR_ELEM_NBR                                   07565200
075653          INTO :PV-MAX-CRTNS                                      07565300
075654             , :PS-DC-THIN-SLICE-PREPK-SW                         07565400
075655             , :PV-MAX-RCVRS                                      07565500
075656          FROM                                                    07565600
075657                WST_INTGRTN_TYP  A                                07565700
075658             ,  WST_ATTR_DEFN    B                                07565800
075659             ,  WST_ATTR_ELEM    C    -- DC                       07565900
075660             ,  WST_ATTR_ELEM    D    -- MAX CARTONS              07566000
075661             ,  WST_ATTR_ELEM    E    -- Y/N                      07566100
075662             ,  WST_ATTR_ELEM    F    -- BEGIN TMST               07566200
075663             ,  WST_ATTR_ELEM    G    -- END TMST                 07566300
075664             ,  WST_ATTR_ELEM    H    -- SETUP TK                 07566400
075665             ,  WST_ATTR_ELEM    I    -- REQUEST TK               07566500
075666             ,  WST_ATTR_ELEM    J    -- FREEFORM INFO            07566600
075667             ,  WST_ATTR_ELEM    K    -- MAX RECEIVERS            07566700
075668          WHERE                                                   07566800
075669                A.INTGRTN_TYP_CDE   = 'THNSLCPRPK'                07566900
075670            AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE           07567000
075671            AND B.ATTR_DEFN_SEQ_NBR = 1                           07567100
075672            AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE           07567200
075673            AND C.ATTR_DEFN_SEQ_NBR = 1                           07567300
075674            AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE           07567400
075675            AND D.ATTR_DEFN_SEQ_NBR = 2                           07567500
075676            AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE           07567600
075677            AND E.ATTR_DEFN_SEQ_NBR = 3                           07567700
075678            AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE           07567800
075679            AND F.ATTR_DEFN_SEQ_NBR = 4                           07567900
075680            AND B.INTGRTN_TYP_CDE   = G.INTGRTN_TYP_CDE           07568000
075681            AND G.ATTR_DEFN_SEQ_NBR = 5                           07568100
075682            AND B.INTGRTN_TYP_CDE   = H.INTGRTN_TYP_CDE           07568200
075683            AND H.ATTR_DEFN_SEQ_NBR = 6                           07568300
075684            AND B.INTGRTN_TYP_CDE   = I.INTGRTN_TYP_CDE           07568400
075685            AND I.ATTR_DEFN_SEQ_NBR = 7                           07568500
075686            AND B.INTGRTN_TYP_CDE   = J.INTGRTN_TYP_CDE           07568600
075687            AND J.ATTR_DEFN_SEQ_NBR = 8                           07568700
075688            AND B.INTGRTN_TYP_CDE   = K.INTGRTN_TYP_CDE           07568800
075689            AND K.ATTR_DEFN_SEQ_NBR = 9                           07568900
075690            AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR         07569000
075691            AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR         07569100
075692            AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR         07569200
075693            AND C.ATTR_ELEM_SEQ_NBR = G.ATTR_ELEM_SEQ_NBR         07569300
075694            AND C.ATTR_ELEM_SEQ_NBR = H.ATTR_ELEM_SEQ_NBR         07569400
075695            AND C.ATTR_ELEM_SEQ_NBR = I.ATTR_ELEM_SEQ_NBR         07569500
075696            AND C.ATTR_ELEM_SEQ_NBR = J.ATTR_ELEM_SEQ_NBR         07569600
075697            AND C.ATTR_ELEM_SEQ_NBR = K.ATTR_ELEM_SEQ_NBR         07569700
075698            AND C.ATTR_ELEM_NBR     = :DK-OPER-UNT-ID             07569800
075699            AND E.ATTR_ELEM_TXT     = 'Y'                         07569900
075700            AND F.ATTR_ELEM_TMST   <= CURRENT TIMESTAMP           07570000
075701            AND G.ATTR_ELEM_TMST   >= CURRENT TIMESTAMP           07570100
075702           with ur                                                07570200
075703     END-EXEC.                                                    07570300
075704                                                                  07570400
075705     EVALUATE TRUE                                                07570500
075706         WHEN SQLCODE = ZERO                                      07570600
075707              SET  PS-DC-THIN-SLICE-PREPK-YES                     07570700
075708                   SU109-SUCCESSFUL        TO  TRUE               07570800
075709                                                                  07570900
075710         WHEN SQLCODE = +100                                      07571000
075711              SET  PS-DC-THIN-SLICE-PREPK-NO                      07571100
075712                   SU109-SUCCESSFUL        TO  TRUE               07571200
075713                                                                  07571300
075714         WHEN SQLWARN0 NOT = SPACES                               07571400
075715         WHEN SQLCODE NOT EQUAL ZERO                              07571500
075716              move '4100'  to  PV-CSSL-PARA                       07571600
075717              perform 8110-WRITE-SUWS109-TO-CSSL                  07571700
075718                                                                  07571800
075719             MOVE '4100-THNSLCPRPK        '                       07571900
075720                                   TO DP013-PARAGRAPH             07572000
075721             MOVE 'SUKCS700 - SELECT PO TRACKING '                07572100
075722                                   TO DP013-MESSAGE-TEXT(1)       07572200
075723             MOVE DK-ORD-NBR       TO PV-DISP-PO                  07572300
075724             MOVE DK-REC-SEQ-NBR   TO PV-DISP-RCVR                07572400
075725                                                                  07572500
075726             STRING 'RCVR:'                                       07572600
075727                     PV-DISP-PO      '-'                          07572700
075728                     PV-DISP-RCVR DELIMITED BY SIZE               07572800
075729                                     INTO DP013-MESSAGE-TEXT(2)   07572900
075730                                                                  07573000
075731             MOVE SQLCA            TO DP013-SQLCA                 07573100
075732             MOVE 'WST-008-010'    TO DP013-DB2-TABLE-NAME(1)     07573200
075733             SET DP013-DB2-ABEND   TO TRUE                        07573300
075734             SET DP013-ROLLBACK    TO TRUE                        07573400
075735             PERFORM 9999-WRITE-CICS-LOG-MSG                      07573500
075736             SET PS-DUMP-TO-LOG    TO TRUE                        07573600
075737             SET SU109-INVALID-SQL TO TRUE                        07573700
075738     END-EVALUATE.                                                07573800
075739                                                                  07573900
075740     IF PS-SHOW-DEBUG-INFO                                        07574000
075741         STRING ' SUKCS700-4100-THNSLPRPK - '                     07574100
075742                PS-DC-THIN-SLICE-PREPK-SW                         07574200
075743             DELIMITED BY SIZE                                    07574300
075744             INTO PV-CICS-MSG-AREA                                07574400
075745         PERFORM 9990-WRITE-CICS                                  07574500
075746     END-IF.                                                      07574600
075747                                                                  07574700
075748                                                                  07574800
075749*----------------------------------------------------------------*07574900
075750* COUNT PREPACK SSCC                                             *07575000
075751*                                                                *07575100
075752* NOTe:  bulk and prepack logic is not complete --- need to      *07575200
075753*        need to determine if the checks are at receover level   *07575300
075754*        or at PO-line/prepack                                   *07575400
075755*----------------------------------------------------------------*07575500
075756 4110-PREPK-COUNT-SSCC.                                           07575600
075757                                                                  07575700
075758     IF  PS-BLD-INTERNAL-TABLE-YES                                07575800
075759         MOVE  '4110'  TO  PT-CURR-PARA                           07575900
075760         PERFORM 8120-INTERNAL-TABLE                              07576000
075761     END-IF.                                                      07576100
075762                                                                  07576200
075763     IF PS-SHOW-DEBUG-INFO                                        07576300
075764         STRING ' SUKCS700-4110-PREPK-COUNT-SSCC '                07576400
075765             DELIMITED BY SIZE                                    07576500
075766             INTO PV-CICS-MSG-AREA                                07576600
075767         PERFORM 9990-WRITE-CICS                                  07576700
075768     END-IF.                                                      07576800
075769                                                                  07576900
075770                                                                  07577000
075771     EXEC SQL                                                     07577100
075772        SELECT  COUNT(DISTINCT(b.SHIPT_UNT_ID))                   07577200
075773          INTO :PV-CARTONS-ON-RCVR                                07577300
075774          FROM                                                    07577400
075775                TPKSLIP A                                         07577500
075776             ,  TINPKSU B                                         07577600
075777           where a.PO_NBR         = :DK-ORD-NBR                   07577700
075778             and a.REC_SEQ_NBR    = :DK-REC-SEQ-NBR               07577800
075779             and a.VER_STAT_CDE   = 'A'                           07577900
075780             and a.PKSL_STAT_CDE  = 'AC'                          07578000
075781             and a.PO_NBR         =  b.PO_NBR                     07578100
075782             and a.SEQ_NBR        =  b.SEQ_NBR                    07578200
075783           WITH UR                                                07578300
075784     END-EXEC.                                                    07578400
075785                                                                  07578500
075786     EVALUATE TRUE                                                07578600
075787         WHEN SQLCODE = ZERO                                      07578700
075788              SET  PS-DC-THIN-SLICE-PREPK-YES                     07578800
075789                   SU109-SUCCESSFUL        TO  TRUE               07578900
075790                                                                  07579000
075791         WHEN SQLCODE = +100                                      07579100
075792              SET  PS-DC-THIN-SLICE-PREPK-NO                      07579200
075793                   SU109-SUCCESSFUL        TO  TRUE               07579300
075794                                                                  07579400
075795         WHEN SQLWARN0 NOT = SPACES                               07579500
075796         WHEN SQLCODE NOT EQUAL ZERO                              07579600
075797              move '4110'  to  PV-CSSL-PARA                       07579700
075798              perform 8110-WRITE-SUWS109-TO-CSSL                  07579800
075799                                                                  07579900
075800             MOVE '4110-PREPK-COUNT-SSCC   '                      07580000
075801                                   TO DP013-PARAGRAPH             07580100
075802             MOVE 'SUKCS700 - COUNT RCVR SSCC    '                07580200
075803                                   TO DP013-MESSAGE-TEXT(1)       07580300
075804             MOVE DK-ORD-NBR       TO PV-DISP-PO                  07580400
075805             MOVE DK-REC-SEQ-NBR   TO PV-DISP-RCVR                07580500
075806                                                                  07580600
075807             STRING 'RCVR:'                                       07580700
075808                     PV-DISP-PO      '-'                          07580800
075809                     PV-DISP-RCVR DELIMITED BY SIZE               07580900
075810                                     INTO DP013-MESSAGE-TEXT(2)   07581000
075811                                                                  07581100
075812             MOVE SQLCA            TO DP013-SQLCA                 07581200
075813             MOVE 'TPKSLIP    '    TO DP013-DB2-TABLE-NAME(1)     07581300
075814             MOVE 'TINPKSU    '    TO DP013-DB2-TABLE-NAME(2)     07581400
075815             SET DP013-DB2-ABEND   TO TRUE                        07581500
075816             SET DP013-ROLLBACK    TO TRUE                        07581600
075817             PERFORM 9999-WRITE-CICS-LOG-MSG                      07581700
075818             SET PS-DUMP-TO-LOG    TO TRUE                        07581800
075819             SET SU109-INVALID-SQL TO TRUE                        07581900
075820     END-EVALUATE.                                                07582000
075821                                                                  07582100
075822     IF PS-SHOW-DEBUG-INFO                                        07582200
075823         MOVE PV-CARTONS-ON-RCVR   TO  PV-DISP-COUNT              07582300
075824         STRING ' SUKCS700-4110-PREPK-COUNT-SSCC - '              07582400
075825                 PV-DISP-COUNT                                    07582500
075826             DELIMITED BY SIZE                                    07582600
075827             INTO PV-CICS-MSG-AREA                                07582700
075828         PERFORM 9990-WRITE-CICS                                  07582800
075829     END-IF.                                                      07582900
075830                                                                  07583000
075831                                                                  07583100
075832*----------------------------------------------------------------*07583200
075833* COUNT NUMBER OF ELIGIBLE PREPK RCVRS ON TRAILER                *07583300
075834*----------------------------------------------------------------*07583400
075835 4115-PREPK-ELIGIBLE-COUNT.                                       07583500
075836                                                                  07583600
075837     IF  PS-BLD-INTERNAL-TABLE-YES                                07583700
075838         MOVE  '4115'  TO  PT-CURR-PARA                           07583800
075839         PERFORM 8120-INTERNAL-TABLE                              07583900
075840     END-IF.                                                      07584000
075841                                                                  07584100
075842     IF PS-SHOW-DEBUG-INFO                                        07584200
075843         STRING ' SUKCS700-4115-PREPK-ELIGIBLE-COUNT '            07584300
075844             DELIMITED BY SIZE                                    07584400
075845             INTO PV-CICS-MSG-AREA                                07584500
075846         PERFORM 9990-WRITE-CICS                                  07584600
075847     END-IF.                                                      07584700
075848                                                                  07584800
075849     MOVE  ZEROES  TO  PV-ELIGIBLE-PREPK-RCVRS.                   07584900
075850                                                                  07585000
075851     EXEC SQL                                                     07585100
075852        SELECT  COUNT(*)                                          07585200
075853          INTO :PV-ELIGIBLE-PREPK-RCVRS                           07585300
075854          FROM                                                    07585400
075855                RCT_PO_RCVR_TRKG A                                07585500
075856             ,  TSHPTPO B                                         07585600
075857             ,  TSHIPMT C                                         07585700
075858             ,  TRECEIV D                                         07585800
075859           WHERE A.DC_FUNC_CDE    = '0M'                          07585900
075860             AND A.PO_NBR         =  B.PO_NBR                     07586000
075861             AND A.RCVR_SEQ_NBR   =  B.REC_SEQ_NBR                07586100
075862             AND B.SHIPT_ID       =  C.SHIPT_ID                   07586200
075863             AND C.TRIP_ID        = :DK-TRIP-ID                   07586300
075864             AND A.PO_NBR         =  D.ORD_NBR                    07586400
075865             AND A.RCVR_SEQ_NBR   =  D.REC_SEQ_NBR                07586500
075866             AND D.VER_STATUS_CDE = 'A'                           07586600
075867             AND D.PKGNG_CDE      = 'M'                           07586700
075868            WITH UR                                               07586800
075869     END-EXEC.                                                    07586900
075870                                                                  07587000
075871     EVALUATE TRUE                                                07587100
075872         WHEN SQLCODE = ZERO                                      07587200
075873              CONTINUE                                            07587300
075874                                                                  07587400
075875         WHEN SQLCODE = +100                                      07587500
075876              MOVE ZEROES  TO  PV-ELIGIBLE-PREPK-RCVRS            07587600
075877                                                                  07587700
075878         WHEN SQLWARN0 NOT = SPACES                               07587800
075879         WHEN SQLCODE NOT EQUAL ZERO                              07587900
075880              move '4115'  to  PV-CSSL-PARA                       07588000
075881              perform 8110-WRITE-SUWS109-TO-CSSL                  07588100
075882                                                                  07588200
075883             MOVE '4115-PREPK-ELIGIBLE-COUNT '                    07588300
075884                                   TO DP013-PARAGRAPH             07588400
075885             MOVE 'SUKCS700 - COUNT PREPK ELIGIBLE RCVRS '        07588500
075886                                   TO DP013-MESSAGE-TEXT(1)       07588600
075887             MOVE DK-ORD-NBR       TO PV-DISP-PO                  07588700
075888             MOVE DK-REC-SEQ-NBR   TO PV-DISP-RCVR                07588800
075889                                                                  07588900
075890             STRING 'RCVR:'                                       07589000
075891                     PV-DISP-PO      '-'                          07589100
075892                     PV-DISP-RCVR DELIMITED BY SIZE               07589200
075893                                     INTO DP013-MESSAGE-TEXT(2)   07589300
075894                                                                  07589400
075895             MOVE SQLCA            TO DP013-SQLCA                 07589500
075896             MOVE 'RCT_PO_RCVR'    TO DP013-DB2-TABLE-NAME(1)     07589600
075897             MOVE 'TSHPTPO    '    TO DP013-DB2-TABLE-NAME(2)     07589700
075898             MOVE 'TSHIPMT    '    TO DP013-DB2-TABLE-NAME(3)     07589800
075899             MOVE 'TRECEIV    '    TO DP013-DB2-TABLE-NAME(4)     07589900
075900             SET DP013-DB2-ABEND   TO TRUE                        07590000
075901             SET DP013-ROLLBACK    TO TRUE                        07590100
075902             PERFORM 9999-WRITE-CICS-LOG-MSG                      07590200
075903             SET PS-DUMP-TO-LOG    TO TRUE                        07590300
075904             SET SU109-INVALID-SQL TO TRUE                        07590400
075905     END-EVALUATE.                                                07590500
075906                                                                  07590600
075907     IF PS-SHOW-DEBUG-INFO                                        07590700
075908         MOVE PV-ELIGIBLE-PREPK-RCVRS TO  PV-DISP-COUNT           07590800
075909         STRING ' SUKCS700-4115-PREPK-ELIGIBLE-COUNT '            07590900
075910                 PV-DISP-COUNT                                    07591000
075911             DELIMITED BY SIZE                                    07591100
075912             INTO PV-CICS-MSG-AREA                                07591200
075913         PERFORM 9990-WRITE-CICS                                  07591300
075914     END-IF.                                                      07591400
075915                                                                  07591500
075916                                                                  07591600
075917*----------------------------------------------------------------*07591700
075918* CHECK IF ANY CARTONS HAVE ALREADY BEEN CHECKED IN FOR THE RCVR *07591800
075919*                                                                *07591900
075920* NOTe:  bulk and prepack logic is not complete --- need to      *07592000
075921*        need to determine if the checks are at receover level   *07592100
075922*        or at PO-line/prepack                                   *07592200
075923*----------------------------------------------------------------*07592300
075924 4130-PREPK-CHECKED-IN.                                           07592400
075925                                                                  07592500
075926     IF  PS-BLD-INTERNAL-TABLE-YES                                07592600
075927         MOVE  '4130'  TO  PT-CURR-PARA                           07592700
075928         PERFORM 8120-INTERNAL-TABLE                              07592800
075929     END-IF.                                                      07592900
075930                                                                  07593000
075931     IF PS-SHOW-DEBUG-INFO                                        07593100
075932         STRING ' SUKCS700-4130-PREPK-ChECKED-IN  '               07593200
075933             DELIMITED BY SIZE                                    07593300
075934             INTO PV-CICS-MSG-AREA                                07593400
075935         PERFORM 9990-WRITE-CICS                                  07593500
075936     END-IF.                                                      07593600
075937                                                                  07593700
075938     MOVE  ZEROES  TO  PV-PREPK-CHECKED-IN-CNT                    07593800
075939                                                                  07593900
075940     EXEC SQL                                                     07594000
075941        SELECT  COUNT(*)                                          07594100
075942          INTO :PV-PREPK-CHECKED-IN-CNT                           07594200
075943          FROM                                                    07594300
075944                TPKSLIP A                                         07594400
075945             ,  TINPKSU B                                         07594500
075946             ,  TSHUNLO C                                         07594600
075947           WHERE A.PO_NBR         = :DK-ORD-NBR                   07594700
075948             AND A.REC_SEQ_NBR    = :DK-REC-SEQ-NBR               07594800
075949             AND A.VER_STAT_CDE   = 'A'                           07594900
075950             AND A.PKSL_STAT_CDE  = 'AC'                          07595000
075951             AND A.PO_NBR         =  B.PO_NBR                     07595100
075952             AND A.SEQ_NBR        =  B.SEQ_NBR                    07595200
075953             AND B.SHIPT_UNT_ID   =  C.SHIPT_UNT_ID               07595300
075954             AND C.SCN_LOC_ID    IN ('RECV','WRCV')               07595400
075955             AND C.ACTV_CDE       =  'A'                          07595500
075956             AND C.TRIP_ID        = :DK-TRIP-ID                   07595600
075957           FETCH FIRST 1 ROW ONLY                                 07595700
075958           WITH UR                                                07595800
075959     END-EXEC.                                                    07595900
075960                                                                  07596000
075961     EVALUATE TRUE                                                07596100
075962         WHEN SQLCODE = ZERO                                      07596200
075963              SET  SU109-SUCCESSFUL        TO  TRUE               07596300
075964                                                                  07596400
075965         WHEN SQLCODE = +100                                      07596500
075966              MOVE ZEROES  TO  PV-PREPK-CHECKED-IN-CNT            07596600
075967              SET  SU109-SUCCESSFUL        TO  TRUE               07596700
075968                                                                  07596800
075969         WHEN SQLWARN0 NOT = SPACES                               07596900
075970         WHEN SQLCODE NOT EQUAL ZERO                              07597000
075971              MOVE ZEROES  TO  PV-PREPK-CHECKED-IN-CNT            07597100
075972              move '4130'  to  PV-CSSL-PARA                       07597200
075973              perform 8110-WRITE-SUWS109-TO-CSSL                  07597300
075974                                                                  07597400
075975             MOVE '4130-PREPK-CHECKED-IN    '                     07597500
075976                                   TO DP013-PARAGRAPH             07597600
075977             MOVE 'SUKCS700 - PREPK CHECK IN COUNT '              07597700
075978                                   TO DP013-MESSAGE-TEXT(1)       07597800
075979             MOVE DK-ORD-NBR       TO PV-DISP-PO                  07597900
075980             MOVE DK-REC-SEQ-NBR   TO PV-DISP-RCVR                07598000
075981                                                                  07598100
075982             STRING 'RCVR:'                                       07598200
075983                     PV-DISP-PO      '-'                          07598300
075984                     PV-DISP-RCVR DELIMITED BY SIZE               07598400
075985                                     INTO DP013-MESSAGE-TEXT(2)   07598500
075986                                                                  07598600
075987             MOVE SQLCA            TO DP013-SQLCA                 07598700
075988             MOVE 'TPKSLIP    '    TO DP013-DB2-TABLE-NAME(1)     07598800
075989             MOVE 'TINPKSU    '    TO DP013-DB2-TABLE-NAME(2)     07598900
075990             MOVE 'TSHUNLO    '    TO DP013-DB2-TABLE-NAME(3)     07599000
075991             SET DP013-DB2-ABEND   TO TRUE                        07599100
075992             SET DP013-ROLLBACK    TO TRUE                        07599200
075993             PERFORM 9999-WRITE-CICS-LOG-MSG                      07599300
075994             SET PS-DUMP-TO-LOG    TO TRUE                        07599400
075995             SET SU109-INVALID-SQL TO TRUE                        07599500
075996     END-EVALUATE.                                                07599600
075997                                                                  07599700
075998     IF PS-SHOW-DEBUG-INFO                                        07599800
075999         MOVE PV-PREPK-CHECKED-IN-CNT  TO  PV-DISP-COUNT          07599900
076000         STRING ' SUKCS700-4130-PREPK-CHECKED-IN - '              07600000
076001                 PV-DISP-COUNT                                    07600100
076002             DELIMITED BY SIZE                                    07600200
076003             INTO PV-CICS-MSG-AREA                                07600300
076004         PERFORM 9990-WRITE-CICS                                  07600400
076005     END-IF.                                                      07600500
076006                                                                  07600600
076007                                                                  07600700
076008*----------------------------------------------------------------*07600800
076009* CHECK IF PO-RCVR REQUIRES EAS TAGGING                          *07600900
076010*                                                                *07601000
076011* NOTe:  bulk and prepack logic is not complete --- need to      *07601100
076012*        need to determine if the checks are at receover level   *07601200
076013*        or at PO-line/prepack                                   *07601300
076014*----------------------------------------------------------------*07601400
076015 4140-PREPK-EAS-CHECK.                                            07601500
076016                                                                  07601600
076017     IF  PS-BLD-INTERNAL-TABLE-YES                                07601700
076018         MOVE  '4140'  TO  PT-CURR-PARA                           07601800
076019         PERFORM 8120-INTERNAL-TABLE                              07601900
076020     END-IF.                                                      07602000
076021                                                                  07602100
076022     IF PS-SHOW-DEBUG-INFO                                        07602200
076023         STRING ' SUKCS700-4140-PREPK-EAS-CHECK             '     07602300
076024             DELIMITED BY SIZE                                    07602400
076025             INTO PV-CICS-MSG-AREA                                07602500
076026         PERFORM 9990-WRITE-CICS                                  07602600
076027     END-IF.                                                      07602700
076028                                                                  07602800
076029                                                                  07602910
076030*** rfid logic from SUKRF502 - begin                              07603010
076031     INITIALIZE SU093-ITEM-COMMAREA.                              07603110
076032     SET SU093-RFID-KOHL-DPT-IN-STR-NO         TO TRUE.           07603210
076033     SET SU093-RFID-KOHL-DEPT-SUBCL-NO         TO TRUE.           07603310
076034     SET SU093-VNDR-DPT-RFID-COMPLI-NO         TO TRUE.           07603410
076035     SET SU093-VNDR-DPT-RFID-TAGS-NO           TO TRUE.           07603510
076036     SET SU093-DC-DEPT-TAGS-NO                 TO TRUE.           07603610
076037     SET SU093-DC-USE-RFID-CART-LBL-NO         TO TRUE.           07603710
076038     SET SU093-RFID-DC-AUTO-CONVEYR-NO         TO TRUE.           07603810
076039     SET SU093-DPT-STR-P2L-FIRST-NO            TO TRUE.           07603910
076040     SET SU093-IR-CHK-IN-NO                    TO TRUE.           07604010
076041     SET SU093-P2L-CHK-IN-NO                   TO TRUE.           07604110
076042                                                                  07604210
076043     SET SU093-CHECK-IN                        TO TRUE.           07604310
076044     SET SU093-CHECK-BY-DEPT-SUBCLS-YES        TO TRUE.           07604410
076045     SET SU093-CHECK-BY-DEPT-IN-STR-NO         TO TRUE.           07604511
076046     SET SU093-RFID-STR-CHK-NEEDED-NO          TO TRUE.           07604611
076047     SET SU093-CHECK-BY-DC                     TO TRUE.           07604710
076048                                                                  07604810
076049     MOVE SU109-OPER-UNT-ID      TO SU093-KEY-OPER-UNT-ID.        07604910
076050     MOVE SU109-ORD-NBR          TO SU093-KEY-PO.                 07605010
076051     MOVE SU109-REC-SEQ-NBR      TO SU093-KEY-REC-SEQ-NBR.        07605110
076052     MOVE SU109-ORD-LNE-NBR      TO SU093-KEY-LNE-NBR.            07605210
076053     MOVE SU109-PREPK-ID         TO SU093-KEY-PREPK-ID.           07605310
076054     MOVE ZEROES                 TO SU093-KEY-DEST-LOC.           07605411
076055     MOVE SU109-BAR-CODE         TO SU093-KEY-CARTON-ID.          07605510
076056                                                                  07605610
076057     CALL SU093-RFID-PGM       USING DFHEIBLK                     07605710
076058                                     SU093-COMMAREA               07605810
076059                                     SU093-ITEM-COMMAREA.         07605910
076060                                                                  07606010
076061*** rfid logic from SUKRF502 - end                                07606110
076062                                                                  07606210
076063     IF PS-SHOW-DEBUG-INFO                                        07606310
076064         MOVE SU093-SQLCODE          TO  PV-DISP-SQL              07606410
076065         STRING ' SUKCS700-4140-PREPK-EAS-CHECK '                 07606510
076066                '  RFID:'         SU093-RFID-IND                  07606610
076067                '  lbl:'          SU093-LABEL-PRINT-IND           07606710
076068                '  RC:'           SU093-RETURN-CODE               07606810
076069                '  ERR:'          SU093-ERROR-NBR                 07606910
076070                '  SQL:'          PV-DISP-SQL                     07607010
076071             DELIMITED BY SIZE                                    07607110
076072             INTO PV-CICS-MSG-AREA                                07607210
076073         PERFORM 9990-WRITE-CICS                                  07607310
076080     END-IF.                                                      07608010
076154                                                                  07615400
076155                                                                  07615500
076156*----------------------------------------------------------------*07615600
076157* CHECK IF PREPK po-rcvr required a carton audit                 *07615700
076158*                                                                *07615800
076159* NOTe:  bulk and prepack logic is not complete --- need to      *07615900
076160*        need to determine if the checks are at receover level   *07616000
076161*        or at PO-line/prepack                                   *07616100
076162*----------------------------------------------------------------*07616200
076163 4150-CHECK-PREPK-AUDIT.                                          07616300
076164                                                                  07616400
076165     IF  PS-BLD-INTERNAL-TABLE-YES                                07616500
076166         MOVE  '4150'  TO  PT-CURR-PARA                           07616600
076167         PERFORM 8120-INTERNAL-TABLE                              07616700
076168     END-IF.                                                      07616800
076169                                                                  07616900
076170     IF PS-SHOW-DEBUG-INFO                                        07617000
076171         STRING ' SUKCS700-4150-CHECK-PREPK-AUDIT  '              07617100
076172             DELIMITED BY SIZE                                    07617200
076173             INTO PV-CICS-MSG-AREA                                07617300
076174         PERFORM 9990-WRITE-CICS                                  07617400
076175     END-IF.                                                      07617500
076176                                                                  07617600
076177     MOVE ZEROES  TO  SU021-PO-NUMBER                             07617700
076178                      SU021-LINE-NBR                              07617800
076179                      SU021-DRIVER-LINE-NBR                       07617900
076180                      SU021-PRE-PACK-ID                           07618000
076181                      SU021-OPER-UNT-ID                           07618100
076182                      SU021-REC-SEQ-NBR                           07618200
076183                      SU021-INBOUND-TRIP-ID                       07618300
076184                      SU021-SHIPT-UNT-ID                          07618400
076185                      SU021-AUDIT-NUMBER                          07618500
076186                      SU021-RFID-AUDIT-NUMBER.                    07618600
076187                                                                  07618700
076188     MOVE SPACES  TO  SU021-AUDIT-REQUEST-TYPE                    07618800
076189                      SU021-PACKAGE-TYPE-CODE                     07618900
076190                      SU021-USER-ID                               07619000
076191                      SU021-DEFERRED-AUDIT-IND                    07619100
076192                      SU021-AUDIT-REQUIRED-SW                     07619200
076193                      SU021-AUDIT-VALIDATION-SW                   07619300
076194                      SU021-PRINT-APPLY-SW                        07619400
076195                      SU021-RFID-AUDIT-REQUIRED-SW                07619500
076196                      SU021-RFID-AUDIT-VALIDATION-SW.             07619600
076197                                                                  07619700
076198     MOVE SU109-OPER-UNT-ID        TO SU021-OPER-UNT-ID.          07619800
076199     MOVE SU109-ORD-NBR            TO SU021-PO-NUMBER.            07619900
076200     MOVE SU109-REC-SEQ-NBR        TO SU021-REC-SEQ-NBR.          07620000
076201     MOVE SU109-TRIP-ID            TO SU021-INBOUND-TRIP-ID.      07620100
076202     MOVE SU109-BAR-CODE           TO SU021-SHIPT-UNT-ID.         07620200
076203     MOVE 'PP'                     TO SU021-PACKAGE-TYPE-CODE.    07620300
076204                                                                  07620400
076205     IF  SU109-ACM-LBL-STA-NBR > 0                                07620500
076206         SET SU021-PRINT-APPLY     TO TRUE                        07620600
076207     END-IF.                                                      07620700
076208                                                                  07620800
076209     PERFORM 6000-CALL-SUKCS752.                                  07620900
076210                                                                  07621000
076211     IF PS-SHOW-DEBUG-INFO                                        07621100
076212         STRING ' SUKCS700-4150-CHECK-PREPK-AUDIT - '             07621200
076213                  SU021-AUDIT-REQUEST-TYPE '-'                    07621300
076214                  SU021-AUDIT-VALIDATION-SW                       07621400
076215             DELIMITED BY SIZE                                    07621500
076216             INTO PV-CICS-MSG-AREA                                07621600
076217         PERFORM 9990-WRITE-CICS                                  07621700
076218     END-IF.                                                      07621800
076219                                                                  07621900
076220                                                                  07622000
076221*----------------------------------------------------------------*07622100
076222* CALL AUDIT MODULE TO SEE IF AN AUDIT WOULD BE REQUIRED         *07622200
076223*----------------------------------------------------------------*07622300
076224 6000-CALL-SUKCS752.                                              07622400
076225                                                                  07622500
076226     IF  PS-BLD-INTERNAL-TABLE-YES                                07622600
076227         MOVE  '6000'  TO  PT-CURR-PARA                           07622700
076228         PERFORM 8120-INTERNAL-TABLE                              07622800
076229     END-IF.                                                      07622900
076230                                                                  07623000
076231     IF PS-SHOW-DEBUG-INFO                                        07623100
076232         STRING ' SUKCS700-6000-CALL-SUKCS752             '       07623200
076233             DELIMITED BY SIZE                                    07623300
076234             INTO PV-CICS-MSG-AREA                                07623400
076235         PERFORM 9990-WRITE-CICS                                  07623500
076236                                                                  07623600
076237         MOVE  SU021-OPER-UNT-ID       TO PV-DISP-OPER            07623700
076238         MOVE  SU021-PO-NUMBER         TO PV-DISP-PO              07623800
076239         MOVE  SU021-REC-SEQ-NBR       TO PV-DISP-RCVR            07623900
076240         MOVE  SU021-INBOUND-TRIP-ID   TO PV-DISP-TRIP            07624000
076241         MOVE  SU021-SHIPT-UNT-ID      TO PV-DISP-SSCC            07624100
076242         MOVE  SU109-ACM-LBL-STA-NBR   TO PV-DISP-PNA-STA         07624200
076243                                                                  07624300
076244         MOVE  SPACES                  TO PV-CICS-MSG-AREA        07624400
076245         STRING ' SUKCS700-SSCC:' PV-DISP-SSCC                    07624500
076246                '  ' PV-DISP-OPER                                 07624600
076247                '-'  PV-DISP-PO                                   07624700
076248                '-'  PV-DISP-RCVR                                 07624800
076249             DELIMITED BY SIZE                                    07624900
076250             INTO PV-CICS-MSG-AREA                                07625000
076251         PERFORM 9990-WRITE-CICS                                  07625100
076252                                                                  07625200
076253         MOVE  SPACES                  TO PV-CICS-MSG-AREA        07625300
076254         STRING ' SUKCS700-TRIP:' PV-DISP-TRIP                    07625400
076255                '  PNA STA:'      PV-DISP-PNA-STA                 07625500
076256                '  '              SU021-PACKAGE-TYPE-CODE         07625600
076257                '  PNA SW:'       SU021-PRINT-APPLY-SW            07625700
076258             DELIMITED BY SIZE                                    07625800
076259             INTO PV-CICS-MSG-AREA                                07625900
076260         PERFORM 9990-WRITE-CICS                                  07626000
076261                                                                  07626100
076262         MOVE  SPACES                  TO PV-CICS-MSG-AREA        07626200
076263         PERFORM 9990-WRITE-CICS                                  07626300
076264                                                                  07626400
076265     END-IF.                                                      07626500
076266                                                                  07626600
076267     SET  SU021-CARTON-CHECK-IN                                   07626700
076268          SU021-AUDIT-IS-COMPLETE                                 07626800
076269          SU021-RFID-AUDIT-IS-COMPLETE  TO TRUE.                  07626900
076270                                                                  07627000
076271     MOVE 'Y'          TO SU021-DEFERRED-AUDIT-IND.               07627100
076272                                                                  07627200
076273     MOVE LENGTH OF SU021-CARTON-AUDIT-RECORD                     07627300
076274                                         TO PV-COMMAREA-LENGTH.   07627400
076275                                                                  07627500
076276     EXEC CICS                                                    07627600
076277         LINK PROGRAM  (PC-SUKCS752)                              07627700
076278              COMMAREA (SU021-CARTON-AUDIT-RECORD)                07627800
076279              LENGTH   (PV-COMMAREA-LENGTH)                       07627900
076280              RESP     (PV-CICS-RESP)                             07628000
076281     END-EXEC.                                                    07628100
076282                                                                  07628200
076283     EVALUATE TRUE                                                07628300
076284         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     07628400
076285              IF  SU021-INVALID-REQUEST OR                        07628500
076286                  SU021-DB2-ERROR                                 07628600
076287                                                                  07628700
076288                  INITIALIZE PV-CICS-MSG-AREA                     07628800
076289                                                                  07628900
076290                  MOVE SU109-OPER-UNT-ID     TO PV-DISP-OPER      07629000
076291                  MOVE SU109-TRIP-ID         TO PV-DISP-TRIP      07629100
076292                  MOVE SU109-ACM-LBL-STA-NBR tO PV-DISP-PNA-STA   07629200
076293                                                                  07629300
076294                  MOVE SU109-OPER-UNT-ID     TO PV-DISP-OPER      07629400
076295                  MOVE SU109-ORD-NBR         TO PV-DISP-PO        07629500
076296                  MOVE SU109-REC-SEQ-NBR     TO PV-DISP-RCVR      07629600
076297                  MOVE SU109-ORD-LNE-NBR     TO PV-DISP-LINE      07629700
076298                  MOVE SU109-PREPK-ID        TO PV-DISP-PREPK     07629800
076299                                                                  07629900
076300                  MOVE SU109-TRIP-ID         TO PV-DISP-TRIP      07630000
076301                  MOVE SU109-BAR-CODE        TO PV-DISP-SSCC      07630100
076302                                                                  07630200
076303                  STRING  'SUKCS700 6000-'                        07630300
076304                          ' DC:'               PV-DISP-OPER       07630400
076305                          ' SSCC:'             SU109-BAR-CODE     07630500
076306                                               DELIMITED BY SIZE  07630600
076307                                          INTO PV-CICS-MSG-AREA   07630700
076308                                                                  07630800
076309                  MOVE SPACES               TO PV-CICS-MSG-AREA   07630900
076310                                                                  07631000
076311                  PERFORM 9997-WRITE-TO-CSSL                      07631100
076312                                                                  07631200
076313                  STRING  'SUKCS700 '                             07631300
076314                          ' TRIP:'             PV-DISP-TRIP       07631400
076315                          ' DR:'               SU109-DOOR-NUMBER  07631500
076316                          ' USR:'              SU109-USER-ID      07631600
076317                          ' STA:'              PV-DISP-PNA-STA    07631700
076318                          ' SQL:'              PV-DISP-SQL        07631800
076319                          ' CARTON AUDIT CHECK MODULE SUKCS752'   07631900
076320                          ' INVALID REQ/DB2 ERROR'                07632000
076321                                               DELIMITED BY SIZE  07632100
076322                                          INTO PV-CICS-MSG-AREA   07632200
076323                                                                  07632300
076324                  PERFORM 9997-WRITE-TO-CSSL                      07632400
076325                                                                  07632500
076326                  INITIALIZE PV-CICS-MSG-AREA                     07632600
076327                                                                  07632700
076328                                                                  07632800
076329                  STRING  'SUKCS700 (SUKCS552)'                   07632900
076330                          ' TYPE:'       SU021-AUDIT-REQUEST-TYPE 07633000
076331                          ' PO:'         PV-DISP-OPER             07633100
076332                          '-'            PV-DISP-PO               07633200
076333                          '-'            PV-DISP-RCVR             07633300
076334                          ' LINE:'       PV-DISP-LINE             07633400
076335                          ' PRPK:'       PV-DISP-PREPK            07633500
076336                          ' PKG:'        SU021-PACKAGE-TYPE-CODE  07633600
076337                                         DELIMITED BY SIZE        07633700
076338                                    INTO PV-CICS-MSG-AREA         07633800
076339                  PERFORM 9997-WRITE-TO-CSSL                      07633900
076340                                                                  07634000
076341                  INITIALIZE PV-CICS-MSG-AREA                     07634100
076342                                                                  07634200
076343                                                                  07634300
076344                  STRING  'SUKCS700 '                             07634400
076345                          ' TRIP:'       PV-DISP-TRIP             07634500
076346                          ' SSCC:'       PV-DISP-SSCC             07634600
076347                          ' USR:'        SU021-USER-ID            07634700
076348                          ' DEF:'        SU021-DEFERRED-AUDIT-IND 07634800
076349                          ' REQ:'        SU021-AUDIT-REQUIRED-SW  07634900
076350                                         DELIMITED BY SIZE        07635000
076351                                    INTO PV-CICS-MSG-AREA         07635100
076352                                                                  07635200
076353                                                                  07635300
076354                  PERFORM 9997-WRITE-TO-CSSL                      07635400
076355                                                                  07635500
076356                  INITIALIZE PV-CICS-MSG-AREA                     07635600
076357                                                                  07635700
076358                  STRING  'SUKCS700 '                             07635800
076359                          ' AUD SW:'   SU021-AUDIT-VALIDATION-SW  07635900
076360                          ' PNA SW:'   SU021-PRINT-APPLY-SW       07636000
076361                         ' RFID AUD:' SU021-RFID-AUDIT-REQUIRED-SW07636100
076362                          ' RFID AUD SW:'                         07636200
076363                                   SU021-RFID-AUDIT-VALIDATION-SW 07636300
076364                                           DELIMITED BY SIZE      07636400
076365                                      INTO PV-CICS-MSG-AREA       07636500
076366                                                                  07636600
076367                  PERFORM 9997-WRITE-TO-CSSL                      07636700
076368                                                                  07636800
076369                  SET SU109-INVALID-SQL                           07636900
076370                      SU109-CRA-SQLERROR  TO  TRUE                07637000
076371                                                                  07637100
076372              END-IF                                              07637200
076373                                                                  07637300
076374              IF PS-SHOW-DEBUG-INFO                               07637400
076375                 MOVE SPACES TO PV-CICS-MSG-AREA                  07637500
076376                 STRING ' SUKCS700-6000-CALL-SUKCS752 - AFTER '   07637600
076377                         SU021-AUDIT-REQUIRED-SW                  07637700
076378                         DELIMITED BY SIZE                        07637800
076379                    INTO PV-CICS-MSG-AREA                         07637900
076380                 PERFORM 9990-WRITE-CICS                          07638000
076381                                                                  07638100
076382                 MOVE SPACES TO PV-CICS-MSG-AREA                  07638200
076383                 PERFORM 9990-WRITE-CICS                          07638300
076384              END-IF                                              07638400
076385                                                                  07638500
076386         WHEN OTHER                                               07638600
076387                                                                  07638700
076388              INITIALIZE PV-CICS-MSG-AREA                         07638800
076389                                                                  07638900
076390              MOVE SU109-OPER-UNT-ID     TO PV-DISP-OPER          07639000
076391              MOVE SU109-TRIP-ID         TO PV-DISP-TRIP          07639100
076392              MOVE SU109-ACM-LBL-STA-NBR tO PV-DISP-PNA-STA       07639200
076393                                                                  07639300
076394              MOVE SU109-OPER-UNT-ID     TO PV-DISP-OPER          07639400
076395              MOVE SU109-ORD-NBR         TO PV-DISP-PO            07639500
076396              MOVE SU109-REC-SEQ-NBR     TO PV-DISP-RCVR          07639600
076397              MOVE SU109-ORD-LNE-NBR     TO PV-DISP-LINE          07639700
076398              MOVE SU109-PREPK-ID        TO PV-DISP-PREPK         07639800
076399                                                                  07639900
076400              MOVE SU109-TRIP-ID         TO PV-DISP-TRIP          07640000
076401              MOVE SU109-BAR-CODE        TO PV-DISP-SSCC          07640100
076402                                                                  07640200
076403              STRING  'SUKCS700 6000-'                            07640300
076404                      ' DC:'               PV-DISP-OPER           07640400
076405                      ' SSCC:'             SU109-BAR-CODE         07640500
076406                                           DELIMITED BY SIZE      07640600
076407                                      INTO PV-CICS-MSG-AREA       07640700
076408                                                                  07640800
076409              PERFORM 9997-WRITE-TO-CSSL                          07640900
076410                                                                  07641000
076411              STRING  'SUKCS700 '                                 07641100
076412                      ' TRIP:'             PV-DISP-TRIP           07641200
076413                      ' DR:'               SU109-DOOR-NUMBER      07641300
076414                      ' USR:'              SU109-USER-ID          07641400
076415                      ' STA:'              PV-DISP-PNA-STA        07641500
076416                      ' SQL:'              PV-DISP-SQL            07641600
076417                      ' CARTON AUDIT DETERMINATION MODULE'        07641700
076418                      ' OTHER'                                    07641800
076419                                           DELIMITED BY SIZE      07641900
076420                                      INTO PV-CICS-MSG-AREA       07642000
076421                                                                  07642100
076422              PERFORM 9997-WRITE-TO-CSSL                          07642200
076423                                                                  07642300
076424              INITIALIZE PV-CICS-MSG-AREA                         07642400
076425                                                                  07642500
076426              STRING  'SUKCS700 (SUKCS583)'                       07642600
076427                      ' TYPE:'       SU021-AUDIT-REQUEST-TYPE     07642700
076428                      ' PO:'         PV-DISP-OPER                 07642800
076429                      '-'            PV-DISP-PO                   07642900
076430                      '-'            PV-DISP-RCVR                 07643000
076431                      ' LINE:'       PV-DISP-LINE                 07643100
076432                      ' PRPK:'       PV-DISP-PREPK                07643200
076433                      ' PKG:'        SU021-PACKAGE-TYPE-CODE      07643300
076434                                     DELIMITED BY SIZE            07643400
076435                                INTO PV-CICS-MSG-AREA             07643500
076436                                                                  07643600
076437              PERFORM 9997-WRITE-TO-CSSL                          07643700
076438                                                                  07643800
076439              INITIALIZE PV-CICS-MSG-AREA                         07643900
076440                                                                  07644000
076441              STRING  'SUKCS700 '                                 07644100
076442                      ' TRIP:'       PV-DISP-TRIP                 07644200
076443                      ' SSCC:'       PV-DISP-SSCC                 07644300
076444                      ' USR:'        SU021-USER-ID                07644400
076445                      ' DEF:'        SU021-DEFERRED-AUDIT-IND     07644500
076446                      ' REQ:'        SU021-AUDIT-REQUIRED-SW      07644600
076447                                     DELIMITED BY SIZE            07644700
076448                                INTO PV-CICS-MSG-AREA             07644800
076449                                                                  07644900
076450              PERFORM 9997-WRITE-TO-CSSL                          07645000
076451                                                                  07645100
076452              INITIALIZE PV-CICS-MSG-AREA                         07645200
076453                                                                  07645300
076454                                                                  07645400
076455              STRING  'SUKCS700 '                                 07645500
076456                      ' AUD SW:'   SU021-AUDIT-VALIDATION-SW      07645600
076457                      ' PNA SW:'   SU021-PRINT-APPLY-SW           07645700
076458                      ' RFID AUD:' SU021-RFID-AUDIT-REQUIRED-SW   07645800
076459                      ' RFID AUD SW:'                             07645900
076460                                   SU021-RFID-AUDIT-VALIDATION-SW 07646000
076461                                   DELIMITED BY SIZE              07646100
076462                              INTO PV-CICS-MSG-AREA               07646200
076463                                                                  07646300
076464              PERFORM 9997-WRITE-TO-CSSL                          07646400
076465                                                                  07646500
076466              SET SU109-INVALID-SQL                               07646600
076467                  SU109-CRA-SQLERROR  TO  TRUE                    07646700
076468                                                                  07646800
076469     END-EVALUATE.                                                07646900
076470                                                                  07647000
076471                                                                  07647100
076472*----------------------------------------------------------------*07647200
076473* CALL AUDIT MODULE TO CREATE STOP VE TROUBLE                    *07647300
076474*----------------------------------------------------------------*07647400
076475 6050-CREATE-TROUBLE.                                             07647500
076476                                                                  07647600
076477     IF  PS-BLD-INTERNAL-TABLE-YES                                07647700
076478         MOVE  '6050'  TO  PT-CURR-PARA                           07647800
076479         PERFORM 8120-INTERNAL-TABLE                              07647900
076480     END-IF.                                                      07648000
076481                                                                  07648100
076482     PERFORM 6060-GET-RCVR-OPER.                                  07648204
076483                                                                  07648304
076484     IF PS-SHOW-DEBUG-INFO                                        07648404
076485         STRING ' SUKCS700-6050-CREATE-TROUBLE            '       07648504
076486             DELIMITED BY SIZE                                    07648604
076487             INTO PV-CICS-MSG-AREA                                07648704
076488         PERFORM 9990-WRITE-CICS                                  07648804
076489     END-IF.                                                      07648900
076490                                                                  07649000
076491     INITIALIZE TM500-FIELDS.                                     07649100
076492                                                                  07649200
076493     SET  TM500-CREATE-AUTO                                       07649300
076494          TM500-PO-LEVEL                                          07649400
076495          TM500-ADD-DETAILS                                       07649500
076496          TM500-CREATE             TO TRUE.                       07649600
076497                                                                  07649700
076498     MOVE PC-433                  TO TM500-TRBL-RSN-CDE.          07649801
076499     MOVE PV-OPER-UNT-ID          TO TM500-OPER-UNT-ID.           07649904
076500     MOVE 1                       TO TM500-FCLTY-ID.              07650003
076501     MOVE SU021-PO-NUMBER         TO TM500-PO-NBR.                07650100
076502     MOVE SU021-REC-SEQ-NBR       TO TM500-REC-SEQ-NBR.           07650206
076503     MOVE PC-THIN-SLICE-MOD       TO TM500-CRE-UID.               07650307
076504                                                                  07650406
076505     MOVE SU021-INBOUND-TRIP-ID   TO PV-DISP-TRIP                 07650506
076506     MOVE SU109-ACM-LBL-STA-NBR   TO PV-DISP-PNA-STA              07650606
076507     MOVE SPACES                  TO TM500-FREEFORM-TEXT.         07650706
076508     STRING ' SELECTED FOR THIN SLICE ELIGIBILITY - '             07650806
076509            ' DO NOT RESOLVE TROUBLE UNTIL AFTER THE'             07650906
076510            ' DATA HAS BEEN UPLOADED FROM NEW SYSTEM'             07651006
076511            ' TRIP:'     PV-DISP-TRIP                             07651106
076512            ' PNA STA:'  PV-DISP-PNA-STA                          07651206
076513            ' DOOR:'     SU109-DOOR-NUMBER                        07651306
076514                                     DELIMITED BY SIZE            07651400
076515                                INTO TM500-FREEFORM-TEXT.         07651500
076516                                                                  07651600
076517     MOVE LENGTH OF TM500-FIELDS  TO PV-COMMAREA-LENGTH.          07651700
076518                                                                  07651800
076519     EXEC CICS                                                    07651900
076520         LINK PROGRAM  (PC-TMKCS521)                              07652000
076521              COMMAREA (TM500-FIELDS)                             07652100
076522              LENGTH   (PV-COMMAREA-LENGTH)                       07652200
076523     END-EXEC.                                                    07652300
076524                                                                  07652400
076525     EVALUATE TRUE                                                07652500
076526         WHEN TM500-CALL-SUCCESSFUL                               07652600
076527              CONTINUE                                            07652700
076609                                                                  07660900
076610              IF PS-SHOW-DEBUG-INFO                               07661000
076611                 MOVE SPACES TO PV-CICS-MSG-AREA                  07661100
076612                 STRING ' SUKCS700-6050-CREATE-TROUBLE-AFTER '    07661200
076613                        ' -  SUCCESSFUL'                          07661300
076614                         DELIMITED BY SIZE                        07661400
076615                    INTO PV-CICS-MSG-AREA                         07661500
076616                 PERFORM 9990-WRITE-CICS                          07661600
076617                                                                  07661700
076618                 MOVE SPACES TO PV-CICS-MSG-AREA                  07661800
076619                 PERFORM 9990-WRITE-CICS                          07661900
076620              END-IF                                              07662000
076621                                                                  07662100
076622         WHEN OTHER                                               07662200
076623                                                                  07662300
076624              INITIALIZE PV-CICS-MSG-AREA                         07662400
076625                                                                  07662500
076627              MOVE SU109-TRIP-ID         TO PV-DISP-TRIP          07662700
076628              MOVE SU109-ACM-LBL-STA-NBR TO PV-DISP-PNA-STA       07662800
076629                                                                  07662900
076630              MOVE PV-OPER-UNT-ID        TO PV-DISP-OPER          07663004
076631              MOVE SU109-ORD-NBR         TO PV-DISP-PO            07663100
076632              MOVE SU109-REC-SEQ-NBR     TO PV-DISP-RCVR          07663200
076633              MOVE SU109-ORD-LNE-NBR     TO PV-DISP-LINE          07663300
076634              MOVE SU109-PREPK-ID        TO PV-DISP-PREPK         07663400
076635                                                                  07663500
076636              MOVE SU109-TRIP-ID         TO PV-DISP-TRIP          07663600
076637              MOVE SU109-BAR-CODE        TO PV-DISP-SSCC          07663700
076638                                                                  07663800
076639              STRING  'SUKCS700 6050-CREATE-TROUBLE '             07663900
076640                      ' DC:'               PV-DISP-OPER           07664000
076641                      ' SSCC:'             SU109-BAR-CODE         07664100
076642                                           DELIMITED BY SIZE      07664200
076643                                      INTO PV-CICS-MSG-AREA       07664300
076644                                                                  07664400
076645              PERFORM 9997-WRITE-TO-CSSL                          07664500
076646                                                                  07664600
076647              STRING  'SUKCS700 '                                 07664700
076648                      ' TRIP:'             PV-DISP-TRIP           07664800
076649                      ' DR:'               SU109-DOOR-NUMBER      07664900
076650                      ' USR:'              SU109-USER-ID          07665000
076651                      ' STA:'              PV-DISP-PNA-STA        07665100
076652                      ' SQL:'              PV-DISP-SQL            07665200
076653                      ' TROUBLE CREATE MODULE '                   07665300
076655                                           DELIMITED BY SIZE      07665500
076656                                      INTO PV-CICS-MSG-AREA       07665600
076657                                                                  07665700
076658              PERFORM 9997-WRITE-TO-CSSL                          07665800
076659                                                                  07665900
076660              INITIALIZE PV-CICS-MSG-AREA                         07666000
076661                                                                  07666100
076662              STRING  'SUKCS700 (TMKCS521)'                       07666200
076663                      ' TYPE:'       SU021-AUDIT-REQUEST-TYPE     07666300
076664                      ' PO:'         PV-DISP-OPER                 07666400
076665                      '-'            PV-DISP-PO                   07666500
076666                      '-'            PV-DISP-RCVR                 07666600
076667                      ' LINE:'       PV-DISP-LINE                 07666700
076668                      ' PRPK:'       PV-DISP-PREPK                07666800
076669                      ' PKG:'        SU021-PACKAGE-TYPE-CODE      07666900
076670                                     DELIMITED BY SIZE            07667000
076671                                INTO PV-CICS-MSG-AREA             07667100
076672                                                                  07667200
076673              PERFORM 9997-WRITE-TO-CSSL                          07667300
076674                                                                  07667400
076675              INITIALIZE PV-CICS-MSG-AREA                         07667500
076676                                                                  07667600
076677              STRING  'SUKCS700 '                                 07667700
076678                      ' TRIP:'       PV-DISP-TRIP                 07667800
076679                      ' SSCC:'       PV-DISP-SSCC                 07667900
076680                      ' USR:'        SU021-USER-ID                07668000
076681                      ' DEF:'        SU021-DEFERRED-AUDIT-IND     07668100
076682                      ' REQ:'        SU021-AUDIT-REQUIRED-SW      07668200
076683                                     DELIMITED BY SIZE            07668300
076684                                INTO PV-CICS-MSG-AREA             07668400
076685                                                                  07668500
076686              PERFORM 9997-WRITE-TO-CSSL                          07668600
076687                                                                  07668700
076688              INITIALIZE PV-CICS-MSG-AREA                         07668800
076689                                                                  07668900
076690                                                                  07669000
076691              STRING  'SUKCS700 '                                 07669100
076692                      ' AUD SW:'   SU021-AUDIT-VALIDATION-SW      07669200
076693                      ' PNA SW:'   SU021-PRINT-APPLY-SW           07669300
076694                      ' RFID AUD:' SU021-RFID-AUDIT-REQUIRED-SW   07669400
076695                      ' RFID AUD SW:'                             07669500
076696                                   SU021-RFID-AUDIT-VALIDATION-SW 07669600
076697                                   DELIMITED BY SIZE              07669700
076698                              INTO PV-CICS-MSG-AREA               07669800
076699                                                                  07669900
076700              PERFORM 9997-WRITE-TO-CSSL                          07670000
076701                                                                  07670100
076702                                                                  07670200
076703              STRING  'SUKCS700 '                                 07670300
076704                      ' RET CD:'   TM500-RETURN-CODE              07670400
076705                      ' SQL:'      TM500-SQLCODE                  07670502
076706                      '  '         TM500-SQLCA                    07670600
076709                                   DELIMITED BY SIZE              07670900
076710                              INTO PV-CICS-MSG-AREA               07671000
076711                                                                  07671100
076712              PERFORM 9997-WRITE-TO-CSSL                          07671200
076713                                                                  07671300
076714              SET SU109-INVALID-SQL                               07671400
076715                  SU109-CRA-SQLERROR  TO  TRUE                    07671500
076716                                                                  07671600
076717     END-EVALUATE.                                                07671700
076718                                                                  07671800
076719                                                                  07671900
076720*----------------------------------------------------------------*07672004
076721* GET THE OPER ON THE RECEIVER                                   *07672104
076722*----------------------------------------------------------------*07672204
076723 6060-GET-RCVR-OPER.                                              07672304
076725                                                                  07672504
076726     IF  PS-BLD-INTERNAL-TABLE-YES                                07672604
076727         MOVE  '6060'  TO  PT-CURR-PARA                           07672704
076728         PERFORM 8120-INTERNAL-TABLE                              07672804
076729     END-IF.                                                      07672904
076730                                                                  07673004
076731     IF PS-SHOW-DEBUG-INFO                                        07673104
076732         STRING ' SUKCS700-6060-GET-RCVR-OPER   '                 07673204
076733             DELIMITED BY SIZE                                    07673304
076734             INTO PV-CICS-MSG-AREA                                07673404
076735         PERFORM 9990-WRITE-CICS                                  07673504
076736     END-IF.                                                      07673604
076737                                                                  07673704
076740     EXEC SQL                                                     07674004
076741        SELECT  OPER_UNT_ID                                       07674104
076742          INTO :PV-OPER-UNT-ID                                    07674204
076743          FROM  TRECEIV                                           07674304
076751         WHERE ORD_NBR         = :DK-ORD-NBR                      07675104
076752           AND REC_SEQ_NBR     = :DK-REC-SEQ-NBR                  07675204
076754           AND VER_STATUS_CDE  =  'A'                             07675404
076774           WITH UR                                                07677404
076775     END-EXEC.                                                    07677504
076776                                                                  07677604
076777     EVALUATE TRUE                                                07677704
076778         WHEN SQLCODE = ZERO                                      07677804
076779              CONTINUE                                            07677904
076780                                                                  07678004
076785         WHEN SQLWARN0 NOT = SPACES                               07678504
076786         WHEN SQLCODE NOT EQUAL ZERO                              07678604
076787              MOVE ZEROES  TO  PV-BULK-EAS-CNT                    07678704
076788              move '6060'  to  PV-CSSL-PARA                       07678804
076789              perform 8110-WRITE-SUWS109-TO-CSSL                  07678904
076790                                                                  07679004
076791             MOVE '6060-GET-RCVR-OPER      '                      07679104
076792                                   TO DP013-PARAGRAPH             07679204
076793             MOVE 'SUKCS700 - GET RECEIVER OPER FOR TROUBLE'      07679304
076794                                   TO DP013-MESSAGE-TEXT(1)       07679404
076795             MOVE DK-ORD-NBR       TO PV-DISP-PO                  07679504
076796             MOVE DK-REC-SEQ-NBR   TO PV-DISP-RCVR                07679604
076797                                                                  07679704
076798             STRING 'RCVR:'                                       07679804
076799                     PV-DISP-PO      '-'                          07679904
076800                     PV-DISP-RCVR DELIMITED BY SIZE               07680004
076801                                     INTO DP013-MESSAGE-TEXT(2)   07680104
076802                                                                  07680204
076803             MOVE SQLCA            TO DP013-SQLCA                 07680304
076804             MOVE 'TRECEIV'        TO DP013-DB2-TABLE-NAME(1)     07680404
076807             SET DP013-DB2-ABEND   TO TRUE                        07680704
076808             SET DP013-ROLLBACK    TO TRUE                        07680804
076809             PERFORM 9999-WRITE-CICS-LOG-MSG                      07680904
076810             SET PS-DUMP-TO-LOG    TO TRUE                        07681004
076811             SET SU109-INVALID-SQL TO TRUE                        07681104
076812     END-EVALUATE.                                                07681204
076813                                                                  07681304
076814     IF PS-SHOW-DEBUG-INFO                                        07681404
076815         MOVE PV-BULK-EAS-CNT         TO  PV-DISP-COUNT           07681504
076816         STRING ' SUKCS700-6060-GET-RCVR-OPER  - '                07681604
076818             DELIMITED BY SIZE                                    07681804
076819             INTO PV-CICS-MSG-AREA                                07681904
076820         PERFORM 9990-WRITE-CICS                                  07682004
076821     END-IF.                                                      07682104
076822                                                                  07682204
076823                                                                  07682304
076824                                                                  07682400
076825                                                                  07682500
076826*----------------------------------------------------------------*07682600
076827* INSERT INTO PO TRACKING TABLE                                  *07682700
076828*----------------------------------------------------------------*07682800
076829 7000-INSERT-PO-TRKG.                                             07682900
076830                                                                  07683000
076831     IF  PS-BLD-INTERNAL-TABLE-YES                                07683100
076832         MOVE  '7000'  TO  PT-CURR-PARA                           07683200
076833         PERFORM 8120-INTERNAL-TABLE                              07683300
076834     END-IF.                                                      07683400
076835                                                                  07683500
076836     IF PS-SHOW-DEBUG-INFO                                        07683600
076837         STRING ' SUKCS700-7000-INSERT-PO-TRKG   '                07683700
076838                  RCT00017-DC-FUNC-CDE                            07683800
076839             DELIMITED BY SIZE                                    07683900
076840             INTO PV-CICS-MSG-AREA                                07684000
076841         PERFORM 9990-WRITE-CICS                                  07684100
076842     END-IF.                                                      07684200
076843                                                                  07684300
076844     EXEC SQL                                                     07684400
076845         INSERT INTO RCT_PO_RCVR_TRKG                             07684500
076846               (PO_NBR                                            07684600
076847              , RCVR_SEQ_NBR                                      07684700
076848              , CRE_BY_USR_ID                                     07684800
076849              , CRE_TMST                                          07684900
076850              , DC_FUNC_CDE                                       07685000
076851              , LOC_NBR                                           07685100
076852              , PO_LNE_NBR                                        07685200
076853              , PREPK_ID                                          07685300
076854              , CRE_BY_PGM_NM                                     07685400
076855              , QTY_TRKD_NBR                                      07685500
076856              , LAST_UPD_TMST                                     07685600
076857              , PKSL_SEQ_NBR                                      07685700
076858              , DEST_LOC_NBR                                      07685800
076859               )                                                  07685900
076860         VALUES (:RCT00017-PO-NBR                                 07686000
076861               , :RCT00017-RCVR-SEQ-NBR                           07686100
076862               , :RCT00017-CRE-BY-USR-ID                          07686200
076863               ,  CURRENT TIMESTAMP                               07686300
076864               , :RCT00017-DC-FUNC-CDE                            07686400
076865               , :RCT00017-LOC-NBR                                07686500
076866               , :RCT00017-PO-LNE-NBR                             07686600
076867               , :RCT00017-PREPK-ID                               07686700
076868               , :PC-THIN-SLICE-MOD                               07686800
076869               , :RCT00017-QTY-TRKD-NBR                           07686900
076870               ,  CURRENT TIMESTAMP                               07687000
076871               , :RCT00017-PKSL-SEQ-NBR                           07687100
076872               , :RCT00017-DEST-LOC-NBR                           07687200
076873                )                                                 07687300
076874     END-EXEC.                                                    07687400
076875                                                                  07687500
076876     EVALUATE TRUE                                                07687600
076877         WHEN SQLCODE = ZERO                                      07687700
076878              SET  SU109-SUCCESSFUL        TO  TRUE               07687800
076879                                                                  07687900
076880         WHEN SQLWARN0 NOT = SPACES                               07688000
076881         WHEN SQLCODE NOT EQUAL ZERO                              07688100
076882              MOVE ZEROES  TO  PV-PBS-EAS-CNT                     07688200
076883              move '7000'  to  PV-CSSL-PARA                       07688300
076884              perform 8110-WRITE-SUWS109-TO-CSSL                  07688400
076885                                                                  07688500
076886             MOVE '7000-INSERT-PO-TRKG    '                       07688600
076887                                   TO DP013-PARAGRAPH             07688700
076888             MOVE 'SUKCS700 - po tracking insert '                07688800
076889                                   TO DP013-MESSAGE-TEXT(1)       07688900
076890             MOVE DK-ORD-NBR       TO PV-DISP-PO                  07689000
076891             MOVE DK-REC-SEQ-NBR   TO PV-DISP-RCVR                07689100
076892                                                                  07689200
076893             STRING 'RCVR:'                                       07689300
076894                     PV-DISP-PO      '-'                          07689400
076895                     PV-DISP-RCVR DELIMITED BY SIZE               07689500
076896                                     INTO DP013-MESSAGE-TEXT(2)   07689600
076897                                                                  07689700
076898             MOVE SQLCA            TO DP013-SQLCA                 07689800
076899             MOVE 'rct00017   '    TO DP013-DB2-TABLE-NAME(1)     07689900
076900             MOVE 'rct_PO_rcvr_trkg' TO DP013-DB2-TABLE-NAME(2)   07690000
076901             SET DP013-DB2-ABEND   TO TRUE                        07690100
076902             SET DP013-ROLLBACK    TO TRUE                        07690200
076903             PERFORM 9999-WRITE-CICS-LOG-MSG                      07690300
076904             SET PS-DUMP-TO-LOG    TO TRUE                        07690400
076905             SET SU109-INVALID-SQL TO TRUE                        07690500
076906     END-EVALUATE.                                                07690600
076907                                                                  07690700
076908                                                                  07690800
076909                                                                  07690900
076910                                                                  07691000
076911                                                                  07691100
076912                                                                  07691200
076913                                                                  07691300
076914                                                                  07691400
076915                                                                  07691500
076916                                                                  07691600
076917                                                                  07691700
076918                                                                  07691800
076919                                                                  07691900
076920                                                                  07692000
076921                                                                  07692100
076922                                                                  07692200
076923                                                                  07692300
076924                                                                  07692400
076925                                                                  07692500
076926                                                                  07692600
076927                                                                  07692700
076928*----------------------------------------------------------------*07692800
076929*                                                                *07692900
076930*----------------------------------------------------------------*07693000
076931 8000-CHECK-FOR-LOGGING.                                          07693100
076932                                                                  07693200
076933     IF  PS-BLD-INTERNAL-TABLE-YES                                07693300
076934         MOVE  '8000'  TO  PT-CURR-PARA                           07693400
076935         PERFORM 8120-INTERNAL-TABLE                              07693500
076936     END-IF.                                                      07693600
076937                                                                  07693700
076938     EXEC SQL                                                     07693800
076939          SELECT FUNC_TXT                                         07693900
076940            INTO :KRPRPM-FUNC-TXT                                 07694000
076941            FROM TKRPRPM                                          07694100
076942           WHERE LOC_ID            = :DK-OPER-UNT-ID              07694200
076950             AND INTFC_SYS_CDE    = 'KHL'                         07695000
077000             AND SYS_PRC_FUNC_CDE = 'SU700D'                      07700000
077100             AND FUNC_PRC_STAT_CDE = 'AC'                         07710000
077200            WITH UR                                               07720000
077300     END-EXEC.                                                    07730000
077400                                                                  07740000
077500     EVALUATE TRUE                                                07750000
077600         WHEN SQLCODE = ZERO                                      07760000
077700             IF KRPRPM-FUNC-TXT = 'Y'                             07770000
077800                 SET PS-SHOW-DEBUG-INFO  TO TRUE                  07780000
077900             ELSE                                                 07790000
078000                 SET PS-DONT-SHOW-DEBUG-INFO TO TRUE              07800000
078100             END-IF                                               07810000
078200         WHEN SQLCODE = +100                                      07820000
078300             SET PS-DONT-SHOW-DEBUG-INFO TO TRUE                  07830000
078400         WHEN SQLWARN0 NOT = SPACES                               07840000
078500         WHEN SQLCODE NOT EQUAL ZERO                              07850000
078600              move '8000'  to  PV-CSSL-PARA                       07860000
078700              perform 8110-WRITE-SUWS109-TO-CSSL                  07870000
078800                                                                  07880000
078900             SET SU109-INVALID-SQL    TO TRUE                     07890000
079000             MOVE  SQLCODE            TO PV-DISP-SQL              07900000
079100             STRING   ' SUKCS700-8000-'                           07910000
079200                      '  SQLCODE='                                07920000
079300                      PV-DISP-SQL                                 07930000
079400                      ' '                                         07940000
079500                      DELIMITED BY SIZE                           07950000
079600                                      INTO PV-CICS-MSG-AREA       07960000
079700             PERFORM 9999-WRITE-TO-CSSL                           07970000
079800             MOVE '8000-'                TO SU109-CRA-REQ-ID      07980000
079900             MOVE PV-CICS-MSG-AREA      TO SU109-CRA-RET-MSG      07990000
080000             SET SU109-INVALID-SQL TO TRUE                        08000000
080100             PERFORM 9998-RETURN                                  08010000
080200     END-EVALUATE.                                                08020000
080300                                                                  08030000
080400                                                                  08040000
080500*---------------------------------------------------------------* 08050000
080600* check parm table (TKRPRPM) to check for logging to CSSL       * 08060000
080700* IF PROGRAM IS TAKING TOO LONG TO RESPOND.  THE VALUE WILL     * 08070000
080800* BE seconds AND WILL BE USED TO DETERMINE IF WE SHOULD WRITE   * 08080000
080900* pt-pARA-tRACKING TABLE TO CSSL                                * 08090000
081000* check parm table (TKRPRPM) to check if will be building the   * 08100000
081100* internal table during processing.  this will be used when     * 08110000
081200* dc's report long resonse times                                * 08120000
081300*---------------------------------------------------------------* 08130000
081400 8100-CHECK-PARA-TRACK-SEC.                                       08140000
081500                                                                  08150000
081600     IF  PS-BLD-INTERNAL-TABLE-YES                                08160000
081700         MOVE  '8100'  TO  PT-CURR-PARA                           08170000
081800         PERFORM 8120-INTERNAL-TABLE                              08180000
081900     END-IF.                                                      08190000
082000                                                                  08200000
082100     EXEC SQL                                                     08210000
082200          SELECT  FUNC_QTY                                        08220000
082300               ,  FUNC_txt                                        08230000
082400            INTO :PV-PARM-seconds                                 08240000
082500               , :PS-BLD-INTERNAL-TABLE-SW                        08250000
082600            FROM  TKRPRPM                                         08260000
082700           WHERE  LOC_ID            = :DK-OPER-UNT-ID             08270000
082800             AND  INTFC_SYS_CDE     = 'ACM'                       08280000
082900             AND  SYS_PRC_FUNC_CDE  = 'PATIM4'                    08290000
083000             AND  FUNC_PRC_STAT_CDE = 'AC'                        08300000
083100             AND  fUNC_BEG_TMST    <=  current timestamp          08310000
083200             AND  fUNC_END_TMST    >=  current timestamp          08320000
083300            WITH UR                                               08330000
083400     END-EXEC.                                                    08340000
083500                                                                  08350000
083600     EVALUATE TRUE                                                08360000
083700         WHEN SQLCODE = ZERO                                      08370000
083800              CONTINUE                                            08380000
083900                                                                  08390000
084000         WHEN SQLCODE = +100                                      08400000
084100              MOVE 999999999  TO  PV-PARM-SECONDS                 08410000
084200              SET  PS-BLD-INTERNAL-TABLE-NO   TO TRUE             08420000
084300                                                                  08430000
084400         WHEN SQLWARN0 NOT = SPACES                               08440000
084500         WHEN SQLCODE NOT EQUAL ZERO                              08450000
084600              move '8100'  to  PV-CSSL-PARA                       08460000
084700              perform 8110-WRITE-SUWS109-TO-CSSL                  08470000
084800                                                                  08480000
084900              MOVE '8100'  TO  PV-CSSL-PARA                       08490000
085000              PERFORM 8110-WRITE-SUWS109-TO-CSSL                  08500000
085100                                                                  08510000
085200              MOVE 999999999  TO  PV-PARM-SECONDS                 08520000
085300              SET PS-BLD-INTERNAL-TABLE-NO   TO  TRUE             08530000
085400              MOVE  SQLCODE           TO PV-DISP-SQL              08540000
085500              SET SU109-INVALID-SQL   TO TRUE                     08550000
085600              MOVE  SQLCODE           TO PV-DISP-SQL              08560000
085700              STRING   ' SUKCS700-8100-'                          08570000
085800                       ' SQL:'           PV-DISP-SQL              08580000
085900                       ' '                                        08590000
086000                       DELIMITED BY SIZE                          08600000
086100                                    INTO PV-CICS-MSG-AREA         08610000
086200             PERFORM 9997-WRITE-TO-CSSL                           08620000
086300             MOVE '8100-'             TO SU109-CRA-REQ-ID         08630000
086400             MOVE PV-CICS-MSG-AREA    TO SU109-CRA-RET-MSG        08640000
086500             SET SU109-INVALID-SQL    TO TRUE                     08650000
086600             PERFORM 9998-RETURN                                  08660000
086700                                                                  08670000
086800     END-EVALUATE.                                                08680000
086900                                                                  08690000
087000                                                                  08700000
087100*---------------------------------------------------------------* 08710000
087200* WRITE COMMAREA TO CSSL                                        * 08720000
087300*---------------------------------------------------------------* 08730000
087400 8110-WRITE-SUWS109-TO-CSSL.                                      08740000
087500                                                                  08750000
087600     IF  PS-BLD-INTERNAL-TABLE-YES                                08760000
087700         MOVE  '8110'  TO  PT-CURR-PARA                           08770000
087800         PERFORM 8120-INTERNAL-TABLE                              08780000
087900     END-IF.                                                      08790000
088000                                                                  08800000
088100                                                                  08810000
088200     INITIALIZE PV-CICS-MSG-AREA                                  08820000
088300     MOVE SU109-BAR-CODE           TO PV-DISP-SSCC                08830000
088400     MOVE SU109-ord-nbr            TO PV-DISP-PO                  08840000
088500     MOVE SU109-OPER-UNT-ID        TO PV-DISP-OPER                08850000
088600     MOVE SU109-TRIP-ID            TO PV-DISP-TRIP                08860000
088700     MOVE SQLCODE                  TO PV-DISP-SQL                 08870000
088800                                                                  08880000
088900     INITIALIZE PV-CICS-MSG-AREA                                  08890000
089000     PERFORM 9997-WRITE-TO-CSSL.                                  08900000
089100                                                                  08910000
089200     STRING  ' SUKCS700 '  PV-CSSL-PARA                           08920000
089300             ' SSCC:'      PV-DISP-SSCC                           08930000
089400             ' PO:'        PV-DISP-PO                             08940000
089500             ' OPER:'      PV-DISP-OPER                           08950000
089600                           DELIMITED BY SIZE                      08960000
089700                      INTO PV-CICS-MSG-AREA                       08970000
089800                                                                  08980000
089900     PERFORM 9997-WRITE-TO-CSSL                                   08990000
090000                                                                  09000000
090100     INITIALIZE PV-CICS-MSG-AREA                                  09010000
090200     STRING  ' SUKCS700 '                                         09020000
090300             ' SUCC:'      SU109-SUCCESS-IND                      09030000
090400                           DELIMITED BY SIZE                      09040000
090500                      INTO PV-CICS-MSG-AREA                       09050000
090600                                                                  09060000
090700     PERFORM 9997-WRITE-TO-CSSL.                                  09070000
090800                                                                  09080000
090900     INITIALIZE PV-CICS-MSG-AREA                                  09090000
091000     STRING  ' SUKCS700 '                                         09100000
091100             ' SQL:'       PV-DISP-SQL                            09110000
091200                           DELIMITED BY SIZE                      09120000
091300                      INTO PV-CICS-MSG-AREA                       09130000
091400                                                                  09140000
091500     PERFORM 9997-WRITE-TO-CSSL.                                  09150000
091600                                                                  09160000
091700     INITIALIZE PV-CICS-MSG-AREA                                  09170000
091800     PERFORM 9997-WRITE-TO-CSSL.                                  09180000
091900                                                                  09190000
092000                                                                  09200000
092100*---------------------------------------------------------------* 09210000
092200* BUILD INTERNAL TABLE WITN PARAGRAPH TRACKING                  * 09220000
092300*---------------------------------------------------------------* 09230000
092400 8120-INTERNAL-TABLE.                                             09240000
092500                                                                  09250000
092600     PERFORM 8130-GET-CURRENT-TMST.                               09260000
092700     ADD  +1  TO  PT-CURR-ENTRIES.                                09270000
092800     SET  PT-TRACK-IDX to PT-CURR-ENTRIES                         09280000
092900                                                                  09290000
093000     MOVE 'SUKCS700'           TO PT-PROGRAM(PT-TRACK-IDX).       09300000
093100     MOVE PT-CURR-ENTRIES      TO PT-INDEX-NBR(PT-TRACK-IDX).     09310000
093200     MOVE PT-CURR-PARA         TO PT-PARAGRAPH(PT-TRACK-IDX).     09320000
093300     MOVE PV-CURRENT-PARA-TMST TO PT-TIMESTAMP(PT-TRACK-IDX).     09330000
093400     MOVE PV-DURATION-SEC      TO PT-DURATION(PT-TRACK-IDX).      09340000
093500                                                                  09350000
093600     MOVE PV-DURATION-NANO-SEC    TO PV-WORK-NANO-SEC.            09360000
093700     MOVE PV-WORK-NANO-MIN-1-2    TO PV-DISP-NANO-MIN-1-2.        09370000
093800     MOVE '-'                     TO PV-DISP-NANO-DASH-1.         09380000
093900     MOVE PV-WORK-NANO-SEC-3-4    TO PV-DISP-NANO-SEC-3-4.        09390000
094000     MOVE '-'                     TO PV-DISP-NANO-DASH-2.         09400000
094100     MOVE PV-WORK-NANO-MICRO-5-10 TO PV-DISP-NANO-MICRO-5-10.     09410000
094200     MOVE PV-DISP-NANO-SEC     TO PT-NANO-SEC(PT-TRACK-IDX).      09420000
094300                                                                  09430000
094400     MOVE SU109-OPER-UNT-ID      tO PT-DC(PT-TRACK-IDX).          09440000
094500     MOVE PV-INIT-TIME-KEY      TO PT-START-HHMMSS(PT-TRACK-IDX). 09450000
094600                                                                  09460000
094700     IF  PT-TRACK-IDX >=  PT-MAX-PARA-ENTRIES                     09470000
094800         MOVE ZEROES TO PT-CURR-ENTRIES                           09480000
094900         SET  PT-TRACK-IDX  TO PT-CURR-ENTRIES                    09490000
095000     END-IF.                                                      09500000
095100                                                                  09510000
095200                                                                  09520000
095300*---------------------------------------------------------------* 09530000
095400*                                                               * 09540000
095500*---------------------------------------------------------------* 09550000
095600 8130-GET-CURRENT-TMST.                                           09560000
095700     EXEC SQL                                                     09570000
095800          SET :PV-CURRENT-PARA-TMST = CURRENT TIMESTAMP           09580000
095900     END-EXEC.                                                    09590000
096000                                                                  09600000
096100     EXEC SQL                                                     09610000
096200          SELECT                                                  09620000
096300                 TIMESTAMPDIFF( 2 ,CHAR(:PV-CURRENT-PARA-TMST     09630000
096400                   - TIMESTAMP(:PV-RECEIVE-RQST-TMST)))           09640000
096500               , TIMESTAMPDIFF( 1 ,CHAR(:PV-CURRENT-PARA-TMST     09650000
096600                   - TIMESTAMP(:PV-RECEIVE-RQST-TMST)))           09660000
096700            INTO :PV-DURATION-SEC                                 09670000
096800               , :PV-DURATION-nano-sec                            09680000
096900            FROM  SYSIBM.SYSDUMMY1                                09690000
097000     END-EXEC.                                                    09700000
097100                                                                  09710000
097200                                                                  09720000
097300*---------------------------------------------------------------* 09730000
097400*                                                               * 09740000
097500*---------------------------------------------------------------* 09750000
097600 8140-DUMP-TABLE-TO-CSSL.                                         09760000
097700                                                                  09770000
097800     INITIALIZE PV-CICS-MSG-AREA                                  09780000
097900                                                                  09790000
098000     MOVE PT-ENTRIES(PT-TRACK-IDX)  TO PV-CICS-MSG-AREA           09800000
098100                                                                  09810000
098200     PERFORM 9997-WRITE-TO-CSSL.                                  09820000
098300                                                                  09830000
098400                                                                  09840000
098500*---------------------------------------------------------------* 09850000
098600*                                                               * 09860000
098700*---------------------------------------------------------------* 09870000
098800 8150-CLEAR-TABLE.                                                09880000
098900                                                                  09890000
099000     MOVE  SPACES  TO  PT-PROGRAM(PT-TRACK-IDX).                  09900000
099100     MOVE  ZEROES  TO  PT-INDEX-NBR(PT-TRACK-IDX).                09910000
099200     MOVE  SPACES  TO  PT-PARAGRAPH(PT-TRACK-IDX).                09920000
099300     MOVE  SPACES  TO  PT-TIMESTAMP(PT-TRACK-IDX).                09930000
099400     MOVE  ZEROES  TO  PT-DURATION(PT-TRACK-IDX).                 09940000
099500                                                                  09950000
099600                                                                  09960000
099700                                                                  09970000
099800 9990-WRITE-CICS.                                                 09980000
099900                                                                  09990000
100000* IF YOU'RE AT THE LAST OCCURRENCE OF THE TABLE,                  10000000
100100* THE NEXT MESSAGE WILL GO INTO THE FIRST OCCURRENCE.  KEEP       10010000
100200* INCREMENTING THE SEQUENCE SO THAT IF THE TABLE IS DUMPED TO THE 10020000
100300* LOG YOU WILL BE ABLE TO SEE THE LAST 200 LINES AND HOW THEY     10030000
100400* WRAPPED AROUND.                                                 10040000
100500                                                                  10050000
100600     EVALUATE TRUE                                                10060000
100700     WHEN PT-MSG-IDX < PC-MSG-TABLE-SIZE                          10070000
100800         MOVE PV-CICS-MSG-AREA        TO PT-MSG-LINE (PT-MSG-IDX) 10080000
100900         MOVE PT-MSG-SEQ (PT-MSG-IDX) TO PV-PREV-SEQUENCE         10090000
101000         SET PT-MSG-IDX UP BY 1                                   10100000
101100     WHEN PT-MSG-IDX = PC-MSG-TABLE-SIZE                          10110000
101200         MOVE PV-CICS-MSG-AREA        TO PT-MSG-LINE (PT-MSG-IDX) 10120000
101300         MOVE PT-MSG-SEQ (PT-MSG-IDX) TO PV-PREV-SEQUENCE         10130000
101400         SET PT-MSG-IDX               TO 1                        10140000
101500     END-EVALUATE                                                 10150000
101600                                                                  10160000
101700     COMPUTE PV-NEXT-SEQUENCE = PV-PREV-SEQUENCE + 1              10170000
101800     MOVE PV-NEXT-SEQUENCE            TO PT-MSG-SEQ (PT-MSG-IDX)  10180000
101900                                                                  10190000
102000                                                                  10200000
102100*  IF THE DC HAS TRACE PROCESSING TURNED ON, ALL MESSAGES WILL    10210000
102200*  BE DISPLAYED AS THEY OCCUR.  DUMPING THE MESSAGE TABLE WILL    10220000
102300*  BE UNNECESSARY BECAUSE OF THE REAL-TIME DISPLAYS.              10230000
102400*                                                                 10240000
102500     IF PS-SHOW-DEBUG-INFO                                        10250000
102600         PERFORM 9991-WRITEQ                                      10260000
102700     END-IF                                                       10270000
102800     MOVE SPACES                      TO PV-CICS-MSG-AREA.        10280000
102900                                                                  10290000
103000                                                                  10300000
103100 9991-WRITEQ.                                                     10310000
103200     EXEC CICS                                                    10320000
103300         WRITEQ TD                                                10330000
103400         QUEUE(PC-LOG-QUEUE)                                      10340000
103500         FROM(PV-CICS-MSG-AREA)                                   10350000
103600         RESP(PV-CICS-RESP)                                       10360000
103700     END-EXEC.                                                    10370000
103800                                                                  10380000
103900*-----------------------------------------------------------------10390000
104000 9997-WRITE-TO-CSSL.                                              10400000
104100*-----------------------------------------------------------------10410000
104200     MOVE LENGTH OF PV-CICS-MSG-AREA    TO PV-COMMAREA-LENGTH.    10420000
104300                                                                  10430000
104400     EXEC CICS                                                    10440000
104500          WRITEQ TD                                               10450000
104600           QUEUE   ('CSSL')                                       10460000
104700            FROM   (PV-CICS-MSG-AREA)                             10470000
104800          LENGTH   (PV-COMMAREA-LENGTH)                           10480000
104900            RESP   (PV-CICS-RESP)                                 10490000
105000     END-EXEC.                                                    10500000
105100                                                                  10510000
105200                                                                  10520000
105300                                                                  10530000
105400*-----------------------------------------------------------------10540000
105500*  RETURN TO CALLING PROGRAM                                      10550000
105600*-----------------------------------------------------------------10560000
105700 9998-RETURN.                                                     10570000
105800                                                                  10580000
105900     STRING ' 9998-RETURN'                                        10590000
106000         DELIMITED BY SIZE                                        10600000
106100         INTO PV-CICS-MSG-AREA.                                   10610000
106200     PERFORM 9990-WRITE-CICS.                                     10620000
106300     MOVE SU109-THIN-SLICE-COMM         TO DFHCOMMAREA.           10630000
106400                                                                  10640000
106500     EXEC CICS                                                    10650000
106600          RETURN                                                  10660000
106700     END-EXEC.                                                    10670000
106800                                                                  10680000
106900                                                                  10690000
107000 9999-WRITE-TO-CSSL.                                              10700000
107100     STRING ' 9999-WRITE-TO-CSSL'                                 10710000
107200                                   DELIMITED BY SIZE              10720000
107300                              INTO PV-CICS-MSG-AREA.              10730000
107400     PERFORM 9990-WRITE-CICS.                                     10740000
107500     MOVE LENGTH OF PV-CICS-MSG-AREA                              10750000
107600       TO PV-COMMAREA-LENGTH                                      10760000
107700     EXEC CICS                                                    10770000
107800          WRITEQ TD                                               10780000
107900           QUEUE   ('CSSL')                                       10790000
108000            FROM   (PV-CICS-MSG-AREA)                             10800000
108100          LENGTH   (PV-COMMAREA-LENGTH)                           10810000
108200            RESP   (PV-CICS-RESP)                                 10820000
108300     END-EXEC.                                                    10830000
108400                                                                  10840000
108500                                                                  10850000
108600 9999-WRITE-CICS-LOG-MSG.                                         10860000
108700     STRING ' 9999-WRITE-CICS-LOG-MSG'                            10870000
108800         DELIMITED BY SIZE                                        10880000
108900         INTO PV-CICS-MSG-AREA.                                   10890000
109000     PERFORM 9990-WRITE-CICS.                                     10900000
109100     MOVE 'SUKCS700'                 TO DP013-PROGRAM.            10910000
109200     MOVE DFHEIBLK                   TO DP013-DFHEIBLK.           10920000
109300     INITIALIZE DP013-SRC-TASK-NUMBER                             10930000
109400                DP013-STACK.                                      10940000
109500     SET DP013-LINK-RETURN           TO TRUE.                     10950000
109600                                                                  10960000
109700     EXEC CICS                                                    10970000
109800         LINK                                                     10980000
109900             PROGRAM   (DP013-NAME)                               10990000
110000             COMMAREA  (DP013-PARAMETERS)                         11000000
110100             LENGTH    (DP013-LENGTH)                             11010000
110200     END-EXEC.                                                    11020000
110300                                                                  11030000
110400                                                                  11040000
110500 9999-FINAL-DUMP.                                                 11050000
110600*  IF AN ERROR HAS OCCURRED, DUMP THE MESSAGE TABLE WHICH WILL    11060000
110700*  CONTAIN THE LAST 200 TRACE DISPLAYS.  IF THE TABLE EVER        11070000
110800*  OVERFLOW, YOU WILL SEE THE SEQUENCE NUMBERS WRAP.  UNUSED      11080000
110900*  OCCRENCES ARE NOT DISPLAYED.                                   11090000
111000*                                                                 11100000
111100                                                                  11110000
111200     STRING ' 9999-FINAL-DUMP'                                    11120000
111300         DELIMITED BY SIZE                                        11130000
111400         INTO PV-CICS-MSG-AREA                                    11140000
111500     PERFORM 9990-WRITE-CICS.                                     11150000
111600                                                                  11160000
111700     EXEC CICS ENQ                                                11170000
111800         RESOURCE(PC-LOG-QUEUE)                                   11180000
111900     END-EXEC                                                     11190000
112000                                                                  11200000
112100     MOVE PV-EIBTASKN             TO PV-DISP-TASK.                11210000
112200     PERFORM VARYING PT-MSG-IDX FROM 1 BY 1 UNTIL                 11220000
112300                     PT-MSG-IDX > PC-MSG-TABLE-SIZE               11230000
112400         IF PT-MSG-SEQ (PT-MSG-IDX) > ZERO                        11240000
112500             MOVE PT-MSG-SEQ (PT-MSG-IDX)                         11250000
112600                                  TO PV-DISP-MSG-NBR              11260000
112700             STRING ' ' PV-DISP-TASK ' '                          11270000
112800                  PV-DISP-MSG-NBR ' '                             11280000
112900                  PT-MSG-LINE (PT-MSG-IDX)                        11290000
113000                  DELIMITED BY SIZE                               11300000
113100                                INTO PV-CICS-MSG-AREA             11310000
113200             PERFORM 9991-WRITEQ                                  11320000
113300         END-IF                                                   11330000
113400     END-PERFORM.                                                 11340000
113500                                                                  11350000
113600     SET PT-MSG-IDX               TO 1.                           11360000
113700     SET PS-DONT-DUMP-TO-LOG      TO TRUE.                        11370000
113800                                                                  11380000
113900     EXEC CICS DEQ                                                11390000
114000         RESOURCE(PC-LOG-QUEUE)                                   11400000
114100     END-EXEC.                                                    11410000
114200                                                                  11420000
