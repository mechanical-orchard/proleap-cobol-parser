000100 IDENTIFICATION DIVISION.                                         00010002
000200 PROGRAM-ID.    RCKCS240.                                         00020002
000300 AUTHOR.        LARRY SCHLEICHER                                  00030002
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040002
000500 DATE-WRITTEN.  04/25/96.                                         00050002
000600 DATE-COMPILED.                                                   00060002
000700                                                                  00070002
000800*---------------------------------------------------------------* 00080002
000900*    TRANID      - E240                                         * 00090002
001000*    TYPE        - CICS ARCHITECTURE MAINTENANCE - DB2          * 00100002
001100*    DESCRIPTION - REDISTRO OR DISTRO LIST SELECTION            * 00110002
001200*    MAPSET      - RCKM240                                      * 00120002
001300*                                                               * 00130002
001400*    THIS PROGRAM ALLOWS THE USER TO OPERATOR TO SELECT TO      * 00140002
001500*    EITHER COMPLETE A REDISTRO FOR A LINE OR GO TO THE         * 00150002
001600*    DISTRO LIST SCREEN.                                        * 00160002
001700*                                                               * 00170002
001800*                                                               * 00180002
001900*---------------------------------------------------------------* 00190002
002000                                                                  00200002
002100 ENVIRONMENT DIVISION.                                            00210002
002200 DATA DIVISION.                                                   00220002
002300                                                                  00230002
002400 WORKING-STORAGE SECTION.                                         00240002
002500                                                                  00250002
002600 01  DK-DB2-KEYS.                                                 00260002
002700     05  DK-PO-NBR                    PIC S9(9) COMP VALUE +0.    00270002
002800     05  DK-REC-SEQ-NBR               PIC S9(9) COMP VALUE +0.    00280002
002900     05  DK-PO-LNE-NBR                PIC S9(9) COMP VALUE +0.    00290002
003000                                                                  00300002
003100 01  PC-PROGRAM-CONSTANTS.                                        00310002
003200     05  PC-TRANS-ID                  PIC X(04)  VALUE 'E240'.    00320002
003300     05  PC-CURRENT-PROGRAM-NAME      PIC X(08)  VALUE 'RCKCS240'.00330002
003400     05  PC-CURRENT-MAP-NAME          PIC X(08)  VALUE 'RC240A  '.00340002
003500     05  PC-CURRENT-MAPSET-NAME       PIC X(08)  VALUE 'RCKM240 '.00350002
003600     05  PC-TROUBLE-RTN               PIC X(08)  VALUE 'TMKCS520'.00360002
003700     05  PC-TROUBLE-RTN-LENGTH        PIC S9(04) VALUE +600       00370002
003800                                                 COMP.            00380002
003900     05  PC-APPL-MAP                  PIC S9(04) VALUE  +1        00390002
004000                                                 COMP.            00400002
004100     05  PC-MAX-RETRIES               PIC S9(04) VALUE  +3        00410002
004200                                                 COMP.            00420002
004300     05  PC-DEFAULT-TMST              PIC  X(26) VALUE            00430002
004400                             '9999-09-09-09.09.09.999999'.        00440002
004500     05  PC-1                         PIC S9(09) VALUE +1         00450002
004600                                                 COMP.            00460002
004700     05  PC-ACTIVE                    PIC X(01)  VALUE 'A'.       00470002
004800     05  PC-INACTIVE                  PIC X(01)  VALUE 'I'.       00480002
004900     05  PC-A                         PIC X(01)  VALUE 'A'.       00490002
005000     05  PC-F                         PIC X(01)  VALUE 'F'.       00500002
005100     05  PC-R                         PIC X(01)  VALUE 'R'.       00510002
005200     05  PC-T                         PIC X(01)  VALUE 'T'.       00520002
005300     05  PC-I                         PIC X(01)  VALUE 'I'.       00530002
005400     05  PC-N                         PIC X(01)  VALUE 'N'.       00540002
005500     05  PC-DPKUT500                  PIC X(08)  VALUE 'DPKUT500'.00550002
005600     05  PC-INTER-APPL-CODES.                                     00560002
005700         10  PC-INTER-APPL-UPDATE     PIC X(01)  VALUE '1'.       00570002
005800     05  PC-DASH                      PIC X(01)  VALUE '-'.       00580002
005900     05  PC-999                       PIC 9(04)  VALUE 999.       00590002
006000     05  PC-1000                      PIC 9(04)  VALUE 1000.      00600002
006100     05  PC-8999                      PIC 9(04)  VALUE 8999.      00610002
006200     05  PC-9000                      PIC 9(04)  VALUE 9000.      00620002
006300     05  PC-MULTIPLE-MSG              PIC X(25)  VALUE            00630002
006400         'MULTIPLE TROUBLE EXISTS  '.                             00640002
006500                                                                  00650002
006600     05  PC-TSYMSG-NUMBERS.                                       00660002
006700         10  PC-TSYMSG-00005          PIC 9(05)  VALUE 00005.     00670002
006800*            INVALID VALUE                                        00680002
006900         10  PC-TSYMSG-00059          PIC 9(05)  VALUE 00059.     00690002
007000*            UPDATE(S) SUCCESSFUL                                 00700002
007100         10  PC-TSYMSG-00069          PIC 9(05)  VALUE 00069.     00710002
007200*            TOP OF LIST                                          00720002
007300         10  PC-TSYMSG-00070          PIC 9(05)  VALUE 00070.     00730002
007400*            BOTTOM OF LIST                                       00740002
007500         10  PC-TSYMSG-00084          PIC 9(05)  VALUE 00084.     00750002
007600*            PURCHASE ORDER LINE DOES NOT EXIST                   00760002
007700         10  PC-TSYMSG-00342          PIC 9(05)  VALUE 00342.     00770002
007800*            MUST BE NUMERIC AND > ZERO                           00780002
007900         10  PC-TSYMSG-00808          PIC 9(05)  VALUE 00808.     00790002
008000*            PURCHASE ORDER LINE STATUS MUST BE ACTIVE OR APPROVED00800002
008100         10  PC-TSYMSG-00892          PIC 9(05)  VALUE 00892.     00810002
008200*            PACK SLIPS EXIST; WORK ORDER DELETE; STATUS UPDATED  00820002
008300         10  PC-TSYMSG-00928          PIC 9(05)  VALUE 00928.     00830002
008400*            REDISTRO PROCEDURE INVALID FOR A PACKED BY STORE RECE00840002
008500         10  PC-TSYMSG-00929          PIC 9(05)  VALUE 00929.     00850002
008600*            RECEIPT LINE HAS ALREADY BEEN VERIFIED               00860002
008700         10  PC-TSYMSG-00937          PIC 9(05)  VALUE 00937.     00870002
008800*            UNABLE TO REDISTRO DUE TO TROUBLE                    00880002
008900         10  PC-TSYMSG-00941          PIC 9(05)  VALUE 00941.     00890002
009000*            REDISTRO SUCCESSFUL BUT TROUBLE CREATED              00900002
009100         10  PC-TSYMSG-01034          PIC 9(05)  VALUE 01034.     00910002
009200*            UNRESOLVED TROUBLE STILL EXISTS                      00920002
009300         10  PC-TSYMSG-01038          PIC 9(05)  VALUE 01038.     00930002
009400*            NOTIFICATION/TROUBLE NOT FOUND                       00940002
009500         10  PC-TSYMSG-01793          PIC 9(05)  VALUE 01793.     00950002
009600*UNABLE TO REDISTRO - CASEPACK SPLIT PROCESS HAS BEEN PERFORMED   00960002
009700         10  PC-TSYMSG-03394          PIC 9(05)  VALUE 03394.     00970002
009800*UNABLE TO REDISTRO - MANIFESTED CARTONS EXIST FOR PO/RCVR/LNE    00980002
009900*JAK - 06/2007 - ADD WMS SPECIFIC MESSAGES                        00990002
010000         10  PC-TSYMSG-03569          PIC 9(05)  VALUE 03569.     01000002
010100*REDISTRO SUCCESSFUL, ASN WILL BE DWNLD TO WMS, BUT TRBL CREATED  01010002
010200         10  PC-TSYMSG-03570          PIC 9(05)  VALUE 03570.     01020002
010300*UPD SUCCESSFUL-REDISTRO PERFORMED AND WILL BE DOWNLOADED TO WMS  01030002
010400                                                                  01040002
010500 01  PS-PROGRAM-SWITCHES.                                         01050002
010600     05  PS-ERROR-SW                  PIC X(01)  VALUE 'N'.       01060002
010700         88  PS-ERROR                            VALUE 'Y'.       01070002
010800         88  PS-NO-ERROR                         VALUE 'N'.       01080002
010900     05  PS-COMMAREA-SW               PIC X(01)  VALUE 'N'.       01090002
011000         88  PS-COMMAREA-VALID                   VALUE 'Y'.       01100002
011100         88  PS-COMMAREA-NOT-VALID               VALUE 'N'.       01110002
011200     05  PS-PKITEM-EXISTS-SW          PIC X(01)  VALUE 'N'.       01120002
011300         88  PS-PKITEM-FOUND                     VALUE 'Y'.       01130002
011400         88  PS-PKITEM-NOT-FOUND                 VALUE 'N'.       01140002
011500         88  PS-MULTI-PKITEM-FOUND               VALUE 'M'.       01150002
011600     05  PS-PURITM-EXISTS-SW          PIC X(01)  VALUE 'N'.       01160002
011700         88  PS-PURITM-FOUND                     VALUE 'Y'.       01170002
011800         88  PS-PURITM-NOT-FOUND                 VALUE 'N'.       01180002
011900     05  PS-UNPKSL-EXISTS-SW          PIC X(01)  VALUE 'N'.       01190002
012000         88  PS-UNPKSL-FOUND                     VALUE 'Y'.       01200002
012100         88  PS-UNPKSL-NOT-FOUND                 VALUE 'N'.       01210002
012200     05  PS-RECITM-EXISTS-SW          PIC X(01)  VALUE 'N'.       01220002
012300         88  PS-RECITM-FOUND                     VALUE 'Y'.       01230002
012400         88  PS-RECITM-NOT-FOUND                 VALUE 'N'.       01240002
012500     05  PS-RTV-QTY-ERROR-SW          PIC X(01)  VALUE 'N'.       01250002
012600         88  PS-RTV-QTY-ERROR                    VALUE 'Y'.       01260002
012700         88  PS-NO-RTV-QTY-ERROR                 VALUE 'N'.       01270002
012800     05  PS-DMG-ITM-QTY-ERROR-SW      PIC X(01)  VALUE 'N'.       01280002
012900         88  PS-DMG-ITM-QTY-ERROR                VALUE 'Y'.       01290002
013000         88  PS-NO-DMG-ITM-QTY-ERROR             VALUE 'N'.       01300002
013100     05  PS-PREV-UPDATE-SW            PIC X(01)  VALUE 'N'.       01310002
013200         88  PS-PREV-UPDATE                      VALUE 'Y'.       01320002
013300         88  PS-NO-PREV-UPDATE                   VALUE 'N'.       01330002
013400     05  PS-LIST-SW                   PIC X(01)  VALUE 'N'.       01340002
013500         88  PS-LIST-END                         VALUE 'Y'.       01350002
013600         88  PS-NO-LIST-END                      VALUE 'N'.       01360002
013700     05  PS-REDISTRO-SW               PIC X(01)  VALUE 'N'.       01370002
013800         88  PS-REDISTRO-OK                      VALUE 'Y'.       01380002
013900         88  PS-REDISTRO-NOT-OK                  VALUE 'N'.       01390002
014000                                                                  01400002
014100 01  PV-PROGRAM-VARIABLES.                                        01410002
014200     05  PV-CICS-RESPONSE             PIC S9(04) VALUE +0         01420002
014300                                                 COMP SYNC.       01430002
014400     05  PV-RETRY-COUNTER             PIC S9(04) VALUE +0         01440002
014500                                                 COMP SYNC.       01450002
014600     05  PV-DB2-COUNT                 PIC S9(09) VALUE +0         01460002
014700                                                 COMP-3.          01470002
014800     05  PV-LINE-NBR-IND              PIC S9(04) VALUE +0         01480002
014900                                                 COMP SYNC.       01490002
015000     05  PV-MAX-LINE-NBR              PIC S9(04) VALUE +0         01500002
015100                                                 COMP.            01510002
015200     05  PV-NEXT-LINE-NBR             PIC S9(04) VALUE +0         01520002
015300                                                 COMP.            01530002
015400     05  PV-NULL-IND                  PIC S9(04) VALUE +0         01540002
015500                                                 COMP.            01550002
015600     05  PV-ABSTIME                   PIC S9(15) COMP.            01560002
015700     05  PV-CURRENT-TIME              PIC  9(06).                 01570002
015800     05  PV-CURRENT-DATE              PIC  9(06).                 01580002
015900     05  FILLER REDEFINES PV-CURRENT-DATE.                        01590002
016000         10  PV-CURRENT-DATE-YY       PIC  X(02).                 01600002
016100         10  PV-CURRENT-DATE-MM       PIC  X(02).                 01610002
016200         10  PV-CURRENT-DATE-DD       PIC  X(02).                 01620002
016300                                                                  01630002
016400     05  PV-CURRENT-DATE-ISO          PIC  X(10).                 01640002
016500     05  FILLER REDEFINES PV-CURRENT-DATE-ISO.                    01650002
016600         10  PV-CD-ISO-YEAR           PIC  9(04).                 01660002
016700         10  FILLER                   PIC  X(01).                 01670002
016800         10  PV-CD-ISO-MM             PIC  9(02).                 01680002
016900         10  FILLER                   PIC  X(01).                 01690002
017000         10  PV-CD-ISO-DD             PIC  9(02).                 01700002
017100                                                                  01710002
017200     05  PV-COMPARE-DATE1             PIC  X(04).                 01720002
017300     05  FILLER REDEFINES PV-COMPARE-DATE1.                       01730002
017400         10  PV-CD-YY-N               PIC  9(02).                 01740002
017500         10  PV-CD-MM-N               PIC  9(02).                 01750002
017600     05  PV-COMPARE-DATE2             PIC  X(04).                 01760002
017700     05  PV-DB2-RETURN-AREAS.                                     01770002
017800         10  PV-DB2-MONTH             PIC S9(09)   VALUE +0       01780002
017900                                                   COMP.          01790002
018000         10  PV-DB2-DAY               PIC S9(09)   VALUE +0       01800002
018100                                                   COMP.          01810002
018200         10  PV-DB2-YEAR              PIC S9(09)   VALUE +0       01820002
018300                                                   COMP.          01830002
018400         10  PV-DB2-HOUR              PIC S9(09)   VALUE +0       01840002
018500                                                   COMP.          01850002
018600         10  PV-DB2-MINUTE            PIC S9(09)   VALUE +0       01860002
018700                                                   COMP.          01870002
018800         10  PV-DB2-TMST.                                         01880002
018900             15  PV-DB2-DATE-AREA     PIC  X(10)   VALUE SPACES.  01890002
019000             15  FILLER               PIC  X(01)   VALUE SPACES.  01900002
019100             15  PV-DB2-TIME-AREA     PIC  X(15)   VALUE SPACES.  01910002
019200     05  PV-DISPLAY-DATE.                                         01920002
019300         10  PV-MONTH                 PIC  9(02)   VALUE ZEROES.  01930002
019400         10  FILLER                   PIC  X(01)   VALUE '-'.     01940002
019500         10  PV-DAY                   PIC  9(02)   VALUE ZEROES.  01950002
019600         10  FILLER                   PIC  X(01)   VALUE '-'.     01960002
019700         10  PV-YEAR                  PIC  9(04)   VALUE ZEROES.  01970002
019800     05  PV-DISPLAY-TIME.                                         01980002
019900         10  PV-HOUR                  PIC  9(02)   VALUE ZEROES.  01990002
020000         10  FILLER                   PIC  X(01)   VALUE ':'.     02000002
020100         10  PV-MINUTE                PIC  9(02)   VALUE ZEROES.  02010002
020200     05  PV-DB2-DATE-HOST             PIC  X(10).                 02020002
020300     05  PV-DB2-DATE                  PIC  X(10).                 02030002
020400     05  FILLER  REDEFINES PV-DB2-DATE.                           02040002
020500         10  PV-DB2-DATE-CCYY.                                    02050002
020600             15  PV-DB2-DATE-CC       PIC  X(02).                 02060002
020700             15  PV-DB2-DATE-YY       PIC  X(02).                 02070002
020800         10  FILLER                   PIC  X(01).                 02080002
020900         10  PV-DB2-DATE-MM           PIC  X(02).                 02090002
021000         10  FILLER                   PIC  X(01).                 02100002
021100         10  PV-DB2-DATE-DD           PIC  X(02).                 02110002
021200     05  PV-DB2-TIME                  PIC  X(15).                 02120006
021300     05  FILLER  REDEFINES PV-DB2-TIME.                           02130002
021400         10  PV-DB2-TIME-HH           PIC  X(02).                 02140002
021500         10  FILLER                   PIC  X(01).                 02150002
021600         10  PV-DB2-TIME-MM           PIC  X(02).                 02160002
021700         10  FILLER                   PIC  X(01).                 02170002
021800         10  PV-DB2-TIME-SS           PIC  X(02).                 02180002
021900         10  FILLER                   PIC  X(01).                 02190002
022000         10  PV-DB2-TIME-HS           PIC  X(06).                 02200002
022100     05  PV-INTEGER                   PIC  9(6).                  02210002
022200     05  PV-REMAINDER                 PIC  9(3).                  02220002
022300     05  PV-STATUS                    PIC  X(02)   VALUE SPACES.  02230002
022400     05  PV-PKSL-STAT-CDE             PIC  X(02)   VALUE SPACES.  02240002
022500         88 PV-PKSL-STAT-CDE-BEING-WORKED          VALUES         02250002
022600            'IP', 'CM'.                                           02260002
022700     05  PV-VALIDATE-IND              PIC  X(01)   VALUE SPACES.  02270002
022800         88  PV-VALID-RTV-IND                      VALUES         02280002
022900                                                   'Y', 'N', ' '. 02290002
023000         88  PV-VALID-PRE-TKT-IND                  VALUES         02300002
023100                                                   'Y', 'N', ' '. 02310002
023200     05  PV-PURITM-STATUS-CDE         PIC  X(02)   VALUE SPACES.  02320002
023300         88  PV-PURITM-STATUS-CDE-VALID            VALUES         02330002
023400                                                   'AC', 'AP'.    02340002
023500                                                                  02350002
023600     05  PV-BASE-DISTRO-QTY           PIC S9(07)   VALUE +0.      02360002
023700     05  PV-DISTRO-QTY                PIC S9(07)   VALUE +0.      02370002
023800     05  PV-TROUBLE-COUNT             PIC 9(03)    VALUE ZEROS.   02380002
023900     05  PV-NOT-IN-TROUBLE-COUNT      PIC 9(03)    VALUE ZEROS.   02390002
024000     05  PV-PACK-BY-ST-IND            PIC X(01)    VALUE SPACE.   02400002
024100         88  PV-PACK-BY-ST-IND-YES                 VALUE 'Y'.     02410002
024200     05  PV-PO-NBR                    PIC S9(09)   COMP           02420002
024300                                                   VALUE ZERO.    02430002
024400     05  PV-REC-SEQ-NBR               PIC S9(09)   COMP           02440002
024500                                                   VALUE ZERO.    02450002
024600     05  PV-NBR-OF-PIC-AD             PIC S9(04) COMP.            02460002
024700     05  PV-OUTBOUND-CNT              PIC S9(04) COMP.            02470002
024800                                                                  02480002
024900     05  PV-PO-NBR-PIC9               PIC S9(11) VALUE +0.        02490002
025000     05  PV-REC-SEQ-NBR-PIC9          PIC S9(11) VALUE +0.        02500002
025100     05  PV-PO-LNE-NBR-PIC9           PIC S9(11) VALUE +0.        02510002
025200                                                                  02520007
025300     05  PV-DISP-PO                   PIC  9(09) VALUE ZEROES.    02530003
025400     05  PV-DISP-RCVR                 PIC  9(04) VALUE ZEROES.    02540003
025500     05  PV-DISP-LINE                 PIC  9(04) VALUE ZEROES.    02550003
025600                                                                  02560002
025700 01  MSG-QUEUE-ITEM.                                              02570002
025800     05  FILLER                       PIC X(11)  VALUE            02580002
025900         'QUEUE NAME '.                                           02590002
026000     05  MSG-QUEUE-NAME               PIC X(08).                  02600002
026100     05  FILLER                       PIC X(14)  VALUE            02610002
026200         '  ITEM NUMBER '.                                        02620002
026300     05  MSG-SEL-ITEM                 PIC 9(04).                  02630002
026400                                                                  02640002
026500 01  MSG1-PO-REC.                                                 02650002
026600     05  FILLER                       PIC X(07)  VALUE            02660002
026700         'PO NBR '.                                               02670002
026800     05  MSG1-PO-NBR                  PIC 9(09).                  02680002
026900     05  FILLER                       PIC X(11)  VALUE            02690002
027000         '  REC SEQ  '.                                           02700002
027100     05  MSG1-REC-SEQ-NBR-N           PIC 9(09).                  02710002
027200     05  FILLER                       PIC X(12)  VALUE            02720002
027300         '  OPER UNIT '.                                          02730002
027400     05  MSG1-OPER-UNT-ID             PIC X(04).                  02740002
027500     05  FILLER                       PIC X(11)  VALUE            02750002
027600         '  FACILITY '.                                           02760002
027700     05  MSG1-FACILITY-ID             PIC X(04).                  02770002
027800                                                                  02780002
027900*----------------------------------------------------------------*02790002
028000*    THE LAYOUT FOR THE TEMPORARY STORAGE QUEUE CONTAINING       *02800002
028100*    SELECTED LIST ITEMS TO BE PROCESSED BY THIS PROGRAM.        *02810002
028200*----------------------------------------------------------------*02820002
028300                                                                  02830002
028400     COPY PCWS016.                                                02840002
028500/                                                                 02850002
028600                                                                  02860002
028700******************************************************************02870002
028800*    SELECTED ITEMS TEMPORARY STORAGE QUEUE ITEM LAYOUT           02880002
028900******************************************************************02890002
029000     COPY RCWS013.                                                02900002
029100                                                                  02910002
029200*----------------------------------------------------------------*02920002
029300*    COPYBOOK FOR THE FIELDS PASSED TO THE TROUBLE SUBROUTINE     02930002
029400*----------------------------------------------------------------*02940002
029500                                                                  02950002
029600     COPY TMWS500.                                                02960002
029700/                                                                 02970002
029800                                                                  02980002
029900*----------------------------------------------------------------*02990002
030000*    MAP LAYOUT                                                  *03000002
030100*----------------------------------------------------------------*03010002
030200                                                                  03020002
030300     COPY RCKM240.                                                03030002
030400                                                                  03040002
030500/                                                                 03050002
030600*----------------------------------------------------------------*03060002
030700*    ATTRIBUTE SETTINGS COPYBOOK.                                *03070002
030800*----------------------------------------------------------------*03080002
030900                                                                  03090002
031000     COPY DPWS015.                                                03100002
031100                                                                  03110002
031200/                                                                 03120002
031300*----------------------------------------------------------------*03130002
031400*    FUNCTION KEYS COPYBOOK                                      *03140002
031500*----------------------------------------------------------------*03150002
031600                                                                  03160002
031700     COPY DPWS016.                                                03170002
031800                                                                  03180002
031900/                                                                 03190002
032000*----------------------------------------------------------------*03200002
032100*    THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT   *03210002
032200*    SUB-ROUTINE (POKUT100).                                     *03220002
032300*----------------------------------------------------------------*03230002
032400     COPY DPWS010I.                                               03240002
032500                                                                  03250002
032600/                                                                 03260002
032700******************************************************************03270008
032800** THE CALLING PARAMETER LIST (DPWS030/DPWS930) FOR THE CICS    **03280008
032900** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **03290008
033000******************************************************************03300008
033100     COPY DPWS030.                                                03310002
033110     COPY DPWS930.                                                03311008
033200                                                                  03320002
033300/                                                                 03330002
033400*----------------------------------------------------------------*03340002
033500*    STANDARD COMMAREA.                                          *03350002
033600*----------------------------------------------------------------*03360002
033700                                                                  03370002
033800     COPY DPWS020.                                                03380002
033900     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                03390002
034000                                                                  03400002
034100*----------------------------------------------------------------*03410002
034200*    INTER-APPLICATION COMMAREA.                                 *03420002
034300*----------------------------------------------------------------*03430002
034400                                                                  03440002
034500         10  INTER-APPL-COMM-AREA PIC X(200).                     03450002
034600     COPY PCWS000.                                                03460002
034700*----------------------------------------------------------------*03470002
034800*    SPECIFIC COMMMAREA FOR RCKCS240.                            *03480002
034900*----------------------------------------------------------------*03490002
035000         10  ASC-SPECIFIC-COMMAREA.                               03500002
035100             15  ASC-USE-SELECTION-QUEUE-IND                      03510002
035200                                            PIC X(01).            03520002
035300                 88  ASC-USE-SELECTION-QUEUE    VALUE 'Y'.        03530002
035400             15  ASC-SEL-QUEUE-NAME         PIC X(08).            03540002
035500             15  ASC-NUMBER-OF-TS-ITEMS     PIC S9(05) COMP-3.    03550002
035600             15  ASC-NUMBER-OF-SELECTED-ITEMS                     03560002
035700                                            PIC S9(09) COMP-3.    03570002
035800             15  ASC-SEL-SUB                PIC S9(04) COMP.      03580002
035900             15  ASC-SEL-ITEM               PIC S9(04) COMP.      03590002
036000             15  ASC-CURRENT-DATE           PIC X(10).            03600002
036100             15  ASC-ACTION-SW              PIC X(03).            03610002
036200                 88  ASC-UPDATE-PENDING     VALUE 'UPD'.          03620002
036300             15  ASC-KEY-FIELDS.                                  03630002
036400** CHG0094517  CHANGED PO-NBR LENGTH FROM 7 TO 8                  03640005
036500                 20  ASC-KEY-PO-NBR         PIC 9(08).            03650005
036600                 20  ASC-KEY-PO-LNE-NBR     PIC S9(09) COMP.      03660002
036700                 20  ASC-KEY-REC-SEQ-NBR    PIC 9(04).            03670002
036800                 20  ASC-KEY-OPER-UNT-ID    PIC S9(4)  COMP.      03680002
036900                 20  ASC-KEY-FCLTY-ID       PIC S9(4)  COMP.      03690002
037000             15  ASC-SCREEN-FIELDS.                               03700002
037100                 20  ASC-OPER-UNT-ID        PIC S9(4)  COMP.      03710002
037200                 20  ASC-FCLTY-ID           PIC S9(4)  COMP.      03720002
037300                 20  ASC-FCLTY-DESC         PIC X(25).            03730002
037400                 20  ASC-RECEIVER.                                03740002
037500** CHG0094517  CHANGED PO-NBR LENGTH FROM 7 TO 8                  03750005
037600                     25  ASC-PO-NBR         PIC 9(08).            03760005
037700                     25  ASC-REC-DASH       PIC X(01).            03770002
037800                     25  ASC-REC-SEQ-NBR    PIC 9(04).            03780002
037900                 20  ASC-CREATED-BY-UID     PIC X(08).            03790002
038000                 20  ASC-CREATED-BY-DTE     PIC X(10).            03800002
038100                 20  ASC-CREATED-BY-TME     PIC X(05).            03810002
038200                 20  ASC-PO-LNE-NBR.                              03820002
038300                     25  ASC-PO-LNE-NBR-N   PIC 9(04).            03830002
038400                 20  ASC-LAST-UPD-BY-UID    PIC X(08).            03840002
038500                 20  ASC-LAST-UPD-BY-DTE    PIC X(10).            03850002
038600                 20  ASC-LAST-UPD-BY-TME    PIC X(05).            03860002
038700                 20  ASC-STATUS-DESC        PIC X(10).            03870002
038800                 20  ASC-TROUBLE-DESC       PIC X(26).            03880002
038900                 20  ASC-INNR-PACK-QTY.                           03890002
039000                     25  ASC-INNR-PACK-QTY-N                      03900002
039100                                            PIC 9(03).            03910002
039200                 20  FILLER                 PIC X(06).            03920002
039300                 20  ASC-CASE-PACK-QTY.                           03930002
039400                     25  ASC-CASE-PACK-QTY-N                      03940002
039500                                            PIC 9(03).            03950002
039600                 20  ASC-GP-QTY             PIC 9(03).            03960002
039700                 20  ASC-PRE-TKT-IND        PIC X(01).            03970002
039800                 20  ASC-DMG-ITM-QTY.                             03980002
039900                     25  ASC-DMG-ITM-QTY-N  PIC 9(04).            03990002
040000                 20  ASC-EXPTED-CART-CNT    PIC 9(04).            04000002
040100                 20  FILLER                 PIC X(06).            04010002
040200                 20  ASC-ACTL-CART-CNT      PIC 9(04).            04020002
040300                 20  ASC-TKT-TYP-DESC       PIC X(06).            04030002
040400                 20  ASC-RTV-IND            PIC X(01).            04040002
040500                 20  ASC-SKU.                                     04050002
040600                     25  ASC-DEPT-NBR       PIC X(03).            04060002
040700                     25  ASC-SKU-DASH-1     PIC X(01).            04070002
040800                     25  ASC-CLASS-NBR      PIC X(02).            04080002
040900                     25  ASC-SKU-DASH-2     PIC X(01).            04090002
041000                     25  ASC-SKU-SEQ-NBR    PIC X(03).            04100002
041100                 20  ASC-RTV-QTY.                                 04110002
041200                     25  ASC-RTV-QTY-N      PIC 9(05).            04120002
041300                 20  ASC-VEND-STYL-NAME     PIC X(20).            04130002
041400                 20  ASC-UNT-COST-AMT.                            04140002
041500                     25  ASC-UNT-COST-AMT-N PIC 9(05)V9(3).       04150002
041600                 20  ASC-COLOR-DESC         PIC X(25).            04160002
041700                 20  ASC-MTCH-TO-LINE.                            04170002
041800                     25  ASC-MTCH-TO-LINE-N PIC 9(04).            04180002
041900                 20  ASC-SIZE-DESC          PIC X(25).            04190002
042000             15  ASC-PURITM-VER-NBR         PIC S9(04) COMP.      04200002
042100             15  ASC-ITM-NBR                PIC S9(15) COMP-3.    04210002
042200             15  ASC-ENT-ID                 PIC S9(09) COMP.      04220002
042300             15  ASC-NOT-FOUND-SW           PIC X(01).            04230002
042400                 88  ASC-FOUND                         VALUE 'F'. 04240002
042500                 88  ASC-NOT-FOUND                     VALUE 'N'. 04250002
042600             15  ASC-CASEPACK-SW            PIC X(01).            04260002
042700                 88  ASC-CASEPACK-FOUND                VALUE 'Y'. 04270002
042800                 88  ASC-CASEPACK-NOT-FOUND            VALUE 'N'. 04280002
042900             15  ASC-CARTONS-SW             PIC X(01).            04290002
043000                 88  ASC-CARTONS-FOUND                 VALUE 'Y'. 04300002
043100                 88  ASC-CARTONS-NOT-FOUND             VALUE 'N'. 04310002
043200             15  ASC-DELETE-ITEM-SW         PIC X(01).            04320002
043300                 88  ASC-DELETE-ITEM                   VALUE 'D'. 04330002
043400             15  ASC-DELETED-SW             PIC X(01).            04340002
043500                 88  ASC-DELETED                       VALUE 'D'. 04350002
043600                 88  ASC-NOT-DELETED                   VALUE 'N'. 04360002
043700             15  ASC-RECITM-STATUS-CDE      PIC X(02).            04370002
043800                 88  ASC-RECITM-STATUS-CM-VE           VALUES     04380002
043900                     'CM', 'VE'.                                  04390002
044000             15 ASC-TRBL-FOUND-SW           PIC  X.               04400002
044100                 88 ASC-TRBL-EXISTS                    VALUE 'Y'. 04410002
044200                 88 ASC-NO-TRBL-EXISTS                 VALUE 'N'. 04420002
044300/                                                                 04430002
044400*----------------------------------------------------------------*04440002
044500*    ABEND PROCESSING COPYBOOK.                                  *04450002
044600*----------------------------------------------------------------*04460002
044700                                                                  04470002
044800     COPY DPWS013.                                                04480002
044900/                                                                 04490002
045000                                                                  04500002
045100*----------------------------------------------------------------*04510002
045200*    SYSTEM MESSAGE COPYBOOK                                     *04520002
045300*----------------------------------------------------------------*04530002
045400                                                                  04540002
045500     COPY DPRD507I.                                               04550002
045600/                                                                 04560002
045700                                                                  04570002
045800*----------------------------------------------------------------*04580002
045900*    DB2 SQL COMMUNICATION AREA                                   04590002
046000*----------------------------------------------------------------*04600002
046100     EXEC SQL                                                     04610002
046200          INCLUDE SQLCA                                           04620002
046300     END-EXEC.                                                    04630002
046400                                                                  04640002
046500/                                                                 04650002
046600******************************************************************04660002
046700*    CARTON MASTER                                                04670002
046800******************************************************************04680002
046900     EXEC SQL                                                     04690002
047000         INCLUDE SUT00024                                         04700002
047100     END-EXEC.                                                    04710002
047200/                                                                 04720002
047300******************************************************************04730002
047400*    CARTON UPC                                                   04740002
047500******************************************************************04750002
047600     EXEC SQL                                                     04760002
047700         INCLUDE SUT00028                                         04770002
047800     END-EXEC.                                                    04780002
047900/                                                                 04790002
048000*----------------------------------------------------------------*04800002
048100*    DB2 DCLGEN FOR THE PACK SLIP TABLE                           04810002
048200*----------------------------------------------------------------*04820002
048300     EXEC SQL                                                     04830002
048400          INCLUDE TPKSLIP                                         04840002
048500     END-EXEC.                                                    04850002
048600                                                                  04860002
048700/                                                                 04870002
048800*----------------------------------------------------------------*04880002
048900*    DB2 DCLGEN FOR THE PACK SLIP ITEM TABLE                      04890002
049000*----------------------------------------------------------------*04900002
049100     EXEC SQL                                                     04910002
049200          INCLUDE TPKITEM                                         04920002
049300     END-EXEC.                                                    04930002
049400                                                                  04940002
049500/                                                                 04950002
049600*----------------------------------------------------------------*04960002
049700*    DB2 DCLGEN FOR THE DISTRIBUTION HEADER TABLE                 04970002
049800*----------------------------------------------------------------*04980002
049900     EXEC SQL                                                     04990002
050000          INCLUDE TDISTHD                                         05000002
050100     END-EXEC.                                                    05010002
050200                                                                  05020002
050300/                                                                 05030002
050400*----------------------------------------------------------------*05040002
050500*    DB2 DCLGEN FOR THE UNMATCHED PACK SLIP ITEM TABLE            05050002
050600*----------------------------------------------------------------*05060002
050700     EXEC SQL                                                     05070002
050800          INCLUDE TUNPKSL                                         05080002
050900     END-EXEC.                                                    05090002
051000                                                                  05100002
051100/                                                                 05110002
051200*----------------------------------------------------------------*05120002
051300*    DB2 DCLGEN FOR THE RECEIVER TABLE                            05130002
051400*----------------------------------------------------------------*05140002
051500     EXEC SQL                                                     05150002
051600          INCLUDE TRECEIV                                         05160002
051700     END-EXEC.                                                    05170002
051800                                                                  05180002
051900/                                                                 05190002
052000*----------------------------------------------------------------*05200002
052100*    DB2 DCLGEN FOR THE RECEIVER ITEM TABLE                       05210002
052200*----------------------------------------------------------------*05220002
052300     EXEC SQL                                                     05230002
052400          INCLUDE TRECITM                                         05240002
052500     END-EXEC.                                                    05250002
052600                                                                  05260002
052700/                                                                 05270002
052800*----------------------------------------------------------------*05280002
052900*    DB2 DCLGEN FOR THE RECEIVER DISTRIBUTION TABLE               05290002
053000*----------------------------------------------------------------*05300002
053100     EXEC SQL                                                     05310002
053200          INCLUDE TRECDIS                                         05320002
053300     END-EXEC.                                                    05330002
053400                                                                  05340002
053500/                                                                 05350002
053600*----------------------------------------------------------------*05360002
053700*    DB2 DCLGEN FOR PURCHASE ORDER TABLE                          05370002
053800*----------------------------------------------------------------*05380002
053900     EXEC SQL                                                     05390002
054000          INCLUDE TPURCHS                                         05400002
054100     END-EXEC.                                                    05410002
054200                                                                  05420002
054300/                                                                 05430002
054400*----------------------------------------------------------------*05440002
054500*    DB2 DCLGEN FOR PURCHASE ORDER STATUS CODE TABLE              05450002
054600*----------------------------------------------------------------*05460002
054700     EXEC SQL                                                     05470002
054800          INCLUDE TSTATCD                                         05480002
054900     END-EXEC.                                                    05490002
055000                                                                  05500002
055100/                                                                 05510002
055200*----------------------------------------------------------------*05520002
055300*    DB2 DCLGEN FOR PURCHASE ORDER LINE ITEM TABLE                05530002
055400*----------------------------------------------------------------*05540002
055500     EXEC SQL                                                     05550002
055600          INCLUDE TPURITM                                         05560002
055700     END-EXEC.                                                    05570002
055800                                                                  05580002
055900*----------------------------------------------------------------*05590002
056000*    DB2 DCLGEN FOR THE TROUBLE NOTIFICATION TABLE                05600002
056100*----------------------------------------------------------------*05610002
056200     EXEC SQL                                                     05620002
056300          INCLUDE TTRBNTF                                         05630002
056400     END-EXEC.                                                    05640002
056500                                                                  05650002
056600*----------------------------------------------------------------*05660002
056700*    DB2 DCLGEN FOR THE TROUBLE REASON CODE TABLE                 05670002
056800*----------------------------------------------------------------*05680002
056900     EXEC SQL                                                     05690002
057000          INCLUDE TTRBRSN                                         05700002
057100     END-EXEC.                                                    05710002
057200                                                                  05720002
057300*----------------------------------------------------------------*05730002
057400*    DB2 DCLGEN FOR THE WORK ORDER TABLE                          05740002
057500*----------------------------------------------------------------*05750002
057600     EXEC SQL                                                     05760002
057700          INCLUDE TWRKORD                                         05770002
057800     END-EXEC.                                                    05780002
057900                                                                  05790002
058000*----------------------------------------------------------------*05800002
058100*    DB2 DCLGEN FOR THE WORK ORDER INSTRUCTION TABLE              05810002
058200*----------------------------------------------------------------*05820002
058300     EXEC SQL                                                     05830002
058400          INCLUDE TWKORIN                                         05840002
058500     END-EXEC.                                                    05850002
058600                                                                  05860002
059400*----------------------------------------------------------------*05940002
059500*    DB2 DCLGEN FOR THE ODD UNIT TABLE                            05950002
059600*----------------------------------------------------------------*05960002
059700     EXEC SQL                                                     05970002
059800          INCLUDE RCT00009                                        05980002
059900     END-EXEC.                                                    05990002
060000                                                                  06000002
060100/                                                                 06010002
060200 LINKAGE SECTION.                                                 06020002
060300                                                                  06030002
060400 01  DFHCOMMAREA.                                                 06040002
060500     05  FILLER                       OCCURS  1 TO 4072 TIMES     06050002
060600                                      DEPENDING ON EIBCALEN.      06060002
060700         10  FILLER                   PIC X.                      06070002
060800                                                                  06080002
060900/                                                                 06090002
061000 PROCEDURE DIVISION.                                              06100002
061100                                                                  06110002
061200*----------------------------------------------------------------*06120002
061300*    THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. *06130002
061400*    THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  *06140002
061500*    MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            *06150002
061600*                                                                *06160002
061700*    THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  *06170002
061800*    LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       *06180002
061900*----------------------------------------------------------------*06190002
062000 0000-MAIN-MODULE.                                                06200002
062100                                                                  06210002
062200     INITIALIZE DP030-CICS-API-FIELDS.                            06220002
062300     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       06230002
062400     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          06240002
062500     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         06250002
062600     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       06260002
062700     MOVE LENGTH OF RC240AI        TO DP030-MAP-LENGTH (1).       06270002
062800     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     06280002
062900     PERFORM 0001-CALL-CICS-ARCH-API.                             06290002
063000                                                                  06300002
063100     PERFORM 1000-CONTROL-PROCESSING.                             06310002
063200                                                                  06320002
063300     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     06330002
063400     PERFORM 0001-CALL-CICS-ARCH-API.                             06340002
063500                                                                  06350002
063600/                                                                 06360002
063700 0001-CALL-CICS-ARCH-API.                                         06370002
063800                                                                  06380002
063910     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      06391008
064000                                    DFHCOMMAREA                   06400008
064100                                    DP030-CICS-API-FIELDS         06410008
064200                                    DP020-STANDARD-COMMAREA       06420008
064300                                    RC240AI.                      06430008
064400                                                                  06440002
064500     IF  DP030-RC-CALL-SUCCESSFUL                                 06450002
064600         CONTINUE                                                 06460002
064700     ELSE                                                         06470002
064800         SET DP013-NO-ROLLBACK                                    06480002
064900             DP013-XCTL-DISPLAY-RESTART                           06490002
065000             DP013-CICS-ABEND      TO TRUE                        06500002
065100         MOVE 'BEFORE 0000-MAIN-MODULE'                           06510002
065200                                   TO DP013-PARAGRAPH             06520002
065220         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O06522008
065230-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      06523008
065500         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      06550002
065600         PERFORM DP013-0000-PROCESS-ABEND                         06560002
065700     END-IF.                                                      06570002
065800                                                                  06580002
065900/                                                                 06590002
066000*----------------------------------------------------------------*06600002
066100*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *06610002
066200*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *06620002
066300*----------------------------------------------------------------*06630002
066400                                                                  06640002
066500 1000-CONTROL-PROCESSING.                                         06650002
066600                                                                  06660002
066700     EVALUATE TRUE                                                06670002
066800         WHEN DP020-NEXT-ACT-INITIAL                              06680002
066900              INITIALIZE ASC-SPECIFIC-COMMAREA                    06690002
067000              PERFORM 1100-PROCESS-INTER-APPL-COMM                06700002
067100              PERFORM 4000-BUILD-INITIAL-PANEL                    06710002
067200                                                                  06720002
067300         WHEN DP020-NEXT-ACT-READ-MAP                             06730002
067400              PERFORM 2000-PROCESS-PANEL                          06740002
067500                                                                  06750002
067600         WHEN DP020-NEXT-ACT-RETURN                               06760002
067700             INITIALIZE ASC-SCREEN-FIELDS                         06770002
067800             MOVE ASC-KEY-PO-NBR   TO DK-PO-NBR                   06780002
067900                                      ASC-PO-NBR                  06790002
068000             MOVE ASC-KEY-PO-LNE-NBR                              06800002
068100                                   TO ASC-PO-LNE-NBR-N            06810002
068200                                      DK-PO-LNE-NBR               06820002
068300             MOVE ASC-KEY-REC-SEQ-NBR                             06830002
068400                                   TO ASC-REC-SEQ-NBR             06840002
068500                                      DK-REC-SEQ-NBR              06850002
068600                                                                  06860002
068700             MOVE ASC-KEY-OPER-UNT-ID                             06870002
068800                                   TO ASC-OPER-UNT-ID             06880002
068900                                                                  06890002
069000             MOVE ASC-KEY-FCLTY-ID TO ASC-FCLTY-ID                06900002
069100             PERFORM 4000-BUILD-INITIAL-PANEL                     06910002
069200                                                                  06920002
069300         WHEN OTHER                                               06930002
069400              SET DP013-LOGIC-ABEND                               06940002
069500                  DP013-NO-ROLLBACK                               06950002
069600                                   TO TRUE                        06960002
069700              MOVE '1000-CONTROL-PROCESSING'                      06970002
069800                                   TO DP013-PARAGRAPH             06980002
069900              MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'  06990002
070000                                   TO DP013-MESSAGE-TEXT(1)       07000002
070100              MOVE DP020-NEXT-APPL-ACTIVITY                       07010002
070200                                   TO DP013-MESSAGE-TEXT(2)       07020002
070300              PERFORM DP013-0000-PROCESS-ABEND                    07030002
070400     END-EVALUATE.                                                07040002
070500                                                                  07050002
070600/                                                                 07060002
070700*----------------------------------------------------------------*07070002
070800*    SAVE THE KEYS PASSED IN THE INTER-APPL COMMAREA             *07080002
070900*----------------------------------------------------------------*07090002
071000 1100-PROCESS-INTER-APPL-COMM.                                    07100002
071100                                                                  07110002
071200     SET PS-COMMAREA-VALID         TO TRUE.                       07120002
071300                                                                  07130002
071400     EVALUATE DP020-INT-APPL-FORMAT-IND                           07140002
071500         WHEN PC-INTER-APPL-UPDATE                                07150002
071600             IF PC000-SEL-QUEUE-NAME = 'RETURN  '                 07160002
071700                 SET DP020-NEXT-ACT-APPL-ERROR TO TRUE            07170002
071800             ELSE                                                 07180002
071900                 MOVE PC000-PO-NBR-N                              07190002
072000                                   TO ASC-KEY-PO-NBR              07200002
072100                 MOVE PC000-LINE-NBR-N                            07210002
072200                                   TO ASC-KEY-PO-LNE-NBR          07220002
072300                 MOVE PC000-ENT-ID                                07230002
072400                                   TO ASC-ENT-ID                  07240002
072500                 MOVE PC000-SEL-QUEUE-NAME                        07250002
072600                                   TO ASC-SEL-QUEUE-NAME          07260002
072700                 MOVE PC000-REC-SEQ-NBR-N                         07270002
072800                                   TO ASC-KEY-REC-SEQ-NBR         07280002
072900                 MOVE PC000-OPERATING-UNIT-ID                     07290002
073000                                   TO ASC-KEY-OPER-UNT-ID         07300002
073100                 MOVE PC000-FACILITY-ID                           07310002
073200                                   TO ASC-KEY-FCLTY-ID            07320002
073300                 MOVE PC000-NUMBER-OF-SELECTED-ITEMS              07330002
073400                                   TO ASC-NUMBER-OF-SELECTED-ITEMS07340002
073500                 MOVE PC000-NUMBER-OF-TS-ITEMS                    07350002
073600                                   TO ASC-NUMBER-OF-TS-ITEMS      07360002
073700                 MOVE PC016-MAX-ITEMS                             07370002
073800                                 TO ASC-SEL-SUB                   07380002
073900                 MOVE ZERO       TO ASC-SEL-ITEM                  07390002
074000             END-IF                                               07400002
074100                                                                  07410002
074200     END-EVALUATE.                                                07420002
074300                                                                  07430002
074400/                                                                 07440002
074500*----------------------------------------------------------------*07450002
074600*    DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA*07460002
074700*    ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT*07470002
074800*    USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE    *07480002
074900*    REST OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO      *07490002
075000*    INVALID FUNCTION KEYS CAN GET THIS FAR.                     *07500002
075100*----------------------------------------------------------------*07510002
075200                                                                  07520002
075300 2000-PROCESS-PANEL.                                              07530002
075400                                                                  07540002
075500     EVALUATE TRUE                                                07550002
075600                                                                  07560002
075700         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              07570002
075800         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              07580002
075900         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              07590002
076000             MOVE ASC-KEY-PO-NBR   TO PC000-PO-NBR-N              07600002
076100*                                                                 07610002
076200*----------------------------------------------------------------*07620002
076300             MOVE ASC-ENT-ID       TO PC000-ENT-ID                07630002
076400             MOVE ASC-KEY-PO-LNE-NBR                              07640002
076500                                   TO PC000-LINE-NBR-N            07650002
076600             MOVE ASC-SEL-QUEUE-NAME                              07660002
076700                                   TO PC000-SEL-QUEUE-NAME        07670002
076800             MOVE ASC-KEY-REC-SEQ-NBR                             07680002
076900                                   TO PC000-REC-SEQ-NBR-N         07690002
077000             MOVE ASC-KEY-OPER-UNT-ID                             07700002
077100                                   TO PC000-OPERATING-UNIT-ID     07710002
077200             MOVE ASC-KEY-FCLTY-ID TO PC000-FACILITY-ID           07720002
077300             MOVE ASC-NUMBER-OF-SELECTED-ITEMS                    07730002
077400                               TO PC000-NUMBER-OF-SELECTED-ITEMS  07740002
077500             MOVE ASC-NUMBER-OF-TS-ITEMS                          07750002
077600                                   TO PC000-NUMBER-OF-TS-ITEMS    07760002
077700                                                                  07770002
077800         WHEN DP020-SRC-AID = DP016-CLEAR                         07780002
077900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07790002
078000                                                                  07800002
078100         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     07810002
078200             INITIALIZE ASC-SCREEN-FIELDS                         07820002
078300             MOVE ASC-KEY-PO-NBR   TO DK-PO-NBR                   07830002
078400                                      ASC-PO-NBR                  07840002
078500             MOVE ASC-KEY-PO-LNE-NBR                              07850002
078600                                   TO ASC-PO-LNE-NBR-N            07860002
078700                                      DK-PO-LNE-NBR               07870002
078800             MOVE ASC-KEY-REC-SEQ-NBR                             07880002
078900                                   TO ASC-REC-SEQ-NBR             07890002
079000                                      DK-REC-SEQ-NBR              07900002
079100                                                                  07910002
079200             MOVE ASC-KEY-OPER-UNT-ID                             07920002
079300                                   TO ASC-OPER-UNT-ID             07930002
079400                                                                  07940002
079500             MOVE ASC-KEY-FCLTY-ID TO ASC-FCLTY-ID                07950002
079600             PERFORM 4000-BUILD-INITIAL-PANEL                     07960002
079700                                                                  07970002
079800         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             07980002
079900             IF ASC-USE-SELECTION-QUEUE                           07990002
080000                 PERFORM 2400-GET-NEXT-WO-RECORD                  08000002
080100                 PERFORM 4000-BUILD-INITIAL-PANEL                 08010002
080200             ELSE                                                 08020002
080300*                --- BOTTOM OF LIST ---                           08030002
080400                 MOVE PC-TSYMSG-00070                             08040002
080500                                 TO DP020-MSG-NUMBER              08050002
080600                 SET DP020-MSG-INFORMATIONAL                      08060002
080700                                 TO TRUE                          08070002
080800             END-IF                                               08080002
080900                                                                  08090002
081000         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             08100002
081100             IF ASC-USE-SELECTION-QUEUE                           08110002
081200                 PERFORM 2410-GET-PREV-WO-RECORD                  08120002
081300                 PERFORM 4000-BUILD-INITIAL-PANEL                 08130002
081400             ELSE                                                 08140002
081500*                --- TOP OF LIST ---                              08150002
081600                 MOVE PC-TSYMSG-00069                             08160002
081700                                 TO DP020-MSG-NUMBER              08170002
081800                 SET DP020-MSG-INFORMATIONAL                      08180002
081900                                 TO TRUE                          08190002
082000             END-IF                                               08200002
082100                                                                  08210002
082200         WHEN OTHER                                               08220002
082300              SET DP030-CONTINUE-GO                               08230002
082400                           TO TRUE                                08240002
082500              PERFORM 2100-CHECK-FUNCTION-KEY                     08250002
082600     END-EVALUATE.                                                08260002
082700                                                                  08270002
082800/                                                                 08280002
082900*----------------------------------------------------------------*08290002
083000*    ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED    *08300002
083100*    FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED*08310002
083200*    FROM THE CICS ARCHITECTURE API.                             *08320002
083300*----------------------------------------------------------------*08330002
083400                                                                  08340002
083500 2100-CHECK-FUNCTION-KEY.                                         08350002
083600                                                                  08360002
083700     EVALUATE TRUE                                                08370002
083800         WHEN DP020-SRC-AID = DP016-ENTER                         08380002
083900             CONTINUE                                             08390002
084000                                                                  08400002
084100         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              08410002
084200             IF ASC-RECITM-STATUS-CM-VE                           08420002
084300                 MOVE PC-TSYMSG-00929                             08430002
084400                                   TO DP020-MSG-NUMBER            08440002
084500                 SET DP020-MSG-FATAL                              08450002
084600                                   TO TRUE                        08460002
084700             ELSE                                                 08470002
084800                 PERFORM 6260-CHECK-OUTBOUND                      08480002
084900                 IF ASC-CASEPACK-FOUND                            08490002
085000                    MOVE PC-TSYMSG-01793                          08500002
085100                                     TO DP020-MSG-NUMBER          08510002
085200                    SET DP020-MSG-FATAL                           08520002
085300                                     TO TRUE                      08530002
085400                 ELSE                                             08540002
085500                    IF ASC-CARTONS-FOUND                          08550002
085600                        MOVE PC-TSYMSG-03394                      08560002
085700                                      TO DP020-MSG-NUMBER         08570002
085800                        SET DP020-MSG-FATAL                       08580002
085900                                      TO TRUE                     08590002
086000                    ELSE                                          08600002
086100                        PERFORM 2130-CHECK-PACK-BY-STORE          08610002
086200                        IF  PV-PACK-BY-ST-IND-YES                 08620002
086300                            MOVE PC-TSYMSG-00928                  08630002
086400                                          TO DP020-MSG-NUMBER     08640002
086500                            SET DP020-MSG-FATAL                   08650002
086600                                          TO TRUE                 08660002
086700                        ELSE                                      08670002
086800                            SET DP030-CONTINUE-GO                 08680002
086900                                          TO TRUE                 08690002
087000                            PERFORM 6000-PROCESS-REDISTRO         08700002
087100                        END-IF                                    08710002
087200                    END-IF                                        08720002
087300                 END-IF                                           08730002
087400             END-IF                                               08740002
087500         WHEN OTHER                                               08750002
087600             SET DP013-NO-ROLLBACK                                08760002
087700                 DP013-XCTL-DISPLAY-RESTART                       08770002
087800                 DP013-CICS-ABEND  TO TRUE                        08780002
087900             MOVE '2100-CHECK-FUNCTION-KEY'                       08790002
088000                                   TO DP013-PARAGRAPH             08800002
088100             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      08810002
088200                                   TO DP013-MESSAGE-TEXT (1)      08820002
088300             PERFORM DP013-0000-PROCESS-ABEND                     08830002
088400     END-EVALUATE.                                                08840002
088500                                                                  08850002
088600/                                                                 08860002
088700*----------------------------------------------------------------*08870002
088800*    GET THE CURRENT ROW FOR PROCESSING.                         *08880002
088900*----------------------------------------------------------------*08890002
089000                                                                  08900002
089100 2130-CHECK-PACK-BY-STORE.                                        08910002
089200     MOVE ASC-KEY-PO-NBR           TO PV-PO-NBR.                  08920002
089300     MOVE ASC-KEY-REC-SEQ-NBR      TO PV-REC-SEQ-NBR.             08930002
089400                                                                  08940002
089500     EXEC SQL                                                     08950002
089600          SELECT PACK_BY_ST_IND                                   08960002
089700            INTO :PV-PACK-BY-ST-IND                               08970002
089800            FROM TRECEIV                                          08980002
089900           WHERE ORD_NBR         =  :PV-PO-NBR                    08990002
090000             AND REC_SEQ_NBR     =  :PV-REC-SEQ-NBR               09000002
090100             AND OPER_UNT_ID     =  :ASC-KEY-OPER-UNT-ID          09010002
090200             AND FCLTY_ID        =  :ASC-KEY-FCLTY-ID             09020002
090300             AND VER_STATUS_CDE  =  :PC-A                         09030002
090400     END-EXEC.                                                    09040002
090500                                                                  09050002
090600     EVALUATE TRUE                                                09060002
090700         WHEN SQLCODE = ZERO                                      09070002
090800              CONTINUE                                            09080002
090900         WHEN SQLWARN0 NOT = SPACE                                09090002
091000         WHEN SQLCODE NOT = ZERO                                  09100002
091100              MOVE DK-PO-NBR           TO  PV-DISP-PO             09110003
091200              MOVE DK-REC-SEQ-NBR      TO  PV-DISP-RCVR           09120003
091300              MOVE SPACES  TO  DP013-MESSAGE-TEXT (2)             09130003
091400              STRING PV-DISP-PO   '-'                             09140003
091500                     PV-DISP-RCVR     DELIMITED BY SIZE           09150004
091600                         INTO  DP013-MESSAGE-TEXT (2)             09160003
091700                                                                  09170003
091800              MOVE '2130-CHECK-PACK-BY-STORE'                     09180002
091900                               TO DP013-PARAGRAPH                 09190002
092000              MOVE 'SELECT TRECEIV'                               09200002
092100                               TO DP013-MESSAGE-TEXT (1)          09210002
092200              MOVE SQLCA       TO DP013-SQLCA                     09220002
092300              MOVE 'TRECEIV '  TO DP013-DB2-TABLE-NAME (1)        09230002
092400              SET DP013-DB2-ABEND                                 09240002
092500                               TO TRUE                            09250002
092600              PERFORM DP013-0000-PROCESS-ABEND                    09260002
092700     END-EVALUATE.                                                09270002
092800/                                                                 09280002
092900                                                                  09290002
093000******************************************************************09300002
093100* GET THE KEYS OF THE NEXT SELECTED OBJECT FROM THE WO           *09310002
093200* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *09320002
093300******************************************************************09330002
093400 2400-GET-NEXT-WO-RECORD.                                         09340002
093500                                                                  09350002
093600     ADD +1                      TO ASC-SEL-SUB.                  09360002
093700                                                                  09370002
093800     IF ASC-SEL-SUB > RC013-MAX-ITEMS                             09380002
093900         ADD +1                  TO ASC-SEL-ITEM                  09390002
094000         MOVE +1                 TO ASC-SEL-SUB                   09400002
094100     END-IF.                                                      09410002
094200                                                                  09420002
094300     IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                 09430002
094400         PERFORM 9300-READ-WO-SEL-QUEUE                           09440002
094500         IF PC016-ITEM (ASC-SEL-SUB) > ZERO                       09450002
094600             MOVE PC016-LINE-NBR-N (ASC-SEL-SUB)                  09460002
094700                                 TO ASC-PO-LNE-NBR-N              09470002
094800             SET PC016-INQ (ASC-SEL-SUB)                          09480002
094900                                 TO TRUE                          09490002
095000             PERFORM 9400-REWRITE-WO-LIST-QUEUE                   09500002
095100         ELSE                                                     09510002
095200             SUBTRACT +1 FROM ASC-SEL-SUB                         09520002
095300*            --- BOTTOM OF LIST ---                               09530002
095400             MOVE PC-TSYMSG-00070                                 09540002
095500                                 TO DP020-MSG-NUMBER              09550002
095600             SET DP020-MSG-INFORMATIONAL                          09560002
095700                                 TO TRUE                          09570002
095800         END-IF                                                   09580002
095900     ELSE                                                         09590002
096000         SUBTRACT +1 FROM ASC-SEL-ITEM                            09600002
096100         MOVE PC016-MAX-ITEMS    TO ASC-SEL-SUB                   09610002
096200         MOVE PC-TSYMSG-00070    TO DP020-MSG-NUMBER              09620002
096300         SET DP020-MSG-INFORMATIONAL                              09630002
096400                                 TO TRUE                          09640002
096500     END-IF.                                                      09650002
096600                                                                  09660002
096700/                                                                 09670002
096800******************************************************************09680002
096900* GET THE KEYS OF THE PREVIOUS SELECTED WORK ORDER OBJECT FROM   *09690002
097000* THE INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                   *09700002
097100******************************************************************09710002
097200 2410-GET-PREV-WO-RECORD.                                         09720002
097300                                                                  09730002
097400     SUBTRACT +1 FROM ASC-SEL-SUB.                                09740002
097500                                                                  09750002
097600     IF ASC-SEL-SUB < +1                                          09760002
097700         SUBTRACT +1 FROM ASC-SEL-ITEM                            09770002
097800         MOVE PC016-MAX-ITEMS    TO ASC-SEL-SUB                   09780002
097900     END-IF.                                                      09790002
098000                                                                  09800002
098100     IF ASC-SEL-ITEM > ZERO                                       09810002
098200         PERFORM 9300-READ-WO-SEL-QUEUE                           09820002
098300         MOVE PC016-LINE-NBR-N (ASC-SEL-SUB)                      09830002
098400                                 TO ASC-PO-LNE-NBR-N              09840002
098500     ELSE                                                         09850002
098600         MOVE +1                 TO ASC-SEL-ITEM                  09860002
098700                                    ASC-SEL-SUB                   09870002
098800*        --- TOP OF LIST ---                                      09880002
098900         MOVE PC-TSYMSG-00069    TO DP020-MSG-NUMBER              09890002
099000         SET DP020-MSG-INFORMATIONAL                              09900002
099100                                 TO TRUE                          09910002
099200     END-IF.                                                      09920002
099300                                                                  09930002
099400 4000-BUILD-INITIAL-PANEL.                                        09940002
099500     MOVE ASC-KEY-PO-NBR         TO DK-PO-NBR.                    09950002
099600     MOVE ASC-PO-LNE-NBR-N       TO DK-PO-LNE-NBR.                09960002
099700     MOVE ASC-KEY-REC-SEQ-NBR    TO DK-REC-SEQ-NBR.               09970002
099800                                                                  09980002
099900     PERFORM 6250-GET-TDISTHD.                                    09990002
100000     PERFORM 4100-LOOK-FOR-TROUBLE.                               10000002
100100     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        10010002
100200/                                                                 10020002
100300 4100-LOOK-FOR-TROUBLE.                                           10030002
100400                                                                  10040002
100500     EXEC SQL                                                     10050002
100600         SELECT B.TRBL_SHT_DESC                                   10060002
100700         INTO :TRBRSN-TRBL-SHT-DESC                               10070002
100800         FROM  TTRBNTF A                                          10080002
100900              ,TTRBRSN B                                          10090002
101000         WHERE A.PO_NBR               = :DK-PO-NBR                10100002
101100               AND A.REC_SEQ_NBR      = :DK-REC-SEQ-NBR           10110002
101200               AND A.PO_LNE_NBR       = :DK-PO-LNE-NBR            10120002
101300               AND A.RESOLVED_IND IN (:PC-N, :PC-I)               10130002
101400               AND A.TRBL_RSN_CDE = B.TRBL_RSN_CDE                10140002
101500               AND B.PO_UPD_IND   = :PC-A                         10150002
101600     END-EXEC                                                     10160002
101700                                                                  10170002
101800     EVALUATE TRUE                                                10180002
101900         WHEN SQLCODE = ZERO                                      10190002
102000             SET ASC-TRBL-EXISTS           TO TRUE                10200002
102100         WHEN SQLCODE = -811                                      10210002
102200         WHEN SQLCODE = +100                                      10220002
102300             SET ASC-NO-TRBL-EXISTS        TO TRUE                10230002
102400         WHEN SQLWARN0 NOT = SPACE                                10240002
102500         WHEN SQLCODE < ZERO                                      10250002
102600         WHEN SQLCODE > ZERO                                      10260002
102700              MOVE DK-PO-NBR           TO  PV-DISP-PO             10270003
102800              MOVE DK-REC-SEQ-NBR      TO  PV-DISP-RCVR           10280003
102900              MOVE DK-PO-LNE-NBR       TO  PV-DISP-LINE           10290003
103000              MOVE SPACES  TO  DP013-MESSAGE-TEXT (2)             10300003
103100              STRING PV-DISP-PO   '-'                             10310003
103200                     PV-DISP-RCVR '-'                             10320003
103300                     PV-DISP-LINE    DELIMITED BY SIZE            10330004
103400                         INTO  DP013-MESSAGE-TEXT (2)             10340003
103500                                                                  10350003
103600             MOVE '4100-LOOK-FOR-TROUBLE'                         10360002
103700                             TO DP013-PARAGRAPH                   10370002
103800             MOVE 'SELECT ON TTRBNTF/TTRBRSN'                     10380002
103900                             TO DP013-MESSAGE-TEXT (1)            10390002
104000             MOVE SQLCA          TO DP013-SQLCA                   10400002
104100             MOVE 'TTRBNTF'      TO DP013-DB2-TABLE-NAME (1)      10410002
104200             MOVE 'TTRBRSN'      TO DP013-DB2-TABLE-NAME (2)      10420002
104300             SET DP013-DB2-ABEND                                  10430002
104400                 DP013-XCTL-DISPLAY-RESTART                       10440002
104500                             TO TRUE                              10450002
104600              PERFORM DP013-0000-PROCESS-ABEND                    10460002
104700     END-EVALUATE.                                                10470002
104800/                                                                 10480002
104900 4400-MOVE-COMMAREA-TO-SCREEN.                                    10490002
105000                                                                  10500002
105100     IF PC000-SEL-QUEUE-NAME NOT = 'RETURN  '                     10510002
105200         IF ASC-NO-TRBL-EXISTS                                    10520002
105300             MOVE PC-TSYMSG-01038                                 10530002
105400                              TO DP020-MSG-NUMBER                 10540002
105500             SET DP020-MSG-INFORMATIONAL                          10550002
105600                              TO TRUE                             10560002
105700         ELSE                                                     10570002
105800             MOVE PC-TSYMSG-01034                                 10580002
105900                              TO DP020-MSG-NUMBER                 10590002
106000             SET DP020-MSG-INFORMATIONAL                          10600002
106100                              TO TRUE                             10610002
106200         END-IF                                                   10620002
106300     END-IF.                                                      10630002
106400/                                                                 10640002
106500*----------------------------------------------------------------*10650002
106600* DETERMINE WHAT QUANITITY NEEDS TO BE REDISTROED AND PASS IT    *10660002
106700* FOR PROCESSING THRU THE TROUBLE AND REDISTRO ROUTINES.         *10670002
106800*----------------------------------------------------------------*10680002
106900 6000-PROCESS-REDISTRO.                                           10690002
107000                                                                  10700002
107100     PERFORM 6200-SELECT-RECITM-DATA.                             10710002
107200     IF RECITM-DTL-CK-ITM-QTY > ZEROS                             10720002
107300         MOVE RECITM-DTL-CK-ITM-QTY TO PV-BASE-DISTRO-QTY         10730002
107400     ELSE                                                         10740002
107500         MOVE RECITM-PKSL-ITM-QTY  TO PV-BASE-DISTRO-QTY          10750002
107600     END-IF.                                                      10760002
107700                                                                  10770002
107800     COMPUTE PV-DISTRO-QTY = PV-BASE-DISTRO-QTY -                 10780002
107900         (ASC-DMG-ITM-QTY-N + ASC-RTV-QTY-N).                     10790002
108000                                                                  10800002
108100     PERFORM 6300-CLEANUP-RECDIS.                                 10810002
108200                                                                  10820002
108300     PERFORM 6350-DELETE-ODD-UNIT.                                10830002
108400                                                                  10840002
108500     PERFORM 6100-CHECK-FOR-TROUBLE.                              10850002
108600                                                                  10860002
108700     IF PS-REDISTRO-OK                                            10870002
108800         PERFORM 6400-UPDATE-RECITM                               10880002
108900         IF TM500-IN-TROUBLE                                      10890002
109000* JAK 06/2007 - ADD WMS SPECIFIC MESSAGES                         10900002
109100***          MOVE PC-TSYMSG-00941        TO DP020-MSG-NUMBER      10910002
109200***          SET DP020-MSG-INFORMATIONAL TO TRUE                  10920002
109300             IF TM500-ASN-SENT-TO-WMS-YES                         10930002
109400                 MOVE PC-TSYMSG-03569        TO DP020-MSG-NUMBER  10940002
109500                 SET DP020-MSG-INFORMATIONAL TO TRUE              10950002
109600             ELSE                                                 10960002
109700                 MOVE PC-TSYMSG-00941        TO DP020-MSG-NUMBER  10970002
109800                 SET DP020-MSG-INFORMATIONAL TO TRUE              10980002
109900             END-IF                                               10990002
110000         ELSE                                                     11000002
110100***          MOVE PC-TSYMSG-00059        TO DP020-MSG-NUMBER      11010002
110200***          SET DP020-MSG-INFORMATIONAL TO TRUE                  11020002
110300             IF TM500-ASN-SENT-TO-WMS-YES                         11030002
110400                 MOVE PC-TSYMSG-03570        TO DP020-MSG-NUMBER  11040002
110500                 SET DP020-MSG-INFORMATIONAL TO TRUE              11050002
110600             ELSE                                                 11060002
110700                 MOVE PC-TSYMSG-00059        TO DP020-MSG-NUMBER  11070002
110800                 SET DP020-MSG-INFORMATIONAL TO TRUE              11080002
110900             END-IF                                               11090002
111000         END-IF                                                   11100002
111100     ELSE                                                         11110002
111200         MOVE PC-TSYMSG-00937        TO DP020-MSG-NUMBER          11120002
111300         SET DP020-MSG-INFORMATIONAL TO TRUE                      11130002
111400     END-IF.                                                      11140002
111500                                                                  11150002
111600 6100-CHECK-FOR-TROUBLE.                                          11160002
111700                                                                  11170002
111800     INITIALIZE TM500-FIELDS.                                     11180002
111900                                                                  11190002
112000     SET  TM500-CREATE-AUTO        TO TRUE.                       11200002
112100     SET  TM500-LINE-LEVEL         TO TRUE.                       11210002
112200     SET  TM500-NO-DETAILS         TO TRUE.                       11220002
112300     SET  TM500-REDISTRO-YES       TO TRUE.                       11230002
112400                                                                  11240002
112500     MOVE ASC-KEY-PO-NBR           TO TM500-PO-NBR.               11250002
112600     MOVE ASC-KEY-PO-LNE-NBR       TO TM500-PO-LNE-NBR.           11260002
112700     MOVE ASC-KEY-OPER-UNT-ID      TO TM500-OPER-UNT-ID.          11270002
112800     MOVE ASC-KEY-FCLTY-ID         TO TM500-FCLTY-ID.             11280002
112900     MOVE PV-DISTRO-QTY            TO TM500-UNITS-TO-ALLOC.       11290002
113000                                                                  11300002
113100     PERFORM 6150-GET-PURITM.                                     11310002
113200     IF PV-NBR-OF-PIC-AD > 0                                      11320002
113300        MOVE 'Y'                   TO TM500-AD-SW                 11330002
113400     ELSE                                                         11340002
113500        MOVE 'N'                   TO TM500-AD-SW.                11350002
113600                                                                  11360002
113700                                                                  11370002
113800*  TM500-RTV-SW IS LOADED BY TMKCS505 ONLY                        11380002
113900*    MOVE ASC-RTV-IND              TO TM500-RTV-SW.               11390002
114000     MOVE PC-CURRENT-PROGRAM-NAME  TO TM500-NOTIF-UID.            11400002
114100     MOVE ASC-KEY-REC-SEQ-NBR      TO TM500-REC-SEQ-NBR           11410002
114200                                                                  11420002
114300     SET PS-REDISTRO-OK            TO TRUE                        11430002
114400                                                                  11440002
114500     EXEC CICS                                                    11450002
114600         LINK PROGRAM  (PC-TROUBLE-RTN)                           11460002
114700              COMMAREA (TM500-FIELDS)                             11470002
114800              LENGTH   (PC-TROUBLE-RTN-LENGTH)                    11480002
114900     END-EXEC.                                                    11490002
115000                                                                  11500002
115100     EVALUATE TRUE                                                11510002
115200         WHEN TM500-CALL-SUCCESSFUL                               11520002
115300         WHEN TM500-DUPLICATE-TROUBLE                             11530002
115400         WHEN TM500-TTRBNTF-UPDATE-NOT-FND                        11540002
115500              IF TM500-IN-TROUBLE                                 11550002
115600                  ADD 1 TO PV-TROUBLE-COUNT                       11560002
115700              ELSE                                                11570002
115800                  ADD 1 TO PV-NOT-IN-TROUBLE-COUNT                11580002
115900              END-IF                                              11590002
116000                                                                  11600002
116100         WHEN TM500-DIDNT-ALLOC-DUE-TO-TRBL                       11610002
116200              SET PS-REDISTRO-NOT-OK TO TRUE                      11620002
116300                                                                  11630002
116400              IF TM500-IN-TROUBLE                                 11640002
116500                  ADD 1 TO PV-TROUBLE-COUNT                       11650002
116600              ELSE                                                11660002
116700                  ADD 1 TO PV-NOT-IN-TROUBLE-COUNT                11670002
116800              END-IF                                              11680002
116900                                                                  11690002
117000         WHEN OTHER                                               11700002
117100              MOVE '6100-CHECK-FOR-TROUBLE'                       11710002
117200                                    TO DP013-PARAGRAPH            11720002
117300              MOVE 'UNSUCCESSFUL CALL TO TROUBLE RTN'             11730002
117400                                    TO DP013-MESSAGE-TEXT (1)     11740002
117500              MOVE TM500-RETURN-MSG TO DP013-MESSAGE-TEXT (2)     11750002
117600              MOVE TM500-SQLCA      TO DP013-SQLCA                11760002
117700              SET DP013-DB2-ABEND                                 11770002
117800                  DP013-XCTL-DISPLAY-RESTART                      11780002
117900                                    TO TRUE                       11790002
118000              PERFORM DP013-0000-PROCESS-ABEND                    11800002
118100                                                                  11810002
118200     END-EVALUATE.                                                11820002
118300/                                                                 11830002
118400******************************************************************11840002
118500*    DETERMINE IF PO HAS A PICTURED AD                            11850002
118600******************************************************************11860002
118700 6150-GET-PURITM.                                                 11870002
118800                                                                  11880002
118900     MOVE ASC-KEY-PO-NBR           TO PV-PO-NBR.                  11890002
119000     MOVE ASC-KEY-REC-SEQ-NBR      TO PV-REC-SEQ-NBR              11900002
119100                                                                  11910002
119200     EXEC SQL                                                     11920002
119300          SELECT COUNT(*)                                         11930002
119400            INTO :PV-NBR-OF-PIC-AD                                11940002
119500            FROM TPURCHS A,                                       11950002
119600                 TPURITM B,                                       11960002
119700                 TRECITM C                                        11970002
119800           WHERE A.PO_NBR         = :PV-PO-NBR                    11980002
119900             AND A.VER_STATUS_CDE = 'A'                           11990002
120000             AND A.PO_NBR         = B.PO_NBR                      12000002
120100             AND A.PO_NBR         = C.ORD_NBR                     12010002
120200             AND B.PIC_ITM_IND    = 'Y'                           12020002
120300             AND C.ORD_LNE_NBR    = B.APP_PO_LNE_NBR              12030002
120400             AND C.PO_VER_NBR     = B.VER_NBR                     12040002
120500             AND C.VER_STATUS_CDE = 'A'                           12050002
120600             AND C.REC_SEQ_NBR    = :PV-REC-SEQ-NBR               12060002
120700                                                                  12070002
120800     END-EXEC.                                                    12080002
120900                                                                  12090002
121000     EVALUATE TRUE                                                12100002
121100         WHEN SQLCODE = +0                                        12110002
121200         WHEN SQLCODE = +100                                      12120002
121300              CONTINUE                                            12130002
121400         WHEN SQLWARN0 NOT = SPACES                               12140002
121500         WHEN SQLCODE < +0                                        12150002
121600         WHEN SQLCODE > +0                                        12160002
121700              MOVE DK-PO-NBR           TO  PV-DISP-PO             12170003
121800              MOVE DK-REC-SEQ-NBR      TO  PV-DISP-RCVR           12180003
121900              MOVE SPACES  TO  DP013-MESSAGE-TEXT (2)             12190003
122000              STRING PV-DISP-PO   '-'                             12200003
122100                     PV-DISP-RCVR     DELIMITED BY SIZE           12210004
122200                         INTO  DP013-MESSAGE-TEXT (2)             12220003
122300                                                                  12230003
122400              MOVE '6150-GET-PURITM'                              12240002
122500                               TO DP013-PARAGRAPH                 12250002
122600              MOVE 'UNSUCCESSFUL SELECT ON PO ITEM'               12260002
122700                               TO DP013-MESSAGE-TEXT (1)          12270002
122800              MOVE SQLCA       TO DP013-SQLCA                     12280002
122900              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)        12290002
123000              SET DP013-DB2-ABEND                                 12300002
123100                  DP013-XCTL-DISPLAY-RESTART                      12310002
123200                               TO TRUE                            12320002
123300              PERFORM DP013-0000-PROCESS-ABEND                    12330002
123400     END-EVALUATE.                                                12340002
123500                                                                  12350002
123600                                                                  12360002
123700******************************************************************12370002
123800*    SELECT RECEIVER ITEM DATA                                    12380002
123900******************************************************************12390002
124000                                                                  12400002
124100 6200-SELECT-RECITM-DATA.                                         12410002
124200     MOVE ASC-KEY-PO-NBR   TO DK-PO-NBR.                          12420002
124300     MOVE ASC-KEY-PO-LNE-NBR                                      12430002
124400                           TO DK-PO-LNE-NBR.                      12440002
124500     MOVE ASC-KEY-REC-SEQ-NBR                                     12450002
124600                           TO DK-REC-SEQ-NBR.                     12460002
124700                                                                  12470002
124800     EXEC SQL                                                     12480002
124900           SELECT PKSL_ITM_QTY                                    12490002
125000                , DTL_CK_ITM_QTY                                  12500002
125100             INTO :RECITM-PKSL-ITM-QTY                            12510002
125200                , :RECITM-DTL-CK-ITM-QTY                          12520002
125300             FROM TRECITM                                         12530002
125400            WHERE ORD_NBR            = :DK-PO-NBR                 12540002
125500              AND ORD_LNE_NBR        = :DK-PO-LNE-NBR             12550002
125600              AND REC_SEQ_NBR        = :DK-REC-SEQ-NBR            12560002
125700              AND OPER_UNT_ID        = :ASC-KEY-OPER-UNT-ID       12570002
125800              AND FCLTY_ID           = :ASC-KEY-FCLTY-ID          12580002
125900              AND VER_STATUS_CDE = :PC-ACTIVE                     12590002
126000     END-EXEC                                                     12600002
126100                                                                  12610002
126200     EVALUATE TRUE                                                12620002
126300         WHEN SQLCODE = ZERO                                      12630002
126400              CONTINUE                                            12640002
126500         WHEN SQLWARN0 NOT = SPACES                               12650002
126600         WHEN SQLCODE      NOT = ZERO                             12660002
126700              MOVE DK-PO-NBR           TO  PV-DISP-PO             12670003
126800              MOVE DK-REC-SEQ-NBR      TO  PV-DISP-RCVR           12680003
126900              MOVE DK-PO-LNE-NBR       TO  PV-DISP-LINE           12690003
127000              MOVE SPACES  TO  DP013-MESSAGE-TEXT (2)             12700003
127100              STRING PV-DISP-PO   '-'                             12710003
127200                     PV-DISP-RCVR '-'                             12720003
127300                     PV-DISP-LINE     DELIMITED BY SIZE           12730004
127400                         INTO  DP013-MESSAGE-TEXT (2)             12740003
127500                                                                  12750003
127600              MOVE '6200-SELECT-RECITM-DATA'                      12760002
127700                             TO DP013-PARAGRAPH                   12770002
127800              MOVE 'UNSUCCESSFUL SELECT OF RECITM HEADER DATA'    12780002
127900                             TO DP013-MESSAGE-TEXT (1)            12790002
128000              MOVE SQLCA         TO DP013-SQLCA                   12800002
128100              MOVE 'TRECITM' TO DP013-DB2-TABLE-NAME (1)          12810002
128200              SET DP013-DB2-ABEND                                 12820002
128300                  DP013-XCTL-DISPLAY-RESTART                      12830002
128400                             TO TRUE                              12840002
128500                                                                  12850002
128600              PERFORM DP013-0000-PROCESS-ABEND                    12860002
128700     END-EVALUATE.                                                12870002
128800 6250-GET-TDISTHD.                                                12880002
128900                                                                  12890002
129000     MOVE ASC-KEY-PO-NBR   TO DK-PO-NBR.                          12900002
129100     MOVE ASC-KEY-PO-LNE-NBR                                      12910002
129200                           TO DK-PO-LNE-NBR.                      12920002
129300     MOVE ASC-KEY-REC-SEQ-NBR                                     12930002
129400                           TO DK-REC-SEQ-NBR.                     12940002
129500         EXEC SQL                                                 12950002
129600             SELECT TOT_CART_CNT                                  12960002
129700             INTO   :DISTHD-TOT-CART-CNT                          12970002
129800             FROM  TDISTHD                                        12980002
129900          WHERE ORD_NBR          =  :DK-PO-NBR                    12990002
130000          AND   ORD_LNE_NBR      =  :DK-PO-LNE-NBR                13000002
130100          AND   RCVR_SEQ_NBR     =  :DK-REC-SEQ-NBR               13010002
130200          AND   TOT_CART_CNT     >  0                             13020002
130300         END-EXEC.                                                13030002
130400                                                                  13040002
130500     EVALUATE TRUE                                                13050002
130600           WHEN SQLCODE = +0                                      13060002
130700                SET ASC-CASEPACK-FOUND TO TRUE                    13070002
130800           WHEN SQLCODE = +100                                    13080002
130900                SET ASC-CASEPACK-NOT-FOUND TO TRUE                13090002
131000           WHEN SQLWARN0 NOT = SPACES                             13100002
131100           WHEN SQLCODE  NOT = ZERO                               13110002
131200              MOVE DK-PO-NBR           TO  PV-DISP-PO             13120003
131300              MOVE DK-REC-SEQ-NBR      TO  PV-DISP-RCVR           13130003
131400              MOVE DK-PO-LNE-NBR       TO  PV-DISP-LINE           13140003
131500              MOVE SPACES  TO  DP013-MESSAGE-TEXT (2)             13150003
131600              STRING PV-DISP-PO   '-'                             13160003
131700                     PV-DISP-RCVR '-'                             13170003
131800                     PV-DISP-LINE     DELIMITED BY SIZE           13180004
131900                         INTO  DP013-MESSAGE-TEXT (2)             13190003
132000                                                                  13200003
132100                MOVE '6250-GET-TDISTHD'                           13210002
132200                               TO DP013-PARAGRAPH                 13220002
132300                MOVE 'UNSUCCESSFUL SELECT OF TDISTHD'             13230002
132400                               TO DP013-MESSAGE-TEXT (1)          13240002
132500                MOVE 'SEARCHING FOR CASEPACK'                     13250002
132600                               TO DP013-MESSAGE-TEXT (2)          13260002
132700                MOVE SQLCA     TO DP013-SQLCA                     13270002
132800                MOVE 'TDISTHD' TO DP013-DB2-TABLE-NAME (1)        13280002
132900                SET DP013-DB2-ABEND                               13290002
133000                      DP013-XCTL-DISPLAY-RESTART                  13300002
133100                                 TO TRUE                          13310002
133200                  PERFORM DP013-0000-PROCESS-ABEND                13320002
133300         END-EVALUATE.                                            13330002
133400                                                                  13340002
133500                                                                  13350002
133600 6260-CHECK-OUTBOUND.                                             13360002
133700                                                                  13370002
133800       MOVE ASC-KEY-PO-LNE-NBR TO DK-PO-LNE-NBR.                  13380002
133900       MOVE ASC-KEY-REC-SEQ-NBR TO DK-REC-SEQ-NBR.                13390002
134000       MOVE ASC-KEY-PO-NBR TO DK-PO-NBR.                          13400002
134100                                                                  13410002
134200         EXEC SQL                                                 13420002
134300             SELECT A.SHIPT_UNT_ID                                13430002
134400             INTO   :SUT00028-SHIPT-UNT-ID                        13440002
134500             FROM  SUT_OTBND_UPC A                                13450002
134600                 , SUT_OTBND_CART B                               13460002
134700           WHERE A.TRN_NBR              = :DK-PO-NBR              13470002
134800            AND  A.RCVR_SEQ_NBR         = :DK-REC-SEQ-NBR         13480002
134900            AND  A.TRN_LNE_NBR          = :DK-PO-LNE-NBR          13490002
135000            AND  A.SHIPT_UNT_ID         =  B.SHIPT_UNT_ID         13500002
135100            AND  B.ACTV_IND             =  'Y'                    13510002
135200         END-EXEC.                                                13520002
135300                                                                  13530002
135400     EVALUATE TRUE                                                13540002
135500           WHEN SQLCODE = +0                                      13550002
135600           WHEN SQLCODE = -811                                    13560002
135700                SET ASC-CARTONS-FOUND TO TRUE                     13570002
135800           WHEN SQLCODE = +100                                    13580002
135900                SET ASC-CARTONS-NOT-FOUND TO TRUE                 13590002
136000           WHEN SQLWARN0 NOT = SPACES                             13600002
136100           WHEN SQLCODE  NOT = ZERO                               13610002
136200              MOVE DK-PO-NBR           TO  PV-DISP-PO             13620003
136300              MOVE DK-REC-SEQ-NBR      TO  PV-DISP-RCVR           13630003
136400              MOVE DK-PO-LNE-NBR       TO  PV-DISP-LINE           13640003
136500              MOVE SPACES  TO  DP013-MESSAGE-TEXT (2)             13650003
136600              STRING PV-DISP-PO   '-'                             13660003
136700                     PV-DISP-RCVR '-'                             13670003
136800                     PV-DISP-LINE     DELIMITED BY SIZE           13680004
136900                         INTO  DP013-MESSAGE-TEXT (2)             13690003
137000                                                                  13700003
137100                MOVE '6260-CHECK-OUTBOUND'                        13710002
137200                               TO DP013-PARAGRAPH                 13720002
137300                MOVE 'UNSUCCESSFUL SELECT OF OUTBOUND TBL'        13730002
137400                               TO DP013-MESSAGE-TEXT (1)          13740002
137500                MOVE SQLCA     TO DP013-SQLCA                     13750002
137600                MOVE 'TOTNBND' TO DP013-DB2-TABLE-NAME (1)        13760002
137700                SET DP013-DB2-ABEND                               13770002
137800                      DP013-XCTL-DISPLAY-RESTART                  13780002
137900                                 TO TRUE                          13790002
138000                  PERFORM DP013-0000-PROCESS-ABEND                13800002
138100     END-EVALUATE.                                                13810002
138200                                                                  13820002
138300                                                                  13830002
138400 6300-CLEANUP-RECDIS.                                             13840002
138500                                                                  13850002
138600     EXEC SQL                                                     13860002
138700           DELETE                                                 13870002
138800             FROM TRECDIS                                         13880002
138900            WHERE ORD_NBR            = :DK-PO-NBR                 13890002
139000              AND ORD_LNE_NBR        = :DK-PO-LNE-NBR             13900002
139100              AND REC_SEQ_NBR        = :DK-REC-SEQ-NBR            13910002
139200              AND OPER_UNT_ID        = :ASC-KEY-OPER-UNT-ID       13920002
139300              AND FCLTY_ID           = :ASC-KEY-FCLTY-ID          13930002
139400     END-EXEC                                                     13940002
139500                                                                  13950002
139600     EVALUATE TRUE                                                13960002
139700         WHEN SQLCODE = ZERO                                      13970002
139800         WHEN SQLCODE = +100                                      13980002
139900              CONTINUE                                            13990002
140000         WHEN SQLWARN0 NOT = SPACES                               14000002
140100         WHEN SQLCODE      NOT = ZERO                             14010002
140200              MOVE DK-PO-NBR           TO  PV-DISP-PO             14020003
140300              MOVE DK-REC-SEQ-NBR      TO  PV-DISP-RCVR           14030003
140400              MOVE DK-PO-LNE-NBR       TO  PV-DISP-LINE           14040003
140500              MOVE SPACES  TO  DP013-MESSAGE-TEXT (2)             14050003
140600              STRING PV-DISP-PO   '-'                             14060003
140700                     PV-DISP-RCVR '-'                             14070003
140800                     PV-DISP-LINE     DELIMITED BY SIZE           14080004
140900                         INTO  DP013-MESSAGE-TEXT (2)             14090003
141000                                                                  14100003
141100              MOVE '6300-CLEANUP-RECIDS'                          14110002
141200                             TO DP013-PARAGRAPH                   14120002
141300              MOVE 'UNSUCCESSFUL DELETE OF RECDIS DATA'           14130002
141400                             TO DP013-MESSAGE-TEXT (1)            14140002
141500              MOVE SQLCA         TO DP013-SQLCA                   14150002
141600              MOVE 'TRECDIS' TO DP013-DB2-TABLE-NAME (1)          14160002
141700              SET DP013-DB2-ABEND                                 14170002
141800                  DP013-XCTL-DISPLAY-RESTART                      14180002
141900                             TO TRUE                              14190002
142000                                                                  14200002
142100              PERFORM DP013-0000-PROCESS-ABEND                    14210002
142200     END-EVALUATE.                                                14220002
142300                                                                  14230002
142400 6350-DELETE-ODD-UNIT.                                            14240002
142500                                                                  14250002
142600     EXEC SQL                                                     14260002
142700          DELETE                                                  14270002
142800            FROM RCT_VRFD_ODD_UNT                                 14280002
142900            WHERE PO_NBR         = :DK-PO-NBR                     14290002
143000              AND PO_LNE_NBR     = :DK-PO-LNE-NBR                 14300002
143100              AND RCVR_SEQ_NBR   = :DK-REC-SEQ-NBR                14310002
143200     END-EXEC.                                                    14320002
143300                                                                  14330002
143400     EVALUATE TRUE                                                14340002
143500         WHEN SQLCODE = ZERO                                      14350002
143600         WHEN SQLCODE = +100                                      14360002
143700              CONTINUE                                            14370002
143800                                                                  14380002
143900         WHEN SQLWARN0 NOT = SPACES                               14390002
144000         WHEN SQLCODE  NOT = ZERO                                 14400002
144100              MOVE '6350-DELETE-ODD-UNIT'                         14410002
144200                             TO DP013-PARAGRAPH                   14420002
144300              MOVE 'UNSUCCESSFUL DELETE OF RCT_VRFD_ODD_UNT'      14430002
144400                             TO DP013-MESSAGE-TEXT (1)            14440002
144500                                                                  14450002
144600              MOVE DK-PO-NBR      TO PV-PO-NBR-PIC9               14460002
144700              MOVE DK-REC-SEQ-NBR TO PV-REC-SEQ-NBR-PIC9          14470002
144800              MOVE DK-PO-LNE-NBR  TO PV-PO-LNE-NBR-PIC9           14480002
144900              STRING 'PO '                                        14490002
145000                     PV-PO-NBR-PIC9                               14500002
145100                     ' SEQ '                                      14510002
145200                     PV-REC-SEQ-NBR-PIC9                          14520002
145300                     ' LINE '                                     14530002
145400                     PV-PO-LNE-NBR-PIC9                           14540002
145500                     DELIMITED BY SIZE                            14550002
145600                     INTO DP013-MESSAGE-TEXT (2)                  14560002
145700              MOVE SQLCA     TO DP013-SQLCA                       14570002
145800              MOVE 'RCT00009' TO DP013-DB2-TABLE-NAME (1)         14580002
145900              SET DP013-DB2-ABEND                                 14590002
146000                  DP013-XCTL-DISPLAY-RESTART                      14600002
146100                             TO TRUE                              14610002
146200              PERFORM DP013-0000-PROCESS-ABEND                    14620002
146300     END-EVALUATE.                                                14630002
146400                                                                  14640002
146500                                                                  14650002
146600******************************************************************14660002
146700* UPDATE TRECITM WHEN REDISTRO IS SUCCESSFUL.                    *14670002
146800******************************************************************14680002
146900 6400-UPDATE-RECITM.                                              14690002
147000                                                                  14700002
147100     EXEC SQL                                                     14710002
147200           UPDATE TRECITM                                         14720002
147300              SET LAST_TRSCP_TMST   = CURRENT TIMESTAMP           14730002
147400                , LAST_TRSCP_USR_ID = :DP020-USERID               14740002
147500            WHERE ORD_NBR           = :PV-PO-NBR                  14750002
147600              AND ORD_LNE_NBR       = :ASC-KEY-PO-LNE-NBR         14760002
147700              AND REC_SEQ_NBR       = :PV-REC-SEQ-NBR             14770002
147800              AND VER_STATUS_CDE    = 'A'                         14780002
147900     END-EXEC.                                                    14790002
148000                                                                  14800002
148100     EVALUATE TRUE                                                14810002
148200         WHEN SQLCODE = ZERO                                      14820002
148300              CONTINUE                                            14830002
148400         WHEN SQLWARN0 NOT = SPACES                               14840002
148500         WHEN SQLCODE      NOT = ZERO                             14850002
148600              MOVE DK-PO-NBR           TO  PV-DISP-PO             14860003
148700              MOVE DK-REC-SEQ-NBR      TO  PV-DISP-RCVR           14870003
148800              MOVE ASC-KEY-PO-LNE-NBR  TO  PV-DISP-LINE           14880003
148900              MOVE SPACES  TO  DP013-MESSAGE-TEXT (2)             14890003
149000              STRING PV-DISP-PO   '-'                             14900003
149100                     PV-DISP-RCVR '-'                             14910003
149200                     PV-DISP-LINE     DELIMITED BY SIZE           14920004
149300                         INTO  DP013-MESSAGE-TEXT (2)             14930003
149400                                                                  14940003
149500              MOVE '6400-UPDATE-RECITM'                           14950002
149600                             TO DP013-PARAGRAPH                   14960002
149700              MOVE 'UNSUCCESSFUL UPDATE OF RECITM'                14970002
149800                             TO DP013-MESSAGE-TEXT (1)            14980002
149900              MOVE SQLCA         TO DP013-SQLCA                   14990002
150000              MOVE 'TRECITM' TO DP013-DB2-TABLE-NAME (1)          15000002
150100              SET DP013-DB2-ABEND                                 15010002
150200                  DP013-XCTL-DISPLAY-RESTART                      15020002
150300                             TO TRUE                              15030002
150400                                                                  15040002
150500              PERFORM DP013-0000-PROCESS-ABEND                    15050002
150600     END-EVALUATE.                                                15060002
150700                                                                  15070002
150800******************************************************************15080002
150900* READ AN ITEM FROM THE INPUT SELECTED WORK ORDER ITEMS          *15090002
151000* TEMP STORAGE QUEUE.                                            *15100002
151100******************************************************************15110002
151200 9300-READ-WO-SEL-QUEUE.                                          15120002
151300                                                                  15130002
151400     EXEC CICS                                                    15140002
151500         READQ TS                                                 15150002
151600             QUEUE (ASC-SEL-QUEUE-NAME)                           15160002
151700             INTO  (PC016-TS-SEL-REC)                             15170002
151800             ITEM  (ASC-SEL-ITEM)                                 15180002
151900             RESP  (PV-CICS-RESPONSE)                             15190002
152000     END-EXEC.                                                    15200002
152100                                                                  15210002
152200     IF PV-CICS-RESPONSE EQUAL DFHRESP(NORMAL)                    15220002
152300         CONTINUE                                                 15230002
152400     ELSE                                                         15240002
152500         SET DP013-LOGIC-ABEND                                    15250002
152600             DP013-NO-ROLLBACK   TO TRUE                          15260002
152700         MOVE '9300-READ-WO-SEL-QUEUE'                            15270002
152800                                 TO DP013-PARAGRAPH               15280002
152900         MOVE 'ATTEMPTING TO READ TO LIST SELECTIONS TS QUEUE'    15290002
153000                                 TO DP013-MESSAGE-TEXT (1)        15300002
153100         MOVE ASC-SEL-QUEUE-NAME TO MSG-QUEUE-NAME                15310002
153200         MOVE ASC-SEL-ITEM       TO MSG-SEL-ITEM                  15320002
153300         MOVE MSG-QUEUE-ITEM     TO DP013-MESSAGE-TEXT (2)        15330002
153400         MOVE PC000-PO-NBR-N     TO MSG1-PO-NBR                   15340002
153500         MOVE PC000-REC-SEQ-NBR-N                                 15350002
153600                                 TO MSG1-REC-SEQ-NBR-N            15360002
153700         MOVE PC000-OPERATING-UNIT-ID                             15370002
153800                                 TO MSG1-OPER-UNT-ID              15380002
153900         MOVE PC000-FACILITY-ID  TO MSG1-FACILITY-ID              15390002
154000         MOVE MSG1-PO-REC        TO DP013-MESSAGE-TEXT (3)        15400002
154100         PERFORM DP013-0000-PROCESS-ABEND                         15410002
154200     END-IF.                                                      15420002
154300                                                                  15430002
154400/                                                                 15440002
154500******************************************************************15450002
154600* UPDATE AN ITEM IN THE INPUT SELECTED WORK ORDER ITEMS          *15460002
154700* TEMP STORAGE QUEUE.                                            *15470002
154800******************************************************************15480002
154900 9400-REWRITE-WO-LIST-QUEUE.                                      15490002
155000     EXEC CICS                                                    15500002
155100          WRITEQ TS                                               15510002
155200              QUEUE   (ASC-SEL-QUEUE-NAME)                        15520002
155300              FROM    (PC016-TS-SEL-REC)                          15530002
155400              ITEM    (ASC-SEL-ITEM)                              15540002
155500              RESP    (PV-CICS-RESPONSE)                          15550002
155600              REWRITE                                             15560002
155700     END-EXEC.                                                    15570002
155800                                                                  15580002
155900     IF PV-CICS-RESPONSE NOT EQUAL DFHRESP(NORMAL)                15590002
156000         SET DP013-CICS-ABEND                                     15600002
156100             DP013-NO-ROLLBACK   TO TRUE                          15610002
156200         MOVE '9400-REWRITE-WO-LIST-QUEUE'                        15620002
156300                                 TO DP013-PARAGRAPH               15630002
156400         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   15640002
156500                                 TO DP013-MESSAGE-TEXT (1)        15650002
156600         PERFORM DP013-0000-PROCESS-ABEND                         15660002
156700     END-IF.                                                      15670002
156800/                                                                 15680002
156900*----------------------------------------------------------------*15690002
157000*    ABEND PROCESSOR MODULE                                      *15700002
157100*----------------------------------------------------------------*15710002
157200                                                                  15720002
157300     COPY DPPD013.                                                15730002
