000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.      MAKUT226.                                       00020000
000300 AUTHOR.          LINDA GRIESBACH.                                00030000
000400 INSTALLATION.    KOHLS DEPARTMENT STORES.                        00040000
000500                                                                  00050000
000600***************************************************************** 00060000
000700**  THIS PROGRAM PROCESSES LOCATION BRIDGING RECORDS FOR       ** 00070000
000800**  THE DISTRICT, WH, WH_ATTRIBUTES, STORE, STORE_ATTRIBUTES,  ** 00080000
000900**  WH_STORE_ASSIGN AND OUTLOC MESSAGES.                       ** 00090000
001000**                                                             ** 00100000
001100**  THE INPUT RECORDS TO THIS PROGRAM ARE GENERATED IN RMS.    ** 00110000
001200**  THE RMS SYSTEM VALIDATES THE INTEGRITY OF THE DATA BEING   ** 00120000
001300**  INSERTED AND UPDATED.                                      ** 00130000
001400**                                                             ** 00140000
001500**  THE DC EFF-END-TMST LOGIC AND/OR SEQUENCE OF PROCESSING    ** 00150000
001600**  IS BASED ON THE ASSUMPTION OF THE DCCLC CURSOR.  THIS      ** 00160000
001700**  CURSOR FETCHES DC/DS RELATIONSHIPS BASED ON THE FACT THAT  ** 00170000
001800**  THE LATEST RELATIONSHIP IS FETCHED FIRST I.E. IN           ** 00180000
001900**  OCCURRENCE 1.  THIS WAS DONE TO CORRESPOND TO THE LOGIC    ** 00190000
002000**  OF THE RMS LOCATION MESSAGES, WHICH ARE DATE DRIVEN.       ** 00200000
002100**                                                             ** 00210000
002200***************************************************************** 00220000
002300*---------------------------------------------------------------* 00230000
002400*    WR/PITS#     DATE        DESCRIPTION                       * 00240000
002500*    --------   ----------   ---------------------------------  * 00250000
002600*                            INSTALLATION                       * 00260000
002700*    WR38216    03/12/10     EFC2 CONVERSION-STORE SUPPRESSION  * 00270000
002800*    WR38972    08/18/10     MLOF PROJECT CHANGES.              * 00280000
002900*                            REMOVED THE EFC2 SUPPRESSION       * 00290000
003000*                            CHANGES.                           * 00300000
003100*                                         - COGNIZANT (SANDEEP) * 00310000
003200*    PB48739    12/26/14     MODIFIED PROGRAM TO MOVE WH CLOSE  * 00320000
003300*                            DATE INSTEAD OF MOVING STORE CLOSE * 00330000
003400*                            DATE TO ORG CLUSTER CLOSE DATE     * 00340000
003500*                            FIELD WHEN WH IS CLOSED ONE.       * 00350000
003600*                                         - COGNIZANT           * 00360000
003700*    PB53432     09/16/15    MODIFIED CODE TO ALWAYS INSERT NULL* 00370000
003800*                            INTO CLO_DTE (TORGCLT TABLE) FOR A * 00380000
003900*                            NEW STORE.                         * 00390000
004000*                                         - COGNIZANT           * 00400000
070941* CHG0205458     07/30/18    ORACLE LOGON STANDRD PROGRAM CHANGE* 00402003
070941*                                         - COGNIZANT           * 00404002
070941***************************************************************** 00406002
004100***************************************************************** 00410000
004200 ENVIRONMENT DIVISION.                                            00420000
004300 CONFIGURATION SECTION.                                           00430000
004400 SOURCE-COMPUTER.       IBM-3090.                                 00440000
004500 OBJECT-COMPUTER.       IBM-3090.                                 00450000
004600                                                                  00460000
004700 INPUT-OUTPUT SECTION.                                            00470000
004800 FILE-CONTROL.                                                    00480000
004900     SELECT ORG-FILE           ASSIGN TO INP01.                   00490000
005000     SELECT NOTIFY-FILE        ASSIGN TO OUT01.                   00500000
005010     SELECT ORACLE-LOGON-FILE  ASSIGN TO ORALOGON.                00501001
005100                                                                  00510000
005200 DATA DIVISION.                                                   00520000
005300 FILE SECTION.                                                    00530000
005400 FD  ORG-FILE                                                     00540000
005500     RECORDING MODE F                                             00550000
005600     LABEL RECORDS ARE OMITTED                                    00560000
005700     BLOCK CONTAINS 0 RECORDS.                                    00570000
005800 01  ORG-RECORD                       PIC  X(500).                00580000
005900                                                                  00590000
006000 FD  NOTIFY-FILE                                                  00600000
006100     RECORDING MODE F                                             00610000
006200     LABEL RECORDS OMITTED                                        00620000
006300     BLOCK CONTAINS 0 RECORDS.                                    00630000
006400 01  NOTIFY-RECORD                    PIC X(80).                  00640000
006500                                                                  00650000
006510 FD  ORACLE-LOGON-FILE                                            00651001
006520     RECORDING MODE IS F                                          00652001
006530     LABEL RECORDS ARE STANDARD                                   00653001
006540     BLOCK CONTAINS 0 RECORDS                                     00654001
006550     RECORD CONTAINS 80 CHARACTERS                                00655001
006560     DATA RECORDS IS OL-ORACLE-LOGON-RECORD.                      00656001
006570 01  OL-ORACLE-LOGON-RECORD          PIC X(80).                   00657001
006580                                                                  00658001
006600 WORKING-STORAGE SECTION.                                         00660000
006700 01  WS-SWITCHES.                                                 00670000
006710     05  PS-END-OF-LOGON-FILE-SW      PIC X(01) VALUE 'N'.        00671001
006720         88  PS-END-OF-LOGON-FILE               VALUE 'Y'.        00672001
006730     05  PS-END-OF-PROC-INST-FILE-SW  PIC X(01) VALUE 'N'.        00673001
006740         88  PS-END-OF-PROC-INST-FILE           VALUE 'Y'.        00674001
006750         88  PS-NOT-END-OF-PROC-INST-FILE       VALUE 'N'.        00675001
006760     05  PS-ORA-SRC-CTL-DONE-SW       PIC X(01) VALUE 'N'.        00676001
006770         88  PS-ORA-SRC-EMPTY                   VALUE 'Y'.        00677001
006800     05  WS-UPDATE-DATE-SW            PIC X(1)  VALUE 'N'.        00680000
006900         88  UPDATE-DATE-YES                    VALUE 'Y'.        00690000
007000         88  UPDATE-DATE-NO                     VALUE 'N'.        00700000
007100     05  WS-ORG-FILE-SW               PIC X(1)  VALUE 'N'.        00710000
007200         88  ORG-EOF                            VALUE 'Y'.        00720000
007300         88  ORG-NOT-EOF                        VALUE 'N'.        00730000
007400     05  WS-DC-SW                     PIC X(1)  VALUE 'N'.        00740000
007500         88  MORE-DCS                           VALUE 'Y'.        00750000
007600         88  NO-MORE-DCS                        VALUE 'N'.        00760000
007700     05  WS-TORGCLT-RCD-SW            PIC X(1)  VALUE 'N'.        00770000
007800         88  TORGCLT-RCD-EXISTS                 VALUE 'Y'.        00780000
007900         88  TORGCLT-RCD-DOES-NOT-EXIST         VALUE 'N'.        00790000
008000     05  WS-TORGCLC-RCD-SW            PIC X(1)  VALUE 'N'.        00800000
008100         88  TORGCLC-RCD-EXISTS                 VALUE 'Y'.        00810000
008200         88  TORGCLC-RCD-DOES-NOT-EXIST         VALUE 'N'.        00820000
008300     05  WS-TORGPHY-RCD-SW            PIC X(1)  VALUE 'N'.        00830000
008400         88  TORGPHY-RCD-EXISTS                 VALUE 'Y'.        00840000
008500         88  TORGPHY-RCD-DOES-NOT-EXIST         VALUE 'N'.        00850000
008600     05  WS-TORGPHY-SEC-RCD-SW        PIC X(1)  VALUE 'N'.        00860000
008700         88  TORGPHY-SEC-RCD-EXISTS             VALUE 'Y'.        00870000
008800         88  TORGPHY-SEC-RCD-DOES-NOT-EXIST     VALUE 'N'.        00880000
008900     05  WS-TPHYLOC-RCD-SW            PIC X(1)  VALUE 'N'.        00890000
009000         88  TPHYLOC-RCD-EXISTS                 VALUE 'Y'.        00900000
009100         88  TPHYLOC-RCD-DOES-NOT-EXIST         VALUE 'N'.        00910000
009200     05  WS-TORGCLT-SELECT-SW         PIC X(1)  VALUE '0'.        00920000
009300         88  TORGCLT-HIER-CDE                   VALUE '1'.        00930000
009400         88  TORGCLT-ORG-TYP-CDE                VALUE '2'.        00940000
009500         88  TORGCLT-OTHERS                     VALUE '3'.        00950000
009600     05  WS-TORGCLC-SELECT-SW         PIC X(1)  VALUE '0'.        00960000
009700         88  TORGCLC-EXPIRED-TMST               VALUE '1'.        00970000
009800         88  TORGCLC-ACTIVE-TMST                VALUE '2'.        00980000
009900                                                                  00990000
009910 01  CC-ORACLE-CONNECTION.                                        00991001
009920     05  CC-ORACLE-USERID             PIC X(40).                  00992001
009930         88 CC-AUTO-LOGON                       VALUE '/'.        00993001
009940     05  CC-ORACLE-PASSWORD           PIC X(40).                  00994001
009950                                                                  00995001
010000 01  WS-CONSTANTS.                                                01000000
010010     05  PC-AUTO-LOGON                PIC X(01) VALUE '/'.        01001001
010100     05  WS-DEFAULT-DC                PIC 9(4)  VALUE 0899.       01010000
010200     05  WS-CENTRAL-STOCK             PIC X(2)  VALUE 'CS'.       01020000
010300     05  WS-DISTRIBUTION-CENTER       PIC X(2)  VALUE 'DC'.       01030000
010400     05  WS-STORE                     PIC X(2)  VALUE 'DS'.       01040000
010500     05  WS-NON-MERCHANDISE           PIC X(2)  VALUE 'ND'.       01050000
010600     05  WS-RETURN-TO-VENDOR          PIC X(2)  VALUE 'RV'.       01060000
010700     05  WS-VENDOR                    PIC X(2)  VALUE 'VN'.       01070000
010800     05  WS-STORE-TABLE               PIC X(30) VALUE             01080000
010900        'STORE                         '.                         01090000
011000     05  WS-STORE-ATTRIBUTES-TABLE    PIC X(30) VALUE             01100000
011100        'STORE_ATTRIBUTES              '.                         01110000
011200     05  WS-DISTRICT-TABLE            PIC X(30) VALUE             01120000
011300        'DISTRICT                      '.                         01130000
011400     05  WS-OUTLOC-TABLE              PIC X(30) VALUE             01140000
011500        'OUTLOC                        '.                         01150000
011600     05  WS-WH-TABLE                  PIC X(30) VALUE             01160000
011700        'WH                            '.                         01170000
011800     05  WS-WH-ATTRIBUTES-TABLE       PIC X(30) VALUE             01180000
011900        'WH_ATTRIBUTES                 '.                         01190000
012000     05  WS-WH-STORE-ASSIGN           PIC X(30) VALUE             01200000
012100        'WH_STORE_ASSIGN               '.                         01210000
012200     05  WS-DPKUT500                  PIC X(8)  VALUE             01220000
012300                                      'DPKUT500'.                 01230000
012400     05  WS-DEFAULT-DATE              PIC X(10) VALUE             01240000
012500                                      '9999-09-09'.               01250000
012600     05  WS-INITIAL-TMST              PIC X(19) VALUE             01260000
012700                                      '0000-00-00-00.00.00'.      01270000
012800     05  WS-INITIAL-END-TMST          PIC X(19) VALUE             01280000
012900                                      '0000-00-00-23.59.59'.      01290000
013000     05  WS-DIST-END-TMST             PIC X(19).                  01300000
013100     05  WS-MAX-SIZE                  PIC S9(9) COMP              01310000
013200                                                VALUE 512.        01320000
013300                                                                  01330000
013400 01  WS-VARIABLES.                                                01340000
013410     05  PV-ORACLE-USERID-LEN         PIC S9(04) VALUE ZEROS      01341001
013420                                                 COMP SYNC.       01342001
013430     05  PV-ORACLE-PASSWORD-LEN       PIC S9(04) VALUE ZEROS      01343001
013440                                                 COMP SYNC.       01344001
013500     05  WS-SUB                       PIC S9(3) COMP-3            01350000
013600                                                VALUE 0.          01360000
013700     05  WS-READ-COUNT                PIC S9(9) COMP-3            01370000
013800                                                VALUE 0.          01380000
013900     05  WS-NOTIFY-COUNT              PIC S9(9) COMP-3            01390000
014000                                                VALUE 0.          01400000
014100     05  WS-ABEND-CODE                PIC S9(4) COMP SYNC         01410000
014200                                                VALUE ZERO.       01420000
014300     05  WS-MSG-TEXT                  PIC X(512).                 01430000
014400     05  WS-MSG-LENGTH                PIC S9(9) COMP.             01440000
014500     05  WS-CURRENT-DATE.                                         01450000
014600         10  WS-CURRENT-DATE-CCYY     PIC X(04).                  01460000
014700         10  FILLER                   PIC X(01)  VALUE '-'.       01470000
014800         10  WS-CURRENT-DATE-MM       PIC X(02).                  01480000
014900         10  FILLER                   PIC X(01)  VALUE '-'.       01490000
015000         10  WS-CURRENT-DATE-DD       PIC X(02).                  01500000
015100     05  WS-DISTRICT                  PIC X(4).                   01510000
015200     05  WS-DISTRICT-N                PIC 9(4).                   01520000
015300     05  WS-DISTRICT-FINAL            PIC X(4).                   01530000
015400     05  WS-STORE-NBR                 PIC X(4).                   01540000
015500     05  WS-ZIP-CODE-X.                                           01550000
015600         10  WS-ZIP-CODE-X-1-9        PIC 9(9).                   01560000
015700         10  FILLER                   PIC X(11).                  01570000
015800     05  WS-ZIP-CODE-Y.                                           01580000
015900         10  WS-ZIP-CODE-Y-1-5        PIC X(5).                   01590000
016000         10  WS-ZIP-CODE-Y-6          PIC X(1).                   01600000
016100         10  WS-ZIP-CODE-Y-7-10       PIC X(4).                   01610000
016200     05  WS-CLUSTR-ID                 PIC S9(9)  COMP-3           01620000
016300                                                 VALUE 0.         01630000
016400     05  WS-PRNT-CLUSTR-ID            PIC S9(9)  COMP-3           01640000
016500                                                 VALUE 0.         01650000
016600     05  WS-REPL-CLUSTR-ID            PIC S9(9)  COMP-3           01660000
016700                                                 VALUE 0.         01670000
016800     05  WS-4-BYTE-IN-FLD             PIC X(4).                   01680000
016900     05  WS-4-BYTE-IN-FLD-RDF REDEFINES WS-4-BYTE-IN-FLD.         01690000
017000         10  WS-4-BYTE-IN-FLD-1-2     PIC X(2).                   01700000
017100         10  WS-4-BYTE-IN-FLD-3-4     PIC X(2).                   01710000
017200     05  WS-4-BYTE-IN-FLD-RDF2 REDEFINES WS-4-BYTE-IN-FLD.        01720000
017300         10  WS-4-BYTE-IN-FLD-1       PIC X(1).                   01730000
017400         10  WS-4-BYTE-IN-FLD-2-4     PIC X(3).                   01740000
017500     05  WS-DAYS                      PIC 9(5)  VALUE 0.          01750000
017600     05  WS-DATE-DEC-DAYS             PIC X(10).                  01760000
017700     05  WS-START-DATE                PIC X(10).                  01770000
017800     05  WS-HO100-WH-DATA.                                        01780000
017900         10  WS-HO100-WH              PIC X(4).                   01790000
018000         10  WS-HO100-WH-NAME         PIC X(20).                  01800000
018100         10  WS-HO100-WH-ADD1-1-25    PIC X(25).                  01810000
018200         10  WS-HO100-WH-ADD2-1-25    PIC X(25).                  01820000
018300         10  WS-HO100-WH-CITY-1-15    PIC X(15).                  01830000
018400         10  WS-HO100-WH-STATE-1-2    PIC X(2).                   01840000
018500         10  WS-HO100-WH-PCODE        PIC X(10).                  01850000
018600     05  WS-CLO-DTE                   PIC X(19).                  01860000
018700                                                                  01870000
018800 01  WS-MESSAGES.                                                 01880000
018900     05  WS-COULD-NOT-PROCESS-TABLE   PIC X(40) VALUE             01890000
019000         'COULD NOT PROCESS TABLE                 '.              01900000
019100     05  WS-COULD-NOT-INSERT-TORGCLT  PIC X(40) VALUE             01910000
019200         'COULD NOT INSERT RELATION ON ORGCLT     '.              01920000
019300     05  WS-COULD-NOT-INSERT-TORGCLC  PIC X(40) VALUE             01930000
019400         'COULD NOT INSERT RELATION ON ORGCLC     '.              01940000
019500     05  WS-CORP-NOT-FOUND            PIC X(40) VALUE             01950000
019600         'CORP NOT FOUND ON ORGCLT                '.              01960000
019700     05  WS-DISTRICT-NOT-FOUND        PIC X(40) VALUE             01970000
019800         'DISTRICT NOT FOUND ON ORGCLT            '.              01980000
019900     05  WS-DC-NOT-FOUND              PIC X(40) VALUE             01990000
020000         'DC NOT FOUND ON ORGCLT                  '.              02000000
020100     05  WS-DISTRICT-INSERTED         PIC X(40) VALUE             02010000
020200         'DIST INSERT ORGCLT-UPDATE PHYLOC/ORGPHY '.              02020000
020300                                                                  02030000
020400 01  WS-DC-TABLE.                                                 02040000
020500     05  WS-DC                        OCCURS 2 TIMES.             02050000
020600         10  WS-DC-CLUSTR-ID          PIC S9(9) COMP-3.           02060000
020700         10  WS-DC-ORG-CLUSTR-NAME    PIC X(20).                  02070000
020800         10  WS-DC-EFF-BEG-TMST       PIC X(19).                  02080000
020900         10  WS-DC-EFF-END-TMST       PIC X(19).                  02090000
021000                                                                  02100000
021100 01  WS-INPUT-NUMBER-IN.                                          02110000
021200     05  WS-INPUT-NBR-TBL             OCCURS 20 TIMES             02120000
021300             INDEXED BY IN-IDX.                                   02130000
021400         10  WS-INPUT-DIGIT-IN        PIC X(1).                   02140000
021500 01  WS-OUTPUT-NUMBER-OUT.                                        02150000
021600     05  WS-OUTPUT-NBR-TBL            OCCURS 20 TIMES             02160000
021700             INDEXED BY OUT-IDX.                                  02170000
021800         10  WS-OUTPUT-DIGIT-OUT      PIC X(1).                   02180000
021900                                                                  02190000
022000 01  WS-NOTIFY-RECORD.                                            02200000
022100     05  WS-NOTIFY-MSG                PIC X(40).                  02210000
022200     05  WS-NOTIFY-DATA1              PIC X(20).                  02220000
022300     05  WS-NOTIFY-DATA2              PIC X(20).                  02230000
022400                                                                  02240000
022500     COPY HORD100.                                                02250000
022600                                                                  02260000
022700                                                                  02270000
022800*******************************************************           02280000
022900*   WORK AREA PASSED TO/FROM DPKUT500                             02290000
023000*******************************************************           02300000
023100     COPY DPWS500.                                                02310000
023200                                                                  02320000
023300                                                                  02330000
023400     EXEC SQL BEGIN DECLARE SECTION END-EXEC.                     02340000
023500                                                                  02350000
023600 01      AUTO-ORACLE-ID               PIC X          VALUE '/'.   02360000
023700 01      USERNAME                     PIC X(10)      VARYING.     02370000
023800 01      PASSWD                       PIC X(10)      VARYING.     02380000
023900 01      WS-CURRENT-END-TMST          PIC X(19)      VALUE SPACES.02390000
024000 01      WS-ORGCLC-EFF-BEG-TMST       PIC X(19)      VALUE SPACES.02400000
024100                                                                  02410000
024200                                                                  02420000
024300*    TORGCLT NULL INDICATORS                                      02430000
024400 01      WS-ORG-CLUSTR-NAME-5-NULL    PIC S9(04)     COMP SYNC    02440000
024500                                                     VALUE +0.    02450000
024600 01      WS-ORG-CLUSTR-NAME-10-NULL   PIC S9(04)     COMP SYNC    02460000
024700                                                     VALUE +0.    02470000
024800 01      WS-CLT-EFF-END-TMST-NULL     PIC S9(04)     COMP SYNC    02480000
024900                                                     VALUE +0.    02490000
025000 01      WS-CLUSTR-TYP-CDE-NULL       PIC S9(04)     COMP SYNC    02500000
025100                                                     VALUE +0.    02510000
025200 01      WS-HIER-TYP-CDE-NULL         PIC S9(04)     COMP SYNC    02520000
025300                                                     VALUE +0.    02530000
025400 01      WS-HIER-CDE-NULL             PIC S9(04)     COMP SYNC    02540000
025500                                                     VALUE +0.    02550000
025600 01      WS-ORG-TYP-CDE-NULL          PIC S9(04)     COMP SYNC    02560000
025700                                                     VALUE +0.    02570000
025800 01      WS-NMDSE-PO-BEG-TMST-NULL    PIC S9(04)     COMP SYNC    02580000
025900                                                     VALUE +0.    02590000
026000 01      WS-NMDSE-PO-END-TMST-NULL    PIC S9(04)     COMP SYNC    02600000
026100                                                     VALUE +0.    02610000
026200 01      WS-ARCH-DTE-NULL             PIC S9(04)     COMP SYNC    02620000
026300                                                     VALUE +0.    02630000
026400 01      WS-OWNER-ID-NULL             PIC S9(04)     COMP SYNC    02640000
026500                                                     VALUE +0.    02650000
026600 01      WS-OPN-DTE-NULL              PIC S9(04)     COMP SYNC    02660000
026700                                                     VALUE +0.    02670000
026800 01      WS-CLO-DTE-NULL              PIC S9(04)     COMP SYNC    02680000
026900                                                     VALUE +0.    02690000
027000 01      WS-REPL-ORG-CLUSTR-ID-NULL   PIC S9(04)     COMP SYNC    02700000
027100                                                     VALUE +0.    02710000
027200                                                                  02720000
027300*    TORGCLC NULL INDICATORS                                      02730000
027400 01      WS-CLC-EFF-END-TMST-NULL     PIC S9(04)     COMP SYNC    02740000
027500                                                     VALUE +0.    02750000
027600                                                                  02760000
027700*    TPHYLOC NULL INDICATORS                                      02770000
027800 01      WS-ADR-LNE2-DESC-NULL        PIC S9(04)     COMP SYNC    02780000
027900                                                     VALUE +0.    02790000
028000                                                                  02800000
028100     EXEC SQL                                                     02810000
028200        INCLUDE TORGCLT                                           02820000
028300     END-EXEC.                                                    02830000
028400                                                                  02840000
028500     EXEC SQL                                                     02850000
028600        INCLUDE TORGCLC                                           02860000
028700     END-EXEC.                                                    02870000
028800                                                                  02880000
028900     EXEC SQL                                                     02890000
029000        INCLUDE TPHYLOC                                           02900000
029100     END-EXEC.                                                    02910000
029200                                                                  02920000
029300     EXEC SQL                                                     02930000
029400        INCLUDE TORGPHY                                           02940000
029500     END-EXEC.                                                    02950000
029600                                                                  02960000
029700     EXEC SQL                                                     02970000
029800          VAR PHYLOC-OWN-LEASE-CDE  IS CHARF(1)                   02980000
029900     END-EXEC.                                                    02990000
030000                                                                  03000000
030100     EXEC SQL END DECLARE SECTION END-EXEC.                       03010000
030200                                                                  03020000
030300     EXEC SQL                                                     03030000
030400         INCLUDE SQLCA                                            03040000
030500     END-EXEC.                                                    03050000
030600                                                                  03060000
030700     COPY SQLCA2.                                                 03070000
030800                                                                  03080000
030900                                                                  03090000
031000 PROCEDURE DIVISION.                                              03100000
031100 0000-MAINLINE.                                                   03110000
031200                                                                  03120000
031300     PERFORM A1000-INITIALIZE                                     03130000
031400        THRU A1000-EXIT.                                          03140000
031500                                                                  03150000
031600     PERFORM B1000-PROCESS-MESSAGES                               03160000
031700        THRU B1000-EXIT                                           03170000
031800       UNTIL ORG-EOF.                                             03180000
031900                                                                  03190000
032000     PERFORM J1000-EOJ-PROCESSING                                 03200000
032100        THRU J1000-EXIT.                                          03210000
032200                                                                  03220000
032300     STOP RUN.                                                    03230000
032400                                                                  03240000
032500                                                                  03250000
032600 A1000-INITIALIZE.                                                03260000
032700                                                                  03270000
032800     OPEN INPUT ORG-FILE                                          03280000
032900         OUTPUT NOTIFY-FILE.                                      03290000
033000                                                                  03300000
033100     MOVE FUNCTION CURRENT-DATE (1:4) TO WS-CURRENT-DATE-CCYY.    03310000
033200     MOVE FUNCTION CURRENT-DATE (5:2) TO WS-CURRENT-DATE-MM.      03320000
033300     MOVE FUNCTION CURRENT-DATE (7:2) TO WS-CURRENT-DATE-DD.      03330000
033400     DISPLAY 'CURRENT DATE IS =====> ' WS-CURRENT-DATE.           03340000
033500                                                                  03350000
033600***  WS-CURRENT-END-TMST IS ONLY USED IN SQL WHERE CLAUSES        03360000
033700                                                                  03370000
033800     MOVE WS-INITIAL-END-TMST TO WS-CURRENT-END-TMST.             03380000
033900     MOVE WS-CURRENT-DATE     TO WS-CURRENT-END-TMST(1:10).       03390000
034000                                                                  03400000
034100*********  LOGON TO ORACLE  *************************             03410000
034200                                                                  03420000
034210     PERFORM A1010-CONNECT-TO-ORACLE.                             03421001
036900                                                                  03690000
037000     EXEC SQL                                                     03700000
037100         ALTER SESSION                                            03710000
037200            SET NLS_DATE_FORMAT = 'YYYY-MM-DD.HH24.MI.SS'         03720000
037300     END-EXEC.                                                    03730000
037400                                                                  03740000
037500***  THE CURSOR FETCH WILL ONLY ALLOW THE RETRIEVAL OF 2 DC'S     03750000
037600***  MAX.  THE CURSOR WILL FETCH THE 2 MOST RECENT DC/DS          03760000
037700***  RELATIONSHIPS.                                               03770000
037800                                                                  03780000
037900     EXEC SQL                                                     03790000
038000         DECLARE DCCLC CURSOR FOR                                 03800000
038100             SELECT PRNT_ORG_CLUSTR_ID,                           03810000
038200                    EFF_BEG_TMST,                                 03820000
038300                    EFF_END_TMST                                  03830000
038400               FROM TORGCLC                                       03840000
038500              WHERE CHLD_ORG_CLUSTR_ID = :WS-CLUSTR-ID            03850000
038600                AND REL_TYP_CDE = 'D'                             03860000
038700           ORDER BY EFF_BEG_TMST DESC                             03870000
038800     END-EXEC.                                                    03880000
038900                                                                  03890000
039000     EXEC SQL                                                     03900000
039100        DECLARE DIST CURSOR FOR                                   03910000
039200            SELECT A.PRNT_ORG_CLUSTR_ID,                          03920000
039300                   A.CHLD_ORG_CLUSTR_ID,                          03930000
039400                   A.REL_TYP_CDE,                                 03940000
039500                   A.EFF_BEG_TMST,                                03950000
039600                   A.EFF_END_TMST,                                03960000
039700                   A.CRE_BY_UID,                                  03970000
039800                   A.CRE_TMST,                                    03980000
039900                   A.LAST_UPD_BY_UID,                             03990000
040000                   A.LAST_UPD_TMST                                04000000
040100              FROM TORGCLC A,                                     04010000
040200                   TORGCLT B                                      04020000
040300             WHERE A.CHLD_ORG_CLUSTR_ID                           04030000
040400                                 = :ORGCLC-CHLD-ORG-CLUSTR-ID     04040000
040500               AND A.REL_TYP_CDE = :ORGCLC-REL-TYP-CDE            04050000
040600               AND A.PRNT_ORG_CLUSTR_ID = B.ORG_CLUSTR_ID         04060000
040700               AND B.HIER_CDE = 'DST'                             04070000
040800          ORDER BY A.EFF_BEG_TMST DESC                            04080000
040900     END-EXEC.                                                    04090000
041000                                                                  04100000
041100 A1000-EXIT.                                                      04110000
041200     EXIT.                                                        04120000
041300                                                                  04130000
041310****************************************************************  04131001
041320*   CONNECT TO THE APPROPRIATE ORACLE SERVER.                  *  04132001
041330****************************************************************  04133001
041340 A1010-CONNECT-TO-ORACLE.                                         04134001
041350                                                                  04135001
041360     OPEN INPUT ORACLE-LOGON-FILE.                                04136001
041370                                                                  04137001
041380     PERFORM A1020-READ-ORACLE-LOGON.                             04138001
041390                                                                  04139001
041391     CLOSE ORACLE-LOGON-FILE.                                     04139101
041392                                                                  04139201
041393     IF ((PS-END-OF-LOGON-FILE)                                   04139301
041394             OR (CC-ORACLE-CONNECTION = SPACES))                  04139401
041395         DISPLAY '** ABEND **'                                    04139501
041396         DISPLAY 'MAKUT226 - ORACLE LOGON CONTROL CARD '          04139601
041397                   'NOT PROVIDED'                                 04139701
041398         SET PS-ORA-SRC-EMPTY TO TRUE                             04139801
041399         CALL 'ILBOABN0' USING WS-ABEND-CODE                      04139901
041400     END-IF.                                                      04140001
041401                                                                  04140101
041402     IF CC-AUTO-LOGON                                             04140201
041403         DISPLAY 'MAKUT226 - AUTO LOGON TO ORACLE'                04140301
041404         EXEC SQL                                                 04140401
041405              CONNECT :USERNAME                                   04140501
041406         END-EXEC                                                 04140601
041407     ELSE                                                         04140701
041408         INITIALIZE PV-ORACLE-USERID-LEN                          04140801
041409                    PV-ORACLE-PASSWORD-LEN                        04140901
041410         INSPECT CC-ORACLE-USERID                                 04141001
041411             TALLYING PV-ORACLE-USERID-LEN                        04141101
041412          FOR CHARACTERS BEFORE INITIAL SPACE                     04141201
041413      INSPECT CC-ORACLE-PASSWORD                                  04141301
041414          TALLYING PV-ORACLE-PASSWORD-LEN                         04141401
041415          FOR CHARACTERS BEFORE INITIAL SPACE                     04141501
041416      MOVE CC-ORACLE-USERID (1:PV-ORACLE-USERID-LEN) TO           04141601
041417                USERNAME-ARR                                      04141701
041418      MOVE PV-ORACLE-USERID-LEN TO USERNAME-LEN                   04141801
041419      MOVE CC-ORACLE-PASSWORD (1:PV-ORACLE-PASSWORD-LEN) TO       04141901
041420                PASSWD-ARR                                        04142001
041421      MOVE PV-ORACLE-PASSWORD-LEN TO PASSWD-LEN                   04142101
041422      DISPLAY 'MAKUT226 - LOGON TO ORACLE AS USER '               04142201
041423                USERNAME-ARR                                      04142301
041424      EXEC SQL                                                    04142401
041425        CONNECT :USERNAME IDENTIFIED BY :PASSWD                   04142501
041426      END-EXEC                                                    04142601
041427      INITIALIZE CC-ORACLE-PASSWORD                               04142701
041428                 PASSWD                                           04142801
041429      END-IF.                                                     04142901
041430                                                                  04143001
041431     IF (SQLCODE NOT = 0)                                         04143101
041432         DISPLAY 'A1010-CONNECT-TO-ORACLE'                        04143201
041433         DISPLAY 'MAKUT226 - ERROR LOGGING ON TO ORACLE'          04143301
041434         PERFORM Z9999-ABEND-ROUTINE                              04143401
041435     END-IF.                                                      04143501
041436                                                                  04143601
041437****************************************************************  04143701
041438** READ THE ORACLE LOGON CONTROL CARD.                        **  04143801
041439****************************************************************  04143901
041440 A1020-READ-ORACLE-LOGON.                                         04144001
041441                                                                  04144101
041442     READ ORACLE-LOGON-FILE                                       04144201
041443         INTO CC-ORACLE-CONNECTION                                04144301
041444         AT END                                                   04144401
041445             SET PS-END-OF-LOGON-FILE TO TRUE                     04144501
041446     END-READ.                                                    04144601
041450                                                                  04145000
041500 B1000-PROCESS-MESSAGES.                                          04150000
041600                                                                  04160000
041700     PERFORM B1100-READ-ORG-MESSAGES                              04170000
041800        THRU B1100-EXIT.                                          04180000
041900                                                                  04190000
042000     IF ORG-EOF                                                   04200000
042100         GO TO B1000-EXIT                                         04210000
042200     END-IF.                                                      04220000
042300                                                                  04230000
042400     DISPLAY '**********************************************'.    04240000
042500     DISPLAY 'BEGIN PROCESSING NEW RECORD'.                       04250000
042600     DISPLAY 'RMS TABLE NAME:      ' HO100-RMS-TBL-NAME.          04260000
042700     DISPLAY 'ACTION TYPE CODE:    ' HO100-ACTN-TYP-CDE.          04270000
042800                                                                  04280000
042900     EVALUATE TRUE                                                04290000
043000        WHEN HO100-RMS-TBL-NAME = WS-DISTRICT-TABLE               04300000
043100           PERFORM C1000-PROCESS-DIST-MESSAGES                    04310000
043200              THRU C1000-EXIT                                     04320000
043300        WHEN HO100-RMS-TBL-NAME = WS-WH-TABLE                     04330000
043400           PERFORM D1000-PROCESS-WH                               04340000
043500              THRU D1000-EXIT                                     04350000
043600        WHEN HO100-RMS-TBL-NAME = WS-WH-ATTRIBUTES-TABLE          04360000
043700           PERFORM E1000-PROCESS-WH-ATTRIB                        04370000
043800              THRU E1000-EXIT                                     04380000
043900        WHEN HO100-RMS-TBL-NAME = WS-STORE-TABLE                  04390000
044000           PERFORM F1000-PROCESS-STORE                            04400000
044100              THRU F1000-EXIT                                     04410000
044200        WHEN HO100-RMS-TBL-NAME = WS-STORE-ATTRIBUTES-TABLE       04420000
044300           PERFORM G1000-PROCESS-STORE-ATTRIB                     04430000
044400              THRU G1000-EXIT                                     04440000
044500        WHEN HO100-RMS-TBL-NAME = WS-WH-STORE-ASSIGN              04450000
044600           PERFORM H1000-PROCESS-WH-STR-ASSIGN                    04460000
044700              THRU H1000-EXIT                                     04470000
044800        WHEN HO100-RMS-TBL-NAME = WS-OUTLOC-TABLE                 04480000
044900           PERFORM I1000-PROCESS-OUTLOC                           04490000
045000              THRU I1000-EXIT                                     04500000
045100        WHEN OTHER                                                04510000
045200             DISPLAY '************************'                   04520000
045300             DISPLAY '         ERROR          '                   04530000
045400             DISPLAY 'COULD NOT PROCESS TABLE ' HO100-RMS-TBL-NAME04540000
045500             DISPLAY '************************'                   04550000
045600     END-EVALUATE.                                                04560000
045700                                                                  04570000
045800 B1000-EXIT.                                                      04580000
045900     EXIT.                                                        04590000
046000                                                                  04600000
046100                                                                  04610000
046200 B1100-READ-ORG-MESSAGES.                                         04620000
046300                                                                  04630000
046400     READ ORG-FILE INTO HORD100-RECORD                            04640000
046500         AT END                                                   04650000
046600             SET ORG-EOF TO TRUE                                  04660000
046700             GO TO B1100-EXIT.                                    04670000
046800                                                                  04680000
046900     ADD 1 TO WS-READ-COUNT.                                      04690000
047000                                                                  04700000
047100     INSPECT HO100-STORE-DATA REPLACING ALL '|' BY ' '.           04710000
047200     INSPECT HO100-STORE-DATA REPLACING ALL '_' BY ' '.           04720000
047300     INSPECT HO100-STORE-DATA REPLACING ALL '''' BY ' '.          04730000
047400     INSPECT HO100-STORE-DATA REPLACING ALL '"' BY ' '.           04740000
047500     INSPECT HO100-STORE-DATA REPLACING ALL '*' BY ' '.           04750000
047600                                                                  04760000
047700 B1100-EXIT.                                                      04770000
047800     EXIT.                                                        04780000
047900                                                                  04790000
048000                                                                  04800000
048100 C1000-PROCESS-DIST-MESSAGES.                                     04810000
048200                                                                  04820000
048300     DISPLAY 'C1000-PROCESS-DIST-MESSAGES'.                       04830000
048400     DISPLAY 'DISTRICT:  ' HO100-DISTRICT.                        04840000
048500                                                                  04850000
048600     INITIALIZE ORGCLT-ORG-CLUSTR-NAME.                           04860000
048700     MOVE HO100-DISTRICT   TO WS-DISTRICT                         04870000
048800                              WS-DISTRICT-N.                      04880000
048900                                                                  04890000
049000*** THIS IF STATMENT IS NEEDED TO PREVENT THE LEADING NUMBER      04900000
049100*** OF 3 CHARACTER DC FROM BEING TRUNCATED. STORE DC NUMBER       04910000
049200*** IN WS-DISTRICT-FINAL TO REPLACE WS-KEY-NBR AND IT'S           04920000
049300*** RELATED VARIABLES. THAT PREVENTS LEADING DC NUMBER BEING      04930000
049400*** TRUNCATED AS WELL.                                            04940000
049500     IF WS-DISTRICT-N > 99                                        04950000
049600        MOVE WS-DISTRICT(2:3) TO ORGCLT-ORG-CLUSTR-NAME           04960000
049700                                 WS-DISTRICT-FINAL                04970000
049800     ELSE                                                         04980000
049900        MOVE WS-DISTRICT(3:2) TO ORGCLT-ORG-CLUSTR-NAME           04990000
050000                                 WS-DISTRICT-FINAL                05000000
050100     END-IF.                                                      05010000
050200                                                                  05020000
050300     MOVE 'DST'            TO ORGCLT-HIER-CDE.                    05030000
050400     SET TORGCLT-HIER-CDE  TO TRUE.                               05040000
050500                                                                  05050000
050600     PERFORM U9000-SELECT-TORGCLT                                 05060000
050700        THRU U9000-EXIT.                                          05070000
050800                                                                  05080000
050900     IF TORGCLT-RCD-EXISTS                                        05090000
051000         MOVE ORGCLT-ORG-CLUSTR-ID TO WS-CLUSTR-ID                05100000
051100     END-IF.                                                      05110000
051200                                                                  05120000
051300     IF HO100-ACTN-TYP-INSERT                                     05130000
051400         IF TORGCLT-RCD-DOES-NOT-EXIST                            05140000
051500                                                                  05150000
051600             PERFORM U9100-SELECT-NEXT-SEQ-NBR                    05160000
051700                THRU U9100-EXIT                                   05170000
051800             MOVE ORGCLT-ORG-CLUSTR-ID TO WS-CLUSTR-ID            05180000
051900                                                                  05190000
052000             INITIALIZE DCLTORGCLT                                05200000
052100             MOVE WS-CLUSTR-ID    TO ORGCLT-ORG-CLUSTR-ID         05210000
052200             MOVE HO100-DISTRICT-AREA-NAME(10:3)                  05220000
052300                                  TO ORGCLT-ORG-CLUSTR-NAME-10    05230000
052400             MOVE WS-DISTRICT-FINAL TO ORGCLT-ORG-CLUSTR-NAME     05240000
052500             MOVE HO100-DISTRICT-AREA-NAME                        05250000
052600                                  TO ORGCLT-ORG-CLUSTR-DESC       05260000
052700             MOVE WS-INITIAL-TMST TO ORGCLT-EFF-BEG-TMST          05270000
052800                                     ORGCLT-NMDSE-PO-BEG-TMST     05280000
052900             MOVE WS-CURRENT-DATE                                 05290000
053000                                TO ORGCLT-EFF-BEG-TMST(1:10)      05300000
053100                                   ORGCLT-NMDSE-PO-BEG-TMST(1:10) 05310000
053200             MOVE 'S'             TO ORGCLT-CLUSTR-TYP-CDE        05320000
053300                                     ORGCLT-HIER-TYP-CDE          05330000
053400             MOVE 'DST'           TO ORGCLT-HIER-CDE              05340000
053500             MOVE 'C'             TO ORGCLT-ORG-CLUSTR-CDE        05350000
053600             MOVE 'N'             TO ORGCLT-E-BUS-LOC-IND         05360000
053700                                                                  05370000
053800             MOVE 0               TO WS-ORG-CLUSTR-NAME-10-NULL   05380000
053900                                     WS-HIER-TYP-CDE-NULL         05390000
054000                                     WS-HIER-CDE-NULL             05400000
054100                                     WS-CLUSTR-TYP-CDE-NULL       05410000
054200                                     WS-NMDSE-PO-BEG-TMST-NULL    05420000
054300                                                                  05430000
054400             MOVE -1              TO WS-ORG-CLUSTR-NAME-5-NULL    05440000
054500                                     WS-CLT-EFF-END-TMST-NULL     05450000
054600                                     WS-ORG-TYP-CDE-NULL          05460000
054700                                     WS-NMDSE-PO-END-TMST-NULL    05470000
054800                                     WS-ARCH-DTE-NULL             05480000
054900                                     WS-OWNER-ID-NULL             05490000
055000                                     WS-OPN-DTE-NULL              05500000
055100                                     WS-CLO-DTE-NULL              05510000
055200                                     WS-REPL-ORG-CLUSTR-ID-NULL   05520000
055300                                                                  05530000
055400             PERFORM U9200-INSERT-TORGCLT                         05540000
055500                THRU U9200-EXIT                                   05550000
055600                                                                  05560000
055700***   A NOTIFICATION NEEDS TO BE SENT TO THE MA TEAM THAT         05570000
055800***   DISTRICT INFO NEEDS TO BE MANUALLY INSERTED INTO            05580000
055900***   TPHYLOC AND TORGPHY -----                                   05590000
056000***   THE INSERT NEEDS TO BE DONE MANUALLY BECAUSE WE NEED        05600000
056100***   THE ADDRESS OF THE NEW DISTRICT OFFICE FOR TPHYLOC.         05610000
056200***   THIS INFORMATION IS NOT CARRIED ON THE RMS LOCATION         05620000
056300***   RECORDS.                                                    05630000
056400                                                                  05640000
056500             MOVE WS-DISTRICT-INSERTED TO WS-NOTIFY-MSG           05650000
056600             MOVE WS-DISTRICT-FINAL    TO WS-NOTIFY-DATA1         05660000
056700             MOVE SPACES               TO WS-NOTIFY-DATA2         05670000
056800             PERFORM U8300-WRITE-NOTIFY-RECORD                    05680000
056900                THRU U8300-EXIT                                   05690000
057000                                                                  05700000
057100             INITIALIZE ORGCLT-ORG-CLUSTR-NAME                    05710000
057200             MOVE '0090'        TO ORGCLT-ORG-CLUSTR-NAME         05720000
057300             SET TORGCLT-OTHERS TO TRUE                           05730000
057400             PERFORM U9000-SELECT-TORGCLT                         05740000
057500                THRU U9000-EXIT                                   05750000
057600                                                                  05760000
057700             IF TORGCLT-RCD-EXISTS                                05770000
057800                 MOVE ORGCLT-ORG-CLUSTR-ID TO WS-PRNT-CLUSTR-ID   05780000
057900                                                                  05790000
058000                 INITIALIZE DCLTORGCLC                            05800000
058100                 MOVE WS-PRNT-CLUSTR-ID                           05810000
058200                                  TO ORGCLC-PRNT-ORG-CLUSTR-ID    05820000
058300                 MOVE WS-CLUSTR-ID                                05830000
058400                                  TO ORGCLC-CHLD-ORG-CLUSTR-ID    05840000
058500                 MOVE 'M'         TO ORGCLC-REL-TYP-CDE           05850000
058600                 MOVE WS-INITIAL-TMST TO ORGCLC-EFF-BEG-TMST      05860000
058700                 MOVE WS-CURRENT-DATE                             05870000
058800                                  TO ORGCLC-EFF-BEG-TMST(1:10)    05880000
058900                 MOVE -1          TO WS-CLC-EFF-END-TMST-NULL     05890000
059000                                                                  05900000
059100                 PERFORM V9000-INSERT-TORGCLC                     05910000
059200                    THRU V9000-EXIT                               05920000
059300             ELSE                                                 05930000
059400                 DISPLAY '**************************************' 05940000
059500                 DISPLAY '                ERROR                 ' 05950000
059600                 DISPLAY 'CORP ORG CLUSTER ID NOT FOUND         ' 05960000
059700                 DISPLAY 'COULD NOT INSERT TORGCLC RELATIONSHIP ' 05970000
059800                 DISPLAY 'FOR ' WS-DISTRICT-FINAL                 05980000
059900                 DISPLAY '**************************************' 05990000
060000             END-IF                                               06000000
060100         END-IF                                                   06010000
060200     END-IF.                                                      06020000
060300                                                                  06030000
060400     IF HO100-ACTN-TYP-UPDATE                                     06040000
060500         IF TORGCLT-RCD-EXISTS                                    06050000
060600             MOVE HO100-DISTRICT-AREA-NAME                        06060000
060700                               TO ORGCLT-ORG-CLUSTR-DESC          06070000
060800             PERFORM U9300-UPDATE-TORGCLT                         06080000
060900                THRU U9300-EXIT                                   06090000
061000         END-IF                                                   06100000
061100     END-IF.                                                      06110000
061200                                                                  06120000
061300 C1000-EXIT.                                                      06130000
061400     EXIT.                                                        06140000
061500                                                                  06150000
061600                                                                  06160000
061700 D1000-PROCESS-WH.                                                06170000
061800                                                                  06180000
061900     DISPLAY 'D1000-PROCESS-WH'.                                  06190000
062000     DISPLAY 'WAREHOUSE:  ' HO100-WH.                             06200000
062100                                                                  06210000
062200***  WH MESSAGES HAVE LOCATION TYPES OF DC, RV, CS AND NA.        06220000
062300***  WE DO NOT PROCESS 'NA' TYPES.                                06230000
062400                                                                  06240000
062500***  THE RMS RECORDS ARE CREATED WITH EACH WH MESSAGE BEING       06250000
062600***  IMMEDIATELY FOLLOWED BY A WH_ATTRIB MESSAGE.                 06260000
062700                                                                  06270000
062800***  THEREFORE, INSERT PROCESSING SAVES THE NECESSARY DATA        06280000
062900***  TO WORKING STORAGE.  WITH THE SUBSEQUENT READ OF THE         06290000
063000***  WH_ATTRIBUTES MESSAGE, IT CAN BE DETERMINED WHAT THE         06300000
063100***  LOCATION TYPE IS:  DC, RV OR CS.                             06310000
063200                                                                  06320000
063300***  UPDATE PROCESSING IS DONE AS SOON AS THE WH MESSAGE IS       06330000
063400***  READ.  IF THE RECORD IS NOT FOUND, NOTHING IS DONE.          06340000
063500                                                                  06350000
063600***  WH MESSAGES DO NOT IDENTIFY THE ORG-TYP-CDE I.E.             06360000
063700***  DC, RV OR CS.  THEREFORE, TORGCLT LOOKUPS ARE                06370000
063800***  DONE USING ONLY THE ORGCLT-ORG-CLUSTR-NAME.                  06380000
063900                                                                  06390000
064000     INITIALIZE ORGCLT-ORG-CLUSTR-NAME.                           06400000
064100     MOVE HO100-WH      TO ORGCLT-ORG-CLUSTR-NAME.                06410000
064200     SET TORGCLT-OTHERS TO TRUE.                                  06420000
064300                                                                  06430000
064400     PERFORM U9000-SELECT-TORGCLT                                 06440000
064500        THRU U9000-EXIT.                                          06450000
064600                                                                  06460000
064700     IF TORGCLT-RCD-EXISTS                                        06470000
064800         MOVE ORGCLT-ORG-CLUSTR-ID TO WS-CLUSTR-ID                06480000
064900     END-IF.                                                      06490000
065000                                                                  06500000
065100***  SAVE THIS INFO FOR THE CORRESPONDING WH_ATTTRIB MESSAGE      06510000
065200***  WHICH SHOULD FOLLOW IMMEDIATELY AFTER THIS MESSAGE           06520000
065300     IF HO100-ACTN-TYP-INSERT                                     06530000
065400         IF TORGCLT-RCD-DOES-NOT-EXIST                            06540000
065500             MOVE HO100-WH      TO WS-HO100-WH                    06550000
065600             MOVE HO100-WH-NAME TO WS-HO100-WH-NAME               06560000
065700             MOVE HO100-WH-ADD1-1-25                              06570000
065800                                TO WS-HO100-WH-ADD1-1-25          06580000
065900             MOVE HO100-WH-ADD2-1-25                              06590000
066000                                TO WS-HO100-WH-ADD2-1-25          06600000
066100             MOVE HO100-WH-CITY-1-15                              06610000
066200                                TO WS-HO100-WH-CITY-1-15          06620000
066300             MOVE HO100-WH-STATE-1-2                              06630000
066400                                TO WS-HO100-WH-STATE-1-2          06640000
066500             MOVE HO100-WH-PCODE                                  06650000
066600                                TO WS-HO100-WH-PCODE              06660000
066700         END-IF                                                   06670000
066800     END-IF.                                                      06680000
066900                                                                  06690000
067000     IF HO100-ACTN-TYP-UPDATE                                     06700000
067100         IF TORGCLT-RCD-EXISTS                                    06710000
067200             MOVE HO100-WH-NAME TO ORGCLT-ORG-CLUSTR-DESC         06720000
067300             PERFORM U9300-UPDATE-TORGCLT                         06730000
067400                THRU U9300-EXIT                                   06740000
067500         END-IF                                                   06750000
067600     END-IF.                                                      06760000
067700                                                                  06770000
067800 D1000-EXIT.                                                      06780000
067900     EXIT.                                                        06790000
068000                                                                  06800000
068100                                                                  06810000
068200 E1000-PROCESS-WH-ATTRIB.                                         06820000
068300                                                                  06830000
068400     DISPLAY 'E1000-PROCESS-WH-ATTRIB'.                           06840000
068500     DISPLAY 'WAREHOUSE:  ' HO100-WHATTR-WH.                      06850000
068600     DISPLAY 'WAREHOUSE LOC TYPE:  ' HO100-WHATTR-LOC-TYP-CDE.    06860000
068700                                                                  06870000
068800     IF HO100-WHATTR-LOC-TYP-CDE = 'DC'                           06880000
068900       OR HO100-WHATTR-LOC-TYP-CDE = 'CS'                         06890000
069000       OR HO100-WHATTR-LOC-TYP-CDE = 'RV'                         06900000
069100         CONTINUE                                                 06910000
069200     ELSE                                                         06920000
069300         GO TO E1000-EXIT                                         06930000
069400     END-IF.                                                      06940000
069500                                                                  06950000
069600     INITIALIZE ORGCLT-ORG-CLUSTR-NAME.                           06960000
069700     MOVE HO100-WHATTR-WH      TO ORGCLT-ORG-CLUSTR-NAME.         06970000
069800     MOVE HO100-WHATTR-LOC-TYP-CDE                                06980000
069900                               TO ORGCLT-ORG-TYP-CDE.             06990000
070000     SET TORGCLT-ORG-TYP-CDE   TO TRUE.                           07000000
070100                                                                  07010000
070200     PERFORM U9000-SELECT-TORGCLT                                 07020000
070300        THRU U9000-EXIT.                                          07030000
070400                                                                  07040000
070500     IF TORGCLT-RCD-EXISTS                                        07050000
070600         MOVE ORGCLT-ORG-CLUSTR-ID TO WS-CLUSTR-ID                07060000
070700     END-IF.                                                      07070000
070800                                                                  07080000
070900***  THERE IS A WH_ATTRIB INSERT MESSAGE CREATED FOR EVERY        07090000
071000***  WH INSERT MESSAGE CREATED                                    07100000
071100                                                                  07110000
071200     IF HO100-ACTN-TYP-INSERT                                     07120000
071300         IF TORGCLT-RCD-DOES-NOT-EXIST                            07130000
071400                                                                  07140000
071500             PERFORM U9100-SELECT-NEXT-SEQ-NBR                    07150000
071600                THRU U9100-EXIT                                   07160000
071700             MOVE ORGCLT-ORG-CLUSTR-ID TO WS-CLUSTR-ID            07170000
071800                                                                  07180000
071900             INITIALIZE DCLTORGCLT                                07190000
072000             MOVE WS-CLUSTR-ID     TO ORGCLT-ORG-CLUSTR-ID        07200000
072100             MOVE HO100-WHATTR-NM-5-ABBR                          07210000
072200                               TO ORGCLT-ORG-CLUSTR-NAME-5        07220000
072300             MOVE HO100-WHATTR-NM-10-ABBR                         07230000
072400                               TO ORGCLT-ORG-CLUSTR-NAME-10       07240000
072500             MOVE WS-HO100-WH      TO ORGCLT-ORG-CLUSTR-NAME      07250000
072600             MOVE WS-HO100-WH-NAME TO ORGCLT-ORG-CLUSTR-DESC      07260000
072700                                                                  07270000
072800             MOVE WS-INITIAL-TMST  TO ORGCLT-EFF-BEG-TMST         07280000
072900                                      ORGCLT-NMDSE-PO-BEG-TMST    07290000
073000                                      ORGCLT-OPN-DTE              07300000
073100             MOVE WS-CURRENT-DATE                                 07310000
073200                               TO ORGCLT-NMDSE-PO-BEG-TMST(1:10)  07320000
073300             MOVE HO100-WHATTR-OPN-DTE                            07330000
073400                               TO ORGCLT-EFF-BEG-TMST(1:10)       07340000
073500                                  ORGCLT-OPN-DTE(1:10)            07350000
073600                                                                  07360000
073700             MOVE 'O'          TO ORGCLT-ORG-CLUSTR-CDE           07370000
073800             MOVE HO100-WHATTR-LOC-TYP-CDE                        07380000
073900                               TO ORGCLT-ORG-TYP-CDE              07390000
074000                                                                  07400000
074100             IF HO100-WHATTR-CLO-DTE = '9999-09-09'               07410000
074200                 MOVE -1                   TO WS-CLO-DTE-NULL     07420000
074300             ELSE                                                 07430000
074400                 MOVE WS-INITIAL-END-TMST  TO ORGCLT-CLO-DTE      07440000
074500                 MOVE HO100-WHATTR-CLO-DTE TO ORGCLT-CLO-DTE(1:10)07450000
074600                 MOVE 0                    TO WS-CLO-DTE-NULL     07460000
074700             END-IF                                               07470000
074800                                                                  07480000
074900             MOVE 0   TO WS-ORG-CLUSTR-NAME-5-NULL                07490000
075000                         WS-ORG-CLUSTR-NAME-10-NULL               07500000
075100                         WS-ORG-TYP-CDE-NULL                      07510000
075200                         WS-NMDSE-PO-BEG-TMST-NULL                07520000
075300                         WS-OPN-DTE-NULL                          07530000
075400                                                                  07540000
075500             MOVE -1  TO WS-CLT-EFF-END-TMST-NULL                 07550000
075600                         WS-CLUSTR-TYP-CDE-NULL                   07560000
075700                         WS-HIER-TYP-CDE-NULL                     07570000
075800                         WS-HIER-CDE-NULL                         07580000
075900                         WS-NMDSE-PO-END-TMST-NULL                07590000
076000                         WS-ARCH-DTE-NULL                         07600000
076100                         WS-OWNER-ID-NULL                         07610000
076200                         WS-REPL-ORG-CLUSTR-ID-NULL               07620000
076300                                                                  07630000
076400             MOVE HO100-WHATTR-E-BUS-LOC-IND                      07640000
076500                               TO ORGCLT-E-BUS-LOC-IND            07650000
076600                                                                  07660000
076700             PERFORM U9200-INSERT-TORGCLT                         07670000
076800                THRU U9200-EXIT                                   07680000
076900                                                                  07690000
077000             IF HO100-WHATTR-LOC-TYP-CDE = 'DC'                   07700000
077100                                                                  07710000
077200                 INITIALIZE DCLTPHYLOC                            07720000
077300                 MOVE WS-HO100-WH-NAME TO PHYLOC-PHY-LOC-NAME     07730000
077400                 MOVE WS-HO100-WH-ADD1-1-25                       07740000
077500                                       TO PHYLOC-ADR-LNE1-DESC    07750000
077600                 IF WS-HO100-WH-ADD2-1-25 > SPACES                07760000
077700                     MOVE WS-HO100-WH-ADD2-1-25                   07770000
077800                                       TO PHYLOC-ADR-LNE2-DESC    07780000
077900                     MOVE 0            TO WS-ADR-LNE2-DESC-NULL   07790000
078000                 ELSE                                             07800000
078100                     MOVE -1           TO WS-ADR-LNE2-DESC-NULL   07810000
078200                 END-IF                                           07820000
078300                                                                  07830000
078400                 MOVE WS-HO100-WH-CITY-1-15                       07840000
078500                                      TO PHYLOC-CTY-NAME          07850000
078600                 MOVE WS-HO100-WH-STATE-1-2                       07860000
078700                                      TO PHYLOC-ST-CDE            07870000
078800                 MOVE ' '             TO PHYLOC-OWN-LEASE-CDE     07880000
078900                 MOVE ZEROS           TO PHYLOC-TAX-PCT           07890000
079000                                                                  07900000
079100***  CONVERT THE INPUT ALPHANUMERIC ZIP CODE TO NUMERIC           07910000
079200                 INITIALIZE WS-INPUT-NUMBER-IN                    07920000
079300                            WS-OUTPUT-NUMBER-OUT                  07930000
079400                            WS-ZIP-CODE-X-1-9                     07940000
079500                 MOVE WS-HO100-WH-PCODE                           07950000
079600                                      TO WS-INPUT-NUMBER-IN       07960000
079700                                                                  07970000
079800                 PERFORM U8000-CONVERT-ALPHA-TO-NUMERIC           07980000
079900                    THRU U8000-EXIT                               07990000
080000                                                                  08000000
080100                 MOVE WS-OUTPUT-NUMBER-OUT TO WS-ZIP-CODE-X       08010000
080200                 MOVE WS-ZIP-CODE-X-1-9(1:5) TO WS-ZIP-CODE-Y-1-5 08020000
080300                                                                  08030000
080400                 IF WS-ZIP-CODE-X-1-9(6:4) = ZEROS                08040000
080500                     MOVE SPACES TO WS-ZIP-CODE-Y-7-10            08050000
080600                     MOVE SPACES TO WS-ZIP-CODE-Y-6               08060000
080700                 ELSE                                             08070000
080800                     MOVE WS-ZIP-CODE-X-1-9(6:4)                  08080000
080900                              TO WS-ZIP-CODE-Y-7-10               08090000
081000                     MOVE '-' TO WS-ZIP-CODE-Y-6                  08100000
081100                 END-IF                                           08110000
081200                 MOVE WS-ZIP-CODE-Y TO PHYLOC-ZIP-CDE             08120000
081300                                                                  08130000
081400                 PERFORM T1000-CREATE-TPHYLOC-TORGPHY             08140000
081500                    THRU T1000-EXIT                               08150000
081600         END-IF                                                   08160000
081700     END-IF.                                                      08170000
081800                                                                  08180000
081900     IF HO100-ACTN-TYP-UPDATE                                     08190000
082000         IF TORGCLT-RCD-EXISTS                                    08200000
082100                                                                  08210000
082200             MOVE HO100-WHATTR-NM-5-ABBR                          08220000
082300                               TO ORGCLT-ORG-CLUSTR-NAME-5        08230000
082400             MOVE HO100-WHATTR-NM-10-ABBR                         08240000
082500                               TO ORGCLT-ORG-CLUSTR-NAME-10       08250000
082600             MOVE WS-INITIAL-TMST TO ORGCLT-EFF-BEG-TMST          08260000
082700                                     ORGCLT-OPN-DTE               08270000
082800             MOVE HO100-WHATTR-OPN-DTE                            08280000
082900                                  TO ORGCLT-EFF-BEG-TMST(1:10)    08290000
083000                                     ORGCLT-OPN-DTE(1:10)         08300000
083100                                                                  08310000
083200             IF HO100-WHATTR-CLO-DTE NOT = '9999-09-09'           08320000
083300                 MOVE WS-INITIAL-END-TMST  TO ORGCLT-CLO-DTE      08330000
083400                 MOVE HO100-WHATTR-CLO-DTE TO ORGCLT-CLO-DTE(1:10)08340000
083500                 MOVE 0                    TO WS-CLO-DTE-NULL     08350000
083600             END-IF                                               08360000
083700                                                                  08370000
083800             MOVE HO100-WHATTR-E-BUS-LOC-IND                      08380000
083900                               TO ORGCLT-E-BUS-LOC-IND            08390000
084000                                                                  08400000
084100             PERFORM U9300-UPDATE-TORGCLT                         08410000
084200                THRU U9300-EXIT                                   08420000
084300         END-IF                                                   08430000
084400     END-IF.                                                      08440000
084500                                                                  08450000
084600***  ONLY CS AND RV LOCATION TYPES HAVE TORGCLC DC RELATIONSHIPS  08460000
084700                                                                  08470000
084800     IF HO100-WHATTR-LOC-TYP-CDE = 'CS'                           08480000
084900       OR HO100-WHATTR-LOC-TYP-CDE = 'RV'                         08490000
085000         PERFORM E1100-SETUP-CS-RV-REL                            08500000
085100            THRU E1100-EXIT                                       08510000
085200     END-IF.                                                      08520000
085300                                                                  08530000
085400 E1000-EXIT.                                                      08540000
085500     EXIT.                                                        08550000
085600                                                                  08560000
085700                                                                  08570000
085800 E1100-SETUP-CS-RV-REL.                                           08580000
085900                                                                  08590000
086000     IF HO100-ACTN-TYP-INSERT                                     08600000
086100         IF TORGCLT-RCD-DOES-NOT-EXIST                            08610000
086200                                                                  08620000
086300             INITIALIZE ORGCLT-ORG-CLUSTR-NAME                    08630000
086400             MOVE HO100-WHATTR-DC-NBR TO ORGCLT-ORG-CLUSTR-NAME   08640000
086500             SET TORGCLT-OTHERS       TO TRUE                     08650000
086600             PERFORM U9000-SELECT-TORGCLT                         08660000
086700                THRU U9000-EXIT                                   08670000
086800                                                                  08680000
086900             IF TORGCLT-RCD-EXISTS                                08690000
087000                 MOVE ORGCLT-ORG-CLUSTR-ID                        08700000
087100                                TO WS-PRNT-CLUSTR-ID              08710000
087200                                                                  08720000
087300                 INITIALIZE DCLTORGCLC                            08730000
087400                 MOVE WS-PRNT-CLUSTR-ID                           08740000
087500                                TO ORGCLC-PRNT-ORG-CLUSTR-ID      08750000
087600                 MOVE WS-CLUSTR-ID                                08760000
087700                                TO ORGCLC-CHLD-ORG-CLUSTR-ID      08770000
087800                 MOVE 'D'       TO ORGCLC-REL-TYP-CDE             08780000
087900                 MOVE WS-INITIAL-TMST                             08790000
088000                                TO ORGCLC-EFF-BEG-TMST            08800000
088100                 MOVE HO100-WHATTR-OPN-DTE                        08810000
088200                                TO ORGCLC-EFF-BEG-TMST(1:10)      08820000
088300                                                                  08830000
088400                 IF HO100-WHATTR-CLO-DTE = '9999-09-09'           08840000
088500                     MOVE -1    TO WS-CLC-EFF-END-TMST-NULL       08850000
088600                 ELSE                                             08860000
088700                     MOVE WS-INITIAL-END-TMST                     08870000
088800                                TO ORGCLC-EFF-END-TMST            08880000
088900                     MOVE HO100-WHATTR-CLO-DTE                    08890000
089000                                TO ORGCLC-EFF-END-TMST(1:10)      08900000
089100                     MOVE 0     TO WS-CLC-EFF-END-TMST-NULL       08910000
089200                 END-IF                                           08920000
089300                                                                  08930000
089400                 PERFORM V9000-INSERT-TORGCLC                     08940000
089500                    THRU V9000-EXIT                               08950000
089600             ELSE                                                 08960000
089700                 DISPLAY '**************************************' 08970000
089800                 DISPLAY '                ERROR                 ' 08980000
089900                 DISPLAY 'DC ORG CLUSTER ID NOT FOUND           ' 08990000
090000                 DISPLAY 'COULD NOT INSERT TORGCLC RELATIONSHIP ' 09000000
090100                 DISPLAY 'FOR ' HO100-WHATTR-DC-NBR               09010000
090200                 DISPLAY '**************************************' 09020000
090300             END-IF                                               09030000
090400         END-IF                                                   09040000
090500     END-IF.                                                      09050000
090600                                                                  09060000
090700                                                                  09070000
090800     IF HO100-ACTN-TYP-UPDATE                                     09080000
090900         IF TORGCLT-RCD-EXISTS                                    09090000
091000                                                                  09100000
091100***  CS AND RV LOCATIONS HAVE ONLY 1 PARENT ON THE TORGCLC        09110000
091200***  TABLE AND THAT'S A DC                                        09120000
091300             MOVE WS-CLUSTR-ID TO ORGCLC-CHLD-ORG-CLUSTR-ID       09130000
091400             MOVE 'D'          TO ORGCLC-REL-TYP-CDE              09140000
091500             PERFORM V9200-SELECT-TORGCLC-CHLD                    09150000
091600                THRU V9200-EXIT                                   09160000
091700                                                                  09170000
091800             IF TORGCLC-RCD-EXISTS                                09180000
091900                 MOVE WS-INITIAL-TMST TO WS-ORGCLC-EFF-BEG-TMST   09190000
092000                 MOVE HO100-WHATTR-OPN-DTE                        09200000
092100                                  TO WS-ORGCLC-EFF-BEG-TMST(1:10) 09210000
092200                                                                  09220000
092300                 IF HO100-WHATTR-CLO-DTE NOT = '9999-09-09'       09230000
092400                     MOVE WS-INITIAL-END-TMST                     09240000
092500                                    TO ORGCLC-EFF-END-TMST        09250000
092600                     MOVE HO100-WHATTR-CLO-DTE                    09260000
092700                                    TO ORGCLC-EFF-END-TMST(1:10)  09270000
092800                     MOVE 0         TO WS-CLC-EFF-END-TMST-NULL   09280000
092900                 END-IF                                           09290000
093000                                                                  09300000
093100                 PERFORM V9100-UPDATE-TORGCLC                     09310000
093200                    THRU V9100-EXIT                               09320000
093300             END-IF                                               09330000
093400         END-IF                                                   09340000
093500     END-IF.                                                      09350000
093600                                                                  09360000
093700 E1100-EXIT.                                                      09370000
093800     EXIT.                                                        09380000
093900                                                                  09390000
094000                                                                  09400000
094100 F1000-PROCESS-STORE.                                             09410000
094200                                                                  09420000
094300     DISPLAY 'F1000-PROCESS-STORE'.                               09430000
094400     DISPLAY 'STORE:  ' HO100-STR-NBR.                            09440000
094500                                                                  09450000
094600     INITIALIZE ORGCLT-ORG-CLUSTR-NAME.                           09460000
094700     MOVE HO100-STR-NBR      TO ORGCLT-ORG-CLUSTR-NAME.           09470000
094800     MOVE 'DS'               TO ORGCLT-ORG-TYP-CDE.               09480000
094900     SET TORGCLT-ORG-TYP-CDE TO TRUE.                             09490000
095000                                                                  09500000
095100     PERFORM U9000-SELECT-TORGCLT                                 09510000
095200        THRU U9000-EXIT.                                          09520000
095300                                                                  09530000
095400     IF TORGCLT-RCD-EXISTS                                        09540000
095500         MOVE ORGCLT-ORG-CLUSTR-ID TO WS-CLUSTR-ID                09550000
095600     END-IF.                                                      09560000
095700                                                                  09570000
095800     IF HO100-ACTN-TYP-INSERT                                     09580000
095900         IF TORGCLT-RCD-DOES-NOT-EXIST                            09590000
096000             PERFORM F1100-INSERT-STORE                           09600000
096100                THRU F1100-EXIT                                   09610000
096200         END-IF                                                   09620000
096300     END-IF.                                                      09630000
096400                                                                  09640000
096500     IF HO100-ACTN-TYP-UPDATE                                     09650000
096600         IF TORGCLT-RCD-EXISTS                                    09660000
096700             PERFORM F1200-UPDATE-STORE                           09670000
096800                THRU F1200-EXIT                                   09680000
096900         END-IF                                                   09690000
097000     END-IF.                                                      09700000
097100                                                                  09710000
097200 F1000-EXIT.                                                      09720000
097300     EXIT.                                                        09730000
097400                                                                  09740000
097500                                                                  09750000
097600 F1100-INSERT-STORE.                                              09760000
097700                                                                  09770000
097800     DISPLAY 'F1100-INSERT-STORE'.                                09780000
097900                                                                  09790000
098000     PERFORM U9100-SELECT-NEXT-SEQ-NBR                            09800000
098100        THRU U9100-EXIT.                                          09810000
098200     MOVE ORGCLT-ORG-CLUSTR-ID TO WS-CLUSTR-ID.                   09820000
098300                                                                  09830000
098400     INITIALIZE DCLTORGCLT.                                       09840000
098500     MOVE WS-CLUSTR-ID       TO ORGCLT-ORG-CLUSTR-ID.             09850000
098600     MOVE HO100-STR-NAME10   TO ORGCLT-ORG-CLUSTR-NAME-10.        09860000
098700     MOVE HO100-STR-NBR      TO ORGCLT-ORG-CLUSTR-NAME.           09870000
098800     MOVE HO100-STR-NAME     TO ORGCLT-ORG-CLUSTR-DESC.           09880000
098900     MOVE 'DS'               TO ORGCLT-ORG-TYP-CDE.               09890000
099000     MOVE 'O'                TO ORGCLT-ORG-CLUSTR-CDE.            09900000
099100                                                                  09910000
099200                                                                  09920000
099300***  ORGCLT-EFF-BEG-TMST IS JUST BEING INITIALIZED HERE           09930000
099400***  A VALUE WILL BE PLACED IN THE FIELD WHEN A CORRESPONDING     09940000
099500***  WH_STORE_ASSIGN RECORD IS PROCESSED                          09950000
099600                                                                  09960000
099700     MOVE WS-INITIAL-TMST    TO ORGCLT-EFF-BEG-TMST               09970000
099800                                ORGCLT-NMDSE-PO-BEG-TMST.         09980000
099900     MOVE WS-CURRENT-DATE                                         09990000
100000                      TO ORGCLT-EFF-BEG-TMST(1:10)                10000000
100100                         ORGCLT-NMDSE-PO-BEG-TMST(1:10).          10010000
100200                                                                  10020000
100300     MOVE 0           TO WS-ORG-CLUSTR-NAME-10-NULL               10030000
100400                         WS-ORG-TYP-CDE-NULL                      10040000
100500                         WS-NMDSE-PO-BEG-TMST-NULL                10050000
100600                         WS-OPN-DTE-NULL.                         10060000
100700                                                                  10070000
100800     MOVE -1  TO WS-ORG-CLUSTR-NAME-5-NULL                        10080000
100900                 WS-CLT-EFF-END-TMST-NULL                         10090000
101000                 WS-CLUSTR-TYP-CDE-NULL                           10100000
101100                 WS-HIER-TYP-CDE-NULL                             10110000
101200                 WS-HIER-CDE-NULL                                 10120000
101300                 WS-NMDSE-PO-END-TMST-NULL                        10130000
101400                 WS-ARCH-DTE-NULL                                 10140000
101500                 WS-OWNER-ID-NULL                                 10150000
101600                 WS-REPL-ORG-CLUSTR-ID-NULL.                      10160000
101700                                                                  10170000
101800     MOVE WS-INITIAL-TMST          TO ORGCLT-OPN-DTE.             10180000
101900     MOVE HO100-STR-OPEN-DATE      TO ORGCLT-OPN-DTE(1:10).       10190000
102000***  THE CLOSE FOR A NEW IS ALWAYS SET TO NULL IRRESPECTIVE OF    10200000
102100***  THE ITS VALUE IN THE MESSAGE QUEUE                           10210000
102200      MOVE -1                       TO WS-CLO-DTE-NULL            10220000
102300                                                                  10230000
102400***  THE VALUE FOR A STORE E-BUS-LOC-IND IS SET BY THE            10240000
102500***  STORE_ATTRIBUTES MESSAGE.  HOWEVER, SINCE IT CAN NOT         10250000
102600***  HAVE A NULL VALUE, A DEFAULT VALUE IS BEING SET HERE         10260000
102700***  FOR THE INSERT.                                              10270000
102800     MOVE 'N'                      TO ORGCLT-E-BUS-LOC-IND.       10280000
102900                                                                  10290000
103000***  INSERT THE 'DS' RECORD WITH PARTIAL INFORMATION              10300000
103100***  THE STORE_ATTRIBUTES MESSAGE WILL HAVE THE REMAINING INFO    10310000
103200     PERFORM U9200-INSERT-TORGCLT                                 10320000
103300        THRU U9200-EXIT.                                          10330000
103400                                                                  10340000
103500***  INSERT DST/DS RELATIONSHIP -                                 10350000
103600***  THE STORE MESSAGE PROVIDES ALL THE INFO NEEDED FOR THE       10360000
103700***  DISTRICT/STORE RELATIONSHIP EXCEPT FOR THE EFF-END-TMST -    10370000
103800***  THIS WILL BE UPDATED BY THE WH_STORE_ASSIGN MESSAGE          10380000
103900                                                                  10390000
104000     INITIALIZE ORGCLT-ORG-CLUSTR-NAME.                           10400000
104100     MOVE HO100-STR-DISTRICT   TO WS-DISTRICT.                    10410000
104200                                                                  10420000
104300*** THIS IF STATMENT IS NEEDED TO PREVENT THE LEADING NUMBER      10430000
104400*** OF 3 CHARACTER DC FROM BEING TRUNCATED.                       10440000
104500     IF HO100-STR-DISTRICT > 99                                   10450000
104600        MOVE WS-DISTRICT(2:3)  TO ORGCLT-ORG-CLUSTR-NAME          10460000
104700                                  WS-DISTRICT-FINAL               10470000
104800     ELSE                                                         10480000
104900        MOVE WS-DISTRICT(3:2)  TO ORGCLT-ORG-CLUSTR-NAME          10490000
105000                                  WS-DISTRICT-FINAL               10500000
105100     END-IF.                                                      10510000
105200                                                                  10520000
105300     DISPLAY WS-DISTRICT-FINAL.                                   10530000
105400                                                                  10540000
105500     MOVE 'DST'                TO ORGCLT-HIER-CDE.                10550000
105600     SET TORGCLT-HIER-CDE      TO TRUE.                           10560000
105700     PERFORM U9000-SELECT-TORGCLT                                 10570000
105800        THRU U9000-EXIT.                                          10580000
105900                                                                  10590000
106000     IF TORGCLT-RCD-EXISTS                                        10600000
106100         MOVE ORGCLT-ORG-CLUSTR-ID TO WS-PRNT-CLUSTR-ID           10610000
106200                                                                  10620000
106300         INITIALIZE DCLTORGCLC                                    10630000
106400         MOVE WS-PRNT-CLUSTR-ID                                   10640000
106500                              TO ORGCLC-PRNT-ORG-CLUSTR-ID        10650000
106600         MOVE WS-CLUSTR-ID    TO ORGCLC-CHLD-ORG-CLUSTR-ID        10660000
106700         MOVE 'M'             TO ORGCLC-REL-TYP-CDE               10670000
106800         MOVE WS-INITIAL-TMST TO ORGCLC-EFF-BEG-TMST              10680000
106900         MOVE WS-CURRENT-DATE TO ORGCLC-EFF-BEG-TMST(1:10)        10690000
107000         MOVE -1              TO WS-CLC-EFF-END-TMST-NULL         10700000
107100                                                                  10710000
107200         PERFORM V9000-INSERT-TORGCLC                             10720000
107300            THRU V9000-EXIT                                       10730000
107400     ELSE                                                         10740000
107500         DISPLAY '**************************************'         10750000
107600         DISPLAY '                ERROR                 '         10760000
107700         DISPLAY 'DISTRICT ORG CLUSTER ID NOT FOUND     '         10770000
107800         DISPLAY 'COULD NOT INSERT TORGCLC RELATIONSHIP '         10780000
107900         DISPLAY 'FOR ' WS-DISTRICT-FINAL                         10790000
108000         DISPLAY '**************************************'         10800000
108100     END-IF.                                                      10810000
108200                                                                  10820000
108300     INITIALIZE DCLTPHYLOC.                                       10830000
108400     MOVE HO100-STR-NAME          TO PHYLOC-PHY-LOC-NAME.         10840000
108500     MOVE HO100-STR-ADD1-1-25     TO PHYLOC-ADR-LNE1-DESC.        10850000
108600     IF HO100-STR-ADD2-1-25 > SPACES                              10860000
108700         MOVE HO100-STR-ADD2-1-25 TO PHYLOC-ADR-LNE2-DESC         10870000
108800         MOVE 0                   TO WS-ADR-LNE2-DESC-NULL        10880000
108900     ELSE                                                         10890000
109000         MOVE -1                  TO WS-ADR-LNE2-DESC-NULL        10900000
109100     END-IF.                                                      10910000
109200                                                                  10920000
109300     MOVE HO100-STR-CITY-1-15  TO PHYLOC-CTY-NAME.                10930000
109400     MOVE HO100-STR-STATE-1-2  TO PHYLOC-ST-CDE.                  10940000
109500     MOVE ' '                  TO PHYLOC-OWN-LEASE-CDE.           10950000
109600     MOVE ZEROS                TO PHYLOC-TAX-PCT.                 10960000
109700                                                                  10970000
109800***  CONVERT THE INPUT ALPHANUMERIC ZIP CODE TO NUMERIC           10980000
109900     INITIALIZE WS-INPUT-NUMBER-IN                                10990000
110000                WS-OUTPUT-NUMBER-OUT                              11000000
110100                WS-ZIP-CODE-X-1-9.                                11010000
110200     MOVE HO100-STR-PCODE TO WS-INPUT-NUMBER-IN.                  11020000
110300                                                                  11030000
110400     PERFORM U8000-CONVERT-ALPHA-TO-NUMERIC                       11040000
110500        THRU U8000-EXIT.                                          11050000
110600                                                                  11060000
110700     MOVE WS-OUTPUT-NUMBER-OUT TO WS-ZIP-CODE-X.                  11070000
110800     MOVE WS-ZIP-CODE-X-1-9(1:5) TO WS-ZIP-CODE-Y-1-5.            11080000
110900                                                                  11090000
111000     IF WS-ZIP-CODE-X-1-9(6:4) = ZEROS                            11100000
111100         MOVE SPACES TO WS-ZIP-CODE-Y-7-10                        11110000
111200         MOVE SPACES TO WS-ZIP-CODE-Y-6                           11120000
111300     ELSE                                                         11130000
111400         MOVE WS-ZIP-CODE-X-1-9(6:4)                              11140000
111500                  TO WS-ZIP-CODE-Y-7-10                           11150000
111600         MOVE '-' TO WS-ZIP-CODE-Y-6                              11160000
111700     END-IF.                                                      11170000
111800     MOVE WS-ZIP-CODE-Y TO PHYLOC-ZIP-CDE.                        11180000
111900                                                                  11190000
112000     PERFORM T1000-CREATE-TPHYLOC-TORGPHY                         11200000
112100        THRU T1000-EXIT.                                          11210000
112200                                                                  11220000
112300 F1100-EXIT.                                                      11230000
112400     EXIT.                                                        11240000
112500                                                                  11250000
112600                                                                  11260000
112700 F1200-UPDATE-STORE.                                              11270000
112800                                                                  11280000
112900     DISPLAY 'F1200-UPDATE-STORE'.                                11290000
113000                                                                  11300000
113100***  WHEN A STORE IS BEING REOPENED, HO100-STR-CLOSE-DATE IS      11310000
113200***  RESET TO 9999-09-09.  SO YOU NEED TO CHECK ORGCLT-CLO-DTE    11320000
113300***  TO VERIFY WHETHER OR NOT WE ARE REOPENING A STORE THAT       11330000
113400***  WAS SET UP TO CLOSE.                                         11340000
113500                                                                  11350000
113600     MOVE ORGCLT-CLO-DTE TO WS-CLO-DTE.                           11360000
113700     INITIALIZE WS-DIST-END-TMST.                                 11370000
113800                                                                  11380000
113900***  STORE IS OPEN AND WILL REMAIN OPEN                           11390000
114000                                                                  11400000
114100     IF HO100-STR-CLOSE-DATE = '9999-09-09'                       11410000
114200       AND WS-CLO-DTE = SPACES                                    11420000
114300         SET TORGCLC-ACTIVE-TMST TO TRUE                          11430000
114400                                                                  11440000
114500***  STORE IS CLOSED AND WILL BE REOPENED -                       11450000
114600***  THE TORGCLC DC/DS RELATIONSHIPS WILL BE RE-ESTABLISHED       11460000
114700***  WHEN THE WH_STORE_ASSIGN MESSAGES ARE PROCESSED              11470000
114800                                                                  11480000
114900     ELSE IF HO100-STR-CLOSE-DATE = '9999-09-09'                  11490000
115000            AND WS-CLO-DTE > SPACES                               11500000
115100              INITIALIZE ORGCLT-CLO-DTE                           11510000
115200              MOVE -1 TO WS-CLO-DTE-NULL                          11520000
115300              SET TORGCLC-EXPIRED-TMST TO TRUE                    11530000
115400                                                                  11540000
115500***  STORE IS OPEN AND WILL BE CLOSED                             11550000
115600                                                                  11560000
115700     ELSE IF HO100-STR-CLOSE-DATE NOT = '9999-09-09'              11570000
115800            AND WS-CLO-DTE = SPACES                               11580000
115900             OR HO100-STR-ACTN-STP-ORD                            11590000
116000              PERFORM U8200-LOAD-DC-INFO                          11600000
116100                 THRU U8200-EXIT                                  11610000
116200              PERFORM F1210-SET-DC-STOP-DATES                     11620000
116300                 THRU F1210-EXIT                                  11630000
116400                                                                  11640000
116500***  RESELECT THE TORGCLT STORE RECORD INTO THE LAYOUT            11650000
116600***  SO IT CAN BE UPDATED                                         11660000
116700                                                                  11670000
116800              INITIALIZE ORGCLT-ORG-CLUSTR-NAME                   11680000
116900              MOVE HO100-STR-NBR      TO ORGCLT-ORG-CLUSTR-NAME   11690000
117000              MOVE 'DS'               TO ORGCLT-ORG-TYP-CDE       11700000
117100              SET TORGCLT-ORG-TYP-CDE TO TRUE                     11710000
117200              PERFORM U9000-SELECT-TORGCLT                        11720000
117300                 THRU U9000-EXIT                                  11730000
117400                                                                  11740000
117500              MOVE WS-INITIAL-END-TMST  TO ORGCLT-CLO-DTE         11750000
117600              MOVE HO100-STR-CLOSE-DATE TO ORGCLT-CLO-DTE(1:10)   11760000
117700              MOVE 0                    TO WS-CLO-DTE-NULL        11770000
117800              SET TORGCLC-ACTIVE-TMST   TO TRUE                   11780000
117900                                                                  11790000
118000              PERFORM U8400-SET-STORE-DATES                       11800000
118100                 THRU U8400-EXIT                                  11810000
118200                                                                  11820000
118300              MOVE ORGCLT-EFF-END-TMST TO WS-DIST-END-TMST        11830000
118400     END-IF.                                                      11840000
118500                                                                  11850000
118600     MOVE HO100-STR-NAME   TO ORGCLT-ORG-CLUSTR-DESC.             11860000
118700     MOVE HO100-STR-NAME10 TO ORGCLT-ORG-CLUSTR-NAME-10.          11870000
118800                                                                  11880000
118900***  STORE OPEN DATE MAY CHANGE FOR A FUTURE STORE                11890000
119000     MOVE HO100-STR-OPEN-DATE                                     11900000
119100                           TO ORGCLT-OPN-DTE(1:10).               11910000
119200                                                                  11920000
119300     PERFORM U9300-UPDATE-TORGCLT                                 11930000
119400        THRU U9300-EXIT.                                          11940000
119500                                                                  11950000
119600     PERFORM F1220-PROCESS-DIST-STORE-REL                         11960000
119700        THRU F1220-EXIT.                                          11970000
119800                                                                  11980000
119900     MOVE WS-CLUSTR-ID TO ORGPHY-ORG-CLUSTR-ID.                   11990000
120000     PERFORM T1900-SELECT-TPHYLOC-TORGPHY                         12000000
120100        THRU T1900-EXIT.                                          12010000
120200                                                                  12020000
120300     IF TPHYLOC-RCD-DOES-NOT-EXIST                                12030000
120400         INITIALIZE DCLTPHYLOC                                    12040000
120500     END-IF.                                                      12050000
120600                                                                  12060000
120700     MOVE HO100-STR-NAME       TO PHYLOC-PHY-LOC-NAME.            12070000
120800                                                                  12080000
120900     IF TPHYLOC-RCD-EXISTS                                        12090000
121000       IF HO100-STR-CITY-1-15 = 'NOT ASSIGNED   '                 12100000
121100         AND HO100-STR-STATE-1-2 = 'XX'                           12110000
121200           PERFORM T1850-UPDATE-TPHYLOC                           12120000
121300              THRU T1850-EXIT                                     12130000
121400           GO TO F1200-EXIT                                       12140000
121500       END-IF                                                     12150000
121600     END-IF.                                                      12160000
121700                                                                  12170000
121800     MOVE HO100-STR-ADD1-1-25  TO PHYLOC-ADR-LNE1-DESC.           12180000
121900                                                                  12190000
122000     IF HO100-STR-ADD2-1-25 > SPACES                              12200000
122100         MOVE HO100-STR-ADD2-1-25 TO PHYLOC-ADR-LNE2-DESC         12210000
122200         MOVE 0                   TO WS-ADR-LNE2-DESC-NULL        12220000
122300     ELSE                                                         12230000
122400         MOVE -1                  TO WS-ADR-LNE2-DESC-NULL        12240000
122500     END-IF.                                                      12250000
122600                                                                  12260000
122700     MOVE HO100-STR-CITY-1-15  TO PHYLOC-CTY-NAME.                12270000
122800     MOVE HO100-STR-STATE-1-2  TO PHYLOC-ST-CDE.                  12280000
122900                                                                  12290000
123000*** CONVERT THE INPUT ALPHANUMERIC ZIP CODE TO NUMERIC            12300000
123100     INITIALIZE WS-INPUT-NUMBER-IN                                12310000
123200                WS-OUTPUT-NUMBER-OUT                              12320000
123300                WS-ZIP-CODE-X-1-9.                                12330000
123400     MOVE HO100-STR-PCODE TO WS-INPUT-NUMBER-IN.                  12340000
123500                                                                  12350000
123600     PERFORM U8000-CONVERT-ALPHA-TO-NUMERIC                       12360000
123700        THRU U8000-EXIT.                                          12370000
123800                                                                  12380000
123900     MOVE WS-OUTPUT-NUMBER-OUT TO WS-ZIP-CODE-X.                  12390000
124000     MOVE WS-ZIP-CODE-X-1-9(1:5) TO WS-ZIP-CODE-Y-1-5.            12400000
124100                                                                  12410000
124200     IF WS-ZIP-CODE-X-1-9(6:4) = ZEROS                            12420000
124300         MOVE SPACES TO WS-ZIP-CODE-Y-7-10                        12430000
124400         MOVE SPACES TO WS-ZIP-CODE-Y-6                           12440000
124500     ELSE                                                         12450000
124600         MOVE WS-ZIP-CODE-X-1-9(6:4)                              12460000
124700                  TO WS-ZIP-CODE-Y-7-10                           12470000
124800         MOVE '-' TO WS-ZIP-CODE-Y-6                              12480000
124900     END-IF.                                                      12490000
125000     MOVE WS-ZIP-CODE-Y TO PHYLOC-ZIP-CDE.                        12500000
125100                                                                  12510000
125200     IF TPHYLOC-RCD-DOES-NOT-EXIST                                12520000
125300         MOVE ' '   TO PHYLOC-OWN-LEASE-CDE                       12530000
125400         MOVE ZEROS TO PHYLOC-TAX-PCT                             12540000
125500         PERFORM T1000-CREATE-TPHYLOC-TORGPHY                     12550000
125600            THRU T1000-EXIT                                       12560000
125700     ELSE                                                         12570000
125800         PERFORM T1800-UPDATE-TPHYLOC                             12580000
125900            THRU T1800-EXIT                                       12590000
126000     END-IF.                                                      12600000
126100                                                                  12610000
126200 F1200-EXIT.                                                      12620000
126300     EXIT.                                                        12630000
126400                                                                  12640000
126500                                                                  12650000
126600* ------------------------------------------------------------- * 12660000
126700* WHEN A STORE IS CLOSING, SET UP THE EXPIRATION OF THE DC/DS   * 12670000
126800* RELATIONSHIPS - INCLUDING FUTURE DC'S.                        * 12680000
126900* ------------------------------------------------------------- * 12690000
127000 F1210-SET-DC-STOP-DATES.                                         12700000
127100                                                                  12710000
127200     DISPLAY 'F1210-SET-DC-STOP-DATES'.                           12720000
127300                                                                  12730000
127400     IF HO100-STR-CLOSE-DATE <= WS-CURRENT-DATE                   12740000
127500         MOVE WS-CURRENT-DATE           TO WS-DATE-DEC-DAYS       12750000
127600     ELSE                                                         12760000
127700         MOVE HO100-STR-CLOSE-DATE      TO WS-START-DATE          12770000
127800         MOVE HO100-STR-STOP-ORDER-DAYS TO WS-DAYS                12780000
127900         PERFORM U8100-DECREMENT-DATE                             12790000
128000            THRU U8100-EXIT                                       12800000
128100     END-IF.                                                      12810000
128200                                                                  12820000
128300     IF WS-DC-EFF-BEG-TMST(1)(1:10) > WS-CURRENT-DATE             12830000
128400       AND WS-DC-EFF-BEG-TMST(1) > WS-DC-EFF-END-TMST(2)          12840000
128500       AND WS-DC-EFF-END-TMST(2) NOT = SPACES                     12850000
128600         PERFORM F1212-LOAD-DC2-STOP-DATE                         12860000
128700            THRU F1212-EXIT                                       12870000
128800     ELSE                                                         12880000
128900         PERFORM F1211-LOAD-DC1-STOP-DATE                         12890000
129000            THRU F1211-EXIT                                       12900000
129100     END-IF.                                                      12910000
129200                                                                  12920000
129300 F1210-EXIT.                                                      12930000
129400     EXIT.                                                        12940000
129500                                                                  12950000
129600                                                                  12960000
129700 F1211-LOAD-DC1-STOP-DATE.                                        12970000
129800                                                                  12980000
129900     DISPLAY 'F1211-LOAD-DC1-STOP-DATE'.                          12990000
130000                                                                  13000000
130100     MOVE WS-INITIAL-END-TMST TO ORGCLC-EFF-END-TMST              13010000
130200                                 WS-DC-EFF-END-TMST(1).           13020000
130300     MOVE 0                   TO WS-CLC-EFF-END-TMST-NULL.        13030000
130400                                                                  13040000
130500     IF WS-DATE-DEC-DAYS < WS-DC-EFF-BEG-TMST(1)(1:10)            13050000
130600       OR WS-DATE-DEC-DAYS < WS-CURRENT-DATE                      13060000
130700         MOVE WS-CURRENT-DATE TO ORGCLC-EFF-END-TMST(1:10)        13070000
130800                                 WS-DC-EFF-END-TMST(1)(1:10)      13080000
130900     ELSE                                                         13090000
131000         MOVE WS-DATE-DEC-DAYS TO ORGCLC-EFF-END-TMST(1:10)       13100000
131100                                  WS-DC-EFF-END-TMST(1)(1:10)     13110000
131200     END-IF.                                                      13120000
131300                                                                  13130000
131400     MOVE WS-DC-CLUSTR-ID(1) TO ORGCLC-PRNT-ORG-CLUSTR-ID.        13140000
131500     MOVE WS-CLUSTR-ID       TO ORGCLC-CHLD-ORG-CLUSTR-ID.        13150000
131600     MOVE 'D'                TO ORGCLC-REL-TYP-CDE.               13160000
131700     MOVE WS-DC-EFF-BEG-TMST(1)                                   13170000
131800                             TO ORGCLC-EFF-BEG-TMST               13180000
131900                                WS-ORGCLC-EFF-BEG-TMST.           13190000
132000                                                                  13200000
132100     PERFORM V9100-UPDATE-TORGCLC                                 13210000
132200        THRU V9100-EXIT.                                          13220000
132300                                                                  13230000
132400 F1211-EXIT.                                                      13240000
132500     EXIT.                                                        13250000
132600                                                                  13260000
132700                                                                  13270000
132800 F1212-LOAD-DC2-STOP-DATE.                                        13280000
132900                                                                  13290000
133000     DISPLAY 'F1212-LOAD-DC2-STOP-DATE'.                          13300000
133100                                                                  13310000
133200     MOVE WS-CLUSTR-ID        TO ORGCLC-CHLD-ORG-CLUSTR-ID.       13320000
133300     MOVE 'D'                 TO ORGCLC-REL-TYP-CDE.              13330000
133400     MOVE WS-INITIAL-END-TMST TO ORGCLC-EFF-END-TMST              13340000
133500                                 WS-DC-EFF-END-TMST(1)            13350000
133600                                 WS-DC-EFF-END-TMST(2).           13360000
133700     MOVE 0                   TO WS-CLC-EFF-END-TMST-NULL.        13370000
133800                                                                  13380000
133900     IF WS-DATE-DEC-DAYS < WS-DC-EFF-BEG-TMST(2)(1:10)            13390000
134000       OR WS-DATE-DEC-DAYS < WS-CURRENT-DATE                      13400000
134100         MOVE WS-CURRENT-DATE TO ORGCLC-EFF-END-TMST(1:10)        13410000
134200                                 WS-DC-EFF-END-TMST(2)(1:10)      13420000
134300     ELSE                                                         13430000
134400         MOVE WS-DATE-DEC-DAYS TO ORGCLC-EFF-END-TMST(1:10)       13440000
134500                                  WS-DC-EFF-END-TMST(2)(1:10)     13450000
134600     END-IF.                                                      13460000
134700                                                                  13470000
134800     MOVE WS-DC-CLUSTR-ID(2) TO ORGCLC-PRNT-ORG-CLUSTR-ID.        13480000
134900     MOVE WS-DC-EFF-BEG-TMST(2)                                   13490000
135000                             TO ORGCLC-EFF-BEG-TMST               13500000
135100                                WS-ORGCLC-EFF-BEG-TMST.           13510000
135200                                                                  13520000
135300     PERFORM V9100-UPDATE-TORGCLC                                 13530000
135400        THRU V9100-EXIT.                                          13540000
135500                                                                  13550000
135600***  FOR A FUTURE ASSIGNMENT DC, EXPIRE W/ CURRENT DATE           13560000
135700***  VSM MOVES 9'S TO ALL FIELDS                                  13570000
135800                                                                  13580000
135900     MOVE WS-CURRENT-DATE TO ORGCLC-EFF-END-TMST(1:10)            13590000
136000                             WS-DC-EFF-END-TMST(1)(1:10).         13600000
136100                                                                  13610000
136200     MOVE WS-DC-CLUSTR-ID(1) TO ORGCLC-PRNT-ORG-CLUSTR-ID.        13620000
136300     MOVE WS-DC-EFF-BEG-TMST(1)                                   13630000
136400                             TO ORGCLC-EFF-BEG-TMST               13640000
136500                                WS-ORGCLC-EFF-BEG-TMST.           13650000
136600                                                                  13660000
136700     PERFORM V9100-UPDATE-TORGCLC                                 13670000
136800        THRU V9100-EXIT.                                          13680000
136900                                                                  13690000
137000 F1212-EXIT.                                                      13700000
137100     EXIT.                                                        13710000
137200                                                                  13720000
137300                                                                  13730000
137400 F1220-PROCESS-DIST-STORE-REL.                                    13740000
137500                                                                  13750000
137600***  LOOK UP CURRENT DISTRICT RELATIONSHIP                        13760000
137700***  IN THE CASE OF 'CLOSED' STORE BEING REOPENED,                13770000
137800***  THIS LOOKUP MAY BE FOR AN EXPIRED DISTRICT/STORE             13780000
137900***  RELATIONSHIP                                                 13790000
138000                                                                  13800000
138100     MOVE WS-CLUSTR-ID TO ORGCLC-CHLD-ORG-CLUSTR-ID.              13810000
138200     MOVE 'M'          TO ORGCLC-REL-TYP-CDE.                     13820000
138300     IF TORGCLC-ACTIVE-TMST                                       13830000
138400         PERFORM V9500-SELECT-CURR-DIST-REL                       13840000
138500            THRU V9500-EXIT                                       13850000
138600     ELSE                                                         13860000
138700         PERFORM V9400-GET-LAST-DIST-REL                          13870000
138800            THRU V9400-EXIT                                       13880000
138900     END-IF.                                                      13890000
139000                                                                  13900000
139100     IF TORGCLC-RCD-EXISTS                                        13910000
139200         MOVE ORGCLC-PRNT-ORG-CLUSTR-ID TO WS-PRNT-CLUSTR-ID      13920000
139300     ELSE                                                         13930000
139400         GO TO F1220-EXIT                                         13940000
139500     END-IF.                                                      13950000
139600                                                                  13960000
139700***  IF THE STORE IS CLOSING, THE STORE CLOSE DATE WILL           13970000
139800***  NOT = '9999-09-09'                                           13980000
139900     IF HO100-STR-CLOSE-DATE NOT = '9999-09-09'                   13990000
140000                                                                  14000000
140100         MOVE WS-PRNT-CLUSTR-ID TO ORGCLC-PRNT-ORG-CLUSTR-ID      14010000
140200         MOVE WS-CLUSTR-ID      TO ORGCLC-CHLD-ORG-CLUSTR-ID      14020000
140300         MOVE 'M'               TO ORGCLC-REL-TYP-CDE             14030000
140400         MOVE ORGCLC-EFF-BEG-TMST                                 14040000
140500                                TO WS-ORGCLC-EFF-BEG-TMST         14050000
140600         MOVE WS-DIST-END-TMST  TO ORGCLC-EFF-END-TMST            14060000
140700         MOVE 0                 TO WS-CLC-EFF-END-TMST-NULL       14070000
140800                                                                  14080000
140900         PERFORM V9100-UPDATE-TORGCLC                             14090000
141000            THRU V9100-EXIT                                       14100000
141100                                                                  14110000
141200         GO TO F1220-EXIT                                         14120000
141300                                                                  14130000
141400     END-IF.                                                      14140000
141500                                                                  14150000
141600     MOVE WS-PRNT-CLUSTR-ID TO ORGCLT-ORG-CLUSTR-ID.              14160000
141700     PERFORM U9400-SELECT-TORGCLT-ID                              14170000
141800        THRU U9400-EXIT.                                          14180000
141900                                                                  14190000
142000***  LOOK UP CURRENT DISTRICT ON TORGCLT                          14200000
142100     IF TORGCLT-RCD-EXISTS                                        14210000
142200         CONTINUE                                                 14220000
142300     ELSE                                                         14230000
142400         DISPLAY '**************************************'         14240000
142500         DISPLAY '                ERROR                 '         14250000
142600         DISPLAY 'DISTRICT ORG CLUSTER ID NOT FOUND     '         14260000
142700         DISPLAY 'FOR ' WS-DISTRICT (2:3)                         14270000
142800         DISPLAY '**************************************'         14280000
142900         GO TO F1220-EXIT                                         14290000
143000     END-IF.                                                      14300000
143100                                                                  14310000
143200     MOVE HO100-STR-DISTRICT TO WS-DISTRICT.                      14320000
143300                                                                  14330000
143400*** THE DISTRICT CHECK IS NEEDED TO PREVENT THE LEADING NUMBER    14340000
143500*** OF 3 CHARACTER DC FROM BEING TRUNCATED.                       14350000
143600     IF HO100-STR-DISTRICT > 99                                   14360000
143700        MOVE WS-DISTRICT(2:3) TO WS-DISTRICT-FINAL                14370000
143800     ELSE                                                         14380000
143900        MOVE WS-DISTRICT(3:2) TO WS-DISTRICT-FINAL                14390000
144000     END-IF.                                                      14400000
144100                                                                  14410000
144200*** CHECKING THE ORGCLT-ORG-CLUSTR-NAME THIS WAY WILL PREVENT     14420000
144300*** THE SCENARIO WHERE NEW DISTRICT = 01 AND OLD DISTRICT = 101   14430000
144400*** FROM CONSIDER "EQUAL".                                        14440000
144500     IF WS-DISTRICT-FINAL = ORGCLT-ORG-CLUSTR-NAME (1:3)          14450000
144600                                                                  14460000
144700*** THE STORE WAS CLOSED AND REOPENED.  SO THE DISTRICT/STORE     14470000
144800*** RELATIONSHIP NEEDS TO BE REACTIVATED                          14480000
144900                                                                  14490000
145000         IF HO100-STR-CLOSE-DATE = '9999-09-09'                   14500000
145100           AND WS-CLO-DTE > SPACES                                14510000
145200             MOVE WS-PRNT-CLUSTR-ID                               14520000
145300                          TO ORGCLC-PRNT-ORG-CLUSTR-ID            14530000
145400             MOVE WS-CLUSTR-ID                                    14540000
145500                          TO ORGCLC-CHLD-ORG-CLUSTR-ID            14550000
145600             MOVE 'M' TO ORGCLC-REL-TYP-CDE                       14560000
145700             MOVE ORGCLC-EFF-BEG-TMST                             14570000
145800                          TO WS-ORGCLC-EFF-BEG-TMST               14580000
145900             INITIALIZE  ORGCLC-EFF-END-TMST                      14590000
146000             MOVE -1  TO WS-CLC-EFF-END-TMST-NULL                 14600000
146100             PERFORM V9100-UPDATE-TORGCLC                         14610000
146200                THRU V9100-EXIT                                   14620000
146300         END-IF                                                   14630000
146400                                                                  14640000
146500         GO TO F1220-EXIT                                         14650000
146600                                                                  14660000
146700     END-IF.                                                      14670000
146800                                                                  14680000
146900***  THE STORE IS BEING MOVED TO A NEW DISTRICT                   14690000
147000***  EXPIRE THE OLD DISTRICT/STORE TORGCLC RELATIONSHIP           14700000
147100     MOVE WS-PRNT-CLUSTR-ID TO ORGCLC-PRNT-ORG-CLUSTR-ID.         14710000
147200     MOVE WS-CLUSTR-ID      TO ORGCLC-CHLD-ORG-CLUSTR-ID.         14720000
147300     MOVE 'M'               TO ORGCLC-REL-TYP-CDE.                14730000
147400     MOVE ORGCLC-EFF-BEG-TMST                                     14740000
147500                            TO WS-ORGCLC-EFF-BEG-TMST.            14750000
147600     MOVE WS-INITIAL-END-TMST                                     14760000
147700                            TO ORGCLC-EFF-END-TMST.               14770000
147800     MOVE WS-CURRENT-DATE   TO ORGCLC-EFF-END-TMST(1:10).         14780000
147900     MOVE 0                 TO WS-CLC-EFF-END-TMST-NULL.          14790000
148000     PERFORM V9100-UPDATE-TORGCLC                                 14800000
148100        THRU V9100-EXIT.                                          14810000
148200                                                                  14820000
148300***  LOOK UP NEW DISTRICT ON TORGCLT                              14830000
148400     INITIALIZE ORGCLT-ORG-CLUSTR-NAME.                           14840000
148500                                                                  14850000
148600*** THIS IF STATEMENT IS NEEDED TO PREVENT THE LEADING NUMBER     14860000
148700*** OF 3 CHARACTER DC FROM BEING TRUNCATED.                       14870000
148800     IF HO100-STR-DISTRICT > 99                                   14880000
148900        MOVE WS-DISTRICT(2:3)  TO ORGCLT-ORG-CLUSTR-NAME          14890000
149000                                  WS-DISTRICT-FINAL               14900000
149100     ELSE                                                         14910000
149200        MOVE WS-DISTRICT(3:2)  TO ORGCLT-ORG-CLUSTR-NAME          14920000
149300                                  WS-DISTRICT-FINAL               14930000
149400     END-IF.                                                      14940000
149500                                                                  14950000
149600     MOVE 'DST'             TO ORGCLT-HIER-CDE.                   14960000
149700     SET TORGCLT-HIER-CDE   TO TRUE.                              14970000
149800     PERFORM U9000-SELECT-TORGCLT                                 14980000
149900        THRU U9000-EXIT.                                          14990000
150000                                                                  15000000
150100     IF TORGCLT-RCD-EXISTS                                        15010000
150200         MOVE ORGCLT-ORG-CLUSTR-ID TO WS-PRNT-CLUSTR-ID           15020000
150300                                                                  15030000
150400***  CREATE THE NEW DISTRICT/STORE TORGCLC RELATIONSHIP           15040000
150500         INITIALIZE DCLTORGCLC                                    15050000
150600         MOVE WS-PRNT-CLUSTR-ID TO ORGCLC-PRNT-ORG-CLUSTR-ID      15060000
150700         MOVE WS-CLUSTR-ID      TO ORGCLC-CHLD-ORG-CLUSTR-ID      15070000
150800         MOVE 'M'               TO ORGCLC-REL-TYP-CDE             15080000
150900         MOVE WS-INITIAL-TMST   TO ORGCLC-EFF-BEG-TMST            15090000
151000         MOVE WS-CURRENT-DATE   TO ORGCLC-EFF-BEG-TMST(1:10)      15100000
151100         MOVE -1                TO WS-CLC-EFF-END-TMST-NULL       15110000
151200                                                                  15120000
151300         PERFORM V9000-INSERT-TORGCLC                             15130000
151400            THRU V9000-EXIT                                       15140000
151500                                                                  15150000
151600     ELSE                                                         15160000
151700         DISPLAY '**************************************'         15170000
151800         DISPLAY '                ERROR                 '         15180000
151900         DISPLAY 'DISTRICT ORG CLUSTER ID NOT FOUND     '         15190000
152000         DISPLAY 'COULD NOT INSERT TORGCLC RELATIONSHIP '         15200000
152100         DISPLAY 'FOR ' WS-DISTRICT-FINAL                         15210000
152200         DISPLAY '**************************************'         15220000
152300     END-IF.                                                      15230000
152400                                                                  15240000
152500 F1220-EXIT.                                                      15250000
152600     EXIT.                                                        15260000
152700                                                                  15270000
152800                                                                  15280000
152900 G1000-PROCESS-STORE-ATTRIB.                                      15290000
153000                                                                  15300000
153100     DISPLAY 'G1000-PROCESS-STORE-ATRIB'.                         15310000
153200     DISPLAY 'STORE:  ' HO100-SATTR-STR-NBR.                      15320000
153300                                                                  15330000
153400* HO100-ACTN-TYP-CDE IS NOT CHECKED FOR STORE_ATTRIBUTES          15340000
153500* RECORDS BECAUSE THE STORE MESSAGE MUST HAVE ALREADY             15350000
153600* INSERTED THE RECORD - IF NOT, THE STORE_ATTRIBUTES MESSAGE      15360000
153700* IS BYPASSED HERE                                                15370000
153800                                                                  15380000
153900     INITIALIZE ORGCLT-ORG-CLUSTR-NAME.                           15390000
154000     MOVE HO100-SATTR-STR-NBR TO ORGCLT-ORG-CLUSTR-NAME.          15400000
154100     MOVE 'DS'                TO ORGCLT-ORG-TYP-CDE.              15410000
154200     SET TORGCLT-ORG-TYP-CDE  TO TRUE.                            15420000
154300                                                                  15430000
154400     PERFORM U9000-SELECT-TORGCLT                                 15440000
154500        THRU U9000-EXIT.                                          15450000
154600                                                                  15460000
154700     IF TORGCLT-RCD-EXISTS                                        15470000
154800         MOVE ORGCLT-ORG-CLUSTR-ID TO WS-CLUSTR-ID                15480000
154900     ELSE                                                         15490000
155000         GO TO G1000-EXIT                                         15500000
155100     END-IF.                                                      15510000
155200                                                                  15520000
155300     IF HO100-SATTR-REPLT-STR-NBR > 0                             15530000
155400                                                                  15540000
155500         INITIALIZE ORGCLT-ORG-CLUSTR-NAME                        15550000
155600         MOVE HO100-SATTR-REPLT-STR-NBR(2:4)                      15560000
155700                         TO ORGCLT-ORG-CLUSTR-NAME                15570000
155800         MOVE 'DS'       TO ORGCLT-ORG-TYP-CDE                    15580000
155900         SET TORGCLT-ORG-TYP-CDE TO TRUE                          15590000
156000                                                                  15600000
156100         PERFORM U9000-SELECT-TORGCLT                             15610000
156200            THRU U9000-EXIT                                       15620000
156300                                                                  15630000
156400         IF TORGCLT-RCD-EXISTS                                    15640000
156500             MOVE ORGCLT-ORG-CLUSTR-ID                            15650000
156600                               TO WS-REPL-CLUSTR-ID               15660000
156700         ELSE                                                     15670000
156800             MOVE ZEROS        TO WS-REPL-CLUSTR-ID               15680000
156900         END-IF                                                   15690000
157000                                                                  15700000
157100***  THE TORGCLT STORE RECORD NEEDS TO BE RESELECTED              15710000
157200***  BECAUSE THE VALUES WERE OVERLAID BY THE REPLACEMENT          15720000
157300***  STORE SELECT                                                 15730000
157400                                                                  15740000
157500         INITIALIZE ORGCLT-ORG-CLUSTR-NAME                        15750000
157600         MOVE HO100-SATTR-STR-NBR TO ORGCLT-ORG-CLUSTR-NAME       15760000
157700         MOVE 'DS'                TO ORGCLT-ORG-TYP-CDE           15770000
157800         SET TORGCLT-ORG-TYP-CDE  TO TRUE                         15780000
157900                                                                  15790000
158000         PERFORM U9000-SELECT-TORGCLT                             15800000
158100            THRU U9000-EXIT                                       15810000
158200                                                                  15820000
158300         IF WS-REPL-CLUSTR-ID > 0                                 15830000
158400             MOVE WS-REPL-CLUSTR-ID                               15840000
158500                               TO ORGCLT-REPL-ORG-CLUSTR-ID       15850000
158600             MOVE 0            TO WS-REPL-ORG-CLUSTR-ID-NULL      15860000
158700         END-IF                                                   15870000
158800     END-IF.                                                      15880000
158900                                                                  15890000
159000                                                                  15900000
159100     MOVE HO100-SATTR-STR-NM-5-ABBR                               15910000
159200                  TO ORGCLT-ORG-CLUSTR-NAME-5.                    15920000
159300     MOVE HO100-SATTR-E-BUS-LOC-IND                               15930000
159400                  TO ORGCLT-E-BUS-LOC-IND.                        15940000
159500     MOVE 0       TO WS-ORG-CLUSTR-NAME-5-NULL.                   15950000
159600                                                                  15960000
159700     PERFORM U9300-UPDATE-TORGCLT                                 15970000
159800        THRU U9300-EXIT.                                          15980000
159900                                                                  15990000
160000 G1000-EXIT.                                                      16000000
160100     EXIT.                                                        16010000
160200                                                                  16020000
160300                                                                  16030000
160400 H1000-PROCESS-WH-STR-ASSIGN.                                     16040000
160500                                                                  16050000
160600     DISPLAY 'H1000-PROCESS-WH-STR-ASSIGN'.                       16060000
160700     DISPLAY 'STORE:  ' HO100-SA-STORE-NUMBER.                    16070000
160800     DISPLAY 'WAREHOUSE:  ' HO100-SA-WH.                          16080000
160900                                                                  16090000
161000     INITIALIZE ORGCLT-ORG-CLUSTR-NAME.                           16100000
161100     MOVE HO100-SA-STORE-NUMBER TO WS-STORE-NBR.                  16110000
161200     MOVE WS-STORE-NBR          TO ORGCLT-ORG-CLUSTR-NAME.        16120000
161300     MOVE 'DS'                  TO ORGCLT-ORG-TYP-CDE.            16130000
161400     SET TORGCLT-ORG-TYP-CDE    TO TRUE.                          16140000
161500                                                                  16150000
161600     PERFORM U9000-SELECT-TORGCLT                                 16160000
161700        THRU U9000-EXIT.                                          16170000
161800                                                                  16180000
161900     IF TORGCLT-RCD-EXISTS                                        16190000
162000         MOVE ORGCLT-ORG-CLUSTR-ID TO WS-CLUSTR-ID                16200000
162100                                                                  16210000
162200         IF ORGCLT-CLO-DTE NOT = SPACES                           16220000
162300           AND HO100-SA-ASSIGN-DATE > WS-CURRENT-DATE             16230000
162400             DISPLAY 'TRYING TO ASSIGN A FUTURE '                 16240000
162500             DISPLAY 'WH ON A CLOSED STORE ' HO100-SA-WH          16250000
162600             DISPLAY ' FOR STORE ' HO100-SA-STORE-NUMBER          16260000
162700             GO TO H1000-EXIT                                     16270000
162800         END-IF                                                   16280000
162900     ELSE                                                         16290000
163000         GO TO H1000-EXIT                                         16300000
163100     END-IF.                                                      16310000
163200                                                                  16320000
163300****  DC 0899 IS A BOGUS DC THAT'S USED WHEN A STORE HAS          16330000
163400****  NOT BEEN OFFICIALLY ASSIGNED TO A DC                        16340000
163500                                                                  16350000
163600****  WE DO NOT KEEP DC 0899 IN THE TORGCLT TABLE SO THIS         16360000
163700****  WH-STR-ASSIGN RECORD IS BYPASSED - HOWEVER WE DO NEED       16370000
163800****  TO RETRIEVE THE HO100-SA-ASSIGN-DATE FROM THIS RECORD       16380000
163900****  TO SET THE STORE EFF-BEG-TMST                               16390000
164000                                                                  16400000
164100     IF HO100-SA-WH = WS-DEFAULT-DC                               16410000
164200         IF HO100-ACTN-TYP-INSERT                                 16420000
164300           OR HO100-ACTN-TYP-UPDATE                               16430000
164400             MOVE WS-INITIAL-TMST TO ORGCLT-EFF-BEG-TMST          16440000
164500             MOVE HO100-SA-ASSIGN-DATE                            16450000
164600                                  TO ORGCLT-EFF-BEG-TMST(1:10)    16460000
164700             PERFORM U9300-UPDATE-TORGCLT                         16470000
164800                THRU U9300-EXIT                                   16480000
164900             GO TO H1000-EXIT                                     16490000
165000         END-IF                                                   16500000
165100     END-IF.                                                      16510000
165200                                                                  16520000
165300     PERFORM U8200-LOAD-DC-INFO                                   16530000
165400        THRU U8200-EXIT.                                          16540000
165500                                                                  16550000
165600*  WH-STR-ASSIGN RECORDS WITH AN ACTN-TYP-UPDATE COME             16560000
165700*  THROUGH FOR STORES THAT WERE ASSIGNED TO DC 0899.              16570000
165800*  WS-DC-EFF-BEG-TMST(1) = SPACES VERIFIES THAT THIS              16580000
165900*  STORE HAS NOT BEEN ASSIGNED TO A DC.  U8200-LOAD-DC-INFO       16590000
166000*  LOADS THE DATA INTO WS-DC-EFF-BEG-TMST(1).                     16600000
166100                                                                  16610000
166200     IF HO100-ACTN-TYP-INSERT                                     16620000
166300       OR HO100-ACTN-TYP-UPDATE                                   16630000
166400         PERFORM H1100-SETUP-DC-STORE-ASSIGN                      16640000
166500            THRU H1100-EXIT                                       16650000
166600     END-IF.                                                      16660000
166700                                                                  16670000
166800*    ELSE IF HO100-ACTN-TYP-UPDATE                                16680000
166900                                                                  16690000
167000*  R1 AND R2 ARE RMS INDICATORS FOR DC REPLACEMENT                16700000
167100*  THE R1 AND R2 VALUES SHOULD BE CHECKED IN                      16710000
167200*  HO100-SA-REPLACE-DC                                            16720000
167300*  IN TESTING, R1 AND R2 WERE FOUND IN                            16730000
167400*  HO100-SA-OLD-ASSIGN-DATE.  THIS NEEDS TO BE CHECKED            16740000
167500*  INTO FURTHER BEFORE THE CODE IS UNCOMMENTED                    16750000
167600                                                                  16760000
167700*            IF HO100-SA-OLD-ASSIGN-DATE(1:2) = 'R1'              16770000
167800*              OR HO100-SA-OLD-ASSIGN-DATE(1:2) = 'R2'            16780000
167900*                PERFORM H1200-REACTIVE-DC                        16790000
168000*                   THRU H1200-EXIT                               16800000
168100*            ELSE                                                 16810000
168200*                PERFORM H1300-UPDATE-FUTURE-STORE-WH             16820000
168300*                   THRU H1300-EXIT                               16830000
168400*            END-IF                                               16840000
168500                                                                  16850000
168600*    END-IF.                                                      16860000
168700                                                                  16870000
168800* RESELECT THE STORE RECORD INTO THE TORGCLT LAYOUT               16880000
168900* SO IT CAN BE UPDATED                                            16890000
169000                                                                  16900000
169100     INITIALIZE ORGCLT-ORG-CLUSTR-NAME.                           16910000
169200     MOVE WS-STORE-NBR       TO ORGCLT-ORG-CLUSTR-NAME.           16920000
169300     MOVE 'DS'               TO ORGCLT-ORG-TYP-CDE.               16930000
169400     SET TORGCLT-ORG-TYP-CDE TO TRUE.                             16940000
169500                                                                  16950000
169600     PERFORM U9000-SELECT-TORGCLT                                 16960000
169700        THRU U9000-EXIT.                                          16970000
169800                                                                  16980000
169900*** TO FIX TORGCLT-EFF-BEG-TMST AND TORGCLT-EFF-END-TMST     ***  16990000
170000*** ISSUE WHEN STORE OPEN DATE IS PUSHED TO A LATER DATE.    ***  17000000
170100*** THIS MODULE MODELS U8400-SET-STORE-DATES.                ***  17010000
170200     PERFORM U8500-SET-STORE-EFF-DATES.                           17020000
170300                                                                  17030000
170400***  SAVE THE STORE EFF-END-TMST SO IT CAN BE USED TO UPDATE      17040000
170500***  THE DISTRICT/STORE TORGCLC RELATIONSHIP                      17050000
170600                                                                  17060000
170700     IF ORGCLT-EFF-END-TMST > SPACES                              17070000
170800         MOVE ORGCLT-EFF-END-TMST TO WS-DIST-END-TMST             17080000
170900     ELSE                                                         17090000
171000         INITIALIZE WS-DIST-END-TMST                              17100000
171100     END-IF.                                                      17110000
171200                                                                  17120000
171300     PERFORM U9300-UPDATE-TORGCLT                                 17130000
171400        THRU U9300-EXIT.                                          17140000
171500                                                                  17150000
171600***  UPDATE THE TORGCLC DIST/DS RELATIONSHIP EFF-END-TMST         17160000
171700***  THIS CODE IN A FOLLOW-UP TO THE DIST/DS RELATIONSHIP         17170000
171800***  CREATED WHEN THE STORE MESSAGE WAS PROCESSED                 17180000
171900                                                                  17190000
172000     MOVE WS-CLUSTR-ID TO ORGCLC-CHLD-ORG-CLUSTR-ID.              17200000
172100     MOVE 'M'          TO ORGCLC-REL-TYP-CDE.                     17210000
172200     PERFORM V9500-SELECT-CURR-DIST-REL                           17220000
172300        THRU V9500-EXIT.                                          17230000
172400                                                                  17240000
172500     IF TORGCLC-RCD-EXISTS                                        17250000
172600                                                                  17260000
172700***  THE ONLY PURPOSE OF THIS UPDATE IS TO UPDATE THE             17270000
172800***  EFF-END-TMST.  THE EFF-BEG-TMST IS MOVED TO                  17280000
172900***  WS-ORGCLC-EFF-BEG-TMST BECAUSE THIS FIELD IS USED IN         17290000
173000***  UPDATE CLAUSE                                                17300000
173100                                                                  17310000
173200         IF WS-DIST-END-TMST > SPACES                             17320000
173300             MOVE ORGCLC-EFF-BEG-TMST                             17330000
173400                       TO WS-ORGCLC-EFF-BEG-TMST                  17340000
173500             MOVE WS-DIST-END-TMST                                17350000
173600                       TO ORGCLC-EFF-END-TMST                     17360000
173700             MOVE 0    TO WS-CLC-EFF-END-TMST-NULL                17370000
173800             PERFORM V9100-UPDATE-TORGCLC                         17380000
173900                THRU V9100-EXIT                                   17390000
174000         END-IF                                                   17400000
174100     END-IF.                                                      17410000
174200                                                                  17420000
174300 H1000-EXIT.                                                      17430000
174400     EXIT.                                                        17440000
174500                                                                  17450000
174600                                                                  17460000
174700 H1100-SETUP-DC-STORE-ASSIGN.                                     17470000
174800                                                                  17480000
174900     DISPLAY 'H1100-SETUP-DC-STORE-ASSIGN'.                       17490000
175000                                                                  17500000
175100***  RMS WILL ONLY ALLOW 2 ACTIVE DC'S AT ONCE - THIS IS          17510000
175200***  DRIVEN BY EFF-END-TMST - SO UNTIL THE EFF-END-TMST           17520000
175300***  IS LATER THAN CURRENT DATE, NO NEW WH_STORE_ASSIGN           17530000
175400***  MESSAGES CAN BE CREATED                                      17540000
175500                                                                  17550000
175600***  NEW STORE - FIRST DC ASSIGNMENT                              17560000
175700     IF WS-DC-EFF-BEG-TMST(1) = SPACES                            17570000
175800                                                                  17580000
175900         INITIALIZE ORGCLT-ORG-CLUSTR-NAME                        17590000
176000         MOVE HO100-SA-WH TO ORGCLT-ORG-CLUSTR-NAME               17600000
176100         MOVE 'DC'        TO ORGCLT-ORG-TYP-CDE                   17610000
176200         SET TORGCLT-ORG-TYP-CDE TO TRUE                          17620000
176300                                                                  17630000
176400         PERFORM U9000-SELECT-TORGCLT                             17640000
176500            THRU U9000-EXIT                                       17650000
176600                                                                  17660000
176700         IF TORGCLT-RCD-EXISTS                                    17670000
176800             MOVE ORGCLT-ORG-CLUSTR-ID                            17680000
176900                               TO WS-PRNT-CLUSTR-ID               17690000
177000                                                                  17700000
177100***  SET UP THE RECORD FOR INSERT, BUT CHECK IF AN ACTIVE         17710000
177200***  RELATIONSHIP EXISTS BEFORE TRYING TO INSERT                  17720000
177300                                                                  17730000
177400             INITIALIZE DCLTORGCLC                                17740000
177500             MOVE WS-PRNT-CLUSTR-ID                               17750000
177600                               TO ORGCLC-PRNT-ORG-CLUSTR-ID       17760000
177700             MOVE WS-CLUSTR-ID TO ORGCLC-CHLD-ORG-CLUSTR-ID       17770000
177800             MOVE 'D'          TO ORGCLC-REL-TYP-CDE              17780000
177900             MOVE WS-INITIAL-TMST TO ORGCLC-EFF-BEG-TMST          17790000
178000             MOVE HO100-SA-ASSIGN-DATE                            17800000
178100                                  TO ORGCLC-EFF-BEG-TMST(1:10)    17810000
178200             MOVE -1              TO WS-CLC-EFF-END-TMST-NULL     17820000
178300                                                                  17830000
178400             PERFORM V9300-SELECT-TORGCLC-PRNT-CHLD               17840000
178500                THRU V9300-EXIT                                   17850000
178600                                                                  17860000
178700             IF TORGCLC-RCD-DOES-NOT-EXIST                        17870000
178800                 PERFORM V9000-INSERT-TORGCLC                     17880000
178900                    THRU V9000-EXIT                               17890000
179000                                                                  17900000
179100***  UPDATE WS-DC-TABLE SO IT CAN BE USED TO UPDATE THE           17910000
179200***  TORGCLT DS RECORD'S EFF-BEG-TMST AND EFF-END-TMST            17920000
179300                                                                  17930000
179400                 MOVE WS-PRNT-CLUSTR-ID TO WS-DC-CLUSTR-ID(1)     17940000
179500                 MOVE HO100-SA-WH     TO WS-DC-ORG-CLUSTR-NAME(1) 17950000
179600                 MOVE WS-INITIAL-TMST TO WS-DC-EFF-BEG-TMST(1)    17960000
179700                 MOVE HO100-SA-ASSIGN-DATE                        17970000
179800                            TO WS-DC-EFF-BEG-TMST(1)(1:10)        17980000
179900                 MOVE SPACES          TO WS-DC-EFF-END-TMST(1)    17990000
180000                                                                  18000000
180100             END-IF                                               18010000
180200         END-IF                                                   18020000
180300                                                                  18030000
180400***  EXISTING STORE - SET THE EFF-END-TMST ON THE CURRENT         18040000
180500***  DC AND SET UP A NEW DC (POSSIBLY A FUTURE DC)                18050000
180600                                                                  18060000
180700***  A FUTURE DC WOULD BE CREATED BY SETTING THE EFF-END-TMST     18070000
180800***  OF THE CURRENT DC TO A "FUTURE" DATE                         18080000
180900***  AND BY SETTING THE EFF-BEG-TMST OF THE NEW DC TO A           18090000
181000***  FUTURE DATE                                                  18100000
181100                                                                  18110000
181200***  THE DCCLC CURSOR SELECTS TORGCLC DC/DS RELATIONSHIP          18120000
181300***  RECORDS IN DESCENDING ORDER BY EFF-BEG-TMST                  18130000
181400***  SO THE FIRST OCCURRENCE ALWAYS CONTAINS THE LATEST           18140000
181500***  DC/DS RELATIONSHIP                                           18150000
181600                                                                  18160000
181700     ELSE                                                         18170000
181800                                                                  18180000
181900***  IF HO100-SA-ASSIGN-DATE < WS-DC-EFF-BEG-TMST AND             18190000
182000***  HO100-SA-WH = WS-DC-ORG-CLUSTR-NAME, THEY ARE CHANGING       18200000
182100***  THE EFFECTIVE BEGIN DATE FOR AN EXISTING DC/DS RELATIONSHIP. 18210000
182200***  THE EFFECTIVITY DATE IS BEING SET TO AN EARLIER DATE         18220000
182300***  THAN IT WAS SET TO BEFORE.                                   18230000
182400                                                                  18240000
182500         IF HO100-SA-ASSIGN-DATE < WS-DC-EFF-BEG-TMST(1)(1:10)    18250000
182600           AND HO100-SA-WH = WS-DC-ORG-CLUSTR-NAME(1)(1:4)        18260000
182700                                                                  18270000
182800             MOVE WS-DC-CLUSTR-ID(1) TO ORGCLC-PRNT-ORG-CLUSTR-ID 18280000
182900             MOVE WS-CLUSTR-ID       TO ORGCLC-CHLD-ORG-CLUSTR-ID 18290000
183000             MOVE 'D'                TO ORGCLC-REL-TYP-CDE        18300000
183100             MOVE WS-INITIAL-TMST TO WS-ORGCLC-EFF-BEG-TMST       18310000
183200             MOVE HO100-SA-ASSIGN-DATE                            18320000
183300                                  TO WS-ORGCLC-EFF-BEG-TMST(1:10) 18330000
183400             MOVE WS-DC-EFF-BEG-TMST(1)                           18340000
183500                                     TO ORGCLC-EFF-BEG-TMST       18350000
183600             MOVE SPACES             TO ORGCLC-EFF-END-TMST       18360000
183700             MOVE -1                 TO WS-CLC-EFF-END-TMST-NULL  18370000
183800                                                                  18380000
183900             PERFORM V9100-UPDATE-TORGCLC                         18390000
184000                THRU V9100-EXIT                                   18400000
184100                                                                  18410000
184200             MOVE WS-INITIAL-TMST TO WS-DC-EFF-BEG-TMST(1)        18420000
184300             MOVE HO100-SA-ASSIGN-DATE                            18430000
184400                                  TO WS-DC-EFF-BEG-TMST(1)(1:10)  18440000
184500                                                                  18450000
184600***  IF HO100-SA-ASSIGN-DATE = WS-DC-EFF-BEG-TMST AND             18460000
184700***  HO100-SA-WH NOT = WS-DC-ORG-CLUSTR-NAME, THEY ARE CHANGING   18470000
184800***  THE DC/DS RELATIONSHIP BUT KEEPING THE SAME EFF-BEG-TMST.    18480000
184900                                                                  18490000
185000         ELSE                                                     18500000
185100                                                                  18510000
185200           IF HO100-SA-ASSIGN-DATE = WS-DC-EFF-BEG-TMST(1)(1:10)  18520000
185300             AND WS-DC-EFF-END-TMST(1) = SPACES                   18530000
185400             AND HO100-SA-WH NOT = WS-DC-ORG-CLUSTR-NAME(1)(1:4)  18540000
185500                                                                  18550000
185600             MOVE WS-DC-CLUSTR-ID(1) TO ORGCLC-PRNT-ORG-CLUSTR-ID 18560000
185700             MOVE WS-CLUSTR-ID       TO ORGCLC-CHLD-ORG-CLUSTR-ID 18570000
185800             MOVE 'D'                TO ORGCLC-REL-TYP-CDE        18580000
185900             MOVE WS-DC-EFF-BEG-TMST(1) TO                        18590000
186000                                     WS-ORGCLC-EFF-BEG-TMST       18600000
186100                                     ORGCLC-EFF-BEG-TMST          18610000
186200                                     ORGCLC-EFF-END-TMST          18620000
186300             MOVE 0                  TO WS-CLC-EFF-END-TMST-NULL  18630000
186400                                                                  18640000
186500             PERFORM V9100-UPDATE-TORGCLC                         18650000
186600                THRU V9100-EXIT                                   18660000
186700                                                                  18670000
186800             MOVE WS-DC-EFF-BEG-TMST(1)                           18680000
186900                                     TO WS-DC-EFF-END-TMST(1)     18690000
187000                                                                  18700000
187100             INITIALIZE ORGCLT-ORG-CLUSTR-NAME                    18710000
187200             MOVE HO100-SA-WH      TO ORGCLT-ORG-CLUSTR-NAME      18720000
187300             MOVE 'DC'             TO ORGCLT-ORG-TYP-CDE          18730000
187400             SET TORGCLT-ORG-TYP-CDE TO TRUE                      18740000
187500                                                                  18750000
187600             PERFORM U9000-SELECT-TORGCLT                         18760000
187700                THRU U9000-EXIT                                   18770000
187800                                                                  18780000
187900             IF TORGCLT-RCD-EXISTS                                18790000
188000                 MOVE ORGCLT-ORG-CLUSTR-ID                        18800000
188100                                   TO WS-PRNT-CLUSTR-ID           18810000
188200                                                                  18820000
188300                 INITIALIZE DCLTORGCLC                            18830000
188400                 MOVE WS-PRNT-CLUSTR-ID                           18840000
188500                                   TO ORGCLC-PRNT-ORG-CLUSTR-ID   18850000
188600                 MOVE WS-CLUSTR-ID TO ORGCLC-CHLD-ORG-CLUSTR-ID   18860000
188700                 MOVE 'D'          TO ORGCLC-REL-TYP-CDE          18870000
188800                 MOVE WS-INITIAL-TMST                             18880000
188900                                   TO ORGCLC-EFF-BEG-TMST         18890000
189000                 MOVE HO100-SA-ASSIGN-DATE                        18900000
189100                                   TO ORGCLC-EFF-BEG-TMST(1:10)   18910000
189200                 MOVE -1           TO WS-CLC-EFF-END-TMST-NULL    18920000
189300                                                                  18930000
189400                 PERFORM V9300-SELECT-TORGCLC-PRNT-CHLD           18940000
189500                    THRU V9300-EXIT                               18950000
189600                                                                  18960000
189700                 IF TORGCLC-RCD-DOES-NOT-EXIST                    18970000
189800                     PERFORM V9000-INSERT-TORGCLC                 18980000
189900                        THRU V9000-EXIT                           18990000
190000                                                                  19000000
190100***  UPDATE WS-DC-TABLE SO IT CAN BE USED TO UPDATE THE           19010000
190200***  TORGCLT DS RECORD'S EFF-BEG-TMST AND EFF-END-TMST            19020000
190300                                                                  19030000
190400                     MOVE WS-PRNT-CLUSTR-ID                       19040000
190500                                   TO WS-DC-CLUSTR-ID(2)          19050000
190600                     MOVE HO100-SA-WH  TO WS-DC-ORG-CLUSTR-NAME(2)19060000
190700                     MOVE WS-INITIAL-TMST                         19070000
190800                                   TO WS-DC-EFF-BEG-TMST(2)       19080000
190900                     MOVE HO100-SA-ASSIGN-DATE                    19090000
191000                                   TO WS-DC-EFF-BEG-TMST(2)(1:10) 19100000
191100                     MOVE SPACES   TO WS-DC-EFF-END-TMST(2)       19110000
191200                                                                  19120000
191300                 END-IF                                           19130000
191400             END-IF                                               19140000
191500                                                                  19150000
191600         ELSE                                                     19160000
191700                                                                  19170000
191800             MOVE HO100-SA-ASSIGN-DATE TO WS-START-DATE           19180000
191900             MOVE 1                    TO WS-DAYS                 19190000
192000             PERFORM U8100-DECREMENT-DATE                         19200000
192100                THRU U8100-EXIT                                   19210000
192200                                                                  19220000
192300             MOVE WS-INITIAL-END-TMST TO ORGCLC-EFF-END-TMST      19230000
192400             MOVE WS-DATE-DEC-DAYS    TO ORGCLC-EFF-END-TMST(1:10)19240000
192500             MOVE 0                   TO WS-CLC-EFF-END-TMST-NULL 19250000
192600             MOVE WS-DC-CLUSTR-ID(1)  TO ORGCLC-PRNT-ORG-CLUSTR-ID19260000
192700             MOVE WS-CLUSTR-ID        TO ORGCLC-CHLD-ORG-CLUSTR-ID19270000
192800             MOVE 'D'                 TO ORGCLC-REL-TYP-CDE       19280000
192900             MOVE WS-DC-EFF-BEG-TMST(1)                           19290000
193000                                      TO ORGCLC-EFF-BEG-TMST      19300000
193100                                         WS-ORGCLC-EFF-BEG-TMST   19310000
193200                                                                  19320000
193300             PERFORM V9100-UPDATE-TORGCLC                         19330000
193400                THRU V9100-EXIT                                   19340000
193500                                                                  19350000
193600***  UPDATE WS-DC-TABLE SO IT CAN BE USED TO UPDATE THE           19360000
193700***  TORGCLT DS RECORD'S EFF-BEG-TMST AND EFF-END-TMST            19370000
193800                                                                  19380000
193900             MOVE WS-INITIAL-END-TMST TO WS-DC-EFF-END-TMST(1)    19390000
194000             MOVE WS-DATE-DEC-DAYS                                19400000
194100                                   TO WS-DC-EFF-END-TMST(1)(1:10) 19410000
194200                                                                  19420000
194300             INITIALIZE ORGCLT-ORG-CLUSTR-NAME                    19430000
194400             MOVE HO100-SA-WH      TO ORGCLT-ORG-CLUSTR-NAME      19440000
194500             MOVE 'DC'             TO ORGCLT-ORG-TYP-CDE          19450000
194600             SET TORGCLT-ORG-TYP-CDE TO TRUE                      19460000
194700                                                                  19470000
194800             PERFORM U9000-SELECT-TORGCLT                         19480000
194900                THRU U9000-EXIT                                   19490000
195000                                                                  19500000
195100             IF TORGCLT-RCD-EXISTS                                19510000
195200                 MOVE ORGCLT-ORG-CLUSTR-ID                        19520000
195300                                   TO WS-PRNT-CLUSTR-ID           19530000
195400                                                                  19540000
195500                 INITIALIZE DCLTORGCLC                            19550000
195600                 MOVE WS-PRNT-CLUSTR-ID                           19560000
195700                                   TO ORGCLC-PRNT-ORG-CLUSTR-ID   19570000
195800                 MOVE WS-CLUSTR-ID TO ORGCLC-CHLD-ORG-CLUSTR-ID   19580000
195900                 MOVE 'D'          TO ORGCLC-REL-TYP-CDE          19590000
196000                 MOVE WS-INITIAL-TMST                             19600000
196100                                   TO ORGCLC-EFF-BEG-TMST         19610000
196200                 MOVE HO100-SA-ASSIGN-DATE                        19620000
196300                                   TO ORGCLC-EFF-BEG-TMST(1:10)   19630000
196400                 MOVE -1           TO WS-CLC-EFF-END-TMST-NULL    19640000
196500                                                                  19650000
196600                 PERFORM V9300-SELECT-TORGCLC-PRNT-CHLD           19660000
196700                    THRU V9300-EXIT                               19670000
196800                                                                  19680000
196900                 IF TORGCLC-RCD-DOES-NOT-EXIST                    19690000
197000                     PERFORM V9000-INSERT-TORGCLC                 19700000
197100                        THRU V9000-EXIT                           19710000
197200                                                                  19720000
197300***  UPDATE WS-DC-TABLE SO IT CAN BE USED TO UPDATE THE           19730000
197400***  TORGCLT DS RECORD'S EFF-BEG-TMST AND EFF-END-TMST            19740000
197500                                                                  19750000
197600                     MOVE WS-PRNT-CLUSTR-ID                       19760000
197700                                   TO WS-DC-CLUSTR-ID(2)          19770000
197800                     MOVE HO100-SA-WH  TO WS-DC-ORG-CLUSTR-NAME(2)19780000
197900                     MOVE WS-INITIAL-TMST                         19790000
198000                                   TO WS-DC-EFF-BEG-TMST(2)       19800000
198100                     MOVE HO100-SA-ASSIGN-DATE                    19810000
198200                                   TO WS-DC-EFF-BEG-TMST(2)(1:10) 19820000
198300                     MOVE SPACES   TO WS-DC-EFF-END-TMST(2)       19830000
198400                                                                  19840000
198500                 END-IF                                           19850000
198600             END-IF                                               19860000
198700         END-IF                                                   19870000
198800     END-IF.                                                      19880000
198900                                                                  19890000
199000 H1100-EXIT.                                                      19900000
199100     EXIT.                                                        19910000
199200                                                                  19920000
199300                                                                  19930000
199400*H1200-REACTIVE-DC.                                               19940000
199500                                                                  19950000
199600*    DISPLAY 'H1200-REACTIVE-DC'.                                 19960000
199700                                                                  19970000
199800*   WHEN THIS IS PERFORMED, THE STR-CLOSE-DATE HAS BEEN SET       19980000
199900*   AND THE EFF-END-TMST'S HAVE BEEN SET ON THE DC/DS             19990000
200000*   RELATIONSHIPS                                                 20000000
200100                                                                  20010000
200200*   WE'RE ONLY RESETING THE EFF-END-TMST                          20020000
200300                                                                  20030000
200400*    IF HO100-SA-WH = WS-DC-ORG-CLUSTR-NAME(1)(1:4)               20040000
200500                                                                  20050000
200600*        MOVE WS-DC-CLUSTR-ID(1) TO ORGCLC-PRNT-ORG-CLUSTR-ID     20060000
200700*        MOVE WS-CLUSTR-ID       TO ORGCLC-CHLD-ORG-CLUSTR-ID     20070000
200800*        MOVE 'D'                TO ORGCLC-REL-TYP-CDE            20080000
200900*        MOVE WS-DC-EFF-BEG-TMST(1)                               20090000
201000*                                TO WS-ORGCLC-EFF-BEG-TMST        20100000
201100*                                   ORGCLC-EFF-BEG-TMST           20110000
201200*        MOVE SPACES             TO ORGCLC-EFF-END-TMST           20120000
201300*        MOVE -1                 TO WS-CLC-EFF-END-TMST-NULL      20130000
201400*        PERFORM V9100-UPDATE-TORGCLC                             20140000
201500*           THRU V9100-EXIT                                       20150000
201600                                                                  20160000
201700*        MOVE SPACES             TO WS-DC-EFF-END-TMST(1)         20170000
201800                                                                  20180000
201900*    END-IF.                                                      20190000
202000                                                                  20200000
202100*    IF HO100-SA-WH = WS-DC-ORG-CLUSTR-NAME(2)(1:4)               20210000
202200                                                                  20220000
202300*        MOVE WS-DC-CLUSTR-ID(2) TO ORGCLC-PRNT-ORG-CLUSTR-ID     20230000
202400*        MOVE WS-CLUSTR-ID       TO ORGCLC-CHLD-ORG-CLUSTR-ID     20240000
202500*        MOVE 'D'                TO ORGCLC-REL-TYP-CDE            20250000
202600*        MOVE WS-DC-EFF-BEG-TMST(2)                               20260000
202700*                                TO WS-ORGCLC-EFF-BEG-TMST        20270000
202800*                                   ORGCLC-EFF-BEG-TMST           20280000
202900                                                                  20290000
203000*        IF WS-DC-EFF-BEG-TMST(1) > WS-CURRENT-DATE               20300000
203100*            MOVE WS-DC-EFF-BEG-TMST(1)(1:10) TO WS-START-DATE    20310000
203200*            MOVE 1                           TO WS-DAYS          20320000
203300*            PERFORM U8100-DECREMENT-DATE                         20330000
203400*               THRU U8100-EXIT                                   20340000
203500                                                                  20350000
203600*            MOVE WS-INITIAL-END-TMST TO ORGCLC-EFF-END-TMST      20360000
203700*            MOVE WS-DATE-DEC-DAYS    TO ORGCLC-EFF-END-TMST(1:10)20370000
203800*            MOVE 0                   TO WS-CLC-EFF-END-TMST-NULL 20380000
203900*        ELSE                                                     20390000
204000*            MOVE SPACES              TO ORGCLC-EFF-END-TMST      20400000
204100*            MOVE -1                  TO WS-CLC-EFF-END-TMST-NULL 20410000
204200*        END-IF                                                   20420000
204300                                                                  20430000
204400*        PERFORM V9100-UPDATE-TORGCLC                             20440000
204500*           THRU V9100-EXIT                                       20450000
204600                                                                  20460000
204700*        MOVE ORGCLC-EFF-END-TMST     TO WS-DC-EFF-END-TMST(2)    20470000
204800                                                                  20480000
204900*    END-IF.                                                      20490000
205000                                                                  20500000
205100*H1200-EXIT.                                                      20510000
205200*    EXIT.                                                        20520000
205300                                                                  20530000
205400                                                                  20540000
205500*H1300-UPDATE-FUTURE-STORE-WH.                                    20550000
205600                                                                  20560000
205700*    DISPLAY 'H1300-UPDATE-FUTURE-STORE-WH'.                      20570000
205800                                                                  20580000
205900*   WE'RE JUST UPDATING THE EFF-BEG-TMST FOR THE ACTIVE DC        20590000
206000*   WITH THE WAY THE DCCLC CURSOR WORKS, THIS SHOULD ALWAYS       20600000
206100*   BE THE FIRST OCCURRENCE IN THE TABLE.  HOWEVER, WE'LL         20610000
206200*   STILL CHECK FOR A NAME MATCH HERE.                            20620000
206300                                                                  20630000
206400*    IF HO100-SA-OLD-WH = WS-DC-ORG-CLUSTR-NAME(1)                20640000
206500*      AND  HO100-SA-OLD-ASSIGN-DATE                              20650000
206600*                       = WS-DC-EFF-BEG-TMST(1)(1:10)             20660000
206700                                                                  20670000
206800*        MOVE WS-INITIAL-TMST      TO WS-ORGCLC-EFF-BEG-TMST      20680000
206900*        MOVE HO100-SA-ASSIGN-DATE TO WS-ORGCLC-EFF-BEG-TMST(1:10)20690000
207000                                                                  20700000
207100*        MOVE WS-DC-CLUSTR-ID(1)   TO ORGCLC-PRNT-ORG-CLUSTR-ID   20710000
207200*        MOVE WS-CLUSTR-ID         TO ORGCLC-CHLD-ORG-CLUSTR-ID   20720000
207300*        MOVE 'D'                  TO ORGCLC-REL-TYP-CDE          20730000
207400                                                                  20740000
207500*        MOVE WS-DC-EFF-BEG-TMST(1)                               20750000
207600*                                  TO ORGCLC-EFF-BEG-TMST         20760000
207700*        MOVE WS-DC-EFF-END-TMST(1)                               20770000
207800*                                  TO ORGCLC-EFF-END-TMST         20780000
207900                                                                  20790000
208000*        IF WS-DC-EFF-END-TMST(1) = SPACES                        20800000
208100*            MOVE -1               TO WS-CLC-EFF-END-TMST-NULL    20810000
208200*        ELSE                                                     20820000
208300*            MOVE 0                TO WS-CLC-EFF-END-TMST-NULL    20830000
208400*        END-IF                                                   20840000
208500                                                                  20850000
208600*        PERFORM V9100-UPDATE-TORGCLC                             20860000
208700*           THRU V9100-EXIT                                       20870000
208800                                                                  20880000
208900*        MOVE WS-INITIAL-TMST      TO WS-DC-EFF-BEG-TMST(1)       20890000
209000*        MOVE HO100-SA-ASSIGN-DATE TO WS-DC-EFF-BEG-TMST(1)(1:10) 20900000
209100                                                                  20910000
209200*    END-IF.                                                      20920000
209300                                                                  20930000
209400*    IF HO100-SA-OLD-WH = WS-DC-ORG-CLUSTR-NAME(2)                20940000
209500*      AND  HO100-SA-OLD-ASSIGN-DATE                              20950000
209600*                           = WS-DC-EFF-BEG-TMST(2)(1:10)         20960000
209700                                                                  20970000
209800*        MOVE WS-INITIAL-TMST      TO ORGCLC-EFF-BEG-TMST         20980000
209900*        MOVE HO100-SA-ASSIGN-DATE TO ORGCLC-EFF-BEG-TMST(1:10)   20990000
210000                                                                  21000000
210100*        MOVE WS-DC-CLUSTR-ID(2)   TO ORGCLC-PRNT-ORG-CLUSTR-ID   21010000
210200*        MOVE WS-CLUSTR-ID         TO ORGCLC-CHLD-ORG-CLUSTR-ID   21020000
210300*        MOVE 'D'                  TO ORGCLC-REL-TYP-CDE          21030000
210400*        MOVE WS-DC-EFF-BEG-TMST(2)                               21040000
210500*                                  TO ORGCLC-EFF-BEG-TMST         21050000
210600                                                                  21060000
210700*        MOVE WS-DC-EFF-END-TMST(2)                               21070000
210800*                                  TO ORGCLC-EFF-END-TMST         21080000
210900                                                                  21090000
211000*        IF WS-DC-EFF-END-TMST(2) = SPACES                        21100000
211100*            MOVE -1               TO WS-CLC-EFF-END-TMST-NULL    21110000
211200*        ELSE                                                     21120000
211300*            MOVE 0                TO WS-CLC-EFF-END-TMST-NULL    21130000
211400*        END-IF                                                   21140000
211500                                                                  21150000
211600*        PERFORM V9100-UPDATE-TORGCLC                             21160000
211700*           THRU V9100-EXIT                                       21170000
211800                                                                  21180000
211900*        MOVE WS-INITIAL-TMST      TO WS-DC-EFF-BEG-TMST(2)       21190000
212000*        MOVE HO100-SA-ASSIGN-DATE TO WS-DC-EFF-BEG-TMST(2)(1:10) 21200000
212100                                                                  21210000
212200*    END-IF.                                                      21220000
212300                                                                  21230000
212400*H1300-EXIT.                                                      21240000
212500*    EXIT.                                                        21250000
212600                                                                  21260000
212700                                                                  21270000
212800 I1000-PROCESS-OUTLOC.                                            21280000
212900                                                                  21290000
213000     DISPLAY 'I1400-PROCESS-OUTLOC'.                              21300000
213100     DISPLAY 'OUTLOC:  ' HO100-OTLC-ID.                           21310000
213200                                                                  21320000
213300*  VN AND ND RECORDS ARE CREATED BY OUTLOC MESSAGES               21330000
213400                                                                  21340000
213500     IF HO100-OTLC-TYPE(1:2) = 'ND'                               21350000
213600       OR HO100-OTLC-TYPE(1:2) = 'VN'                             21360000
213700         CONTINUE                                                 21370000
213800     ELSE                                                         21380000
213900         GO TO I1000-EXIT                                         21390000
214000     END-IF.                                                      21400000
214100                                                                  21410000
214200     INITIALIZE ORGCLT-ORG-CLUSTR-NAME.                           21420000
214300     MOVE HO100-OUTLC-ID-2-5  TO ORGCLT-ORG-CLUSTR-NAME.          21430000
214400     MOVE HO100-OTLC-TYPE     TO ORGCLT-ORG-TYP-CDE.              21440000
214500     SET TORGCLT-ORG-TYP-CDE  TO TRUE.                            21450000
214600                                                                  21460000
214700     PERFORM U9000-SELECT-TORGCLT                                 21470000
214800        THRU U9000-EXIT.                                          21480000
214900                                                                  21490000
215000     IF TORGCLT-RCD-EXISTS                                        21500000
215100         MOVE ORGCLT-ORG-CLUSTR-ID TO WS-CLUSTR-ID                21510000
215200     END-IF.                                                      21520000
215300                                                                  21530000
215400     IF HO100-ACTN-TYP-INSERT                                     21540000
215500         IF TORGCLT-RCD-DOES-NOT-EXIST                            21550000
215600                                                                  21560000
215700             PERFORM U9100-SELECT-NEXT-SEQ-NBR                    21570000
215800                THRU U9100-EXIT                                   21580000
215900             MOVE ORGCLT-ORG-CLUSTR-ID TO WS-CLUSTR-ID            21590000
216000                                                                  21600000
216100             INITIALIZE DCLTORGCLT                                21610000
216200             MOVE WS-CLUSTR-ID        TO ORGCLT-ORG-CLUSTR-ID     21620000
216300             MOVE HO100-OTLC-NM-5-ABBR                            21630000
216400                                      TO ORGCLT-ORG-CLUSTR-NAME-5 21640000
216500             MOVE HO100-OUTLOC-DESC1-10                           21650000
216600                                      TO ORGCLT-ORG-CLUSTR-NAME-1021660000
216700                                                                  21670000
216800             MOVE HO100-OUTLC-ID-2-5    TO ORGCLT-ORG-CLUSTR-NAME 21680000
216900             MOVE HO100-OUTLC-DESC-1-25 TO ORGCLT-ORG-CLUSTR-DESC 21690000
217000             MOVE WS-INITIAL-TMST TO ORGCLT-EFF-BEG-TMST          21700000
217100                                     ORGCLT-NMDSE-PO-BEG-TMST     21710000
217200             MOVE WS-CURRENT-DATE                                 21720000
217300                               TO ORGCLT-EFF-BEG-TMST(1:10)       21730000
217400                                  ORGCLT-NMDSE-PO-BEG-TMST(1:10)  21740000
217500             MOVE HO100-OTLC-TYPE TO ORGCLT-ORG-TYP-CDE           21750000
217600             MOVE 'O'             TO ORGCLT-ORG-CLUSTR-CDE        21760000
217700                                                                  21770000
217800             MOVE 0  TO WS-ORG-CLUSTR-NAME-5-NULL                 21780000
217900                        WS-ORG-CLUSTR-NAME-10-NULL                21790000
218000                        WS-ORG-TYP-CDE-NULL                       21800000
218100                        WS-NMDSE-PO-BEG-TMST-NULL                 21810000
218200                                                                  21820000
218300             MOVE -1 TO WS-CLT-EFF-END-TMST-NULL                  21830000
218400                        WS-CLUSTR-TYP-CDE-NULL                    21840000
218500                        WS-HIER-TYP-CDE-NULL                      21850000
218600                        WS-HIER-CDE-NULL                          21860000
218700                        WS-NMDSE-PO-END-TMST-NULL                 21870000
218800                        WS-ARCH-DTE-NULL                          21880000
218900                        WS-OWNER-ID-NULL                          21890000
219000                        WS-OPN-DTE-NULL                           21900000
219100                        WS-CLO-DTE-NULL                           21910000
219200                        WS-REPL-ORG-CLUSTR-ID-NULL                21920000
219300             MOVE 'N' TO ORGCLT-E-BUS-LOC-IND                     21930000
219400                                                                  21940000
219500             PERFORM U9200-INSERT-TORGCLT                         21950000
219600                THRU U9200-EXIT                                   21960000
219700                                                                  21970000
219800             INITIALIZE DCLTPHYLOC                                21980000
219900             MOVE HO100-OUTLC-DESC-1-25 TO PHYLOC-PHY-LOC-NAME    21990000
220000             MOVE HO100-OTLC-ADD1-1-25  TO PHYLOC-ADR-LNE1-DESC   22000000
220100             IF HO100-OTLC-ADD2-1-25 > SPACES                     22010000
220200                 MOVE HO100-OTLC-ADD2-1-25                        22020000
220300                                        TO PHYLOC-ADR-LNE2-DESC   22030000
220400                 MOVE 0                 TO WS-ADR-LNE2-DESC-NULL  22040000
220500             ELSE                                                 22050000
220600                 MOVE -1                TO WS-ADR-LNE2-DESC-NULL  22060000
220700             END-IF                                               22070000
220800             MOVE HO100-OTLC-CITY-1-15  TO PHYLOC-CTY-NAME        22080000
220900             MOVE HO100-OTLC-STATE-1-2  TO PHYLOC-ST-CDE          22090000
221000             MOVE ' '                   TO PHYLOC-OWN-LEASE-CDE   22100000
221100             MOVE ZEROS                 TO PHYLOC-TAX-PCT         22110000
221200                                                                  22120000
221300*** CONVERT THE INPUT ALPHANUMERIC ZIP CODE TO NUMERIC            22130000
221400             INITIALIZE WS-INPUT-NUMBER-IN                        22140000
221500                        WS-OUTPUT-NUMBER-OUT                      22150000
221600                        WS-ZIP-CODE-X-1-9                         22160000
221700             MOVE HO100-OTLC-POST      TO WS-INPUT-NUMBER-IN      22170000
221800                                                                  22180000
221900             PERFORM U8000-CONVERT-ALPHA-TO-NUMERIC               22190000
222000                THRU U8000-EXIT                                   22200000
222100                                                                  22210000
222200             MOVE WS-OUTPUT-NUMBER-OUT   TO WS-ZIP-CODE-X         22220000
222300             MOVE WS-ZIP-CODE-X-1-9(1:5) TO WS-ZIP-CODE-Y-1-5     22230000
222400                                                                  22240000
222500             IF WS-ZIP-CODE-X-1-9(6:4) = ZEROS                    22250000
222600                 MOVE SPACES TO WS-ZIP-CODE-Y-7-10                22260000
222700                 MOVE SPACES TO WS-ZIP-CODE-Y-6                   22270000
222800             ELSE                                                 22280000
222900                 MOVE WS-ZIP-CODE-X-1-9(6:4)                      22290000
223000                             TO WS-ZIP-CODE-Y-7-10                22300000
223100                 MOVE '-'    TO WS-ZIP-CODE-Y-6                   22310000
223200             END-IF                                               22320000
223300             MOVE WS-ZIP-CODE-Y TO PHYLOC-ZIP-CDE                 22330000
223400                                                                  22340000
223500             PERFORM T1000-CREATE-TPHYLOC-TORGPHY                 22350000
223600                THRU T1000-EXIT                                   22360000
223700         END-IF                                                   22370000
223800     END-IF.                                                      22380000
223900                                                                  22390000
224000     IF HO100-ACTN-TYP-UPDATE                                     22400000
224100         IF TORGCLT-RCD-EXISTS                                    22410000
224200                                                                  22420000
224300             MOVE HO100-OUTLC-DESC-1-25 TO ORGCLT-ORG-CLUSTR-DESC 22430000
224400             MOVE HO100-OTLC-NM-5-ABBR                            22440000
224500                                      TO ORGCLT-ORG-CLUSTR-NAME-5 22450000
224600             MOVE HO100-OUTLOC-DESC1-10                           22460000
224700                                      TO ORGCLT-ORG-CLUSTR-NAME-1022470000
224800                                                                  22480000
224900             PERFORM U9300-UPDATE-TORGCLT                         22490000
225000                THRU U9300-EXIT                                   22500000
225100                                                                  22510000
225200             MOVE WS-CLUSTR-ID        TO ORGPHY-ORG-CLUSTR-ID     22520000
225300                                                                  22530000
225400             PERFORM T1900-SELECT-TPHYLOC-TORGPHY                 22540000
225500                THRU T1900-EXIT                                   22550000
225600                                                                  22560000
225700             IF TPHYLOC-RCD-DOES-NOT-EXIST                        22570000
225800                 INITIALIZE DCLTPHYLOC                            22580000
225900             END-IF                                               22590000
226000                                                                  22600000
226100             MOVE HO100-OUTLC-DESC-1-25 TO PHYLOC-PHY-LOC-NAME    22610000
226200             MOVE HO100-OTLC-ADD1-1-25 TO PHYLOC-ADR-LNE1-DESC    22620000
226300             IF HO100-OTLC-ADD2-1-25 > SPACES                     22630000
226400                 MOVE HO100-OTLC-ADD2-1-25                        22640000
226500                                       TO PHYLOC-ADR-LNE2-DESC    22650000
226600                 MOVE 0   TO WS-ADR-LNE2-DESC-NULL                22660000
226700             ELSE                                                 22670000
226800                 MOVE -1  TO WS-ADR-LNE2-DESC-NULL                22680000
226900             END-IF                                               22690000
227000             MOVE HO100-OTLC-ADD2-1-25 TO PHYLOC-ADR-LNE2-DESC    22700000
227100             MOVE HO100-OTLC-CITY-1-15 TO PHYLOC-CTY-NAME         22710000
227200             MOVE HO100-OTLC-STATE-1-2 TO PHYLOC-ST-CDE           22720000
227300                                                                  22730000
227400             INITIALIZE WS-INPUT-NUMBER-IN                        22740000
227500                        WS-OUTPUT-NUMBER-OUT                      22750000
227600                        WS-ZIP-CODE-X-1-9                         22760000
227700             MOVE HO100-OTLC-POST      TO WS-INPUT-NUMBER-IN      22770000
227800                                                                  22780000
227900             PERFORM U8000-CONVERT-ALPHA-TO-NUMERIC               22790000
228000                THRU U8000-EXIT                                   22800000
228100                                                                  22810000
228200             MOVE WS-OUTPUT-NUMBER-OUT   TO WS-ZIP-CODE-X         22820000
228300             MOVE WS-ZIP-CODE-X-1-9(1:5) TO WS-ZIP-CODE-Y-1-5     22830000
228400                                                                  22840000
228500             IF WS-ZIP-CODE-X-1-9(6:4) = ZEROS                    22850000
228600                 MOVE SPACES TO WS-ZIP-CODE-Y-7-10                22860000
228700                 MOVE SPACES TO WS-ZIP-CODE-Y-6                   22870000
228800             ELSE                                                 22880000
228900                 MOVE WS-ZIP-CODE-X-1-9(6:4)                      22890000
229000                             TO WS-ZIP-CODE-Y-7-10                22900000
229100                 MOVE '-'    TO WS-ZIP-CODE-Y-6                   22910000
229200             END-IF                                               22920000
229300             MOVE WS-ZIP-CODE-Y TO PHYLOC-ZIP-CDE                 22930000
229400                                                                  22940000
229500             IF TPHYLOC-RCD-DOES-NOT-EXIST                        22950000
229600                 MOVE ' '       TO PHYLOC-OWN-LEASE-CDE           22960000
229700                 MOVE ZEROS     TO PHYLOC-TAX-PCT                 22970000
229800                 PERFORM T1000-CREATE-TPHYLOC-TORGPHY             22980000
229900                    THRU T1000-EXIT                               22990000
230000             ELSE                                                 23000000
230100                 PERFORM T1800-UPDATE-TPHYLOC                     23010000
230200                    THRU T1800-EXIT                               23020000
230300             END-IF                                               23030000
230400         END-IF                                                   23040000
230500     END-IF.                                                      23050000
230600                                                                  23060000
230700 I1000-EXIT.                                                      23070000
230800     EXIT.                                                        23080000
230900                                                                  23090000
231000                                                                  23100000
231100 J1000-EOJ-PROCESSING.                                            23110000
231200                                                                  23120000
231300     CLOSE ORG-FILE                                               23130000
231400           NOTIFY-FILE.                                           23140000
231500                                                                  23150000
231600     EXEC SQL                                                     23160000
231700         COMMIT RELEASE                                           23170000
231800     END-EXEC.                                                    23180000
231900                                                                  23190000
232000     IF SQLCODE = ZERO                                            23200000
232100         CONTINUE                                                 23210000
232200     ELSE                                                         23220000
232300         MOVE SQLCODE    TO SQLCODE2                              23230000
232400         MOVE SQLERRD(3) TO SQLERRD3                              23240000
232500         DISPLAY '** ABEND **       ** = SQLERROR'                23250000
232600         DISPLAY '** PROGRAM        ** = MAKUT226'                23260000
232700         DISPLAY '** SQLCODE        ** = ' SQLCODE                23270000
232800         DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3               23280000
232900         DISPLAY '** SQLERRM        ** = ' SQLERRM                23290000
233000         DISPLAY '** SQLERRMC       ** = ' SQLERRM                23300000
233100         MOVE SPACES TO WS-MSG-TEXT                               23310000
233200                                                                  23320000
233300*    GET FULL TEXT OF ERROR MESSAGE                               23330000
233400                                                                  23340000
233500         CALL 'SQLGLM' USING WS-MSG-TEXT,                         23350000
233600                             WS-MAX-SIZE,                         23360000
233700                             WS-MSG-LENGTH                        23370000
233800         DISPLAY 'MESSAGE TEXT      ** = ' WS-MSG-TEXT            23380000
233900     END-IF.                                                      23390000
234000                                                                  23400000
234100     DISPLAY '*****************************************'.         23410000
234200     DISPLAY 'MAKUT226'.                                          23420000
234300     DISPLAY 'RCDS READ:         ' WS-READ-COUNT.                 23430000
234400     DISPLAY 'NEW DISTRICT RCDS: ' WS-NOTIFY-COUNT.               23440000
234500     DISPLAY '*****************************************'.         23450000
234600                                                                  23460000
234700     IF WS-NOTIFY-COUNT > 0                                       23470000
234800         MOVE 4095 TO RETURN-CODE                                 23480000
234900     ELSE                                                         23490000
235000         MOVE 0    TO RETURN-CODE                                 23500000
235100     END-IF.                                                      23510000
235200                                                                  23520000
235300 J1000-EXIT.                                                      23530000
235400     EXIT.                                                        23540000
235500                                                                  23550000
235600                                                                  23560000
235700 T1000-CREATE-TPHYLOC-TORGPHY.                                    23570000
235800                                                                  23580000
235900     PERFORM T1100-SELECT-NEXT-SEQ-NBR                            23590000
236000        THRU T1100-EXIT.                                          23600000
236100     PERFORM T1200-INSERT-TPHYLOC                                 23610000
236200        THRU T1200-EXIT.                                          23620000
236300                                                                  23630000
236400     MOVE WS-CLUSTR-ID TO ORGPHY-ORG-CLUSTR-ID.                   23640000
236500     PERFORM T1300-SELECT-TORGPHY                                 23650000
236600        THRU T1300-EXIT.                                          23660000
236700                                                                  23670000
236800     IF TORGPHY-RCD-DOES-NOT-EXIST                                23680000
236900         INITIALIZE DCLTORGPHY                                    23690000
237000         MOVE WS-CLUSTR-ID      TO ORGPHY-ORG-CLUSTR-ID           23700000
237100         MOVE PHYLOC-PHY-LOC-ID TO ORGPHY-PHY-LOC-ID              23710000
237200         MOVE 'Y'               TO ORGPHY-PRIM-IND                23720000
237300         PERFORM T1400-INSERT-TORGPHY                             23730000
237400            THRU T1400-EXIT                                       23740000
237500     ELSE                                                         23750000
237600         MOVE PHYLOC-PHY-LOC-ID TO ORGPHY-PHY-LOC-ID              23760000
237700         PERFORM T1500-UPDATE-TORGPHY                             23770000
237800            THRU T1500-EXIT                                       23780000
237900     END-IF.                                                      23790000
238000                                                                  23800000
238100     PERFORM T1600-SELECT-TORGPHY-SEC                             23810000
238200        THRU T1600-EXIT.                                          23820000
238300                                                                  23830000
238400     IF TORGPHY-SEC-RCD-EXISTS                                    23840000
238500         MOVE PHYLOC-PHY-LOC-ID TO ORGPHY-PHY-LOC-ID              23850000
238600         PERFORM T1700-UPDATE-TORGPHY-SEC                         23860000
238700            THRU T1700-EXIT                                       23870000
238800     END-IF.                                                      23880000
238900                                                                  23890000
239000 T1000-EXIT.                                                      23900000
239100     EXIT.                                                        23910000
239200                                                                  23920000
239300                                                                  23930000
239400 T1100-SELECT-NEXT-SEQ-NBR.                                       23940000
239500                                                                  23950000
239600     DISPLAY 'T1100-SELECT-NEXT-SEQ-NBR'.                         23960000
239700                                                                  23970000
239800     EXEC SQL                                                     23980000
239900         SELECT PHY_LOC_SEQ.NEXTVAL                               23990000
240000           INTO :PHYLOC-PHY-LOC-ID                                24000000
240100           FROM DUAL                                              24010000
240200     END-EXEC.                                                    24020000
240300                                                                  24030000
240400     EVALUATE TRUE                                                24040000
240500         WHEN SQLCODE = ZEROS                                     24050000
240600             CONTINUE                                             24060000
240700         WHEN OTHER                                               24070000
240800             PERFORM Z9999-ABEND-ROUTINE                          24080000
240900     END-EVALUATE.                                                24090000
241000                                                                  24100000
241100 T1100-EXIT.                                                      24110000
241200     EXIT.                                                        24120000
241300                                                                  24130000
241400                                                                  24140000
241500 T1200-INSERT-TPHYLOC.                                            24150000
241600                                                                  24160000
241700     DISPLAY 'T1200-INSERT-TPHYLOC'.                              24170000
241800                                                                  24180000
241900     EXEC SQL                                                     24190000
242000         INSERT INTO TPHYLOC                                      24200000
242100            (PHY_LOC_ID,                                          24210000
242200             PHY_LOC_NAME,                                        24220000
242300             ADR_LNE1_DESC,                                       24230000
242400             ADR_LNE2_DESC,                                       24240000
242500             CTY_NAME,                                            24250000
242600             ST_CDE,                                              24260000
242700             ZIP_CDE,                                             24270000
242800             OWN_LEASE_CDE,                                       24280000
242900             TAX_PCT)                                             24290000
243000         VALUES                                                   24300000
243100            (:PHYLOC-PHY-LOC-ID,                                  24310000
243200             :PHYLOC-PHY-LOC-NAME,                                24320000
243300             :PHYLOC-ADR-LNE1-DESC,                               24330000
243400             :PHYLOC-ADR-LNE2-DESC:WS-ADR-LNE2-DESC-NULL,         24340000
243500             :PHYLOC-CTY-NAME,                                    24350000
243600             :PHYLOC-ST-CDE,                                      24360000
243700             :PHYLOC-ZIP-CDE,                                     24370000
243800             :PHYLOC-OWN-LEASE-CDE,                               24380000
243900             :PHYLOC-TAX-PCT)                                     24390000
244000     END-EXEC.                                                    24400000
244100                                                                  24410000
244200     EVALUATE TRUE                                                24420000
244300         WHEN SQLCODE = ZEROS                                     24430000
244400             CONTINUE                                             24440000
244500         WHEN OTHER                                               24450000
244600             DISPLAY 'PHYLOC-PHY-LOC-NAME:   '                    24460000
244700                             PHYLOC-PHY-LOC-NAME                  24470000
244800             DISPLAY 'PHYLOC-ADR-LNE1-DESC:  '                    24480000
244900                             PHYLOC-ADR-LNE1-DESC                 24490000
245000             DISPLAY 'PHYLOC-ADR-LNE2-DESC:  '                    24500000
245100                             PHYLOC-ADR-LNE2-DESC                 24510000
245200             DISPLAY 'PHYLOC-CTY-NAME:       '                    24520000
245300                             PHYLOC-CTY-NAME                      24530000
245400             DISPLAY 'PHYLOC-ST-CDE:         '                    24540000
245500                             PHYLOC-ST-CDE                        24550000
245600             DISPLAY 'PHYLOC-ZIP-CDE:        '                    24560000
245700                             PHYLOC-ZIP-CDE                       24570000
245800             PERFORM Z9999-ABEND-ROUTINE                          24580000
245900     END-EVALUATE.                                                24590000
246000                                                                  24600000
246100 T1200-EXIT.                                                      24610000
246200     EXIT.                                                        24620000
246300                                                                  24630000
246400                                                                  24640000
246500 T1300-SELECT-TORGPHY.                                            24650000
246600                                                                  24660000
246700     DISPLAY 'T1300-SELECT-TORGPHY'.                              24670000
246800                                                                  24680000
246900     EXEC SQL                                                     24690000
247000         SELECT *                                                 24700000
247100           INTO :ORGPHY-ORG-CLUSTR-ID,                            24710000
247200                :ORGPHY-PHY-LOC-ID,                               24720000
247300                :ORGPHY-PRIM-IND                                  24730000
247400           FROM TORGPHY                                           24740000
247500          WHERE ORG_CLUSTR_ID = :ORGPHY-ORG-CLUSTR-ID             24750000
247600            AND PRIM_IND = 'Y'                                    24760000
247700     END-EXEC.                                                    24770000
247800                                                                  24780000
247900     EVALUATE TRUE                                                24790000
248000         WHEN SQLCODE = ZEROS                                     24800000
248100             SET TORGPHY-RCD-EXISTS TO TRUE                       24810000
248200         WHEN SQLCODE = +1403                                     24820000
248300             SET TORGPHY-RCD-DOES-NOT-EXIST TO TRUE               24830000
248400         WHEN OTHER                                               24840000
248500             PERFORM Z9999-ABEND-ROUTINE                          24850000
248600     END-EVALUATE.                                                24860000
248700                                                                  24870000
248800 T1300-EXIT.                                                      24880000
248900     EXIT.                                                        24890000
249000                                                                  24900000
249100                                                                  24910000
249200 T1400-INSERT-TORGPHY.                                            24920000
249300                                                                  24930000
249400     DISPLAY 'T1400-INSERT-TORGPHY'.                              24940000
249500                                                                  24950000
249600     EXEC SQL                                                     24960000
249700         INSERT INTO TORGPHY                                      24970000
249800             (PRIM_IND,                                           24980000
249900              ORG_CLUSTR_ID,                                      24990000
250000              PHY_LOC_ID)                                         25000000
250100         VALUES                                                   25010000
250200            (:ORGPHY-PRIM-IND,                                    25020000
250300             :ORGPHY-ORG-CLUSTR-ID,                               25030000
250400             :ORGPHY-PHY-LOC-ID)                                  25040000
250500     END-EXEC.                                                    25050000
250600                                                                  25060000
250700     EVALUATE TRUE                                                25070000
250800         WHEN SQLCODE = ZEROS                                     25080000
250900             CONTINUE                                             25090000
251000         WHEN OTHER                                               25100000
251100             DISPLAY 'ORGPHY-ORG-CLUSTR-ID:  '                    25110000
251200                                ORGPHY-ORG-CLUSTR-ID              25120000
251300             DISPLAY 'ORGPHY-PHY-LOC-ID:     '                    25130000
251400                                ORGPHY-PHY-LOC-ID                 25140000
251500             PERFORM Z9999-ABEND-ROUTINE                          25150000
251600     END-EVALUATE.                                                25160000
251700                                                                  25170000
251800 T1400-EXIT.                                                      25180000
251900     EXIT.                                                        25190000
252000                                                                  25200000
252100                                                                  25210000
252200 T1500-UPDATE-TORGPHY.                                            25220000
252300                                                                  25230000
252400     DISPLAY 'T1500-UPDATE-TORGPHY'.                              25240000
252500                                                                  25250000
252600     EXEC SQL                                                     25260000
252700       UPDATE TORGPHY                                             25270000
252800          SET PHY_LOC_ID    = :ORGPHY-PHY-LOC-ID                  25280000
252900        WHERE ORG_CLUSTR_ID = :ORGPHY-ORG-CLUSTR-ID               25290000
253000          AND PRIM_IND      = 'Y'                                 25300000
253100     END-EXEC.                                                    25310000
253200                                                                  25320000
253300     EVALUATE TRUE                                                25330000
253400         WHEN SQLCODE = ZEROS                                     25340000
253500             CONTINUE                                             25350000
253600         WHEN OTHER                                               25360000
253700             DISPLAY 'ORGPHY-ORG-CLUSTR-ID:  '                    25370000
253800                                 ORGPHY-ORG-CLUSTR-ID             25380000
253900             DISPLAY 'ORGPHY-PHY-LOC-ID:  '                       25390000
254000                                 ORGPHY-PHY-LOC-ID                25400000
254100             PERFORM Z9999-ABEND-ROUTINE                          25410000
254200     END-EVALUATE.                                                25420000
254300                                                                  25430000
254400 T1500-EXIT.                                                      25440000
254500     EXIT.                                                        25450000
254600                                                                  25460000
254700                                                                  25470000
254800 T1600-SELECT-TORGPHY-SEC.                                        25480000
254900                                                                  25490000
255000     DISPLAY 'T1600-SELECT-TORGPHY-SEC'.                          25500000
255100                                                                  25510000
255200**  SELECT ON PRIM-IND = 'S' TO OBTAIN ONLY SECURED ADDRESSES     25520000
255300**  AND NOT PUBLIC ADDRESSES                                      25530000
255400                                                                  25540000
255500     EXEC SQL                                                     25550000
255600         SELECT *                                                 25560000
255700           INTO :ORGPHY-ORG-CLUSTR-ID,                            25570000
255800                :ORGPHY-PHY-LOC-ID,                               25580000
255900                :ORGPHY-PRIM-IND                                  25590000
256000           FROM TORGPHY                                           25600000
256100          WHERE ORG_CLUSTR_ID = :ORGPHY-ORG-CLUSTR-ID             25610000
256200            AND PRIM_IND = 'S'                                    25620000
256300     END-EXEC.                                                    25630000
256400                                                                  25640000
256500     EVALUATE TRUE                                                25650000
256600         WHEN SQLCODE = ZEROS                                     25660000
256700             SET TORGPHY-SEC-RCD-EXISTS TO TRUE                   25670000
256800         WHEN SQLCODE = +1403                                     25680000
256900             SET TORGPHY-SEC-RCD-DOES-NOT-EXIST TO TRUE           25690000
257000         WHEN OTHER                                               25700000
257100             PERFORM Z9999-ABEND-ROUTINE                          25710000
257200     END-EVALUATE.                                                25720000
257300                                                                  25730000
257400 T1600-EXIT.                                                      25740000
257500     EXIT.                                                        25750000
257600                                                                  25760000
257700                                                                  25770000
257800 T1700-UPDATE-TORGPHY-SEC.                                        25780000
257900                                                                  25790000
258000     DISPLAY 'T1700-UPDATE-TORGPHY-SEC'.                          25800000
258100                                                                  25810000
258200     EXEC SQL                                                     25820000
258300         UPDATE TORGPHY                                           25830000
258400            SET PHY_LOC_ID    = :ORGPHY-PHY-LOC-ID                25840000
258500          WHERE ORG_CLUSTR_ID = :ORGPHY-ORG-CLUSTR-ID             25850000
258600            AND PRIM_IND      = 'S'                               25860000
258700     END-EXEC.                                                    25870000
258800                                                                  25880000
258900     EVALUATE TRUE                                                25890000
259000         WHEN SQLCODE = ZEROS                                     25900000
259100             CONTINUE                                             25910000
259200         WHEN OTHER                                               25920000
259300             DISPLAY 'ORGPHY-ORG-CLUSTR-ID:  '                    25930000
259400                                 ORGPHY-ORG-CLUSTR-ID             25940000
259500             DISPLAY 'ORGPHY-PHY-LOC-ID:  '                       25950000
259600                                 ORGPHY-PHY-LOC-ID                25960000
259700             PERFORM Z9999-ABEND-ROUTINE                          25970000
259800     END-EVALUATE.                                                25980000
259900                                                                  25990000
260000 T1700-EXIT.                                                      26000000
260100     EXIT.                                                        26010000
260200                                                                  26020000
260300                                                                  26030000
260400 T1800-UPDATE-TPHYLOC.                                            26040000
260500                                                                  26050000
260600     DISPLAY 'T1800-UPDATE-TPHYLOC'.                              26060000
260700                                                                  26070000
260800     EXEC SQL                                                     26080000
260900         UPDATE TPHYLOC                                           26090000
261000            SET PHY_LOC_NAME  = :PHYLOC-PHY-LOC-NAME,             26100000
261100                ADR_LNE1_DESC = :PHYLOC-ADR-LNE1-DESC,            26110000
261200                ADR_LNE2_DESC = :PHYLOC-ADR-LNE2-DESC             26120000
261300                                :WS-ADR-LNE2-DESC-NULL,           26130000
261400                CTY_NAME      = :PHYLOC-CTY-NAME,                 26140000
261500                ST_CDE        = :PHYLOC-ST-CDE,                   26150000
261600                ZIP_CDE       = :PHYLOC-ZIP-CDE                   26160000
261700          WHERE PHY_LOC_ID    = :PHYLOC-PHY-LOC-ID                26170000
261800     END-EXEC.                                                    26180000
261900                                                                  26190000
262000     EVALUATE TRUE                                                26200000
262100         WHEN SQLCODE = ZEROS                                     26210000
262200             CONTINUE                                             26220000
262300         WHEN OTHER                                               26230000
262400             DISPLAY 'PHYLOC-PHY-LOC-NAME:   '                    26240000
262500                             PHYLOC-PHY-LOC-NAME                  26250000
262600             DISPLAY 'PHYLOC-ADR-LNE1-DESC:  '                    26260000
262700                             PHYLOC-ADR-LNE1-DESC                 26270000
262800             DISPLAY 'PHYLOC-ADR-LNE2-DESC:  '                    26280000
262900                             PHYLOC-ADR-LNE2-DESC                 26290000
263000             DISPLAY 'PHYLOC-CTY-NAME:       '                    26300000
263100                             PHYLOC-CTY-NAME                      26310000
263200             DISPLAY 'PHYLOC-ST-CDE:         '                    26320000
263300                             PHYLOC-ST-CDE                        26330000
263400             DISPLAY 'PHYLOC-ZIP-CDE:        '                    26340000
263500                             PHYLOC-ZIP-CDE                       26350000
263600             PERFORM Z9999-ABEND-ROUTINE                          26360000
263700     END-EVALUATE.                                                26370000
263800                                                                  26380000
263900 T1800-EXIT.                                                      26390000
264000     EXIT.                                                        26400000
264100                                                                  26410000
264200                                                                  26420000
264300 T1850-UPDATE-TPHYLOC.                                            26430000
264400                                                                  26440000
264500     DISPLAY 'T1850-UPDATE-TPHYLOC'.                              26450000
264600                                                                  26460000
264700     EXEC SQL                                                     26470000
264800         UPDATE TPHYLOC                                           26480000
264900            SET PHY_LOC_NAME  = :PHYLOC-PHY-LOC-NAME              26490000
265000          WHERE PHY_LOC_ID    = :PHYLOC-PHY-LOC-ID                26500000
265100     END-EXEC.                                                    26510000
265200                                                                  26520000
265300     EVALUATE TRUE                                                26530000
265400         WHEN SQLCODE = ZEROS                                     26540000
265500             CONTINUE                                             26550000
265600         WHEN OTHER                                               26560000
265700             DISPLAY 'PHYLOC-PHY-LOC-NAME:   '                    26570000
265800                             PHYLOC-PHY-LOC-NAME                  26580000
265900             PERFORM Z9999-ABEND-ROUTINE                          26590000
266000     END-EVALUATE.                                                26600000
266100                                                                  26610000
266200 T1850-EXIT.                                                      26620000
266300     EXIT.                                                        26630000
266400                                                                  26640000
266500                                                                  26650000
266600 T1900-SELECT-TPHYLOC-TORGPHY.                                    26660000
266700                                                                  26670000
266800     DISPLAY 'T1900-SELECT-TPHYLOC-TORGPHY'.                      26680000
266900                                                                  26690000
267000     EXEC SQL                                                     26700000
267100         SELECT  A.PHY_LOC_ID,                                    26710000
267200                 A.PHY_LOC_NAME,                                  26720000
267300                 A.ADR_LNE1_DESC,                                 26730000
267400                 A.ADR_LNE2_DESC,                                 26740000
267500                 A.CTY_NAME,                                      26750000
267600                 A.ST_CDE,                                        26760000
267700                 A.ZIP_CDE                                        26770000
267800           INTO :PHYLOC-PHY-LOC-ID,                               26780000
267900                :PHYLOC-PHY-LOC-NAME,                             26790000
268000                :PHYLOC-ADR-LNE1-DESC,                            26800000
268100                :PHYLOC-ADR-LNE2-DESC:WS-ADR-LNE2-DESC-NULL,      26810000
268200                :PHYLOC-CTY-NAME,                                 26820000
268300                :PHYLOC-ST-CDE,                                   26830000
268400                :PHYLOC-ZIP-CDE                                   26840000
268500           FROM TPHYLOC A,                                        26850000
268600                TORGPHY B                                         26860000
268700          WHERE B.ORG_CLUSTR_ID = :ORGPHY-ORG-CLUSTR-ID           26870000
268800           AND  B.PRIM_IND      = 'Y'                             26880000
268900           AND  B.PHY_LOC_ID    = A.PHY_LOC_ID                    26890000
269000     END-EXEC.                                                    26900000
269100                                                                  26910000
269200     EVALUATE TRUE                                                26920000
269300         WHEN SQLCODE = ZEROS                                     26930000
269400             SET TPHYLOC-RCD-EXISTS TO TRUE                       26940000
269500         WHEN SQLCODE = +1403                                     26950000
269600             SET TPHYLOC-RCD-DOES-NOT-EXIST TO TRUE               26960000
269700         WHEN OTHER                                               26970000
269800             PERFORM Z9999-ABEND-ROUTINE                          26980000
269900     END-EVALUATE.                                                26990000
270000                                                                  27000000
270100 T1900-EXIT.                                                      27010000
270200     EXIT.                                                        27020000
270300                                                                  27030000
270400                                                                  27040000
270500 U8000-CONVERT-ALPHA-TO-NUMERIC.                                  27050000
270600                                                                  27060000
270700     SET OUT-IDX TO 1.                                            27070000
270800     PERFORM                                                      27080000
270900        VARYING IN-IDX FROM 1 BY 1                                27090000
271000           UNTIL IN-IDX > 20                                      27100000
271100         IF WS-INPUT-DIGIT-IN (IN-IDX) IS NUMERIC                 27110000
271200             MOVE WS-INPUT-DIGIT-IN (IN-IDX) TO                   27120000
271300                  WS-OUTPUT-DIGIT-OUT (OUT-IDX)                   27130000
271400                  SET OUT-IDX UP BY 1                             27140000
271500         END-IF                                                   27150000
271600     END-PERFORM.                                                 27160000
271700                                                                  27170000
271800     INSPECT WS-OUTPUT-NUMBER-OUT REPLACING ALL ' ' BY '0'.       27180000
271900                                                                  27190000
272000 U8000-EXIT.                                                      27200000
272100     EXIT.                                                        27210000
272200                                                                  27220000
272300                                                                  27230000
272400* ------------------------------------------------------------- * 27240000
272500* DECREMENT THE DATE IN WS-START-DATE BY ONE DAY.  PLACE THE      27250000
272600* RESULT IN WS-DATE-DEC-DAYS.                                     27260000
272700* ------------------------------------------------------------- * 27270000
272800 U8100-DECREMENT-DATE.                                            27280000
272900                                                                  27290000
273000     INITIALIZE DPG51                                             27300000
273100                DPG52                                             27310000
273200                DPG53                                             27320000
273300                DPG54                                             27330000
273400                DPG55                                             27340000
273500                DPG56.                                            27350000
273600                                                                  27360000
273700     MOVE WS-START-DATE         TO DPG52-LK-DATE-INPUT.           27370000
273800     SET DPG51-DECREMENT-DATE   TO TRUE.                          27380000
273900     MOVE WS-DAYS               TO DPG51-INCR-DECR-DAYS-9.        27390000
274000                                                                  27400000
274100     MOVE 'F2'                  TO DPG51-CALENDAR-TYPE            27410000
274200     SET  DPG52-LK-DTE-ISO-FMT  TO TRUE.                          27420000
274300                                                                  27430000
274400     CALL WS-DPKUT500                                             27440000
274500         USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.               27450000
274600                                                                  27460000
274700     IF (DPG54-DATE-INVALID OR                                    27470000
274800         DPG54-SEVERE-ERROR)                                      27480000
274900         DISPLAY 'DPKUT500 ERROR = ' DPG54-ERROR-MESSAGE          27490000
275000         DISPLAY '** PROGRAM ERROR **'                            27500000
275100         DISPLAY 'MAKUT226  - DECREMENT DATE: ' WS-START-DATE     27510000
275200     END-IF.                                                      27520000
275300                                                                  27530000
275400     MOVE DPG55-DB2-ISO-DATE-FMT TO WS-DATE-DEC-DAYS.             27540000
275500                                                                  27550000
275600 U8100-EXIT.                                                      27560000
275700     EXIT.                                                        27570000
275800                                                                  27580000
275900                                                                  27590000
276000 U8200-LOAD-DC-INFO.                                              27600000
276100                                                                  27610000
276200     DISPLAY 'U8200-LOAD-DC-INFO'.                                27620000
276300                                                                  27630000
276400     PERFORM VARYING WS-SUB                                       27640000
276500         FROM 1 BY 1                                              27650000
276600         UNTIL WS-SUB > 2                                         27660000
276700             MOVE ZEROS  TO WS-DC-CLUSTR-ID(WS-SUB)               27670000
276800             MOVE SPACES TO WS-DC-ORG-CLUSTR-NAME(WS-SUB)         27680000
276900                            WS-DC-EFF-BEG-TMST(WS-SUB)            27690000
277000                            WS-DC-EFF-END-TMST(WS-SUB)            27700000
277100     END-PERFORM.                                                 27710000
277200                                                                  27720000
277300     PERFORM U8210-OPEN-DCCLC                                     27730000
277400        THRU U8210-EXIT.                                          27740000
277500                                                                  27750000
277600     SET MORE-DCS TO TRUE.                                        27760000
277700     PERFORM VARYING WS-SUB FROM 1 BY 1                           27770000
277800       UNTIL NO-MORE-DCS                                          27780000
277900         PERFORM U8220-FETCH-DCCLC                                27790000
278000            THRU U8220-EXIT                                       27800000
278100     END-PERFORM.                                                 27810000
278200                                                                  27820000
278300     PERFORM U8230-CLOSE-DCCLC                                    27830000
278400        THRU U8230-EXIT.                                          27840000
278500                                                                  27850000
278600     PERFORM VARYING WS-SUB FROM 1 BY 1                           27860000
278700       UNTIL WS-SUB > 2                                           27870000
278800                                                                  27880000
278900           IF WS-DC-CLUSTR-ID(WS-SUB) > ZEROS                     27890000
279000               MOVE WS-DC-CLUSTR-ID(WS-SUB)                       27900000
279100                             TO ORGCLT-ORG-CLUSTR-ID              27910000
279200                                                                  27920000
279300               PERFORM U8240-SELECT-CLUSTR-NAME                   27930000
279400                  THRU U8240-EXIT                                 27940000
279500                                                                  27950000
279600               IF TORGCLT-RCD-EXISTS                              27960000
279700                   MOVE ORGCLT-ORG-CLUSTR-NAME                    27970000
279800                             TO WS-DC-ORG-CLUSTR-NAME(WS-SUB)     27980000
279900               END-IF                                             27990000
280000                                                                  28000000
280100           END-IF                                                 28010000
280200                                                                  28020000
280300     END-PERFORM.                                                 28030000
280400                                                                  28040000
280500 U8200-EXIT.                                                      28050000
280600     EXIT.                                                        28060000
280700                                                                  28070000
280800                                                                  28080000
280900 U8210-OPEN-DCCLC.                                                28090000
281000                                                                  28100000
281100     DISPLAY 'U8210-OPEN-DCCLC'.                                  28110000
281200                                                                  28120000
281300     EXEC SQL                                                     28130000
281400         OPEN DCCLC                                               28140000
281500     END-EXEC.                                                    28150000
281600                                                                  28160000
281700     EVALUATE TRUE                                                28170000
281800         WHEN SQLCODE = ZEROS                                     28180000
281900             CONTINUE                                             28190000
282000         WHEN OTHER                                               28200000
282100             PERFORM Z9999-ABEND-ROUTINE                          28210000
282200     END-EVALUATE.                                                28220000
282300                                                                  28230000
282400 U8210-EXIT.                                                      28240000
282500     EXIT.                                                        28250000
282600                                                                  28260000
282700                                                                  28270000
282800 U8220-FETCH-DCCLC.                                               28280000
282900                                                                  28290000
283000     DISPLAY 'U8220-FETCH-DCCLC'.                                 28300000
283100                                                                  28310000
283200     EXEC SQL                                                     28320000
283300         FETCH DCCLC                                              28330000
283400          INTO :ORGCLC-PRNT-ORG-CLUSTR-ID,                        28340000
283500               :ORGCLC-EFF-BEG-TMST,                              28350000
283600               :ORGCLC-EFF-END-TMST:WS-CLC-EFF-END-TMST-NULL      28360000
283700     END-EXEC.                                                    28370000
283800                                                                  28380000
283900     EVALUATE TRUE                                                28390000
284000         WHEN SQLCODE = ZEROS                                     28400000
284100             MOVE ORGCLC-PRNT-ORG-CLUSTR-ID                       28410000
284200                          TO WS-DC-CLUSTR-ID(WS-SUB)              28420000
284300             MOVE ORGCLC-EFF-BEG-TMST                             28430000
284400                          TO WS-DC-EFF-BEG-TMST(WS-SUB)           28440000
284500             IF WS-CLC-EFF-END-TMST-NULL = 0                      28450000
284600                 MOVE ORGCLC-EFF-END-TMST                         28460000
284700                          TO WS-DC-EFF-END-TMST(WS-SUB)           28470000
284800             END-IF                                               28480000
284900         WHEN SQLCODE = +1403                                     28490000
285000             SET NO-MORE-DCS TO TRUE                              28500000
285100             GO TO U8220-EXIT                                     28510000
285200         WHEN OTHER                                               28520000
285300             PERFORM Z9999-ABEND-ROUTINE                          28530000
285400     END-EVALUATE.                                                28540000
285500                                                                  28550000
285600***  CHECK IF WE'VE REACHED THE 2 DC LIMIT                        28560000
285700     IF WS-SUB > 1                                                28570000
285800         SET NO-MORE-DCS TO TRUE                                  28580000
285900     END-IF.                                                      28590000
286000                                                                  28600000
286100 U8220-EXIT.                                                      28610000
286200     EXIT.                                                        28620000
286300                                                                  28630000
286400                                                                  28640000
286500 U8230-CLOSE-DCCLC.                                               28650000
286600                                                                  28660000
286700     DISPLAY 'U8230-CLOSE-DCCLC'.                                 28670000
286800                                                                  28680000
286900     EXEC SQL                                                     28690000
287000         CLOSE DCCLC                                              28700000
287100     END-EXEC.                                                    28710000
287200                                                                  28720000
287300     EVALUATE TRUE                                                28730000
287400         WHEN SQLCODE = ZEROS                                     28740000
287500             CONTINUE                                             28750000
287600         WHEN OTHER                                               28760000
287700             PERFORM Z9999-ABEND-ROUTINE                          28770000
287800     END-EVALUATE.                                                28780000
287900                                                                  28790000
288000 U8230-EXIT.                                                      28800000
288100     EXIT.                                                        28810000
288200                                                                  28820000
288300                                                                  28830000
288400 U8240-SELECT-CLUSTR-NAME.                                        28840000
288500                                                                  28850000
288600     DISPLAY 'U8240-SELECT-CLUSTR-NAME'.                          28860000
288700                                                                  28870000
288800     EXEC SQL                                                     28880000
288900         SELECT ORG_CLUSTR_NAME                                   28890000
289000           INTO :ORGCLT-ORG-CLUSTR-NAME                           28900000
289100           FROM TORGCLT                                           28910000
289200          WHERE ORG_CLUSTR_ID = :ORGCLT-ORG-CLUSTR-ID             28920000
289300            AND ORG_TYP_CDE   = 'DC'                              28930000
289400     END-EXEC.                                                    28940000
289500                                                                  28950000
289600     EVALUATE TRUE                                                28960000
289700         WHEN SQLCODE = ZEROS                                     28970000
289800             SET TORGCLT-RCD-EXISTS TO TRUE                       28980000
289900         WHEN SQLCODE = +1403                                     28990000
290000             SET TORGCLT-RCD-DOES-NOT-EXIST TO TRUE               29000000
290100         WHEN OTHER                                               29010000
290200             PERFORM Z9999-ABEND-ROUTINE                          29020000
290300     END-EVALUATE.                                                29030000
290400                                                                  29040000
290500 U8240-EXIT.                                                      29050000
290600     EXIT.                                                        29060000
290700                                                                  29070000
290800                                                                  29080000
290900 U8300-WRITE-NOTIFY-RECORD.                                       29090000
291000                                                                  29100000
291100     WRITE NOTIFY-RECORD FROM WS-NOTIFY-RECORD.                   29110000
291200                                                                  29120000
291300     ADD 1 TO WS-NOTIFY-COUNT.                                    29130000
291400                                                                  29140000
291500 U8300-EXIT.                                                      29150000
291600     EXIT.                                                        29160000
291700                                                                  29170000
291800                                                                  29180000
291900 U8400-SET-STORE-DATES.                                           29190000
292000                                                                  29200000
292100     DISPLAY 'U8400-SET-STORE-DATES'.                             29210000
292200                                                                  29220000
292300     IF HO100-RMS-TBL-NAME = WS-WH-STORE-ASSIGN                   29230000
292400                                                                  29240000
292500         IF WS-DC-EFF-BEG-TMST(2) = SPACES                        29250000
292600           MOVE WS-DC-EFF-BEG-TMST(1) TO ORGCLT-EFF-BEG-TMST      29260000
292700         ELSE                                                     29270000
292800           IF WS-DC-EFF-BEG-TMST(1) < WS-DC-EFF-BEG-TMST(2)       29280000
292900                                                                  29290000
293000*****   WE COULD HAVE 2 TORGCLC RELATIONSHIPS FOR THE SAME DC     29300000
293100*****   AND STORE.  ONE WOULD BE EXPIRED AND THE OTHER WOULD BE   29310000
293200*****   ACTIVE.  THIS WOULD HAPPEN IF THE USER CHANGES THE        29320000
293300*****   EFFECTIVE BEGIN DATE FOR THE SAME DC/STORE RELATIONSHIP.  29330000
293400                                                                  29340000
293500             IF (WS-DC-ORG-CLUSTR-NAME(1) =                       29350000
293600                           WS-DC-ORG-CLUSTR-NAME(2)               29360000
293700               AND WS-DC-EFF-END-TMST(1) NOT = SPACES)            29370000
293800                 MOVE WS-DC-EFF-BEG-TMST(2) TO ORGCLT-EFF-BEG-TMST29380000
293900             ELSE                                                 29390000
294000                 MOVE WS-DC-EFF-BEG-TMST(1) TO ORGCLT-EFF-BEG-TMST29400000
294100             END-IF                                               29410000
294200           ELSE                                                   29420000
294300             MOVE WS-DC-EFF-BEG-TMST(2) TO ORGCLT-EFF-BEG-TMST    29430000
294400           END-IF                                                 29440000
294500         END-IF                                                   29450000
294600                                                                  29460000
294700     END-IF.                                                      29470000
294800                                                                  29480000
294900***  THE EFF-END-TMST WILL BE SET WHEN PROCESSING STORE           29490000
295000***  UPDATE AND WH-STORE-ASSIGN MESSAGES                          29500000
295100                                                                  29510000
295200     IF WS-DC-EFF-BEG-TMST(1) NOT = SPACES                        29520000
295300       AND WS-DC-EFF-BEG-TMST(2) NOT = SPACES                     29530000
295400                                                                  29540000
295500         IF (WS-DC-EFF-END-TMST(1) = SPACES                       29550000
295600             AND WS-DC-EFF-END-TMST(2) NOT = SPACES)              29560000
295700           OR (WS-DC-EFF-END-TMST(2) = SPACES                     29570000
295800               AND WS-DC-EFF-END-TMST(1) NOT = SPACES)            29580000
295900                                                                  29590000
296000             INITIALIZE ORGCLT-EFF-END-TMST                       29600000
296100             MOVE -1 TO WS-CLT-EFF-END-TMST-NULL                  29610000
296200                                                                  29620000
296300         ELSE IF WS-DC-EFF-END-TMST(1)                            29630000
296400                     > WS-DC-EFF-END-TMST(2)                      29640000
296500                                                                  29650000
296600             MOVE WS-DC-EFF-END-TMST(1)                           29660000
296700                     TO ORGCLT-EFF-END-TMST                       29670000
296800             MOVE 0  TO WS-CLT-EFF-END-TMST-NULL                  29680000
296900                                                                  29690000
297000         ELSE                                                     29700000
297100                                                                  29710000
297200             MOVE WS-DC-EFF-END-TMST(2)                           29720000
297300                     TO ORGCLT-EFF-END-TMST                       29730000
297400             MOVE 0  TO WS-CLT-EFF-END-TMST-NULL                  29740000
297500                                                                  29750000
297600         END-IF                                                   29760000
297700                                                                  29770000
297800     ELSE                                                         29780000
297900                                                                  29790000
298000         IF WS-DC-EFF-END-TMST(1) = SPACES                        29800000
298100             INITIALIZE ORGCLT-EFF-END-TMST                       29810000
298200             MOVE -1 TO WS-CLT-EFF-END-TMST-NULL                  29820000
298300         ELSE                                                     29830000
298400             MOVE WS-DC-EFF-END-TMST(1)                           29840000
298500                     TO ORGCLT-EFF-END-TMST                       29850000
298600             MOVE 0  TO WS-CLT-EFF-END-TMST-NULL                  29860000
298700         END-IF                                                   29870000
298800                                                                  29880000
298900     END-IF.                                                      29890000
299000                                                                  29900000
299100 U8400-EXIT.                                                      29910000
299200     EXIT.                                                        29920000
299300                                                                  29930000
299400*************************************************************     29940000
299500*** TO FIX TORGCLT-EFF-BEG-TMST AND TORGCLT-EFF-END-TMST          29950000
299600*** ISSUE WHEN STORE OPEN DATE IS PUSHED TO A LATER DATE.         29960000
299700*** THIS MODULE MODELS U8400-SET-STORE-DATES.                     29970000
299800*************************************************************     29980000
299900 U8500-SET-STORE-EFF-DATES.                                       29990000
300000                                                                  30000000
300100     DISPLAY 'U8500-SET-STORE-EFF-DATES'.                         30010000
300200                                                                  30020000
300300     IF HO100-RMS-TBL-NAME = WS-WH-STORE-ASSIGN                   30030000
300400                                                                  30040000
300500         IF WS-DC-EFF-BEG-TMST(2) = SPACES                        30050000
300600            MOVE HO100-SA-ASSIGN-DATE TO ORGCLT-EFF-BEG-TMST(1:10)30060000
300700            SET  UPDATE-DATE-YES      TO TRUE                     30070000
300800         ELSE                                                     30080000
300900           IF WS-DC-EFF-BEG-TMST(1) < WS-DC-EFF-BEG-TMST(2)       30090000
301000                                                                  30100000
301100*****   WE COULD HAVE 2 TORGCLC RELATIONSHIPS FOR THE SAME DC     30110000
301200*****   AND STORE.  ONE WOULD BE EXPIRED AND THE OTHER WOULD BE   30120000
301300*****   ACTIVE.  THIS WOULD HAPPEN IF THE USER CHANGES THE        30130000
301400*****   EFFECTIVE BEGIN DATE FOR THE SAME DC/STORE RELATIONSHIP.  30140000
301500                                                                  30150000
301600             IF (WS-DC-ORG-CLUSTR-NAME(1) =                       30160000
301700                           WS-DC-ORG-CLUSTR-NAME(2)               30170000
301800               AND WS-DC-EFF-END-TMST(1) NOT = SPACES)            30180000
301900                 MOVE WS-DC-EFF-BEG-TMST(2) TO ORGCLT-EFF-BEG-TMST30190000
302000             ELSE                                                 30200000
302100                 MOVE WS-DC-EFF-BEG-TMST(1) TO ORGCLT-EFF-BEG-TMST30210000
302200             END-IF                                               30220000
302300           ELSE                                                   30230000
302400             MOVE WS-DC-EFF-BEG-TMST(2) TO ORGCLT-EFF-BEG-TMST    30240000
302500           END-IF                                                 30250000
302600         END-IF                                                   30260000
302700                                                                  30270000
302800     END-IF.                                                      30280000
302900                                                                  30290000
303000***  THE EFF-END-TMST WILL BE SET WHEN PROCESSING STORE           30300000
303100***  UPDATE AND WH-STORE-ASSIGN MESSAGES                          30310000
303200                                                                  30320000
303300     IF WS-DC-EFF-BEG-TMST(1) NOT = SPACES                        30330000
303400       AND WS-DC-EFF-BEG-TMST(2) NOT = SPACES                     30340000
303500                                                                  30350000
303600         IF (WS-DC-EFF-END-TMST(1) = SPACES                       30360000
303700             AND WS-DC-EFF-END-TMST(2) NOT = SPACES)              30370000
303800           OR (WS-DC-EFF-END-TMST(2) = SPACES                     30380000
303900               AND WS-DC-EFF-END-TMST(1) NOT = SPACES)            30390000
304000                                                                  30400000
304100             INITIALIZE ORGCLT-EFF-END-TMST                       30410000
304200             MOVE -1 TO WS-CLT-EFF-END-TMST-NULL                  30420000
304300                                                                  30430000
304400         ELSE IF WS-DC-EFF-END-TMST(1)                            30440000
304500                     > WS-DC-EFF-END-TMST(2)                      30450000
304600                                                                  30460000
304700             MOVE WS-DC-EFF-END-TMST(1)                           30470000
304800                     TO ORGCLT-EFF-END-TMST                       30480000
304900             MOVE 0  TO WS-CLT-EFF-END-TMST-NULL                  30490000
305000                                                                  30500000
305100         ELSE                                                     30510000
305200                                                                  30520000
305300             MOVE WS-DC-EFF-END-TMST(2)                           30530000
305400                     TO ORGCLT-EFF-END-TMST                       30540000
305500             MOVE 0  TO WS-CLT-EFF-END-TMST-NULL                  30550000
305600                                                                  30560000
305700         END-IF                                                   30570000
305800                                                                  30580000
305900     ELSE                                                         30590000
306000                                                                  30600000
306100         IF WS-DC-EFF-END-TMST(1) = SPACES OR                     30610000
306200            UPDATE-DATE-YES                                       30620000
306300***** THIS STATEMENT IS ADDED TO FIX AN ISSUE WITH       *****    30630000
306400***** ORGCLT-EFF-END-TMST WHERE DATE CHANGE FOR STORE    *****    30640000
306500***** IS MADE IN RMS.                                    *****    30650000
306600             INITIALIZE ORGCLT-EFF-END-TMST                       30660000
306700             MOVE -1 TO WS-CLT-EFF-END-TMST-NULL                  30670000
306800             IF UPDATE-DATE-YES                                   30680000
306900                SET UPDATE-DATE-NO  TO TRUE                       30690000
307000             END-IF                                               30700000
307100         ELSE                                                     30710000
307200             MOVE WS-DC-EFF-END-TMST(1)                           30720000
307300                     TO ORGCLT-EFF-END-TMST                       30730000
307400             MOVE 0  TO WS-CLT-EFF-END-TMST-NULL                  30740000
307500         END-IF                                                   30750000
307600                                                                  30760000
307700     END-IF.                                                      30770000
307800                                                                  30780000
307900                                                                  30790000
308000 U9000-SELECT-TORGCLT.                                            30800000
308100                                                                  30810000
308200     DISPLAY 'U9000-SELECT-TORGCLT'.                              30820000
308300     DISPLAY 'ORGCLT-ORG-CLUSTR-NAME:  ' ORGCLT-ORG-CLUSTR-NAME.  30830000
308400                                                                  30840000
308500     IF TORGCLT-HIER-CDE                                          30850000
308600                                                                  30860000
308700     DISPLAY 'PROCESSING IF TORGCLT-HIER-CDE'                     30870000
308800     DISPLAY 'ORGCLT-HIER-CDE:         ' ORGCLT-HIER-CDE          30880000
308900                                                                  30890000
309000     EXEC SQL                                                     30900000
309100         SELECT                                                   30910000
309200            ORG_CLUSTR_ID,                                        30920000
309300            ORG_CLUSTR_NAME_5,                                    30930000
309400            ORG_CLUSTR_NAME_10,                                   30940000
309500            ORG_CLUSTR_NAME,                                      30950000
309600            ORG_CLUSTR_DESC,                                      30960000
309700            EFF_BEG_TMST,                                         30970000
309800            EFF_END_TMST,                                         30980000
309900            CLUSTR_TYP_CDE,                                       30990000
310000            HIER_TYP_CDE,                                         31000000
310100            HIER_CDE,                                             31010000
310200            ORG_CLUSTR_CDE,                                       31020000
310300            ORG_TYP_CDE,                                          31030000
310400            NMDSE_PO_BEG_TMST,                                    31040000
310500            NMDSE_PO_END_TMST,                                    31050000
310600            CRE_BY_UID,                                           31060000
310700            CRE_TMST,                                             31070000
310800            LAST_UPD_BY_UID,                                      31080000
310900            LAST_UPD_TMST,                                        31090000
311000            ARCH_DTE,                                             31100000
311100            OWNER_ID,                                             31110000
311200            OPN_DTE,                                              31120000
311300            CLO_DTE,                                              31130000
311400            REPL_ORG_CLUSTR_ID,                                   31140000
311500            E_BUS_LOC_IND                                         31150000
311600         INTO                                                     31160000
311700            :ORGCLT-ORG-CLUSTR-ID,                                31170000
311800            :ORGCLT-ORG-CLUSTR-NAME-5:WS-ORG-CLUSTR-NAME-5-NULL,  31180000
311900            :ORGCLT-ORG-CLUSTR-NAME-10:WS-ORG-CLUSTR-NAME-10-NULL,31190000
312000            :ORGCLT-ORG-CLUSTR-NAME,                              31200000
312100            :ORGCLT-ORG-CLUSTR-DESC,                              31210000
312200            :ORGCLT-EFF-BEG-TMST,                                 31220000
312300            :ORGCLT-EFF-END-TMST:WS-CLT-EFF-END-TMST-NULL,        31230000
312400            :ORGCLT-CLUSTR-TYP-CDE:WS-CLUSTR-TYP-CDE-NULL,        31240000
312500            :ORGCLT-HIER-TYP-CDE:WS-HIER-TYP-CDE-NULL,            31250000
312600            :ORGCLT-HIER-CDE:WS-HIER-CDE-NULL,                    31260000
312700            :ORGCLT-ORG-CLUSTR-CDE,                               31270000
312800            :ORGCLT-ORG-TYP-CDE:WS-ORG-TYP-CDE-NULL,              31280000
312900            :ORGCLT-NMDSE-PO-BEG-TMST:WS-NMDSE-PO-BEG-TMST-NULL,  31290000
313000            :ORGCLT-NMDSE-PO-END-TMST:WS-NMDSE-PO-END-TMST-NULL,  31300000
313100            :ORGCLT-CRE-BY-UID,                                   31310000
313200            :ORGCLT-CRE-TMST,                                     31320000
313300            :ORGCLT-LAST-UPD-BY-UID,                              31330000
313400            :ORGCLT-LAST-UPD-TMST,                                31340000
313500            :ORGCLT-ARCH-DTE:WS-ARCH-DTE-NULL,                    31350000
313600            :ORGCLT-OWNER-ID:WS-OWNER-ID-NULL,                    31360000
313700            :ORGCLT-OPN-DTE:WS-OPN-DTE-NULL,                      31370000
313800            :ORGCLT-CLO-DTE:WS-CLO-DTE-NULL,                      31380000
313900            :ORGCLT-REPL-ORG-CLUSTR-ID:WS-REPL-ORG-CLUSTR-ID-NULL,31390000
314000            :ORGCLT-E-BUS-LOC-IND                                 31400000
314100         FROM TORGCLT                                             31410000
314200        WHERE ORG_CLUSTR_NAME = :ORGCLT-ORG-CLUSTR-NAME           31420000
314300          AND HIER_CDE        = :ORGCLT-HIER-CDE                  31430000
314400     END-EXEC                                                     31440000
314500                                                                  31450000
314600     ELSE                                                         31460000
314700                                                                  31470000
314800     IF TORGCLT-ORG-TYP-CDE                                       31480000
314900                                                                  31490000
315000     DISPLAY 'PROCESSING IF TORGCLT-ORG-TYP-CDE'                  31500000
315100     DISPLAY 'ORGCLT-ORG-TYP-CDE:      ' ORGCLT-ORG-TYP-CDE       31510000
315200                                                                  31520000
315300     EXEC SQL                                                     31530000
315400         SELECT                                                   31540000
315500            ORG_CLUSTR_ID,                                        31550000
315600            ORG_CLUSTR_NAME_5,                                    31560000
315700            ORG_CLUSTR_NAME_10,                                   31570000
315800            ORG_CLUSTR_NAME,                                      31580000
315900            ORG_CLUSTR_DESC,                                      31590000
316000            EFF_BEG_TMST,                                         31600000
316100            EFF_END_TMST,                                         31610000
316200            CLUSTR_TYP_CDE,                                       31620000
316300            HIER_TYP_CDE,                                         31630000
316400            HIER_CDE,                                             31640000
316500            ORG_CLUSTR_CDE,                                       31650000
316600            ORG_TYP_CDE,                                          31660000
316700            NMDSE_PO_BEG_TMST,                                    31670000
316800            NMDSE_PO_END_TMST,                                    31680000
316900            CRE_BY_UID,                                           31690000
317000            CRE_TMST,                                             31700000
317100            LAST_UPD_BY_UID,                                      31710000
317200            LAST_UPD_TMST,                                        31720000
317300            ARCH_DTE,                                             31730000
317400            OWNER_ID,                                             31740000
317500            OPN_DTE,                                              31750000
317600            CLO_DTE,                                              31760000
317700            REPL_ORG_CLUSTR_ID,                                   31770000
317800            E_BUS_LOC_IND                                         31780000
317900         INTO                                                     31790000
318000            :ORGCLT-ORG-CLUSTR-ID,                                31800000
318100            :ORGCLT-ORG-CLUSTR-NAME-5:WS-ORG-CLUSTR-NAME-5-NULL,  31810000
318200            :ORGCLT-ORG-CLUSTR-NAME-10:WS-ORG-CLUSTR-NAME-10-NULL,31820000
318300            :ORGCLT-ORG-CLUSTR-NAME,                              31830000
318400            :ORGCLT-ORG-CLUSTR-DESC,                              31840000
318500            :ORGCLT-EFF-BEG-TMST,                                 31850000
318600            :ORGCLT-EFF-END-TMST:WS-CLT-EFF-END-TMST-NULL,        31860000
318700            :ORGCLT-CLUSTR-TYP-CDE:WS-CLUSTR-TYP-CDE-NULL,        31870000
318800            :ORGCLT-HIER-TYP-CDE:WS-HIER-TYP-CDE-NULL,            31880000
318900            :ORGCLT-HIER-CDE:WS-HIER-CDE-NULL,                    31890000
319000            :ORGCLT-ORG-CLUSTR-CDE,                               31900000
319100            :ORGCLT-ORG-TYP-CDE:WS-ORG-TYP-CDE-NULL,              31910000
319200            :ORGCLT-NMDSE-PO-BEG-TMST:WS-NMDSE-PO-BEG-TMST-NULL,  31920000
319300            :ORGCLT-NMDSE-PO-END-TMST:WS-NMDSE-PO-END-TMST-NULL,  31930000
319400            :ORGCLT-CRE-BY-UID,                                   31940000
319500            :ORGCLT-CRE-TMST,                                     31950000
319600            :ORGCLT-LAST-UPD-BY-UID,                              31960000
319700            :ORGCLT-LAST-UPD-TMST,                                31970000
319800            :ORGCLT-ARCH-DTE:WS-ARCH-DTE-NULL,                    31980000
319900            :ORGCLT-OWNER-ID:WS-OWNER-ID-NULL,                    31990000
320000            :ORGCLT-OPN-DTE:WS-OPN-DTE-NULL,                      32000000
320100            :ORGCLT-CLO-DTE:WS-CLO-DTE-NULL,                      32010000
320200            :ORGCLT-REPL-ORG-CLUSTR-ID:WS-REPL-ORG-CLUSTR-ID-NULL,32020000
320300            :ORGCLT-E-BUS-LOC-IND                                 32030000
320400         FROM TORGCLT                                             32040000
320500        WHERE ORG_CLUSTR_NAME = :ORGCLT-ORG-CLUSTR-NAME           32050000
320600          AND ORG_TYP_CDE     = :ORGCLT-ORG-TYP-CDE               32060000
320700     END-EXEC                                                     32070000
320800                                                                  32080000
320900     ELSE                                                         32090000
321000                                                                  32100000
321100***  IF TORGCLT-OTHERS                                            32110000
321200                                                                  32120000
321300     DISPLAY 'PROCESSING IF TORGCLT-OTHERS'                       32130000
321400                                                                  32140000
321500     EXEC SQL                                                     32150000
321600         SELECT                                                   32160000
321700            ORG_CLUSTR_ID,                                        32170000
321800            ORG_CLUSTR_NAME_5,                                    32180000
321900            ORG_CLUSTR_NAME_10,                                   32190000
322000            ORG_CLUSTR_NAME,                                      32200000
322100            ORG_CLUSTR_DESC,                                      32210000
322200            EFF_BEG_TMST,                                         32220000
322300            EFF_END_TMST,                                         32230000
322400            CLUSTR_TYP_CDE,                                       32240000
322500            HIER_TYP_CDE,                                         32250000
322600            HIER_CDE,                                             32260000
322700            ORG_CLUSTR_CDE,                                       32270000
322800            ORG_TYP_CDE,                                          32280000
322900            NMDSE_PO_BEG_TMST,                                    32290000
323000            NMDSE_PO_END_TMST,                                    32300000
323100            CRE_BY_UID,                                           32310000
323200            CRE_TMST,                                             32320000
323300            LAST_UPD_BY_UID,                                      32330000
323400            LAST_UPD_TMST,                                        32340000
323500            ARCH_DTE,                                             32350000
323600            OWNER_ID,                                             32360000
323700            OPN_DTE,                                              32370000
323800            CLO_DTE,                                              32380000
323900            REPL_ORG_CLUSTR_ID,                                   32390000
324000            E_BUS_LOC_IND                                         32400000
324100         INTO                                                     32410000
324200            :ORGCLT-ORG-CLUSTR-ID,                                32420000
324300            :ORGCLT-ORG-CLUSTR-NAME-5:WS-ORG-CLUSTR-NAME-5-NULL,  32430000
324400            :ORGCLT-ORG-CLUSTR-NAME-10:WS-ORG-CLUSTR-NAME-10-NULL,32440000
324500            :ORGCLT-ORG-CLUSTR-NAME,                              32450000
324600            :ORGCLT-ORG-CLUSTR-DESC,                              32460000
324700            :ORGCLT-EFF-BEG-TMST,                                 32470000
324800            :ORGCLT-EFF-END-TMST:WS-CLT-EFF-END-TMST-NULL,        32480000
324900            :ORGCLT-CLUSTR-TYP-CDE:WS-CLUSTR-TYP-CDE-NULL,        32490000
325000            :ORGCLT-HIER-TYP-CDE:WS-HIER-TYP-CDE-NULL,            32500000
325100            :ORGCLT-HIER-CDE:WS-HIER-CDE-NULL,                    32510000
325200            :ORGCLT-ORG-CLUSTR-CDE,                               32520000
325300            :ORGCLT-ORG-TYP-CDE:WS-ORG-TYP-CDE-NULL,              32530000
325400            :ORGCLT-NMDSE-PO-BEG-TMST:WS-NMDSE-PO-BEG-TMST-NULL,  32540000
325500            :ORGCLT-NMDSE-PO-END-TMST:WS-NMDSE-PO-END-TMST-NULL,  32550000
325600            :ORGCLT-CRE-BY-UID,                                   32560000
325700            :ORGCLT-CRE-TMST,                                     32570000
325800            :ORGCLT-LAST-UPD-BY-UID,                              32580000
325900            :ORGCLT-LAST-UPD-TMST,                                32590000
326000            :ORGCLT-ARCH-DTE:WS-ARCH-DTE-NULL,                    32600000
326100            :ORGCLT-OWNER-ID:WS-OWNER-ID-NULL,                    32610000
326200            :ORGCLT-OPN-DTE:WS-OPN-DTE-NULL,                      32620000
326300            :ORGCLT-CLO-DTE:WS-CLO-DTE-NULL,                      32630000
326400            :ORGCLT-REPL-ORG-CLUSTR-ID:WS-REPL-ORG-CLUSTR-ID-NULL,32640000
326500            :ORGCLT-E-BUS-LOC-IND                                 32650000
326600         FROM TORGCLT                                             32660000
326700        WHERE ORG_CLUSTR_NAME = :ORGCLT-ORG-CLUSTR-NAME           32670000
326800     END-EXEC.                                                    32680000
326900                                                                  32690000
327000     EVALUATE TRUE                                                32700000
327100         WHEN SQLCODE = ZEROS                                     32710000
327200             SET TORGCLT-RCD-EXISTS TO TRUE                       32720000
327300         WHEN SQLCODE = +1403                                     32730000
327400             SET TORGCLT-RCD-DOES-NOT-EXIST TO TRUE               32740000
327500         WHEN OTHER                                               32750000
327600             DISPLAY 'ORGCLT-ORG-CLUSTR-NAME:  '                  32760000
327700                             ORGCLT-ORG-CLUSTR-NAME               32770000
327800             PERFORM Z9999-ABEND-ROUTINE                          32780000
327900     END-EVALUATE.                                                32790000
328000                                                                  32800000
328100 U9000-EXIT.                                                      32810000
328200     EXIT.                                                        32820000
328300                                                                  32830000
328400                                                                  32840000
328500 U9100-SELECT-NEXT-SEQ-NBR.                                       32850000
328600                                                                  32860000
328700     DISPLAY 'U9100-SELECT-NEXT-SEQ-NBR'.                         32870000
328800                                                                  32880000
328900     EXEC SQL                                                     32890000
329000         SELECT ORG_CLUSTR_SEQ.NEXTVAL                            32900000
329100           INTO :ORGCLT-ORG-CLUSTR-ID                             32910000
329200           FROM DUAL                                              32920000
329300     END-EXEC.                                                    32930000
329400                                                                  32940000
329500     EVALUATE TRUE                                                32950000
329600         WHEN SQLCODE = ZEROS                                     32960000
329700             CONTINUE                                             32970000
329800         WHEN OTHER                                               32980000
329900             PERFORM Z9999-ABEND-ROUTINE                          32990000
330000     END-EVALUATE.                                                33000000
330100                                                                  33010000
330200 U9100-EXIT.                                                      33020000
330300     EXIT.                                                        33030000
330400                                                                  33040000
330500                                                                  33050000
330600 U9200-INSERT-TORGCLT.                                            33060000
330700                                                                  33070000
330800     DISPLAY 'U9200-INSERT-TORGCLT'.                              33080000
330900                                                                  33090000
331000     EXEC SQL                                                     33100000
331100         INSERT INTO TORGCLT                                      33110000
331200          (ORG_CLUSTR_ID,                                         33120000
331300           ORG_CLUSTR_NAME_5,                                     33130000
331400           ORG_CLUSTR_NAME_10,                                    33140000
331500           ORG_CLUSTR_NAME,                                       33150000
331600           ORG_CLUSTR_DESC,                                       33160000
331700           EFF_BEG_TMST,                                          33170000
331800           EFF_END_TMST,                                          33180000
331900           CLUSTR_TYP_CDE,                                        33190000
332000           HIER_TYP_CDE,                                          33200000
332100           HIER_CDE,                                              33210000
332200           ORG_CLUSTR_CDE,                                        33220000
332300           ORG_TYP_CDE,                                           33230000
332400           NMDSE_PO_BEG_TMST,                                     33240000
332500           NMDSE_PO_END_TMST,                                     33250000
332600           CRE_BY_UID,                                            33260000
332700           CRE_TMST,                                              33270000
332800           LAST_UPD_BY_UID,                                       33280000
332900           LAST_UPD_TMST,                                         33290000
333000           ARCH_DTE,                                              33300000
333100           OWNER_ID,                                              33310000
333200           OPN_DTE,                                               33320000
333300           CLO_DTE,                                               33330000
333400           REPL_ORG_CLUSTR_ID,                                    33340000
333500           E_BUS_LOC_IND)                                         33350000
333600         VALUES                                                   33360000
333700          (:ORGCLT-ORG-CLUSTR-ID,                                 33370000
333800           :ORGCLT-ORG-CLUSTR-NAME-5:WS-ORG-CLUSTR-NAME-5-NULL,   33380000
333900           :ORGCLT-ORG-CLUSTR-NAME-10:WS-ORG-CLUSTR-NAME-10-NULL, 33390000
334000           :ORGCLT-ORG-CLUSTR-NAME,                               33400000
334100           :ORGCLT-ORG-CLUSTR-DESC,                               33410000
334200           :ORGCLT-EFF-BEG-TMST,                                  33420000
334300           :ORGCLT-EFF-END-TMST:WS-CLT-EFF-END-TMST-NULL,         33430000
334400           :ORGCLT-CLUSTR-TYP-CDE:WS-CLUSTR-TYP-CDE-NULL,         33440000
334500           :ORGCLT-HIER-TYP-CDE:WS-HIER-TYP-CDE-NULL,             33450000
334600           :ORGCLT-HIER-CDE:WS-HIER-CDE-NULL,                     33460000
334700           :ORGCLT-ORG-CLUSTR-CDE,                                33470000
334800           :ORGCLT-ORG-TYP-CDE:WS-ORG-TYP-CDE-NULL,               33480000
334900           :ORGCLT-NMDSE-PO-BEG-TMST:WS-NMDSE-PO-BEG-TMST-NULL,   33490000
335000           :ORGCLT-NMDSE-PO-END-TMST:WS-NMDSE-PO-END-TMST-NULL,   33500000
335100           'MAKUT226',                                            33510000
335200            SYSDATE,                                              33520000
335300           'MAKUT226',                                            33530000
335400            SYSDATE,                                              33540000
335500            :ORGCLT-ARCH-DTE:WS-ARCH-DTE-NULL,                    33550000
335600            :ORGCLT-OWNER-ID:WS-OWNER-ID-NULL,                    33560000
335700            :ORGCLT-OPN-DTE:WS-OPN-DTE-NULL,                      33570000
335800            :ORGCLT-CLO-DTE:WS-CLO-DTE-NULL,                      33580000
335900            :ORGCLT-REPL-ORG-CLUSTR-ID:WS-REPL-ORG-CLUSTR-ID-NULL,33590000
336000            :ORGCLT-E-BUS-LOC-IND)                                33600000
336100     END-EXEC.                                                    33610000
336200                                                                  33620000
336300     EVALUATE TRUE                                                33630000
336400         WHEN SQLCODE = ZEROS                                     33640000
336500             CONTINUE                                             33650000
336600         WHEN OTHER                                               33660000
336700             DISPLAY 'ORGCLT-ORG-CLUSTR-NAME:  '                  33670000
336800                         ORGCLT-ORG-CLUSTR-NAME                   33680000
336900             DISPLAY 'ORGCLT-ORG-CLUSTR-DESC:  '                  33690000
337000                         ORGCLT-ORG-CLUSTR-DESC                   33700000
337100             DISPLAY 'ORGCLT-EFF-BEG-TMST:  '                     33710000
337200                         ORGCLT-EFF-BEG-TMST                      33720000
337300             PERFORM Z9999-ABEND-ROUTINE                          33730000
337400     END-EVALUATE.                                                33740000
337500                                                                  33750000
337600 U9200-EXIT.                                                      33760000
337700     EXIT.                                                        33770000
337800                                                                  33780000
337900                                                                  33790000
338000 U9300-UPDATE-TORGCLT.                                            33800000
338100                                                                  33810000
338200     DISPLAY 'U9300-UPDATE-TORGCLT'.                              33820000
338300                                                                  33830000
338400     EXEC SQL                                                     33840000
338500       UPDATE TORGCLT                                             33850000
338600         SET ORG_CLUSTR_NAME_5  = :ORGCLT-ORG-CLUSTR-NAME-5       33860000
338700                                  :WS-ORG-CLUSTR-NAME-5-NULL,     33870000
338800             ORG_CLUSTR_NAME_10 = :ORGCLT-ORG-CLUSTR-NAME-10,     33880000
338900             ORG_CLUSTR_NAME    = :ORGCLT-ORG-CLUSTR-NAME,        33890000
339000             ORG_CLUSTR_DESC    = :ORGCLT-ORG-CLUSTR-DESC,        33900000
339100             EFF_BEG_TMST       = :ORGCLT-EFF-BEG-TMST,           33910000
339200             EFF_END_TMST       = :ORGCLT-EFF-END-TMST            33920000
339300                                  :WS-CLT-EFF-END-TMST-NULL,      33930000
339400             LAST_UPD_BY_UID    = 'MAKUT226',                     33940000
339500             LAST_UPD_TMST      = SYSDATE,                        33950000
339600             OPN_DTE            = :ORGCLT-OPN-DTE                 33960000
339700                                  :WS-OPN-DTE-NULL,               33970000
339800             CLO_DTE            = :ORGCLT-CLO-DTE                 33980000
339900                                  :WS-CLO-DTE-NULL,               33990000
340000             REPL_ORG_CLUSTR_ID = :ORGCLT-REPL-ORG-CLUSTR-ID      34000000
340100                                  :WS-REPL-ORG-CLUSTR-ID-NULL,    34010000
340200             E_BUS_LOC_IND      = :ORGCLT-E-BUS-LOC-IND           34020000
340300        WHERE ORG_CLUSTR_ID     = :ORGCLT-ORG-CLUSTR-ID           34030000
340400     END-EXEC.                                                    34040000
340500                                                                  34050000
340600     EVALUATE TRUE                                                34060000
340700         WHEN SQLCODE = ZEROS                                     34070000
340800             CONTINUE                                             34080000
340900         WHEN OTHER                                               34090000
341000             DISPLAY 'ORGCLT-ORG-CLUSTR-NAME:  '                  34100000
341100                         ORGCLT-ORG-CLUSTR-NAME                   34110000
341200             DISPLAY 'ORGCLT-ORG-CLUSTR-DESC:  '                  34120000
341300                         ORGCLT-ORG-CLUSTR-DESC                   34130000
341400             DISPLAY 'ORGCLT-EFF-BEG-TMST:  '                     34140000
341500                         ORGCLT-EFF-BEG-TMST                      34150000
341600             PERFORM Z9999-ABEND-ROUTINE                          34160000
341700     END-EVALUATE.                                                34170000
341800                                                                  34180000
341900 U9300-EXIT.                                                      34190000
342000     EXIT.                                                        34200000
342100                                                                  34210000
342200                                                                  34220000
342300 U9400-SELECT-TORGCLT-ID.                                         34230000
342400                                                                  34240000
342500     DISPLAY 'U9400-UPDATE-TORGCLT-ID'.                           34250000
342600                                                                  34260000
342700     EXEC SQL                                                     34270000
342800         SELECT                                                   34280000
342900            ORG_CLUSTR_ID,                                        34290000
343000            ORG_CLUSTR_NAME_5,                                    34300000
343100            ORG_CLUSTR_NAME_10,                                   34310000
343200            ORG_CLUSTR_NAME,                                      34320000
343300            ORG_CLUSTR_DESC,                                      34330000
343400            EFF_BEG_TMST,                                         34340000
343500            EFF_END_TMST,                                         34350000
343600            CLUSTR_TYP_CDE,                                       34360000
343700            HIER_TYP_CDE,                                         34370000
343800            HIER_CDE,                                             34380000
343900            ORG_CLUSTR_CDE,                                       34390000
344000            ORG_TYP_CDE,                                          34400000
344100            NMDSE_PO_BEG_TMST,                                    34410000
344200            NMDSE_PO_END_TMST,                                    34420000
344300            CRE_BY_UID,                                           34430000
344400            CRE_TMST,                                             34440000
344500            LAST_UPD_BY_UID,                                      34450000
344600            LAST_UPD_TMST,                                        34460000
344700            ARCH_DTE,                                             34470000
344800            OWNER_ID,                                             34480000
344900            OPN_DTE,                                              34490000
345000            CLO_DTE,                                              34500000
345100            REPL_ORG_CLUSTR_ID,                                   34510000
345200            E_BUS_LOC_IND                                         34520000
345300         INTO                                                     34530000
345400            :ORGCLT-ORG-CLUSTR-ID,                                34540000
345500            :ORGCLT-ORG-CLUSTR-NAME-5:WS-ORG-CLUSTR-NAME-5-NULL,  34550000
345600            :ORGCLT-ORG-CLUSTR-NAME-10:WS-ORG-CLUSTR-NAME-10-NULL,34560000
345700            :ORGCLT-ORG-CLUSTR-NAME,                              34570000
345800            :ORGCLT-ORG-CLUSTR-DESC,                              34580000
345900            :ORGCLT-EFF-BEG-TMST,                                 34590000
346000            :ORGCLT-EFF-END-TMST:WS-CLT-EFF-END-TMST-NULL,        34600000
346100            :ORGCLT-CLUSTR-TYP-CDE:WS-CLUSTR-TYP-CDE-NULL,        34610000
346200            :ORGCLT-HIER-TYP-CDE:WS-HIER-TYP-CDE-NULL,            34620000
346300            :ORGCLT-HIER-CDE:WS-HIER-CDE-NULL,                    34630000
346400            :ORGCLT-ORG-CLUSTR-CDE,                               34640000
346500            :ORGCLT-ORG-TYP-CDE:WS-ORG-TYP-CDE-NULL,              34650000
346600            :ORGCLT-NMDSE-PO-BEG-TMST:WS-NMDSE-PO-BEG-TMST-NULL,  34660000
346700            :ORGCLT-NMDSE-PO-END-TMST:WS-NMDSE-PO-END-TMST-NULL,  34670000
346800            :ORGCLT-CRE-BY-UID,                                   34680000
346900            :ORGCLT-CRE-TMST,                                     34690000
347000            :ORGCLT-LAST-UPD-BY-UID,                              34700000
347100            :ORGCLT-LAST-UPD-TMST,                                34710000
347200            :ORGCLT-ARCH-DTE:WS-ARCH-DTE-NULL,                    34720000
347300            :ORGCLT-OWNER-ID:WS-OWNER-ID-NULL,                    34730000
347400            :ORGCLT-OPN-DTE:WS-OPN-DTE-NULL,                      34740000
347500            :ORGCLT-CLO-DTE:WS-CLO-DTE-NULL,                      34750000
347600            :ORGCLT-REPL-ORG-CLUSTR-ID:WS-REPL-ORG-CLUSTR-ID-NULL,34760000
347700            :ORGCLT-E-BUS-LOC-IND                                 34770000
347800         FROM TORGCLT                                             34780000
347900        WHERE ORG_CLUSTR_ID = :ORGCLT-ORG-CLUSTR-ID               34790000
348000     END-EXEC.                                                    34800000
348100                                                                  34810000
348200     EVALUATE TRUE                                                34820000
348300         WHEN SQLCODE = ZEROS                                     34830000
348400             SET TORGCLT-RCD-EXISTS TO TRUE                       34840000
348500         WHEN SQLCODE = +1403                                     34850000
348600             SET TORGCLT-RCD-DOES-NOT-EXIST TO TRUE               34860000
348700         WHEN OTHER                                               34870000
348800             DISPLAY 'ORGCLT-ORG-CLUSTR-ID:  '                    34880000
348900                             ORGCLT-ORG-CLUSTR-ID                 34890000
349000             PERFORM Z9999-ABEND-ROUTINE                          34900000
349100     END-EVALUATE.                                                34910000
349200                                                                  34920000
349300 U9400-EXIT.                                                      34930000
349400     EXIT.                                                        34940000
349500                                                                  34950000
349600                                                                  34960000
349700 V9000-INSERT-TORGCLC.                                            34970000
349800                                                                  34980000
349900     DISPLAY 'V9000-INSERT-TORGCLC'.                              34990000
350000                                                                  35000000
350100     EXEC SQL                                                     35010000
350200         INSERT INTO TORGCLC                                      35020000
350300             (PRNT_ORG_CLUSTR_ID,                                 35030000
350400              CHLD_ORG_CLUSTR_ID,                                 35040000
350500              REL_TYP_CDE,                                        35050000
350600              EFF_BEG_TMST,                                       35060000
350700              EFF_END_TMST,                                       35070000
350800              CRE_BY_UID,                                         35080000
350900              CRE_TMST,                                           35090000
351000              LAST_UPD_BY_UID,                                    35100000
351100              LAST_UPD_TMST)                                      35110000
351200         VALUES                                                   35120000
351300            (:ORGCLC-PRNT-ORG-CLUSTR-ID,                          35130000
351400             :ORGCLC-CHLD-ORG-CLUSTR-ID,                          35140000
351500             :ORGCLC-REL-TYP-CDE,                                 35150000
351600             :ORGCLC-EFF-BEG-TMST,                                35160000
351700             :ORGCLC-EFF-END-TMST:WS-CLC-EFF-END-TMST-NULL,       35170000
351800             'MAKUT226',                                          35180000
351900             SYSDATE,                                             35190000
352000             'MAKUT226',                                          35200000
352100             SYSDATE)                                             35210000
352200     END-EXEC.                                                    35220000
352300                                                                  35230000
352400     EVALUATE TRUE                                                35240000
352500         WHEN SQLCODE = ZEROS                                     35250000
352600             CONTINUE                                             35260000
352700         WHEN OTHER                                               35270000
352800             DISPLAY 'ORGCLC-PRNT-ORG-CLUSTR-ID:  '               35280000
352900                         ORGCLC-PRNT-ORG-CLUSTR-ID                35290000
353000             DISPLAY 'ORGCLC-CHLD-ORG-CLUSTR-ID:  '               35300000
353100                         ORGCLC-CHLD-ORG-CLUSTR-ID                35310000
353200             PERFORM Z9999-ABEND-ROUTINE                          35320000
353300     END-EVALUATE.                                                35330000
353400                                                                  35340000
353500 V9000-EXIT.                                                      35350000
353600     EXIT.                                                        35360000
353700                                                                  35370000
353800                                                                  35380000
353900 V9100-UPDATE-TORGCLC.                                            35390000
354000                                                                  35400000
354100     DISPLAY 'V9100-UPDATE-TORGCLC'.                              35410000
354200                                                                  35420000
354300     EXEC SQL                                                     35430000
354400         UPDATE TORGCLC                                           35440000
354500            SET EFF_BEG_TMST = :WS-ORGCLC-EFF-BEG-TMST,           35450000
354600                EFF_END_TMST =                                    35460000
354700                    :ORGCLC-EFF-END-TMST:WS-CLC-EFF-END-TMST-NULL,35470000
354800                LAST_UPD_BY_UID = 'MAKUT226',                     35480000
354900                LAST_UPD_TMST = SYSDATE                           35490000
355000          WHERE PRNT_ORG_CLUSTR_ID = :ORGCLC-PRNT-ORG-CLUSTR-ID   35500000
355100            AND CHLD_ORG_CLUSTR_ID = :ORGCLC-CHLD-ORG-CLUSTR-ID   35510000
355200            AND REL_TYP_CDE        = :ORGCLC-REL-TYP-CDE          35520000
355300            AND EFF_BEG_TMST       = :ORGCLC-EFF-BEG-TMST         35530000
355400     END-EXEC.                                                    35540000
355500                                                                  35550000
355600     EVALUATE TRUE                                                35560000
355700         WHEN SQLCODE = ZEROS                                     35570000
355800             CONTINUE                                             35580000
355900         WHEN OTHER                                               35590000
356000             DISPLAY 'ORGCLC-PRNT-ORG-CLUSTR-ID:  '               35600000
356100                         ORGCLC-PRNT-ORG-CLUSTR-ID                35610000
356200             DISPLAY 'ORGCLC-CHLD-ORG-CLUSTR-ID:  '               35620000
356300                         ORGCLC-CHLD-ORG-CLUSTR-ID                35630000
356400             DISPLAY 'ORGCLC-REL-TYP-CDE:  '                      35640000
356500                         ORGCLC-REL-TYP-CDE                       35650000
356600             DISPLAY 'ORGCLC-EFF-BEG-TMST:  '                     35660000
356700                         ORGCLC-EFF-BEG-TMST                      35670000
356800             PERFORM Z9999-ABEND-ROUTINE                          35680000
356900     END-EVALUATE.                                                35690000
357000                                                                  35700000
357100 V9100-EXIT.                                                      35710000
357200     EXIT.                                                        35720000
357300                                                                  35730000
357400                                                                  35740000
357500 V9200-SELECT-TORGCLC-CHLD.                                       35750000
357600                                                                  35760000
357700     DISPLAY 'V9200-SELECT-TORGCLC-CHLD'.                         35770000
357800                                                                  35780000
357900     EXEC SQL                                                     35790000
358000         SELECT PRNT_ORG_CLUSTR_ID,                               35800000
358100                CHLD_ORG_CLUSTR_ID,                               35810000
358200                REL_TYP_CDE,                                      35820000
358300                EFF_BEG_TMST,                                     35830000
358400                EFF_END_TMST,                                     35840000
358500                CRE_BY_UID,                                       35850000
358600                CRE_TMST,                                         35860000
358700                LAST_UPD_BY_UID,                                  35870000
358800                LAST_UPD_TMST                                     35880000
358900           INTO :ORGCLC-PRNT-ORG-CLUSTR-ID,                       35890000
359000                :ORGCLC-CHLD-ORG-CLUSTR-ID,                       35900000
359100                :ORGCLC-REL-TYP-CDE,                              35910000
359200                :ORGCLC-EFF-BEG-TMST,                             35920000
359300                :ORGCLC-EFF-END-TMST:WS-CLC-EFF-END-TMST-NULL,    35930000
359400                :ORGCLC-CRE-BY-UID,                               35940000
359500                :ORGCLC-CRE-TMST,                                 35950000
359600                :ORGCLC-LAST-UPD-BY-UID,                          35960000
359700                :ORGCLC-LAST-UPD-TMST                             35970000
359800           FROM TORGCLC                                           35980000
359900          WHERE CHLD_ORG_CLUSTR_ID = :ORGCLC-CHLD-ORG-CLUSTR-ID   35990000
360000            AND REL_TYP_CDE = :ORGCLC-REL-TYP-CDE                 36000000
360100            AND EFF_END_TMST IS NULL                              36010000
360200     END-EXEC.                                                    36020000
360300                                                                  36030000
360400     EVALUATE TRUE                                                36040000
360500         WHEN SQLCODE = ZEROS                                     36050000
360600             SET TORGCLC-RCD-EXISTS TO TRUE                       36060000
360700         WHEN SQLCODE = +1403                                     36070000
360800             SET TORGCLC-RCD-DOES-NOT-EXIST TO TRUE               36080000
360900         WHEN OTHER                                               36090000
361000             DISPLAY 'ORGCLC-CHLD-ORG-CLUSTR-ID:  '               36100000
361100                         ORGCLC-CHLD-ORG-CLUSTR-ID                36110000
361200             DISPLAY 'ORGCLC-REL-TYP-CDE:  '                      36120000
361300                         ORGCLC-REL-TYP-CDE                       36130000
361400             PERFORM Z9999-ABEND-ROUTINE                          36140000
361500     END-EVALUATE.                                                36150000
361600                                                                  36160000
361700 V9200-EXIT.                                                      36170000
361800     EXIT.                                                        36180000
361900                                                                  36190000
362000                                                                  36200000
362100 V9300-SELECT-TORGCLC-PRNT-CHLD.                                  36210000
362200                                                                  36220000
362300     DISPLAY 'V9300-SELECT-TORGCLC-PRNT-CHLD'.                    36230000
362400                                                                  36240000
362500     EXEC SQL                                                     36250000
362600         SELECT PRNT_ORG_CLUSTR_ID,                               36260000
362700                CHLD_ORG_CLUSTR_ID,                               36270000
362800                REL_TYP_CDE,                                      36280000
362900                EFF_BEG_TMST,                                     36290000
363000                EFF_END_TMST,                                     36300000
363100                CRE_BY_UID,                                       36310000
363200                CRE_TMST,                                         36320000
363300                LAST_UPD_BY_UID,                                  36330000
363400                LAST_UPD_TMST                                     36340000
363500           INTO :ORGCLC-PRNT-ORG-CLUSTR-ID,                       36350000
363600                :ORGCLC-CHLD-ORG-CLUSTR-ID,                       36360000
363700                :ORGCLC-REL-TYP-CDE,                              36370000
363800                :ORGCLC-EFF-BEG-TMST,                             36380000
363900                :ORGCLC-EFF-END-TMST:WS-CLC-EFF-END-TMST-NULL,    36390000
364000                :ORGCLC-CRE-BY-UID,                               36400000
364100                :ORGCLC-CRE-TMST,                                 36410000
364200                :ORGCLC-LAST-UPD-BY-UID,                          36420000
364300                :ORGCLC-LAST-UPD-TMST                             36430000
364400           FROM TORGCLC                                           36440000
364500          WHERE PRNT_ORG_CLUSTR_ID = :ORGCLC-PRNT-ORG-CLUSTR-ID   36450000
364600            AND CHLD_ORG_CLUSTR_ID = :ORGCLC-CHLD-ORG-CLUSTR-ID   36460000
364700            AND ((EFF_END_TMST IS NULL) OR                        36470000
364800                 (EFF_END_TMST > :WS-CURRENT-END-TMST))           36480000
364900     END-EXEC.                                                    36490000
365000                                                                  36500000
365100     EVALUATE TRUE                                                36510000
365200         WHEN SQLCODE = ZEROS                                     36520000
365300             SET TORGCLC-RCD-EXISTS TO TRUE                       36530000
365400         WHEN SQLCODE = +1403                                     36540000
365500             SET TORGCLC-RCD-DOES-NOT-EXIST TO TRUE               36550000
365600         WHEN OTHER                                               36560000
365700             DISPLAY 'ORGCLC-PRNT-ORG-CLUSTR-ID:  '               36570000
365800                         ORGCLC-PRNT-ORG-CLUSTR-ID                36580000
365900             DISPLAY 'ORGCLC-CHLD-ORG-CLUSTR-ID:  '               36590000
366000                         ORGCLC-CHLD-ORG-CLUSTR-ID                36600000
366100             PERFORM Z9999-ABEND-ROUTINE                          36610000
366200     END-EVALUATE.                                                36620000
366300                                                                  36630000
366400 V9300-EXIT.                                                      36640000
366500     EXIT.                                                        36650000
366600                                                                  36660000
366700                                                                  36670000
366800 V9400-GET-LAST-DIST-REL.                                         36680000
366900                                                                  36690000
367000     PERFORM V9410-OPEN-DIST                                      36700000
367100        THRU V9410-EXIT.                                          36710000
367200                                                                  36720000
367300     PERFORM V9420-FETCH-DIST                                     36730000
367400        THRU V9420-EXIT.                                          36740000
367500                                                                  36750000
367600     PERFORM V9430-CLOSE-DIST                                     36760000
367700        THRU V9430-EXIT.                                          36770000
367800                                                                  36780000
367900 V9400-EXIT.                                                      36790000
368000     EXIT.                                                        36800000
368100                                                                  36810000
368200                                                                  36820000
368300 V9410-OPEN-DIST.                                                 36830000
368400                                                                  36840000
368500     DISPLAY 'V9410-OPEN-DIST'.                                   36850000
368600                                                                  36860000
368700     EXEC SQL                                                     36870000
368800         OPEN DIST                                                36880000
368900     END-EXEC.                                                    36890000
369000                                                                  36900000
369100     EVALUATE TRUE                                                36910000
369200         WHEN SQLCODE = ZEROS                                     36920000
369300             CONTINUE                                             36930000
369400         WHEN OTHER                                               36940000
369500             PERFORM Z9999-ABEND-ROUTINE                          36950000
369600     END-EVALUATE.                                                36960000
369700                                                                  36970000
369800 V9410-EXIT.                                                      36980000
369900     EXIT.                                                        36990000
370000                                                                  37000000
370100                                                                  37010000
370200 V9420-FETCH-DIST.                                                37020000
370300                                                                  37030000
370400     DISPLAY 'V9420-FETCH-DIST'.                                  37040000
370500                                                                  37050000
370600***  THERE MAY BE MORE THAN 1 EXPIRED DIST/DS RELATIONSHIP        37060000
370700***  WE ONLY WANT TO FETCH THE MOST RECENT ONE                    37070000
370800                                                                  37080000
370900     EXEC SQL                                                     37090000
371000         FETCH DIST                                               37100000
371100          INTO :ORGCLC-PRNT-ORG-CLUSTR-ID,                        37110000
371200               :ORGCLC-CHLD-ORG-CLUSTR-ID,                        37120000
371300               :ORGCLC-REL-TYP-CDE,                               37130000
371400               :ORGCLC-EFF-BEG-TMST,                              37140000
371500               :ORGCLC-EFF-END-TMST,                              37150000
371600               :ORGCLC-CRE-BY-UID,                                37160000
371700               :ORGCLC-CRE-TMST,                                  37170000
371800               :ORGCLC-LAST-UPD-BY-UID,                           37180000
371900               :ORGCLC-LAST-UPD-TMST                              37190000
372000     END-EXEC.                                                    37200000
372100                                                                  37210000
372200     EVALUATE TRUE                                                37220000
372300         WHEN SQLCODE = ZEROS                                     37230000
372400             SET TORGCLC-RCD-EXISTS TO TRUE                       37240000
372500         WHEN SQLCODE = +1403                                     37250000
372600             SET TORGCLC-RCD-DOES-NOT-EXIST TO TRUE               37260000
372700         WHEN OTHER                                               37270000
372800             PERFORM Z9999-ABEND-ROUTINE                          37280000
372900     END-EVALUATE.                                                37290000
373000                                                                  37300000
373100 V9420-EXIT.                                                      37310000
373200     EXIT.                                                        37320000
373300                                                                  37330000
373400                                                                  37340000
373500 V9430-CLOSE-DIST.                                                37350000
373600                                                                  37360000
373700     DISPLAY 'V9430-CLOSE-DIST'.                                  37370000
373800                                                                  37380000
373900     EXEC SQL                                                     37390000
374000         CLOSE DIST                                               37400000
374100     END-EXEC.                                                    37410000
374200                                                                  37420000
374300     EVALUATE TRUE                                                37430000
374400         WHEN SQLCODE = ZEROS                                     37440000
374500             CONTINUE                                             37450000
374600         WHEN OTHER                                               37460000
374700             PERFORM Z9999-ABEND-ROUTINE                          37470000
374800     END-EVALUATE.                                                37480000
374900                                                                  37490000
375000 V9430-EXIT.                                                      37500000
375100     EXIT.                                                        37510000
375200                                                                  37520000
375300                                                                  37530000
375400 V9500-SELECT-CURR-DIST-REL.                                      37540000
375500                                                                  37550000
375600     DISPLAY 'V9500-SELECT-CURR-DIST-REL'.                        37560000
375700                                                                  37570000
375800     EXEC SQL                                                     37580000
375900         SELECT A.PRNT_ORG_CLUSTR_ID,                             37590000
376000                A.CHLD_ORG_CLUSTR_ID,                             37600000
376100                A.REL_TYP_CDE,                                    37610000
376200                A.EFF_BEG_TMST,                                   37620000
376300                A.EFF_END_TMST,                                   37630000
376400                A.CRE_BY_UID,                                     37640000
376500                A.CRE_TMST,                                       37650000
376600                A.LAST_UPD_BY_UID,                                37660000
376700                A.LAST_UPD_TMST                                   37670000
376800           INTO :ORGCLC-PRNT-ORG-CLUSTR-ID,                       37680000
376900                :ORGCLC-CHLD-ORG-CLUSTR-ID,                       37690000
377000                :ORGCLC-REL-TYP-CDE,                              37700000
377100                :ORGCLC-EFF-BEG-TMST,                             37710000
377200                :ORGCLC-EFF-END-TMST:WS-CLC-EFF-END-TMST-NULL,    37720000
377300                :ORGCLC-CRE-BY-UID,                               37730000
377400                :ORGCLC-CRE-TMST,                                 37740000
377500                :ORGCLC-LAST-UPD-BY-UID,                          37750000
377600                :ORGCLC-LAST-UPD-TMST                             37760000
377700           FROM TORGCLC A,                                        37770000
377800                TORGCLT B                                         37780000
377900          WHERE A.CHLD_ORG_CLUSTR_ID = :ORGCLC-CHLD-ORG-CLUSTR-ID 37790000
378000            AND A.REL_TYP_CDE        = :ORGCLC-REL-TYP-CDE        37800000
378100            AND A.EFF_END_TMST IS NULL                            37810000
378200            AND A.PRNT_ORG_CLUSTR_ID = B.ORG_CLUSTR_ID            37820000
378300            AND B.HIER_CDE           = 'DST'                      37830000
378400     END-EXEC.                                                    37840000
378500                                                                  37850000
378600     EVALUATE TRUE                                                37860000
378700         WHEN SQLCODE = ZEROS                                     37870000
378800             SET TORGCLC-RCD-EXISTS TO TRUE                       37880000
378900         WHEN SQLCODE = +1403                                     37890000
379000             SET TORGCLC-RCD-DOES-NOT-EXIST TO TRUE               37900000
379100         WHEN OTHER                                               37910000
379200             DISPLAY 'ORGCLC-CHLD-ORG-CLUSTR-ID:  '               37920000
379300                         ORGCLC-CHLD-ORG-CLUSTR-ID                37930000
379400             DISPLAY 'ORGCLC-REL-TYP-CDE:  '                      37940000
379500                         ORGCLC-REL-TYP-CDE                       37950000
379600             PERFORM Z9999-ABEND-ROUTINE                          37960000
379700     END-EVALUATE.                                                37970000
379800                                                                  37980000
379900 V9500-EXIT.                                                      37990000
380000     EXIT.                                                        38000000
380100                                                                  38010000
380200                                                                  38020000
380300 Z9999-ABEND-ROUTINE.                                             38030000
380400                                                                  38040000
380500     MOVE SQLCODE    TO SQLCODE2.                                 38050000
380600     MOVE SQLERRD(3) TO SQLERRD3.                                 38060000
380700     DISPLAY '** ABEND **       ** = SQLERROR'.                   38070000
380800     DISPLAY '** PROGRAM        ** = MAKUT226'.                   38080000
380900     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  38090000
381000     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  38100000
381100     DISPLAY '** SQLERRM        ** = ' SQLERRM.                   38110000
381200     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  38120000
381300     DISPLAY '** SQLERRD(5)     ** = ' SQLERRD(5)                 38130000
381400                                                                  38140000
381500     MOVE SPACES TO WS-MSG-TEXT.                                  38150000
381600*    GET FULL TEXT OF ERROR MESSAGE                               38160000
381700     CALL 'SQLGLM' USING WS-MSG-TEXT,                             38170000
381800                         WS-MAX-SIZE,                             38180000
381900                         WS-MSG-LENGTH.                           38190000
382000     DISPLAY 'MESSAGE TEXT      ** = ' WS-MSG-TEXT.               38200000
382100                                                                  38210000
382200     EXEC SQL                                                     38220000
382300         ROLLBACK WORK RELEASE                                    38230000
382400     END-EXEC.                                                    38240000
382500                                                                  38250000
382600** A SQLCODE OF -2068 IS AN ORACLE DATABASE DISCONNECT ERR        38260000
382700     IF SQLCODE = -2068                                           38270000
382800         MOVE +4016 TO WS-ABEND-CODE                              38280000
382900     ELSE                                                         38290000
383000         MOVE +4013 TO WS-ABEND-CODE                              38300000
383100     END-IF.                                                      38310000
383200                                                                  38320000
383300     CALL 'ILBOABN0' USING WS-ABEND-CODE.                         38330000
383400                                                                  38340000
