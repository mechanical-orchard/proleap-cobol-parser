000100*** THIS PROGRAM IS RESERVED FOR THE PRICE  VERSION EXTRACT FOR   00010023
000200*** THE NEW PROMO PROJECT.                                        00020023
000100*----------------------------------------------------------       00030023
000200 IDENTIFICATION DIVISION.                                         00040023
000300*----------------------------------------------------------       00050023
000400 PROGRAM-ID.    XSKUT026.                                         00060023
000500 AUTHOR.        JOSEPH MENYAH.                                    00070023
000600 DATE-WRITTEN.  OCTOBER , 2002.                                   00080023
000700                                                                  00090023
000800*----------------------------------------------------------       00100023
000900*            PRICE VERSION BUSINESS EVENT EXTRACT                 00110023
001000*----------------------------------------------------------       00120023
001010* THIS PROGRAM WILL PERFORM THE NECESSARY BUSINESS EVENT          00130023
001020* EXTRACT FOR THE PRICE VERSION BUSINESS EVENT.                   00140023
001124*                                                                 00150023
001125*----------------------------------------------------------       00160023
001126* HISTORY LOG:                                                    00170023
001127*                                                                 00180023
001128*----------------------------------------------------------       00190023
001129*-------------------------------------------------------------    00200032
101253* DATE: 01-07-2015                                                00210033
101253* WR/IR#: CHG0101253                                              00220033
101253* PROGRAMMER: COGNIZANT                                           00230033
101253* DESCRIPTION:MODIFIED THE EXTRACT CURSOR TO ELIMINATE THE RECORDS00230133
101253* WITH'C' AND 'D' STATUS                                          00230233
001140*-----------------------------------------------------------------00230332
101253* DATE: 06-01-2020                                                00230435
101253* PROGRAMMER: JEAN KURK                                           00230635
101253* DESCRIPTION:MODIFIED THE EXTRACT CURSOR FOR EFFICIENCY          00230735
001140*-----------------------------------------------------------------00230935
001160*----------------------------------------------------------       00231032
001170 ENVIRONMENT DIVISION.                                            00260023
001180*----------------------------------------------------------       00270023
001190 CONFIGURATION SECTION.                                           00280023
001200 SOURCE-COMPUTER. IBM-3090.                                       00290023
001300 OBJECT-COMPUTER. IBM-3090.                                       00300023
001400                                                                  00310023
001500 INPUT-OUTPUT SECTION.                                            00320023
001600                                                                  00330023
001700 FILE-CONTROL.                                                    00340023
001800                                                                  00350023
004900     SELECT DATE-RANGE-FILE                                       00360023
005000         ASSIGN TO INP01.                                         00370023
                                                                        00380023
004900     SELECT TMST-FILE                                             00390023
005000         ASSIGN TO INP02.                                         00400023
                                                                        00410023
004900     SELECT EXTRACT-FILE                                          00420023
005000         ASSIGN TO OUT01.                                         00430023
001900*----------------------------------------------------------       00440023
002000 DATA DIVISION.                                                   00450023
002100*----------------------------------------------------------       00460023
002200 FILE SECTION.                                                    00470023
002300                                                                  00480023
008000 FD  EXTRACT-FILE                                                 00490023
008100     RECORDING MODE IS F                                          00500023
008200     LABEL RECORDS ARE OMITTED                                    00510023
008300     RECORD CONTAINS 080 CHARACTERS                               00520023
008400     DATA RECORD IS PRIC-VER-RECORD.                              00530023
008500 01  PRIC-VER-RECORD      PIC X(080).                             00540023
008600                                                                  00550023
005800 FD  DATE-RANGE-FILE                                              00560023
005900     RECORDING MODE IS F                                          00570023
006000     LABEL RECORDS ARE OMITTED                                    00580023
006100     RECORD CONTAINS 80 CHARACTERS                                00590023
006200     BLOCK CONTAINS 0 RECORDS.                                    00600023
       01  DATE-RANGE-LINE             PIC  X(80).                      00610023
006500                                                                  00620023
005800 FD  TMST-FILE                                                    00630023
005900     RECORDING MODE IS F                                          00640023
006000     LABEL RECORDS ARE OMITTED                                    00650023
006100     RECORD CONTAINS 80 CHARACTERS                                00660023
006200     BLOCK CONTAINS 0 RECORDS.                                    00670023
       01  TMST-LINE                        PIC  X(80).                 00680023
006500                                                                  00690023
002500*---------------------------------------------------------        00700023
002600                                                                  00710023
002700 WORKING-STORAGE SECTION.                                         00720023
002800*---------------------------------------------------------        00730023
003500* PC- PROGRAM CONSTANTS                                           00740023
003600*----------------------------------------------------------       00750023
003700 01  PC-PROGRAM-CONSTANTS.                                        00760023
003800     05  PC-PROGRAM-NAME              PIC X(08) VALUE 'XSKUT026'. 00770023
003900     05  PC-MAX-RETRIES               PIC S9(04) VALUE +5 COMP.   00780023
004000                                                                  00790023
004100*----------------------------------------------------------       00800023
004200* PS- PROGRAM SWITCHES                                            00810023
004300*----------------------------------------------------------       00820023
004400 01  PS-PROGRAM-SWITCHES.                                         00830023
004500     05  PS-EOF-EXTRACT-SW           PIC X(01)  VALUE SPACE.      00840023
004600         88  PS-EOF-EXTRACT                      VALUE 'Y'.       00850023
004600         88  PS-NOT-EOF-EXTRACT                  VALUE 'N'.       00860023
           05  PS-DATE-RANGE-FILE-SW        PIC  X(01)  VALUE 'N'.      00870023
               88  PS-DATE-RANGE-FILE-END               VALUE 'Y'.      00880023
               88  PS-DATE-RANGE-FILE-START             VALUE 'N'.      00890023
           05  PS-TMST-FILE-SW              PIC  X(01)  VALUE 'N'.      00900023
               88  PS-TMST-FILE-END                     VALUE 'Y'.      00910023
               88  PS-TMST-FILE-START                   VALUE 'N'.      00920023
004800                                                                  00930023
004900*----------------------------------------------------------       00940023
005000* PV- PROGRAM VARIABLES                                           00950023
005100*----------------------------------------------------------       00960023
       01  CC-DATE-RANGE-FILE.                                          00970023
           05  CC-START-DATE                PIC X(10).                  00980023
           05  FILLER                       PIC X(01).                  00990023
           05  CC-END-DATE                  PIC X(10).                  01000023
                                                                        01010023
       01  CC-TMST-FILE.                                                01020023
           05  CC-LAST-UPD-TMST             PIC X(19).                  01030023
005200 01 PV-PROGRAM-VARIABLES.                                         01040023
006000    05  PV-RECORD-COUNT               PIC 9(05) VALUE ZEROS.      01050023
013800    05  ABEND-CODE              PIC S9(4)  VALUE ZEROS COMP SYNC. 01060023
005500    05  PV-SQL-SUB                    PIC S9(4)  VALUE +0 COMP.   01070023
005600    05  PV-MAX-OFFSET-DTE             PIC 9(08)  VALUE 0.         01080023
005710    05  PV-EVNT-ID                    PIC S9(09) VALUE +0.        01090023
                                                                        01100023
007100    05  PV-STRT-PARM.                                             01110023
007200        10  PV-STRT-DTE-CC            PIC X(02).                  01120023
007200        10  PV-STRT-DTE-YY            PIC X(02).                  01130023
007400        10  PV-STRT-DTE-MM            PIC X(02).                  01140023
007600        10  PV-STRT-DTE-DD            PIC X(02).                  01150023
007400        10  FILLER                    PIC X.                      01160023
007400        10  PV-DECREMENT              PIC X(02).                  01170023
007400        10  FILLER                    PIC X(69).                  01180023
007700                                                                  01190023
007100    05  PV-EVNT-STRT-DTE              PIC X(10).                  01200023
                                                                        01210023
008500                                                                  01220023
008600    05  PV-EVNT-END-DTE-TM.                                       01230023
008700        10  PV-EVNT-END-DTE.                                      01240023
008800            15  PV-EVNT-DTE-TM2-CCYY      PIC X(04).              01250023
008900            15  FILLER                    PIC X(01).              01260023
009000            15  PV-EVNT-DTE-TM2-MM        PIC X(02).              01270023
009100            15  FILLER                    PIC X(01).              01280023
009200            15  PV-EVNT-DTE-TM2-DD        PIC X(02).              01290023
009300        10  PV-EVNT-END-TM                PIC X(16).              01300023
009400                                                                  01310023
           05  PV-OPERATION-MSG             PIC  X(60)  VALUE SPACES.   01320023
           05  PV-OPERATION-MSG-1           PIC  X(40)  VALUE SPACES.   01330023
                                                                        01340023
       01  PV-TOTAL-RECORD.                                             01350023
           05 PV-BUSINESS-EVNT-ID              PIC 9(03) VALUE ZERO.    01360023
           05 PV-ACTION-CDE                    PIC X(01) VALUE 'T'.     01370023
           05 PV-TOTAL-NBR-OF-RECS             PIC 9(11) VALUE ZERO.    01380023
010900*----------------------------------------------------------       01390023
011000* PRICE VERSION BUSINESS EVENT RECORD LAYOUT                      01400023
011100*----------------------------------------------------------       01410023
011200     COPY XSRD017.                                                01420023
011300                                                                  01430023
011400*----------------------------------------------------------       01440023
011500* DATE ROUTINE COPY MEMBERS                                       01450023
011600*----------------------------------------------------------       01460023
011700     COPY DPWS500.                                                01470023
011800                                                                  01480023
011900*----------------------------------------------------------       01490023
012000* VARIABLES REQUIRED FOR THE FORMAT SQLCA ROUTINE DPPD004         01500023
012100*----------------------------------------------------------       01510023
012200     COPY DPWS004.                                                01520023
012300                                                                  01530023
030160*---------------------------------------------                    01540023
030170*  DB2 COMMUNICATION AREA.                                        01550023
030180*---------------------------------------------                    01560023
030190     EXEC SQL                                                     01570023
030191          INCLUDE SQLCA                                           01580023
030192     END-EXEC.                                                    01590023
030193                                                                  01600023
023000     COPY SQLCA2.                                                 01610023
009410*---------------------------------------------                    01620023
009420*  DB2 TABLE XST00026(XST_PROMO) - PROMOTION TABLE                01630023
009430*---------------------------------------------                    01640023
009440     EXEC SQL                                                     01650023
009450          INCLUDE XST00026                                        01660023
009460     END-EXEC.                                                    01670023
009470                                                                  01680023
030194*---------------------------------------------                    01690023
030195*  DB2 TABLE XST00032(XST_PROMO_PRIC_VER)                         01700023
030196*---------------------------------------------                    01710023
030197     EXEC SQL                                                     01720023
030198          INCLUDE XST00032                                        01730023
030199     END-EXEC.                                                    01740023
030200                                                                  01750023
030194*---------------------------------------------                    01760023
023300*   EXTRACT CURSOR  DB2 SELECT                                    01770023
030194*---------------------------------------------                    01780023
023400     EXEC SQL                                                     01790023
023500       DECLARE EXTRACT CURSOR FOR                                 01800023
              SELECT A.PROMO_PRIC_VER_ID,                               01810023
                     A.PRIC_VER_ABBR_NM,                                01820023
                     A.STAT_CDE,                                        01830023
                     A.PROMO_ID,                                        01840023
                     A.SOR_LAST_UPD_TMST                                01850023
024100        FROM XST_PROMO_PRIC_VER A,                                01860023
024100             XST_PROMO B                                          01870023
JEM 00        WHERE A.PROMO_ID = B.PROMO_ID                             01880023
              AND DATE(B.DFLT_END_TMST) >=                              01890023
                   :CC-START-DATE                                       01900023
              AND DATE(B.DFLT_STRT_TMST) <=                             01910023
                  :CC-END-DATE                                          01920023
              AND A.LAST_UPD_TMST <=                                    01930023
                  :CC-LAST-UPD-TMST                                     01940023
101253        AND A.STAT_CDE NOT IN ('C','D')                           01941034
101253        AND                                                       01941136
101253        (                                                         01941236
101253         NOT EXISTS                                               01941336
101253          (SELECT 1                                               01941436
101253           FROM XST_PROMO_ADHC_RLT C                              01941536
101253           WHERE C.PROMO_PRIC_VER_ID = A.PROMO_PRIC_VER_ID)       01941637
101253         OR                                                       01941736
101253         NOT EXISTS                                               01941836
101253          (SELECT 1                                               01941936
101253           FROM XST_PROMO_STR_GP D                                01942036
101253           WHERE D.PROMO_PRIC_VER_ID = A.PROMO_PRIC_VER_ID)       01942137
101253        )                                                         01942236
101253*       AND NOT EXISTS (SELECT 1 FROM                             01942635
101253*               XST_PROMO_ADHC_RLT C,                             01943035
101253*               XST_PROMO_STR_GP D                                01944035
101253*      WHERE    C.PROMO_PRIC_VER_ID = A.PROMO_PRIC_VER_ID AND     01945035
101253*               D.PROMO_PRIC_VER_ID = A.PROMO_PRIC_VER_ID)        01946035
024200*       WHERE B.DFLT_STRT_TMST >  :PV-EVNT-STRT-DTE               01950023
  4300*       ORDER BY STR_NBR, DEPT_NBR, KY_DTE                        01960023
               WITH UR                                                  01970023
024400     END-EXEC.                                                    01980023
030310                                                                  01990023
031400*----------------------------------------------------------       02000023
031500 PROCEDURE DIVISION.                                              02010023
032100*----------------------------------------------------------       02020023
032200 0000-MAINLINE.                                                   02030023
032300                                                                  02040023
032400     PERFORM 1000-INITIALIZATION.                                 02050023
032500                                                                  02060023
032600     PERFORM 2000-EXTRACT-DATA                                    02070023
032700             UNTIL PS-EOF-EXTRACT.                                02080023
035000                                                                  02090023
035100     PERFORM 9990-WRITE-RECORD-CNT.                               02100023
                                                                        02110023
035100     PERFORM 9999-WRAPUP.                                         02120023
035200                                                                  02130023
035500     GOBACK.                                                      02140023
035700                                                                  02150023
035701*0000-EXIT.                                                       02160023
035702 EJECT.                                                           02170023
035703                                                                  02180023
035800*----------------------------------------------------------       02190023
035900* 1000-INITIALIZATION.                                            02200023
036000*     INTIALIZES OR MOVES ANY VARIABLES BEFORE IT WILL            02210023
036100*     UPDATE OR INSERT A RECORD.                                  02220023
036200*----------------------------------------------------------       02230023
036300 1000-INITIALIZATION.                                             02240023
                                                                        02250023
           SET PS-NOT-EOF-EXTRACT TO TRUE.                              02260023
                                                                        02270023
026600     OPEN INPUT DATE-RANGE-FILE                                   02280023
026600                TMST-FILE                                         02290023
026600          OUTPUT EXTRACT-FILE.                                    02300023
                                                                        02310023
051100     PERFORM 2010-COMPUTE-STRT-DTE                                02320023
051200        THRU 2010-EXIT.                                           02330023
038000                                                                  02340023
027900     EXEC SQL                                                     02350023
028000         OPEN EXTRACT                                             02360023
028100     END-EXEC.                                                    02370023
                                                                        02380023
055500     IF SQLCODE < 0                                               02390023
055600         DISPLAY 'OPEN  UNSUCCESSFUL FOR TABLE XST_PROMO_PRIC'    02400023
055700         PERFORM U9980-SQL-ERROR                                  02410023
055800            THRU U9980-EXIT                                       02420023
           END-IF.                                                      02430023
055900                                                                  02440023
056000     IF (SQLCODE > 0 AND SQLCODE NOT EQUAL +100) OR               02450023
056100           SQLWARN0 = 'W'                                         02460023
056200         DISPLAY 'FETCH WARNING FOR TABLE XST_PROMO_PRIC_VER'     02470023
056300         PERFORM U9990-SQL-WARNING                                02480023
056400            THRU U9990-EXIT                                       02490023
           END-IF.                                                      02500023
056500                                                                  02510023
036400                                                                  02520023
                                                                        02530023
036410     INITIALIZE DCLXST00032.                                      02540023
036515                                                                  02550023
037240*1100-EXIT.                                                       02560023
037250 EJECT.                                                           02570023
037251                                                                  02580023
037260*----------------------------------------------------------       02590023
037300* 2000-EXTRACT-DATA.                                              02600023
037400*     THIS EXTRACTS THE DATA FROM THE PRICE VERSION TABLE         02610023
037800*----------------------------------------------------------       02620023
037900 2000-EXTRACT-DATA.                                               02630023
                                                                        02640023
                                                                        02650023
051100     PERFORM 2100-FETCH-EXTRACT                                   02660023
051200        THRU 2100-EXIT.                                           02670023
038000                                                                  02680023
           IF PS-NOT-EOF-EXTRACT                                        02690023
051100         PERFORM 2200-FORMAT-EXTRACT-FILE                         02700023
051200            THRU 2200-EXIT                                        02710023
                                                                        02720023
051100         PERFORM 3000-WRITE-PRIC-VER-EXTRACT                      02730023
051200            THRU 3000-EXIT                                        02740023
           END-IF.                                                      02750023
038000                                                                  02760023
038110*2000-EXIT.                                                       02770023
038200 EJECT.                                                           02780023
030000 2010-COMPUTE-STRT-DTE.                                           02790023
           READ DATE-RANGE-FILE INTO CC-DATE-RANGE-FILE                 02800023
              AT END                                                    02810023
                 SET PS-DATE-RANGE-FILE-END TO TRUE                     02820023
           END-READ.                                                    02830023
                                                                        02840023
           IF PS-DATE-RANGE-FILE-END                                    02850023
               MOVE 'NO DATE RANGE FILE TO PROCESS'                     02860023
                                                 TO PV-OPERATION-MSG-1  02870023
               PERFORM Z910-ABEND                                       02890023
           ELSE                                                         02900023
               DISPLAY 'CC-START-DATE = ' CC-START-DATE                 02910023
               DISPLAY 'CC-END-DATE   = ' CC-END-DATE                   02920023
           END-IF.                                                      02930023
                                                                        02940023
           READ TMST-FILE INTO CC-TMST-FILE                             02950023
              AT END                                                    02960023
                 SET PS-TMST-FILE-END TO TRUE                           02970023
           END-READ.                                                    02980023
                                                                        02990023
           IF PS-TMST-FILE-END                                          03000023
               MOVE 'NO TMST FILE TO PROCESS'                           03010023
                                                 TO PV-OPERATION-MSG-1  03020023
               PERFORM Z910-ABEND                                       03040023
           ELSE                                                         03050023
               DISPLAY 'CC-LAST-UPD-TMST = ' CC-LAST-UPD-TMST           03060023
           END-IF.                                                      03070023
030100                                                                  03080023
 35100                                                                  03090023
038110 2010-EXIT.                                                       03100023
           EXIT.                                                        03110023
038200 EJECT.                                                           03120023
038300*------------------------------------------------------           03130023
038400* 2100-FETCH-EXTRACT                                              03140023
038500*     FETCHES THE PRICE VERSION RECORD.                           03150023
038600*------------------------------------------------------           03160023
038210                                                                  03170023
054400 2100-FETCH-EXTRACT.                                              03180023
054500                                                                  03190023
054600     EXEC SQL                                                     03200023
054700         FETCH EXTRACT                                            03210023
                   INTO :XST00032-PROMO-PRIC-VER-ID,                    03220023
                        :XST00032-PRIC-VER-ABBR-NM,                     03230023
                        :XST00032-STAT-CDE,                             03240023
                        :XST00032-PROMO-ID,                             03250023
                        :XST00032-SOR-LAST-UPD-TMST                     03260023
055300     END-EXEC.                                                    03270023
055400                                                                  03280023
055500     IF SQLCODE < 0                                               03290023
055600         DISPLAY 'FETCH UNSUCCESSFUL FOR TABLE XST_PROMO_PRIC'    03300023
055700         PERFORM U9980-SQL-ERROR                                  03310023
055800            THRU U9980-EXIT                                       03320023
           END-IF.                                                      03330023
                                                                        03340023
056000     IF (SQLCODE > 0 AND SQLCODE NOT EQUAL +100) OR               03350023
056100           SQLWARN0 = 'W'                                         03360023
056200         DISPLAY 'FETCH WARNING FOR TABLE XST_PROMO_PRIC_VER'     03370023
056300         PERFORM U9990-SQL-WARNING                                03380023
056400            THRU U9990-EXIT                                       03390023
           END-IF.                                                      03400023
056500                                                                  03410023
056600     IF SQLCODE = +100                                            03420023
056700         MOVE 'Y' TO PS-EOF-EXTRACT-SW                            03430023
           END-IF.                                                      03440023
056800                                                                  03450023
056900 2100-EXIT.                                                       03460023
057000     EXIT.                                                        03470023
038300*------------------------------------------------------           03480023
038400* 2200-FORMAT-EXTRACT-FILE                                        03490023
038500*     FORMATS THE PROMOTION EVENT COPY BOOK.                      03500023
038600*------------------------------------------------------           03510023
038700 2200-FORMAT-EXTRACT-FILE.                                        03520023
016000     MOVE XST00032-PROMO-PRIC-VER-ID TO XS017-PROMO-PRIC-VER-ID.  03530023
016000     MOVE XST00032-PRIC-VER-ABBR-NM  TO XS017-PRIC-VER-ABBR-NM.   03540023
016000     MOVE XST00032-STAT-CDE          TO XS017-STAT-CDE.           03550023
037200     MOVE XST00032-SOR-LAST-UPD-TMST   TO XS017-LAST-UPD-TMST.    03560023
           MOVE XST00032-PROMO-ID          TO XS017-PROMO-ID.           03570023
           MOVE 030                        TO XS017-BUSINESS-EVNT-ID.   03580023
           MOVE 'U'                        TO XS017-ACTION-CDE.         03590024
038800                                                                  03600023
043510 2200-EXIT.                                                       03610023
           EXIT.                                                        03620023
043600 EJECT.                                                           03630023
043610                                                                  03640023
043700*------------------------------------------------------           03650023
043800* 3000-WRITE-PRIC-VER-EXTRACT.                                    03660023
043900*     WRITE EXTRACT FILE.                                         03670023
044000*------------------------------------------------------           03680023
044100 3000-WRITE-PRIC-VER-EXTRACT.                                     03690023
           ADD 1 TO PV-RECORD-COUNT.                                    03700023
                                                                        03710023
062300     WRITE PRIC-VER-RECORD FROM XS017-PRICE-VERSION-RECORD.       03720023
                                                                        03730023
047710 3000-EXIT.                                                       03740023
           EXIT.                                                        03750023
047800 EJECT.                                                           03760023
047810                                                                  03770023
056020                                                                  03780023
059800*----------------------------------------------------------       03790023
073900 U9980-SQL-ERROR.                                                 03800023
059800*----------------------------------------------------------       03810023
074000                                                                  03820023
074100     MOVE SQLCODE    TO SQLCODE2.                                 03830023
074200     MOVE SQLERRD(3) TO SQLERRD3.                                 03840023
074300     DISPLAY '** ABEND **       ** = SQLWARNING'.                 03850023
074400     DISPLAY '** PROGRAM        ** = XSKUT026'.                   03860023
074500     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  03870023
074600     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  03880023
074700     DISPLAY '** SQLERRM        ** = ' SQLERRM.                   03890023
074800     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  03900023
074900                                                                  03910023
075000     MOVE 4013 TO ABEND-CODE.                                     03920023
075100     CALL 'ILBOABN0' USING ABEND-CODE.                            03930023
075200                                                                  03940023
075300 U9980-EXIT.                                                      03950023
075400     EXIT.                                                        03960023
                                                                        03970023
059800*----------------------------------------------------------       03980023
075600 U9990-SQL-WARNING.                                               03990023
059800*----------------------------------------------------------       04000023
075700                                                                  04010023
075800     MOVE SQLCODE    TO SQLCODE2.                                 04020023
075900     MOVE SQLERRD(3) TO SQLERRD3.                                 04030023
076000     DISPLAY '** ABEND **       ** = SQLWARNING'.                 04040023
076100     DISPLAY '** PROGRAM        ** = XSKUT026'.                   04050023
077200                                                                  04060023
077300     MOVE 4013 TO ABEND-CODE.                                     04070023
077400     CALL 'ILBOABN0' USING ABEND-CODE.                            04080023
077500                                                                  04090023
077600 U9990-EXIT.                                                      04100023
077700     EXIT.                                                        04110023
                                                                        04120023
060100 9990-WRITE-RECORD-CNT.                                           04130023
           MOVE 030 TO PV-BUSINESS-EVNT-ID.                             04140023
           MOVE PV-RECORD-COUNT TO PV-TOTAL-NBR-OF-RECS.                04150023
           MOVE 'T' TO PV-ACTION-CDE.                                   04160023
062300     WRITE PRIC-VER-RECORD FROM PV-TOTAL-RECORD.                  04170023
060710*9990-EXIT.                                                       04180023
                                                                        04190023
059800*----------------------------------------------------------       04200023
059900* 9999-WRAPUP.                                                    04210023
059910*     MOVES ALL ERROR CODES TO THE LINKAGE VARIABLES TO           04220023
059920*     BE PASSED BACK TO THE CALLING PROGRAM.  EXITS THE           04230023
059930*     PROGRAM.                                                    04240023
060000*----------------------------------------------------------       04250023
*                                                                       04260023
060100 9999-WRAPUP.                                                     04270023
           CLOSE DATE-RANGE-FILE                                        04280023
                 TMST-FILE                                              04290023
                 EXTRACT-FILE.                                          04300023
                                                                        04310023
072200     EXEC SQL                                                     04320023
072300         CLOSE EXTRACT                                            04330023
072400     END-EXEC.                                                    04340023
060200                                                                  04350023
060500                                                                  04360023
060710*9999-EXIT.                                                       04370023
060800 EJECT.                                                           04380023
060900                                                                  04390023
      ******************************************************************04400023
      * Z910-ABEND - PERFORMS A NON-SQL-ABEND                          *04410023
      ******************************************************************04420023
       Z910-ABEND.                                                      04430023
                                                                        04440023
           DISPLAY '** ABEND           **'.                             04450023
           DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG.         04480023
           DISPLAY '**                 ** = ' PV-OPERATION-MSG-1.       04490023
                                                                        04500023
           CALL 'ILBOABN0' USING ABEND-CODE.                            04510023
