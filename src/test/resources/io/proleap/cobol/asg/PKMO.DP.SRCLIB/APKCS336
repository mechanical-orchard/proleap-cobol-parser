000100*-----------------------*                                         00010002
000200 IDENTIFICATION DIVISION.                                         00020002
000300*-----------------------*                                         00030002
000400 PROGRAM-ID.    APKCS336.                                         00040002
000500 AUTHOR.        MARY KING.                                        00050002
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060002
000700 DATE-WRITTEN.  09/01/95.                                         00070002
000800 DATE-COMPILED.                                                   00080002
000900                                                                  00090002
001000*----------------------------------------------------------------*00100002
001100*    A336 - AP VENDOR SELECTION CRITERIA SPECIFICATION           *00110002
001200*                                                                *00120002
001300*    THIS PROGRAM ALLOWS THE USER ENTER A DUNS NUMBER AND        *00130002
001400*    OPTIONALLY A DEPARTMENT NUMBER TO SPECIFY AP PROCESSING     *00140002
001500*    FOR SPECIFIC VENDORS OR VENDOR/DEPTS.                       *00150002
001600*                                                                *00160002
001700*    EDITS DONE BY THIS PROGRAM ARE:                             *00170002
001800*    -- DUN NUMBER MUST BE NUMERIC, IF ENTERED.                  *00180002
001900*    -- DEPARTMENT NUMBER MUST BE NUMERIC, IF ENTERED.           *00190002
002000*                                                                *00200002
002100*    ANY OTHER EDITS ARE DONE IN THE SUBSEQUENT PROGRAMS.        *00210002
002200*                                                                *00220002
002300*----------------------------------------------------------------*00230002
002400* CHANGE LOG:                                                    *00240002
002500*                                                                *00250002
002600* 02/03/98   ROBIN BERNOSKI                  WR/IR #: WR5703     *00260002
002700*            - MODIFIED THE MANNER IN WHICH THE STANDARD DATE    *00270002
002800*              ROUTINE, DPKUT500, IS TO BE CALLED WITHIN A       *00280002
002900*              PROGRAM SO THAT THE CALL IS DYNAMIC.              *00290002
003000*            - REPLACED ++INCLUDES WITH COPY STATEMENTS.         *00300002
003100*                                                                *00310002
003110*---------------------------------------------------------------* 00311003
003120* DATE  09/01/2021                                                00312003
003130*            - CHANGE CALL OF  DPKUT100  TO                     * 00313004
003140*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 00314003
003150*              MAKING THE CALL DYNAMIC VS STATIC                * 00315003
003160*     MADE BY: GERMAN BANDA            WR/IR #: CHG0261053        00316005
003200*                                                               * 00320006
003210* DATE  10/24/2022                                              * 00321006
003220*     ADD COPYBOOK DPWS930                                      * 00322007
003230*     CHANGE CICS ARCHITECTURE CALL TO USE DP930-CICS-ARCH-API  * 00323007
003240*     MADE BY: BOB MCASEY              WR/IR #: CHG0276864      * 00324007
003300*----------------------------------------------------------------*00330002
003400                                                                  00340002
003500 ENVIRONMENT DIVISION.                                            00350002
003600                                                                  00360002
003700 DATA DIVISION.                                                   00370002
003800                                                                  00380002
003900 WORKING-STORAGE SECTION.                                         00390002
004000                                                                  00400002
004100 01  PC-PROGRAM-CONSTANTS.                                        00410002
004200     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE  'AP336A  '. 00420002
004300     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE  'APKM336 '. 00430002
004400     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE  'APKCS336'. 00440002
004500     05  PC-TSYMSG-NUMBERS.                                       00450002
004600         10  PC-TSYMSG-00008       PIC  9(05)  VALUE  00008.      00460002
004700                                                                  00470002
004800 01  PS-PROGRAM-SWITCHES.                                         00480002
004900     05  PS-ERROR-SW               PIC  X(01)  VALUE  'N'.        00490002
005000         88  PS-ERROR                          VALUE  'Y'.        00500002
005100         88  PS-NO-ERROR                       VALUE  'N'.        00510002
005200                                                                  00520002
005300*----------------------------------------------------------------*00530002
005400*    MAP LAYOUT                                                  *00540002
005500*----------------------------------------------------------------*00550002
005600                                                                  00560002
005700     COPY APKM336.                                                00570002
005800                                                                  00580002
005900*----------------------------------------------------------------*00590002
006000*    ATTRIBUTE SETTINGS COPYBOOK.                                *00600002
006100*----------------------------------------------------------------*00610002
006200                                                                  00620002
006300     COPY DPWS015.                                                00630002
006400                                                                  00640002
006500*----------------------------------------------------------------*00650002
006600*    FUNCTION KEYS COPYBOOK                                      *00660002
006700*----------------------------------------------------------------*00670002
006800                                                                  00680002
006900     COPY DPWS016.                                                00690002
007000 EJECT                                                            00700002
007100*----------------------------------------------------------------*00710002
007200*  THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT     *00720002
007300*  SUB-ROUTINE (DPKUT100).                                       *00730002
007400*----------------------------------------------------------------*00740002
007500     COPY DPWS010I.                                               00750002
007600 EJECT                                                            00760002
007700*----------------------------------------------------------------*00770002
007800*  THE CALLING PARAMETER LIST (DPWS030) FOR THE CICS             *00780002
007900*  ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                     *00790002
008000*----------------------------------------------------------------*00800002
008100     COPY DPWS030.                                                00810002
008110     COPY DPWS930.                                                00811007
008120 EJECT                                                            00812007
008300*---------------------------------------------------------------* 00830002
008400*    STANDARD COMMAREA.                                         * 00840002
008500*---------------------------------------------------------------* 00850002
008600                                                                  00860002
008700     COPY DPWS020.                                                00870002
008800     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                00880002
008900                                                                  00890002
009000*---------------------------------------------------------------* 00900002
009100*    INTER-APPLICATION COMMAREA.                                * 00910002
009200*---------------------------------------------------------------* 00920002
009300                                                                  00930002
009400         10  INTER-APPL-COMM-AREA PIC X(200).                     00940002
009500     COPY APWS302.                                                00950002
009600*---------------------------------------------------------------* 00960002
009700*    SPECIFIC COMMMAREA FOR APKCS336.                           * 00970002
009800*---------------------------------------------------------------* 00980002
009900         10  ASC-SPECIFIC-COMMAREA.                               00990002
010000             15  ASC-DUN-NBR                 PIC  X(09).          01000002
010100             15  ASC-DUN-NBR-N REDEFINES ASC-DUN-NBR              01010002
010200                                             PIC  9(09).          01020002
010300             15  ASC-DEPT-NBR                PIC  X(03).          01030002
010400             15  ASC-DEPT-NBR-N REDEFINES ASC-DEPT-NBR            01040002
010500                                             PIC  9(03).          01050002
010600     EJECT                                                        01060002
010700*----------------------------------------------------------------*01070002
010800*    ABEND PROCESSING COPYBOOK.                                  *01080002
010900*----------------------------------------------------------------*01090002
011000                                                                  01100002
011100     COPY DPWS013.                                                01110002
011200                                                                  01120002
011300 EJECT                                                            01130002
011400 LINKAGE SECTION.                                                 01140002
011500                                                                  01150002
011600 01  DFHCOMMAREA.                                                 01160002
011700     05  FILLER                         OCCURS  1 TO 4072 TIMES   01170002
011800                                        DEPENDING ON EIBCALEN.    01180002
011900         10  FILLER                     PIC X.                    01190002
012000                                                                  01200002
012100 PROCEDURE DIVISION.                                              01210002
012200                                                                  01220002
012300*---------------------------------------------------------------* 01230002
012400*  THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM.  * 01240002
012500*  THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API   * 01250002
012600*  MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.             * 01260002
012700*                                                               * 01270002
012800*  THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE   * 01280002
012900*  LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.        * 01290002
013000*---------------------------------------------------------------* 01300002
013100                                                                  01310002
013200 0000-MAIN-MODULE.                                                01320002
013300                                                                  01330002
013400     INITIALIZE DP030-CICS-API-FIELDS.                            01340002
013500     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       01350002
013600     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          01360002
013700     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         01370002
013800     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       01380002
013900     MOVE LENGTH OF AP336AI        TO DP030-MAP-LENGTH (1).       01390002
014000     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     01400002
014100     SET DP030-OVERRIDE-APPL-ERROR TO TRUE.                       01410002
014200     PERFORM 0001-CALL-CICS-ARCH-API.                             01420002
014300                                                                  01430002
014400     PERFORM 1000-CONTROL-PROCESSING                              01440002
014500                                                                  01450002
014600     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     01460002
014700     PERFORM 0001-CALL-CICS-ARCH-API.                             01470002
014800                                                                  01480002
014900*---------------------------------------------------------------* 01490002
015000*    CALL THE ARCHITECTURE API.                                 * 01500002
015100*---------------------------------------------------------------* 01510002
015200                                                                  01520002
015300 0001-CALL-CICS-ARCH-API.                                         01530002
015400                                                                  01540002
015500     CALL DP930-CICS-ARCH-API  USING DFHEIBLK                     01550006
015600                                     DFHCOMMAREA                  01560006
015700                                     DP030-CICS-API-FIELDS        01570006
015800                                     DP020-STANDARD-COMMAREA      01580006
015900                                     AP336AI.                     01590006
016000                                                                  01600002
016100     IF  DP030-RC-CALL-SUCCESSFUL OR                              01610002
016200         DP030-RC-APPL-ERROR                                      01620002
016300         CONTINUE                                                 01630002
016400     ELSE                                                         01640002
016500         SET DP013-NO-ROLLBACK                                    01650002
016600             DP013-XCTL-DISPLAY-RESTART                           01660002
016700             DP013-CICS-ABEND      TO TRUE                        01670002
016800         MOVE 'BEFORE 0000-MAIN-MODULE'                           01680002
016900                                   TO DP013-PARAGRAPH             01690002
017000         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O01700007
017100-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      01710007
017200         MOVE DP030-RETURN-CODE                                   01720002
017300                                   TO DP013-MESSAGE-TEXT (3)      01730002
017400         PERFORM DP013-0000-PROCESS-ABEND                         01740002
017500     END-IF.                                                      01750002
017600 EJECT                                                            01760002
017700*----------------------------------------------------------------*01770002
017800*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *01780002
017900*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *01790002
018000*----------------------------------------------------------------*01800002
018100                                                                  01810002
018200 1000-CONTROL-PROCESSING.                                         01820002
018300                                                                  01830002
018400     EVALUATE TRUE                                                01840002
018500         WHEN DP030-RC-APPL-ERROR                                 01850002
018600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 01860002
018700             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   01870002
018800                                                                  01880002
018900         WHEN DP020-NEXT-ACT-INITIAL                              01890002
019000             INITIALIZE ASC-SPECIFIC-COMMAREA                     01900002
019100             PERFORM 4000-BUILD-INITIAL-PANEL                     01910002
019200                                                                  01920002
019300         WHEN DP020-NEXT-ACT-READ-MAP                             01930002
019400             PERFORM 2000-FKEY-PROCESSING                         01940002
019500                                                                  01950002
019600         WHEN DP020-NEXT-ACT-RETURN                               01960002
019700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 01970002
019800             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   01980002
019900                                                                  01990002
020000         WHEN OTHER                                               02000002
020100             SET DP013-LOGIC-ABEND                                02010002
020200                 DP013-NO-ROLLBACK TO TRUE                        02020002
020300             MOVE '1000-CONTROL-PROCESSING'                       02030002
020400                                   TO  DP013-PARAGRAPH            02040002
020500             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   02050002
020600                                   TO  DP013-MESSAGE-TEXT(1)      02060002
020700             MOVE DP020-NEXT-APPL-ACTIVITY                        02070002
020800                                   TO DP013-MESSAGE-TEXT(2)       02080002
020900             PERFORM DP013-0000-PROCESS-ABEND                     02090002
021000     END-EVALUATE.                                                02100002
021100                                                                  02110002
021200*----------------------------------------------------------------*02120002
021300* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*02130002
021400* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*02140002
021500* EDITS.                                                         *02150002
021600*----------------------------------------------------------------*02160002
021700                                                                  02170002
021800 2000-FKEY-PROCESSING.                                            02180002
021900                                                                  02190002
022000     EVALUATE TRUE                                                02200002
022100                                                                  02210002
022200         WHEN DP020-SRC-AID = DP016-CLEAR                         02220002
022300             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   02230002
022400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 02240002
022500                                                                  02250002
022600         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    02260002
022700             INITIALIZE ASC-SPECIFIC-COMMAREA                     02270002
022800             PERFORM 4000-BUILD-INITIAL-PANEL                     02280002
022900             PERFORM 3360-RESET-ATTRIBUTES                        02290002
023000                                                                  02300002
023100         WHEN OTHER                                               02310002
023200             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 02320002
023300             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   02330002
023400             IF  PS-NO-ERROR                                      02340002
023500                 SET DP030-CONTINUE-GO TO TRUE                    02350002
023600                 PERFORM 2100-CHECK-FUNCTION-KEY                  02360002
023700             ELSE                                                 02370002
023800                 SET DP030-OVERRIDE-GO TO TRUE                    02380002
023900             END-IF                                               02390002
024000     END-EVALUATE.                                                02400002
024100                                                                  02410002
024200*----------------------------------------------------------------*02420002
024300*  ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED      *02430002
024400*  FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED  *02440002
024500*  FROM THE CICS ARCHITECTURE API.                               *02450002
024600*----------------------------------------------------------------*02460002
024700                                                                  02470002
024800 2100-CHECK-FUNCTION-KEY.                                         02480002
024900                                                                  02490002
025000     EVALUATE TRUE                                                02500002
025100         WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID)                 02510002
025200             PERFORM 2110-PREPARE-INTER-APPL-COMM                 02520002
025300                                                                  02530002
025400         WHEN DP020-SRC-AID = DP016-ENTER                         02540002
025500             CONTINUE                                             02550002
025600                                                                  02560002
025700         WHEN OTHER                                               02570002
025800             SET DP013-NO-ROLLBACK                                02580002
025900                 DP013-XCTL-DISPLAY-RESTART                       02590002
026000                 DP013-CICS-ABEND  TO TRUE                        02600002
026100             MOVE '2100-CHECK-FUNCTION-KEY'                       02610002
026200                                   TO DP013-PARAGRAPH             02620002
026300             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      02630002
026400                                   TO DP013-MESSAGE-TEXT (1)      02640002
026500             PERFORM DP013-0000-PROCESS-ABEND                     02650002
026600     END-EVALUATE.                                                02660002
026700                                                                  02670002
026800*----------------------------------------------------------------*02680002
026900*  MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE    *02690002
027000*  INTER-APPLICATION COMMAREA.                                   *02700002
027100*----------------------------------------------------------------*02710002
027200                                                                  02720002
027300 2110-PREPARE-INTER-APPL-COMM.                                    02730002
027400                                                                  02740002
027500     INITIALIZE INTER-APPL-COMM-AREA.                             02750002
027600     MOVE ASC-DUN-NBR              TO AP302-DUN-NBR.              02760002
027700     MOVE ASC-DEPT-NBR             TO AP302-DEPT-NBR.             02770002
027800 EJECT                                                            02780002
027900*----------------------------------------------------------------*02790002
028000* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*02800002
028100* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *02810002
028200* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *02820002
028300*----------------------------------------------------------------*02830002
028400                                                                  02840002
028500 2200-MOVE-SCREEN-TO-COMMAREA.                                    02850002
028600                                                                  02860002
028700     IF  AVNDNUML > ZERO                                          02870002
028800         MOVE AVNDNUMI             TO ASC-DUN-NBR                 02880002
028900     ELSE                                                         02890002
029000         IF  AVNDNUMF = DP015-ERASE-EOF                           02900002
029100             MOVE SPACE            TO ASC-DUN-NBR                 02910002
029200         END-IF                                                   02920002
029300     END-IF.                                                      02930002
029400                                                                  02940002
029500     IF  ADPTNUML > ZERO                                          02950002
029600         MOVE ADPTNUMI             TO ASC-DEPT-NBR                02960002
029700     ELSE                                                         02970002
029800         IF  ADPTNUMF = DP015-ERASE-EOF                           02980002
029900             MOVE SPACE            TO ASC-DEPT-NBR                02990002
030000         END-IF                                                   03000002
030100     END-IF.                                                      03010002
030200                                                                  03020002
030300*----------------------------------------------------------------*03030002
030400* ENSURE THE DATA IS CORRECT.  NOTE THAT IN A CRITERIA SPECIFI-  *03040002
030500* CATION SCREEN ONLY MINIMAL EDITS ARE DONE.  EDITS RELATED TO   *03050002
030600* A SPECIFIC SCREEN THAT THE USER IS GOING TO (LOCAL-GO) ARE DONE*03060002
030700* IN THE DESTINATION PROGRAM, NOT HERE.                          *03070002
030800*                                                                *03080002
030900* EDITS DONE HERE ARE:                                           *03090002
031000*    -- DUN NUMBER MUST BE NUMERIC, IF ENTERED.                  *03100002
031100*    -- DEPARTMENT NUMBER MUST BE NUMERIC, IF ENTERED.           *03110002
031200*----------------------------------------------------------------*03120002
031300                                                                  03130002
031400 3000-EDIT-DATA-IN-COMMAREA.                                      03140002
031500                                                                  03150002
031600     PERFORM 3360-RESET-ATTRIBUTES.                               03160002
031700                                                                  03170002
031800     IF  ASC-DEPT-NBR > SPACE                                     03180002
031900         MOVE ASC-DEPT-NBR-N       TO DP010I-UNEDITED-FIELD       03190002
032000         MOVE LENGTH OF ASC-DEPT-NBR TO DP010I-MAXIMUM-DIGITS     03200002
032100         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     03210002
032200         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  03220002
032320         CALL DP010I-NUMERIC-EDIT-ROUTINE                         03232003
032330                         USING DP010I-NUMERIC-EDIT-AREA           03233003
032400         IF  DP010I-ERROR-DETECTED                                03240002
032500             SET PS-ERROR                                         03250002
032600                 DP020-MSG-FATAL   TO TRUE                        03260002
032700*            -- MUST BE NUMERIC --                                03270002
032800             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            03280002
032900             MOVE DP015-UNP-ALP-BRT-OFF                           03290002
033000                                   TO ADPTNUMA                    03300002
033100             MOVE DP015-RED        TO ADPTNUMC                    03310002
033200             MOVE DP015-REVERSE    TO ADPTNUMH                    03320002
033300             MOVE -1               TO ADPTNUML                    03330002
033400             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  03340002
033500         END-IF                                                   03350002
033600     END-IF.                                                      03360002
033700                                                                  03370002
033800     IF  ASC-DUN-NBR > SPACE                                      03380002
033900         MOVE ASC-DUN-NBR-N        TO DP010I-UNEDITED-FIELD       03390002
034000         MOVE LENGTH OF ASC-DUN-NBR TO DP010I-MAXIMUM-DIGITS      03400002
034100         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     03410002
034200         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  03420002
034320         CALL DP010I-NUMERIC-EDIT-ROUTINE                         03432003
034330                         USING DP010I-NUMERIC-EDIT-AREA           03433003
034400         IF  DP010I-ERROR-DETECTED                                03440002
034500             SET PS-ERROR                                         03450002
034600                 DP020-MSG-FATAL   TO TRUE                        03460002
034700*            -- MUST BE NUMERIC --                                03470002
034800             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            03480002
034900             MOVE DP015-UNP-ALP-BRT-OFF                           03490002
035000                                   TO AVNDNUMA                    03500002
035100             MOVE DP015-RED        TO AVNDNUMC                    03510002
035200             MOVE DP015-REVERSE    TO AVNDNUMH                    03520002
035300             MOVE -1               TO AVNDNUML                    03530002
035400             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  03540002
035500         END-IF                                                   03550002
035600     END-IF.                                                      03560002
035700                                                                  03570002
035800*----------------------------------------------------------------*03580002
035900*  MOVE THE DEFAULT ATTRIBUTES TO ALL OF THE OPEN FIELDS ON THE  *03590002
036000*  MAP.                                                          *03600002
036100*----------------------------------------------------------------*03610002
036200                                                                  03620002
036300 3360-RESET-ATTRIBUTES.                                           03630002
036400                                                                  03640002
036500     MOVE DP015-UNP-ALP-NOR-OFF    TO AVNDNUMA                    03650002
036600                                      ADPTNUMA.                   03660002
036700                                                                  03670002
036800     MOVE DP015-GREEN              TO AVNDNUMC                    03680002
036900                                      ADPTNUMC.                   03690002
037000                                                                  03700002
037100     MOVE DP015-UNDERLINE          TO AVNDNUMH                    03710002
037200                                      ADPTNUMH.                   03720002
037300                                                                  03730002
037400*----------------------------------------------------------------*03740002
037500*  POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 *03750002
037600*  IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL, MOVE   *03760002
037700*  IT HERE.                                                      *03770002
037800*----------------------------------------------------------------*03780002
037900                                                                  03790002
038000 4000-BUILD-INITIAL-PANEL.                                        03800002
038100                                                                  03810002
038200     SET PS-NO-ERROR               TO TRUE.                       03820002
038300     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       03830002
038400     MOVE -1                       TO AVNDNUML.                   03840002
038500                                                                  03850002
038600*----------------------------------------------------------------*03860002
038700*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *03870002
038800*----------------------------------------------------------------*03880002
038900                                                                  03890002
039000 4400-MOVE-COMMAREA-TO-SCREEN.                                    03900002
039100                                                                  03910002
039200     MOVE ASC-DUN-NBR              TO AVNDNUMO.                   03920002
039300     MOVE ASC-DEPT-NBR             TO ADPTNUMO.                   03930002
039400     MOVE -1                       TO AVNDNUML.                   03940002
039500     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       03950002
039600 EJECT                                                            03960002
039700*----------------------------------------------------------------*03970002
039800*    ABEND PROCESSOR MODULE                                      *03980002
039900*----------------------------------------------------------------*03990002
040000                                                                  04000002
040100     COPY DPPD013.                                                04010002
