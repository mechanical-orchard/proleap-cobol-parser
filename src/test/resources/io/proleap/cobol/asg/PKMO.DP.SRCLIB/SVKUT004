000100***************************************************************** 00010071
000200 IDENTIFICATION DIVISION.                                         00020071
000300***************************************************************** 00030071
000400                                                                  00040071
000500 PROGRAM-ID.             SVKUT004.                                00050071
000600 AUTHOR.                 BARB ERTL - SAFENET CONSULTING.          00060071
000700 INSTALLATION.           KOHLS.                                   00070071
000800 DATE-WRITTEN            JULY 2000.                               00080071
000900 DATE-COMPILED.                                                   00090071
001000                                                                  00100071
001100***************************************************************** 00110071
001200*                                                                 00120071
001300*  MODULE TYPE: COBOL2 DB2 BATCH                                  00130099
001400*                                                                 00140099
001500*  THIS PROGRAM WILL CREATE A FILE TO BE SENT TO THE STORE        00150071
001600*  SERVERS TO CREATE/UPDATE STORED VALUE CARD INFORMATION.        00160071
001700*                                                                 00170071
001800*  THE INPUT SVT_KOHLS_CRD_ACCT AND SVT_KOHLS_CRD_TXN TABLES      00180073
001900*  ARE USED TO GATHER THE INFORMATION TO CREATE AN OUTPUT FILE    00190073
002000*  TO SEND TO THE STORE SERVERS.                                  00200073
002100*  OUTPUT FILE IS CREATED -                                       00210099
002200*  IN PIPE-DELIMITED EBCDIC FOR SQL SERVER OFF-LINE FILES.        00220099
002300*                                                                 00230071
002400*  THE INPUT CONTROL CARDS (INP01) CONTAINS 'ALL  ', 'M9999', OR  00240071
002500*  'S9999'.  THIS WILL BE USED TO DETERMINE IF THIS RUN IS FOR    00250071
002600*  ALL AREAS, CERTAIN METRO DISTRICTS, OR CERTAIN STORES.         00260071
002700*                                                                 00270071
002800******************************************************************00280099
002900                                                                  00290099
003000 ENVIRONMENT DIVISION.                                            00300071
003100 CONFIGURATION SECTION.                                           00310071
003200                                                                  00320071
003300 SOURCE-COMPUTER.        IBM-3090.                                00330071
003400 OBJECT-COMPUTER.        IBM-3090.                                00340071
003500                                                                  00350071
003600 INPUT-OUTPUT SECTION.                                            00360071
003700                                                                  00370071
003800 FILE-CONTROL.                                                    00380071
003900                                                                  00390071
004000     SELECT CONTROL-FILE                                          00400071
004100         ASSIGN TO INP01.                                         00410071
004200                                                                  00420071
004300     SELECT YEAR-PARAMETER-FILE                                   00430071
004400         ASSIGN TO INP02.                                         00440071
004500                                                                  00450071
004600     SELECT SV-CARD-INFO-FILE                                     00460077
004700         ASSIGN TO INP03.                                         00470077
004800                                                                  00480077
004900     SELECT SV-CARD-TXN-FILE                                      00490077
005000         ASSIGN TO INP04.                                         00500077
005100                                                                  00510077
005500     SELECT SV-CARD-SQLS-FILE                                     00550099
005600         ASSIGN TO OUT01.                                         00560099
005700                                                                  00570099
005800******************************************************************00580071
005900 DATA DIVISION.                                                   00590071
006000******************************************************************00600071
006100                                                                  00610071
006200 FILE SECTION.                                                    00620071
006300                                                                  00630071
006400 FD  CONTROL-FILE                                                 00640071
006500     RECORDING MODE IS F                                          00650071
006600     BLOCK CONTAINS 0 RECORDS                                     00660071
006700     LABEL RECORDS ARE STANDARD.                                  00670071
006800                                                                  00680071
006900 01  CONTROL-RECORD                  PIC X(80).                   00690071
007000                                                                  00700071
007100 FD  YEAR-PARAMETER-FILE                                          00710071
007200     RECORDING MODE IS F                                          00720071
007300     BLOCK CONTAINS 0 RECORDS                                     00730071
007400     LABEL RECORDS ARE STANDARD.                                  00740071
007500                                                                  00750071
007600 01  YEAR-PARAMETER-RCD              PIC X(80).                   00760071
007700                                                                  00770071
007800 FD  SV-CARD-INFO-FILE                                            00780077
007900     RECORDING MODE IS F                                          00790077
008000     BLOCK CONTAINS 0 RECORDS                                     00800077
008100     LABEL RECORDS ARE STANDARD.                                  00810077
008200                                                                  00820077
008300 01  SV-CARD-INFO-RCD                PIC X(25).                   00830099
008400                                                                  00840077
008500 FD  SV-CARD-TXN-FILE                                             00850077
008600     RECORDING MODE IS F                                          00860077
008700     BLOCK CONTAINS 0 RECORDS                                     00870077
008800     LABEL RECORDS ARE STANDARD.                                  00880077
008900                                                                  00890077
009000 01  SV-CARD-TXN-RCD                 PIC X(17).                   00900078
009100                                                                  00910077
009800 FD  SV-CARD-SQLS-FILE                                            00980099
009900     RECORDING MODE IS F                                          00990099
010000     BLOCK CONTAINS 0 RECORDS                                     01000099
010100     LABEL RECORDS ARE STANDARD.                                  01010099
010200                                                                  01020099
010300 01  SV-CARD-SQLS-RECORD             PIC  X(41).                  01030099
010400                                                                  01040099
010500******************************************************************01050071
010600 WORKING-STORAGE SECTION.                                         01060071
010700******************************************************************01070071
010800 01  FILLER                            PIC X(50)  VALUE           01080071
010900     ' *** WORKING STORAGE STARTS HERE FOR SVKUT004 *** '.        01090071
011000                                                                  01100071
011100* ----------------------------------------------------------------01110099
011200* RECORD LAYOUT FOR INPUT CONTROL CARD                            01120071
011300* ----------------------------------------------------------------01130099
011400  01  CC-CONTROL-CARD.                                            01140071
011500      05  CC-RUN-TYPE                  PIC X(05)  VALUE SPACES.   01150071
011600          88  CC-ALL-STORES                       VALUE 'ALL  '.  01160071
011700      05  CC-RUN-TYPE-RDF REDEFINES CC-RUN-TYPE.                  01170071
011800          10  CC-METRO-STORE-IND       PIC X(01).                 01180071
011900              88  CC-METRO                        VALUE 'M'.      01190071
012000              88  CC-STORE                        VALUE 'S'.      01200071
012100          10  CC-METRO-STORE           PIC X(04).                 01210071
012200      05  FILLER                       PIC X(75)  VALUE SPACES.   01220071
012300                                                                  01230071
012400 01  AC-ABEND-CODE                     PIC S9(04) VALUE ZERO      01240071
012500                                                  COMP SYNC.      01250071
012600     88  AC-CONTROL-CARD-ERROR                    VALUE +4003.    01260071
012700     88  AC-TABLE-OVERFLOW-ERROR                  VALUE +4004.    01270071
012900     88  AC-DATASET-DATA-ERROR                    VALUE +4008.    01290071
013000     88  AC-DB2-ERROR                             VALUE +4013.    01300071
013100     88  AC-CALENDAR-ROUTINE-ERROR                VALUE +4019.    01310071
013200                                                                  01320077
013300 01  PS-PROGRAM-SWITCHES.                                         01330071
013400     05  PS-END-OF-ACTIVITY-SW         PIC X(01)  VALUE 'N'.      01340073
013500         88  PS-END-OF-ACTIVITY                   VALUE 'Y'.      01350073
013600         88  PS-NOT-END-OF-ACTIVITY               VALUE 'N'.      01360073
013700     05  PS-END-OF-CARD-ACTIVITY-SW    PIC X(01)  VALUE 'N'.      01370084
013800         88  PS-END-OF-CARD-ACTIVITY              VALUE 'Y'.      01380084
013900         88  PS-NOT-END-OF-CARD-ACTIVITY          VALUE 'N'.      01390084
014000     05  PS-END-OF-AVAILABLE-SW        PIC X(01)  VALUE 'N'.      01400073
014100         88  PS-END-OF-AVAILABLE                  VALUE 'Y'.      01410073
014200     05  PS-END-OF-CARD-FILE-SW        PIC X(01)  VALUE 'N'.      01420071
014300         88  PS-END-OF-CARD-FILE                  VALUE 'Y'.      01430071
014400     05  PS-END-OF-CARD-STORES-SW      PIC X(01)  VALUE 'N'.      01440071
014500         88  PS-END-OF-CARD-STORES                VALUE 'Y'.      01450071
014600         88  PS-NOT-END-OF-CARD-STORES            VALUE 'N'.      01460071
014700     05  PS-ALL-STORES-SW              PIC X(01)  VALUE 'N'.      01470071
014800         88  PS-ALL-STORES                        VALUE 'Y'.      01480071
014900     05  PS-COMP-ADDED-SW              PIC X(01)  VALUE 'N'.      01490071
015000         88  PS-COMP-ADDED                        VALUE 'Y'.      01500071
015100         88  PS-COMP-NOT-ADDED                    VALUE 'N'.      01510071
015200     05  PS-ACTIVITY-FOUND-SW          PIC X(01)  VALUE 'N'.      01520071
015300         88  PS-ACTIVITY-FOUND                    VALUE 'Y'.      01530071
015400         88  PS-NO-ACTIVITY-FOUND                 VALUE 'N'.      01540071
015500     05  PS-CARD-STORE-FOUND-SW        PIC X(01)  VALUE 'N'.      01550071
015600         88  PS-CARD-STORE-FOUND                  VALUE 'Y'.      01560071
015700         88  PS-CARD-STORE-NOT-FOUND              VALUE 'N'.      01570071
015800     05  PS-CARD-STORE-ADDED-SW        PIC X(01)  VALUE 'N'.      01580071
015900         88  PS-CARD-STORE-ADDED                  VALUE 'Y'.      01590071
016000         88  PS-CARD-STORE-NOT-ADDED              VALUE 'N'.      01600071
016100                                                                  01610071
016200 01  PC-CONSTANTS.                                                01620071
016300     05  PC-COMPARE-STORE-LIMIT      PIC S9(04)    VALUE +400.    01630099
016400     05  PC-CARD-STORE-LIMIT         PIC S9(04)    VALUE +20.     01640071
016500     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          01650071
016600                                                   'SVKUT004'.    01660071
016700                                                                  01670099
016800 01  PV-MISC-FIELDS.                                              01680071
016900     05  PV-PARAGRAPH-NAME           PIC  X(30)    VALUE SPACE.   01690071
017000     05  PV-OPERATION-MSG-1          PIC  X(40)    VALUE SPACE.   01700071
017100     05  PV-OPERATION-MSG-2          PIC  X(40)    VALUE SPACE.   01710071
017200     05  PV-DB2-OPERATION            PIC  X(30)    VALUE SPACE.   01720071
017300     05  PV-COMP-STORE-SUB           PIC S9(3)     VALUE ZERO     01730071
017400                                          COMP-3.                 01740071
017500     05  PV-CARD-STORE-SUB           PIC S9(3)     VALUE ZERO     01750071
017600                                          COMP-3.                 01760071
017700     05  PV-MET-CK                   PIC  X(01)    VALUE SPACE.   01770077
017800                                                                  01780071
017900* ----------------------------------------------------------------01790099
018000*  COUNTERS AND ACCUMULATORS                                      01800099
018100* ----------------------------------------------------------------01810099
018200 01  PV-PC-COUNTERS.                                              01820099
018300     05  PV-PC-AVAIL-CARDS-READ        PIC  9(09)  VALUE ZERO.    01830099
018400     05  PV-PC-TRANSACTIONS-READ       PIC  9(09)  VALUE ZERO.    01840099
018600     05  PV-PC-SQLS-CARD-RCDS-WRITTEN  PIC  9(09)  VALUE ZERO.    01860099
018700                                                                  01870099
018800******************************************************************01880071
018900*  TABLES FOR PROCESSING.                                         01890071
019000******************************************************************01900071
019100*  THE COMPARE STORE TABLE HOLDS THE STORE AND METRO AREA TO BE   01910071
019200*  USED IN THIS RUN.                                              01920071
019300* ----------------------------------------------------------------01930099
019400 01  COMPARE-STORE-TABLE.                                         01940071
019500     05  COMPARE-STORE OCCURS 400 TIMES.                          01950099
019600         10  CS-STORE         PIC S9(4) COMP.                     01960071
019700         10  CS-METRO         PIC S9(4) COMP.                     01970071
019800         10  CS-STATE         PIC  X(2).                          01980099
019900* ----------------------------------------------------------------01990099
020000*  THE CARD STORE TABLE HOLDS THE STORES THAT A PARTICULAR CARD   02000071
020100*  SHOULD BE SENT TO.  WHEN A CC-STORE RECORD IS IN THE CONTROL   02010071
020200*  FILE, ONLY THAT STORE, AND NOT ITS METRO AREA, IS BEING LOADED.02020071
020300* ----------------------------------------------------------------02030099
020400 01  CARD-STORE-TABLE.                                            02040071
020500     05  CARD-STORE OCCURS 20 TIMES.                              02050071
020600         10  CST-STORE         PIC S9(4) COMP.                    02060071
020700******************************************************************02070071
020800*  INPUT SV CARD INFO                                             02080079
020900******************************************************************02090099
021000     COPY SVRD004.                                                02100099
021100******************************************************************02110099
021200*  INPUT SV ACTIVITY INFO                                         02120079
021300******************************************************************02130099
021400     COPY SVRD011.                                                02140088
021500******************************************************************02150079
021600*  WS FIELDS FOR SVPD001                                          02160079
021700******************************************************************02170079
021800     COPY SVWS001.                                                02180099
021900***************************************************************** 02190071
022000* PROCEDURE DIVISION.                                           * 02200071
022100***************************************************************** 02210071
022200 PROCEDURE DIVISION.                                              02220071
022300                                                                  02230071
022400 0000-MAINLINE-PROCESSING.                                        02240071
022500                                                                  02250071
022600     PERFORM 1000-INITIALIZE-PROGRAM.                             02260071
022700                                                                  02270072
022800     PERFORM 2000-CREATE-FILE                                     02280071
022900       UNTIL PS-END-OF-AVAILABLE.                                 02290073
023000                                                                  02300071
023100     PERFORM 9990-DISPLAY-TOTALS.                                 02310099
023200                                                                  02320099
023400     CLOSE SV-CARD-SQLS-FILE                                      02340099
023500           SV-CARD-INFO-FILE                                      02350078
023600           SV-CARD-TXN-FILE.                                      02360078
023700                                                                  02370071
023800     GOBACK.                                                      02380071
023900                                                                  02390077
024000******************************************************************02400071
024100* 1000-INITIALIZE-PROGRAM                                         02410071
024200* OPEN FILES, GET CONTROL CARD, INITIALIZE TABLES.                02420071
024300******************************************************************02430071
024400 1000-INITIALIZE-PROGRAM.                                         02440071
024500                                                                  02450071
024600     OPEN INPUT  CONTROL-FILE                                     02460071
024700                 SV-CARD-INFO-FILE                                02470078
024800                 SV-CARD-TXN-FILE                                 02480078
024900          OUTPUT SV-CARD-SQLS-FILE.                               02490099
025100                                                                  02510071
025200     INITIALIZE COMPARE-STORE-TABLE                               02520079
025300                SV004-RECORD                                      02530079
025400                SV011-RECORD.                                     02540099
025500                                                                  02550071
025600     PERFORM SV001-1000-INITIALIZE.                               02560078
025700                                                                  02570071
025800     PERFORM SV001-2000-LOAD-STORE-TABLE.                         02580078
025900                                                                  02590071
026000     PERFORM 1110-READ-CONTROL-FILE.                              02600071
026100                                                                  02610071
026200     IF PS-END-OF-CARD-FILE                                       02620071
026300         MOVE '1000-INITIALIZE-PROGRAM  '  TO PV-PARAGRAPH-NAME   02630071
026400         MOVE 'NO CONTROL CARD TO PROCESS' TO PV-OPERATION-MSG-1  02640071
026500         SET AC-CONTROL-CARD-ERROR TO TRUE                        02650071
026600         PERFORM 9999-ABEND                                       02660071
026700     END-IF.                                                      02670071
026800                                                                  02680071
026900     PERFORM 1100-PROCESS-CONTROL-CARD                            02690071
027000         UNTIL PS-END-OF-CARD-FILE.                               02700071
027100                                                                  02710071
027200     CLOSE CONTROL-FILE.                                          02720071
027300                                                                  02730072
027400     IF CC-ALL-STORES                                             02740076
027500         CONTINUE                                                 02750076
027600     ELSE                                                         02760076
027700         IF CS-STORE(1) = 0                                       02770076
027800             SET PS-END-OF-AVAILABLE TO TRUE                      02780076
027900         END-IF                                                   02790076
028000     END-IF.                                                      02800072
028100******************************************************************02810071
028200* 1100-PROCESS-CONTROL-CARD                                       02820071
028300* READ CONTROL CARDS FOR RUN TYPE.                                02830071
028400******************************************************************02840071
028500 1100-PROCESS-CONTROL-CARD.                                       02850071
028600                                                                  02860071
028700     DISPLAY 'CONTROL CARD RECORD IS ' CC-CONTROL-CARD.           02870085
028800                                                                  02880085
028900     IF CC-ALL-STORES                                             02890071
029000         SET PS-ALL-STORES TO TRUE                                02900071
029100         SET PS-END-OF-CARD-FILE TO TRUE                          02910071
029200     ELSE                                                         02920071
029300         IF CC-METRO                                              02930071
029400             PERFORM 1200-VALIDATE-METRO-AREA                     02940071
029500         ELSE                                                     02950071
029600             IF CC-STORE                                          02960071
029700                 PERFORM 1300-VALIDATE-STORE                      02970071
029800             ELSE                                                 02980071
029900                 SET AC-CONTROL-CARD-ERROR TO TRUE                02990071
030000                 MOVE '1100-PROCESS-CONTROL-CARD' TO              03000071
030100                                     PV-PARAGRAPH-NAME            03010071
030200                 MOVE 'INVALID CONTROL CARD' TO                   03020071
030300                                     PV-OPERATION-MSG-1           03030071
030400                 PERFORM 9999-ABEND                               03040071
030500             END-IF                                               03050071
030600         END-IF                                                   03060071
030700     END-IF.                                                      03070071
030800                                                                  03080071
030900     PERFORM 1110-READ-CONTROL-FILE.                              03090071
031000                                                                  03100071
031100******************************************************************03110071
031200* 1110-READ-CONTROL-FILE                                          03120071
031300* READ CONTROL CARD.                                              03130071
031400******************************************************************03140071
031500 1110-READ-CONTROL-FILE.                                          03150071
031600     READ CONTROL-FILE INTO CC-CONTROL-CARD                       03160071
031700        AT END                                                    03170071
031800           MOVE PV-COMP-STORE-SUB TO PC-COMPARE-STORE-LIMIT       03180071
031900           SET PS-END-OF-CARD-FILE TO TRUE.                       03190071
032000                                                                  03200071
032100******************************************************************03210071
032200* 1200-VALIDATE-METRO-AREA.                                       03220071
032300*  VALIDATE METRO AREA AND POPULATE TABLE WITH STORES.            03230071
032400******************************************************************03240071
032500 1200-VALIDATE-METRO-AREA.                                        03250071
032600                                                                  03260071
032700     MOVE CC-METRO-STORE TO SV001-PV-METRO-STORE.                 03270078
032800     MOVE SV001-PV-METRO-STORE TO SV001-PV-METRO-STORE-CMP.       03280078
032900                                                                  03290071
033000     EXEC SQL                                                     03300071
033100         SELECT '1'                                               03310078
033200           INTO :PV-MET-CK                                        03320078
033300           FROM XST_STR_GP                                        03330078
033400          WHERE STR_GP_TYP_CDE = 2000                             03340078
033500            AND STR_GP_ID = :SV001-PV-METRO-STORE-CMP             03350080
033600           WITH UR                                                03360071
033700     END-EXEC.                                                    03370071
033800                                                                  03380071
033900     EVALUATE TRUE                                                03390071
034000         WHEN SQLCODE = 0                                         03400071
034100             PERFORM 1210-GET-STORES                              03410071
034200         WHEN SQLCODE = +100                                      03420071
034300             DISPLAY 'INVALID METRO AREA IN CONTROL CARD '        03430071
034400             DISPLAY 'CONTROL CARD HAS ' CC-METRO-STORE           03440071
034500         WHEN SQLWARN0 NOT EQUAL SPACE                            03450071
034600         WHEN SQLCODE NOT EQUAL ZERO                              03460071
034700             MOVE '1200-VALIDATE-METRO-AREA' TO PV-PARAGRAPH-NAME 03470071
034800             MOVE 'SELECT FROM XST_STR_GP      '                  03480099
034900                                            TO PV-DB2-OPERATION   03490071
035000             PERFORM 9100-SQL-ABEND                               03500071
035100     END-EVALUATE.                                                03510071
035200                                                                  03520071
035300******************************************************************03530071
035400* 1210-GET-STORES.                                                03540071
035500*  FIND STORES IN THE METRO AREA AND PUT THEM ON COMPARE STORE    03550071
035600*  TABLE                                                          03560071
035700******************************************************************03570071
035800 1210-GET-STORES.                                                 03580071
035900                                                                  03590071
036000     SET SV001-PS-METRO-NOT-FOUND TO TRUE.                        03600078
036100     MOVE ZERO           TO SV001-PV-STORE-SUB.                   03610078
036200                                                                  03620071
036300     PERFORM 1220-FIND-METRO                                      03630071
036400         UNTIL SV001-PV-STORE-SUB > SV001-PC-STORE-LIMIT.         03640078
036500                                                                  03650071
036600     IF SV001-PS-METRO-NOT-FOUND                                  03660078
036700         DISPLAY 'STORES IN METRO AREA NOT SET UP FOR SV LOAD'    03670071
036800         DISPLAY 'METRO AREA = ' CC-METRO-STORE                   03680071
036900     END-IF.                                                      03690071
037000                                                                  03700071
037100******************************************************************03710071
037200* 1220-FIND-METRO.                                                03720071
037300*  FIND ALL STORES IN METRO AREA IN STORE TABLE                   03730071
037400******************************************************************03740071
037500 1220-FIND-METRO.                                                 03750071
037600                                                                  03760071
037700     ADD +1 TO SV001-PV-STORE-SUB.                                03770078
037800                                                                  03780071
037900     IF SV001-PV-METRO-STORE-CMP = ST-METRO(SV001-PV-STORE-SUB)   03790078
038000         IF ((SV001-PV-COMPARE-OPEN NOT LESS THAN                 03800078
038100              ST-OPEN-DATE(SV001-PV-STORE-SUB)                    03810078
038200          AND SV001-PV-COMPARE-OPEN NOT GREATER THAN              03820078
038300              ST-CLOSE-DATE(SV001-PV-STORE-SUB)))                 03830078
038400           OR ((SV001-PV-WORK-CCYY-MM-DD NOT LESS THAN            03840078
038500               ST-OPEN-DATE(SV001-PV-STORE-SUB)                   03850078
038600          AND SV001-PV-WORK-CCYY-MM-DD NOT GREATER THAN           03860078
038700               ST-CLOSE-DATE(SV001-PV-STORE-SUB)))                03870078
038800                                                                  03880071
038900             SET SV001-PS-METRO-FOUND TO TRUE                     03890078
039000             SET PS-COMP-NOT-ADDED TO TRUE                        03900071
039100             MOVE ZERO TO PV-COMP-STORE-SUB                       03910071
039200             MOVE ST-STORE(SV001-PV-STORE-SUB) TO                 03920078
039300                                             SV001-PV-ADD-STORE   03930078
039400             PERFORM 1320-CHECK-TABLE                             03940071
039500                 UNTIL PV-COMP-STORE-SUB GREATER THAN             03950071
039600                       PC-COMPARE-STORE-LIMIT                     03960071
039700                    OR PS-COMP-ADDED                              03970071
039800                                                                  03980071
039900             IF PV-COMP-STORE-SUB GREATER THAN                    03990071
040000                PC-COMPARE-STORE-LIMIT                            04000071
040100                 SET AC-TABLE-OVERFLOW-ERROR TO TRUE              04010071
040200                 MOVE '1220-FIND-METRO' TO PV-PARAGRAPH-NAME      04020099
040300                 MOVE 'COMPARE STORE TABLE OVERFLOW' TO           04030071
040400                                       PV-OPERATION-MSG-1         04040071
040500                 PERFORM 9999-ABEND                               04050071
040600             END-IF                                               04060071
040700         END-IF                                                   04070071
040800     END-IF.                                                      04080071
040900                                                                  04090071
041000******************************************************************04100071
041100* 1300-VALIDATE-STORE.                                            04110071
041200*  VALIDATE STORE AND POPULATE TABLE.                             04120071
041300******************************************************************04130071
041400 1300-VALIDATE-STORE.                                             04140071
041500                                                                  04150071
041600     MOVE CC-METRO-STORE TO SV001-PV-METRO-STORE.                 04160078
041700     MOVE SV001-PV-METRO-STORE TO SV001-PV-METRO-STORE-CMP.       04170078
041800     MOVE ZERO           TO SV001-PV-STORE-SUB.                   04180078
041900     SET SV001-PS-STORE-NOT-FOUND TO TRUE.                        04190078
042000                                                                  04200071
042100     PERFORM 1310-FIND-STORE                                      04210071
042200         UNTIL SV001-PV-STORE-SUB > SV001-PC-STORE-LIMIT          04220078
042300            OR SV001-PS-STORE-FOUND.                              04230078
042400                                                                  04240071
042500     IF SV001-PS-STORE-NOT-FOUND                                  04250078
042600         DISPLAY 'STORE NOT SET UP FOR SV LOAD'                   04260071
042700         DISPLAY 'STORE = ' CC-METRO-STORE                        04270077
042800     END-IF.                                                      04280071
042900                                                                  04290071
043000******************************************************************04300071
043100* 1310-FIND-STORE.                                                04310071
043200*  FIND STORE IN STORE TABLE                                      04320071
043300******************************************************************04330071
043400 1310-FIND-STORE.                                                 04340071
043500                                                                  04350071
043600     ADD +1 TO SV001-PV-STORE-SUB.                                04360078
043700                                                                  04370071
043800     IF SV001-PV-METRO-STORE-CMP = ST-STORE(SV001-PV-STORE-SUB)   04380078
043900         IF ((SV001-PV-COMPARE-OPEN NOT LESS THAN                 04390078
044000              ST-OPEN-DATE(SV001-PV-STORE-SUB)                    04400078
044100          AND SV001-PV-COMPARE-OPEN NOT GREATER THAN              04410078
044200              ST-CLOSE-DATE(SV001-PV-STORE-SUB)))                 04420078
044300           OR ((SV001-PV-WORK-CCYY-MM-DD NOT LESS THAN            04430078
044400               ST-OPEN-DATE(SV001-PV-STORE-SUB)                   04440078
044500          AND SV001-PV-WORK-CCYY-MM-DD NOT GREATER THAN           04450078
044600              ST-CLOSE-DATE(SV001-PV-STORE-SUB)))                 04460078
044700                                                                  04470071
044800             SET SV001-PS-STORE-FOUND TO TRUE                     04480078
044900             SET PS-COMP-NOT-ADDED TO TRUE                        04490071
045000             MOVE ZERO TO PV-COMP-STORE-SUB                       04500071
045100             MOVE ST-STORE(SV001-PV-STORE-SUB) TO                 04510078
045200                                               SV001-PV-ADD-STORE 04520078
045300             PERFORM 1320-CHECK-TABLE                             04530071
045400                 UNTIL PV-COMP-STORE-SUB GREATER THAN             04540071
045500                           PC-COMPARE-STORE-LIMIT                 04550071
045600                    OR PS-COMP-ADDED                              04560071
045700                                                                  04570071
045800             IF PV-COMP-STORE-SUB GREATER THAN                    04580071
045900                PC-COMPARE-STORE-LIMIT                            04590071
046000                 SET AC-TABLE-OVERFLOW-ERROR TO TRUE              04600071
046100                 MOVE '1310-FIND-STORE' TO PV-PARAGRAPH-NAME      04610071
046200                 MOVE 'COMPARE STORE TABLE OVERFLOW' TO           04620071
046300                                       PV-OPERATION-MSG-1         04630071
046400                 PERFORM 9999-ABEND                               04640071
046500             END-IF                                               04650071
046600         END-IF                                                   04660071
046700     END-IF.                                                      04670071
046800                                                                  04680071
046900******************************************************************04690071
047000* 1320-CHECK-TABLE.                                               04700071
047100*  FIND STORE IN COMPARE TABLE.  IF STORE NOT THERE, ADD IT.      04710071
047200******************************************************************04720071
047300 1320-CHECK-TABLE.                                                04730071
047400                                                                  04740071
047500     ADD +1 TO PV-COMP-STORE-SUB.                                 04750071
047600                                                                  04760071
047700     IF SV001-PV-ADD-STORE = CS-STORE(PV-COMP-STORE-SUB)          04770078
047800         IF CS-METRO(PV-COMP-STORE-SUB) = 0                       04780089
047900             MOVE ST-METRO(SV001-PV-STORE-SUB) TO                 04790089
048000                  CS-METRO(PV-COMP-STORE-SUB)                     04800089
048100         END-IF                                                   04810089
048200         IF CS-STATE(PV-COMP-STORE-SUB) = SPACES                  04820099
048300             MOVE ST-STATE(SV001-PV-STORE-SUB) TO                 04830099
048400                  CS-STATE(PV-COMP-STORE-SUB)                     04840099
048500         END-IF                                                   04850099
048600         SET PS-COMP-ADDED TO TRUE                                04860071
048700     ELSE                                                         04870071
048800         IF CS-STORE(PV-COMP-STORE-SUB) = ZERO                    04880071
048900             MOVE SV001-PV-ADD-STORE TO                           04890078
049000                                     CS-STORE(PV-COMP-STORE-SUB)  04900078
049100             MOVE ST-METRO(SV001-PV-STORE-SUB) TO                 04910089
049200                                     CS-METRO(PV-COMP-STORE-SUB)  04920089
049300             MOVE ST-STATE(SV001-PV-STORE-SUB) TO                 04930099
049400                                     CS-STATE(PV-COMP-STORE-SUB)  04940099
049500             SET PS-COMP-ADDED TO TRUE                            04950071
049600         END-IF                                                   04960071
049700     END-IF.                                                      04970071
049800                                                                  04980071
049900******************************************************************04990071
050000* 2000-CREATE-FILE                                                05000071
050100*                                                                 05010071
050200******************************************************************05020071
050300 2000-CREATE-FILE.                                                05030071
050400                                                                  05040071
050500     PERFORM 6000-READ-AVAILABLE-CARD.                            05050079
050600     PERFORM 3000-PROCESS-AVAILABLE                               05060073
050700         UNTIL PS-END-OF-AVAILABLE.                               05070073
050800                                                                  05080071
050900******************************************************************05090071
051000* 3000-PROCESS-AVAILABLE                                          05100073
051100******************************************************************05110071
051200 3000-PROCESS-AVAILABLE.                                          05120073
051300                                                                  05130071
051400     SET SV001-PS-STORE-NOT-FOUND TO TRUE.                        05140078
051500     INITIALIZE SVWS001-CARD-METRO-TABLE.                         05150071
051600     INITIALIZE CARD-STORE-TABLE.                                 05160071
051700     MOVE ZERO              TO SV001-PV-CARD-METRO-SUB            05170078
051800                               PV-CARD-STORE-SUB.                 05180071
051900     MOVE SV004-STR-NBR     TO SV001-PV-ADD-STORE.                05190092
052000     MOVE SPACES            TO SV001-PV-STATE-CDE.                05200092
052100                                                                  05210071
052200     SET PS-NOT-END-OF-CARD-ACTIVITY                              05220084
052300         PS-NO-ACTIVITY-FOUND  TO TRUE.                           05230079
052400     MOVE ZERO TO SV001-PV-CARD-BALANCE.                          05240078
052500                                                                  05250071
052600     PERFORM 4000-PROCESS-ACTIVITY                                05260073
052700         UNTIL PS-END-OF-CARD-ACTIVITY                            05270084
052800            OR PS-END-OF-ACTIVITY.                                05280084
052900                                                                  05290071
053000     IF  PS-NO-ACTIVITY-FOUND                                     05300099
053100         CONTINUE                                                 05310099
053200     ELSE                                                         05320071
053300         IF  SV001-PV-CARD-BALANCE GREATER THAN ZERO              05330099
053400             PERFORM 7000-WRITE-RECORD                            05340071
053500         END-IF                                                   05350071
053600     END-IF.                                                      05360071
053700                                                                  05370071
053800     PERFORM 6000-READ-AVAILABLE-CARD.                            05380079
053900                                                                  05390071
054000******************************************************************05400071
054100* 4000-PROCESS-ACTIVITY                                           05410073
054200*   PROCESS TRANSACTION IF CARD NUMBERS EQUAL,THEN READ NEXT      05420079
054300*   READ TRANSACTION TABLE TO CATCH UP IF ACCT CARD > TXN CARD    05430079
054400*   SET END-OF-ACTIVITY-SW IF ACCT CARD < TXN CARD                05440079
054500******************************************************************05450071
054600 4000-PROCESS-ACTIVITY.                                           05460073
054700                                                                  05470071
054800     IF SV004-CRD-NBR = SV011-CRD-NBR                             05480079
054900         SET PS-ACTIVITY-FOUND TO TRUE                            05490079
055000         PERFORM 4100-PROCESS-TXN                                 05500079
055100         IF PS-NOT-END-OF-ACTIVITY                                05510083
055200             PERFORM 6100-READ-ACTIVITY-RCD                       05520082
055300         END-IF                                                   05530082
055400     ELSE                                                         05540079
055500         IF SV004-CRD-NBR < SV011-CRD-NBR                         05550079
055600             SET PS-END-OF-CARD-ACTIVITY TO TRUE                  05560084
055700         ELSE                                                     05570079
055800             IF SV004-CRD-NBR > SV011-CRD-NBR                     05580079
055900                 IF PS-NOT-END-OF-ACTIVITY                        05590083
056000                     PERFORM 6100-READ-ACTIVITY-RCD               05600082
056100                 END-IF                                           05610082
056200             END-IF                                               05620079
056300         END-IF                                                   05630079
056400     END-IF.                                                      05640079
056500                                                                  05650071
056600******************************************************************05660079
056700* 4100-PROCESS-TXN                                                05670079
056800*   PROCESS EACH TRANSACTION RECORD FOR THE CARD                  05680079
056900******************************************************************05690079
057000 4100-PROCESS-TXN.                                                05700081
057100                                                                  05710079
057200     IF SV011-TRN-VOID-IND = 'Y'                                  05720079
057300         CONTINUE                                                 05730079
057400     ELSE                                                         05740079
057500         ADD SV011-APP-AUTH-AMT TO SV001-PV-CARD-BALANCE          05750079
057600     END-IF.                                                      05760079
057700                                                                  05770079
057800     SET SV001-PS-STORE-NOT-FOUND TO TRUE.                        05780079
057900     MOVE SV011-STR-NBR TO SV001-PV-ADD-STORE.                    05790079
058000     MOVE SV011-ST-CDE  TO SV001-PV-STATE-CDE.                    05800079
058100                                                                  05810079
058200     IF PS-ALL-STORES                                             05820079
058300         MOVE ZERO TO SV001-PV-STORE-SUB                          05830079
058400         PERFORM SV001-3000-CHECK-STORE                           05840079
058500             UNTIL SV001-PS-STORE-FOUND                           05850079
058600                OR SV001-PV-STORE-SUB > SV001-PC-STORE-LIMIT      05860079
058700         IF SV001-PS-STORE-NOT-FOUND                              05870099
058800             IF SV001-PV-STATE-CDE = SPACES                       05880099
058900                 CONTINUE                                         05890099
059000             ELSE                                                 05900099
059100                 PERFORM SV001-3100-FIND-METRO-BY-STATE           05910099
059200                 VARYING SV001-PV-STATE-SUB FROM 1 BY 1           05920099
059300                   UNTIL SV001-PV-STATE-SUB > SV001-PV-STORE-MAX  05930099
059400             END-IF                                               05940099
059500         END-IF                                                   05950099
059600     ELSE                                                         05960095
059700         MOVE +1   TO PV-COMP-STORE-SUB                           05970099
059800         SET SV001-PS-STATE-NOT-FOUND TO TRUE                     05980099
059900         SET SV001-PS-STORE-NOT-FOUND TO TRUE                     05990099
060000         PERFORM 5000-CHECK-STORE                                 06000098
060100             UNTIL CS-STORE(PV-COMP-STORE-SUB) = 0                06010099
060200                OR PV-COMP-STORE-SUB > PC-COMPARE-STORE-LIMIT     06020099
060300     END-IF.                                                      06030079
060400                                                                  06040079
060500******************************************************************06050079
060600* 5000-CHECK-STORE                                                06060071
060700* CHECK IF STORE IS ONE TO BE SENT IN THIS RUN.                   06070071
060800******************************************************************06080071
060900 5000-CHECK-STORE.                                                06090071
061000                                                                  06100071
061100     IF SV001-PV-ADD-STORE = CS-STORE(PV-COMP-STORE-SUB)          06110078
061200         SET SV001-PS-STORE-FOUND TO TRUE                         06120078
061300         IF CS-METRO(PV-COMP-STORE-SUB) = 0                       06130071
061400            SET PS-CARD-STORE-NOT-FOUND TO TRUE                   06140071
061500            SET PS-CARD-STORE-NOT-ADDED TO TRUE                   06150071
061600            PERFORM 5100-CHECK-CARD-STORE                         06160071
061700                VARYING PV-CARD-STORE-SUB FROM 1 BY 1             06170071
061800                    UNTIL PS-CARD-STORE-FOUND                     06180071
061900                       OR PS-CARD-STORE-ADDED                     06190071
062000                       OR PV-CARD-STORE-SUB GREATER THAN          06200071
062100                          PC-CARD-STORE-LIMIT                     06210071
062200            IF PS-CARD-STORE-FOUND OR PS-CARD-STORE-ADDED         06220071
062300              CONTINUE                                            06230071
062400            ELSE                                                  06240071
062500              SET AC-TABLE-OVERFLOW-ERROR TO TRUE                 06250071
062600              MOVE '5000-CHECK-STORE' TO PV-PARAGRAPH-NAME        06260071
062700              MOVE 'CARD STORE TABLE LIMIT EXCEEDED' TO           06270071
062800                              PV-OPERATION-MSG-1                  06280071
062900              PERFORM 9999-ABEND                                  06290071
063000            END-IF                                                06300071
063100         ELSE                                                     06310071
063200            SET SV001-PS-METRO-NOT-FOUND TO TRUE                  06320078
063300            SET SV001-PS-METRO-NOT-ADDED TO TRUE                  06330078
063400            MOVE CS-METRO(PV-COMP-STORE-SUB) TO SV001-PV-ADD-METRO06340078
063500            PERFORM SV001-3500-CHECK-METRO                        06350078
063600                VARYING SV001-PV-CARD-METRO-SUB FROM 1 BY 1       06360078
063700                    UNTIL SV001-PS-METRO-FOUND                    06370078
063800                       OR SV001-PS-METRO-ADDED                    06380078
063900                       OR SV001-PV-CARD-METRO-SUB GREATER THAN    06390078
064000                          SV001-PC-METRO-TABLE-LIMIT              06400078
064100            IF SV001-PS-METRO-NOT-FOUND AND                       06410078
064200               SV001-PS-METRO-NOT-ADDED                           06420078
064300                 SET AC-TABLE-OVERFLOW-ERROR TO TRUE              06430071
064400                 MOVE '5000-CHECK-STORE' TO PV-PARAGRAPH-NAME     06440071
064500                 MOVE 'METRO TABLE LIMIT EXCEEDED' TO             06450071
064600                              PV-OPERATION-MSG-1                  06460071
064700                 PERFORM 9999-ABEND                               06470071
064800            END-IF                                                06480071
064900         END-IF                                                   06490071
065000     ELSE                                                         06500099
065100         IF SV001-PV-STATE-CDE = CS-STATE(PV-COMP-STORE-SUB)      06510099
065200             SET SV001-PS-STATE-FOUND TO TRUE                     06520099
065300             SET SV001-PS-METRO-NOT-FOUND TO TRUE                 06530099
065400             SET SV001-PS-METRO-NOT-ADDED TO TRUE                 06540099
065500             MOVE CS-METRO(PV-COMP-STORE-SUB) TO                  06550099
065600                     SV001-PV-ADD-METRO                           06560099
065700             PERFORM SV001-3500-CHECK-METRO                       06570099
065800             VARYING SV001-PV-CARD-METRO-SUB FROM 1 BY 1          06580099
065900               UNTIL SV001-PS-METRO-FOUND                         06590099
066000                  OR SV001-PS-METRO-ADDED                         06600099
066100                  OR SV001-PV-CARD-METRO-SUB GREATER THAN         06610099
066200                          SV001-PC-METRO-TABLE-LIMIT              06620099
066300             IF SV001-PS-METRO-NOT-FOUND AND                      06630099
066400                 SV001-PS-METRO-NOT-ADDED                         06640099
066500                 SET AC-TABLE-OVERFLOW-ERROR TO TRUE              06650099
066600                 MOVE '5000-CHECK-STORE' TO PV-PARAGRAPH-NAME     06660099
066700                 MOVE 'METRO TABLE LIMIT EXCEEDED' TO             06670099
066800                                  PV-OPERATION-MSG-1              06680099
066900                 PERFORM 9999-ABEND                               06690099
067000             END-IF                                               06700099
067100         END-IF                                                   06710099
067200     END-IF.                                                      06720071
067300                                                                  06730071
067400     ADD +1 TO PV-COMP-STORE-SUB.                                 06740099
067500                                                                  06750099
067600******************************************************************06760071
067700* 5100-CHECK-CARD-STORE                                           06770071
067800*                                                                 06780071
067900******************************************************************06790071
068000 5100-CHECK-CARD-STORE.                                           06800071
068100                                                                  06810071
068200     IF SV001-PV-ADD-STORE = CST-STORE(PV-CARD-STORE-SUB)         06820078
068300         SET PS-CARD-STORE-FOUND TO TRUE                          06830071
068400     ELSE                                                         06840071
068500         IF CST-STORE(PV-CARD-STORE-SUB) = 0                      06850071
068600            SET PS-CARD-STORE-ADDED TO TRUE                       06860071
068700            MOVE SV001-PV-ADD-STORE TO                            06870078
068800                                 CST-STORE(PV-CARD-STORE-SUB)     06880078
068900         END-IF                                                   06890071
069000     END-IF.                                                      06900071
069100                                                                  06910071
069200******************************************************************06920071
069300* 6000-READ-AVAILABLE-CARD                                        06930079
069400******************************************************************06940071
069500 6000-READ-AVAILABLE-CARD.                                        06950079
069600                                                                  06960079
069700     READ SV-CARD-INFO-FILE INTO SV004-RECORD                     06970079
069800        AT END                                                    06980079
069900           SET PS-END-OF-AVAILABLE TO TRUE.                       06990079
070000                                                                  07000079
070100     ADD +1 TO PV-PC-AVAIL-CARDS-READ.                            07010099
070200                                                                  07020099
070300******************************************************************07030071
070400* 6100-READ-ACTIVITY-RCD                                          07040079
070500******************************************************************07050071
070600 6100-READ-ACTIVITY-RCD.                                          07060079
070700                                                                  07070079
070800     READ SV-CARD-TXN-FILE INTO SV011-RECORD                      07080079
070900        AT END                                                    07090079
071000           SET PS-END-OF-ACTIVITY TO TRUE.                        07100079
071100                                                                  07110099
071200     ADD +1 TO PV-PC-TRANSACTIONS-READ.                           07120099
071300                                                                  07130084
071400******************************************************************07140071
071500* 7000-WRITE-RECORD                                               07150071
071600* POPULATE AND WRITE RECORDS FOR CARD TO BE SENT TO THE STORES    07160099
071700* WRITE RECORDS FOR CARD TO BE SENT TO STORES                     07170099
071800******************************************************************07180071
071900 7000-WRITE-RECORD.                                               07190071
072000                                                                  07200071
072100     INITIALIZE SV060-CARD-RCD.                                   07210099
072400                                                                  07240071
072600     MOVE 'FUL'            TO SV060-FUL-CHG.                      07260099
072900     SET  SV060-ACTION-ADD TO TRUE.                               07290099
073000     MOVE SV004-CRD-NBR    TO SV060-SVC-NBR.                      07300099
073200     MOVE SV004-CRD-TYP-CDE        TO SV060-SVC-TYP-CDE.          07320099
073300     MOVE SV004-CRD-SPCTY-TYP-CDE  TO SV060-SVC-SPCTY-TYP-CDE.    07330099
073400                                                                  07340071
074100     MOVE SV001-PV-CARD-BALANCE TO SV060-SVC-BAL-AMT.             07410099
074300                                                                  07430099
074400     IF CST-STORE(1) GREATER THAN ZERO                            07440071
074500         SET PS-NOT-END-OF-CARD-STORES TO TRUE                    07450071
074600         MOVE ZERO TO PV-CARD-STORE-SUB                           07460071
074700         PERFORM 7100-WRITE-STORES                                07470071
074800             UNTIL PS-END-OF-CARD-STORES                          07480071
074900                OR PV-CARD-STORE-SUB GREATER THAN                 07490071
075000                   PC-CARD-STORE-LIMIT                            07500071
075100     END-IF.                                                      07510071
075200                                                                  07520071
075300     SET SV001-PS-NOT-END-OF-METRO TO TRUE.                       07530078
075400     MOVE ZERO TO SV001-PV-CARD-METRO-SUB.                        07540078
075500     MOVE SPACES TO SV060-EXC-STORE.                              07550099
075700                                                                  07570071
075800     PERFORM SV001-5000-GET-METRO-AREA                            07580078
075900         UNTIL SV001-PS-END-OF-METRO                              07590078
076000            OR SV001-PV-CARD-METRO-SUB GREATER THAN               07600078
076100               SV001-PC-METRO-TABLE-LIMIT.                        07610078
076200                                                                  07620071
076300******************************************************************07630071
076400* 7100-WRITE-STORES                                               07640071
076500* WRITE RECORDS FOR CARD TO BE SENT TO SPECIFIC STORES            07650071
076600* -- SQL SERVER FORMAT --                                         07660099
076700******************************************************************07670071
076800 7100-WRITE-STORES.                                               07680071
076900                                                                  07690071
077000     ADD +1 TO PV-CARD-STORE-SUB.                                 07700071
077100                                                                  07710071
077200     IF CST-STORE(PV-CARD-STORE-SUB) = ZERO                       07720071
077300         SET PS-END-OF-CARD-STORES TO TRUE                        07730071
077400     ELSE                                                         07740071
077500         MOVE CST-STORE(PV-CARD-STORE-SUB) TO                     07750078
077600                                         SV001-PV-METRO-STORE-CMP307760078
077700         MOVE SV001-PV-METRO-STORE-CMP3    TO SV001-PV-METRO-STORE07770078
078500                                                                  07850099
078600         MOVE SV001-PV-METRO-STORE         TO SV060-EXC-STORE     07860099
078700         PERFORM SV001-5200-PROCESS-SQLS-RCD                      07870099
078800     END-IF.                                                      07880099
078900                                                                  07890099
079000******************************************************************07900071
079100* COPYBOOK FOR PROCEDURE STATEMENTS USED IN CREATING STORED VALUE 07910071
079200* RECORDS TO BE SENT TO STORES FOR OFFLINES.                      07920071
079300******************************************************************07930071
079400     COPY SVPD001.                                                07940099
079500                                                                  07950099
079600******************************************************************07960071
079700* 9100-SQL-ABEND - PERFORMS THE ABEND FOR THE PROGRAM IN THE      07970071
079800* EVENT THAT AN SQL ERROR OR WARNING CODE OCCURS.                 07980071
079900******************************************************************07990071
080000 9100-SQL-ABEND.                                                  08000071
080100     PERFORM 9990-DISPLAY-TOTALS.                                 08010099
080200     DISPLAY '** ABEND     **'.                                   08020071
080300     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        08030071
080400     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              08040071
080500     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION.               08050071
080600                                                                  08060071
080700******************************************************************08070071
080800* COPY BOOK CONTAINING PROCEDURE DIVISION STATEMENTS REQUIRED     08080071
080900* TO UTILIZE SQLCA MESSAGE DISPLAY MODULE 'DSNTIAR' FOLLOWS.      08090071
081000******************************************************************08100071
081100     COPY DPPD004.                                                08110088
081200                                                                  08120071
081300     SET AC-DB2-ERROR TO TRUE.                                    08130071
081400     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         08140071
081500                                                                  08150071
081600******************************************************************08160099
081700*  DISPLAY TOTALS AT END OF JOB.                                  08170099
081800******************************************************************08180099
081900 9990-DISPLAY-TOTALS.                                             08190099
082000                                                                  08200099
082100     DISPLAY '*************************************'.             08210099
082200     DISPLAY 'AVAIL CARDS READ ====> ' PV-PC-AVAIL-CARDS-READ.    08220099
082300     DISPLAY 'TRANSACTIONS READ ===> ' PV-PC-TRANSACTIONS-READ.   08230099
082500     DISPLAY 'SV001 SQLS RCDS OUT => ' SV001-PV-SV060-WRITE-CNT.  08250099
082600     DISPLAY 'STORE FETCH COUNT ===> ' SV001-PV-STORE-FETCH-CNT.  08260099
082700     DISPLAY '*************************************'.             08270099
082800                                                                  08280099
082900******************************************************************08290071
083000* 9999-ABEND - PERFORMS A NON-SQL-ABEND                           08300071
083100******************************************************************08310071
083200 9999-ABEND.                                                      08320071
083300     DISPLAY '** ABEND           **'.                             08330071
083400     DISPLAY '** PROGRAM         ** = ' PC-CURRENT-PROGRAM-NAME.  08340071
083500     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        08350071
083600     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       08360071
083700     DISPLAY '**                 ** = ' PV-OPERATION-MSG-2.       08370071
083800     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         08380071
