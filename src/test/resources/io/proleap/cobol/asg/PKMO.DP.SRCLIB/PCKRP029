000100 IDENTIFICATION DIVISION.                                         00010089
000200 PROGRAM-ID.             PCKRP029.                                00020089
000300 AUTHOR.                 DENISE HAHN.                             00030089
000400 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00040089
000500 DATE-WRITTEN.           FEBRUARY, 2009.                          00050089
000600 DATE-COMPILED.                                                   00060089
000700                                                                  00070089
000800****************************************************************  00080089
000900* THIS WILL CREATE 2 REPORTS WHENEVER AN ASSOCIATE HAS BEEN       00090089
001000* ATTACHED TO MULTIPLE ACTIVE ASSIGNMENTS - OR WHEN THERE ARE     00100089
001100* 2 ACTIVE ASSIGNMENTS OPEN FOR THE SAME DC WORK AREA             00110089
001200* REPORT 1:  INFORMATION ABOUT THE ERROR                          00120089
001300* REPORT 2:  WHEN AN ASSOCIATE IS ON MULTIPLE ASSIGNMENTS IT      00130089
001400*            WILL SHOW THE LAST HOURS HISTORY OF ASSIGNMENTS      00140089
001500*            FOR THE ASSOCIATE                                    00150089
001600*            AND IT WILL *** THE ASSIGNMENTS CLOSED BY THE        00160089
001700*            MULTIPLE ASSIGNMENT CHECK ROUTINE (DLKUT028)         00170089
001800****************************************************************  00180089
001900                                                                  00190089
002000 ENVIRONMENT DIVISION.                                            00200089
002100 CONFIGURATION SECTION.                                           00210089
002200 SOURCE-COMPUTER.                        IBM-3090.                00220089
002300 OBJECT-COMPUTER.                        IBM-3090.                00230089
002400 INPUT-OUTPUT SECTION.                                            00240089
002500 FILE-CONTROL.                                                    00250089
002600                                                                  00260089
002700     SELECT TIMESTAMP-FILE                                        00270089
002800         ASSIGN TO INP01.                                         00280089
002900                                                                  00290089
003000     SELECT  REPORT-FILE-1                                        00300089
003100         ASSIGN TO RPT01.                                         00310089
003200                                                                  00320089
003300     SELECT  REPORT-FILE-2                                        00330089
003400         ASSIGN TO RPT02.                                         00340089
003500                                                                  00350089
003600 DATA DIVISION.                                                   00360089
003700 FILE SECTION.                                                    00370089
003800                                                                  00380089
003900 FD  TIMESTAMP-FILE                                               00390089
004000     RECORDING MODE IS F                                          00400089
004100     LABEL RECORDS ARE STANDARD                                   00410089
004200     BLOCK CONTAINS 0 RECORDS.                                    00420089
004300 01  TIMESTAMP-RECORD                 PIC X(80).                  00430089
004400                                                                  00440089
004500 FD  REPORT-FILE-1                                                00450089
004600     RECORDING MODE IS F                                          00460089
004700     LABEL RECORDS ARE STANDARD                                   00470089
004800     BLOCK CONTAINS 0 RECORDS.                                    00480089
004900 01  REPORT1-RECORD                   PIC X(132).                 00490089
005000                                                                  00500089
005100 FD  REPORT-FILE-2                                                00510089
005200     RECORDING MODE IS F                                          00520089
005300     LABEL RECORDS ARE STANDARD                                   00530089
005400     BLOCK CONTAINS 0 RECORDS.                                    00540089
005500 01  REPORT2-RECORD                   PIC X(132).                 00550089
005600                                                                  00560089
005700                                                                  00570089
005800                                                                  00580089
005900 WORKING-STORAGE SECTION.                                         00590089
005910***************************************************************** 00591089
005920*    INPUT CONTROL CARD                                           00592089
005930*    ADDED - 12/10/2009                                           00593089
005940***************************************************************** 00594089
005941                                                                  00594189
005942 01  CC-CONTROL-CARD.                                             00594289
005943     05  CC-OPER-UNT-ID              PIC 9(04)     VALUE ZERO.    00594389
005944     05  FILLER                      PIC X(03)     VALUE SPACES.  00594489
005945     05  CC-FCLTY-NAME               PIC X(20)     VALUE SPACES.  00594589
005946                                                                  00594689
005947 01  DK-DB2-KEYS.                                                 00594789
005948     05  DK-OPER-UNT-ID              PIC S9(04)    VALUE +0       00594889
005949                                                   COMP SYNC.     00594989
005950                                                                  00595089
005960                                                                  00596089
005970 01  TIMESTAMP-REC-IN.                                            00597089
005980     05  FILLER                       PIC X(1)    VALUE SPACES.   00598089
005990     05  TR-FROM-TIMESTAMP            PIC X(26)   VALUE SPACES.   00599089
006000     05  FILLER                       PIC X(1)    VALUE SPACES.   00600089
006100     05  TR-TO-TIMESTAMP              PIC X(26)   VALUE SPACES.   00610089
006200     05  FILLER                       PIC X(26)   VALUE SPACES.   00620089
006300                                                                  00630089
006400 01  UD-UPLDER-DTL-LAYOUT.                                        00640089
006500     05  UD-OPER                      PIC 9(04).                  00650089
006600     05  FILLER                       PIC X(01).                  00660089
006700     05  UD-USER-ID                   PIC X(07).                  00670089
006800     05  FILLER                       PIC X(02).                  00680089
006900     05  UD-WK-TYP-DESC               PIC X(15).                  00690089
007000     05  FILLER                       PIC X(01).                  00700089
007100     05  UD-WK-AREA-DESC              PIC X(20).                  00710089
007200     05  FILLER                       PIC X(01).                  00720089
007300     05  UD-ASGMT-STRT-DTE            PIC X(10).                  00730089
007400     05  FILLER                       PIC X(01).                  00740089
007500     05  UD-ASGMT-NBR-TXT             PIC X(10).                  00750089
007600     05  FILLER                       PIC X(01).                  00760089
007700     05  UD-JN-TMST                   PIC X(26).                  00770089
007800     05  FILLER                       PIC X(01).                  00780089
007900                                                                  00790089
008000 01  PS-SWITCHES.                                                 00800089
008100     05  PS-EOF-UPLDER-CSR-SW         PIC X(01) VALUE 'N'.        00810089
008200         88  PS-EOF-UPLDER-CSR                  VALUE 'Y'.        00820089
008300         88  PS-EOF-UPLDER-CSR-NO               VALUE 'N'.        00830089
008400     05  PS-EOF-ASGMT-CSR-SW          PIC X(01) VALUE 'N'.        00840089
008500         88  PS-EOF-ASGMT-CSR                   VALUE 'Y'.        00850089
008600         88  PS-EOF-ASGMT-CSR-NO                VALUE 'N'.        00860089
008700                                                                  00870089
008800                                                                  00880089
008900 01  SD-SYSTEM-DATE.                                              00890089
009000     05  SD-SYSTEM-DATE-YY          PIC  9(02)   VALUE ZERO.      00900089
009100     05  SD-SYSTEM-DATE-MM          PIC  9(02)   VALUE ZERO.      00910089
009200     05  SD-SYSTEM-DATE-DD          PIC  9(02)   VALUE ZERO.      00920089
009300                                                                  00930089
009400 01  ST-SYSTEM-TIME.                                              00940089
009500     05  ST-SYSTEM-HOUR             PIC  9(02)   VALUE ZERO.      00950089
009600     05  ST-SYSTEM-MINUTE           PIC  9(02)   VALUE ZERO.      00960089
009700     05  FILLER                     PIC  9(04)   VALUE ZERO.      00970089
009800                                                                  00980089
009900 01  PV-VARIABLES.                                                00990089
010000     05  PV-30                      PIC  99      VALUE 30.        01000089
010100     05  PV-DISP-SQLCODE            PIC  -999    VALUE ZEROES.    01010089
010200     05  PV-USERID                  PIC  X(08)   VALUE SPACES.    01020089
010300     05  PV-USER-ID                 PIC  X(08)   VALUE SPACES.    01030089
010400     05  PV-TMST                    PIC  X(28)   VALUE SPACES.    01040089
010500     05  PV-PAGE-COUNT-RPT1         PIC S9(07)   COMP-3           01050089
010600                                                 VALUE ZERO.      01060089
010700     05  PV-PAGE-COUNT-RPT2         PIC S9(07)   COMP-3           01070089
010800                                                 VALUE ZERO.      01080089
010900     05  PV-LINES-USED-RPT1         PIC S9(04)   COMP-3           01090089
011000                                                 VALUE ZERO.      01100089
011100     05  PV-LINES-USED-RPT2         PIC S9(04)   COMP-3           01110089
011200                                                 VALUE ZERO.      01120089
011300     05  PV-NULL-IND-1              PIC S9(04)   VALUE ZEROS      01130089
011400                                                 COMP SYNC.       01140089
011500     05  PV-NULL-IND-2              PIC S9(04)   VALUE ZEROS      01150089
011600                                                 COMP SYNC.       01160089
011700                                                                  01170089
011800     05  PV-PREV-USER-ID            PIC X(08)    VALUE SPACES.    01180089
011900     05  PV-PREV-OPER-UNIT          PIC 9(04)    VALUE ZEROES.    01190089
012000                                                                  01200089
012100 01  PC-CONSTANTS.                                                01210089
012200     05  PC-CURRENT-PROGRAM-NAME      PIC X(08) VALUE 'PCKRP029'. 01220089
012300     05  PC-MAX-LINES-ON-PAGE         PIC S9(3) COMP-3 VALUE +60. 01230089
012400     05  PC-MAX-RETRIES               PIC S9(04) VALUE +3  COMP.  01240089
012500                                                                  01250089
012600***  STANDARD REPORT HEADER FOR 132 COLUMN REPORT                 01260089
012700     COPY DPWS132O.                                               01270089
012800                                                                  01280089
012900*    ERROR EXTRACT                                                01290089
013000     COPY PCRD038.                                                01300089
013100                                                                  01310089
013200                                                                  01320089
013300 01  HL-HEADING-LINE-1A.                                          01330089
013400     05  FILLER                      PIC  X(53)  VALUE SPACES.    01340089
013500     05  FILLER                      PIC  X(27)  VALUE            01350089
013600      'MULTIPLE ASSIGNMENTS ERRORS'.                              01360089
013700     05  FILLER                      PIC  X(52)  VALUE SPACES.    01370089
013800                                                                  01380089
013900 01  HL-HEADING-LINE-1B.                                          01390089
014000     05  FILLER                      PIC  X(49)  VALUE SPACES.    01400089
014100     05  FILLER                      PIC  X(33)  VALUE            01410089
014200      'ASSOCIATE ON MULTIPLE ASSIGNMENTS'.                        01420089
014300     05  FILLER                      PIC  X(50)  VALUE SPACES.    01430089
014400                                                                  01440089
014500 01  HL-HEADING-LINE-2B.                                          01450089
014600         10  HL2-OPER-UNIT           PIC  9(04)    VALUE ZEROS.   01460089
014610         10  FILLER                  PIC  X(03)    VALUE ' - '.   01461089
014620         10  HL2-DC-NAME             PIC  X(40)    VALUE SPACES.  01462089
014630         10  FILLER                  PIC  X(85)    VALUE SPACES.  01463089
014640                                                                  01464089
014650 01  HL-HEADING-LINE-2A.                                          01465089
014660     05  FILLER              PIC  X(04) VALUE 'OPER'.             01466089
014670     05  FILLER              PIC  X(01) VALUE  SPACES.            01467089
014680     05  FILLER              PIC  X(17) VALUE 'PROCESS TIMESTAMP'.01468089
014690     05  FILLER              PIC  X(15) VALUE  SPACES.            01469089
014700     05  FILLER              PIC  X(07) VALUE 'USER ID'.          01470089
014800     05  FILLER              PIC  X(10) VALUE  SPACES.            01480090
014900     05  FILLER              PIC  X(09) VALUE 'WORK TYPE'.        01490089
015000     05  FILLER              PIC  X(07) VALUE  SPACES.            01500089
015100     05  FILLER              PIC  X(09) VALUE 'WORK AREA'.        01510089
015200     05  FILLER              PIC  X(12) VALUE  SPACES.            01520089
015300     05  FILLER              PIC  X(10) VALUE 'START DATE'.       01530089
015400     05  FILLER              PIC  X(01) VALUE  SPACES.            01540089
015500     05  FILLER              PIC  X(09) VALUE 'ASGMT TXT'.        01550089
015600     05  FILLER              PIC  X(02) VALUE  SPACES.            01560089
015700     05  FILLER              PIC  X(14) VALUE 'JOIN TIMESTAMP'.   01570089
015800     05  FILLER              PIC  X(13) VALUE  SPACES.            01580089
015900                                                                  01590089
016000 01  HL-HEADING-LINE-3B.                                          01600089
016100     05  FILLER              PIC  X(02) VALUE  SPACES.            01610089
016200     05  FILLER              PIC  X(05) VALUE  'ASGMT'.           01620089
016300     05  FILLER              PIC  X(06) VALUE  SPACES.            01630089
016400     05  FILLER              PIC  X(05) VALUE  'ASGMT'.           01640089
016500     05  FILLER              PIC  X(07) VALUE  SPACES.            01650089
016600     05  FILLER              PIC  X(05) VALUE  'ASGMT'.           01660089
016700     05  FILLER              PIC  X(04) VALUE  SPACES.            01670089
016800     05  FILLER              PIC  X(05) VALUE  'ASGMT'.           01680089
016900     05  FILLER              PIC  X(39) VALUE  SPACES.            01690089
017000     05  FILLER              PIC  X(05) VALUE  'LAST'.            01700089
017100     05  FILLER              PIC  X(04) VALUE  SPACES.            01710089
017200     05  FILLER              PIC  X(05) VALUE  'TEAM'.            01720089
017300     05  FILLER              PIC  X(03) VALUE  SPACES.            01730089
017400     05  FILLER              PIC  X(06) VALUE  'CREATE'.          01740089
017500     05  FILLER              PIC  X(28) VALUE  SPACES.            01750089
017600     05  FILLER              PIC  X(03) VALUE  'LVE'.             01760089
017700                                                                  01770089
017800 01  HL-HEADING-LINE-4B.                                          01780089
017900     05  FILLER              PIC  X(02) VALUE  SPACES.            01790089
018000     05  FILLER              PIC  X(05) VALUE  'START'.           01800089
018100     05  FILLER              PIC  X(05) VALUE  SPACES.            01810089
018200     05  FILLER              PIC  X(06) VALUE  'NUMBER'.          01820089
018300     05  FILLER              PIC  X(07) VALUE  SPACES.            01830089
018400     05  FILLER              PIC  X(06) VALUE  'NUMBER'.          01840089
018500     05  FILLER              PIC  X(03) VALUE  SPACES.            01850089
018600     05  FILLER              PIC  X(05) VALUE  'START'.           01860089
018700     05  FILLER              PIC  X(02) VALUE  SPACES.            01870089
018800     05  FILLER              PIC  X(05) VALUE  'WORK'.            01880089
018900     05  FILLER              PIC  X(11) VALUE  SPACES.            01890089
019000     05  FILLER              PIC  X(05) VALUE  'WORK'.            01900089
019100     05  FILLER              PIC  X(16) VALUE  SPACES.            01910089
019200     05  FILLER              PIC  X(05) VALUE  'USED'.            01920089
019300     05  FILLER              PIC  X(05) VALUE  SPACES.            01930089
019400     05  FILLER              PIC  X(03) VALUE  'SEQ'.             01940089
019500     05  FILLER              PIC  X(04) VALUE  SPACES.            01950089
019600     05  FILLER              PIC  X(02) VALUE  'BY'.              01960089
019700     05  FILLER              PIC  X(07) VALUE  SPACES.            01970089
019800     05  FILLER              PIC  X(09) VALUE  'LEAVE'.           01980089
019900     05  FILLER              PIC  X(16) VALUE  SPACES.            01990089
020000     05  FILLER              PIC  X(03) VALUE  'RSN'.             02000089
020100                                                                  02010089
020200 01  HL-HEADING-LINE-5B.                                          02020089
020300     05  FILLER              PIC  X(02) VALUE  SPACES.            02030089
020400     05  FILLER              PIC  X(05) VALUE  'DATE '.           02040089
020500     05  FILLER              PIC  X(05) VALUE  SPACES.            02050089
020600     05  FILLER              PIC  X(06) VALUE  ' TEXT '.          02060089
020700     05  FILLER              PIC  X(08) VALUE  SPACES.            02070089
020800     05  FILLER              PIC  X(03) VALUE  'SEQ'.             02080089
020900     05  FILLER              PIC  X(05) VALUE  SPACES.            02090089
021000     05  FILLER              PIC  X(05) VALUE  'TIME '.           02100089
021100     05  FILLER              PIC  X(02) VALUE  SPACES.            02110089
021200     05  FILLER              PIC  X(04) VALUE  'TYPE'.            02120089
021300     05  FILLER              PIC  X(12) VALUE  SPACES.            02130089
021400     05  FILLER              PIC  X(04) VALUE  'AREA'.            02140089
021500     05  FILLER              PIC  X(18) VALUE  SPACES.            02150089
021600     05  FILLER              PIC  X(03) VALUE  'SEQ'.             02160089
021700     05  FILLER              PIC  X(06) VALUE  SPACES.            02170089
021800     05  FILLER              PIC  X(03) VALUE  'NBR'.             02180089
021900     05  FILLER              PIC  X(02) VALUE  SPACES.            02190089
022000     05  FILLER              PIC  X(07) VALUE  'PROGRAM'.         02200089
022100     05  FILLER              PIC  X(03) VALUE  SPACES.            02210089
022200     05  FILLER              PIC  X(09) VALUE  'TIMESTAMP'.       02220089
022300     05  FILLER              PIC  X(17) VALUE  SPACES.            02230089
022400     05  FILLER              PIC  X(03) VALUE  'CDE'.             02240089
022500                                                                  02250089
022600                                                                  02260089
022700 01  DL-DETAIL-LINE-1A.                                           02270089
022800     05  DL-A-OPER-UNT-ID            PIC  Z(04).                  02280089
022900     05  FILLER                      PIC  X(01) VALUE  SPACES.    02290089
023000     05  DL-A-PRCS-TMST              PIC  X(26).                  02300089
023100     05  FILLER                      PIC  X(01) VALUE  SPACES.    02310089
023200     05  DL-A-DETAIL                 PIC  X(100).                 02320089
023300                                                                  02330089
023400 01  DL-DETAIL-LINE-1B.                                           02340089
023500     05  DL-B-ASGMT-STRT-DATE        PIC  X(10).                  02350089
023600     05  FILLER                      PIC  X(01) VALUE  SPACES.    02360089
023700     05  DL-B-ASGMT-NBR-TXT          PIC  X(10).                  02370089
023800     05  FILLER                      PIC  X(01) VALUE  SPACES.    02380089
023900     05  DL-B-ASGMT-NBR-SEQ          PIC  Z(08)9.                 02390089
024000     05  FILLER                      PIC  X(01) VALUE  SPACES.    02400089
024100     05  DL-B-ASGMT-STRT-TIME        PIC  X(08).                  02410089
024200     05  FILLER                      PIC  X(01) VALUE  SPACES.    02420089
024300     05  DL-B-WORK-TYPE-DESC         PIC  X(15).                  02430089
024400     05  FILLER                      PIC  X(01) VALUE  SPACES.    02440089
024500     05  DL-B-WORK-AREA-DESC         PIC  X(20).                  02450089
024600     05  FILLER                      PIC  X(01) VALUE  SPACES.    02460089
024700     05  DL-B-ASGMT-LAST-SEQ         PIC  ZZZ9.                   02470089
024800     05  DL-B-ZERO-SEQ               PIC  X(01).                  02480089
024900     05  DL-B-TEAM-SEQ-NBR           PIC  Z(08)9.                 02490089
025000     05  FILLER                      PIC  X(01) VALUE  SPACES.    02500089
025100     05  DL-B-CRE-BY-PROGRAM         PIC  X(08).                  02510089
025200     05  FILLER                      PIC  X(01) VALUE  SPACES.    02520089
025300     05  DL-B-TEAM-LEAVE-TMST        PIC  X(26).                  02530089
025400     05  FILLER                      PIC  X(01) VALUE  SPACES.    02540089
025500     05  DL-B-TEAM-LEAVE-RSN-CDE     PIC  X(01).                  02550089
025600     05  FILLER                      PIC  X(01) VALUE  SPACES.    02560089
025700     05  DL-B-MULT-ASGMT-DELETE      PIC  X(01).                  02570089
025800                                                                  02580089
025900 01  DL-DETAIL-LINE-3B.                                           02590089
026000     05  FILLER                      PIC X(09) VALUE 'USERID:  '. 02600089
026100     05  DL-B-TEAM-USER-ID           PIC X(08).                   02610089
026101     05  FILLER                      PIC X(115).                  02610189
026102                                                                  02610289
026103 01  DL-DETAIL-LINE-2B.                                           02610389
026104     05  FILLER                      PIC  X(50) VALUE             02610489
026105         '* * * * * * * * * * * * * * * * * * * * * * * * * '.    02610589
026106     05  FILLER                      PIC  X(50) VALUE             02610689
026107         '* * * * * * * * * * * * * * * * * * * * * * * * * '.    02610789
026108     05  FILLER                      PIC  X(32) VALUE             02610889
026109         '* * * * * * * * * * * * * * * * '.                      02610989
026110                                                                  02611089
026120 01  END-OF-REPORT-LINE.                                          02612089
026130     05  FILLER                  PIC  X(44)    VALUE SPACES.      02613089
026140     05  FILLER                  PIC  X(45)    VALUE              02614089
026150          '*******   E N D   O F   R E P O R T   *******'.        02615089
026160     05  FILLER                  PIC  X(43)    VALUE SPACES.      02616089
026170/                                                                 02617089
026180******************************************************************02618089
026190     COPY SQLCA2.                                                 02619089
026200                                                                  02620089
026300     EXEC SQL                                                     02630089
026400         INCLUDE SQLCA                                            02640089
026500     END-EXEC.                                                    02650089
026600                                                                  02660089
026700*----------------------------------------------------------------*02670089
026800*    DB2 DCLGEN FOR TKPRPPM TABLE                                 02680089
026900*----------------------------------------------------------------*02690089
027000     EXEC SQL                                                     02700089
027100          INCLUDE TKRPRPM                                         02710089
027200     END-EXEC.                                                    02720089
027300                                                                  02730089
027400*----------------------------------------------------------------*02740089
027500*    DB2 DCLGEN FOR TUPLDER TABLE                                 02750089
027600*----------------------------------------------------------------*02760089
027700     EXEC SQL                                                     02770089
027800          INCLUDE TUPLDER                                         02780089
027900     END-EXEC.                                                    02790089
028000                                                                  02800089
028100*---------------------------------------------------------------* 02810089
028200*    DLT_ASGMT  LABOR ASSIGNMENT TABLE                            02820089
028300*---------------------------------------------------------------* 02830089
028400     EXEC SQL                                                     02840089
028500          INCLUDE DLT00004                                        02850089
028600     END-EXEC.                                                    02860089
028700                                                                  02870089
028800*---------------------------------------------------------------* 02880089
028900*    DLT_TEM_ASGMT   LABOR TEAM ASSIGNMENTS TABLE                 02890089
029000*---------------------------------------------------------------* 02900089
029100     EXEC SQL                                                     02910089
029200          INCLUDE DLT00003                                        02920089
029300     END-EXEC.                                                    02930089
029400                                                                  02940089
029500*---------------------------------------------------------------* 02950089
029600*    XLT_LOC     XL DOMAIN LOCATION DATABASE                      02960089
029700*---------------------------------------------------------------* 02970089
029800     EXEC SQL                                                     02980089
029900          INCLUDE XLT00010                                        02990089
030000     END-EXEC.                                                    03000089
030100                                                                  03010089
030200                                                                  03020089
030300*----------------------------------------------------------------*03030089
030400*    CURSOR TO THE ERRORS FROM TUPLDER DATABASE                   03040089
030500*----------------------------------------------------------------*03050089
030600     EXEC SQL                                                     03060089
030700          DECLARE UPLDER-CSR CURSOR FOR                           03070089
030800           SELECT OPER_UNT_ID                                     03080089
030900                , UPLD_TRN_CDE                                    03090089
031000                , ERR_CDE                                         03100089
031100                , PRC_TMST                                        03110089
031200                , UPLD_SEQ_NBR                                    03120089
031300                , SUBSTR(PKT_TXT,6,8) AS USER_ID                  03130089
031400                , PKT_TXT                                         03140089
031500             FROM TUPLDER A                                       03150089
031600            WHERE A.UPLD_TRN_CDE = 'F'                            03160089
031700              AND A.PRC_TMST    >= :TR-FROM-TIMESTAMP             03170089
031800              AND A.PRC_TMST    <= :TR-TO-TIMESTAMP               03180089
031900              AND OPER_UNT_ID    = :DK-OPER-UNT-ID                03190089
032000           ORDER BY OPER_UNT_ID                                   03200089
032100                  , 6                                             03210089
032200                  , PRC_TMST                                      03220089
032300     END-EXEC.                                                    03230089
032400                                                                  03240089
032500*----------------------------------------------------------------*03250089
032600*  CURSOR TO GET THE ASSIGNMENTS THAT THE ASSOCIATE HAS BEEN ON   03260089
032700*----------------------------------------------------------------*03270089
032800     EXEC SQL                                                     03280089
032900          DECLARE ASGMT-CSR CURSOR FOR                            03290089
033000           SELECT A.ASGMT_STRT_DTE                                03300089
033100                , A.ASGMT_NBR_TXT                                 03310089
033200                , A.ASGMT_NBR_SEQ_NBR                             03320089
033300                , A.ASGMT_STRT_TM                                 03330089
033400                , A.WK_TYP_DESC                                   03340089
033500                , A.WK_AREA_DESC                                  03350089
033600                , A.DC_NBR                                        03360089
033700                , A.CRE_BY_USR_ID                                 03370089
033800                , A.CRE_BY_PGM_NM                                 03380089
033900                , A.ASGMT_STP_TMST                                03390089
034000                , A.ASGMT_STP_RSN_CDE                             03400089
034100                , A.STP_BY_PGM_NM                                 03410089
034200                , A.LAST_USD_SEQ_NBR                              03420089
034300                                                                  03430089
034400                , B.ASGMT_STRT_DTE                                03440089
034500                , B.ASGMT_NBR_TXT                                 03450089
034600                , B.ASGMT_NBR_SEQ_NBR                             03460089
034700                , B.TEM_ASGMT_SEQ_NBR                             03470089
034800                , B.KOHLS_USR_ID                                  03480089
034900                , B.TMP_USR_ID                                    03490089
035000                , B.JN_TMST                                       03500089
035100                , B.CRE_BY_USR_ID                                 03510089
035200                , B.LVE_TMST                                      03520089
035300                , B.LVE_RSN_CDE                                   03530089
035400                , B.LVE_BY_PGM_NM                                 03540089
035500             FROM DLT_ASGMT A                                     03550089
035600                , DLT_TEM_ASGMT B                                 03560089
035700                , TKRPRPM C                                       03570089
035800            WHERE A.ASGMT_STRT_DTE    =  B.ASGMT_STRT_DTE         03580089
035900              AND A.ASGMT_NBR_TXT     =  B.ASGMT_NBR_TXT          03590089
036000              AND A.ASGMT_NBR_SEQ_NBR =  B.ASGMT_NBR_SEQ_NBR      03600089
036100              AND A.DC_NBR            =  :DK-OPER-UNT-ID          03610089
036200              AND (B.KOHLS_USR_ID     =  :PV-USER-ID   OR         03620089
036300                   B.TMP_USR_ID       =  :PV-USER-ID)             03630089
036400              AND  C.LOC_ID           =   90                      03640089
036500              AND  C.SYS_PRC_FUNC_CDE =  'DLMULT'                 03650089
036600              AND B.JN_TMST          >=  TIMESTAMP                03660089
036700              (:TR-FROM-TIMESTAMP) - C.FUNC_QTY MINUTES           03670089
036800              AND B.JN_TMST          <=  TIMESTAMP                03680089
036900              (:TR-TO-TIMESTAMP)   + C.FUNC_QTY MINUTES           03690089
037000            ORDER BY B.KOHLS_USR_ID                               03700089
037100                   , B.TMP_USR_ID                                 03710089
037200                   , B.JN_TMST                                    03720089
037300     END-EXEC.                                                    03730089
037400                                                                  03740089
037500****************************************************************  03750089
037600 PROCEDURE DIVISION.                                              03760089
037700****************************************************************  03770089
037800 0000-MAINLINE.                                                   03780089
037900                                                                  03790089
038000     PERFORM 1000-INITIALIZE                                      03800089
038100                                                                  03810089
038200     PERFORM 2000-PROCESS                                         03820089
038300       UNTIL PS-EOF-UPLDER-CSR.                                   03830089
038400                                                                  03840089
038500     PERFORM 5300-CLOSE-TUPLDER-CSR.                              03850089
038600                                                                  03860089
038700     PERFORM 9000-EOJ.                                            03870089
038800                                                                  03880089
038900     GOBACK.                                                      03890089
039000                                                                  03900089
039100****************************************************************  03910089
039200 1000-INITIALIZE.                                                 03920089
039300                                                                  03930089
039400     DISPLAY ' PCKRP029 STARTED'                                  03940089
039500     EXEC SQL                                                     03950089
039600          SET :PV-TMST = CURRENT TIMESTAMP                        03960089
039700     END-EXEC.                                                    03970089
039800                                                                  03980089
039900     OPEN INPUT  TIMESTAMP-FILE                                   03990089
040000          OUTPUT REPORT-FILE-1                                    04000089
040100          OUTPUT REPORT-FILE-2.                                   04010089
040200                                                                  04020089
040300*** DMH - 12/10/2009 - BEGIN                                      04030089
040400     ACCEPT CC-CONTROL-CARD FROM SYSIN.                           04040089
040500                                                                  04050089
040510     DISPLAY 'CONTROL CARD ====>  ' CC-CONTROL-CARD.              04051089
040520                                                                  04052089
040530     MOVE CC-OPER-UNT-ID       TO DK-OPER-UNT-ID.                 04053089
040540*** DMH - 12/10/2009 - END                                        04054089
040550                                                                  04055089
040560                                                                  04056089
040570* LOAD SYSTEM DATE INTO HEADINGS                                  04057089
040580     ACCEPT SD-SYSTEM-DATE FROM DATE.                             04058089
040590     ACCEPT ST-SYSTEM-TIME FROM TIME.                             04059089
040600                                                                  04060089
040700     MOVE SD-SYSTEM-DATE-YY      TO DP132O-RUN-YEAR.              04070089
040800     MOVE SD-SYSTEM-DATE-MM      TO DP132O-RUN-MONTH.             04080089
040900     MOVE SD-SYSTEM-DATE-DD      TO DP132O-RUN-DAY.               04090089
041000     MOVE ST-SYSTEM-HOUR         TO DP132O-RUN-HOUR.              04100089
041100     MOVE ST-SYSTEM-MINUTE       TO DP132O-RUN-MINUTE.            04110089
041200                                                                  04120089
041300     MOVE PC-CURRENT-PROGRAM-NAME                                 04130089
041400                                 TO DP132O-PROGRAM-NAME.          04140089
041500                                                                  04150089
041600     PERFORM 8000-READ-TIMESTAMP-FILE.                            04160089
041700                                                                  04170089
041800     PERFORM 5100-OPEN-TUPLDER-CSR.                               04180089
041900     PERFORM 5200-FETCH-TUPLDER-CSR.                              04190089
042000                                                                  04200089
042100     MOVE UPLDER-OPER-UNT-ID     TO XLT00010-LOC-NBR.             04210089
042101     MOVE UPLDER-OPER-UNT-ID     TO PV-PREV-OPER-UNIT.            04210189
042102     PERFORM 5700-GET-DC-NAME.                                    04210289
042103                                                                  04210389
042104     MOVE 1                      TO DP132O-REPORT-NUMBER          04210489
042105                                    DP132O-PAGE-NUMBER            04210589
042106     PERFORM 8100-WRITE-MAIN-HEADINGS-RPT1.                       04210689
042107***                                                               04210789
042108***  MOVE 2                      TO DP132O-REPORT-NUMBER          04210889
042109***  MOVE 1                      TO DP132O-PAGE-NUMBER            04210989
042110***  PERFORM 8110-WRITE-MAIN-HEADINGS-RPT2                        04211089
042120***                                                               04212089
042130***  MOVE UD-USER-ID             TO DL-B-TEAM-USER-IDR            04213089
042140***  WRITE REPORT2-RECORD                                         04214089
042150***   FROM DL-DETAIL-LINE-3B                                      04215089
042160***        AFTER 1 LINES.                                         04216089
042170***                                                               04217089
042180***  MOVE SPACES TO REPORT2-RECORD.                               04218089
042190***  WRITE REPORT2-RECORD                                         04219089
042200***        AFTER 1 LINE.                                          04220089
042300                                                                  04230089
042400                                                                  04240089
042500                                                                  04250089
042600******************************************************************04260089
042700 2000-PROCESS.                                                    04270089
042800******************************************************************04280089
042900                                                                  04290089
043000     PERFORM 3000-RPT1-DETAIL.                                    04300089
043100                                                                  04310089
043200     IF  UD-USER-ID  =  PV-PREV-USER-ID                           04320089
043300         CONTINUE                                                 04330089
043400     ELSE                                                         04340089
043500         MOVE  UD-USER-ID    TO  PV-PREV-USER-ID                  04350089
043600         PERFORM 8160-ASSOCIATE-BREAK                             04360089
043700         PERFORM 2010-PROC-ASGMTS                                 04370089
043800     END-IF.                                                      04380089
043900                                                                  04390089
044000     PERFORM 5200-FETCH-TUPLDER-CSR.                              04400089
044100                                                                  04410089
044200                                                                  04420089
044300     IF  UPLDER-OPER-UNT-ID  =  PV-PREV-OPER-UNIT                 04430089
044400         CONTINUE                                                 04440089
044500     ELSE                                                         04450089
044600         MOVE UPLDER-OPER-UNT-ID     TO XLT00010-LOC-NBR          04460089
044700         MOVE UPLDER-OPER-UNT-ID     TO PV-PREV-OPER-UNIT         04470089
044800         PERFORM 5700-GET-DC-NAME                                 04480089
044810         MOVE 2                      TO DP132O-REPORT-NUMBER      04481089
044820         PERFORM 8110-WRITE-MAIN-HEADINGS-RPT2                    04482089
044830     END-IF.                                                      04483089
044840                                                                  04484089
044850                                                                  04485089
044860******************************************************************04486089
044870 2010-PROC-ASGMTS.                                                04487089
044880******************************************************************04488089
044890                                                                  04489089
044900     INITIALIZE DL-DETAIL-LINE-1B.                                04490089
045000                                                                  04500089
045100     MOVE  UD-USER-ID    TO  PV-USER-ID.                          04510089
045200                                                                  04520089
045300     DISPLAY UD-USER-ID ' - '                                     04530089
045400             PV-USER-ID ' - '                                     04540089
045500             TR-FROM-TIMESTAMP ' - '                              04550089
045600             TR-TO-TIMESTAMP.                                     04560089
045700                                                                  04570089
045800     SET  PS-EOF-ASGMT-CSR-NO  TO  TRUE.                          04580089
045900     PERFORM 5400-OPEN-ASGMT-CSR.                                 04590089
046000     PERFORM 5500-FETCH-ASGMT-CSR                                 04600089
046100       UNTIL PS-EOF-ASGMT-CSR.                                    04610089
046200     PERFORM 5600-CLOSE-ASGMT-CSR.                                04620089
046300                                                                  04630089
046400                                                                  04640089
046500*----------------------------------------------------------------*04650089
046600* UPLOAD ERROR REPORT DETAIL LINE                                 04660089
046700*----------------------------------------------------------------*04670089
046800 3000-RPT1-DETAIL.                                                04680089
046900                                                                  04690089
047000     INITIALIZE DL-DETAIL-LINE-1A.                                04700089
047100                                                                  04710089
047200     MOVE UPLDER-OPER-UNT-ID       TO  DL-A-OPER-UNT-ID.          04720089
047300     MOVE UPLDER-PRC-TMST          TO  DL-A-PRCS-TMST.            04730089
047400     MOVE UPLDER-PKT-TXT           TO  DL-A-DETAIL.               04740089
047500                                                                  04750089
047600     PERFORM 8110-WRITE-DETAIL-RPT1.                              04760089
047700                                                                  04770089
047800                                                                  04780089
047900*----------------------------------------------------------------*04790089
048000* ASSIGNMENT REPORT - DETAIL LINE                                 04800089
048100*----------------------------------------------------------------*04810089
048200 3050-RPT2-DETAIL.                                                04820089
048300                                                                  04830089
048400     INITIALIZE DL-DETAIL-LINE-1B.                                04840089
048500                                                                  04850089
048600     MOVE  DLT00004-ASGMT-STRT-DTE     TO  DL-B-ASGMT-STRT-DATE.  04860089
048700     MOVE  DLT00004-ASGMT-NBR-TXT      TO  DL-B-ASGMT-NBR-TXT.    04870089
048800     MOVE  DLT00004-ASGMT-NBR-SEQ-NBR  TO  DL-B-ASGMT-NBR-SEQ.    04880089
048900     MOVE  DLT00004-ASGMT-STRT-TM      TO  DL-B-ASGMT-STRT-TIME.  04890089
049000     MOVE  DLT00004-WK-TYP-DESC        TO  DL-B-WORK-TYPE-DESC.   04900089
049100     MOVE  DLT00004-WK-AREA-DESC       TO  DL-B-WORK-AREA-DESC.   04910089
049200     MOVE  DLT00004-LAST-USD-SEQ-NBR   TO  DL-B-ASGMT-LAST-SEQ.   04920089
049300     MOVE  DLT00003-TEM-ASGMT-SEQ-NBR  TO  DL-B-TEAM-SEQ-NBR.     04930089
049400                                                                  04940089
049500     EVALUATE  DLT00004-CRE-BY-PGM-NM                             04950089
049600         WHEN  'PCKCS701'                                         04960089
049700               MOVE  'CASEPACK'        TO  DL-B-CRE-BY-PROGRAM    04970089
049800         WHEN  'PCKCS710'                                         04980089
049900               MOVE  'SMOOTHNG'        TO  DL-B-CRE-BY-PROGRAM    04990089
049910         WHEN  'PCKCS762'                                         04991089
049920         WHEN  'PCKUT072'                                         04992089
049930               MOVE  'P2L-PICK'        TO  DL-B-CRE-BY-PROGRAM    04993089
049940         WHEN  'PCKCS763'                                         04994089
049950         WHEN  'PCKUT073'                                         04995089
049960               MOVE  'P2L-INBD'        TO  DL-B-CRE-BY-PROGRAM    04996089
049970         WHEN  'PCKCS764'                                         04997089
049980         WHEN  'PCKUT074'                                         04998089
049990               MOVE  'P2L-OPEN'        TO  DL-B-CRE-BY-PROGRAM    04999089
049991         WHEN  'PCKCS765'                                         04999189
049992         WHEN  'PCKUT075'                                         04999289
049993               MOVE  'P2L-CLOS'        TO  DL-B-CRE-BY-PROGRAM    04999389
049994         WHEN  'PCKRF743'                                         04999489
049995               MOVE  'SHP-LOGN'        TO  DL-B-CRE-BY-PROGRAM    04999589
049996         WHEN  'PCKRF864'                                         04999689
049997               MOVE  'MASTER  '        TO  DL-B-CRE-BY-PROGRAM    04999789
049998         WHEN  'PCKRF870'                                         04999889
049999               MOVE  'SHP-OPEN'        TO  DL-B-CRE-BY-PROGRAM    04999989
050000         WHEN  'PCKRF875'                                         05000089
050001               MOVE  'SHP-ROPN'        TO  DL-B-CRE-BY-PROGRAM    05000189
050002         WHEN  'PCKRF877'                                         05000289
050003               MOVE  'SHP-CLOS'        TO  DL-B-CRE-BY-PROGRAM    05000389
050004         WHEN  'PCKRF879'                                         05000489
050005               MOVE  'SHP-SCAN'        TO  DL-B-CRE-BY-PROGRAM    05000589
050006         WHEN  'SUKCS770'                                         05000689
050007               MOVE  'PNA     '        TO  DL-B-CRE-BY-PROGRAM    05000789
050008         WHEN  'SUKCS771'                                         05000889
050009               MOVE  'PNA     '        TO  DL-B-CRE-BY-PROGRAM    05000989
050010         WHEN  'SUKRF512'                                         05001089
050020               MOVE  'CTN AUDT'        TO  DL-B-CRE-BY-PROGRAM    05002089
050021         WHEN  'SUKRF515'                                         05002189
050022               MOVE  'CTN AUDT'        TO  DL-B-CRE-BY-PROGRAM    05002289
050023         WHEN  'SUKRF529'                                         05002389
050024               MOVE  'CHECK-IN'        TO  DL-B-CRE-BY-PROGRAM    05002489
050025         WHEN  OTHER                                              05002589
050026               MOVE  DLT00004-CRE-BY-PGM-NM                       05002689
050027                                       TO  DL-B-CRE-BY-PROGRAM    05002789
050028     END-EVALUATE.                                                05002889
050029                                                                  05002989
050030     MOVE  DLT00003-KOHLS-USR-ID       TO  DL-B-TEAM-USER-ID.     05003089
050040     MOVE  DLT00003-LVE-TMST           TO  DL-B-TEAM-LEAVE-TMST.  05004089
050050     MOVE  DLT00003-LVE-RSN-CDE        TO  DL-B-TEAM-LEAVE-RSN-CDE05005089
050060                                                                  05006089
050070     IF  DLT00003-LVE-BY-PGM-NM  =  'DLKUT028'                    05007089
050080         MOVE  '*'                     TO  DL-B-MULT-ASGMT-DELETE 05008089
050090                                           DL-B-ZERO-SEQ          05009089
050100     ELSE                                                         05010089
050200     IF  DLT00004-LAST-USD-SEQ-NBR   =  0                         05020089
050300         MOVE  '*'                     TO  DL-B-ZERO-SEQ          05030089
050400     END-IF                                                       05040089
050410     END-IF.                                                      05041089
050420                                                                  05042089
050430     PERFORM 8150-WRITE-DETAIL-RPT2.                              05043089
050440                                                                  05044089
050450                                                                  05045089
050460*----------------------------------------------------------------*05046089
050470* OPEN THE TUPLDER CURSOR                                         05047089
050480*----------------------------------------------------------------*05048089
050490 5100-OPEN-TUPLDER-CSR.                                           05049089
050500                                                                  05050089
050600         EXEC SQL                                                 05060089
050700              OPEN UPLDER-CSR                                     05070089
050800         END-EXEC                                                 05080089
050900                                                                  05090089
051000         EVALUATE TRUE                                            05100089
051100             WHEN SQLCODE = ZERO                                  05110089
051200             WHEN SQLCODE = -904                                  05120089
051300             WHEN SQLCODE = -913                                  05130089
051400                  SET  PS-EOF-UPLDER-CSR-NO TO TRUE               05140089
051500                                                                  05150089
051600             WHEN SQLWARN0 NOT = SPACES                           05160089
051700             WHEN SQLCODE < ZERO                                  05170089
051800             WHEN SQLCODE > ZERO                                  05180089
051900                 CONTINUE                                         05190089
052000         END-EVALUATE.                                            05200089
052100                                                                  05210089
052200*----------------------------------------------------------------*05220089
052300*    FETCH THE TUPLDER CURSOR                                     05230089
052400*----------------------------------------------------------------*05240089
052500 5200-FETCH-TUPLDER-CSR.                                          05250089
052600                                                                  05260089
052700     EXEC SQL                                                     05270089
052800         FETCH UPLDER-CSR                                         05280089
052900          INTO :UPLDER-OPER-UNT-ID                                05290089
053000             , :UPLDER-UPLD-TRN-CDE                               05300089
053100             , :UPLDER-ERR-CDE                                    05310089
053200             , :UPLDER-PRC-TMST                                   05320089
053300             , :UPLDER-UPLD-SEQ-NBR                               05330089
053400             , :PV-USERID                                         05340089
053500             , :UPLDER-PKT-TXT                                    05350089
053600     END-EXEC.                                                    05360089
053700                                                                  05370089
053800     EVALUATE TRUE                                                05380089
053900         WHEN SQLCODE = ZEROS                                     05390089
054000              INITIALIZE UD-UPLDER-DTL-LAYOUT                     05400089
054100              MOVE  UPLDER-PKT-TXT  TO UD-UPLDER-DTL-LAYOUT       05410089
054200                                                                  05420089
054300         WHEN SQLCODE = +100                                      05430089
054400              SET  PS-EOF-UPLDER-CSR TO TRUE                      05440089
054500              CONTINUE                                            05450089
054600         WHEN OTHER                                               05460089
054700              CONTINUE                                            05470089
054800     END-EVALUATE.                                                05480089
054900                                                                  05490089
055000*----------------------------------------------------------------*05500089
055100* CLOSE THE UPLDER CURSOR                                         05510089
055200*----------------------------------------------------------------*05520089
055300 5300-CLOSE-TUPLDER-CSR.                                          05530089
055400                                                                  05540089
055500     EXEC SQL                                                     05550089
055600          CLOSE UPLDER-CSR                                        05560089
055700     END-EXEC.                                                    05570089
055800                                                                  05580089
055900     EVALUATE TRUE                                                05590089
056000         WHEN SQLCODE = ZERO                                      05600089
056100         WHEN SQLCODE = +100                                      05610089
056200             CONTINUE                                             05620089
056300         WHEN SQLWARN0 NOT = SPACES                               05630089
056400         WHEN SQLCODE < ZERO                                      05640089
056500         WHEN SQLCODE > ZERO                                      05650089
056600             CONTINUE                                             05660089
056700     END-EVALUATE.                                                05670089
056800                                                                  05680089
056900                                                                  05690089
057000 5400-OPEN-ASGMT-CSR.                                             05700089
057100         SET  PS-EOF-ASGMT-CSR-NO TO TRUE                         05710089
057200                                                                  05720089
057300         EXEC SQL                                                 05730089
057400              OPEN ASGMT-CSR                                      05740089
057500         END-EXEC                                                 05750089
057600                                                                  05760089
057700         EVALUATE TRUE                                            05770089
057800             WHEN SQLCODE = ZERO                                  05780089
057900             WHEN SQLCODE = -904                                  05790089
058000             WHEN SQLCODE = -913                                  05800089
058100                  CONTINUE                                        05810089
058200                                                                  05820089
058300             WHEN SQLWARN0 NOT = SPACES                           05830089
058400             WHEN SQLCODE < ZERO                                  05840089
058500             WHEN SQLCODE > ZERO                                  05850089
058600                 CONTINUE                                         05860089
058700         END-EVALUATE.                                            05870089
058800                                                                  05880089
058900                                                                  05890089
059000                                                                  05900089
059100 5500-FETCH-ASGMT-CSR.                                            05910089
059200                                                                  05920089
059300     EXEC SQL                                                     05930089
059400         FETCH ASGMT-CSR                                          05940089
059500          INTO :DLT00004-ASGMT-STRT-DTE                           05950089
059600             , :DLT00004-ASGMT-NBR-TXT                            05960089
059700             , :DLT00004-ASGMT-NBR-SEQ-NBR                        05970089
059800             , :DLT00004-ASGMT-STRT-TM                            05980089
059900             , :DLT00004-WK-TYP-DESC                              05990089
060000             , :DLT00004-WK-AREA-DESC                             06000089
060100             , :DLT00004-DC-NBR                                   06010089
060200             , :DLT00004-CRE-BY-USR-ID                            06020089
060300             , :DLT00004-CRE-BY-PGM-NM                            06030089
060400             , :DLT00004-ASGMT-STP-TMST                           06040089
060500             , :DLT00004-ASGMT-STP-RSN-CDE                        06050089
060600             , :DLT00004-STP-BY-PGM-NM                            06060089
060700             , :DLT00004-LAST-USD-SEQ-NBR                         06070089
060800                                                                  06080089
060900             , :DLT00003-ASGMT-STRT-DTE                           06090089
061000             , :DLT00003-ASGMT-NBR-TXT                            06100089
061100             , :DLT00003-ASGMT-NBR-SEQ-NBR                        06110089
061200             , :DLT00003-TEM-ASGMT-SEQ-NBR                        06120089
061300             , :DLT00003-KOHLS-USR-ID   :PV-NULL-IND-1            06130089
061400             , :DLT00003-TMP-USR-ID     :PV-NULL-IND-2            06140089
061500             , :DLT00003-JN-TMST                                  06150089
061600             , :DLT00003-CRE-BY-USR-ID                            06160089
061700             , :DLT00003-LVE-TMST                                 06170089
061800             , :DLT00003-LVE-RSN-CDE                              06180089
061900             , :DLT00003-LVE-BY-PGM-NM                            06190089
062000     END-EXEC.                                                    06200089
062100                                                                  06210089
062200**   MOVE  SQLCODE  TO  PV-DISP-SQLCODE                           06220089
062300**   DISPLAY '5500-FETCH-ASGMT-CSR  ' PV-DISP-SQLCODE             06230089
062400                                                                  06240089
062500                                                                  06250089
062600     EVALUATE TRUE                                                06260089
062700         WHEN SQLCODE = ZEROS                                     06270089
062800                                                                  06280089
062900             IF  PV-NULL-IND-1  =  -1                             06290089
063000                 MOVE SPACES  TO   DLT00003-KOHLS-USR-ID          06300089
063100             END-IF                                               06310089
063200             IF  PV-NULL-IND-2  =  -1                             06320089
063300                 MOVE SPACES  TO   DLT00003-TMP-USR-ID            06330089
063400             END-IF                                               06340089
063500                                                                  06350089
063600              PERFORM 3050-RPT2-DETAIL                            06360089
063700                                                                  06370089
063800         WHEN SQLCODE = +100                                      06380089
063900              SET  PS-EOF-ASGMT-CSR TO TRUE                       06390089
064000              PERFORM 8165-END-ASSOCIATE                          06400089
064100                                                                  06410089
064200         WHEN OTHER                                               06420089
064300              CONTINUE                                            06430089
064400     END-EVALUATE.                                                06440089
064500                                                                  06450089
064600                                                                  06460089
064700 5600-CLOSE-ASGMT-CSR.                                            06470089
064800                                                                  06480089
064900     EXEC SQL                                                     06490089
065000          CLOSE ASGMT-CSR                                         06500089
065100     END-EXEC.                                                    06510089
065200                                                                  06520089
065300     EVALUATE TRUE                                                06530089
065400         WHEN SQLCODE = ZERO                                      06540089
065500         WHEN SQLCODE = +100                                      06550089
065600             CONTINUE                                             06560089
065700         WHEN SQLWARN0 NOT = SPACES                               06570089
065800         WHEN SQLCODE < ZERO                                      06580089
065900         WHEN SQLCODE > ZERO                                      06590089
066000             CONTINUE                                             06600089
066100     END-EVALUATE.                                                06610089
066200                                                                  06620089
066300                                                                  06630089
066400 5700-GET-DC-NAME.                                                06640089
066500                                                                  06650089
066600     EXEC SQL                                                     06660089
066700          SELECT LOC_NM                                           06670089
066800            INTO :XLT00010-LOC-NM                                 06680089
066900            FROM XLT_LOC                                          06690089
066910           WHERE LOC_NBR  = :XLT00010-LOC-NBR                     06691089
066920     END-EXEC.                                                    06692089
066930                                                                  06693089
066940     EVALUATE TRUE                                                06694089
066950         WHEN SQLCODE = ZERO                                      06695089
066960             CONTINUE                                             06696089
066970                                                                  06697089
066980         WHEN SQLCODE = +100                                      06698089
066990             MOVE '*** UNKNOWN ***'   TO  XLT00010-LOC-NM         06699089
067000                                                                  06700089
067001         WHEN SQLWARN0 NOT = SPACES                               06700189
067002         WHEN SQLCODE < ZERO                                      06700289
067003         WHEN SQLCODE > ZERO                                      06700389
067004             CONTINUE                                             06700489
067005     END-EVALUATE.                                                06700589
067006                                                                  06700689
067007                                                                  06700789
067008                                                                  06700889
067009 8000-READ-TIMESTAMP-FILE.                                        06700989
067010     READ TIMESTAMP-FILE                                          06701089
067020         INTO TIMESTAMP-REC-IN                                    06702089
067030     END-READ.                                                    06703089
067040                                                                  06704089
067050                                                                  06705089
067060 8100-WRITE-MAIN-HEADINGS-RPT1.                                   06706089
067070                                                                  06707089
067080     ADD 1                            TO PV-PAGE-COUNT-RPT1.      06708089
067090     MOVE PV-PAGE-COUNT-RPT1          TO DP132O-PAGE-NUMBER.      06709089
067100     MOVE ZERO                        TO PV-LINES-USED-RPT1.      06710089
067200                                                                  06720089
067300     WRITE REPORT1-RECORD                                         06730089
067400      FROM DP132O-STANDRD-HEADER-132-COLS                         06740089
067500           AFTER ADVANCING PAGE                                   06750089
067600                                                                  06760089
067700     WRITE REPORT1-RECORD                                         06770089
067800      FROM HL-HEADING-LINE-1A                                     06780089
067900           AFTER ADVANCING 2 LINES.                               06790089
068000                                                                  06800089
068100     WRITE REPORT1-RECORD                                         06810089
068200      FROM HL-HEADING-LINE-2A                                     06820089
068300           AFTER ADVANCING 2 LINES.                               06830089
068400                                                                  06840089
068500     ADD 6                            TO PV-LINES-USED-RPT1.      06850089
068600                                                                  06860089
068700     MOVE  SPACES TO REPORT1-RECORD                               06870089
068800     WRITE REPORT1-RECORD                                         06880089
068900           AFTER ADVANCING 1 LINES.                               06890089
069000                                                                  06900089
069100     INITIALIZE DP132O-LASER-NEW-PAGE-INDICATR.                   06910089
069200     ADD  3                           TO PV-LINES-USED-RPT1.      06920089
069300                                                                  06930089
069400                                                                  06940089
069500 8110-WRITE-MAIN-HEADINGS-RPT2.                                   06950089
069600                                                                  06960089
069700     ADD 1                            TO PV-PAGE-COUNT-RPT2.      06970089
069800     MOVE PV-PAGE-COUNT-RPT2          TO DP132O-PAGE-NUMBER.      06980089
069900     MOVE ZERO                        TO PV-LINES-USED-RPT2.      06990089
070000     MOVE XLT00010-LOC-NBR            TO HL2-OPER-UNIT.           07000089
070100     MOVE XLT00010-LOC-NM             TO HL2-DC-NAME.             07010089
070200                                                                  07020089
070300     WRITE REPORT2-RECORD                                         07030089
070400      FROM DP132O-STANDRD-HEADER-132-COLS                         07040089
070500           AFTER ADVANCING PAGE                                   07050089
070600                                                                  07060089
070700     WRITE REPORT2-RECORD                                         07070089
070800      FROM HL-HEADING-LINE-1B                                     07080089
070900           AFTER ADVANCING 2 LINES.                               07090089
071000                                                                  07100089
071100     WRITE REPORT2-RECORD                                         07110089
071200      FROM HL-HEADING-LINE-2B                                     07120089
071300           AFTER ADVANCING 2 LINES.                               07130089
071400                                                                  07140089
071500     WRITE REPORT2-RECORD                                         07150089
071600      FROM HL-HEADING-LINE-3B                                     07160089
071700           AFTER ADVANCING 1 LINES.                               07170089
071800                                                                  07180089
071900     WRITE REPORT2-RECORD                                         07190089
072000      FROM HL-HEADING-LINE-4B                                     07200089
072100           AFTER ADVANCING 1 LINES.                               07210089
072200                                                                  07220089
072300                                                                  07230089
072400     WRITE REPORT2-RECORD                                         07240089
072500      FROM HL-HEADING-LINE-5B                                     07250089
072600           AFTER ADVANCING 1 LINES.                               07260089
072700                                                                  07270089
072800     ADD 8                            TO PV-LINES-USED-RPT2.      07280089
072900                                                                  07290089
073000     MOVE SPACES TO REPORT2-RECORD                                07300089
073100     WRITE REPORT2-RECORD                                         07310089
073200           AFTER ADVANCING 1 LINES.                               07320089
073300                                                                  07330089
073400     INITIALIZE DP132O-LASER-NEW-PAGE-INDICATR.                   07340089
073500     ADD  3                           TO PV-LINES-USED-RPT2.      07350089
073600                                                                  07360089
073700                                                                  07370089
073800 8110-WRITE-DETAIL-RPT1.                                          07380089
073900                                                                  07390089
074000     WRITE REPORT1-RECORD                                         07400089
074100      FROM DL-DETAIL-LINE-1A                                      07410089
074200           AFTER 1 LINE                                           07420089
074300                                                                  07430089
074400     ADD 1                            TO PV-LINES-USED-RPT1.      07440089
074500                                                                  07450089
074600     IF  PV-LINES-USED-RPT1  >=  PC-MAX-LINES-ON-PAGE             07460089
074700         PERFORM 8100-WRITE-MAIN-HEADINGS-RPT1                    07470089
074800     END-IF.                                                      07480089
074900                                                                  07490089
075000                                                                  07500089
075100 8150-WRITE-DETAIL-RPT2.                                          07510089
075200                                                                  07520089
075300     WRITE REPORT2-RECORD                                         07530089
075400      FROM DL-DETAIL-LINE-1B                                      07540089
075500           AFTER 1 LINE                                           07550089
075600                                                                  07560089
075700     ADD 1                            TO PV-LINES-USED-RPT2.      07570089
075800                                                                  07580089
075900     IF  PV-LINES-USED-RPT2  >=  PC-MAX-LINES-ON-PAGE             07590089
076000         PERFORM 8110-WRITE-MAIN-HEADINGS-RPT2                    07600089
076100     END-IF.                                                      07610089
076200                                                                  07620089
076300                                                                  07630089
076400 8160-ASSOCIATE-BREAK.                                            07640089
076500                                                                  07650089
076600     PERFORM 8110-WRITE-MAIN-HEADINGS-RPT2.                       07660089
076601                                                                  07660189
076602     MOVE SPACES TO REPORT2-RECORD                                07660289
076603     WRITE REPORT2-RECORD                                         07660389
076604           AFTER 1 LINE                                           07660489
076605                                                                  07660589
076606     MOVE UD-USER-ID             TO DL-B-TEAM-USER-ID             07660689
076607     WRITE REPORT2-RECORD                                         07660789
076608      FROM DL-DETAIL-LINE-3B                                      07660889
076609           AFTER 1 LINES.                                         07660989
076610                                                                  07661089
076620     MOVE SPACES TO REPORT2-RECORD.                               07662089
076621     WRITE REPORT2-RECORD                                         07662189
076622           AFTER 1 LINE.                                          07662289
076623                                                                  07662389
076624 8165-END-ASSOCIATE.                                              07662489
076625                                                                  07662589
076626     MOVE SPACES TO REPORT2-RECORD                                07662689
076627     WRITE REPORT2-RECORD                                         07662789
076628           AFTER 1 LINE                                           07662889
076629                                                                  07662989
076630     ADD 1                            TO PV-LINES-USED-RPT2.      07663089
076631                                                                  07663189
076632     IF  PV-LINES-USED-RPT2  >=  PC-MAX-LINES-ON-PAGE             07663289
076633         PERFORM 8110-WRITE-MAIN-HEADINGS-RPT2                    07663389
076634     END-IF.                                                      07663489
076635                                                                  07663589
076636     WRITE REPORT2-RECORD                                         07663689
076637      FROM DL-DETAIL-LINE-2B                                      07663789
076638           AFTER 1 LINES.                                         07663889
076639                                                                  07663989
076640                                                                  07664089
076650 9000-EOJ.                                                        07665089
076660                                                                  07666089
076670     WRITE REPORT1-RECORD                                         07667089
076680       FROM END-OF-REPORT-LINE                                    07668089
076690         AFTER ADVANCING 2 LINES.                                 07669089
076700                                                                  07670089
076800     WRITE REPORT2-RECORD                                         07680089
076900       FROM END-OF-REPORT-LINE                                    07690089
077000         AFTER ADVANCING 2 LINES.                                 07700089
077100                                                                  07710089
077200     CLOSE REPORT-FILE-1                                          07720089
077300           REPORT-FILE-2                                          07730089
077400           TIMESTAMP-FILE.                                        07740089
077500                                                                  07750089
077600                                                                  07760089
