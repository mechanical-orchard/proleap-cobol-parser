000100*************************                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*************************                                         00030000
000400 PROGRAM-ID.      BCKUT003.                                       00040000
000500 AUTHOR.          MIKE SOMMERS.                                   00050000
000600 DATE-WRITTEN.    JUNE 2002.                                      00060000
000700                                                                  00070000
000800*        READ A FORMATTED EMAIL FILE OF EMPLOYEE INFORMATION      00080054
000900*        AND A FORMATTED EMPLOYEE FILE FROM HR.  MERGE THE        00090000
001000*        INFORMATION TO CREATE A NEW FILE.                        00100000
001100                                                                  00110000
001200 ENVIRONMENT DIVISION.                                            00120000
001300 CONFIGURATION SECTION.                                           00130000
001400 SOURCE-COMPUTER. IBM-3090.                                       00140000
001500 OBJECT-COMPUTER. IBM-3090.                                       00150000
001600                                                                  00160000
001700 INPUT-OUTPUT SECTION.                                            00170000
001800 FILE-CONTROL.                                                    00180000
001900     SELECT EMAIL-FILE                 ASSIGN TO INP01.           00190054
002000     SELECT EMPLOYEE-FILE              ASSIGN TO INP02.           00200000
002100     SELECT MERGED-FILE                ASSIGN TO OUT01.           00210000
002400                                                                  00240048
002500***************                                                   00250001
002600 DATA DIVISION.                                                   00260001
002700***************                                                   00270001
002800 FILE SECTION.                                                    00280001
002900 FD  EMAIL-FILE                                                   00290054
003000                             BLOCK CONTAINS 0 RECORDS,            00300001
003100                             RECORD CONTAINS 392 CHARACTERS,      00310064
003200                             RECORDING MODE IS F,                 00320001
003300                             LABEL RECORDS ARE STANDARD,          00330001
003400                             DATA RECORD IS EMAIL-REC.            00340054
003500 01  EMAIL-REC               PIC X(392).                          00350064
003600                                                                  00360001
003700 FD  EMPLOYEE-FILE                                                00370001
003800                             BLOCK CONTAINS 0 RECORDS,            00380001
003900                             RECORD CONTAINS 635 CHARACTERS,      00390064
004000                             RECORDING MODE IS F,                 00400001
004100                             LABEL RECORDS ARE STANDARD,          00410001
004200                             DATA RECORD IS EMPLOYEE-REC.         00420001
004300 01  EMPLOYEE-REC            PIC X(635).                          00430064
004400                                                                  00440001
004500 FD  MERGED-FILE                                                  00450001
004600                             BLOCK CONTAINS 0 RECORDS,            00460001
004700                             RECORD CONTAINS 728 CHARACTERS,      00470064
004800                             RECORDING MODE IS F,                 00480001
004900                             LABEL RECORDS ARE STANDARD,          00490001
005000                             DATA RECORD IS MERGED-REC.           00500001
005100 01  MERGED-REC              PIC X(728).                          00510064
006800                                                                  00680048
006900*************************                                         00690000
007000 WORKING-STORAGE SECTION.                                         00700000
007100*************************                                         00710000
007101                                                                  00710150
007105 01  PS-PROGRAM-SWITCHES.                                         00710550
007106     05  PS-END-OF-EMAIL-FILE-SW PIC X(1)     VALUE 'N'.          00710650
007108         88  PS-END-OF-EMAIL-FILE             VALUE 'Y'.          00710850
007109     05  PS-END-OF-EMPLOYEE-FILE-SW                               00710950
007110                                 PIC X(1)     VALUE 'N'.          00711050
007111         88  PS-END-OF-EMPLOYEE-FILE          VALUE 'Y'.          00711150
007112                                                                  00711250
007113 01  PC-PROGRAM-CONSTANTS.                                        00711350
007114     05  PC-CURRENT-PROGRAM-NAME PIC X(8)     VALUE 'BCKUT003'.   00711450
007120     05  PC-COMMA                PIC X(1)     VALUE ','.          00712044
007121     05  PC-DOUBLE-QUOTE         PIC X(1)     VALUE '"'.          00712145
007122     05  PC-AT-DOMAIN-REFERENCE  PIC X(1)     VALUE '@'.          00712250
007123     05  PC-DOMAIN-EXTENSION     PIC X(1)     VALUE '.'.          00712367
007124                                                                  00712467
007125 01  PV-PROGRAM-VARIABLES.                                        00712567
007126     05  PV-TALLY                PIC S9(4)    VALUE ZEROS         00712667
007127                                              COMP SYNC.          00712767
007130                                                                  00713044
007150 01  PT-PROGRAM-TOTALS.                                           00715052
007160     05  PT-EMAIL-RCDS-READ      PIC S9(7)    VALUE ZEROS         00716053
007170                                              COMP-3.             00717052
007180     05  PT-EMPLOYEE-RCDS-READ   PIC S9(7)    VALUE ZEROS         00718052
007190                                              COMP-3.             00719052
007191     05  PT-MERGED-RCDS-WRITTEN  PIC S9(7)    VALUE ZEROS         00719153
007192                                              COMP-3.             00719253
007193                                                                  00719352
007194 01  TD-TOTAL-DISPLAY-MESSAGE.                                    00719453
007195     05  TD-TOTAL-ID             PIC X(51)    VALUE SPACES.       00719553
007196         88  TD-EMAIL-RCDS-READ-ID            VALUE               00719653
007197             'EMAIL FILE RECORDS READ  . . . . . . . . . . . . .'.00719753
007198         88  TD-EMPLOYEE-RCDS-READ-ID         VALUE               00719853
007199             'EMPLOYEE FILE RECORDS READ . . . . . . . . . . . .'.00719953
007200         88  TD-MERGED-RCDS-WRITTEN-ID        VALUE               00720053
007201             'MERGED EMPLOYEE CSV RECORDS WRITTEN  . . . . . . .'.00720153
007202     05  TD-TOTAL-AMOUNT         PIC Z,ZZZ,ZZ9                    00720255
007203                                              VALUE ZEROS.        00720355
007204                                                                  00720453
007210******************************************************************00721053
007300*   EMPLOYEE RECORD LAYOUT                                        00730039
007400******************************************************************00740000
007500     COPY BCRD000.                                                00750001
007600                                                                  00760000
007800******************************************************************00780001
007900*   EMAIL FILE RECORD LAYOUT                                      00790054
008000******************************************************************00800001
008100 01  ER-EMAIL-RECORD.                                             00810054
008200     05  ER-EMPLOYEE-USER-ID-FIELD.                               00820054
008300         10  ER-EMPLOYEE-USER-ID     PIC X(7)      VALUE SPACES.  00830054
008400         10  FILLER                  PIC X(1)      VALUE SPACES.  00840001
008500     05  ER-EMPLOYEE-NBR             PIC X(7)      VALUE SPACES.  00850054
008510     05  FILLER                      PIC X(2)      VALUE SPACES.  00851029
008600     05  ER-NAME.                                                 00860054
008700         10  ER-FIRST-NAME           PIC X(16)     VALUE SPACES.  00870054
008800         10  ER-LAST-NAME            PIC X(20)     VALUE SPACES.  00880054
008900     05  ER-LOCATION                 PIC X(4)      VALUE SPACES.  00890054
009000     05  ER-LOCATION-NAME            PIC X(22)     VALUE SPACES.  00900054
009100     05  ER-JOB-TITLE                PIC X(75)     VALUE SPACES.  00910054
009200     05  ER-WORK-PHONE               PIC X(12)     VALUE SPACES.  00920054
009300     05  ER-CELL-PHONE               PIC X(16)     VALUE SPACES.  00930054
009400     05  ER-PAGER-PIN                PIC X(60)     VALUE SPACES.  00940054
009500     05  ER-WORK-EMAIL-ADDRESS       PIC X(60)     VALUE SPACES.  00950064
009600     05  ER-SUPERVISOR               PIC X(60)     VALUE SPACES.  00960054
009700     05  ER-MARKET                   PIC X(30)     VALUE SPACES.  00970054
009800                                                                  00980001
009900******************************************************************00990001
010000*   MERGED EMPLOYEE INFO RECORD LAYOUT                            01000054
010100******************************************************************01010001
010200     COPY BCRD001.                                                01020001
010300                                                                  01030001
019400 01  WS-WORKING-STORAGE.                                          01940001
020300     05  WS-HOLD-PHONE           PIC X(12)   VALUE SPACES.        02030041
020301         88  WS-HP-CORP-SWITCHBOARD          VALUE '262-703-7000'.02030141
020302         88  WS-HP-INCORRECT-NO-NUMBER       VALUE '999-999-9999'.02030241
020303         88  WS-HP-NO-NUMBER                 VALUE '000-000-0000'.02030341
020310     05  FILLER                  REDEFINES WS-HOLD-PHONE.         02031041
020400         10  WS-HP-PHONE-1       PIC X(3).                        02040042
020500         10  FILLER              PIC X(1).                        02050042
020510             88  WS-HP-SEP-1                 VALUE '-'.           02051046
020600         10  WS-HP-PHONE-2       PIC X(3).                        02060042
020700         10  FILLER              PIC X(1).                        02070042
020710             88  WS-HP-SEP-2                 VALUE '-'.           02071046
020800         10  WS-HP-PHONE-3       PIC X(4).                        02080042
020801     05  FILLER                  REDEFINES WS-HOLD-PHONE.         02080146
020802         10  FILLER              PIC X(4).                        02080246
020805         10  WS-HP-PHONE-2-3     PIC X(7).                        02080546
020808         10  FILLER              PIC X(1).                        02080846
020809             88  WS-HP-2-3-FILLER            VALUE SPACES.        02080946
020810     05  WS-HOLD-PHONE-2-3       PIC X(7)    VALUE SPACES.        02081046
020811     05  FILLER                  REDEFINES WS-HOLD-PHONE-2-3.     02081146
020812         10  WS-HP23-PHONE-2     PIC X(3).                        02081246
020813         10  WS-HP23-PHONE-3     PIC X(4).                        02081346
020814     05  WS-HOLD-CELL.                                            02081446
020820         10  WS-HOLD-CELL1       PIC X(3)    VALUE SPACES.        02082046
020830         10  FILLER              PIC X(1)    VALUE SPACES.        02083046
020840         10  WS-HOLD-CELL2       PIC X(3)    VALUE SPACES.        02084046
020850         10  FILLER              PIC X(1)    VALUE SPACES.        02085046
020860         10  WS-HOLD-CELL3       PIC X(4)    VALUE SPACES.        02086046
020870     05  WS-HOLD-ER-JOB-TITLE-FULL.                               02087054
020880         10  WS-HOLD-ER-JOB-TITLE-1                               02088054
020890                                 PIC X(1)    VALUE SPACES.        02089046
020891         10  WS-HOLD-ER-JOB-TITLE                                 02089154
020892                                 PIC X(74)   VALUE SPACES.        02089246
020893     05  WS-HOLD-ER-WORK-PHONE-FULL.                              02089354
020894         10  WS-HOLD-ER-WORK-PHONE-1                              02089454
020895                                 PIC X(1)    VALUE SPACES.        02089546
020896         10  WS-HOLD-ER-WORK-PHONE                                02089654
020897                                 PIC X(11)   VALUE SPACES.        02089746
021300     05  WS-EMERGENCY-CONTACT-NAME.                               02130001
021400         10  FILLER              PIC X(1)    VALUE '"'.           02140046
021500         10  WS-EMERGENCY-CONTACT                                 02150001
021600                                 PIC X(28)   VALUE SPACES.        02160046
021700         10  FILLER              PIC X(1)    VALUE '"'.           02170046
022700     05  WS-EDITED-NAME          PIC X(60)   VALUE SPACES.        02270046
022800     05  WS-LAST-CHARACTER       PIC X       VALUE SPACES.        02280046
022900     05  WS-LAST-NUMBER          PIC 9  COMP VALUE ZEROES.        02290046
023000     05  WS-COMBINE-NAME.                                         02300007
023100         10  WS-FULL-NAME        PIC X(60)   VALUE SPACES.        02310046
023200         10  WS-WORKING-FULL-NAME                                 02320007
023300                 REDEFINES WS-FULL-NAME.                          02330007
023400             15  WS-F-LETTERS OCCURS 60 TIMES INDEXED BY          02340007
023500                 X-F-NAME        PIC X.                           02350007
023600     05  WS-DIVIDE-NAME.                                          02360007
023700         10  WS-PART-NAME        PIC X(60)   VALUE SPACES.        02370046
023800         10  WS-WORKING-PART-NAME                                 02380007
023900                 REDEFINES WS-PART-NAME.                          02390007
024000             15  WS-P-LETTERS OCCURS 60 TIMES INDEXED BY          02400007
024100                 X-P-NAME        PIC X.                           02410007
024200     05  WS-DIVIDE-NAME-2.                                        02420007
024300         10  WS-2-NAME           PIC X(60)   VALUE SPACES.        02430046
024400         10  WS-WORKING-2-NAME                                    02440007
024500                 REDEFINES WS-2-NAME.                             02450007
024600             15  WS-2-LETTERS OCCURS 60 TIMES INDEXED BY          02460007
024700                 X-2-NAME        PIC X.                           02470007
025400                                                                  02540048
025500********************                                              02550001
025600 PROCEDURE DIVISION.                                              02560001
025700********************                                              02570001
027200     OPEN INPUT  EMAIL-FILE                                       02720054
027300                 EMPLOYEE-FILE.                                   02730001
027400     OPEN OUTPUT MERGED-FILE.                                     02740048
027700                                                                  02770001
027800     PERFORM A100-READ-EMAIL-FILE.                                02780054
027900     PERFORM A200-READ-EMPLOYEE-FILE.                             02790001
028000     PERFORM B000-CHECK-EOF                                       02800001
028100         UNTIL ((PS-END-OF-EMAIL-FILE)                            02810053
028200                 AND (PS-END-OF-EMPLOYEE-FILE)).                  02820053
028210     PERFORM C000-DISPLAY-PROGRAM-TOTALS.                         02821053
028300                                                                  02830001
028400     CLOSE EMAIL-FILE                                             02840054
028500           EMPLOYEE-FILE                                          02850001
028600           MERGED-FILE.                                           02860048
028700                                                                  02870048
029400     STOP RUN.                                                    02940001
029500                                                                  02950001
029600**********************                                            02960001
029700 A100-READ-EMAIL-FILE.                                            02970054
029800**********************                                            02980001
030200     READ EMAIL-FILE INTO ER-EMAIL-RECORD                         03020054
030300         AT END                                                   03030053
030400              SET PS-END-OF-EMAIL-FILE TO TRUE                    03040053
030500     END-READ.                                                    03050054
030501                                                                  03050153
030510     IF (NOT PS-END-OF-EMPLOYEE-FILE)                             03051053
030520         ADD +1 TO PT-EMAIL-RCDS-READ                             03052053
030540     END-IF.                                                      03054053
030600                                                                  03060001
030700*************************                                         03070001
030800 A200-READ-EMPLOYEE-FILE.                                         03080001
030900*************************                                         03090001
031300     READ EMPLOYEE-FILE INTO BC000-EMPLOYEE-BC-RECORD             03130053
031400         AT END                                                   03140053
031500             SET PS-END-OF-EMPLOYEE-FILE TO TRUE                  03150053
031600     END-READ.                                                    03160054
031610                                                                  03161053
031620     IF (NOT PS-END-OF-EMPLOYEE-FILE)                             03162053
031630         ADD +1 TO PT-EMPLOYEE-RCDS-READ                          03163053
031640     END-IF.                                                      03164053
031700                                                                  03170001
031800****************                                                  03180001
031900 B000-CHECK-EOF.                                                  03190001
032000****************                                                  03200001
032400     IF PS-END-OF-EMAIL-FILE                                      03240053
032410         MOVE SPACES TO BC001-MERGED-RECORD                       03241053
032600         PERFORM D000-BUILD-OUTPUT-RECORD-PART1                   03260053
032800         PERFORM D100-WRITE-OUTPUT                                03280053
032900         PERFORM A200-READ-EMPLOYEE-FILE                          03290053
033000     ELSE                                                         03300053
033100         IF PS-END-OF-EMPLOYEE-FILE                               03310053
033200             PERFORM A100-READ-EMAIL-FILE                         03320054
033300         ELSE                                                     03330053
033400             PERFORM B100-COMPARE-FILES                           03340053
033500         END-IF                                                   03350053
033700     END-IF.                                                      03370001
033800                                                                  03380001
033900********************                                              03390001
034000 B100-COMPARE-FILES.                                              03400001
034100********************                                              03410001
034200     MOVE SPACES TO BC001-MERGED-RECORD.                          03420001
034300                                                                  03430001
035000     IF ER-EMPLOYEE-NBR > BC000-EMPLOYEE-NUMBER                   03500054
035200         PERFORM D000-BUILD-OUTPUT-RECORD-PART1                   03520053
035400         PERFORM D100-WRITE-OUTPUT                                03540053
035600         PERFORM A200-READ-EMPLOYEE-FILE                          03560053
035700     ELSE                                                         03570053
035800         IF ER-EMPLOYEE-NBR < BC000-EMPLOYEE-NUMBER               03580054
035900             DISPLAY PC-CURRENT-PROGRAM-NAME ' - EMAIL RCD '      03590057
036000                       'W/O MATCHING EMPLOYEE RCD FOR '           03600057
036010                       'USERID ' ER-EMPLOYEE-USER-ID-FIELD ': '   03601057
036020                       ER-EMPLOYEE-NBR ' ' ER-NAME                03602056
036030                       ' LOC' ER-LOCATION                         03603056
036100             PERFORM A100-READ-EMAIL-FILE                         03610054
036200         ELSE                                                     03620053
036300             PERFORM D000-BUILD-OUTPUT-RECORD-PART1               03630053
036400             PERFORM D000-BUILD-OUTPUT-RECORD-PART2               03640053
036500             PERFORM D100-WRITE-OUTPUT                            03650053
036600             PERFORM A100-READ-EMAIL-FILE                         03660054
036700             PERFORM A200-READ-EMPLOYEE-FILE                      03670053
036800         END-IF                                                   03680053
036900     END-IF.                                                      03690053
037000                                                                  03700053
037100********************************                                  03710053
037110 C000-DISPLAY-PROGRAM-TOTALS.                                     03711053
037120********************************                                  03712053
037121     DISPLAY ' '.                                                 03712158
037122                                                                  03712258
037130     SET TD-EMAIL-RCDS-READ-ID TO TRUE.                           03713053
037140     MOVE PT-EMAIL-RCDS-READ TO TD-TOTAL-AMOUNT.                  03714053
037150     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       03715053
037160               TD-TOTAL-DISPLAY-MESSAGE.                          03716053
037170                                                                  03717053
037171     SET TD-EMPLOYEE-RCDS-READ-ID TO TRUE.                        03717153
037172     MOVE PT-EMPLOYEE-RCDS-READ TO TD-TOTAL-AMOUNT.               03717253
037173     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       03717353
037174               TD-TOTAL-DISPLAY-MESSAGE.                          03717453
037175                                                                  03717553
037180     SET TD-MERGED-RCDS-WRITTEN-ID TO TRUE.                       03718053
037190     MOVE PT-MERGED-RCDS-WRITTEN TO TD-TOTAL-AMOUNT.              03719053
037191     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       03719153
037192               TD-TOTAL-DISPLAY-MESSAGE.                          03719253
037200                                                                  03720001
037300********************************                                  03730001
037400 D000-BUILD-OUTPUT-RECORD-PART1.                                  03740001
037500********************************                                  03750001
037510*  CLEAN UP INCORRECT PHONE NUMBERS BEFORE PROCESSING             03751041
037520                                                                  03752041
037521     MOVE BC000-PHONE TO WS-HOLD-PHONE.                           03752141
037522     IF ((WS-HP-PHONE-1 NOT NUMERIC)                              03752246
037523             OR (NOT WS-HP-SEP-1)                                 03752346
037524             OR (WS-HP-PHONE-2 NOT NUMERIC)                       03752446
037525             OR (NOT WS-HP-SEP-2)                                 03752546
037526             OR (WS-HP-PHONE-3 NOT NUMERIC))                      03752646
037527         IF ((WS-HP-PHONE-1 NUMERIC)                              03752746
037528                 AND (WS-HP-SEP-1)                                03752846
037529                 AND (WS-HP-PHONE-2-3 NUMERIC)                    03752946
037530                 AND (WS-HP-2-3-FILLER))                          03753046
037531             MOVE WS-HP-PHONE-2-3 TO WS-HOLD-PHONE-2-3            03753146
037532             MOVE WS-HP23-PHONE-2 TO WS-HP-PHONE-2                03753246
037533             SET WS-HP-SEP-2 TO TRUE                              03753346
037534             MOVE WS-HP23-PHONE-3 TO WS-HP-PHONE-3                03753446
037535         ELSE                                                     03753546
037536             SET WS-HP-NO-NUMBER TO TRUE                          03753646
037537         END-IF                                                   03753746
037538     END-IF.                                                      03753846
037539     IF ((WS-HP-CORP-SWITCHBOARD)                                 03753946
037540             OR (WS-HP-INCORRECT-NO-NUMBER))                      03754046
037541         SET WS-HP-NO-NUMBER TO TRUE                              03754146
037542     END-IF.                                                      03754246
037543     MOVE WS-HOLD-PHONE TO BC000-PHONE.                           03754346
037544     MOVE BC000-CELL-PHONE TO WS-HOLD-PHONE.                      03754446
037545     IF ((WS-HP-PHONE-1 NOT NUMERIC)                              03754546
037546             OR (NOT WS-HP-SEP-1)                                 03754646
037547             OR (WS-HP-PHONE-2 NOT NUMERIC)                       03754746
037548             OR (NOT WS-HP-SEP-2)                                 03754846
037549             OR (WS-HP-PHONE-3 NOT NUMERIC))                      03754946
037550         IF ((WS-HP-PHONE-1 NUMERIC)                              03755046
037551                 AND (WS-HP-SEP-1)                                03755146
037552                 AND (WS-HP-PHONE-2-3 NUMERIC)                    03755246
037553                 AND (WS-HP-2-3-FILLER))                          03755346
037554             MOVE WS-HP-PHONE-2-3 TO WS-HOLD-PHONE-2-3            03755446
037555             MOVE WS-HP23-PHONE-2 TO WS-HP-PHONE-2                03755546
037556             SET WS-HP-SEP-2 TO TRUE                              03755646
037557             MOVE WS-HP23-PHONE-3 TO WS-HP-PHONE-3                03755746
037558         ELSE                                                     03755846
037559             SET WS-HP-NO-NUMBER TO TRUE                          03755946
037560         END-IF                                                   03756046
037561     END-IF.                                                      03756146
037562     IF ((WS-HP-CORP-SWITCHBOARD)                                 03756246
037563             OR (WS-HP-INCORRECT-NO-NUMBER))                      03756346
037564         SET WS-HP-NO-NUMBER TO TRUE                              03756446
037565     END-IF.                                                      03756546
037577     MOVE WS-HOLD-PHONE TO BC000-CELL-PHONE.                      03757746
037578     MOVE BC000-WORK-PHONE TO WS-HOLD-PHONE.                      03757846
037579     IF ((WS-HP-PHONE-1 NOT NUMERIC)                              03757946
037580             OR (NOT WS-HP-SEP-1)                                 03758046
037581             OR (WS-HP-PHONE-2 NOT NUMERIC)                       03758146
037582             OR (NOT WS-HP-SEP-2)                                 03758246
037583             OR (WS-HP-PHONE-3 NOT NUMERIC))                      03758346
037584         IF ((WS-HP-PHONE-1 NUMERIC)                              03758446
037585                 AND (WS-HP-SEP-1)                                03758546
037586                 AND (WS-HP-PHONE-2-3 NUMERIC)                    03758646
037587                 AND (WS-HP-2-3-FILLER))                          03758746
037588             MOVE WS-HP-PHONE-2-3 TO WS-HOLD-PHONE-2-3            03758846
037589             MOVE WS-HP23-PHONE-2 TO WS-HP-PHONE-2                03758946
037590             SET WS-HP-SEP-2 TO TRUE                              03759046
037591             MOVE WS-HP23-PHONE-3 TO WS-HP-PHONE-3                03759146
037592         ELSE                                                     03759246
037593             SET WS-HP-NO-NUMBER TO TRUE                          03759346
037594         END-IF                                                   03759446
037595     END-IF.                                                      03759546
037596     IF ((WS-HP-CORP-SWITCHBOARD)                                 03759646
037597             OR (WS-HP-INCORRECT-NO-NUMBER))                      03759746
037598         SET WS-HP-NO-NUMBER TO TRUE                              03759846
037599     END-IF.                                                      03759946
037611     MOVE WS-HOLD-PHONE TO BC000-WORK-PHONE.                      03761146
037612                                                                  03761241
037613     MOVE BC000-LOCATION-TYPE       TO BC001-LOCATION-TYPE.       03761359
037620     MOVE BC000-EMPLOYEE-NUMBER     TO BC001-EMPLOYEE-NUMBER.     03762059
037700     MOVE BC000-LAST-NAME           TO BC001-LAST-NAME.           03770059
037710     INSPECT BC001-LAST-NAME                                      03771044
037720         REPLACING ALL PC-COMMA BY SPACES                         03772045
037730                       PC-DOUBLE-QUOTE BY SPACES.                 03773045
037800     MOVE BC000-FIRST-NAME          TO BC001-FIRST-NAME.          03780059
037810     INSPECT BC001-FIRST-NAME                                     03781044
037820         REPLACING ALL PC-COMMA BY SPACES                         03782045
037830                       PC-DOUBLE-QUOTE BY SPACES.                 03783045
037900     MOVE BC000-ADDRESS             TO BC001-ADDRESS.             03790059
037910     INSPECT BC001-ADDRESS                                        03791065
037920         REPLACING ALL PC-COMMA BY SPACES                         03792065
037930                       PC-DOUBLE-QUOTE BY SPACES.                 03793065
038000     MOVE BC000-CITY                TO BC001-CITY.                03800059
038010     INSPECT BC001-CITY                                           03801065
038020         REPLACING ALL PC-COMMA BY SPACES                         03802065
038030                       PC-DOUBLE-QUOTE BY SPACES.                 03803065
038100     MOVE BC000-STATE               TO BC001-STATE.               03810059
038200     MOVE BC000-ZIP                 TO BC001-ZIP.                 03820059
038300     MOVE BC000-PHONE               TO BC001-PHONE.               03830059
038400     MOVE BC000-CELL-PHONE          TO BC001-CELL-PHONE           03840059
038500                                       WS-HOLD-CELL.              03850059
038600     MOVE BC000-LOCATION            TO BC001-LOCATION.            03860059
038700     MOVE BC000-LOCATION-NAME       TO BC001-LOCATION-NAME.       03870059
038710     INSPECT BC001-LOCATION-NAME                                  03871065
038720         REPLACING ALL PC-COMMA BY SPACES                         03872065
038730                       PC-DOUBLE-QUOTE BY SPACES.                 03873065
038800     MOVE BC000-DEPARTMENT          TO BC001-DEPARTMENT.          03880059
038900     MOVE BC000-DEPARTMENT-NAME     TO BC001-DEPARTMENT-NAME.     03890059
038910     INSPECT BC001-DEPARTMENT-NAME                                03891065
038920         REPLACING ALL PC-COMMA BY SPACES                         03892065
038930                       PC-DOUBLE-QUOTE BY SPACES.                 03893065
039000     MOVE BC000-TERM-DATE           TO BC001-TERM-DATE.           03900059
039100     MOVE BC000-EMP-PERSON-TYPE     TO BC001-EMP-PERSON-TYPE.     03910059
039200     MOVE BC000-EMP-CODE            TO BC001-EMP-CODE.            03920059
039300     MOVE BC000-EMP-STATUS          TO BC001-EMP-STATUS.          03930059
039400     MOVE BC000-EMP-TYPE            TO BC001-EMP-TYPE.            03940059
039500     MOVE BC000-EMERGENCY-CONTACT-NAME   TO                       03950001
039600               WS-EMERGENCY-CONTACT.                              03960059
039700     MOVE WS-EMERGENCY-CONTACT-NAME      TO                       03970001
039800               BC001-EMERGENCY-CONTACT-NAME.                      03980059
039810     INSPECT BC001-EMERGENCY-CONTACT-NAME                         03981065
039820         REPLACING ALL PC-COMMA BY SPACES                         03982065
039830                       PC-DOUBLE-QUOTE BY SPACES.                 03983065
039900     MOVE BC000-EMERGENCY-CONTACT-PHONE1 TO                       03990001
040000               BC001-EMERGENCY-CONTACT-PHONE1.                    04000059
040100     MOVE BC000-EMERGENCY-CONTACT-PHONE2 TO                       04010001
040200               BC001-EMERGENCY-CONTACT-PHONE2.                    04020059
040300     MOVE BC000-EMERGENCY-CONTACT-RELATN TO                       04030001
040400               BC001-EMERGENCY-CONTACT-RELATN.                    04040059
040500     IF (BC000-SUPERVISOR NOT = SPACES)                           04050061
040700         PERFORM E200-MOVE-NAME                                   04070007
040800         MOVE WS-EDITED-NAME        TO BC001-SUPERVISOR           04080059
041000     END-IF.                                                      04100007
041010     INSPECT BC001-SUPERVISOR                                     04101065
041020         REPLACING ALL PC-COMMA BY SPACES                         04102065
041030                       PC-DOUBLE-QUOTE BY SPACES.                 04103065
041100     MOVE BC000-JOB-TITLE           TO BC001-JOB-TITLE.           04110059
041101     INSPECT BC001-JOB-TITLE                                      04110165
041102         REPLACING ALL PC-COMMA BY SPACES                         04110265
041103                       PC-DOUBLE-QUOTE BY SPACES.                 04110365
041110     MOVE BC000-WORK-PHONE          TO BC001-WORK-PHONE.          04111059
041120     IF (BC000-WORK-EMAIL-ADDRESS NOT = SPACES)                   04112059
041130         INITIALIZE PV-TALLY                                      04113059
041140         INSPECT BC000-WORK-EMAIL-ADDRESS                         04114059
041150             TALLYING PV-TALLY                                    04115059
041160             FOR ALL PC-AT-DOMAIN-REFERENCE                       04116059
041170         IF (PV-TALLY = 1)                                        04117059
041171             INITIALIZE PV-TALLY                                  04117167
041172             INSPECT BC000-WORK-EMAIL-ADDRESS                     04117267
041173                 TALLYING PV-TALLY                                04117367
041174                 FOR ALL PC-DOMAIN-EXTENSION                      04117467
041175                 AFTER INITIAL PC-AT-DOMAIN-REFERENCE             04117567
041176             IF (PV-TALLY >= 1)                                   04117669
041180                 MOVE BC000-WORK-EMAIL-ADDRESS TO                 04118067
041190                                       BC001-WORK-EMAIL-ADDRESS   04119059
041191                 INSPECT BC001-WORK-EMAIL-ADDRESS                 04119167
041192                     REPLACING ALL PC-COMMA BY SPACES             04119267
041193                                   PC-DOUBLE-QUOTE BY SPACES      04119367
041200             ELSE                                                 04120067
041300                 DISPLAY PC-CURRENT-PROGRAM-NAME ' - INVALID '    04130067
041310                           'WORK EMAIL ADDRESS IN HR FOR '        04131067
041320                           BC000-EMPLOYEE-NUMBER ' OF '           04132067
041330                           BC000-WORK-EMAIL-ADDRESS               04133067
041404                 INITIALIZE BC001-WORK-EMAIL-ADDRESS              04140467
041405             END-IF                                               04140567
041406         ELSE                                                     04140667
041407             DISPLAY PC-CURRENT-PROGRAM-NAME ' - INVALID WORK '   04140767
041408                       'EMAIL ADDRESS IN HR FOR '                 04140867
041409                       BC000-EMPLOYEE-NUMBER ' OF '               04140967
041410                       BC000-WORK-EMAIL-ADDRESS                   04141067
041411             INITIALIZE BC001-WORK-EMAIL-ADDRESS                  04141167
041412         END-IF                                                   04141267
041413     ELSE                                                         04141367
041414         INITIALIZE BC001-WORK-EMAIL-ADDRESS                      04141467
041415     END-IF.                                                      04141567
041416     IF (BC000-HOME-EMAIL-ADDRESS NOT = SPACES)                   04141667
041417         INITIALIZE PV-TALLY                                      04141767
041418         INSPECT BC000-HOME-EMAIL-ADDRESS                         04141867
041419             TALLYING PV-TALLY                                    04141967
041420             FOR ALL PC-AT-DOMAIN-REFERENCE                       04142067
041421         IF (PV-TALLY = 1)                                        04142167
041422             INITIALIZE PV-TALLY                                  04142267
041423             INSPECT BC000-HOME-EMAIL-ADDRESS                     04142367
041424                 TALLYING PV-TALLY                                04142467
041425                 FOR ALL PC-DOMAIN-EXTENSION                      04142567
041426                 AFTER INITIAL PC-AT-DOMAIN-REFERENCE             04142667
041427             IF (PV-TALLY >= 1)                                   04142769
041428                 MOVE BC000-HOME-EMAIL-ADDRESS TO                 04142867
041429                                       BC001-HOME-EMAIL-ADDRESS   04142967
041430                 INSPECT BC001-HOME-EMAIL-ADDRESS                 04143067
041431                     REPLACING ALL PC-COMMA BY SPACES             04143167
041432                                   PC-DOUBLE-QUOTE BY SPACES      04143267
041433             ELSE                                                 04143367
041434                 DISPLAY PC-CURRENT-PROGRAM-NAME ' - INVALID '    04143467
041435                           'HOME EMAIL ADDRESS IN HR FOR '        04143567
041436                           BC000-EMPLOYEE-NUMBER ' OF '           04143667
041437                           BC000-HOME-EMAIL-ADDRESS               04143767
041438                 INITIALIZE BC001-HOME-EMAIL-ADDRESS              04143867
041439             END-IF                                               04143967
041440         ELSE                                                     04144067
041441             DISPLAY PC-CURRENT-PROGRAM-NAME ' - INVALID HOME '   04144167
041442                       'EMAIL ADDRESS IN HR FOR '                 04144267
041443                       BC000-EMPLOYEE-NUMBER ' OF '               04144367
041444                       BC000-HOME-EMAIL-ADDRESS                   04144467
041445             INITIALIZE BC001-HOME-EMAIL-ADDRESS                  04144567
041446         END-IF                                                   04144667
041447     ELSE                                                         04144767
041448         INITIALIZE BC001-HOME-EMAIL-ADDRESS                      04144867
041449     END-IF.                                                      04144967
041450*                                                                 04145067
041451*  THIS WILL BE THE MOST RECENTLY ADDED ADDITIONAL HOME E-MAIL    04145167
041452*  ADDRESS, SEPARATE FROM THE PRIMARY HOME E-MAIL ADDRESS         04145267
041453*                                                                 04145367
041454     IF (BC000-HOME-EMAIL-ADDRESS-2 NOT = SPACES)                 04145467
041455         INITIALIZE PV-TALLY                                      04145567
041456         INSPECT BC000-HOME-EMAIL-ADDRESS-2                       04145667
041457             TALLYING PV-TALLY                                    04145767
041458             FOR ALL PC-AT-DOMAIN-REFERENCE                       04145867
041459         IF (PV-TALLY = 1)                                        04145967
041460             INITIALIZE PV-TALLY                                  04146067
041461             INSPECT BC000-HOME-EMAIL-ADDRESS-2                   04146167
041462                 TALLYING PV-TALLY                                04146267
041463                 FOR ALL PC-DOMAIN-EXTENSION                      04146367
041464                 AFTER INITIAL PC-AT-DOMAIN-REFERENCE             04146467
041465             IF (PV-TALLY >= 1)                                   04146569
041466                 MOVE BC000-HOME-EMAIL-ADDRESS-2 TO               04146667
041467                                       BC001-HOME-EMAIL-ADDRESS-2 04146767
041468                 INSPECT BC001-HOME-EMAIL-ADDRESS-2               04146867
041469                     REPLACING ALL PC-COMMA BY SPACES             04146967
041470                                   PC-DOUBLE-QUOTE BY SPACES      04147067
041471             ELSE                                                 04147167
041472                 DISPLAY PC-CURRENT-PROGRAM-NAME ' - INVALID '    04147267
041473                           'HOME EMAIL ADDRESS #2 IN HR FOR '     04147367
041474                           BC000-EMPLOYEE-NUMBER ' OF '           04147467
041475                           BC000-HOME-EMAIL-ADDRESS-2             04147567
041476                 INITIALIZE BC001-HOME-EMAIL-ADDRESS-2            04147667
041477             END-IF                                               04147767
041478         ELSE                                                     04147867
041479             DISPLAY PC-CURRENT-PROGRAM-NAME ' - INVALID HOME '   04147967
041480                       'EMAIL ADDRESS #2 IN HR FOR '              04148067
041481                       BC000-EMPLOYEE-NUMBER ' OF '               04148167
041482                       BC000-HOME-EMAIL-ADDRESS-2                 04148267
041483             INITIALIZE BC001-HOME-EMAIL-ADDRESS-2                04148367
041484         END-IF                                                   04148467
041485     ELSE                                                         04148567
041486         INITIALIZE BC001-HOME-EMAIL-ADDRESS-2                    04148667
041487     END-IF.                                                      04148767
041488                                                                  04148867
041490********************************                                  04149067
041500 D000-BUILD-OUTPUT-RECORD-PART2.                                  04150001
041600********************************                                  04160001
041700     MOVE ER-EMPLOYEE-USER-ID-FIELD  TO BC001-EMPLOYEE-USER-ID.   04170054
041800     MOVE ER-FIRST-NAME              TO BC001-FIRST-NAME.         04180054
041810     INSPECT BC001-FIRST-NAME                                     04181044
041820         REPLACING ALL PC-COMMA BY SPACES                         04182045
041830                       PC-DOUBLE-QUOTE BY SPACES.                 04183045
041900     MOVE ER-JOB-TITLE               TO WS-HOLD-ER-JOB-TITLE-FULL.04190054
041904     IF (WS-HOLD-ER-JOB-TITLE NOT = SPACES)                       04190460
041915         MOVE ER-JOB-TITLE           TO BC001-JOB-TITLE           04191554
041916         INSPECT BC001-JOB-TITLE                                  04191665
041917             REPLACING ALL PC-COMMA BY SPACES                     04191765
041918                           PC-DOUBLE-QUOTE BY SPACES              04191865
041919     END-IF.                                                      04191923
041920                                                                  04192026
041921     MOVE ER-WORK-PHONE             TO WS-HOLD-ER-WORK-PHONE-FULL.04192154
041922     MOVE BC001-WORK-PHONE TO WS-HOLD-PHONE.                      04192260
041923     IF ((BC001-WORK-PHONE = SPACES) OR                           04192360
041924             (WS-HP-INCORRECT-NO-NUMBER) OR                       04192460
041925             (WS-HP-NO-NUMBER))                                   04192560
041926         IF (WS-HOLD-ER-WORK-PHONE NOT = SPACES)                  04192660
042000             MOVE ER-WORK-PHONE      TO BC001-WORK-PHONE          04200060
042010         END-IF                                                   04201060
042020     END-IF.                                                      04202060
042100     IF ((WS-HOLD-CELL1 = ZEROES) AND                             04210061
042200             (WS-HOLD-CELL2 = ZEROES) AND                         04220061
042300             (WS-HOLD-CELL3 = ZEROES))                            04230061
042400         MOVE ER-CELL-PHONE          TO BC001-CELL-PHONE          04240054
042500     END-IF.                                                      04250006
042600     MOVE ER-PAGER-PIN               TO BC001-PAGER-PIN.          04260054
042601     IF (BC001-WORK-EMAIL-ADDRESS = SPACES)                       04260161
042610         INITIALIZE PV-TALLY                                      04261061
042620         INSPECT ER-WORK-EMAIL-ADDRESS                            04262060
042630             TALLYING PV-TALLY                                    04263060
042640             FOR ALL PC-AT-DOMAIN-REFERENCE                       04264061
042650         IF (PV-TALLY = 1)                                        04265060
042660             INITIALIZE PV-TALLY                                  04266067
042670             INSPECT ER-WORK-EMAIL-ADDRESS                        04267067
042671                 TALLYING PV-TALLY                                04267167
042672                 FOR ALL PC-DOMAIN-EXTENSION                      04267267
042673                 AFTER INITIAL PC-AT-DOMAIN-REFERENCE             04267367
042674             IF (PV-TALLY >= 1)                                   04267469
042675                 MOVE ER-WORK-EMAIL-ADDRESS TO                    04267567
042676                                       BC001-WORK-EMAIL-ADDRESS   04267667
042677                 INSPECT BC001-WORK-EMAIL-ADDRESS                 04267767
042678                     REPLACING ALL PC-COMMA BY SPACES             04267867
042679                                   PC-DOUBLE-QUOTE BY SPACES      04267967
042680             ELSE                                                 04268067
042681                 DISPLAY PC-CURRENT-PROGRAM-NAME ' - INVALID '    04268167
042682                           'WORK EMAIL ADDRESS FOR '              04268267
042683                           ER-EMPLOYEE-USER-ID-FIELD ' OF '       04268367
042684                           ER-WORK-EMAIL-ADDRESS                  04268467
042685                 INITIALIZE BC001-WORK-EMAIL-ADDRESS              04268567
042686             END-IF                                               04268667
042687         ELSE                                                     04268760
042690             INITIALIZE BC001-WORK-EMAIL-ADDRESS                  04269060
042691             IF (ER-WORK-EMAIL-ADDRESS NOT = SPACES)              04269160
042692                 DISPLAY PC-CURRENT-PROGRAM-NAME ' - INVALID '    04269260
042693                           'WORK EMAIL ADDRESS FOR '              04269360
042694                           ER-EMPLOYEE-USER-ID-FIELD ' OF '       04269460
042695                           ER-WORK-EMAIL-ADDRESS                  04269560
042696             END-IF                                               04269660
042697         END-IF                                                   04269760
042698     END-IF.                                                      04269860
042900     IF (BC001-SUPERVISOR = SPACES)                               04290061
043000         MOVE ER-SUPERVISOR          TO BC001-SUPERVISOR          04300054
043010         INSPECT BC001-SUPERVISOR                                 04301065
043020             REPLACING ALL PC-COMMA BY SPACES                     04302065
043030                           PC-DOUBLE-QUOTE BY SPACES              04303065
043100     END-IF.                                                      04310006
043200     MOVE ER-MARKET                  TO BC001-MARKET.             04320054
047600                                                                  04760001
047700*******************                                               04770001
047800 D100-WRITE-OUTPUT.                                               04780001
047900*******************                                               04790001
048000     WRITE MERGED-REC FROM BC001-MERGED-RECORD.                   04800001
048100     ADD +1 TO PT-MERGED-RCDS-WRITTEN.                            04810053
048200                                                                  04820007
048300******************************************************************04830007
048400* THIS SECTION WILL TAKE A NAME FORMATTED AS                      04840016
048500* LAST,FIRST MIDDLE OR INITIAL (SMITH,JOHN JAMES)                 04850016
048600* AND REFORMAT IT TO FIRST NAME LAST NAME (JOHN SMITH)            04860016
048700******************************************************************04870007
048710****************                                                  04871016
048800 E200-MOVE-NAME.                                                  04880007
048810****************                                                  04881016
048900     PERFORM E210-PROCESS-NAME.                                   04890007
049000     MOVE WS-2-NAME TO WS-EDITED-NAME.                            04900007
049200                                                                  04920007
049210*******************                                               04921016
049300 E210-PROCESS-NAME.                                               04930007
049310*******************                                               04931016
049400     MOVE SPACES TO WS-FULL-NAME                                  04940008
049500                    WS-LAST-CHARACTER                             04950008
049600                    WS-PART-NAME                                  04960008
049700                    WS-EDITED-NAME                                04970008
049800                    WS-2-NAME.                                    04980008
049900     SET X-P-NAME TO 1.                                           04990008
050000     MOVE BC000-SUPERVISOR TO WS-FULL-NAME.                       05000008
050100     PERFORM E220-FORMAT-NAME                                     05010008
050200             VARYING X-F-NAME FROM 1 BY 1                         05020008
050300             UNTIL WS-LAST-CHARACTER EQUAL HIGH-VALUES.           05030008
050400                                                                  05040008
050500     MOVE SPACES TO WS-LAST-CHARACTER.                            05050008
050600     SET X-2-NAME TO 1.                                           05060008
050700     PERFORM E220-CONTINUE-FORMAT                                 05070008
050800             VARYING X-F-NAME FROM WS-LAST-NUMBER BY 1            05080008
050900             UNTIL WS-LAST-CHARACTER EQUAL HIGH-VALUES.           05090008
051000                                                                  05100008
051100     MOVE SPACES TO WS-LAST-CHARACTER.                            05110008
051200     SET X-2-NAME UP BY 1                                         05120008
051300     PERFORM E220-COMPLETE-FORMAT                                 05130008
051400             VARYING X-P-NAME FROM 1 BY 1                         05140008
051500             UNTIL WS-LAST-CHARACTER EQUAL HIGH-VALUES.           05150008
051700                                                                  05170008
051710******************                                                05171016
051800 E220-FORMAT-NAME.                                                05180008
051810******************                                                05181016
051900     IF WS-F-LETTERS(X-F-NAME) NOT EQUAL ','  AND                 05190011
051910       (WS-F-LETTERS(X-F-NAME)     NOT EQUAL SPACES   OR          05191012
051920        WS-F-LETTERS(X-F-NAME + 1) NOT EQUAL SPACES)              05192012
052000         MOVE WS-F-LETTERS(X-F-NAME) TO WS-P-LETTERS(X-P-NAME)    05200008
052100                                        WS-LAST-CHARACTER         05210008
052200         SET X-P-NAME UP BY 1                                     05220008
052300     ELSE                                                         05230010
052800         MOVE HIGH-VALUES TO WS-LAST-CHARACTER                    05280016
052900         SET WS-LAST-NUMBER TO X-F-NAME                           05290016
053100     END-IF.                                                      05310008
053200                                                                  05320008
053210**********************                                            05321016
053300 E220-CONTINUE-FORMAT.                                            05330008
053310**********************                                            05331016
053400     IF WS-F-LETTERS(X-F-NAME) EQUAL ','                          05340009
053500         CONTINUE                                                 05350009
053600     ELSE                                                         05360009
053700         IF WS-F-LETTERS(X-F-NAME) NOT EQUAL SPACES               05370009
053800             MOVE WS-F-LETTERS(X-F-NAME) TO WS-2-LETTERS(X-2-NAME)05380009
053900                                            WS-LAST-CHARACTER     05390009
054000             SET X-2-NAME UP BY 1                                 05400009
054100         ELSE                                                     05410009
054101*----------------------------------------------------------       05410116
054102* THE NEXT COUPLE OF STATEMENTS TAKE INTO ACCOUNT PEOPLE          05410216
054103* WHO USE THEIR FIRST INITIAL AND THEIR SECOND NAME               05410316
054104* (I.E. R. LAWRENCE MONTGOMERY) SO IT DOESN'T SHOW UP AS          05410416
054105* R. MONTGOMERY                                                   05410516
054106*----------------------------------------------------------       05410616
054110             IF WS-F-LETTERS(X-F-NAME - 1) = '.'                  05411014
054111                 MOVE WS-F-LETTERS(X-F-NAME) TO                   05411115
054112                      WS-2-LETTERS(X-2-NAME)                      05411215
054113                      WS-LAST-CHARACTER                           05411315
054114                 SET X-2-NAME UP BY 1                             05411415
054130             ELSE                                                 05413014
054200                 MOVE HIGH-VALUES TO WS-LAST-CHARACTER            05420014
054300             END-IF                                               05430014
054310         END-IF                                                   05431014
054400     END-IF.                                                      05440009
054500                                                                  05450009
054510**********************                                            05451016
054600 E220-COMPLETE-FORMAT.                                            05460009
054610**********************                                            05461016
054700     IF WS-P-LETTERS(X-P-NAME) NOT EQUAL SPACES  OR               05470020
054710        WS-P-LETTERS(X-P-NAME + 1) NOT EQUAL SPACES               05471020
054800         MOVE WS-P-LETTERS(X-P-NAME) TO WS-2-LETTERS(X-2-NAME)    05480009
054900                                        WS-LAST-CHARACTER         05490009
055000         SET X-2-NAME UP BY 1                                     05500009
055100     ELSE                                                         05510009
055200         MOVE HIGH-VALUES TO WS-LAST-CHARACTER                    05520009
055300     END-IF.                                                      05530009
