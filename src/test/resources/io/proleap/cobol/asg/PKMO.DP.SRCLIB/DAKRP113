       IDENTIFICATION DIVISION.                                         00010000
                                                                        00020000
       PROGRAM-ID.           DAKRP113.                                  00030000
       AUTHOR.               JILL LIN.                                  00040000
       INSTALLATION.         KOHLS DEPARTMENT STORES.                   00050000
       DATE-WRITTEN.         MAY 2006.                                  00060000
       DATE-COMPILED.                                                   00070000
                                                                        00080000
      ***************************************************************** 00090000
      *  PROGRAM NARRATIVE:                                           * 00100000
      *  THIS PROGRAM READS AN EXTRACT CREATED FROM DAKUT313 AND      * 00110000
      *  CREATES A REPORT OF DEBIT ALLOWANCE AVAILABLE VENDOR FUNDING * 00120000
      *  REMAINING AVAILABLE COST DOLLAR BALANCES FOR CURRENT AND     * 00120100
      *  PREVIOUS FISCAL QUARTER. THIS PROGRAM RUNS DAILY.            * 00120200
      ***************************************************************** 00120300
      *                                                               * 00120400
      *    WR/PITS#     DATE        DESCRIPTION                       * 00120500
      *    --------   ----------   ---------------------------------  * 00120600
      ***************************************************************** 00120700
      *                                                                 00120800
       ENVIRONMENT DIVISION.                                            00120900
                                                                        00121000
       CONFIGURATION SECTION.                                           00122000
                                                                        00123000
       SOURCE-COMPUTER.                        IBM-3090.                00124000
       OBJECT-COMPUTER.                        IBM-3090.                00125000
                                                                        00126000
       INPUT-OUTPUT SECTION.                                            00127000
                                                                        00128000
       FILE-CONTROL.                                                    00129000
                                                                        00130000
           SELECT  INPUT-FILE                ASSIGN TO INP01.           00140000
           SELECT  REPORT-FILE               ASSIGN TO RPT01.           00150000
                                                                        00160000
      ******************************************************************00170000
       DATA DIVISION.                                                   00180000
      ******************************************************************00190000
                                                                        00200000
       FILE SECTION.                                                    00210000
      *                                                                 00220000
       FD  INPUT-FILE                                                   00230000
           LABEL RECORDS ARE STANDARD                                   00240000
           RECORDING MODE IS F                                          00250000
           BLOCK CONTAINS 0 RECORDS.                                    00260000
       01  INPUT-FILE-REC             PIC X(165).                       00270002
                                                                        00280000
       FD  REPORT-FILE                                                  00290000
           RECORDING MODE F                                             00300000
           LABEL RECORDS OMITTED                                        00310000
           BLOCK CONTAINS  0 RECORDS.                                   00320000
       01  REPORT-RECORD.                                               00330000
           05  REPORT-LINE            PIC X(132).                       00340000
      *                                                                 00350000
       WORKING-STORAGE SECTION.                                         00360000
                                                                        00370000
       01  PA-PROGRAM-ACCUMULATORS.                                     00380000
           05  PA-LINE-NO             PIC S9(03)    COMP-3 VALUE ZEROES.00390000
           05  PA-PAGE-COUNT          PIC S9(05)    COMP-3 VALUE ZEROES.00400000
           05  PA-TOTAL-READ          PIC S9(09)    COMP-3 VALUE ZEROES.00410000
           05  PA-TTL-OFF-BALANCE     PIC S9(11)V99 COMP-3 VALUE ZEROES.00420000
           05  PA-TTL-CRRNT-VND-FUND  PIC S9(11)V99 COMP-3 VALUE ZEROES.00430000
           05  PA-TTL-PREV-VND-FUND   PIC S9(11)V99 COMP-3 VALUE ZEROES.00440000
                                                                        00450000
       01  PC-CONSTANTS.                                                00460000
           05  PC-DAKRP113-PGM            PIC  X(08)   VALUE 'DAKRP113'.00470000
           05  PC-MAX-LINES               PIC S9(03)   VALUE 62.        00480010
           05  PC-DASH                    PIC  X(01)   VALUE '-'.       00490000
                                                                        00500000
       01  PM-PROGRAM-MESSAGES.                                         00510000
           05  PM-NO-INPUT-MSG.                                         00520000
               10 FILLER                  PIC  X(55)    VALUE SPACES.   00530000
               10 FILLER                  PIC  X(22)    VALUE           00540000
               '=====> NO INPUT <====='.                                00550000
               10 FILLER                  PIC  X(55)    VALUE SPACES.   00560000
           05  PM-END-RPT-MSG.                                          00570000
               10 FILLER                  PIC  X(52)    VALUE SPACES.   00580000
               10 FILLER                  PIC  X(27)    VALUE           00590000
               '* * *  END OF REPORT  * * *'.                           00600000
               10 FILLER                  PIC  X(53)    VALUE SPACES.   00610000
                                                                        00620000
       01  PS-SWITCHES.                                                 00630000
           05  PS-EOF-EXTRACT-SWITCH      PIC  X(01)    VALUE 'N'.      00640000
               88  PS-EOF-EXTRACT                       VALUE 'Y'.      00650000
           05  PS-FST-REC-SWITCH          PIC  X(01)    VALUE 'N'.      00660000
               88  PS-FST-REC-PROCESSED                 VALUE 'Y'.      00670000
                                                                        00680000
       01  PV-VARIABLES.                                                00690000
           05  PV-DISP-NUMBER             PIC Z,ZZZ,ZZ9.                00700000
           05  PV-HOLD-GMM                PIC X(02)     VALUE SPACES.   00710000
           05  PV-HOLD-DMM                PIC X(02)     VALUE SPACES.   00720000
           05  PV-HOLD-VND-NAME           PIC X(30)     VALUE SPACES.   00721010
           05  PV-HOLD-DEPT-NBR           PIC X(03)     VALUE SPACES.   00740000
           05  PV-TODAYS-DATE-FORMATTED.                                00741007
               10 PV-YEAR                 PIC 99        VALUE ZEROES.   00743009
               10 PV-MONTH                PIC 99        VALUE ZEROES.   00745009
               10 PV-DAY                  PIC 99        VALUE ZEROES.   00747009
       01  PV-ABEND-CODE     COMP  SYNC   PIC S9(04)    VALUE +0000.    00748014
           88  ABEND-4001-SEQUENCE-ERROR                VALUE +4001.    00749014
      ***************************************************************** 00750000
      *  KOHL'S STANDARD FIRST HEADING LINE                             00760000
      ***************************************************************** 00770000
           COPY DPWS132O.                                               00780000
                                                                        00790000
       01  H2-HEADING2.                                                 00800000
           05  FILLER                     PIC X(45) VALUE SPACES.       00810000
           05  H2-HEADING-TITLE           PIC X(43) VALUE               00820000
           'PROFIT ASSISTANCE/AD COOP FUNDING BY VENDOR'.               00830000
           05  FILLER                     PIC X(44) VALUE SPACES.       00840000
                                                                        00850000
       01  H3-HEADING3.                                                 00860000
           05  FILLER                     PIC X(52) VALUE SPACES.       00870000
           05  H3-HEADING-TITLE           PIC X(29) VALUE               00880000
           'AGING OF OUTSTANDING BALANCES'.                             00890000
           05  FILLER                     PIC X(51) VALUE SPACES.       00900000
                                                                        01130000
       01  DH1-DETAIL-HEADING1.                                         01140000
           05  FILLER                     PIC X(58) VALUE SPACES.       01150000
           05  FILLER                     PIC X(17) VALUE 'OFF INVOICE'.01160013
           05  FILLER                     PIC X(04) VALUE SPACES.       01170000
           05  FILLER                     PIC X(17) VALUE 'CURRENT'.    01180013
           05  FILLER                     PIC X(04) VALUE SPACES.       01190000
           05  FILLER                     PIC X(17) VALUE 'PREVIOUS'.   01200013
           05  FILLER                     PIC X(05) VALUE SPACES.       01210013
                                                                        01220000
       01  DH2-DETAIL-HEADING2.                                         01230000
           05  FILLER                     PIC X(02) VALUE SPACES.       01240000
           05  FILLER                     PIC X(30) VALUE 'VENDOR'.     01250000
           05  FILLER                     PIC X(04) VALUE SPACES.       01260000
           05  FILLER                     PIC X(10) VALUE 'VENDOR #'.   01270000
           05  FILLER                     PIC X(04) VALUE SPACES.       01280000
           05  FILLER                     PIC X(04) VALUE 'DEPT'.       01290000
           05  FILLER                     PIC X(04) VALUE SPACES.       01300000
           05  FILLER                     PIC X(17) VALUE 'BALANCE'.    01310013
           05  FILLER                     PIC X(04) VALUE SPACES.       01320000
           05  FILLER                     PIC X(17) VALUE 'QTR'.        01330013
           05  FILLER                     PIC X(04) VALUE SPACES.       01340000
           05  FILLER                     PIC X(17) VALUE 'QTRS'.       01350013
           05  FILLER                     PIC X(05) VALUE SPACES.       01360013
                                                                        01370000
       01  DH3-DETAIL-HEADING3.                                         01380000
           05  FILLER                     PIC X(02) VALUE SPACES.       01390000
           05  FILLER                     PIC X(30) VALUE               01391003
               '------------------------------'.                        01392003
           05  FILLER                     PIC X(04) VALUE SPACES.       01410000
           05  FILLER                     PIC X(10) VALUE '----------'. 01411003
           05  FILLER                     PIC X(04) VALUE SPACES.       01430000
           05  FILLER                     PIC X(04) VALUE '----'.       01431003
           05  FILLER                     PIC X(04) VALUE SPACES.       01450000
           05  FILLER                     PIC X(17) VALUE               01451013
               '-----------------'.                                     01452013
           05  FILLER                     PIC X(04) VALUE SPACES.       01470000
           05  FILLER                     PIC X(17) VALUE               01471013
               '-----------------'.                                     01472013
           05  FILLER                     PIC X(04) VALUE SPACES.       01490000
           05  FILLER                     PIC X(17) VALUE               01491013
               '-----------------'.                                     01492013
           05  FILLER                     PIC X(05) VALUE SPACES.       01510013
                                                                        01520000
       01  DL1-DETAIL-LINE1.                                            01530000
           05  FILLER                     PIC X(02) VALUE SPACES.       01540000
           05  DL1-VENDOR-NAME            PIC X(30) VALUE SPACES.       01550000
           05  FILLER                     PIC X(04) VALUE SPACES.       01560000
           05  DL1-VENDOR-NUMBER          PIC X(10) VALUE ZEROES.       01570000
           05  FILLER                     PIC X(05) VALUE SPACES.       01580005
           05  DL1-DEPT-NUMBER            PIC 9(03) VALUE ZEROES.       01590005
           05  FILLER                     PIC X(04) VALUE SPACES.       01600000
           05  DL1-OFF-INVOICE-BAL        PIC ZZ,ZZZ,ZZZ,ZZ9.99.        01610013
           05  FILLER                     PIC X(04) VALUE SPACES.       01620000
           05  DL1-CURRENT-QTR            PIC ZZ,ZZZ,ZZZ,ZZ9.99.        01630013
           05  FILLER                     PIC X(04) VALUE SPACES.       01640000
           05  DL1-PREVIOUS-QTR           PIC ZZ,ZZZ,ZZZ,ZZ9.99.        01650013
           05  FILLER                     PIC X(05) VALUE SPACES.       01660013
                                                                        01670000
       01  TL1-TOTAL-LINE1.                                             01680000
           05  FILLER                     PIC X(02) VALUE SPACES.       01690000
           05  FILLER                     PIC X(11) VALUE 'GRAND TOTAL'.01700000
           05  FILLER                     PIC X(45) VALUE SPACES.       01710000
           05  TL1-OFF-INVOICE-BAL        PIC ZZ,ZZZ,ZZZ,ZZ9.99.        01720013
           05  FILLER                     PIC X(04) VALUE SPACES.       01730000
           05  TL1-CURRENT-QTR            PIC ZZ,ZZZ,ZZZ,ZZ9.99.        01740013
           05  FILLER                     PIC X(04) VALUE SPACES.       01750000
           05  TL1-PREVIOUS-QTR           PIC ZZ,ZZZ,ZZZ,ZZ9.99.        01760013
           05  FILLER                     PIC X(05) VALUE SPACES.       01770013
                                                                        01780000
      ****************************************************************  01790000
      * DARD106 COPYBOOK                                                01800000
      ****************************************************************  01810000
           COPY DARD106.                                                01820000
                                                                        01830000
      *                                                                 01840000
       PROCEDURE DIVISION.                                              01850000
                                                                        01860000
      ******************************************************************01870000
      * 0000-DAKRP113.                                                  01880000
      ******************************************************************01890000
       0000-DAKRP113.                                                   01900000
                                                                        01910000
           PERFORM 1000-INITIALIZE                                      01920000
                                                                        01930000
           PERFORM 2000-PROCESS-EXTRACT                                 01940000
               UNTIL PS-EOF-EXTRACT.                                    01950000
                                                                        01960000
           PERFORM 9900-EOJ.                                            01970000
                                                                        01980000
           GOBACK.                                                      01990000
                                                                        02000000
      ******************************************************************02010000
      * 1000-INITIALIZE.                                                02020000
      ******************************************************************02030000
       1000-INITIALIZE.                                                 02040000
                                                                        02050000
           OPEN INPUT  INPUT-FILE.                                      02060000
           OPEN OUTPUT REPORT-FILE.                                     02070000
                                                                        02080000
           PERFORM 9000-READ-EXTRACT.                                   02090000
           IF PS-EOF-EXTRACT                                            02100000
               DISPLAY 'NO DA INPUT -- REPORT WILL BE EMPTY'            02110000
           END-IF.                                                      02120000
                                                                        02130000
      ******************************************************************02140000
      * 2000-PROCESS-EXTRACT.                                           02150000
      ******************************************************************02160000
       2000-PROCESS-EXTRACT.                                            02170000
                                                                        02180000
           IF PS-FST-REC-PROCESSED                                      02190000
               PERFORM 3000-ACCUM-VENDOR-TOTALS                         02190101
               PERFORM 4000-PRINT-DETAIL-LINE                           02230001
           ELSE                                                         02300000
               PERFORM 6000-WRITE-REPORT-HEADING                        02320000
               MOVE DA106-CRRNT-AVL-COST-AMT TO PA-TTL-CRRNT-VND-FUND   02330000
               MOVE DA106-PREV-AVL-COST-AMT  TO PA-TTL-PREV-VND-FUND    02340000
               PERFORM 4000-PRINT-DETAIL-LINE                           02350000
               MOVE 'Y' TO PS-FST-REC-SWITCH                            02351005
           END-IF.                                                      02360000
                                                                        02370000
           PERFORM 3200-HOLD-DA106-RECORD.                              02380000
           PERFORM 9000-READ-EXTRACT.                                   02390000
                                                                        02400000
      ******************************************************************02410000
      * 3000-ACCUM-VENDOR-TOTALS.                                       02420001
      ******************************************************************02430000
       3000-ACCUM-VENDOR-TOTALS.                                        02440001
           COMPUTE PA-TTL-CRRNT-VND-FUND =                              02450000
               DA106-CRRNT-AVL-COST-AMT + PA-TTL-CRRNT-VND-FUND.        02460000
           COMPUTE PA-TTL-PREV-VND-FUND =                               02470000
               DA106-PREV-AVL-COST-AMT + PA-TTL-PREV-VND-FUND.          02480000
                                                                        02490000
      ******************************************************************02500000
      * 3200-HOLD-DA106-RECORD.                                         02510000
      ******************************************************************02520000
       3200-HOLD-DA106-RECORD.                                          02530000
           MOVE DA106-VENDOR-NAME TO PV-HOLD-VND-NAME.                  02560012
           MOVE DA106-DEPT-NBR    TO PV-HOLD-DEPT-NBR.                  02570012
                                                                        02580000
      ******************************************************************02590000
      * 4000-PRINT-DETAIL-LINE.                                         02600000
      ******************************************************************02610000
       4000-PRINT-DETAIL-LINE.                                          02620000
           COMPUTE PA-TTL-OFF-BALANCE =                                 02630000
               DA106-CRRNT-AVL-COST-AMT + DA106-PREV-AVL-COST-AMT.      02640000
                                                                        02650000
           IF DA106-VENDOR-NAME = PV-HOLD-VND-NAME                      02651010
               IF DA106-DEPT-NBR = PV-HOLD-DEPT-NBR                     02670000
                   DISPLAY '** ABEND **'                                02671014
                   DISPLAY '** PROGRAM DAKRP111 **'                     02672014
                   DISPLAY '** INCORRECT SORTING SEQUENCE'              02673014
                   MOVE +4001 TO PV-ABEND-CODE                          02674014
                   PERFORM 9999-ABEND                                   02675014
               ELSE                                                     02690000
                   MOVE SPACES                   TO DL1-VENDOR-NAME     02700000
                   MOVE SPACES                   TO DL1-VENDOR-NUMBER   02710000
                   MOVE DA106-DEPT-NBR           TO DL1-DEPT-NUMBER     02720000
                   MOVE PA-TTL-OFF-BALANCE       TO DL1-OFF-INVOICE-BAL 02730000
                   MOVE DA106-CRRNT-AVL-COST-AMT TO DL1-CURRENT-QTR     02740000
                   MOVE DA106-PREV-AVL-COST-AMT  TO DL1-PREVIOUS-QTR    02750000
                   PERFORM 7000-WRITE-REPORT-LINE                       02760000
               END-IF                                                   02770000
           ELSE                                                         02780000
               IF PS-FST-REC-PROCESSED                                  02790000
                   PERFORM 7200-WRITE-BLANK-LINE                        02800000
               END-IF                                                   02810000
               MOVE DA106-VENDOR-NAME        TO DL1-VENDOR-NAME         02820000
               MOVE DA106-VENDOR-NBR         TO DL1-VENDOR-NUMBER       02830000
               MOVE DA106-DEPT-NBR           TO DL1-DEPT-NUMBER         02840000
               MOVE PA-TTL-OFF-BALANCE       TO DL1-OFF-INVOICE-BAL     02850000
               MOVE DA106-CRRNT-AVL-COST-AMT TO DL1-CURRENT-QTR         02860000
               MOVE DA106-PREV-AVL-COST-AMT  TO DL1-PREVIOUS-QTR        02870000
               PERFORM 7000-WRITE-REPORT-LINE                           02880000
           END-IF.                                                      02890000
                                                                        02900000
      ******************************************************************02910000
      * 5000-PRINT-VENDOR-TOTALS.                                       02920001
      ******************************************************************02930000
       5000-PRINT-VENDOR-TOTALS.                                        02940001
                                                                        02950000
           COMPUTE PA-TTL-OFF-BALANCE =                                 02960000
               PA-TTL-CRRNT-VND-FUND + PA-TTL-PREV-VND-FUND.            02970000
                                                                        02980000
           MOVE PA-TTL-OFF-BALANCE    TO TL1-OFF-INVOICE-BAL.           02990000
           MOVE PA-TTL-CRRNT-VND-FUND TO TL1-CURRENT-QTR.               03000000
           MOVE PA-TTL-PREV-VND-FUND  TO TL1-PREVIOUS-QTR.              03010000
           PERFORM 8000-WRITE-TOTAL-LINE.                               03020000
                                                                        03030000
      ******************************************************************03120000
      * 6000-WRITE-REPORT-HEADING                                      *03130000
      ******************************************************************03140000
       6000-WRITE-REPORT-HEADING.                                       03150000
                                                                        03160000
      * HEADING LINE1                                                   03170000
           MOVE ZEROES                         TO PA-LINE-NO.           03180000
           ADD 1                               TO PA-PAGE-COUNT.        03190000
           ACCEPT PV-TODAYS-DATE-FORMATTED     FROM DATE.               03191007
           MOVE PV-YEAR                        TO DP132O-RUN-YEAR.      03192007
           MOVE PV-MONTH                       TO DP132O-RUN-MONTH.     03193007
           MOVE PV-DAY                         TO DP132O-RUN-DAY.       03194007
           MOVE SPACES                         TO DP132O-RUN-TIME.      03195009
           MOVE PA-PAGE-COUNT                  TO DP132O-PAGE-NUMBER.   03200000
           MOVE PC-DAKRP113-PGM                TO DP132O-PROGRAM-NAME.  03201008
           MOVE '1'                            TO DP132O-REPORT-NUMBER. 03202007
           MOVE DP132O-STANDRD-HEADER-132-COLS TO REPORT-RECORD.        03210000
           WRITE REPORT-RECORD                                          03220000
               AFTER ADVANCING PAGE.                                    03230000
                                                                        03240000
      * HEADING LINE2                                                   03280000
           MOVE H2-HEADING2 TO REPORT-RECORD.                           03290000
           WRITE REPORT-RECORD                                          03300000
               AFTER ADVANCING 1 LINE.                                  03310000
                                                                        03320000
      * HEADING LINE3                                                   03330000
           MOVE H3-HEADING3 TO REPORT-RECORD.                           03340000
           WRITE REPORT-RECORD                                          03350000
               AFTER ADVANCING 1 LINES.                                 03360000
                                                                        03370000
           PERFORM 7200-WRITE-BLANK-LINE.                               03380004
                                                                        03390004
      * DETAIL HEADING1                                                 03580000
           MOVE DH1-DETAIL-HEADING1 TO REPORT-RECORD.                   03590000
           WRITE REPORT-RECORD                                          03600000
               AFTER ADVANCING 1 LINES.                                 03610000
                                                                        03620000
      * DETAIL HEADING2                                                 03630000
           MOVE DH2-DETAIL-HEADING2 TO REPORT-RECORD.                   03640000
           WRITE REPORT-RECORD                                          03650000
               AFTER ADVANCING 1 LINES.                                 03660000
                                                                        03670000
      * DETAIL HEADING DASH LINE                                        03680000
           MOVE DH3-DETAIL-HEADING3 TO REPORT-RECORD.                   03690000
           WRITE REPORT-RECORD                                          03700000
               AFTER ADVANCING 1 LINES.                                 03710000
                                                                        03720000
           ADD 6 TO PA-LINE-NO.                                         03730004
                                                                        03740000
      ******************************************************************03750000
      * 6200-WRITE-SV-RPT-HEADING                                      *03760000
      ******************************************************************03770000
       6200-WRITE-SV-RPT-HEADING.                                       03780000
                                                                        03790000
      * HEADING LINE1                                                   03800000
           MOVE ZEROES                         TO PA-LINE-NO.           03810000
           ADD 1                               TO PA-PAGE-COUNT.        03820000
           MOVE PA-PAGE-COUNT                  TO DP132O-PAGE-NUMBER.   03830000
           MOVE DP132O-STANDRD-HEADER-132-COLS TO REPORT-RECORD.        03840000
           WRITE REPORT-RECORD                                          03850000
               AFTER ADVANCING PAGE.                                    03860000
                                                                        03870000
      * HEADING LINE2                                                   03910000
           MOVE H2-HEADING2 TO REPORT-RECORD.                           03920000
           WRITE REPORT-RECORD                                          03930000
               AFTER ADVANCING 1 LINE.                                  03940000
                                                                        03950000
      * HEADING LINE3                                                   03960000
           MOVE H3-HEADING3 TO REPORT-RECORD.                           03970000
           WRITE REPORT-RECORD                                          03980000
               AFTER ADVANCING 1 LINES.                                 03990000
                                                                        04000000
           PERFORM 7200-WRITE-BLANK-LINE.                               04010005
                                                                        04020005
      * DETAIL HEADING1                                                 04110000
           MOVE DH1-DETAIL-HEADING1 TO REPORT-RECORD.                   04120000
           WRITE REPORT-RECORD                                          04130000
               AFTER ADVANCING 1 LINES.                                 04140000
                                                                        04150000
      * DETAIL HEADING2                                                 04160000
           MOVE DH2-DETAIL-HEADING2 TO REPORT-RECORD.                   04170000
           WRITE REPORT-RECORD                                          04180000
               AFTER ADVANCING 1 LINES.                                 04190000
                                                                        04200000
      * DETAIL HEADING DASH LINE                                        04210000
           MOVE DH3-DETAIL-HEADING3 TO REPORT-RECORD.                   04220000
           WRITE REPORT-RECORD                                          04230000
               AFTER ADVANCING 1 LINES.                                 04240000
                                                                        04250000
           ADD 6 TO PA-LINE-NO.                                         04260005
                                                                        04270000
      * KEEP THE VENDOR NAME AND NUMBER FOR SAVE HEADING                04270106
           MOVE DA106-VENDOR-NAME        TO DL1-VENDOR-NAME.            04271006
           MOVE DA106-VENDOR-NBR         TO DL1-VENDOR-NUMBER.          04272006
                                                                        04273006
      ******************************************************************04280000
      * 7000-WRITE-REPORT-LINE.                                         04290000
      ******************************************************************04300000
       7000-WRITE-REPORT-LINE.                                          04310000
                                                                        04320000
           IF PA-LINE-NO > PC-MAX-LINES                                 04330000
               PERFORM 6200-WRITE-SV-RPT-HEADING                        04340000
           END-IF.                                                      04350000
                                                                        04360000
           WRITE REPORT-RECORD FROM DL1-DETAIL-LINE1                    04370000
                  AFTER ADVANCING 1 LINES.                              04380000
           ADD 1 TO PA-LINE-NO.                                         04390000
                                                                        04400000
      ******************************************************************04410000
      * 7200-WRITE-BLANK-LINE.                                          04420000
      ******************************************************************04430000
       7200-WRITE-BLANK-LINE.                                           04440000
                                                                        04450000
           IF PA-LINE-NO > PC-MAX-LINES                                 04460000
               PERFORM 6200-WRITE-SV-RPT-HEADING                        04470000
           END-IF.                                                      04480000
                                                                        04490000
           MOVE SPACES TO REPORT-RECORD.                                04500000
           WRITE REPORT-RECORD                                          04510000
               AFTER ADVANCING 1 LINES.                                 04520000
                                                                        04530000
           ADD 1 TO PA-LINE-NO.                                         04540000
                                                                        04550000
      ******************************************************************04560000
      * 8000-WRITE-TOTAL-LINE.                                          04570000
      ******************************************************************04580000
       8000-WRITE-TOTAL-LINE.                                           04590000
                                                                        04600000
           IF PA-LINE-NO > PC-MAX-LINES                                 04610000
               PERFORM 6200-WRITE-SV-RPT-HEADING                        04620000
           END-IF.                                                      04630000
                                                                        04640000
           WRITE REPORT-RECORD FROM TL1-TOTAL-LINE1                     04650000
                  AFTER ADVANCING 2 LINES.                              04660005
           ADD 2 TO PA-LINE-NO.                                         04670005
                                                                        04680000
      *************************************************************     04690000
      *  9000-READ-EXTRACT.                                       *     04700000
      *************************************************************     04710000
       9000-READ-EXTRACT.                                               04720000
           READ INPUT-FILE INTO DA106-AVL-VND-FUND-REC                  04730000
               AT END                                                   04740000
                   SET PS-EOF-EXTRACT TO TRUE                           04750000
               NOT AT END                                               04760000
                   ADD 1 TO PA-TOTAL-READ                               04770000
           END-READ.                                                    04780000
                                                                        04790000
      *************************************************************     04800000
      *  9900-EOJ IS PERFORMED FROM 0000-DAKRP113.                *     04810000
      *************************************************************     04820000
       9900-EOJ.                                                        04830000
                                                                        04840000
           IF PA-TOTAL-READ = ZERO                                      04850000
               WRITE REPORT-RECORD FROM PM-NO-INPUT-MSG                 04860001
                   AFTER ADVANCING 5 LINES                              04870001
           ELSE                                                         04870101
               PERFORM 7200-WRITE-BLANK-LINE 2 TIMES                    04871005
               PERFORM 5000-PRINT-VENDOR-TOTALS                         04872001
           END-IF.                                                      04880000
                                                                        04890000
           WRITE REPORT-RECORD FROM PM-END-RPT-MSG                      04900000
                AFTER ADVANCING 5 LINES                                 04910000
                                                                        04920000
           CLOSE INPUT-FILE.                                            04930000
           CLOSE REPORT-FILE.                                           04940000
                                                                        04950000
           DISPLAY SPACES.                                              04960000
           MOVE PA-TOTAL-READ        TO PV-DISP-NUMBER.                 04970000
           DISPLAY 'RECS READ    =    ' PV-DISP-NUMBER.                 04980000
                                                                        04990000
      *************************************************************     05000014
      * 9999-ABEND.                                               *     05010014
      *************************************************************     05020014
       9999-ABEND.                                                      05030014
                                                                        05040014
           CALL 'ILBOABN0'  USING PV-ABEND-CODE.                        05050014
                                                                        05060014
