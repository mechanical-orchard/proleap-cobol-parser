000100***************************************************************** 00010004
000200 IDENTIFICATION DIVISION.                                         00040002
000300***************************************************************** 00050004
000400                                                                  00060002
000500 PROGRAM-ID.             SUKRP026.                                00070002
000600 AUTHOR.                 PATRICK BURKE.                           00080002
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00090002
000800 DATE-WRITTEN.           APRIL 2001.                              00100002
000900 DATE-COMPILED.                                                   00110002
001000                                                                  00120002
001100***************************************************************** 00121004
001200*  THIS PROGRAM TAKE THE EXTRACT FILE CREATED IN SUKUT048 AND     00122004
001300*  CREATES A REPORT TO LIST THE CARTONS CHECKED IN AND POINTED    00123007
001400*  TO AN INACTIVE PACKSLIP.                                       00123104
001500***************************************************************** 00124004
001600 ENVIRONMENT DIVISION.                                            00140002
001700***************************************************************** 00141004
001800 CONFIGURATION SECTION.                                           00150002
001900 SOURCE-COMPUTER.                        IBM-3090.                00160002
002000 OBJECT-COMPUTER.                        IBM-3090.                00170002
002100 INPUT-OUTPUT SECTION.                                            00180002
002200 FILE-CONTROL.                                                    00190002
002300                                                                  00200002
002400     SELECT EXTRACT-FILE                                          00210012
002500         ASSIGN TO INP01.                                         00220012
002600                                                                  00230002
002700     SELECT REPORT-FILE                                           00240012
002800         ASSIGN TO RPT01.                                         00240112
002900                                                                  00240212
003000***************************************************************** 00241004
003100 DATA DIVISION.                                                   00250002
003200***************************************************************** 00251004
003300 FILE SECTION.                                                    00260002
003400                                                                  00270002
003500 FD  EXTRACT-FILE                                                 00280012
003600     RECORDING MODE IS F                                          00290002
003700     LABEL RECORDS ARE STANDARD                                   00300002
003800     BLOCK CONTAINS 0 RECORDS.                                    00310002
003900 01  EXTRACT-RECORD                   PIC X(150).                 00320012
004000                                                                  00320112
004100 FD  REPORT-FILE                                                  00321012
004200     RECORDING MODE IS F                                          00322012
004300     BLOCK CONTAINS 0 RECORDS.                                    00324012
004400 01  REPORT-RECORD                    PIC X(132).                 00325012
004500/                                                                 00330002
004600***************************************************************** 00331004
004700 WORKING-STORAGE SECTION.                                         00340002
004800***************************************************************** 00341004
004900 01  PS-SWITCHES.                                                 00350002
005000     05  PS-END-OF-CURSOR-SW          PIC X(01) VALUE 'N'.        00380023
005100         88  PS-END-OF-CURSOR                   VALUE 'Y'.        00390023
005200         88  PS-NOT-END-OF-CURSOR               VALUE 'N'.        00400023
005300     05  PS-PRINT-PO-INFO-SW          PIC X(01) VALUE 'N'.        00400154
005400         88  PS-PRINT-PO-INFO                   VALUE 'Y'.        00400223
005500         88  PS-NO-PRINT-PO-INFO                VALUE 'N'.        00400323
005600     05  PS-PRINT-TRIP-ID-SW          PIC X(01) VALUE 'N'.              54
005700         88  PS-PRINT-TRIP-ID                   VALUE 'Y'.              23
005800         88  PS-NO-PRINT-TRIP-ID                VALUE 'N'.              23
005900     05  PS-FIRST-RECORD-SW           PIC X(01) VALUE 'N'.              54
006000         88  PS-FIRST-RECORD                    VALUE 'Y'.              23
006100         88  PS-NOT-FIRST-RECORD                 VALUE 'N'.             23
006200     05  PS-PROCESS-EXTRACT-SW        PIC X(01) VALUE 'N'.              54
006300         88  PS-PROCESS-EXTRACT                 VALUE 'Y'.              23
006400         88  PS-NO-PROCESS-EXTRACT              VALUE 'N'.              23
006500     05  PS-END-OF-INPUT-FILE-SW      PIC X(01) VALUE 'N'.        00401012
006600         88  PS-END-OF-INPUT                    VALUE 'Y'.        00402012
006700         88  PS-NOT-END-OF-INPUT                VALUE 'N'.        00403012
006800     05  PS-PAGE-SW                  PIC X(01) VALUE 'N'.         00409112
006900         88  PS-NEW-PAGE                       VALUE 'Y'.         00409212
007000         88  PS-SAME-PAGE                      VALUE 'N'.         00409312
007100     05  PS-PRINT-LINE-SW             PIC X(01) VALUE 'N'.        00409440
007200         88  PS-PRINT-LINE                      VALUE 'Y'.        00409540
007300                                                                  00410002
007400 01  DK-DB2-KEYS.                                                 00420002
007500     05  DK-CHECK-IN-DATE             PIC X(10).                  00430007
007600     05  DK-TO-DATE                   PIC X(10).                  00440002
007700     05  DK-STR-NBR                   PIC S9(04) COMP VALUE ZERO. 00450002
007800                                                                  00460002
007900 01  ABEND-CODE                       PIC S9(04) VALUE ZERO       00470002
008000                                                 COMP SYNC.       00480002
008100     88  ABEND-4013-DB2-ERROR                        VALUE +4013. 00490002
008200                                                                  00500002
008300 01  PV-DATE-RECORD.                                              00510002
008400     05  PV-FROM-DATE                 PIC X(10) VALUE SPACES.     00520002
008500     05  FILLER                       PIC X(01) VALUE SPACES.     00530002
008600     05  PV-TO-DATE                   PIC X(10) VALUE SPACES.     00540002
008700                                                                  00550002
008800 01  SD-SYSTEM-DATE.                                              00560002
008900     05  SD-SYSTEM-DATE-YY          PIC  9(02)   VALUE ZERO.      00570002
009000     05  SD-SYSTEM-DATE-MM          PIC  9(02)   VALUE ZERO.      00580002
009100     05  SD-SYSTEM-DATE-DD          PIC  9(02)   VALUE ZERO.      00590002
009200                                                                  00600002
009300 01  ST-SYSTEM-TIME.                                              00610002
009400     05  ST-SYSTEM-HOUR             PIC  9(02)   VALUE ZERO.      00620002
009500     05  ST-SYSTEM-MINUTE           PIC  9(02)   VALUE ZERO.      00630002
009600     05  FILLER                     PIC  9(04)   VALUE ZERO.      00640002
009700                                                                  00650002
009800 01  PV-VARIABLES.                                                00660002
009900     05  PV-READ-COUNT                PIC S9(7) COMP-3            00670002
010000                                                VALUE ZERO.       00680002
010100     05  PV-REC-READ-QTY              PIC S9(7) COMP-3            00681012
010200                                                VALUE ZERO.       00682012
010300     05  PV-WRITE-COUNT               PIC S9(7) COMP-3            00690002
010400                                                VALUE ZERO.       00700002
010500     05  PV-PAGE-COUNT                PIC S9(3) COMP-3            00710002
010600                                                VALUE ZERO.       00720002
010700     05  PV-LINE-COUNT                PIC S9(04) VALUE ZERO       00730012
010800                                                 COMP SYNC.       00740012
010900     05  PV-SPACE-COUNT               PIC S9(05) VALUE ZERO       00750002
011000                                                 COMP-3.          00760002
011100     05  PV-CHAR-COUNT                PIC S9(05) VALUE ZERO       00770002
011200                                                 COMP-3.          00780002
011300     05  PV-REMAINDER                 PIC S9(05) VALUE ZERO       00790002
011400                                                 COMP-3.          00800002
011500     05  PV-RESULT                    PIC S9(05)V99 VALUE ZERO    00810002
011600                                                 COMP-3.          00820002
011700     05  PV-STAT-DATE                 PIC X(10) VALUE ZERO.       00830002
011800     05  PV-DB2-FUNCTION              PIC X(30) VALUE SPACES.     00840002
011900     05  PV-PARAGRAPH                 PIC X(30) VALUE SPACES.     00850002
012000     05  PV-DISP-NUMBER               PIC Z,ZZZ,ZZ9.              00860002
012100                                                                  00870002
012200     05  PV-RUN-DATE                  PIC X(10) VALUE SPACES.     00880002
012300     05  PV-SAVE-START-DATE           PIC X(10) VALUE SPACES.     00890002
012400                                                                  00900002
012500     05  PV-SHIPT-UNT-ID            PIC S9(18)V COMP-3 VALUE ZERO.00901012
012600     05  PV-PREV-CARTON-ID          PIC X(18)   VALUE SPACES.     00901162
012700                                                                  00901262
012800     05  PV-TRN-LNE-NBR             PIC S9(09)  COMP VALUE ZERO.  00902062
012900     05  PV-UPC-NBR                 PIC S9(15)V COMP-3 VALUE ZERO.00903012
013000     05  PV-SHPD-QTY                PIC S9(07)  COMP VALUE ZERO.        39
013100                                                                          
013200     05  PV-SCAN-DC-NBR             PIC  S9(4) COMP.                    39
013300     05  PV-PREV-SCAN-DC-NBR        PIC S9(04).                         39
013400     05  PV-SCAN-DC-DESC            PIC X(40)   VALUE SPACES.     00904039
013500     05  PV-TRIP-ID                 PIC X(09).                          39
013600     05  PV-PREV-TRIP-ID            PIC X(09).                          39
013700                                                                  01002012
013800 01  PV-CONTROL-KEYS.                                             01010002
013900     05  PV-PREVIOUS-KEY.                                         01070002
014000         10  PV-PREV-PO-NBR           PIC 9(09) VALUE ZERO.       01080062
014100                                                                  01150002
014200     05  PV-DB2-YEAR                  PIC S9(08) COMP             01160002
014300                                          VALUE ZERO.             01170002
014400     05  PV-DB2-MONTH                 PIC S9(08) COMP             01180002
014500                                          VALUE ZERO.             01190002
014600     05  PV-DB2-DAY                   PIC S9(08) COMP             01200002
014700                                          VALUE ZERO.             01210002
014800     05  PV-DB2-HOUR                  PIC S9(08) COMP             01220002
014900                                          VALUE ZERO.             01230002
015000     05  PV-DB2-MINUTE                PIC S9(08) COMP             01240002
015100                                          VALUE ZERO.             01250002
015200     05  PV-DB2-SECOND                PIC S9(08) COMP             01260002
015300                                          VALUE ZERO.             01270002
015400                                                                  01280002
015500 01  PV-BUCKETS COMP-3.                                           01290002
015600     05  PV-UNIT-TOTAL.                                           01300055
015700         10  PV-TOTAL-UNITS           PIC S9(7) VALUE ZERO.       01310055
015800     05  PV-PO-UNIT-TOTALS.                                       01340055
015900         10  PV-PO-TOTAL-UNITS        PIC S9(7) VALUE ZERO.       01350055
016000     05  PV-PO-CTN-TOTALS.                                        01360055
016100         10  PV-PO-TOTAL-CARTONS      PIC S9(7) VALUE ZERO.       01370055
016200     05  PV-TRIP-UNIT-TOTALS.                                           55
016300         10  PV-TRIP-TOTAL-UNITS       PIC S9(7) VALUE ZERO.            55
016400     05  PV-TRIP-CTN-TOTALS.                                            55
016500         10  PV-TRIP-TOTAL-CARTONS     PIC S9(7) VALUE ZERO.            55
016600     05  PV-SCAN-DC-UNIT-TOTALS.                                        55
016700         10  PV-SCAN-DC-TOTAL-UNITS    PIC S9(7) VALUE ZERO.            55
016800     05  PV-SCAN-DC-CTN-TOTALS.                                         55
016900         10  PV-SCAN-DC-TOTAL-CARTONS  PIC S9(7) VALUE ZERO.            55
017000                                                                  01420012
017100 01  PC-CONSTANTS.                                                01430002
017200     05  PC-SUKUT048                  PIC X(08) VALUE 'SUKUT048'. 01440005
017300     05  PC-CURRENT-PROGRAM-NAME      PIC X(08) VALUE 'SUKRP026'. 01450005
017400     05  PC-END-OF-PAGE               PIC S9(3) COMP-3 VALUE +60. 01470002
017500     05  PC-MAX-LINE-COUNT            PIC S9(3) VALUE +60         01471012
017600                                                COMP-3.           01472012
017700/                                                                 01480002
017800******************************************************************01531012
017900*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               01532012
018000******************************************************************01533012
018100     COPY DPWS132O.                                               01534012
018200*                                                                 01535012
018300 01  HL-HEADING-LINE-1.                                           01540002
018400     05  FILLER                      PIC  X(43)  VALUE            01550002
018500      '                                    LISTING'.                      
018600     05  FILLER                      PIC  X(52)  VALUE            01560002
018700      ' OF CARTONS CHECKED IN POINTING TO INACTIVE PACKSLIP'.           03
018800     05  FILLER                      PIC  X(34)  VALUE SPACES.    01580002
018900                                                                  01590002
019000 01  HL-HEADING-LINE-2.                                           01600002
019100     05  FILLER                      PIC  X(54)  VALUE SPACES.    01610002
019200     05  FILLER                      PIC  X(18)  VALUE            01620003
019300         'CHECK-IN DATE OF '.                                     01630003
019400     05  HL2-CHECK-DATE.                                          01640003
019500         10  HL2-MO                   PIC 99.                     01650002
019600         10  FILLER                   PIC X VALUE '/'.            01660002
019700         10  HL2-DD                   PIC 99.                     01670002
019800         10  FILLER                   PIC X VALUE '/'.            01680002
019900         10  HL2-CCYY                 PIC 9(04).                  01690002
020000     05  FILLER                      PIC  X(54)  VALUE SPACES.    01700002
020100                                                                  01710002
020200 01  HL-HEADING-LINE-3A.                                                  
020300     05  FILLER                      PIC  X(23)  VALUE                    
020400            ' DC SCAN LOCATION:     '.                                    
020500     05  HL3A-SCAN-DC-NBR            PIC  9(04).                          
020600     05  FILLER                      PIC  X(03) VALUE ' - '.              
020700     05  HL3A-SCAN-DC-DESC           PIC  X(40).                          
020800     05  FILLER                      PIC  X(52)  VALUE SPACES.            
020900                                                                          
021000 01  HL-HEADING-LINE-3.                                           01720002
021100     05  FILLER                      PIC  X(44)  VALUE SPACES.    01730004
021200     05  FILLER                      PIC  X(44)  VALUE SPACES.    01740004
021300     05  FILLER                      PIC  X(44)  VALUE            01750004
021400            ' DEST                                       '.       01760062
021500                                                                  01800002
021600 01  HL-HEADING-LINE-4.                                           01810002
021700     05  FILLER                       PIC X(44) VALUE             01820002
021800            '             PO     DEPT                    '.             62
021900     05  FILLER                       PIC X(44) VALUE             01840002
022000            '                                TIME     DC '.             62
022100     05  FILLER                       PIC X(44) VALUE             01860002
022200            ' OPER  LINE                    SHIP         '.             62
022300                                                                  01880002
022400 01  HL-HEADING-LINE-5.                                           01890002
022500     05  FILLER                       PIC X(44) VALUE             01900002
022600            ' TRIP ID   NUMBER   NBR  VENDOR NAME        '.             62
022700     05  FILLER                       PIC X(44) VALUE             01920002
022800            '           VENDOR CARTON ID    SCANNED  ORGN'.             62
022900     05  FILLER                       PIC X(44) VALUE             01940002
023000            ' UNIT  NBR      UPC NUMBER     QTY          '.             62
023100                                                                  01960002
023200                                                                  01970002
023300 01  DL-DETAIL-LINE-1.                                            01980002
023400     05  DL1-TRIP-ID                  PIC X(09).                  02070004
023500     05  FILLER                       PIC X(01) VALUE SPACES.     02080004
023600     05  DL1-PO-NBR                   PIC X(09).                  01990062
023700     05  FILLER                       PIC X(01) VALUE SPACES.     02000004
023800     05  DL1-DEPT-NBR                 PIC X(04).                  02010004
023900     05  FILLER                       PIC X(01) VALUE SPACES.     02020004
024000     05  DL1-VENDOR-NAME              PIC X(28).                  02030004
024100     05  FILLER                       PIC X(01) VALUE SPACES.     02040004
024200     05  DL1-VENDOR-CARTON-ID         PIC X(20).                  02050012
024300     05  FILLER                       PIC X(01) VALUE SPACES.     02060004
024400     05  DL1-TIME-SCANNED.                                        02090004
024500         10  DL1-HH                   PIC 99.                     02092004
024600         10  FILLER                   PIC X(01) VALUE ':'.        02093004
024700         10  DL1-MI                   PIC 99.                     02094004
024800         10  FILLER                   PIC X(01) VALUE ':'.        02095004
024900         10  DL1-SS                   PIC 99.                     02096004
025000     05  FILLER                       PIC X(01) VALUE SPACES.     02100004
025100     05  DL1-DC-ORGN                  PIC 9(04).                  02130004
025200     05  FILLER                       PIC X(01) VALUE SPACES.     02140004
025300     05  DL1-DEST-OPER-UNIT           PIC X(04).                  02150004
025400     05  FILLER                       PIC X(01) VALUE SPACES.     02160004
025500*    05  DL1-STOR-ASGN                PIC 9(04).                  02170004
025600     05  FILLER                       PIC X(01) VALUE SPACES.     02180004
025700     05  DL1-PO-LINE-NBR              PIC 9(04).                  02190011
025800     05  FILLER                       PIC X(01) VALUE SPACES.     02191004
025900     05  DL1-UPC-NUMBER               PIC 9(15).                  02192004
026000     05  FILLER                       PIC X(01) VALUE SPACES.     02193004
026100     05  DL1-SHIP-QTY                 PIC ZZZ,ZZ9.                02194040
026200                                                                  02200002
026300 01  DL-DETAIL-LINE-2.                                            02201035
026400     05  FILLER                       PIC X(095) VALUE SPACES.    02210762
026500     05  DL2-PO-LINE-NBR              PIC 9(04).                  02210835
026600     05  FILLER                       PIC X(01) VALUE SPACES.     02210935
026700     05  DL2-UPC-NUMBER               PIC 9(15).                  02211035
026800     05  FILLER                       PIC X(01) VALUE SPACES.     02211135
026900     05  DL2-SHIP-QTY                 PIC ZZZ,ZZ9.                02211240
027000                                                                  02211335
027100 01  DL-DETAIL-LINE-3.                                            02410002
027200     05  FILLER                       PIC X(11) VALUE SPACES.     02420002
027300     05  FILLER                       PIC X(14) VALUE             02430002
027400            'COMMENTS:     '.                                     02440002
027500     05  DL3-COMMENT-TEXT             PIC X(100).                 02450002
027600                                                                  02460002
027700 01  DL-DETAIL-LINE-4.                                            02470002
027800     05  FILLER                       PIC X(11) VALUE SPACES.     02480002
027900     05  FILLER                       PIC X(14) VALUE SPACES.     02490002
028000     05  DL4-COMMENT-TEXT             PIC X(100).                 02500002
028100                                                                  02510002
028200 01  DL-DETAIL-LINE-5.                                            02520002
028300     05  FILLER                       PIC X(11) VALUE SPACES.     02530002
028400     05  FILLER                       PIC X(14) VALUE SPACES.     02540002
028500     05  DL5-COMMENT-TEXT             PIC X(050).                 02550002
028600                                                                  02560002
028700 01  TL-UNIT-TOT-LINE.                                            02570055
028800     05  FILLER                       PIC X(095) VALUE SPACES.    02580062
028900     05  FILLER                       PIC X(19) VALUE             02600055
029000         'CARTON UNIT TOTAL: '.                                   02610055
029100     05  TL-UNITS                     PIC Z,ZZZ,ZZ9.              02620055
029200     05  FILLER                       PIC X(05) VALUE SPACES.     02630002
029300                                                                  02730002
029400 01  TL-PO-UNIT-TOT-LINE.                                         02740055
029500     05  FILLER                       PIC X(099) VALUE SPACES.    02750062
029600     05  FILLER                       PIC X(15) VALUE             02760056
029700         'PO UNIT TOTAL: '.                                       02770055
029800     05  TL-PO-UNITS                  PIC Z,ZZZ,ZZ9.              02780055
029900     05  FILLER                       PIC X(05) VALUE SPACES.     02790029
030000                                                                  02800029
030100 01  TL-PO-CARTON-TOT-LINE.                                       02810055
030200     05  FILLER                       PIC X(097) VALUE SPACES.    02820062
030300     05  FILLER                       PIC X(17) VALUE             02830055
030400         'PO CARTON TOTAL: '.                                     02840055
030500     05  TL-PO-CARTONS                PIC Z,ZZZ,ZZ9.              02850055
030600     05  FILLER                       PIC X(05) VALUE SPACES.     02860055
030700                                                                  02870055
030800 01  TL-TRIP-UNIT-TOT-LINE.                                       02810055
030900     05  FILLER                       PIC X(097) VALUE SPACES.    02820062
031000     05  FILLER                       PIC X(17) VALUE             02830055
031100         'TRIP UNIT TOTAL: '.                                     02840055
031200     05  TL-TRIP-UNITS                PIC Z,ZZZ,ZZ9.              02850055
031300     05  FILLER                       PIC X(05) VALUE SPACES.     02860055
031400                                                                  02870055
031500 01  TL-TRIP-CARTON-TOT-LINE.                                           55
031600     05  FILLER                       PIC X(095) VALUE SPACES.    02580062
031700     05  FILLER                       PIC X(19) VALUE             02600055
031800         'TRIP CARTON TOTAL: '.                                   02610055
031900     05  TL-TRIP-CARTONS              PIC Z,ZZZ,ZZ9.              02620055
032000     05  FILLER                       PIC X(05) VALUE SPACES.     02630002
032100                                                                  02730002
032200 01  TL-SCAN-DC-UNIT-TOT-LINE.                                          55
032300     05  FILLER                       PIC X(094) VALUE SPACES.    02580062
032400     05  FILLER                       PIC X(20) VALUE             02600055
032500         'SCAN DC UNIT TOTAL: '.                                  02610055
032600     05  TL-SCAN-DC-UNITS             PIC Z,ZZZ,ZZ9.              02620055
032700     05  FILLER                       PIC X(05) VALUE SPACES.     02630002
032800                                                                  02730002
032900 01  TL-SCAN-DC-CARTON-TOT-LINE.                                        55
033000     05  FILLER                       PIC X(092) VALUE SPACES.    02580062
033100     05  FILLER                       PIC X(22) VALUE             02600055
033200         'SCAN DC CARTON TOTAL: '.                                      55
033300     05  TL-SCAN-DC-CARTONS           PIC Z,ZZZ,ZZ9.              02620055
033400     05  FILLER                       PIC X(05) VALUE SPACES.     02630002
033500                                                                  02730002
033600 01  ER-END-OF-REPORT-LINE.                                       02890002
033700     05  FILLER                       PIC X(54)  VALUE SPACES.    02900002
033800     05  FILLER                       PIC X(25)  VALUE            02910002
033900         '**** END OF REPORT ******'.                             02920002
034000     05  FILLER                       PIC X(53)  VALUE SPACES.    02930002
034100                                                                  02940002
034200 01  EP-EMPTY-REPORT-LINE.                                        02950002
034300     05  FILLER                       PIC X(35)  VALUE SPACES.    02960004
034400     05  FILLER                       PIC X(57)  VALUE            02970004
034500     '*** NO CARTONS FOUND POINTING TO AN INACTIVE PACKSLIP ***' .02980012
034600     05  FILLER                       PIC X(50)  VALUE SPACES.    02990004
034700 01  DL-BLANK-LINE                    PIC X(132) VALUE SPACES.    03000002
034800/                                                                 03010002
034900******************************************************************03011004
035000* CORPORATE DATE ROUTINES                                         03020002
035100******************************************************************03021004
035200     COPY DPWS500.                                                03030002
035300/                                                                 03040002
035400******************************************************************03041004
035500*  WORKING STORAGE AREA FOR NAME REFORMAT DPPD024                 03050002
035600******************************************************************03051004
035700*                                                                 03060002
035800     COPY DPWS024.                                                03070002
035900/                                                                 03080002
036000******************************************************************03092005
036100*  RECORD LAYOUT FOR INPUT FILE                                   03093005
036200******************************************************************03094005
036300     COPY SURD016.                                                03100004
036400/                                                                 03101004
036500******************************************************************03102005
036600*  DB2 FORMATTED MESSAGE AREA                                     03103005
036700******************************************************************03104005
036800     COPY DPWS004.                                                03105005
036900/                                                                         
037000*                                                                         
037100*  LOGISTICS DOMAIN LOCATION MODULE                               00010000
037200*                                                                 00020000
037300     COPY XLWS071.                                                00030000
037400/                                                                 03106005
037500******************************************************************03152004
037600*   DB2 SQL COMMUNICATION AREA                                    03153004
037700******************************************************************03154004
037800     EXEC SQL                                                     03170002
037900         INCLUDE SQLCA                                            03180002
038000     END-EXEC.                                                    03190002
038100/                                                                 03200004
038200     COPY SQLCA2.                                                 03210002
038300/                                                                 03220002
038400******************************************************************03221004
038500*   DB2 DCLGEN FOR SHIPMENT UNIT/UPC TABLE.                       03222047
038600******************************************************************03223004
038700     EXEC SQL                                                     03230002
038800          INCLUDE TSHUUPC                                         03240004
038900     END-EXEC.                                                    03250002
039000/                                                                 03260004
039100******************************************************************03280004
039200* CARTON CURSOR                                                   03290004
039300******************************************************************03300004
039400                                                                  03500002
039500     EXEC SQL                                                     03510002
039600         DECLARE CARTON-CSR CURSOR FOR                            03520004
039700     SELECT                                                       03530002
039800         A.TRN_LNE_NBR                                            03540004
039900      ,  A.UPC_NBR                                                03550004
040000      ,  A.SHPD_QTY                                               03560004
040100     FROM                                                         03750004
040200         TSHUUPC A                                                03760004
040300     WHERE                                                        03800002
040400         A.SHIPT_UNT_ID      = :PV-SHIPT-UNT-ID                   03810004
040500     ORDER BY 1                                                   03860004
040600                                                                  03870004
040700     END-EXEC.                                                    03920002
040800/                                                                 03930002
040900******************************************************************03931004
041000 PROCEDURE DIVISION.                                              03940002
041100******************************************************************03941004
041200 0000-MAINLINE.                                                   03960002
041300                                                                  03960110
041400*OPEN FILES.                                                      03961010
041500     OPEN INPUT  EXTRACT-FILE                                     03962012
041600          OUTPUT REPORT-FILE.                                     03963010
041700                                                                  03964010
041800*READ HEADER RECORD.                                              03965015
041900     PERFORM 2100-READ-EXTRACT.                                   03967010
042000     MOVE SU016-SCAN-DATE        TO DK-CHECK-IN-DATE.             03967115
042100                                                                        11
042200                                                                  03968010
042300*READ FIRST DETAIL RECORD.                                        03968115
042400     PERFORM 2100-READ-EXTRACT.                                   03968329
042500     SET PS-FIRST-RECORD    TO TRUE.                                      
042600     IF SU016-PO-NBR = 0                                                  
042700        SET PS-END-OF-INPUT TO TRUE                                       
042800     ELSE                                                                 
042900        MOVE SU016-PO-NBR          TO PV-PREV-PO-NBR                    68
043000        MOVE SU016-SHIPT-UNT-ID    TO PV-PREV-CARTON-ID                 68
043100        MOVE SU016-SCAN-DC-NBR     TO PV-PREV-SCAN-DC-NBR               68
043200        MOVE SU016-TRIP-ID         TO PV-PREV-TRIP-ID                   29
043300                                                                          
043400        INITIALIZE PV-PO-TOTAL-CARTONS                                  68
043500     END-IF.                                                              
043600     PERFORM 1000-INITIALIZE.                                           45
043700                                                                  03968810
043800*PROCESS INPUT FILE.                                              03969010
043900     IF PS-END-OF-INPUT                                           03969110
044000         PERFORM 1300-NO-DETAIL-LINE                              03969210
044100     ELSE                                                         03969310
044200         SET PS-PRINT-PO-INFO      TO TRUE                              55
044300         PERFORM 1950-PROCESS-EXTRACT                             03969510
044400             UNTIL PS-END-OF-INPUT                                03969625
044500        PERFORM 3300-DC-SCAN-TOTALS                                     55
044600     END-IF.                                                      03969910
044700                                                                  03970002
044800     PERFORM 9000-EOJ.                                            04060002
044900                                                                  04083010
045000     GOBACK.                                                      04090002
045100                                                                  04100002
045200******************************************************************04101004
045300 1000-INITIALIZE.                                                 04110002
045400******************************************************************04111004
045500                                                                  04270002
045600* LOAD SYSTEM DATE INTO HEADINGS                                  04280002
045700     ACCEPT SD-SYSTEM-DATE FROM DATE.                             04290002
045800     ACCEPT ST-SYSTEM-TIME FROM TIME.                             04300002
045900                                                                  04310002
046000     MOVE SD-SYSTEM-DATE-YY      TO DP132O-RUN-YEAR.              04320002
046100     MOVE SD-SYSTEM-DATE-MM      TO DP132O-RUN-MONTH.             04330002
046200     MOVE SD-SYSTEM-DATE-DD      TO DP132O-RUN-DAY.               04340002
046300     MOVE ST-SYSTEM-HOUR         TO DP132O-RUN-HOUR.              04350005
046400     MOVE ST-SYSTEM-MINUTE       TO DP132O-RUN-MINUTE.            04360005
046500                                                                  04370002
046600     MOVE PC-CURRENT-PROGRAM-NAME                                 04380002
046700                                 TO DP132O-PROGRAM-NAME.          04390002
046800     MOVE 1                      TO DP132O-REPORT-NUMBER          04400002
046900                                    DP132O-PAGE-NUMBER            04410002
047000                                                                  04470002
047100         PERFORM 8000-WRITE-MAIN-HEADINGS.                        04570029
047200         PERFORM 8100-WRITE-SUB-HEADINGS.                         04580029
047300         INITIALIZE PV-BUCKETS.                                   04590029
047400/                                                                 04610002
047500******************************************************************05431010
047600*  PRINT A 'NO INPUT' REPORT LINE.                                05432010
047700******************************************************************05433010
047800 1300-NO-DETAIL-LINE.                                             05434010
047900                                                                  05435010
048000     WRITE REPORT-RECORD                                          05436012
048100       FROM EP-EMPTY-REPORT-LINE                                  05437012
048200         AFTER ADVANCING 3 LINES.                                 05438010
048300                                                                  05439010
048400******************************************************************      10
048500*  PRINT A BLANK LINE.                                                  10
048600******************************************************************      10
048700 1400-PRINT-BLANK-LINE.                                                 10
048800                                                                          
048900     WRITE REPORT-RECORD FROM DL-BLANK-LINE                             59
049000         AFTER ADVANCING 1 LINE.                                        59
049100     ADD 1                            TO PV-LINE-COUNT.                 59
049200*                                                                       55
049300******************************************************************      28
049400*  CHECK FOR CHANGE IN TRIP ID.                                         28
049500******************************************************************      28
049600 1800-CHECK-TRIP-ID.                                                    28
049700*                                                                       28
049800     IF SU016-TRIP-ID  = PV-PREV-TRIP-ID                                29
049900        SET PS-PROCESS-EXTRACT     TO TRUE                                
050000     ELSE                                                                 
050100        SET PS-NO-PROCESS-EXTRACT  TO TRUE                                
050200        SET PS-PRINT-TRIP-ID       TO TRUE.                               
050300*                                                                       28
050400******************************************************************05440028
050500*  PROCESS DETAIL RECORD: OPEN CURSOR,FETCH AND PRINT FULL DETAIL 05450028
050600*  LINE.                                                          05450128
050700******************************************************************05450228
050800 1900-PROCESS-DETAIL-RECORD.                                            28
050900*                                                                       28
051000     PERFORM 7000-OPEN-CARTON-CURSOR.                                   29
051100     PERFORM 7010-FETCH-CARTON-CURSOR.                                  29
051200     PERFORM 3000-PRINT-DETAILS.                                        29
051300*                                                                       28
051400******************************************************************      23
051500* IF CHANGE IN DC SCAN NUMBER THEN PRINT TOTALS AND START NEW           23
051600*  PAGE AND RESET PAGE NUMBER TO ONE.                                   23
051700******************************************************************      23
051800 1950-PROCESS-EXTRACT.                                                  23
051900*                                                                       23
052000     IF SU016-SCAN-DC-NBR = PV-PREV-SCAN-DC-NBR                         29
052100        PERFORM 1800-CHECK-TRIP-ID                                        
052200          IF PS-PROCESS-EXTRACT                                           
052300            PERFORM 2000-PROCESS-EXTRACT                                  
052400          ELSE                                                            
052500            PERFORM 3200-TRIP-TOTALS                                    55
052600            PERFORM 1400-PRINT-BLANK-LINE                               55
052700            MOVE SU016-TRIP-ID         TO PV-PREV-TRIP-ID               29
052800            MOVE SU016-PO-NBR          TO PV-PREV-PO-NBR                29
052900            SET PS-PRINT-PO-INFO TO TRUE                                55
053000          END-IF                                                        62
053100     ELSE                                                                 
053200        PERFORM 3300-DC-SCAN-TOTALS                                     55
053300        MOVE SU016-SCAN-DC-NBR     TO PV-PREV-SCAN-DC-NBR               29
053400        MOVE SU016-TRIP-ID         TO PV-PREV-TRIP-ID                   29
053500        MOVE SU016-PO-NBR          TO PV-PREV-PO-NBR                    29
053600        MOVE ZERO                  TO PV-PAGE-COUNT                     29
053700        SET PS-NEW-PAGE TO TRUE                                         37
053800        PERFORM 8000-WRITE-MAIN-HEADINGS                                11
053900        PERFORM 8100-WRITE-SUB-HEADINGS                                 28
054000     END-IF.                                                            62
054100*                                                                         
054200******************************************************************05451023
054300 2000-PROCESS-EXTRACT.                                            05452023
054400******************************************************************05453023
054500*                                                                 05454023
054600     IF SU016-PO-NBR   = PV-PREV-PO-NBR                           05455029
054700        PERFORM 1900-PROCESS-DETAIL-RECORD                        05456029
054800        SET PS-NOT-END-OF-CURSOR  TO TRUE                         05457042
054900        PERFORM 2050-FETCH-AND-PRINT                              05461029
055000                UNTIL PS-END-OF-CURSOR                            05470029
055100        PERFORM 7020-CLOSE-CARTON-CSR                             05480031
055200           IF PS-PRINT-LINE                                       05480162
055300             PERFORM 4100-CARTON-UNIT-TOTAL                       05490062
055400             INITIALIZE  PS-PRINT-LINE-SW                         05490162
055500           ELSE                                                   05490262
055600             INITIALIZE PV-TOTAL-UNITS                            05490362
055700           END-IF                                                 05490562
055800        PERFORM 2100-READ-EXTRACT                                 05491037
055900     ELSE                                                         05492029
056000        PERFORM 4200-PO-UNIT-TOTAL                                05493055
056100        PERFORM 4300-PO-CARTON-TOTAL                              05494055
056200        PERFORM 1400-PRINT-BLANK-LINE                                   55
056300        MOVE SU016-PO-NBR            TO PV-PREV-PO-NBR            05500029
056400        SET PS-PRINT-PO-INFO TO TRUE                              05500155
056500     END-IF.                                                      05500229
056600*                                                                 05590021
056700******************************************************************05600023
056800 2050-FETCH-AND-PRINT.                                            05601023
056900******************************************************************05602023
057000*                                                                 05603023
057100         PERFORM 7010-FETCH-CARTON-CURSOR.                        05604037
057200         IF PS-END-OF-CURSOR                                      05604137
057300             CONTINUE                                             05604237
057400         ELSE                                                     05604337
057500             PERFORM 3100-PRINT-LINE                              05605037
057600         END-IF.                                                  05605237
057700*                                                                 05606023
057800******************************************************************05609505
057900*  READ NEXT INPUT FILE RECORD.                                   05609605
058000******************************************************************05609705
058100 2100-READ-EXTRACT.                                               05609805
058200                                                                  05609905
058300     READ EXTRACT-FILE INTO SU016-EXTRACT-RECORD                  05610012
058400        AT END                                                    05610105
058500           SET PS-END-OF-INPUT TO TRUE.                           05610205
058600                                                                  05610305
058700     ADD +1                       TO PV-READ-COUNT                05610428
058800                                     PV-PO-TOTAL-CARTONS          05610555
058900                                     PV-TRIP-TOTAL-CARTONS              55
059000                                     PV-SCAN-DC-TOTAL-CARTONS.          55
059100     MOVE SU016-SHIPT-UNT-ID      TO PV-SHIPT-UNT-ID.             05610629
059200     MOVE SU016-SCAN-DC-NBR       TO PV-SCAN-DC-NBR.                    68
059300                                                                  05610829
059400******************************************************************05610958
059500*  PRINT PO INFORMATION.                                          05611058
059600******************************************************************05611158
059700 2500-PRINT-PO-INFO.                                              05611258
059800*                                                                 05611358
059900     IF PS-PRINT-PO-INFO                                          05611458
060000         SET PS-NO-PRINT-PO-INFO      TO TRUE                     05611558
060100         MOVE SU016-PO-NBR            TO DL1-PO-NBR               05611658
060200         MOVE SU016-DEPT-NBR          TO DL1-DEPT-NBR             05611758
060300         MOVE SU016-VENDOR-NAME       TO DL1-VENDOR-NAME          05611858
060400     ELSE                                                         05611958
060500         MOVE SPACES                  TO DL1-PO-NBR               05612058
060600                                         DL1-DEPT-NBR             05612158
060700                                         DL1-VENDOR-NAME          05612258
060800     END-IF.                                                      05612358
060900*                                                                 05612458
061000******************************************************************05610958
061100*  PRINT TRIP INFORMATION.                                              58
061200******************************************************************05611158
061300 2600-PRINT-TRIP-INFO.                                                  58
061400*                                                                       58
061500     IF  PS-NO-PRINT-TRIP-ID                                            58
061600         MOVE SPACES                TO DL1-TRIP-ID                      58
061700     ELSE                                                               58
061800         MOVE SU016-TRIP-ID         TO PV-PREV-TRIP-ID                  29
061900                                       DL1-TRIP-ID                      35
062000         SET PS-NO-PRINT-TRIP-ID    TO TRUE                             58
062100     END-IF.                                                            58
062200                                                                          
062300     IF PS-FIRST-RECORD                                                 29
062400         INITIALIZE PS-FIRST-RECORD-SW                                  58
062500         MOVE SU016-TRIP-ID         TO PV-PREV-TRIP-ID                  29
062600                                       DL1-TRIP-ID.                     35
062700*                                                                       58
062800******************************************************************05612529
062900*  FILL AND PRINT DETAIL REPORT LINE.                             05612629
063000******************************************************************05612729
063100 3000-PRINT-DETAILS.                                              05612829
063200*                                                                 05612958
063300     PERFORM 2600-PRINT-TRIP-INFO.                                      58
063400     PERFORM 2500-PRINT-PO-INFO.                                        58
063500                                                                          
063600     MOVE SU016-SHIPT-UNT-ID      TO DL1-VENDOR-CARTON-ID.        05614221
063700     MOVE SU016-SCAN-TIME         TO DL1-TIME-SCANNED.            05615011
063800     MOVE SU016-ORIGIN-DC-NBR     TO DL1-DC-ORGN.                 05617011
063900     MOVE SU016-DESTIN-DC-NBR     TO DL1-DEST-OPER-UNIT.          05618011
064000                                                                  05619011
064100     MOVE PV-TRN-LNE-NBR          TO DL1-PO-LINE-NBR.             05620011
064200     MOVE PV-UPC-NBR              TO DL1-UPC-NUMBER.              05630011
064300     MOVE PV-SHPD-QTY             TO DL1-SHIP-QTY.                05640011
064400     ADD  PV-SHPD-QTY             TO PV-TOTAL-UNITS               05641055
064500                                     PV-PO-TOTAL-UNITS            05650055
064600                                     PV-TRIP-TOTAL-UNITS                55
064700                                     PV-SCAN-DC-TOTAL-UNITS.            55
064800*CHECK FOR OVERFLOW.                                              05660011
064900     ADD 1 TO PV-LINE-COUNT.                                      05670011
065000     IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                         05680011
065100         SET PS-NEW-PAGE TO TRUE                                  05690011
065200         PERFORM 8000-WRITE-MAIN-HEADINGS                         05700011
065300         PERFORM 8100-WRITE-SUB-HEADINGS                          05701028
065400     END-IF.                                                      05710011
065500                                                                  05720011
065600*IF NEW PAGE, DISPLAY CHECK-IN DATE.                              05730011
065700     IF PS-NEW-PAGE                                               05740011
065800         MOVE DK-CHECK-IN-DATE        TO HL2-CHECK-DATE           05750011
065900         MOVE SU016-SCAN-DC-NBR       TO HL3A-SCAN-DC-NBR               11
066000         MOVE SU016-TRIP-ID           TO DL1-TRIP-ID                    35
066100         MOVE SU016-PO-NBR            TO DL1-PO-NBR               05760055
066200         MOVE SU016-DEPT-NBR          TO DL1-DEPT-NBR             05770055
066300         MOVE SU016-VENDOR-NAME       TO DL1-VENDOR-NAME          05770155
066400         SET PS-SAME-PAGE             TO TRUE                     05770211
066500     END-IF.                                                      05770311
066600                                                                  05780011
066700*WRITE DETAIL LINE.                                               05790011
066800     WRITE REPORT-RECORD                                          05800012
066900       FROM DL-DETAIL-LINE-1                                      05810012
067000         AFTER ADVANCING 1 LINES.                                 05820011
067100*                                                                 05830021
067200******************************************************************05831021
067300 3100-PRINT-LINE.                                                 05832021
067400******************************************************************05833021
067500*                                                                 05834021
067600     MOVE PV-TRN-LNE-NBR          TO DL2-PO-LINE-NBR.             05850035
067700     MOVE PV-UPC-NBR              TO DL2-UPC-NUMBER.              05860035
067800     MOVE PV-SHPD-QTY             TO DL2-SHIP-QTY.                05870035
067900     SET PS-PRINT-LINE            TO TRUE.                        05881040
068000                                                                  05890031
068100*CHECK FOR OVERFLOW.                                              05890137
068200     ADD 1 TO PV-LINE-COUNT.                                      05890237
068300     IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                         05890337
068400         SET PS-NEW-PAGE TO TRUE                                  05890437
068500         PERFORM 8000-WRITE-MAIN-HEADINGS                         05890537
068600         PERFORM 8100-WRITE-SUB-HEADINGS                          05890637
068700     END-IF.                                                      05890737
068800                                                                  05890837
068900*IF NEW PAGE, DISPLAY CHECK-IN DATE.                              05891037
069000     IF PS-NEW-PAGE                                               05892037
069100         MOVE DK-CHECK-IN-DATE              TO HL2-CHECK-DATE     05893037
069200         MOVE SU016-SCAN-DC-NBR             TO HL3A-SCAN-DC-NBR         11
069300         SET PS-SAME-PAGE                   TO TRUE               05894037
069400         SET PS-PRINT-PO-INFO               TO TRUE               05894155
069500         SET PS-PRINT-TRIP-ID               TO TRUE               05894155
069600         PERFORM 3000-PRINT-DETAILS                               05894360
069700     ELSE                                                         05894437
069800         ADD  PV-SHPD-QTY         TO PV-TOTAL-UNITS               05894561
069900                                     PV-PO-TOTAL-UNITS            05894661
070000                                     PV-TRIP-TOTAL-UNITS                  
070100                                     PV-SCAN-DC-TOTAL-UNITS               
070200         WRITE REPORT-RECORD                                      05894737
070300            FROM DL-DETAIL-LINE-2                                 05894837
070400         AFTER ADVANCING 1 LINES                                  05894937
070500     END-IF.                                                      05895037
070600*                                                                 05940031
070700******************************************************************07051011
070800 3200-TRIP-TOTALS.                                                      62
070900******************************************************************07061011
071000*                                                                       11
071100     PERFORM 4200-PO-UNIT-TOTAL.                                        55
071200     PERFORM 4300-PO-CARTON-TOTAL.                                      55
071300     PERFORM 4400-TRIP-UNIT-TOTAL.                                      55
071400     PERFORM 4500-TRIP-CARTON-TOTAL.                                    55
071500*                                                                       11
071600******************************************************************      11
071700 3300-DC-SCAN-TOTALS.                                                   62
071800******************************************************************      11
071900*                                                                       11
072000     PERFORM 4200-PO-UNIT-TOTAL.                                        55
072100     PERFORM 4300-PO-CARTON-TOTAL.                                      55
072200     PERFORM 4400-TRIP-UNIT-TOTAL.                                      55
072300     PERFORM 4500-TRIP-CARTON-TOTAL.                                    55
072400     PERFORM 4600-SCAN-DC-UNIT-TOTAL.                                   55
072500     PERFORM 4700-SCAN-DC-CARTON-TOTAL.                                 55
072600*                                                                       11
072700******************************************************************07051011
072800 4100-CARTON-UNIT-TOTAL.                                          07060062
072900******************************************************************07061011
073000*                                                                 07062011
073100     MOVE PV-TOTAL-UNITS              TO TL-UNITS                 07090055
073200                                                                  07100002
073300     WRITE REPORT-RECORD FROM TL-UNIT-TOT-LINE                    07110055
073400         AFTER ADVANCING 1 LINE.                                  07120021
073500     ADD 1                            TO PV-LINE-COUNT            07130021
073600     INITIALIZE PV-TOTAL-UNITS.                                   07170055
073700                                                                          
073800*                                                                 07180011
073900******************************************************************07190029
074000 4200-PO-UNIT-TOTAL.                                              07200055
074100******************************************************************07210029
074200*                                                                 07220029
074300     MOVE PV-PO-TOTAL-UNITS             TO TL-PO-UNITS            07230055
074400                                                                  07240029
074500     WRITE REPORT-RECORD FROM TL-PO-UNIT-TOT-LINE                 07250055
074600         AFTER ADVANCING 1 LINE.                                  07260029
074700     ADD 1                            TO PV-LINE-COUNT            07270029
074800     INITIALIZE PV-PO-TOTAL-UNITS                                 07280055
074900                PV-TOTAL-UNITS.                                   07280155
075000                                                                          
075100*                                                                 07280229
075200******************************************************************07280355
075300 4300-PO-CARTON-TOTAL.                                            07280455
075400******************************************************************07280555
075500*                                                                 07280655
075600     MOVE PV-PO-TOTAL-CARTONS      TO TL-PO-CARTONS                     55
075700                                                                  07280855
075800     WRITE REPORT-RECORD FROM TL-PO-CARTON-TOT-LINE               07280955
075900         AFTER ADVANCING 1 LINE.                                  07281055
076000     ADD 1                            TO PV-LINE-COUNT            07281155
076100     INITIALIZE PV-PO-TOTAL-CARTONS.                              07281255
076200                                                                  07281355
076300*                                                                 07281755
076400******************************************************************07280355
076500 4400-TRIP-UNIT-TOTAL.                                            07280455
076600******************************************************************07280555
076700*                                                                 07280655
076800     MOVE PV-TRIP-TOTAL-UNITS      TO TL-TRIP-UNITS                     55
076900                                                                  07280855
077000     WRITE REPORT-RECORD FROM TL-TRIP-UNIT-TOT-LINE                     55
077100         AFTER ADVANCING 1 LINE.                                  07281055
077200     ADD 1                            TO PV-LINE-COUNT            07281155
077300     INITIALIZE PV-TRIP-TOTAL-UNITS.                              07281255
077400                                                                  07281355
077500*                                                                 07281755
077600******************************************************************07280355
077700 4500-TRIP-CARTON-TOTAL.                                                55
077800******************************************************************07280555
077900*                                                                 07280655
078000     MOVE PV-TRIP-TOTAL-CARTONS       TO TL-TRIP-CARTONS                55
078100                                                                  07280855
078200     WRITE REPORT-RECORD FROM TL-TRIP-CARTON-TOT-LINE                   55
078300         AFTER ADVANCING 1 LINE.                                  07281055
078400     ADD 1                            TO PV-LINE-COUNT            07281155
078500     INITIALIZE PV-TRIP-TOTAL-CARTONS.                            07281255
078600                                                                  07281355
078700*                                                                 07281755
078800******************************************************************07280355
078900 4600-SCAN-DC-UNIT-TOTAL.                                               55
079000******************************************************************07280555
079100*                                                                 07280655
079200     MOVE PV-SCAN-DC-TOTAL-UNITS        TO TL-SCAN-DC-UNITS             55
079300                                                                  07280855
079400     WRITE REPORT-RECORD FROM TL-SCAN-DC-UNIT-TOT-LINE                  55
079500         AFTER ADVANCING 1 LINE.                                  07281055
079600     ADD 1                            TO PV-LINE-COUNT            07281155
079700     INITIALIZE PV-SCAN-DC-TOTAL-UNITS.                           07281255
079800                                                                          
079900*                                                                 07281755
080000******************************************************************07280355
080100 4700-SCAN-DC-CARTON-TOTAL.                                             55
080200******************************************************************07280555
080300*                                                                 07280655
080400     MOVE PV-SCAN-DC-TOTAL-CARTONS    TO TL-SCAN-DC-CARTONS             55
080500                                                                  07280855
080600     WRITE REPORT-RECORD FROM TL-SCAN-DC-CARTON-TOT-LINE                55
080700         AFTER ADVANCING 1 LINE.                                  07281055
080800     ADD 1                            TO PV-LINE-COUNT            07281155
080900     INITIALIZE PV-SCAN-DC-TOTAL-CARTONS.                         07281255
081000                                                                  07281355
081100     WRITE REPORT-RECORD FROM DL-BLANK-LINE                       07281459
081200         AFTER ADVANCING 1 LINE.                                  07281559
081300     ADD 1                            TO PV-LINE-COUNT.           07281659
081400*                                                                 07281755
081500******************************************************************07282055
081600 7000-OPEN-CARTON-CURSOR.                                         07290004
081700******************************************************************07291004
081800     EXEC SQL                                                     07300002
081900         OPEN CARTON-CSR                                          07310004
082000     END-EXEC.                                                    07320002
082100                                                                  07330002
082200     EVALUATE TRUE                                                07340002
082300         WHEN SQLCODE = ZERO                                      07350002
082400             CONTINUE                                             07360002
082500         WHEN SQLCODE < ZERO                                      07370002
082600             MOVE '7000-OPEN-CARTON-CURSOR '                      07380004
082700                                      TO PV-PARAGRAPH             07390002
082800             MOVE 'OPEN'              TO PV-DB2-FUNCTION          07400002
082900             PERFORM 9200-SQL-ERROR                               07410002
083000         WHEN SQLCODE > ZERO                                      07420002
083100         WHEN SQLWARN0 NOT = SPACES                               07430002
083200             MOVE '7000-OPEN-CARTON-CURSOR '                      07440004
083300                                      TO PV-PARAGRAPH             07450002
083400             MOVE 'OPEN'              TO PV-DB2-FUNCTION          07460002
083500             PERFORM 9300-SQL-WARNING                             07470002
083600     END-EVALUATE.                                                07480002
083700/                                                                 07490002
083800******************************************************************07491004
083900 7010-FETCH-CARTON-CURSOR.                                        07500004
084000******************************************************************07501004
084100                                                                  07502004
084200     INITIALIZE DCLTSHUUPC.                                       07503017
084300                                                                  07504017
084400     EXEC SQL                                                     07510002
084500     FETCH CARTON-CSR                                             07520004
084600     INTO                                                         07530002
084700        :SHUUPC-TRN-LNE-NBR                                       07540004
084800      , :SHUUPC-UPC-NBR                                           07550004
084900      , :SHUUPC-SHPD-QTY                                          07560004
085000                                                                  07750002
085100     END-EXEC.                                                    07760002
085200                                                                  07770002
085300     EVALUATE TRUE                                                07780002
085400         WHEN SQLCODE = ZERO                                      07790002
085500             MOVE SHUUPC-TRN-LNE-NBR  TO PV-TRN-LNE-NBR           07800004
085600             MOVE SHUUPC-UPC-NBR      TO PV-UPC-NBR               07810004
085700             MOVE SHUUPC-SHPD-QTY     TO PV-SHPD-QTY              07820004
085800             ADD 1                    TO PV-READ-COUNT            07860002
085900         WHEN SQLCODE = +100                                      07870002
086000             SET PS-END-OF-CURSOR    TO TRUE                      07880023
086100         WHEN SQLCODE < ZERO                                      07890002
086200             MOVE '7010-FETCH-CARTON-CURSOR '                     07900004
086300                                      TO PV-PARAGRAPH             07910002
086400             MOVE 'FETCH'             TO PV-DB2-FUNCTION          07920002
086500             PERFORM 9200-SQL-ERROR                               07930002
086600         WHEN SQLCODE > ZERO                                      07940002
086700         WHEN SQLWARN0 NOT = SPACES                               07950002
086800             MOVE '7010-FETCH-CARTON-CURSOR '                     07960004
086900                                      TO PV-PARAGRAPH             07970002
087000             MOVE 'FETCH'             TO PV-DB2-FUNCTION          07980002
087100             PERFORM 9300-SQL-WARNING                             07990002
087200     END-EVALUATE.                                                08000002
087300/                                                                 08010002
087400******************************************************************08011004
087500 7020-CLOSE-CARTON-CSR.                                           08020004
087600******************************************************************08021004
087700*                                                                 08022004
087800     EXEC SQL                                                     08030002
087900     CLOSE CARTON-CSR                                             08040004
088000     END-EXEC                                                     08050002
088100                                                                  08060002
088200     EVALUATE TRUE                                                08070002
088300         WHEN SQLCODE = ZERO                                      08080002
088400             CONTINUE                                             08090002
088500         WHEN SQLCODE < ZERO                                      08100002
088600             MOVE '7020-CLOSE-CARTON-CURSOR '                     08110004
088700                                      TO PV-PARAGRAPH             08120002
088800             MOVE 'CLOSE'             TO PV-DB2-FUNCTION          08130002
088900             PERFORM 9200-SQL-ERROR                               08140002
089000         WHEN SQLCODE > ZERO                                      08150002
089100         WHEN SQLWARN0 NOT = SPACES                               08160002
089200             MOVE '7020-CLOSE-CARTON-CURSOR '                     08170004
089300                                      TO PV-PARAGRAPH             08180002
089400             MOVE 'CLOSE'             TO PV-DB2-FUNCTION          08190002
089500             PERFORM 9300-SQL-WARNING                             08200002
089600     END-EVALUATE.                                                08210002
089700                                                                  08220002
089800******************************************************************        
089900 7400-SELECT-DC-SCAN-DESC.                                                
090000******************************************************************        
090100                                                                  00040001
090200     INITIALIZE XL071-COMMAREA-REC.                               00050001
090300     MOVE PV-SCAN-DC-NBR        TO XL071-LOCATION-NUMBER          00060001
090400                                                                  00070001
090500     CALL XL071-LOCATION-MODULE USING XL071-COMMAREA-REC.         00080001
090600                                                                  00090001
090700     EVALUATE TRUE                                                00100001
090800     WHEN XL071-NO-ERRORS                                         00110001
090900         MOVE XL071-LOC-NM          TO PV-SCAN-DC-DESC                    
091000     WHEN XL071-LOC-NOT-FOUND                                     00120001
091100     WHEN XL071-DC-ASGMT-NOT-FND                                  00130001
091200         MOVE 'UNKNOWN'             TO PV-SCAN-DC-DESC                    
091300     WHEN XL071-BAD-DB2-RETURN                                    00150001
091400         DISPLAY 'CALL LOCATION MOD '                             00170001
091500         DISPLAY 'XLT00010'                                       00180001
091600         MOVE XL071-SQLCA             TO SQLCA                    00190001
091700         MOVE '7400-SELECT-DC-SCAN-DESC'                                  
091800                                      TO PV-PARAGRAPH                     
091900         MOVE 'SELECT'            TO PV-DB2-FUNCTION                      
092000         PERFORM 9200-SQL-ERROR                                           
092100     END-EVALUATE.                                                00210001
092200/                                                                         
092300******************************************************************09111004
092400 8000-WRITE-MAIN-HEADINGS.                                        09120002
092500******************************************************************09121004
092600     MOVE DK-CHECK-IN-DATE            TO HL2-CHECK-DATE.          09150007
092700     MOVE SU016-SCAN-DC-NBR           TO HL3A-SCAN-DC-NBR.              11
092800     PERFORM 7400-SELECT-DC-SCAN-DESC.                                    
092900     MOVE PV-SCAN-DC-DESC             TO HL3A-SCAN-DC-DESC.             11
093000                                                                          
093100     ADD 1                            TO PV-PAGE-COUNT.           09160002
093200     MOVE PV-PAGE-COUNT               TO DP132O-PAGE-NUMBER.      09170002
093300     MOVE ZERO                        TO PV-LINE-COUNT            09180012
093400                                                                  09190002
093500     WRITE REPORT-RECORD FROM DP132O-STANDRD-HEADER-132-COLS      09200002
093600                 AFTER ADVANCING PAGE                             09210002
093700                                                                  09220002
093800     WRITE REPORT-RECORD FROM HL-HEADING-LINE-1                   09230002
093900        AFTER ADVANCING 2 LINES.                                  09240002
094000     WRITE REPORT-RECORD FROM HL-HEADING-LINE-2                   09250002
094100        AFTER ADVANCING 1 LINES.                                  09260002
094200     ADD 3                            TO PV-LINE-COUNT.           09270012
094300*                                                                 09280018
094400******************************************************************09290018
094500 8100-WRITE-SUB-HEADINGS.                                         09300018
094600******************************************************************09310018
094700                                                                  09360018
094800     WRITE REPORT-RECORD FROM HL-HEADING-LINE-3A                  09400018
094900        AFTER ADVANCING 1 LINES.                                  09410018
095000                                                                  09411018
095100     WRITE REPORT-RECORD FROM HL-HEADING-LINE-3                   09400018
095200        AFTER ADVANCING 2 LINES.                                  09410018
095300                                                                  09411018
095400     WRITE REPORT-RECORD FROM HL-HEADING-LINE-4                   09420018
095500        AFTER ADVANCING 1 LINES.                                  09430018
095600                                                                  09431018
095700     WRITE REPORT-RECORD FROM HL-HEADING-LINE-5                   09432018
095800        AFTER ADVANCING 1 LINES.                                  09433018
095900     ADD 5                            TO PV-LINE-COUNT.           09440018
096000*                                                                 09450018
096100******************************************************************09461004
096200 9000-EOJ.                                                        09470002
096300******************************************************************09471004
096400                                                                  09480002
096500     WRITE REPORT-RECORD FROM ER-END-OF-REPORT-LINE               09530002
096600        AFTER ADVANCING 2 LINES.                                  09540002
096700                                                                  09550002
096800*CLOSE FILES.                                                     09561010
096900     CLOSE EXTRACT-FILE                                           09562012
097000           REPORT-FILE.                                           09563012
097100/                                                                 09570002
097200******************************************************************09571004
097300 9100-ABEND.                                                      09580002
097400******************************************************************09581004
097500     IF PS-NOT-END-OF-CURSOR                                      09590024
097600         PERFORM 7020-CLOSE-CARTON-CSR                            09600004
097700     END-IF.                                                      09610002
097800                                                                  09620002
097900     MOVE +4013                       TO ABEND-CODE.              09630002
098000     CALL 'ILBOABN0' USING ABEND-CODE.                            09640002
098100                                                                  09650002
098200******************************************************************09651004
098300 9200-SQL-ERROR.                                                  09660002
098400******************************************************************09661004
098500                                                                  09670002
098600     MOVE SQLCODE                     TO SQLCODE2.                09680002
098700     MOVE SQLERRD(3)                  TO SQLERRD3.                09690002
098800                                                                  09700002
098900     DISPLAY '** ABEND **         ** = SQLERROR'.                 09710002
099000     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        09720002
099100     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH.                   09730002
099200     DISPLAY '** OPERATION ** = ' PV-DB2-FUNCTION.                09740002
099300                                                                  09750002
099400     DISPLAY '** SQLCODE          ** = ' SQLCODE2.                09760002
099500     DISPLAY '** ROWS PROCESSED   ** = ' SQLERRD3.                09770002
099600     DISPLAY '** SQLERRM          ** = ' SQLERRM.                 09780002
099700     DISPLAY '** SQLERRMC         ** = ' SQLERRMC.                09790002
099800                                                                  09800002
099900                                                                  09810002
100000     MOVE +4013                       TO ABEND-CODE.              09820002
100100     CALL 'ILBOABN0' USING ABEND-CODE.                            09830002
100200                                                                  09840002
100300******************************************************************09841004
100400 9300-SQL-WARNING.                                                09850002
100500******************************************************************09851004
100600                                                                  09860002
100700     DISPLAY '9300-SQL-WARNING'.                                  09870002
100800     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        09880002
100900     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH.                   09890002
101000     DISPLAY '** OPERATION ** = ' PV-DB2-FUNCTION.                09900002
101100                                                                  09910002
101200     MOVE SQLCODE                     TO SQLCODE2.                09920002
101300     MOVE SQLERRD(3)                  TO SQLERRD3.                09930002
101400     DISPLAY '** ABEND **       ** = SQLWARNING'.                 09940002
101500     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  09950002
101600     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  09960002
101700     DISPLAY '** SQLWARN0       ** = ' SQLWARN0.                  09970002
101800     DISPLAY '** SQLWARN1       ** = ' SQLWARN1.                  09980002
101900     DISPLAY '** SQLWARN2       ** = ' SQLWARN2.                  09990002
102000     DISPLAY '** SQLWARN3       ** = ' SQLWARN3.                  10000002
102100     DISPLAY '** SQLWARN4       ** = ' SQLWARN4.                  10010002
102200     DISPLAY '** SQLWARN5       ** = ' SQLWARN5.                  10020002
102300     DISPLAY '** SQLWARN6       ** = ' SQLWARN6.                  10030002
102400     DISPLAY '** SQLWARN7       ** = ' SQLWARN7.                  10040002
102500                                                                  10050002
102600     MOVE +4013                       TO ABEND-CODE.              10060002
102700     CALL 'ILBOABN0' USING ABEND-CODE.                            10070002
102800                                                                  10080002
