000100 IDENTIFICATION DIVISION.                                         00010032
000200 PROGRAM-ID.     APKRP269.                                        00020032
000300 AUTHOR.         DARYL WOELFEL                                    00030032
000400 DATE-WRITTEN.   06/13/1996.                                      00040032
000500 DATE-COMPILED.                                                   00050032
000600*************************************************************     00060032
000700*    COBOL 2                                                *     00070032
000800*                                                           *     00080032
000900*    RECONCILIATION RESULTS SUMMARY REPORT                  *     00090063
001000*                                                           *     00100032
001100*   PROGRAM OVERVIEW:                                       *     00110032
001200*                                                           *     00120032
001300*     THIS PROGRAM CREATES THE RECONCILIATION RESULTS       *     00130032
001400*   SUMMARY REPORT FROM FILES PRODUCED BY APKUT028.         *     00140032
001500*                                                           *     00150032
001600*     WHEN FORMATTING PRINT AREAS, IF THE TOTAL FOR         *     00160032
001700*   ANY CATEGORY IS ZERO, THAT CATEGORY IS NOT PRINTED.     *     00170032
001800*   TO HANDLE THIS, ALL NON-ZERO CATEGORIES HAVE A CODE     *     00180032
001900*   MOVED TO A 'PRINT TABLE'.  ONLY FIELDS IN THE PRINT     *     00190032
002000*   TABLE ARE THEN PRINTED.  FOR EXAMPLE:                   *     00200032
002100*                                                           *     00210032
002200*     FIELDS:         ---->   PRINT TABLE:                  *     00220032
002300*     PAID INVC = 24.00          -----------                *     00230032
002400*     JRNL RCPT =  0.00       (1)| PI | 76 |                *     00240032
002500*     OPEN OVER = 12.50          ----------| \              *     00250032
002600*     TR CDE 12 =  0.00       (2)| OO |    |  \             *     00260032
002700*     TR CDE 76 = 12.50          -----------   \            *     00270032
002800*                                               |           *     00280032
002900*                     OUTPUT:                <--|           *     00290032
003000*                                                           *     00300032
003100*        PAID INVOICES  24.00   ADJ.:  76 OVERAGE  12.50    *     00310032
003200*        OPEN OVERAGE   12.50                               *     00320032
003300*                                                           *     00330032
003400*************************************************************     00340032
003500*   INPUT:                                                  *     00350032
003600*                                                           *     00360032
003700*  1) SUMMARIZED-RECON-RESULTS-FILE    (APRD269)            *     00370063
003800*                                                           *     00380032
003900*   OUTPUT:                                                 *     00390032
004000*                                                           *     00400032
004100*  1) RPT01-FILE                       (DPWS132O)           *     00410063
004200*                                                           *     00420032
004300*************************************************************     00430032
004400*   CHANGES:                                                *     00440063
004500*                                                           *     00450063
004600* 02/05/2003                                                *     00460063
004700*    CHANGE MADE: ARKPO PHASE3 PROJECT.                     *     00470063
004800*    UPDATED THE PROGRAM TITLE TO MATCH THE SPEC TITLE.     *     00480063
004900*    UPDATED THE FILE NAMES IN THE PROGRAM COMMENT BLOCK.   *     00490063
005000*    CHANGED THE VARIOUS PRINT PO NUMBERS TO PIC Z(9).      *     00500063
005100* MADE BY:  MIKE BESKE                          WR#: 23500  *     00510063
005200*************************************************************     00520063
005300/                                                                 00530032
005400 ENVIRONMENT DIVISION.                                            00540032
005500 CONFIGURATION SECTION.                                           00550032
005600 INPUT-OUTPUT SECTION.                                            00560032
005700 FILE-CONTROL.                                                    00570032
005800                                                                  00580032
005900     SELECT SUMMARIZED-RECON-RESULTS-FILE ASSIGN TO UT-S-INP01.   00590032
006000     SELECT RPT01-FILE                    ASSIGN TO UT-S-RPT01.   00600032
006100                                                                  00610032
006200 DATA DIVISION.                                                   00620032
006300 FILE SECTION.                                                    00630032
006400 FD  SUMMARIZED-RECON-RESULTS-FILE                                00640032
006500     RECORDING MODE IS F                                          00650032
006600     LABEL RECORDS ARE STANDARD                                   00660032
006700     BLOCK CONTAINS 0 RECORDS                                     00670032
006800     DATA RECORD IS INPUT-RECORD.                                 00680032
006900 01  INPUT-RECORD                PIC X(275).                      00690044
007000                                                                  00700032
007100 FD  RPT01-FILE                                                   00710032
007200     RECORDING MODE IS F                                          00720032
007300     LABEL RECORDS ARE STANDARD                                   00730032
007400     BLOCK CONTAINS 0 RECORDS                                     00740032
007500     DATA RECORD IS RPT01-RECORD.                                 00750032
007600 01  RPT01-RECORD                PIC X(132).                      00760032
007700                                                                  00770032
007800 EJECT                                                            00780032
007900 WORKING-STORAGE SECTION.                                         00790032
008000                                                                  00800032
008100 01  PROGRAM-WORKAREA.                                            00810032
008200     05  FILLER                  PIC  X(30)           VALUE       00820032
008300         '** BEGINING OF APKRP269 W/S **'.                        00830032
008400     05  PV-PROGRAM-NAME         PIC  X(08)           VALUE       00840032
008500         'APKRP269'.                                              00850032
008600                                                                  00860032
008700 01  PRINT-FIELDS.                                                00870032
008800     05  PV-MAX-LINES            PIC S9(05)   COMP-3  VALUE +60.  00880032
008900     05  PV-LINE-COUNT           PIC S9(05)   COMP-3  VALUE +99.  00890032
009000     05  PV-PAGE-COUNT           PIC S9(05)   COMP-3  VALUE +0.   00900032
009100                                                                  00910032
009200 01  PROGRAM-SWITCHES.                                            00920032
009300     05  PS-END-OF-INPUT-RECS-SW                                  00930032
009400                                 PIC  X(01)   VALUE 'N'.          00940032
009500         88  END-OF-INPUT-RECS                VALUE 'Y'.          00950032
009600     05  PS-PRINT-ADJ-SW                                          00960062
009700                                 PIC  X(01)   VALUE 'Y'.          00970054
009800         88  PRINT-ADJ                        VALUE 'Y'.          00980062
009900         88  NO-PRINT-ADJ                     VALUE 'N'.          00990062
010000                                                                  01000032
010100 01  PV-CURRENT-DATE.                                             01010032
010200     05  PV-CURRENT-YEAR         PIC  9(02).                      01020032
010300     05  PV-CURRENT-MONTH        PIC  9(02).                      01030032
010400     05  PV-CURRENT-DAY          PIC  9(02).                      01040032
010500                                                                  01050032
010600 01  PV-CURRENT-TIME.                                             01060032
010700     05  PV-CURRENT-HOUR         PIC  9(02).                      01070032
010800     05  PV-CURRENT-MINUTE       PIC  9(02).                      01080032
010900     05  FILLER                  PIC  9(02)    VALUE 00.          01090032
011000                                                                  01100032
011100 01  CC-CONTROL-CARD.                                             01110032
011200     05  CC-RUN-TYPE             PIC  X(01)    VALUE ZERO.        01120032
011300     05  FILLER                  PIC  X(01)    VALUE SPACE.       01130032
011400     05  CC-END-DATE.                                             01140032
011500         10  CC-END-MONTH        PIC  9(02)    VALUE ZERO.        01150032
011600         10  CC-END-DAY          PIC  9(02)    VALUE ZERO.        01160032
011700         10  CC-END-YEAR         PIC  9(02)    VALUE ZERO.        01170032
011800                                                                  01180032
011900 01  PV-END-DATE.                                                 01190032
012000     05  PV-END-MONTH            PIC  9(02)    VALUE ZERO.        01200032
012100     05  FILLER                  PIC  X(01)    VALUE '/'.         01210032
012200     05  PV-END-DAY              PIC  9(02)    VALUE ZERO.        01220032
012300     05  FILLER                  PIC  X(01)    VALUE '/'.         01230032
012400     05  PV-END-YEAR.                                             01240032
012500         10  PV-END-YEAR-CC      PIC  9(02)    VALUE ZERO.        01250032
012600         10  PV-END-YEAR-YY      PIC  9(02)    VALUE ZERO.        01260032
012700                                                                  01270032
012800 01  HOLD-FIELDS.                                                 01280032
012900     05  HOLD-DEPT-NBR           PIC  X(03)    VALUE ZERO.        01290032
013000     05  HOLD-DEPT-NAME          PIC  X(25)    VALUE SPACES.      01300050
013100     05  HOLD-VENDOR-NAME        PIC  X(30)    VALUE SPACES.      01310032
013200                                                                  01320032
013300 01  SUBSCRIPTS.                                                  01330032
013400     05  NET-SUB                 PIC S9(04)    VALUE +0 COMP SYNC.01340032
013500     05  ADJUST-SUB              PIC S9(04)    VALUE +0 COMP SYNC.01350032
013600     05  MAX-SUB                 PIC S9(04)    VALUE +0 COMP SYNC.01360032
013700     05  PRINT-SUB               PIC S9(04)    VALUE +0 COMP SYNC.01370032
013800                                                                  01380032
013900 01  TOTAL-FIELDS.                                                01390032
014000     05  VENDOR-TOTALS.                                           01400032
014100         10  VT-OPEN-SHORT-COST  PIC 9(11)V99  COMP-3 VALUE ZERO. 01410037
014200         10  VT-OPEN-OVER-COST   PIC 9(11)V99  COMP-3 VALUE ZERO. 01420038
014300         10  VT-TR-CDE-10-COST   PIC 9(11)V99  COMP-3 VALUE ZERO. 01430032
014400         10  VT-TR-CDE-16-COST   PIC 9(11)V99  COMP-3 VALUE ZERO. 01440032
014500         10  VT-TR-CDE-36-COST   PIC 9(11)V99  COMP-3 VALUE ZERO. 01450032
014600         10  VT-TR-CDE-37-COST   PIC 9(11)V99  COMP-3 VALUE ZERO. 01460032
014700     05  DEPT-TOTALS.                                             01470032
014800         10  DT-OPEN-SHORT-COST  PIC 9(11)V99  COMP-3 VALUE ZERO. 01480037
014900         10  DT-OPEN-OVER-COST   PIC 9(11)V99  COMP-3 VALUE ZERO. 01490037
015000         10  DT-TR-CDE-10-COST   PIC 9(11)V99  COMP-3 VALUE ZERO. 01500032
015100         10  DT-TR-CDE-16-COST   PIC 9(11)V99  COMP-3 VALUE ZERO. 01510032
015200         10  DT-TR-CDE-36-COST   PIC 9(11)V99  COMP-3 VALUE ZERO. 01520032
015300         10  DT-TR-CDE-37-COST   PIC 9(11)V99  COMP-3 VALUE ZERO. 01530032
015400     05  GRAND-TOTALS.                                            01540032
015500         10  GT-OPEN-SHORT-COST  PIC 9(11)V99  COMP-3 VALUE ZERO. 01550037
015600         10  GT-OPEN-OVER-COST   PIC 9(11)V99  COMP-3 VALUE ZERO. 01560037
015700         10  GT-TR-CDE-10-COST   PIC 9(11)V99  COMP-3 VALUE ZERO. 01570032
015800         10  GT-TR-CDE-16-COST   PIC 9(11)V99  COMP-3 VALUE ZERO. 01580032
015900         10  GT-TR-CDE-36-COST   PIC 9(11)V99  COMP-3 VALUE ZERO. 01590032
016000         10  GT-TR-CDE-37-COST   PIC 9(11)V99  COMP-3 VALUE ZERO. 01600032
016100*                                                                 01610032
016200 01  PRINT-TABLE.                                                 01620032
016300     05  PRINT-RECORD OCCURS 5 TIMES.                             01630037
016400         10  NET-CDE             PIC X(02)     VALUE SPACES.      01640032
016500         10  ADJUST-CDE          PIC X(02)     VALUE SPACES.      01650032
016600 EJECT                                                            01660032
016700*  INPUT RECORD AREA                                              01670032
016800     COPY APRD269.                                                01680032
016900                                                                  01690032
017000 EJECT                                                            01700032
017100*  PRINT AREA                                                     01710032
017200                                                                  01720032
017300     COPY DPWS132O.                                               01730032
017400                                                                  01740032
017500 01  HDR-LINE2                   PIC  X(132)  VALUE SPACES.       01750032
017600                                                                  01760032
017700 01  HDR-LINE2-WEEK.                                              01770032
017800     05  FILLER                  PIC  X(38)   VALUE SPACES.       01780032
017900     05  HL2-TITLE-WEEK          PIC  X(47)   VALUE               01790032
018000         'RECONCILIATION RESULTS SUMMARY FOR WEEK ENDING '.       01800032
018100     05  HL2-END-DATE-WEEK       PIC  X(10)   VALUE SPACES.       01810032
018200     05  FILLER                  PIC  X(37)   VALUE SPACES.       01820032
018300                                                                  01830032
018400 01  HDR-LINE2-MONTH.                                             01840032
018500     05  FILLER                  PIC  X(38)   VALUE SPACES.       01850032
018600     05  HL2-TITLE-MONTH         PIC  X(48)   VALUE               01860032
018700         'RECONCILIATION RESULTS SUMMARY FOR MONTH ENDING '.      01870032
018800     05  HL2-END-DATE-MONTH      PIC  X(10)   VALUE SPACES.       01880032
018900     05  FILLER                  PIC  X(36)   VALUE SPACES.       01890032
019000                                                                  01900042
019100 01  GMM-HEADER.                                                  01910042
019200     05  FILLER                  PIC  X(09)    VALUE 'GMM:     '. 01920042
019300     05  GH-GMM-NBR              PIC  X(02)    VALUE SPACES.      01930048
019400     05  FILLER                  PIC  X(03)    VALUE ' - '.       01940042
019500     05  GH-GMM-NAME             PIC  X(30)    VALUE SPACES.      01950048
019600     05  FILLER                  PIC  X(88)    VALUE SPACES.      01960042
019700                                                                  01970042
019800 01  DMM-HEADER.                                                  01980042
019900     05  FILLER                  PIC  X(09)    VALUE 'DMM:     '. 01990042
020000     05  DH-DMM-NBR              PIC  X(02)    VALUE SPACES.      02000048
020100     05  FILLER                  PIC  X(03)    VALUE ' - '.       02010042
020200     05  DH-DMM-NAME             PIC  X(30)    VALUE SPACES.      02020048
020300     05  FILLER                  PIC  X(88)    VALUE SPACES.      02030042
020400                                                                  02040042
020500 01  BUYER-HEADER.                                                02050042
020600     05  FILLER                  PIC  X(09)    VALUE 'BUYER:   '. 02060042
020700     05  BH-BUYER-NBR            PIC  X(03)    VALUE SPACES.      02070042
020800     05  FILLER                  PIC  X(03)    VALUE ' - '.       02080042
020900     05  BH-BUYER-NAME           PIC  X(30)    VALUE SPACES.      02090042
021000     05  FILLER                  PIC  X(87)    VALUE SPACES.      02100042
021100                                                                  02110032
021200 01  DEPT-HEADER.                                                 02120042
021300     05  FILLER                  PIC  X(09)    VALUE 'DEPT:    '. 02130042
021400     05  DH-DEPT-NBR             PIC  X(03)    VALUE SPACES.      02140042
021500     05  FILLER                  PIC  X(03)    VALUE ' - '.       02150042
021600     05  DH-DEPT-NAME            PIC  X(30)    VALUE SPACES.      02160042
021700     05  FILLER                  PIC  X(87)    VALUE SPACES.      02170042
021800                                                                  02180042
021900 01  VENDOR-HEADER.                                               02190032
022000     05  FILLER                  PIC  X(09)    VALUE 'VENDOR:  '. 02200042
022100     05  VH-VENDOR-NBR           PIC  X(09)    VALUE SPACES.      02210042
022200     05  FILLER                  PIC  X(03)    VALUE ' - '.       02220042
022300     05  VH-VENDOR-NAME          PIC  X(30)    VALUE SPACES.      02230032
022400     05  FILLER                  PIC  X(81)    VALUE SPACES.      02240042
022500                                                                  02250032
022600 01  PO-HEADER.                                                   02260032
022700     05  FILLER                  PIC  X(10)                       02270042
022800                                    VALUE 'PO NUMBER '.           02280042
022900     05  PH-PO-NBR               PIC  Z(09)    VALUE ZERO.        02290063
023000     05  FILLER                  PIC  X(07)    VALUE SPACES.      02300063
023100     05  FILLER                  PIC  X(19)                       02310032
023200                                    VALUE 'EXTENDED GROSS COST'.  02320036
023300     05  FILLER                  PIC  X(18)    VALUE SPACES.      02330032
023400     05  FILLER                  PIC  X(09)                       02340042
023500                                    VALUE 'TRAN CODE'.            02350042
023600     05  FILLER                  PIC  X(03)    VALUE SPACES.      02360032
023700     05  FILLER                  PIC  X(11)                       02370032
023800                                    VALUE 'DESCRIPTION'.          02380032
023900     05  FILLER                  PIC  X(27)    VALUE SPACES.      02390032
024000     05  FILLER                  PIC  X(19)                       02400032
024100                                    VALUE 'TOTAL EXTENDED COST'.  02410032
024200                                                                  02420032
024300 01  PO-HEADER-NA.                                                02430043
024400     05  FILLER                  PIC  X(10)                       02440043
024500                                    VALUE 'PO NUMBER '.           02450043
024600     05  PH-PO-NBR-NA            PIC  Z(09)    VALUE ZERO.        02460063
024700     05  FILLER                  PIC  X(07)    VALUE SPACES.      02470063
024800     05  FILLER                  PIC  X(19)                       02480043
024900                                    VALUE 'EXTENDED GROSS COST'.  02490043
025000     05  FILLER                  PIC  X(87)    VALUE SPACES.      02500043
025100                                                                  02510043
025200 01  VENDOR-TOTAL-HEADER.                                         02520032
025300     05  FILLER                  PIC  X(18)                       02530032
025400                                    VALUE 'TOTALS FOR VENDOR '.   02540032
025500     05  VTH-VENDOR-NAME         PIC  X(30)    VALUE SPACES.      02550032
025600     05  FILLER                  PIC  X(84)    VALUE SPACES.      02560042
025700                                                                  02570032
025800 01  DEPT-TOTAL-HEADER.                                           02580032
025900     05  FILLER                  PIC  X(22)                       02590032
026000                                VALUE 'TOTALS FOR DEPARTMENT '.   02600032
026100     05  DTH-DEPT-NBR            PIC  X(03)    VALUE SPACES.      02610032
026200     05  FILLER                  PIC  X(03)    VALUE ' - '.       02620042
026300     05  DTH-DEPT-NAME           PIC  X(30)    VALUE SPACES.      02630042
026400     05  FILLER                  PIC  X(74)    VALUE SPACES.      02640042
026500                                                                  02650032
026600 01  GRAND-TOTAL-HEADER.                                          02660032
026700     05  FILLER                  PIC  X(13)                       02670042
026800                                    VALUE 'GRAND TOTALS:'.        02680042
026900     05  FILLER                  PIC  X(119)   VALUE SPACES.      02690042
027000                                                                  02700032
027100 01  HYPHEN-DIVIDER.                                              02710032
027200     05  FILLER                  PIC  X(132)   VALUE ALL '-'.     02720032
027300                                                                  02730032
027400 01  ADJUSTMENTS-HEADER.                                          02740042
027500     05  FILLER                  PIC  X(63)    VALUE SPACE.       02750042
027600     05  FILLER                  PIC  X(69)    VALUE              02760042
027700         '--------------------------  ADJUSTMENTS  ---------------02770042
027800-        '-------------'.                                         02780045
027900                                                                  02790042
028000 01  DETAIL-HEADER.                                               02800042
028100     05  FILLER                  PIC  X(26)    VALUE SPACES.      02810047
028200     05  FILLER                  PIC  X(19)                       02820042
028300                                    VALUE 'EXTENDED GROSS COST'.  02830042
028400     05  FILLER                  PIC  X(18)    VALUE SPACES.      02840042
028500     05  FILLER                  PIC  X(09)                       02850042
028600                                    VALUE 'TRAN CODE'.            02860042
028700     05  FILLER                  PIC  X(03)    VALUE SPACES.      02870042
028800     05  FILLER                  PIC  X(11)                       02880042
028900                                    VALUE 'DESCRIPTION'.          02890042
029000     05  FILLER                  PIC  X(27)    VALUE SPACES.      02900042
029100     05  FILLER                  PIC  X(19)                       02910042
029200                                    VALUE 'TOTAL EXTENDED COST'.  02920042
029300                                                                  02930042
029400 01  DETAIL-HEADER-NA.                                            02940043
029500     05  FILLER                  PIC  X(26)    VALUE SPACES.      02950047
029600     05  FILLER                  PIC  X(19)                       02960043
029700                                    VALUE 'EXTENDED GROSS COST'.  02970043
029800     05  FILLER                  PIC  X(87)    VALUE SPACES.      02980043
029900                                                                  02990043
030000 01  DETAIL-LITERALS.                                             03000032
030100     05  LIT-PAID-INVC-COST      PIC  X(28)                       03010032
030200                           VALUE ' PAID INVOICES              '.  03020036
030300     05  LIT-JRNLD-RCV-COST      PIC  X(28)                       03030032
030400                           VALUE ' JOURNALIZED RECEIPTS       '.  03040036
030500     05  LIT-OPEN-INVC-COST      PIC  X(28)                       03050032
030600                           VALUE ' OPEN INVOICES              '.  03060032
030700     05  LIT-OPEN-SHORT-COST     PIC  X(28)                       03070032
030800                           VALUE ' OPEN SHORTAGE              '.  03080032
030900     05  LIT-OPEN-OVER-COST      PIC  X(28)                       03090032
031000                           VALUE ' OPEN OVERAGE               '.  03100032
031100     05  LIT-TR-CDE-10-COST      PIC  X(43)                       03110040
031200            VALUE '10   INVC COST > PO COST; PO COST USED     '.  03120040
031300     05  LIT-TR-CDE-16-COST      PIC  X(43)                       03130040
031400            VALUE '16   INVC COST < PO COST; PO COST USED     '.  03140040
031500     05  LIT-TR-CDE-36-COST      PIC  X(43)                       03150040
031600            VALUE '36   INVC COST < PO COST; INVC COST USED   '.  03160040
031700     05  LIT-TR-CDE-37-COST      PIC  X(43)                       03170040
031800            VALUE '37   INVC COST > PO COST; INVC COST USED   '.  03180040
031900                                                                  03190032
032000 01  DL-DETAIL-LINE.                                              03200032
032100     05  DL-LIT-1                PIC  X(28)  VALUE SPACES.        03210032
032200     05  DL-COST-1               PIC  ZZ,ZZZ,ZZZ,ZZZ.ZZ           03220032
032300                                             VALUE SPACES.        03230032
032400     05  FILLER                  PIC  X(25)  VALUE SPACES.        03240040
032500     05  DL-LIT-2                PIC  X(43)  VALUE SPACES.        03250040
032600     05  DL-DM-L                 PIC  X(01)  VALUE SPACE.         03260040
032700     05  DL-COST-2               PIC  ZZ,ZZZ,ZZZ,ZZZ.ZZ           03270032
032800                                             VALUE SPACES.        03280032
032900     05  DL-DM-R                 PIC  X(01)  VALUE SPACE.         03290040
033000                                                                  03300032
033100 01  PRINT-LINE                  PIC  X(132) VALUE SPACES.        03310032
033200                                                                  03320032
033300 01  FILLER                      PIC  X(25)  VALUE                03330032
033400     '** END OF APKRP269 W/S **'.                                 03340032
033500                                                                  03350032
033600 EJECT                                                            03360032
033700 PROCEDURE DIVISION.                                              03370032
033800***************************************************************** 03380032
033900*  MAIN PARAGRAPH                                                 03390032
034000***************************************************************** 03400032
034100 A000-MAIN.                                                       03410032
034200                                                                  03420032
034300     PERFORM B100-BEGIN-PROGRAM.                                  03430032
034400     PERFORM B200-PROCESS-INPUT                                   03440032
034500         UNTIL END-OF-INPUT-RECS.                                 03450032
034600     PERFORM B300-END-PROGRAM.                                    03460032
034700                                                                  03470032
034800     GOBACK.                                                      03480032
034900                                                                  03490032
035000 EJECT                                                            03500032
035100***************************************************************** 03510032
035200*  OPEN FILES, GET DATE & TIME, GET RUN TYPE & END DATE,          03520032
035300*  DO INITIAL READ                                                03530032
035400***************************************************************** 03540032
035500 B100-BEGIN-PROGRAM.                                              03550032
035600                                                                  03560032
035700     OPEN INPUT  SUMMARIZED-RECON-RESULTS-FILE                    03570032
035800          OUTPUT RPT01-FILE.                                      03580032
035900                                                                  03590032
036000     ACCEPT PV-CURRENT-DATE      FROM DATE.                       03600032
036100     MOVE PV-CURRENT-MONTH       TO   DP132O-RUN-MONTH.           03610032
036200     MOVE PV-CURRENT-DAY         TO   DP132O-RUN-DAY.             03620032
036300     MOVE PV-CURRENT-YEAR        TO   DP132O-RUN-YEAR.            03630032
036400                                                                  03640032
036500     ACCEPT PV-CURRENT-TIME      FROM TIME.                       03650032
036600     MOVE PV-CURRENT-HOUR        TO   DP132O-RUN-HOUR.            03660032
036700     MOVE PV-CURRENT-MINUTE      TO   DP132O-RUN-MINUTE.          03670032
036800                                                                  03680032
036900     MOVE PV-PROGRAM-NAME        TO   DP132O-PROGRAM-NAME.        03690032
037000     MOVE 1                      TO   DP132O-REPORT-NUMBER.       03700032
037100                                                                  03710032
037200     ACCEPT CC-CONTROL-CARD.                                      03720032
037300     MOVE CC-END-MONTH           TO   PV-END-MONTH.               03730032
037400     MOVE CC-END-DAY             TO   PV-END-DAY.                 03740032
037500     MOVE CC-END-YEAR            TO   PV-END-YEAR-YY.             03750032
037600     IF CC-END-YEAR >= 80                                         03760032
037700         MOVE 19 TO PV-END-YEAR-CC                                03770032
037800     ELSE                                                         03780032
037900         MOVE 20 TO PV-END-YEAR-CC                                03790032
038000     END-IF.                                                      03800032
038100     EVALUATE CC-RUN-TYPE                                         03810032
038200         WHEN 'W'                                                 03820032
038300             MOVE PV-END-DATE     TO HL2-END-DATE-WEEK            03830032
038400             MOVE HDR-LINE2-WEEK  TO HDR-LINE2                    03840032
038500         WHEN 'M'                                                 03850032
038600             MOVE PV-END-DATE     TO HL2-END-DATE-MONTH           03860032
038700             MOVE HDR-LINE2-MONTH TO HDR-LINE2                    03870032
038800         WHEN OTHER                                               03880032
038900             DISPLAY 'CONTROL CARD ERROR IN APKRP269:'            03890032
039000             DISPLAY 'FIRST COLUMN MUST BE (W)KLY OR (M)NTHLY.'   03900032
039100     END-EVALUATE.                                                03910032
039200                                                                  03920032
039300     PERFORM R100-READ-INPUT-FILE.                                03930032
039400                                                                  03940032
039500 EJECT                                                            03950032
039600***************************************************************** 03960032
039700*  PROCESS DEPTS, PRINT DEPT TOTALS, ADD TO GRAND TOTALS          03970032
039800***************************************************************** 03980032
039900 B200-PROCESS-INPUT.                                              03990032
040000                                                                  04000032
040100     MOVE AP269-GMM-NBR    TO GH-GMM-NBR.                         04010047
040200     MOVE AP269-GMM-NAME   TO GH-GMM-NAME.                        04020047
040300     MOVE AP269-DMM-NBR    TO DH-DMM-NBR.                         04030047
040400     MOVE AP269-DMM-NAME   TO DH-DMM-NAME.                        04040047
040500     MOVE AP269-BUYER-NBR  TO BH-BUYER-NBR.                       04050047
040600     MOVE AP269-BUYER-NAME TO BH-BUYER-NAME.                      04060047
040700     MOVE AP269-DEPT-NAME  TO HOLD-DEPT-NAME                      04070050
040800                              DH-DEPT-NAME.                       04080050
040900     MOVE AP269-DEPT-NBR   TO HOLD-DEPT-NBR                       04090047
041000                              DH-DEPT-NBR.                        04100047
041100                                                                  04110032
041200     PERFORM C100-PROCESS-DEPT                                    04120032
041300         UNTIL (AP269-DEPT-NBR NOT = HOLD-DEPT-NBR)               04130032
041400            OR END-OF-INPUT-RECS.                                 04140032
041500                                                                  04150032
041600* PRINT DEPT TOTALS                                               04160032
041700     MOVE +0 TO NET-SUB                                           04170037
041800                ADJUST-SUB.                                       04180037
041900     IF DT-OPEN-SHORT-COST NOT = ZERO                             04190037
042000         ADD +1 TO NET-SUB                                        04200037
042100         MOVE 'OS' TO NET-CDE (NET-SUB)                           04210037
042200     END-IF.                                                      04220032
042300     IF DT-OPEN-OVER-COST NOT = ZERO                              04230037
042400         ADD +1 TO NET-SUB                                        04240037
042500         MOVE 'OO' TO NET-CDE (NET-SUB)                           04250037
042600     END-IF.                                                      04260032
042700     IF DT-TR-CDE-10-COST NOT = ZERO                              04270032
042800         ADD +1 TO ADJUST-SUB                                     04280032
042900         MOVE '10' TO ADJUST-CDE (ADJUST-SUB)                     04290032
043000     END-IF.                                                      04300032
043100     IF DT-TR-CDE-16-COST NOT = ZERO                              04310032
043200         ADD +1 TO ADJUST-SUB                                     04320032
043300         MOVE '16' TO ADJUST-CDE (ADJUST-SUB)                     04330032
043400     END-IF.                                                      04340032
043500     IF DT-TR-CDE-36-COST NOT = ZERO                              04350032
043600         ADD +1 TO ADJUST-SUB                                     04360032
043700         MOVE '36' TO ADJUST-CDE (ADJUST-SUB)                     04370032
043800     END-IF.                                                      04380032
043900     IF DT-TR-CDE-37-COST NOT = ZERO                              04390032
044000         ADD +1 TO ADJUST-SUB                                     04400032
044100         MOVE '37' TO ADJUST-CDE (ADJUST-SUB)                     04410032
044200     END-IF.                                                      04420032
044300                                                                  04430032
044400     IF ADJUST-SUB > NET-SUB                                      04440037
044500         MOVE ADJUST-SUB TO MAX-SUB                               04450037
044600     ELSE                                                         04460037
044700         MOVE NET-SUB TO MAX-SUB                                  04470037
044800     END-IF.                                                      04480037
044900                                                                  04490037
045000     IF (PV-LINE-COUNT + MAX-SUB + 7) > PV-MAX-LINES              04500046
045100         PERFORM W100-WRITE-PAGE-HEADING                          04510046
045200         PERFORM W400-WRITE-BLANK-LINE                            04520043
045300         MOVE HOLD-DEPT-NBR      TO DTH-DEPT-NBR                  04530043
045400         MOVE HOLD-DEPT-NAME     TO DTH-DEPT-NAME                 04540049
045500         MOVE DEPT-TOTAL-HEADER  TO PRINT-LINE                    04550043
045600         PERFORM W200-WRITE-HEADER-LINE                           04560043
045700         MOVE ADJUSTMENTS-HEADER TO PRINT-LINE                    04570043
045800         PERFORM W200-WRITE-HEADER-LINE                           04580043
045900         MOVE DETAIL-HEADER      TO PRINT-LINE                    04590043
046000         PERFORM W200-WRITE-HEADER-LINE                           04600043
046100     ELSE                                                         04610043
046200         PERFORM W400-WRITE-BLANK-LINE                            04620043
046300         MOVE HOLD-DEPT-NBR      TO DTH-DEPT-NBR                  04630043
046400         MOVE HOLD-DEPT-NAME     TO DTH-DEPT-NAME                 04640049
046500         MOVE DEPT-TOTAL-HEADER  TO PRINT-LINE                    04650043
046600         PERFORM W200-WRITE-HEADER-LINE                           04660043
046700         IF ADJUST-SUB > 0                                        04670043
046800             MOVE ADJUSTMENTS-HEADER TO PRINT-LINE                04680043
046900             PERFORM W200-WRITE-HEADER-LINE                       04690043
047000             MOVE DETAIL-HEADER      TO PRINT-LINE                04700043
047100             PERFORM W200-WRITE-HEADER-LINE                       04710043
047200         ELSE                                                     04720043
047300             PERFORM W400-WRITE-BLANK-LINE                        04730043
047400             MOVE DETAIL-HEADER-NA   TO PRINT-LINE                04740043
047500             PERFORM W200-WRITE-HEADER-LINE                       04750043
047600         END-IF                                                   04760043
047700     END-IF.                                                      04770043
047800     PERFORM W400-WRITE-BLANK-LINE.                               04780042
047900                                                                  04790042
048000     PERFORM C200-PRINT-DEPT-TOTAL-LINES                          04800032
048100         VARYING PRINT-SUB FROM +1 BY +1                          04810032
048200             UNTIL PRINT-SUB > MAX-SUB.                           04820037
048300     MOVE SPACES TO PRINT-TABLE.                                  04830032
048400                                                                  04840032
048500* ADD DEPT TOTALS TO GRAND TOTALS                                 04850032
048600     ADD DT-OPEN-SHORT-COST TO GT-OPEN-SHORT-COST.                04860037
048700     ADD DT-OPEN-OVER-COST  TO GT-OPEN-OVER-COST.                 04870037
048800     ADD DT-TR-CDE-10-COST  TO GT-TR-CDE-10-COST.                 04880032
048900     ADD DT-TR-CDE-16-COST  TO GT-TR-CDE-16-COST.                 04890032
049000     ADD DT-TR-CDE-36-COST  TO GT-TR-CDE-36-COST.                 04900032
049100     ADD DT-TR-CDE-37-COST  TO GT-TR-CDE-37-COST.                 04910032
049200     MOVE ZEROS             TO DT-OPEN-SHORT-COST                 04920037
049300                               DT-OPEN-OVER-COST                  04930037
049400                               DT-TR-CDE-10-COST                  04940032
049500                               DT-TR-CDE-16-COST                  04950032
049600                               DT-TR-CDE-36-COST                  04960032
049700                               DT-TR-CDE-37-COST.                 04970032
049800                                                                  04980032
049900* PRINT '-------' DIVIDER                                         04990032
050000     PERFORM W400-WRITE-BLANK-LINE.                               05000042
050100     MOVE HYPHEN-DIVIDER TO PRINT-LINE.                           05010042
050200     PERFORM W200-WRITE-HEADER-LINE.                              05020032
050300                                                                  05030032
050400     MOVE +99 TO PV-LINE-COUNT.                                   05040052
050500     SET PRINT-ADJ TO TRUE.                                       05050062
050600                                                                  05060032
050700 EJECT                                                            05070032
050800***************************************************************** 05080032
050900*  PRINT GRAND TOTALS, CLOSE FILES                                05090032
051000***************************************************************** 05100032
051100 B300-END-PROGRAM.                                                05110032
051200                                                                  05120032
051300* PRINT GRAND TOTALS                                              05130032
051400     MOVE +0 TO NET-SUB                                           05140037
051500                ADJUST-SUB.                                       05150037
051600     IF GT-OPEN-SHORT-COST NOT = ZERO                             05160037
051700         ADD +1 TO NET-SUB                                        05170037
051800         MOVE 'OS' TO NET-CDE (NET-SUB)                           05180037
051900     END-IF.                                                      05190032
052000     IF GT-OPEN-OVER-COST NOT = ZERO                              05200037
052100         ADD +1 TO NET-SUB                                        05210037
052200         MOVE 'OO' TO NET-CDE (NET-SUB)                           05220037
052300     END-IF.                                                      05230032
052400     IF GT-TR-CDE-10-COST NOT = ZERO                              05240032
052500         ADD +1 TO ADJUST-SUB                                     05250032
052600         MOVE '10' TO ADJUST-CDE (ADJUST-SUB)                     05260032
052700     END-IF.                                                      05270032
052800     IF GT-TR-CDE-16-COST NOT = ZERO                              05280032
052900         ADD +1 TO ADJUST-SUB                                     05290032
053000         MOVE '16' TO ADJUST-CDE (ADJUST-SUB)                     05300032
053100     END-IF.                                                      05310032
053200     IF GT-TR-CDE-36-COST NOT = ZERO                              05320032
053300         ADD +1 TO ADJUST-SUB                                     05330032
053400         MOVE '36' TO ADJUST-CDE (ADJUST-SUB)                     05340032
053500     END-IF.                                                      05350032
053600     IF GT-TR-CDE-37-COST NOT = ZERO                              05360032
053700         ADD +1 TO ADJUST-SUB                                     05370032
053800         MOVE '37' TO ADJUST-CDE (ADJUST-SUB)                     05380032
053900     END-IF.                                                      05390032
054000                                                                  05400032
054100     IF ADJUST-SUB > NET-SUB                                      05410037
054200         MOVE ADJUST-SUB TO MAX-SUB                               05420037
054300     ELSE                                                         05430037
054400         MOVE NET-SUB TO MAX-SUB                                  05440037
054500     END-IF.                                                      05450037
054600                                                                  05460037
054700     PERFORM W100-WRITE-PAGE-HEADING.                             05470053
054800     PERFORM W400-WRITE-BLANK-LINE.                               05480043
054900     MOVE GRAND-TOTAL-HEADER TO PRINT-LINE.                       05490043
055000     PERFORM W200-WRITE-HEADER-LINE.                              05500043
055100     IF ADJUST-SUB > 0                                            05510043
055200         MOVE ADJUSTMENTS-HEADER TO PRINT-LINE                    05520043
055300         PERFORM W200-WRITE-HEADER-LINE                           05530043
055400         MOVE DETAIL-HEADER      TO PRINT-LINE                    05540043
055500         PERFORM W200-WRITE-HEADER-LINE                           05550043
055600     ELSE                                                         05560043
055700         PERFORM W400-WRITE-BLANK-LINE                            05570043
055800         MOVE DETAIL-HEADER-NA   TO PRINT-LINE                    05580043
055900         PERFORM W200-WRITE-HEADER-LINE                           05590043
056000     END-IF                                                       05600043
056100     PERFORM W400-WRITE-BLANK-LINE.                               05610043
056200                                                                  05620043
056300     PERFORM F200-PRINT-GRAND-TOTAL-LINES                         05630032
056400         VARYING PRINT-SUB FROM +1 BY +1                          05640032
056500             UNTIL PRINT-SUB > MAX-SUB.                           05650037
056600                                                                  05660032
056700     CLOSE       SUMMARIZED-RECON-RESULTS-FILE                    05670032
056800                 RPT01-FILE.                                      05680032
056900                                                                  05690032
057000 EJECT                                                            05700032
057100***************************************************************** 05710032
057200*  PROCESS VENDORS, PRINT VENDOR TOTALS, ADD TO DEPT TOTALS       05720032
057300***************************************************************** 05730032
057400 C100-PROCESS-DEPT.                                               05740032
057500                                                                  05750032
057600     MOVE AP269-VENDOR-NBR       TO   VH-VENDOR-NBR.              05760047
057700     MOVE AP269-VENDOR-NAME      TO   HOLD-VENDOR-NAME            05770032
057800                                      VH-VENDOR-NAME.             05780032
057900*****                                                             05790034
058000* THIS NEXT CHUNK OF CODE IS TO PREVENT THE VENDOR HEADER         05800034
058100* FROM PRINTING ALONE AT PAGE BOTTOM IF THERE'S NOT ENOUGH        05810034
058200* ROOM FOR THE FIRST PO.  WE NEED TO PEEK AHEAD AND SEE HOW       05820034
058300* MANY LINES THE FIRST PO WILL TAKE.  IF TOO MANY, WE NEED        05830034
058400* A PAGE BREAK BEFORE PRINTING THE VENDOR HEADER.                 05840034
058500*                                                                 05850034
058600     MOVE +0 TO NET-SUB                                           05860034
058700                ADJUST-SUB.                                       05870034
058800     IF AP269-PAID-INVC-COST NOT = ZERO                           05880034
058900         ADD +1 TO NET-SUB                                        05890034
059000     END-IF.                                                      05900034
059100     IF AP269-JRNLD-RCV-COST NOT = ZERO                           05910034
059200         ADD +1 TO NET-SUB                                        05920034
059300     END-IF.                                                      05930034
059400     IF AP269-OPEN-INVC-COST NOT = ZERO                           05940034
059500         ADD +1 TO NET-SUB                                        05950034
059600     END-IF.                                                      05960034
059700     IF AP269-OPEN-SHORT-COST NOT = ZERO                          05970034
059800         ADD +1 TO NET-SUB                                        05980034
059900     END-IF.                                                      05990034
060000     IF AP269-OPEN-OVER-COST NOT = ZERO                           06000034
060100         ADD +1 TO NET-SUB                                        06010034
060200     END-IF.                                                      06020034
060300     IF AP269-TR-CDE-10-COST NOT = ZERO                           06030034
060400         ADD +1 TO ADJUST-SUB                                     06040034
060500     END-IF.                                                      06050034
060600     IF AP269-TR-CDE-16-COST NOT = ZERO                           06060034
060700         ADD +1 TO ADJUST-SUB                                     06070034
060800     END-IF.                                                      06080034
060900     IF AP269-TR-CDE-36-COST NOT = ZERO                           06090034
061000         ADD +1 TO ADJUST-SUB                                     06100034
061100     END-IF.                                                      06110034
061200     IF AP269-TR-CDE-37-COST NOT = ZERO                           06120034
061300         ADD +1 TO ADJUST-SUB                                     06130034
061400     END-IF.                                                      06140034
061500     IF ADJUST-SUB > NET-SUB                                      06150034
061600         MOVE ADJUST-SUB TO MAX-SUB                               06160034
061700     ELSE                                                         06170034
061800         MOVE NET-SUB TO MAX-SUB                                  06180034
061900     END-IF.                                                      06190034
062000     IF (PV-LINE-COUNT + MAX-SUB + 8) > PV-MAX-LINES              06200058
062100         PERFORM W100-WRITE-PAGE-HEADING                          06210059
062200         SET PRINT-ADJ TO TRUE                                    06220062
062300     END-IF.                                                      06230034
062400*                                                                 06240034
062500*****                                                             06250034
062600     PERFORM W400-WRITE-BLANK-LINE.                               06260042
062700     MOVE VENDOR-HEADER TO PRINT-LINE.                            06270042
062800     PERFORM W200-WRITE-HEADER-LINE.                              06280032
062900                                                                  06290042
063000     PERFORM D100-PROCESS-VENDOR                                  06300032
063100         UNTIL (AP269-VENDOR-NAME NOT = HOLD-VENDOR-NAME)         06310032
063200            OR (AP269-DEPT-NBR    NOT = HOLD-DEPT-NBR)            06320032
063300            OR END-OF-INPUT-RECS                                  06330032
063400                                                                  06340032
063500* PRINT '-------' DIVIDER AFTER LAST PO BEFORE VENDOR TOTALS      06350034
063600     PERFORM W400-WRITE-BLANK-LINE.                               06360042
063700     MOVE HYPHEN-DIVIDER TO PRINT-LINE.                           06370042
063800     PERFORM W200-WRITE-HEADER-LINE.                              06380034
063900                                                                  06390034
064000* PRINT VENDOR TOTALS                                             06400032
064100     MOVE +0 TO NET-SUB                                           06410037
064200                ADJUST-SUB.                                       06420037
064300     IF VT-OPEN-SHORT-COST NOT = ZERO                             06430037
064400         ADD +1 TO NET-SUB                                        06440037
064500         MOVE 'OS' TO NET-CDE (NET-SUB)                           06450037
064600     END-IF.                                                      06460032
064700     IF VT-OPEN-OVER-COST NOT = ZERO                              06470037
064800         ADD +1 TO NET-SUB                                        06480037
064900         MOVE 'OO' TO NET-CDE (NET-SUB)                           06490037
065000     END-IF.                                                      06500032
065100     IF VT-TR-CDE-10-COST NOT = ZERO                              06510032
065200         ADD +1 TO ADJUST-SUB                                     06520032
065300         MOVE '10' TO ADJUST-CDE (ADJUST-SUB)                     06530032
065400     END-IF.                                                      06540032
065500     IF VT-TR-CDE-16-COST NOT = ZERO                              06550032
065600         ADD +1 TO ADJUST-SUB                                     06560032
065700         MOVE '16' TO ADJUST-CDE (ADJUST-SUB)                     06570032
065800     END-IF.                                                      06580032
065900     IF VT-TR-CDE-36-COST NOT = ZERO                              06590032
066000         ADD +1 TO ADJUST-SUB                                     06600032
066100         MOVE '36' TO ADJUST-CDE (ADJUST-SUB)                     06610032
066200     END-IF.                                                      06620032
066300     IF VT-TR-CDE-37-COST NOT = ZERO                              06630032
066400         ADD +1 TO ADJUST-SUB                                     06640032
066500         MOVE '37' TO ADJUST-CDE (ADJUST-SUB)                     06650032
066600     END-IF.                                                      06660032
066700                                                                  06670032
066800     IF ADJUST-SUB > NET-SUB                                      06680037
066900         MOVE ADJUST-SUB TO MAX-SUB                               06690037
067000     ELSE                                                         06700037
067100         MOVE NET-SUB TO MAX-SUB                                  06710037
067200     END-IF.                                                      06720037
067300                                                                  06730037
067400     IF (PV-LINE-COUNT + MAX-SUB + 8) > PV-MAX-LINES              06740058
067500         PERFORM W100-WRITE-PAGE-HEADING                          06750046
067600         PERFORM W400-WRITE-BLANK-LINE                            06760043
067700         MOVE HOLD-VENDOR-NAME    TO VTH-VENDOR-NAME              06770043
067800         MOVE VENDOR-TOTAL-HEADER TO PRINT-LINE                   06780043
067900         PERFORM W200-WRITE-HEADER-LINE                           06790043
068000         MOVE ADJUSTMENTS-HEADER TO PRINT-LINE                    06800043
068100         PERFORM W200-WRITE-HEADER-LINE                           06810043
068200         MOVE DETAIL-HEADER TO PRINT-LINE                         06820043
068300         PERFORM W200-WRITE-HEADER-LINE                           06830043
068400     ELSE                                                         06840043
068500         PERFORM W400-WRITE-BLANK-LINE                            06850043
068600         MOVE HOLD-VENDOR-NAME       TO VTH-VENDOR-NAME           06860043
068700         MOVE VENDOR-TOTAL-HEADER    TO PRINT-LINE                06870043
068800         PERFORM W200-WRITE-HEADER-LINE                           06880043
068900         IF ADJUST-SUB > 0                                        06890043
069000             MOVE ADJUSTMENTS-HEADER TO PRINT-LINE                06900043
069100             PERFORM W200-WRITE-HEADER-LINE                       06910043
069200             MOVE DETAIL-HEADER      TO PRINT-LINE                06920043
069300             PERFORM W200-WRITE-HEADER-LINE                       06930043
069400         ELSE                                                     06940043
069500             PERFORM W400-WRITE-BLANK-LINE                        06950043
069600             MOVE DETAIL-HEADER-NA   TO PRINT-LINE                06960043
069700             PERFORM W200-WRITE-HEADER-LINE                       06970043
069800         END-IF                                                   06980043
069900     END-IF.                                                      06990043
070000     PERFORM W400-WRITE-BLANK-LINE.                               07000042
070100                                                                  07010032
070200     PERFORM D200-PRINT-VENDOR-TOTAL-LINES                        07020032
070300         VARYING PRINT-SUB FROM +1 BY +1                          07030032
070400             UNTIL PRINT-SUB > MAX-SUB.                           07040037
070500     MOVE SPACES TO PRINT-TABLE.                                  07050032
070600                                                                  07060032
070700* ADD VENDOR TOTALS TO DEPT TOTALS                                07070032
070800     ADD VT-OPEN-SHORT-COST TO DT-OPEN-SHORT-COST.                07080037
070900     ADD VT-OPEN-OVER-COST  TO DT-OPEN-OVER-COST.                 07090037
071000     ADD VT-TR-CDE-10-COST  TO DT-TR-CDE-10-COST.                 07100032
071100     ADD VT-TR-CDE-16-COST  TO DT-TR-CDE-16-COST.                 07110032
071200     ADD VT-TR-CDE-36-COST  TO DT-TR-CDE-36-COST.                 07120032
071300     ADD VT-TR-CDE-37-COST  TO DT-TR-CDE-37-COST.                 07130032
071400     MOVE ZEROS             TO VT-OPEN-SHORT-COST                 07140037
071500                               VT-OPEN-OVER-COST                  07150037
071600                               VT-TR-CDE-10-COST                  07160032
071700                               VT-TR-CDE-16-COST                  07170032
071800                               VT-TR-CDE-36-COST                  07180032
071900                               VT-TR-CDE-37-COST.                 07190032
072000                                                                  07200032
072100* PRINT '-------' DIVIDER                                         07210032
072200     PERFORM W400-WRITE-BLANK-LINE.                               07220042
072300     MOVE HYPHEN-DIVIDER TO PRINT-LINE.                           07230042
072400     PERFORM W200-WRITE-HEADER-LINE.                              07240032
072500                                                                  07250032
072600 EJECT                                                            07260032
072700***************************************************************** 07270032
072800*  PRINT DEPARTMENT TOTAL LINES                                   07280032
072900***************************************************************** 07290032
073000 C200-PRINT-DEPT-TOTAL-LINES.                                     07300032
073100                                                                  07310037
073200     EVALUATE NET-CDE (PRINT-SUB)                                 07320037
073300         WHEN 'OS'                                                07330037
073400             MOVE LIT-OPEN-SHORT-COST   TO DL-LIT-1               07340037
073500             MOVE DT-OPEN-SHORT-COST    TO DL-COST-1              07350037
073600         WHEN 'OO'                                                07360037
073700             MOVE LIT-OPEN-OVER-COST    TO DL-LIT-1               07370037
073800             MOVE DT-OPEN-OVER-COST     TO DL-COST-1              07380037
073900         WHEN OTHER                                               07390037
074000             MOVE SPACES                TO DL-LIT-1               07400037
074100             MOVE ZERO                  TO DL-COST-1              07410037
074200     END-EVALUATE.                                                07420037
074300                                                                  07430032
074400     EVALUATE ADJUST-CDE (PRINT-SUB)                              07440032
074500         WHEN '10'                                                07450032
074600             MOVE LIT-TR-CDE-10-COST    TO DL-LIT-2               07460032
074700             MOVE DT-TR-CDE-10-COST     TO DL-COST-2              07470032
074800             MOVE '<'                   TO DL-DM-L                07480040
074900             MOVE '>'                   TO DL-DM-R                07490040
075000         WHEN '16'                                                07500032
075100             MOVE LIT-TR-CDE-16-COST    TO DL-LIT-2               07510032
075200             MOVE DT-TR-CDE-16-COST     TO DL-COST-2              07520032
075300         WHEN '36'                                                07530032
075400             MOVE LIT-TR-CDE-36-COST    TO DL-LIT-2               07540032
075500             MOVE DT-TR-CDE-36-COST     TO DL-COST-2              07550032
075600             MOVE '<'                   TO DL-DM-L                07560040
075700             MOVE '>'                   TO DL-DM-R                07570040
075800         WHEN '37'                                                07580032
075900             MOVE LIT-TR-CDE-37-COST    TO DL-LIT-2               07590032
076000             MOVE DT-TR-CDE-37-COST     TO DL-COST-2              07600032
076100         WHEN OTHER                                               07610032
076200             MOVE SPACES                TO DL-LIT-2               07620032
076300             MOVE ZERO                  TO DL-COST-2              07630032
076400     END-EVALUATE.                                                07640032
076500                                                                  07650032
076600     PERFORM W300-WRITE-DETAIL-LINE.                              07660046
076700                                                                  07670032
076800 EJECT                                                            07680032
076900***************************************************************** 07690032
077000*  PRINT PO TOTALS, ADD TO VENDOR TOTALS, READ NEXT RECORD        07700032
077100***************************************************************** 07710032
077200 D100-PROCESS-VENDOR.                                             07720032
077300                                                                  07730032
077400* PRINT PO TOTALS                                                 07740032
077500     MOVE +0 TO NET-SUB                                           07750037
077600                ADJUST-SUB.                                       07760037
077700     IF AP269-PAID-INVC-COST NOT = ZERO                           07770032
077800         ADD +1 TO NET-SUB                                        07780032
077900         MOVE 'PI' TO NET-CDE (NET-SUB)                           07790032
078000     END-IF.                                                      07800032
078100     IF AP269-JRNLD-RCV-COST NOT = ZERO                           07810032
078200         ADD +1 TO NET-SUB                                        07820032
078300         MOVE 'JR' TO NET-CDE (NET-SUB)                           07830032
078400     END-IF.                                                      07840032
078500     IF AP269-OPEN-INVC-COST NOT = ZERO                           07850032
078600         ADD +1 TO NET-SUB                                        07860032
078700         MOVE 'OI' TO NET-CDE (NET-SUB)                           07870032
078800     END-IF.                                                      07880032
078900     IF AP269-OPEN-SHORT-COST NOT = ZERO                          07890032
079000         ADD +1 TO NET-SUB                                        07900032
079100         MOVE 'OS' TO NET-CDE (NET-SUB)                           07910032
079200     END-IF.                                                      07920032
079300     IF AP269-OPEN-OVER-COST NOT = ZERO                           07930032
079400         ADD +1 TO NET-SUB                                        07940032
079500         MOVE 'OO' TO NET-CDE (NET-SUB)                           07950032
079600     END-IF.                                                      07960032
079700     IF AP269-TR-CDE-10-COST NOT = ZERO                           07970032
079800         ADD +1 TO ADJUST-SUB                                     07980032
079900         MOVE '10' TO ADJUST-CDE (ADJUST-SUB)                     07990032
080000     END-IF.                                                      08000032
080100     IF AP269-TR-CDE-16-COST NOT = ZERO                           08010032
080200         ADD +1 TO ADJUST-SUB                                     08020032
080300         MOVE '16' TO ADJUST-CDE (ADJUST-SUB)                     08030032
080400     END-IF.                                                      08040032
080500     IF AP269-TR-CDE-36-COST NOT = ZERO                           08050032
080600         ADD +1 TO ADJUST-SUB                                     08060032
080700         MOVE '36' TO ADJUST-CDE (ADJUST-SUB)                     08070032
080800     END-IF.                                                      08080032
080900     IF AP269-TR-CDE-37-COST NOT = ZERO                           08090032
081000         ADD +1 TO ADJUST-SUB                                     08100032
081100         MOVE '37' TO ADJUST-CDE (ADJUST-SUB)                     08110032
081200     END-IF.                                                      08120032
081300                                                                  08130032
081400     IF ADJUST-SUB > NET-SUB                                      08140032
081500         MOVE ADJUST-SUB TO MAX-SUB                               08150032
081600     ELSE                                                         08160032
081700         MOVE NET-SUB TO MAX-SUB                                  08170032
081800     END-IF.                                                      08180032
081900                                                                  08190032
082000     IF (PV-LINE-COUNT + MAX-SUB + 6) > PV-MAX-LINES              08200058
082100         PERFORM W100-WRITE-PAGE-HEADING                          08210046
082200         PERFORM W400-WRITE-BLANK-LINE                            08220042
082300         MOVE VENDOR-HEADER TO PRINT-LINE                         08230032
082400         PERFORM W200-WRITE-HEADER-LINE                           08240032
082500         PERFORM W400-WRITE-BLANK-LINE                            08250058
082600         MOVE ADJUSTMENTS-HEADER TO PRINT-LINE                    08260042
082700         PERFORM W200-WRITE-HEADER-LINE                           08270042
082800         MOVE AP269-PO-NBR TO PH-PO-NBR                           08280043
082900         MOVE PO-HEADER TO PRINT-LINE                             08290043
083000         PERFORM W200-WRITE-HEADER-LINE                           08300043
083100     ELSE                                                         08310042
083200         IF ADJUST-SUB > 0 OR PRINT-ADJ                           08320062
083300             PERFORM W400-WRITE-BLANK-LINE                        08330058
083400             MOVE ADJUSTMENTS-HEADER TO PRINT-LINE                08340042
083500             PERFORM W200-WRITE-HEADER-LINE                       08350042
083600             MOVE AP269-PO-NBR       TO PH-PO-NBR                 08360043
083700             MOVE PO-HEADER          TO PRINT-LINE                08370043
083800             PERFORM W200-WRITE-HEADER-LINE                       08380043
083900         ELSE                                                     08390042
084000             PERFORM W400-WRITE-BLANK-LINE                        08400042
084100             PERFORM W400-WRITE-BLANK-LINE                        08410058
084200             MOVE AP269-PO-NBR       TO PH-PO-NBR-NA              08420043
084300             MOVE PO-HEADER-NA       TO PRINT-LINE                08430043
084400             PERFORM W200-WRITE-HEADER-LINE                       08440043
084500         END-IF                                                   08450042
084600         SET NO-PRINT-ADJ            TO TRUE                      08460062
084700     END-IF.                                                      08470042
084800     PERFORM W400-WRITE-BLANK-LINE.                               08480032
084900                                                                  08490032
085000     PERFORM E200-PRINT-PO-TOTAL-LINES                            08500032
085100         VARYING PRINT-SUB FROM +1 BY +1                          08510032
085200             UNTIL PRINT-SUB > MAX-SUB.                           08520032
085300     MOVE SPACES TO PRINT-TABLE.                                  08530032
085400                                                                  08540032
085500* ADD PO TOTALS TO VENDOR TOTALS                                  08550032
085600     ADD AP269-OPEN-SHORT-COST TO VT-OPEN-SHORT-COST.             08560037
085700     ADD AP269-OPEN-OVER-COST  TO VT-OPEN-OVER-COST.              08570037
085800     ADD AP269-TR-CDE-10-COST  TO VT-TR-CDE-10-COST.              08580032
085900     ADD AP269-TR-CDE-16-COST  TO VT-TR-CDE-16-COST.              08590032
086000     ADD AP269-TR-CDE-36-COST  TO VT-TR-CDE-36-COST.              08600032
086100     ADD AP269-TR-CDE-37-COST  TO VT-TR-CDE-37-COST.              08610032
086200                                                                  08620032
086300     PERFORM R100-READ-INPUT-FILE.                                08630032
086400                                                                  08640032
086500 EJECT                                                            08650032
086600***************************************************************** 08660032
086700*  PRINT VENDOR TOTALS                                            08670032
086800***************************************************************** 08680032
086900 D200-PRINT-VENDOR-TOTAL-LINES.                                   08690032
087000                                                                  08700037
087100     EVALUATE NET-CDE (PRINT-SUB)                                 08710037
087200         WHEN 'OS'                                                08720037
087300             MOVE LIT-OPEN-SHORT-COST   TO DL-LIT-1               08730037
087400             MOVE VT-OPEN-SHORT-COST    TO DL-COST-1              08740037
087500         WHEN 'OO'                                                08750037
087600             MOVE LIT-OPEN-OVER-COST    TO DL-LIT-1               08760037
087700             MOVE VT-OPEN-OVER-COST     TO DL-COST-1              08770037
087800         WHEN OTHER                                               08780037
087900             MOVE SPACES                TO DL-LIT-1               08790037
088000             MOVE ZERO                  TO DL-COST-1              08800037
088100     END-EVALUATE.                                                08810037
088200                                                                  08820032
088300     EVALUATE ADJUST-CDE (PRINT-SUB)                              08830032
088400         WHEN '10'                                                08840032
088500             MOVE LIT-TR-CDE-10-COST    TO DL-LIT-2               08850032
088600             MOVE VT-TR-CDE-10-COST     TO DL-COST-2              08860032
088700             MOVE '<'                   TO DL-DM-L                08870040
088800             MOVE '>'                   TO DL-DM-R                08880040
088900         WHEN '16'                                                08890032
089000             MOVE LIT-TR-CDE-16-COST    TO DL-LIT-2               08900032
089100             MOVE VT-TR-CDE-16-COST     TO DL-COST-2              08910032
089200         WHEN '36'                                                08920032
089300             MOVE LIT-TR-CDE-36-COST    TO DL-LIT-2               08930032
089400             MOVE VT-TR-CDE-36-COST     TO DL-COST-2              08940032
089500             MOVE '<'                   TO DL-DM-L                08950040
089600             MOVE '>'                   TO DL-DM-R                08960040
089700         WHEN '37'                                                08970032
089800             MOVE LIT-TR-CDE-37-COST    TO DL-LIT-2               08980032
089900             MOVE VT-TR-CDE-37-COST     TO DL-COST-2              08990032
090000         WHEN OTHER                                               09000032
090100             MOVE SPACES                TO DL-LIT-2               09010032
090200             MOVE ZERO                  TO DL-COST-2              09020032
090300     END-EVALUATE.                                                09030032
090400                                                                  09040032
090500     PERFORM W300-WRITE-DETAIL-LINE.                              09050046
090600                                                                  09060032
090700 EJECT                                                            09070032
090800***************************************************************** 09080032
090900*  PRINT PO TOTALS                                                09090032
091000***************************************************************** 09100032
091100 E200-PRINT-PO-TOTAL-LINES.                                       09110032
091200                                                                  09120032
091300     EVALUATE NET-CDE (PRINT-SUB)                                 09130032
091400         WHEN 'PI'                                                09140032
091500             MOVE LIT-PAID-INVC-COST    TO DL-LIT-1               09150032
091600             MOVE AP269-PAID-INVC-COST  TO DL-COST-1              09160032
091700         WHEN 'JR'                                                09170032
091800             MOVE LIT-JRNLD-RCV-COST    TO DL-LIT-1               09180032
091900             MOVE AP269-JRNLD-RCV-COST  TO DL-COST-1              09190032
092000         WHEN 'OI'                                                09200032
092100             MOVE LIT-OPEN-INVC-COST    TO DL-LIT-1               09210032
092200             MOVE AP269-OPEN-INVC-COST  TO DL-COST-1              09220032
092300         WHEN 'OS'                                                09230032
092400             MOVE LIT-OPEN-SHORT-COST   TO DL-LIT-1               09240032
092500             MOVE AP269-OPEN-SHORT-COST TO DL-COST-1              09250032
092600         WHEN 'OO'                                                09260032
092700             MOVE LIT-OPEN-OVER-COST    TO DL-LIT-1               09270032
092800             MOVE AP269-OPEN-OVER-COST  TO DL-COST-1              09280032
092900         WHEN OTHER                                               09290032
093000             MOVE SPACES                TO DL-LIT-1               09300032
093100             MOVE ZERO                  TO DL-COST-1              09310032
093200     END-EVALUATE.                                                09320032
093300                                                                  09330032
093400     EVALUATE ADJUST-CDE (PRINT-SUB)                              09340032
093500         WHEN '10'                                                09350032
093600             MOVE LIT-TR-CDE-10-COST    TO DL-LIT-2               09360032
093700             MOVE AP269-TR-CDE-10-COST  TO DL-COST-2              09370032
093800             MOVE '<'                   TO DL-DM-L                09380040
093900             MOVE '>'                   TO DL-DM-R                09390040
094000         WHEN '16'                                                09400032
094100             MOVE LIT-TR-CDE-16-COST    TO DL-LIT-2               09410032
094200             MOVE AP269-TR-CDE-16-COST  TO DL-COST-2              09420032
094300         WHEN '36'                                                09430032
094400             MOVE LIT-TR-CDE-36-COST    TO DL-LIT-2               09440032
094500             MOVE AP269-TR-CDE-36-COST  TO DL-COST-2              09450032
094600             MOVE '<'                   TO DL-DM-L                09460040
094700             MOVE '>'                   TO DL-DM-R                09470040
094800         WHEN '37'                                                09480032
094900             MOVE LIT-TR-CDE-37-COST    TO DL-LIT-2               09490032
095000             MOVE AP269-TR-CDE-37-COST  TO DL-COST-2              09500032
095100         WHEN OTHER                                               09510032
095200             MOVE SPACES                TO DL-LIT-2               09520032
095300             MOVE ZERO                  TO DL-COST-2              09530032
095400     END-EVALUATE.                                                09540032
095500                                                                  09550032
095600     PERFORM W300-WRITE-DETAIL-LINE.                              09560046
095700                                                                  09570032
095800 EJECT                                                            09580032
095900***************************************************************** 09590032
096000*  PRINT GRAND TOTALS                                             09600032
096100***************************************************************** 09610032
096200 F200-PRINT-GRAND-TOTAL-LINES.                                    09620032
096300                                                                  09630037
096400     EVALUATE NET-CDE (PRINT-SUB)                                 09640037
096500         WHEN 'OS'                                                09650037
096600             MOVE LIT-OPEN-SHORT-COST   TO DL-LIT-1               09660037
096700             MOVE GT-OPEN-SHORT-COST    TO DL-COST-1              09670039
096800         WHEN 'OO'                                                09680037
096900             MOVE LIT-OPEN-OVER-COST    TO DL-LIT-1               09690037
097000             MOVE GT-OPEN-OVER-COST     TO DL-COST-1              09700039
097100         WHEN OTHER                                               09710037
097200             MOVE SPACES                TO DL-LIT-1               09720037
097300             MOVE ZERO                  TO DL-COST-1              09730037
097400     END-EVALUATE.                                                09740037
097500                                                                  09750037
097600     EVALUATE ADJUST-CDE (PRINT-SUB)                              09760032
097700         WHEN '10'                                                09770032
097800             MOVE LIT-TR-CDE-10-COST    TO DL-LIT-2               09780032
097900             MOVE GT-TR-CDE-10-COST     TO DL-COST-2              09790032
098000             MOVE '<'                   TO DL-DM-L                09800040
098100             MOVE '>'                   TO DL-DM-R                09810040
098200         WHEN '16'                                                09820032
098300             MOVE LIT-TR-CDE-16-COST    TO DL-LIT-2               09830032
098400             MOVE GT-TR-CDE-16-COST     TO DL-COST-2              09840032
098500         WHEN '36'                                                09850032
098600             MOVE LIT-TR-CDE-36-COST    TO DL-LIT-2               09860032
098700             MOVE GT-TR-CDE-36-COST     TO DL-COST-2              09870032
098800             MOVE '<'                   TO DL-DM-L                09880040
098900             MOVE '>'                   TO DL-DM-R                09890040
099000         WHEN '37'                                                09900032
099100             MOVE LIT-TR-CDE-37-COST    TO DL-LIT-2               09910032
099200             MOVE GT-TR-CDE-37-COST     TO DL-COST-2              09920032
099300         WHEN OTHER                                               09930032
099400             MOVE SPACES                TO DL-LIT-2               09940032
099500             MOVE ZERO                  TO DL-COST-2              09950032
099600     END-EVALUATE.                                                09960032
099700                                                                  09970032
099800     PERFORM W300-WRITE-DETAIL-LINE.                              09980046
099900                                                                  09990032
100000 EJECT                                                            10000032
100100***************************************************************** 10010032
100200*  READ THE REPORT DATA FILE FROM APKUT028                        10020032
100300***************************************************************** 10030032
100400 R100-READ-INPUT-FILE.                                            10040032
100500                                                                  10050032
100600     READ SUMMARIZED-RECON-RESULTS-FILE INTO AP269-RECORD         10060032
100700         AT END                                                   10070032
100800             SET END-OF-INPUT-RECS TO TRUE.                       10080032
100900                                                                  10090032
101000 EJECT                                                            10100032
101100***************************************************************** 10110046
101200*  WRITE PAGE HEADING                                             10120046
101300***************************************************************** 10130046
101400 W100-WRITE-PAGE-HEADING.                                         10140046
101500                                                                  10150046
101600     ADD 1                       TO PV-PAGE-COUNT.                10160046
101700     MOVE PV-PAGE-COUNT          TO DP132O-PAGE-NUMBER.           10170046
101800                                                                  10180046
101900     WRITE RPT01-RECORD FROM DP132O-STANDRD-HEADER-132-COLS       10190046
102000         AFTER PAGE.                                              10200046
102100                                                                  10210046
102200     WRITE RPT01-RECORD FROM HDR-LINE2 AFTER 1.                   10220046
102300     MOVE +2                     TO PV-LINE-COUNT.                10230046
102400                                                                  10240046
102500     IF NOT END-OF-INPUT-RECS                                     10250046
102600         PERFORM W400-WRITE-BLANK-LINE                            10260046
102700         MOVE GMM-HEADER   TO PRINT-LINE                          10270046
102800         PERFORM W200-WRITE-HEADER-LINE                           10280046
102900         MOVE DMM-HEADER   TO PRINT-LINE                          10290046
103000         PERFORM W200-WRITE-HEADER-LINE                           10300046
103100         MOVE BUYER-HEADER TO PRINT-LINE                          10310046
103200         PERFORM W200-WRITE-HEADER-LINE                           10320046
103300         MOVE DEPT-HEADER  TO PRINT-LINE                          10330046
103400         PERFORM W200-WRITE-HEADER-LINE                           10340046
103500     END-IF.                                                      10350046
103600                                                                  10360046
103700 EJECT                                                            10370046
103800***************************************************************** 10380032
103900*  WRITE HEADER LINES.  USED FOR PRINTING DEPT, VENDOR, PO, AND   10390032
104000*  TOTALS HEADINGS.                                               10400032
104100***************************************************************** 10410032
104200 W200-WRITE-HEADER-LINE.                                          10420032
104300                                                                  10430032
104400*    IF PV-LINE-COUNT > PV-MAX-LINES                              10440046
104500*        PERFORM W100-WRITE-PAGE-HEADING                          10450046
104600*    END-IF.                                                      10460046
104700                                                                  10470032
104800     WRITE RPT01-RECORD FROM PRINT-LINE AFTER 1.                  10480042
104900     ADD +1 TO PV-LINE-COUNT.                                     10490042
105000     MOVE SPACES TO PRINT-LINE.                                   10500046
105100 EJECT                                                            10510032
105200***************************************************************** 10520046
105300*  WRITE A DETAIL LINE.  USED FOR PRINTING ALL TOTALS.            10530046
105400***************************************************************** 10540046
105500 W300-WRITE-DETAIL-LINE.                                          10550046
105600                                                                  10560046
105700*    IF PV-LINE-COUNT > PV-MAX-LINES                              10570046
105800*        PERFORM W100-WRITE-PAGE-HEADING                          10580046
105900*    END-IF.                                                      10590046
106000                                                                  10600046
106100     WRITE RPT01-RECORD FROM DL-DETAIL-LINE AFTER 1.              10610046
106200     ADD +1 TO PV-LINE-COUNT.                                     10620046
106300     MOVE SPACES TO DL-DETAIL-LINE.                               10630046
106400 EJECT                                                            10640046
106500***************************************************************** 10650032
106600*  WRITE BLANK LINE                                               10660032
106700***************************************************************** 10670032
106800 W400-WRITE-BLANK-LINE.                                           10680032
106900                                                                  10690032
107000     MOVE SPACES TO PRINT-LINE.                                   10700032
107100     WRITE RPT01-RECORD FROM PRINT-LINE AFTER 1.                  10710032
107200     ADD +1 TO PV-LINE-COUNT.                                     10720032
