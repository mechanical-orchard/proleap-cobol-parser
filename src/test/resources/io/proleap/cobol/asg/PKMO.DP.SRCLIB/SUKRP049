000100***************************************************************** 00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000300***************************************************************** 00030001
000400*                                                                 00040001
000500 PROGRAM-ID.             SUKRP049.                                00050007
000600 AUTHOR.                 PAUL JORGENSEN.                          00060007
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070001
000800 DATE-WRITTEN.           MAY 2006.                                00080007
000900 DATE-COMPILED.                                                   00090001
001000*                                                                 00100001
001100***************************************************************** 00110001
001200*  THIS PROGRAM WILL BE USED TO CREATE A REPORT LISTING ALL OF THE00120001
001300*  UNKNOWN/EMPTY CARTONS THAT WERE DIVERTED CURRENT DAY.          00130007
001400***************************************************************** 00140001
001500 ENVIRONMENT DIVISION.                                            00150001
001600***************************************************************** 00160001
001700 CONFIGURATION SECTION.                                           00170001
001800 SOURCE-COMPUTER.                        IBM-3090.                00180001
001900 OBJECT-COMPUTER.                        IBM-3090.                00190001
002000 INPUT-OUTPUT SECTION.                                            00200001
002100 FILE-CONTROL.                                                    00210001
002200                                                                  00220001
002300     SELECT EMPTY-UNKNOWN-FILE                                    00230022
002400         ASSIGN TO INP01.                                         00240001
002500                                                                  00250001
002600     SELECT TODAY-EMPTY-UNKNOWN-FILE                              00260099
002700         ASSIGN TO OUT01.                                         00270022
002800                                                                  00280022
002900     SELECT REPORT-FILE-1                                         00290001
003000         ASSIGN TO RPT01.                                         00300001
003100                                                                  00310001
003200***************************************************************** 00320001
003300 DATA DIVISION.                                                   00330001
003400***************************************************************** 00340001
003500 FILE SECTION.                                                    00350001
003600                                                                  00360001
003700 FD  EMPTY-UNKNOWN-FILE                                           00370022
003800     RECORDING MODE IS F                                          00380001
003900     LABEL RECORDS ARE STANDARD                                   00390001
004000     BLOCK CONTAINS 0 RECORDS.                                    00400001
004100 01  EMPTY-UNKNOWN-RECORD             PIC X(150).                 00410022
004200                                                                  00420001
004300 FD  TODAY-EMPTY-UNKNOWN-FILE                                     00430022
004400     RECORDING MODE IS F                                          00440022
004500     LABEL RECORDS ARE STANDARD                                   00450022
004600     BLOCK CONTAINS 0 RECORDS.                                    00460022
004700 01  TODAY-EMPTY-UNKNOWN-RECORD       PIC X(150).                 00470022
004800                                                                  00480022
004900 FD  REPORT-FILE-1                                                00490001
005000     RECORDING MODE IS F                                          00500001
005100     BLOCK CONTAINS 0 RECORDS.                                    00510001
005200 01  REPORT-RECORD-1                  PIC X(132).                 00520001
005300                                                                  00530001
005400/                                                                 00540001
005500***************************************************************** 00550001
005600 WORKING-STORAGE SECTION.                                         00560001
005700***************************************************************** 00570001
005800                                                                  00580001
005900 01  PS-SWITCHES.                                                 00590001
006000     05  PS-END-OF-INPUT-FILE-SW      PIC X(01) VALUE 'N'.        00600001
006100         88  PS-END-OF-INPUT                    VALUE 'Y'.        00610001
006200         88  PS-NOT-END-OF-INPUT                VALUE 'N'.        00620001
006300     05  PS-PAGE-SW                   PIC X(01) VALUE 'N'.        00630001
006400         88  PS-NEW-PAGE                        VALUE 'Y'.        00640001
006500         88  PS-SAME-PAGE                       VALUE 'N'.        00650001
006600     05  PS-END-OTBND-CART-CSR-SW     PIC X(01) VALUE 'N'.        00660072
006700         88  PS-END-OTBND-CART-CSR-YES          VALUE 'Y'.        00670099
006800         88  PS-END-OTBND-CART-CSR-NO           VALUE 'N'.        00680099
006900     05  PS-PRINT-INPUT-SW            PIC X(01) VALUE 'N'.        00690099
007000         88  PS-PRINT-INPUT                     VALUE 'Y'.        00700099
007100         88  PS-NOT-PRINT-INPUT                 VALUE 'N'.        00710099
007200                                                                  00720001
007300 01  DK-DB2-KEYS.                                                 00730001
007400     05  DK-RUN-DATE                  PIC X(10).                  00740001
007500     05  DK-WEEK-END-DATE             PIC X(10).                  00750001
007600     05  DK-OPER-ID                   PIC S9(4) COMP.             00760001
007700     05  DK-DB2-TMST-1                PIC X(26).                  00770001
007800     05  DK-DB2-TMST-2                PIC X(26).                  00780001
007900                                                                  00790001
008000 01  DN-NULL-INDICATORS.                                          00800001
008100     05  DN-OTBND-TRIP-NULL           PIC S9(04) COMP VALUE ZERO. 00810054
008200                                                                  00820001
008300 01  PV-DATE-RECORD.                                              00830001
008400     05  PV-FROM-DATE                 PIC X(10) VALUE SPACES.     00840001
008500     05  FILLER                       PIC X(01) VALUE SPACES.     00850001
008600     05  PV-TO-DATE                   PIC X(10) VALUE SPACES.     00860001
008700                                                                  00870001
008800 01  SD-SYSTEM-DATE.                                              00880001
008900     05  SD-SYSTEM-DATE-YY            PIC  9(02)   VALUE ZERO.    00890021
009000     05  SD-SYSTEM-DATE-MM            PIC  9(02)   VALUE ZERO.    00900021
009100     05  SD-SYSTEM-DATE-DD            PIC  9(02)   VALUE ZERO.    00910021
009200                                                                  00920001
009300 01  ST-SYSTEM-TIME.                                              00930001
009400     05  ST-SYSTEM-HOUR               PIC  9(02)   VALUE ZERO.    00940021
009500     05  ST-SYSTEM-MINUTE             PIC  9(02)   VALUE ZERO.    00950021
009600     05  FILLER                       PIC  9(04)   VALUE ZERO.    00960021
009700                                                                  00970001
009800 01  PV-VARIABLES.                                                00980001
009900     05  PV-BEGINNING-SML             PIC S9(18)V COMP-3.         00990021
010000     05  PV-ENDING-SML                PIC S9(18)V COMP-3.         01000021
010100     05  PV-SHIPT-UNT-ID              PIC  9(20).                 01010099
010200     05  FILLER REDEFINES PV-SHIPT-UNT-ID.                        01020099
010300         10  FILLER                   PIC X(05).                  01030099
010400         10  PV-SHIPT-UNT-ID-STORE    PIC 9(04).                  01040099
010500         10  FILLER                   PIC X(11).                  01050099
010600     05  PV-READ-COUNT                PIC S9(7) COMP-3            01060001
010700                                                VALUE ZERO.       01070001
010800     05  PV-REC-READ-QTY              PIC S9(7) COMP-3            01080001
010900                                                VALUE ZERO.       01090001
011000     05  PV-WRITE-COUNT               PIC S9(7) COMP-3            01100001
011100                                                VALUE ZERO.       01110001
011200     05  PV-PAGE-COUNT                PIC S9(3) COMP-3            01120001
011300                                                VALUE ZERO.       01130001
011400     05  PV-LINE-COUNT                PIC S9(04) VALUE ZERO       01140001
011500                                                 COMP SYNC.       01150001
011600***************************************************************   01160001
011700     05  PV-TOTAL-DIVERTS            PIC S9(07) VALUE ZERO        01170001
011800                                                 COMP SYNC.       01180001
011900     05  PV-SHIPPING-DOOR             PIC S9(07) VALUE ZERO       01190001
012000                                                 COMP SYNC.       01200001
012100     05  PV-STORAGE-DOOR              PIC S9(07) VALUE ZERO       01210001
012200                                                 COMP SYNC.       01220001
012300     05  PV-SHUTTLE-DOOR              PIC S9(07) VALUE ZERO       01230001
012400                                                 COMP SYNC.       01240001
012500     05  PV-OTHER                     PIC S9(07) VALUE ZERO       01250001
012600                                                 COMP SYNC.       01260001
012700     05  PV-DUPLICATE-DIVERTS         PIC S9(07) VALUE ZERO       01270001
012800                                                 COMP SYNC.       01280001
012900     05  PV-NO-INFO-DIVERTS           PIC S9(07) VALUE ZERO       01290001
013000                                                 COMP SYNC.       01300001
013100     05  PV-INACTIVE-DIVERTS          PIC S9(07) VALUE ZERO       01310001
013200                                                 COMP SYNC.       01320001
013300                                                                  01330001
013400***************************************************************   01340001
013500     05  PV-DISPLAY-COUNT             PIC ZZZ,ZZZ,ZZ9.            01350001
013600     05  PV-STORE-NBR                 PIC S9(4) COMP.             01360001
013700     05  PV-STORE-NAME                PIC X(25) VALUE SPACES.     01370001
013800     05  PV-LOCATION-NBR              PIC 9(04) VALUE ZEROS.      01380001
013900     05  PV-DC                        PIC S9(04) COMP.            01390025
014000     05  PV-PREV-DC                   PIC S9(04) COMP.            01400025
014100                                                                  01410001
014200     05  PV-DB2-FUNCTION              PIC X(30) VALUE SPACES.     01420001
014300     05  PV-DB2-TABLE-NAME            PIC X(30) VALUE SPACES.     01430001
014400     05  PV-PARAGRAPH                 PIC X(30) VALUE SPACES.     01440001
014500     05  PV-DISPLAY-SML               PIC 9(20).                  01450092
014600     05  PV-DISPLAY-PO                PIC 9(09).                  01460092
014700     05  PV-DISPLAY-RCVR              PIC 9(04).                  01470092
014800     05  PV-DISP-NUMBER               PIC Z,ZZZ,ZZ9.              01480001
014900     05  PV-DISP-LOC                  PIC  9(4).                  01490049
015000                                                                  01500001
015100     05  PV-RUN-DATE                  PIC X(10) VALUE SPACES.     01510001
015200     05  PV-SAVE-START-DATE           PIC X(10) VALUE SPACES.     01520001
015300     05  PV-ERROR-MESSAGE-1           PIC X(60)  VALUE SPACES.    01530001
015400     05  PV-ERROR-MESSAGE-2           PIC X(60)  VALUE SPACES.    01540001
015500     05  PV-DB2-YEAR                  PIC S9(08) COMP             01550001
015600                                          VALUE ZERO.             01560001
015700     05  PV-DB2-MONTH                 PIC S9(08) COMP             01570001
015800                                          VALUE ZERO.             01580001
015900     05  PV-DB2-DAY                   PIC S9(08) COMP             01590001
016000                                          VALUE ZERO.             01600001
016100     05  PV-DB2-HOUR                  PIC S9(08) COMP             01610001
016200                                          VALUE ZERO.             01620001
016300     05  PV-DB2-MINUTE                PIC S9(08) COMP             01630001
016400                                          VALUE ZERO.             01640001
016500     05  PV-DB2-SECOND                PIC S9(08) COMP             01650001
016600                                          VALUE ZERO.             01660001
016700                                                                  01670001
016800******************************************************************01680001
016900 01  PV-DATE-FIELDS.                                              01690086
017000     05  PV-DB2-TMST.                                             01700001
017100         10 PV-DB2-TMST-CCYY          PIC  9(04).                 01710001
017200         10 FILLER                    PIC  X(01).                 01720001
017300         10 PV-DB2-TMST-MM            PIC  9(02).                 01730001
017400         10 FILLER                    PIC  X(01).                 01740001
017500         10 PV-DB2-TMST-DD            PIC  9(02).                 01750001
017600         10 FILLER                    PIC  X(01).                 01760001
017700         10 PV-DB2-TMST-HH            PIC  9(02).                 01770001
017800         10 FILLER                    PIC  X(01).                 01780001
017900         10 PV-DB2-TMST-MN            PIC  9(02).                 01790001
018000         10 FILLER                    PIC  X(01).                 01800001
018100         10 PV-DB2-TMST-SS            PIC  9(02).                 01810001
018200         10 FILLER                    PIC  X(07).                 01820001
018300     05  PV-DIVERT-DATE               PIC  X(10).                 01830056
018400     05  FILLER REDEFINES PV-DIVERT-DATE.                         01840056
018500         10 FILLER                    PIC  X(02).                 01850059
018600         10 PV-DIVERT-DATE-YY         PIC  X(02).                 01860059
018700         10 FILLER                    PIC  X(01).                 01870059
018800         10 PV-DIVERT-DATE-MM         PIC  X(02).                 01880059
018900         10 FILLER                    PIC  X(01).                 01890059
019000         10 PV-DIVERT-DATE-DD         PIC  X(02).                 01900059
019100     05  PV-DIVERT-TIME               PIC  X(08).                 01910057
019200     05  FILLER REDEFINES PV-DIVERT-TIME.                         01920093
019300         10 PV-DIVERT-TIME-HH         PIC  X(02).                 01930057
019400         10 FILLER                    PIC  X(01).                 01940057
019500         10 PV-DIVERT-TIME-MM         PIC  X(02).                 01950057
019600         10 FILLER                    PIC  X(01).                 01960057
019700         10 PV-DIVERT-TIME-SS         PIC  X(02).                 01970057
019800     05  PV-CREATE-DATE               PIC  X(10).                 01980086
019900     05  FILLER REDEFINES PV-CREATE-DATE.                         01990093
020000         10 FILLER                    PIC  X(02).                 02000086
020100         10 PV-CREATE-DATE-YY         PIC  X(02).                 02010086
020200         10 FILLER                    PIC  X(01).                 02020099
020300         10 PV-CREATE-DATE-MM         PIC  X(02).                 02030086
020400         10 FILLER                    PIC  X(01).                 02040099
020500         10 PV-CREATE-DATE-DD         PIC  X(02).                 02050086
020600     05  PV-CREATE-TIME               PIC  X(08).                 02060086
020700     05  FILLER REDEFINES PV-CREATE-TIME.                         02070093
020800         10 PV-CREATE-TIME-HH         PIC  X(02).                 02080086
020900         10 FILLER                    PIC  X(01).                 02090099
021000         10 PV-CREATE-TIME-MM         PIC  X(02).                 02100086
021100         10 FILLER                    PIC  X(01).                 02110099
021200         10 PV-CREATE-TIME-SS         PIC  X(02).                 02120086
021300     05  PV-FORMAT-DATE-TIME.                                     02130099
021400         10  PV-FORMAT-DATE-MM            PIC X(02).              02140099
021500         10  FILLER                       PIC X(01) VALUE '/'.    02150099
021600         10  PV-FORMAT-DATE-DD            PIC X(02).              02160099
021700         10  FILLER                       PIC X(01) VALUE '/'.    02170099
021800         10  PV-FORMAT-DATE-YY            PIC X(02).              02180099
021900         10  FILLER                       PIC X(01) VALUE SPACE.  02190099
022000         10  PV-FORMAT-TIME-HH            PIC X(02).              02200099
022100         10  FILLER                       PIC X(01) VALUE ':'.    02210099
022200         10  PV-FORMAT-TIME-MM            PIC X(02).              02220099
022300                                                                  02230001
022400     05  PV-DB2-TMST-1.                                           02240001
022500         10  PV-DB2-DATE-1                PIC X(10) VALUE SPACES. 02250001
022600         10  FILLER                       PIC X(16) VALUE         02260001
022700                              '-00.00.00.000000'.                 02270001
022800     05  PV-DB2-TMST-2.                                           02280001
022900         10  PV-DB2-DATE-2                PIC X(10) VALUE SPACES. 02290001
023000         10  FILLER                       PIC X(16) VALUE         02300001
023100                              '-23.59.59.999999'.                 02310001
023200                                                                  02320001
023300                                                                  02330001
023400 01  PV-ABEND-FIELDS.                                             02340001
023500     05  PV-ABEND-CODE                PIC S9(04) VALUE +0         02350001
023600                                                 COMP SYNC.       02360001
023700     05  PV-DB2-OPERATION-MESSAGE-1   PIC  X(79) VALUE SPACES.    02370001
023800     05  PV-DB2-OPERATION-MESSAGE-2   PIC  X(79) VALUE SPACES.    02380001
023900     05  PV-DB2-OPERATION-MESSAGE-3   PIC  X(79) VALUE SPACES.    02390001
024000     05  PV-DB2-OPERATION-ATTEMPTED   PIC  X(30)  VALUE SPACE.    02400001
024100/                                                                 02410001
024200 01  PC-CONSTANTS.                                                02420001
024300     05  PC-SUKRP049                  PIC X(08) VALUE 'SUKRP049'. 02430007
024400     05  PC-CURRENT-PROGRAM-NAME      PIC X(08) VALUE 'SUKRP049'. 02440007
024500     05  PC-CRTN-STATUS-PGM           PIC X(08) VALUE 'PCKUT713'. 02450038
024600     05  PC-END-OF-PAGE               PIC S9(3) COMP-3 VALUE +60. 02460001
024700     05  PC-MAX-LINE-COUNT            PIC S9(3) VALUE +60         02470001
024800                                                COMP-3.           02480014
024900     05  PC-ASTERISKS                 PIC X(07) VALUE '*******'.  02490014
025000/                                                                 02500001
025100******************************************************************02510001
025200*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               02520001
025300******************************************************************02530001
025400     COPY DPWS132O.                                               02540001
025500*                                                                 02550001
025600 01  HL-HEADING-LINE-1.                                           02560001
025700     05  FILLER                      PIC  X(37).                  02570007
025800     05  FILLER                      PIC  X(59)  VALUE            02580099
025900     'DAILY - EMPTY/UNKNOWN CARTONS LOADED ONTO OUTBOUND TRAILER'.02590099
026000     05  FILLER                      PIC  X(37).                  02600099
026100                                                                  02610001
026200 01  HL-HEADING-LINE-2.                                           02620001
026300     05  FILLER                      PIC  X(16)  VALUE            02630001
026400            '  DC LOCATION:  '.                                   02640001
026500     05  HL2-LOCATION.                                            02650001
026600         10  HL2-OPER-ID             PIC  X(04) VALUE SPACES.     02660001
026700         10  FILLER                  PIC  X(01) VALUE SPACES.     02670001
026800         10  FILLER                  PIC  X(01) VALUE '-'.        02680001
026900         10  FILLER                  PIC  X(01) VALUE SPACES.     02690001
027000         10  HL2-LOC-DESC            PIC  X(25) VALUE SPACES.     02700001
027100         10  FILLER                  PIC  X(84) VALUE SPACES.     02710010
027200                                                                  02720010
027300 01  HL-HEADING-LINE-3.                                           02730001
027400     05  FILLER                      PIC  X(10)  VALUE SPACES.    02740008
027500     05  FILLER                      PIC  X(21)  VALUE            02750008
027600      'PURCHASE  RCVR   PACK'.                                    02760008
027700     05  FILLER                      PIC  X(25)  VALUE SPACES.    02770009
027800     05  FILLER                      PIC  X(35)  VALUE            02780009
027900      'STORE    OUTBOUND  CRE   CREATE    '.                      02790009
028000     05  FILLER                      PIC  X(41)  VALUE            02800009
028100      ' --- CREATE ---  --- DIVERT ---   DOOR   '.                02810099
028200                                                                  02820001
028300 01  HL-HEADING-LINE-4.                                           02830001
028400     05  FILLER                      PIC  X(10)  VALUE SPACES.    02840010
028500     05  FILLER                      PIC  X(34)  VALUE            02850011
028600      ' ORDER     NBR   TYPE   SML NUMBER'.                       02860011
028700     05  FILLER                      PIC  X(12)  VALUE SPACES.    02870011
028800     05  FILLER                      PIC  X(35)  VALUE            02880010
028900      ' NBR       TRIP    SRC   USER ID   '.                      02890012
029000     05  FILLER                      PIC  X(41)  VALUE            02900010
029100      '   DATE    TIME    DATE    TIME    ID    '.                02910099
029200                                                                  02920001
029300 01  DL-DETAIL-LINE-1.                                            02930001
029400     05  FILLER                       PIC X(01) VALUE SPACES.     02940001
029500     05  DL1-ASTERISKS-1              PIC X(07).                  02950099
029600     05  FILLER                       PIC X(01) VALUE SPACES.     02960013
029700     05  DL1-PO-NBR                   PIC Z(09).                  02970013
029800     05  DL1-PO-NBR-X REDEFINES DL1-PO-NBR                        02980063
029900                                      PIC X(09).                  02990063
030000     05  FILLER                       PIC X(02) VALUE SPACES.     03000013
030100     05  DL1-RCVR-NBR                 PIC Z(04).                  03010063
030200     05  DL1-RCVR-NBR-X REDEFINES DL1-RCVR-NBR                    03020063
030300                                      PIC X(04).                  03030063
030400     05  FILLER                       PIC X(02) VALUE SPACES.     03040001
030500     05  DL1-PACK-TYPE                PIC X(06).                  03050063
030600     05  DL1-ASTERISKS-2              PIC X(02) VALUE SPACES.     03060099
030700     05  DL1-SHIPT-UNT-ID             PIC 9(20).                  03070006
030800     05  DL1-ASTERISKS-3              PIC X(02) VALUE SPACES.     03080099
030900     05  FILLER                       PIC X(01) VALUE SPACES.     03090099
031000     05  DL1-STORE-NBR                PIC Z(04).                  03100014
031100     05  FILLER                       PIC X(03) VALUE SPACES.     03110014
031200     05  DL1-OUTBOUND-TRIP-ID         PIC 9(09).                  03120069
031300     05  DL1-OUTBOUND-TRIP-ID-X REDEFINES DL1-OUTBOUND-TRIP-ID    03130099
031400                                      PIC X(09).                  03140099
031500     05  FILLER                       PIC X(02) VALUE SPACES.     03150001
031600     05  DL1-SRC-ID                   PIC X(03).                  03160001
031700     05  FILLER                       PIC X(03) VALUE SPACES.     03170015
031800     05  DL1-CREATE-USER-ID           PIC X(08).                  03180015
031900     05  FILLER                       PIC X(03) VALUE SPACES.     03190015
032000     05  DL1-CREATE-DATE-TIME         PIC X(14).                  03200099
032100     05  FILLER                       PIC X(02) VALUE SPACES.     03210059
032200     05  DL1-DIVERT-DATE-TIME         PIC X(14).                  03220099
032300     05  FILLER                       PIC X(03) VALUE SPACES.     03230059
032400     05  DL1-DOOR-ID                  PIC X(04).                  03240090
032500     05  FILLER                       PIC X(06) VALUE SPACES.     03250016
032600                                                                  03260001
032700 01  ER-END-OF-REPORT-LINE.                                       03270001
032800     05  FILLER                       PIC X(19)  VALUE            03280001
032900         '** END OF REPORT **'.                                   03290001
033000     05  FILLER                       PIC X(113)  VALUE SPACES.   03300001
033100                                                                  03310001
033200 01  EP-EMPTY-REPORT-LINE.                                        03320001
033300     05  FILLER                       PIC X(34)  VALUE SPACES.    03330001
033400     05  FILLER                       PIC X(52)  VALUE            03340001
033500      '*************** EMPTY INPUT FILE *******************'.     03350001
033600     05  FILLER                       PIC X(49)  VALUE SPACES.    03360001
033700                                                                  03370001
033800 01  DL-BLANK-LINE                    PIC X(132) VALUE SPACES.    03380001
033900                                                                  03390001
034000 01  EL1-ERROR-LINE-1P.                                           03400001
034100     05  FILLER                      PIC  X(02)     VALUE SPACES. 03410001
034200     05  FILLER                      PIC  X(48)     VALUE         03420001
034300         'A PROBLEM WAS ENCOUNTERED DURING THE PROCESS OF '.      03430001
034400     05  FILLER                      PIC  X(49)     VALUE         03440001
034500         'CREATING YOUR REPORT.   THIS REPORT COULD NOT BE '.     03450001
034600     05  FILLER                      PIC  X(33)     VALUE         03460001
034700         'COMPLETED.                       '.                     03470001
034800                                                                  03480001
034900 01  EL2-ERROR-LINE-2F.                                           03490001
035000     05  FILLER                      PIC  X(02)     VALUE SPACES. 03500001
035100     05  FILLER                      PIC  X(36)     VALUE         03510001
035200         'NONE OF YOUR REPORTS WERE CREATED.  '.                  03520001
035300     05  FILLER                      PIC  X(36)     VALUE         03530001
035400         'PLEASE RE-SUBMIT YOUR REQUEST AGAIN.'.                  03540001
035500     05  FILLER                      PIC  X(58)     VALUE SPACES. 03550001
035600                                                                  03560001
035700 01  EL3-ERROR-LINE-3.                                            03570001
035800     05  FILLER                      PIC  X(02)     VALUE SPACES. 03580001
035900     05  FILLER                      PIC  X(50)     VALUE         03590001
036000         'YOUR REQUEST WAS AS FOLLOWS:                      '.    03600001
036100     05  FILLER                      PIC  X(81)     VALUE SPACES. 03610001
036200                                                                  03620001
036300 01  EL4-ERROR-LINE-4.                                            03630001
036400     05  FILLER                      PIC  X(02)     VALUE SPACES. 03640001
036500     05  FILLER                      PIC  X(18)     VALUE         03650001
036600         'REQUESTOR       : '.                                    03660001
036700     05  EL4-REQUESTOR-ID            PIC  X(10)     VALUE SPACES. 03670001
036800     05  FILLER                      PIC  X(07)     VALUE SPACES. 03680001
036900     05  FILLER                      PIC  X(21)     VALUE         03690001
037000         'PRINTER DESTINATION: '.                                 03700001
037100     05  EL4-PRINTER-ID              PIC  X(10)     VALUE SPACES. 03710001
037200     05  FILLER                      PIC  X(65)     VALUE SPACES. 03720001
037300                                                                  03730001
037400 01  EL5-ERROR-LINE-5B.                                           03740001
037500     05  FILLER                      PIC  X(02)     VALUE SPACES. 03750001
037600     05  FILLER                      PIC  X(18)     VALUE         03760001
037700         'START DATE RANGE: '.                                    03770001
037800     05  EL5-START-DATE-RANGE        PIC  X(10).                  03780001
037900     05  FILLER                      PIC  X(07)     VALUE SPACES. 03790001
038000     05  FILLER                      PIC  X(21)     VALUE         03800001
038100         'END DATE RANGE     : '.                                 03810001
038200     05  EL5-END-DATE-RANGE          PIC  X(10).                  03820001
038300     05  FILLER                      PIC  X(20)     VALUE SPACES. 03830001
038400/                                                                 03840001
038500******************************************************************03850001
038600*  RECORD LAYOUT FOR INPUT FILE                                   03860001
038700******************************************************************03870001
038800     COPY SURD067.                                                03880046
038900/                                                                 03890001
039000*  LOGISTICS DOMAIN LOCATION MODULE                               03900001
039100*                                                                 03910001
039200     COPY XLWS071.                                                03920001
039300                                                                  03930046
039400*COPYBOOK FOR CARTON STATUS MODULE - PCKUT713                     03940046
039500     COPY PCWS046.                                                03950046
039600******************************************************************03960001
039700*  COPYBOOK USED BY MBS SYSTEM                                    03970001
039800******************************************************************03980001
039900     COPY DPWS003.                                                03990001
040000*                                                                 04000001
040100******************************************************************04010001
040200*  WORKING STORAGE AREA FOR NAME REFORMAT DPPD024                 04020001
040300******************************************************************04030001
040400     COPY DPWS024.                                                04040001
040500/                                                                 04050001
040600******************************************************************04060001
040700*  DB2 FORMATTED MESSAGE AREA                                     04070001
040800******************************************************************04080001
040900     COPY DPWS004.                                                04090001
041000/                                                                 04100001
041100******************************************************************04110001
041200* CORPORATE DATE ROUTINES                                         04120001
041300******************************************************************04130001
041400     COPY DPWS500.                                                04140001
041500/                                                                 04150001
041600*DB2 AREA FOR SUT_OTBND_CART TABLE                                04160020
041700     EXEC SQL                                                     04170020
041800          INCLUDE SUT00024                                        04180099
041900     END-EXEC.                                                    04190020
042000                                                                  04200063
042100*DB2 AREA FOR SUT_OTBND_UPC TABLE                                 04210063
042200     EXEC SQL                                                     04220063
042300          INCLUDE SUT00028                                        04230063
042400     END-EXEC.                                                    04240063
042500                                                                  04250066
042600*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE RECEIVING          04260064
042700*  TABLE                                                          04270064
042800     EXEC SQL                                                     04280064
042900         INCLUDE TRECEIV                                          04290064
043000     END-EXEC.                                                    04300064
043100                                                                  04310066
043200*DB2 AREA FOR SU-CARTON DIVERT                                    04320066
043300     EXEC SQL                                                     04330066
043400          INCLUDE TSUCRDV                                         04340066
043500     END-EXEC.                                                    04350066
043600******************************************************************04360001
043700*   DB2 SQL COMMUNICATION AREA                                    04370001
043800******************************************************************04380001
043900     EXEC SQL                                                     04390001
044000         INCLUDE SQLCA                                            04400001
044100     END-EXEC.                                                    04410001
044200*                                                                 04420001
044300     COPY SQLCA2.                                                 04430001
044400*                                                                 04440017
044500     EXEC SQL                                                     04450018
044600         DECLARE OTBND_CART_CSR CURSOR FOR                        04460071
044700             SELECT SHIPT_UNT_ID                                  04470018
044800                   ,ORGN_LOC_NBR                                  04480018
044900                   ,DEST_LOC_NBR                                  04490019
045000                   ,CART_SRC_CDE                                  04500089
045100                   ,CRE_DTE                                       04510019
045200                   ,CRE_TM                                        04520019
045300                   ,CRE_USR_ID                                    04530020
045400                   ,OTBND_TRIP_ID                                 04540020
045500                   ,ACTV_IND                                      04550020
045600         FROM  SUT_OTBND_CART                                     04560020
045700        WHERE  SHIPT_UNT_ID >= :PV-BEGINNING-SML                  04570021
045800          AND  SHIPT_UNT_ID <= :PV-ENDING-SML                     04580021
045900     END-EXEC.                                                    04590018
046000*                                                                 04600001
046100     EXEC SQL                                                     04610071
046200         DECLARE OTBND_UPC_CSR CURSOR FOR                         04620071
046300             SELECT TRN_NBR                                       04630071
046400                   ,RCVR_SEQ_NBR                                  04640075
046500         FROM  SUT_OTBND_UPC                                      04650071
046600        WHERE  SHIPT_UNT_ID = :SUT00024-SHIPT-UNT-ID              04660071
046700     END-EXEC.                                                    04670071
046800******************************************************************04680001
046900 PROCEDURE DIVISION.                                              04690001
047000******************************************************************04700001
047100 0000-MAINLINE.                                                   04710001
047200                                                                  04720001
047300     OPEN INPUT  EMPTY-UNKNOWN-FILE                               04730023
047400          OUTPUT TODAY-EMPTY-UNKNOWN-FILE                         04740023
047500                 REPORT-FILE-1.                                   04750099
047600                                                                  04760001
047700     PERFORM 1000-INITIALIZE                                      04770099
047800     PERFORM 2100-READ-INPUT-FILE.                                04780023
047900     IF PS-END-OF-INPUT                                           04790001
048000         PERFORM 1300-NO-DETAIL-LINE                              04800001
048100     ELSE                                                         04810001
048200         MOVE SU067-LOC-NBR          TO PV-PREV-DC                04820099
048300         PERFORM 5000-SELECT-OPER-DESC                            04830099
048400         PERFORM 8000-WRITE-MAIN-HEADINGS                         04840001
048500         PERFORM 2000-PROCESS-EXTRACT                             04850001
048600             UNTIL PS-END-OF-INPUT                                04860001
048700     END-IF.                                                      04870001
048800                                                                  04880001
048900     PERFORM 9000-EOJ.                                            04890001
049000                                                                  04900001
049100     GOBACK.                                                      04910001
049200                                                                  04920001
049300******************************************************************04930001
049400 1000-INITIALIZE.                                                 04940001
049500******************************************************************04950001
049600*                                                                 04960001
049700* LOAD SYSTEM DATE INTO HEADINGS                                  04970001
049800     ACCEPT SD-SYSTEM-DATE FROM DATE.                             04980001
049900     ACCEPT ST-SYSTEM-TIME FROM TIME.                             04990001
050000                                                                  05000001
050100     MOVE SD-SYSTEM-DATE-YY      TO DP132O-RUN-YEAR.              05010001
050200     MOVE SD-SYSTEM-DATE-MM      TO DP132O-RUN-MONTH.             05020001
050300     MOVE SD-SYSTEM-DATE-DD      TO DP132O-RUN-DAY.               05030001
050400     MOVE ST-SYSTEM-HOUR         TO DP132O-RUN-HOUR.              05040001
050500     MOVE ST-SYSTEM-MINUTE       TO DP132O-RUN-MINUTE.            05050001
050600                                                                  05060001
050700     MOVE PC-CURRENT-PROGRAM-NAME                                 05070001
050800                                 TO DP132O-PROGRAM-NAME.          05080001
050900     MOVE 1                      TO DP132O-REPORT-NUMBER          05090001
051000                                    DP132O-PAGE-NUMBER.           05100001
051100                                                                  05110001
051200*                                                                 05120001
051300*                                                                 05130001
051400******************************************************************05140001
051500*  PRINT A 'NO INPUT' REPORT LINE.                                05150001
051600******************************************************************05160001
051700 1300-NO-DETAIL-LINE.                                             05170001
051800*                                                                 05180001
051900     PERFORM 8000-WRITE-MAIN-HEADINGS.                            05190001
052000                                                                  05200001
052100     WRITE REPORT-RECORD-1                                        05210001
052200       FROM EP-EMPTY-REPORT-LINE                                  05220001
052300         AFTER ADVANCING 3 LINES.                                 05230001
052400*                                                                 05240001
052500*                                                                 05250001
052600******************************************************************05260001
052700 2000-PROCESS-EXTRACT.                                            05270001
052800******************************************************************05280001
052900*                                                                 05290001
053000     IF SU067-LOC-NBR NOT = PV-PREV-DC                            05300035
053100         PERFORM 5000-SELECT-OPER-DESC                            05310099
053200         MOVE ZERO                  TO PV-PAGE-COUNT              05320099
053300         PERFORM 8000-WRITE-MAIN-HEADINGS                         05330035
053400         MOVE SU067-LOC-NBR         TO PV-PREV-DC                 05340035
053500     END-IF.                                                      05350035
053600     SUBTRACT 5 FROM SU067-SHIPT-UNT-ID GIVING PV-BEGINNING-SML   05360036
053700     ADD      5 TO   SU067-SHIPT-UNT-ID GIVING PV-ENDING-SML      05370036
053800     PERFORM 4000-OPEN-OTBND-CART-CSR                             05380072
053900     SET PS-END-OTBND-CART-CSR-NO                                 05390099
054000         PS-PRINT-INPUT           TO TRUE                         05400099
054100     PERFORM 4010-FETCH-OTBND-CART-CSR.                           05410072
054200     IF PS-END-OTBND-CART-CSR-NO                                  05420099
054300         PERFORM 3000-PROCESS-5-BEFORE-5-AFTER                    05430099
054400             UNTIL PS-END-OTBND-CART-CSR-YES                      05440099
054500     END-IF                                                       05450099
054600     PERFORM 4020-CLOSE-OTBND-CART-CSR                            05460072
054700* * *  IN THE CASE THAT THE CURSOR RUNS OUT BEFORE WE PRINT       05470099
054800* * *  AN 'ASTERISK' LINE                                         05480099
054900     IF PS-PRINT-INPUT                                            05490099
055000         PERFORM 3010-PRINT-FROM-INPUT                            05500099
055100     END-IF.                                                      05510099
055200                                                                  05520099
055300     ADD 2 TO PV-LINE-COUNT.                                      05530099
055400     IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                         05540099
055500         SUBTRACT 2 FROM PV-LINE-COUNT                            05550099
055600     ELSE                                                         05560099
055700         WRITE REPORT-RECORD-1                                    05570099
055800           FROM DL-BLANK-LINE                                     05580099
055900             AFTER ADVANCING 2 LINES                              05590099
056000     END-IF.                                                      05600099
056100     WRITE TODAY-EMPTY-UNKNOWN-RECORD                             05610099
056200         FROM SU067-EXTRACT-RECORD                                05620099
056300     ADD +1 TO PV-WRITE-COUNT                                     05630099
056400                                                                  05640001
056500     PERFORM 2100-READ-INPUT-FILE.                                05650023
056600*                                                                 05660001
056700******************************************************************05670001
056800*  READ NEXT INPUT FILE RECORD.                                   05680001
056900******************************************************************05690001
057000 2100-READ-INPUT-FILE.                                            05700023
057100                                                                  05710001
057200     READ EMPTY-UNKNOWN-FILE      INTO SU067-EXTRACT-RECORD       05720023
057300        AT END                                                    05730001
057400           SET PS-END-OF-INPUT TO TRUE                            05740001
057500        NOT AT END                                                05750001
057600           ADD +1                   TO PV-READ-COUNT              05760001
057700     END-READ.                                                    05770001
057800*                                                                 05780001
057900 3000-PROCESS-5-BEFORE-5-AFTER.                                   05790048
058000* * * WHERE THERE IS NO SHIPT-UNT-ID ON THE SUT_OTBND_UPC         05800099
058100* * * THAT MATCHES SHIPT-UNT-ID ON THE INPUT FILE                 05810099
058200     IF SUT00024-SHIPT-UNT-ID > SU067-SHIPT-UNT-ID                05820099
058300       AND PS-PRINT-INPUT                                         05830099
058400         PERFORM 3010-PRINT-FROM-INPUT                            05840099
058500         SET PS-NOT-PRINT-INPUT   TO TRUE                         05850099
058600     END-IF                                                       05860099
058700* * * WHERE THERE IS A SHIPT-UNT-ID ON THE SUT_OTBND_UPC          05870099
058800* * * THAT MATCHES SHIPT-UNT-ID ON THE INPUT FILE                 05880099
058900     IF SUT00024-SHIPT-UNT-ID = SU067-SHIPT-UNT-ID                05890099
059000         MOVE PC-ASTERISKS        TO DL1-ASTERISKS-1              05900099
059100                                     DL1-ASTERISKS-2              05910099
059200                                     DL1-ASTERISKS-3              05920099
059300         MOVE SPACES              TO DL1-PO-NBR-X                 05930099
059400                                     DL1-RCVR-NBR-X               05940099
059500                                     DL1-PACK-TYPE                05950099
059600         SET PS-NOT-PRINT-INPUT   TO TRUE                         05960099
059700     ELSE                                                         05970099
059800         MOVE SPACES              TO DL1-ASTERISKS-1              05980099
059900                                     DL1-ASTERISKS-2              05990099
060000                                     DL1-ASTERISKS-3              06000099
060100         PERFORM 3100-GET-PO-RCVR-PACK                            06010099
060200     END-IF                                                       06020099
060300     IF SUT00024-OTBND-TRIP-ID = ZERO                             06030099
060400         PERFORM 6000-CALL-CRTN-STATUS-PGM                        06040099
060500         IF PC046-OTBD-TRIP-ID NUMERIC                            06050099
060600           AND PC046-OTBD-TRIP-ID > ZERO                          06060099
060700             MOVE PC046-OTBD-TRIP-ID                              06070099
060800                                  TO DL1-OUTBOUND-TRIP-ID         06080099
060900         ELSE                                                     06090099
061000             MOVE SPACES          TO DL1-OUTBOUND-TRIP-ID-X       06100099
061100         END-IF                                                   06110099
061200     ELSE                                                         06120099
061300         MOVE SUT00024-OTBND-TRIP-ID                              06130099
061400                                  TO DL1-OUTBOUND-TRIP-ID         06140099
061500     END-IF                                                       06150099
061600     PERFORM 3200-GET-DIVERT-DATA                                 06160099
061700     IF PV-DIVERT-DATE > SPACES                                   06170099
061800         MOVE PV-DIVERT-DATE-MM   TO PV-FORMAT-DATE-MM            06180099
061900         MOVE PV-DIVERT-DATE-DD   TO PV-FORMAT-DATE-DD            06190099
062000         MOVE PV-DIVERT-DATE-YY   TO PV-FORMAT-DATE-YY            06200099
062100         MOVE PV-DIVERT-TIME-HH   TO PV-FORMAT-TIME-HH            06210099
062200         MOVE PV-DIVERT-TIME-MM   TO PV-FORMAT-TIME-MM            06220099
062300         MOVE PV-FORMAT-DATE-TIME TO DL1-DIVERT-DATE-TIME         06230099
062400     ELSE                                                         06240099
062500         MOVE SPACES              TO DL1-DIVERT-DATE-TIME         06250099
062600     END-IF                                                       06260099
062700     IF PV-CREATE-DATE > SPACES                                   06270099
062800         MOVE PV-CREATE-DATE-MM   TO PV-FORMAT-DATE-MM            06280099
062900         MOVE PV-CREATE-DATE-DD   TO PV-FORMAT-DATE-DD            06290099
063000         MOVE PV-CREATE-DATE-YY   TO PV-FORMAT-DATE-YY            06300099
063100         MOVE PV-CREATE-TIME-HH   TO PV-FORMAT-TIME-HH            06310099
063200         MOVE PV-CREATE-TIME-MM   TO PV-FORMAT-TIME-MM            06320099
063300         MOVE PV-FORMAT-DATE-TIME TO DL1-CREATE-DATE-TIME         06330099
063400     ELSE                                                         06340099
063500         MOVE SPACES              TO DL1-CREATE-DATE-TIME         06350099
063600     END-IF                                                       06360099
063700     MOVE SUT00024-SHIPT-UNT-ID   TO DL1-SHIPT-UNT-ID             06370099
063800     MOVE SUT00024-DEST-LOC-NBR   TO DL1-STORE-NBR                06380099
063900     MOVE SUT00024-CART-SRC-CDE   TO DL1-SRC-ID                   06390099
064000     MOVE SUT00024-CRE-USR-ID     TO DL1-CREATE-USER-ID           06400099
064100     PERFORM 7000-PRINT-DETAILS                                   06410099
064200                                                                  06420099
064300     PERFORM 4010-FETCH-OTBND-CART-CSR.                           06430072
064400                                                                  06440001
064500 3010-PRINT-FROM-INPUT.                                           06450099
064600     MOVE PC-ASTERISKS            TO DL1-ASTERISKS-1              06460099
064700                                     DL1-ASTERISKS-2              06470099
064800                                     DL1-ASTERISKS-3              06480099
064900     MOVE SPACES                  TO DL1-PO-NBR-X                 06490099
065000                                     DL1-RCVR-NBR-X               06500099
065100                                     DL1-PACK-TYPE                06510099
065200                                     DL1-OUTBOUND-TRIP-ID-X       06520099
065300                                     DL1-SRC-ID                   06530099
065400                                     DL1-CREATE-USER-ID           06540099
065500                                     DL1-CREATE-DATE-TIME         06550099
065600     MOVE SU067-SHIPT-UNT-ID      TO DL1-SHIPT-UNT-ID             06560099
065700                                     PV-SHIPT-UNT-ID              06570099
065800     MOVE PV-SHIPT-UNT-ID-STORE   TO DL1-STORE-NBR                06580099
065900     MOVE SU067-DIVERT-DOOR       TO DL1-DOOR-ID                  06590099
066000     IF SU067-DIVERT-DATE > SPACES                                06600099
066100         MOVE SU067-DIVERT-DATE   TO PV-DIVERT-DATE               06610099
066200         MOVE SU067-DIVERT-TIME   TO PV-DIVERT-TIME               06620099
066300         MOVE PV-DIVERT-DATE-MM   TO PV-FORMAT-DATE-MM            06630099
066400         MOVE PV-DIVERT-DATE-DD   TO PV-FORMAT-DATE-DD            06640099
066500         MOVE PV-DIVERT-DATE-YY   TO PV-FORMAT-DATE-YY            06650099
066600         MOVE PV-DIVERT-TIME-HH   TO PV-FORMAT-TIME-HH            06660099
066700         MOVE PV-DIVERT-TIME-MM   TO PV-FORMAT-TIME-MM            06670099
066800         MOVE PV-FORMAT-DATE-TIME TO DL1-DIVERT-DATE-TIME         06680099
066900     ELSE                                                         06690099
067000         MOVE SPACES              TO DL1-DIVERT-DATE-TIME         06700099
067100     END-IF                                                       06710099
067200     PERFORM 7000-PRINT-DETAILS.                                  06720099
067300                                                                  06730099
067400 3100-GET-PO-RCVR-PACK.                                           06740099
067500     PERFORM 3110-OPEN-OTBND-UPC-CSR                              06750099
067600* * * JUST WANT TO DO ONE FETCH FOR PO AND RCVR                   06760099
067700     PERFORM 3120-FETCH-OTBND-UPC-CSR.                            06770099
067800     PERFORM 3130-CLOSE-OTBND-UPC-CSR                             06780099
067900     IF DL1-PO-NBR-X = SPACES                                     06790099
068000         MOVE SPACES           TO DL1-PACK-TYPE                   06800099
068100     ELSE                                                         06810099
068200         PERFORM 3140-GET-PACK-TYPE                               06820099
068300         EVALUATE TRUE                                            06830099
068400             WHEN RECEIV-PKGNG-CDE      = 'B'                     06840099
068500                 MOVE 'BULK  ' TO DL1-PACK-TYPE                   06850099
068600             WHEN RECEIV-PKGNG-CDE      = 'C'                     06860099
068700                 MOVE 'CASE  ' TO DL1-PACK-TYPE                   06870099
068800             WHEN RECEIV-PKGNG-CDE      = 'I'                     06880099
068900                 MOVE 'I-PACK' TO DL1-PACK-TYPE                   06890099
069000             WHEN RECEIV-PKGNG-CDE      = 'M'                     06900099
069100                 MOVE 'M-PACK' TO DL1-PACK-TYPE                   06910099
069200             WHEN RECEIV-PACK-BY-ST-IND = 'Y'                     06920099
069300                 MOVE 'PBS   ' TO DL1-PACK-TYPE                   06930099
069400             WHEN OTHER                                           06940099
069500                 MOVE '      ' TO DL1-PACK-TYPE                   06950099
069600         END-EVALUATE                                             06960099
069700     END-IF.                                                      06970099
069800                                                                  06980099
069900******************************************************************06990099
070000 3110-OPEN-OTBND-UPC-CSR.                                         07000099
070100******************************************************************07010099
070200                                                                  07020099
070300     EXEC SQL                                                     07030099
070400         OPEN OTBND_UPC_CSR                                       07040099
070500     END-EXEC.                                                    07050099
070600                                                                  07060099
070700     EVALUATE TRUE                                                07070099
070800         WHEN SQLCODE = ZERO                                      07080099
070900             CONTINUE                                             07090099
071000         WHEN SQLWARN0 NOT = SPACES                               07100099
071100         WHEN SQLCODE < +0                                        07110099
071200         WHEN SQLCODE > ZERO                                      07120099
071300             MOVE '3110-OPEN-OTBND-UPC-CSR'                       07130099
071400                                TO PV-PARAGRAPH                   07140099
071500             MOVE 'OPEN OTBND_UPC_CSR'                            07150099
071600                                TO PV-DB2-OPERATION-MESSAGE-1     07160099
071700             PERFORM 9200-SQL-ABEND                               07170099
071800     END-EVALUATE.                                                07180099
071900                                                                  07190099
072000******************************************************************07200099
072100 3120-FETCH-OTBND-UPC-CSR.                                        07210099
072200******************************************************************07220099
072300     EXEC SQL                                                     07230099
072400         FETCH OTBND_UPC_CSR                                      07240099
072500         INTO  :SUT00028-TRN-NBR                                  07250099
072600              ,:SUT00028-RCVR-SEQ-NBR                             07260099
072700     END-EXEC.                                                    07270099
072800                                                                  07280099
072900     EVALUATE TRUE                                                07290099
073000         WHEN SQLCODE = ZERO                                      07300099
073100             IF SUT00028-TRN-NBR NOT = ZERO                       07310099
073200                 MOVE SUT00028-TRN-NBR                            07320099
073300                                   TO DL1-PO-NBR                  07330099
073400                 MOVE SUT00028-RCVR-SEQ-NBR                       07340099
073500                                   TO DL1-RCVR-NBR                07350099
073600             ELSE                                                 07360099
073700                 MOVE SPACES       TO DL1-PO-NBR-X                07370099
073800                                      DL1-RCVR-NBR-X              07380099
073900             END-IF                                               07390099
074000         WHEN SQLCODE = +100                                      07400099
074100             MOVE SPACES           TO DL1-PO-NBR-X                07410099
074200                                      DL1-RCVR-NBR-X              07420099
074300                                      DL1-PACK-TYPE               07430099
074400         WHEN SQLWARN0 NOT = SPACES                               07440099
074500         WHEN SQLCODE < +0                                        07450099
074600         WHEN SQLCODE > ZERO                                      07460099
074700             MOVE '3120-FETCH-OTBND-UPC-CSR'                      07470099
074800                                   TO PV-PARAGRAPH                07480099
074900             MOVE 'FETCH'          TO PV-DB2-FUNCTION             07490099
075000             MOVE 'SUT_OTBND_UPC'  TO PV-DB2-TABLE-NAME           07500099
075100             MOVE SUT00024-SHIPT-UNT-ID                           07510099
075200                                   TO PV-DISPLAY-SML              07520099
075300             STRING 'SML: ' DELIMITED BY SIZE                     07530099
075400                    PV-DISPLAY-SML    DELIMITED BY SIZE           07540099
075500                           INTO PV-DB2-OPERATION-MESSAGE-1        07550099
075600             PERFORM 9200-SQL-ABEND                               07560099
075700     END-EVALUATE.                                                07570099
075800                                                                  07580099
075900******************************************************************07590099
076000 3130-CLOSE-OTBND-UPC-CSR.                                        07600099
076100******************************************************************07610099
076200     EXEC SQL                                                     07620099
076300         CLOSE OTBND_UPC_CSR                                      07630099
076400     END-EXEC.                                                    07640099
076500                                                                  07650099
076600     EVALUATE TRUE                                                07660099
076700         WHEN SQLCODE = ZERO                                      07670099
076800             CONTINUE                                             07680099
076900                                                                  07690099
077000         WHEN SQLWARN0 NOT = SPACES                               07700099
077100         WHEN SQLCODE < +0                                        07710099
077200         WHEN SQLCODE > ZERO                                      07720099
077300             MOVE '3130-CLOSE-OTBND-UPC-CSR'                      07730099
077400                                 TO PV-PARAGRAPH                  07740099
077500             MOVE 'CLOSE OTBND_UPC_CSR'                           07750099
077600                                 TO PV-DB2-OPERATION-MESSAGE-1    07760099
077700             PERFORM 9200-SQL-ABEND                               07770099
077800     END-EVALUATE.                                                07780099
077900                                                                  07790099
078000 3140-GET-PACK-TYPE.                                              07800099
078100     EXEC SQL                                                     07810099
078200        SELECT  PKGNG_CDE                                         07820099
078300              , PACK_BY_ST_IND                                    07830099
078400          INTO  :RECEIV-PKGNG-CDE                                 07840099
078500              , :RECEIV-PACK-BY-ST-IND                            07850099
078600          FROM  TRECEIV                                           07860099
078700          WHERE ORD_NBR           = :SUT00028-TRN-NBR             07870099
078800            AND REC_SEQ_NBR       = :SUT00028-RCVR-SEQ-NBR        07880099
078900     END-EXEC.                                                    07890099
079000                                                                  07900099
079100     EVALUATE TRUE                                                07910099
079200         WHEN SQLCODE = ZERO                                      07920099
079300             CONTINUE                                             07930099
079400         WHEN SQLCODE = +100                                      07940099
079500             MOVE SPACES           TO RECEIV-PKGNG-CDE            07950099
079600                                      RECEIV-PACK-BY-ST-IND       07960099
079700         WHEN SQLWARN0 NOT = SPACES                               07970099
079800         WHEN SQLCODE < +0                                        07980099
079900         WHEN SQLCODE > ZERO                                      07990099
080000             MOVE '3140-GET-PACK-TYPE'                            08000099
080100                                   TO PV-PARAGRAPH                08010099
080200             MOVE 'SELECT'         TO PV-DB2-OPERATION-MESSAGE-1  08020099
080300             MOVE 'TRECEIV'        TO PV-DB2-TABLE-NAME           08030099
080400             MOVE SUT00028-TRN-NBR TO PV-DISPLAY-PO               08040099
080500             MOVE SUT00028-RCVR-SEQ-NBR                           08050099
080600                                   TO PV-DISPLAY-RCVR             08060099
080700             STRING 'PO/RCVR '      DELIMITED BY SIZE             08070099
080800                    PV-DISPLAY-PO   DELIMITED BY SIZE             08080099
080900                    '/'             DELIMITED BY SIZE             08090099
081000                    PV-DISPLAY-RCVR DELIMITED BY SIZE             08100099
081100                           INTO PV-DB2-OPERATION-MESSAGE-2        08110099
081200             PERFORM 9200-SQL-ABEND                               08120099
081300     END-EVALUATE.                                                08130099
081400                                                                  08140099
081500 3200-GET-DIVERT-DATA.                                            08150066
081600     EXEC SQL                                                     08160067
081700         SELECT DATE(A.DIVERT_TMST)                               08170067
081800               ,TIME(A.DIVERT_TMST)                               08180067
081900               ,A.DOOR_ID                                         08190067
082000         INTO  :PV-DIVERT-DATE                                    08200067
082100              ,:PV-DIVERT-TIME                                    08210067
082200              ,:DL1-DOOR-ID                                       08220088
082300         FROM TSUCRDV A                                           08230067
082400        WHERE A.SHIPT_UNT_ID = :SUT00024-SHIPT-UNT-ID             08240099
082500          AND A.ACTV_CDE     = 'A'                                08250099
082600          AND A.DIVERT_TMST IN                                    08260067
082700             (SELECT MAX(B.DIVERT_TMST)                           08270067
082800                FROM TSUCRDV B                                    08280067
082900               WHERE A.SHIPT_UNT_ID = B.SHIPT_UNT_ID)             08290067
083000     END-EXEC.                                                    08300067
083100                                                                  08310067
083200     EVALUATE TRUE                                                08320067
083300         WHEN SQLCODE = ZERO                                      08330067
083400             CONTINUE                                             08340099
083500         WHEN SQLCODE = +100                                      08350067
083600             MOVE SPACES TO PV-DIVERT-DATE                        08360095
083700                            PV-DIVERT-TIME                        08370095
083800                            DL1-DOOR-ID                           08380099
083900         WHEN SQLWARN0 NOT = SPACES                               08390067
084000         WHEN SQLCODE < +0                                        08400067
084100         WHEN SQLCODE > ZERO                                      08410067
084200             MOVE '3200-GET-DIVERT-DATA'                          08420067
084300                                  TO PV-PARAGRAPH                 08430091
084400             MOVE 'SELECT'        TO PV-DB2-OPERATION-MESSAGE-1   08440091
084500             MOVE 'TSUCRDV'       TO PV-DB2-TABLE-NAME            08450067
084600             MOVE SU067-SHIPT-UNT-ID TO PV-DISPLAY-SML            08460068
084700             STRING 'SHIPT-UNT-QTY: '  DELIMITED BY SIZE          08470067
084800                 PV-DISPLAY-SML        DELIMITED BY SIZE          08480068
084900                           INTO PV-DB2-OPERATION-MESSAGE-2        08490091
085000             PERFORM 9200-SQL-ABEND                               08500092
085100     END-EVALUATE.                                                08510067
085200                                                                  08520073
085300******************************************************************08530031
085400 4000-OPEN-OTBND-CART-CSR.                                        08540072
085500******************************************************************08550031
085600                                                                  08560031
085700     EXEC SQL                                                     08570031
085800         OPEN OTBND_CART_CSR                                      08580071
085900     END-EXEC.                                                    08590031
086000                                                                  08600031
086100     EVALUATE TRUE                                                08610031
086200         WHEN SQLCODE = ZERO                                      08620031
086300             CONTINUE                                             08630031
086400         WHEN SQLWARN0 NOT = SPACES                               08640031
086500         WHEN SQLCODE < +0                                        08650031
086600         WHEN SQLCODE > ZERO                                      08660031
086700             MOVE '4000-OPEN-OTBND-CART-CSR'                      08670072
086800                                TO PV-PARAGRAPH                   08680091
086900             MOVE 'OPEN OTBND_CART_CSR'                           08690071
087000                                TO PV-DB2-OPERATION-MESSAGE-1     08700091
087100             PERFORM 9200-SQL-ABEND                               08710092
087200     END-EVALUATE.                                                08720031
087300                                                                  08730031
087400                                                                  08740031
087500******************************************************************08750031
087600 4010-FETCH-OTBND-CART-CSR.                                       08760072
087700******************************************************************08770031
087800     EXEC SQL                                                     08780031
087900         FETCH OTBND_CART_CSR                                     08790071
088000         INTO  :SUT00024-SHIPT-UNT-ID                             08800045
088100              ,:SUT00024-ORGN-LOC-NBR                             08810045
088200              ,:SUT00024-DEST-LOC-NBR                             08820045
088300              ,:SUT00024-CART-SRC-CDE                             08830089
088400              ,:PV-CREATE-DATE                                    08840086
088500              ,:PV-CREATE-TIME                                    08850086
088600              ,:SUT00024-CRE-USR-ID                               08860045
088700              ,:SUT00024-OTBND-TRIP-ID:DN-OTBND-TRIP-NULL         08870057
088800              ,:SUT00024-ACTV-IND                                 08880045
088900     END-EXEC.                                                    08890031
089000                                                                  08900031
089100     EVALUATE TRUE                                                08910031
089200         WHEN SQLCODE = ZERO                                      08920031
089300             IF DN-OTBND-TRIP-NULL = -1                           08930057
089400                 MOVE ZERO        TO SUT00024-OTBND-TRIP-ID       08940057
089500             END-IF                                               08950057
089600         WHEN SQLCODE = +100                                      08960031
089700             SET PS-END-OTBND-CART-CSR-YES TO TRUE                08970099
089800         WHEN SQLWARN0 NOT = SPACES                               08980031
089900         WHEN SQLCODE < +0                                        08990031
090000         WHEN SQLCODE > ZERO                                      09000031
090100             MOVE '4010-FETCH-OTBND-CART-CSR'                     09010077
090200                                   TO PV-PARAGRAPH                09020091
090300             MOVE 'FETCH'          TO PV-DB2-OPERATION-MESSAGE-1  09030091
090400             MOVE 'SUT_OTBND_CART' TO PV-DB2-TABLE-NAME           09040049
090500             MOVE PV-BEGINNING-SML TO PV-DISPLAY-SML              09050051
090600             STRING 'BEGINNING SML: ' DELIMITED BY SIZE           09060051
090700                    PV-DISPLAY-SML    DELIMITED BY SIZE           09070051
090800                           INTO PV-DB2-OPERATION-MESSAGE-2        09080091
090900             MOVE PV-ENDING-SML    TO PV-DISPLAY-SML              09090051
091000             STRING 'ENDING SML: '    DELIMITED BY SIZE           09100051
091100                    PV-DISPLAY-SML    DELIMITED BY SIZE           09110051
091200                           INTO PV-DB2-OPERATION-MESSAGE-3        09120091
091300             PERFORM 9200-SQL-ABEND                               09130092
091400     END-EVALUATE.                                                09140031
091500                                                                  09150031
091600******************************************************************09160031
091700 4020-CLOSE-OTBND-CART-CSR.                                       09170072
091800******************************************************************09180031
091900     EXEC SQL                                                     09190031
092000         CLOSE OTBND_CART_CSR                                     09200071
092100     END-EXEC.                                                    09210031
092200                                                                  09220031
092300     EVALUATE TRUE                                                09230031
092400         WHEN SQLCODE = ZERO                                      09240031
092500             CONTINUE                                             09250031
092600                                                                  09260031
092700         WHEN SQLWARN0 NOT = SPACES                               09270031
092800         WHEN SQLCODE < +0                                        09280031
092900         WHEN SQLCODE > ZERO                                      09290031
093000             MOVE '4020-CLOSE-OTBND-CART-CSR'                     09300072
093100                                 TO PV-PARAGRAPH                  09310091
093200             MOVE 'CLOSE OTBND_CART_CSR'                          09320071
093300                                 TO PV-DB2-OPERATION-MESSAGE-1    09330091
093400             PERFORM 9200-SQL-ABEND                               09340092
093500     END-EVALUATE.                                                09350031
093600*                                                                 09360099
093700***************************************************************** 09370099
093800 5000-SELECT-OPER-DESC.                                           09380099
093900***************************************************************** 09390099
094000     INITIALIZE XL071-COMMAREA-REC.                               09400099
094100     MOVE SU067-LOC-NBR         TO XL071-LOCATION-NUMBER          09410099
094200                                   PV-DISP-LOC                    09420099
094300                                   HL2-OPER-ID                    09430099
094400                                                                  09440099
094500     CALL XL071-LOCATION-MODULE USING XL071-COMMAREA-REC.         09450099
094600                                                                  09460099
094700     EVALUATE TRUE                                                09470099
094800     WHEN XL071-NO-ERRORS                                         09480099
094900         MOVE XL071-LOC-NM          TO HL2-LOC-DESC               09490099
095000     WHEN XL071-LOC-NOT-FOUND                                     09500099
095100     WHEN XL071-DC-ASGMT-NOT-FND                                  09510099
095200         MOVE 'UNKNOWN'             TO HL2-LOC-DESC               09520099
095300     WHEN XL071-BAD-DB2-RETURN                                    09530099
095400         MOVE    '5000-SELECT-OPER-DESC' TO PV-PARAGRAPH          09540099
095500         DISPLAY '5000-SELECT-OPER-DESC'                          09550099
095600         DISPLAY '** LOCATION     = ' PV-DISP-LOC                 09560099
095700         DISPLAY 'CALL LOCATION MOD '                             09570099
095800         DISPLAY 'XLT00010'                                       09580099
095900         MOVE XL071-SQLCA             TO SQLCA                    09590099
096000         PERFORM 9200-SQL-ABEND                                   09600099
096100     END-EVALUATE.                                                09610099
096200                                                                  09620031
096300 6000-CALL-CRTN-STATUS-PGM.                                       09630039
096400                                                                  09640039
096500     INITIALIZE PC046-COMMAREA-REC.                               09650039
096600     MOVE  SUT00024-SHIPT-UNT-ID  TO  PC046-CARTON-ID.            09660099
096700                                                                  09670039
096800     CALL PC-CRTN-STATUS-PGM                                      09680039
096900        USING PC046-COMMAREA-REC.                                 09690039
097000                                                                  09700001
097100     IF  PC046-SUCCESSFUL                                         09710070
097200         CONTINUE                                                 09720070
097300     ELSE                                                         09730070
097400         DISPLAY '** ABEND - PROGRAM ' PC-CURRENT-PROGRAM-NAME    09740097
097500         DISPLAY '** BAD CALL TO CRTN STATUS PGM PCKUT713'        09750097
097600         DISPLAY 'PC046-CRA-RET-CDE = ' PC046-CRA-RET-CDE         09760070
097700         DISPLAY PC046-CRA-RET-MSG                                09770070
097710****                                                              09771099
097720         MOVE  ZEROES  TO  PC046-OTBD-TRIP-ID                     09772099
097730****                                                              09773099
097800****     MOVE +4019 TO PV-ABEND-CODE                              09780099
097900****     CALL 'ILBOABN0' USING PV-ABEND-CODE                      09790099
098000     END-IF.                                                      09800070
098100******************************************************************09810084
098200*  FILL AND PRINT DETAIL REPORT LINE.                             09820084
098300******************************************************************09830084
098400 7000-PRINT-DETAILS.                                              09840084
098500                                                                  09850084
098600*CHECK FOR OVERFLOW.                                              09860084
098700     ADD 1 TO PV-LINE-COUNT.                                      09870084
098800     IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                         09880084
098900         SET PS-NEW-PAGE TO TRUE                                  09890084
099000         PERFORM 8000-WRITE-MAIN-HEADINGS                         09900084
099100     END-IF.                                                      09910084
099200     WRITE REPORT-RECORD-1                                        09920099
099300       FROM DL-DETAIL-LINE-1                                      09930099
099400         AFTER ADVANCING 1 LINES.                                 09940099
099500*                                                                 09950001
099600******************************************************************09960001
099700 8000-WRITE-MAIN-HEADINGS.                                        09970001
099800******************************************************************09980001
099900*                                                                 09990001
100000     ADD 1                         TO PV-PAGE-COUNT.              10000001
100100     MOVE PV-PAGE-COUNT            TO DP132O-PAGE-NUMBER.         10010001
100200     MOVE ZERO                     TO PV-LINE-COUNT.              10020001
100300                                                                  10030001
100400     WRITE REPORT-RECORD-1 FROM                                   10040001
100500         DP132O-STANDRD-HEADER-132-COLS                           10050001
100600         AFTER ADVANCING PAGE.                                    10060001
100700                                                                  10070001
100800     WRITE REPORT-RECORD-1 FROM DL-BLANK-LINE                     10080001
100900         AFTER ADVANCING 1 LINE                                   10090001
101000                                                                  10100001
101100     WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-1                 10110001
101200        AFTER ADVANCING 1 LINES.                                  10120001
101300                                                                  10130001
101400     WRITE REPORT-RECORD-1 FROM DL-BLANK-LINE                     10140001
101500         AFTER ADVANCING 1 LINE                                   10150001
101600                                                                  10160001
101700     WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-2                 10170001
101800        AFTER ADVANCING 1 LINES.                                  10180001
101900                                                                  10190001
102000     WRITE REPORT-RECORD-1 FROM DL-BLANK-LINE                     10200001
102100         AFTER ADVANCING 1 LINE                                   10210001
102200                                                                  10220001
102300     WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-3                 10230001
102400        AFTER ADVANCING 1 LINES.                                  10240001
102500                                                                  10250001
102600     WRITE REPORT-RECORD-1 FROM HL-HEADING-LINE-4                 10260001
102700        AFTER ADVANCING 1 LINES.                                  10270001
102800                                                                  10280001
102900     WRITE REPORT-RECORD-1 FROM DL-BLANK-LINE                     10290001
103000         AFTER ADVANCING 1 LINE                                   10300001
103100                                                                  10310001
103200     ADD 8                            TO PV-LINE-COUNT.           10320001
103300*                                                                 10330001
103400******************************************************************10340001
103500 9000-EOJ.                                                        10350001
103600******************************************************************10360001
103700*                                                                 10370001
103800     WRITE REPORT-RECORD-1 FROM ER-END-OF-REPORT-LINE             10380001
103900        AFTER ADVANCING 2 LINES                                   10390001
104000                                                                  10400001
104100*CLOSE FILES.                                                     10410001
104200     CLOSE EMPTY-UNKNOWN-FILE                                     10420024
104300           TODAY-EMPTY-UNKNOWN-FILE                               10430024
104400           REPORT-FILE-1.                                         10440024
104500                                                                  10450001
104600     MOVE PV-READ-COUNT      TO PV-DISPLAY-COUNT.                 10460001
104700     DISPLAY 'TOTAL INPUT RECORDS READ...: ' PV-DISPLAY-COUNT.    10470099
104800     MOVE PV-WRITE-COUNT     TO PV-DISPLAY-COUNT.                 10480099
104900     DISPLAY 'TOTAL INPUT RECORDS WRITTEN: ' PV-DISPLAY-COUNT.    10490099
105000                                                                  10500001
105100/                                                                 10510001
105200******************************************************************10520001
105300 9200-SQL-ABEND.                                                  10530001
105400******************************************************************10540001
105500                                                                  10550001
105600     MOVE SQLCODE                     TO SQLCODE2.                10560001
105700     MOVE SQLERRD(3)                  TO SQLERRD3.                10570001
105800                                                                  10580001
105900     DISPLAY '** ABEND **         ** = SQLERROR'.                 10590001
106000     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.        10600001
106100     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH.                   10610001
106200     DISPLAY '** TABLE NAME * = ' PV-DB2-TABLE-NAME.              10620001
106300     DISPLAY '** OPERATION ** = ' PV-DB2-FUNCTION.                10630001
106400     DISPLAY '*** MESSAGE     = ' PV-DB2-OPERATION-MESSAGE-1.     10640001
106500     DISPLAY '***             = ' PV-DB2-OPERATION-MESSAGE-2.     10650001
106600     DISPLAY '***             = ' PV-DB2-OPERATION-MESSAGE-3.     10660001
106700                                                                  10670001
106800     DISPLAY '** SQLCODE          ** = ' SQLCODE2.                10680001
106900     DISPLAY '** ROWS PROCESSED   ** = ' SQLERRD3.                10690001
107000     DISPLAY '** SQLERRM          ** = ' SQLERRM.                 10700001
107100     DISPLAY '** SQLERRMC         ** = ' SQLERRMC.                10710001
107200                                                                  10720001
107300                                                                  10730001
107400     MOVE +4013                       TO PV-ABEND-CODE.           10740001
107500     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         10750001
107600                                                                  10760001
