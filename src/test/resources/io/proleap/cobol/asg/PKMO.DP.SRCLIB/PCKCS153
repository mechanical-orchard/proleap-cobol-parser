000100*-----------------------*                                         00010025
000200 IDENTIFICATION DIVISION.                                         00020026
000300*-----------------------*                                         00030026
000400 PROGRAM-ID.    PCKCS153.                                         00040026
000500 AUTHOR.        DAN HINTZ.                                        00050026
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060026
000700 DATE-WRITTEN.  02-09-94.                                         00070026
000800 DATE-COMPILED.                                                   00080026
000900                                                                  00090027
001000*----------------------------------------------------------------*00100026
001100*    E153 - PRINTER CRITERIA SPECIFICATION                       *00110026
001200*                                                                *00120026
001300*    THIS PROGRAM ALLOWS THE USER ENTER A VALID DESTINATION      *00130026
001400*    PRINTER ID FOR A SPECIFIED REPORT.                          *00140026
001500*----------------------------------------------------------------*00150026
C94517*  CHANGED 10/14/2014    BY COGNIZANT       WR: CHG0094517        00160073
C94517*                                                                 00170072
C94517* EXTENDED PO# FROM 7 TO 8 DIGITS WHERE NEEDED.                   00180072
C94517*-----------------------------------------------------------------00190072
1122RM* DATE  11/07/2022                                               *00192078
1122RM*            - ADD COPYBOOK DPWS930                              *00193078
1122RM*              CHANGE CALL TO DPWS030 FROM STATIC TO             *00194078
1122RM*              DYNAMIC.                                          *00195078
1122RM*     MADE BY: BOB MCASEY              WR/IR #: CHG0277910       *00196078
1122RM*-----------------------------------------------------------------00197078
001600                                                                  00200026
001700                                                                  00210027
001800 ENVIRONMENT DIVISION.                                            00220026
001900                                                                  00230026
002000                                                                  00240026
002100                                                                  00250026
002200 DATA DIVISION.                                                   00260026
002300                                                                  00270026
002400                                                                  00280026
002500 WORKING-STORAGE SECTION.                                         00290026
002600*                                                                 00300026
002700 01  DK-DB2-KEYS.                                                 00310026
002800     05  DK-OPER-UNT-ID            PIC S9(04)  COMP VALUE +0.     00320026
002900     05  DK-FCLTY-ID               PIC S9(04)  COMP VALUE +0.     00330026
003000     05  DK-PO-NBR                 PIC S9(09)  COMP VALUE +0.     00340026
003100     05  DK-REC-SEQ-NBR            PIC S9(09)  COMP VALUE +0.     00350026
003200*                                                                 00360026
003300 01  PC-PROGRAM-CONSTANTS.                                        00370026
003400     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE  'PC153A  '. 00380026
003500     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE  'PCKM153 '. 00390026
003600     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE  'PCKCS153'. 00400026
003700     05  PC-AUDIT-RTN              PIC  X(08)  VALUE  'RCKCS290'. 00410026
003800     05  PC-AUDIT-RTN-LENGTH       PIC S9(04)  VALUE  +300        00420026
003900                                                      COMP SYNC.  00430026
004000     05  PC-DPKCS060               PIC  X(08)  VALUE  'DPKCS060'. 00440048
004100     05  PC-MAX-RETRIES            PIC S9(04)  VALUE +2.          00450026
004200     05  PC-INTER-APPL-CODES.                                     00460026
004300         10 PC-INTER-APPL-CRIT-SPEC                               00470026
004400                                   PIC  X(01)  VALUE '1'.         00480026
004500         10 PC-CONTROL-APRON-REQUEST                              00490026
004600                                   PIC  X(01)  VALUE '2'.         00500026
004700         10 PC-PRE-TICKET-REQUEST                                 00510026
004800                                   PIC  X(01)  VALUE '3'.         00520026
004900         10 PC-WRK-ORD-LIST-REQUEST                               00530026
005000                                   PIC  X(01)  VALUE '5'.         00540026
005100         10 PC-MARKING-APRON-REQUEST                              00550026
005200                                   PIC  X(01)  VALUE '5'.         00560026
005300         10 PC-SORTATION-REQUEST   PIC  X(01)  VALUE '6'.         00570060
005400         10 PC-MOPS-CIDS-REQUEST   PIC  X(01)  VALUE '7'.         00580026
005500         10 PC-JEW-MNFST-REQUEST   PIC  X(01)  VALUE '8'.         00590026
005600         10 PC-PACK-APRON-REQUEST  PIC  X(01)  VALUE '9'.         00600057
005700     05  PC-01                     PIC  X(02)  VALUE '01'.        00610032
005800     05  PC-P                      PIC  X(01)  VALUE 'P'.         00620053
005900     05  PC-Y                      PIC  X(01)  VALUE 'Y'.         00630053
006000     05  PC-A                      PIC  X(01)  VALUE 'A'.         00640026
006100     05  PC-IN                     PIC  X(02)  VALUE 'IN'.        00650026
006200     05  PC-TSYMSG-NUMBERS.                                       00660026
006300         10  PC-TSYMSG-00005       PIC  9(05)  VALUE  00005.      00670026
006400         10  PC-TSYMSG-00007       PIC  9(05)  VALUE  00007.      00680026
006500         10  PC-TSYMSG-00070       PIC  9(05)  VALUE  00070.      00690026
006600         10  PC-TSYMSG-00098       PIC  9(05)  VALUE  00098.      00700026
006700         10  PC-TSYMSG-00551       PIC  9(05)  VALUE  00551.      00710026
006800         10  PC-TSYMSG-00746       PIC  9(05)  VALUE  00746.      00720026
006900         10  PC-TSYMSG-01178       PIC  9(05)  VALUE  01178.      00730026
007000*                                                                 00740026
007100 01  PV-PROGRAM-VARIABLES.                                        00750026
007700                                                                  00760037
007800     05  PV-CICS-RESP              PIC S9(04)  VALUE +0           00770026
007900                                               COMP SYNC.         00780026
008000     05  PV-SEL-QUEUE-ITEM         PIC S9(04)  VALUE +0           00790026
008100                                               COMP SYNC.         00800026
008200     05  PV-RETRY-COUNT            PIC S9(04)  VALUE ZERO         00810026
008300                                               COMP SYNC.         00820026
008400     05  PV-NUM-ITEMS              PIC S9(04)  VALUE ZERO         00830026
008500                                               COMP SYNC.         00840026
008600     05  PV-COMMAREA-LENGTH        PIC S9(04)  VALUE +0           00850026
008700                                               COMP SYNC.         00860026
008800     05  PV-PCKCS153-COMMAREA.                                    00870026
008900         07  PV-PCKCS013-COMMAREA.                                00880026
009000           10  PV-PCKCS011-COMMAREA.                              00890026
009100             15  PV-CA-ORD-NBR         PIC  9(08)  VALUE ZEROS.   00900026
009200             15  PV-CA-RCVR-SEQ-NBR    PIC  9(03)  VALUE ZEROS.   00910026
009300             15  PV-CA-ORD-LNE-NBR     PIC  9(04)  VALUE ZEROS.   00920026
009400             15  PV-CA-WORK-ORD-SEQ-NBR                           00930026
009500                                       PIC  9(03)  VALUE ZEROS.   00940026
009600             15  PV-CA-PRINTER-DESTINATION                        00950026
009700                                       PIC  X(08)  VALUE SPACE.   00960028
009800             15  PV-CA-USER-ID         PIC  X(08)  VALUE SPACE.   00970026
009900             15  PV-CA-OPERATING-ID    PIC  X(04)  VALUE SPACE.   00980026
010000             15  PV-CA-FACILITY-ID     PIC  X(04)  VALUE SPACE.   00990026
010100             15  PV-CA-MRKG-APRON-REQ-IND                         01000026
010200                                       PIC  X(01)  VALUE SPACE.   01010026
010300                 88  PV-CA-PRINT-CTL-APRON-HDR     VALUE 'H'.     01020026
010400             15  PV-CA-PRTR-AUTO-CUTTER-IND                       01030029
010500                                       PIC  X(01)  VALUE SPACE.   01040029
010600             15  PV-CA-PRTR-PRTR-BRCDE-IND                        01050035
010700                                       PIC  X(01)  VALUE SPACE.   01060029
010800             15  PV-CA-PRTR-PRTR-CNTL-IND                         01070029
010900                                       PIC  X(01)  VALUE SPACE.   01080029
011000             15  PV-CA-PRINT-PACKAGE-IND                          01090046
011100                                       PIC  X(01)  VALUE SPACE.   01100046
011200                 88 PV-CA-NOT-PRINT-PACKAGE        VALUE 'N'.     01110046
011300             15  PV-CA-LINES-PER-INCH  PIC  X(03)  VALUE SPACE.   01120046
011400           10  PV-CA-NUMBER-OF-SELECTED-ITEMS                     01130026
011500                                       PIC S9(09)  COMP-3.        01140026
011600           10  PV-CA-NUMBER-OF-TS-ITEMS                           01150026
011700                                       PIC S9(05)  COMP-3.        01160026
011800           10  PV-CA-SEL-QUEUE-NAME    PIC  X(08)  VALUE SPACE.   01170026
011900           10  PV-CA-MAX-ITEMS         PIC S9(04)  COMP.          01180026
012000           10  PV-CA-MRKG-APRON-HDR-IND                           01190029
012100                                       PIC  X(01)  VALUE SPACE.   01200029
012200               88  PV-CA-PRINT-MRKG-APRON-HDR      VALUE 'Y'.     01210030
012300           10  PV-CA-MRKG-APRON-IND    PIC  X(01)  VALUE SPACE.   01220030
012400               88  PV-CA-PRINT-MRKG-APRON          VALUE 'Y'.     01230030
012500               88  PV-CA-PRINT-PACK-APRON          VALUE 'P'.     01240054
012600         07  PV-CA-STORE-NMBR          PIC  9(04)  VALUE ZERO.    01250030
012700                                                                  01260026
012800     05  PV-SORTATION-COMMAREA.                                   01270026
012900         10  PV-SC-PRINTER             PIC X(08).                 01280029
013000         10  PV-SC-PO-NBR              PIC 9(08).                 01290029
013100         10  PV-SC-REC-SEQ-NBR         PIC 9(03).                 01300029
013200         10  PV-SC-DIST-PACK           PIC 9(03).                 01310029
013300         10  PV-SC-FUNCTION            PIC X(01).                 01320029
013400         10  PV-SC-LNE-NBR             PIC 9(03).                 01330029
013500         10  PV-SC-USERID              PIC X(08).                 01340029
013600         10  PV-SC-MULT-DIST-PACK-IND  PIC X(01).                 01350029
013700         10  PV-SC-PRTR-AUTO-CUTTER-IND                           01360029
013800                                       PIC X(01) VALUE SPACE.     01370029
013900         10  PV-SC-PRTR-PRTR-BRCDE-IND                            01380035
014000                                       PIC X(01) VALUE SPACE.     01390029
014100         10  PV-SC-PRTR-PRTR-CNTL-IND  PIC X(01) VALUE SPACE.     01400029
014200         10  PV-SC-PRINT-PACKAGE-IND   PIC  X(01)  VALUE SPACE.   01410047
014300             88 PV-SC-NOT-PRINT-PACKAGE            VALUE 'N'.     01420047
014400                                                                  01430026
014500     05  PV-MOPS-CIDS-COMMAREA.                                   01440026
014600         10  PV-MC-PO-NBR              PIC 9(08).                 01450029
014700         10  PV-MC-REC-SEQ-NBR         PIC 9(03).                 01460029
014800         10  PV-MC-OPER-UNT-ID         PIC 9(04).                 01470071
014900         10  PV-MC-FCLTY-ID            PIC 9(03).                 01480029
015000         10  PV-MC-CLERK               PIC X(20).                 01490029
015100         10  PV-MC-PRINTER             PIC X(08).                 01500029
015200         10  PV-MC-MASTER-PO           PIC X(01).                 01510029
015300         10  PV-MC-CHECKIN-DOC         PIC X(01).                 01520029
015400         10  PV-MC-CHECKIN-DOC-LINE    PIC 9(03).                 01530030
015500         10  PV-MC-PRTR-AUTO-CUTTER-IND                           01540029
015600                                       PIC X(01) VALUE SPACE.     01550029
015700         10  PV-MC-PRTR-PRTR-BRCDE-IND                            01560035
015800                                       PIC X(01) VALUE SPACE.     01570029
015900         10  PV-MC-PRTR-PRTR-CNTL-IND  PIC X(01) VALUE SPACE.     01580029
016000         10  PV-MC-PRINT-PACKAGE-IND   PIC  X(01)  VALUE SPACE.   01590047
016100             88 PV-MC-NOT-PRINT-PACKAGE            VALUE 'N'.     01600047
016200         10  PV-MC-MERCH-LOC           PIC X(15).                 01610059
016300                                                                  01620026
016400     05  PV-PRE-TICKET-COMMAREA.                                  01630026
C94517         10  PV-PT-PO-NBR              PIC 9(08).                 01640073
016600         10  PV-PT-PRINTER             PIC X(08).                 01650029
016700         10  PV-PT-PRTR-AUTO-CUTTER-IND                           01660029
016800                                       PIC X(01) VALUE SPACE.     01670029
016900         10  PV-PT-PRTR-PRTR-BRCDE-IND                            01680035
017000                                       PIC X(01) VALUE SPACE.     01690029
017100         10  PV-PT-PRTR-PRTR-CNTL-IND  PIC X(01) VALUE SPACE.     01700029
017200         10  PV-PT-PRINT-PACKAGE-IND   PIC  X(01)  VALUE SPACE.   01710047
017300             88 PV-PT-NOT-PRINT-PACKAGE            VALUE 'N'.     01720048
017400                                                                  01730029
017500                                                                  01740026
017600     05  PV-RECEIV-KEY-MSG.                                       01750026
017700         10  FILLER                    PIC X(07) VALUE ' KEY = '. 01760029
017800         10  PVT-OPER                  PIC 9(04).                 01770029
017900         10  FILLER                    PIC X(03) VALUE ' - '.     01780029
018000         10  PVT-FCLTY                 PIC 9(04).                 01790029
018100         10  FILLER                    PIC X(03) VALUE ' - '.     01800029
018200         10  PVT-PO                    PIC 9(09).                 01810029
018300         10  FILLER                    PIC X(03) VALUE ' - '.     01820029
018400         10  PVT-SEQ                   PIC 9(09).                 01830029
018500*                                                                 01840026
018600*                                                                 01850026
018700 01  PS-PROGRAM-SWITCHES.                                         01860029
018800     05  PS-COMMAREA-SW                PIC X(01) VALUE 'Y'.       01870029
018900         88  PS-COMMAREA-VALID                   VALUE 'Y'.       01880029
019000         88  PS-COMMAREA-NOT-VALID               VALUE 'N'.       01890029
019100     05  PS-ERROR-SW                   PIC X(01) VALUE 'N'.       01900029
019200         88  PS-ERROR                          VALUE  'Y'.        01910029
019300         88  PS-NO-ERROR                       VALUE  'N'.        01920029
019400     05  PS-END-OF-SEL-ITEMS-QUEUE-SW                             01930029
019500                                       PIC X(01) VALUE 'N'.       01940029
019600         88  PS-END-OF-SEL-ITEMS-QUEUE         VALUE 'Y'.         01950029
019700         88  PS-NOT-END-OF-SEL-ITEMS-QUEUE     VALUE 'N'.         01960029
019800     05  PS-APRON-CHANGE-SW            PIC X(01) VALUE 'N'.       01970029
019900         88  PS-APRON-DESC-SAME                VALUE 'N'.         01980029
020000         88  PS-APRON-DESC-CHANGED             VALUE 'Y'.         01990029
020100     05  PS-UPDATE-SW                  PIC X(01) VALUE 'N'.       02000029
020200         88  PS-NO-UPDATES-DONE                VALUE 'N'.         02010026
020300         88  PS-UPDATES-DONE                   VALUE 'Y'.         02020026
020400                                                                  02030026
020500*---------------------------------------------------------------* 02040026
020600*  RECORD LAYOUT 'INSERT AUDIT MODULE'  RCKCS290                * 02050026
020700*---------------------------------------------------------------* 02060026
020800                                                                  02070026
020900     COPY RCWS031.                                                02080026
021000                                                                  02090026
021100*---------------------------------------------------------------* 02100026
021200*  RECORD LAYOUT FOR THE LIST SELECTION TEMP STORAGE QUEUE.     * 02110026
021300*---------------------------------------------------------------* 02120026
021400                                                                  02130026
021500     COPY PCWS016.                                                02140026
021600                                                                  02150026
021700/                                                                 02160026
021800*----------------------------------------------------------------*02170026
021900*    MAP LAYOUT                                                  *02180026
022000*----------------------------------------------------------------*02190026
022100                                                                  02200026
022200     COPY PCKM153.                                                02210026
022300     EJECT                                                        02220026
022400*----------------------------------------------------------------*02230026
022500*    COMMAREA COPYBOOK TO LINK TO DPKCS060 - PRINT DEST VALIDATION02240032
022600*----------------------------------------------------------------*02250026
022700                                                                  02260026
022800     COPY DPWS072.                                                02270032
022900                                                                  02280032
023000*----------------------------------------------------------------*02290032
023100*    ATTRIBUTE SETTINGS COPYBOOK.                                *02300032
023200*----------------------------------------------------------------*02310032
023300                                                                  02320032
023400     COPY DPWS015.                                                02330032
023500                                                                  02340032
023600*----------------------------------------------------------------*02350026
023700*    FUNCTION KEYS COPYBOOK                                      *02360026
023800*----------------------------------------------------------------*02370026
023900                                                                  02380026
024000     COPY DPWS016.                                                02390026
024100/                                                                 02400026
024200*----------------------------------------------------------------*02410026
024300**  SECURITY SUBROUTINE PARAMETERS                                02420026
024400*----------------------------------------------------------------*02430026
024500     COPY DPWS008.                                                02440026
024600/                                                                 02450026
024700******************************************************************02460026
024800** THE CALLING PARAMETER LIST (DPWS030) FOR THE CICS            **02470026
024900** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **02480026
025000******************************************************************02490026
025100     COPY DPWS030.                                                02500026
1122RM     COPY DPWS930.                                                02501078
025200 EJECT                                                            02510026
025300***************************************************************** 02520026
025400*    STANDARD COMMAREA.                                           02530026
025500***************************************************************** 02540026
025600                                                                  02550026
025700     COPY DPWS020.                                                02560066
025800     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02570026
025900                                                                  02580026
026000***************************************************************** 02590026
026100*    INTER-APPLICATION COMMAREA.                                  02600026
026200***************************************************************** 02610026
026300                                                                  02620026
026400         10  INTER-APPL-COMM-AREA PIC X(200).                     02630026
026500     COPY PCWS000.                                                02640026
026600     COPY RCWS012.                                                02650026
026800***************************************************************** 02670026
026900*    SPECIFIC COMMMAREA FOR PCKCS153.                             02680026
027000***************************************************************** 02690026
027100         10  ASC-SPECIFIC-COMMAREA.                               02700026
027200             15  ASC-OPER-UNT-ID             PIC  9(04).          02710036
027300             15  ASC-FACILITY-ID             PIC  9(04).          02720026
027400             15  ASC-CUR-OPER-UNT-ID         PIC  9(04).          02730036
027500             15  ASC-CUR-FACILITY-ID         PIC  9(04).          02740036
027600             15  ASC-FCLTY-NME               PIC  X(24).          02750026
027700             15  ASC-PRINTER-DESTINATION     PIC  X(08).          02760028
027800             15  ASC-REPORT-ID               PIC  9(03).          02770026
027900             15  ASC-ORD-NBR.                                     02780026
028000                 20  ASC-ORD-NBR-N           PIC  9(08).          02790026
028100             15  ASC-REC-SEQ-NBR.                                 02800026
028200                 20  ASC-REC-SEQ-NBR-N       PIC  9(03).          02810026
028300             15  ASC-ORD-LNE-NBR.                                 02820026
028400                 20  ASC-ORD-LNE-NBR-N       PIC  9(04).          02830026
028500             15  ASC-WORK-ORD-SEQ-NBR.                            02840026
028600                 20  ASC-WORK-ORD-SEQ-NBR-N  PIC  9(09).          02850026
028700             15  ASC-SEL-SUB                 PIC S9(04) COMP.     02860026
028800             15  ASC-SEL-ITEM                PIC S9(04) COMP.     02870026
028900             15  ASC-NUMBER-OF-ITEMS-READ                         02880026
029000                                             PIC S9(09) COMP-3.   02890026
029100             15  ASC-NUMBER-OF-SELECTED-ITEMS                     02900026
029200                                             PIC S9(09) COMP-3.   02910026
029300             15  ASC-NUMBER-OF-TS-ITEMS      PIC S9(05) COMP-3.   02920026
029400             15  ASC-SEL-QUEUE-NAME-IN       PIC X(08).           02930026
029500             15  ASC-SEL-QUEUE-NAME-OUT.                          02940026
029600                 20  ASC-SEL-TERM-ID-OUT PIC X(04).               02950026
029700                 20  ASC-SEL-TASK-NUMBER-OUT                      02960026
029800                                         PIC S9(05) COMP-3.       02970026
029900                 20  ASC-SEL-SEQ-OUT     PIC 9(01).               02980026
030000             15  ASC-USE-SELECTION-QUEUE-IND PIC X(01).           02990026
030100                 88  ASC-USE-SELECTION-QUEUE VALUE 'Y'.           03000026
030200             15  ASC-ORIGINATION-IND         PIC X(01).           03010026
030300                 88  ASC-CONTROL-APRON-REQUEST                    03020026
030400                                             VALUE '2'.           03030026
030500                 88  ASC-PRE-TICKET-REQUEST  VALUE '3'.           03040026
030600                 88  ASC-SORTATION-REQUEST   VALUE '6'.           03050026
030700                 88  ASC-MOPS-CIDS-REQUEST   VALUE '7'.           03060026
030800                 88  ASC-JEW-MNFST-REQUEST   VALUE '8'.           03070026
030900             15  ASC-PRINT-CTL-APRON-HEADER  PIC X(01).           03080026
031000                                                                  03090026
031100             15  ASC-MASTER-PO               PIC  X(01).          03100026
031200             15  ASC-CHECKIN-DOC             PIC  X(01).          03110026
031300             15  ASC-DISTRIBUTION-PACK       PIC  9(03).          03120026
031400             15  ASC-MULT-DIST-PACK-IND      PIC  X(01).          03130026
031500             15  ASC-FUNCTION                PIC  X(01).          03140026
031600             15  ASC-MERCH-LOC               PIC  X(15).          03150058
031700             15  ASC-STR-NBR                 PIC  9(04).          03160026
031800             15  ASC-APRON-LOC-DESC          PIC  X(08).          03170026
031900             15  ASC-APRON-LOC-DESC-OLD      PIC  X(08).          03180026
032000             15  ASC-MARKING-APRON-HDR-IND   PIC  X(01).          03190026
032100             15  ASC-MARKING-APRON-IND       PIC  X(01).          03200026
032300             15  ASC-PRTR-AUTO-CUTTER-IND    PIC  X(01).          03210029
032400             15  ASC-PRTR-PRTR-BRCDE-IND     PIC  X(01).          03220035
032500             15  ASC-PRTR-PRTR-CNTL-IND      PIC  X(01).          03230029
032600             15  ASC-CALLED-PROGRAM         PIC  X(08).           03240039
032700                 88 ASC-CONTROL-APRON-PROGRAM                     03250039
032800                                           VALUE 'PCKCS011'.      03260039
032900                 88 ASC-PRE-TICKET-PROGRAM                        03270039
033000                                           VALUE 'PCKCS012'.      03280039
033100                 88 ASC-WRK-ORD-LIST-PROGRAM                      03290039
033200                                           VALUE 'PCKCS013'.      03300039
033300                 88 ASC-MARKING-APRON-PROGRAM                     03310039
033400                                           VALUE 'PCKCS013'.      03320039
033700                 88 ASC-SORTATION-PROGRAM                         03350039
033800                                           VALUE 'MPKCS032'.      03360039
033900                 88 ASC-MOPS-CIDS-PROGRAM                         03370039
034000                                           VALUE 'MPKCS014'.      03380039
034100                 88 ASC-JEW-MNFST-PROGRAM                         03390039
034200                                           VALUE 'RCKCS237'.      03400039
034300/                                                                 03410026
034400*                                                                 03420026
034500*  DCLGEN FOR THE LOGISTICS DOMAIN LOCATION MASTER TABLE          03430071
034600*                                                                 03440026
034700                                                                  03450026
034800     EXEC SQL                                                     03460026
034900         INCLUDE XLT00010                                         03470071
035000     END-EXEC.                                                    03480026
035100/                                                                 03490026
035200*                                                                 03500026
035300*  SQL AND COBOL DECLARATIONS FOR THE RECEIVER TABLE (TRECEIV)    03510026
035400*                                                                 03520026
035500                                                                  03530026
035600     EXEC SQL                                                     03540026
035700         INCLUDE TRECEIV                                          03550026
035800     END-EXEC.                                                    03560026
035900/                                                                 03570026
036000*                                                                 03580026
036100*  PACK SLIP HEADER TABLE (TPKSLIP)                               03590026
036200*                                                                 03600026
036300                                                                  03610026
036400     EXEC SQL                                                     03620026
036500         INCLUDE TPKSLIP                                          03630026
036600     END-EXEC.                                                    03640026
036700/                                                                 03650026
036800*                                                                 03660026
036900*  STANDARD LAYOUT FOR THE SQL COMMUNICATIONS AREA                03670026
037000*                                                                 03680026
037100     EXEC SQL                                                     03690026
037200         INCLUDE SQLCA                                            03700026
037300     END-EXEC.                                                    03710026
037400                                                                  03720026
037500*----------------------------------------------------------------*03730026
037600*    ABEND PROCESSING COPYBOOK.                                  *03740026
037700*----------------------------------------------------------------*03750026
037800**                                                                03760026
037900     COPY DPWS013.                                                03770026
038000                                                                  03780026
038100                                                                  03790026
038200 EJECT                                                            03800026
038300 LINKAGE SECTION.                                                 03810026
038400                                                                  03820026
038500 01  DFHCOMMAREA.                                                 03830026
038600     05  FILLER                         OCCURS  1 TO 4072 TIMES   03840026
038700                                        DEPENDING ON EIBCALEN.    03850026
038800         10  FILLER                     PIC X.                    03860026
038900                                                                  03870026
039000                                                                  03880026
039100 PROCEDURE DIVISION.                                              03890026
039200***************************************************************** 03900026
039300** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 03910026
039400** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 03920026
039500** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 03930026
039600**                                                             ** 03940026
039700** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 03950026
039800** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 03960026
039900***************************************************************** 03970026
040000 0000-MAIN-MODULE.                                                03980026
040100     INITIALIZE DP030-CICS-API-FIELDS.                            03990026
040200     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       04000026
040300     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          04010026
040400     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         04020026
040500     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       04030026
040600     MOVE LENGTH OF PC153AI        TO DP030-MAP-LENGTH (1).       04040026
040700     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     04050026
040800     PERFORM 0001-CALL-CICS-ARCH-API.                             04060026
040900*                                                                 04070026
041000     PERFORM 1000-CONTROL-PROCESSING                              04080026
041100*                                                                 04090026
041200     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     04100026
041300     PERFORM 0001-CALL-CICS-ARCH-API.                             04110026
041400                                                                  04120026
041500 0001-CALL-CICS-ARCH-API.                                         04130026
1122RM*    CALL 'DPKCS030' USING DFHEIBLK                               04140078
1122RM     CALL DP930-CICS-ARCH-API                                     04141078
1122RM                     USING DFHEIBLK                               04142078
041700                           DFHCOMMAREA                            04150026
041800                           DP030-CICS-API-FIELDS                  04160026
041900                           DP020-STANDARD-COMMAREA                04170026
042000                           PC153AI.                               04180026
042100*                                                                 04190026
042200     IF  DP030-RC-CALL-SUCCESSFUL                                 04200026
042300         CONTINUE                                                 04210026
042400     ELSE                                                         04220026
042500         SET DP013-NO-ROLLBACK                                    04230026
042600             DP013-XCTL-DISPLAY-RESTART                           04240026
042700             DP013-CICS-ABEND      TO TRUE                        04250026
042800         MOVE 'BEFORE 0000-MAIN-MODULE'                           04260026
042900                                   TO DP013-PARAGRAPH             04270026
1122RM*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX04280078
1122RM*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      04290078
1122RM         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O04291078
1122RM-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      04292078
043200         MOVE DP030-RETURN-CODE                                   04300026
043300                                   TO DP013-MESSAGE-TEXT (3)      04310026
043400         PERFORM DP013-0000-PROCESS-ABEND                         04320026
043500     END-IF.                                                      04330026
043600 EJECT                                                            04340026
043700*----------------------------------------------------------------*04350026
043800*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *04360026
043900*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *04370026
044000*----------------------------------------------------------------*04380026
044100                                                                  04390026
044200 1000-CONTROL-PROCESSING.                                         04400026
044300                                                                  04410026
044400     EVALUATE TRUE                                                04420026
044500         WHEN DP020-NEXT-ACT-INITIAL                              04430026
044600             INITIALIZE ASC-SPECIFIC-COMMAREA                     04440026
044700             PERFORM 1100-PROCESS-INTER-APPL-COMM                 04450026
044800             IF  PS-COMMAREA-NOT-VALID                            04460026
044900                 CONTINUE                                         04470026
045000             ELSE                                                 04480026
045100                 PERFORM 4000-BUILD-INITIAL-PANEL                 04490026
045200                 PERFORM 3200-RESET-ATTRIBUTES                    04500026
045300             END-IF                                               04510026
045400                                                                  04520026
045500         WHEN DP020-NEXT-ACT-READ-MAP                             04530026
045600             PERFORM 2000-FKEY-PROCESSING                         04540026
045700                                                                  04550026
045800         WHEN DP020-NEXT-ACT-RETURN                               04560026
045900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 04570026
046000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   04580026
046100                                                                  04590026
046200         WHEN OTHER                                               04600026
046300             SET DP013-LOGIC-ABEND                                04610026
046400                 DP013-NO-ROLLBACK TO TRUE                        04620026
046500             MOVE '1000-CONTROL-PROCESSING'                       04630026
046600                                   TO  DP013-PARAGRAPH            04640026
046700             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   04650026
046800                                   TO  DP013-MESSAGE-TEXT(1)      04660026
046900             MOVE DP020-NEXT-APPL-ACTIVITY                        04670026
047000                                   TO DP013-MESSAGE-TEXT(2)       04680026
047100             PERFORM DP013-0000-PROCESS-ABEND                     04690026
047200     END-EVALUATE.                                                04700026
047300/                                                                 04710026
047400*----------------------------------------------------------------*04720026
047500* MOVE DATA PASSED THROUGH THE INTER-APPL COMMAREA               *04730026
047600*----------------------------------------------------------------*04740026
047700 1100-PROCESS-INTER-APPL-COMM.                                    04750026
047800                                                                  04760026
047900     MOVE DP020-INT-APPL-FORMAT-IND                               04770026
048000                                   TO ASC-ORIGINATION-IND.        04780026
048100                                                                  04790026
048200     EVALUATE DP020-INT-APPL-FORMAT-IND                           04800026
048300                                                                  04810028
048400         WHEN PC-INTER-APPL-CRIT-SPEC                             04820026
048500             PERFORM 1110-PROC-INTER-APPL-COMM-SPEC               04830028
048600                                                                  04840028
048700         WHEN PC-PRE-TICKET-REQUEST                               04850026
048800             SET ASC-PRE-TICKET-PROGRAM TO TRUE                   04860039
048900             PERFORM 1110-PROC-INTER-APPL-COMM-SPEC               04870028
049000                                                                  04880028
049100         WHEN PC-MOPS-CIDS-REQUEST                                04890026
049200             SET ASC-MOPS-CIDS-PROGRAM TO TRUE                    04900039
049300             PERFORM 1110-PROC-INTER-APPL-COMM-SPEC               04910026
049400                                                                  04920026
049500         WHEN PC-SORTATION-REQUEST                                04930026
049600             SET ASC-SORTATION-PROGRAM TO TRUE                    04940039
049700             PERFORM 1115-PROC-INTER-APPL-COMM-SPEC               04950026
049800                                                                  04960026
049900         WHEN PC-WRK-ORD-LIST-REQUEST                             04970057
050000             SET ASC-WRK-ORD-LIST-PROGRAM TO TRUE                 04980057
050100             SET ASC-USE-SELECTION-QUEUE                          04990057
050200                                   TO TRUE                        05000057
050300             PERFORM 1120-PROC-INTER-APPL-COMM-LIST               05010057
050400             PERFORM 1150-MARKING-APRON-EDITS                     05020057
050500                                                                  05030057
050600         WHEN PC-MARKING-APRON-REQUEST                            05040026
050700         WHEN PC-PACK-APRON-REQUEST                               05050052
050800             SET ASC-MARKING-APRON-PROGRAM                        05060039
050900                 ASC-USE-SELECTION-QUEUE                          05070028
051000                                   TO TRUE                        05080026
051100             PERFORM 1120-PROC-INTER-APPL-COMM-LIST               05090026
051200             PERFORM 1150-MARKING-APRON-EDITS                     05100026
051300                                                                  05110028
051400         WHEN PC-CONTROL-APRON-REQUEST                            05120060
051500              SET ASC-CONTROL-APRON-PROGRAM                       05130060
051600                  ASC-USE-SELECTION-QUEUE                         05140060
051700                                   TO TRUE                        05150060
051800              MOVE PC-Y            TO ASC-PRINT-CTL-APRON-HEADER  05160060
051900              PERFORM 1120-PROC-INTER-APPL-COMM-LIST              05170060
052000                                                                  05180060
052100         WHEN PC-JEW-MNFST-REQUEST                                05190026
052200             SET ASC-JEW-MNFST-PROGRAM TO TRUE                    05200039
052300             PERFORM 1140-PROC-INTER-APPL-COMM-SPEC               05210026
052400     END-EVALUATE.                                                05220026
052500/                                                                 05230026
052600*----------------------------------------------------------------*05240026
052700* MOVE DATA PASSED THROUGH THE INTER-APPL COMMAREA FROM THE      *05250026
052800* CRITERIA SPEC PROGRAM                                          *05260026
052900*----------------------------------------------------------------*05270026
053000 1110-PROC-INTER-APPL-COMM-SPEC.                                  05280026
053100                                                                  05290026
053200     MOVE PC000-OPERATING-UNIT-ID  TO ASC-OPER-UNT-ID.            05300036
053300     MOVE PC000-FACILITY-ID        TO ASC-FACILITY-ID.            05310026
053400     MOVE PC000-REPORT-ID          TO ASC-REPORT-ID.              05320026
053500     MOVE PC000-PO-NBR-N           TO ASC-ORD-NBR-N.              05330026
053600     MOVE PC000-REC-SEQ-NBR-N      TO ASC-REC-SEQ-NBR-N.          05340026
053700     MOVE PC000-LINE-NBR-N         TO ASC-ORD-LNE-NBR-N.          05350026
053800     MOVE PC000-WO-NBR-N           TO ASC-WORK-ORD-SEQ-NBR-N.     05360026
053900                                                                  05370026
054000     MOVE PC000-MASTER-PO         TO  ASC-MASTER-PO.              05380026
054100     MOVE PC000-CHECKIN-DOC       TO  ASC-CHECKIN-DOC.            05390026
054200     MOVE PC000-DISTRIBUTION-PACK TO  ASC-DISTRIBUTION-PACK.      05400026
054300     MOVE PC000-MULT-DIST-PACK-IND TO ASC-MULT-DIST-PACK-IND.     05410026
054400     MOVE PC000-FUNCTION          TO  ASC-FUNCTION.               05420026
054500     MOVE PC000-MERCH-LOCATION    TO  ASC-MERCH-LOC.              05430058
054600/                                                                 05440026
054700 1115-PROC-INTER-APPL-COMM-SPEC.                                  05450026
054800                                                                  05460026
054900     IF PC000-FUNCTION = SPACES                                   05470026
055000         MOVE PC-TSYMSG-00005                                     05480026
055100                          TO DP020-MSG-NUMBER                     05490026
055200         SET PS-ERROR                                             05500026
055300             PS-COMMAREA-NOT-VALID                                05510026
055400             DP020-NEXT-ACT-APPL-ERROR                            05520026
055500             DP020-MSG-FATAL                                      05530026
055600                          TO TRUE                                 05540026
055700     ELSE                                                         05550026
055800         MOVE PC000-OPERATING-UNIT-ID  TO ASC-OPER-UNT-ID         05560036
055900         MOVE PC000-FACILITY-ID        TO ASC-FACILITY-ID         05570026
056000         MOVE PC000-REPORT-ID          TO ASC-REPORT-ID           05580026
056100         MOVE PC000-PO-NBR-N           TO ASC-ORD-NBR-N           05590026
056200         MOVE PC000-REC-SEQ-NBR-N      TO ASC-REC-SEQ-NBR-N       05600026
056300         MOVE PC000-LINE-NBR-N         TO ASC-ORD-LNE-NBR-N       05610026
056400         MOVE PC000-WO-NBR-N           TO ASC-WORK-ORD-SEQ-NBR-N  05620026
056500                                                                  05630026
056600         MOVE PC000-MASTER-PO         TO  ASC-MASTER-PO           05640026
056700         MOVE PC000-CHECKIN-DOC       TO  ASC-CHECKIN-DOC         05650026
056800         MOVE PC000-DISTRIBUTION-PACK TO  ASC-DISTRIBUTION-PACK   05660026
056900         MOVE PC000-MULT-DIST-PACK-IND TO ASC-MULT-DIST-PACK-IND  05670026
057000         MOVE PC000-FUNCTION          TO  ASC-FUNCTION            05680026
057100     END-IF.                                                      05690026
057200/                                                                 05700026
057300*----------------------------------------------------------------*05710026
057400* MOVE DATA PASSED THROUGH THE INTER-APPL COMMAREA FROM THE      *05720026
057500* LIST PROGRAM                                                   *05730026
057600*----------------------------------------------------------------*05740026
057700 1120-PROC-INTER-APPL-COMM-LIST.                                  05750026
057800                                                                  05760026
057900     MOVE PC000-OPERATING-UNIT-ID TO ASC-OPER-UNT-ID.             05770036
058000     MOVE PC000-FACILITY-ID       TO ASC-FACILITY-ID.             05780026
058100     MOVE PC000-REPORT-ID         TO ASC-REPORT-ID.               05790026
058200     MOVE PC000-NUMBER-OF-SELECTED-ITEMS                          05800026
058300                                  TO ASC-NUMBER-OF-SELECTED-ITEMS.05810026
058400     MOVE PC000-NUMBER-OF-TS-ITEMS TO ASC-NUMBER-OF-TS-ITEMS.     05820026
058500     MOVE PC000-SEL-QUEUE-NAME    TO ASC-SEL-QUEUE-NAME-IN.       05830026
058600     MOVE PC016-MAX-ITEMS         TO ASC-SEL-SUB.                 05840026
058700     MOVE ZERO                    TO ASC-SEL-ITEM.                05850026
058800     PERFORM 1130-GET-NEXT-RECORD.                                05860026
058900/                                                                 05870026
059000******************************************************************05880026
059100* SET THE INDICATOR OF THE NEXT SELECTED OBJECT FROM THE         *05890026
059200* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE TO "INQ".              *05900026
059300* THIS IS REQUIRED WHEN RETURNING TO THE PROGRAM WHICH INVOKED   *05910026
059400* THIS PROGRAM.                                                  *05920026
059500******************************************************************05930026
059600 1130-GET-NEXT-RECORD.                                            05940026
059700                                                                  05950026
059800     ADD +1                        TO ASC-SEL-SUB.                05960026
059900     IF ASC-SEL-SUB > PC016-MAX-ITEMS                             05970026
060000         ADD +1                    TO ASC-SEL-ITEM                05980026
060100         MOVE +1                   TO ASC-SEL-SUB                 05990026
060200     END-IF.                                                      06000026
060300     IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                 06010026
060400         PERFORM 9100-READ-SEL-QUEUE                              06020026
060500         IF PC016-ITEM (ASC-SEL-SUB) > ZERO                       06030026
060600             SET PC016-INQ (ASC-SEL-SUB)           TO TRUE        06040026
060700             PERFORM 9200-REWRITE-SEL-QUEUE                       06050026
060800         ELSE                                                     06060026
060900             SUBTRACT +1 FROM ASC-SEL-SUB                         06070026
061000*            --- BOTTOM OF LIST ---                               06080026
061100             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            06090026
061200             SET DP020-MSG-INFORMATIONAL                          06100026
061300                                   TO TRUE                        06110026
061400         END-IF                                                   06120026
061500     ELSE                                                         06130026
061600         SUBTRACT +1 FROM ASC-SEL-ITEM                            06140026
061700         MOVE PC016-MAX-ITEMS      TO ASC-SEL-SUB                 06150026
061800         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            06160026
061900         SET DP020-MSG-INFORMATIONAL                              06170026
062000                                   TO TRUE                        06180026
062100     END-IF.                                                      06190026
062200/                                                                 06200026
062300*----------------------------------------------------------------*06210026
062400* MOVE DATA PASSED THROUGH THE INTER-APPL COMMAREA FROM THE      *06220026
062500* CRITERIA SPEC PROGRAM                                          *06230026
062600*----------------------------------------------------------------*06240026
062700 1140-PROC-INTER-APPL-COMM-SPEC.                                  06250026
062800                                                                  06260026
062900     MOVE RC012-OPER-UNT-ID        TO ASC-OPER-UNT-ID.            06270036
063000     MOVE RC012-FCLTY-ID           TO ASC-FACILITY-ID.            06280026
063100     MOVE PC000-REPORT-ID          TO ASC-REPORT-ID.              06290026
063200     MOVE RC012-PO-NBR             TO ASC-ORD-NBR-N.              06300026
063300     MOVE RC012-REC-SEQ-NBR        TO ASC-REC-SEQ-NBR-N.          06310026
063400     MOVE RC012-PO-LNE-NBR         TO ASC-ORD-LNE-NBR-N.          06320026
063500     MOVE RC012-STR-NBR            TO ASC-STR-NBR.                06330026
063600/                                                                 06340026
063700 1150-MARKING-APRON-EDITS.                                        06350026
063800                                                                  06360026
063900     IF PC016-ITEM (1) > ZERO                                     06370026
064000         MOVE PC016-PO-NBR-N (1)   TO DK-PO-NBR                   06380026
064100         MOVE PC016-REC-SEQ-NBR-N (1)                             06390026
064200                                   TO DK-REC-SEQ-NBR              06400026
064300                                                                  06410026
064400         PERFORM 7200-SELECT-ACTIVE-TPKSLIP                       06420026
064500         IF SQLCODE = +100                                        06430026
064600             SET PS-COMMAREA-NOT-VALID                            06440026
064700                 DP020-MSG-FATAL                                  06450026
064800                 DP020-NEXT-ACT-APPL-ERROR                        06460026
064900                          TO TRUE                                 06470026
065000             MOVE PC-TSYMSG-01178                                 06480026
065100                          TO DP020-MSG-NUMBER                     06490026
065200         ELSE                                                     06500026
065300                                                                  06510026
065400             PERFORM 7210-SELECT-INACT-TPKSLIP                    06520026
065500                                                                  06530026
065600             IF SQLCODE = ZERO OR -811                            06540026
065700                 SET PS-COMMAREA-NOT-VALID                        06550026
065800                     DP020-MSG-FATAL                              06560026
065900                     DP020-NEXT-ACT-APPL-ERROR                    06570026
066000                              TO TRUE                             06580026
066100                 MOVE PC-TSYMSG-01178                             06590026
066200                              TO DP020-MSG-NUMBER                 06600026
066300             END-IF                                               06610026
066400         END-IF                                                   06620026
066500                                                                  06630026
066600     ELSE                                                         06640026
066700         SET PS-COMMAREA-NOT-VALID TO TRUE                        06650026
066800                                                                  06660026
066900     END-IF.                                                      06670026
067000/                                                                 06680026
067100*----------------------------------------------------------------*06690026
067200* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*06700026
067300* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*06710026
067400* EDITS.                                                         *06720026
067500*----------------------------------------------------------------*06730026
067600 2000-FKEY-PROCESSING.                                            06740026
067700                                                                  06750026
067800     EVALUATE TRUE                                                06760026
067900                                                                  06770026
068000         WHEN DP020-SRC-AID = DP016-CLEAR                         06780026
068100             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   06790026
068200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06800026
068300                                                                  06810026
068400         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     06820026
068500             PERFORM 4000-BUILD-INITIAL-PANEL                     06830026
068600             PERFORM 3200-RESET-ATTRIBUTES                        06840026
068700                                                                  06850026
068800         WHEN OTHER                                               06860026
068900             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 06870026
069000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   06880026
069100             IF  PS-NO-ERROR                                      06890026
069200                 SET DP030-CONTINUE-GO TO TRUE                    06900026
069300                 PERFORM 2100-CHECK-FUNCTION-KEY                  06910026
069400             ELSE                                                 06920026
069500                 SET DP030-OVERRIDE-GO TO TRUE                    06930026
069600             END-IF                                               06940026
069700     END-EVALUATE.                                                06950026
069800                                                                  06960026
069900******************************************************************06970026
070000** ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED     **06980026
070100** FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED **06990026
070200** FROM THE CICS ARCHITECTURE API.                              **07000026
070300******************************************************************07010026
070400 2100-CHECK-FUNCTION-KEY.                                         07020026
070500                                                                  07030060
070600     SET PS-NO-UPDATES-DONE TO TRUE.                              07040060
070700                                                                  07050060
070800     EVALUATE TRUE                                                07060026
070900         WHEN DP020-FK-LOCAL-RETURN(DP020-SRC-AID)                07070026
071000             IF  ASC-USE-SELECTION-QUEUE                          07080026
071100                 PERFORM 2400-PROCESS-SEL-ITEMS-QUEUE             07090026
071200                 MOVE PC-TSYMSG-00098 TO DP020-MSG-NUMBER         07100026
071300                 SET DP020-MSG-INFORMATIONAL TO TRUE              07110026
071400             ELSE                                                 07120026
071500                 PERFORM 2300-PREPARE-INTER-APPL-COMM             07130026
071600                 EVALUATE TRUE                                    07140026
071700                     WHEN ASC-CONTROL-APRON-REQUEST               07150026
071800                          PERFORM 7010-START-TRANID-E011          07160026
071900                     WHEN ASC-PRE-TICKET-REQUEST                  07170026
072000                          PERFORM 7050-START-TRANID-E012          07180026
072100                     WHEN ASC-SORTATION-REQUEST                   07190026
072200                          PERFORM 7020-START-TRANID-M032          07200026
072300                     WHEN ASC-MOPS-CIDS-REQUEST                   07210026
072400                          PERFORM 7030-START-TRANID-M014          07220026
072500                     WHEN ASC-JEW-MNFST-REQUEST                   07230026
072600                          PERFORM 7040-START-TRANID-E237          07240026
072700                     WHEN OTHER                                   07250026
072800                          PERFORM 7000-START-TRANID-E013          07260026
072900                 END-EVALUATE                                     07270026
073000                                                                  07280026
073100                 MOVE PC-TSYMSG-00098 TO DP020-MSG-NUMBER         07290026
073200                 SET DP020-MSG-INFORMATIONAL TO TRUE              07300026
073300             END-IF                                               07310026
073400                                                                  07320026
073500         WHEN DP020-SRC-AID = DP016-ENTER                         07330026
073600             CONTINUE                                             07340026
073700                                                                  07350026
073800         WHEN OTHER                                               07360026
073900             SET DP013-NO-ROLLBACK                                07370026
074000                 DP013-XCTL-DISPLAY-RESTART                       07380026
074100                 DP013-CICS-ABEND  TO TRUE                        07390026
074200             MOVE '2100-CHECK-FUNCTION-KEY'                       07400026
074300                                   TO DP013-PARAGRAPH             07410026
074400             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      07420026
074500                                   TO DP013-MESSAGE-TEXT (1)      07430026
074600             PERFORM DP013-0000-PROCESS-ABEND                     07440026
074700     END-EVALUATE.                                                07450026
074800*----------------------------------------------------------------*07460026
074900* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*07470026
075000* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *07480026
075100* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *07490026
075200*----------------------------------------------------------------*07500026
075300 2200-MOVE-SCREEN-TO-COMMAREA.                                    07510026
075400                                                                  07520060
075500     IF  APRDSTL > ZERO                                           07530026
075600         MOVE APRDSTI              TO ASC-PRINTER-DESTINATION     07540026
075700     ELSE                                                         07550026
075800         IF  APRDSTF = DP015-ERASE-EOF                            07560026
075900             MOVE SPACE            TO ASC-PRINTER-DESTINATION     07570026
076000         END-IF                                                   07580026
076100     END-IF.                                                      07590026
076200                                                                  07600026
076300     IF AAPRLOCL > ZERO                                           07610026
076400         MOVE AAPRLOCI             TO ASC-APRON-LOC-DESC          07620026
076500     ELSE                                                         07630026
076600         IF AAPRLOCF = DP015-ERASE-EOF                            07640026
076700             MOVE SPACES           TO ASC-APRON-LOC-DESC          07650026
076800         END-IF                                                   07660026
076900     END-IF.                                                      07670026
077000                                                                  07680026
077100     IF ASC-APRON-LOC-DESC NOT = ASC-APRON-LOC-DESC-OLD           07690026
077200         SET PS-APRON-DESC-CHANGED TO TRUE                        07700026
077300         MOVE ASC-APRON-LOC-DESC   TO ASC-APRON-LOC-DESC-OLD      07710026
077400     ELSE                                                         07720026
077500         SET PS-APRON-DESC-SAME    TO TRUE                        07730026
077600     END-IF.                                                      07740026
077700                                                                  07750026
077800     IF AAPRHDRL > ZERO                                           07760026
077900         MOVE AAPRHDRI             TO ASC-MARKING-APRON-HDR-IND   07770026
078000     ELSE                                                         07780026
078100         IF AAPRHDRF = DP015-ERASE-EOF                            07790026
078200             MOVE SPACES           TO ASC-MARKING-APRON-HDR-IND   07800026
078300         END-IF                                                   07810026
078400     END-IF.                                                      07820026
078500                                                                  07830026
078600     IF AMRKAPRL > ZERO                                           07840026
078700         MOVE AMRKAPRI             TO ASC-MARKING-APRON-IND       07850026
078800     ELSE                                                         07860026
078900         IF AMRKAPRF = DP015-ERASE-EOF                            07870026
079000             MOVE SPACES           TO ASC-MARKING-APRON-IND       07880026
079100         END-IF                                                   07890026
079200     END-IF.                                                      07900026
080100                                                                  07910060
080200******************************************************************07920026
080300** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **07930026
080400** INTER-APPLICATION COMMAREA.                                  **07940026
080500******************************************************************07950026
080600 2300-PREPARE-INTER-APPL-COMM.                                    07960026
080700     EVALUATE DP020-INT-APPL-FORMAT-IND                           07970026
080800         WHEN PC-WRK-ORD-LIST-REQUEST                             07980026
080900         WHEN PC-MARKING-APRON-REQUEST                            07990026
081000         WHEN PC-PACK-APRON-REQUEST                               08000052
081100         WHEN PC-CONTROL-APRON-REQUEST                            08010026
081200         WHEN PC-JEW-MNFST-REQUEST                                08020026
081300             INITIALIZE PV-PCKCS013-COMMAREA                      08030026
081400             MOVE ASC-ORD-NBR-N       TO PV-CA-ORD-NBR            08040026
081500             MOVE ASC-REC-SEQ-NBR-N   TO PV-CA-RCVR-SEQ-NBR       08050026
081600             MOVE ASC-ORD-LNE-NBR-N   TO PV-CA-ORD-LNE-NBR        08060026
081700             MOVE ASC-WORK-ORD-SEQ-NBR-N                          08070026
081800                                      TO PV-CA-WORK-ORD-SEQ-NBR   08080026
081900             MOVE ASC-PRINTER-DESTINATION                         08090026
082000                                      TO PV-CA-PRINTER-DESTINATION08100026
082100             MOVE DP020-USERID        TO PV-CA-USER-ID            08110026
082200             MOVE ASC-OPER-UNT-ID                                 08120036
082300                                      TO PV-CA-OPERATING-ID       08130026
082400             MOVE ASC-FACILITY-ID     TO PV-CA-FACILITY-ID        08140026
082500             MOVE ASC-STR-NBR         TO PV-CA-STORE-NMBR         08150026
082600             MOVE ASC-MARKING-APRON-HDR-IND                       08160026
082700                                      TO PV-CA-MRKG-APRON-HDR-IND 08170026
082800             MOVE ASC-MARKING-APRON-IND                           08180060
082900                                      TO PV-CA-MRKG-APRON-IND     08190026
083000             IF DP020-INT-APPL-FORMAT-IND                         08200053
083100                                        = PC-PACK-APRON-REQUEST   08210053
083200               AND PV-CA-MRKG-APRON-IND = PC-Y                    08220053
083300                 MOVE PC-P            TO PV-CA-MRKG-APRON-IND     08230053
083400             END-IF                                               08240053
083500             IF ASC-PRINT-CTL-APRON-HEADER = PC-Y                 08250026
083600                 SET PV-CA-PRINT-CTL-APRON-HDR                    08260026
083700                                      TO TRUE                     08270026
083800             END-IF                                               08280026
083900                                                                  08290029
084000             MOVE ASC-PRTR-AUTO-CUTTER-IND                        08300032
084100                 TO PV-CA-PRTR-AUTO-CUTTER-IND                    08310029
084200                                                                  08320029
084300             MOVE ASC-PRTR-PRTR-BRCDE-IND                         08330035
084400                 TO PV-CA-PRTR-PRTR-BRCDE-IND                     08340035
084500                                                                  08350029
084600             MOVE ASC-PRTR-PRTR-CNTL-IND                          08360032
084700                 TO PV-CA-PRTR-PRTR-CNTL-IND                      08370029
084800                                                                  08380041
084900             SET PV-CA-NOT-PRINT-PACKAGE TO TRUE                  08390042
085000                                                                  08400029
085100             MOVE LENGTH OF PV-PCKCS013-COMMAREA                  08410029
085200                                      TO PV-COMMAREA-LENGTH       08420029
085300     END-EVALUATE.                                                08430026
085400 EJECT                                                            08440026
085500                                                                  08450026
085600******************************************************************08460026
085700** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **08470026
085800** INTER-APPLICATION COMMAREA.                                  **08480026
085900******************************************************************08490060
086000 2400-PROCESS-SEL-ITEMS-QUEUE.                                    08500026
086100                                                                  08510060
086200     EVALUATE DP020-INT-APPL-FORMAT-IND                           08520026
086300         WHEN PC-WRK-ORD-LIST-REQUEST                             08530026
086400         WHEN PC-MARKING-APRON-REQUEST                            08540026
086500         WHEN PC-PACK-APRON-REQUEST                               08550052
086600         WHEN PC-CONTROL-APRON-REQUEST                            08560026
086700             INITIALIZE PV-PCKCS013-COMMAREA                      08570026
086800             MOVE ASC-PRINTER-DESTINATION                         08580026
086900                                      TO PV-CA-PRINTER-DESTINATION08590026
087000             MOVE DP020-USERID        TO PV-CA-USER-ID            08600026
087100             MOVE ASC-OPER-UNT-ID                                 08610036
087200                                      TO PV-CA-OPERATING-ID       08620026
087300             MOVE ASC-FACILITY-ID     TO PV-CA-FACILITY-ID        08630026
087400             MOVE ASC-MARKING-APRON-HDR-IND                       08640026
087500                                      TO PV-CA-MRKG-APRON-HDR-IND 08650026
087600             MOVE ASC-MARKING-APRON-IND                           08660060
087700                                      TO PV-CA-MRKG-APRON-IND     08670026
087800             IF DP020-INT-APPL-FORMAT-IND                         08680053
087900                                        = PC-PACK-APRON-REQUEST   08690053
088000               AND PV-CA-MRKG-APRON-IND = PC-Y                    08700053
088100                 MOVE PC-P            TO PV-CA-MRKG-APRON-IND     08710053
088200             END-IF                                               08720053
088300                                                                  08730029
088400             MOVE ASC-PRTR-AUTO-CUTTER-IND                        08740032
088500                 TO PV-CA-PRTR-AUTO-CUTTER-IND                    08750029
088600                                                                  08760029
088700             MOVE ASC-PRTR-PRTR-BRCDE-IND                         08770035
088800                 TO PV-CA-PRTR-PRTR-BRCDE-IND                     08780035
088900                                                                  08790029
089000             MOVE ASC-PRTR-PRTR-CNTL-IND                          08800032
089100                 TO PV-CA-PRTR-PRTR-CNTL-IND                      08810029
089200                                                                  08820043
089300             SET PV-CA-NOT-PRINT-PACKAGE TO TRUE                  08830043
089400                                                                  08840029
089500             MOVE LENGTH OF PV-PCKCS013-COMMAREA                  08850026
089600                                      TO PV-COMMAREA-LENGTH       08860026
089700                                                                  08870026
089800             MOVE +1                  TO ASC-SEL-ITEM             08880026
089900             MOVE ASC-NUMBER-OF-SELECTED-ITEMS                    08890026
090000                            TO PV-CA-NUMBER-OF-SELECTED-ITEMS     08900026
090100             MOVE ASC-NUMBER-OF-TS-ITEMS                          08910026
090200                            TO PV-CA-NUMBER-OF-TS-ITEMS           08920026
090300             MOVE ZERO                TO ASC-SEL-SUB              08930026
090400             SET PS-NOT-END-OF-SEL-ITEMS-QUEUE                    08940026
090500                                       TO TRUE                    08950026
090600             PERFORM 9100-READ-SEL-QUEUE                          08960026
090700             MOVE PC016-MAX-ITEMS                                 08970026
090800                            TO PV-CA-MAX-ITEMS                    08980026
090900             IF PC016-ITEM (1) > ZERO                             08990026
091000                 MOVE PC016-PO-NBR-N (1)   TO PV-CA-ORD-NBR       09000026
091100                 MOVE PC016-REC-SEQ-NBR-N (1)                     09010026
091200                                           TO PV-CA-RCVR-SEQ-NBR  09020026
091300* * *  IF GOING TO PRINT THE PACK MARKING APRON, THE LINE-NBR     09030054
091400* * *  WILL ACTUALLY BE HOLDING A PACK ID                         09040054
091500                 MOVE PC016-LINE-NBR-N (1) TO PV-CA-ORD-LNE-NBR   09050026
091600                 MOVE PC016-WO-NBR-N (1)                          09060026
091700                                      TO PV-CA-WORK-ORD-SEQ-NBR   09070026
091800                 MOVE PC016-MRKG-APRON-REQ-IND (1)                09080026
091900                                     TO PV-CA-MRKG-APRON-REQ-IND  09090026
092000             END-IF                                               09100026
092100             PERFORM 2410-FETCH-WO-NBR-INFO                       09110026
092200                 UNTIL PS-END-OF-SEL-ITEMS-QUEUE                  09120026
092300                 OR ASC-SEL-ITEM > PV-NUM-ITEMS                   09130026
092400                                                                  09140026
092500            IF DP020-INT-APPL-FORMAT-IND =                        09150060
092600                 PC-WRK-ORD-LIST-REQUEST                          09160051
092700                   OR PC-MARKING-APRON-REQUEST                    09170051
092800                   OR PC-PACK-APRON-REQUEST                       09180051
092900                 PERFORM 7000-START-TRANID-E013                   09190026
093000            END-IF                                                09200060
093500     END-EVALUATE.                                                09210026
093600 EJECT                                                            09220026
093700                                                                  09230026
093800/                                                                 09240026
093900******************************************************************09250026
094000* READ THROUGH THE SELECTED-ITEMS TEMP STORAGE QUEUE TO RETRIEVE *09260026
094100* THE WORK ORDER NUMBER INFORMATION.  WRITE AN OUTPUT TS QUEUE   *09270026
094200* FOR EACH SELECTION QUEUE RECORD.  END-OF-FILE IS EITHER WHEN   *09280026
094300* AN INPUT REOCRD OCCURRENCE IS ZERO OR WHEN THE ITEM NUMBER IS  *09290026
094400* GREATER THAN THE NUMBER OF ITEMS IN THE INPUT QUEUE.           *09300026
094500* PCKCS011 WILL START FOR EVERY SELECTED LINE.  PCKCS010         *09310026
094600* IS STARTED ONLY AFTER ALL THE QUEUE RECORDS HAVE BEEN WRITTEN. *09320026
094700******************************************************************09330026
094800 2410-FETCH-WO-NBR-INFO.                                          09340026
094900                                                                  09350026
095000     PERFORM VARYING ASC-SEL-SUB FROM 1 BY 1                      09360026
095100                        UNTIL ASC-SEL-SUB > PC016-MAX-ITEMS       09370026
095200         IF PC016-ITEM (ASC-SEL-SUB) = ZERO                       09380026
095300             SET PS-END-OF-SEL-ITEMS-QUEUE TO TRUE                09390026
095400         ELSE                                                     09400026
095500             IF ASC-CONTROL-APRON-REQUEST                         09410026
095600                 MOVE PC016-LINE-NBR-N (ASC-SEL-SUB)              09420026
095700                                   TO PV-CA-ORD-LNE-NBR           09430026
095800                 IF ASC-PRINT-CTL-APRON-HEADER = PC-Y             09440026
095900                    SET PV-CA-PRINT-CTL-APRON-HDR                 09450026
096000                                           TO TRUE                09460026
096100                 END-IF                                           09470026
096200             SET PC016-PRT (ASC-SEL-SUB) TO TRUE                  09480026
096300             PERFORM 7010-START-TRANID-E011                       09490026
096400             END-IF                                               09500026
096500         END-IF                                                   09510026
096600     END-PERFORM.                                                 09520026
096700                                                                  09530026
096800     IF PS-END-OF-SEL-ITEMS-QUEUE                                 09540026
096900         PERFORM 9000-WRITE-SEL-QUEUE                             09550026
097000         PERFORM 9200-REWRITE-SEL-QUEUE                           09560026
097100     ELSE                                                         09570026
097200         PERFORM 9000-WRITE-SEL-QUEUE                             09580026
097300         PERFORM 9200-REWRITE-SEL-QUEUE                           09590026
097400         ADD +1                        TO ASC-SEL-ITEM            09600026
097500         MOVE +1                       TO ASC-SEL-SUB             09610026
097600         PERFORM 9100-READ-SEL-QUEUE                              09620026
097700     END-IF.                                                      09630026
097800                                                                  09640026
097900/                                                                 09650026
098000*----------------------------------------------------------------*09660026
098100* ENSURE THE DATA IS CORRECT.  NOTE THAT IN A CRITERIA SPECIFI-  *09670026
098200* CATION SCREEN ONLY MINIMAL EDITS ARE DONE.  EDITS RELATED TO   *09680026
098300* A SPECIFIC SCREEN THAT THE USER IS GOING TO (LOCAL-GO) ARE DONE*09690026
098400* IN THE DESTINATION PROGRAM, NOT HERE.                          *09700026
098500*----------------------------------------------------------------*09710026
098600                                                                  09720026
098700 3000-EDIT-DATA-IN-COMMAREA.                                      09730026
098800     PERFORM 3200-RESET-ATTRIBUTES.                               09740026
098900*                                                                 09750026
099000     EVALUATE TRUE                                                09760026
099100         WHEN ASC-PRINTER-DESTINATION = SPACES                    09770026
099200             SET PS-ERROR                                         09780026
099300                 DP020-MSG-FATAL  TO TRUE                         09790026
099400             MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER             09800026
099500             MOVE DP015-UNP-ALP-BRT-MDT                           09810026
099600                                  TO APRDSTA                      09820026
099700             MOVE DP015-RED       TO APRDSTC                      09830026
099800             MOVE DP015-REVERSE   TO APRDSTH                      09840026
099900             MOVE -1              TO APRDSTL                      09850026
100000             SET DP030-SET-CURSOR-APPL-1                          09860026
100100                                  TO TRUE                         09870026
100200         WHEN ASC-PRINTER-DESTINATION > SPACES                    09880026
100300*            VALIDATE USING DPKCS060                              09890029
100400             MOVE ASC-PRINTER-DESTINATION                         09900028
100500                                     TO DP072-PRINTER-ID          09910028
100600             MOVE ASC-CALLED-PROGRAM TO DP072-RPT-PGM-NME         09920039
100700             MOVE PC-01              TO DP072-RPT-PGM-TYP-ID      09930028
100800             MOVE ASC-OPER-UNT-ID    TO DP072-ORIGIN-OPER-UNT-ID  09940036
100900             MOVE ASC-CUR-OPER-UNT-ID                             09950036
101000                                     TO DP072-OPER-UNT-ID         09960036
101100             MOVE ASC-FACILITY-ID    TO DP072-ORIGIN-FCLTY-ID     09970036
101200             MOVE ASC-CUR-FACILITY-ID                             09980036
101300                                     TO DP072-FCLTY-ID            09990036
101400             SET DP072-VALIDATE     TO TRUE                       10000036
101500                                                                  10010036
101600             EXEC CICS                                            10020036
101700                 LINK PROGRAM  (PC-DPKCS060)                      10030036
101800                      COMMAREA (DP072-COMM-AREA)                  10040036
101900                      RESP     (PV-CICS-RESP)                     10050036
102000             END-EXEC                                             10060036
102100                                                                  10070036
102200             EVALUATE TRUE                                        10080036
102300                 WHEN PV-CICS-RESP = DFHRESP (NORMAL)             10090036
102400                     CONTINUE                                     10100036
102500                 WHEN OTHER                                       10110036
102600                       MOVE '3000-EDIT-DATA-IN-COMMAREA'          10120036
102700                                            TO DP013-PARAGRAPH    10130036
102800                       MOVE PV-CICS-RESP                          10140036
102900                            TO DP013-MESSAGE-TEXT(1)              10150036
103000                       MOVE SQLCA           TO DP013-SQLCA        10160036
103100                       SET DP013-LINK-RETURN                      10170036
103200                           DP013-CICS-ABEND                       10180036
103300                           DP013-NO-ROLLBACK TO TRUE              10190036
103400                       PERFORM DP013-0000-PROCESS-ABEND           10200036
103500             END-EVALUATE                                         10210036
103600                                                                  10220036
103700             IF  DP072-PRTR-PRTR-TRK-STAT-CDE = PC-A              10230036
103800                 MOVE DP072-PRTR-AUTO-CUTTER-IND                  10240036
103900                     TO ASC-PRTR-AUTO-CUTTER-IND                  10250036
104000                 MOVE DP072-PRTR-PRTR-BRCDE-IND                   10260036
104100                     TO ASC-PRTR-PRTR-BRCDE-IND                   10270036
104200                 MOVE DP072-PRTR-PRTR-CNTL-IND                    10280036
104300                     TO ASC-PRTR-PRTR-CNTL-IND                    10290036
104400             ELSE                                                 10300029
104500                 SET PS-ERROR                                     10310029
104600                     DP020-MSG-FATAL                              10320029
104700                                  TO TRUE                         10330029
104800                 MOVE PC-TSYMSG-00746                             10340029
104900                                  TO DP020-MSG-NUMBER             10350029
105000                 MOVE DP015-UNP-ALP-BRT-MDT                       10360029
105100                                  TO APRDSTA                      10370029
105200                 MOVE DP015-RED   TO APRDSTC                      10380029
105300                 MOVE DP015-REVERSE                               10390029
105400                                  TO APRDSTH                      10400029
105500                 MOVE -1          TO APRDSTL                      10410029
105600                 SET DP030-SET-CURSOR-APPL-1                      10420029
105700                                  TO TRUE                         10430029
105800             END-IF                                               10440029
105900     END-EVALUATE.                                                10450026
106000*                                                                 10460026
106100     IF  PS-NO-ERROR                                              10470026
106200         MOVE -1                   TO APRDSTL                     10480026
106300         SET DP030-SET-CURSOR-APPL-1                              10490026
106400                                   TO TRUE                        10500026
106500     END-IF.                                                      10510026
106600/                                                                 10520026
106700******************************************************************10530026
106800** MOVE THE DEFAULT ATTRIBUTES TO ALL OF THE OPEN FIELDS ON THE **10540026
106900** MAP.                                                         **10550026
107000******************************************************************10560026
107100 3200-RESET-ATTRIBUTES.                                           10570026
107200     MOVE DP015-UNP-ALP-NOR-OFF    TO APRDSTA.                    10580026
107300     MOVE DP015-GREEN              TO APRDSTC.                    10590026
107400     MOVE DP015-UNDERLINE          TO APRDSTH.                    10600026
107500                                                                  10610026
107600     IF PC016-MRKG-APRON-REQ-IND (ASC-SEL-SUB) = 'Y'              10620026
107700        AND (DP020-INT-APPL-FORMAT-IND = PC-MARKING-APRON-REQUEST 10630052
107800                                      OR PC-PACK-APRON-REQUEST)   10640060
107900         PERFORM 3210-CHECK-RACF                                  10650026
108000     END-IF.                                                      10660026
108100                                                                  10670026
108200*----------------------------------------------------------------*10680026
108300*    THE APRON LOCATION FIELD IS ONLY UPDATABLE IF THE USER HAS  *10690026
108400*    RACF ACCESS.                                                *10700026
108500*----------------------------------------------------------------*10710026
108600 3210-CHECK-RACF.                                                 10720026
108700                                                                  10730026
108800     SET DP008-RSRC-TYPE-FUNC     TO TRUE                         10740026
108900     MOVE 'RCAPRLOC'              TO DP008-FUNCTION-NAME          10750026
109000     SET DP008-ACCESS-TYPE-USE    TO TRUE                         10760026
109100                                                                  10770026
109200     EXEC CICS                                                    10780026
109300         LINK PROGRAM (DP008-SECURITY-SUBROUTINE)                 10790026
109400              COMMAREA (DP008-SECURITY-COMMAREA)                  10800026
109500              LENGTH (DP008-SECURITY-COMMAREA-LENGTH)             10810026
109600     END-EXEC                                                     10820026
109700                                                                  10830026
109800     IF DP008-CALL-SUCCESSFUL                                     10840026
109900         IF DP008-ACCESS-ALLOWED                                  10850026
110000             CONTINUE                                             10860026
110100         ELSE                                                     10870026
110200*        -- NO SECURITY CLEARANCE FOR FUNCTION --                 10880026
110300             MOVE DP015-PRO-NOR-OFF  TO AAPRLOCA                  10890026
110400             MOVE DP015-BLUE         TO AAPRLOCC                  10900026
110500             MOVE DP015-HL-OFF       TO AAPRLOCH                  10910026
110600         END-IF                                                   10920026
110700     ELSE                                                         10930026
110800         MOVE '3210-CHECK-RACF-ACCESS'                            10940026
110900                                     TO DP013-PARAGRAPH           10950026
111000         MOVE 'UNABLE TO ACCESS CICS'                             10960026
111100                                     TO DP013-MESSAGE-TEXT (1)    10970026
111200         MOVE SQLCA                  TO DP013-SQLCA               10980026
111300         SET DP013-DB2-ABEND                                      10990026
111400             DP013-XCTL-DISPLAY-RESTART                           11000026
111500                                     TO TRUE                      11010026
111600         PERFORM DP013-0000-PROCESS-ABEND                         11020026
111700     END-IF.                                                      11030026
111800/                                                                 11040026
111900*                                                                 11050026
112000*----------------------------------------------------------------*11060026
112100*  POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 *11070026
112200*  IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL, MOVE   *11080026
112300*  IT HERE.                                                      *11090026
112400*----------------------------------------------------------------*11100026
112500 4000-BUILD-INITIAL-PANEL.                                        11110026
112600                                                                  11120060
112700     SET DP030-SET-CURSOR-APPL-1   TO TRUE                        11130026
112800     MOVE -1                       TO APRDSTL.                    11140026
112900     MOVE ASC-OPER-UNT-ID          TO AOPRIDO                     11150036
113000                                      DK-OPER-UNT-ID.             11160026
113100     MOVE ASC-FACILITY-ID          TO AFACIDO                     11170026
113200                                      DK-FCLTY-ID.                11180026
113300     MOVE DP020-LOCATION-NBR       TO ASC-CUR-OPER-UNT-ID.        11190071
113500     MOVE 1                        TO ASC-CUR-FACILITY-ID.        11200037
113600     PERFORM 4010-GET-LOCATION-NAME.                              11210071
113700                                                                  11220026
113800     MOVE ASC-FCLTY-NME            TO AFDESCO.                    11230026
113900                                                                  11240026
114000     MOVE 'Y'                      TO AAPRHDRO                    11250026
114100                                      AMRKAPRO                    11260026
114300                                      ASC-MARKING-APRON-HDR-IND   11270026
114400                                      ASC-MARKING-APRON-IND       11280060
114600                                                                  11290026
114700     IF PC016-MRKG-APRON-REQ-IND (ASC-SEL-SUB) = 'Y'              11300026
114800        AND (DP020-INT-APPL-FORMAT-IND = PC-MARKING-APRON-REQUEST 11310052
114900                                      OR PC-PACK-APRON-REQUEST)   11320052
115000         PERFORM 4020-GET-TRECEIV                                 11330026
115100         MOVE RECEIV-APRON-LOC-DESC                               11340026
115200                                TO AAPRLOCO                       11350026
115300                                   ASC-APRON-LOC-DESC             11360026
115400                                   ASC-APRON-LOC-DESC-OLD         11370026
115500     ELSE                                                         11380026
115600        MOVE DP015-PRO-DRK-OFF  TO AAPRLOCA                       11390026
115700                                   AAPRLITA                       11400026
115800                                   AAPRHDRA                       11410026
115900                                   AHDRLITA                       11420026
116000                                   AMRKAPRA                       11430026
116100                                   AMRKLITA                       11440026
116300        MOVE DP015-HL-OFF       TO AAPRLOCH                       11460026
116400                                   AAPRHDRH                       11470026
116500                                   AMRKAPRH.                      11480075
116700/                                                                 11500026
116800*----------------------------------------------------------------*11510026
116900*    GET THE LOCATION NAME                                       *11520071
117000*----------------------------------------------------------------*11530026
117100 4010-GET-LOCATION-NAME.                                          11540071
117200                                                                  11550026
117300     PERFORM                                                      11560026
117400         WITH TEST AFTER                                          11570026
117500         VARYING PV-RETRY-COUNT                                   11580026
117600         FROM 1 BY 1                                              11590026
117700         UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 11600026
117800             OR (SQLCODE = +0)                                    11610026
117900             OR (SQLCODE = +100))                                 11620026
118000                                                                  11630026
118100         EXEC SQL                                                 11640026
118200              SELECT LOC_NM                                       11650071
118300                INTO :XLT00010-LOC-NM                             11660071
118400                FROM XLT_LOC                                      11670071
118500               WHERE LOC_NBR = :DK-OPER-UNT-ID                    11680071
118700         END-EXEC                                                 11690026
118800                                                                  11700026
118900         EVALUATE TRUE                                            11710026
119000             WHEN SQLCODE = +0                                    11720026
119100                  MOVE XLT00010-LOC-NM                            11730071
119200                                  TO ASC-FCLTY-NME                11740026
119300                                                                  11750026
119400             WHEN SQLCODE = +100                                  11760026
119500                  MOVE SPACES     TO ASC-FCLTY-NME                11770026
119600                                                                  11780026
119700             WHEN SQLCODE = -904                                  11790026
119800             WHEN SQLCODE = -913                                  11800026
119900                  CONTINUE                                        11810026
120000                                                                  11820026
120100             WHEN SQLWARN0 NOT = SPACES                           11830026
120200             WHEN SQLCODE < +0                                    11840026
120300             WHEN SQLCODE > +0                                    11850026
120400                  MOVE '4010-GET-LOCATION-NAME'                   11860071
120500                                  TO DP013-PARAGRAPH              11870026
120600                  MOVE 'UNSUCCESSFUL SELECT ON XLT_LOC TABLE'     11880071
120700                                  TO DP013-MESSAGE-TEXT (1)       11890026
120800                  MOVE SQLCA      TO DP013-SQLCA                  11900026
120900                  MOVE 'XLT_LOC ' TO DP013-DB2-TABLE-NAME (1)     11910071
121000                  SET DP013-DB2-ABEND                             11920026
121100                      DP013-XCTL-DISPLAY-RESTART                  11930026
121200                                  TO TRUE                         11940026
121300                  PERFORM DP013-0000-PROCESS-ABEND                11950026
121400         END-EVALUATE                                             11960026
121500     END-PERFORM.                                                 11970026
121600                                                                  11980026
121700     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          11990026
121800         MOVE '4010-GET-LOCATION-NAME'                            12000071
121900                                  TO DP013-PARAGRAPH              12010026
122000         MOVE 'MAX RETRIES EXCEEDED ON SELECT XLT_LOC TABLE'      12020071
122100                                  TO DP013-MESSAGE-TEXT (1)       12030026
122200         MOVE SQLCA               TO DP013-SQLCA                  12040026
122300         MOVE 'XLT_LOC'           TO DP013-DB2-TABLE-NAME (1)     12050071
122400         SET DP013-DB2-ABEND                                      12060026
122500             DP013-XCTL-DISPLAY-RESTART                           12070026
122600                                  TO TRUE                         12080026
122700         PERFORM DP013-0000-PROCESS-ABEND                         12090026
122800     END-IF.                                                      12100026
122900/                                                                 12110026
123000 4020-GET-TRECEIV.                                                12120026
123100     MOVE PC016-PO-NBR-N (1)       TO DK-PO-NBR                   12130026
123200     MOVE PC016-REC-SEQ-NBR-N (1)  TO DK-REC-SEQ-NBR              12140026
123300                                                                  12150026
123400     EXEC SQL                                                     12160026
123500         SELECT APRON_LOC_DESC                                    12170026
123600         INTO                         :RECEIV-APRON-LOC-DESC      12180026
123700         FROM TRECEIV                                             12190026
123800         WHERE OPER_UNT_ID          = :DK-OPER-UNT-ID             12200026
123900             AND FCLTY_ID           = :DK-FCLTY-ID                12210026
124000             AND ORD_NBR            = :DK-PO-NBR                  12220026
124100             AND REC_SEQ_NBR        = :DK-REC-SEQ-NBR             12230026
124200             AND VER_STATUS_CDE     = :PC-A                       12240026
124300     END-EXEC.                                                    12250026
124400                                                                  12260026
124500     EVALUATE TRUE                                                12270026
124600         WHEN SQLCODE = ZERO                                      12280026
124700             CONTINUE                                             12290026
124800         WHEN SQLCODE = +100                                      12300026
124900             MOVE SPACES            TO RECEIV-APRON-LOC-DESC      12310026
125000         WHEN SQLCODE = -904                                      12320026
125100         WHEN SQLCODE = -911                                      12330026
125200         WHEN SQLCODE = -913                                      12340026
125300              PERFORM 9900-SOFT-ABORT                             12350026
125400                                                                  12360026
125500         WHEN SQLWARN0 NOT = SPACES                               12370026
125600         WHEN SQLCODE < +0                                        12380026
125700         WHEN SQLCODE > +0                                        12390026
125800             MOVE '4020-GET-TRECEIV'                              12400026
125900                               TO DP013-PARAGRAPH                 12410026
126000             MOVE 'SELECT APRON LOC DESC    '                     12420026
126100                               TO DP013-MESSAGE-TEXT(1)           12430026
126200             MOVE SQLCA            TO DP013-SQLCA                 12440026
126300             MOVE 'TRECEIV'        TO DP013-DB2-TABLE-NAME (1)    12450026
126400             MOVE DK-OPER-UNT-ID                                  12460026
126500                             TO PVT-OPER                          12470026
126600             MOVE DK-FCLTY-ID                                     12480026
126700                             TO PVT-FCLTY                         12490026
126800             MOVE DK-PO-NBR      TO PVT-PO                        12500026
126900             MOVE DK-REC-SEQ-NBR                                  12510026
127000                             TO PVT-SEQ                           12520026
127100             MOVE PV-RECEIV-KEY-MSG                               12530026
127200                             TO DP013-MESSAGE-TEXT (2)            12540026
127300             SET DP013-DB2-ABEND                                  12550026
127400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               12560026
127500             PERFORM DP013-0000-PROCESS-ABEND                     12570026
127600     END-EVALUATE.                                                12580026
127700/                                                                 12590026
127800*                                                                 12600026
127900*----------------------------------------------------------------*12610026
128000*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *12620026
128100*----------------------------------------------------------------*12630026
128200 4400-MOVE-COMMAREA-TO-SCREEN.                                    12640026
128300     MOVE ASC-OPER-UNT-ID          TO AOPRIDO.                    12650036
128400     MOVE ASC-FCLTY-NME            TO AFDESCO.                    12660026
128500     MOVE ASC-FACILITY-ID          TO AFACIDO.                    12670026
128600     MOVE ASC-PRINTER-DESTINATION  TO APRDSTO.                    12680026
128700*                                                                 12690026
128800*----------------------------------------------------------------*12700026
128900*    START TRANID FOR PCKCS013 (PRINT MANIFEST).                 *12710026
129000*----------------------------------------------------------------*12720026
129100 7000-START-TRANID-E013.                                          12730026
129200                                                                  12740026
129300     IF (DP020-INT-APPL-FORMAT-IND = PC-MARKING-APRON-REQUEST     12750052
129400                                  OR PC-PACK-APRON-REQUEST)       12760052
129500                AND PS-APRON-DESC-CHANGED                         12770026
129600         PERFORM 8000-LINK-AUDIT-MODULE                           12780026
129700         PERFORM 7100-UPDATE-TRECEIV                              12790026
129800     END-IF.                                                      12800026
129900                                                                  12810026
130000     MOVE ASC-SEL-QUEUE-NAME-OUT TO PV-CA-SEL-QUEUE-NAME          12820026
130100                                                                  12830026
130200* ************************************************************** *12840049
130300* * PURGE-ARCHIVE-RETRIEVAL (PAR) PROJECT:                     * *12850049
130400* * CHECK PACKAGE INDICATOR IN DETERMIMING WHICH TRAN ID TO    * *12860049
130500* * START. (MULTIPLE TRAN IDS AND MNEMONICS ASSOCIATED WITH    * *12870049
130600* * THE PROGRAM TO BE STARTED; THESE DETERMINE WHICH SET OF    * *12880049
130700* * DB2 TABLES WILL BE ACCESSED: REGULAR OR ARCHIVED HISTORY.) * *12890049
130800* ************************************************************** *12900049
130900     IF DP020-SRC-DB2-PKG-ARCHIVE                                 12910050
131000         EXEC CICS                                                12920049
131100              START TRANSID ('EA13')                              12930049
131200                   FROM     (PV-PCKCS013-COMMAREA)                12940049
131300         END-EXEC                                                 12950049
131400     ELSE                                                         12960049
131500         EXEC CICS                                                12970049
131600              START TRANSID ('E013')                              12980049
131700                   FROM     (PV-PCKCS013-COMMAREA)                12990049
131800         END-EXEC                                                 13000049
131900     END-IF.                                                      13010049
132000                                                                  13020060
135500*----------------------------------------------------------------*13030026
135600*    START TRANID FOR PCKCS011 (PRINT CONTROL APRON)             *13040026
135700*----------------------------------------------------------------*13050026
135800 7010-START-TRANID-E011.                                          13060026
135900                                                                  13070026
136000* ************************************************************** *13080049
136100* * PURGE-ARCHIVE-RETRIEVAL (PAR) PROJECT:                     * *13090049
136200* * CHECK PACKAGE INDICATOR IN DETERMIMING WHICH TRAN ID TO    * *13100049
136300* * START. (MULTIPLE TRAN IDS AND MNEMONICS ASSOCIATED WITH    * *13110049
136400* * THE PROGRAM TO BE STARTED; THESE DETERMINE WHICH SET OF    * *13120049
136500* * DB2 TABLES WILL BE ACCESSED: REGULAR OR ARCHIVED HISTORY.) * *13130049
136600* ************************************************************** *13140049
136700     IF DP020-SRC-DB2-PKG-ARCHIVE                                 13150050
136800         EXEC CICS                                                13160049
136900              START TRANSID ('EA11')                              13170049
137000                   FROM     (PV-PCKCS011-COMMAREA)                13180049
137100         END-EXEC                                                 13190049
137200     ELSE                                                         13200049
137300         EXEC CICS                                                13210049
137400              START TRANSID ('E011')                              13220049
137500                   FROM     (PV-PCKCS011-COMMAREA)                13230049
137600         END-EXEC                                                 13240049
137700     END-IF.                                                      13250049
137800                                                                  13260026
137900     MOVE SPACES                   TO ASC-PRINT-CTL-APRON-HEADER  13270026
138000                                      PV-CA-MRKG-APRON-REQ-IND.   13280026
138100/                                                                 13290026
138200*----------------------------------------------------------------*13300026
138300*    FORMAT THE SORTATION COMMAREA AND START THE TRAN.           *13310026
138400*----------------------------------------------------------------*13320026
138500                                                                  13330026
138600 7020-START-TRANID-M032.                                          13340026
138700                                                                  13350026
138800     MOVE ASC-PRINTER-DESTINATION TO  PV-SC-PRINTER.              13360026
138900     MOVE ASC-ORD-NBR-N           TO  PV-SC-PO-NBR.               13370026
139000     MOVE ASC-REC-SEQ-NBR-N       TO  PV-SC-REC-SEQ-NBR.          13380026
139100     MOVE ASC-DISTRIBUTION-PACK   TO  PV-SC-DIST-PACK.            13390026
139200     MOVE ASC-FUNCTION            TO  PV-SC-FUNCTION.             13400026
139300     MOVE ASC-ORD-LNE-NBR-N       TO  PV-SC-LNE-NBR.              13410026
139400     MOVE DP020-USERID            TO  PV-SC-USERID.               13420026
139500     MOVE ASC-MULT-DIST-PACK-IND  TO  PV-SC-MULT-DIST-PACK-IND.   13430026
139600                                                                  13440029
139700     MOVE ASC-PRTR-AUTO-CUTTER-IND                                13450032
139800                                  TO PV-SC-PRTR-AUTO-CUTTER-IND.  13460029
139900                                                                  13470029
140000     MOVE ASC-PRTR-PRTR-BRCDE-IND                                 13480035
140100                                  TO PV-SC-PRTR-PRTR-BRCDE-IND.   13490035
140200                                                                  13500029
140300     MOVE ASC-PRTR-PRTR-CNTL-IND  TO PV-SC-PRTR-PRTR-CNTL-IND.    13510032
140400     SET  PV-SC-NOT-PRINT-PACKAGE TO TRUE.                        13520047
140500                                                                  13530026
140600* ************************************************************** *13540049
140700* * PURGE-ARCHIVE-RETRIEVAL (PAR) PROJECT:                     * *13550049
140800* * CHECK PACKAGE INDICATOR IN DETERMIMING WHICH TRAN ID TO    * *13560049
140900* * START. (MULTIPLE TRAN IDS AND MNEMONICS ASSOCIATED WITH    * *13570049
141000* * THE PROGRAM TO BE STARTED; THESE DETERMINE WHICH SET OF    * *13580049
141100* * DB2 TABLES WILL BE ACCESSED: REGULAR OR ARCHIVED HISTORY.) * *13590049
141200* ************************************************************** *13600049
141300     IF DP020-SRC-DB2-PKG-ARCHIVE                                 13610050
141400         EXEC CICS                                                13620049
141500              START TRANSID ('MA32')                              13630049
141600                   FROM     (PV-SORTATION-COMMAREA)               13640049
141700         END-EXEC                                                 13650049
141800     ELSE                                                         13660049
141900         EXEC CICS                                                13670049
142000              START TRANSID ('M032')                              13680049
142100                   FROM     (PV-SORTATION-COMMAREA)               13690049
142200         END-EXEC                                                 13700049
142300     END-IF.                                                      13710049
142400/                                                                 13720026
142500*----------------------------------------------------------------*13730026
142600*    FORMAT THE MOPS/CIDS COMMAREA AND START THE TRAN.           *13740026
142700*----------------------------------------------------------------*13750026
142800                                                                  13760026
142900 7030-START-TRANID-M014.                                          13770026
143000                                                                  13780026
143100     MOVE ASC-ORD-NBR-N           TO  PV-MC-PO-NBR.               13790026
143200     MOVE ASC-REC-SEQ-NBR-N       TO  PV-MC-REC-SEQ-NBR.          13800026
143300     MOVE ASC-OPER-UNT-ID         TO  PV-MC-OPER-UNT-ID.          13810036
143400     MOVE ASC-FACILITY-ID         TO  PV-MC-FCLTY-ID.             13820026
143500     MOVE DP020-USERID            TO  PV-MC-CLERK.                13830026
143600     MOVE ASC-PRINTER-DESTINATION TO  PV-MC-PRINTER.              13840026
143700     MOVE ASC-MASTER-PO           TO  PV-MC-MASTER-PO.            13850026
143800     MOVE ASC-CHECKIN-DOC         TO  PV-MC-CHECKIN-DOC.          13860026
143900     MOVE ASC-ORD-LNE-NBR-N       TO  PV-MC-CHECKIN-DOC-LINE.     13870026
144000*GB                                                               13880058
144100     MOVE ASC-MERCH-LOC           TO  PV-MC-MERCH-LOC.            13890058
144200     MOVE ASC-PRTR-AUTO-CUTTER-IND                                13900032
144300                                  TO PV-MC-PRTR-AUTO-CUTTER-IND.  13910029
144400                                                                  13920029
144500     MOVE ASC-PRTR-PRTR-BRCDE-IND                                 13930035
144600                                  TO PV-MC-PRTR-PRTR-BRCDE-IND.   13940035
144700                                                                  13950029
144800     MOVE ASC-PRTR-PRTR-CNTL-IND  TO PV-MC-PRTR-PRTR-CNTL-IND.    13960032
144900                                                                  13970029
145000     SET PV-MC-NOT-PRINT-PACKAGE  TO TRUE.                        13980047
145100                                                                  13990026
145200* ************************************************************** *14000049
145300* * PURGE-ARCHIVE-RETRIEVAL (PAR) PROJECT:                     * *14010049
145400* * CHECK PACKAGE INDICATOR IN DETERMIMING WHICH TRAN ID TO    * *14020049
145500* * START. (MULTIPLE TRAN IDS AND MNEMONICS ASSOCIATED WITH    * *14030049
145600* * THE PROGRAM TO BE STARTED; THESE DETERMINE WHICH SET OF    * *14040049
145700* * DB2 TABLES WILL BE ACCESSED: REGULAR OR ARCHIVED HISTORY.) * *14050049
145800* ************************************************************** *14060049
145900     IF DP020-SRC-DB2-PKG-ARCHIVE                                 14070050
146000         EXEC CICS                                                14080049
146100              START TRANSID ('MA14')                              14090049
146200                   FROM     (PV-MOPS-CIDS-COMMAREA)               14100049
146300         END-EXEC                                                 14110049
146400     ELSE                                                         14120049
146500         EXEC CICS                                                14130049
146600              START TRANSID ('M014')                              14140049
146700                   FROM     (PV-MOPS-CIDS-COMMAREA)               14150049
146800         END-EXEC                                                 14160049
146900     END-IF.                                                      14170049
147000/                                                                 14180026
147100*----------------------------------------------------------------*14190026
147200*    FORMAT THE MOPS/CIDS COMMAREA AND START THE TRAN.           *14200026
147300*----------------------------------------------------------------*14210026
147400                                                                  14220026
147500 7040-START-TRANID-E237.                                          14230026
147600                                                                  14240026
147700* ************************************************************** *14250049
147800*** PURGE-ARCHIVE-RETRIEVAL (PAR) PROJECT:                     * *14260058
147900* * CHECK PACKAGE INDICATOR IN DETERMIMING WHICH TRAN ID TO    * *14270049
148000* * START. (MULTIPLE TRAN IDS AND MNEMONICS ASSOCIATED WITH    * *14280049
148100* * THE PROGRAM TO BE STARTED; THESE DETERMINE WHICH SET OF    * *14290049
148200* * DB2 TABLES WILL BE ACCESSED: REGULAR OR ARCHIVED HISTORY.) * *14300049
148300* ************************************************************** *14310049
148400     IF DP020-SRC-DB2-PKG-ARCHIVE                                 14320050
148500         EXEC CICS                                                14330049
148600              START TRANSID ('EC37')                              14340049
148700                   FROM     (PV-PCKCS153-COMMAREA)                14350049
148800         END-EXEC                                                 14360049
148900     ELSE                                                         14370049
149000         EXEC CICS                                                14380049
149100              START TRANSID ('E237')                              14390049
149200                   FROM     (PV-PCKCS153-COMMAREA)                14400049
149300         END-EXEC                                                 14410049
149400     END-IF.                                                      14420049
149500/                                                                 14430026
149600*----------------------------------------------------------------*14440026
149700*    FORMAT THE PRE-TICKET REPORT COMMAREA AND START THE TRAN.   *14450026
149800*----------------------------------------------------------------*14460026
149900 7050-START-TRANID-E012.                                          14470026
150000                                                                  14480026
150100     MOVE ASC-ORD-NBR-N           TO  PV-PT-PO-NBR.               14490026
150200     MOVE ASC-PRINTER-DESTINATION TO  PV-PT-PRINTER.              14500026
150300     MOVE ASC-PRTR-AUTO-CUTTER-IND                                14510032
150400                                  TO PV-PT-PRTR-AUTO-CUTTER-IND.  14520029
150500                                                                  14530029
150600     MOVE ASC-PRTR-PRTR-BRCDE-IND                                 14540035
150700                                  TO PV-PT-PRTR-PRTR-BRCDE-IND.   14550035
150800                                                                  14560029
150900     MOVE ASC-PRTR-PRTR-CNTL-IND  TO PV-PT-PRTR-PRTR-CNTL-IND.    14570032
151000                                                                  14580029
151100     SET PV-PT-NOT-PRINT-PACKAGE  TO TRUE.                        14590048
151200                                                                  14600026
151300* ************************************************************** *14610049
151400* * PURGE-ARCHIVE-RETRIEVAL (PAR) PROJECT:                     * *14620049
151500* * CHECK PACKAGE INDICATOR IN DETERMIMING WHICH TRAN ID TO    * *14630049
151600* * START. (MULTIPLE TRAN IDS AND MNEMONICS ASSOCIATED WITH    * *14640049
151700* * THE PROGRAM TO BE STARTED; THESE DETERMINE WHICH SET OF    * *14650049
151800* * DB2 TABLES WILL BE ACCESSED: REGULAR OR ARCHIVED HISTORY.) * *14660049
151900* ************************************************************** *14670049
152000     IF DP020-SRC-DB2-PKG-ARCHIVE                                 14680050
152100         EXEC CICS                                                14690049
152200              START TRANSID ('EA12')                              14700049
152300                   FROM     (PV-PRE-TICKET-COMMAREA)              14710049
152400         END-EXEC                                                 14720049
152500     ELSE                                                         14730049
152600         EXEC CICS                                                14740049
152700              START TRANSID ('E012')                              14750049
152800                   FROM     (PV-PRE-TICKET-COMMAREA)              14760049
152900         END-EXEC                                                 14770049
153000     END-IF.                                                      14780049
153100/                                                                 14790026
153200*----------------------------------------------------------------*14800026
153300*    UPDATE THE MARKING APRON LOCATION DESCRIPTION IN TRECEIV    *14810026
153400*----------------------------------------------------------------*14820026
153500                                                                  14830026
153600 7100-UPDATE-TRECEIV.                                             14840026
153700                                                                  14850026
153800     MOVE PV-CA-OPERATING-ID       TO DK-OPER-UNT-ID              14860026
153900     MOVE PV-CA-FACILITY-ID        TO DK-FCLTY-ID                 14870026
154000     MOVE PV-CA-ORD-NBR            TO DK-PO-NBR                   14880026
154100     MOVE PV-CA-RCVR-SEQ-NBR       TO DK-REC-SEQ-NBR              14890026
154200                                                                  14900026
154300     EXEC SQL                                                     14910026
154400       UPDATE TRECEIV                                             14920026
154500          SET APRON_LOC_DESC        = :ASC-APRON-LOC-DESC         14930026
154600               ,UPD_TMST            = CURRENT TIMESTAMP           14940026
154700               ,UPD_UID             = :PV-CA-USER-ID              14950026
154800               ,UPD_PGM_ID          = :PC-CURRENT-PROGRAM-NAME    14960026
154900           WHERE OPER_UNT_ID        = :DK-OPER-UNT-ID             14970026
155000             AND FCLTY_ID           = :DK-FCLTY-ID                14980026
155100             AND ORD_NBR            = :DK-PO-NBR                  14990026
155200             AND REC_SEQ_NBR        = :DK-REC-SEQ-NBR             15000026
155300             AND VER_STATUS_CDE     = :PC-A                       15010026
155400     END-EXEC.                                                    15020026
155500                                                                  15030026
155600     EVALUATE TRUE                                                15040026
155700         WHEN SQLCODE = ZERO                                      15050026
155800             CONTINUE                                             15060026
155900         WHEN SQLCODE = -904                                      15070026
156000         WHEN SQLCODE = -911                                      15080026
156100         WHEN SQLCODE = -913                                      15090026
156200              SET PS-UPDATES-DONE   TO TRUE                       15100026
156300              PERFORM 9900-SOFT-ABORT                             15110026
156400                                                                  15120026
156500         WHEN SQLWARN0 NOT = SPACES                               15130026
156600         WHEN SQLCODE < +0                                        15140026
156700         WHEN SQLCODE > +0                                        15150026
156800             MOVE '7100-UPDATE-TRECEIV'                           15160026
156900                               TO DP013-PARAGRAPH                 15170026
157000             MOVE 'UPDATE APRON LOC DESC    '                     15180026
157100                               TO DP013-MESSAGE-TEXT(1)           15190026
157200             MOVE SQLCA            TO DP013-SQLCA                 15200026
157300             MOVE 'TRECEIV'        TO DP013-DB2-TABLE-NAME (1)    15210026
157400             MOVE DK-OPER-UNT-ID                                  15220026
157500                             TO PVT-OPER                          15230026
157600             MOVE DK-FCLTY-ID                                     15240026
157700                             TO PVT-FCLTY                         15250026
157800             MOVE DK-PO-NBR      TO PVT-PO                        15260026
157900             MOVE DK-REC-SEQ-NBR                                  15270026
158000                             TO PVT-SEQ                           15280026
158100             MOVE PV-RECEIV-KEY-MSG                               15290026
158200                             TO DP013-MESSAGE-TEXT (2)            15300026
158300             SET DP013-DB2-ABEND                                  15310026
158400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               15320026
158500             PERFORM DP013-0000-PROCESS-ABEND                     15330026
158600     END-EVALUATE.                                                15340026
158700/                                                                 15350026
158800 7200-SELECT-ACTIVE-TPKSLIP.                                      15360026
158900                                                                  15370026
159000     EXEC SQL                                                     15380026
159100         SELECT SEQ_NBR                                           15390026
159200         INTO :PKSLIP-SEQ-NBR                                     15400026
159300         FROM TPKSLIP                                             15410026
159400         WHERE PO_NBR        = :DK-PO-NBR      AND                15420026
159500               REC_SEQ_NBR   = :DK-REC-SEQ-NBR AND                15430026
159600               VER_STAT_CDE  = :PC-A                              15440026
159700     END-EXEC.                                                    15450026
159800                                                                  15460026
159900     EVALUATE TRUE                                                15470026
160000         WHEN SQLCODE = ZERO                                      15480026
160100         WHEN SQLCODE = +100                                      15490026
160200         WHEN SQLCODE = -811                                      15500026
160300             CONTINUE                                             15510026
160400         WHEN SQLCODE = -904                                      15520026
160500         WHEN SQLCODE = -911                                      15530026
160600         WHEN SQLCODE = -913                                      15540026
160700              PERFORM 9900-SOFT-ABORT                             15550026
160800                                                                  15560026
160900         WHEN SQLWARN0 NOT = SPACES                               15570026
161000         WHEN SQLCODE < +0                                        15580026
161100         WHEN SQLCODE > +0                                        15590026
161200             MOVE '7200-SELECT-ACTIVE-TPKSLIP'                    15600026
161300                               TO DP013-PARAGRAPH                 15610026
161400             MOVE 'CHECK FOR ACTIVE PACKSLIPS'                    15620026
161500                               TO DP013-MESSAGE-TEXT(1)           15630026
161600             MOVE SQLCA            TO DP013-SQLCA                 15640026
161700             MOVE 'TPKSLIP'        TO DP013-DB2-TABLE-NAME (1)    15650026
161800             MOVE DK-OPER-UNT-ID                                  15660026
161900                             TO PVT-OPER                          15670026
162000             MOVE DK-FCLTY-ID                                     15680026
162100                             TO PVT-FCLTY                         15690026
162200             MOVE DK-PO-NBR      TO PVT-PO                        15700026
162300             MOVE DK-REC-SEQ-NBR                                  15710026
162400                             TO PVT-SEQ                           15720026
162500             MOVE PV-RECEIV-KEY-MSG                               15730026
162600                             TO DP013-MESSAGE-TEXT (2)            15740026
162700             SET DP013-DB2-ABEND                                  15750026
162800                 DP013-XCTL-DISPLAY-RESTART TO TRUE               15760026
162900             PERFORM DP013-0000-PROCESS-ABEND                     15770026
163000     END-EVALUATE.                                                15780026
163100                                                                  15790026
163200/                                                                 15800026
163300                                                                  15810026
163400 7210-SELECT-INACT-TPKSLIP.                                       15820026
163500                                                                  15830026
163600     EXEC SQL                                                     15840026
163700         SELECT SEQ_NBR                                           15850026
163800         INTO :PKSLIP-SEQ-NBR                                     15860026
163900         FROM TPKSLIP                                             15870026
164000         WHERE PO_NBR        = :DK-PO-NBR      AND                15880026
164100               REC_SEQ_NBR   = :DK-REC-SEQ-NBR AND                15890026
164200               VER_STAT_CDE  = :PC-A           AND                15900026
164300               PKSL_STAT_CDE = :PC-IN                             15910026
164400     END-EXEC.                                                    15920026
164500                                                                  15930026
164600     EVALUATE TRUE                                                15940026
164700         WHEN SQLCODE = ZERO                                      15950026
164800         WHEN SQLCODE = +100                                      15960026
164900         WHEN SQLCODE = -811                                      15970026
165000             CONTINUE                                             15980026
165100         WHEN SQLCODE = -904                                      15990026
165200         WHEN SQLCODE = -911                                      16000026
165300         WHEN SQLCODE = -913                                      16010026
165400              PERFORM 9900-SOFT-ABORT                             16020026
165500                                                                  16030026
165600         WHEN SQLWARN0 NOT = SPACES                               16040026
165700         WHEN SQLCODE < +0                                        16050026
165800         WHEN SQLCODE > +0                                        16060026
165900             MOVE '7210-SELECT-INACT-TPKSLIP'                     16070026
166000                               TO DP013-PARAGRAPH                 16080026
166100             MOVE 'CHECK FOR INACTIVE PACKSLIPS'                  16090026
166200                               TO DP013-MESSAGE-TEXT(1)           16100026
166300             MOVE SQLCA            TO DP013-SQLCA                 16110026
166400             MOVE 'TPKSLIP'        TO DP013-DB2-TABLE-NAME (1)    16120026
166500             MOVE DK-OPER-UNT-ID                                  16130026
166600                             TO PVT-OPER                          16140026
166700             MOVE DK-FCLTY-ID                                     16150026
166800                             TO PVT-FCLTY                         16160026
166900             MOVE DK-PO-NBR      TO PVT-PO                        16170026
167000             MOVE DK-REC-SEQ-NBR                                  16180026
167100                             TO PVT-SEQ                           16190026
167200             MOVE PV-RECEIV-KEY-MSG                               16200026
167300                             TO DP013-MESSAGE-TEXT (2)            16210026
167400             SET DP013-DB2-ABEND                                  16220026
167500                 DP013-XCTL-DISPLAY-RESTART TO TRUE               16230026
167600             PERFORM DP013-0000-PROCESS-ABEND                     16240026
167700     END-EVALUATE.                                                16250026
167800                                                                  16260026
167900/                                                                 16270026
168000*----------------------------------------------------------------*16280026
168100*    LINK TO AUDIT MODULE * RCKCS290                             *16290026
168200*----------------------------------------------------------------*16300026
168300                                                                  16310026
168400 8000-LINK-AUDIT-MODULE.                                          16320026
168500                                                                  16330026
168600     MOVE 'V'                 TO RC031-TABLE-TO-AUDIT.            16340026
168700     MOVE 'B'                 TO RC031-AUD-TYP-CDE.               16350026
168800     MOVE 'U'                 TO RC031-AUD-FUNC-CDE.              16360026
168900     MOVE PV-CA-OPERATING-ID  TO RC031-OPER-UNT-ID.               16370026
169000     MOVE PV-CA-FACILITY-ID   TO RC031-FCLTY-ID.                  16380026
169100     MOVE PV-CA-ORD-NBR       TO RC031-PO-NBR.                    16390026
169200     MOVE PV-CA-RCVR-SEQ-NBR  TO RC031-REC-SEQ-NBR.               16400026
169300                                                                  16410026
169400     EXEC CICS                                                    16420026
169500          LINK PROGRAM  (PC-AUDIT-RTN)                            16430026
169600          COMMAREA (RC031-FIELDS)                                 16440026
169700          LENGTH   (PC-AUDIT-RTN-LENGTH)                          16450026
169800     END-EXEC.                                                    16460026
169900                                                                  16470026
170000     EVALUATE TRUE                                                16480026
170100         WHEN RC031-CALL-SUCCESSFUL                               16490026
170200             CONTINUE                                             16500026
170300         WHEN OTHER                                               16510026
170400             MOVE '8000-LINK-AUDIT-MODULE'                        16520026
170500                                 TO DP013-PARAGRAPH               16530026
170600             MOVE 'UNSUCCESSFUL CALL TO AUDIT RTN'                16540026
170700                                 TO DP013-MESSAGE-TEXT (1)        16550026
170800             MOVE RC031-RETURN-DESC                               16560026
170900                                 TO DP013-MESSAGE-TEXT (2)        16570026
171000             MOVE RC031-SQLCA    TO DP013-SQLCA                   16580026
171100             SET DP013-DB2-ABEND                                  16590026
171200                 DP013-XCTL-DISPLAY-RESTART                       16600026
171300                                 TO TRUE                          16610026
171400             PERFORM DP013-0000-PROCESS-ABEND                     16620026
171500     END-EVALUATE.                                                16630026
171600/                                                                 16640026
171700*----------------------------------------------------------------*16650026
171800*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *16660026
171900*----------------------------------------------------------------*16670026
172000                                                                  16680026
172100 9000-WRITE-SEL-QUEUE.                                            16690026
172200                                                                  16700026
172300     MOVE ASC-SEL-QUEUE-NAME-IN    TO ASC-SEL-QUEUE-NAME-OUT.     16710026
172400     MOVE DP020-SRC-TASK-NUMBER                                   16720026
172500                                   TO ASC-SEL-TASK-NUMBER-OUT     16730026
172600     MOVE 9                        TO ASC-SEL-SEQ-OUT.            16740026
172700     ADD  +1                       TO PV-SEL-QUEUE-ITEM.          16750026
172800                                                                  16760026
172900     EXEC CICS                                                    16770026
173000          WRITEQ TS                                               16780026
173100              QUEUE (ASC-SEL-QUEUE-NAME-OUT)                      16790026
173200              FROM  (PC016-TS-SEL-REC)                            16800026
173300              ITEM  (PV-SEL-QUEUE-ITEM)                           16810026
173400              RESP  (PV-CICS-RESP)                                16820026
173500     END-EXEC.                                                    16830026
173600                                                                  16840026
173700     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          16850026
173800         CONTINUE                                                 16860026
173900     ELSE                                                         16870026
174000         SET DP013-LOGIC-ABEND                                    16880026
174100             DP013-NO-ROLLBACK     TO TRUE                        16890026
174200         MOVE '9000-WRITE-SEL-QUEUE'                              16900026
174300                                   TO DP013-PARAGRAPH             16910026
174400         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          16920026
174500                                   TO DP013-MESSAGE-TEXT(1)       16930026
174600         PERFORM DP013-0000-PROCESS-ABEND                         16940026
174700     END-IF.                                                      16950026
174800******************************************************************16960026
174900* READ AN ITEM FROM THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *16970026
175000******************************************************************16980026
175100 9100-READ-SEL-QUEUE.                                             16990026
175200     EXEC CICS                                                    17000026
175300         READQ TS                                                 17010026
175400             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        17020026
175500             INTO  (PC016-TS-SEL-REC)                             17030026
175600             ITEM  (ASC-SEL-ITEM)                                 17040026
175700             NUMITEMS(PV-NUM-ITEMS)                               17050026
175800             RESP  (PV-CICS-RESP)                                 17060026
175900     END-EXEC.                                                    17070026
176000                                                                  17080026
176100     EVALUATE TRUE                                                17090026
176200     WHEN PV-CICS-RESP EQUAL DFHRESP(NORMAL)                      17100026
176300         CONTINUE                                                 17110026
176400     WHEN PV-CICS-RESP EQUAL DFHRESP(ITEMERR)                     17120026
176500         SET PS-END-OF-SEL-ITEMS-QUEUE TO TRUE                    17130026
176600     WHEN OTHER                                                   17140026
176700         SET DP013-LOGIC-ABEND                                    17150026
176800             DP013-NO-ROLLBACK     TO TRUE                        17160026
176900         MOVE '9100-READ-SEL-QUEUE'                               17170026
177000                                   TO DP013-PARAGRAPH             17180026
177100         MOVE 'ATTEMPTING TO READ TO LIST SELECTIONS TS QUEUE'    17190026
177200                                   TO DP013-MESSAGE-TEXT (1)      17200026
177300         PERFORM DP013-0000-PROCESS-ABEND                         17210026
177400     END-EVALUATE.                                                17220026
177500                                                                  17230026
177600/                                                                 17240026
177700******************************************************************17250026
177800* UPDATE AN ITEM IN THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *17260026
177900******************************************************************17270026
178000 9200-REWRITE-SEL-QUEUE.                                          17280026
178100     EXEC CICS                                                    17290026
178200          WRITEQ TS                                               17300026
178300              QUEUE   (ASC-SEL-QUEUE-NAME-IN)                     17310026
178400              FROM    (PC016-TS-SEL-REC)                          17320026
178500              ITEM    (ASC-SEL-ITEM)                              17330026
178600              RESP    (PV-CICS-RESP)                              17340026
178700              REWRITE                                             17350026
178800     END-EXEC.                                                    17360026
178900                                                                  17370026
179000     IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                    17380026
179100         SET DP013-CICS-ABEND                                     17390026
179200             DP013-NO-ROLLBACK     TO TRUE                        17400026
179300         MOVE '9200-REWRITE-SEL-QUEUE'                            17410026
179400                                   TO DP013-PARAGRAPH             17420026
179500         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   17430026
179600                                   TO DP013-MESSAGE-TEXT (1)      17440026
179700         PERFORM DP013-0000-PROCESS-ABEND                         17450026
179800     END-IF.                                                      17460026
179900                                                                  17470026
180000/                                                                 17480026
180100******************************************************************17490026
180200** THE DB2 RESOURCE IS NOT AVAILABLE, SET THE ERROR MESSAGE  **   17500026
180300** AND THE ERROR SWITCHES.                                   **   17510026
180400******************************************************************17520026
180500 9900-SOFT-ABORT.                                                 17530026
180600     SET PS-ERROR                                                 17540026
180700         DP020-MSG-FATAL   TO TRUE.                               17550026
180800                                                                  17560026
180900     IF PS-UPDATES-DONE AND SQLCODE = -913                        17570026
181000         PERFORM 9901-ROLLBACK                                    17580026
181100     END-IF.                                                      17590026
181200                                                                  17600026
181300     MOVE PC-TSYMSG-00551  TO DP020-MSG-NUMBER.                   17610026
181400     MOVE 'PROGRAM EXIT CALL' TO DP013-MESSAGE-TEXT(1).           17620026
181500     PERFORM 0001-CALL-CICS-ARCH-API.                             17630026
181600                                                                  17640026
181700 9901-ROLLBACK.                                                   17650026
181800     EXEC CICS                                                    17660026
181900         SYNCPOINT ROLLBACK                                       17670026
182000     END-EXEC.                                                    17680026
182100                                                                  17690026
182200/                                                                 17700026
182300*----------------------------------------------------------------*17710026
182400*    ABEND PROCESSOR MODULE                                      *17720026
182500*----------------------------------------------------------------*17730026
182600                                                                  17740026
182700     COPY DPPD013.                                                17750026
