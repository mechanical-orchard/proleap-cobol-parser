000100*-----------------------*                                         00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000300*-----------------------*                                         00030001
000400 PROGRAM-ID.    SUKCS756.                                         00040001
000500 AUTHOR.        DEANNA BRANTNER.                                  00050001
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060001
000700 DATE-WRITTEN.  MARCH, 2003.                                      00070001
000800 DATE-COMPILED.                                                   00080001
000900*---------------------------------------------------------------* 00090001
001000*    S756 - STORE UNIT ADJ TRANSACTION DETAIL                     00100001
001100*---------------------------------------------------------------* 00110001
263968* CHANGED 11/15/2021    BY JIM HUNTER      WR: CHG0263968         00112099
263968* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00113099
263968* MAKING THE CALL DYNAMIC VS STATIC.                              00114099
001130*                                                                 00114199
001110* CHANGED 01/09/2023    BY JEAN KURK       WR: CHG0278099         00114299
001120* CHANGE CALL OF DPKCS030 TO BE DYNAMIC                           00114399
263968*---------------------------------------------------------------* 00115099
001200 ENVIRONMENT DIVISION.                                            00120001
001300 DATA DIVISION.                                                   00130001
001400                                                                  00140001
001500 WORKING-STORAGE SECTION.                                         00150001
001600 01  DK-DB2-KEYS.                                                 00160001
001700     05  DK-FINCL-ID               PIC  S9(9) COMP.               00170001
001800     05  DK-DEFAULT-ALPHA-BEGIN    PIC  X(01)      VALUE 'A'.     00180001
001900     05  DK-DEFAULT-ALPHA-END      PIC  X(01)      VALUE 'Z'.     00190001
002000     05  DK-DEFAULT-BEGIN          PIC S9(09) COMP VALUE ZERO.    00200001
002100     05  DK-DEFAULT-END-LINE      PIC S9(09) COMP VALUE 999999999.00210001
002200     05  DK-DEFAULT-END-STR        PIC S9(04) COMP VALUE 9999.    00220001
002300     05  DK-DEFAULT-END-UPC PIC S9(15) COMP VALUE 999999999999999.00230001
002400   05 DK-DEFAULT-END-SML PIC S9(18) COMP VALUE 999999999999999999.00240001
002500     05  DK-UNT-ADJ-TYP-BEGIN      PIC  X(01)      VALUE SPACE.   00250001
002600     05  DK-UNT-ADJ-TYP-END        PIC  X(01)      VALUE SPACE.   00260001
002700     05  DK-FAIL-SUCC-BEGIN        PIC  X(01)      VALUE SPACE.   00270001
002800     05  DK-FAIL-SUCC-END          PIC  X(01)      VALUE SPACE.   00280001
002900     05  DK-GROUP-BEGIN            PIC  X(01)      VALUE SPACE.   00290001
003000     05  DK-GROUP-END              PIC  X(01)      VALUE SPACE.   00300001
003100     05  DK-RSLV-BY-BEGIN          PIC  X(08)      VALUE SPACE.   00310001
003200     05  DK-RSLV-BY-END            PIC  X(08)      VALUE SPACE.   00320001
003300     05  DK-OPER-UNT-ID            PIC S9(04) COMP VALUE ZERO.    00330001
003400     05  DK-PO-NBR                 PIC S9(09) COMP VALUE ZERO.    00340001
003500     05  DK-RCVR-SEQ-NBR           PIC S9(09) COMP VALUE ZERO.    00350001
003600     05  DK-LINE-NBR               PIC S9(09) COMP VALUE ZERO.    00360001
003700     05  DK-STR-NBR                PIC S9(04) COMP VALUE ZERO.    00370001
003800     05  DK-UPC-NBR                PIC S9(15)V COMP-3 VALUE ZERO. 00380001
003900     05  DK-SKU-NBR                PIC S9(08) COMP-3.             00390001
004000     05  DK-SHIPT-UNT-ID           PIC S9(18)V COMP-3 VALUE ZERO. 00400001
004100     05  DK-AUDIT-NBR              PIC S9(09) COMP VALUE ZERO.    00410001
004200                                                                  00420001
004300     05  DK-SML.                                                  00430001
004400         10  DK-SML-1-2                PIC 9(02) VALUE ZEROES.    00440001
004500         10  DK-SML-REST               PIC 9(16) VALUE ZEROES.    00450001
004600     05  DK-SML-N                   PIC S9(18)V COMP-3 VALUE ZERO.00460001
004700     05  DK-BRCDE.                                                00470001
004800         10  DK-BRCDE-1-2               PIC 9(02) VALUE ZEROES.   00480001
004900         10  DK-BRCDE-3-18              PIC 9(18) VALUE ZEROES.   00490001
005000         10  DK-BRCDE-REST              PIC X(02) VALUE SPACES.   00500001
005100     05  DK-SML-Z                      PIC ZZZZZZZZZZZZZZZZZZ.    00510001
005200     05  DK-AUDIT                      PIC S9(09) COMP VALUE ZERO.00520001
005300     05  DK-PO-TRN-NBR-X.                                         00530001
005400         10  FILLER-1                   PIC 9(01) VALUE ZEROES.   00540001
005500         10  FILLER-2                   PIC 9(01) VALUE ZEROES.   00550001
005600         10  FILLER-3                   PIC 9(01) VALUE ZEROES.   00560001
005700         10  FILLER-4                   PIC 9(01) VALUE ZEROES.   00570001
005800         10  FILLER-5                   PIC 9(01) VALUE ZEROES.   00580001
005900         10  FILLER-6                   PIC 9(01) VALUE ZEROES.   00590001
006000         10  FILLER-7                   PIC 9(01) VALUE ZEROES.   00600001
006100         10  FILLER-8                   PIC 9(01) VALUE ZEROES.   00610001
006200         10  FILLER-9                   PIC 9(01) VALUE ZEROES.   00620001
006300                                                                  00630001
006400     05  DK-PO-RCVR-NBR-N               PIC 9(09) VALUE ZEROES.   00640001
006500     05  DK-PO-RCVR-NBR-X REDEFINES DK-PO-RCVR-NBR-N.             00650001
006600         10  DK-RCVR-NBR-X                PIC X(09).              00660001
006700     05  DK-RCVR-NBR-9.                                           00670001
006800         10  DK-RCVR-NBR-6                PIC 9(06) VALUE ZEROES. 00680001
006900         10  DK-RCVR-NBR-3                PIC 9(03) VALUE ZEROES. 00690001
007000     05  DK-PO-RCVR.                                              00700001
007100         10  DK-TRN-NBR                   PIC X(09) VALUE SPACES. 00710080
007200         10  FILLER                       PIC X(01) VALUE '-'.    00720001
007300         10  DK-RCVR-NBR                  PIC X(03) VALUE SPACES. 00730001
007400                                                                  00740001
007500     05  DK-DISPLAY-DATE.                                         00750001
007600         10  DK-DIS-MM-FR                 PIC X(02) VALUE SPACES. 00760001
007700         10  FILLER                       PIC X(01) VALUE '/'.    00770001
007800         10  DK-DIS-DD-FR                 PIC X(02) VALUE SPACES. 00780001
007900         10  FILLER                       PIC X(01) VALUE '/'.    00790001
008000         10  DK-DIS-YY-FR                 PIC X(02) VALUE SPACES. 00800001
008100         10  FILLER                       PIC X(01) VALUE ' '.    00810001
008200         10  FILLER                       PIC X(01) VALUE '-'.    00820001
008300         10  FILLER                       PIC X(01) VALUE ' '.    00830001
008400         10  DK-DIS-MM-TO                 PIC X(02) VALUE SPACES. 00840001
008500         10  FILLER                       PIC X(01) VALUE '/'.    00850001
008600         10  DK-DIS-DD-TO                 PIC X(02) VALUE SPACES. 00860001
008700         10  FILLER                       PIC X(01) VALUE '/'.    00870001
008800         10  DK-DIS-YY-TO                 PIC X(02) VALUE SPACES. 00880001
008900                                                                  00890001
009000 01  PC-PROGRAM-CONSTANTS.                                        00900001
009100     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'SU756A  '.  00910001
009200     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'SUKM756'.   00920001
009300     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'SUKCS756'.  00930001
009400     05  PC-LOCATION-MODULE        PIC  X(08)  VALUE  'XLKUT071'. 00940099
009500     05  PC-LIST-QUEUE-SEQ         PIC  9(01)  VALUE 1.           00950001
009600     05  PC-SEL-QUEUE-SEQ          PIC  9(01)  VALUE 2.           00960001
009700     05  PC-CRIT-SPEC-FORMAT       PIC  X(01)  VALUE '1'.         00970001
009800     05  PC-LIST-FORMAT            PIC  X(01)  VALUE '2'.         00980099
009900*    05  PC-LIST-FORMAT            PIC  X(01)  VALUE '4'.         00990099
010000     05  PC-AUDIT-FORMAT           PIC  X(01)  VALUE '3'.         01000001
010100     05  PC-ITEMS-PER-PANEL        PIC S9(04)  VALUE +10          01010001
010200                                               COMP SYNC.         01020001
010300     05  PC-MAX-BLOCKS-IN-ARRAY    PIC S9(04)  VALUE +2           01030001
010400                                               COMP SYNC.         01040001
010500     05  PC-MAX-ITEMS              PIC S9(09)  VALUE +1000000     01050001
010600                                               COMP-3.            01060001
010700     05  PC-MSG-NUMBER-LENGTH      PIC S9(04)  VALUE +5           01070001
010800                                               COMP SYNC.         01080001
010900     05  PC-MAX-RETRIES            PIC S9(03)  VALUE 3            01090001
011000                                               COMP-3.            01100001
011100     05  PC-INQ                    PIC  X(03)  VALUE 'INQ'.       01110001
011200     05  PC-UPD                    PIC  X(03)  VALUE 'UPD'.       01120001
011300     05  PC-DEL                    PIC  X(03)  VALUE 'DEL'.       01130001
011400     05  PC-ERR                    PIC  X(03)  VALUE 'ERR'.       01140001
011500     05  PC-SLASH                  PIC  X(01)  VALUE '/'.         01150001
011600     05  PC-ZERO                   PIC S9(04)  VALUE ZEROES       01160001
011700                                               COMP.              01170001
011800     05  PC-01                     PIC  X(02)  VALUE '01'.        01180001
011900     05  PC-A                      PIC  X(01)  VALUE 'A'.         01190001
012000*                                                                 01200001
012100*----------------------------------------------------------------*01210001
012200*  SYSTEM MESSAGES                                               *01220001
012300*----------------------------------------------------------------*01230001
012400*   00005 = INVALID VALUE                                        *01240001
012500*   00008 = MUST BE NUMERIC                                      *01250001
012600*   00045 - INVALID FUNCTION KEY                                 *01260001
012700*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *01270001
012800*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *01280001
012900*   00052 - END OF RANGE PRECEDES START OF RANGE                 *01290001
013000*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *01300001
013100*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *01310001
013200*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *01320001
013300*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *01330001
013400*   00069 - TOP OF LIST                                          *01340001
013500*   00070 - BOTTOM OF LIST                                       *01350001
013600*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *01360001
013700*   00551 - WAIT 15 SECONDS;RETRY FUNCTION AGAIN; IF UNSUCCESSFUL*01370001
013800*   00279 - MORE ITEMS TO DISPLAY                                *01380001
013900*   00840 - YOU ARE NOT AUTHORIZED TO VIEW THIS INFORMATION      *01390001
014000*   00984 - DATABASE IS BUSY, TRY AGAIN IN A FEW MINUTES         *01400001
014100*   02227 = APPLICATION UNAVAILABLE AT THIS TIME                 *01410001
014200*   99901 = INVALID COMMAND WAS ENTERED                          *01420001
014300*----------------------------------------------------------------*01430001
014400     05  PC-TSYMSG-NUMBERS.                                       01440001
014500         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01450001
014600         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01460001
014700         10  PC-TSYMSG-00045            PIC  9(05)  VALUE 00045.  01470001
014800         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01480001
014900         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01490001
015000         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01500001
015100         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01510001
015200         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01520001
015300         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01530001
015400         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01540001
015500         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01550001
015600         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01560001
015700         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01570001
015800         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01580001
015900         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  01590001
016000         10  PC-TSYMSG-00746            PIC  9(05)  VALUE 00746.  01600001
016100         10  PC-TSYMSG-00840            PIC  9(05)  VALUE 00840.  01610001
016200         10  PC-TSYMSG-01563            PIC  9(05)  VALUE 01563.  01620001
016300         10  PC-TSYMSG-00984            PIC  9(05)  VALUE 00984.  01630001
016400         10  PC-TSYMSG-02227            PIC  9(05)  VALUE 02227.  01640001
016500         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  01650001
016600*                                                                 01660001
016700 01  PS-PROGRAM-SWITCHES.                                         01670001
016800     05  PS-BLOCK-ERROR-SW              PIC  X(01)  VALUE 'Y'.    01680001
016900         88  PS-NO-BLOCK-ERROR                      VALUE 'Y'.    01690001
017000         88  PS-BLOCK-ERROR                         VALUE 'N'.    01700001
017100     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01710001
017200         88  PS-NO-ERROR                            VALUE 'Y'.    01720001
017300         88  PS-ERROR                               VALUE 'N'.    01730001
017400     05  PS-FIRST-LINE-SW               PIC  X(01)  VALUE 'Y'.    01740034
017500         88  PS-FIRST-LINE                          VALUE 'Y'.    01750031
017600         88  PS-NOT-FIRST-LINE                      VALUE 'N'.    01760031
017700     05  PS-SOFT-ABORT-ERROR-SW         PIC  X(01)  VALUE  'N'.   01770001
017800         88  PS-SOFT-ABORT-ERROR                    VALUE  'Y'.   01780001
017900         88  PS-NO-SOFT-ABORT-ERROR                 VALUE  'N'.   01790001
018000     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01800001
018100         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01810001
018200         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01820001
018300     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    01830001
018400         88  PS-DONE                                VALUE 'Y'.    01840001
018500         88  PS-NOT-DONE                            VALUE 'N'.    01850001
018600     05  PS-LIST-END-SW                 PIC  X(01)  VALUE  'N'.   01860001
018700         88  PS-LIST-END                            VALUE  'Y'.   01870001
018800         88  PS-NO-LIST-END                         VALUE  'N'.   01880001
018900     05  PS-FIRST-TIME-AUDIT-SW         PIC  X(01)  VALUE  'Y'.   01890026
019000         88  PS-FIRST-TIME-AUDIT                    VALUE  'Y'.   01900020
019100         88  PS-NOT-FIRST-TIME-AUDIT                VALUE  'N'.   01910020
019200     05  PS-FIRST-TIME-SML-SW           PIC  X(01)  VALUE  'Y'.   01920023
019300         88  PS-FIRST-TIME-SML                      VALUE  'Y'.   01930020
019400         88  PS-NOT-FIRST-TIME-SML                  VALUE  'N'.   01940020
019500*                                                                 01950001
019600 01  PV-PROGRAM-VARIABLES.                                        01960001
019700     05  PV-DISP-SHIPT-UNT-ID           PIC 9(18) VALUE ZEROES.   01970059
019800     05  PV-DISP-OPER-UNT-ID            PIC 9(04) VALUE ZEROES.   01980059
019900     05  PV-DISP-PO-NBR                 PIC 9(09) VALUE ZEROES.   01990059
020000     05  PV-DISP-RCVR                   PIC 9(04) VALUE ZEROES.   02000060
020100     05  PV-DISP-SEL-SUB                PIC 9(04) VALUE ZEROES.   02010066
020200     05  PV-DISP-SEL-ITEM               PIC 9(04) VALUE ZEROES.   02020066
020300***                                                               02030059
020400     05  PV-OPER-UNT-ID                 PIC ZZZZ  VALUE ZEROES.   02040059
020500     05  PV-ONE                         PIC S9(09) COMP.          02050001
020600     05  PV-ORIGINAL-BLOCK              PIC S9(04)  VALUE +0      02060001
020700                                                    COMP SYNC.    02070001
020800     05  PV-ITEMS-HOLD                  PIC S9(03)  COMP-3.       02080001
020900     05  PV-ITEMS-DIFF                  PIC S9(03)  COMP-3.       02090001
021000     05  PV-RACF-ERROR-CODE             PIC  9(04)  VALUE ZEROES. 02100001
021100     05  PV-CICS-RESPONSE               PIC S9(08)  VALUE ZEROES  02110001
021200                                          COMP SYNC.              02120001
021300     05  PV-SUB                         PIC S9(04)  VALUE +0      02130001
021400                                                    COMP SYNC.    02140001
021500     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      02150001
021600                                                    COMP SYNC.    02160001
021700     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      02170001
021800                                                    COMP-3.       02180001
021900     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      02190001
022000                                                    COMP-3.       02200001
022100     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      02210001
022200                                                    COMP-3.       02220001
022300     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      02230001
022400                                                    COMP-3.       02240001
022500     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      02250001
022600                                                    COMP-3.       02260001
022700     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      02270001
022800                                                    COMP-3.       02280001
022900     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      02290001
023000                                                    COMP-3.       02300001
023100     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      02310001
023200                                                    COMP SYNC.    02320001
023300     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      02330001
023400                                                    COMP SYNC.    02340001
023500     05  PV-ITEM                        PIC S9(04)  VALUE +0      02350001
023600                                                    COMP SYNC.    02360001
023700     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      02370001
023800                                                    COMP SYNC.    02380001
023900     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      02390001
024000                                                    COMP SYNC.    02400001
024100     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      02410001
024200                                                    COMP SYNC.    02420001
024300     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      02430001
024400                                                    COMP SYNC.    02440001
024500     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      02450001
024600                                                    COMP SYNC.    02460001
024700     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02470001
024800                                                    COMP SYNC.    02480001
024900     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02490001
025000                                                    COMP SYNC.    02500001
025100     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      02510001
025200                                                    COMP SYNC.    02520001
025300     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      02530001
025400                                                    COMP SYNC.    02540001
025500     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      02550001
025600                                                    COMP SYNC.    02560001
025700     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      02570001
025800                                                    COMP SYNC.    02580001
025900     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      02590001
026000                                                    COMP SYNC.    02600001
026100     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      02610001
026200                                                    COMP SYNC.    02620001
026300     05  PV-NULL-IND-1                  PIC S9(04)  VALUE +0      02630001
026400                                                    COMP.         02640001
026500     05  PV-NULL-IND-2                  PIC S9(04)  VALUE +0      02650001
026600                                                    COMP.         02660001
026700     05  PV-NULL-IND-3                  PIC S9(04)  VALUE +0      02670025
026800                                                    COMP.         02680025
026900     05  PV-SOFT-ABORT-MSG.                                       02690001
027000         10  FILLER            PIC X(12) VALUE ' SUKCS756 - '.    02700001
027100         10  FILLER            PIC X(09) VALUE 'SQLCODE: '.       02710001
027200         10  PV-SOFT-SQLCODE   PIC ZZZZZZZZ9-.                    02720001
027300         10  FILLER            PIC X(12) VALUE ' PARAGRAPH: '.    02730001
027400         10  PV-SOFT-PARAGRAPH PIC X(30).                         02740001
027500     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     02750001
027600                                                     COMP SYNC.   02760001
027700     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACE. 02770001
027800     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 02780001
027900     05  PV-CICS-MSG-HOLD.                                        02790001
028000         10  FILLER                      PIC  X(01)  VALUE SPACE. 02800001
028100         10  PV-CICS-MSG-DATA            PIC  X(79)  VALUE SPACE. 02810001
028200     05  PV-CICS-MSG-HOLD2.                                       02820001
028300         10  FILLER                      PIC  X(01)  VALUE SPACE. 02830001
028400         10  PV-CICS-MSG-DATA2           PIC  X(99)  VALUE SPACE. 02840001
028500                                                                  02850001
028600     05  PV-SELECT-LIST-SEQ              PIC  X(01) VALUE SPACES. 02860001
028700     05  PV-NBR-ITEMS                    PIC  9(05) VALUE ZEROES. 02870001
028800     05  PV-SEL-TERM-ID                  PIC  X(04).              02880001
028900     05  PV-SEL-TASK-NUMBER              PIC  9(05).              02890001
029000     05  PV-SEL-SEQ                      PIC  9(01).              02900001
029100     05  PV-NET-ADJ                      PIC S9(04) COMP.         02910001
029200     05  PV-FROM-TMST                    PIC  X(26) VALUE SPACES. 02920001
029300     05  PV-FROM-TMST-X.                                          02930001
029400         10  PV-FROM-CC                  PIC  X(02) VALUE '01'.   02940001
029500         10  PV-FROM-YY                  PIC  X(02) VALUE '01'.   02950001
029600         10  FILLER                      PIC  X(01) VALUE '-'.    02960001
029700         10  PV-FROM-MM                  PIC  X(02) VALUE '01'.   02970001
029800         10  FILLER                      PIC  X(01) VALUE '-'.    02980001
029900         10  PV-FROM-DD                  PIC  X(02) VALUE '01'.   02990001
030000         10  FILLER                      PIC  X(01) VALUE '-'.    03000001
030100         10  PV-FROM-HR                  PIC  X(02) VALUE ZERO.   03010001
030200         10  FILLER                      PIC  X(01) VALUE '.'.    03020001
030300         10  PV-FROM-MN                  PIC  X(02) VALUE ZERO.   03030001
030400         10  FILLER                      PIC  X(01) VALUE '.'.    03040001
030500         10  PV-FROM-SS                  PIC  X(02) VALUE ZERO.   03050001
030600         10  FILLER                      PIC  X(01) VALUE '.'.    03060001
030700         10  PV-FROM-REST                PIC  X(06) VALUE ZERO.   03070001
030800     05  PV-TO-TMST                      PIC  X(26) VALUE SPACES. 03080001
030900     05  PV-TO-TMST-X.                                            03090001
031000         10  PV-TO-CC                    PIC  X(02) VALUE '99'.   03100001
031100         10  PV-TO-YY                    PIC  X(02) VALUE '98'.   03110001
031200         10  FILLER                      PIC  X(01) VALUE '-'.    03120001
031300         10  PV-TO-MM                    PIC  X(02) VALUE '12'.   03130001
031400         10  FILLER                      PIC  X(01) VALUE '-'.    03140001
031500         10  PV-TO-DD                    PIC  X(02) VALUE '31'.   03150001
031600         10  FILLER                      PIC  X(01) VALUE '-'.    03160001
031700         10  PV-TO-HR                    PIC  X(02) VALUE '23'.   03170001
031800         10  FILLER                      PIC  X(01) VALUE '.'.    03180001
031900         10  PV-TO-MN                    PIC  X(02) VALUE '59'.   03190001
032000         10  FILLER                      PIC  X(01) VALUE '.'.    03200001
032100         10  PV-TO-SS                    PIC  X(02) VALUE '59'.   03210001
032200         10  FILLER                      PIC  X(01) VALUE '.'.    03220001
032300         10  PV-TO-REST                 PIC  X(06) VALUE '999999'.03230001
032400     05  PV-DATE-TIME-TMST.                                       03240001
032500         10  PV-TD-CC                    PIC  X(02).              03250001
032600         10  PV-TD-YY                    PIC  X(02).              03260001
032700         10  FILLER                      PIC  X(01).              03270001
032800         10  PV-TD-MM                    PIC  X(02).              03280001
032900         10  FILLER                      PIC  X(01).              03290001
033000         10  PV-TD-DD                    PIC  X(02).              03300001
033100         10  FILLER                      PIC  X(01).              03310001
033200         10  PV-TD-HR                    PIC  X(02).              03320001
033300         10  FILLER                      PIC  X(01).              03330001
033400         10  PV-TD-MN                    PIC  X(02).              03340001
033500         10  FILLER                      PIC  X(01).              03350001
033600         10  PV-TD-SS                    PIC  X(02).              03360001
033700         10  FILLER                      PIC  X(01).              03370001
033800         10  PV-TD-REST                  PIC  X(06).              03380001
033900     05  PV-DATE.                                                 03390001
034000         10  PV-DT-MM                    PIC  X(02).              03400001
034100         10  FILLER                      PIC  X(01) VALUE '/'.    03410001
034200         10  PV-DT-DD                    PIC  X(02).              03420001
034300     05  PV-TIME.                                                 03430001
034400         10  PV-TI-HR                    PIC  X(02).              03440001
034500         10  FILLER                      PIC  X(01) VALUE ':'.    03450001
034600         10  PV-TI-MN                    PIC  X(02).              03460001
034700     05  PV-PO                     PIC S9(09) COMP VALUE ZERO.    03470001
034800     05  PV-REC-SEQ                PIC S9(09) COMP VALUE ZERO.    03480033
034900     05  PV-LNE-NBR                PIC S9(09) COMP VALUE ZERO.    03490033
035000     05  PV-SKU-UPC.                                              03500001
035100         10  PV-SKU                PIC  Z(08) VALUE ZERO.         03510001
035200         10  FILLER                PIC  X(01) VALUE '/'.          03520001
035300         10  PV-UPC                PIC  Z(15) VALUE ZERO.         03530001
035400     05  PV-AUDIT-STATUS.                                         03540001
035500         10  PV-AUDIT                  PIC  X(09)  VALUE ZERO.    03550030
035600         10  FILLER                    PIC  X(01)  VALUE '/'.     03560001
035700         10  PV-AUD-STAT               PIC  X(09)  VALUE SPACES.  03570001
035800     05  PV-PO-NBR.                                               03580006
035900         10  PV-TRN-1                     PIC X(01) VALUE SPACES. 03590053
036000         10  PV-TRN-2                     PIC X(01) VALUE SPACES. 03600053
036100         10  PV-TRN-3                     PIC X(01) VALUE SPACES. 03610053
036200         10  PV-TRN-4                     PIC X(01) VALUE SPACES. 03620053
036300         10  PV-TRN-5                     PIC X(01) VALUE SPACES. 03630053
036400         10  PV-TRN-6                     PIC X(01) VALUE SPACES. 03640053
036500         10  PV-TRN-7                     PIC X(01) VALUE SPACES. 03650053
036600         10  PV-TRN-8                     PIC X(01) VALUE SPACES. 03660053
036700         10  PV-TRN-9                     PIC X(01) VALUE SPACES. 03670053
036800                                                                  03680006
036900                                                                  03690001
037000******************************************************************03700001
037100**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **03710001
037200**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **03720001
037300**  APPLICATION-SPECIFIC COMMAREA.                              **03730001
037400******************************************************************03740001
037500 01  LQW-LIST-QUEUE-WORK-AREA.                                    03750001
037600     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  03760001
037700     05  LQW-ITEM-ENTRIES               OCCURS 10 TIMES           03770001
037800                                        INDEXED BY LQW-IDX.       03780001
037900         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       03790001
038000         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               03800001
038100         10  LQW-SELECTED-SW            PIC  X(01).               03810001
038200             88  LQW-SELECT                         VALUE 'S'.    03820001
038300             88  LQW-DESELECT                       VALUE ' '.    03830001
038400         10  LQW-ACTION                 PIC  X(03).               03840001
038500             88  LQW-DEL                            VALUE 'DEL'.  03850001
038600             88  LQW-INQ                            VALUE 'INQ'.  03860001
038700             88  LQW-UPD                            VALUE 'UPD'.  03870001
038800             88  LQW-ERR                            VALUE 'ERR'.  03880001
038900         10  LQW-STR-NBR                PIC  9(04).               03890001
039000         10  LQW-UPC-NBR                PIC  9(15).               03900001
039100         10  LQW-DATE                   PIC  X(05).               03910001
039200         10  LQW-TIME                   PIC  X(05).               03920001
039300         10  LQW-ADJ-SOURCE             PIC  X(08).               03930001
039400         10  LQW-BEF-QTY                PIC  ZZZZ9.               03940001
039500         10  LQW-AFT-QTY                PIC  ZZZZ9.               03950001
039600         10  LQW-FAIL-SUCCSS            PIC  X(01).               03960001
039700         10  LQW-ERR-CDE                PIC  X(08).               03970001
039800         10  LQW-ACKNOWLEDGE            PIC  X(01).               03980001
039900         10  LQW-ADJ-TYP                PIC  X(05).               03990001
040000         10  LQW-FINCL-ID               PIC S9(09).               04000001
040100         10  LQW-PRCS-GROUP             PIC  X(01).               04010001
040200         10  LQW-PO-LNE                 PIC S9(09) COMP.          04020048
040300         10  LQW-LNE-LNE                PIC S9(09) COMP.          04030048
040400         10  LQW-REC-LNE                PIC S9(09) COMP.          04040048
040500         10  LQW-SML-NBR                PIC S9(18) COMP.          04050057
040600                                                                  04060001
040700*---------------------------------------------------------------* 04070001
040800* SELECTON QUEUE LAYOUT                                         * 04080001
040900*---------------------------------------------------------------* 04090001
041000     COPY SUWS039.                                                04100001
041100                                                                  04110058
041200*---------------------------------------------------------------* 04120049
041300* SELECTON QUEUE LAYOUT FOR PACKED CARTON DATA                  * 04130049
041400*---------------------------------------------------------------* 04140049
041500     COPY SUWS010.                                                04150049
041600                                                                  04160001
041700*---------------------------------------------------------------* 04170001
041800* SELECTON QUEUE LAYOUT                                         * 04180001
041900*---------------------------------------------------------------* 04190001
042000     COPY RCWS013.                                                04200001
042100                                                                  04210001
042200*---------------------------------------------------------------* 04220099
042300* COPYBOOK FOR THE LOCATION MODULE - XLKUT071                     04230099
042400*---------------------------------------------------------------* 04240099
042500     COPY XLWS071.                                                04250099
042600                                                                  04260099
042700*---------------------------------------------------------------* 04270001
042800*    MAP LAYOUT                                                 * 04280001
042900*---------------------------------------------------------------* 04290001
043000     COPY SUKM756.                                                04300001
043100*                                                                 04310001
043200 01  MR-OCCURS-LAYOUT                   REDEFINES  SU756AO.       04320001
043300     05  FILLER                         PIC X(319).               04330026
043400     05  MR-SCROLL-AREA                 OCCURS 10 TIMES.          04340001
043500         10  MR-SELECTL                 PIC S9(04) COMP.          04350001
043600         10  MR-SELECTA                 PIC  X(01).               04360001
043700         10  MR-SELECTC                 PIC  X(01).               04370001
043800         10  MR-SELECTH                 PIC  X(01).               04380001
043900         10  MR-SELECTI                 PIC  X(01).               04390001
044000                                                                  04400001
044100         10  MR-ACTIONL                 PIC S9(04) COMP.          04410001
044200         10  MR-ACTIONA                 PIC  X(01).               04420001
044300         10  MR-ACTIONC                 PIC  X(01).               04430001
044400         10  MR-ACTIONH                 PIC  X(01).               04440001
044500         10  MR-ACTION                  PIC  X(03).               04450001
044600                                                                  04460001
044700         10  MR-STR-NBRL                PIC S9(04) COMP.          04470001
044800         10  MR-STR-NBRA                PIC  X(01).               04480001
044900         10  MR-STR-NBRC                PIC  X(01).               04490001
045000         10  MR-STR-NBRH                PIC  X(01).               04500001
045100         10  MR-STR-NBR                 PIC  Z(04).               04510001
045200                                                                  04520001
045300         10  MR-UPC-SKUL                PIC S9(04) COMP.          04530001
045400         10  MR-UPC-SKUA                PIC  X(01).               04540001
045500         10  MR-UPC-SKUC                PIC  X(01).               04550001
045600         10  MR-UPC-SKUH                PIC  X(01).               04560001
045700         10  MR-UPC-SKU                 PIC  Z(15).               04570001
045800                                                                  04580001
045900         10  MR-DATEL                   PIC S9(04) COMP.          04590001
046000         10  MR-DATEA                   PIC  X(01).               04600001
046100         10  MR-DATEC                   PIC  X(01).               04610001
046200         10  MR-DATEH                   PIC  X(01).               04620001
046300         10  MR-DATE                    PIC  X(05).               04630001
046400                                                                  04640001
046500         10  MR-TIMEL                   PIC S9(04) COMP.          04650001
046600         10  MR-TIMEA                   PIC  X(01).               04660001
046700         10  MR-TIMEC                   PIC  X(01).               04670001
046800         10  MR-TIMEH                   PIC  X(01).               04680001
046900         10  MR-TIME                    PIC  X(05).               04690001
047000                                                                  04700001
047100         10  MR-ADJ-SOURCEL             PIC S9(04) COMP.          04710001
047200         10  MR-ADJ-SOURCEA             PIC  X(01).               04720001
047300         10  MR-ADJ-SOURCEC             PIC  X(01).               04730001
047400         10  MR-ADJ-SOURCEH             PIC  X(01).               04740001
047500         10  MR-ADJ-SOURCE              PIC  X(08).               04750001
047600                                                                  04760001
047700         10  MR-BEF-QTYL                PIC S9(04) COMP.          04770001
047800         10  MR-BEF-QTYA                PIC  X(01).               04780001
047900         10  MR-BEF-QTYC                PIC  X(01).               04790001
048000         10  MR-BEF-QTYH                PIC  X(01).               04800001
048100         10  MR-BEF-QTY                 PIC  X(05).               04810001
048200                                                                  04820001
048300         10  MR-AFT-QTYL                PIC S9(04) COMP.          04830001
048400         10  MR-AFT-QTYA                PIC  X(01).               04840001
048500         10  MR-AFT-QTYC                PIC  X(01).               04850001
048600         10  MR-AFT-QTYH                PIC  X(01).               04860001
048700         10  MR-AFT-QTY                 PIC  X(05).               04870001
048800                                                                  04880001
048900         10  MR-FAIL-SUCCSSL            PIC S9(04) COMP.          04890001
049000         10  MR-FAIL-SUCCSSA            PIC  X(01).               04900001
049100         10  MR-FAIL-SUCCSSC            PIC  X(01).               04910001
049200         10  MR-FAIL-SUCCSSH            PIC  X(01).               04920001
049300         10  MR-FAIL-SUCCSS             PIC  X(01).               04930001
049400                                                                  04940001
049500         10  MR-ERR-CDEL                PIC S9(04) COMP.          04950001
049600         10  MR-ERR-CDEA                PIC  X(01).               04960001
049700         10  MR-ERR-CDEC                PIC  X(01).               04970001
049800         10  MR-ERR-CDEH                PIC  X(01).               04980001
049900         10  MR-ERR-CDE                 PIC  X(08).               04990001
050000                                                                  05000001
050100         10  MR-ACKNOWLEDGEL            PIC S9(04) COMP.          05010001
050200         10  MR-ACKNOWLEDGEA            PIC  X(01).               05020001
050300         10  MR-ACKNOWLEDGEC            PIC  X(01).               05030001
050400         10  MR-ACKNOWLEDGEH            PIC  X(01).               05040001
050500         10  MR-ACKNOWLEDGE             PIC  X(01).               05050001
050600                                                                  05060001
050700         10  MR-ADJ-TYPL                PIC S9(04) COMP.          05070001
050800         10  MR-ADJ-TYPA                PIC  X(01).               05080001
050900         10  MR-ADJ-TYPC                PIC  X(01).               05090001
051000         10  MR-ADJ-TYPH                PIC  X(01).               05100001
051100         10  MR-ADJ-TYP                 PIC  X(05).               05110001
051200                                                                  05120001
051300*-----------------------------------------------------------------05130001
051400*  COPYBOOK FOR LOGISTIC MODULE XLKUT001                          05140001
051500*-----------------------------------------------------------------05150001
051600     COPY XLWS001.                                                05160001
051700                                                                  05170001
051800*---------------------------------------------------------------* 05180001
051900*    ATTRIBUTE SETTINGS COPYBOOK.                               * 05190001
052000*---------------------------------------------------------------* 05200001
052100     COPY DPWS015.                                                05210001
052200                                                                  05220001
052300*---------------------------------------------------------------* 05230001
052400*    FUNCTION KEYS COPYBOOK.                                    * 05240001
052500*---------------------------------------------------------------* 05250001
052600     COPY DPWS016.                                                05260001
052700                                                                  05270001
052800*---------------------------------------------------------------* 05280001
052900*    NUMERIC EDIT LAYOUT.                                       * 05290001
053000*---------------------------------------------------------------* 05300001
053100     COPY DPWS010I.                                               05310001
053200                                                                  05320001
053300*----------------------------------------------------------------*05330001
053400**  SECURITY SUBROUTINE PARAMETERS                                05340001
053500*----------------------------------------------------------------*05350001
053600     COPY DPWS008.                                                05360001
053700                                                                  05370001
053800*---------------------------------------------------------------* 05380001
053900*    PARAMETERS FOR CALLING CICS ARCHITECTURE API               * 05390099
054000*---------------------------------------------------------------* 05400001
054100     COPY DPWS030.                                                05410099
054100     COPY DPWS930.                                                05411099
054200                                                                  05420001
054300*---------------------------------------------------------------* 05430001
054400*    STANDARD COMMAREA.                                         * 05440001
054500*---------------------------------------------------------------* 05450001
054600     COPY DPWS020.                                                05460001
054700     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                05470001
054800                                                                  05480001
054900*---------------------------------------------------------------* 05490001
055000* INTER-APPLICATION COMMAREA.                                   * 05500001
055100*   SUWS037 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 05510001
055200*             SPEC SCREEN.                                      * 05520001
055300*   SUWS038 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 05530001
055400*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 05540001
055500*---------------------------------------------------------------* 05550001
055600                                                                  05560001
055700         10  INTER-APPL-COMM-AREA       PIC X(200).               05570001
055800*-----------------------------------------------------------------05580001
055900*  VARIOUS COPYBOOKS                                              05590038
056000*-----------------------------------------------------------------05600001
056100     COPY RCWS015.                                                05610093
056200     COPY SUWS037.                                                05620001
056300     COPY SUWS038.                                                05630001
056400     COPY PCWS000.                                                05640001
056500     COPY SUWS009.                                                05650038
056600*---------------------------------------------------------------* 05660001
056700*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 05670001
056800*---------------------------------------------------------------* 05680001
056900         10  ASC-SPECIFIC-COMMAREA.                               05690001
057000             15  ASC-CURSOR-SW                       PIC  X(01).  05700001
057100                 88  ASC-OP-PO-RC-LN-ST-CSR          VALUE 'A'.   05710001
057200                 88  ASC-OP-PO-REC-LNE-CSR           VALUE 'B'.   05720001
057300                 88  ASC-OPER-PO-REC-CSR             VALUE 'C'.   05730001
057400                 88  ASC-OPER-PO-CSR                 VALUE 'D'.   05740001
057500                 88  ASC-OPER-CSR                    VALUE 'E'.   05750001
057600                 88  ASC-PO-REC-LNE-DST-CSR          VALUE 'F'.   05760001
057700                 88  ASC-PO-REC-LNE-CSR              VALUE 'G'.   05770001
057800                 88  ASC-PO-REC-CSR                  VALUE 'H'.   05780001
057900                 88  ASC-PO-CSR                      VALUE 'I'.   05790001
058000                 88  ASC-OPER-UPC-CSR                VALUE 'J'.   05800001
058100                 88  ASC-UPC-CSR                     VALUE 'K'.   05810001
058200                 88  ASC-AUDIT-CSR                   VALUE 'L'.   05820001
058300                 88  ASC-SHIPT-UNT-CSR               VALUE 'M'.   05830001
058400                 88  ASC-OPER-SKU-CSR                VALUE 'N'.   05840001
058500                 88  ASC-SKU-CSR                     VALUE 'O'.   05850001
058600                 88  ASC-OP-PO-RC-LN-AU-CSR          VALUE 'P'.   05860013
058700                 88  ASC-OP-PO-RC-LN-SML-CSR         VALUE 'Q'.   05870090
058800             15  ASC-LOCAL-GO-DESTINATION            PIC X(01).   05880001
058900                 88  ASC-GOING-TO-TROUBLE            VALUE '1'.   05890001
059000                 88  ASC-GOING-TO-PCKCRTN            VALUE '2'.   05900050
059100             15  ASC-FORMAT-IND                      PIC X(01).   05910099
059200                 88  ASC-LIST-FORMAT                 VALUE '2'.   05920099
059300*                88  ASC-LIST-FORMAT                 VALUE '4'.   05930099
059400                 88  ASC-AUDIT-FORMAT                VALUE '3'.   05940099
059500             15  ASC-CURR-OPER-UNT-ID        PIC  X(04).          05950001
059600             15  ASC-CURR-OPER-UNT-ID-N REDEFINES                 05960001
059700                     ASC-CURR-OPER-UNT-ID    PIC  9(04).          05970001
059800             15  ASC-UNT-ADJ-TYP             PIC  X(01).          05980001
059900                 88  ASC-UNT-ADJ-ALL               VALUE 'A'.     05990001
060000                 88  ASC-UNT-ADJ-CNFRM             VALUE 'C'.     06000001
060100                 88  ASC-UNT-ADJ-POSTV             VALUE 'P'.     06010001
060200                 88  ASC-UNT-ADJ-VERFY             VALUE 'V'.     06020001
060300                 88  ASC-UNT-ADJ-P2L               VALUE 'Q'.     06030001
060400             15  ASC-FAIL-SUCCESS-IND        PIC X(01).           06040001
060500                 88  ASC-FAIL-SUCC-ALL             VALUE 'A'.     06050001
060600                 88  ASC-FAIL                      VALUE 'F'.     06060001
060700                 88  ASC-SUCCESS                   VALUE 'S'.     06070001
060800                 88  ASC-UNACKNOWLEDGED            VALUE 'U'.     06080001
060900             15  ASC-ACCESS-UPC-SKU          PIC X(01).           06090001
061000                 88  ASC-ACCESS-UPC                VALUE 'U'.     06100001
061100                 88  ASC-ACCESS-SKU                VALUE 'S'.     06110001
061200             15  ASC-FROM-DATE.                                   06120001
061300                 20  ASC-FROM-MM             PIC  X(02).          06130001
061400                 20  ASC-FROM-DD             PIC  X(02).          06140001
061500                 20  ASC-FROM-CC             PIC  X(02).          06150001
061600                 20  ASC-FROM-YY             PIC  X(02).          06160001
061700             15  ASC-TO-DATE.                                     06170001
061800                 20  ASC-TO-MM               PIC  X(02).          06180001
061900                 20  ASC-TO-DD               PIC  X(02).          06190001
062000                 20  ASC-TO-CC               PIC  X(02).          06200001
062100                 20  ASC-TO-YY               PIC  X(02).          06210001
062200             15  ASC-OPER-UNT-ID-X           PIC  X(04).          06220001
062300             15  ASC-OPER-UNT-ID-N REDEFINES ASC-OPER-UNT-ID-X.   06230001
062400                 20  ASC-OPER-UNT-ID         PIC  9(04).          06240001
062500             15  ASC-OPER-NAME               PIC  X(25).          06250001
062600             15  ASC-PO-RCVR.                                     06260001
062700                 20  ASC-PO-NBR              PIC  X(09).          06270001
062800                 20  FILLER                  PIC  X(01).          06280001
062900                 20  ASC-RCVR-NBR            PIC  X(03).          06290001
063000             15  ASC-PO-RCVR-2.                                   06300001
063100                 20  ASC-PO-NBR-2            PIC  Z(09).          06310001
063200                 20  ASC-PO-RCVR-DASH-2      PIC  X(01).          06320001
063300                 20  ASC-RCVR-NBR-2          PIC  X(03).          06330001
063400             15  ASC-CURSOR-PO-NBR           PIC  9(09).          06340031
063500             15  ASC-CURSOR-RCVR-NBR         PIC  9(03).          06350031
063600             15  ASC-CURSOR-LINE-NBR         PIC  9(04).          06360031
063700             15  ASC-CURSOR-UPC              PIC  9(15).          06370031
063800             15  ASC-PO-X                    PIC  X(09).          06380001
063900             15  ASC-PO-N REDEFINES ASC-PO-X.                     06390001
064000                 20  ASC-PO                  PIC  9(09).          06400001
064100             15  ASC-RCVR                    PIC  9(03).          06410001
064200             15  ASC-LINE-X                  PIC X(04).           06420001
064300             15  ASC-LINE-N REDEFINES ASC-LINE-X.                 06430001
064400                 20  ASC-LINE                PIC  9(04).          06440001
064500             15  ASC-STR-NBR-X               PIC  X(04).          06450001
064600             15  ASC-STR-NBR-N REDEFINES ASC-STR-NBR-X.           06460001
064700                 20  ASC-STR-NBR             PIC  9(04).          06470001
064800             15  ASC-STR-NAME                PIC  X(20).          06480001
064900             15  ASC-SKU-X                   PIC  X(08).          06490001
065000             15  ASC-SKU-N REDEFINES ASC-SKU-X.                   06500001
065100                 20  ASC-SKU                 PIC  9(08).          06510001
065200             15  ASC-UPC-X                   PIC  X(15).          06520001
065300             15  ASC-UPC-N REDEFINES ASC-UPC-X.                   06530001
065400                 20  ASC-UPC                 PIC  9(15).          06540001
065500             15  ASC-SML-X                   PIC  X(18).          06550001
065600             15  ASC-SML-N REDEFINES ASC-SML-X.                   06560001
065700                 20  ASC-SML                 PIC  9(18).          06570001
065800             15  ASC-SML-IN                  PIC  9(18).          06580037
065900             15  ASC-AUDIT-X                 PIC  X(09).          06590001
066000             15  ASC-AUDIT-N REDEFINES ASC-AUDIT-X.               06600001
066100                 20  ASC-AUDIT               PIC  9(09).          06610001
066200             15  ASC-AUDIT-IN                PIC  9(09).          06620037
066300             15  ASC-AUD-STAT                PIC  X(09).          06630001
066400             15  ASC-NET-ADJ                 PIC S9(06).          06640001
066500             15  ASC-ADJ-SOURCE              PIC  X(08).          06650001
066600             15  ASC-ACKNOWLEDGED            PIC  X(01).          06660001
066700             15  ASC-FAIL-SUCC-SW            PIC  X(01).          06670001
066800                 88  ASC-FAIL-SW      VALUE 'F'.                  06680001
066900                 88  ASC-SUCC-SW      VALUE 'S'.                  06690001
067000                 88  ASC-ALL-SW       VALUE 'A'.                  06700001
067100             15  ASC-PROCESS-GROUP           PIC X(01).           06710001
067200                 88  ASC-GROUP-ALL                 VALUE 'A'.     06720001
067300                 88  ASC-GROUP-CRTN                VALUE 'C'.     06730001
067400                 88  ASC-GROUP-P2L                 VALUE 'P'.     06740001
067500             15  ASC-PROCESS-GRP-DESC        PIC X(25).           06750001
067600             15  ASC-MULTIPLE-PO-REC-LNE-SW  PIC X(01).           06760031
067700                 88  ASC-MULTIPLE-PO-REC-LNE        VALUE 'Y'.    06770031
067800                 88  ASC-NOT-MULTIPLE-PO-REC-LNE    VALUE 'N'.    06780031
067900             15  ASC-MULTIPLE-UPC-SW         PIC X(01).           06790031
068000                 88  ASC-MULTIPLE-UPC               VALUE 'Y'.    06800031
068100                 88  ASC-NOT-MULTIPLE-UPC           VALUE 'N'.    06810031
068200                                                                  06820001
068300*-----------------------------------------------------------------06830001
068400             15  ASC-BLK-SUB                  PIC S9(04) COMP     06840001
068500                                                         SYNC.    06850001
068600             15  ASC-ITEM-SUB                 PIC S9(04) COMP     06860001
068700                                                         SYNC.    06870001
068800             15  ASC-NUMBER-OF-ITEMS-READ     PIC S9(09) COMP-3.  06880001
068900             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09) COMP-3.  06890001
069000             15  ASC-ITEMS-DISPLAYED          PIC S9(03) COMP-3.  06900001
069100             15  ASC-ITEM-AT-TOP-OF-PANEL     PIC S9(09) COMP-3.  06910001
069200             15  ASC-ITEM-AT-BOT-OF-PANEL     PIC S9(09) COMP-3.  06920001
069300             15  ASC-HIGHEST-BLOCK-WRITTEN    PIC S9(04) COMP     06930001
069400                                                         SYNC.    06940001
069500             15  ASC-START-OF-SELECTED-RANGE  PIC S9(09) COMP-3.  06950001
069600             15  ASC-END-OF-SELECTED-RANGE    PIC S9(09) COMP-3.  06960001
069700             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         06970001
069800                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     06980001
069900                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     06990001
070000             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         07000001
070100                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     07010001
070200                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     07020001
070300             15  ASC-LIST-QUEUE-NAME.                             07030001
070400                 20  ASC-LIST-TERM-ID         PIC  X(04).         07040001
070500                 20  ASC-LIST-TASK-NUMBER     PIC S9(05) COMP-3.  07050001
070600                 20  ASC-LIST-SEQ             PIC  9(01).         07060001
070700                                                                  07070001
070800             15  ASC-START-ITEM-REQUEST.                          07080001
070900                 20  ASC-START-ITEM-REQUEST-N PIC  9(05).         07090001
071000                                                                  07100001
071100             15  ASC-SEL-SUB                  PIC S9(4) COMP.     07110001
071200             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     07120001
071300             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          07130001
071400                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 07140001
071500             15  ASC-SEL-QUEUE-IN.                                07150001
071600                 20  ASC-SEL-TERM-ID-IN       PIC  X(04).         07160001
071700                 20  ASC-SEL-TASK-NUMBER-IN   PIC S9(05) COMP-3.  07170001
071800                 20  ASC-SEL-SEQ-IN           PIC  9(01).         07180001
071900             15  ASC-SEL-QUEUE-IN-2.                              07190071
072000                 20  ASC-SEL-TERM-ID-IN-2     PIC  X(04).         07200071
072100                 20  ASC-SEL-TASK-NUMBER-IN-2 PIC S9(05) COMP-3.  07210071
072200                 20  ASC-SEL-SEQ-IN-2         PIC  9(01).         07220071
072300             15  ASC-SEL-QUEUE-IN-3.                              07230071
072400                 20  ASC-SEL-TERM-ID-IN-3     PIC  X(04).         07240071
072500                 20  ASC-SEL-TASK-NUMBER-IN-3 PIC S9(05) COMP-3.  07250071
072600                 20  ASC-SEL-SEQ-IN-3         PIC  9(01).         07260071
072700             15  ASC-SEL-QUEUE-OUT.                               07270001
072800                 20  ASC-SEL-TERM-ID-OUT      PIC  X(04).         07280001
072900                 20  ASC-SEL-TASK-NUMBER-OUT  PIC S9(05) COMP-3.  07290001
073000                 20  ASC-SEL-SEQ-OUT          PIC  9(01).         07300001
073100             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  07310001
073200                                                                  07320001
073300*-----------------------------------------------------------------07330001
073400             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                07340001
073500                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  07350001
073600                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   07360001
073700                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   07370001
073800                                                                  07380001
073900                 20  ASC-ITEM-ARRAY.                              07390001
074000                     25  ASC-ITEM-ENTRIES OCCURS 10 TIMES.        07400001
074100                         30  ASC-LIST-ITEM-NUMBER                 07410001
074200                                                     PIC S9(09)   07420001
074300                                                     COMP-3.      07430001
074400                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  07440001
074500                             88  ASC-VALID-SELECT    VALUE ' '    07450001
074600                                                           'S'    07460001
074700                                                           'B'    07470001
074800                                                           'E'.   07480001
074900                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   07490001
075000                             88  ASC-TEMP-SELECT     VALUE 'S'.   07500001
075100                             88  ASC-TEMP-BEGIN      VALUE 'B'.   07510001
075200                             88  ASC-TEMP-END        VALUE 'E'.   07520001
075300                         30  ASC-SELECTED-SW         PIC  X(01).  07530001
075400                             88  ASC-NO-SELECT       VALUE ' '.   07540001
075500                             88  ASC-SELECT          VALUE 'S'.   07550001
075600                             88  ASC-BEGIN           VALUE 'B'.   07560001
075700                             88  ASC-END             VALUE 'E'.   07570001
075800                         30  ASC-ACTION             PIC  X(03).   07580001
075900                         30  ASC-STORE              PIC  Z(04).   07590001
076000                         30  ASC-UPC-SKU-NBR        PIC  9(15).   07600001
076100                         30  ASC-DATE               PIC  X(05).   07610001
076200                         30  ASC-TIME               PIC  X(05).   07620001
076300                         30  ASC-ADJ-SRCE           PIC  X(08).   07630001
076400                         30  ASC-BEF-QTY            PIC  ZZZZ9.   07640001
076500                         30  ASC-AFT-QTY            PIC  ZZZZ9.   07650001
076600                         30  ASC-FAIL-SUCCSS        PIC  X(01).   07660001
076700                         30  ASC-ERR-CDE            PIC  X(08).   07670001
076800                         30  ASC-ACKNOWLEDGE        PIC  X(01).   07680001
076900                         30  ASC-ADJ-TYP            PIC  X(05).   07690001
077000                         30  ASC-FINCL-ID           PIC S9(09).   07700001
077100                         30  ASC-PRCS-GROUP         PIC  X(01).   07710001
077200                         30  ASC-PO-LNE           PIC S9(09) COMP.07720048
077300                         30  ASC-LNE-LNE          PIC S9(09) COMP.07730048
077400                         30  ASC-REC-LNE          PIC S9(09) COMP.07740048
077500                         30  ASC-SML-NBR          PIC S9(18) COMP.07750048
077600                                                                  07760001
077700*---------------------------------------------------------------* 07770001
077800*    ABEND PROCESSING COPYBOOK.                                 * 07780001
077900*---------------------------------------------------------------* 07790001
078000     COPY DPWS013.                                                07800001
078100                                                                  07810001
078200*---------------------------------------------------------------* 07820001
078300*    DB2 AREA FOR SYSDUMMY TABLE                                  07830001
078400*---------------------------------------------------------------* 07840001
078500     EXEC SQL                                                     07850001
078600          INCLUDE SYSDUMMY                                        07860001
078700     END-EXEC.                                                    07870001
078800                                                                  07880001
078900*---------------------------------------------------------------* 07890003
079000*    THE XLT_SKU TABLE                                            07900003
079100*---------------------------------------------------------------* 07910003
079200     EXEC SQL                                                     07920003
079300          INCLUDE XLT00003                                        07930003
079400     END-EXEC.                                                    07940003
079500                                                                  07950003
079600*---------------------------------------------------------------* 07960003
079700*    THE XLT_UPC TABLE                                            07970003
079800*---------------------------------------------------------------* 07980003
079900     EXEC SQL                                                     07990003
080000          INCLUDE XLT00006                                        08000003
080100     END-EXEC.                                                    08010003
080200                                                                  08020003
080300*---------------------------------------------------------------* 08030001
080400*    FINANCIAL ADJUSTMENT TABLE - SUT_FINCL_ADJ                   08040001
080500*---------------------------------------------------------------* 08050001
080600     EXEC SQL                                                     08060001
080700          INCLUDE SUT00030                                        08070001
080800     END-EXEC.                                                    08080001
080900                                                                  08090001
081000*---------------------------------------------------------------* 08100001
081100*    FINANCIAL ADJUSTMENT TABLE FOR ERRORS - SUT_ADJ_ERR_CDE      08110001
081200*---------------------------------------------------------------* 08120001
081300     EXEC SQL                                                     08130001
081400          INCLUDE SUT00031                                        08140001
081500     END-EXEC.                                                    08150001
081600                                                                  08160001
081700*---------------------------------------------------------------* 08170001
081800*     SUT_PO_AUD_REQ - SYSTEM REQUESTED AUDITS                    08180001
081900*---------------------------------------------------------------* 08190001
082000     EXEC SQL                                                     08200001
082100          INCLUDE SUT00015                                        08210001
082200     END-EXEC.                                                    08220001
082300                                                                  08230001
082400*---------------------------------------------------------------* 08240001
082500*    THE TSURSNC TABLE                                            08250001
082600*---------------------------------------------------------------* 08260001
082700     EXEC SQL                                                     08270001
082800          INCLUDE TSURSNC                                         08280001
082900     END-EXEC.                                                    08290001
083000                                                                  08300001
083100*---------------------------------------------------------------* 08310001
083200*    THE TSUNAUD TABLE                                            08320001
083300*---------------------------------------------------------------* 08330001
083400     EXEC SQL                                                     08340001
083500          INCLUDE TSUNAUD                                         08350001
083600     END-EXEC.                                                    08360001
083700                                                                  08370001
083800*---------------------------------------------------------------* 08380001
083900*    THE CROSS REFERENCE TABLE                                    08390001
084000*---------------------------------------------------------------* 08400001
084100     EXEC SQL                                                     08410001
084200          INCLUDE TSULBXF                                         08420001
084300     END-EXEC.                                                    08430001
084400                                                                  08440001
084500                                                                  08450098
084600*---------------------------------------------------------------* 08460001
084700*    THE LIST CURSOR                                              08470001
084800*---------------------------------------------------------------* 08480001
084900**   EXEC SQL                                                     08490001
085000**        DECLARE LIST-CSR CURSOR FOR                             08500001
085100**            SELECT  PO_NBR                                      08510001
085200**                   ,RCVR_LNE_NBR                                08520001
085300**                   ,RCVR_SEQ_NBR                                08530001
085400**                   ,DEST_LOC_NBR                                08540001
085500**                   ,UPC_NBR                                     08550001
085600**                   ,SHIPT_UNT_ID                                08560001
085700**                   ,CRE_TMST                                    08570001
085800**                   ,CRE_PGM_NM                                  08580001
085900**                   ,FINCL_BEF_QTY                               08590001
086000**                   ,FINCL_AFT_QTY                               08600001
086100**                   ,AUTO_APL_IND                                08610001
086200**                   ,A.PRC_RSN_CDE                               08620001
086300**                   ,RSLV_BY_USR_ID                              08630001
086400**                   ,AUD_ADJ_STAT_CDE                            08640001
086500**                   ,FINCL_ADJ_ID                                08650001
086600**                   ,ADJ_ERR_CDE                                 08660001
086700**                   ,B.PRC_GP_CDE                                08670001
086800**              FROM  SUT_FINCL_ADJ A                             08680001
086900**                   ,TSURSNC B                                   08690001
087000**            WHERE  AUD_ADJ_STAT_CDE  >= :DK-UNT-ADJ-TYP-BEGIN   08700001
087100**              AND  AUD_ADJ_STAT_CDE  <= :DK-UNT-ADJ-TYP-END     08710001
087200**              AND  AUTO_APL_IND      >= :DK-FAIL-SUCC-BEGIN     08720001
087300**              AND  AUTO_APL_IND      <= :DK-FAIL-SUCC-END       08730001
087400**              AND  RSLV_BY_USR_ID    >= :DK-RSLV-BY-BEGIN       08740001
087500**              AND  RSLV_BY_USR_ID    <= :DK-RSLV-BY-END         08750001
087600**              AND  CRE_TMST          >= :PV-FROM-TMST           08760001
087700**              AND  CRE_TMST          <= :PV-TO-TMST             08770001
087800**              AND  ORGN_LOC_NBR      >= :DK-OPER-UNT-ID         08780001
087900**              AND  ORGN_LOC_NBR      <= :DK-OPER-END            08790001
088000**              AND  PO_NBR            >= :DK-PO-BEGIN            08800001
088100**              AND  PO_NBR            <= :DK-PO-END              08810001
088200**              AND  RCVR_SEQ_NBR      >= :DK-RCVR-BEGIN          08820001
088300**              AND  RCVR_SEQ_NBR      <= :DK-RCVR-END            08830001
088400**              AND  RCVR_LNE_NBR      >= :DK-LINE-BEGIN          08840001
088500**              AND  RCVR_LNE_NBR      <= :DK-LINE-END            08850001
088600**              AND  DEST_LOC_NBR      >= :DK-STR-BEGIN           08860001
088700**              AND  DEST_LOC_NBR      <= :DK-STR-END             08870001
088800**              AND  UPC_NBR           >= :DK-UPC-BEGIN           08880001
088900**              AND  UPC_NBR           <= :DK-UPC-END             08890001
089000**              AND ((SHIPT_UNT_ID     >= :DK-SML-BEGIN  AND      08900001
089100**                    SHIPT_UNT_ID     <= :DK-SML-END)   OR       08910001
089200**                   (SHIPT_UNT_ID     IS NULL))                  08920001
089300**              AND ((AUD_CNTL_NBR     >= :DK-AUDIT-BEGIN  AND    08930001
089400**                    AUD_CNTL_NBR     <= :DK-AUDIT-END)   OR     08940001
089500**                   (AUD_CNTL_NBR     IS NULL))                  08950001
089600**              AND  A.CRE_PGM_NM       = B.PRC_RSN_CDE           08960001
089700**              AND  B.PRC_GP_CDE      >= :DK-GROUP-BEGIN         08970001
089800**              AND  B.PRC_GP_CDE      <= :DK-GROUP-END           08980001
089900**            ORDER BY DEST_LOC_NBR                               08990001
090000**                    ,UPC_NBR                                    09000001
090100**                    ,CRE_TMST                                   09010001
090200**   END-EXEC.                                                    09020001
090300**                                                                09030001
090400*---------------------------------------------------------------* 09040001
090500*    THE OPER CURSOR                                              09050001
090600*---------------------------------------------------------------* 09060001
090700     EXEC SQL                                                     09070001
090800          DECLARE OPER-CSR CURSOR FOR                             09080001
090900              SELECT  A.PO_NBR                                    09090099
091000                     ,A.RCVR_LNE_NBR                              09100099
091100                     ,A.RCVR_SEQ_NBR                              09110099
091200                     ,A.DEST_LOC_NBR                              09120099
091300                     ,A.UPC_NBR                                   09130099
091400                     ,A.SHIPT_UNT_ID                              09140099
091500                     ,A.CRE_TMST                                  09150099
091600                     ,A.CRE_PGM_NM                                09160099
091700                     ,A.FINCL_BEF_QTY                             09170099
091800                     ,A.FINCL_AFT_QTY                             09180099
091900                     ,A.AUTO_APL_IND                              09190099
092000                     ,A.PRC_RSN_CDE                               09200001
092100                     ,A.RSLV_BY_USR_ID                            09210099
092200                     ,A.AUD_ADJ_STAT_CDE                          09220099
092300                     ,A.FINCL_ADJ_ID                              09230099
092400                     ,A.ADJ_ERR_CDE                               09240099
092500                     ,A.AUD_CNTL_NBR                              09250099
092600                     ,B.PRC_GP_CDE                                09260001
092700                FROM  SUT_FINCL_ADJ A                             09270001
092800                     ,TSURSNC B                                   09280001
092900              WHERE  A.ORGN_LOC_NBR       = :DK-OPER-UNT-ID       09290001
093000                AND  A.CRE_TMST          >= :PV-FROM-TMST         09300001
093100                AND  A.CRE_TMST          <= :PV-TO-TMST           09310001
093200                AND  A.AUD_ADJ_STAT_CDE  >= :DK-UNT-ADJ-TYP-BEGIN 09320001
093300                AND  A.AUD_ADJ_STAT_CDE  <= :DK-UNT-ADJ-TYP-END   09330001
093400                AND  A.AUTO_APL_IND      >= :DK-FAIL-SUCC-BEGIN   09340001
093500                AND  A.AUTO_APL_IND      <= :DK-FAIL-SUCC-END     09350001
093600                AND  A.RSLV_BY_USR_ID    >= :DK-RSLV-BY-BEGIN     09360001
093700                AND  A.RSLV_BY_USR_ID    <= :DK-RSLV-BY-END       09370001
093800                AND  B.PRC_RSN_CDE        = A.CRE_PGM_NM          09380001
093900                AND  B.PRC_GP_CDE        >= :DK-GROUP-BEGIN       09390001
094000                AND  B.PRC_GP_CDE        <= :DK-GROUP-END         09400001
094100              ORDER BY DEST_LOC_NBR                               09410001
094200                      ,UPC_NBR                                    09420001
094300                      ,CRE_TMST                                   09430001
094400     END-EXEC.                                                    09440001
094500                                                                  09450001
094600*---------------------------------------------------------------* 09460001
094700*    THE OPER PO CURSOR                                           09470001
094800*---------------------------------------------------------------* 09480001
094900     EXEC SQL                                                     09490001
095000          DECLARE OPER-PO-CSR CURSOR FOR                          09500001
095100              SELECT  A.PO_NBR                                    09510099
095200                     ,A.RCVR_LNE_NBR                              09520099
095300                     ,A.RCVR_SEQ_NBR                              09530099
095400                     ,A.DEST_LOC_NBR                              09540099
095500                     ,A.UPC_NBR                                   09550099
095600                     ,A.SHIPT_UNT_ID                              09560099
095700                     ,A.CRE_TMST                                  09570099
095800                     ,A.CRE_PGM_NM                                09580099
095900                     ,A.FINCL_BEF_QTY                             09590099
096000                     ,A.FINCL_AFT_QTY                             09600099
096100                     ,A.AUTO_APL_IND                              09610099
096200                     ,A.PRC_RSN_CDE                               09620001
096300                     ,A.RSLV_BY_USR_ID                            09630099
096400                     ,A.AUD_ADJ_STAT_CDE                          09640099
096500                     ,A.FINCL_ADJ_ID                              09650099
096600                     ,A.ADJ_ERR_CDE                               09660099
096700                     ,A.AUD_CNTL_NBR                              09670099
096800                     ,B.PRC_GP_CDE                                09680001
096900                FROM  SUT_FINCL_ADJ A                             09690001
097000                     ,TSURSNC B                                   09700001
097100              WHERE  A.PO_NBR             = :DK-PO-NBR            09710001
097200                AND  A.ORGN_LOC_NBR       = :DK-OPER-UNT-ID       09720001
097300                AND  A.CRE_TMST          >= :PV-FROM-TMST         09730001
097400                AND  A.CRE_TMST          <= :PV-TO-TMST           09740001
097500                AND  A.AUD_ADJ_STAT_CDE  >= :DK-UNT-ADJ-TYP-BEGIN 09750001
097600                AND  A.AUD_ADJ_STAT_CDE  <= :DK-UNT-ADJ-TYP-END   09760001
097700                AND  A.AUTO_APL_IND      >= :DK-FAIL-SUCC-BEGIN   09770001
097800                AND  A.AUTO_APL_IND      <= :DK-FAIL-SUCC-END     09780001
097900                AND  A.RSLV_BY_USR_ID    >= :DK-RSLV-BY-BEGIN     09790001
098000                AND  A.RSLV_BY_USR_ID    <= :DK-RSLV-BY-END       09800001
098100                AND  B.PRC_RSN_CDE        = A.CRE_PGM_NM          09810001
098200                AND  B.PRC_GP_CDE        >= :DK-GROUP-BEGIN       09820001
098300                AND  B.PRC_GP_CDE        <= :DK-GROUP-END         09830001
098400              ORDER BY DEST_LOC_NBR                               09840001
098500                      ,UPC_NBR                                    09850001
098600                      ,CRE_TMST                                   09860001
098700                                                                  09870001
098800     END-EXEC.                                                    09880001
098900                                                                  09890001
099000*---------------------------------------------------------------* 09900001
099100*    THE OPER PO RECEIVER CURSOR                                  09910001
099200*---------------------------------------------------------------* 09920001
099300     EXEC SQL                                                     09930001
099400          DECLARE OPER-PO-REC-CSR CURSOR FOR                      09940001
099500              SELECT  A.PO_NBR                                    09950099
099600                     ,A.RCVR_LNE_NBR                              09960099
099700                     ,A.RCVR_SEQ_NBR                              09970099
099800                     ,A.DEST_LOC_NBR                              09980099
099900                     ,A.UPC_NBR                                   09990099
100000                     ,A.SHIPT_UNT_ID                              10000099
100100                     ,A.CRE_TMST                                  10010099
100200                     ,A.CRE_PGM_NM                                10020099
100300                     ,A.FINCL_BEF_QTY                             10030099
100400                     ,A.FINCL_AFT_QTY                             10040099
100500                     ,A.AUTO_APL_IND                              10050099
100600                     ,A.PRC_RSN_CDE                               10060001
100700                     ,A.RSLV_BY_USR_ID                            10070099
100800                     ,A.AUD_ADJ_STAT_CDE                          10080099
100900                     ,A.FINCL_ADJ_ID                              10090099
101000                     ,A.ADJ_ERR_CDE                               10100099
101100                     ,A.AUD_CNTL_NBR                              10110099
101200                     ,B.PRC_GP_CDE                                10120001
101300                FROM  SUT_FINCL_ADJ A                             10130001
101400                     ,TSURSNC B                                   10140001
101500              WHERE  A.PO_NBR             = :DK-PO-NBR            10150001
101600                AND  A.RCVR_SEQ_NBR       = :DK-RCVR-SEQ-NBR      10160001
101700                AND  A.ORGN_LOC_NBR       = :DK-OPER-UNT-ID       10170001
101800                AND  A.CRE_TMST          >= :PV-FROM-TMST         10180001
101900                AND  A.CRE_TMST          <= :PV-TO-TMST           10190001
102000                AND  A.AUD_ADJ_STAT_CDE  >= :DK-UNT-ADJ-TYP-BEGIN 10200001
102100                AND  A.AUD_ADJ_STAT_CDE  <= :DK-UNT-ADJ-TYP-END   10210001
102200                AND  A.AUTO_APL_IND      >= :DK-FAIL-SUCC-BEGIN   10220001
102300                AND  A.AUTO_APL_IND      <= :DK-FAIL-SUCC-END     10230001
102400                AND  A.RSLV_BY_USR_ID    >= :DK-RSLV-BY-BEGIN     10240001
102500                AND  A.RSLV_BY_USR_ID    <= :DK-RSLV-BY-END       10250001
102600                AND  B.PRC_RSN_CDE        = A.CRE_PGM_NM          10260001
102700                AND  B.PRC_GP_CDE        >= :DK-GROUP-BEGIN       10270001
102800                AND  B.PRC_GP_CDE        <= :DK-GROUP-END         10280001
102900              ORDER BY DEST_LOC_NBR                               10290001
103000                      ,UPC_NBR                                    10300001
103100                      ,CRE_TMST                                   10310001
103200     END-EXEC.                                                    10320001
103300                                                                  10330001
103400*---------------------------------------------------------------* 10340001
103500*    THE OPER PO RECEIVER LINE CURSOR                             10350001
103600*---------------------------------------------------------------* 10360001
103700     EXEC SQL                                                     10370001
103800          DECLARE OP-PO-REC-LNE-CSR CURSOR FOR                    10380001
103900              SELECT  A.PO_NBR                                    10390099
104000                     ,A.RCVR_LNE_NBR                              10400099
104100                     ,A.RCVR_SEQ_NBR                              10410099
104200                     ,A.DEST_LOC_NBR                              10420099
104300                     ,A.UPC_NBR                                   10430099
104400                     ,A.SHIPT_UNT_ID                              10440099
104500                     ,A.CRE_TMST                                  10450099
104600                     ,A.CRE_PGM_NM                                10460099
104700                     ,A.FINCL_BEF_QTY                             10470099
104800                     ,A.FINCL_AFT_QTY                             10480099
104900                     ,A.AUTO_APL_IND                              10490099
105000                     ,A.PRC_RSN_CDE                               10500001
105100                     ,A.RSLV_BY_USR_ID                            10510099
105200                     ,A.AUD_ADJ_STAT_CDE                          10520099
105300                     ,A.FINCL_ADJ_ID                              10530099
105400                     ,A.ADJ_ERR_CDE                               10540099
105500                     ,A.AUD_CNTL_NBR                              10550099
105600                     ,B.PRC_GP_CDE                                10560001
105700                FROM  SUT_FINCL_ADJ A                             10570001
105800                     ,TSURSNC B                                   10580001
105900              WHERE  A.PO_NBR             = :DK-PO-NBR            10590001
106000                AND  A.RCVR_SEQ_NBR       = :DK-RCVR-SEQ-NBR      10600001
106100                AND  A.RCVR_LNE_NBR       = :DK-LINE-NBR          10610001
106200                AND  A.ORGN_LOC_NBR       = :DK-OPER-UNT-ID       10620001
106300                AND  A.CRE_TMST          >= :PV-FROM-TMST         10630001
106400                AND  A.CRE_TMST          <= :PV-TO-TMST           10640001
106500                AND  A.AUD_ADJ_STAT_CDE  >= :DK-UNT-ADJ-TYP-BEGIN 10650001
106600                AND  A.AUD_ADJ_STAT_CDE  <= :DK-UNT-ADJ-TYP-END   10660001
106700                AND  A.AUTO_APL_IND      >= :DK-FAIL-SUCC-BEGIN   10670001
106800                AND  A.AUTO_APL_IND      <= :DK-FAIL-SUCC-END     10680001
106900                AND  A.RSLV_BY_USR_ID    >= :DK-RSLV-BY-BEGIN     10690001
107000                AND  A.RSLV_BY_USR_ID    <= :DK-RSLV-BY-END       10700001
107100                AND  B.PRC_RSN_CDE        = A.CRE_PGM_NM          10710001
107200                AND  B.PRC_GP_CDE        >= :DK-GROUP-BEGIN       10720001
107300                AND  B.PRC_GP_CDE        <= :DK-GROUP-END         10730001
107400              ORDER BY DEST_LOC_NBR                               10740001
107500                      ,UPC_NBR                                    10750001
107600                      ,CRE_TMST                                   10760001
107700     END-EXEC.                                                    10770001
107800                                                                  10780001
107900*---------------------------------------------------------------* 10790082
108000*    THE OPER PO RECEIVER LINE SML CURSOR                         10800082
108100*---------------------------------------------------------------* 10810082
108200     EXEC SQL                                                     10820082
108300          DECLARE OPPO-RECLNESML-CSR CURSOR FOR                   10830083
108400              SELECT  A.PO_NBR                                    10840099
108500                     ,A.RCVR_LNE_NBR                              10850099
108600                     ,A.RCVR_SEQ_NBR                              10860099
108700                     ,A.DEST_LOC_NBR                              10870099
108800                     ,A.UPC_NBR                                   10880099
108900                     ,A.SHIPT_UNT_ID                              10890099
109000                     ,A.CRE_TMST                                  10900099
109100                     ,A.CRE_PGM_NM                                10910099
109200                     ,A.FINCL_BEF_QTY                             10920099
109300                     ,A.FINCL_AFT_QTY                             10930099
109400                     ,A.AUTO_APL_IND                              10940099
109500                     ,A.PRC_RSN_CDE                               10950082
109600                     ,A.RSLV_BY_USR_ID                            10960099
109700                     ,A.AUD_ADJ_STAT_CDE                          10970099
109800                     ,A.FINCL_ADJ_ID                              10980099
109900                     ,A.ADJ_ERR_CDE                               10990099
110000                     ,A.AUD_CNTL_NBR                              11000099
110100                     ,B.PRC_GP_CDE                                11010082
110200                FROM  SUT_FINCL_ADJ A                             11020082
110300                     ,TSURSNC B                                   11030082
110400              WHERE  A.PO_NBR             = :DK-PO-NBR            11040097
110500                AND  A.RCVR_SEQ_NBR       = :DK-RCVR-SEQ-NBR      11050097
110600                AND  A.RCVR_LNE_NBR       = :DK-LINE-NBR          11060097
110700                AND  A.ORGN_LOC_NBR       = :DK-OPER-UNT-ID       11070097
110800                AND  A.SHIPT_UNT_ID       = :DK-SHIPT-UNT-ID      11080097
110900                AND  A.CRE_TMST          >= :PV-FROM-TMST         11090097
111000                AND  A.CRE_TMST          <= :PV-TO-TMST           11100097
111100                AND  A.AUD_ADJ_STAT_CDE  >= :DK-UNT-ADJ-TYP-BEGIN 11110097
111200                AND  A.AUD_ADJ_STAT_CDE  <= :DK-UNT-ADJ-TYP-END   11120097
111300                AND  A.AUTO_APL_IND      >= :DK-FAIL-SUCC-BEGIN   11130097
111400                AND  A.AUTO_APL_IND      <= :DK-FAIL-SUCC-END     11140097
111500                AND  A.RSLV_BY_USR_ID    >= :DK-RSLV-BY-BEGIN     11150097
111600                AND  A.RSLV_BY_USR_ID    <= :DK-RSLV-BY-END       11160097
111700                AND  B.PRC_RSN_CDE        = A.CRE_PGM_NM          11170097
111800                AND  B.PRC_GP_CDE        >= :DK-GROUP-BEGIN       11180097
111900                AND  B.PRC_GP_CDE        <= :DK-GROUP-END         11190097
112000              ORDER BY DEST_LOC_NBR                               11200097
112100                      ,UPC_NBR                                    11210097
112200                      ,CRE_TMST                                   11220097
112300     END-EXEC.                                                    11230097
112400                                                                  11240097
112500*---------------------------------------------------------------* 11250082
112600*    THE OPER PO RECEIVER LINE DEST CURSOR                        11260001
112700*---------------------------------------------------------------* 11270001
112800     EXEC SQL                                                     11280001
112900          DECLARE OP-PO-RC-LN-ST-CSR CURSOR FOR                   11290087
113000              SELECT  A.PO_NBR                                    11300099
113100                     ,A.RCVR_LNE_NBR                              11310099
113200                     ,A.RCVR_SEQ_NBR                              11320099
113300                     ,A.DEST_LOC_NBR                              11330099
113400                     ,A.UPC_NBR                                   11340099
113500                     ,A.SHIPT_UNT_ID                              11350099
113600                     ,A.CRE_TMST                                  11360099
113700                     ,A.CRE_PGM_NM                                11370099
113800                     ,A.FINCL_BEF_QTY                             11380099
113900                     ,A.FINCL_AFT_QTY                             11390099
114000                     ,A.AUTO_APL_IND                              11400099
114100                     ,A.PRC_RSN_CDE                               11410001
114200                     ,A.RSLV_BY_USR_ID                            11420099
114300                     ,A.AUD_ADJ_STAT_CDE                          11430099
114400                     ,A.FINCL_ADJ_ID                              11440099
114500                     ,A.ADJ_ERR_CDE                               11450099
114600                     ,A.AUD_CNTL_NBR                              11460099
114700                     ,B.PRC_GP_CDE                                11470001
114800                FROM  SUT_FINCL_ADJ A                             11480001
114900                     ,TSURSNC B                                   11490001
115000              WHERE  A.PO_NBR             = :DK-PO-NBR            11500001
115100                AND  A.RCVR_SEQ_NBR       = :DK-RCVR-SEQ-NBR      11510001
115200                AND  A.RCVR_LNE_NBR       = :DK-LINE-NBR          11520001
115300                AND  A.DEST_LOC_NBR       = :DK-STR-NBR           11530001
115400                AND  A.ORGN_LOC_NBR       = :DK-OPER-UNT-ID       11540001
115500                AND  A.CRE_TMST          >= :PV-FROM-TMST         11550001
115600                AND  A.CRE_TMST          <= :PV-TO-TMST           11560001
115700                AND  A.AUD_ADJ_STAT_CDE  >= :DK-UNT-ADJ-TYP-BEGIN 11570001
115800                AND  A.AUD_ADJ_STAT_CDE  <= :DK-UNT-ADJ-TYP-END   11580001
115900                AND  A.AUTO_APL_IND      >= :DK-FAIL-SUCC-BEGIN   11590001
116000                AND  A.AUTO_APL_IND      <= :DK-FAIL-SUCC-END     11600001
116100                AND  A.RSLV_BY_USR_ID    >= :DK-RSLV-BY-BEGIN     11610001
116200                AND  A.RSLV_BY_USR_ID    <= :DK-RSLV-BY-END       11620001
116300                AND  B.PRC_RSN_CDE        = A.CRE_PGM_NM          11630001
116400                AND  B.PRC_GP_CDE        >= :DK-GROUP-BEGIN       11640001
116500                AND  B.PRC_GP_CDE        <= :DK-GROUP-END         11650001
116600              ORDER BY DEST_LOC_NBR                               11660001
116700                      ,UPC_NBR                                    11670001
116800                      ,CRE_TMST                                   11680001
116900     END-EXEC.                                                    11690001
117000                                                                  11700001
117100*---------------------------------------------------------------* 11710011
117200*    THE OPER PO RECEIVER LINE DEST AUDIT CURSOR                  11720011
117300*---------------------------------------------------------------* 11730011
117400     EXEC SQL                                                     11740011
117500          DECLARE OP-PO-RC-LN-AU-CSR CURSOR FOR                   11750013
117600              SELECT  A.PO_NBR                                    11760099
117700                     ,A.RCVR_LNE_NBR                              11770099
117800                     ,A.RCVR_SEQ_NBR                              11780099
117900                     ,A.DEST_LOC_NBR                              11790099
118000                     ,A.UPC_NBR                                   11800099
118100                     ,A.SHIPT_UNT_ID                              11810099
118200                     ,A.CRE_TMST                                  11820099
118300                     ,A.CRE_PGM_NM                                11830099
118400                     ,A.FINCL_BEF_QTY                             11840099
118500                     ,A.FINCL_AFT_QTY                             11850099
118600                     ,A.AUTO_APL_IND                              11860099
118700                     ,A.PRC_RSN_CDE                               11870011
118800                     ,A.RSLV_BY_USR_ID                            11880099
118900                     ,A.AUD_ADJ_STAT_CDE                          11890099
119000                     ,A.FINCL_ADJ_ID                              11900099
119100                     ,A.ADJ_ERR_CDE                               11910099
119200                     ,A.AUD_CNTL_NBR                              11920099
119300                     ,B.PRC_GP_CDE                                11930011
119400                FROM  SUT_FINCL_ADJ A                             11940011
119500                     ,TSURSNC B                                   11950011
119600              WHERE  A.PO_NBR             = :DK-PO-NBR            11960011
119700                AND  A.RCVR_SEQ_NBR       = :DK-RCVR-SEQ-NBR      11970011
119800                AND  A.RCVR_LNE_NBR      >= :DK-DEFAULT-BEGIN     11980099
119900                AND  A.RCVR_LNE_NBR      <= :DK-DEFAULT-END-LINE  11990099
120000                AND  A.ORGN_LOC_NBR       = :DK-OPER-UNT-ID       12000011
120100                AND  A.AUD_CNTL_NBR       = :DK-AUDIT-NBR         12010011
120200**              AND  A.CRE_TMST          >= :PV-FROM-TMST         12020014
120300**              AND  A.CRE_TMST          <= :PV-TO-TMST           12030014
120400                AND  A.AUD_ADJ_STAT_CDE  >= :DK-UNT-ADJ-TYP-BEGIN 12040011
120500                AND  A.AUD_ADJ_STAT_CDE  <= :DK-UNT-ADJ-TYP-END   12050011
120600                AND  A.AUTO_APL_IND      >= :DK-FAIL-SUCC-BEGIN   12060011
120700                AND  A.AUTO_APL_IND      <= :DK-FAIL-SUCC-END     12070011
120800                AND  A.RSLV_BY_USR_ID    >= :DK-RSLV-BY-BEGIN     12080011
120900                AND  A.RSLV_BY_USR_ID    <= :DK-RSLV-BY-END       12090011
121000                AND  B.PRC_RSN_CDE        = A.CRE_PGM_NM          12100011
121100                AND  B.PRC_GP_CDE        >= :DK-GROUP-BEGIN       12110011
121200                AND  B.PRC_GP_CDE        <= :DK-GROUP-END         12120011
121300              ORDER BY DEST_LOC_NBR                               12130011
121400                      ,UPC_NBR                                    12140011
121500                      ,CRE_TMST                                   12150011
121600     END-EXEC.                                                    12160011
121700                                                                  12170011
121800*---------------------------------------------------------------* 12180011
121900*    THE OPER UPC CURSOR                                          12190001
122000*---------------------------------------------------------------* 12200001
122100     EXEC SQL                                                     12210001
122200          DECLARE OPER-UPC-CSR CURSOR FOR                         12220001
122300              SELECT  A.PO_NBR                                    12230099
122400                     ,A.RCVR_LNE_NBR                              12240099
122500                     ,A.RCVR_SEQ_NBR                              12250099
122600                     ,A.DEST_LOC_NBR                              12260099
122700                     ,A.UPC_NBR                                   12270099
122800                     ,A.SHIPT_UNT_ID                              12280099
122900                     ,A.CRE_TMST                                  12290099
123000                     ,A.CRE_PGM_NM                                12300099
123100                     ,A.FINCL_BEF_QTY                             12310099
123200                     ,A.FINCL_AFT_QTY                             12320099
123300                     ,A.AUTO_APL_IND                              12330099
123400                     ,A.PRC_RSN_CDE                               12340001
123500                     ,A.RSLV_BY_USR_ID                            12350099
123600                     ,A.AUD_ADJ_STAT_CDE                          12360099
123700                     ,A.FINCL_ADJ_ID                              12370099
123800                     ,A.ADJ_ERR_CDE                               12380099
123900                     ,A.AUD_CNTL_NBR                              12390099
124000                     ,B.PRC_GP_CDE                                12400001
124100                FROM  SUT_FINCL_ADJ A                             12410001
124200                     ,TSURSNC B                                   12420001
124300              WHERE  A.ORGN_LOC_NBR       = :DK-OPER-UNT-ID       12430001
124400                AND  A.UPC_NBR            = :DK-UPC-NBR           12440001
124500                AND  A.CRE_TMST          >= :PV-FROM-TMST         12450001
124600                AND  A.CRE_TMST          <= :PV-TO-TMST           12460001
124700                AND  A.AUD_ADJ_STAT_CDE  >= :DK-UNT-ADJ-TYP-BEGIN 12470001
124800                AND  A.AUD_ADJ_STAT_CDE  <= :DK-UNT-ADJ-TYP-END   12480001
124900                AND  A.AUTO_APL_IND      >= :DK-FAIL-SUCC-BEGIN   12490001
125000                AND  A.AUTO_APL_IND      <= :DK-FAIL-SUCC-END     12500001
125100                AND  A.RSLV_BY_USR_ID    >= :DK-RSLV-BY-BEGIN     12510001
125200                AND  A.RSLV_BY_USR_ID    <= :DK-RSLV-BY-END       12520001
125300                AND  B.PRC_RSN_CDE        = A.CRE_PGM_NM          12530001
125400                AND  B.PRC_GP_CDE        >= :DK-GROUP-BEGIN       12540001
125500                AND  B.PRC_GP_CDE        <= :DK-GROUP-END         12550001
125600              ORDER BY DEST_LOC_NBR                               12560001
125700                      ,UPC_NBR                                    12570001
125800                      ,CRE_TMST                                   12580001
125900     END-EXEC.                                                    12590001
126000                                                                  12600001
126100*---------------------------------------------------------------* 12610001
126200*    THE PO CURSOR                                                12620001
126300*---------------------------------------------------------------* 12630001
126400     EXEC SQL                                                     12640001
126500          DECLARE PO-CSR CURSOR FOR                               12650001
126600              SELECT  A.PO_NBR                                    12660099
126700                     ,A.RCVR_LNE_NBR                              12670099
126800                     ,A.RCVR_SEQ_NBR                              12680099
126900                     ,A.DEST_LOC_NBR                              12690099
127000                     ,A.UPC_NBR                                   12700099
127100                     ,A.SHIPT_UNT_ID                              12710099
127200                     ,A.CRE_TMST                                  12720099
127300                     ,A.CRE_PGM_NM                                12730099
127400                     ,A.FINCL_BEF_QTY                             12740099
127500                     ,A.FINCL_AFT_QTY                             12750099
127600                     ,A.AUTO_APL_IND                              12760099
127700                     ,A.PRC_RSN_CDE                               12770001
127800                     ,A.RSLV_BY_USR_ID                            12780099
127900                     ,A.AUD_ADJ_STAT_CDE                          12790099
128000                     ,A.FINCL_ADJ_ID                              12800099
128100                     ,A.ADJ_ERR_CDE                               12810099
128200                     ,A.AUD_CNTL_NBR                              12820099
128300                     ,B.PRC_GP_CDE                                12830001
128400                FROM  SUT_FINCL_ADJ A                             12840001
128500                     ,TSURSNC B                                   12850001
128600              WHERE  A.PO_NBR             = :DK-PO-NBR            12860001
128700                AND  A.CRE_TMST          >= :PV-FROM-TMST         12870001
128800                AND  A.CRE_TMST          <= :PV-TO-TMST           12880001
128900                AND  A.AUD_ADJ_STAT_CDE  >= :DK-UNT-ADJ-TYP-BEGIN 12890001
129000                AND  A.AUD_ADJ_STAT_CDE  <= :DK-UNT-ADJ-TYP-END   12900001
129100                AND  A.AUTO_APL_IND      >= :DK-FAIL-SUCC-BEGIN   12910001
129200                AND  A.AUTO_APL_IND      <= :DK-FAIL-SUCC-END     12920001
129300                AND  A.RSLV_BY_USR_ID    >= :DK-RSLV-BY-BEGIN     12930001
129400                AND  A.RSLV_BY_USR_ID    <= :DK-RSLV-BY-END       12940001
129500                AND  B.PRC_RSN_CDE        = A.CRE_PGM_NM          12950001
129600                AND  B.PRC_GP_CDE        >= :DK-GROUP-BEGIN       12960001
129700                AND  B.PRC_GP_CDE        <= :DK-GROUP-END         12970001
129800              ORDER BY DEST_LOC_NBR                               12980001
129900                      ,UPC_NBR                                    12990001
130000                      ,CRE_TMST                                   13000001
130100     END-EXEC.                                                    13010001
130200                                                                  13020001
130300*---------------------------------------------------------------* 13030001
130400*    THE PO RECEIVER CURSOR                                       13040001
130500*---------------------------------------------------------------* 13050001
130600     EXEC SQL                                                     13060001
130700          DECLARE PO-REC-CSR CURSOR FOR                           13070001
130800              SELECT  A.PO_NBR                                    13080099
130900                     ,A.RCVR_LNE_NBR                              13090099
131000                     ,A.RCVR_SEQ_NBR                              13100099
131100                     ,A.DEST_LOC_NBR                              13110099
131200                     ,A.UPC_NBR                                   13120099
131300                     ,A.SHIPT_UNT_ID                              13130099
131400                     ,A.CRE_TMST                                  13140099
131500                     ,A.CRE_PGM_NM                                13150099
131600                     ,A.FINCL_BEF_QTY                             13160099
131700                     ,A.FINCL_AFT_QTY                             13170099
131800                     ,A.AUTO_APL_IND                              13180099
131900                     ,A.PRC_RSN_CDE                               13190001
132000                     ,A.RSLV_BY_USR_ID                            13200099
132100                     ,A.AUD_ADJ_STAT_CDE                          13210099
132200                     ,A.FINCL_ADJ_ID                              13220099
132300                     ,A.ADJ_ERR_CDE                               13230099
132400                     ,A.AUD_CNTL_NBR                              13240099
132500                     ,B.PRC_GP_CDE                                13250001
132600                FROM  SUT_FINCL_ADJ A                             13260001
132700                     ,TSURSNC B                                   13270001
132800              WHERE  A.PO_NBR             = :DK-PO-NBR            13280001
132900                AND  A.RCVR_SEQ_NBR       = :DK-RCVR-SEQ-NBR      13290001
133000                AND  A.CRE_TMST          >= :PV-FROM-TMST         13300001
133100                AND  A.CRE_TMST          <= :PV-TO-TMST           13310001
133200                AND  A.AUD_ADJ_STAT_CDE  >= :DK-UNT-ADJ-TYP-BEGIN 13320001
133300                AND  A.AUD_ADJ_STAT_CDE  <= :DK-UNT-ADJ-TYP-END   13330001
133400                AND  A.AUTO_APL_IND      >= :DK-FAIL-SUCC-BEGIN   13340001
133500                AND  A.AUTO_APL_IND      <= :DK-FAIL-SUCC-END     13350001
133600                AND  A.RSLV_BY_USR_ID    >= :DK-RSLV-BY-BEGIN     13360001
133700                AND  A.RSLV_BY_USR_ID    <= :DK-RSLV-BY-END       13370001
133800                AND  B.PRC_RSN_CDE        = A.CRE_PGM_NM          13380001
133900                AND  B.PRC_GP_CDE        >= :DK-GROUP-BEGIN       13390001
134000                AND  B.PRC_GP_CDE        <= :DK-GROUP-END         13400001
134100              ORDER BY DEST_LOC_NBR                               13410001
134200                      ,UPC_NBR                                    13420001
134300                      ,CRE_TMST                                   13430001
134400     END-EXEC.                                                    13440001
134500                                                                  13450001
134600*---------------------------------------------------------------* 13460001
134700*    THE PO RECEIVER LINE CURSOR                                  13470001
134800*---------------------------------------------------------------* 13480001
134900     EXEC SQL                                                     13490001
135000          DECLARE PO-REC-LNE-CSR CURSOR FOR                       13500001
135100              SELECT  A.PO_NBR                                    13510099
135200                     ,A.RCVR_LNE_NBR                              13520099
135300                     ,A.RCVR_SEQ_NBR                              13530099
135400                     ,A.DEST_LOC_NBR                              13540099
135500                     ,A.UPC_NBR                                   13550099
135600                     ,A.SHIPT_UNT_ID                              13560099
135700                     ,A.CRE_TMST                                  13570099
135800                     ,A.CRE_PGM_NM                                13580099
135900                     ,A.FINCL_BEF_QTY                             13590099
136000                     ,A.FINCL_AFT_QTY                             13600099
136100                     ,A.AUTO_APL_IND                              13610099
136200                     ,A.PRC_RSN_CDE                               13620001
136300                     ,A.RSLV_BY_USR_ID                            13630099
136400                     ,A.AUD_ADJ_STAT_CDE                          13640099
136500                     ,A.FINCL_ADJ_ID                              13650099
136600                     ,A.ADJ_ERR_CDE                               13660099
136700                     ,A.AUD_CNTL_NBR                              13670099
136800                     ,B.PRC_GP_CDE                                13680001
136900                FROM  SUT_FINCL_ADJ A                             13690001
137000                     ,TSURSNC B                                   13700001
137100              WHERE  A.PO_NBR             = :DK-PO-NBR            13710001
137200                AND  A.RCVR_SEQ_NBR       = :DK-RCVR-SEQ-NBR      13720001
137300                AND  A.RCVR_LNE_NBR       = :DK-LINE-NBR          13730001
137400                AND  A.CRE_TMST          >= :PV-FROM-TMST         13740001
137500                AND  A.CRE_TMST          <= :PV-TO-TMST           13750001
137600                AND  A.AUD_ADJ_STAT_CDE  >= :DK-UNT-ADJ-TYP-BEGIN 13760001
137700                AND  A.AUD_ADJ_STAT_CDE  <= :DK-UNT-ADJ-TYP-END   13770001
137800                AND  A.AUTO_APL_IND      >= :DK-FAIL-SUCC-BEGIN   13780001
137900                AND  A.AUTO_APL_IND      <= :DK-FAIL-SUCC-END     13790001
138000                AND  A.RSLV_BY_USR_ID    >= :DK-RSLV-BY-BEGIN     13800001
138100                AND  A.RSLV_BY_USR_ID    <= :DK-RSLV-BY-END       13810001
138200                AND  B.PRC_RSN_CDE        = A.CRE_PGM_NM          13820001
138300                AND  B.PRC_GP_CDE        >= :DK-GROUP-BEGIN       13830001
138400                AND  B.PRC_GP_CDE        <= :DK-GROUP-END         13840001
138500              ORDER BY DEST_LOC_NBR                               13850001
138600                      ,UPC_NBR                                    13860001
138700                      ,CRE_TMST                                   13870001
138800     END-EXEC.                                                    13880001
138900                                                                  13890001
139000*---------------------------------------------------------------* 13900001
139100*    THE PO RECEIVER LINE DEST CURSOR                             13910001
139200*---------------------------------------------------------------* 13920001
139300     EXEC SQL                                                     13930001
139400          DECLARE PO-REC-LNE-DST-CSR CURSOR FOR                   13940001
139500              SELECT  A.PO_NBR                                    13950099
139600                     ,A.RCVR_LNE_NBR                              13960099
139700                     ,A.RCVR_SEQ_NBR                              13970099
139800                     ,A.DEST_LOC_NBR                              13980099
139900                     ,A.UPC_NBR                                   13990099
140000                     ,A.SHIPT_UNT_ID                              14000099
140100                     ,A.CRE_TMST                                  14010099
140200                     ,A.CRE_PGM_NM                                14020099
140300                     ,A.FINCL_BEF_QTY                             14030099
140400                     ,A.FINCL_AFT_QTY                             14040099
140500                     ,A.AUTO_APL_IND                              14050099
140600                     ,A.PRC_RSN_CDE                               14060001
140700                     ,A.RSLV_BY_USR_ID                            14070099
140800                     ,A.AUD_ADJ_STAT_CDE                          14080099
140900                     ,A.FINCL_ADJ_ID                              14090099
141000                     ,A.ADJ_ERR_CDE                               14100099
141100                     ,A.AUD_CNTL_NBR                              14110099
141200                     ,B.PRC_GP_CDE                                14120001
141300                FROM  SUT_FINCL_ADJ A                             14130001
141400                     ,TSURSNC B                                   14140001
141500              WHERE  A.PO_NBR             = :DK-PO-NBR            14150001
141600                AND  A.RCVR_SEQ_NBR       = :DK-RCVR-SEQ-NBR      14160001
141700                AND  A.RCVR_LNE_NBR       = :DK-LINE-NBR          14170001
141800                AND  A.DEST_LOC_NBR       = :DK-STR-NBR           14180001
141900                AND  A.CRE_TMST          >= :PV-FROM-TMST         14190001
142000                AND  A.CRE_TMST          <= :PV-TO-TMST           14200001
142100                AND  A.AUD_ADJ_STAT_CDE  >= :DK-UNT-ADJ-TYP-BEGIN 14210001
142200                AND  A.AUD_ADJ_STAT_CDE  <= :DK-UNT-ADJ-TYP-END   14220001
142300                AND  A.AUTO_APL_IND      >= :DK-FAIL-SUCC-BEGIN   14230001
142400                AND  A.AUTO_APL_IND      <= :DK-FAIL-SUCC-END     14240001
142500                AND  A.RSLV_BY_USR_ID    >= :DK-RSLV-BY-BEGIN     14250001
142600                AND  A.RSLV_BY_USR_ID    <= :DK-RSLV-BY-END       14260001
142700                AND  B.PRC_RSN_CDE        = A.CRE_PGM_NM          14270001
142800                AND  B.PRC_GP_CDE        >= :DK-GROUP-BEGIN       14280001
142900                AND  B.PRC_GP_CDE        <= :DK-GROUP-END         14290001
143000              ORDER BY DEST_LOC_NBR                               14300001
143100                      ,UPC_NBR                                    14310001
143200                      ,CRE_TMST                                   14320001
143300     END-EXEC.                                                    14330001
143400                                                                  14340001
143500*---------------------------------------------------------------* 14350001
143600*    THE UPC CURSOR                                               14360001
143700*---------------------------------------------------------------* 14370001
143800     EXEC SQL                                                     14380001
143900          DECLARE UPC-CSR CURSOR FOR                              14390001
144000              SELECT  A.PO_NBR                                    14400099
144100                     ,A.RCVR_LNE_NBR                              14410099
144200                     ,A.RCVR_SEQ_NBR                              14420099
144300                     ,A.DEST_LOC_NBR                              14430099
144400                     ,A.UPC_NBR                                   14440099
144500                     ,A.SHIPT_UNT_ID                              14450099
144600                     ,A.CRE_TMST                                  14460099
144700                     ,A.CRE_PGM_NM                                14470099
144800                     ,A.FINCL_BEF_QTY                             14480099
144900                     ,A.FINCL_AFT_QTY                             14490099
145000                     ,A.AUTO_APL_IND                              14500099
145100                     ,A.PRC_RSN_CDE                               14510001
145200                     ,A.RSLV_BY_USR_ID                            14520099
145300                     ,A.AUD_ADJ_STAT_CDE                          14530099
145400                     ,A.FINCL_ADJ_ID                              14540099
145500                     ,A.ADJ_ERR_CDE                               14550099
145600                     ,A.AUD_CNTL_NBR                              14560099
145700                     ,B.PRC_GP_CDE                                14570001
145800                FROM  SUT_FINCL_ADJ A                             14580001
145900                     ,TSURSNC B                                   14590001
146000              WHERE  A.UPC_NBR            = :DK-UPC-NBR           14600001
146100                AND  A.CRE_TMST          >= :PV-FROM-TMST         14610001
146200                AND  A.CRE_TMST          <= :PV-TO-TMST           14620001
146300                AND  A.AUD_ADJ_STAT_CDE  >= :DK-UNT-ADJ-TYP-BEGIN 14630001
146400                AND  A.AUD_ADJ_STAT_CDE  <= :DK-UNT-ADJ-TYP-END   14640001
146500                AND  A.AUTO_APL_IND      >= :DK-FAIL-SUCC-BEGIN   14650001
146600                AND  A.AUTO_APL_IND      <= :DK-FAIL-SUCC-END     14660001
146700                AND  A.RSLV_BY_USR_ID    >= :DK-RSLV-BY-BEGIN     14670001
146800                AND  A.RSLV_BY_USR_ID    <= :DK-RSLV-BY-END       14680001
146900                AND  B.PRC_RSN_CDE        = A.CRE_PGM_NM          14690001
147000                AND  B.PRC_GP_CDE        >= :DK-GROUP-BEGIN       14700001
147100                AND  B.PRC_GP_CDE        <= :DK-GROUP-END         14710001
147200              ORDER BY DEST_LOC_NBR                               14720001
147300                      ,UPC_NBR                                    14730001
147400                      ,CRE_TMST                                   14740001
147500     END-EXEC.                                                    14750001
147600                                                                  14760001
147700*---------------------------------------------------------------* 14770001
147800*    THE AUDIT CURSOR                                             14780001
147900*---------------------------------------------------------------* 14790001
148000     EXEC SQL                                                     14800001
148100          DECLARE AUDIT-CSR CURSOR FOR                            14810001
148200              SELECT  A.PO_NBR                                    14820099
148300                     ,A.RCVR_LNE_NBR                              14830099
148400                     ,A.RCVR_SEQ_NBR                              14840099
148500                     ,A.DEST_LOC_NBR                              14850099
148600                     ,A.UPC_NBR                                   14860099
148700                     ,A.SHIPT_UNT_ID                              14870099
148800                     ,A.CRE_TMST                                  14880099
148900                     ,A.CRE_PGM_NM                                14890099
149000                     ,A.FINCL_BEF_QTY                             14900099
149100                     ,A.FINCL_AFT_QTY                             14910099
149200                     ,A.AUTO_APL_IND                              14920099
149300                     ,A.PRC_RSN_CDE                               14930001
149400                     ,A.RSLV_BY_USR_ID                            14940099
149500                     ,A.AUD_ADJ_STAT_CDE                          14950099
149600                     ,A.FINCL_ADJ_ID                              14960099
149700                     ,A.ADJ_ERR_CDE                               14970099
149800                     ,A.AUD_CNTL_NBR                              14980099
149900                     ,B.PRC_GP_CDE                                14990001
150000                FROM  SUT_FINCL_ADJ A                             15000001
150100                     ,TSURSNC B                                   15010001
150200              WHERE  A.AUD_CNTL_NBR       = :DK-AUDIT-NBR         15020001
150300**              AND  A.CRE_TMST          >= :PV-FROM-TMST         15030001
150400**              AND  A.CRE_TMST          <= :PV-TO-TMST           15040001
150500                AND  A.AUD_ADJ_STAT_CDE  >= :DK-UNT-ADJ-TYP-BEGIN 15050001
150600                AND  A.AUD_ADJ_STAT_CDE  <= :DK-UNT-ADJ-TYP-END   15060001
150700                AND  A.AUTO_APL_IND      >= :DK-FAIL-SUCC-BEGIN   15070001
150800                AND  A.AUTO_APL_IND      <= :DK-FAIL-SUCC-END     15080001
150900                AND  A.RSLV_BY_USR_ID    >= :DK-RSLV-BY-BEGIN     15090001
151000                AND  A.RSLV_BY_USR_ID    <= :DK-RSLV-BY-END       15100001
151100                AND  B.PRC_RSN_CDE        = A.CRE_PGM_NM          15110001
151200                AND  B.PRC_GP_CDE        >= :DK-GROUP-BEGIN       15120001
151300                AND  B.PRC_GP_CDE        <= :DK-GROUP-END         15130001
151400              ORDER BY DEST_LOC_NBR                               15140001
151500                      ,UPC_NBR                                    15150001
151600                      ,CRE_TMST                                   15160001
151700     END-EXEC.                                                    15170001
151800                                                                  15180001
151900*---------------------------------------------------------------* 15190001
152000*    THE SHIPT UNIT CURSOR                                        15200001
152100*---------------------------------------------------------------* 15210001
152200     EXEC SQL                                                     15220001
152300          DECLARE SHIPT-UNIT-CSR CURSOR FOR                       15230001
152400              SELECT  A.PO_NBR                                    15240099
152500                     ,A.RCVR_LNE_NBR                              15250099
152600                     ,A.RCVR_SEQ_NBR                              15260099
152700                     ,A.DEST_LOC_NBR                              15270099
152800                     ,A.UPC_NBR                                   15280099
152900                     ,A.SHIPT_UNT_ID                              15290099
153000                     ,A.CRE_TMST                                  15300099
153100                     ,A.CRE_PGM_NM                                15310099
153200                     ,A.FINCL_BEF_QTY                             15320099
153300                     ,A.FINCL_AFT_QTY                             15330099
153400                     ,A.AUTO_APL_IND                              15340099
153500                     ,A.PRC_RSN_CDE                               15350007
153600                     ,A.RSLV_BY_USR_ID                            15360099
153700                     ,A.AUD_ADJ_STAT_CDE                          15370099
153800                     ,A.FINCL_ADJ_ID                              15380099
153900                     ,A.ADJ_ERR_CDE                               15390099
154000                     ,A.AUD_CNTL_NBR                              15400099
154100                     ,B.PRC_GP_CDE                                15410007
154200                FROM  SUT_FINCL_ADJ A                             15420001
154300                     ,TSURSNC B                                   15430001
154400              WHERE  A.SHIPT_UNT_ID       = :DK-SHIPT-UNT-ID      15440001
154500                AND  A.CRE_TMST          >= :PV-FROM-TMST         15450001
154600                AND  A.CRE_TMST          <= :PV-TO-TMST           15460001
154700                AND  A.AUD_ADJ_STAT_CDE  >= :DK-UNT-ADJ-TYP-BEGIN 15470001
154800                AND  A.AUD_ADJ_STAT_CDE  <= :DK-UNT-ADJ-TYP-END   15480001
154900                AND  A.AUTO_APL_IND      >= :DK-FAIL-SUCC-BEGIN   15490001
155000                AND  A.AUTO_APL_IND      <= :DK-FAIL-SUCC-END     15500001
155100                AND  A.RSLV_BY_USR_ID    >= :DK-RSLV-BY-BEGIN     15510001
155200                AND  A.RSLV_BY_USR_ID    <= :DK-RSLV-BY-END       15520001
155300                AND  B.PRC_RSN_CDE        = A.CRE_PGM_NM          15530001
155400                AND  B.PRC_GP_CDE        >= :DK-GROUP-BEGIN       15540001
155500                AND  B.PRC_GP_CDE        <= :DK-GROUP-END         15550001
155600              ORDER BY DEST_LOC_NBR                               15560001
155700                      ,UPC_NBR                                    15570001
155800                      ,CRE_TMST                                   15580001
155900     END-EXEC.                                                    15590001
156000                                                                  15600001
156100*---------------------------------------------------------------* 15610001
156200*    THE OPER SKU CURSOR                                          15620001
156300*---------------------------------------------------------------* 15630001
156400     EXEC SQL                                                     15640001
156500          DECLARE OPER-SKU-CSR CURSOR FOR                         15650001
156600              SELECT  A.PO_NBR                                    15660099
156700                     ,A.RCVR_LNE_NBR                              15670099
156800                     ,A.RCVR_SEQ_NBR                              15680099
156900                     ,A.DEST_LOC_NBR                              15690099
157000                     ,A.UPC_NBR                                   15700008
157100                     ,A.SHIPT_UNT_ID                              15710099
157200                     ,A.CRE_TMST                                  15720099
157300                     ,A.CRE_PGM_NM                                15730099
157400                     ,A.FINCL_BEF_QTY                             15740099
157500                     ,A.FINCL_AFT_QTY                             15750099
157600                     ,A.AUTO_APL_IND                              15760099
157700                     ,A.PRC_RSN_CDE                               15770007
157800                     ,A.RSLV_BY_USR_ID                            15780099
157900                     ,A.AUD_ADJ_STAT_CDE                          15790099
158000                     ,A.FINCL_ADJ_ID                              15800099
158100                     ,A.ADJ_ERR_CDE                               15810099
158200                     ,A.AUD_CNTL_NBR                              15820099
158300                     ,B.PRC_GP_CDE                                15830007
158400                FROM  SUT_FINCL_ADJ A                             15840001
158500                     ,TSURSNC B                                   15850001
158600                     ,XLT_SKU C                                   15860001
158700                     ,XLT_UPC D                                   15870001
158800              WHERE  A.ORGN_LOC_NBR       = :DK-OPER-UNT-ID       15880001
158900                AND  C.SKU_NBR            = :DK-SKU-NBR           15890001
159000                AND  C.INTR_UPC_ID        = D.INTR_UPC_ID         15900001
159100                AND  A.UPC_NBR            = D.UPC_NBR             15910001
159200                AND  A.CRE_TMST          >= :PV-FROM-TMST         15920001
159300                AND  A.CRE_TMST          <= :PV-TO-TMST           15930001
159400                AND  A.AUD_ADJ_STAT_CDE  >= :DK-UNT-ADJ-TYP-BEGIN 15940001
159500                AND  A.AUD_ADJ_STAT_CDE  <= :DK-UNT-ADJ-TYP-END   15950001
159600                AND  A.AUTO_APL_IND      >= :DK-FAIL-SUCC-BEGIN   15960001
159700                AND  A.AUTO_APL_IND      <= :DK-FAIL-SUCC-END     15970001
159800                AND  A.RSLV_BY_USR_ID    >= :DK-RSLV-BY-BEGIN     15980001
159900                AND  A.RSLV_BY_USR_ID    <= :DK-RSLV-BY-END       15990001
160000                AND  B.PRC_RSN_CDE        = A.CRE_PGM_NM          16000001
160100                AND  B.PRC_GP_CDE        >= :DK-GROUP-BEGIN       16010001
160200                AND  B.PRC_GP_CDE        <= :DK-GROUP-END         16020097
160300              ORDER BY DEST_LOC_NBR                               16030001
160400                      ,UPC_NBR                                    16040001
160500                      ,CRE_TMST                                   16050001
160600     END-EXEC.                                                    16060001
160700                                                                  16070001
160800*---------------------------------------------------------------* 16080001
160900*    THE SKU CURSOR                                               16090001
161000*---------------------------------------------------------------* 16100001
161100     EXEC SQL                                                     16110001
161200          DECLARE SKU-CSR CURSOR FOR                              16120001
161300              SELECT  A.PO_NBR                                    16130099
161400                     ,A.RCVR_LNE_NBR                              16140099
161500                     ,A.RCVR_SEQ_NBR                              16150099
161600                     ,A.DEST_LOC_NBR                              16160099
161700                     ,A.UPC_NBR                                   16170008
161800                     ,A.SHIPT_UNT_ID                              16180099
161900                     ,A.CRE_TMST                                  16190099
162000                     ,A.CRE_PGM_NM                                16200099
162100                     ,A.FINCL_BEF_QTY                             16210099
162200                     ,A.FINCL_AFT_QTY                             16220099
162300                     ,A.AUTO_APL_IND                              16230099
162400                     ,A.PRC_RSN_CDE                               16240007
162500                     ,A.RSLV_BY_USR_ID                            16250099
162600                     ,A.AUD_ADJ_STAT_CDE                          16260099
162700                     ,A.FINCL_ADJ_ID                              16270099
162800                     ,A.ADJ_ERR_CDE                               16280099
162900                     ,A.AUD_CNTL_NBR                              16290099
163000                     ,B.PRC_GP_CDE                                16300007
163100                FROM  SUT_FINCL_ADJ A                             16310001
163200                     ,TSURSNC B                                   16320001
163300                     ,XLT_SKU C                                   16330001
163400                     ,XLT_UPC D                                   16340001
163500              WHERE  C.SKU_NBR            = :DK-SKU-NBR           16350001
163600                AND  C.INTR_UPC_ID        = D.INTR_UPC_ID         16360001
163700                AND  A.UPC_NBR            = D.UPC_NBR             16370001
163800                AND  A.CRE_TMST          >= :PV-FROM-TMST         16380001
163900                AND  A.CRE_TMST          <= :PV-TO-TMST           16390001
164000                AND  A.AUD_ADJ_STAT_CDE  >= :DK-UNT-ADJ-TYP-BEGIN 16400001
164100                AND  A.AUD_ADJ_STAT_CDE  <= :DK-UNT-ADJ-TYP-END   16410001
164200                AND  A.AUTO_APL_IND      >= :DK-FAIL-SUCC-BEGIN   16420001
164300                AND  A.AUTO_APL_IND      <= :DK-FAIL-SUCC-END     16430001
164400                AND  A.RSLV_BY_USR_ID    >= :DK-RSLV-BY-BEGIN     16440001
164500                AND  A.RSLV_BY_USR_ID    <= :DK-RSLV-BY-END       16450001
164600                AND  B.PRC_RSN_CDE        = A.CRE_PGM_NM          16460001
164700                AND  B.PRC_GP_CDE        >= :DK-GROUP-BEGIN       16470001
164800                AND  B.PRC_GP_CDE        <= :DK-GROUP-END         16480001
164900              ORDER BY DEST_LOC_NBR                               16490001
165000                      ,UPC_NBR                                    16500001
165100                      ,CRE_TMST                                   16510001
165200     END-EXEC.                                                    16520001
165300                                                                  16530001
165400*---------------------------------------------------------------* 16540001
165500*---------------------------------------------------------------* 16550001
165600     EXEC SQL                                                     16560001
165700          INCLUDE SQLCA                                           16570001
165800     END-EXEC.                                                    16580001
165900                                                                  16590001
166000*-----------------------------------------------------------------16600001
166100 LINKAGE SECTION.                                                 16610001
166200                                                                  16620001
166300 01  DFHCOMMAREA.                                                 16630001
166400     05  FILLER                         OCCURS  1 TO 4072 TIMES   16640001
166500                                        DEPENDING ON EIBCALEN.    16650001
166600         10  FILLER                     PIC X.                    16660001
166700                                                                  16670001
166800                                                                  16680001
166900 PROCEDURE DIVISION.                                              16690001
167000******************************************************************16700001
167100**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **16710001
167200**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **16720001
167300**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **16730001
167400******************************************************************16740001
167500 0000-MAIN-MODULE.                                                16750001
167600     INITIALIZE DP030-CICS-API-FIELDS.                            16760001
167700     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       16770001
167800     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          16780001
167900     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         16790001
168000     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       16800001
168100     MOVE LENGTH OF SU756AI        TO DP030-MAP-LENGTH (1).       16810001
168200     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     16820001
168300     PERFORM 0001-CALL-CICS-ARCH-API.                             16830001
168400                                                                  16840001
168500     PERFORM 1000-CONTROL-PROCESSING                              16850001
168600*                                                                 16860001
168700     EVALUATE TRUE                                                16870001
168800        WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)               16880001
168900        WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)               16890001
169000        WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)               16900001
169100        WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)               16910001
169200        WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)               16920001
169300        WHEN DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)               16930001
169400        WHEN DP020-FK-LOCAL-FUNC-08 (DP020-SRC-AID)               16940045
169500            IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                   16950001
169600                CONTINUE                                          16960001
169700            END-IF                                                16970001
169800        WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)               16980096
169900            IF DP020-MSG-FATAL AND DP020-MSG-NUMBER = 00050       16990096
170000                CONTINUE                                          17000096
170100            END-IF                                                17010096
170200        WHEN OTHER                                                17020001
170300            IF DP020-MSG-FATAL AND DP020-MSG-NUMBER = 00050       17030001
170400                SET DP020-NEXT-ACT-APPL-ERROR TO TRUE             17040001
170500            END-IF                                                17050001
170600     END-EVALUATE.                                                17060001
170700                                                                  17070001
170800     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     17080001
170900     PERFORM 0001-CALL-CICS-ARCH-API.                             17090001
171000                                                                  17100001
171100******************************************************************17110001
171200**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **17120001
171300**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **17130001
171400******************************************************************17140001
171500 0001-CALL-CICS-ARCH-API.                                         17150001
171600*    CALL 'DPKCS030' USING DFHEIBLK                               17160099
171600     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      17161099
171700                           DFHCOMMAREA                            17170001
171800                           DP030-CICS-API-FIELDS                  17180001
171900                           DP020-STANDARD-COMMAREA                17190001
172000                           SU756AI.                               17200001
172100*                                                                 17210001
172200     IF  DP030-RC-CALL-SUCCESSFUL                                 17220001
172300         CONTINUE                                                 17230001
172400     ELSE                                                         17240001
172500         SET DP013-NO-ROLLBACK                                    17250001
172600             DP013-XCTL-DISPLAY-RESTART                           17260001
172700             DP013-CICS-ABEND      TO TRUE                        17270001
172800         MOVE '0001-CALL-CICS-ARCH-API' TO DP013-PARAGRAPH        17280001
172900*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX17290099
173000*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      17300099
172900         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O17301099
173000-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      17302099
173100         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      17310001
173200         PERFORM DP013-0000-PROCESS-ABEND                         17320001
173300     END-IF.                                                      17330001
173400                                                                  17340001
173500*----------------------------------------------------------------*17350001
173600* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *17360001
173700* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *17370001
173800*                                                                *17380001
173900* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *17390001
174000*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *17400001
174100*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *17410001
174200*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *17420001
174300*----------------------------------------------------------------*17430001
174400 1000-CONTROL-PROCESSING.                                         17440001
174500                                                                  17450001
174600     EVALUATE TRUE                                                17460001
174700         WHEN DP020-NEXT-ACT-INITIAL                              17470001
174800             INITIALIZE ASC-SPECIFIC-COMMAREA                     17480001
174900             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            17490001
175000                                      ASC-SEL-TERM-ID-OUT         17500001
175100             MOVE DP020-SRC-TASK-NUMBER TO ASC-LIST-TASK-NUMBER   17510001
175200                                           ASC-SEL-TASK-NUMBER-OUT17520001
175300             MOVE PC-LIST-QUEUE-SEQ  TO ASC-LIST-SEQ              17530001
175400             MOVE PC-SEL-QUEUE-SEQ   TO ASC-SEL-SEQ-OUT           17540001
175500             PERFORM 1100-PROCESS-INTER-APPL-COMM                 17550001
175600             SET ASC-ACCESS-UPC  TO TRUE                          17560001
175700             MOVE 'UPC NUMBER' TO AUPSKHDO                        17570001
175800             IF ASC-FAIL-SUCC-ALL                                 17580001
175900                 SET ASC-ALL-SW  TO TRUE                          17590001
176000                 MOVE ' ** ALL ** ' TO ADISPLYO                   17600001
176100             ELSE                                                 17610001
176200                 IF ASC-FAIL                                      17620001
176300                     SET ASC-FAIL-SW  TO TRUE                     17630001
176400                     MOVE ' ** FAIL ** ' TO ADISPLYO              17640001
176500                 ELSE                                             17650001
176600                     IF ASC-SUCCESS                               17660001
176700                         SET ASC-SUCC-SW  TO TRUE                 17670001
176800                         MOVE ' ** SUCCESSFUL ** ' TO ADISPLYO    17680001
176900                     ELSE                                         17690001
177000                         IF ASC-UNACKNOWLEDGED                    17700001
177100                             SET ASC-ALL-SW  TO TRUE              17710001
177200                             MOVE ' ** ALL ** ' TO ADISPLYO       17720001
177300                         END-IF                                   17730001
177400                     END-IF                                       17740001
177500                 END-IF                                           17750001
177600             END-IF                                               17760001
177700             PERFORM 4000-BUILD-INITIAL-PANEL                     17770001
177800                                                                  17780001
177900         WHEN DP020-NEXT-ACT-READ-MAP                             17790001
178000             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         17800001
178100             PERFORM 2000-PROCESS-PANEL                           17810001
178200                                                                  17820001
178300         WHEN DP020-NEXT-ACT-RETURN                               17830001
178400             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         17840001
178500             MOVE ZERO  TO ASC-ITEM-AT-TOP-OF-PANEL               17850001
178600             IF  ASC-ACCESS-UPC-SKU = 'U'                         17860030
178700                 SET ASC-ACCESS-UPC TO TRUE                       17870031
178800                 MOVE 'UPC NUMBER' TO AUPSKHDO                    17880031
178900             ELSE                                                 17890031
179000                 IF  ASC-ACCESS-UPC-SKU = 'S'                     17900031
179100                     SET ASC-ACCESS-SKU TO TRUE                   17910031
179200                     MOVE 'SKU NUMBER' TO AUPSKHDO                17920031
179300                 END-IF                                           17930031
179400             END-IF                                               17940031
179500             IF ASC-FAIL-SUCC-ALL                                 17950028
179600                 SET ASC-ALL-SW  TO TRUE                          17960028
179700                 MOVE ' ** ALL ** ' TO ADISPLYO                   17970028
179800             ELSE                                                 17980028
179900                 IF ASC-FAIL                                      17990028
180000                     SET ASC-FAIL-SW  TO TRUE                     18000028
180100                     MOVE ' ** FAIL ** ' TO ADISPLYO              18010028
180200                 ELSE                                             18020028
180300                     IF ASC-SUCCESS                               18030028
180400                         SET ASC-SUCC-SW  TO TRUE                 18040028
180500                         MOVE ' ** SUCCESSFUL ** ' TO ADISPLYO    18050028
180600                     ELSE                                         18060028
180700                         IF ASC-UNACKNOWLEDGED                    18070028
180800                             SET ASC-ALL-SW  TO TRUE              18080028
180900                             MOVE ' ** ALL ** ' TO ADISPLYO       18090028
181000                         END-IF                                   18100028
181100                     END-IF                                       18110028
181200                 END-IF                                           18120028
181300             END-IF                                               18130028
181400*            PERFORM 2050-DELETE-LIST-QUEUE                       18140001
181500*            PERFORM 4000-BUILD-INITIAL-PANEL                     18150001
181600             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 18160001
181700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 18170001
181800                                                                  18180001
181900         WHEN OTHER                                               18190001
182000             SET DP013-LOGIC-ABEND TO TRUE                        18200001
182100             SET DP013-NO-ROLLBACK TO TRUE                        18210001
182200             MOVE '1000-CONTROL-PROCESSING' TO DP013-PARAGRAPH    18220001
182300             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    18230001
182400                                   TO DP013-MESSAGE-TEXT(1)       18240001
182500             PERFORM DP013-0000-PROCESS-ABEND                     18250001
182600     END-EVALUATE.                                                18260001
182700                                                                  18270001
182800*----------------------------------------------------------------*18280001
182900* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *18290001
183000* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *18300001
183100*----------------------------------------------------------------*18310001
183200 1100-PROCESS-INTER-APPL-COMM.                                    18320001
183300                                                                  18330001
183400     SET PS-COMMAREA-VALID         TO TRUE.                       18340001
183500     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     18350001
183600                                                                  18360001
183700     IF  DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT          18370001
183800         MOVE SU037-CURR-OPER-UNT-ID  TO ASC-CURR-OPER-UNT-ID     18380001
183900         MOVE SU037-UNT-ADJ-TYP       TO ASC-UNT-ADJ-TYP          18390001
184000         MOVE SU037-FAIL-SUCCESS-IND  TO ASC-FAIL-SUCCESS-IND     18400001
184100         MOVE SU037-PROCESS-GROUP     TO ASC-PROCESS-GROUP        18410001
184200         MOVE SU037-PROCESS-GRP-DESC  TO ASC-PROCESS-GRP-DESC     18420001
184300         MOVE SU037-REQUEST-FROM-DATE TO ASC-FROM-DATE            18430001
184400         MOVE SU037-REQUEST-TO-DATE   TO ASC-TO-DATE              18440001
184500         MOVE SU037-OPER-UNT-ID       TO ASC-OPER-UNT-ID          18450001
184600         MOVE SU037-OPER-NAME         TO ASC-OPER-NAME            18460001
184700         MOVE SU037-PO                TO ASC-PO                   18470001
184800                                         DK-TRN-NBR               18480001
184900         MOVE SU037-RCVR              TO ASC-RCVR                 18490001
185000                                         DK-PO-RCVR-NBR-N         18500001
185100         MOVE DK-PO-RCVR-NBR-N        TO DK-RCVR-NBR-9            18510001
185200         MOVE DK-RCVR-NBR-3           TO DK-RCVR-NBR              18520001
185300         MOVE DK-PO-RCVR              TO ASC-PO-RCVR              18530001
185400         MOVE SU037-LINE              TO ASC-LINE                 18540001
185500         MOVE SU037-STR-NBR           TO ASC-STR-NBR              18550001
185600         MOVE SU037-STR-NAME          TO ASC-STR-NAME             18560001
185700         MOVE SU037-UPC               TO ASC-UPC                  18570001
185800         MOVE SU037-SKU               TO ASC-SKU                  18580001
185900         MOVE SU037-SML               TO ASC-SML                  18590001
186000                                         ASC-SML-IN               18600037
186100         MOVE SU037-AUDIT-NBR         TO ASC-AUDIT                18610001
186200                                         ASC-AUDIT-IN             18620037
186300     ELSE                                                         18630001
186400         IF  DP020-INT-APPL-FORMAT-IND = PC-LIST-FORMAT           18640001
186500             SET ASC-USE-SELECTION-QUEUE TO TRUE                  18650001
186600             SET ASC-LIST-FORMAT TO TRUE                          18660099
186700             MOVE SU038-NUMBER-OF-SELECTED-ITEMS TO               18670001
186800                                      ASC-NUMBER-OF-SELECTED-ITEMS18680001
186900             MOVE SU038-NUMBER-OF-TS-ITEMS TO                     18690001
187000                                            ASC-NUMBER-OF-TS-ITEMS18700001
187100             MOVE SU038-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-IN    18710001
187200             MOVE SU038-UNT-ADJ-TYP        TO ASC-UNT-ADJ-TYP     18720001
187300             MOVE SU038-FAIL-SUCCSS        TO ASC-FAIL-SUCCESS-IND18730001
187400             MOVE SU038-PROCESS-GROUP      TO ASC-PROCESS-GROUP   18740001
187500             MOVE SU038-PROCESS-GRP-DESC   TO ASC-PROCESS-GRP-DESC18750001
187600             MOVE SU038-STR-NBR            TO ASC-STR-NBR         18760001
187700             MOVE SU038-FROM-DATE          TO ASC-FROM-DATE       18770001
187800             MOVE SU038-TO-DATE            TO ASC-TO-DATE         18780001
187900             MOVE SU038-OPER-UNT-ID        TO ASC-OPER-UNT-ID     18790001
188000             MOVE SU038-OPER-NAME          TO ASC-OPER-NAME       18800001
188100             MOVE SU038-AUDIT              TO ASC-AUDIT           18810001
188200                                              ASC-AUDIT-IN        18820037
188300             MOVE ZEROES                   TO ASC-PO-NBR          18830001
188400                                              ASC-RCVR            18840001
188500             MOVE SU038-PO-RCVR            TO ASC-PO-RCVR         18850001
188600             MOVE SU038-LINE               TO ASC-LINE            18860001
188700             MOVE SU038-SML                TO ASC-SML             18870001
188800                                              ASC-SML-IN          18880037
188900             PERFORM 1120-PREPARE-LIST-ENTRY                      18890001
189000         ELSE                                                     18900001
189100             IF  DP020-INT-APPL-FORMAT-IND = PC-AUDIT-FORMAT      18910071
189200                 SET ASC-USE-SELECTION-QUEUE TO TRUE              18920071
189300                 SET ASC-AUDIT-FORMAT TO TRUE                     18930099
189400                 MOVE SU038-NUMBER-OF-SELECTED-ITEMS TO           18940071
189500                                      ASC-NUMBER-OF-SELECTED-ITEMS18950001
189600                 MOVE SU038-NUMBER-OF-TS-ITEMS TO                 18960071
189700                                            ASC-NUMBER-OF-TS-ITEMS18970001
189800                 MOVE SU038-SEL-QUEUE-NAME  TO ASC-SEL-QUEUE-IN-2 18980071
189900                 MOVE SU038-UNT-ADJ-TYP        TO ASC-UNT-ADJ-TYP 18990071
190000                 MOVE SU038-FAIL-SUCCSS    TO ASC-FAIL-SUCCESS-IND19000071
190100                 MOVE SU038-PROCESS-GROUP     TO ASC-PROCESS-GROUP19010071
190200                 MOVE SU038-PROCESS-GRP-DESC TO                   19020071
190300                                              ASC-PROCESS-GRP-DESC19030071
190400                 MOVE SU038-STR-NBR            TO ASC-STR-NBR     19040071
190500                 MOVE SU038-OPER-UNT-ID        TO ASC-OPER-UNT-ID 19050071
190600                 MOVE SU038-OPER-NAME          TO ASC-OPER-NAME   19060071
190700                 MOVE SU038-AUDIT              TO ASC-AUDIT       19070071
190800                                                  ASC-AUDIT-IN    19080071
190900                 MOVE SU038-PO-RCVR            TO ASC-PO-RCVR     19090071
191000                 MOVE SU038-LINE               TO ASC-LINE        19100071
191100                 MOVE SU038-SML                TO ASC-SML         19110071
191200                                                  ASC-SML-IN      19120071
191300                 PERFORM 1120-PREPARE-LIST-ENTRY                  19130071
191400             ELSE                                                 19140071
191500                 SET ASC-USE-SELECTION-QUEUE TO TRUE              19150071
191600                 MOVE SU038-NUMBER-OF-SELECTED-ITEMS TO           19160071
191700                                      ASC-NUMBER-OF-SELECTED-ITEMS19170071
191800                 MOVE SU038-NUMBER-OF-TS-ITEMS TO                 19180071
191900                                            ASC-NUMBER-OF-TS-ITEMS19190071
192000                 MOVE SU038-SEL-QUEUE-NAME  TO ASC-SEL-QUEUE-IN-3 19200071
192100                 MOVE SU038-UNT-ADJ-TYP        TO ASC-UNT-ADJ-TYP 19210071
192200                 MOVE SU038-FAIL-SUCCSS    TO ASC-FAIL-SUCCESS-IND19220071
192300                 MOVE SU038-PROCESS-GROUP     TO ASC-PROCESS-GROUP19230071
192400                 MOVE SU038-PROCESS-GRP-DESC TO                   19240071
192500                                              ASC-PROCESS-GRP-DESC19250071
192600                 MOVE SU038-STR-NBR            TO ASC-STR-NBR     19260071
192700                 MOVE SU038-OPER-UNT-ID        TO ASC-OPER-UNT-ID 19270071
192800                 MOVE SU038-OPER-NAME          TO ASC-OPER-NAME   19280071
192900                 MOVE SU038-AUDIT              TO ASC-AUDIT       19290071
193000                                                  ASC-AUDIT-IN    19300071
193100                 MOVE SU038-PO-RCVR            TO ASC-PO-RCVR     19310071
193200                 MOVE SU038-LINE               TO ASC-LINE        19320071
193300                 MOVE SU038-SML                TO ASC-SML         19330071
193400                                                  ASC-SML-IN      19340071
193500                 PERFORM 1120-PREPARE-LIST-ENTRY                  19350071
193600     END-IF.                                                      19360071
193700                                                                  19370071
193800     MOVE ASC-PO-NBR                  TO DK-PO-NBR                19380068
193900                                         PV-PO-NBR.               19390068
194000     IF PV-PO-NBR  > SPACES                                       19400068
194100         EVALUATE TRUE                                            19410068
194200             WHEN PV-TRN-3 = SPACES                               19420068
194300                 MOVE PV-TRN-9     TO FILLER-9                    19430068
194400                 MOVE PV-TRN-8     TO FILLER-8                    19440068
194500                 MOVE PV-TRN-7     TO FILLER-7                    19450068
194600                 MOVE PV-TRN-6     TO FILLER-6                    19460068
194700                 MOVE PV-TRN-5     TO FILLER-5                    19470068
194800                 MOVE PV-TRN-4     TO FILLER-4                    19480068
194900                 MOVE 0            TO FILLER-3                    19490068
195000                                      FILLER-2                    19500068
195100                                      FILLER-1                    19510068
195200                 MOVE DK-PO-TRN-NBR-X  TO ASC-PO                  19520081
195300                                          DK-PO-NBR               19530081
195400             WHEN PV-TRN-2 = SPACES                               19540068
195500                 MOVE PV-TRN-9     TO FILLER-9                    19550068
195600                 MOVE PV-TRN-8     TO FILLER-8                    19560068
195700                 MOVE PV-TRN-7     TO FILLER-7                    19570068
195800                 MOVE PV-TRN-6     TO FILLER-6                    19580068
195900                 MOVE PV-TRN-5     TO FILLER-5                    19590068
196000                 MOVE PV-TRN-4     TO FILLER-4                    19600068
196100                 MOVE PV-TRN-3     TO FILLER-3                    19610068
196200                 MOVE 0            TO FILLER-2                    19620068
196300                                      FILLER-1                    19630068
196400                 MOVE DK-PO-TRN-NBR-X  TO ASC-PO                  19640081
196500                                          DK-PO-NBR               19650081
196600             WHEN PV-TRN-1 = SPACES                               19660068
196700                 MOVE PV-TRN-9     TO FILLER-9                    19670068
196800                 MOVE PV-TRN-8     TO FILLER-8                    19680068
196900                 MOVE PV-TRN-7     TO FILLER-7                    19690068
197000                 MOVE PV-TRN-6     TO FILLER-6                    19700068
197100                 MOVE PV-TRN-5     TO FILLER-5                    19710068
197200                 MOVE PV-TRN-4     TO FILLER-4                    19720068
197300                 MOVE PV-TRN-3     TO FILLER-3                    19730068
197400                 MOVE PV-TRN-2     TO FILLER-2                    19740068
197500                 MOVE 0            TO FILLER-1                    19750068
197600                 MOVE DK-PO-TRN-NBR-X  TO ASC-PO                  19760081
197700                                          DK-PO-NBR               19770081
197800          END-EVALUATE                                            19780068
197900     ELSE                                                         19790080
198000                 MOVE PV-PO-NBR    TO DK-TRN-NBR                  19800080
198100                 MOVE DK-TRN-NBR   TO ASC-PO                      19810080
198200                                      DK-PO-NBR                   19820080
198300     END-IF.                                                      19830080
198400     MOVE ZEROES                      TO DK-RCVR-NBR-3            19840068
198500                                         DK-RCVR-NBR-6            19850068
198600                                         ASC-RCVR.                19860068
198700     MOVE ASC-RCVR-NBR                TO DK-RCVR-NBR-3.           19870068
198800     MOVE DK-RCVR-NBR-3               TO ASC-RCVR.                19880068
198900*-----------------------------------------------------------------19890001
199000*  PREPARE LIST ENTRY                                             19900001
199100*-----------------------------------------------------------------19910001
199200 1120-PREPARE-LIST-ENTRY.                                         19920001
199300                                                                  19930001
199400     MOVE SU039-MAX-ITEMS          TO ASC-SEL-SUB.                19940001
199500     MOVE ZERO                     TO ASC-SEL-ITEM.               19950001
199600     PERFORM 1130-GET-NEXT-RECORD.                                19960001
199700                                                                  19970001
199800*-----------------------------------------------------------------19980001
199900*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*19990001
200000*-----------------------------------------------------------------20000001
200100 1130-GET-NEXT-RECORD.                                            20010001
200200     ADD +1                       TO ASC-SEL-SUB.                 20020001
200300                                                                  20030001
200400     IF  ASC-SEL-SUB > SU039-MAX-ITEMS                            20040001
200500         ADD +1                   TO ASC-SEL-ITEM                 20050001
200600         MOVE +1                  TO ASC-SEL-SUB                  20060001
200700     END-IF.                                                      20070001
200800                                                                  20080001
200900     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                20090001
201000         IF  DP020-INT-APPL-FORMAT-IND = PC-LIST-FORMAT           20100068
201100             PERFORM 9100-READ-SEL-QUEUE                          20110068
201200             IF  SU039-ITEM (ASC-SEL-SUB) > ZERO                  20120068
201300                 IF ASC-OPER-UNT-ID = ZEROES                      20130099
201300                     MOVE SU039-OPER-UNT-ID (ASC-SEL-SUB) TO      20131099
201400                                                   ASC-OPER-UNT-ID20140099
202800                 END-IF                                           20141099
201500                 IF ASC-PO-RCVR = SPACES                          20150099
201500                   MOVE SU039-PO-RCVR (ASC-SEL-SUB) TO ASC-PO-RCVR20151099
202800                 END-IF                                           20152099
201600                 MOVE SU039-LINE (ASC-SEL-SUB)    TO ASC-LINE     20160001
201700                 MOVE SU039-SKU (ASC-SEL-SUB)     TO ASC-SKU      20170001
201800                 MOVE SU039-UPC (ASC-SEL-SUB)     TO ASC-UPC      20180001
201900*                MOVE SU039-SHIPT-UNT-ID(ASC-SEL-SUB) TO ASC-SML  20190099
202000*                                                      ASC-SML-IN 20200099
202100                 SET SU039-INQ (ASC-SEL-SUB) TO TRUE              20210001
202200                 PERFORM 9200-REWRITE-SEL-QUEUE                   20220001
202300             ELSE                                                 20230068
202400                 SUBTRACT +1 FROM ASC-SEL-SUB                     20240068
202500                 MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER         20250068
202600                 SET DP020-MSG-INFORMATIONAL                      20260068
202700                     PS-LIST-END             TO TRUE              20270068
202800             END-IF                                               20280068
202900         ELSE                                                     20290068
203000             IF  DP020-INT-APPL-FORMAT-IND = PC-AUDIT-FORMAT      20300071
203100                 PERFORM 9300-READ-SEL-QUEUE-2                    20310071
203200                 IF  SU039-ITEM (ASC-SEL-SUB) > ZERO              20320071
203300                     MOVE SU039-UPC (ASC-SEL-SUB)     TO ASC-UPC  20330071
203400                     MOVE SU039-SHIPT-UNT-ID(ASC-SEL-SUB) TO      20340075
203500                                                       ASC-SML    20350075
203600                                                       ASC-SML-IN 20360075
203700                     MOVE SU039-LINE (ASC-SEL-SUB)    TO ASC-LINE 20370071
203800                     PERFORM 9400-REWRITE-SEL-QUEUE-2             20380071
203900                 ELSE                                             20390071
204000                     SUBTRACT +1 FROM ASC-SEL-SUB                 20400071
204100                     MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER     20410071
204200                     SET DP020-MSG-INFORMATIONAL                  20420071
204300                         PS-LIST-END             TO TRUE          20430071
204400                 END-IF                                           20440071
204500             ELSE                                                 20450071
204600                 PERFORM 9500-READ-SEL-QUEUE-3                    20460071
204700                 IF  SU039-ITEM (ASC-SEL-SUB) > ZERO              20470071
204800                     MOVE SU039-UPC (ASC-SEL-SUB)     TO ASC-UPC  20480071
204900                     MOVE SU039-LINE (ASC-SEL-SUB)    TO ASC-LINE 20490071
205000                     PERFORM 9600-REWRITE-SEL-QUEUE-3             20500071
205100                 ELSE                                             20510071
205200                     SUBTRACT +1 FROM ASC-SEL-SUB                 20520071
205300                     MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER     20530071
205400                     SET DP020-MSG-INFORMATIONAL                  20540071
205500                         PS-LIST-END             TO TRUE          20550071
205600                 END-IF                                           20560071
205700             END-IF                                               20570071
205800         END-IF                                                   20580071
205900     ELSE                                                         20590001
206000         SUBTRACT +1 FROM ASC-SEL-ITEM                            20600001
206100         MOVE SU039-MAX-ITEMS     TO ASC-SEL-SUB                  20610001
206200         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             20620001
206300         SET DP020-MSG-INFORMATIONAL                              20630001
206400             PS-LIST-END             TO TRUE                      20640001
206500     END-IF.                                                      20650001
206600                                                                  20660062
206700     MOVE ASC-PO-NBR                  TO DK-PO-NBR                20670068
206800                                         PV-PO-NBR.               20680068
206900     IF PV-PO-NBR  > SPACES                                       20690068
207000         EVALUATE TRUE                                            20700068
207100             WHEN PV-TRN-3 = SPACES                               20710068
207200                 MOVE PV-TRN-9     TO FILLER-9                    20720068
207300                 MOVE PV-TRN-8     TO FILLER-8                    20730068
207400                 MOVE PV-TRN-7     TO FILLER-7                    20740068
207500                 MOVE PV-TRN-6     TO FILLER-6                    20750068
207600                 MOVE PV-TRN-5     TO FILLER-5                    20760068
207700                 MOVE PV-TRN-4     TO FILLER-4                    20770068
207800                 MOVE 0            TO FILLER-3                    20780068
207900                                      FILLER-2                    20790068
208000                                      FILLER-1                    20800068
208100                 MOVE DK-PO-TRN-NBR-X  TO ASC-PO                  20810081
208200                                          DK-PO-NBR               20820081
208300             WHEN PV-TRN-2 = SPACES                               20830068
208400                 MOVE PV-TRN-9     TO FILLER-9                    20840068
208500                 MOVE PV-TRN-8     TO FILLER-8                    20850068
208600                 MOVE PV-TRN-7     TO FILLER-7                    20860068
208700                 MOVE PV-TRN-6     TO FILLER-6                    20870068
208800                 MOVE PV-TRN-5     TO FILLER-5                    20880068
208900                 MOVE PV-TRN-4     TO FILLER-4                    20890068
209000                 MOVE PV-TRN-3     TO FILLER-3                    20900068
209100                 MOVE 0            TO FILLER-2                    20910068
209200                                      FILLER-1                    20920068
209300                 MOVE DK-PO-TRN-NBR-X  TO ASC-PO                  20930081
209400                                          DK-PO-NBR               20940081
209500             WHEN PV-TRN-1 = SPACES                               20950068
209600                 MOVE PV-TRN-9     TO FILLER-9                    20960068
209700                 MOVE PV-TRN-8     TO FILLER-8                    20970068
209800                 MOVE PV-TRN-7     TO FILLER-7                    20980068
209900                 MOVE PV-TRN-6     TO FILLER-6                    20990068
210000                 MOVE PV-TRN-5     TO FILLER-5                    21000068
210100                 MOVE PV-TRN-4     TO FILLER-4                    21010068
210200                 MOVE PV-TRN-3     TO FILLER-3                    21020068
210300                 MOVE PV-TRN-2     TO FILLER-2                    21030068
210400                 MOVE 0            TO FILLER-1                    21040068
210500                 MOVE DK-PO-TRN-NBR-X  TO ASC-PO                  21050081
210600                                          DK-PO-NBR               21060081
210700          END-EVALUATE                                            21070068
210800     ELSE                                                         21080068
210900                 MOVE PV-PO-NBR    TO DK-TRN-NBR                  21090080
211000                 MOVE DK-TRN-NBR   TO ASC-PO                      21100080
211100                                      DK-PO-NBR                   21110080
211200     END-IF.                                                      21120068
211300     MOVE ZEROES                      TO DK-RCVR-NBR-3            21130068
211400                                         DK-RCVR-NBR-6            21140068
211500                                         ASC-RCVR.                21150068
211600     MOVE ASC-RCVR-NBR                TO DK-RCVR-NBR-3.           21160068
211700     MOVE DK-RCVR-NBR-3               TO ASC-RCVR.                21170068
211800*----------------------------------------------------------------*21180001
211900*    GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING      *21190001
212000*    PROCESSED.                                                  *21200001
212100*----------------------------------------------------------------*21210001
212200 1140-GET-PREV-RECORD.                                            21220001
212300     SUBTRACT +1 FROM ASC-SEL-SUB.                                21230001
212400                                                                  21240001
212500     IF  ASC-SEL-SUB < +1                                         21250001
212600         SUBTRACT +1 FROM ASC-SEL-ITEM                            21260001
212700         MOVE SU039-MAX-ITEMS     TO ASC-SEL-SUB                  21270001
212800     END-IF.                                                      21280001
212900                                                                  21290001
213000     IF  ASC-SEL-ITEM > ZERO                                      21300001
213100         IF  DP020-INT-APPL-FORMAT-IND = PC-LIST-FORMAT           21310068
213200             PERFORM 9100-READ-SEL-QUEUE                          21320068
213300*           MOVE SU039-OPER-UNT-ID(ASC-SEL-SUB) TO ASC-OPER-UNT-ID21330099
213400*            MOVE SU039-PO-RCVR (ASC-SEL-SUB)     TO  ASC-PO-RCVR 21340099
213500             MOVE SU039-LINE (ASC-SEL-SUB)        TO  ASC-LINE    21350068
213600             MOVE SU039-SKU (ASC-SEL-SUB)         TO  ASC-SKU     21360068
213700             MOVE SU039-UPC (ASC-SEL-SUB)         TO  ASC-UPC     21370068
213800             MOVE SU039-NET-ADJ (ASC-SEL-SUB)     TO  ASC-NET-ADJ 21380068
213900             MOVE SU039-ADJ-SOURCE (ASC-SEL-SUB) TO ASC-ADJ-SOURCE21390068
214000*            MOVE SU039-SHIPT-UNT-ID(ASC-SEL-SUB) TO  ASC-SML     21400099
214100*                                                     ASC-SML-IN  21410099
214200             SET SU039-INQ (ASC-SEL-SUB) TO TRUE                  21420068
214300             PERFORM 9200-REWRITE-SEL-QUEUE                       21430068
214400         ELSE                                                     21440068
214500             IF  DP020-INT-APPL-FORMAT-IND = PC-AUDIT-FORMAT      21450071
214600                 PERFORM 9300-READ-SEL-QUEUE-2                    21460071
214700                 MOVE SU039-LINE (ASC-SEL-SUB)        TO  ASC-LINE21470071
214800                 MOVE SU039-SKU (ASC-SEL-SUB)         TO  ASC-SKU 21480071
214900                 MOVE SU039-UPC (ASC-SEL-SUB)         TO  ASC-UPC 21490071
215000                 MOVE SU039-NET-ADJ (ASC-SEL-SUB) TO  ASC-NET-ADJ 21500071
215100                 MOVE SU039-ADJ-SOURCE (ASC-SEL-SUB) TO           21510071
215200                                                    ASC-ADJ-SOURCE21520071
215300                 MOVE SU039-SHIPT-UNT-ID(ASC-SEL-SUB) TO  ASC-SML 21530071
215400                                                        ASC-SML-IN21540071
215500                 SET SU039-INQ (ASC-SEL-SUB) TO TRUE              21550071
215600                 PERFORM 9400-REWRITE-SEL-QUEUE-2                 21560073
215700             ELSE                                                 21570071
215800                 PERFORM 9500-READ-SEL-QUEUE-3                    21580071
215900                 MOVE SU039-OPER-UNT-ID(ASC-SEL-SUB) TO           21590099
216000                                                   ASC-OPER-UNT-ID21600099
216100                 MOVE SU039-PO-RCVR (ASC-SEL-SUB)  TO ASC-PO-RCVR 21610099
216200                 MOVE SU039-LINE (ASC-SEL-SUB)        TO  ASC-LINE21620071
216300                 MOVE SU039-SKU (ASC-SEL-SUB)         TO  ASC-SKU 21630071
216400                 MOVE SU039-UPC (ASC-SEL-SUB)         TO  ASC-UPC 21640071
216500                 MOVE SU039-NET-ADJ (ASC-SEL-SUB) TO  ASC-NET-ADJ 21650071
216600                 MOVE SU039-ADJ-SOURCE (ASC-SEL-SUB) TO           21660071
216700                                                    ASC-ADJ-SOURCE21670071
216800                 SET SU039-INQ (ASC-SEL-SUB) TO TRUE              21680071
216900                 PERFORM 9600-REWRITE-SEL-QUEUE-3                 21690071
217000             END-IF                                               21700071
217100         END-IF                                                   21710071
217200     ELSE                                                         21720071
217300         MOVE +1                  TO ASC-SEL-ITEM                 21730001
217400                                     ASC-SEL-SUB                  21740001
217500         MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             21750001
217600         SET DP020-MSG-INFORMATIONAL                              21760001
217700             PS-LIST-END             TO TRUE                      21770001
217800     END-IF.                                                      21780001
217900                                                                  21790001
218000     MOVE ASC-PO-NBR                  TO DK-PO-NBR                21800068
218100                                         PV-PO-NBR.               21810068
218200     IF PV-PO-NBR  > SPACES                                       21820068
218300         EVALUATE TRUE                                            21830068
218400             WHEN PV-TRN-3 = SPACES                               21840068
218500                 MOVE PV-TRN-9     TO FILLER-9                    21850068
218600                 MOVE PV-TRN-8     TO FILLER-8                    21860068
218700                 MOVE PV-TRN-7     TO FILLER-7                    21870068
218800                 MOVE PV-TRN-6     TO FILLER-6                    21880068
218900                 MOVE PV-TRN-5     TO FILLER-5                    21890068
219000                 MOVE PV-TRN-4     TO FILLER-4                    21900068
219100                 MOVE 0            TO FILLER-3                    21910068
219200                                      FILLER-2                    21920068
219300                                      FILLER-1                    21930068
219400                 MOVE DK-PO-TRN-NBR-X  TO ASC-PO                  21940081
219500                                          DK-PO-NBR               21950081
219600             WHEN PV-TRN-2 = SPACES                               21960068
219700                 MOVE PV-TRN-9     TO FILLER-9                    21970068
219800                 MOVE PV-TRN-8     TO FILLER-8                    21980068
219900                 MOVE PV-TRN-7     TO FILLER-7                    21990068
220000                 MOVE PV-TRN-6     TO FILLER-6                    22000068
220100                 MOVE PV-TRN-5     TO FILLER-5                    22010068
220200                 MOVE PV-TRN-4     TO FILLER-4                    22020068
220300                 MOVE PV-TRN-3     TO FILLER-3                    22030068
220400                 MOVE 0            TO FILLER-2                    22040068
220500                                      FILLER-1                    22050068
220600                 MOVE DK-PO-TRN-NBR-X  TO ASC-PO                  22060081
220700                                          DK-PO-NBR               22070081
220800             WHEN PV-TRN-1 = SPACES                               22080068
220900                 MOVE PV-TRN-9     TO FILLER-9                    22090068
221000                 MOVE PV-TRN-8     TO FILLER-8                    22100068
221100                 MOVE PV-TRN-7     TO FILLER-7                    22110068
221200                 MOVE PV-TRN-6     TO FILLER-6                    22120068
221300                 MOVE PV-TRN-5     TO FILLER-5                    22130068
221400                 MOVE PV-TRN-4     TO FILLER-4                    22140068
221500                 MOVE PV-TRN-3     TO FILLER-3                    22150068
221600                 MOVE PV-TRN-2     TO FILLER-2                    22160068
221700                 MOVE 0            TO FILLER-1                    22170068
221800                 MOVE DK-PO-TRN-NBR-X  TO ASC-PO                  22180081
221900                                          DK-PO-NBR               22190081
222000          END-EVALUATE                                            22200068
222100     ELSE                                                         22210080
222200         MOVE PV-PO-NBR            TO DK-TRN-NBR                  22220080
222300         MOVE DK-TRN-NBR           TO ASC-PO                      22230080
222400                                      DK-PO-NBR                   22240080
222500     END-IF.                                                      22250080
222600     MOVE ZEROES                      TO DK-RCVR-NBR-3            22260068
222700                                         DK-RCVR-NBR-6            22270068
222800                                         ASC-RCVR.                22280068
222900     MOVE ASC-RCVR-NBR                TO DK-RCVR-NBR-3.           22290068
223000     MOVE DK-RCVR-NBR-3               TO ASC-RCVR.                22300068
223100*----------------------------------------------------------------*22310001
223200* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *22320001
223300* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *22330001
223400* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *22340001
223500* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *22350001
223600* FUNCTION KEYS CAN GET THIS FAR.                                *22360001
223700*----------------------------------------------------------------*22370001
223800 2000-PROCESS-PANEL.                                              22380001
223900     EVALUATE TRUE                                                22390001
224000         WHEN DP020-SRC-AID = DP016-CLEAR                         22400001
224100             MOVE ZERO   TO ASC-ITEM-AT-TOP-OF-PANEL              22410001
224200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   22420001
224300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 22430001
224400                                                                  22440001
224500         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    22450001
224600             SET ASC-ACCESS-UPC  TO TRUE                          22460001
224700             MOVE 'UPC NUMBER' TO AUPSKHDO                        22470001
224800             IF ASC-FAIL-SUCC-ALL                                 22480001
224900                 SET ASC-ALL-SW  TO TRUE                          22490001
225000                 MOVE ' ** ALL ** ' TO ADISPLYO                   22500001
225100             ELSE                                                 22510001
225200                 IF ASC-FAIL                                      22520001
225300                     SET ASC-FAIL-SW  TO TRUE                     22530001
225400                     MOVE ' ** FAIL ** ' TO ADISPLYO              22540001
225500                 ELSE                                             22550001
225600                     IF ASC-SUCCESS                               22560001
225700                         SET ASC-SUCC-SW  TO TRUE                 22570001
225800                         MOVE ' ** SUCCESSFUL ** ' TO ADISPLYO    22580001
225900                     ELSE                                         22590001
226000                         IF ASC-UNACKNOWLEDGED                    22600001
226100                             SET ASC-ALL-SW  TO TRUE              22610001
226200                             MOVE ' ** ALL ** ' TO ADISPLYO       22620001
226300                         END-IF                                   22630001
226400                     END-IF                                       22640001
226500                 END-IF                                           22650001
226600             END-IF                                               22660001
226700             PERFORM 2050-DELETE-LIST-QUEUE                       22670001
226800             PERFORM 4000-BUILD-INITIAL-PANEL                     22680001
226900                                                                  22690001
227000         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    22700001
227100             PERFORM 2140-DESELECT-ALL-ITEMS                      22710001
227200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 22720001
227300                                                                  22730001
227400         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  22740001
227500             PERFORM 2150-SELECT-ALL-ITEMS                        22750001
227600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 22760001
227700                                                                  22770001
227800         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             22780001
227900             IF  ASC-USE-SELECTION-QUEUE                          22790001
228000                 IF ASC-LIST-FORMAT                               22800099
228100                    MOVE '2' TO DP020-INT-APPL-FORMAT-IND         22810099
228200*                   MOVE '4' TO DP020-INT-APPL-FORMAT-IND         22820099
228300                 END-IF                                           22830099
228400                 IF ASC-AUDIT-FORMAT                              22840099
228500                    MOVE '3' TO DP020-INT-APPL-FORMAT-IND         22850099
228600                 END-IF                                           22860099
228700                 PERFORM 1130-GET-NEXT-RECORD                     22870001
228800                 IF PS-LIST-END                                   22880001
228900                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         22890001
229000                     SET PS-NO-LIST-END TO TRUE                   22900001
229100                 ELSE                                             22910001
229200                     PERFORM 2050-DELETE-LIST-QUEUE               22920001
229300                     PERFORM 3200-RESET-ATTRIBUTES                22930001
229400                     PERFORM 4000-BUILD-INITIAL-PANEL             22940001
229500                 END-IF                                           22950001
229600              ELSE                                                22960001
229700                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             22970001
229800*                --- BOTTOM OF LIST ---                           22980001
229900                 MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER         22990001
230000                 SET DP020-MSG-INFORMATIONAL TO TRUE              23000001
230100             END-IF                                               23010001
230200                                                                  23020001
230300         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             23030001
230400             IF  ASC-USE-SELECTION-QUEUE                          23040001
230500                 IF ASC-LIST-FORMAT                               23050099
230600                    MOVE '2' TO DP020-INT-APPL-FORMAT-IND         23060099
230700*                   MOVE '4' TO DP020-INT-APPL-FORMAT-IND         23070099
230800                 END-IF                                           23080099
230900                 IF ASC-AUDIT-FORMAT                              23090099
231000                    MOVE '3' TO DP020-INT-APPL-FORMAT-IND         23100099
231100                 END-IF                                           23110099
231200                 PERFORM 1140-GET-PREV-RECORD                     23120001
231300                 IF PS-LIST-END                                   23130001
231400                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         23140001
231500                     SET PS-NO-LIST-END TO TRUE                   23150001
231600                 ELSE                                             23160001
231700                     PERFORM 2050-DELETE-LIST-QUEUE               23170001
231800                     PERFORM 3200-RESET-ATTRIBUTES                23180001
231900                     PERFORM 4000-BUILD-INITIAL-PANEL             23190001
232000                 END-IF                                           23200001
232100             ELSE                                                 23210001
232200                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             23220001
232300                 MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER         23230001
232400                 SET DP020-MSG-INFORMATIONAL TO TRUE              23240001
232500             END-IF                                               23250001
232600                                                                  23260001
232700         WHEN OTHER                                               23270001
232800             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 23280001
232900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   23290001
233000                                                                  23300001
233100             IF  PS-NO-ERROR                                      23310001
233200                 SET DP030-CONTINUE-GO TO TRUE                    23320001
233300                 PERFORM 2100-CHECK-FUNCTION-KEY                  23330001
233400             ELSE                                                 23340001
233500                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             23350001
233600                 SET DP030-OVERRIDE-GO TO TRUE                    23360001
233700             END-IF                                               23370001
233800     END-EVALUATE.                                                23380001
233900                                                                  23390001
234000*----------------------------------------------------------------*23400001
234100*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *23410001
234200*----------------------------------------------------------------*23420001
234300 2050-DELETE-LIST-QUEUE.                                          23430001
234400                                                                  23440001
234500     EXEC CICS                                                    23450001
234600         DELETEQ TS                                               23460001
234700             QUEUE (ASC-LIST-QUEUE-NAME)                          23470001
234800             RESP  (PV-CICS-RESP)                                 23480001
234900     END-EXEC.                                                    23490001
235000                                                                  23500001
235100     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       23510001
235200        (PV-CICS-RESP = DFHRESP(QIDERR))                          23520001
235300         CONTINUE                                                 23530001
235400     ELSE                                                         23540001
235500         SET DP013-CICS-ABEND      TO TRUE                        23550001
235600         SET DP013-NO-ROLLBACK     TO TRUE                        23560001
235700                                                                  23570001
235800         MOVE '2050-DELETE-LIST-QUEUE' TO DP013-PARAGRAPH         23580001
235900         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    23590001
236000                                   TO DP013-MESSAGE-TEXT (1)      23600001
236100         PERFORM DP013-0000-PROCESS-ABEND                         23610001
236200     END-IF.                                                      23620001
236300                                                                  23630001
236400     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  23640001
236500                                                                  23650001
236600*----------------------------------------------------------------*23660001
236700* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*23670001
236800* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *23680001
236900* CICS ARCHITECTURE API.                                         *23690001
237000*----------------------------------------------------------------*23700001
237100 2100-CHECK-FUNCTION-KEY.                                         23710001
237200                                                                  23720001
237300     EVALUATE TRUE                                                23730001
237400                                                                  23740001
237500* F13 - TROUBLE LIST SCREEN                                       23750001
237600         WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)              23760001
237700             INITIALIZE RC015-INTER-APPL-COMMAREA                 23770093
237800             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              23780093
237900                 SET ASC-GOING-TO-TROUBLE TO TRUE                 23790094
238000                 MOVE ASC-PO          TO RC015-PO-NBR             23800093
238100                 MOVE ASC-RCVR        TO RC015-REC-SEQ-NBR        23810093
238200                 MOVE ASC-OPER-UNT-ID TO RC015-OPER-UNT-ID        23820093
238300                 MOVE 1               TO RC015-FCLTY-ID           23830093
238400                 PERFORM 5080-PREPARE-SEL-QUEUE                   23840093
238500             ELSE                                                 23850093
238600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             23860093
238700                 SET DP030-OVERRIDE-GO TO TRUE                    23870093
238800                 MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER         23880093
238900                 SET DP020-MSG-WARNING TO TRUE                    23890093
239000             END-IF                                               23900093
239100                                                                  23910093
239200*F15 = STORE UNIT ADJUSTMENT UPDATES                              23920001
239300         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              23930001
239400             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              23940001
239500                 INITIALIZE SU038-INTER-APPL-COMMAREA             23950001
239600                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                23960001
239700                                 TO SU038-NUMBER-OF-SELECTED-ITEMS23970001
239800                 MOVE ASC-UNT-ADJ-TYP      TO SU038-UNT-ADJ-TYP   23980001
239900                 MOVE ASC-FAIL-SUCCESS-IND TO SU038-FAIL-SUCCSS   23990001
240000                 MOVE ASC-PROCESS-GROUP    TO SU038-PROCESS-GROUP 24000001
240100                 MOVE ASC-PROCESS-GRP-DESC TO                     24010001
240200                                           SU038-PROCESS-GRP-DESC 24020001
240300                 MOVE ASC-AUDIT-IN         TO SU038-AUDIT         24030037
240400                 MOVE ASC-FROM-DATE        TO SU038-FROM-DATE     24040001
240500                 MOVE ASC-TO-DATE          TO SU038-TO-DATE       24050001
240600                 MOVE ASC-OPER-UNT-ID      TO SU038-OPER-UNT-ID   24060001
240700                 MOVE ASC-PO-RCVR          TO SU038-PO-RCVR       24070001
240800                 MOVE ASC-LINE             TO SU038-LINE          24080001
240900                 MOVE ASC-SKU              TO SU038-SKU           24090001
241000                 MOVE ASC-UPC              TO SU038-UPC           24100001
241100                 MOVE ASC-SML-IN           TO SU038-SML           24110037
241200                 PERFORM 5000-PREPARE-SEL-QUEUE                   24120001
241300             ELSE                                                 24130001
241400                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             24140001
241500                 SET DP030-OVERRIDE-GO TO TRUE                    24150001
241600                 MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER         24160001
241700                 SET DP020-MSG-WARNING TO TRUE                    24170001
241800             END-IF                                               24180001
241900                                                                  24190001
242000*F16 = TOGGLE BETWEEN UPC AND SKU INFO                            24200001
242100         WHEN DP020-FK-LOCAL-FUNC-07 (DP020-SRC-AID)              24210001
242200             IF  ASC-ACCESS-UPC-SKU = 'U'                         24220001
242300                 SET ASC-ACCESS-SKU TO TRUE                       24230001
242400                 MOVE 'SKU NUMBER' TO AUPSKHDO                    24240001
242500             ELSE                                                 24250001
242600                 IF  ASC-ACCESS-UPC-SKU = 'S'                     24260001
242700                     SET ASC-ACCESS-UPC TO TRUE                   24270001
242800                     MOVE 'UPC NUMBER' TO AUPSKHDO                24280001
242900                 END-IF                                           24290001
243000             END-IF                                               24300001
243100             PERFORM 2050-DELETE-LIST-QUEUE                       24310001
243200             PERFORM 4000-BUILD-INITIAL-PANEL                     24320001
243300                                                                  24330001
243400*F17 = SHOW ONLY SUCCESSFUL ADJUSTMENTS                           24340001
243500         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              24350001
243600             SET ASC-SUCC-SW  TO TRUE                             24360001
243700             MOVE '** SUCCESSFUL **'  TO ADISPLYO                 24370001
243800             PERFORM 2050-DELETE-LIST-QUEUE                       24380001
243900             PERFORM 4000-BUILD-INITIAL-PANEL                     24390001
244000                                                                  24400001
244100*F18 = SHOW ONLY FAILED ADJUSTMENTS                               24410001
244200         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              24420001
244300             SET ASC-FAIL-SW  TO TRUE                             24430001
244400             MOVE '** FAILED **'  TO ADISPLYO                     24440001
244500             PERFORM 2050-DELETE-LIST-QUEUE                       24450001
244600             PERFORM 4000-BUILD-INITIAL-PANEL                     24460001
244700***          PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 24470034
244800                                                                  24480001
244900*F22 = CREATE TROUBLE                                             24490001
245000         WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)              24500001
245100             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              24510001
245200                 SET ASC-GOING-TO-TROUBLE TO TRUE                 24520001
245300                 MOVE ASC-OPER-UNT-ID   TO PC000-OPERATING-UNIT-ID24530001
245400                 MOVE 1                    TO PC000-FACILITY-ID   24540001
245500                 PERFORM 5050-PREPARE-SEL-QUEUE                   24550001
245600             ELSE                                                 24560001
245700                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             24570001
245800                 SET DP030-OVERRIDE-GO TO TRUE                    24580001
245900                 MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER         24590001
246000                 SET DP020-MSG-WARNING TO TRUE                    24600001
246100             END-IF                                               24610001
246200                                                                  24620001
246300*F23 = SML CRTN PACKED DETAIL SCREEN                              24630038
246400         WHEN DP020-FK-LOCAL-FUNC-08 (DP020-SRC-AID)              24640038
246500             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              24650048
246600                 SET ASC-GOING-TO-PCKCRTN TO TRUE                 24660050
246700                 MOVE ASC-OPER-UNT-ID TO SU009-OPER-UNT-ID        24670048
246800                 PERFORM 5075-PREPARE-SEL-QUEUE                   24680048
246900             ELSE                                                 24690042
247000                 SET DP030-OVERRIDE-GO TO TRUE                    24700048
247100                 MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER        24710048
247200                 SET DP020-MSG-WARNING TO TRUE                    24720048
247300             END-IF                                               24730042
247400                                                                  24740038
247500*F24 = STORE UNIT ADJUSTMENT DETAIL                               24750001
247600         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              24760001
247700             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              24770001
247800                 INITIALIZE SU038-INTER-APPL-COMMAREA             24780001
247900                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                24790001
248000                                 TO SU038-NUMBER-OF-SELECTED-ITEMS24800001
248100                 MOVE ASC-UNT-ADJ-TYP      TO SU038-UNT-ADJ-TYP   24810001
248200                 MOVE ASC-FAIL-SUCCESS-IND TO SU038-FAIL-SUCCSS   24820001
248300                 MOVE ASC-PROCESS-GROUP    TO SU038-PROCESS-GROUP 24830001
248400                 MOVE ASC-PROCESS-GRP-DESC TO                     24840001
248500                                           SU038-PROCESS-GRP-DESC 24850001
248600                 MOVE ASC-AUDIT-IN         TO SU038-AUDIT         24860037
248700                 MOVE ASC-FROM-DATE        TO SU038-FROM-DATE     24870001
248800                 MOVE ASC-TO-DATE          TO SU038-TO-DATE       24880001
248900                 MOVE ASC-OPER-UNT-ID      TO SU038-OPER-UNT-ID   24890001
249000                 MOVE ASC-PO-RCVR          TO SU038-PO-RCVR       24900001
249100                 MOVE ASC-LINE             TO SU038-LINE          24910001
249200                 MOVE ASC-SKU              TO SU038-SKU           24920001
249300                 MOVE ASC-UPC              TO SU038-UPC           24930001
249400                 MOVE ASC-SML-IN           TO SU038-SML           24940037
249500                 PERFORM 5000-PREPARE-SEL-QUEUE                   24950001
249600             ELSE                                                 24960001
249700                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             24970001
249800                 SET DP030-OVERRIDE-GO TO TRUE                    24980001
249900                 MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER         24990001
250000                 SET DP020-MSG-WARNING TO TRUE                    25000001
250100             END-IF                                               25010001
250200                                                                  25020001
250300*                                                                 25030001
250400* F6 - FIRST PAGE                                                 25040001
250500         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  25050001
250600             MOVE +1               TO PV-TOP-ITEM                 25060001
250700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 25070001
250800*                                                                 25080001
250900* F7 - PREVIOUS PAGE                                              25090001
251000         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   25100001
251100             PERFORM 2110-BROWSE-BACKWARD                         25110001
251200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 25120001
251300*                                                                 25130001
251400* F8 - NEXT PAGE                                                  25140001
251500         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   25150001
251600             PERFORM 2120-BROWSE-FORWARD                          25160001
251700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 25170001
251800*                                                                 25180001
251900* ENTER KEY                                                       25190001
252000         WHEN DP020-SRC-AID = DP016-ENTER                         25200001
252100             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   25210001
252200             IF  PS-ERROR                                         25220001
252300                 CONTINUE                                         25230001
252400             ELSE                                                 25240001
252500                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             25250001
252600             END-IF                                               25260001
252700                                                                  25270001
252800         WHEN OTHER                                               25280001
252900             SET DP013-NO-ROLLBACK                                25290001
253000                 DP013-XCTL-DISPLAY-RESTART                       25300001
253100                 DP013-CICS-ABEND  TO TRUE                        25310001
253200             MOVE '2100-CHECK-FUNCTION-KEY'                       25320001
253300                                   TO DP013-PARAGRAPH             25330001
253400             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      25340001
253500                                   TO DP013-MESSAGE-TEXT (1)      25350001
253600             PERFORM DP013-0000-PROCESS-ABEND                     25360001
253700     END-EVALUATE.                                                25370001
253800*                                                                 25380001
253900*----------------------------------------------------------------*25390001
254000*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *25400001
254100*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *25410001
254200*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *25420001
254300*    MESSAGE.                                                    *25430001
254400*----------------------------------------------------------------*25440001
254500 2110-BROWSE-BACKWARD.                                            25450001
254600     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    25460001
254700         GIVING PV-TOP-ITEM.                                      25470001
254800*                                                                 25480001
254900     IF  ((PV-TOP-ITEM < +1)                                      25490001
255000       OR (PV-TOP-ITEM = +1))                                     25500001
255100         MOVE +1                   TO PV-TOP-ITEM                 25510001
255200*        -- TOP OF LIST --                                        25520001
255300         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            25530001
255400         SET DP020-MSG-INFORMATIONAL TO TRUE                      25540001
255500     END-IF.                                                      25550001
255600                                                                  25560001
255700*----------------------------------------------------------------*25570001
255800*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *25580001
255900*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *25590001
256000*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *25600001
256100*----------------------------------------------------------------*25610001
256200 2120-BROWSE-FORWARD.                                             25620001
256300                                                                  25630001
256400     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              25640001
256500         GIVING PV-TOP-ITEM.                                      25650001
256600     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   25660001
256700         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             25670001
256800*        -- BOTTOM OF LIST --                                     25680001
256900         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            25690001
257000         SET DP020-MSG-INFORMATIONAL  TO TRUE                     25700001
257100     ELSE                                                         25710001
257200         COMPUTE PV-BOTTOM-ITEM =                                 25720001
257300             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 25730001
257400         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            25740001
257500*            -- BOTTOM OF LIST --                                 25750001
257600             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            25760001
257700             SET DP020-MSG-INFORMATIONAL TO TRUE                  25770001
257800         END-IF                                                   25780001
257900     END-IF.                                                      25790001
258000                                                                  25800001
258100*----------------------------------------------------------------*25810001
258200*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *25820001
258300*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *25830001
258400*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *25840001
258500*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *25850001
258600*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *25860001
258700*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *25870001
258800*----------------------------------------------------------------*25880001
258900 2130-CHECK-FOR-JUMP-BROWSE.                                      25890001
259000     SET PS-NO-ERROR               TO TRUE.                       25900001
259100     IF (ASC-START-ITEM-REQUEST = SPACE)                          25910001
259200         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             25920001
259300     ELSE                                                         25930001
259400         MOVE ASC-START-ITEM-REQUEST TO DP010I-UNEDITED-FIELD     25940001
259500         MOVE +0                     TO DP010I-MAXIMUM-DECIMALS   25950001
259600         MOVE LENGTH OF ASC-START-ITEM-REQUEST TO                 25960001
259700                                             DP010I-MAXIMUM-DIGITS25970001
259800         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  25980001
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         25991099
263968              USING DP010I-NUMERIC-EDIT-AREA                      25992099
260000                                                                  26000001
260100         IF  NOT DP010I-ERROR-DETECTED                            26010001
260200             MOVE DP010I-NUMERIC-FIELD TO ASC-START-ITEM-REQUEST-N26020001
260300             IF  ASC-START-ITEM-REQUEST-N > ZERO                  26030001
260400                 IF  ASC-START-ITEM-REQUEST-N >                   26040001
260500                                          ASC-NUMBER-OF-ITEMS-READ26050001
260600                     MOVE SPACE TO ASC-START-ITEM-REQUEST         26060001
260700                     COMPUTE PV-TOP-ITEM =                        26070001
260800                             ASC-NUMBER-OF-ITEMS-READ             26080001
260900                             - PC-ITEMS-PER-PANEL + 1             26090001
261000                     IF  PV-TOP-ITEM < +1                         26100001
261100                         MOVE +1   TO PV-TOP-ITEM                 26110001
261200                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 26120001
261300                         SET DP020-MSG-INFORMATIONAL TO TRUE      26130001
261400                     ELSE                                         26140001
261500                         MOVE  PV-TOP-ITEM                        26150001
261600                           TO  ASC-START-ITEM-REQUEST-N           26160001
261700                     END-IF                                       26170001
261800                 ELSE                                             26180001
261900                     MOVE ASC-START-ITEM-REQUEST-N TO PV-TOP-ITEM 26190001
262000                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      26200001
262100                     COMPUTE PV-BOTTOM-ITEM =                     26210001
262200                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     26220001
262300                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ26230001
262400                         SUBTRACT  PV-TOP-ITEM                    26240001
262500                             FROM  ASC-NUMBER-OF-ITEMS-READ       26250001
262600                           GIVING  ASC-ITEMS-DISPLAYED            26260001
262700                         MOVE  ASC-NUMBER-OF-ITEMS-READ           26270001
262800                           TO  PV-BOTTOM-ITEM                     26280001
262900*                        -- BOTTOM OF LIST --                     26290001
263000                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 26300001
263100                         SET DP020-MSG-INFORMATIONAL TO TRUE      26310001
263200                     END-IF                                       26320001
263300                 END-IF                                           26330001
263400             ELSE                                                 26340001
263500*                --- VALUE OUT OF RANGE ----                      26350001
263600                 MOVE PC-TSYMSG-00101  TO DP020-MSG-NUMBER        26360001
263700                 MOVE -1           TO ASTRTITL                    26370001
263800                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              26380001
263900                 MOVE DP015-REVERSE TO ASTRTITH                   26390001
264000                 MOVE DP015-RED    TO ASTRTITC                    26400001
264100                 MOVE DP015-UNP-NUM-BRT-MDT TO ASTRTITA           26410001
264200                 SET DP020-MSG-FATAL                              26420001
264300                     PS-ERROR        TO TRUE                      26430001
264400             END-IF                                               26440001
264500         ELSE                                                     26450001
264600             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            26460001
264700             MOVE -1               TO ASTRTITL                    26470001
264800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  26480001
264900             MOVE DP015-REVERSE    TO ASTRTITH                    26490001
265000             MOVE DP015-RED        TO ASTRTITC                    26500001
265100             MOVE DP015-UNP-NUM-BRT-MDT TO ASTRTITA               26510001
265200             SET DP020-MSG-FATAL   TO TRUE                        26520001
265300             SET PS-ERROR          TO TRUE                        26530001
265400         END-IF                                                   26540001
265500     END-IF.                                                      26550001
265600                                                                  26560001
265700*----------------------------------------------------------------*26570001
265800*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *26580001
265900*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *26590001
266000*----------------------------------------------------------------*26600001
266100 2140-DESELECT-ALL-ITEMS.                                         26610001
266200     MOVE +1                       TO ASC-BLK-SUB.                26620001
266300                                                                  26630001
266400     PERFORM 2141-CLEAR-SELECTED-INDS                             26640001
266500         VARYING ASC-ITEM-SUB                                     26650001
266600         FROM 1 BY 1                                              26660001
266700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 26670001
266800                                                                  26680001
266900     ADD +1                        TO ASC-BLK-SUB.                26690001
267000                                                                  26700001
267100     PERFORM 2141-CLEAR-SELECTED-INDS                             26710001
267200         VARYING ASC-ITEM-SUB                                     26720001
267300         FROM 1 BY 1                                              26730001
267400         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 26740001
267500                                                                  26750001
267600     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               26760001
267700                                   TO PV-LIST-ITEM-NUMBER.        26770001
267800                                                                  26780001
267900     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            26790001
268000         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    26800001
268100                                                                  26810001
268200     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     26820001
268300        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      26830001
268400         MOVE +1                   TO ASC-BLK-SUB                 26840001
268500                                                                  26850001
268600         PERFORM 5100-WRITE-TEMP-STORAGE                          26860001
268700         MOVE +2                   TO ASC-BLK-SUB                 26870015
268800         PERFORM 5100-WRITE-TEMP-STORAGE                          26880015
268900         MOVE +1                   TO ASC-BLK-SUB                 26890015
269000                                                                  26900001
269100         MOVE +1                   TO PV-BLOCK-NUMBER             26910001
269200                                                                  26920001
269300         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         26930001
269400             PV-FIRST-BLOCK-IN-ARRAY - 1                          26940001
269500                                                                  26950001
269600         PERFORM                                                  26960001
269700             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       26970001
269800                                                                  26980001
269900             PERFORM 4410-READ-TEMP-STORAGE                       26990001
270000                                                                  27000001
270100             PERFORM 2141-CLEAR-SELECTED-INDS                     27010001
270200                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 27020001
270300                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          27030001
270400                                                                  27040001
270500             PERFORM 5100-WRITE-TEMP-STORAGE                      27050001
270600                                                                  27060001
270700             ADD +1                TO PV-BLOCK-NUMBER             27070001
270800                                                                  27080001
270900         END-PERFORM                                              27090001
271000                                                                  27100001
271100         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         27110001
271200             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     27120001
271300                                                                  27130001
271400         PERFORM                                                  27140001
271500             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       27150001
271600                   ASC-HIGHEST-BLOCK-WRITTEN                      27160001
271700                                                                  27170001
271800             MOVE PV-NEXT-BLOCK-IN-ARRAY                          27180001
271900                                   TO PV-BLOCK-NUMBER             27190001
272000                                                                  27200001
272100             PERFORM 4410-READ-TEMP-STORAGE                       27210001
272200                                                                  27220001
272300             PERFORM 2141-CLEAR-SELECTED-INDS                     27230001
272400                 VARYING ASC-ITEM-SUB                             27240001
272500                 FROM 1 BY 1                                      27250001
272600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          27260001
272700                                                                  27270001
272800             PERFORM 5100-WRITE-TEMP-STORAGE                      27280001
272900                                                                  27290001
273000             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      27300001
273100                                                                  27310001
273200         END-PERFORM                                              27320001
273300                                                                  27330001
273400         MOVE PV-FIRST-BLOCK-IN-ARRAY                             27340001
273500                                   TO PV-BLOCK-NUMBER             27350001
273600                                                                  27360001
273700         PERFORM 4410-READ-TEMP-STORAGE                           27370001
273800     END-IF.                                                      27380001
273900                                                                  27390001
274000                                                                  27400001
274100     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 27410001
274200     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.27420001
274300     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  27430001
274400                                                                  27440001
274500     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        27450001
274600                                                                  27460001
274700*----------------------------------------------------------------*27470001
274800*    MARK EACH ITEM AS BEING NOT SELECTED.                       *27480001
274900*----------------------------------------------------------------*27490001
275000                                                                  27500001
275100 2141-CLEAR-SELECTED-INDS.                                        27510001
275200                                                                  27520001
275300     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           27530001
275400             NOT EQUAL ZERO                                       27540001
275500         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          27550001
275600             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          27560001
275700                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    27570001
275800                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  27580001
275900                                   TO TRUE                        27590001
276000         END-IF                                                   27600001
276100     END-IF.                                                      27610001
276200                                                                  27620001
276300*----------------------------------------------------------------*27630001
276400*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *27640001
276500*  FOR ALL ITEMS.                                                *27650001
276600*----------------------------------------------------------------*27660001
276700 2150-SELECT-ALL-ITEMS.                                           27670001
276800                                                                  27680001
276900     MOVE +1                       TO ASC-BLK-SUB.                27690001
277000                                                                  27700001
277100     PERFORM 2151-SET-SELECTED-INDS                               27710001
277200         VARYING ASC-ITEM-SUB                                     27720001
277300         FROM 1 BY 1                                              27730001
277400         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 27740001
277500                                                                  27750001
277600     ADD +1                        TO ASC-BLK-SUB.                27760001
277700                                                                  27770001
277800     PERFORM 2151-SET-SELECTED-INDS                               27780001
277900         VARYING ASC-ITEM-SUB                                     27790001
278000         FROM 1 BY 1                                              27800001
278100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 27810001
278200                                                                  27820001
278300     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               27830001
278400                                   TO PV-LIST-ITEM-NUMBER.        27840001
278500                                                                  27850001
278600     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            27860001
278700         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    27870001
278800                                                                  27880001
278900*                                                                 27890015
279000     IF  PV-FIRST-BLOCK-IN-ARRAY  = +1                            27900015
279100         MOVE +1                   TO ASC-BLK-SUB                 27910015
279200                                                                  27920015
279300         PERFORM 5100-WRITE-TEMP-STORAGE                          27930015
279400         MOVE +2                   TO ASC-BLK-SUB                 27940015
279500         PERFORM 5100-WRITE-TEMP-STORAGE                          27950015
279600         MOVE +1                   TO ASC-BLK-SUB                 27960015
279700         MOVE +1                   TO PV-BLOCK-NUMBER             27970015
279800     END-IF.                                                      27980015
279900*                                                                 27990015
280000                                                                  28000015
280100     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     28010001
280200        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    28020001
280300         MOVE +1                   TO ASC-BLK-SUB                 28030001
280400                                                                  28040001
280500         PERFORM 5100-WRITE-TEMP-STORAGE                          28050001
280600         MOVE +2                   TO ASC-BLK-SUB                 28060015
280700         PERFORM 5100-WRITE-TEMP-STORAGE                          28070015
280800         MOVE +1                   TO ASC-BLK-SUB                 28080015
280900         MOVE +1                   TO PV-BLOCK-NUMBER             28090001
281000                                                                  28100001
281100         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         28110001
281200             PV-FIRST-BLOCK-IN-ARRAY - 1                          28120001
281300                                                                  28130001
281400         PERFORM                                                  28140001
281500             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       28150001
281600                                                                  28160001
281700             PERFORM 4410-READ-TEMP-STORAGE                       28170001
281800                                                                  28180001
281900             PERFORM 2151-SET-SELECTED-INDS                       28190001
282000                 VARYING ASC-ITEM-SUB                             28200001
282100                 FROM 1 BY 1                                      28210001
282200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          28220001
282300                                                                  28230001
282400             PERFORM 5100-WRITE-TEMP-STORAGE                      28240001
282500                                                                  28250001
282600             ADD +1                TO PV-BLOCK-NUMBER             28260001
282700                                                                  28270001
282800         END-PERFORM                                              28280001
282900                                                                  28290001
283000         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         28300001
283100             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     28310001
283200                                                                  28320001
283300         PERFORM                                                  28330001
283400             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       28340001
283500                   ASC-HIGHEST-BLOCK-WRITTEN                      28350001
283600                                                                  28360001
283700             MOVE PV-NEXT-BLOCK-IN-ARRAY                          28370001
283800                                   TO PV-BLOCK-NUMBER             28380001
283900                                                                  28390001
284000             PERFORM 4410-READ-TEMP-STORAGE                       28400001
284100                                                                  28410001
284200             PERFORM 2151-SET-SELECTED-INDS                       28420001
284300                 VARYING ASC-ITEM-SUB                             28430001
284400                 FROM 1 BY 1                                      28440001
284500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          28450001
284600                                                                  28460001
284700             PERFORM 5100-WRITE-TEMP-STORAGE                      28470001
284800                                                                  28480001
284900             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      28490001
285000                                                                  28500001
285100         END-PERFORM                                              28510001
285200                                                                  28520001
285300         MOVE PV-FIRST-BLOCK-IN-ARRAY                             28530001
285400                                   TO PV-BLOCK-NUMBER             28540001
285500                                                                  28550001
285600         PERFORM 4410-READ-TEMP-STORAGE                           28560001
285700     END-IF.                                                      28570001
285800                                                                  28580001
285900                                                                  28590001
286000     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             28600001
286100                       ASC-NUMBER-OF-SELECTED-ITEMS.              28610001
286200                                                                  28620001
286300     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        28630001
286400                                                                  28640001
286500*----------------------------------------------------------------*28650001
286600*    MARK EACH ITEM AS BEING SELECTED.                           *28660001
286700*----------------------------------------------------------------*28670001
286800                                                                  28680001
286900 2151-SET-SELECTED-INDS.                                          28690001
287000                                                                  28700001
287100     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           28710001
287200             NOT EQUAL ZERO                                       28720001
287300         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             28730001
287400             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             28740001
287500                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        28750001
287600                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  28760001
287700                               TO  TRUE                           28770001
287800         END-IF                                                   28780001
287900     END-IF.                                                      28790001
288000******************************************************************28800001
288100** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **28810001
288200** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **28820001
288300******************************************************************28830001
288400 2200-MOVE-SCREEN-TO-COMMAREA.                                    28840001
288500                                                                  28850001
288600     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             28860001
288700     MOVE +1                       TO PV-SUB.                     28870001
288800*                                                                 28880001
288900     PERFORM 3100-SET-SUBSCRIPTS.                                 28890001
289000     IF  ASTRTITL > ZERO                                          28900001
289100         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          28910001
289200     ELSE                                                         28920001
289300         IF  ASTRTITF = DP015-ERASE-EOF                           28930001
289400             INITIALIZE ASC-START-ITEM-REQUEST                    28940001
289500         END-IF                                                   28950001
289600     END-IF.                                                      28960001
289700                                                                  28970001
289800     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          28980001
289900         VARYING PV-SUB                                           28990001
290000         FROM 1 BY 1                                              29000001
290100         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      29010001
290200******************************************************************29020001
290300** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**29030001
290400******************************************************************29040001
290500 2210-MOVE-LINES-TO-COMMAREA.                                     29050001
290600     IF  MR-SELECTL (PV-SUB) > ZERO                               29060001
290700         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             29070001
290800         MOVE MR-SELECTI (PV-SUB)                                 29080001
290900                                   TO ASC-TEMP-SELECTED-SW        29090001
291000                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      29100001
291100     ELSE                                                         29110001
291200         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                29120001
291300                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     29130001
291400                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        29140001
291500                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      29150001
291600         END-IF                                                   29160001
291700     END-IF.                                                      29170001
291800                                                                  29180001
291900     ADD +1                        TO ASC-ITEM-SUB.               29190001
292000                                                                  29200001
292100     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        29210001
292200         IF  ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     29220001
292300             COMPUTE PV-BLOCK-NUMBER  =                           29230001
292400                1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /         29240001
292500                    PC-ITEMS-PER-PANEL                            29250001
292600             PERFORM 5105-REWRITE-ASC-LISTQ                       29260001
292700         END-IF                                                   29270001
292800         ADD +1                    TO ASC-BLK-SUB                 29280001
292900         MOVE +1                   TO ASC-ITEM-SUB                29290001
293000     ELSE                                                         29300001
293100     IF  PV-SUB = ASC-ITEMS-DISPLAYED                             29310001
293200         IF  ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     29320001
293300             COMPUTE PV-BLOCK-NUMBER  =                           29330001
293400                1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /         29340001
293500                    PC-ITEMS-PER-PANEL                            29350001
293600             PERFORM 5105-REWRITE-ASC-LISTQ                       29360001
293700         END-IF                                                   29370001
293800     END-IF.                                                      29380001
293900******************************************************************29390001
294000** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **29400001
294100** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **29410001
294200******************************************************************29420001
294300 3000-EDIT-DATA-IN-COMMAREA.                                      29430001
294400     SET PS-NO-ERROR               TO TRUE.                       29440001
294500     PERFORM 3200-RESET-ATTRIBUTES.                               29450001
294600     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     29460001
294700                                                                  29470001
294800**                                                                29480001
294900* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              29490001
295000* EDITTING IS DONE FROM THE BOTTOM UP.                            29500001
295100**                                                                29510001
295200     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       29520001
295300         ASC-ITEMS-DISPLAYED - 1.                                 29530001
295400     PERFORM 3100-SET-SUBSCRIPTS.                                 29540001
295500*                                                                 29550001
295600     IF  PS-NO-ERROR                                              29560001
295700         PERFORM 3005-EDIT-COMMAREA-BLOCKS                        29570001
295800     END-IF.                                                      29580001
295900                                                                  29590001
296000     IF  PS-NO-ERROR                                              29600001
296100         PERFORM 3400-CHECK-RANGE-SEQUENCE                        29610001
296200     END-IF.                                                      29620001
296300*                                                                 29630001
296400     IF  ((PS-NO-ERROR)                                           29640001
296500       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   29650001
296600       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    29660001
296700             PERFORM 3500-MARK-RANGE-AS-SELECTED                  29670001
296800     END-IF.                                                      29680001
296900                                                                  29690001
297000*----------------------------------------------------------------*29700001
297100*   3005-EDIT-COMMAREA-BLOCKS                                    *29710001
297200*----------------------------------------------------------------*29720001
297300 3005-EDIT-COMMAREA-BLOCKS.                                       29730001
297400     MOVE +1                       TO PV-BLOCK-NUMBER.            29740001
297500     MOVE +1                       TO ASC-BLK-SUB.                29750001
297600     MOVE PC-ITEMS-PER-PANEL       TO ASC-ITEM-SUB.               29760001
297700                                                                  29770001
297800     COMPUTE PV-BLOCK-NUMBER  =                                   29780001
297900        1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /                 29790001
298000            PC-ITEMS-PER-PANEL.                                   29800001
298100                                                                  29810001
298200     MOVE  PV-BLOCK-NUMBER         TO PV-ORIGINAL-BLOCK.          29820001
298300                                                                  29830001
298400     PERFORM                                                      29840001
298500       UNTIL PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN          29850001
298600          OR PS-ERROR                                             29860001
298700          OR PS-BLOCK-ERROR                                       29870001
298800                                                                  29880001
298900             COMPUTE PV-ITEMS-HOLD  =                             29890001
299000                     ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +        29900001
299100                     PC-ITEMS-PER-PANEL - 1                       29910001
299200                                                                  29920001
299300             IF  PV-ITEMS-HOLD  >  ASC-NUMBER-OF-ITEMS-READ       29930001
299400                 SUBTRACT  ASC-NUMBER-OF-ITEMS-READ               29940001
299500                     FROM  PV-ITEMS-HOLD                          29950001
299600                   GIVING  PV-ITEMS-DIFF                          29960001
299700                 SUBTRACT  PV-ITEMS-DIFF                          29970001
299800                     FROM  PC-ITEMS-PER-PANEL                     29980001
299900                   GIVING  PV-ITEMS-HOLD                          29990001
300000                     MOVE  PV-ITEMS-HOLD  TO  PV-SUB              30000001
300100                                              ASC-ITEM-SUB        30010001
300200                                              ASC-ITEMS-DISPLAYED 30020001
300300             ELSE                                                 30030001
300400                 MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB              30040001
300500                 MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB        30050001
300600             END-IF                                               30060001
300700                                                                  30070001
300800             PERFORM 3300-EDIT-SELECTIONS                         30080001
300900                     VARYING PV-SUB                               30090001
301000                        FROM PV-SUB BY -1                         30100001
301100                       UNTIL PV-SUB < +1                          30110001
301200                                                                  30120001
301300             MOVE +1               TO ASC-BLK-SUB                 30130001
301400                                                                  30140001
301500             PERFORM 5105-REWRITE-ASC-LISTQ                       30150001
301600                                                                  30160001
301700             MOVE +1                TO ASC-BLK-SUB                30170001
301800                                                                  30180001
301900             IF  PS-BLOCK-ERROR                                   30190001
302000                 SET  PS-ERROR     TO TRUE                        30200001
302100                 MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)        30210001
302200                                   TO PV-TOP-ITEM                 30220001
302300             ELSE                                                 30230001
302400                 ADD  +1           TO PV-BLOCK-NUMBER             30240001
302500                 IF  PV-BLOCK-NUMBER >                            30250001
302600                     ASC-HIGHEST-BLOCK-WRITTEN                    30260001
302700                     MOVE +2       TO ASC-BLK-SUB                 30270001
302800                     PERFORM 4410-READ-TEMP-STORAGE               30280001
302900                     MOVE +1       TO ASC-BLK-SUB                 30290001
303000                 ELSE                                             30300001
303100                     PERFORM 4410-READ-TEMP-STORAGE               30310001
303200                     ADD  +1        TO PV-BLOCK-NUMBER            30320001
303300                     MOVE +2        TO ASC-BLK-SUB                30330001
303400                     PERFORM 4410-READ-TEMP-STORAGE               30340001
303500                     SUBTRACT +1  FROM PV-BLOCK-NUMBER            30350001
303600                     MOVE +1        TO ASC-BLK-SUB                30360001
303700                 END-IF                                           30370001
303800             END-IF                                               30380001
303900     END-PERFORM.                                                 30390001
304000                                                                  30400001
304100     IF  PV-ORIGINAL-BLOCK  = +1    OR                            30410001
304200         PS-ERROR                   OR                            30420001
304300         PS-BLOCK-ERROR                                           30430001
304400         CONTINUE                                                 30440001
304500     ELSE                                                         30450001
304600         MOVE +1                 TO PV-BLOCK-NUMBER               30460001
304700         MOVE +1                 TO ASC-BLK-SUB                   30470001
304800         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  30480001
304900         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEMS-DISPLAYED           30490001
305000         PERFORM 4410-READ-TEMP-STORAGE                           30500001
305100                                                                  30510001
305200         PERFORM                                                  30520001
305300           UNTIL PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK              30530001
305400              OR PS-ERROR                                         30540001
305500              OR PS-BLOCK-ERROR                                   30550001
305600                                                                  30560001
305700                 COMPUTE PV-ITEMS-HOLD  =                         30570001
305800                         ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +    30580001
305900                         PC-ITEMS-PER-PANEL - 1                   30590001
306000                                                                  30600001
306100                 IF  PV-ITEMS-HOLD > ASC-NUMBER-OF-ITEMS-READ     30610001
306200                     SUBTRACT  ASC-NUMBER-OF-ITEMS-READ           30620001
306300                         FROM  PV-ITEMS-HOLD                      30630001
306400                       GIVING  PV-ITEMS-DIFF                      30640001
306500                     SUBTRACT  PV-ITEMS-DIFF                      30650001
306600                         FROM  PC-ITEMS-PER-PANEL                 30660001
306700                       GIVING  PV-ITEMS-HOLD                      30670001
306800                         MOVE  PV-ITEMS-HOLD TO PV-SUB            30680001
306900                                                ASC-ITEM-SUB      30690001
307000                                               ASC-ITEMS-DISPLAYED30700001
307100                 ELSE                                             30710001
307200                     MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB          30720001
307300                     MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB    30730001
307400                 END-IF                                           30740001
307500                                                                  30750001
307600                 PERFORM 3300-EDIT-SELECTIONS                     30760001
307700                         VARYING PV-SUB                           30770001
307800                            FROM PV-SUB BY -1                     30780001
307900                           UNTIL PV-SUB < +1                      30790001
308000                                                                  30800001
308100                 MOVE +1               TO ASC-BLK-SUB             30810001
308200                                                                  30820001
308300                 PERFORM 5105-REWRITE-ASC-LISTQ                   30830001
308400                                                                  30840001
308500                 MOVE +1                TO ASC-BLK-SUB            30850001
308600                                                                  30860001
308700                 IF  PS-BLOCK-ERROR                               30870001
308800                     SET  PS-ERROR     TO TRUE                    30880001
308900                     MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)    30890001
309000                                       TO PV-TOP-ITEM             30900001
309100                 ELSE                                             30910001
309200                     ADD  +1            TO PV-BLOCK-NUMBER        30920001
309300                     IF  PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK      30930001
309400                         MOVE +2        TO ASC-BLK-SUB            30940001
309500                         PERFORM 4410-READ-TEMP-STORAGE           30950001
309600                         MOVE +1        TO ASC-BLK-SUB            30960001
309700                     ELSE                                         30970001
309800                         PERFORM 4410-READ-TEMP-STORAGE           30980001
309900                         ADD  +1        TO PV-BLOCK-NUMBER        30990001
310000                         MOVE +2        TO ASC-BLK-SUB            31000001
310100                         PERFORM 4410-READ-TEMP-STORAGE           31010001
310200                         SUBTRACT +1  FROM PV-BLOCK-NUMBER        31020001
310300                         MOVE +1        TO ASC-BLK-SUB            31030001
310400                     END-IF                                       31040001
310500                 END-IF                                           31050001
310600     END-PERFORM.                                                 31060001
310700                                                                  31070001
310800*----------------------------------------------------------------*31080001
310900*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *31090001
311000*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*31100001
311100*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *31110001
311200*                                                                *31120001
311300*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *31130001
311400*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *31140001
311500*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *31150001
311600*    US IN THE 2ND BLOCK OF THE ARRAY.                           *31160001
311700*----------------------------------------------------------------*31170001
311800 3100-SET-SUBSCRIPTS.                                             31180001
311900                                                                  31190001
312000     COMPUTE ASC-ITEM-SUB =                                       31200001
312100         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        31210001
312200                                                                  31220001
312300     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         31230001
312400         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            31240001
312500         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               31250001
312600     ELSE                                                         31260001
312700         MOVE +1                     TO ASC-BLK-SUB               31270001
312800     END-IF.                                                      31280001
312900******************************************************************31290001
313000** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **31300001
313100******************************************************************31310001
313200 3200-RESET-ATTRIBUTES.                                           31320001
313300     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   31330001
313400     MOVE DP015-GREEN              TO ASTRTITC.                   31340001
313500     MOVE DP015-UNDERLINE          TO ASTRTITH.                   31350001
313600                                                                  31360001
313700     PERFORM                                                      31370001
313800         VARYING PV-SUB                                           31380001
313900         FROM 1 BY 1                                              31390001
314000         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        31400001
314100         MOVE DP015-UNP-ALP-NOR-OFF                               31410001
314200                                   TO MR-SELECTA (PV-SUB)         31420001
314300         MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)         31430001
314400         MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)         31440001
314500     END-PERFORM.                                                 31450001
314600                                                                  31460001
314700******************************************************************31470001
314800** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **31480001
314900** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **31490001
315000** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **31500001
315100** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **31510001
315200******************************************************************31520001
315300 3300-EDIT-SELECTIONS.                                            31530001
315400     EVALUATE TRUE                                                31540001
315500         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     31550001
315600             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         31560001
315700                 CONTINUE                                         31570001
315800         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         31580001
315900             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        31590001
316000                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   31600001
316100                 MOVE ASC-TEMP-SELECTED-SW                        31610001
316200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  31620001
316300                                TO ASC-SELECTED-SW                31630001
316400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  31640001
316500             END-IF                                               31650001
316600         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     31660001
316700                 = SPACE                                          31670001
316800             EVALUATE TRUE                                        31680001
316900                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       31690001
317000                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS31700001
317100                     MOVE SPACE TO ASC-SELECTED-SW                31710001
317200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  31720001
317300                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        31730001
317400                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    31740001
317500                     MOVE SPACE TO ASC-SELECTED-SW                31750001
317600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  31760001
317700                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          31770001
317800                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      31780001
317900                     MOVE SPACE TO ASC-SELECTED-SW                31790001
318000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  31800001
318100             END-EVALUATE                                         31810001
318200         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           31820001
318300             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            31830001
318400                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    31840001
318500             END-IF                                               31850001
318600             PERFORM 3310-EDIT-RANGE                              31860001
318700         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             31870001
318800             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            31880001
318900                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    31890001
319000             END-IF                                               31900001
319100             PERFORM 3310-EDIT-RANGE                              31910001
319200         WHEN OTHER                                               31920001
319300             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           31930001
319400             SET DP020-MSG-FATAL    TO TRUE                       31940001
319500             MOVE -1                TO MR-SELECTL (PV-SUB)        31950001
319600             SET DP030-SET-CURSOR-APPL-1  TO TRUE                 31960001
319700             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        31970001
319800             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        31980001
319900             SET PS-ERROR TO TRUE                                 31990001
320000             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            32000001
320100                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     32010001
320200                 MOVE SPACE         TO ASC-SELECTED-SW            32020001
320300                                        (ASC-BLK-SUB ASC-ITEM-SUB)32030001
320400             END-IF                                               32040001
320500     END-EVALUATE.                                                32050001
320600                                                                  32060001
320700     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 32070001
320800     SUBTRACT +1 FROM ASC-ITEM-SUB.                               32080001
320900     IF  ASC-ITEM-SUB < 1                                         32090001
321000         SUBTRACT +1 FROM ASC-BLK-SUB                             32100001
321100         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                32110001
321200     END-IF.                                                      32120001
321300                                                                  32130001
321400******************************************************************32140001
321500** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **32150001
321600** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **32160001
321700** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**32170001
321800** THE ENDING.                                                  **32180001
321900******************************************************************32190001
322000 3310-EDIT-RANGE.                                                 32200001
322100     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                32210001
322200         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   32220001
322300             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)32230001
322400                                   TO ASC-SELECTED-SW             32240001
322500                                        (ASC-BLK-SUB ASC-ITEM-SUB)32250001
322600             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 32260001
322700         ELSE                                                     32270001
322800             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     32280001
322900                 CONTINUE                                         32290001
323000             ELSE                                                 32300001
323100*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        32310001
323200                 MOVE PC-TSYMSG-00054                             32320001
323300                                       TO DP020-MSG-NUMBER        32330001
323400                 MOVE -1               TO ASTRTITL                32340001
323500                 SET DP020-MSG-FATAL                              32350001
323600                     DP030-SET-CURSOR-APPL-1                      32360001
323700                     PS-ERROR          TO TRUE                    32370001
323800             END-IF                                               32380001
323900         END-IF                                                   32390001
324000     ELSE                                                         32400001
324100         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     32410001
324200             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 32420001
324300                                   TO ASC-SELECTED-SW             32430001
324400                                     (ASC-BLK-SUB ASC-ITEM-SUB)   32440001
324500             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   32450001
324600         ELSE                                                     32460001
324700             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       32470001
324800                 CONTINUE                                         32480001
324900             ELSE                                                 32490001
325000*                -- ONLY ONE END-OF-RANGE ALLOWED --              32500001
325100                 MOVE PC-TSYMSG-00055                             32510001
325200                                        TO DP020-MSG-NUMBER       32520001
325300                 MOVE -1                TO ASTRTITL               32530001
325400                 SET DP020-MSG-FATAL                              32540001
325500                     DP030-SET-CURSOR-APPL-1                      32550001
325600                     PS-ERROR           TO TRUE                   32560001
325700             END-IF                                               32570001
325800         END-IF                                                   32580001
325900     END-IF.                                                      32590001
326000*                                                                 32600001
326100******************************************************************32610001
326200** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **32620001
326300** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **32630001
326400******************************************************************32640001
326500 3400-CHECK-RANGE-SEQUENCE.                                       32650001
326600     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       32660001
326700       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      32670001
326800       AND  ASC-START-OF-SELECTED-RANGE >                         32680001
326900                                         ASC-END-OF-SELECTED-RANGE32690001
327000*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                32700001
327100         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 32710001
327200         SET DP020-MSG-FATAL TO TRUE                              32720001
327300         SET PS-ERROR TO TRUE                                     32730001
327400         PERFORM 3410-POSITION-AT-ERROR                           32740001
327500     END-IF.                                                      32750001
327600******************************************************************32760001
327700** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **32770001
327800** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **32780001
327900** SHOULD BE POSITIONED ON A RANGE ERROR.                       **32790001
328000******************************************************************32800001
328100 3410-POSITION-AT-ERROR.                                          32810001
328200     SET DP030-SET-CURSOR-APPL-1                                  32820001
328300                                   TO TRUE.                       32830001
328400     MOVE -1                       TO ASTRTITL                    32840001
328500     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 32850001
328600                    - PV-TOP-ITEM + 1.                            32860001
328700     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      32870001
328800         CONTINUE                                                 32880001
328900     END-IF.                                                      32890001
329000*                                                                 32900001
329100     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   32910001
329200                    - PV-TOP-ITEM + 1.                            32920001
329300     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      32930001
329400         CONTINUE                                                 32940001
329500     END-IF.                                                      32950001
329600                                                                  32960001
329700*----------------------------------------------------------------*32970001
329800*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *32980001
329900*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *32990001
330000*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *33000001
330100*----------------------------------------------------------------*33010001
330200 3500-MARK-RANGE-AS-SELECTED.                                     33020001
330300     MOVE +1                       TO  ASC-BLK-SUB.               33030001
330400     PERFORM 3510-MARK-SELECTED-INDS                              33040001
330500         VARYING ASC-ITEM-SUB                                     33050001
330600         FROM 1 BY 1                                              33060001
330700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 33070001
330800                                                                  33080001
330900     ADD +1                        TO ASC-BLK-SUB.                33090001
331000     PERFORM 3510-MARK-SELECTED-INDS                              33100001
331100         VARYING ASC-ITEM-SUB                                     33110001
331200         FROM 1 BY 1                                              33120001
331300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 33130001
331400                                                                  33140001
331500     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               33150001
331600                                   TO  PV-LIST-ITEM-NUMBER.       33160001
331700     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            33170001
331800         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         33180001
331900               PC-ITEMS-PER-PANEL).                               33190001
332000                                                                  33200001
332100     MOVE ASC-START-OF-SELECTED-RANGE                             33210001
332200                                   TO PV-START-OF-SELECTED-RANGE. 33220001
332300     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            33230001
332400         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  33240001
332500               PC-ITEMS-PER-PANEL).                               33250001
332600                                                                  33260001
332700     MOVE ASC-END-OF-SELECTED-RANGE                               33270001
332800                                   TO  PV-END-OF-SELECTED-RANGE.  33280001
332900     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             33290001
333000         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    33300001
333100               PC-ITEMS-PER-PANEL).                               33310001
333200     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             33320001
333300         PV-FIRST-BLOCK-IN-ARRAY + 1.                             33330001
333400                                                                  33340001
333500     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    33350001
333600        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        33360001
333700         MOVE +1                   TO ASC-BLK-SUB                 33370001
333800         PERFORM 5100-WRITE-TEMP-STORAGE                          33380001
333900         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         33390001
334000             PV-FIRST-BLOCK-IN-ARRAY - 1                          33400001
334100                                                                  33410001
334200         PERFORM                                                  33420001
334300             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      33430001
334400                   PV-PREV-BLOCK-IN-ARRAY                         33440001
334500             MOVE PV-FIRST-BLOCK-IN-RANGE                         33450001
334600                                   TO PV-BLOCK-NUMBER             33460001
334700             PERFORM 4410-READ-TEMP-STORAGE                       33470001
334800             PERFORM 3510-MARK-SELECTED-INDS                      33480001
334900                 VARYING ASC-ITEM-SUB                             33490001
335000                 FROM 1 BY 1                                      33500001
335100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          33510001
335200             PERFORM 5100-WRITE-TEMP-STORAGE                      33520001
335300             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     33530001
335400         END-PERFORM                                              33540001
335500                                                                  33550001
335600         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         33560001
335700             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     33570001
335800         PERFORM                                                  33580001
335900             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       33590001
336000                   PV-LAST-BLOCK-IN-RANGE                         33600001
336100             MOVE PV-NEXT-BLOCK-IN-ARRAY                          33610001
336200                                   TO PV-BLOCK-NUMBER             33620001
336300             PERFORM 4410-READ-TEMP-STORAGE                       33630001
336400             PERFORM 3510-MARK-SELECTED-INDS                      33640001
336500                 VARYING ASC-ITEM-SUB                             33650001
336600                 FROM 1 BY 1                                      33660001
336700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          33670001
336800             PERFORM 5100-WRITE-TEMP-STORAGE                      33680001
336900             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      33690001
337000         END-PERFORM                                              33700001
337100                                                                  33710001
337200         MOVE PV-FIRST-BLOCK-IN-ARRAY                             33720001
337300                                   TO PV-BLOCK-NUMBER             33730001
337400         PERFORM 4410-READ-TEMP-STORAGE                           33740001
337500     END-IF.                                                      33750001
337600                                                                  33760001
337700     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 33770001
337800                                      ASC-END-OF-SELECTED-RANGE.  33780001
337900                                                                  33790001
338000*----------------------------------------------------------------*33800001
338100* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *33810001
338200*----------------------------------------------------------------*33820001
338300 3510-MARK-SELECTED-INDS.                                         33830001
338400                                                                  33840001
338500     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         33850001
338600                                ASC-ITEM-SUB) >                   33860001
338700         ASC-START-OF-SELECTED-RANGE)                             33870001
338800     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         33880001
338900                                ASC-ITEM-SUB) =                   33890001
339000         ASC-START-OF-SELECTED-RANGE)                             33900001
339100                                                                  33910001
339200         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     33920001
339300                                    ASC-ITEM-SUB) <               33930001
339400             ASC-END-OF-SELECTED-RANGE)                           33940001
339500         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     33950001
339600                                    ASC-ITEM-SUB) =               33960001
339700             ASC-END-OF-SELECTED-RANGE)                           33970001
339800                                                                  33980001
339900             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          33990001
340000                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   34000001
340100                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   34010001
340200                               TO TRUE                            34020001
340300                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              34030001
340400                               TO TRUE                            34040001
340500                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    34050001
340600             END-IF                                               34060001
340700         END-IF                                                   34070001
340800     END-IF.                                                      34080001
340900                                                                  34090001
341000*----------------------------------------------------------------*34100001
341100*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *34110001
341200*    INITIALIZE ALL COUNTERS AND FLAGS.                          *34120001
341300*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *34130001
341400*    DISPLAY THE PANEL TO USER.                                  *34140001
341500*----------------------------------------------------------------*34150001
341600 4000-BUILD-INITIAL-PANEL.                                        34160001
341700                                                                  34170001
341800     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            34180001
341900                                 ASC-BLOCK-ENTRIES (2).           34190001
342000     MOVE +1                 TO ASC-BLK-SUB.                      34200001
342100     SET ASC-ITEMS-LEFT-ON-DB  TO TRUE.                           34210001
342200                                                                  34220001
342300     MOVE +0                 TO ASC-ITEM-SUB                      34230001
342400                                ASC-NUMBER-OF-ITEMS-READ          34240001
342500                                ASC-NUMBER-OF-SELECTED-ITEMS      34250001
342600                                ASC-HIGHEST-BLOCK-WRITTEN         34260001
342700                                ASC-START-OF-SELECTED-RANGE       34270001
342800                                ASC-END-OF-SELECTED-RANGE         34280001
342900                                ASC-ITEM-AT-TOP-OF-PANEL.         34290001
343000                                                                  34300001
343100                                                                  34310001
343200     SET PS-FIRST-TIME-AUDIT TO TRUE.                             34320035
343300     SET PS-FIRST-TIME-SML   TO TRUE.                             34330035
343400     SET ASC-NOT-MULTIPLE-PO-REC-LNE TO TRUE.                     34340035
343500     SET ASC-NOT-MULTIPLE-UPC        TO TRUE.                     34350035
343600     PERFORM 4100-PREPARE-CURSOR.                                 34360001
343700     PERFORM 4010-OPEN-CURSOR.                                    34370001
343800     PERFORM 4300-READ-ITEMS-FROM-DB.                             34380001
343900     PERFORM 4020-CLOSE-CURSOR.                                   34390001
344000                                                                  34400001
344100     MOVE +1                   TO  PV-TOP-ITEM.                   34410001
344200*    IF MORE THAN ONE ITEM WAS SELECTED, SHOW A BLANK LIST        34420001
344300*    FOR THOSE ITEMS THAT WERE NOT FOUND.  THIS ALLOWS THE USER   34430001
344400*    TO BROWSE THRU THEIR SELECTIONS WITHOUT JUMPING BACK TO      34440001
344500*    THE ORIGINAL SCREEN.                                         34450001
344600*    OR WHEN THE F17 OR F18 ARE PRESSED                           34460036
344700     EVALUATE TRUE                                                34470001
344800         WHEN SU039-SELECTED-ITEMS > 1                            34480001
344900         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              34490036
345000         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              34500036
345100         WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)              34510095
345200             IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                  34520001
345300                 SET DP020-MSG-WARNING TO  TRUE                   34530001
345400                 MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER       34540001
345500                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              34550001
345600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             34560001
345700             ELSE                                                 34570001
345800                 MOVE -1               TO MR-SELECTL(1)           34580001
345900                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              34590001
346000                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             34600001
346100             END-IF                                               34610001
346200         WHEN OTHER                                               34620001
346300             IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                  34630001
346400*                SET DP020-NEXT-ACT-APPL-ERROR TO TRUE            34640001
346500                 SET DP020-MSG-FATAL   TO  TRUE                   34650001
346600                 MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER       34660001
346700             ELSE                                                 34670001
346800                 MOVE -1               TO MR-SELECTL(1)           34680001
346900                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              34690001
347000                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             34700001
347100             END-IF                                               34710001
347200     END-EVALUATE.                                                34720001
347300                                                                  34730001
347400*----------------------------------------------------------------*34740001
347500* OPEN THE CURSOR                                                 34750001
347600*----------------------------------------------------------------*34760001
347700 4010-OPEN-CURSOR.                                                34770001
347800     PERFORM                                                      34780001
347900         WITH TEST AFTER                                          34790001
348000         VARYING PV-RETRY-COUNTER                                 34800001
348100         FROM 1 BY 1                                              34810001
348200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               34820001
348300                   OR (SQLCODE = ZERO))                           34830001
348400                                                                  34840001
348500         EVALUATE TRUE                                            34850001
348600             WHEN ASC-OP-PO-RC-LN-SML-CSR                         34860091
348700                 EXEC SQL                                         34870085
348800                      OPEN OPPO-RECLNESML-CSR                     34880083
348900                 END-EXEC                                         34890001
349000             WHEN ASC-OP-PO-RC-LN-AU-CSR                          34900082
349100                 EXEC SQL                                         34910082
349200                      OPEN OP-PO-RC-LN-AU-CSR                     34920082
349300                 END-EXEC                                         34930082
349400             WHEN ASC-OP-PO-RC-LN-ST-CSR                          34940011
349500                 EXEC SQL                                         34950011
349600                      OPEN OP-PO-RC-LN-ST-CSR                     34960011
349700                 END-EXEC                                         34970011
349800             WHEN ASC-OP-PO-REC-LNE-CSR                           34980001
349900                 EXEC SQL                                         34990001
350000                      OPEN OP-PO-REC-LNE-CSR                      35000001
350100                 END-EXEC                                         35010001
350200             WHEN ASC-OPER-PO-REC-CSR                             35020001
350300                 EXEC SQL                                         35030001
350400                      OPEN OPER-PO-REC-CSR                        35040001
350500                 END-EXEC                                         35050001
350600             WHEN ASC-OPER-PO-CSR                                 35060001
350700                 EXEC SQL                                         35070001
350800                      OPEN OPER-PO-CSR                            35080001
350900                 END-EXEC                                         35090001
351000             WHEN ASC-OPER-CSR                                    35100001
351100                 EXEC SQL                                         35110001
351200                      OPEN OPER-CSR                               35120001
351300                 END-EXEC                                         35130001
351400             WHEN ASC-PO-REC-LNE-DST-CSR                          35140001
351500                 EXEC SQL                                         35150001
351600                      OPEN PO-REC-LNE-DST-CSR                     35160001
351700                 END-EXEC                                         35170001
351800             WHEN ASC-PO-REC-LNE-CSR                              35180001
351900                 EXEC SQL                                         35190001
352000                      OPEN PO-REC-LNE-CSR                         35200001
352100                 END-EXEC                                         35210001
352200             WHEN ASC-PO-REC-CSR                                  35220001
352300                 EXEC SQL                                         35230001
352400                      OPEN PO-REC-CSR                             35240001
352500                 END-EXEC                                         35250001
352600             WHEN ASC-PO-CSR                                      35260001
352700                 EXEC SQL                                         35270001
352800                      OPEN PO-CSR                                 35280001
352900                 END-EXEC                                         35290001
353000             WHEN ASC-OPER-UPC-CSR                                35300001
353100                 EXEC SQL                                         35310001
353200                      OPEN OPER-UPC-CSR                           35320001
353300                 END-EXEC                                         35330001
353400             WHEN ASC-UPC-CSR                                     35340001
353500                 EXEC SQL                                         35350001
353600                      OPEN UPC-CSR                                35360001
353700                 END-EXEC                                         35370001
353800             WHEN ASC-OPER-SKU-CSR                                35380001
353900                 EXEC SQL                                         35390001
354000                      OPEN OPER-SKU-CSR                           35400001
354100                 END-EXEC                                         35410001
354200             WHEN ASC-SKU-CSR                                     35420001
354300                 EXEC SQL                                         35430001
354400                      OPEN SKU-CSR                                35440001
354500                 END-EXEC                                         35450001
354600             WHEN ASC-AUDIT-CSR                                   35460001
354700                 EXEC SQL                                         35470001
354800                      OPEN AUDIT-CSR                              35480001
354900                 END-EXEC                                         35490001
355000             WHEN ASC-SHIPT-UNT-CSR                               35500001
355100                 EXEC SQL                                         35510001
355200                      OPEN SHIPT-UNIT-CSR                         35520001
355300                 END-EXEC                                         35530001
355400         END-EVALUATE                                             35540001
355500                                                                  35550001
355600                                                                  35560001
355700         EVALUATE TRUE                                            35570001
355800             WHEN SQLCODE = ZERO                                  35580001
355900             WHEN SQLCODE = -904                                  35590001
356000             WHEN SQLCODE = -913                                  35600001
356100                 CONTINUE                                         35610001
356200             WHEN SQLWARN0 NOT = SPACES                           35620001
356300             WHEN SQLCODE < ZERO                                  35630001
356400             WHEN SQLCODE > ZERO                                  35640001
356500                 MOVE '4010-OPEN-CURSOR' TO DP013-PARAGRAPH       35650001
356600                 MOVE 'OPEN CURSOR PROBLEM    - '                 35660001
356700                                   TO DP013-MESSAGE-TEXT (1)      35670001
356800                 MOVE SQLCA        TO DP013-SQLCA                 35680001
356900                 MOVE 'FINCLADJ'   TO DP013-DB2-TABLE-NAME (1)    35690001
357000                 SET DP013-DB2-ABEND                              35700001
357100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           35710001
357200                 PERFORM DP013-0000-PROCESS-ABEND                 35720001
357300         END-EVALUATE                                             35730001
357400     END-PERFORM.                                                 35740001
357500*                                                                 35750001
357600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        35760001
357700         MOVE '4010-OPEN-CURSOR'   TO DP013-PARAGRAPH             35770001
357800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   35780001
357900                                   TO DP013-MESSAGE-TEXT (1)      35790001
358000         MOVE SQLCA                TO DP013-SQLCA                 35800001
358100         MOVE 'FINCLADJ'           TO DP013-DB2-TABLE-NAME (1)    35810001
358200         SET DP013-DB2-ABEND                                      35820001
358300             DP013-XCTL-DISPLAY-RESTART TO TRUE                   35830001
358400         PERFORM DP013-0000-PROCESS-ABEND                         35840001
358500     END-IF.                                                      35850001
358600                                                                  35860001
358700*----------------------------------------------------------------*35870001
358800* CLOSE THE CURSOR.                                               35880001
358900*----------------------------------------------------------------*35890001
359000 4020-CLOSE-CURSOR.                                               35900001
359100                                                                  35910001
359200     EVALUATE TRUE                                                35920001
359300         WHEN ASC-OP-PO-RC-LN-SML-CSR                             35930082
359400             EXEC SQL                                             35940001
359500                  CLOSE OPPO-RECLNESML-CSR                        35950083
359600             END-EXEC                                             35960001
359700         WHEN ASC-OP-PO-RC-LN-AU-CSR                              35970082
359800             EXEC SQL                                             35980082
359900                  CLOSE OP-PO-RC-LN-AU-CSR                        35990082
360000             END-EXEC                                             36000082
360100         WHEN ASC-OP-PO-RC-LN-ST-CSR                              36010011
360200             EXEC SQL                                             36020011
360300                  CLOSE OP-PO-RC-LN-ST-CSR                        36030011
360400             END-EXEC                                             36040011
360500         WHEN ASC-OP-PO-REC-LNE-CSR                               36050001
360600             EXEC SQL                                             36060001
360700                  CLOSE OP-PO-REC-LNE-CSR                         36070001
360800             END-EXEC                                             36080001
360900         WHEN ASC-OPER-PO-REC-CSR                                 36090001
361000             EXEC SQL                                             36100001
361100                  CLOSE OPER-PO-REC-CSR                           36110001
361200             END-EXEC                                             36120001
361300         WHEN ASC-OPER-PO-CSR                                     36130001
361400             EXEC SQL                                             36140001
361500                  CLOSE OPER-PO-CSR                               36150001
361600             END-EXEC                                             36160001
361700         WHEN ASC-OPER-CSR                                        36170001
361800             EXEC SQL                                             36180001
361900                  CLOSE OPER-CSR                                  36190001
362000             END-EXEC                                             36200001
362100         WHEN ASC-PO-REC-LNE-DST-CSR                              36210001
362200             EXEC SQL                                             36220001
362300                  CLOSE PO-REC-LNE-DST-CSR                        36230001
362400             END-EXEC                                             36240001
362500         WHEN ASC-PO-REC-LNE-CSR                                  36250001
362600             EXEC SQL                                             36260001
362700                  CLOSE PO-REC-LNE-CSR                            36270001
362800             END-EXEC                                             36280001
362900         WHEN ASC-PO-REC-CSR                                      36290001
363000             EXEC SQL                                             36300001
363100                  CLOSE PO-REC-CSR                                36310001
363200             END-EXEC                                             36320001
363300         WHEN ASC-PO-CSR                                          36330001
363400             EXEC SQL                                             36340001
363500                  CLOSE PO-CSR                                    36350001
363600             END-EXEC                                             36360001
363700         WHEN ASC-OPER-UPC-CSR                                    36370001
363800             EXEC SQL                                             36380001
363900                  CLOSE OPER-UPC-CSR                              36390001
364000             END-EXEC                                             36400001
364100         WHEN ASC-UPC-CSR                                         36410001
364200             EXEC SQL                                             36420001
364300                  CLOSE UPC-CSR                                   36430001
364400             END-EXEC                                             36440001
364500         WHEN ASC-OPER-SKU-CSR                                    36450001
364600             EXEC SQL                                             36460001
364700                  CLOSE OPER-SKU-CSR                              36470001
364800             END-EXEC                                             36480001
364900         WHEN ASC-SKU-CSR                                         36490001
365000             EXEC SQL                                             36500001
365100                  CLOSE SKU-CSR                                   36510001
365200             END-EXEC                                             36520001
365300         WHEN ASC-AUDIT-CSR                                       36530001
365400             EXEC SQL                                             36540001
365500                  CLOSE AUDIT-CSR                                 36550001
365600             END-EXEC                                             36560001
365700         WHEN ASC-SHIPT-UNT-CSR                                   36570001
365800             EXEC SQL                                             36580001
365900                  CLOSE SHIPT-UNIT-CSR                            36590001
366000             END-EXEC                                             36600001
366100     END-EVALUATE.                                                36610001
366200                                                                  36620001
366300     EVALUATE TRUE                                                36630001
366400         WHEN SQLCODE = ZERO                                      36640001
366500         WHEN SQLCODE = +100                                      36650001
366600             CONTINUE                                             36660001
366700         WHEN SQLWARN0 NOT = SPACES                               36670001
366800         WHEN SQLCODE < ZERO                                      36680001
366900         WHEN SQLCODE > ZERO                                      36690001
367000             MOVE '4020-CLOSE-CURSOR' TO DP013-PARAGRAPH          36700001
367100             MOVE 'CLOSE CURSOR PROBLEM   '                       36710001
367200                               TO DP013-MESSAGE-TEXT (1)          36720001
367300             MOVE SQLCA        TO DP013-SQLCA                     36730001
367400             MOVE 'FINCLADJ'   TO DP013-DB2-TABLE-NAME (1)        36740001
367500             SET DP013-DB2-ABEND                                  36750001
367600                 DP013-XCTL-DISPLAY-RESTART TO TRUE               36760001
367700             PERFORM DP013-0000-PROCESS-ABEND                     36770001
367800     END-EVALUATE.                                                36780001
367900                                                                  36790001
368000*----------------------------------------------------------------*36800001
368100*    FILL IN HOST VARIABLE FIELDS                                 36810001
368200*----------------------------------------------------------------*36820001
368300 4100-PREPARE-CURSOR.                                             36830001
368400     IF NOT ASC-UNT-ADJ-ALL                                       36840001
368500         MOVE ASC-UNT-ADJ-TYP     TO  DK-UNT-ADJ-TYP-BEGIN        36850001
368600                                      DK-UNT-ADJ-TYP-END          36860001
368700     ELSE                                                         36870001
368800         MOVE DK-DEFAULT-ALPHA-BEGIN  TO  DK-UNT-ADJ-TYP-BEGIN    36880001
368900         MOVE DK-DEFAULT-ALPHA-END    TO  DK-UNT-ADJ-TYP-END      36890001
369000     END-IF.                                                      36900001
369100                                                                  36910001
369200* DMH 8/19/03 - BEGIN                                             36920001
369300     IF  ASC-GROUP-CRTN                                           36930001
369400         MOVE  'C'                TO  DK-GROUP-BEGIN              36940001
369500                                      DK-GROUP-END                36950001
369600     ELSE                                                         36960001
369700     IF  ASC-GROUP-P2L                                            36970001
369800         MOVE  'P'                TO  DK-GROUP-BEGIN              36980001
369900                                      DK-GROUP-END                36990001
370000     ELSE                                                         37000001
370100         MOVE  'A'                TO  DK-GROUP-BEGIN              37010001
370200         MOVE  'P'                TO  DK-GROUP-END                37020001
370300     END-IF                                                       37030001
370400     END-IF.                                                      37040001
370500* DMH 8/19/03 - END                                               37050001
370600                                                                  37060001
370700     IF ASC-FAIL-SW                                               37070001
370800         MOVE 'N'                 TO  DK-FAIL-SUCC-BEGIN          37080001
370900                                      DK-FAIL-SUCC-END            37090001
371000         MOVE '        '          TO  DK-RSLV-BY-BEGIN            37100001
371100         MOVE 'ZZZZZZZZ'          TO  DK-RSLV-BY-END              37110001
371200     ELSE                                                         37120001
371300         IF ASC-SUCC-SW                                           37130001
371400             MOVE 'Y'             TO  DK-FAIL-SUCC-BEGIN          37140001
371500                                      DK-FAIL-SUCC-END            37150001
371600             MOVE '        '      TO  DK-RSLV-BY-BEGIN            37160001
371700             MOVE 'ZZZZZZZZ'      TO  DK-RSLV-BY-END              37170001
371800         ELSE                                                     37180001
371900             IF ASC-SUCCESS                                       37190001
372000                 MOVE 'Y'             TO  DK-FAIL-SUCC-BEGIN      37200001
372100                                          DK-FAIL-SUCC-END        37210001
372200                 MOVE '        '      TO  DK-RSLV-BY-BEGIN        37220001
372300                 MOVE 'ZZZZZZZZ'      TO  DK-RSLV-BY-END          37230001
372400             ELSE                                                 37240001
372500                 IF ASC-FAIL                                      37250001
372600                     MOVE 'N'             TO  DK-FAIL-SUCC-BEGIN  37260001
372700                                              DK-FAIL-SUCC-END    37270001
372800                     MOVE '        '      TO  DK-RSLV-BY-BEGIN    37280001
372900                     MOVE 'ZZZZZZZZ'          TO  DK-RSLV-BY-END  37290001
373000                 ELSE                                             37300001
373100                     IF ASC-UNACKNOWLEDGED                        37310001
373200                         MOVE 'N'           TO  DK-FAIL-SUCC-BEGIN37320001
373300                                                DK-FAIL-SUCC-END  37330001
373400                         MOVE '        '    TO  DK-RSLV-BY-BEGIN  37340001
373500                                                DK-RSLV-BY-END    37350001
373600                     ELSE                                         37360001
373700                         MOVE DK-DEFAULT-ALPHA-BEGIN TO           37370001
373800                                                DK-FAIL-SUCC-BEGIN37380001
373900                         MOVE DK-DEFAULT-ALPHA-END   TO           37390001
374000                                                DK-FAIL-SUCC-END  37400001
374100                         MOVE '        '     TO  DK-RSLV-BY-BEGIN 37410001
374200                         MOVE 'ZZZZZZZZ'     TO  DK-RSLV-BY-END   37420001
374300                     END-IF                                       37430001
374400                 END-IF                                           37440001
374500             END-IF                                               37450001
374600         END-IF                                                   37460001
374700     END-IF.                                                      37470001
374800     IF ASC-FROM-CC   NOT = SPACES                                37480001
374900         MOVE ASC-FROM-CC          TO PV-FROM-CC                  37490001
375000         MOVE ASC-FROM-YY          TO PV-FROM-YY                  37500001
375100         MOVE ASC-FROM-MM          TO PV-FROM-MM                  37510001
375200         MOVE ASC-FROM-DD          TO PV-FROM-DD                  37520001
375300         MOVE PV-FROM-TMST-X       TO PV-FROM-TMST                37530001
375400     ELSE                                                         37540001
375500         MOVE PV-FROM-TMST-X       TO PV-FROM-TMST                37550001
375600     END-IF.                                                      37560001
375700     IF ASC-TO-CC   NOT = SPACES                                  37570001
375800         MOVE ASC-TO-CC            TO PV-TO-CC                    37580001
375900         MOVE ASC-TO-YY            TO PV-TO-YY                    37590001
376000         MOVE ASC-TO-MM            TO PV-TO-MM                    37600001
376100         MOVE ASC-TO-DD            TO PV-TO-DD                    37610001
376200         MOVE PV-TO-TMST-X         TO PV-TO-TMST                  37620001
376300     ELSE                                                         37630001
376400         MOVE PV-TO-TMST-X         TO PV-TO-TMST                  37640001
376500     END-IF.                                                      37650001
376600     MOVE ASC-OPER-UNT-ID      TO  DK-OPER-UNT-ID.                37660001
376700     MOVE ASC-PO               TO  DK-PO-NBR.                     37670001
376800     MOVE ASC-RCVR             TO  DK-RCVR-SEQ-NBR.               37680001
376900     MOVE ASC-LINE             TO  DK-LINE-NBR.                   37690001
377000     MOVE ASC-STR-NBR          TO  DK-STR-NBR.                    37700001
377100     MOVE ASC-UPC              TO  DK-UPC-NBR.                    37710001
377200     MOVE ASC-SKU              TO  DK-SKU-NBR.                    37720001
377300**   IF ASC-SKU    > ZEROES                                       37730009
377400**       IF ASC-UPC = ZEROES                                      37740009
377500**           PERFORM 4110-GET-UPC                                 37750009
377600**           MOVE XL001-UPC-NBR    TO  DK-UPC-NBR                 37760009
377700**       END-IF                                                   37770009
377800**   ELSE                                                         37780009
377900*        MOVE ZEROES TO ASC-SKU                                   37790001
378000**       IF ASC-UPC > ZEROES                                      37800009
378100**           MOVE ASC-UPC          TO SUT00030-UPC-NBR            37810009
378200**           PERFORM 4340-GET-SKU                                 37820009
378300**           MOVE XL001-SKU-NBR    TO ASC-SKU                     37830009
378400**       END-IF                                                   37840009
378500**   END-IF.                                                      37850009
378600                                                                  37860061
378700     MOVE ASC-SML-IN TO DK-SML.                                   37870037
378800     IF DK-SML-1-2 = 41                                           37880001
378900         MOVE ASC-SML-IN       TO  DK-SHIPT-UNT-ID                37890037
379000     ELSE                                                         37900001
379100         IF DK-SML  > ZEROES                                      37910001
379200             MOVE ASC-SML-IN           TO  DK-SML-N               37920037
379300             PERFORM 4130-GOTO-CROSS-REF                          37930001
379400             MOVE ASC-SML-IN           TO  DK-SHIPT-UNT-ID        37940037
379500         ELSE                                                     37950001
379600             MOVE ZEROES               TO  DK-SHIPT-UNT-ID        37960001
379700             MOVE ZEROES               TO  ASC-SML-IN             37970037
379800         END-IF                                                   37980001
379900     END-IF.                                                      37990001
380000     MOVE ASC-AUDIT-IN                 TO  DK-AUDIT-NBR.          38000037
380100                                                                  38010001
380200     EVALUATE TRUE                                                38020001
380300         WHEN ((DK-SHIPT-UNT-ID > 0) AND                          38030076
380400            ((DP020-INT-APPL-FORMAT-IND = PC-AUDIT-FORMAT) OR     38040077
380500             (DP020-INT-APPL-FORMAT-IND = '4')))                  38050077
380600             SET ASC-SHIPT-UNT-CSR                 TO TRUE        38060055
380700                                                                  38070055
380800         WHEN DK-OPER-UNT-ID > 0 AND                              38080001
380900              DK-PO-NBR > 0 AND                                   38090001
381000              DK-RCVR-SEQ-NBR > 0 AND                             38100001
381100              (DK-LINE-NBR > 0 OR DK-LINE-NBR = 0) AND            38110092
381200              DK-SHIPT-UNT-ID > 0                                 38120082
381300             SET ASC-OP-PO-RC-LN-SML-CSR           TO TRUE        38130082
381400                                                                  38140001
381500         WHEN (DK-OPER-UNT-ID > 0 AND                             38150099
381600               DK-PO-NBR > 0 AND                                  38160099
381700               DK-RCVR-SEQ-NBR > 0 AND                            38170099
381800              (DK-LINE-NBR > 0 OR DK-LINE-NBR = 0) AND            38180099
381900               DK-AUDIT-NBR > 0)                                  38190099
382000             SET ASC-OP-PO-RC-LN-AU-CSR            TO TRUE        38200082
382100             IF DK-LINE-NBR = 0                                   38210099
382200                 MOVE 0            TO DK-DEFAULT-BEGIN            38220099
382300                 MOVE 9999         TO DK-DEFAULT-END-LINE         38230099
382400             ELSE                                                 38240099
382500                 MOVE DK-LINE-NBR  TO DK-DEFAULT-BEGIN            38250099
382600                 MOVE DK-LINE-NBR  TO DK-DEFAULT-END-LINE         38260099
382700             END-IF                                               38270099
382800                                                                  38280082
382900         WHEN DK-SHIPT-UNT-ID > 0                                 38290027
383000             SET ASC-SHIPT-UNT-CSR                 TO TRUE        38300027
383100                                                                  38310027
383200         WHEN DK-OPER-UNT-ID > 0 AND                              38320011
383300              DK-PO-NBR > 0 AND                                   38330011
383400              DK-RCVR-SEQ-NBR > 0 AND                             38340011
383500              DK-LINE-NBR > 0 AND                                 38350011
383600              DK-STR-NBR > 0                                      38360011
383700             SET ASC-OP-PO-RC-LN-ST-CSR            TO TRUE        38370011
383800                                                                  38380011
383900         WHEN (DK-OPER-UNT-ID > 0 AND                             38390017
384000              DK-PO-NBR > 0 AND                                   38400001
384100              DK-RCVR-SEQ-NBR > 0 AND                             38410001
384200              DK-LINE-NBR > 0) OR                                 38420017
384300              (DP020-INT-APPL-FORMAT-IND = PC-LIST-FORMAT AND     38430017
384400              DK-OPER-UNT-ID > 0 AND                              38440017
384500              DK-PO-NBR > 0 AND                                   38450017
384600              DK-RCVR-SEQ-NBR > 0 AND                             38460017
384700              DK-LINE-NBR = 0)                                    38470017
384800             SET ASC-OP-PO-REC-LNE-CSR             TO TRUE        38480001
384900                                                                  38490001
385000         WHEN DK-OPER-UNT-ID > 0 AND                              38500001
385100              DK-PO-NBR > 0 AND                                   38510001
385200              DK-RCVR-SEQ-NBR > 0                                 38520001
385300             SET ASC-OPER-PO-REC-CSR               TO TRUE        38530001
385400                                                                  38540001
385500         WHEN DK-OPER-UNT-ID > 0 AND                              38550001
385600              DK-PO-NBR > 0                                       38560001
385700             SET ASC-OPER-PO-CSR                   TO TRUE        38570001
385800                                                                  38580001
385900         WHEN DK-OPER-UNT-ID > 0 AND                              38590001
386000              DK-UPC-NBR > 0                                      38600001
386100             SET ASC-OPER-UPC-CSR                  TO TRUE        38610001
386200                                                                  38620001
386300         WHEN DK-OPER-UNT-ID > 0 AND                              38630001
386400              DK-SKU-NBR > 0                                      38640001
386500             SET ASC-OPER-SKU-CSR                  TO TRUE        38650001
386600                                                                  38660001
386700         WHEN DK-AUDIT-NBR > 0                                    38670010
386800             SET ASC-AUDIT-CSR                     TO TRUE        38680010
386900                                                                  38690010
387000         WHEN DK-OPER-UNT-ID > 0                                  38700001
387100             SET ASC-OPER-CSR                      TO TRUE        38710001
387200                                                                  38720001
387300         WHEN DK-PO-NBR > 0 AND                                   38730001
387400              DK-RCVR-SEQ-NBR > 0 AND                             38740001
387500              DK-LINE-NBR > 0 AND                                 38750001
387600              DK-STR-NBR > 0                                      38760001
387700             SET ASC-PO-REC-LNE-DST-CSR            TO TRUE        38770001
387800                                                                  38780001
387900         WHEN DK-PO-NBR > 0 AND                                   38790001
388000              DK-RCVR-SEQ-NBR > 0 AND                             38800001
388100              DK-LINE-NBR > 0                                     38810001
388200             SET ASC-PO-REC-LNE-CSR                TO TRUE        38820001
388300                                                                  38830001
388400         WHEN DK-PO-NBR > 0 AND                                   38840001
388500              DK-RCVR-SEQ-NBR > 0                                 38850001
388600             SET ASC-PO-REC-CSR                    TO TRUE        38860001
388700                                                                  38870001
388800         WHEN DK-PO-NBR > 0                                       38880001
388900             SET ASC-PO-CSR                        TO TRUE        38890001
389000                                                                  38900001
389100         WHEN DK-UPC-NBR > 0                                      38910001
389200             SET ASC-UPC-CSR                       TO TRUE        38920001
389300                                                                  38930001
389400         WHEN DK-SKU-NBR > 0                                      38940001
389500             SET ASC-SKU-CSR                       TO TRUE        38950001
389600                                                                  38960001
389700     END-EVALUATE.                                                38970001
389800                                                                  38980001
389900     INITIALIZE DCLSUT00030.                                      38990001
390000*----------------------------------------------------------------*39000001
390100*    RETRIEVE UPC USING SKU NUMBER                                39010001
390200*----------------------------------------------------------------*39020001
390300 4110-GET-UPC.                                                    39030001
390400     INITIALIZE XL001-ITEM-COMMAREA.                              39040001
390500     MOVE ASC-SKU  TO XL001-KEY-SKU.                              39050001
390600     MOVE  'V'     TO XL001-KEY-UPC-TYP-CDE.                      39060001
390700     SET  XL001-BY-NUMERIC-SKU                                    39070001
390800          XL001-SELECT-UPC     TO TRUE.                           39080001
390900                                                                  39090001
391000     CALL XL001-VSM-PGM USING DFHEIBLK                            39100001
391100                           XL001-COMMAREA                         39110001
391200                           XL001-ITEM-COMMAREA.                   39120001
391300     EVALUATE TRUE                                                39130001
391400         WHEN XL001-SUCCESSFUL                                    39140001
391500         WHEN XL001-UPC-SQLCODE = -811                            39150001
391600              CONTINUE                                            39160001
391700         WHEN XL001-UPC-NOT-FOUND                                 39170001
391800             PERFORM 4120-GET-INTR-UPC-NBR                        39180001
391900         WHEN XL001-SQL-ERROR                                     39190001
392000             MOVE '4110-GET-UPC-NBR  '  TO DP013-PARAGRAPH        39200001
392100             MOVE 'FIND UPC NUMBER' TO  DP013-MESSAGE-TEXT (1)    39210001
392200             MOVE SQLCA   TO DP013-SQLCA                          39220001
392300             MOVE 'XLKUT001' TO DP013-DB2-TABLE-NAME (1)          39230001
392400             SET DP013-DB2-ABEND                                  39240001
392500                 DP013-XCTL-DISPLAY-RESTART TO TRUE               39250001
392600             PERFORM DP013-0000-PROCESS-ABEND                     39260001
392700     END-EVALUATE.                                                39270001
392800                                                                  39280001
392900*----------------------------------------------------------------*39290001
393000*    RETRIEVE INTR UPC NUMBER                                     39300001
393100*----------------------------------------------------------------*39310001
393200 4120-GET-INTR-UPC-NBR.                                           39320001
393300     INITIALIZE XL001-ITEM-COMMAREA.                              39330001
393400     MOVE ASC-SKU  TO XL001-KEY-SKU.                              39340001
393500     MOVE  'I'     TO XL001-KEY-UPC-TYP-CDE.                      39350001
393600     SET  XL001-BY-NUMERIC-SKU                                    39360001
393700          XL001-SELECT-UPC     TO TRUE.                           39370001
393800                                                                  39380001
393900     CALL XL001-VSM-PGM USING DFHEIBLK                            39390001
394000                           XL001-COMMAREA                         39400001
394100                           XL001-ITEM-COMMAREA.                   39410001
394200     EVALUATE TRUE                                                39420001
394300         WHEN XL001-SUCCESSFUL                                    39430001
394400         WHEN XL001-UPC-SQLCODE = -811                            39440001
394500              CONTINUE                                            39450001
394600         WHEN XL001-UPC-NOT-FOUND                                 39460001
394700             MOVE ZEROES TO XL001-UPC-NBR                         39470001
394800         WHEN XL001-SQL-ERROR                                     39480001
394900             MOVE '4120-GET-INTR-UPC-NBR  '  TO DP013-PARAGRAPH   39490001
395000             MOVE 'FIND INTR UPC NUMBER' TO DP013-MESSAGE-TEXT (1)39500001
395100             MOVE SQLCA   TO DP013-SQLCA                          39510001
395200             MOVE 'XLKUT001' TO DP013-DB2-TABLE-NAME (1)          39520001
395300             SET DP013-DB2-ABEND                                  39530001
395400                 DP013-XCTL-DISPLAY-RESTART TO TRUE               39540001
395500             PERFORM DP013-0000-PROCESS-ABEND                     39550001
395600     END-EVALUATE.                                                39560001
395700                                                                  39570001
395800*----------------------------------------------------------------*39580001
395900*    USE THE INBOUND CARTON ID TO GET THE OUTBOUND CARTON ID      39590001
396000*----------------------------------------------------------------*39600001
396100 4130-GOTO-CROSS-REF.                                             39610001
396200                                                                  39620001
396300     EXEC SQL                                                     39630001
396400          SELECT BRCDE_NBR                                        39640001
396500          INTO  :SULBXF-BRCDE-NBR                                 39650001
396600          FROM  TSULBXF                                           39660001
396700        WHERE    SHIPT_UNT_ID   =  :DK-SML-N                      39670001
396800     END-EXEC.                                                    39680001
396900                                                                  39690001
397000     EVALUATE TRUE                                                39700001
397100         WHEN SQLCODE = +0                                        39710001
397200             MOVE SULBXF-BRCDE-NBR TO DK-BRCDE                    39720001
397300             MOVE DK-BRCDE-3-18    TO ASC-SML-IN                  39730037
397400         WHEN OTHER                                               39740001
397500             MOVE ZEROES           TO ASC-SML-IN                  39750037
397600     END-EVALUATE.                                                39760001
397700                                                                  39770001
397800*----------------------------------------------------------------*39780001
397900*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *39790001
398000*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *39800001
398100*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *39810001
398200*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *39820001
398300*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *39830001
398400*                                                                *39840001
398500*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *39850001
398600*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *39860001
398700*    UPON INITIALIZATION.                                        *39870001
398800*----------------------------------------------------------------*39880001
398900 4300-READ-ITEMS-FROM-DB.                                         39890001
399000                                                                  39900001
399100     PERFORM                                                      39910001
399200         VARYING PV-READ-COUNT                                    39920001
399300         FROM 1 BY 1                                              39930001
399400         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    39940001
399500            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         39950001
399600                                                                  39960001
399700         PERFORM 4310-FETCH                                       39970001
399800                                                                  39980001
399900         IF  ASC-ITEMS-LEFT-ON-DB                                 39990001
400000             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                40000001
400100                 ADD +1            TO ASC-ITEM-SUB                40010001
400200             ELSE                                                 40020001
400300                 ADD +1            TO ASC-BLK-SUB                 40030001
400400                 MOVE +1           TO ASC-ITEM-SUB                40040001
400500                                                                  40050001
400600                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         40060001
400700                     MOVE +1       TO ASC-BLK-SUB                 40070001
400800                     SET ASC-BLOCK-MODIFIED (1) TO TRUE           40080001
400900                     PERFORM 5100-WRITE-TEMP-STORAGE              40090001
401000                     MOVE ASC-BLOCK-ENTRIES                       40100001
401100                                   (PC-MAX-BLOCKS-IN-ARRAY)       40110001
401200                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 40120001
401300                     ADD +1        TO ASC-BLK-SUB                 40130001
401400                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   40140001
401500                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      40150001
401600                                                          TO TRUE 40160001
401700                 END-IF                                           40170001
401800             END-IF                                               40180001
401900             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    40190001
402000             SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB) TO TRUE          40200001
402100             MOVE ASC-NUMBER-OF-ITEMS-READ                        40210001
402200                                   TO ASC-LIST-ITEM-NUMBER        40220001
402300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  40230001
402400             MOVE SPACES TO ASC-ACTION                            40240001
402500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  40250001
402600             MOVE SUT00030-DEST-LOC-NBR TO                        40260001
402700                             ASC-STORE (ASC-BLK-SUB ASC-ITEM-SUB) 40270001
402800             MOVE SUT00030-PO-NBR TO                              40280001
402900                             ASC-PO-LNE (ASC-BLK-SUB ASC-ITEM-SUB)40290001
403000                             PV-PO                                40300031
403100             MOVE SUT00030-RCVR-LNE-NBR TO                        40310001
403200                            ASC-LNE-LNE (ASC-BLK-SUB ASC-ITEM-SUB)40320001
403300                            PV-LNE-NBR                            40330031
403400             MOVE SUT00030-RCVR-SEQ-NBR TO                        40340001
403500                            ASC-REC-LNE (ASC-BLK-SUB ASC-ITEM-SUB)40350001
403600                            PV-REC-SEQ                            40360031
403700             IF ASC-PO-RCVR = '000000000-000'                     40370031
403800                IF PS-FIRST-LINE                                  40380031
403900                    MOVE PV-PO            TO ASC-CURSOR-PO-NBR    40390031
404000                    MOVE PV-REC-SEQ       TO ASC-CURSOR-RCVR-NBR  40400031
404100                    MOVE PV-LNE-NBR       TO ASC-CURSOR-LINE-NBR  40410031
404200                    SET PS-NOT-FIRST-LINE TO TRUE                 40420031
404300                ELSE                                              40430031
404400                    IF ASC-MULTIPLE-PO-REC-LNE                    40440031
404500                        CONTINUE                                  40450031
404600                    ELSE                                          40460031
404700                        IF PV-PO NOT = ASC-CURSOR-PO-NBR OR       40470031
404800                           PV-REC-SEQ NOT = ASC-CURSOR-RCVR-NBR OR40480031
404900                           PV-LNE-NBR NOT = ASC-CURSOR-LINE-NBR   40490031
405000                            SET ASC-MULTIPLE-PO-REC-LNE TO TRUE   40500031
405100                        END-IF                                    40510031
405200                    END-IF                                        40520031
405300                END-IF                                            40530031
405400             END-IF                                               40540031
405500             IF ASC-UPC = 0                                       40550031
405600                 IF ASC-CURSOR-UPC = 0                            40560031
405700                     MOVE SUT00030-UPC-NBR TO ASC-CURSOR-UPC      40570031
405800                 ELSE                                             40580031
405900                     SET ASC-MULTIPLE-UPC   TO TRUE               40590031
406000                 END-IF                                           40600031
406100             END-IF                                               40610031
406200             PERFORM 4340-GET-SKU                                 40620001
406300             IF ASC-ACCESS-UPC                                    40630001
406400                 MOVE SUT00030-UPC-NBR TO                         40640001
406500                       ASC-UPC-SKU-NBR (ASC-BLK-SUB ASC-ITEM-SUB) 40650001
406600             ELSE                                                 40660001
406700                 MOVE XL001-SKU-NBR TO                            40670001
406800                       ASC-UPC-SKU-NBR (ASC-BLK-SUB ASC-ITEM-SUB) 40680001
406900             END-IF                                               40690001
407000             IF PV-NULL-IND-2 < 0                                 40700022
407100                 MOVE ZEROES TO SUT00030-SHIPT-UNT-ID             40710022
407200             END-IF                                               40720022
407300             IF ASC-SML-X = 'MULTIPLE'                            40730022
407400                 CONTINUE                                         40740022
407500             ELSE                                                 40750022
407600                 IF ASC-SML NOT = SUT00030-SHIPT-UNT-ID           40760019
407700                     IF PS-FIRST-TIME-SML                         40770020
407800                         MOVE SUT00030-SHIPT-UNT-ID  TO ASC-SML   40780022
407900                         SET PS-NOT-FIRST-TIME-SML   TO TRUE      40790022
408000                     ELSE                                         40800020
408100                         MOVE 'MULTIPLE'             TO ASC-SML-X 40810020
408200                     END-IF                                       40820020
408300                 ELSE                                             40830018
408400                     MOVE SUT00030-SHIPT-UNT-ID  TO ASC-SML       40840022
408500                 END-IF                                           40850022
408600             END-IF                                               40860018
408700             MOVE SUT00030-SHIPT-UNT-ID TO                        40870048
408800                            ASC-SML-NBR (ASC-BLK-SUB ASC-ITEM-SUB)40880048
408900             MOVE SUT00030-CRE-TMST TO PV-DATE-TIME-TMST          40890001
409000             MOVE PV-TD-DD  TO PV-DT-DD                           40900001
409100             MOVE PV-TD-MM  TO PV-DT-MM                           40910001
409200             MOVE PV-TD-HR  TO PV-TI-HR                           40920001
409300             MOVE PV-TD-MN  TO PV-TI-MN                           40930001
409400             MOVE PV-DATE TO   ASC-DATE (ASC-BLK-SUB ASC-ITEM-SUB)40940001
409500             MOVE PV-TIME TO   ASC-TIME (ASC-BLK-SUB ASC-ITEM-SUB)40950001
409600             PERFORM 4320-GET-ADJ-SOURCE                          40960001
409700             MOVE SURSNC-PRC-RSN-DESC   TO                        40970001
409800                          ASC-ADJ-SRCE (ASC-BLK-SUB ASC-ITEM-SUB) 40980001
409900             MOVE SUT00030-FINCL-BEF-QTY TO                       40990001
410000                           ASC-BEF-QTY (ASC-BLK-SUB ASC-ITEM-SUB) 41000001
410100             MOVE SUT00030-FINCL-AFT-QTY TO                       41010001
410200                           ASC-AFT-QTY (ASC-BLK-SUB ASC-ITEM-SUB) 41020001
410300             IF SUT00030-AUTO-APL-IND = 'N'                       41030001
410400                 MOVE 'F' TO                                      41040001
410500                        ASC-FAIL-SUCCSS (ASC-BLK-SUB ASC-ITEM-SUB)41050001
410600                 IF SUT00030-RSLV-BY-USR-ID = '        '          41060001
410700                     MOVE 'U' TO ASC-ACKNOWLEDGE                  41070001
410800                                        (ASC-BLK-SUB ASC-ITEM-SUB)41080001
410900                 ELSE                                             41090001
411000                     MOVE ' ' TO ASC-ACKNOWLEDGE                  41100001
411100                                        (ASC-BLK-SUB ASC-ITEM-SUB)41110001
411200                 END-IF                                           41120001
411300             ELSE                                                 41130001
411400                 MOVE 'S' TO                                      41140001
411500                        ASC-FAIL-SUCCSS (ASC-BLK-SUB ASC-ITEM-SUB)41150001
411600                 MOVE ' ' TO ASC-ACKNOWLEDGE                      41160001
411700                                        (ASC-BLK-SUB ASC-ITEM-SUB)41170001
411800             END-IF                                               41180001
411900                                                                  41190001
412000* DMH 8/19/03 BEGIN                                               41200001
412100             MOVE  SURSNC-PRC-GP-CDE                              41210001
412200               TO  ASC-PRCS-GROUP (ASC-BLK-SUB ASC-ITEM-SUB)      41220001
412300* DMH 8/19/03 END                                                 41230001
412400                                                                  41240001
412500             IF PV-NULL-IND-1  <  0                               41250001
412600                 MOVE SPACES TO                                   41260001
412700                           ASC-ERR-CDE (ASC-BLK-SUB ASC-ITEM-SUB) 41270001
412800             ELSE                                                 41280001
412900                 PERFORM 4330-GET-ERR-CDE                         41290001
413000                 MOVE SUT00031-ADJ-ERR-SHRT-DESC TO               41300001
413100                           ASC-ERR-CDE (ASC-BLK-SUB ASC-ITEM-SUB) 41310001
413200             END-IF                                               41320001
413300             EVALUATE TRUE                                        41330001
413400                 WHEN SUT00030-AUD-ADJ-STAT-CDE = 'P'             41340001
413500                      MOVE 'POSTV'  TO ASC-ADJ-TYP                41350001
413600                                        (ASC-BLK-SUB ASC-ITEM-SUB)41360001
413700                 WHEN SUT00030-AUD-ADJ-STAT-CDE = 'C'             41370001
413800                      MOVE 'CNFRM'  TO ASC-ADJ-TYP                41380001
413900                                        (ASC-BLK-SUB ASC-ITEM-SUB)41390001
414000                 WHEN SUT00030-AUD-ADJ-STAT-CDE = 'V'             41400001
414100                         MOVE 'VERFY'  TO ASC-ADJ-TYP             41410001
414200                                        (ASC-BLK-SUB ASC-ITEM-SUB)41420001
414300                 WHEN SUT00030-AUD-ADJ-STAT-CDE = 'Q'             41430001
414400                         MOVE 'P2L  '  TO ASC-ADJ-TYP             41440001
414500                                        (ASC-BLK-SUB ASC-ITEM-SUB)41450001
414600             END-EVALUATE                                         41460001
414700             MOVE SUT00030-FINCL-ADJ-ID  TO                       41470001
414800                           ASC-FINCL-ID (ASC-BLK-SUB ASC-ITEM-SUB)41480001
414900             IF PV-NULL-IND-3 < 0                                 41490025
415000                 MOVE ZEROES TO SUT00030-AUD-CNTL-NBR             41500025
415100             END-IF                                               41510025
415200             IF ASC-AUDIT-X = 'MULTIPLE'                          41520019
415300                 CONTINUE                                         41530018
415400             ELSE                                                 41540018
415500                 IF ASC-AUDIT NOT = SUT00030-AUD-CNTL-NBR         41550019
415600                     IF PS-FIRST-TIME-AUDIT                       41560024
415700                        MOVE SUT00030-AUD-CNTL-NBR  TO ASC-AUDIT  41570019
415800                        SET PS-NOT-FIRST-TIME-AUDIT TO TRUE       41580024
415900                     ELSE                                         41590018
416000                        MOVE 'MULTIPLE'             TO ASC-AUDIT-X41600019
416100                     END-IF                                       41610018
416200                 ELSE                                             41620018
416300                     MOVE SUT00030-AUD-CNTL-NBR  TO ASC-AUDIT     41630018
416400                 END-IF                                           41640018
416500             END-IF                                               41650018
416600         END-IF                                                   41660001
416700     END-PERFORM.                                                 41670001
416800                                                                  41680001
416900     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          41690001
417000         MOVE +1               TO ASC-BLK-SUB                     41700001
417100         PERFORM 5100-WRITE-TEMP-STORAGE                          41710001
417200         ADD +1                TO ASC-BLK-SUB                     41720001
417300         PERFORM 5100-WRITE-TEMP-STORAGE                          41730001
417400                                                                  41740001
417500         MOVE 1                TO ASC-BLK-SUB                     41750001
417600                                  PV-BLOCK-NUMBER                 41760001
417700         PERFORM 4410-READ-TEMP-STORAGE                           41770001
417800         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             41780001
417900             MOVE 2            TO ASC-BLK-SUB                     41790001
418000                                  PV-BLOCK-NUMBER                 41800001
418100             PERFORM 4410-READ-TEMP-STORAGE                       41810001
418200         END-IF                                                   41820001
418300     END-IF.                                                      41830001
418400                                                                  41840001
418500                                                                  41850001
418600*----------------------------------------------------------------*41860001
418700*    FETCH THE CURSOR                                             41870018
418800*----------------------------------------------------------------*41880001
418900 4310-FETCH.                                                      41890001
419000***                                                               41900058
419100* ADD DISPLAY FOR CURSOR BEING USED FOR TESTING PURPOSES          41910058
419200*    INITIALIZE PV-CICS-MSG-AREA                                  41920099
419300*    MOVE DK-SHIPT-UNT-ID  TO PV-DISP-SHIPT-UNT-ID                41930099
419400*    MOVE DK-OPER-UNT-ID   TO PV-DISP-OPER-UNT-ID                 41940099
419500*    MOVE DK-PO-NBR        TO PV-DISP-PO-NBR                      41950099
419600*    MOVE DK-RCVR-SEQ-NBR  TO PV-DISP-RCVR                        41960099
419700*    STRING ' SUKCS756 - CURSOR='                                 41970099
419800*            ASC-CURSOR-SW ' - '                                  41980099
419900*            PV-DISP-SHIPT-UNT-ID ' - '                           41990099
420000*            PV-DISP-OPER-UNT-ID  '-'                             42000099
420100*            PV-DISP-PO-NBR       '-'                             42010099
420200*            PV-DISP-RCVR                                         42020099
420300*           DELIMITED BY SIZE                                     42030099
420400*      INTO PV-CICS-MSG-AREA                                      42040099
420500*    EXEC CICS                                                    42050099
420600*        WRITEQ TD                                                42060099
420700*        QUEUE('CSSL')                                            42070099
420800*        FROM(PV-CICS-MSG-AREA)                                   42080099
420900*        RESP(PV-CICS-RESPONSE)                                   42090099
421000*    END-EXEC.                                                    42100099
421100                                                                  42110059
421200     MOVE SPACES TO PV-CICS-MSG-AREA.                             42120059
421300***                                                               42130058
421400                                                                  42140058
421500     EVALUATE TRUE                                                42150001
421600         WHEN ASC-OP-PO-RC-LN-SML-CSR                             42160082
421700             EXEC SQL                                             42170001
421800                  FETCH OPPO-RECLNESML-CSR                        42180088
421900                  INTO  :SUT00030-PO-NBR                          42190001
422000                       ,:SUT00030-RCVR-LNE-NBR                    42200001
422100                       ,:SUT00030-RCVR-SEQ-NBR                    42210001
422200                       ,:SUT00030-DEST-LOC-NBR                    42220001
422300                       ,:SUT00030-UPC-NBR                         42230001
422400                       ,:SUT00030-SHIPT-UNT-ID :PV-NULL-IND-2     42240001
422500                       ,:SUT00030-CRE-TMST                        42250001
422600                       ,:SUT00030-CRE-PGM-NM                      42260001
422700                       ,:SUT00030-FINCL-BEF-QTY                   42270001
422800                       ,:SUT00030-FINCL-AFT-QTY                   42280001
422900                       ,:SUT00030-AUTO-APL-IND                    42290001
423000                       ,:SUT00030-PRC-RSN-CDE                     42300001
423100                       ,:SUT00030-RSLV-BY-USR-ID                  42310001
423200                       ,:SUT00030-AUD-ADJ-STAT-CDE                42320001
423300                       ,:SUT00030-FINCL-ADJ-ID                    42330001
423400                       ,:SUT00030-ADJ-ERR-CDE  :PV-NULL-IND-1     42340025
423500                       ,:SUT00030-AUD-CNTL-NBR :PV-NULL-IND-3     42350025
423600                       ,:SURSNC-PRC-GP-CDE                        42360001
423700             END-EXEC                                             42370001
423800         WHEN ASC-OP-PO-RC-LN-AU-CSR                              42380082
423900             EXEC SQL                                             42390082
424000                  FETCH OP-PO-RC-LN-AU-CSR                        42400082
424100                  INTO  :SUT00030-PO-NBR                          42410082
424200                       ,:SUT00030-RCVR-LNE-NBR                    42420082
424300                       ,:SUT00030-RCVR-SEQ-NBR                    42430082
424400                       ,:SUT00030-DEST-LOC-NBR                    42440082
424500                       ,:SUT00030-UPC-NBR                         42450082
424600                       ,:SUT00030-SHIPT-UNT-ID :PV-NULL-IND-2     42460082
424700                       ,:SUT00030-CRE-TMST                        42470082
424800                       ,:SUT00030-CRE-PGM-NM                      42480082
424900                       ,:SUT00030-FINCL-BEF-QTY                   42490082
425000                       ,:SUT00030-FINCL-AFT-QTY                   42500082
425100                       ,:SUT00030-AUTO-APL-IND                    42510082
425200                       ,:SUT00030-PRC-RSN-CDE                     42520082
425300                       ,:SUT00030-RSLV-BY-USR-ID                  42530082
425400                       ,:SUT00030-AUD-ADJ-STAT-CDE                42540082
425500                       ,:SUT00030-FINCL-ADJ-ID                    42550082
425600                       ,:SUT00030-ADJ-ERR-CDE  :PV-NULL-IND-1     42560082
425700                       ,:SUT00030-AUD-CNTL-NBR :PV-NULL-IND-3     42570082
425800                       ,:SURSNC-PRC-GP-CDE                        42580082
425900             END-EXEC                                             42590082
426000         WHEN ASC-OP-PO-RC-LN-ST-CSR                              42600082
426100             EXEC SQL                                             42610011
426200                  FETCH OP-PO-RC-LN-ST-CSR                        42620011
426300                  INTO  :SUT00030-PO-NBR                          42630011
426400                       ,:SUT00030-RCVR-LNE-NBR                    42640011
426500                       ,:SUT00030-RCVR-SEQ-NBR                    42650011
426600                       ,:SUT00030-DEST-LOC-NBR                    42660011
426700                       ,:SUT00030-UPC-NBR                         42670011
426800                       ,:SUT00030-SHIPT-UNT-ID :PV-NULL-IND-2     42680011
426900                       ,:SUT00030-CRE-TMST                        42690011
427000                       ,:SUT00030-CRE-PGM-NM                      42700011
427100                       ,:SUT00030-FINCL-BEF-QTY                   42710011
427200                       ,:SUT00030-FINCL-AFT-QTY                   42720011
427300                       ,:SUT00030-AUTO-APL-IND                    42730011
427400                       ,:SUT00030-PRC-RSN-CDE                     42740011
427500                       ,:SUT00030-RSLV-BY-USR-ID                  42750011
427600                       ,:SUT00030-AUD-ADJ-STAT-CDE                42760011
427700                       ,:SUT00030-FINCL-ADJ-ID                    42770011
427800                       ,:SUT00030-ADJ-ERR-CDE  :PV-NULL-IND-1     42780025
427900                       ,:SUT00030-AUD-CNTL-NBR :PV-NULL-IND-3     42790025
428000                       ,:SURSNC-PRC-GP-CDE                        42800011
428100             END-EXEC                                             42810011
428200         WHEN ASC-OP-PO-REC-LNE-CSR                               42820011
428300             EXEC SQL                                             42830001
428400                  FETCH OP-PO-REC-LNE-CSR                         42840001
428500                  INTO  :SUT00030-PO-NBR                          42850001
428600                       ,:SUT00030-RCVR-LNE-NBR                    42860001
428700                       ,:SUT00030-RCVR-SEQ-NBR                    42870001
428800                       ,:SUT00030-DEST-LOC-NBR                    42880001
428900                       ,:SUT00030-UPC-NBR                         42890001
429000                       ,:SUT00030-SHIPT-UNT-ID :PV-NULL-IND-2     42900001
429100                       ,:SUT00030-CRE-TMST                        42910001
429200                       ,:SUT00030-CRE-PGM-NM                      42920001
429300                       ,:SUT00030-FINCL-BEF-QTY                   42930001
429400                       ,:SUT00030-FINCL-AFT-QTY                   42940001
429500                       ,:SUT00030-AUTO-APL-IND                    42950001
429600                       ,:SUT00030-PRC-RSN-CDE                     42960001
429700                       ,:SUT00030-RSLV-BY-USR-ID                  42970001
429800                       ,:SUT00030-AUD-ADJ-STAT-CDE                42980001
429900                       ,:SUT00030-FINCL-ADJ-ID                    42990001
430000                       ,:SUT00030-ADJ-ERR-CDE  :PV-NULL-IND-1     43000025
430100                       ,:SUT00030-AUD-CNTL-NBR :PV-NULL-IND-3     43010025
430200                       ,:SURSNC-PRC-GP-CDE                        43020001
430300             END-EXEC                                             43030001
430400         WHEN ASC-OPER-PO-REC-CSR                                 43040001
430500             EXEC SQL                                             43050001
430600                  FETCH OPER-PO-REC-CSR                           43060001
430700                  INTO  :SUT00030-PO-NBR                          43070001
430800                       ,:SUT00030-RCVR-LNE-NBR                    43080001
430900                       ,:SUT00030-RCVR-SEQ-NBR                    43090001
431000                       ,:SUT00030-DEST-LOC-NBR                    43100001
431100                       ,:SUT00030-UPC-NBR                         43110001
431200                       ,:SUT00030-SHIPT-UNT-ID :PV-NULL-IND-2     43120001
431300                       ,:SUT00030-CRE-TMST                        43130001
431400                       ,:SUT00030-CRE-PGM-NM                      43140001
431500                       ,:SUT00030-FINCL-BEF-QTY                   43150001
431600                       ,:SUT00030-FINCL-AFT-QTY                   43160001
431700                       ,:SUT00030-AUTO-APL-IND                    43170001
431800                       ,:SUT00030-PRC-RSN-CDE                     43180001
431900                       ,:SUT00030-RSLV-BY-USR-ID                  43190001
432000                       ,:SUT00030-AUD-ADJ-STAT-CDE                43200001
432100                       ,:SUT00030-FINCL-ADJ-ID                    43210001
432200                       ,:SUT00030-ADJ-ERR-CDE  :PV-NULL-IND-1     43220025
432300                       ,:SUT00030-AUD-CNTL-NBR :PV-NULL-IND-3     43230025
432400                       ,:SURSNC-PRC-GP-CDE                        43240001
432500             END-EXEC                                             43250001
432600         WHEN ASC-OPER-PO-CSR                                     43260001
432700             EXEC SQL                                             43270001
432800                  FETCH OPER-PO-CSR                               43280001
432900                  INTO  :SUT00030-PO-NBR                          43290001
433000                       ,:SUT00030-RCVR-LNE-NBR                    43300001
433100                       ,:SUT00030-RCVR-SEQ-NBR                    43310001
433200                       ,:SUT00030-DEST-LOC-NBR                    43320001
433300                       ,:SUT00030-UPC-NBR                         43330001
433400                       ,:SUT00030-SHIPT-UNT-ID :PV-NULL-IND-2     43340001
433500                       ,:SUT00030-CRE-TMST                        43350001
433600                       ,:SUT00030-CRE-PGM-NM                      43360001
433700                       ,:SUT00030-FINCL-BEF-QTY                   43370001
433800                       ,:SUT00030-FINCL-AFT-QTY                   43380001
433900                       ,:SUT00030-AUTO-APL-IND                    43390001
434000                       ,:SUT00030-PRC-RSN-CDE                     43400001
434100                       ,:SUT00030-RSLV-BY-USR-ID                  43410001
434200                       ,:SUT00030-AUD-ADJ-STAT-CDE                43420001
434300                       ,:SUT00030-FINCL-ADJ-ID                    43430001
434400                       ,:SUT00030-ADJ-ERR-CDE  :PV-NULL-IND-1     43440025
434500                       ,:SUT00030-AUD-CNTL-NBR :PV-NULL-IND-3     43450025
434600                       ,:SURSNC-PRC-GP-CDE                        43460001
434700             END-EXEC                                             43470001
434800         WHEN ASC-OPER-CSR                                        43480001
434900             EXEC SQL                                             43490001
435000                  FETCH OPER-CSR                                  43500001
435100                  INTO  :SUT00030-PO-NBR                          43510001
435200                       ,:SUT00030-RCVR-LNE-NBR                    43520001
435300                       ,:SUT00030-RCVR-SEQ-NBR                    43530001
435400                       ,:SUT00030-DEST-LOC-NBR                    43540001
435500                       ,:SUT00030-UPC-NBR                         43550001
435600                       ,:SUT00030-SHIPT-UNT-ID :PV-NULL-IND-2     43560001
435700                       ,:SUT00030-CRE-TMST                        43570001
435800                       ,:SUT00030-CRE-PGM-NM                      43580001
435900                       ,:SUT00030-FINCL-BEF-QTY                   43590001
436000                       ,:SUT00030-FINCL-AFT-QTY                   43600001
436100                       ,:SUT00030-AUTO-APL-IND                    43610001
436200                       ,:SUT00030-PRC-RSN-CDE                     43620001
436300                       ,:SUT00030-RSLV-BY-USR-ID                  43630001
436400                       ,:SUT00030-AUD-ADJ-STAT-CDE                43640001
436500                       ,:SUT00030-FINCL-ADJ-ID                    43650001
436600                       ,:SUT00030-ADJ-ERR-CDE  :PV-NULL-IND-1     43660025
436700                       ,:SUT00030-AUD-CNTL-NBR :PV-NULL-IND-3     43670025
436800                       ,:SURSNC-PRC-GP-CDE                        43680001
436900             END-EXEC                                             43690001
437000         WHEN ASC-PO-REC-LNE-DST-CSR                              43700001
437100             EXEC SQL                                             43710001
437200                  FETCH PO-REC-LNE-DST-CSR                        43720001
437300                  INTO  :SUT00030-PO-NBR                          43730001
437400                       ,:SUT00030-RCVR-LNE-NBR                    43740001
437500                       ,:SUT00030-RCVR-SEQ-NBR                    43750001
437600                       ,:SUT00030-DEST-LOC-NBR                    43760001
437700                       ,:SUT00030-UPC-NBR                         43770001
437800                       ,:SUT00030-SHIPT-UNT-ID :PV-NULL-IND-2     43780001
437900                       ,:SUT00030-CRE-TMST                        43790001
438000                       ,:SUT00030-CRE-PGM-NM                      43800001
438100                       ,:SUT00030-FINCL-BEF-QTY                   43810001
438200                       ,:SUT00030-FINCL-AFT-QTY                   43820001
438300                       ,:SUT00030-AUTO-APL-IND                    43830001
438400                       ,:SUT00030-PRC-RSN-CDE                     43840001
438500                       ,:SUT00030-RSLV-BY-USR-ID                  43850001
438600                       ,:SUT00030-AUD-ADJ-STAT-CDE                43860001
438700                       ,:SUT00030-FINCL-ADJ-ID                    43870001
438800                       ,:SUT00030-ADJ-ERR-CDE  :PV-NULL-IND-1     43880025
438900                       ,:SUT00030-AUD-CNTL-NBR :PV-NULL-IND-3     43890025
439000                       ,:SURSNC-PRC-GP-CDE                        43900001
439100             END-EXEC                                             43910001
439200         WHEN ASC-PO-REC-LNE-CSR                                  43920001
439300             EXEC SQL                                             43930001
439400                  FETCH PO-REC-LNE-CSR                            43940001
439500                  INTO  :SUT00030-PO-NBR                          43950001
439600                       ,:SUT00030-RCVR-LNE-NBR                    43960001
439700                       ,:SUT00030-RCVR-SEQ-NBR                    43970001
439800                       ,:SUT00030-DEST-LOC-NBR                    43980001
439900                       ,:SUT00030-UPC-NBR                         43990001
440000                       ,:SUT00030-SHIPT-UNT-ID :PV-NULL-IND-2     44000001
440100                       ,:SUT00030-CRE-TMST                        44010001
440200                       ,:SUT00030-CRE-PGM-NM                      44020001
440300                       ,:SUT00030-FINCL-BEF-QTY                   44030001
440400                       ,:SUT00030-FINCL-AFT-QTY                   44040001
440500                       ,:SUT00030-AUTO-APL-IND                    44050001
440600                       ,:SUT00030-PRC-RSN-CDE                     44060001
440700                       ,:SUT00030-RSLV-BY-USR-ID                  44070001
440800                       ,:SUT00030-AUD-ADJ-STAT-CDE                44080001
440900                       ,:SUT00030-FINCL-ADJ-ID                    44090001
441000                       ,:SUT00030-ADJ-ERR-CDE  :PV-NULL-IND-1     44100025
441100                       ,:SUT00030-AUD-CNTL-NBR :PV-NULL-IND-3     44110025
441200                       ,:SURSNC-PRC-GP-CDE                        44120001
441300             END-EXEC                                             44130001
441400         WHEN ASC-PO-REC-CSR                                      44140001
441500             EXEC SQL                                             44150001
441600                  FETCH PO-REC-CSR                                44160001
441700                  INTO  :SUT00030-PO-NBR                          44170001
441800                       ,:SUT00030-RCVR-LNE-NBR                    44180001
441900                       ,:SUT00030-RCVR-SEQ-NBR                    44190001
442000                       ,:SUT00030-DEST-LOC-NBR                    44200001
442100                       ,:SUT00030-UPC-NBR                         44210001
442200                       ,:SUT00030-SHIPT-UNT-ID :PV-NULL-IND-2     44220001
442300                       ,:SUT00030-CRE-TMST                        44230001
442400                       ,:SUT00030-CRE-PGM-NM                      44240001
442500                       ,:SUT00030-FINCL-BEF-QTY                   44250001
442600                       ,:SUT00030-FINCL-AFT-QTY                   44260001
442700                       ,:SUT00030-AUTO-APL-IND                    44270001
442800                       ,:SUT00030-PRC-RSN-CDE                     44280001
442900                       ,:SUT00030-RSLV-BY-USR-ID                  44290001
443000                       ,:SUT00030-AUD-ADJ-STAT-CDE                44300001
443100                       ,:SUT00030-FINCL-ADJ-ID                    44310001
443200                       ,:SUT00030-ADJ-ERR-CDE  :PV-NULL-IND-1     44320025
443300                       ,:SUT00030-AUD-CNTL-NBR :PV-NULL-IND-3     44330025
443400                       ,:SURSNC-PRC-GP-CDE                        44340001
443500             END-EXEC                                             44350001
443600         WHEN ASC-PO-CSR                                          44360001
443700             EXEC SQL                                             44370001
443800                  FETCH PO-CSR                                    44380001
443900                  INTO  :SUT00030-PO-NBR                          44390001
444000                       ,:SUT00030-RCVR-LNE-NBR                    44400001
444100                       ,:SUT00030-RCVR-SEQ-NBR                    44410001
444200                       ,:SUT00030-DEST-LOC-NBR                    44420001
444300                       ,:SUT00030-UPC-NBR                         44430001
444400                       ,:SUT00030-SHIPT-UNT-ID :PV-NULL-IND-2     44440001
444500                       ,:SUT00030-CRE-TMST                        44450001
444600                       ,:SUT00030-CRE-PGM-NM                      44460001
444700                       ,:SUT00030-FINCL-BEF-QTY                   44470001
444800                       ,:SUT00030-FINCL-AFT-QTY                   44480001
444900                       ,:SUT00030-AUTO-APL-IND                    44490001
445000                       ,:SUT00030-PRC-RSN-CDE                     44500001
445100                       ,:SUT00030-RSLV-BY-USR-ID                  44510001
445200                       ,:SUT00030-AUD-ADJ-STAT-CDE                44520001
445300                       ,:SUT00030-FINCL-ADJ-ID                    44530001
445400                       ,:SUT00030-ADJ-ERR-CDE  :PV-NULL-IND-1     44540025
445500                       ,:SUT00030-AUD-CNTL-NBR :PV-NULL-IND-3     44550025
445600                       ,:SURSNC-PRC-GP-CDE                        44560001
445700             END-EXEC                                             44570001
445800         WHEN ASC-OPER-UPC-CSR                                    44580001
445900             EXEC SQL                                             44590001
446000                  FETCH OPER-UPC-CSR                              44600001
446100                  INTO  :SUT00030-PO-NBR                          44610001
446200                       ,:SUT00030-RCVR-LNE-NBR                    44620001
446300                       ,:SUT00030-RCVR-SEQ-NBR                    44630001
446400                       ,:SUT00030-DEST-LOC-NBR                    44640001
446500                       ,:SUT00030-UPC-NBR                         44650001
446600                       ,:SUT00030-SHIPT-UNT-ID :PV-NULL-IND-2     44660001
446700                       ,:SUT00030-CRE-TMST                        44670001
446800                       ,:SUT00030-CRE-PGM-NM                      44680001
446900                       ,:SUT00030-FINCL-BEF-QTY                   44690001
447000                       ,:SUT00030-FINCL-AFT-QTY                   44700001
447100                       ,:SUT00030-AUTO-APL-IND                    44710001
447200                       ,:SUT00030-PRC-RSN-CDE                     44720001
447300                       ,:SUT00030-RSLV-BY-USR-ID                  44730001
447400                       ,:SUT00030-AUD-ADJ-STAT-CDE                44740001
447500                       ,:SUT00030-FINCL-ADJ-ID                    44750001
447600                       ,:SUT00030-ADJ-ERR-CDE  :PV-NULL-IND-1     44760025
447700                       ,:SUT00030-AUD-CNTL-NBR :PV-NULL-IND-3     44770025
447800                       ,:SURSNC-PRC-GP-CDE                        44780001
447900             END-EXEC                                             44790001
448000         WHEN ASC-UPC-CSR                                         44800001
448100             EXEC SQL                                             44810001
448200                  FETCH UPC-CSR                                   44820001
448300                  INTO  :SUT00030-PO-NBR                          44830001
448400                       ,:SUT00030-RCVR-LNE-NBR                    44840001
448500                       ,:SUT00030-RCVR-SEQ-NBR                    44850001
448600                       ,:SUT00030-DEST-LOC-NBR                    44860001
448700                       ,:SUT00030-UPC-NBR                         44870001
448800                       ,:SUT00030-SHIPT-UNT-ID :PV-NULL-IND-2     44880001
448900                       ,:SUT00030-CRE-TMST                        44890001
449000                       ,:SUT00030-CRE-PGM-NM                      44900001
449100                       ,:SUT00030-FINCL-BEF-QTY                   44910001
449200                       ,:SUT00030-FINCL-AFT-QTY                   44920001
449300                       ,:SUT00030-AUTO-APL-IND                    44930001
449400                       ,:SUT00030-PRC-RSN-CDE                     44940001
449500                       ,:SUT00030-RSLV-BY-USR-ID                  44950001
449600                       ,:SUT00030-AUD-ADJ-STAT-CDE                44960001
449700                       ,:SUT00030-FINCL-ADJ-ID                    44970001
449800                       ,:SUT00030-ADJ-ERR-CDE  :PV-NULL-IND-1     44980025
449900                       ,:SUT00030-AUD-CNTL-NBR :PV-NULL-IND-3     44990025
450000                       ,:SURSNC-PRC-GP-CDE                        45000001
450100             END-EXEC                                             45010001
450200         WHEN ASC-OPER-SKU-CSR                                    45020001
450300             EXEC SQL                                             45030001
450400                  FETCH OPER-SKU-CSR                              45040001
450500                  INTO  :SUT00030-PO-NBR                          45050001
450600                       ,:SUT00030-RCVR-LNE-NBR                    45060001
450700                       ,:SUT00030-RCVR-SEQ-NBR                    45070001
450800                       ,:SUT00030-DEST-LOC-NBR                    45080001
450900                       ,:SUT00030-UPC-NBR                         45090001
451000                       ,:SUT00030-SHIPT-UNT-ID :PV-NULL-IND-2     45100001
451100                       ,:SUT00030-CRE-TMST                        45110001
451200                       ,:SUT00030-CRE-PGM-NM                      45120001
451300                       ,:SUT00030-FINCL-BEF-QTY                   45130001
451400                       ,:SUT00030-FINCL-AFT-QTY                   45140001
451500                       ,:SUT00030-AUTO-APL-IND                    45150001
451600                       ,:SUT00030-PRC-RSN-CDE                     45160001
451700                       ,:SUT00030-RSLV-BY-USR-ID                  45170001
451800                       ,:SUT00030-AUD-ADJ-STAT-CDE                45180001
451900                       ,:SUT00030-FINCL-ADJ-ID                    45190001
452000                       ,:SUT00030-ADJ-ERR-CDE  :PV-NULL-IND-1     45200025
452100                       ,:SUT00030-AUD-CNTL-NBR :PV-NULL-IND-3     45210025
452200                       ,:SURSNC-PRC-GP-CDE                        45220001
452300             END-EXEC                                             45230001
452400         WHEN ASC-SKU-CSR                                         45240001
452500             EXEC SQL                                             45250001
452600                  FETCH SKU-CSR                                   45260001
452700                  INTO  :SUT00030-PO-NBR                          45270001
452800                       ,:SUT00030-RCVR-LNE-NBR                    45280001
452900                       ,:SUT00030-RCVR-SEQ-NBR                    45290001
453000                       ,:SUT00030-DEST-LOC-NBR                    45300001
453100                       ,:SUT00030-UPC-NBR                         45310001
453200                       ,:SUT00030-SHIPT-UNT-ID :PV-NULL-IND-2     45320001
453300                       ,:SUT00030-CRE-TMST                        45330001
453400                       ,:SUT00030-CRE-PGM-NM                      45340001
453500                       ,:SUT00030-FINCL-BEF-QTY                   45350001
453600                       ,:SUT00030-FINCL-AFT-QTY                   45360001
453700                       ,:SUT00030-AUTO-APL-IND                    45370001
453800                       ,:SUT00030-PRC-RSN-CDE                     45380001
453900                       ,:SUT00030-RSLV-BY-USR-ID                  45390001
454000                       ,:SUT00030-AUD-ADJ-STAT-CDE                45400001
454100                       ,:SUT00030-FINCL-ADJ-ID                    45410001
454200                       ,:SUT00030-ADJ-ERR-CDE  :PV-NULL-IND-1     45420025
454300                       ,:SUT00030-AUD-CNTL-NBR :PV-NULL-IND-3     45430025
454400                       ,:SURSNC-PRC-GP-CDE                        45440001
454500             END-EXEC                                             45450001
454600         WHEN ASC-AUDIT-CSR                                       45460001
454700             EXEC SQL                                             45470001
454800                  FETCH AUDIT-CSR                                 45480001
454900                  INTO  :SUT00030-PO-NBR                          45490001
455000                       ,:SUT00030-RCVR-LNE-NBR                    45500001
455100                       ,:SUT00030-RCVR-SEQ-NBR                    45510001
455200                       ,:SUT00030-DEST-LOC-NBR                    45520001
455300                       ,:SUT00030-UPC-NBR                         45530001
455400                       ,:SUT00030-SHIPT-UNT-ID :PV-NULL-IND-2     45540001
455500                       ,:SUT00030-CRE-TMST                        45550001
455600                       ,:SUT00030-CRE-PGM-NM                      45560001
455700                       ,:SUT00030-FINCL-BEF-QTY                   45570001
455800                       ,:SUT00030-FINCL-AFT-QTY                   45580001
455900                       ,:SUT00030-AUTO-APL-IND                    45590001
456000                       ,:SUT00030-PRC-RSN-CDE                     45600001
456100                       ,:SUT00030-RSLV-BY-USR-ID                  45610001
456200                       ,:SUT00030-AUD-ADJ-STAT-CDE                45620001
456300                       ,:SUT00030-FINCL-ADJ-ID                    45630001
456400                       ,:SUT00030-ADJ-ERR-CDE  :PV-NULL-IND-1     45640025
456500                       ,:SUT00030-AUD-CNTL-NBR :PV-NULL-IND-3     45650025
456600                       ,:SURSNC-PRC-GP-CDE                        45660001
456700             END-EXEC                                             45670001
456800         WHEN ASC-SHIPT-UNT-CSR                                   45680001
456900             EXEC SQL                                             45690001
457000                  FETCH SHIPT-UNIT-CSR                            45700001
457100                  INTO  :SUT00030-PO-NBR                          45710001
457200                       ,:SUT00030-RCVR-LNE-NBR                    45720001
457300                       ,:SUT00030-RCVR-SEQ-NBR                    45730001
457400                       ,:SUT00030-DEST-LOC-NBR                    45740001
457500                       ,:SUT00030-UPC-NBR                         45750001
457600                       ,:SUT00030-SHIPT-UNT-ID :PV-NULL-IND-2     45760001
457700                       ,:SUT00030-CRE-TMST                        45770001
457800                       ,:SUT00030-CRE-PGM-NM                      45780001
457900                       ,:SUT00030-FINCL-BEF-QTY                   45790001
458000                       ,:SUT00030-FINCL-AFT-QTY                   45800001
458100                       ,:SUT00030-AUTO-APL-IND                    45810001
458200                       ,:SUT00030-PRC-RSN-CDE                     45820001
458300                       ,:SUT00030-RSLV-BY-USR-ID                  45830001
458400                       ,:SUT00030-AUD-ADJ-STAT-CDE                45840001
458500                       ,:SUT00030-FINCL-ADJ-ID                    45850001
458600                       ,:SUT00030-ADJ-ERR-CDE  :PV-NULL-IND-1     45860025
458700                       ,:SUT00030-AUD-CNTL-NBR :PV-NULL-IND-3     45870025
458800                       ,:SURSNC-PRC-GP-CDE                        45880001
458900             END-EXEC                                             45890001
459000     END-EVALUATE.                                                45900001
459100                                                                  45910001
459200                                                                  45920001
459300     EVALUATE TRUE                                                45930001
459400         WHEN SQLCODE = ZERO                                      45940001
459500         WHEN SQLCODE = +100                                      45950001
459600              CONTINUE                                            45960001
459700         WHEN SQLWARN0 NOT = SPACE                                45970001
459800         WHEN SQLCODE NOT = ZERO                                  45980001
459900              MOVE '4310-FETCH-CURSOR' TO DP013-PARAGRAPH         45990001
460000              MOVE 'FETCH CURSOR PROBLEM '                        46000001
460100                               TO DP013-MESSAGE-TEXT (1)          46010001
460200              MOVE SQLCA       TO DP013-SQLCA                     46020001
460300              MOVE 'FINCLADJ'   TO DP013-DB2-TABLE-NAME (1)       46030001
460400              SET DP013-DB2-ABEND TO TRUE                         46040001
460500              PERFORM DP013-0000-PROCESS-ABEND                    46050001
460600     END-EVALUATE.                                                46060001
460700                                                                  46070001
460800     IF  SQLCODE EQUAL +100                                       46080001
460900         SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                      46090001
461000     END-IF.                                                      46100001
461100                                                                  46110001
461200*----------------------------------------------------------------*46120001
461300*    GET THE ADJUSTMENT SOURCE FROM TSURSNC                       46130001
461400*----------------------------------------------------------------*46140001
461500 4320-GET-ADJ-SOURCE.                                             46150001
461600     INITIALIZE SURSNC-PRC-RSN-DESC.                              46160001
461700                                                                  46170001
461800     EXEC SQL                                                     46180001
461900          SELECT PRC_RSN_DESC                                     46190001
462000          INTO  :SURSNC-PRC-RSN-DESC                              46200001
462100          FROM  TSURSNC                                           46210001
462200        WHERE    PRC_RSN_CDE    =  :SUT00030-CRE-PGM-NM           46220001
462300     END-EXEC.                                                    46230001
462400                                                                  46240001
462500     EVALUATE TRUE                                                46250001
462600         WHEN SQLCODE = +0                                        46260001
462700             CONTINUE                                             46270001
462800         WHEN OTHER                                               46280001
462900             MOVE SPACES TO SURSNC-PRC-RSN-DESC                   46290001
463000     END-EVALUATE.                                                46300001
463100                                                                  46310001
463200*----------------------------------------------------------------*46320001
463300*    GET THE ERROR CODE DESCRIPTION FROM TSURSNC                  46330001
463400*----------------------------------------------------------------*46340001
463500 4330-GET-ERR-CDE.                                                46350001
463600     INITIALIZE SUT00031-ADJ-ERR-SHRT-DESC.                       46360001
463700                                                                  46370001
463800     EXEC SQL                                                     46380001
463900          SELECT ADJ_ERR_SHRT_DESC                                46390001
464000          INTO  :SUT00031-ADJ-ERR-SHRT-DESC                       46400001
464100          FROM  SUT_ADJ_ERR_CDE                                   46410001
464200        WHERE    ADJ_ERR_CDE    =  :SUT00030-ADJ-ERR-CDE          46420001
464300     END-EXEC.                                                    46430001
464400                                                                  46440001
464500     EVALUATE TRUE                                                46450001
464600         WHEN SQLCODE = +0                                        46460001
464700             CONTINUE                                             46470001
464800         WHEN OTHER                                               46480001
464900             MOVE SPACES TO SUT00031-ADJ-ERR-SHRT-DESC            46490001
465000     END-EVALUATE.                                                46500001
465100                                                                  46510001
465200*----------------------------------------------------------------*46520001
465300*    GET THE SKU NUMBER USING XLKUT001                            46530001
465400*----------------------------------------------------------------*46540001
465500 4340-GET-SKU.                                                    46550001
465600     INITIALIZE XL001-ITEM-COMMAREA.                              46560001
465700     MOVE SUT00030-UPC-NBR     TO XL001-KEY-UPC-NBR.              46570001
465800     MOVE 'V'                  TO XL001-KEY-UPC-TYP-CDE.          46580002
465900     SET  XL001-BY-UPC-NBR                                        46590001
466000          XL001-SELECT-SKU     TO TRUE.                           46600001
466100     CALL XL001-VSM-PGM USING DFHEIBLK                            46610001
466200                           XL001-COMMAREA                         46620001
466300                           XL001-ITEM-COMMAREA.                   46630001
466400     EVALUATE TRUE                                                46640001
466500         WHEN XL001-SUCCESSFUL                                    46650001
466600              CONTINUE                                            46660001
466700         WHEN XL001-SKU-NOT-FOUND                                 46670001
466800             MOVE ZEROES TO XL001-SKU-NBR                         46680001
466900         WHEN XL001-SQL-ERROR                                     46690002
467000             PERFORM 4345-GET-SKU                                 46700002
467100     END-EVALUATE.                                                46710001
467200                                                                  46720001
467300*----------------------------------------------------------------*46730002
467400*    GET THE SKU NUMBER USING XLKUT001                            46740002
467500*----------------------------------------------------------------*46750002
467600 4345-GET-SKU.                                                    46760002
467700     INITIALIZE XL001-ITEM-COMMAREA.                              46770002
467800     MOVE SUT00030-UPC-NBR     TO XL001-KEY-UPC-NBR.              46780002
467900     MOVE 'I'                  TO XL001-KEY-UPC-TYP-CDE.          46790002
468000     SET  XL001-BY-UPC-NBR                                        46800002
468100          XL001-SELECT-SKU     TO TRUE.                           46810002
468200     CALL XL001-VSM-PGM USING DFHEIBLK                            46820002
468300                           XL001-COMMAREA                         46830002
468400                           XL001-ITEM-COMMAREA.                   46840002
468500     EVALUATE TRUE                                                46850002
468600         WHEN XL001-SUCCESSFUL                                    46860002
468700              CONTINUE                                            46870002
468800         WHEN OTHER                                               46880002
468900             MOVE ZEROES TO XL001-SKU-NBR                         46890002
469000     END-EVALUATE.                                                46900002
469100                                                                  46910002
469200*----------------------------------------------------------------*46920001
469300* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *46930001
469400*----------------------------------------------------------------*46940001
469500 4400-MOVE-COMMAREA-TO-SCREEN.                                    46950001
469600     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             46960001
469700         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          46970001
469800         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          46980001
469900             MOVE +1    TO ASC-BLK-SUB                            46990001
470000             PERFORM 5100-WRITE-TEMP-STORAGE                      47000001
470100             ADD +1     TO ASC-BLK-SUB                            47010001
470200             PERFORM 5100-WRITE-TEMP-STORAGE                      47020001
470300             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             47030001
470400                 GIVING PV-BLOCK-NUMBER                           47040001
470500                 REMAINDER PV-REMAINDER                           47050001
470600             IF  PV-REMAINDER > ZERO                              47060001
470700                 ADD +1 TO PV-BLOCK-NUMBER                        47070001
470800             END-IF                                               47080001
470900             MOVE +1    TO ASC-BLK-SUB                            47090001
471000             PERFORM 4410-READ-TEMP-STORAGE                       47100001
471100             ADD +1     TO ASC-BLK-SUB                            47110001
471200                           PV-BLOCK-NUMBER                        47120001
471300             PERFORM 4410-READ-TEMP-STORAGE                       47130001
471400     END-IF.                                                      47140001
471500     MOVE +1            TO ASC-BLK-SUB.                           47150001
471600     COMPUTE ASC-ITEM-SUB =                                       47160001
471700         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              47170001
471800         + PC-ITEMS-PER-PANEL).                                   47180001
471900*                                                                 47190001
472000     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        47200001
472100         ADD +1         TO ASC-BLK-SUB                            47210001
472200         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            47220001
472300     END-IF.                                                      47230001
472400*                                                                 47240001
472500     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           47250001
472600         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                47260001
472700     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        47270001
472800     PERFORM 4420-FORMAT-LIST-LINES                               47280001
472900         VARYING PV-SUB                                           47290001
473000         FROM PC-ITEMS-PER-PANEL BY -1                            47300001
473100         UNTIL PV-SUB < +1.                                       47310001
473200*                                                                 47320001
473300     COMPUTE ASC-ITEMS-DISPLAYED =                                47330001
473400         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          47340001
473500     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    47350001
473600                                      ASTRTITO.                   47360001
473700     MOVE ASC-ITEM-AT-BOT-OF-PANEL     TO AENDITO.                47370001
473800     MOVE ASC-NUMBER-OF-ITEMS-READ     TO ATOTITO.                47380001
473900     MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO ASELITO.                47390001
474000                                                                  47400001
474100     MOVE ASC-OPER-UNT-ID      TO PV-OPER-UNT-ID.                 47410004
474200     MOVE PV-OPER-UNT-ID       TO AOPERO.                         47420004
474300     IF ASC-OPER-UNT-ID > ZERO                                    47430001
474400         PERFORM 4407-GET-OPER-NAME                               47440001
474500         MOVE ASC-OPER-NAME     TO AOPNAMEO                       47450001
474600     ELSE                                                         47460001
474700         MOVE SPACES            TO AOPNAMEO                       47470001
474800     END-IF.                                                      47480001
474900                                                                  47490001
475000     EVALUATE TRUE                                                47500001
475100        WHEN ASC-UNT-ADJ-TYP = 'P'                                47510001
475200             MOVE 'POST VERIFY'     TO AADJTYPO                   47520001
475300        WHEN ASC-UNT-ADJ-TYP = 'C'                                47530001
475400             MOVE 'CONFIRM    '     TO AADJTYPO                   47540001
475500        WHEN ASC-UNT-ADJ-TYP = 'V'                                47550001
475600             MOVE 'VERIFY    '      TO AADJTYPO                   47560001
475700        WHEN ASC-UNT-ADJ-TYP = 'Q'                                47570001
475800             MOVE 'P2L ADJUST'      TO AADJTYPO                   47580001
475900        WHEN OTHER                                                47590001
476000             MOVE 'ALL       '      TO AADJTYPO                   47600001
476100     END-EVALUATE.                                                47610001
476200                                                                  47620001
476300     IF ASC-PO-RCVR = '000000000-000'                             47630001
476400         IF ASC-MULTIPLE-PO-REC-LNE                               47640031
476500             MOVE 'MULTIPLE'           TO APORCVRO                47650031
476600             MOVE 0                    TO ALINEO                  47660031
476700         ELSE                                                     47670031
476800             IF ASC-CURSOR-PO-NBR > 0                             47680031
476900                 MOVE ASC-CURSOR-PO-NBR                           47690031
477000                                          TO ASC-PO-NBR-2         47700031
477100                 MOVE '-'                 TO ASC-PO-RCVR-DASH-2   47710031
477200                 MOVE ASC-CURSOR-RCVR-NBR                         47720031
477300                                          TO ASC-RCVR-NBR-2       47730031
477400                 MOVE ASC-PO-RCVR-2       TO APORCVRO             47740031
477500                 MOVE ASC-CURSOR-LINE-NBR  TO ALINEO              47750031
477600             ELSE                                                 47760031
477700                 MOVE SPACES               TO APORCVRO            47770031
477800                 MOVE 0                    TO ALINEO              47780031
477900             END-IF                                               47790031
478000         END-IF                                                   47800031
478100     ELSE                                                         47810001
478200         MOVE ASC-PO-NBR           TO ASC-PO-NBR-2                47820001
478300         MOVE '-'                  TO ASC-PO-RCVR-DASH-2          47830001
478400         MOVE ASC-RCVR-NBR         TO ASC-RCVR-NBR-2              47840001
478500         MOVE ASC-PO-RCVR-2        TO APORCVRO                    47850001
478600         MOVE ASC-LINE             TO ALINEO                      47860031
478700     END-IF.                                                      47870001
478800     IF ASC-FAIL-SUCCESS-IND = 'F'                                47880001
478900         MOVE 'FAIL       '     TO ASTATUSO                       47890001
479000     ELSE                                                         47900001
479100         IF ASC-FAIL-SUCCESS-IND = 'S'                            47910001
479200             MOVE 'SUCCESSFUL'     TO ASTATUSO                    47920001
479300         ELSE                                                     47930001
479400             IF ASC-FAIL-SUCCESS-IND = 'U'                        47940001
479500                 MOVE 'UNACKNOWLEDGED'  TO ASTATUSO               47950001
479600             ELSE                                                 47960001
479700                 MOVE 'ALL           '  TO ASTATUSO               47970001
479800             END-IF                                               47980001
479900         END-IF                                                   47990001
480000     END-IF.                                                      48000001
480100                                                                  48010001
480200* ADDED 8/19/03 DMH - BEGIN                                       48020001
480300     MOVE  ASC-PROCESS-GRP-DESC  TO  AGROUPO.                     48030001
480400* ADDED 8/19/03 DMH - END                                         48040001
480500                                                                  48050001
480600     IF ASC-AUDIT-X = 'MULTIPLE'                                  48060018
480700         MOVE 'MULTIPLE' TO ASC-AUD-STAT                          48070018
480800     ELSE                                                         48080018
480900         PERFORM 4405-GET-AUDIT-STATUS                            48090018
481000     END-IF.                                                      48100018
481100     MOVE ASC-AUDIT            TO PV-AUDIT.                       48110018
481200     MOVE ASC-AUD-STAT         TO PV-AUD-STAT.                    48120018
481300     MOVE PV-AUDIT-STATUS      TO AAUDSTAO.                       48130018
481400     IF ASC-SKU > 0 AND                                           48140031
481500        ASC-UPC > 0                                               48150031
481600         MOVE ASC-UPC              TO PV-UPC                      48160031
481700         MOVE ASC-SKU              TO PV-SKU                      48170031
481800         MOVE PV-SKU-UPC           TO ASKUUPCO                    48180031
481900     ELSE                                                         48190031
482000         IF ASC-NOT-MULTIPLE-UPC                                  48200031
482100             MOVE ASC-CURSOR-UPC   TO PV-UPC                      48210031
482200             IF ASC-CURSOR-UPC > ZEROES                           48220034
482300                 MOVE ASC-CURSOR-UPC   TO SUT00030-UPC-NBR        48230031
482400                 PERFORM 4340-GET-SKU                             48240031
482500                 MOVE XL001-SKU-NBR    TO PV-SKU                  48250031
482600             ELSE                                                 48260031
482700                 MOVE 0        TO PV-SKU                          48270031
482800             END-IF                                               48280031
482900             MOVE PV-SKU-UPC           TO ASKUUPCO                48290031
483000         ELSE                                                     48300031
483100             MOVE 'MULTIPLE '      TO ASKUUPCO                    48310031
483200         END-IF                                                   48320031
483300     END-IF.                                                      48330031
483400                                                                  48340031
483500                                                                  48350001
483600     MOVE ASC-FROM-YY          TO DK-DIS-YY-FR.                   48360001
483700     MOVE ASC-FROM-MM          TO DK-DIS-MM-FR.                   48370001
483800     MOVE ASC-FROM-DD          TO DK-DIS-DD-FR.                   48380001
483900     MOVE ASC-TO-YY            TO DK-DIS-YY-TO.                   48390001
484000     MOVE ASC-TO-MM            TO DK-DIS-MM-TO.                   48400001
484100     MOVE ASC-TO-DD            TO DK-DIS-DD-TO.                   48410001
484200     MOVE DK-DISPLAY-DATE      TO ADATEO.                         48420001
484300                                                                  48430001
484400     IF ASC-SML-X = 'MULTIPLE'                                    48440030
484500         MOVE ASC-SML-X      TO ASMLO                             48450030
484600     ELSE                                                         48460030
484700         MOVE ASC-SML        TO DK-SML-Z                          48470030
484800         MOVE DK-SML-Z       TO ASMLO                             48480030
484900     END-IF.                                                      48490030
485000                                                                  48500001
485100     IF  DP020-MSG-NUMBER-X = SPACE                               48510001
485200         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  48520001
485300*            --- MORE ITEMS TO DISPLAY ----                       48530001
485400             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            48540001
485500             SET DP020-MSG-INFORMATIONAL TO TRUE                  48550001
485600         END-IF                                                   48560001
485700     END-IF.                                                      48570001
485800                                                                  48580001
485900*----------------------------------------------------------------*48590001
486000*    GET THE AUDIT STATUS FROM SUT_PO_AUD_REQ                     48600001
486100*----------------------------------------------------------------*48610001
486200 4405-GET-AUDIT-STATUS.                                           48620001
486300                                                                  48630001
486400     MOVE ASC-AUDIT  TO  DK-AUDIT.                                48640001
486500     EXEC SQL                                                     48650001
486600          SELECT AUD_STAT_CDE                                     48660001
486700          INTO  :SUT00015-AUD-STAT-CDE                            48670001
486800          FROM  SUT_PO_AUD_REQ                                    48680001
486900        WHERE    AUD_CNTL_NBR   =  :DK-AUDIT                      48690001
487000     END-EXEC.                                                    48700001
487100                                                                  48710001
487200     EVALUATE TRUE                                                48720001
487300         WHEN SQLCODE = +0                                        48730001
487400             IF SUT00015-AUD-STAT-CDE = 'P'                       48740001
487500                 MOVE 'PASS     '  TO  ASC-AUD-STAT               48750001
487600             ELSE                                                 48760001
487700                 IF SUT00015-AUD-STAT-CDE = 'F'                   48770001
487800                     MOVE 'FAIL     '  TO  ASC-AUD-STAT           48780001
487900                 ELSE                                             48790001
488000                     IF SUT00015-AUD-STAT-CDE = 'I'               48800001
488100                         MOVE 'INPROCESS'  TO  ASC-AUD-STAT       48810001
488200                     ELSE                                         48820001
488300                         IF SUT00015-AUD-STAT-CDE = 'N'           48830001
488400                             MOVE 'NOT NEEDD'  TO  ASC-AUD-STAT   48840001
488500                         END-IF                                   48850001
488600                     END-IF                                       48860001
488700                 END-IF                                           48870001
488800             END-IF                                               48880001
488900         WHEN OTHER                                               48890001
489000             PERFORM 4406-TRY-TSUNAUD                             48900001
489100     END-EVALUATE.                                                48910001
489200                                                                  48920001
489300*----------------------------------------------------------------*48930001
489400*    GET THE AUDIT STATUS FROM TSUNAUD                            48940001
489500*----------------------------------------------------------------*48950001
489600 4406-TRY-TSUNAUD.                                                48960001
489700                                                                  48970001
489800     EXEC SQL                                                     48980001
489900          SELECT AUD_STAT_CDE                                     48990001
490000          INTO  :SUNAUD-AUD-STAT-CDE                              49000001
490100          FROM  TSUNAUD                                           49010001
490200        WHERE    AUD_CNTL_NBR   =  :DK-AUDIT                      49020001
490300     END-EXEC.                                                    49030001
490400                                                                  49040001
490500     EVALUATE TRUE                                                49050001
490600         WHEN SQLCODE = +0                                        49060001
490700             IF SUNAUD-AUD-STAT-CDE = 'CM'                        49070001
490800                 MOVE 'COMPLETED'  TO  ASC-AUD-STAT               49080001
490900             ELSE                                                 49090001
491000                 IF SUNAUD-AUD-STAT-CDE = 'IP'                    49100001
491100                     MOVE 'INPROCESS'  TO  ASC-AUD-STAT           49110001
491200                 ELSE                                             49120001
491300                     IF SUNAUD-AUD-STAT-CDE = 'PP'                49130001
491400                         MOVE 'POSTPONED'  TO  ASC-AUD-STAT       49140001
491500                     END-IF                                       49150001
491600                 END-IF                                           49160001
491700             END-IF                                               49170001
491800         WHEN OTHER                                               49180001
491900             MOVE SPACES TO ASC-AUD-STAT                          49190001
492000     END-EVALUATE.                                                49200001
492100                                                                  49210001
492200**************************************************************    49220001
492300*  RETRIEVE OPER UNIT NAME                                        49230001
492400**************************************************************    49240001
492500 4407-GET-OPER-NAME.                                              49250001
492600                                                                  49260001
493000     INITIALIZE XL071-COMMAREA-REC.                               49300099
493100     MOVE ASC-OPER-UNT-ID  TO  XL071-LOCATION-NUMBER.             49310099
493200                                                                  49320099
493300     CALL PC-LOCATION-MODULE  USING                               49330099
493400                                    DFHEIBLK                      49340099
493500                                    XL071-COMMAREA                49350099
493600                                    XL071-COMMAREA-REC.           49360099
493700                                                                  49370099
493800     EVALUATE TRUE                                                49380099
493900         WHEN XL071-NO-ERRORS                                     49390099
494000             IF XL071-LOC-TYP-CDE = 'DC' OR 'HQ'                  49400099
494100                 MOVE XL071-LOC-NM   TO ASC-OPER-NAME             49410099
494200             ELSE                                                 49420099
494300                 MOVE SPACES         TO ASC-OPER-NAME             49430099
494400             END-IF                                               49440099
494500         WHEN OTHER                                               49450099
494600             MOVE SPACES             TO ASC-OPER-NAME             49460099
494700     END-EVALUATE.                                                49470099
494800                                                                  49480099
494900*----------------------------------------------------------------*49490001
495000*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *49500001
495100*----------------------------------------------------------------*49510001
495200 4410-READ-TEMP-STORAGE.                                          49520001
495300                                                                  49530001
495400     EXEC CICS                                                    49540001
495500         READQ TS                                                 49550001
495600             QUEUE (ASC-LIST-QUEUE-NAME)                          49560001
495700             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               49570001
495800             ITEM  (PV-BLOCK-NUMBER)                              49580001
495900             RESP  (PV-CICS-RESP)                                 49590001
496000     END-EXEC.                                                    49600001
496100                                                                  49610001
496200     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       49620001
496300       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     49630001
496400         CONTINUE                                                 49640001
496500     ELSE                                                         49650001
496600         SET DP013-CICS-ABEND     TO TRUE                         49660001
496700         SET DP013-NO-ROLLBACK    TO TRUE                         49670001
496800         MOVE '4410-READ-TEMP-STORAGE'                            49680001
496900                                  TO DP013-PARAGRAPH              49690001
497000         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      49700001
497100                                  TO DP013-MESSAGE-TEXT(1)        49710001
497200         PERFORM DP013-0000-PROCESS-ABEND                         49720001
497300     END-IF.                                                      49730001
497400                                                                  49740001
497500     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             49750001
497600*                                                                 49760001
497700     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         49770001
497800         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               49780001
497900     END-IF.                                                      49790001
498000                                                                  49800001
498100*----------------------------------------------------------------*49810001
498200*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *49820001
498300*----------------------------------------------------------------*49830001
498400 4420-FORMAT-LIST-LINES.                                          49840001
498500     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      49850001
498600         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                49860001
498700         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           49870001
498800         MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           49880001
498900         MOVE SPACE              TO MR-SELECTI    (PV-SUB)        49890001
499000                                    MR-ACTION     (PV-SUB)        49900001
499100                                    MR-DATE       (PV-SUB)        49910001
499200                                    MR-TIME       (PV-SUB)        49920001
499300                                    MR-ADJ-SOURCE (PV-SUB)        49930001
499400                                    MR-FAIL-SUCCSS(PV-SUB)        49940001
499500                                    MR-ERR-CDE    (PV-SUB)        49950001
499600                                    MR-ACKNOWLEDGE(PV-SUB)        49960001
499700                                    MR-ADJ-TYP    (PV-SUB)        49970001
499800                                    MR-BEF-QTY    (PV-SUB)        49980001
499900                                    MR-AFT-QTY    (PV-SUB)        49990001
500000          MOVE ZEROES            TO MR-STR-NBR    (PV-SUB)        50000001
500100                                    MR-UPC-SKU    (PV-SUB)        50010001
500200     ELSE                                                         50020001
500300         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      50030001
500400                                                   > SPACE        50040001
500500             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 50050001
500600                                 TO MR-SELECTI (PV-SUB)           50060001
500700         ELSE                                                     50070001
500800             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      50080001
500900                                 TO MR-SELECTI (PV-SUB)           50090001
501000         END-IF                                                   50100001
501100         IF  DP030-SET-CURSOR-TRAILER                             50110001
501200             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)50120001
501300                 > SPACE)                                         50130001
501400               OR (PV-SUB = 1))                                   50140001
501500                SET DP030-SET-CURSOR-APPL-1 TO TRUE               50150001
501600                MOVE -1               TO MR-SELECTL (PV-SUB)      50160001
501700             END-IF                                               50170001
501800         END-IF                                                   50180001
501900*                                                                 50190001
502000         MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)               50200001
502100                                            TO MR-ACTION (PV-SUB) 50210001
502200         MOVE ASC-STORE (ASC-BLK-SUB ASC-ITEM-SUB)                50220001
502300                                            TO MR-STR-NBR (PV-SUB)50230001
502400         MOVE ASC-UPC-SKU-NBR (ASC-BLK-SUB ASC-ITEM-SUB)          50240001
502500                                            TO MR-UPC-SKU (PV-SUB)50250001
502600         MOVE ASC-DATE (ASC-BLK-SUB ASC-ITEM-SUB)                 50260001
502700                                               TO MR-DATE (PV-SUB)50270001
502800         MOVE ASC-TIME (ASC-BLK-SUB ASC-ITEM-SUB)                 50280001
502900                                              TO MR-TIME  (PV-SUB)50290001
503000         MOVE ASC-ADJ-SRCE (ASC-BLK-SUB ASC-ITEM-SUB)             50300001
503100                                         TO MR-ADJ-SOURCE (PV-SUB)50310001
503200         MOVE ASC-BEF-QTY (ASC-BLK-SUB ASC-ITEM-SUB)              50320001
503300                                            TO MR-BEF-QTY (PV-SUB)50330001
503400         MOVE ASC-AFT-QTY (ASC-BLK-SUB ASC-ITEM-SUB)              50340001
503500                                            TO MR-AFT-QTY (PV-SUB)50350001
503600         MOVE ASC-FAIL-SUCCSS (ASC-BLK-SUB ASC-ITEM-SUB)          50360001
503700                                        TO MR-FAIL-SUCCSS (PV-SUB)50370001
503800         MOVE ASC-ERR-CDE (ASC-BLK-SUB ASC-ITEM-SUB)              50380001
503900                                            TO MR-ERR-CDE (PV-SUB)50390001
504000         MOVE ASC-ACKNOWLEDGE (ASC-BLK-SUB ASC-ITEM-SUB)          50400001
504100                                        TO MR-ACKNOWLEDGE (PV-SUB)50410001
504200         MOVE ASC-ADJ-TYP (ASC-BLK-SUB ASC-ITEM-SUB)              50420001
504300                                           TO MR-ADJ-TYP (PV-SUB) 50430001
504400         IF MR-FAIL-SUCCSS (PV-SUB) = 'F'  AND                    50440001
504500            MR-ACKNOWLEDGE (PV-SUB) = 'U'                         50450001
504600             MOVE DP015-YELLOW         TO MR-STR-NBRC     (PV-SUB)50460001
504700             MOVE -1                   TO MR-STR-NBRL     (PV-SUB)50470001
504800             MOVE DP015-YELLOW         TO MR-UPC-SKUC     (PV-SUB)50480001
504900             MOVE -1                   TO MR-UPC-SKUL     (PV-SUB)50490001
505000             MOVE DP015-YELLOW         TO MR-DATEC        (PV-SUB)50500001
505100             MOVE -1                   TO MR-DATEL        (PV-SUB)50510001
505200             MOVE DP015-YELLOW         TO MR-TIMEC        (PV-SUB)50520001
505300             MOVE -1                   TO MR-TIMEL        (PV-SUB)50530001
505400             MOVE DP015-YELLOW         TO MR-ADJ-SOURCEC  (PV-SUB)50540001
505500             MOVE -1                   TO MR-ADJ-SOURCEL  (PV-SUB)50550001
505600             MOVE DP015-YELLOW         TO MR-BEF-QTYC     (PV-SUB)50560001
505700             MOVE -1                   TO MR-BEF-QTYL     (PV-SUB)50570001
505800             MOVE DP015-YELLOW         TO MR-AFT-QTYC     (PV-SUB)50580001
505900             MOVE -1                   TO MR-AFT-QTYL     (PV-SUB)50590001
506000             MOVE DP015-YELLOW         TO MR-FAIL-SUCCSSC (PV-SUB)50600001
506100             MOVE -1                   TO MR-FAIL-SUCCSSL (PV-SUB)50610001
506200             MOVE DP015-YELLOW         TO MR-ERR-CDEC     (PV-SUB)50620001
506300             MOVE -1                   TO MR-ERR-CDEL     (PV-SUB)50630001
506400             MOVE DP015-YELLOW         TO MR-ACKNOWLEDGEC (PV-SUB)50640001
506500             MOVE -1                   TO MR-ACKNOWLEDGEL (PV-SUB)50650001
506600             MOVE DP015-YELLOW         TO MR-ADJ-TYPC     (PV-SUB)50660001
506700             MOVE -1                   TO MR-ADJ-TYPL     (PV-SUB)50670001
506800         ELSE                                                     50680001
506900             MOVE DP015-BLUE           TO MR-STR-NBRC     (PV-SUB)50690001
507000             MOVE 0                    TO MR-STR-NBRL     (PV-SUB)50700001
507100             MOVE DP015-BLUE           TO MR-UPC-SKUC     (PV-SUB)50710001
507200             MOVE 0                    TO MR-UPC-SKUL     (PV-SUB)50720001
507300             MOVE DP015-BLUE           TO MR-DATEC        (PV-SUB)50730001
507400             MOVE 0                    TO MR-DATEL        (PV-SUB)50740001
507500             MOVE DP015-BLUE           TO MR-TIMEC        (PV-SUB)50750001
507600             MOVE 0                    TO MR-TIMEL        (PV-SUB)50760001
507700             MOVE DP015-BLUE           TO MR-ADJ-SOURCEC  (PV-SUB)50770001
507800             MOVE 0                    TO MR-ADJ-SOURCEL  (PV-SUB)50780001
507900             MOVE DP015-BLUE           TO MR-BEF-QTYC     (PV-SUB)50790001
508000             MOVE 0                    TO MR-BEF-QTYL     (PV-SUB)50800001
508100             MOVE DP015-BLUE           TO MR-AFT-QTYC     (PV-SUB)50810001
508200             MOVE 0                    TO MR-AFT-QTYL     (PV-SUB)50820001
508300             MOVE DP015-BLUE           TO MR-FAIL-SUCCSSC (PV-SUB)50830001
508400             MOVE 0                    TO MR-FAIL-SUCCSSL (PV-SUB)50840001
508500             MOVE DP015-BLUE           TO MR-ERR-CDEC     (PV-SUB)50850001
508600             MOVE 0                    TO MR-ERR-CDEL     (PV-SUB)50860001
508700             MOVE DP015-BLUE           TO MR-ACKNOWLEDGEC (PV-SUB)50870001
508800             MOVE 0                    TO MR-ACKNOWLEDGEL (PV-SUB)50880001
508900             MOVE DP015-BLUE           TO MR-ADJ-TYPC     (PV-SUB)50890001
509000             MOVE 0                    TO MR-ADJ-TYPL     (PV-SUB)50900001
509100         END-IF                                                   50910001
509200     END-IF.                                                      50920001
509300     SUBTRACT +1 FROM ASC-ITEM-SUB                                50930001
509400     IF  ASC-ITEM-SUB < + 1                                       50940001
509500         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  50950001
509600         MOVE +1                 TO ASC-BLK-SUB                   50960001
509700     END-IF.                                                      50970001
509800                                                                  50980001
509900******************************************************************50990001
510000** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **51000001
510100** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **51010001
510200** ISSUE A WARNING.                                             **51020001
510300******************************************************************51030001
510400 4430-CHECK-FOR-BEGIN-AND-END.                                    51040001
510500     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       51050001
510600         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     51060001
510700*            -- NO END-OF-RANGE SPECFIED ---                      51070001
510800             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            51080001
510900             SET DP020-MSG-WARNING TO TRUE                        51090001
511000             PERFORM 4431-POSITION-AT-WARNING                     51100001
511100         END-IF                                                   51110001
511200     ELSE                                                         51120001
511300         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     51130001
511400*            -- NO BEGINNING-OF-RANGE SPECFIED ---                51140001
511500             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            51150001
511600             SET DP020-MSG-WARNING TO TRUE                        51160001
511700             PERFORM 4431-POSITION-AT-WARNING                     51170001
511800         END-IF                                                   51180001
511900     END-IF.                                                      51190001
512000******************************************************************51200001
512100** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **51210001
512200** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **51220001
512300** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **51230001
512400** POSITION THE CURSOR THERE.                                   **51240001
512500******************************************************************51250001
512600 4431-POSITION-AT-WARNING.                                        51260001
512700     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 51270001
512800                    - PV-TOP-ITEM + 1.                            51280001
512900     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      51290001
513000         CONTINUE                                                 51300001
513100     ELSE                                                         51310001
513200         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      51320001
513300         MOVE -1                    TO ASTRTITL                   51330001
513400     END-IF.                                                      51340001
513500*                                                                 51350001
513600     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   51360001
513700                    - PV-TOP-ITEM + 1.                            51370001
513800     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      51380001
513900         CONTINUE                                                 51390001
514000     ELSE                                                         51400001
514100         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      51410001
514200         MOVE -1                   TO ASTRTITL                    51420001
514300     END-IF.                                                      51430001
514400                                                                  51440001
514500*----------------------------------------------------------------*51450001
514600* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *51460001
514700* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *51470001
514800* FOR THE SELECTED ITEMS QUEUE.                                  *51480001
514900*                                                                *51490001
515000* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *51500001
515100* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *51510001
515200* THE ARRAY IS FULL.                                             *51520001
515300*----------------------------------------------------------------*51530001
515400 5000-PREPARE-SEL-QUEUE.                                          51540001
515500                                                                  51550001
515600     MOVE +1                   TO  ASC-BLK-SUB.                   51560001
515700     PERFORM 5100-WRITE-TEMP-STORAGE.                             51570001
515800     ADD +1                    TO  ASC-BLK-SUB.                   51580001
515900     PERFORM 5100-WRITE-TEMP-STORAGE.                             51590001
516000                                                                  51600001
516100     MOVE ASC-SEL-QUEUE-OUT    TO  SU038-SEL-QUEUE-NAME.          51610001
516200     PERFORM 6010-DELETE-SEL-QUEUE.                               51620001
516300                                                                  51630001
516400     SET ASC-UPDATE-TSQ        TO  TRUE.                          51640001
516500                                                                  51650001
516600     SET SU039-IDX             TO  1.                             51660001
516700     MOVE ZERO                 TO SU038-NUMBER-OF-TS-ITEMS.       51670001
516800     INITIALIZE SU039-SELECTED-ITEM-ARRAY.                        51680001
516900                                                                  51690001
517000     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           51700001
517100             VARYING PV-ITEM                                      51710001
517200             FROM 1 BY 1                                          51720001
517300             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     51730001
517400                                                                  51740001
517500     IF  SU039-IDX > 1                                            51750001
517600         PERFORM 5205-WRITE-SEL-QUEUE                             51760001
517700         ADD +1                TO SU038-NUMBER-OF-TS-ITEMS        51770001
517800     END-IF.                                                      51780001
517900*----------------------------------------------------------------*51790001
518000* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *51800001
518100* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *51810001
518200* FOR THE SELECTED ITEMS QUEUE.                                  *51820001
518300*                                                                *51830001
518400* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *51840001
518500* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *51850001
518600* THE ARRAY IS FULL.                                             *51860001
518700*----------------------------------------------------------------*51870001
518800 5050-PREPARE-SEL-QUEUE.                                          51880001
518900     MOVE +1                   TO  ASC-BLK-SUB.                   51890048
519000     PERFORM 5100-WRITE-TEMP-STORAGE.                             51900048
519100     ADD +1                    TO  ASC-BLK-SUB.                   51910048
519200     PERFORM 5100-WRITE-TEMP-STORAGE.                             51920048
519300                                                                  51930048
519400     MOVE ASC-SEL-QUEUE-OUT    TO  PC000-SEL-QUEUE-NAME.          51940048
519500     PERFORM 6010-DELETE-SEL-QUEUE.                               51950048
519600                                                                  51960048
519700     SET ASC-UPDATE-TSQ        TO  TRUE.                          51970048
519800                                                                  51980048
519900     SET RC013-IDX             TO  1.                             51990048
520000     MOVE ZERO                 TO PC000-NUMBER-OF-TS-ITEMS        52000048
520100                            PC000-NUMBER-OF-SELECTED-ITEMS.       52010048
520200     INITIALIZE RC013-SELECTED-ITEM-ARRAY.                        52020048
520300                                                                  52030048
520400     PERFORM 5210-FILL-SEL-QUEUE-RECORD                           52040048
520500             VARYING PV-ITEM                                      52050048
520600             FROM 1 BY 1                                          52060048
520700             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     52070048
520800                                                                  52080048
520900     IF  RC013-IDX > 1                                            52090048
521000         PERFORM 5215-WRITE-SEL-QUEUE                             52100048
521100         ADD +1                TO PC000-NUMBER-OF-TS-ITEMS        52110048
521200     END-IF.                                                      52120048
521300                                                                  52130048
521400*----------------------------------------------------------------*52140048
521500* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *52150048
521600* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *52160048
521700* FOR THE SELECTED ITEMS QUEUE.                                  *52170048
521800*                                                                *52180048
521900* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *52190048
522000* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *52200048
522100* THE ARRAY IS FULL.                                             *52210048
522200*----------------------------------------------------------------*52220048
522300 5075-PREPARE-SEL-QUEUE.                                          52230048
522400                                                                  52240048
522500     MOVE +1                   TO  ASC-BLK-SUB.                   52250048
522600     PERFORM 5100-WRITE-TEMP-STORAGE.                             52260048
522700     ADD +1                    TO  ASC-BLK-SUB.                   52270048
522800     PERFORM 5100-WRITE-TEMP-STORAGE.                             52280048
522900                                                                  52290048
523000     MOVE ASC-SEL-QUEUE-OUT    TO  SU009-SEL-QUEUE-NAME.          52300048
523100     PERFORM 6010-DELETE-SEL-QUEUE.                               52310048
523200                                                                  52320048
523300     SET ASC-UPDATE-TSQ        TO  TRUE.                          52330048
523400                                                                  52340048
523500     SET SU010-IDX             TO  1.                             52350048
523600     MOVE ZERO                 TO SU009-NUMBER-OF-TS-ITEMS        52360048
523700                                  SU009-NUMBER-OF-SELECTED-ITEMS. 52370048
523800     INITIALIZE SU010-SELECTED-ITEM-ARRAY.                        52380048
523900                                                                  52390048
524000     PERFORM 5220-FILL-SEL-QUEUE-RECORD                           52400048
524100             VARYING PV-ITEM                                      52410048
524200             FROM 1 BY 1                                          52420048
524300             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     52430048
524400                                                                  52440048
524500     IF  SU010-IDX > 1                                            52450048
524600         PERFORM 5225-WRITE-SEL-QUEUE                             52460048
524700         ADD +1                TO SU009-NUMBER-OF-TS-ITEMS        52470048
524800     END-IF.                                                      52480048
524900                                                                  52490048
525000*----------------------------------------------------------------*52500093
525100* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *52510093
525200* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *52520093
525300* FOR THE SELECTED ITEMS QUEUE.                                  *52530093
525400*                                                                *52540093
525500* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *52550093
525600* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *52560093
525700* THE ARRAY IS FULL.                                             *52570093
525800*----------------------------------------------------------------*52580093
525900 5080-PREPARE-SEL-QUEUE.                                          52590093
526000     MOVE +1                   TO  ASC-BLK-SUB.                   52600093
526100     PERFORM 5100-WRITE-TEMP-STORAGE.                             52610093
526200     ADD +1                    TO  ASC-BLK-SUB.                   52620093
526300     PERFORM 5100-WRITE-TEMP-STORAGE.                             52630093
526400                                                                  52640093
526500     MOVE ASC-SEL-QUEUE-OUT    TO  RC015-SEL-QUEUE-NAME.          52650093
526600     PERFORM 6010-DELETE-SEL-QUEUE.                               52660093
526700                                                                  52670093
526800     SET ASC-UPDATE-TSQ        TO  TRUE.                          52680093
526900                                                                  52690093
527000     SET RC013-IDX             TO  1.                             52700093
527100     MOVE ZERO                 TO RC015-NUMBER-OF-TS-ITEMS        52710093
527200                                  RC015-NUMBER-OF-SELECTED-ITEMS. 52720093
527300     INITIALIZE RC013-SELECTED-ITEM-ARRAY.                        52730093
527400                                                                  52740093
527500     PERFORM 5211-FILL-SEL-QUEUE-RECORD                           52750093
527600             VARYING PV-ITEM                                      52760093
527700             FROM 1 BY 1                                          52770093
527800             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     52780093
527900                                                                  52790093
528000     IF  RC013-IDX > 1                                            52800093
528100         PERFORM 5212-WRITE-SEL-QUEUE                             52810093
528200         ADD +1                TO RC015-NUMBER-OF-TS-ITEMS        52820093
528300     END-IF.                                                      52830093
528400                                                                  52840093
528500                                                                  52850048
528600*----------------------------------------------------------------*52860048
528700*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *52870001
528800*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *52880001
528900*----------------------------------------------------------------*52890001
529000 5100-WRITE-TEMP-STORAGE.                                         52900001
529100     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     52910001
529200                                   TO PV-LIST-ITEM-NUMBER.        52920001
529300     COMPUTE PV-BLOCK-NUMBER =                                    52930001
529400         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    52940001
529500                                                                  52950001
529600     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             52960001
529700     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             52970001
529800         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      52980001
529900             PERFORM 5105-REWRITE-ASC-LISTQ                       52990001
530000         END-IF                                                   53000001
530100     ELSE                                                         53010001
530200         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       53020001
530300         ASC-HIGHEST-BLOCK-WRITTEN + 1                            53030001
530400         PERFORM 5110-WRITE-ASC-LISTQ                             53040001
530500         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   53050001
530600     END-IF.                                                      53060001
530700                                                                  53070001
530800     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             53080001
530900                                                                  53090001
531000******************************************************************53100001
531100** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **53110001
531200** SPECIFIC COMMAREA.                                           **53120001
531300******************************************************************53130001
531400 5105-REWRITE-ASC-LISTQ.                                          53140001
531500     EXEC CICS                                                    53150001
531600         WRITEQ TS                                                53160001
531700             QUEUE (ASC-LIST-QUEUE-NAME)                          53170001
531800             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               53180001
531900             ITEM  (PV-BLOCK-NUMBER)                              53190001
532000             REWRITE                                              53200001
532100             RESP  (PV-CICS-RESP)                                 53210001
532200     END-EXEC.                                                    53220001
532300                                                                  53230001
532400     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           53240001
532500         CONTINUE                                                 53250001
532600     ELSE                                                         53260001
532700         SET DP013-CICS-ABEND            TO TRUE                  53270001
532800         SET DP013-NO-ROLLBACK           TO TRUE                  53280001
532900         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       53290001
533000         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     53300001
533100                                         TO DP013-MESSAGE-TEXT(1) 53310001
533200         PERFORM DP013-0000-PROCESS-ABEND                         53320001
533300     END-IF.                                                      53330001
533400                                                                  53340001
533500******************************************************************53350001
533600** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **53360001
533700** SPECIFIC COMMAREA.                                           **53370001
533800******************************************************************53380001
533900 5110-WRITE-ASC-LISTQ.                                            53390001
534000     EXEC CICS                                                    53400001
534100         WRITEQ TS                                                53410001
534200             QUEUE (ASC-LIST-QUEUE-NAME)                          53420001
534300             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               53430001
534400             ITEM  (PV-BLOCK-NUMBER)                              53440001
534500             RESP  (PV-CICS-RESP)                                 53450001
534600     END-EXEC.                                                    53460001
534700     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      53470001
534800         SET DP013-CICS-ABEND      TO TRUE                        53480001
534900         SET DP013-NO-ROLLBACK     TO TRUE                        53490001
535000         MOVE '5110-WRITE-ASC-LISTQ'                              53500001
535100                                   TO DP013-PARAGRAPH             53510001
535200         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           53520001
535300                                   TO DP013-MESSAGE-TEXT(1)       53530001
535400         PERFORM DP013-0000-PROCESS-ABEND                         53540001
535500     END-IF.                                                      53550001
535600                                                                  53560001
535700*----------------------------------------------------------------*53570001
535800* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *53580001
535900* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *53590001
536000*----------------------------------------------------------------*53600001
536100 5200-FILL-SEL-QUEUE-RECORD.                                      53610001
536200                                                                  53620001
536300     PERFORM 6112-READ-LIST-QUEUE.                                53630001
536400                                                                  53640001
536500     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       53650001
536600         PERFORM                                                  53660001
536700         VARYING LQW-IDX                                          53670001
536800         FROM 1 BY 1                                              53680001
536900         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            53690001
537000           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          53700001
537100                                                                  53710001
537200             IF  LQW-SELECT (LQW-IDX)                             53720001
537300                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              53730001
537400                                   TO SU039-ITEM (SU039-IDX)      53740001
537500                 MOVE SPACE        TO SU039-ACTION-SW (SU039-IDX) 53750001
537600                                                                  53760001
537700                 MOVE LQW-STR-NBR (LQW-IDX)                       53770001
537800                                      TO SU039-STR-NBR (SU039-IDX)53780001
537900                 MOVE LQW-UPC-NBR (LQW-IDX)                       53790001
538000                                         TO SU039-UPC (SU039-IDX) 53800001
538100                 MOVE LQW-ADJ-SOURCE (LQW-IDX)                    53810001
538200                                  TO SU039-ADJ-SOURCE (SU039-IDX) 53820001
538300                 MOVE LQW-BEF-QTY (LQW-IDX)                       53830001
538400                                     TO SU039-BEF-QTY (SU039-IDX) 53840001
538500                 MOVE LQW-AFT-QTY (LQW-IDX)                       53850001
538600                                     TO SU039-AFT-QTY (SU039-IDX) 53860001
538700                 MOVE LQW-FAIL-SUCCSS (LQW-IDX)                   53870001
538800                                 TO SU039-FAIL-SUCCSS (SU039-IDX) 53880001
538900                 MOVE LQW-PRCS-GROUP  (LQW-IDX)                   53890001
539000                               TO SU039-PROCESS-GROUP (SU039-IDX) 53900001
539100                 MOVE LQW-ERR-CDE (LQW-IDX)                       53910001
539200                                     TO SU039-ERR-CDE (SU039-IDX) 53920001
539300                 MOVE LQW-ACKNOWLEDGE (LQW-IDX)                   53930001
539400                                 TO SU039-ACKNOWLEDGE (SU039-IDX) 53940001
539500                 MOVE LQW-ADJ-TYP (LQW-IDX)                       53950001
539600                                     TO SU039-ADJ-TYP (SU039-IDX) 53960001
539700                 MOVE LQW-FINCL-ID (LQW-IDX)                      53970001
539800                                    TO SU039-FINCL-ID (SU039-IDX) 53980001
539900                 MOVE ASC-SML-IN TO SU039-SHIPT-UNT-ID (SU039-IDX)53990037
540000                                                                  54000001
540100                 SET SU039-IDX UP BY 1                            54010001
540200                 IF  SU039-IDX > SU039-MAX-ITEMS                  54020001
540300                     PERFORM 5205-WRITE-SEL-QUEUE                 54030001
540400                     ADD +1        TO SU038-NUMBER-OF-TS-ITEMS    54040001
540500                     INITIALIZE SU039-SELECTED-ITEM-ARRAY         54050001
540600                     SET SU039-IDX TO  1                          54060001
540700                 END-IF                                           54070001
540800             END-IF                                               54080001
540900         END-PERFORM                                              54090001
541000     END-IF.                                                      54100001
541100                                                                  54110001
541200*----------------------------------------------------------------*54120001
541300*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *54130001
541400*----------------------------------------------------------------*54140001
541500 5205-WRITE-SEL-QUEUE.                                            54150001
541600                                                                  54160001
541700     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            54170001
541800                                   TO SU039-SELECTED-ITEMS.       54180001
541900                                                                  54190001
542000     EXEC CICS                                                    54200001
542100          WRITEQ TS                                               54210001
542200              QUEUE (ASC-SEL-QUEUE-OUT)                           54220001
542300              FROM  (SU039-SELECT-RECORD)                         54230001
542400              ITEM  (PV-SEL-QUEUE-ITEM)                           54240001
542500              RESP  (PV-CICS-RESP)                                54250001
542600     END-EXEC.                                                    54260001
542700                                                                  54270001
542800     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          54280001
542900         CONTINUE                                                 54290001
543000     ELSE                                                         54300001
543100         SET DP013-CICS-ABEND      TO TRUE                        54310001
543200         SET DP013-NO-ROLLBACK     TO TRUE                        54320001
543300         MOVE '5205-WRITE-SEL-QUEUE'                              54330001
543400                                   TO DP013-PARAGRAPH             54340001
543500         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          54350001
543600                                   TO DP013-MESSAGE-TEXT(1)       54360001
543700         PERFORM DP013-0000-PROCESS-ABEND                         54370001
543800     END-IF.                                                      54380001
543900                                                                  54390001
544000 5210-FILL-SEL-QUEUE-RECORD.                                      54400001
544100                                                                  54410001
544200     PERFORM 6112-READ-LIST-QUEUE.                                54420001
544300                                                                  54430001
544400     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       54440001
544500         PERFORM                                                  54450001
544600         VARYING LQW-IDX                                          54460001
544700         FROM 1 BY 1                                              54470001
544800         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            54480001
544900           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          54490001
545000                                                                  54500001
545100             IF  (LQW-SELECT (LQW-IDX))                           54510001
545200                 ADD +1 TO PC000-NUMBER-OF-SELECTED-ITEMS         54520001
545300                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              54530001
545400                                    TO RC013-ITEM (RC013-IDX)     54540001
545500                 MOVE SPACE         TO RC013-ACTION-SW (RC013-IDX)54550001
545600                 MOVE ASC-OPER-UNT-ID                             54560001
545700                                    TO RC013-OPER-UNT-ID          54570001
545800                                                       (RC013-IDX)54580001
545900                 MOVE 1             TO RC013-FCLTY-ID             54590001
546000                                                       (RC013-IDX)54600001
546100                 MOVE LQW-PO-LNE (LQW-IDX)                        54610001
546200                                    TO RC013-PO-NBR    (RC013-IDX)54620001
546300                                       PC000-PO-NBR-N             54630001
546400                 MOVE LQW-REC-LNE (LQW-IDX)                       54640001
546500                                    TO RC013-REC-SEQ-NBR          54650001
546600                                                       (RC013-IDX)54660001
546700                                       PC000-REC-SEQ-NBR-N        54670001
546800                 MOVE LQW-LNE-LNE (LQW-IDX)                       54680001
546900                                    TO RC013-PKSL-LNE-NBR-N       54690001
547000                                                       (RC013-IDX)54700001
547100                 SET RC013-IDX UP BY 1                            54710001
547200                 IF  RC013-IDX > RC013-MAX-ITEMS                  54720001
547300                     PERFORM 5215-WRITE-SEL-QUEUE                 54730001
547400                     ADD +1        TO PC000-NUMBER-OF-TS-ITEMS    54740001
547500                     INITIALIZE RC013-SELECTED-ITEM-ARRAY         54750001
547600                     SET RC013-IDX TO 1                           54760001
547700                 END-IF                                           54770001
547800             END-IF                                               54780001
547900         END-PERFORM                                              54790001
548000     END-IF.                                                      54800001
548100                                                                  54810001
548200     MOVE PV-ITEM TO PV-SAVE-ITEM.                                54820001
548300     PERFORM 6111-WRITE-LIST-QUEUE.                               54830001
548400*-----------------------------------------------------------------54840093
548500 5211-FILL-SEL-QUEUE-RECORD.                                      54850093
548600                                                                  54860093
548700     PERFORM 6112-READ-LIST-QUEUE.                                54870093
548800                                                                  54880093
548900     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       54890093
549000         PERFORM                                                  54900093
549100         VARYING LQW-IDX                                          54910093
549200         FROM 1 BY 1                                              54920093
549300         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            54930093
549400           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          54940093
549500                                                                  54950093
549600             IF  (LQW-SELECT (LQW-IDX))                           54960093
549700                 ADD +1 TO RC015-NUMBER-OF-SELECTED-ITEMS         54970093
549800                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              54980093
549900                                    TO RC013-ITEM (RC013-IDX)     54990093
550000                 MOVE SPACE         TO RC013-ACTION-SW (RC013-IDX)55000093
550100                 MOVE ASC-OPER-UNT-ID TO RC013-OPER-UNT-ID        55010093
550200                                                       (RC013-IDX)55020093
550300                 MOVE 1             TO RC013-FCLTY-ID  (RC013-IDX)55030093
550400                 MOVE LQW-PO-LNE (LQW-IDX) TO RC013-PO-NBR        55040093
550500                                                       (RC013-IDX)55050093
550600                 MOVE LQW-REC-LNE (LQW-IDX)  TO RC013-REC-SEQ-NBR 55060093
550700                                                       (RC013-IDX)55070093
550800                 MOVE LQW-LNE-LNE(LQW-IDX) TO RC013-PKSL-LNE-NBR-N55080093
550900                                                       (RC013-IDX)55090093
551000                 SET RC013-IDX UP BY 1                            55100093
551100                 IF  RC013-IDX > RC013-MAX-ITEMS                  55110093
551200                     PERFORM 5212-WRITE-SEL-QUEUE                 55120093
551300                     ADD +1        TO RC015-NUMBER-OF-TS-ITEMS    55130093
551400                     INITIALIZE RC013-SELECTED-ITEM-ARRAY         55140093
551500                     SET RC013-IDX TO 1                           55150093
551600                 END-IF                                           55160093
551700             END-IF                                               55170093
551800         END-PERFORM                                              55180093
551900     END-IF.                                                      55190093
552000                                                                  55200093
552100     MOVE PV-ITEM TO PV-SAVE-ITEM.                                55210093
552200     PERFORM 6111-WRITE-LIST-QUEUE.                               55220093
552300*----------------------------------------------------------------*55230093
552400*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE - RC013.        *55240093
552500*----------------------------------------------------------------*55250093
552600 5212-WRITE-SEL-QUEUE.                                            55260093
552700                                                                  55270093
552800     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            55280093
552900                                   TO RC013-SELECTED-ITEMS.       55290093
553000                                                                  55300093
553100     EXEC CICS                                                    55310093
553200          WRITEQ TS                                               55320093
553300              QUEUE (ASC-SEL-QUEUE-OUT)                           55330093
553400              FROM  (RC013-DC-SELECT-RECORD)                      55340093
553500              ITEM  (PV-SEL-QUEUE-ITEM)                           55350093
553600              RESP  (PV-CICS-RESP)                                55360093
553700     END-EXEC.                                                    55370093
553800                                                                  55380093
553900     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          55390093
554000         CONTINUE                                                 55400093
554100     ELSE                                                         55410093
554200         SET DP013-CICS-ABEND      TO TRUE                        55420093
554300         SET DP013-NO-ROLLBACK     TO TRUE                        55430093
554400         MOVE '5212-WRITE-SEL-QUEUE'                              55440093
554500                                   TO DP013-PARAGRAPH             55450093
554600         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          55460093
554700                                   TO DP013-MESSAGE-TEXT(1)       55470093
554800         PERFORM DP013-0000-PROCESS-ABEND                         55480093
554900     END-IF.                                                      55490093
555000                                                                  55500093
555100***************************************************************   55510093
555200 5220-FILL-SEL-QUEUE-RECORD.                                      55520048
555300                                                                  55530048
555400     PERFORM 6112-READ-LIST-QUEUE.                                55540048
555500                                                                  55550048
555600     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       55560048
555700         PERFORM                                                  55570048
555800         VARYING LQW-IDX                                          55580048
555900         FROM 1 BY 1                                              55590048
556000         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            55600048
556100           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          55610048
556200                                                                  55620048
556300             IF  (LQW-SELECT (LQW-IDX))                           55630048
556400                 ADD +1 TO SU009-NUMBER-OF-SELECTED-ITEMS         55640048
556500                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              55650048
556600                                    TO SU010-ITEM (SU010-IDX)     55660048
556700                 MOVE SPACE         TO SU010-ACTION-SW (SU010-IDX)55670048
556800                 MOVE LQW-SML-NBR (LQW-IDX)                       55680048
556900                                    TO SU010-SML (SU010-IDX)      55690048
557000                 SET SU010-IDX UP BY 1                            55700048
557100                 IF  SU010-IDX > SU010-MAX-ITEMS                  55710048
557200                     PERFORM 5225-WRITE-SEL-QUEUE                 55720048
557300                     ADD +1        TO SU009-NUMBER-OF-TS-ITEMS    55730048
557400                     INITIALIZE SU010-SELECTED-ITEM-ARRAY         55740048
557500                     SET SU010-IDX TO 1                           55750048
557600                 END-IF                                           55760048
557700             END-IF                                               55770048
557800         END-PERFORM                                              55780048
557900     END-IF.                                                      55790048
558000                                                                  55800048
558100     MOVE PV-ITEM TO PV-SAVE-ITEM.                                55810048
558200     PERFORM 6111-WRITE-LIST-QUEUE.                               55820048
558300                                                                  55830048
558400*----------------------------------------------------------------*55840048
558500*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE - RC013.        *55850001
558600*----------------------------------------------------------------*55860001
558700 5215-WRITE-SEL-QUEUE.                                            55870001
558800                                                                  55880001
558900     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            55890001
559000                                   TO RC013-SELECTED-ITEMS.       55900001
559100                                                                  55910001
559200     EXEC CICS                                                    55920001
559300          WRITEQ TS                                               55930001
559400              QUEUE (ASC-SEL-QUEUE-OUT)                           55940001
559500              FROM  (RC013-DC-SELECT-RECORD)                      55950001
559600              ITEM  (PV-SEL-QUEUE-ITEM)                           55960001
559700              RESP  (PV-CICS-RESP)                                55970001
559800     END-EXEC.                                                    55980001
559900                                                                  55990001
560000     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          56000001
560100         CONTINUE                                                 56010001
560200     ELSE                                                         56020001
560300         SET DP013-CICS-ABEND      TO TRUE                        56030001
560400         SET DP013-NO-ROLLBACK     TO TRUE                        56040001
560500         MOVE '5215-WRITE-SEL-QUEUE'                              56050001
560600                                   TO DP013-PARAGRAPH             56060001
560700         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          56070001
560800                                   TO DP013-MESSAGE-TEXT(1)       56080001
560900         PERFORM DP013-0000-PROCESS-ABEND                         56090001
561000     END-IF.                                                      56100001
561100                                                                  56110001
561200*----------------------------------------------------------------*56120048
561300*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE - SU010.        *56130048
561400*----------------------------------------------------------------*56140048
561500 5225-WRITE-SEL-QUEUE.                                            56150048
561600                                                                  56160048
561700     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            56170048
561800                                   TO SU010-SELECTED-ITEMS.       56180048
561900                                                                  56190048
562000     EXEC CICS                                                    56200048
562100          WRITEQ TS                                               56210048
562200              QUEUE (ASC-SEL-QUEUE-OUT)                           56220048
562300              FROM  (SU010-SELECT-RECORD)                         56230048
562400              ITEM  (PV-SEL-QUEUE-ITEM)                           56240048
562500              RESP  (PV-CICS-RESP)                                56250048
562600     END-EXEC.                                                    56260048
562700                                                                  56270048
562800     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          56280048
562900         CONTINUE                                                 56290048
563000     ELSE                                                         56300048
563100         SET DP013-CICS-ABEND      TO TRUE                        56310048
563200         SET DP013-NO-ROLLBACK     TO TRUE                        56320048
563300         MOVE '5225-WRITE-SEL-QUEUE'                              56330048
563400                                   TO DP013-PARAGRAPH             56340048
563500         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          56350048
563600                                   TO DP013-MESSAGE-TEXT(1)       56360048
563700         PERFORM DP013-0000-PROCESS-ABEND                         56370048
563800     END-IF.                                                      56380048
563900                                                                  56390048
564000******************************************************************56400048
564100** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **56410001
564200** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **56420001
564300** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **56430001
564400** THE USER.                                                    **56440001
564500******************************************************************56450001
564600 6000-REFRESH-PANEL-FROM-TEMP.                                    56460001
564700     IF  ASC-UPDATE-TSQ AND ASC-NUMBER-OF-SELECTED-ITEMS > 0      56470001
564800         SET ASC-NO-TSQ-UPDATE TO TRUE                            56480001
564900         MOVE ZERO                 TO PV-SAVE-ITEM                56490001
565000                                      PV-SEL-QUEUE-ITEM           56500001
565100         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        56510001
565200                                   TO PV-HOLD-SELECTED-ITEMS      56520001
565300         MOVE +1                   TO PV-ITEMS-PROCESSED          56530001
565400         IF ASC-GOING-TO-TROUBLE                                  56540001
565500             PERFORM 6100-UPDATE-TSQ-T                            56550001
565600                 UNTIL PV-ITEMS-PROCESSED >                       56560001
565700                                     PV-HOLD-SELECTED-ITEMS       56570001
565800         ELSE                                                     56580001
565900             IF ASC-GOING-TO-PCKCRTN                              56590050
566000                 PERFORM 6100-UPDATE-TSQ-C                        56600050
566100                     UNTIL PV-ITEMS-PROCESSED >                   56610050
566200                                     PV-HOLD-SELECTED-ITEMS       56620050
566300         ELSE                                                     56630050
566400             PERFORM 6100-UPDATE-TSQ                              56640001
566500                 UNTIL PV-ITEMS-PROCESSED >                       56650001
566600                                     PV-HOLD-SELECTED-ITEMS       56660001
566700         END-IF                                                   56670001
566800         INITIALIZE ASC-BLOCK-ENTRIES (1)                         56680001
566900                    ASC-BLOCK-ENTRIES (2)                         56690001
567000     END-IF.                                                      56700001
567100                                                                  56710001
567200*----------------------------------------------------------------*56720001
567300*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *56730001
567400*----------------------------------------------------------------*56740001
567500 6010-DELETE-SEL-QUEUE.                                           56750001
567600                                                                  56760001
567700     EXEC CICS                                                    56770001
567800         DELETEQ TS                                               56780001
567900             QUEUE (ASC-SEL-QUEUE-OUT)                            56790001
568000             RESP  (PV-CICS-RESP)                                 56800001
568100     END-EXEC.                                                    56810001
568200*                                                                 56820001
568300     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      56830001
568400        (PV-CICS-RESP = DFHRESP(QIDERR)))                         56840001
568500         CONTINUE                                                 56850001
568600     ELSE                                                         56860001
568700         SET DP013-CICS-ABEND TO TRUE                             56870001
568800         SET DP013-NO-ROLLBACK TO TRUE                            56880001
568900         MOVE '6010-DELETE-SEL-QUEUE'                             56890001
569000                        TO DP013-PARAGRAPH                        56900001
569100         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         56910001
569200                        TO DP013-MESSAGE-TEXT (1)                 56920001
569300         PERFORM DP013-0000-PROCESS-ABEND                         56930001
569400     END-IF.                                                      56940001
569500                                                                  56950001
569600*----------------------------------------------------------------*56960001
569700*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *56970001
569800*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *56980001
569900*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *56990001
570000*    THE TEMP QUEUE.                                             *57000001
570100*----------------------------------------------------------------*57010001
570200 6100-UPDATE-TSQ.                                                 57020001
570300                                                                  57030001
570400     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             57040001
570500     PERFORM 6150-READ-SEL-QUEUE.                                 57050001
570600     PERFORM                                                      57060001
570700         VARYING SU039-IDX                                        57070001
570800         FROM 1 BY 1                                              57080001
570900         UNTIL ((PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS)     57090001
571000         OR (SU039-IDX GREATER THAN SU039-MAX-ITEMS))             57100001
571100         IF  SU039-ACTION-SW (SU039-IDX) > SPACE                  57110001
571200             PERFORM 6110-PROCESS-ITEMS                           57120001
571300         END-IF                                                   57130001
571400         ADD +1                TO PV-ITEMS-PROCESSED              57140001
571500     END-PERFORM.                                                 57150001
571600     PERFORM 6111-WRITE-LIST-QUEUE.                               57160001
571700                                                                  57170001
571800*----------------------------------------------------------------*57180001
571900*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *57190001
572000*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *57200001
572100*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *57210001
572200*    THE TEMP QUEUE.                                             *57220001
572300*----------------------------------------------------------------*57230001
572400 6100-UPDATE-TSQ-C.                                               57240050
572500                                                                  57250001
572600     ADD 1                         TO PV-SEL-QUEUE-ITEM.          57260001
572700     PERFORM 6175-READ-SEL-QUEUE.                                 57270050
572800                                                                  57280001
572900     PERFORM                                                      57290001
573000         VARYING SU010-IDX                                        57300050
573100         FROM 1 BY 1                                              57310001
573200         UNTIL ((PV-ITEMS-PROCESSED >                             57320001
573300                              PV-HOLD-SELECTED-ITEMS)             57330001
573400         OR (SU010-IDX GREATER THAN SU010-MAX-ITEMS))             57340050
573500             IF  SU010-ACTION-SW (SU010-IDX) > SPACE              57350050
573600                 PERFORM 6120-PROCESS-ITEMS                       57360050
573700             END-IF                                               57370001
573800         ADD +1                    TO PV-ITEMS-PROCESSED          57380001
573900     END-PERFORM.                                                 57390001
574000                                                                  57400001
574100     PERFORM 6111-WRITE-LIST-QUEUE.                               57410001
574200                                                                  57420001
574300*----------------------------------------------------------------*57430050
574400*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *57440050
574500*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *57450050
574600*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *57460050
574700*    THE TEMP QUEUE.                                             *57470050
574800*----------------------------------------------------------------*57480050
574900 6100-UPDATE-TSQ-T.                                               57490050
575000                                                                  57500050
575100     ADD 1                         TO PV-SEL-QUEUE-ITEM.          57510050
575200     PERFORM 6155-READ-SEL-QUEUE.                                 57520050
575300                                                                  57530050
575400     PERFORM                                                      57540050
575500         VARYING RC013-IDX                                        57550050
575600         FROM 1 BY 1                                              57560050
575700         UNTIL ((PV-ITEMS-PROCESSED >                             57570050
575800                              PV-HOLD-SELECTED-ITEMS)             57580050
575900         OR (RC013-IDX GREATER THAN RC013-MAX-ITEMS))             57590050
576000             IF  RC013-ACTION-SW (RC013-IDX) > SPACE              57600050
576100                 PERFORM 6115-PROCESS-ITEMS                       57610050
576200             END-IF                                               57620050
576300         ADD +1                    TO PV-ITEMS-PROCESSED          57630050
576400     END-PERFORM.                                                 57640050
576500                                                                  57650050
576600     PERFORM 6111-WRITE-LIST-QUEUE.                               57660050
576700                                                                  57670050
576800*----------------------------------------------------------------*57680050
576900*    READ THE LIST QUEUE RECORD.                                 *57690001
577000*----------------------------------------------------------------*57700001
577100 6150-READ-SEL-QUEUE.                                             57710001
577200                                                                  57720001
577300     EXEC CICS                                                    57730001
577400          READQ TS                                                57740001
577500              QUEUE (ASC-SEL-QUEUE-OUT)                           57750001
577600              INTO  (SU039-SELECT-RECORD)                         57760001
577700              ITEM  (PV-SEL-QUEUE-ITEM)                           57770001
577800              RESP  (PV-CICS-RESP)                                57780001
577900     END-EXEC.                                                    57790001
578000*                                                                 57800001
578100     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          57810001
578200         CONTINUE                                                 57820001
578300     ELSE                                                         57830001
578400         SET DP013-CICS-ABEND      TO  TRUE                       57840001
578500         SET DP013-NO-ROLLBACK     TO  TRUE                       57850001
578600         MOVE '6150-READ-SEL-QUEUE' TO  DP013-PARAGRAPH           57860001
578700         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           57870001
578800                                   TO  DP013-MESSAGE-TEXT(1)      57880001
578900         PERFORM DP013-0000-PROCESS-ABEND                         57890001
579000     END-IF.                                                      57900001
579100                                                                  57910001
579200*----------------------------------------------------------------*57920001
579300*    READ THE LIST QUEUE RECORD.                                 *57930001
579400*----------------------------------------------------------------*57940001
579500 6155-READ-SEL-QUEUE.                                             57950001
579600                                                                  57960001
579700                                                                  57970001
579800     EXEC CICS                                                    57980001
579900          READQ TS                                                57990001
580000              QUEUE (ASC-SEL-QUEUE-OUT)                           58000001
580100              INTO  (RC013-DC-SELECT-RECORD)                      58010001
580200              ITEM  (PV-SEL-QUEUE-ITEM)                           58020001
580300              RESP  (PV-CICS-RESP)                                58030001
580400     END-EXEC.                                                    58040001
580500                                                                  58050001
580600     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          58060001
580700         CONTINUE                                                 58070001
580800     ELSE                                                         58080001
580900         SET DP013-CICS-ABEND      TO TRUE                        58090001
581000         SET DP013-NO-ROLLBACK     TO TRUE                        58100001
581100         MOVE '6155-READ-SEL-QUEUE2'                              58110050
581200                                   TO DP013-PARAGRAPH             58120001
581300         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           58130001
581400                                   TO DP013-MESSAGE-TEXT(1)       58140001
581500         PERFORM DP013-0000-PROCESS-ABEND                         58150001
581600     END-IF.                                                      58160001
581700*----------------------------------------------------------------*58170050
581800*    READ THE LIST QUEUE RECORD.                                 *58180050
581900*----------------------------------------------------------------*58190050
582000 6175-READ-SEL-QUEUE.                                             58200050
582100                                                                  58210050
582200     EXEC CICS                                                    58220050
582300          READQ TS                                                58230050
582400              QUEUE (ASC-SEL-QUEUE-OUT)                           58240050
582500              INTO  (SU010-SELECT-RECORD)                         58250050
582600              ITEM  (PV-SEL-QUEUE-ITEM)                           58260050
582700              RESP  (PV-CICS-RESP)                                58270050
582800     END-EXEC.                                                    58280050
582900                                                                  58290050
583000     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          58300050
583100         CONTINUE                                                 58310050
583200     ELSE                                                         58320050
583300         SET DP013-CICS-ABEND      TO TRUE                        58330050
583400         SET DP013-NO-ROLLBACK     TO TRUE                        58340050
583500         MOVE '6175-READ-SEL-QUEUE3'                              58350050
583600                                   TO DP013-PARAGRAPH             58360050
583700         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           58370050
583800                                   TO DP013-MESSAGE-TEXT(1)       58380050
583900         PERFORM DP013-0000-PROCESS-ABEND                         58390050
584000     END-IF.                                                      58400050
584100                                                                  58410050
584200*----------------------------------------------------------------*58420050
584300*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*58430001
584400*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*58440001
584500*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *58450001
584600*----------------------------------------------------------------*58460001
584700 6110-PROCESS-ITEMS.                                              58470001
584800                                                                  58480001
584900     COMPUTE PV-ITEM = 1 + ((SU039-ITEM (SU039-IDX) - 1)          58490001
585000                     / PC-ITEMS-PER-PANEL).                       58500001
585100                                                                  58510001
585200     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           58520001
585300         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          58530001
585400             PERFORM 6111-WRITE-LIST-QUEUE                        58540001
585500         END-IF                                                   58550001
585600         MOVE PV-ITEM          TO PV-SAVE-ITEM                    58560001
585700                                                                  58570001
585800         PERFORM 6112-READ-LIST-QUEUE                             58580001
585900         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               58590001
586000             CONTINUE                                             58600001
586100         END-IF                                                   58610001
586200     END-IF.                                                      58620001
586300                                                                  58630001
586400     COMPUTE PV-SUB = (SU039-ITEM (SU039-IDX)                     58640001
586500                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              58650001
586600     SET LQW-DESELECT (PV-SUB) TO    TRUE                         58660001
586700     MOVE LQW-SELECTED-SW (PV-SUB)                                58670001
586800                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  58680001
586900                                                                  58690001
587000     EVALUATE TRUE                                                58700001
587100         WHEN SU039-INQ (SU039-IDX)                               58710001
587200              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             58720001
587300                                                                  58730001
587400         WHEN SU039-UPD (SU039-IDX)                               58740001
587500              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             58750001
587600              PERFORM 7000-PROCESS-UPDATE                         58760001
587700                                                                  58770001
587800         WHEN SU039-DEL (SU039-IDX)                               58780001
587900              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             58790001
588000                                                                  58800001
588100         WHEN SU039-ERR (SU039-IDX)                               58810001
588200              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             58820001
588300     END-EVALUATE.                                                58830001
588400                                                                  58840001
588500     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                58850001
588600                                                                  58860001
588700*----------------------------------------------------------------*58870001
588800*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*58880001
588900*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*58890001
589000*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *58900001
589100*----------------------------------------------------------------*58910001
589200 6115-PROCESS-ITEMS.                                              58920001
589300                                                                  58930001
589400     COMPUTE PV-ITEM = 1 + ((RC013-ITEM (RC013-IDX) - 1)          58940001
589500                     / PC-ITEMS-PER-PANEL).                       58950001
589600                                                                  58960001
589700     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           58970001
589800         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          58980001
589900             PERFORM 6111-WRITE-LIST-QUEUE                        58990001
590000         END-IF                                                   59000001
590100         MOVE PV-ITEM              TO PV-SAVE-ITEM                59010001
590200                                                                  59020001
590300         PERFORM 6112-READ-LIST-QUEUE                             59030001
590400         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               59040001
590500             CONTINUE                                             59050001
590600         END-IF                                                   59060001
590700     END-IF.                                                      59070001
590800                                                                  59080001
590900     COMPUTE PV-SUB = (RC013-ITEM (RC013-IDX)                     59090001
591000                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              59100001
591100                                                                  59110001
591200     SET LQW-DESELECT (PV-SUB)     TO TRUE.                       59120001
591300     MOVE LQW-SELECTED-SW (PV-SUB) TO LQW-TEMP-SELECTED-SW        59130001
591400                                     (PV-SUB).                    59140001
591500     EVALUATE TRUE                                                59150001
591600         WHEN RC013-INQ (RC013-IDX)                               59160001
591700              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             59170001
591800                                                                  59180001
591900         WHEN RC013-UPD (RC013-IDX)                               59190001
592000              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             59200001
592100                                                                  59210001
592200         WHEN RC013-DEL (RC013-IDX)                               59220001
592300              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             59230001
592400                                                                  59240001
592500         WHEN RC013-ERR (RC013-IDX)                               59250001
592600              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             59260001
592700     END-EVALUATE.                                                59270001
592800                                                                  59280001
592900     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                59290001
593000*----------------------------------------------------------------*59300050
593100*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*59310050
593200*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*59320050
593300*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *59330050
593400*----------------------------------------------------------------*59340050
593500 6120-PROCESS-ITEMS.                                              59350050
593600                                                                  59360050
593700     COMPUTE PV-ITEM = 1 + ((SU010-ITEM (SU010-IDX) - 1)          59370050
593800                     / PC-ITEMS-PER-PANEL).                       59380050
593900                                                                  59390050
594000     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           59400050
594100         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          59410050
594200             PERFORM 6111-WRITE-LIST-QUEUE                        59420050
594300         END-IF                                                   59430050
594400         MOVE PV-ITEM              TO PV-SAVE-ITEM                59440050
594500                                                                  59450050
594600         PERFORM 6112-READ-LIST-QUEUE                             59460050
594700         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               59470050
594800             CONTINUE                                             59480050
594900         END-IF                                                   59490050
595000     END-IF.                                                      59500050
595100                                                                  59510050
595200     COMPUTE PV-SUB = (SU010-ITEM (SU010-IDX)                     59520050
595300                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              59530050
595400                                                                  59540050
595500     SET LQW-DESELECT (PV-SUB)     TO TRUE.                       59550050
595600     MOVE LQW-SELECTED-SW (PV-SUB) TO LQW-TEMP-SELECTED-SW        59560050
595700                                     (PV-SUB).                    59570050
595800     EVALUATE TRUE                                                59580050
595900         WHEN SU010-INQ (SU010-IDX)                               59590050
596000              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             59600050
596100                                                                  59610050
596200         WHEN SU010-UPD (SU010-IDX)                               59620050
596300              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             59630050
596400                                                                  59640050
596500         WHEN SU010-DEL (SU010-IDX)                               59650050
596600              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             59660050
596700                                                                  59670050
596800         WHEN SU010-ERR (SU010-IDX)                               59680050
596900              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             59690050
597000     END-EVALUATE.                                                59700050
597100                                                                  59710050
597200     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                59720050
597300*----------------------------------------------------------------*59730050
597400*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *59740001
597500*----------------------------------------------------------------*59750001
597600 6111-WRITE-LIST-QUEUE.                                           59760001
597700                                                                  59770001
597800     EXEC CICS                                                    59780001
597900         WRITEQ TS                                                59790001
598000             QUEUE (ASC-LIST-QUEUE-NAME)                          59800001
598100             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     59810001
598200             ITEM  (PV-SAVE-ITEM)                                 59820001
598300             REWRITE                                              59830001
598400             RESP  (PV-CICS-RESP)                                 59840001
598500     END-EXEC.                                                    59850001
598600*                                                                 59860001
598700     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          59870001
598800         CONTINUE                                                 59880001
598900     ELSE                                                         59890001
599000         SET DP013-CICS-ABEND  TO  TRUE                           59900001
599100         SET DP013-NO-ROLLBACK TO  TRUE                           59910001
599200         MOVE '6111-WRITE-LIST-QUEUE'                             59920001
599300                               TO  DP013-PARAGRAPH                59930001
599400         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  59940001
599500                               TO  DP013-MESSAGE-TEXT(1)          59950001
599600         PERFORM DP013-0000-PROCESS-ABEND                         59960001
599700     END-IF.                                                      59970001
599800                                                                  59980001
599900*----------------------------------------------------------------*59990001
600000*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*60000001
600100*----------------------------------------------------------------*60010001
600200 6112-READ-LIST-QUEUE.                                            60020001
600300                                                                  60030001
600400     EXEC CICS                                                    60040001
600500         READQ TS                                                 60050001
600600             QUEUE (ASC-LIST-QUEUE-NAME)                          60060001
600700             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     60070001
600800             ITEM  (PV-ITEM)                                      60080001
600900             RESP  (PV-CICS-RESP)                                 60090001
601000     END-EXEC.                                                    60100001
601100*                                                                 60110001
601200     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          60120001
601300         CONTINUE                                                 60130001
601400     ELSE                                                         60140001
601500         SET DP013-CICS-ABEND        TO TRUE                      60150001
601600         SET DP013-NO-ROLLBACK       TO TRUE                      60160001
601700         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           60170001
601800         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    60180001
601900                                     TO DP013-MESSAGE-TEXT(1)     60190001
602000         PERFORM DP013-0000-PROCESS-ABEND                         60200001
602100     END-IF.                                                      60210001
602200                                                                  60220001
602300 7000-PROCESS-UPDATE.                                             60230001
602400     MOVE LQW-FINCL-ID (PV-SUB) TO DK-FINCL-ID.                   60240001
602500     PERFORM 7100-SELECT-ADJ.                                     60250001
602600     MOVE SUT00030-DEST-LOC-NBR TO LQW-STR-NBR (PV-SUB).          60260001
602700     MOVE SUT00030-UPC-NBR TO      LQW-UPC-NBR (PV-SUB).          60270001
602800     MOVE SUT00030-CRE-TMST TO PV-DATE-TIME-TMST.                 60280001
602900     MOVE PV-TD-DD  TO PV-DT-DD.                                  60290001
603000     MOVE PV-TD-MM  TO PV-DT-MM.                                  60300001
603100     MOVE PV-TD-HR  TO PV-TI-HR.                                  60310001
603200     MOVE PV-TD-MN  TO PV-TI-MN.                                  60320001
603300     MOVE PV-DATE TO   LQW-DATE (PV-SUB).                         60330001
603400     MOVE PV-TIME TO   LQW-TIME (PV-SUB).                         60340001
603500     PERFORM 4320-GET-ADJ-SOURCE.                                 60350001
603600     MOVE SURSNC-PRC-RSN-DESC   TO  LQW-ADJ-SOURCE (PV-SUB).      60360001
603700     MOVE SUT00030-FINCL-BEF-QTY TO LQW-BEF-QTY (PV-SUB).         60370001
603800     MOVE SUT00030-FINCL-AFT-QTY TO LQW-AFT-QTY (PV-SUB).         60380001
603900     IF SUT00030-AUTO-APL-IND = 'N'                               60390001
604000         MOVE 'F' TO            LQW-FAIL-SUCCSS (PV-SUB)          60400001
604100         IF SUT00030-RSLV-BY-USR-ID = '        '                  60410001
604200             MOVE 'U' TO LQW-ACKNOWLEDGE (PV-SUB)                 60420001
604300         ELSE                                                     60430001
604400             MOVE ' ' TO LQW-ACKNOWLEDGE (PV-SUB)                 60440001
604500         END-IF                                                   60450001
604600     ELSE                                                         60460001
604700         MOVE 'S' TO                                              60470001
604800                LQW-FAIL-SUCCSS (PV-SUB)                          60480001
604900         MOVE ' ' TO LQW-ACKNOWLEDGE (PV-SUB)                     60490001
605000     END-IF                                                       60500001
605100     IF PV-NULL-IND-1  <  0                                       60510001
605200         MOVE SPACES TO   LQW-ERR-CDE (PV-SUB)                    60520001
605300     ELSE                                                         60530001
605400         PERFORM 4330-GET-ERR-CDE                                 60540001
605500         MOVE SUT00031-ADJ-ERR-SHRT-DESC TO                       60550001
605600                          LQW-ERR-CDE (PV-SUB)                    60560001
605700     END-IF                                                       60570001
605800     EVALUATE TRUE                                                60580001
605900         WHEN SUT00030-AUD-ADJ-STAT-CDE = 'P'                     60590001
606000              MOVE 'POSTV'  TO LQW-ADJ-TYP (PV-SUB)               60600001
606100         WHEN SUT00030-AUD-ADJ-STAT-CDE = 'C'                     60610001
606200              MOVE 'CNFRM'  TO LQW-ADJ-TYP (PV-SUB)               60620001
606300         WHEN SUT00030-AUD-ADJ-STAT-CDE = 'V'                     60630001
606400                 MOVE 'VERFY'  TO LQW-ADJ-TYP (PV-SUB)            60640001
606500         WHEN SUT00030-AUD-ADJ-STAT-CDE = 'Q'                     60650001
606600                 MOVE 'P2L  '  TO LQW-ADJ-TYP (PV-SUB)            60660001
606700     END-EVALUATE.                                                60670001
606800     MOVE SUT00030-FINCL-ADJ-ID  TO LQW-FINCL-ID (PV-SUB).        60680001
606900                                                                  60690001
607000 7100-SELECT-ADJ.                                                 60700001
607100     EXEC SQL                                                     60710001
607200         SELECT  DEST_LOC_NBR                                     60720001
607300                ,UPC_NBR                                          60730001
607400                ,CRE_TMST                                         60740001
607500                ,CRE_PGM_NM                                       60750001
607600                ,FINCL_BEF_QTY                                    60760001
607700                ,FINCL_AFT_QTY                                    60770001
607800                ,AUTO_APL_IND                                     60780001
607900                ,PRC_RSN_CDE                                      60790001
608000                ,RSLV_BY_USR_ID                                   60800001
608100                ,AUD_ADJ_STAT_CDE                                 60810001
608200                ,FINCL_ADJ_ID                                     60820001
608300                ,ADJ_ERR_CDE                                      60830001
608400          INTO  :SUT00030-DEST-LOC-NBR                            60840001
608500               ,:SUT00030-UPC-NBR                                 60850001
608600               ,:SUT00030-CRE-TMST                                60860001
608700               ,:SUT00030-CRE-PGM-NM                              60870001
608800               ,:SUT00030-FINCL-BEF-QTY                           60880001
608900               ,:SUT00030-FINCL-AFT-QTY                           60890001
609000               ,:SUT00030-AUTO-APL-IND                            60900001
609100               ,:SUT00030-PRC-RSN-CDE                             60910001
609200               ,:SUT00030-RSLV-BY-USR-ID                          60920001
609300               ,:SUT00030-AUD-ADJ-STAT-CDE                        60930001
609400               ,:SUT00030-FINCL-ADJ-ID                            60940001
609500               ,:SUT00030-ADJ-ERR-CDE :PV-NULL-IND-1              60950001
609600           FROM  SUT_FINCL_ADJ                                    60960001
609700         WHERE  FINCL_ADJ_ID       = :DK-FINCL-ID                 60970001
609800     END-EXEC.                                                    60980001
609900*-----------------------------------------------------------------60990001
610000*  READ THE LIST QUEUE RECORD                                     61000001
610100*-----------------------------------------------------------------61010001
610200 9100-READ-SEL-QUEUE.                                             61020066
610300                                                                  61030001
610400     EXEC CICS                                                    61040001
610500         READQ TS                                                 61050001
610600             QUEUE (ASC-SEL-QUEUE-IN)                             61060001
610700             INTO  (SU039-SELECT-RECORD)                          61070001
610800             ITEM  (ASC-SEL-ITEM)                                 61080001
610900             RESP  (PV-CICS-RESP)                                 61090001
611000     END-EXEC.                                                    61100001
611100     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        61110001
611200         CONTINUE                                                 61120001
611300     ELSE                                                         61130001
611400         SET DP013-LOGIC-ABEND                                    61140001
611500             DP013-NO-ROLLBACK   TO   TRUE                        61150001
611600         MOVE '9100-READ-SEL-QUEUE' TO   DP013-PARAGRAPH          61160001
611700         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   61170001
611800                                 TO   DP013-MESSAGE-TEXT (1)      61180001
611900         PERFORM DP013-0000-PROCESS-ABEND                         61190001
612000     END-IF.                                                      61200001
612100                                                                  61210001
612200*-----------------------------------------------------------------61220001
612300* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *61230001
612400*-----------------------------------------------------------------61240001
612500 9200-REWRITE-SEL-QUEUE.                                          61250001
612600                                                                  61260001
612700     EXEC CICS                                                    61270001
612800          WRITEQ TS                                               61280001
612900              QUEUE  (ASC-SEL-QUEUE-IN)                           61290001
613000              FROM   (SU039-SELECT-RECORD)                        61300001
613100              ITEM   (ASC-SEL-ITEM)                               61310001
613200              RESP   (PV-CICS-RESP)                               61320001
613300              REWRITE                                             61330001
613400     END-EXEC.                                                    61340001
613500                                                                  61350001
613600     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   61360001
613700         SET DP013-CICS-ABEND                                     61370001
613800             DP013-NO-ROLLBACK     TO TRUE                        61380001
613900         MOVE '9200-REWRITE-SEL-QUEUE'                            61390001
614000                                   TO DP013-PARAGRAPH             61400001
614100         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   61410001
614200                                   TO DP013-MESSAGE-TEXT (1)      61420001
614300         PERFORM DP013-0000-PROCESS-ABEND                         61430001
614400     END-IF.                                                      61440001
614500                                                                  61450001
614600*-----------------------------------------------------------------61460068
614700*  READ THE LIST QUEUE RECORD                                     61470068
614800*-----------------------------------------------------------------61480068
614900 9300-READ-SEL-QUEUE-2.                                           61490071
615000                                                                  61500068
615100     EXEC CICS                                                    61510068
615200         READQ TS                                                 61520068
615300             QUEUE (ASC-SEL-QUEUE-IN-2)                           61530071
615400             INTO  (SU039-SELECT-RECORD)                          61540068
615500             ITEM  (ASC-SEL-ITEM)                                 61550068
615600             RESP  (PV-CICS-RESP)                                 61560068
615700     END-EXEC.                                                    61570068
615800     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        61580068
615900         CONTINUE                                                 61590068
616000     ELSE                                                         61600068
616100         SET DP013-LOGIC-ABEND                                    61610068
616200             DP013-NO-ROLLBACK   TO   TRUE                        61620068
616300         MOVE '9300-READ-SEL-QUEUE-2' TO   DP013-PARAGRAPH        61630071
616400         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   61640068
616500                                 TO   DP013-MESSAGE-TEXT (1)      61650068
616600         PERFORM DP013-0000-PROCESS-ABEND                         61660068
616700     END-IF.                                                      61670068
616800                                                                  61680068
616900*-----------------------------------------------------------------61690068
617000* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *61700068
617100*-----------------------------------------------------------------61710068
617200 9400-REWRITE-SEL-QUEUE-2.                                        61720071
617300                                                                  61730068
617400     EXEC CICS                                                    61740068
617500          WRITEQ TS                                               61750068
617600              QUEUE  (ASC-SEL-QUEUE-IN-2)                         61760071
617700              FROM   (SU039-SELECT-RECORD)                        61770068
617800              ITEM   (ASC-SEL-ITEM)                               61780068
617900              RESP   (PV-CICS-RESP)                               61790068
618000              REWRITE                                             61800068
618100     END-EXEC.                                                    61810068
618200                                                                  61820068
618300     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   61830068
618400         SET DP013-CICS-ABEND                                     61840068
618500             DP013-NO-ROLLBACK     TO TRUE                        61850068
618600         MOVE '9400-REWRITE-SEL-QUEUE-2'                          61860071
618700                                   TO DP013-PARAGRAPH             61870068
618800         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   61880068
618900                                   TO DP013-MESSAGE-TEXT (1)      61890068
619000         PERFORM DP013-0000-PROCESS-ABEND                         61900068
619100     END-IF.                                                      61910068
619200                                                                  61920068
619300*-----------------------------------------------------------------61930071
619400*  READ THE LIST QUEUE RECORD                                     61940071
619500*-----------------------------------------------------------------61950071
619600 9500-READ-SEL-QUEUE-3.                                           61960071
619700                                                                  61970071
619800     EXEC CICS                                                    61980071
619900         READQ TS                                                 61990071
620000             QUEUE (ASC-SEL-QUEUE-IN-3)                           62000071
620100             INTO  (SU039-SELECT-RECORD)                          62010071
620200             ITEM  (ASC-SEL-ITEM)                                 62020071
620300             RESP  (PV-CICS-RESP)                                 62030071
620400     END-EXEC.                                                    62040071
620500     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        62050071
620600         CONTINUE                                                 62060071
620700     ELSE                                                         62070071
620800         SET DP013-LOGIC-ABEND                                    62080071
620900             DP013-NO-ROLLBACK   TO   TRUE                        62090071
621000         MOVE '9500-READ-SEL-QUEUE-3' TO   DP013-PARAGRAPH        62100071
621100         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   62110071
621200                                 TO   DP013-MESSAGE-TEXT (1)      62120071
621300         PERFORM DP013-0000-PROCESS-ABEND                         62130071
621400     END-IF.                                                      62140071
621500                                                                  62150071
621600*-----------------------------------------------------------------62160071
621700* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *62170071
621800*-----------------------------------------------------------------62180071
621900 9600-REWRITE-SEL-QUEUE-3.                                        62190071
622000                                                                  62200071
622100     EXEC CICS                                                    62210071
622200          WRITEQ TS                                               62220071
622300              QUEUE  (ASC-SEL-QUEUE-IN-3)                         62230071
622400              FROM   (SU039-SELECT-RECORD)                        62240071
622500              ITEM   (ASC-SEL-ITEM)                               62250071
622600              RESP   (PV-CICS-RESP)                               62260071
622700              REWRITE                                             62270071
622800     END-EXEC.                                                    62280071
622900                                                                  62290071
623000     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   62300071
623100         SET DP013-CICS-ABEND                                     62310071
623200             DP013-NO-ROLLBACK     TO TRUE                        62320071
623300         MOVE '9600-REWRITE-SEL-QUEUE-3'                          62330071
623400                                   TO DP013-PARAGRAPH             62340071
623500         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   62350071
623600                                   TO DP013-MESSAGE-TEXT (1)      62360071
623700         PERFORM DP013-0000-PROCESS-ABEND                         62370071
623800     END-IF.                                                      62380071
623900                                                                  62390071
624000*----------------------------------------------------------------*62400071
624100*    THE DB2 RESOURCE IS NOT AVAILABLE, DISPLAY A MESSAGE ON     *62410001
624200*    THE TERMINAL INDICATING THAT THE RESOURCE IS UNAVAILABLE.   *62420001
624300*----------------------------------------------------------------*62430001
624400 9900-SOFT-ABORT.                                                 62440001
624500                                                                  62450001
624600     EXEC CICS SYNCPOINT                                          62460001
624700          ROLLBACK                                                62470001
624800     END-EXEC.                                                    62480001
624900                                                                  62490001
625000     SET  PS-ERROR                                                62500001
625100          PS-SOFT-ABORT-ERROR                                     62510001
625200          DP020-MSG-FATAL       TO  TRUE.                         62520001
625300                                                                  62530001
625400*----------------------------------------------------------------*62540001
625500*    ABEND PROCESSOR MODULE                                      *62550001
625600*----------------------------------------------------------------*62560001
625700     COPY DPPD013.                                                62570001
