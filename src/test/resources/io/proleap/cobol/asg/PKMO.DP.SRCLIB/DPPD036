      ****************************************************************  00010003
      * DPPD036                                                         00020003
      ****************************************************************  00030003
206118* 08/20/18  CHG0206118  RENAMED FROM CGU040MC WHICH DID NOT       00040002
206118*                       MEET STANDARDS FOR MAINFRAME REFACTORING  00050002
      ****************************************************************  00060002
000100*    BEGIN DPPD036   CREATE OR VALIDATE MOD-10 CHECKDIGITABLE     00070002
000200*           NUMBERS.                                              00080002
000300*      CREATE CHECK-DIGITTED NUMBER:                              00090000
000400*         MOVE NUMBER TO WHICH CHECK DIGIT IS TO BE ADDED TO      00100000
000500*              BASE-NUMBER (INCLUDING LAST DIGIT IN WHICH THE     00110000
000600*              CHECK DIGIT IS TO PLACED)                          00120000
000700*         PERFORM CREATE-CHECK-DIGIT-NUMBER                       00130000
000800*         MOVE BASE-NUMBER TO YOUR NUMBER & YOU WILL HAVE A       00140000
000900*               MOD-10 CHECK DIGIT ON THE END                     00150000
001000*                                                                 00160000
001100*      VALIDATE CHECK-DIGITTED NUMBER:                            00170000
001200*         MOVE NUMBER TO BE VALIDATED TO BASE-NUMBER.             00180000
001300*         PERFORM VALIDATE-CHECK-DIGIT.                           00190000
001400*         IF CHECK-DIGIT NOT = 0 THEN THE NUMBER DOES NOT HAVE A  00200000
001500*            VALID CHECK DIGIT                                    00210000
001600*         IF CHECK-DIGIT = 0 THEN THE NUMBER HAS A VALID CHECK    00220000
001700*                 DIGIT                                           00230000
001800 CREATE-CHECK-DIGIT-NUMBER.                                       00240000
001900     SET CD-X TO NO-DIGITS.                                       00250000
002000     SET CD-X DOWN BY 1.                                          00260000
002100     COMPUTE CHECK-DIGIT = 0.                                     00270000
002200     PERFORM CDV-10-2.                                            00280000
002300     PERFORM CDV-10-1 UNTIL CD-X = 0.                             00290000
002400     SET CD-X TO NO-DIGITS.                                       00300000
002500     COMPUTE BASE-DIGIT  (CD-X) = 10 - CHECK-DIGIT.               00310000
002600 VALIDATE-CHECK-DIGIT.                                            00320000
002700     SET CD-X TO NO-DIGITS.                                       00330000
002800     COMPUTE CHECK-DIGIT = 0.                                     00340000
002900     PERFORM CDV-10-1 UNTIL CD-X = 0.                             00350000
003000 CDV-10-1.                                                        00360000
003100* WEIGHT FACTOR OF 1                                              00370000
003200     COMPUTE CHECK-DIGIT = CHECK-DIGIT + BASE-DIGIT (CD-X).       00380000
003300     SET CD-X DOWN BY 1.                                          00390000
003400     IF CD-X > 0 PERFORM CDV-10-2.                                00400000
003500 CDV-10-2.                                                        00410000
003600* WEIGHT FACTOR OF 2                                              00420000
003700     COMPUTE CHECK-DIGIT = CHECK-DIGIT + 2 * BASE-DIGIT (CD-X).   00430000
003800     IF BASE-DIGIT (CD-X) > 4                                     00440000
003900             COMPUTE CHECK-DIGIT = CHECK-DIGIT + 1.               00450000
004000     SET CD-X DOWN BY 1.                                          00460000
004100*    END   DPPD036  MOD-10 CREATE / VALIDATE                      00470001
