000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             SVKRP035.                                00050000
000600 AUTHOR.                 BARB SCHULTZ.                            00060000
000700 INSTALLATION.           KOHLS.                                   00070000
000800 DATE-WRITTEN            JULY 2005.                               00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200*  CORP RECEIVED AMOUNT FROM LP SCANNED STORED VALUE CARD REPORT *00120094
001400******************************************************************00130000
001900                                                                  00140000
002000******************************************************************00150000
002100 ENVIRONMENT DIVISION.                                            00160000
002200******************************************************************00170000
002300                                                                  00180000
002400 CONFIGURATION SECTION.                                           00190000
002500                                                                  00200000
002600 SOURCE-COMPUTER.        IBM-3090.                                00210000
002700 OBJECT-COMPUTER.        IBM-3090.                                00220000
002800                                                                  00230000
002900 INPUT-OUTPUT SECTION.                                            00240000
003000                                                                  00250000
003100 FILE-CONTROL.                                                    00260000
003200     SELECT DATE-CARD-FILE                                        00270000
003300         ASSIGN TO INP01.                                         00280000
003400                                                                  00290000
003200     SELECT EXTRACT-FILE                                          00300030
003300         ASSIGN TO INP02.                                         00310030
003400                                                                  00320030
004100     SELECT CORP-RCVD-RPT                                         00330004
004200         ASSIGN TO RPT01.                                         00340000
004300                                                                  00350000
004400******************************************************************00390000
004500 DATA DIVISION.                                                   00400000
004600******************************************************************00410000
004700                                                                  00420000
004800 FILE SECTION.                                                    00430000
004900                                                                  00440000
005000 FD  DATE-CARD-FILE                                               00450000
005100     RECORDING MODE IS F                                          00460000
005200     BLOCK CONTAINS 0 RECORDS                                     00470000
005300     LABEL RECORDS ARE STANDARD.                                  00480000
005400                                                                  00490000
005500 01  DATE-CARD-RECORD                       PIC X(80).            00500000
005600                                                                  00510000
005000 FD  EXTRACT-FILE                                                 00520030
005100     RECORDING MODE IS F                                          00530030
005200     BLOCK CONTAINS 0 RECORDS                                     00540030
005300     LABEL RECORDS ARE STANDARD.                                  00550030
005400                                                                  00560030
005500 01  EXTRACT-RECORD                         PIC X(60).            00570030
005600                                                                  00580030
006400 FD  CORP-RCVD-RPT                                                00590004
006500     RECORDING MODE IS F                                          00600000
006600     BLOCK CONTAINS 0 RECORDS                                     00610000
006700     LABEL RECORDS ARE STANDARD.                                  00620000
006800                                                                  00630000
006900 01  CORP-RECEIVED-RECORD                   PIC X(132).           00640001
007000                                                                  00650000
007800******************************************************************00730000
007900 WORKING-STORAGE SECTION.                                         00740000
008000******************************************************************00750000
011100                                                                  00760000
023000******************************************************************00820000
023100*  KOHL'S STANDARD REPORT HEADING                                *00830000
023200******************************************************************00840000
023300     COPY DPWS132.                                                00850000
023400                                                                  00860000
014200 01  RP1-HEADING-LINE-2.                                          00870000
014300     05  FILLER                       PIC  X(23)  VALUE SPACES.   00880077
014420     05  RP1-SUBNAME                  PIC  X(53)  VALUE SPACES.   00910001
014600     05  FILLER                       PIC  X(01)  VALUE SPACES.   00920000
014710     05  RP1-DATE.                                                00930000
014720         10  RP1-DATE-MM              PIC  X(02).                 00940000
014730         10  FILLER                   PIC  X(01)  VALUE '/'.      00950000
014740         10  RP1-DATE-DD              PIC  X(02).                 00960000
014750         10  FILLER                   PIC  X(01)  VALUE '/'.      00970000
014760         10  RP1-DATE-CC              PIC  X(02).                 00980000
014770         10  RP1-DATE-YY              PIC  X(02).                 00990000
014600     05  FILLER                       PIC  X(04)  VALUE ' TO '.   00990101
014710     05  RP1-DATE-2.                                              00991004
014720         10  RP1-DATE-MM-2            PIC  X(02).                 00992001
014730         10  FILLER                   PIC  X(01)  VALUE '/'.      00993001
014740         10  RP1-DATE-DD-2            PIC  X(02).                 00994001
014750         10  FILLER                   PIC  X(01)  VALUE '/'.      00995001
014760         10  RP1-DATE-CC-2            PIC  X(02).                 00996001
014770         10  RP1-DATE-YY-2            PIC  X(02).                 00997001
014800     05  FILLER                       PIC  X(46)  VALUE SPACES.   01000000
014900                                                                  01010000
014910 01  RP1-HEADING-LINE-2-5.                                        01080031
014920     05  FILLER                       PIC  X(05)  VALUE SPACE.    01090040
014930     05  FILLER                       PIC  X(04)  VALUE 'CARD'.   01100031
014950     05  FILLER                       PIC  X(28)  VALUE SPACES.   01120061
014980     05  FILLER                       PIC  X(05)  VALUE 'K C K'.  01150061
014990     05  FILLER                       PIC  X(20)  VALUE SPACES.   01160077
014980     05  FILLER                       PIC  X(07)  VALUE           01163061
015010                                          'G I F T'.              01164061
014990     05  FILLER                       PIC  X(20)  VALUE SPACES.   01165078
015000     05  FILLER                       PIC  X(07)  VALUE           01181061
015010                                          'K M R C'.              01182061
014990     05  FILLER                       PIC  X(20)  VALUE SPACES.   01183367
015000     05  FILLER                       PIC  X(09)  VALUE           01187061
015010                                          'T O T A L'.            01188061
016050                                                                  01340000
014910 01  RP1-HEADING-LINE-3.                                          01341031
014920     05  FILLER                       PIC  X(01)  VALUE SPACE.    01342031
014950     05  FILLER                       PIC  X(01)  VALUE SPACES.   01342140
014930     05  FILLER                       PIC  X(10)  VALUE           01343031
014940                                         'CLOSE DATE'.            01344031
014950     05  FILLER                       PIC  X(02)  VALUE SPACES.   01345031
014960     05  FILLER                       PIC  X(07)  VALUE 'USER ID'.01346031
014970     05  FILLER                       PIC  X(06)  VALUE SPACES.   01347078
014980     05  FILLER                       PIC  X(06)  VALUE 'AMOUNT'. 01348031
014990     05  FILLER                       PIC  X(07)  VALUE SPACES.   01349078
015000     05  FILLER                       PIC  X(03)  VALUE           01349149
015010                                          'CNT'.                  01349249
014970     05  FILLER                       PIC  X(03)  VALUE SPACES.   01349377
015000     05  FILLER                       PIC  X(04)  VALUE           01349449
015010                                          '$CNT'.                 01349549
014970     05  FILLER                       PIC  X(05)  VALUE SPACES.   01349657
014980     05  FILLER                       PIC  X(06)  VALUE 'AMOUNT'. 01349749
014990     05  FILLER                       PIC  X(05)  VALUE SPACES.   01349877
015000     05  FILLER                       PIC  X(03)  VALUE           01349949
015010                                          'CNT'.                  01350049
014990     05  FILLER                       PIC  X(03)  VALUE SPACES.   01350177
015000     05  FILLER                       PIC  X(04)  VALUE           01350249
015010                                          '$CNT'.                 01350349
014970     05  FILLER                       PIC  X(06)  VALUE SPACES.   01350478
014980     05  FILLER                       PIC  X(06)  VALUE 'AMOUNT'. 01350549
014990     05  FILLER                       PIC  X(05)  VALUE SPACES.   01350677
015000     05  FILLER                       PIC  X(03)  VALUE           01350749
015010                                          'CNT'.                  01350849
014990     05  FILLER                       PIC  X(03)  VALUE SPACES.   01350977
015000     05  FILLER                       PIC  X(04)  VALUE           01351049
015010                                          '$CNT'.                 01351149
014970     05  FILLER                       PIC  X(06)  VALUE SPACES.   01351267
014980     05  FILLER                       PIC  X(06)  VALUE 'AMOUNT'. 01351349
014990     05  FILLER                       PIC  X(05)  VALUE SPACES.   01351455
015000     05  FILLER                       PIC  X(03)  VALUE           01351549
015010                                          'CNT'.                  01351649
014990     05  FILLER                       PIC  X(03)  VALUE SPACES.   01351767
015000     05  FILLER                       PIC  X(04)  VALUE           01351849
015010                                          '$CNT'.                 01351949
016050                                                                  01352049
014910 01  RP1-HEADING-LINE-4.                                          01352161
014920     05  FILLER                       PIC  X(05)  VALUE SPACE.    01352261
014930     05  FILLER                       PIC  X(04)  VALUE SPACES.   01352366
014950     05  FILLER                       PIC  X(17)  VALUE SPACES.   01352465
014980     05  FILLER                       PIC  X(24)  VALUE           01352565
015010                                  '------------------------'.     01352665
014990     05  FILLER                       PIC  X(03)  VALUE SPACES.   01352764
014980     05  FILLER                       PIC  X(24)  VALUE           01352865
015010                                  '------------------------'.     01352965
014990     05  FILLER                       PIC  X(03)  VALUE SPACES.   01353164
015000     05  FILLER                       PIC  X(24)  VALUE           01353265
015010                                  '------------------------'.     01353365
014990     05  FILLER                       PIC  X(03)  VALUE SPACES.   01353564
015000     05  FILLER                       PIC  X(24)  VALUE           01353665
015010                                  '------------------------'.     01353765
016050                                                                  01353961
015000 01  RP1-DETAIL-LINE.                                             01354049
016300     05  FILLER                       PIC  X(02)  VALUE SPACE.    01360031
016310     05  RP1-CLOSE-DATE               PIC  X(10)  VALUE SPACES.   01370000
016320     05  FILLER                       PIC  X(02)  VALUE SPACES.   01380031
016330     05  RP1-USER-ID                  PIC  X(08)  VALUE SPACES.   01390000
016340     05  FILLER                       PIC  X(01)  VALUE SPACES.   01400031
016350     05  RP1-KCK-AMT                  PIC  ZZZZZZZ.99-.           01410071
016360     05  FILLER                       PIC  X(03)  VALUE SPACES.   01420071
016370     05  RP1-KCK-CNT                  PIC  ZZZZZ9.                01430071
016380     05  FILLER                       PIC  X(01)  VALUE SPACES.   01440071
016370     05  RP1-KCK-DCNT                 PIC  ZZZZZ9.                01441071
016380     05  FILLER                       PIC  X(01)  VALUE SPACES.   01442042
016350     05  RP1-GIFT-AMT                 PIC  ZZZZZZZ.99-.           01450071
016360     05  FILLER                       PIC  X(01)  VALUE SPACES.   01460071
016370     05  RP1-GIFT-CNT                 PIC  ZZZZZ9.                01470071
016380     05  FILLER                       PIC  X(01)  VALUE SPACES.   01480071
016370     05  RP1-GIFT-DCNT                PIC  ZZZZZ9.                01481071
016380     05  FILLER                       PIC  X(02)  VALUE SPACES.   01482056
016350     05  RP1-KMRC-AMT                 PIC  ZZZZZZZ.99-.           01490071
016360     05  FILLER                       PIC  X(01)  VALUE SPACES.   01500071
016370     05  RP1-KMRC-CNT                 PIC  ZZZZZ9.                01510071
016380     05  FILLER                       PIC  X(01)  VALUE SPACES.   01520071
016370     05  RP1-KMRC-DCNT                PIC  ZZZZZ9.                01521071
016380     05  FILLER                       PIC  X(01)  VALUE SPACES.   01522071
016350     05  RP1-TOT-AMT                  PIC  ZZZZZZZZ.99-.          01530071
016370     05  RP1-TOT-CNT                  PIC  ZZZZZZ9.               01541071
016370     05  RP1-TOT-DCNT                 PIC  ZZZZZZ9.               01543071
                                                                        01543183
015000 01  RP2-TOTAL-LINE.                                              01544083
016300     05  FILLER                       PIC  X(09)  VALUE SPACE.    01545083
016310     05  RP2-CLOSE-DATE               PIC  X(06)  VALUE 'TOTALS'. 01546083
016320     05  FILLER                       PIC  X(07)  VALUE SPACES.   01547083
016350     05  RP2-KCK-AMT                  PIC  ZZZZZZZZ.99-.          01550083
016360     05  FILLER                       PIC  X(01)  VALUE SPACES.   01560083
016370     05  RP2-KCK-CNT                  PIC  ZZZZZZZ9.              01570083
016370     05  RP2-KCK-DCNT                 PIC  ZZZZZZ9.               01590083
016350     05  RP2-GIFT-AMT                 PIC  ZZZZZZZZ.99-.          01610083
016370     05  RP2-GIFT-CNT                 PIC  ZZZZZZ9.               01630083
016370     05  RP2-GIFT-DCNT                PIC  ZZZZZZ9.               01650083
016380     05  FILLER                       PIC  X(01)  VALUE SPACES.   01660083
016350     05  RP2-KMRC-AMT                 PIC  ZZZZZZZZ.99-.          01670083
016370     05  RP2-KMRC-CNT                 PIC  ZZZZZZ9.               01690083
016370     05  RP2-KMRC-DCNT                PIC  ZZZZZZ9.               01710083
016350     05  RP2-TOT-AMT                  PIC  ZZZZZZZZZ.99-.         01730083
016370     05  RP2-TOT-CNT                  PIC  ZZZZZZ9.               01740086
016370     05  RP2-TOT-DCNT                 PIC  ZZZZZZ9.               01750088
019800                                                                  02070000
019900 01  PC-PROGRAM-CONSTANTS.                                        02080000
020000     05  PC-PROGRAM-NAME              PIC  X(08)  VALUE           02090000
020100                                                    'SVKRP035'.   02100000
020200     05  PC-LINES-PER-PAGE            PIC S9(04)  VALUE +60       02110000
020300                                                     COMP SYNC.   02120000
020800                                                                  02130000
020900 01  PS-PROGRAM-SWITCHES.                                         02140000
021000     05  PS-END-OF-EXTRACT-FILE-SW    PIC X(01)   VALUE 'N'.      02150036
021100         88  PS-END-OF-EXTRACT-FILE               VALUE 'Y'.      02160036
021400     05  PS-END-OF-CARD-FILE-SW       PIC X(01)   VALUE 'N'.      02170000
021500         88  PS-END-OF-CARD-FILE                  VALUE 'Y'.      02180000
022400                                                                  02210000
022500 01  PV-PROGRAM-VARIABLES.                                        02220000
023400     05  PV-PARAGRAPH-NAME            PIC  X(30)  VALUE SPACE.    02230000
023500     05  PV-OPERATION-MSG-1           PIC  X(40)  VALUE SPACE.    02240000
023000     05  PV-PAGE-COUNT                PIC S9(04)  VALUE +0 COMP.  02280000
023200     05  PV-LINE-COUNT                PIC S9(04)  VALUE +0 COMP.  02300000
025620     05  PV-F-DATE-CCYY-MM-DD         PIC  X(10)  VALUE SPACES.   02315012
025620     05  PV-T-DATE-CCYY-MM-DD         PIC  X(10)  VALUE SPACES.   02316012
028410     05  PV-CURR-DATE-CCYYMMDD.                                   02317091
028410         10  PV-CURR-DATE-CCYY        PIC  9(04)  VALUE ZEROES.   02318091
028410         10  PV-CURR-DATE-MM          PIC  9(02)  VALUE ZEROES.   02319091
028410         10  PV-CURR-DATE-DD          PIC  9(02)  VALUE ZEROES.   02319191
024201     05  PV-FROM-DTE                  PIC  9(8)   VALUE ZEROES.   02320096
024201     05  PV-TO-DTE                    PIC  9(8)   VALUE ZEROES.   02330096
024201                                                                  02340096
024201                                                                  02350096
025300******************************************************************02550000
025400* RECORD LAYOUT FOR INPUT DATE CARD                               02560000
025500******************************************************************02570000
025610 01  CC-CONTROL-CARD.                                             02580000
025620     05  CC-FROM-DATE-CCYY-MM-DD.                                 02590001
025630         10  CC-FROM-DATE-CC          PIC  X(02)   VALUE SPACES.  02600001
025640         10  CC-FROM-DATE-YY          PIC  X(02)   VALUE SPACES.  02610001
025650         10  FILLER                   PIC  X(01)   VALUE SPACES.  02620000
025660         10  CC-FROM-DATE-MM          PIC  X(02)   VALUE SPACES.  02630001
025670         10  FILLER                   PIC  X(01)   VALUE SPACES.  02640000
025680         10  CC-FROM-DATE-DD          PIC  X(02)   VALUE SPACES.  02650001
025670     05  FILLER                       PIC  X(01)   VALUE SPACES.  02650101
025620     05  CC-TO-DATE-CCYY-MM-DD.                                   02650201
025630         10  CC-TO-DATE-CC            PIC  X(02)   VALUE SPACES.  02651001
025640         10  CC-TO-DATE-YY            PIC  X(02)   VALUE SPACES.  02652001
025650         10  FILLER                   PIC  X(01)   VALUE SPACES.  02653001
025660         10  CC-TO-DATE-MM            PIC  X(02)   VALUE SPACES.  02654001
025670         10  FILLER                   PIC  X(01)   VALUE SPACES.  02655001
025680         10  CC-TO-DATE-DD            PIC  X(02)   VALUE SPACES.  02656001
025690      05  FILLER                      PIC  X(59)   VALUE SPACES.  02660001
025691                                                                  02670000
026000 01  AC-ABEND-CODE                    PIC S9(04) VALUE ZERO       02680000
026100                                                 COMP SYNC.       02690000
026200     88  AC-CONTROL-CARD-ERROR                   VALUE +4003.     02700000
026202     88  AC-DATE-ERROR                           VALUE +4019.     02720000
026300                                                                  02730000
028100 01  ST-SYSTEM-TIME.                                              02790000
028200     05  ST-SYSTEM-HOUR               PIC  9(02)  VALUE ZEROS.    02800000
028300     05  ST-SYSTEM-MINUTE             PIC  9(02)  VALUE ZEROS.    02810000
028400     05  FILLER                       PIC  9(04)  VALUE ZEROS.    02820000
028410                                                                  02830000
028410 01  PV-CORP-ACCUM.                                               02834293
028410     05  PV-CRD-CLO-DTE            PIC  X(10)     VALUE SPACES.   02836029
028410     05  PV-CLO-USR-ID             PIC  X(08)     VALUE SPACES.   02837029
028410     05  PV-KCK-APP-AUTH-AMT       PIC S9(09)V99  VALUE ZEROES.   02838029
028410     05  PV-KCK-ITEM-AUTH-AMT      PIC S9(09)V99  VALUE ZEROES.   02838151
028410     05  PV-KCK-COUNT              PIC S9(09)     VALUE ZEROES.   02839029
028410     05  PV-KCK-DCOUNT             PIC S9(09)     VALUE ZEROES.   02839143
028410     05  PV-TKCK-APP-AUTH-AMT      PIC S9(09)V99  VALUE ZEROES.   02839284
028410     05  PV-TKCK-COUNT             PIC S9(09)     VALUE ZEROES.   02839484
028410     05  PV-TKCK-DCOUNT            PIC S9(09)     VALUE ZEROES.   02839584
028410     05  PV-KMRC-APP-AUTH-AMT      PIC S9(09)V99  VALUE ZEROES.   02839684
028410     05  PV-KMRC-ITEM-AUTH-AMT     PIC S9(09)V99  VALUE ZEROES.   02839784
028410     05  PV-KMRC-COUNT             PIC S9(09)     VALUE ZEROES.   02839884
028410     05  PV-KMRC-DCOUNT            PIC S9(09)     VALUE ZEROES.   02839984
028410     05  PV-TKMRC-APP-AUTH-AMT     PIC S9(09)V99  VALUE ZEROES.   02840084
028410     05  PV-TKMRC-COUNT            PIC S9(09)     VALUE ZEROES.   02840184
028410     05  PV-TKMRC-DCOUNT           PIC S9(09)     VALUE ZEROES.   02840284
028410     05  PV-GIFT-APP-AUTH-AMT      PIC S9(09)V99  VALUE ZEROES.   02840384
028410     05  PV-TGIFT-APP-AUTH-AMT     PIC S9(09)V99  VALUE ZEROES.   02840484
028410     05  PV-TGIFT-COUNT            PIC S9(09)     VALUE ZEROES.   02840684
028410     05  PV-GIFT-COUNT             PIC S9(09)     VALUE ZEROES.   02840784
028410     05  PV-TGIFT-DCOUNT           PIC S9(09)     VALUE ZEROES.   02840884
028410     05  PV-GIFT-DCOUNT            PIC S9(09)     VALUE ZEROES.   02840984
028410     05  PV-TOTAL-APP-AUTH-AMT     PIC S9(09)V99  VALUE ZEROES.   02841084
028410     05  PV-TOTAL-COUNT            PIC S9(09)     VALUE ZEROES.   02841184
028410     05  PV-TOTAL-DCOUNT           PIC S9(09)     VALUE ZEROES.   02841284
028410     05  PV-GTOT-APP-AUTH-AMT      PIC S9(09)V99  VALUE ZEROES.   02841384
028410     05  PV-GTOT-COUNT             PIC S9(09)     VALUE ZEROES.   02841484
028410     05  PV-GTOT-DCOUNT            PIC S9(09)     VALUE ZEROES.   02841584
028410                                                                  02842090
028500******************************************************************02843090
028600* DATE ROUTINE COPY MEMBERS                                       02850000
028700******************************************************************02860000
028800     COPY DPWS500.                                                02870000
028900                                                                  02880000
028500******************************************************************02890035
028600* INPUT FILE INCLUDE - CORP RECEIVED AMOUNT                       02900035
028700******************************************************************02910035
028800     COPY SVRD056.                                                02920035
028900                                                                  02930035
030200******************************************************************03161000
030300 PROCEDURE DIVISION.                                              03170000
030400******************************************************************03180000
030500 0000-PROGRAM-MAINLINE.                                           03190000
030600                                                                  03200000
030900     PERFORM 1000-INITIALIZE.                                     03210000
031000                                                                  03220000
031100     PERFORM 2000-PROCESS-REPORT-FILE                             03230000
031200       UNTIL PS-END-OF-EXTRACT-FILE.                              03240037
031300                                                                  03250000
040199     PERFORM 4000-MOVE-REPORT-DATA.                               03260076
040199     PERFORM 6000-MOVE-TOTAL-DATA.                                03270085
032900     PERFORM 9000-EOJ-ROUTINE.                                    03300000
033000                                                                  03310000
033100     STOP RUN.                                                    03320000
033200                                                                  03330000
033300******************************************************************03340000
033400*  1000-INITIALIZE                                                03350000
033500******************************************************************03360000
033600 1000-INITIALIZE.                                                 03370000
033700                                                                  03380000
033800     OPEN INPUT  DATE-CARD-FILE                                   03390000
033800                 EXTRACT-FILE                                     03400030
034100          OUTPUT CORP-RCVD-RPT.                                   03410004
034160                                                                  03430000
034200     MOVE ZEROS  TO  PV-PAGE-COUNT.                               03440002
034300     MOVE FUNCTION CURRENT-DATE (1:8) TO PV-CURR-DATE-CCYYMMDD    03460090
034500     ACCEPT ST-SYSTEM-TIME  FROM TIME.                            03480000
034600                                                                  03490000
034600     MOVE PV-CURR-DATE-MM          TO  DP132-RUN-MONTH.           03491091
034600     MOVE PV-CURR-DATE-DD          TO  DP132-RUN-DAY.             03492091
034600     MOVE PV-CURR-DATE-CCYY        TO  DP132-RUN-YEAR.            03493091
035150     MOVE ST-SYSTEM-HOUR           TO  DP132-RUN-HOUR.            03530000
035160     MOVE ST-SYSTEM-MINUTE         TO  DP132-RUN-MINUTE.          03540000
035170                                                                  03550000
035200     MOVE PC-PROGRAM-NAME  TO  DP132-PROGRAM-NAME.                03560000
035300                                                                  03570000
076856     INITIALIZE DPG51 DPG52 DPG53                                 03571096
076857                DPG54 DPG55 DPG56.                                03572096
035300                                                                  03573096
039598     PERFORM 1400-PROCESS-CONTROL-CARD.                           03580000
035300                                                                  03580113
035300     MOVE CC-FROM-DATE-CCYY-MM-DD   TO PV-F-DATE-CCYY-MM-DD.      03580596
035300     MOVE PV-F-DATE-CCYY-MM-DD      TO DPG52-LK-DATE-INPUT.       03580696
035300     PERFORM 9975-DATE-ROUTINE.                                   03580796
035300     MOVE DPG55-DB2-ISO-DATE-N      TO PV-FROM-DTE.               03580896
035300                                                                  03580996
035300     MOVE CC-TO-DATE-CCYY-MM-DD     TO PV-T-DATE-CCYY-MM-DD.      03581096
035300     MOVE PV-T-DATE-CCYY-MM-DD      TO DPG52-LK-DATE-INPUT.       03581196
035300     PERFORM 9975-DATE-ROUTINE.                                   03581296
035300     MOVE DPG55-DB2-ISO-DATE-N      TO PV-TO-DTE.                 03581396
035300                                                                  03581496
035300     IF PV-FROM-DTE < PV-TO-DTE                                   03581596
035300         CONTINUE                                                 03581696
035300     ELSE                                                         03581796
035300         MOVE '1000-INITIALIZE'  TO PV-PARAGRAPH-NAME             03581896
035300         MOVE 'CONTROL CARD DATES ARE NOT CORRECT '               03581996
035300                       TO PV-OPERATION-MSG-1                      03582096
035300         SET AC-CONTROL-CARD-ERROR TO TRUE                        03582196
035300         PERFORM 9999-ABEND                                       03582296
035300     END-IF.                                                      03582396
035300                                                                  03582496
039602     MOVE CC-FROM-DATE-CCYY-MM-DD TO PV-F-DATE-CCYY-MM-DD.        03582596
039602     MOVE CC-TO-DATE-CCYY-MM-DD   TO PV-T-DATE-CCYY-MM-DD.        03582696
035300                                                                  03583013
           INITIALIZE PV-CORP-ACCUM.                                    03584093
035300                                                                  03585017
039602     PERFORM 4500-READ-EXTRACT-FILE.                              03591030
041100     MOVE SV056-CRD-CLO-DTE  TO PV-CRD-CLO-DTE.                   03591139
           MOVE SV056-CLO-USR-ID   TO PV-CLO-USR-ID.                    03591239
035300                                                                  03591442
041430     PERFORM 5000-CORP-RCVD-RPT-HEADER.                           03591542
039602                                                                  03591642
039623***************************************************************** 03710000
039624* 1400-PROCESS-CONTROL-CARD                                       03720000
039625* READ DATE CONTROL CARD FOR FISCAL MONTH-END DATE.               03730000
039626* CALL DATE ROUTINE TO GET MAX FISCAL PERIOD.                     03740000
039627***************************************************************** 03750000
039628 1400-PROCESS-CONTROL-CARD.                                       03760000
039629                                                                  03770000
039630     PERFORM 1410-READ-DATE-CARD-FILE.                            03780000
039631                                                                  03790000
039632     IF PS-END-OF-CARD-FILE                                       03800000
039633         MOVE '1400-PROCESS-CONTROL-CARD'  TO PV-PARAGRAPH-NAME   03810000
039634         MOVE 'NO CONTROL CARD TO PROCESS' TO PV-OPERATION-MSG-1  03820000
039635         SET AC-CONTROL-CARD-ERROR TO TRUE                        03830000
039636         PERFORM 9999-ABEND                                       03840000
039637     END-IF.                                                      03850000
039638                                                                  03860000
039641     MOVE CC-FROM-DATE-CC          TO RP1-DATE-CC.                03890001
039642     MOVE CC-FROM-DATE-YY          TO RP1-DATE-YY.                03900001
039643     MOVE CC-FROM-DATE-MM          TO RP1-DATE-MM.                03910001
039644     MOVE CC-FROM-DATE-DD          TO RP1-DATE-DD.                03920001
025620     DISPLAY 'CC-FROM-DATE-CCYY-MM-DD' CC-FROM-DATE-CCYY-MM-DD.   03921011
039646                                                                  03930000
039641     MOVE CC-TO-DATE-CC            TO RP1-DATE-CC-2.              03931024
039642     MOVE CC-TO-DATE-YY            TO RP1-DATE-YY-2.              03932024
039643     MOVE CC-TO-DATE-MM            TO RP1-DATE-MM-2.              03933024
039644     MOVE CC-TO-DATE-DD            TO RP1-DATE-DD-2.              03934024
025620     DISPLAY 'CC-TO-DATE-CCYY-MM-DD' CC-TO-DATE-CCYY-MM-DD.       03934111
039646                                                                  03935001
039647     DISPLAY 'SVKRP035 CONTROL CARD DATE: '                       03940000
039648                          CC-CONTROL-CARD.                        03950000
039649                                                                  03960000
039650******************************************************************03970000
039651* 1410-READ-DATE-CARD-FILE                                        03980000
039652******************************************************************03990000
039653 1410-READ-DATE-CARD-FILE.                                        04000000
039654                                                                  04010000
039655     READ DATE-CARD-FILE INTO CC-CONTROL-CARD                     04020000
039656       AT END                                                     04030000
039657           SET PS-END-OF-CARD-FILE TO TRUE.                       04040000
039658                                                                  04050000
039660******************************************************************04060000
039662* 2000-PROCESS-REPORT-FILE                                       *04070000
039664******************************************************************04080000
039666 2000-PROCESS-REPORT-FILE.                                        04090000
039668                                                                  04100001
041100     IF SV056-CRD-CLO-DTE    = PV-CRD-CLO-DTE AND                 04102032
              SV056-CLO-USR-ID     = PV-CLO-USR-ID                      04102132
                PERFORM 3000-ADD-FIGURES                                04102232
041100     ELSE                                                         04105032
040199        PERFORM 4000-MOVE-REPORT-DATA                             04106032
              PERFORM 3000-ADD-FIGURES                                  04107033
039668     END-IF.                                                      04107547
039668                                                                  04109017
039602     PERFORM 4500-READ-EXTRACT-FILE.                              04109236
039668                                                                  04109317
040196******************************************************************04109432
040197* ADD AMOUNTS AND COUNTS TO THE APPROPRIATE CARD TYPE            *04109532
040198******************************************************************04109632
040199 3000-ADD-FIGURES.                                                04109732
           EVALUATE SV056-CRD-STK-TYP-ID                                04110032
              WHEN 'KCK'                                                04120037
                  IF SV056-APP-AUTH-AMT = 0                             04162095
039668               ADD +1              TO PV-KCK-COUNT                04162192
039668                                      PV-TKCK-COUNT               04162292
039668                                      PV-TOTAL-COUNT              04162392
039668                                      PV-GTOT-COUNT               04162492
                  ELSE                                                  04162592
039668               ADD +1              TO PV-KCK-DCOUNT               04163089
039668                                      PV-TKCK-DCOUNT              04163189
039668                                      PV-TOTAL-DCOUNT             04163289
039668                                      PV-GTOT-DCOUNT              04163389
                  END-IF                                                04164189
                  ADD SV056-APP-AUTH-AMT TO PV-KCK-APP-AUTH-AMT         04165592
                                            PV-TKCK-APP-AUTH-AMT        04165792
                                            PV-TOTAL-APP-AUTH-AMT       04165892
                                            PV-GTOT-APP-AUTH-AMT        04166092
              WHEN 'KMRC'                                               04170037
                  IF SV056-APP-AUTH-AMT = 0                             04210195
039668               ADD +1              TO PV-KMRC-COUNT               04210292
039668                                      PV-TOTAL-COUNT              04210392
039668                                      PV-TKMRC-COUNT              04210492
039668                                      PV-GTOT-COUNT               04210592
                  ELSE                                                  04210692
039668               ADD +1              TO PV-KMRC-DCOUNT              04210789
039668                                      PV-TOTAL-DCOUNT             04210889
039668                                      PV-TKMRC-DCOUNT             04210989
039668                                      PV-GTOT-DCOUNT              04211089
                  END-IF                                                04211389
                  ADD SV056-APP-AUTH-AMT TO PV-KMRC-APP-AUTH-AMT        04211589
                                            PV-TKMRC-APP-AUTH-AMT       04211789
                                            PV-TOTAL-APP-AUTH-AMT       04211889
                                            PV-GTOT-APP-AUTH-AMT        04211989
              WHEN OTHER                                                04212183
                  IF SV056-APP-AUTH-AMT = 0                             04216095
039668               ADD +1              TO PV-GIFT-COUNT               04216192
039668                                      PV-TOTAL-COUNT              04216292
039668                                      PV-TGIFT-COUNT              04216392
039668                                      PV-GTOT-COUNT               04216492
                  ELSE                                                  04216592
039668               ADD +1              TO PV-GIFT-DCOUNT              04217089
039668                                      PV-TOTAL-DCOUNT             04217189
039668                                      PV-TGIFT-DCOUNT             04217289
039668                                      PV-GTOT-DCOUNT              04217389
                  END-IF                                                04218489
                  ADD SV056-APP-AUTH-AMT TO PV-GIFT-APP-AUTH-AMT        04218689
                                            PV-TOTAL-APP-AUTH-AMT       04218889
                                            PV-TGIFT-APP-AUTH-AMT       04218989
                                            PV-GTOT-APP-AUTH-AMT        04219089
           END-EVALUATE.                                                04220032
                                                                        04220182
041100     MOVE SV056-CRD-CLO-DTE  TO PV-CRD-CLO-DTE.                   04221079
           MOVE SV056-CLO-USR-ID   TO PV-CLO-USR-ID.                    04222079
                                                                        04230032
040196******************************************************************04651100
040197* 4000-MOVE-REPORT-DATA                                          *04651200
440198******************************************************************04651342
040199 4000-MOVE-REPORT-DATA.                                           04651400
040200                                                                  04651500
040200     MOVE PV-CRD-CLO-DTE        TO RP1-CLOSE-DATE.                04653333
040300     MOVE PV-CLO-USR-ID         TO RP1-USER-ID.                   04653433
           MOVE PV-GIFT-APP-AUTH-AMT  TO RP1-GIFT-AMT.                  04653733
039668     MOVE PV-GIFT-COUNT         TO RP1-GIFT-CNT.                  04653933
039668     MOVE PV-GIFT-DCOUNT        TO RP1-GIFT-DCNT.                 04654049
           MOVE PV-KCK-APP-AUTH-AMT   TO RP1-KCK-AMT.                   04654233
039668     MOVE PV-KCK-COUNT          TO RP1-KCK-CNT.                   04654433
039668     MOVE PV-KCK-DCOUNT         TO RP1-KCK-DCNT.                  04654549
           MOVE PV-KMRC-APP-AUTH-AMT  TO RP1-KMRC-AMT.                  04654733
           MOVE PV-KMRC-COUNT         TO RP1-KMRC-CNT.                  04654833
           MOVE PV-KMRC-DCOUNT        TO RP1-KMRC-DCNT.                 04654949
           MOVE PV-TOTAL-APP-AUTH-AMT TO RP1-TOT-AMT.                   04655049
039668     MOVE PV-TOTAL-COUNT        TO RP1-TOT-CNT.                   04655133
039668     MOVE PV-TOTAL-DCOUNT       TO RP1-TOT-DCNT.                  04655249
041000                                                                  04656033
041410     IF PV-LINE-COUNT > PC-LINES-PER-PAGE                         04656133
041430        PERFORM 5000-CORP-RCVD-RPT-HEADER                         04656233
041650     END-IF.                                                      04656333
041000                                                                  04656433
071700     WRITE CORP-RECEIVED-RECORD FROM RP1-DETAIL-LINE AFTER        04656533
041600               ADVANCING 1 LINE.                                  04656633
041800     ADD +1 TO PV-LINE-COUNT.                                     04656733
041000                                                                  04656833
           MOVE ZEROS  TO PV-GIFT-APP-AUTH-AMT                          04656933
                          PV-KCK-APP-AUTH-AMT                           04657033
                          PV-KMRC-APP-AUTH-AMT                          04657133
                          PV-TOTAL-APP-AUTH-AMT                         04657273
039668                    PV-GIFT-COUNT                                 04657533
039668                    PV-KMRC-COUNT                                 04657633
039668                    PV-KCK-COUNT                                  04657733
039668                    PV-TOTAL-COUNT                                04657873
039668                    PV-GIFT-DCOUNT                                04657942
039668                    PV-KMRC-DCOUNT                                04658042
039668                    PV-KCK-DCOUNT                                 04658173
039668                    PV-TOTAL-DCOUNT.                              04658273
041000                                                                  04658346
041000******************************************************************04658446
041000*     4500-READ-EXTRACT-FILE.                                    *04658546
041000*     READES THE EXTRACT FILE                                    *04658646
041000******************************************************************04658746
039602 4500-READ-EXTRACT-FILE.                                          04658846
041000                                                                  04658946
039655     READ EXTRACT-FILE INTO SV056-DETAIL-TRANS                    04659046
039656       AT END                                                     04659146
039657           SET PS-END-OF-EXTRACT-FILE TO TRUE.                    04660046
041100                                                                  04661202
044000******************************************************************04661302
044100* 5000-CORP-RCVD-RPT-HEADER                                      *04661404
044200******************************************************************04661502
044300 5000-CORP-RCVD-RPT-HEADER.                                       04661604
044400                                                                  04661700
071300     MOVE 4             TO PV-LINE-COUNT.                         04661800
071400     ADD  1             TO PV-PAGE-COUNT.                         04661900
071500     MOVE PV-PAGE-COUNT TO DP132-PAGE-NUMBER.                     04662000
071510     MOVE 1             TO DP132-REPORT-NUMBER.                   04662100
039640     MOVE 'CORPORATE RECEIVED AMOUNT FROM LP SCANNED CARDS FROM ' 04662201
014420                                   TO RP1-SUBNAME.                04662301
071700     WRITE CORP-RECEIVED-RECORD                                   04662401
071800       FROM DP132-STANDRD-HEADER-132-COLS                         04662500
071900         AFTER ADVANCING PAGE.                                    04662600
072000                                                                  04662700
072100     WRITE CORP-RECEIVED-RECORD                                   04662801
072200         FROM RP1-HEADING-LINE-2                                  04662900
072300         AFTER ADVANCING 1 LINE.                                  04663000
072400                                                                  04663100
072100     WRITE CORP-RECEIVED-RECORD                                   04663233
072200         FROM RP1-HEADING-LINE-2-5                                04663333
072300         AFTER ADVANCING 2 LINE.                                  04663461
072400                                                                  04663533
072100     WRITE CORP-RECEIVED-RECORD                                   04663633
072600         FROM RP1-HEADING-LINE-3                                  04663733
072700         AFTER ADVANCING 1 LINES.                                 04664061
086660                                                                  04671400
072100     WRITE CORP-RECEIVED-RECORD                                   04671561
072600         FROM RP1-HEADING-LINE-4                                  04671661
072700         AFTER ADVANCING 1 LINES.                                 04671761
086660                                                                  04671861
040196******************************************************************04671983
040197* 6000-MOVE-TOTAL-DATA                                           *04672083
440198******************************************************************04673083
040199 6000-MOVE-TOTAL-DATA.                                            04674083
040200                                                                  04674183
           MOVE PV-TGIFT-APP-AUTH-AMT TO RP2-GIFT-AMT.                  04674486
039668     MOVE PV-TGIFT-COUNT        TO RP2-GIFT-CNT.                  04674586
039668     MOVE PV-TGIFT-DCOUNT       TO RP2-GIFT-DCNT.                 04674686
           MOVE PV-TKCK-APP-AUTH-AMT  TO RP2-KCK-AMT.                   04674786
039668     MOVE PV-TKCK-COUNT         TO RP2-KCK-CNT.                   04674886
039668     MOVE PV-TKCK-DCOUNT        TO RP2-KCK-DCNT.                  04674986
           MOVE PV-TKMRC-APP-AUTH-AMT TO RP2-KMRC-AMT.                  04675086
           MOVE PV-TKMRC-COUNT        TO RP2-KMRC-CNT.                  04675186
           MOVE PV-TKMRC-DCOUNT       TO RP2-KMRC-DCNT.                 04675286
           MOVE PV-GTOT-APP-AUTH-AMT  TO RP2-TOT-AMT.                   04675383
039668     MOVE PV-GTOT-COUNT         TO RP2-TOT-CNT.                   04675483
039668     MOVE PV-GTOT-DCOUNT        TO RP2-TOT-DCNT.                  04675583
041000                                                                  04675683
041410     IF PV-LINE-COUNT > PC-LINES-PER-PAGE                         04675783
041430        PERFORM 5000-CORP-RCVD-RPT-HEADER                         04675883
041650     END-IF.                                                      04675983
041000                                                                  04676083
071700     WRITE CORP-RECEIVED-RECORD FROM RP2-TOTAL-LINE AFTER         04676183
041600               ADVANCING 2 LINES.                                 04676283
039699******************************************************************04676300
039700* 9000-EOJ-ROUTINE.                                              *04676400
039800******************************************************************04676500
039900 9000-EOJ-ROUTINE.                                                04676600
040000                                                                  04677000
040100     CLOSE DATE-CARD-FILE                                         04680000
040300           CORP-RCVD-RPT.                                         04700004
040500                                                                  04720000
076848******************************************************************04730000
076849*     9975-DATE-ROUTINE.                                         *04740000
076850* ==> PROCESSES:                                                 *04750000
076851*     -VALIDATES THE INPUT DATES ON THE CONTROL FILE             *04760096
076852* ==> PERFORMED FROM: B100-INITIALIZE                            *04770000
076853******************************************************************04780000
076854 9975-DATE-ROUTINE.                                               04790000
076855                                                                  04800000
076859     SET DPG51-ACTUAL-CALENDAR-ONLY  TO TRUE.                     04840000
076860                                                                  04850000
076862     SET DPG52-LK-DTE-ISO-FMT       TO TRUE.                      04870000
076863                                                                  04880000
076864     CALL DP500-KOHLS-CALENDAR-ROUTINE                            04890000
076865       USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.                 04900000
076866                                                                  04910000
076867     EVALUATE TRUE                                                04920000
076868         WHEN DPG54-SEVERE-ERROR                                  04930000
076869         WHEN DPG54-DATE-INVALID                                  04940000
076870             SET AC-DATE-ERROR TO TRUE                            04950000
076870             MOVE '9975-DATE-ROUTINE' TO PV-PARAGRAPH-NAME        04951096
076870             MOVE DPG54-ERROR-MESSAGE TO PV-OPERATION-MSG-1       04952096
076871             PERFORM 9999-ABEND                                   04960000
076872     END-EVALUATE.                                                04970000
076866                                                                  04970106
076880******************************************************************05070003
076900* 9999-ABEND - PERFORMS A NON-SQL-ABEND                           05080003
077000******************************************************************05090003
077100 9999-ABEND.                                                      05100003
077200     DISPLAY '** ABEND           **'.                             05110003
077300     DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.          05120003
077400     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        05130003
077500     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       05140003
077600     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         05150003
