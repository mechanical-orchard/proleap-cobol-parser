000100 IDENTIFICATION DIVISION.                                         00010000
000200                                                                  00020000
000300 PROGRAM-ID.             PCKRF863.                                00030000
000400 AUTHOR.                 LYNN MCADAMS.                            00040000
000500 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00050000
000600 DATE-WRITTEN            JANUARY, 2001.                           00060000
000700 DATE-COMPILED.                                                   00070000
000800                                                                  00080000
000900******************************************************************00090000
001000* THIS PROGRAM DISPLAYS THE ADJUSTED CARTON QUANTITY ON THE LRT   00100000
001100* (LASER RADIO TERMINAL) WHEN A REASON CODE IS SELECTED FROM      00110000
001200* THE ALTER REASON CODES SCREEN (PCKRF862).  IT WILL ACCEPT THE   00120000
001300* ENTRY OF THE UPC CODE OR SKU NUMBER, AND ALLOWS THE ASSOCIATE   00130000
001400* TO MAKE AN ADJUSTMENT TO THE UNITS IN THE CARTON FOR THAT       00140000
001500* UPC OR SKU.                                                     00150000
001600*                                                                 00160000
001700* IF ITEMS ARE NOT RECOGNIZED AS BEING PART OF THE CARTON CONTENTS00170000
001800* THE UNITS IN CTN WILL DISPLAY ZERO AND THE ASSOCIATE WILL BE    00180000
001900* ABLE TO ADD ITEMS/UNITS TO THE CARTON.                          00190000
002000*                                                                 00200000
002100* IF ITEMS ARE PART OF CARTON CONTENTS, THE UNITS IN CTN WILL     00210000
002200* DISPLAY A VALUE > ZERO AND THE ASSOCIATE WILL BE ABLE TO MAKE   00220000
002300* ADJUSTMENTS TO THE ITEMS/UNITS IN THE CARTON.                   00230000
002400******************************************************************00240000
002500 ENVIRONMENT DIVISION.                                            00250000
002600 DATA DIVISION.                                                   00260000
002700 WORKING-STORAGE SECTION.                                         00270000
002800*                                                                 00280000
002900 01  DK-DB2-KEYS.                                                 00290000
003000     05  DK-SHIPT-UNT-ID           PIC S9(18) COMP-3.             00300000
003100     05  DK-UPC-NBR                PIC S9(15)V COMP-3.            00310000
003200     05  DK-ITM-NBR                PIC S9(15)V COMP-3.            00320000
003300     05  DK-INTR-UPC               PIC S9(09) COMP.               00330000
003400     05  DK-ADJ-TO-QTY             PIC  S9(4) COMP.               00340000
003500     05  DK-SKU-NBR                PIC S9(08)V COMP-3 VALUE ZERO. 00350000
003600     05  DK-PACK-ID                PIC S9(04)  COMP SYNC.         00360000
003700     05  DK-SAVE-PACK-ID           PIC S9(04)  COMP SYNC.         00370000
003800     05  DK-OPER-UNT-ID            PIC S9(04) COMP.               00380000
003900     05  DK-PO-NBR                 PIC S9(09)  COMP.              00390000
004000     05  DK-RCVR-SEQ-NBR           PIC S9(09) COMP.               00400000
004100     05  DK-LNE-NBR                PIC S9(09) COMP SYNC.          00410000
004200     05  DK-BARCODE-NBR            PIC  X(22) VALUE SPACES.       00420000
004300                                                                  00430000
004400* PROGRAM CONSTANTS                                               00440000
004500 01  PC-PROGRAM-CONSTANTS.                                        00450000
004600     05  PC-TRANID                       PIC  X(04)  VALUE 'E863'.00460000
004700     05  PC-MAX-RETRIES                  PIC S9(04)  VALUE +3     00470000
004800                                                     COMP SYNC.   00480000
004900     05  PC-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     00490000
005000                                                     COMP SYNC.   00500000
005100     05  PC-RECEIVE-LENGTH               PIC S9(04)  VALUE +1     00510000
005200                                                     COMP SYNC.   00520000
005300     05  PC-0                            PIC  X(04)  VALUE '   0'.00530000
005400     05  PC-SPACE                        PIC  X(04)  VALUE '    '.00540000
005500     05  PC-4                            PIC  X(01)  VALUE '4'.   00550000
005600     05  PC-01                           PIC  X(02)  VALUE '01'.  00560000
005700     05  PC-18                           PIC S9(04)  VALUE 18     00570000
005800                                                     COMP SYNC.   00580000
005900     05  PC-20                           PIC S9(04)  VALUE 20     00590000
006000                                                     COMP SYNC.   00600000
006100     05  PC-49                           PIC  X(02)  VALUE '49'.  00610000
006200     05  PC-95                           PIC  X(02)  VALUE '95'.  00620000
006300     05  PC-A                            PIC  X(01)  VALUE 'A'.   00630000
006400     05  PC-U                            PIC  X(01)  VALUE 'U'.   00640000
006500     05  PC-MGMX                         PIC  X(04)  VALUE 'MGMX'.00650000
006600     05  PC-UG                           PIC  X(02)  VALUE 'UG'.  00660000
006700     05  PC-90                           PIC  X(02)  VALUE '90'.  00670000
006800                                                                  00680000
006900     05  PC-CURRENT-PROGRAM-NAME    PIC X(08) VALUE 'PCKRF863'.   00690000
007000     05  PC-MANIFEST-MENU-PGM       PIC X(08) VALUE 'PCKRF850'.   00700000
007100     05  PC-DC-RF-APPL-PGM          PIC X(08) VALUE 'MPKCS027'.   00710000
007200     05  PC-ADJUST-CRTN-UNTS-PGM    PIC X(08) VALUE 'PCKRF861'.   00720000
007300     05  PC-ALTER-REASON-PGM        PIC X(08) VALUE 'PCKRF862'.   00730000
007400     05  PC-ADJUSTED-QTY-PGM        PIC X(08) VALUE 'PCKRF863'.   00740000
007500     05  PC-SUKUT702                PIC X(08) VALUE 'SUKUT702'.   00750000
007600     05  PC-RCKCS806                PIC X(08) VALUE 'RCKCS806'.   00760000
007700     05  PC-RANDOM-NBR-GENERATOR    PIC X(08) VALUE 'DPKUT902'.   00770000
007800*                                                                 00780000
007900*                                                                 00790000
008000* SYSTEM/ERROR MESSAGES                                           00800000
008100     05  PC-UNRECOGNIZED-PF-KEY-MSG PIC X(19)                     00810000
008200                                    VALUE  'UNRECOGNIZED PF KEY'. 00820000
008300     05  PC-ENTER-THROUGH-MENU-MSG  PIC X(19)                     00830000
008400                                    VALUE  'ENTER THROUGH MENU '. 00840000
008500     05  PC-TRANS-UNAVAILABLE-MSG   PIC X(19)                     00850000
008600                                    VALUE  'TRANS NOT AVAILABLE'. 00860000
008700     05  PC-PLS-ENT-FLD-MSG         PIC X(19)                     00870000
008800                                    VALUE  'PLEASE ENTER FIELD '. 00880000
008900     05  PC-ENT-UPC-OR-SKU-MSG      PIC X(19)                     00890000
009000                                    VALUE  'ENTER UPC OR SKU   '. 00900000
009100     05  PC-MUST-BE-NUM-MSG         PIC X(19) VALUE               00910000
009200                                           'MUST BE NUMERIC    '. 00920000
009300     05  PC-ADJ-MUST-BE-LT-50       PIC X(19) VALUE               00930000
009400                                           'ADJ MUST BE<50:REDO'. 00940000
009500     05  PC-UPC-MUST-BE-GT-0        PIC X(19) VALUE               00950000
009600                                           'UPC MUST BE GT 0   '. 00960000
009700     05  PC-SKU-MUST-BE-GT-0        PIC X(19) VALUE               00970000
009800                                           'SKU MUST BE GT 0   '. 00980000
009900     05  PC-NOT-A-KOHLS-UPC         PIC X(19) VALUE               00990000
010000                                           'NOT A KOHLS UPC    '. 01000000
010100     05  PC-NOT-A-KOHLS-SKU         PIC X(19) VALUE               01010000
010200                                           'NOT A KOHLS SKU    '. 01020000
010300     05  PC-UPC-NOT-IN-CTN-MSG      PIC X(19) VALUE               01030000
010400                                           'UPC NOT IN CTN/SKU '. 01040000
010500     05  PC-SKU-NOT-IN-CTN-MSG      PIC X(19) VALUE               01050000
010600                                           'SKU NOT IN CARTON  '. 01060000
010700     05  PC-UPD-SUCCESSFUL-MSG      PIC X(19) VALUE               01070000
010800                                           'UPDATE SUCCESSFUL  '. 01080000
010900     05  PC-ADJ-EXCEEDS-CTN-TOT-MSG PIC X(19) VALUE               01090000
011000                                           'ADJ EXCEEDS CTN TOT'. 01100000
011100     05  PC-UNSUCCESS-CALL-AUTOVE   PIC X(19) VALUE               01110000
011200                                           'INVALID CALL AUTOVE'. 01120000
011300     05  PC-UNT-CNT-BE-ADD-DMG      PIC X(19) VALUE               01130000
011400                                           'CANNOT ADD TO DMG  '. 01140000
011500     05  PC-UNT-CNT-BE-ADD-PHYSL    PIC X(19) VALUE               01150000
011600                                          'CAN''T ADD: PHYS LBL'. 01160000
011700     05  PC-ITM-NOT-ON-PO-RCVR      PIC X(19) VALUE               01170000
011800                                           'ITM NOT ON PO/RCVR '. 01180000
011900     05  PC-ITM-NOT-ON-RCVR         PIC X(19) VALUE               01190000
012000                                           'ITEM NOT ON RECEIVR'. 01200000
012100     05  PC-ITM-NOT-ON-PO           PIC X(19) VALUE               01210000
012200                                           'ITEM NOT ON PO     '. 01220000
012300     05  PC-ADD-SUCCESSFUL-MSG      PIC X(19) VALUE               01230000
012400                                           'NEW ITEM ADDED     '. 01240000
012500     05  PC-DMG-EXCED-UPC-QTY-MSG   PIC X(19) VALUE               01250000
012600                                           'DMG EXCEEDS UPC QTY'. 01260000
012700     05  PC-FAILED-ST-UNT-ADJ-MSG   PIC X(19) VALUE               01270000
012800                                           'SEE FAIL ST ADJ RCD'. 01280000
012810     05  PC-NOT-A-DC-LOCATION-MSG   PIC X(19) VALUE               01281010
012820                                           'NOT A DC LOCATION  '. 01282001
012900*                                                                 01290000
013000* PROGRAM SWITCHES                                                01300000
013100 01  PS-PROGRAM-SWITCHES.                                         01310000
013200     05  PS-ODD-UNITS-ADDED-SW           PIC  X(01) VALUE 'N'.    01320000
013300         88  PS-ODD-UNITS-ADDED                     VALUE 'Y'.    01330000
013400         88  PS-NO-ODD-UNITS-ADDED                  VALUE 'N'.    01340000
013500     05  PS-NO-ODD-UNITS-LEFT-SW         PIC  X(01) VALUE 'N'.    01350000
013600         88  PS-ODD-UNITS-LEFT                      VALUE 'Y'.    01360000
013700         88  PS-NO-ODD-UNITS-LEFT                   VALUE 'N'.    01370000
013800     05  PS-ODD-UNIT-ON-OTHER-LINES-SW   PIC  X(01) VALUE 'N'.    01380000
013900         88  PS-ODD-UNIT-ON-OTHER-LINES             VALUE 'Y'.    01390000
014000         88  PS-NO-ODD-UNIT-ON-OTHER-LINES          VALUE 'N'.    01400000
014100     05  PS-BACKOUT-NEEDED-SW            PIC  X(01) VALUE 'N'.    01410000
014200         88  PS-BACKOUT-NEEDED                      VALUE 'Y'.    01420000
014300         88  PS-NO-BACKOUT-NEEDED                   VALUE 'N'.    01430000
014400     05  PS-END-OF-CURSOR-SW             PIC  X(01) VALUE 'N'.    01440000
014500         88  PS-END-OF-CURSOR                       VALUE 'Y'.    01450000
014600         88  PS-NOT-END-OF-CURSOR                   VALUE 'N'.    01460000
014700     05  PS-END-OF-PAC-CURSOR-SW         PIC  X(01) VALUE 'N'.    01470000
014800         88  PS-END-OF-PAC-CURSOR                   VALUE 'Y'.    01480000
014900         88  PS-NOT-END-OF-PAC-CURSOR               VALUE 'N'.    01490000
015000     05  PS-PACK-RECS-PROCESSED-SW      PIC  X(01)  VALUE 'N'.    01500000
015100         88  PS-PACK-RECS-PROCESSED                 VALUE 'Y'.    01510000
015200         88  PS-NO-PACK-RECS-PROCESSED              VALUE 'N'.    01520000
015300     05  PS-CARTON-ITEM-CURSOR-IND       PIC  X(01) VALUE 'N'.    01530000
015400         88  PS-NOT-END-OF-CARTON-ITEM-CSR          VALUE 'N'.    01540000
015500         88  PS-END-OF-CARTON-ITEM-CSR              VALUE 'Y'.    01550000
015600     05  PS-OVER-SHORT-IND               PIC  X(01) VALUE 'N'.    01560000
015700         88  PS-OVER-SHORT-ERROR                    VALUE 'Y'.    01570000
015800         88  PS-NO-OVER-SHORT-ERROR                 VALUE 'N'.    01580000
015900     05  PS-NO-PACK-MATCH-FOUND-SW      PIC  X(01)  VALUE 'N'.    01590000
016000         88  PS-NO-PACK-MATCH-FOUND                 VALUE 'N'.    01600000
016100         88  PS-PACK-MATCH-FOUND                    VALUE 'Y'.    01610000
016200     05  PS-VALID-INPUT-SW               PIC  X(01)  VALUE 'Y'.   01620000
016300         88  PS-VALID-INPUT                          VALUE 'Y'.   01630000
016400         88  PS-INVALID-INPUT                        VALUE 'N'.   01640000
016500     05  PS-REMAINDER-SW                 PIC  X(01)  VALUE 'Y'.   01650000
016600         88  PS-REMAINDER                            VALUE 'Y'.   01660000
016700         88  PS-NO-REMAINDER                         VALUE 'N'.   01670000
016800     05  PS-UPC-FOUND-IN-CTN-SW          PIC  X(01)  VALUE 'Y'.   01680000
016900         88  PS-UPC-FOUND-IN-CTN                     VALUE 'Y'.   01690000
017000         88  PS-UPC-NOT-FOUND-IN-CTN                 VALUE 'N'.   01700000
017100     05  PS-SKU-FOUND-IN-CTN-SW          PIC  X(01)  VALUE 'Y'.   01710000
017200         88  PS-SKU-FOUND-IN-CTN                     VALUE 'Y'.   01720000
017300         88  PS-SKU-NOT-FOUND-IN-CTN                 VALUE 'N'.   01730000
017400     05  PS-ITM-FOUND-ON-PORCVR-SW       PIC  X(01)  VALUE 'N'.   01740000
017500         88  PS-ITM-FOUND-ON-PORCVR                  VALUE 'Y'.   01750000
017600         88  PS-ITM-NOT-ON-PORCVR                    VALUE 'N'.   01760000
017700     05  PS-ITM-FOUND-ON-PO-SW           PIC  X(01)  VALUE 'N'.   01770000
017800         88  PS-ITM-FOUND-ON-PO                      VALUE 'Y'.   01780000
017900         88  PS-ITM-NOT-ON-PO                        VALUE 'N'.   01790000
018000     05  PS-TSUQADJ-INSERTED-SW          PIC  X(01).              01800000
018100         88  PS-TSUQADJ-INSERTED                     VALUE  'Y'.  01810000
018200         88  PS-TSUQADJ-NOT-INSERTED                 VALUE  'N'.  01820000
018300     05  PS-CART-UPC-UPDATED-SW          PIC  X(01).              01830000
018400         88  PS-CART-UPC-UPDATED                     VALUE  'Y'.  01840000
018500         88  PS-CART-UPC-NOT-UPDATED                 VALUE  'N'.  01850000
018600     05  PS-DAMAGED-SW                PIC  X(01)  VALUE SPACE.    01860000
018700         88  PS-DAMAGED-NO                        VALUE 'N'.      01870000
018800         88  PS-DAMAGED-YES                       VALUE 'Y'.      01880000
018900     05  PS-DO-UNIT-ADJ-SW            PIC X(01)   VALUE SPACE.    01890000
019000         88  PS-DO-UNIT-ADJ-YES                   VALUE 'Y'.      01900000
019100         88  PS-DO-UNIT-ADJ-NO                    VALUE 'N'.      01910000
019200     05  PS-PO-VERIFIED-SW            PIC X(01)   VALUE SPACE.    01920000
019300         88  PS-PO-VERIFIED-YES                   VALUE 'Y'.      01930000
019400         88  PS-PO-VERIFIED-NO                    VALUE 'N'.      01940000
019500     05  PS-PO-PREPK-SW               PIC X(01)   VALUE SPACE.    01950000
019600         88  PS-PO-PREPK-YES                      VALUE 'Y'.      01960000
019700         88  PS-PO-PREPK-NO                       VALUE 'N'.      01970000
019800     05  PS-PO-AUTOVE-SW              PIC X(01)   VALUE SPACE.    01980000
019900         88  PS-PO-AUTOVE-YES                     VALUE 'Y'.      01990000
020000         88  PS-PO-AUTOVE-NO                      VALUE 'N'.      02000000
020100     05  PS-NO-UPC-MATCH-FOUND-SW     PIC  X(01)  VALUE 'N'.      02010000
020200         88  PS-NO-UPC-MATCH-FOUND                VALUE 'N'.      02020000
020300         88  PS-UPC-MATCH-FOUND                   VALUE 'Y'.      02030000
020400     05  PS-ODD-UNITS-ADJUSTMENT-SW    PIC  X(01)  VALUE 'N'.     02040000
020500         88  PS-ODD-UNITS-ADJUSTMENT               VALUE 'Y'.     02050000
020600         88  PS-NO-ODD-UNITS-ADJUSTMENT            VALUE 'N'.     02060000
020700     05  PS-ODD-UNITS-LINE-ADJ-SW      PIC  X(01)  VALUE 'N'.     02070000
020800         88  PS-ODD-UNITS-LINE-ADJ                 VALUE 'Y'.     02080000
020900         88  PS-NO-ODD-UNITS-LINE-ADJ              VALUE 'N'.     02090000
021000     05  PS-PACK-ADJUSTMENT-SW         PIC  X(01)  VALUE 'N'.     02100000
021100         88  PS-PACK-ADJUSTMENT                    VALUE 'Y'.     02110000
021200         88  PS-NO-PACK-ADJUSTMENT                 VALUE 'N'.     02120000
021300     05  PS-PREPACK-DRIVER-SW          PIC  X(01)  VALUE 'N'.     02130000
021400         88  PS-PREPACK-DRIVER                     VALUE 'Y'.     02140000
021500         88  PS-NOT-PREPACK-DRIVER                 VALUE 'N'.     02150000
021600     05  PS-ITM-FOUND-SW                PIC  X(01)   VALUE 'N'.   02160000
021700         88  PS-ITM-FOUND                            VALUE 'Y'.   02170000
021800         88  PS-ITM-NOT-FOUND                        VALUE 'N'.   02180000
021900     05  PS-OTBND-PK-FOUND-SW           PIC  X(01)  VALUE 'Y'.    02190000
022000         88  PS-NO-OTBND-PK-FOUND                   VALUE 'N'.    02200000
022100         88  PS-OTBND-PK-FOUND                      VALUE 'Y'.    02210000
022200*                                                                 02220000
022300*                                                                 02230000
022400 01  PV-PROGRAM-VARIABLES.                                        02240000
022500     05  PV-COMMAREA-LENGTH           PIC S9(04)  VALUE +0        02250000
022600                                                     COMP SYNC.   02260000
022700     05  PV-CICS-MSG-AREA.                                        02270000
022800         10  PV-CICS-MSG-AREA1           PIC  X(99)  VALUE SPACE. 02280000
022900     05  PV-MESSAGE-AREA                 PIC  X(19)  VALUE SPACE. 02290000
023000     05  PV-RECEIVE-DATA                 PIC  X(01)  VALUE SPACE. 02300000
023100     05  PV-CICS-RESPONSE                PIC S9(09)  VALUE ZEROS  02310000
023200                                                     COMP SYNC.   02320000
023300     05  PV-TRANSFER-PROGRAM             PIC  X(08)  VALUE SPACE. 02330000
023400     05  PV-LEADING-0-COUNT              PIC S9(04)  VALUE ZERO   02340000
023500                                                     COMP.        02350000
023600     05  PV-UPC-LENGTH                   PIC S9(04)  VALUE ZERO   02360000
023700                                                     COMP.        02370000
023800     05  PV-RECORD-COUNT                 PIC S9(09)  VALUE ZEROS  02380000
023900                                                     COMP SYNC.   02390000
024000     05  PV-COUNT-IND                    PIC S9(04)  VALUE ZEROS  02400000
024100                                                     COMP SYNC.   02410000
024200     05  PV-NULL-IND                     PIC S9(04)  VALUE ZEROS  02420000
024300                                                     COMP SYNC.   02430000
024400     05  PV-NULL-IND-2                   PIC S9(04)  VALUE ZEROS  02440000
024500                                                     COMP SYNC.   02450000
024600     05  PV-NULL-IND-3                   PIC S9(04)  VALUE ZEROS  02460000
024700                                                     COMP SYNC.   02470000
024800     05  PV-SELECT-COUNTER               PIC S9(04)  VALUE ZEROS  02480000
024900                                                     COMP SYNC.   02490000
025000     05  PV-MULTI-LINE-COUNT             PIC S9(04)  VALUE ZEROS  02500000
025100                                                     COMP SYNC.   02510000
025200     05  PV-WRITE-LENGTH                 PIC  9(04)  VALUE  80    02520000
025300                                                     COMP SYNC.   02530000
025400     05  PV-UNTS-IN-SKU                  PIC S9(09)  VALUE +0     02540000
025500                                                     COMP-3.      02550000
025600     05  PV-UNTS-IN-UPC                  PIC S9(09)  VALUE +0     02560000
025700                                                     COMP-3.      02570000
025800     05  PV-TOT-UNTS-IN-CTN              PIC S9(09)  VALUE +0     02580000
025900                                                     COMP-3.      02590000
026000     05  PV-SHIPT-UNT-ID                 PIC  S9(18) COMP-3.      02600000
026100     05  PV-REMAINDER                    PIC S9(04)  VALUE ZEROS  02610000
026200                                                     COMP SYNC.   02620000
026300     05  PV-ADJ-QTY                      PIC S9(4) COMP           02630000
026400                                              VALUE ZERO.         02640000
026500     05  PV-NEG-QTY                      PIC S9(4) COMP           02650000
026600                                              VALUE ZERO.         02660000
026700     05  PV-CURRENT-TMST                 PIC X(026).              02670000
026800*REDEFINE-NEED TO USE TEXT FIELD IN NUMERIC EDIT ROUTINE          02680000
026900     05  PV-UPC-NBR                      PIC  X(15).              02690000
027000     05  PV-UPC-NBR-R REDEFINES                                   02700000
027100                                PV-UPC-NBR.                       02710000
027200         10  PV-UPC-NBR-N                PIC  9(15).              02720000
027300                                                                  02730000
027400     05  PV-ADJ-BY-QTY                   PIC S9(04)  VALUE ZEROS  02740000
027500                                                     COMP SYNC.   02750000
027600     05  PV-ADJ-TO-QTY                   PIC S9(04)  VALUE ZEROS  02760000
027700                                                     COMP SYNC.   02770000
027800*REDEFINE-NEED TO USE TEXT FIELD IN NUMERIC EDIT ROUTINE          02780000
027900     05  PV-ADJ-ENTERED-QTY              PIC  X(04) VALUE SPACE.  02790000
028000     05  PV-ADJ-ENTERED-QTY-R REDEFINES                           02800000
028100                                PV-ADJ-ENTERED-QTY.               02810000
028200         10  PV-ADJ-ENTERED-QUANTITY     PIC  ZZZ9.               02820000
028300                                                                  02830000
028400     05  PV-ADJ-ENTERED-QTY-N            PIC  9(04).              02840000
028500*                                                                 02850000
028600     05  PV-SKU-NBR.                                              02860000
028700         10  PV-SKU-NBR-N              PIC  9(08) VALUE ZEROES.   02870000
028800     05  PV-SKU-DESC                   PIC  X(15) VALUE SPACES.   02880000
028900     05  PV-PRC-RSN-CDE                PIC  X(08).                02890000
029000     05  PV-USER-ID                    PIC  X(08).                02900000
029100     05  PV-OPER-UNT-ID                PIC  S9(04) COMP.          02910000
029200     05  PV-ADJ-FUNC-CDE               PIC  X(01).                02920000
029300     05  PV-ADJ-BEF-QTY                PIC  S9(04) COMP.          02930000
029400     05  PV-SHPD-UNT-QTY               PIC  S9(9)V COMP-3.        02940000
029500     05  PV-ADJ-AMT                    PIC S9(4) COMP VALUE ZERO. 02950000
029600     05  PV-PO-NBR-CRTN                PIC S9(09) COMP VALUE ZERO.02960000
029700     05  PV-PO-NBR-UPC                 PIC S9(09) COMP VALUE ZERO.02970000
029800                                                                  02980000
029900     05  PV-FINCL-ADJ-ID                PIC S9(9)   COMP.         02990000
030000     05  PV-SAVE-FINCL-ADJ-ID           PIC S9(9)   COMP.         03000000
030100     05  PV-SAVE-PO-LINE-NBR            PIC S9(9)   COMP.         03010000
030200     05  PV-SAVE-UPC-NBR                PIC S9(15)  COMP-3.       03020000
030300     05  PV-SAVE-LAST-IDX               PIC S9(4) COMP VALUE 0.   03030000
030400     05  PV-SAVE-LINE-IDX               PIC S9(4) COMP VALUE 0.   03040000
030500     05  PV-CARTON-ITEM-COUNT           PIC S9(09)  VALUE ZERO    03050000
030600                                                     COMP SYNC.   03060000
030700     05  PV-CARTON-REC-TYPE             PIC  X(01)  VALUE SPACE.  03070000
030800     05  PV-CARTON-INTR-UPC             PIC  S9(9)   COMP.        03080000
030900     05  PV-CARTON-HOLD-UPC-NBR         PIC  S9(15)V COMP-3.      03090000
031000     05  PV-CARTON-LINE-NBR             PIC  S9(9)   COMP.        03100000
031100     05  PV-SAVE-PREPK-ID               PIC  S9(4) COMP VALUE 0.  03110000
031200     05  PV-NUMBER-OF-LINES             PIC  S9(5) COMP-3.        03120000
031300     05  PV-SAVE-NBR-OF-PACKS           PIC  S9(5) COMP-3.        03130000
031400     05  PV-BEFORE-QTY                  PIC  S9(9) COMP.          03140000
031500     05  PV-AFTER-QTY                   PIC  S9(9) COMP.          03150000
031600     05  PV-BEFORE-UPC-QTY              PIC  S9(9) COMP.          03160000
031700     05  PV-ADJUST-QTY                  PIC  S9(9) COMP.          03170000
031800     05  PV-PACK-DIFF                   PIC  S9(9) COMP VALUE 0.  03180000
031900     05  PV-ODD-DIFF                    PIC  S9(9) COMP VALUE 0.  03190000
032000     05  PV-ADJ-MINUS-ODD               PIC  S9(9) COMP VALUE 0.  03200000
032100     05  PV-SAVE-ORD-LNE-NBR            PIC S9(09) COMP.          03210000
032200     05  PV-AUDIT-SHPD-QTY              PIC  S9(9)V COMP-3.       03220000
032300     05  PV-CARTON-UPC-NBR              PIC  S9(15)V COMP-3.      03230000
032400     05  PV-CARTON-SHPD-QTY             PIC  S9(9)V COMP-3.       03240000
032500     05  PV-PACK-ID                     PIC S9(04)  COMP SYNC.    03250000
032600     05  PV-BEFORE-ODD-UNT-QTY          PIC  S9(9) COMP VALUE 0.  03260000
032700     05  PV-AFTER-ODD-UNT-QTY           PIC  S9(9) COMP VALUE 0.  03270000
032800     05  PV-LBL-MANIFEST-NBR            PIC  9(09) VALUE ZEROES.  03280000
032900     05  PV-ODD-UNT-IND                 PIC  X(01) VALUE SPACES.  03290000
033000     05  PV-LBL-MANI-NBR                PIC  9(09) VALUE ZEROES   03300000
033100                                                     COMP.        03310000
033200     05  PV-OPER-UNT-ID-DISP-X.                                   03320005
033201         10  PV-OPER-UNT-ID-DISP        PIC  9(04)  VALUE ZEROES. 03320105
033210     05  PV-BAR-CODE                     PIC  X(22) VALUE ZEROES. 03321005
033300     05  PV-BAR-CODE-N  REDEFINES  PV-BAR-CODE.                   03330000
033400         10 FILLER                       PIC  9(02).              03340000
033500         10 PV-BAR-CODE-OTBND            PIC  9(18).              03350000
033600         10 FILLER                       PIC  9(02).              03360000
033700     05  PV-BAR-CODE-R  REDEFINES  PV-BAR-CODE.                   03370000
033800         10 PV-BAR-CODE-DIVERT-PFX       PIC  9(01).              03380000
033900         10 PV-BAR-CODE-STORE-NBR        PIC  9(04).              03390000
034000         10 PV-BAR-CODE-OPER-UNIT        PIC  9(04).              03400000
034100         10 PV-BAR-CODE-POS-10-15        PIC  9(06).              03410000
034200         10 PV-BAR-CODE-LBL-MANIFEST     PIC  9(07).              03420000
034300                                                                  03430000
034400 01  PV-LOG-MSG1.                                                 03440000
034500     05  FILLER                       PIC X(12) VALUE             03450000
034600         ' E863 ERROR '.                                          03460000
034700     05  FILLER                       PIC X(09) VALUE             03470000
034800         'SQLCODE= '.                                             03480000
034900     05  PV-SQLCODE                   PIC -9(03).                 03490000
035000     05  FILLER                       PIC X(06) VALUE             03500000
035100         ' ERR= '.                                                03510000
035200     05  PV-ERROR-NBR                 PIC 9(03) VALUE ZERO.       03520000
035300     05  FILLER                       PIC X(07) VALUE             03530000
035400         ' SML= '.                                                03540000
035500     05  PV-DISPLAY-SML               PIC 9(18) VALUE ZEROES.     03550000
035600 01  PV-LOG-MSG2.                                                 03560000
035700     05  FILLER                       PIC X(06) VALUE             03570000
035800         ' OPER '.                                                03580000
035900     05  PV-ERROR-OPER                PIC  9(04)  VALUE ZEROS.    03590000
036000     05  FILLER                       PIC X(04) VALUE             03600000
036100         ' PO '.                                                  03610000
036200     05  PV-ERROR-ORD-NBR             PIC  9(08)  VALUE ZEROS.    03620000
036300     05  FILLER                       PIC X(06) VALUE             03630000
036400         ' RECV '.                                                03640000
036500     05  PV-ERROR-RCVR-SEQ-NBR        PIC  9(04)  VALUE ZEROS.    03650000
036600     05  FILLER                       PIC X(06) VALUE             03660000
036700         ' LINE '.                                                03670000
036800     05  PV-ERROR-ORD-LNE-NBR         PIC  9(04)  VALUE ZEROS.    03680000
036900     05  FILLER                       PIC X(05) VALUE             03690000
037000         ' UPC '.                                                 03700000
037100     05  PV-ERROR-UPC                 PIC  9(15)  VALUE ZEROS.    03710000
037200 01  PV-LOG-MSG3.                                                 03720000
037300     05  FILLER                       PIC X(06) VALUE             03730000
037400         ' STOR '.                                                03740000
037500     05  PV-ERROR-STR-NBR             PIC  9(04)  VALUE ZEROS.    03750000
037600     05  FILLER                       PIC X(06) VALUE             03760000
037700         ' QTY  '.                                                03770000
037800     05  PV-ERROR-QTY                 PIC  Z(09)  VALUE ZEROS.    03780000
037900     05  FILLER                       PIC X(06) VALUE             03790000
038000         ' BEFR '.                                                03800000
038100     05  PV-ERROR-BEFORE              PIC  Z(09)- VALUE ZEROS.    03810000
038200     05  FILLER                       PIC X(06) VALUE             03820000
038300         ' AFTR '.                                                03830000
038400     05  PV-ERROR-AFTER               PIC  Z(09)- VALUE ZEROS.    03840000
038500     05  FILLER                       PIC X(06) VALUE             03850000
038600         ' ADJT '.                                                03860000
038700     05  PV-ERROR-ADJUST              PIC  Z(09)- VALUE ZEROS.    03870000
038800                                                                  03880000
038900 01  TB-PACK-TABLE.                                               03890000
039000     05  TB-PACK-ITEM OCCURS 500 TIMES INDEXED BY LINE-IDX.       03900000
039100         10  PACK-IND               PIC  X(01)       VALUE SPACE. 03910000
039200         10  PACK-PRPPK-ID          PIC S9(4) COMP    VALUE ZERO. 03920000
039300         10  PACK-PREPK-DRV-LNE-CDE PIC  X(01)       VALUE SPACE. 03930000
039400         10  PACK-LINE              PIC S9(9) COMP    VALUE ZERO. 03940000
039500         10  PACK-ITM               PIC S9(15) COMP-3 VALUE ZERO. 03950000
039600         10  PACK-RATO              PIC S9(4) COMP    VALUE ZERO. 03960000
039700         10  PACK-AUDIT-QTY         PIC S9(09) COMP-3 VALUE ZERO. 03970000
039800         10  PACK-CRTN-QTY          PIC S9(09) COMP-3 VALUE ZERO. 03980000
039900         10  PACK-CRTN-REC-TYPE     PIC  X(01)       VALUE SPACE. 03990000
040000         10  PACK-CRTN-INTR-UPC     PIC S9(9)  COMP   VALUE ZERO. 04000000
040100         10  PACK-CRTN-HOLD-UPC     PIC S9(15)V COMP-3 VALUE ZERO.04010000
040200         10  PACK-AUD-REC-TYPE      PIC  X(02)      VALUE SPACES. 04020000
040300         10  PACK-AUD-INTR-UPC      PIC S9(9)  COMP   VALUE ZERO. 04030000
040400         10  PACK-AUD-HOLD-UPC      PIC S9(15)V COMP-3 VALUE ZERO.04040000
040500         10  PACK-BEST-CASE-UNITS   PIC S9(07) COMP-3 VALUE ZERO. 04050000
040600         10  PACK-ODD-UNITS         PIC S9(05) COMP-3 VALUE ZERO. 04060000
040700*                                                                 04070000
040800* COMMAREA LAYOUT FOR PCRF85X SCREENS                             04080000
040900 01  CA-COMMAREA.                                                 04090000
041000     COPY PCWS033.                                                04100000
041100                                                                  04110000
041200* MAP LAYOUT                                                      04120000
041300     COPY PCKM863.                                                04130000
041400                                                                  04140000
041500*    RANDOM NUMBER GENERATOR                                      04150000
041600     COPY DPWS902.                                                04160000
041700                                                                  04170000
041800* HELP SCREEN COMMAREA                                            04180000
041900     COPY PCWS192.                                                04190000
042000                                                                  04200000
042100* HELP SCREEN WORK AREA                                           04210000
042200     COPY PCWS188.                                                04220000
042300                                                                  04230000
042400*    UNIT ADJUSTMENT MODULE SUKUT702                              04240000
042500     COPY SUWS035.                                                04250000
042600                                                                  04260000
042700*    AUTO VE MODULE RCKUT127                                      04270000
042800     COPY RCWS040.                                                04280000
042900                                                                  04290000
043000* DOMAIN ITEM MODULE                                              04300000
043100     COPY XLWS001.                                                04310000
043200                                                                  04320000
043300* COPYBOOK FOR PCKCS721                                           04330000
043400     COPY PCWS187.                                                04340000
043500                                                                  04350000
043600* COPYBOOK USED TO FORMAT BARCODES                                04360000
043700     COPY PCWS160.                                                04370000
043800                                                                  04380000
043900* SENDING/RECEIVING AREA FOR THE NUMERIC EDIT ROUTINE (DPKUT100)  04390000
044000     COPY DPWS010I.                                               04400000
044100                                                                  04410000
044200* LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.                04420000
044300     COPY DPWS013.                                                04430000
044400                                                                  04440000
044500* KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST    04450000
044600     COPY DPWS015.                                                04460000
044700                                                                  04470000
044800* KOHL'S STANDARD ATTENTION IDENTIFIER LIST                       04480000
044900     COPY DFHAID.                                                 04490000
045000                                                                  04500000
045100******************************************************************04510000
045200*    PREPACK VERIFICATION                                         04520000
045300******************************************************************04530000
045400     COPY RCWS806.                                                04540000
045500                                                                  04550000
045600* DB2 AREA FOR THE SHIPMENT UNIT QUANTITY ADJUSTMENT TABLE        04560000
045700     EXEC SQL                                                     04570000
045800          INCLUDE TSUQADJ                                         04580000
045900     END-EXEC.                                                    04590000
046000                                                                  04600000
046100* DB2 AREA FOR THE SHIPMENT UNIT TABLE - SUT_OTBND_CART           04610000
046200     EXEC SQL                                                     04620000
046300          INCLUDE SUT00024                                        04630000
046400     END-EXEC.                                                    04640000
046500                                                                  04650000
046600* SUT_OTBND_PKD_UPC                                               04660000
046700     EXEC SQL                                                     04670000
046800          INCLUDE SUT00025                                        04680000
046900     END-EXEC.                                                    04690000
047000                                                                  04700000
047100* SUT_OTBND_VND                                                   04710000
047200     EXEC SQL                                                     04720000
047300          INCLUDE SUT00026                                        04730000
047400     END-EXEC.                                                    04740000
047500                                                                  04750000
047600* DB2 AREA FOR THE SHIPMENT UNIT-UPC TABLE - SUT_OTBND_UPC        04760000
047700     EXEC SQL                                                     04770000
047800          INCLUDE SUT00028                                        04780000
047900     END-EXEC.                                                    04790000
047910                                                                  04791000
047920* SUT_FINCL_ADJ                                                   04792000
047930     EXEC SQL                                                     04793000
047940          INCLUDE SUT00030                                        04794000
047950     END-EXEC.                                                    04795000
048000                                                                  04800000
048100* DB2 AREA FOR THE SHIPMENT UNIT- PACK TABLE - SUT_OTBND_PK       04810000
048200     EXEC SQL                                                     04820000
048300          INCLUDE SUT00041                                        04830000
048400     END-EXEC.                                                    04840000
048500                                                                  04850000
048600* XLT_SKU                                                         04860000
048700     EXEC SQL                                                     04870000
048800          INCLUDE XLT00003                                        04880000
048900     END-EXEC.                                                    04890000
049000                                                                  04900000
049100* XLV_UPC                                                         04910000
049200     EXEC SQL                                                     04920000
049300          INCLUDE XLV00003                                        04930000
049400     END-EXEC.                                                    04940000
049500                                                                  04950000
049600* XLT_UPC                                                         04960000
049700     EXEC SQL                                                     04970000
049800          INCLUDE XLT00006                                        04980000
049900     END-EXEC.                                                    04990000
050000                                                                  05000000
050010* XLT_LOC                                                         05001001
050020     EXEC SQL                                                     05002001
050030          INCLUDE XLT00010                                        05003001
050040     END-EXEC.                                                    05004001
050050                                                                  05005001
050100* PARM TABLE                                                      05010000
050200     EXEC SQL                                                     05020000
050300          INCLUDE TKRPRPM                                         05030000
050400     END-EXEC.                                                    05040000
050500                                                                  05050000
050600* RECEIVING TABLE                                                 05060000
050700     EXEC SQL                                                     05070000
050800          INCLUDE TRECEIV                                         05080000
050900     END-EXEC.                                                    05090000
051000                                                                  05100000
051100* RECEIVING ITEM TABLE                                            05110000
051200     EXEC SQL                                                     05120000
051300          INCLUDE TRECITM                                         05130000
051400     END-EXEC.                                                    05140000
051500                                                                  05150000
051600* PACK SLIP TABLE                                                 05160000
051700     EXEC SQL                                                     05170000
051800          INCLUDE TPKSLIP                                         05180000
051900     END-EXEC.                                                    05190000
052000                                                                  05200000
052100* PO PREPACK TABLE                                                05210000
052200     EXEC SQL                                                     05220000
052300          INCLUDE TPOPRPK                                         05230000
052400     END-EXEC.                                                    05240000
052500                                                                  05250000
052600* COMMUNICATIONS AREA FOR DB2                                     05260000
052700     EXEC SQL                                                     05270000
052800         INCLUDE SQLCA                                            05280000
052900     END-EXEC.                                                    05290000
053000*                                                                 05300000
053100*---------------------------------------------------------------* 05310000
053200* CURSOR TO GET NEXT UPC NBR IN SKU...                            05320000
053300* WHEN SKU NUMBER IS ENTERED ON SCREEN, A ROW IS INSERTED INTO    05330000
053400* THE TSUQADJ TABLE.  SINCE WE NEED TO INSERT THE UPC NUMBER IN   05340000
053500* THIS TABLE, WE NEED TO USE THE CURSOR BELOW TO GET THE NEXT UPC 05350000
053600* NUMBER FOR THE SKU THAT WAS ENTERED.                            05360000
053700*---------------------------------------------------------------* 05370000
053800     EXEC SQL                                                     05380000
053900        DECLARE NEXT-UPC-CSR CURSOR FOR                           05390000
054000        SELECT  C.UPC_NBR                                         05400000
054100              , C.TRN_NBR                                         05410000
054200              , C.RCVR_SEQ_NBR                                    05420000
054300              , C.TRN_LNE_NBR                                     05430000
054400              , XUPC.INTR_UPC_ID                                  05440000
054500           FROM    XLT_SKU XSKU                                   05450000
054600                 , XLV_UPC XUPC                                   05460000
054700                 , SUT_OTBND_UPC C                                05470000
054800           WHERE XSKU.INTR_UPC_ID    = XUPC.INTR_UPC_ID           05480000
054900             AND XUPC.UPC_NBR        = C.UPC_NBR                  05490000
055000             AND XSKU.SKU_NBR        = :DK-SKU-NBR                05500000
055100             AND C.SHIPT_UNT_ID      = :DK-SHIPT-UNT-ID           05510000
055200             AND C.UPC_NBR      NOT IN (:DK-UPC-NBR)              05520000
055300     END-EXEC                                                     05530000
055400*                                                                 05540000
055500*---------------------------------------------------------------* 05550000
055600* GET UPC FOR SKU NUMBER THAT WAS ENTERED.                        05560000
055700*---------------------------------------------------------------* 05570000
055800     EXEC SQL                                                     05580000
055900        DECLARE UPC-CSR CURSOR FOR                                05590000
056000        SELECT  C.UPC_NBR                                         05600000
056100              , C.TRN_NBR                                         05610000
056200              , C.RCVR_SEQ_NBR                                    05620000
056300              , C.TRN_LNE_NBR                                     05630000
056400              , XUPC.INTR_UPC_ID                                  05640000
056500           FROM    XLT_SKU XSKU                                   05650000
056600                 , XLV_UPC XUPC                                   05660000
056700                 , SUT_OTBND_UPC C                                05670000
056800           WHERE XSKU.INTR_UPC_ID    = XUPC.INTR_UPC_ID           05680000
056900             AND XUPC.UPC_NBR        = C.UPC_NBR                  05690000
057000             AND XSKU.SKU_NBR        = :DK-SKU-NBR                05700000
057100             AND C.SHIPT_UNT_ID      = :DK-SHIPT-UNT-ID           05710000
057200     END-EXEC.                                                    05720000
057300*                                                                 05730000
057400     EXEC SQL                                                     05740000
057500         DECLARE CARTON_LINE_CURSOR CURSOR                        05750000
057600             FOR SELECT                                           05760000
057700                 'A'                                              05770000
057800               , C.INTR_UPC_ID                                    05780000
057900               , B.TRN_LNE_NBR                                    05790000
058000               , 0                                                05800000
058100               , SUM(B.SHPD_UNT_QTY)                              05810000
058200             FROM SUT_OTBND_CART A                                05820000
058300                , SUT_OTBND_UPC B                                 05830000
058400                , XLT_UPC C                                       05840000
058500             WHERE A.SHIPT_UNT_ID = :DK-SHIPT-UNT-ID              05850000
058600               AND A.ACTV_IND     = 'Y'                           05860000
058700               AND A.SHIPT_UNT_ID = B.SHIPT_UNT_ID                05870000
058800               AND B.UPC_NBR = C.UPC_NBR                          05880000
058900             GROUP BY C.INTR_UPC_ID                               05890000
059000               ,   B.TRN_LNE_NBR                                  05900000
059100         UNION                                                    05910000
059200             SELECT                                               05920000
059300                 'B'                                              05930000
059400               , 0                                                05940000
059500               , B.TRN_LNE_NBR                                    05950000
059600               , B.UPC_NBR                                        05960000
059700               , SUM(B.SHPD_UNT_QTY)                              05970000
059800             FROM SUT_OTBND_CART A                                05980000
059900                , SUT_OTBND_UPC B                                 05990000
060000             WHERE A.SHIPT_UNT_ID = :DK-SHIPT-UNT-ID              06000000
060100               AND A.ACTV_IND     = 'Y'                           06010000
060200               AND A.SHIPT_UNT_ID = B.SHIPT_UNT_ID                06020000
060300               AND NOT EXISTS                                     06030000
060400              (SELECT  *                                          06040000
060500                 FROM XLT_UPC C                                   06050000
060600                 WHERE B.UPC_NBR = C.UPC_NBR)                     06060000
060700             GROUP BY B.TRN_LNE_NBR, B.UPC_NBR                    06070000
060800         ORDER BY 2,3,1                                           06080000
060900     END-EXEC.                                                    06090000
061000                                                                  06100000
061100     EXEC SQL                                                     06110000
061200          DECLARE PACK-CURSOR CURSOR FOR                          06120000
061300          SELECT                                                  06130000
061400                 A.ORD_LNE_NBR                                    06140000
061500              ,  A.ITM_NBR                                        06150000
061600              ,  A.PREPK_RATO_QTY                                 06160000
061700              ,  A.PREPK_DRV_LNE_CDE                              06170000
061800          FROM                                                    06180000
061900                 TRECITM  A                                       06190000
062000          WHERE                                                   06200000
062100                A.ORD_NBR          =  :DK-PO-NBR                  06210000
062200           AND  A.REC_SEQ_NBR      =  :DK-RCVR-SEQ-NBR            06220000
062300           AND  A.VER_STATUS_CDE   =  'A'                         06230000
062400           AND  A.PREPK_ID         = :DK-PACK-ID                  06240000
062500     END-EXEC.                                                    06250000
062600                                                                  06260000
062700*                                                                 06270000
062800 LINKAGE SECTION.                                                 06280000
062900 01  DFHCOMMAREA.                                                 06290000
063000     05  FILLER                       OCCURS 1 TO 4072 TIMES      06300000
063100                                      DEPENDING ON EIBCALEN.      06310000
063200         10  FILLER                   PIC X.                      06320000
063300*                                                                 06330000
063400*                                                                 06340000
063500 PROCEDURE DIVISION.                                              06350000
063600 0000-PROGRAM-MAINLINE.                                           06360000
063700                                                                  06370000
063800     INITIALIZE CA-COMMAREA                                       06380000
063900     MOVE DFHCOMMAREA                 TO CA-COMMAREA              06390000
064000                                                                  06400000
064100     EVALUATE TRUE                                                06410000
064200         WHEN EIBCALEN = ZERO                                     06420000
064300             MOVE PC-ENTER-THROUGH-MENU-MSG TO PV-MESSAGE-AREA    06430000
064400             PERFORM 8300-RETURN                                  06440000
064500                                                                  06450000
064600         WHEN EIBTRNID = 'Z278'                                   06460000
064700             MOVE DFHCOMMAREA         TO PC192-COMMAREA           06470000
064800             MOVE PC192-HOST-SAVE-AREA                            06480000
064900                                      TO CA-COMMAREA              06490000
065000             SET PC033-PROCESS-SCREEN TO TRUE                     06500000
065100             MOVE PC192-HOST-SAVE-MAP TO PC863AO                  06510000
065200             MOVE -1                  TO AUPCL                    06520000
065300             PERFORM 8000-SEND-MAP                                06530000
065400             PERFORM 8200-RETURN-TRANID                           06540000
065500                                                                  06550000
065600         WHEN PC033-INITIALIZE-SCREEN                             06560000
065700         WHEN EIBAID = DFHCLEAR                                   06570000
065800              SET PC033-PROCESS-SCREEN TO TRUE                    06580000
065900              PERFORM 1000-INITIALIZE                             06590000
066000              IF PC033-UPC-ENTERED                                06600000
066100                 IF PC033-UPC-NBR = ZEROES                        06610000
066200                     MOVE SPACES      TO AUPCO                    06620000
066300                 ELSE                                             06630000
066400                     MOVE PC033-UPC-NBR TO AUPCO                  06640000
066500                 END-IF                                           06650000
066600                 MOVE -1            TO AUPCL                      06660000
066700              ELSE                                                06670000
066800                 IF PC033-SKU-NBR-N = ZEROES                      06680000
066900                     MOVE SPACES      TO ASKUO                    06690000
067000                 ELSE                                             06700000
067100                     MOVE PC033-SKU-NBR-N TO ASKUO                06710000
067200                 END-IF                                           06720000
067300                 MOVE -1            TO ASKUL                      06730000
067400              END-IF                                              06740000
067500              MOVE PC033-CARTON     TO PV-SHIPT-UNT-ID            06750000
067600                                       DK-SHIPT-UNT-ID            06760000
067700              MOVE PV-SHIPT-UNT-ID  TO ACARTNO                    06770000
067800              IF PC033-LAST-PROGRAM = 'PCKRF900'                  06780000
067900                  MOVE PC-CURRENT-PROGRAM-NAME                    06790000
068000                                    TO PC033-LAST-PROGRAM         06800000
068100                  PERFORM 8000-SEND-MAP                           06810000
068200                  PERFORM 8200-RETURN-TRANID                      06820000
068300              ELSE                                                06830000
068400                  MOVE PC-CURRENT-PROGRAM-NAME                    06840000
068500                                    TO PC033-LAST-PROGRAM         06850000
068600                  MOVE PC033-REASON-CDE TO PV-PRC-RSN-CDE         06860000
068700                  MOVE PV-PRC-RSN-CDE   TO AMSGLNO                06870000
068800                  IF PS-INVALID-INPUT                             06880000
068900                     PERFORM 8100-SEND-DATA-ONLY                  06890000
069000                     PERFORM 8200-RETURN-TRANID                   06900000
069100                  ELSE                                            06910000
069200                     PERFORM 8000-SEND-MAP                        06920000
069300                     PERFORM 8200-RETURN-TRANID                   06930000
069400                  END-IF                                          06940000
069500              END-IF                                              06950000
069600                                                                  06960000
069700         WHEN EIBAID = DFHENTER                                   06970000
069800              PERFORM 2000-PROCESS-SCREEN-FIELDS                  06980000
069900              MOVE -1            TO AADJQTYL                      06990000
070000              IF PC033-MULT-VALUES-YES AND PS-VALID-INPUT         07000000
070100                 PERFORM 8220-XCTL-PO-ENTRY-SCREEN                07010000
070200              ELSE                                                07020000
070300                 PERFORM 8000-SEND-MAP                            07030000
070400                 PERFORM 8200-RETURN-TRANID                       07040000
070500              END-IF                                              07050000
070600                                                                  07060000
070700         WHEN EIBAID = DFHPF1                                     07070000
070800             PERFORM 2100-RECEIVE-MAP                             07080000
070900             MOVE PC863AO             TO PC192-HOST-SAVE-MAP      07090000
071000             PERFORM 1200-HELP-SCREEN                             07100000
071100                                                                  07110000
071200         WHEN EIBAID = DFHPF3                                     07120000
071300              MOVE PC-ADJUST-CRTN-UNTS-PGM TO                     07130000
071400                          PV-TRANSFER-PROGRAM                     07140000
071500              INITIALIZE PC033-PO-NBR                             07150000
071600                         PC033-PO-LINE-NBR                        07160000
071700                         PC033-RCVR-SEQ-NBR                       07170000
071800                         PC033-RCVR-SEQ-NBR-CTN                   07180000
071900                         PC033-RCVR-SEQ-NBR-MAP                   07190000
072000                         PC033-PO-PREPK-ID                        07200000
072100                         PC033-INTR-UPC-ID                        07210000
072200                         PC033-UPC-NBR                            07220000
072300                         PC033-SKU-NBR                            07230000
072400                         PC033-UPC-DESC                           07240000
072500                         PC033-MULT-VALUES-SW                     07250000
072600                         PC033-OK-TO-UPDATE-SW                    07260000
072700              PERFORM 9100-XCTL-TO-SELECTED-PROGRAM               07270000
072800                                                                  07280000
072900*IF UPC OR SKU ALREADY IN CARTON AND WANT TO ADJUST UNITS         07290000
073000         WHEN EIBAID = DFHPF5                                     07300000
073100              MOVE PC-U TO PV-ADJ-FUNC-CDE                        07310000
073200              IF PC033-RCVR-SEQ-NBR-MAP > 0                       07320000
073300                  MOVE PC033-RCVR-SEQ-NBR-MAP TO DK-RCVR-SEQ-NBR  07330000
073400              ELSE                                                07340000
073500                  MOVE PC033-RCVR-SEQ-NBR-CTN TO DK-RCVR-SEQ-NBR  07350000
073600              END-IF                                              07360000
073700              PERFORM 2000-PROCESS-SCREEN-FIELDS                  07370000
073800              IF PC033-MULT-VALUES-YES AND PS-VALID-INPUT         07380000
073900                  PERFORM 8220-XCTL-PO-ENTRY-SCREEN               07390000
074000              END-IF                                              07400000
074100              IF PS-VALID-INPUT                                   07410000
074200                  IF PS-ITM-FOUND-ON-PORCVR AND                   07420000
074300                     PC033-UNIT-ADJUST                            07430000
074400                      PERFORM 4000-PROCESS-ADD                    07440000
074500                  ELSE                                            07450000
074600                      IF PS-ITM-FOUND-ON-PORCVR AND               07460000
074700                         PC033-DAMAGED-UNITS                      07470000
074800                           MOVE PC-UNT-CNT-BE-ADD-DMG TO AMSGLNO  07480000
074900                           PERFORM 8100-SEND-DATA-ONLY            07490000
075000                           PERFORM 8200-RETURN-TRANID             07500000
075100                      ELSE                                        07510000
075200                          PERFORM 5000-PROCESS-UPDATE             07520000
075300                          MOVE PC033-SKU-NBR-N TO DK-SKU-NBR      07530000
075400                          MOVE PC033-CARTON    TO DK-SHIPT-UNT-ID 07540000
075500                          IF DK-SKU-NBR  =  ZEROES                07550000
075600                              PERFORM 2235-GET-UNITS-IN-UPC       07560000
075700                          ELSE                                    07570000
075800                              PERFORM 2230-GET-UNITS-IN-SKU       07580000
075900                          END-IF                                  07590000
076000                          MOVE PV-UNTS-IN-SKU TO AUNTSKUO         07600000
076100                          INITIALIZE PV-ADJ-ENTERED-QTY           07610000
076200                          MOVE PV-ADJ-ENTERED-QTY TO AADJQTYO     07620000
076300                          PERFORM 2270-GET-TOTAL-UNTS-IN-CTN      07630000
076400                          MOVE ZEROES               TO AUNTCTNO   07640000
076500                          MOVE PV-TOT-UNTS-IN-CTN   TO AUNTCTNO   07650000
076600                                                                  07660000
076700                          MOVE -1                   TO AUPCL      07670000
076800                          MOVE SPACES               TO ASKUO      07680000
076900                                                       AUPCO      07690000
077000                          PERFORM 8000-SEND-MAP                   07700000
077100                          PERFORM 8200-RETURN-TRANID              07710000
077200                      END-IF                                      07720000
077300                  END-IF                                          07730000
077400              ELSE                                                07740000
077500                  IF PS-INVALID-INPUT                             07750000
077600                     PERFORM 8100-SEND-DATA-ONLY                  07760000
077700                     PERFORM 8200-RETURN-TRANID                   07770000
077800                  END-IF                                          07780000
077900              END-IF                                              07790000
078000                                                                  07800000
078100         WHEN OTHER                                               07810000
078200              MOVE PC-UNRECOGNIZED-PF-KEY-MSG TO AMSGLNO          07820000
078300              PERFORM 8100-SEND-DATA-ONLY                         07830000
078400              PERFORM 8200-RETURN-TRANID                          07840000
078500     END-EVALUATE.                                                07850000
078600                                                                  07860000
078700     GOBACK.                                                      07870000
078800*                                                                 07880000
078900*                                                                 07890000
079000 1000-INITIALIZE.                                                 07900000
079100     MOVE -1       TO AUPCL.                                      07910000
079200     IF PC033-LAST-PROGRAM = 'PCKRF900'                           07920000
079300         IF PC033-PO-NBR > ZERO                                   07930000
079400                 AND PC033-RCVR-SEQ-NBR-MAP > ZERO                07940000
079500                 AND PC033-PO-LINE-NBR      > ZERO                07950000
079600             SET PC033-MULT-VALUES-NO                             07960000
079700                 PC033-OK-TO-UPDATE-YES      TO TRUE              07970000
079800                 MOVE PC033-UPC-NBR          TO PV-UPC-NBR        07980000
079900                 MOVE PC033-RCVR-SEQ-NBR-MAP TO DK-RCVR-SEQ-NBR   07990000
080000             PERFORM 2200-EDIT-INPUT                              08000000
080100         ELSE                                                     08010000
080200             SET PS-INVALID-INPUT                                 08020000
080300                 PC033-OK-TO-UPDATE-NO                            08030000
080400                 PC033-MULT-VALUES-NO    TO TRUE                  08040000
080500             MOVE 'UPC ON MLT RCVR'      TO AMSGLNO               08050000
080600         END-IF                                                   08060000
080700     ELSE                                                         08070000
080800         INITIALIZE PC033-RCVR-SEQ-NBR-CTN                        08080000
080900                    PC033-RCVR-SEQ-NBR-MAP                        08090000
081000                    PC033-MASTER-CARTON                           08100000
081100     END-IF.                                                      08110000
081200*                                                                 08120000
081300*                                                                 08130000
081400 1200-HELP-SCREEN.                                                08140000
081500     MOVE 'DPKRF278'                  TO PV-TRANSFER-PROGRAM      08150000
081600     MOVE 'PCKRF863'                  TO PC192-PROGRAM-NAME       08160000
081700     COPY PCPD188.                                                08170000
081800     MOVE PC188-DISPLAY-DATE          TO PC192-DISPLAY-DATE.      08180000
081900     MOVE CA-COMMAREA                 TO PC192-HOST-SAVE-AREA     08190000
082000     PERFORM 8400-XCTL-TO-HELP.                                   08200000
082100*                                                                 08210000
082200*                                                                 08220000
082300 2000-PROCESS-SCREEN-FIELDS.                                      08230000
082400                                                                  08240000
082500     PERFORM 2100-RECEIVE-MAP.                                    08250000
082600     PERFORM 2200-EDIT-INPUT.                                     08260000
082700                                                                  08270000
082800*                                                                 08280000
082900 2100-RECEIVE-MAP.                                                08290000
083000                                                                  08300000
083100     EXEC CICS                                                    08310000
083200         RECEIVE MAP    ('PC863A')                                08320000
083300                 MAPSET ('PCKM863')                               08330000
083400                 RESP   (PV-CICS-RESPONSE)                        08340000
083500     END-EXEC.                                                    08350000
083600                                                                  08360000
083700     EVALUATE TRUE                                                08370000
083800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 08380000
083900             PERFORM 2110-RECEIVE-SCREEN-FIELDS                   08390000
084000         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                08400000
084100             CONTINUE                                             08410000
084200         WHEN OTHER                                               08420000
084300            MOVE '2100-RECEIVE-MAP'      TO DP013-PARAGRAPH       08430000
084400            MOVE 'UNABLE TO RECEIVE MAP' TO DP013-MESSAGE-TEXT (1)08440000
084500            SET DP013-LOGIC-ABEND        TO TRUE                  08450000
084600            SET DP013-NO-ROLLBACK        TO TRUE                  08460000
084700            PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                08470000
084800     END-EVALUATE.                                                08480000
084900*                                                                 08490000
085000*                                                                 08500000
085100 2110-RECEIVE-SCREEN-FIELDS.                                      08510000
085200                                                                  08520000
085300     IF  AUPCL > ZERO                                             08530000
085400         MOVE AUPCI TO PV-UPC-NBR                                 08540000
085500     ELSE                                                         08550000
085600         IF AUPCA = DP015-ERASE-EOF                               08560000
085700             MOVE SPACES TO PV-UPC-NBR                            08570000
085800         END-IF                                                   08580000
085900     END-IF.                                                      08590000
086000                                                                  08600000
086100     IF  ASKUL > ZERO                                             08610000
086200         MOVE ASKUI TO PV-SKU-NBR                                 08620000
086300     ELSE                                                         08630000
086400         IF ASKUA = DP015-ERASE-EOF                               08640000
086500             MOVE SPACES TO PV-SKU-NBR                            08650000
086600         END-IF                                                   08660000
086700     END-IF.                                                      08670000
086800                                                                  08680000
086900     IF  AADJQTYL > ZERO                                          08690000
087000         MOVE AADJQTYI TO PV-ADJ-ENTERED-QTY                      08700000
087100     ELSE                                                         08710000
087200         IF AADJQTYA = DP015-ERASE-EOF                            08720000
087300             MOVE SPACES TO PV-ADJ-ENTERED-QTY                    08730000
087400         END-IF                                                   08740000
087500     END-IF.                                                      08750000
087600*                                                                 08760000
087700*                                                                 08770000
087800 2200-EDIT-INPUT.                                                 08780000
087900                                                                  08790000
088000     MOVE PC033-CARTON    TO DK-SHIPT-UNT-ID                      08800000
088100                                                                  08810000
088200     EVALUATE TRUE                                                08820000
088300*IF NOTHING WAS ENTERED IN THE UPC FIELD AND THE UPC IS           08830000
088400*REQUIRED FOR THE REQUESTED FUNCTION, SEND AN ERROR               08840000
088500        WHEN PV-UPC-NBR = (SPACES OR LOW-VALUES) AND              08850000
088600             (PV-SKU-NBR = SPACES)                                08860000
088700             SET PS-INVALID-INPUT        TO TRUE                  08870000
088800             MOVE DP015-UNP-ALP-BRT-MDT  TO AUPCA                 08880000
088900             MOVE -1                     TO AUPCL                 08890000
089000             MOVE PC-ENT-UPC-OR-SKU-MSG  TO AMSGLNO               08900000
089100                                                                  08910000
089200*WHEN UPC ENTERED                                                 08920000
089300        WHEN PV-UPC-NBR > SPACES AND                              08930000
089400                            PV-SKU-NBR = SPACES                   08940000
089500             SET PC033-UPC-ENTERED TO TRUE                        08950000
089600             PERFORM 2201-UPC-EDITS                               08960000
089700                                                                  08970000
089800*WHEN UPC AND SKU NUMBER ENTERED                                  08980000
089900        WHEN PV-UPC-NBR > SPACES AND                              08990000
090000             PV-SKU-NBR > SPACES                                  09000000
090100             SET PC033-UPC-ENTERED TO TRUE                        09010000
090200             PERFORM 2201-UPC-EDITS                               09020000
090300                                                                  09030000
090400*WHEN SKU ENTERED                                                 09040000
090500        WHEN PV-SKU-NBR > SPACES AND                              09050000
090600             PV-UPC-NBR = (SPACES OR LOW-VALUES)                  09060000
090700             SET PC033-SKU-ENTERED                                09070000
090800                 PC033-UPC-NOT-ENTERED TO TRUE                    09080000
090900             PERFORM 2202-SKU-EDITS                               09090000
091000                                                                  09100000
091100     END-EVALUATE.                                                09110000
091200                                                                  09120000
091300     IF (PV-ADJ-ENTERED-QTY > SPACES) AND PS-VALID-INPUT          09130000
091400        PERFORM 2240-EDIT-ADJ-TO-QTY                              09140000
091500     END-IF.                                                      09150000
091600                                                                  09160000
091630                                                                  09163006
091700 2201-UPC-EDITS.                                                  09170000
091740                                                                  09174004
091750*CHECK TO MAKE SURE THEY ARE SIGNED IN AS A DC LOCATION           09175007
091760*ONLY DO THIS CHECK IF PROCESSING DAMAGED UNITS                   09176008
091770     IF  PC033-REASON-CDE = 'DMGD UNT'                            09177008
091771         PERFORM 2245-CHECK-IF-DC-LOC                             09177108
091772     END-IF.                                                      09177208
091780                                                                  09178007
091800*CHECK TO MAKE SURE THE UPC IS NUMERIC                            09180000
091900     IF (PC033-UPC-ENTERED AND  PV-UPC-NBR = 0) AND               09190007
091910         PS-VALID-INPUT                                           09191007
092000         SET PS-INVALID-INPUT        TO TRUE                      09200000
092100         MOVE DP015-UNP-ALP-BRT-MDT  TO AUPCA                     09210000
092200         MOVE -1                     TO AUPCL                     09220000
092300         MOVE PC-UPC-MUST-BE-GT-0    TO AMSGLNO                   09230000
092400     END-IF.                                                      09240000
092500     IF PS-VALID-INPUT                                            09250000
092600         INITIALIZE DP010I-NUMERIC-EDIT-AREA                      09260000
092700         MOVE PV-UPC-NBR            TO DP010I-UNEDITED-FIELD      09270000
092800         MOVE 15                    TO DP010I-MAXIMUM-DIGITS      09280000
092900         MOVE 0                     TO DP010I-MAXIMUM-DECIMALS    09290000
093000         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  09300000
093100                                                                  09310000
093210         CALL DP010I-NUMERIC-EDIT-ROUTINE                         09321011
093220                         USING DP010I-NUMERIC-EDIT-AREA           09322011
093300         IF  DP010I-ERROR-DETECTED                                09330000
093400             SET PS-INVALID-INPUT        TO TRUE                  09340000
093500             MOVE DP015-UNP-ALP-BRT-MDT  TO AUPCA                 09350000
093600             MOVE -1                     TO AUPCL                 09360000
093700             MOVE PC-MUST-BE-NUM-MSG TO AMSGLNO                   09370000
093800             PERFORM 8100-SEND-DATA-ONLY                          09380000
093900             PERFORM 8200-RETURN-TRANID                           09390000
094000         ELSE                                                     09400000
094100             SET PS-VALID-INPUT          TO TRUE                  09410000
094200             MOVE DP010I-NUM-FIELD-15-DIG-2-DEC                   09420000
094300                                         TO PV-UPC-NBR-N          09430000
094400             IF PV-UPC-NBR-N NOT = PC033-UPC-NBR                  09440000
094500                 SET PC033-OK-TO-UPDATE-NO    TO TRUE             09450000
094600             END-IF                                               09460000
094700             MOVE PV-UPC-NBR-N           TO PC033-UPC-NBR         09470000
094800         END-IF                                                   09480000
094900     END-IF                                                       09490000
095000                                                                  09500000
095100     IF PS-VALID-INPUT                                            09510000
095200        PERFORM 2210-CHECK-IF-UPC-IN-CTN                          09520000
095300*        (POPULATE PC033-INTR-UPC-ID REGARDLESS)                  09530000
095400         PERFORM 2265-GET-SKU                                     09540000
095500         IF PS-VALID-INPUT                                        09550000
095600             IF PC033-MULT-VALUES-YES                             09560000
095700                 CONTINUE                                         09570000
095800             ELSE                                                 09580000
095900                 PERFORM 2210A-CONTINUE                           09590000
096000             END-IF                                               09600000
096100         END-IF                                                   09610000
096200     END-IF.                                                      09620000
096300                                                                  09630000
096400 2210A-CONTINUE.                                                  09640000
096500                                                                  09650000
096600     IF PS-UPC-FOUND-IN-CTN                                       09660000
096700         MOVE DP015-UNP-ALP-NOR-MDT TO AUPCA                      09670000
096800         MOVE PC033-CARTON      TO PV-SHIPT-UNT-ID                09680000
096900         MOVE PV-SHIPT-UNT-ID   TO ACARTNO                        09690000
097000         MOVE PC033-REASON-CDE  TO PV-PRC-RSN-CDE                 09700000
097100         MOVE PV-PRC-RSN-CDE    TO AMSGLNO                        09710000
097200         MOVE PC033-SKU-NBR     TO ASKUO                          09720000
097300         MOVE XL001-SKU-DESC    TO ASKUDSCO                       09730000
097400                                                                  09740000
097500         IF DK-SKU-NBR  =  ZEROES                                 09750000
097600             PERFORM 2235-GET-UNITS-IN-UPC                        09760000
097700         ELSE                                                     09770000
097800             PERFORM 2230-GET-UNITS-IN-SKU                        09780000
097900         END-IF                                                   09790000
098000                                                                  09800000
098100         MOVE PV-UNTS-IN-SKU TO AUNTSKUO                          09810000
098200         PERFORM 2270-GET-TOTAL-UNTS-IN-CTN                       09820000
098300         MOVE ZEROES               TO AUNTCTNO                    09830000
098400         MOVE PV-TOT-UNTS-IN-CTN   TO AUNTCTNO                    09840000
098500     ELSE                                                         09850000
098600         PERFORM 2220-CHECK-IF-SKU-IN-CTN                         09860000
098700                                                                  09870000
098800         IF PC033-MULT-VALUES-YES                                 09880000
098900             CONTINUE                                             09890000
099000         ELSE                                                     09900000
099100             PERFORM 2210A2-CONTINUE                              09910000
099200         END-IF                                                   09920000
099300     END-IF.                                                      09930000
099400                                                                  09940000
099500 2210A2-CONTINUE.                                                 09950000
099600     IF PS-SKU-FOUND-IN-CTN                                       09960000
099700         MOVE DP015-UNP-ALP-NOR-MDT TO AUPCA                      09970000
099800         MOVE PC033-CARTON      TO PV-SHIPT-UNT-ID                09980000
099900         MOVE PV-SHIPT-UNT-ID   TO ACARTNO                        09990000
100000         MOVE PC033-REASON-CDE  TO PV-PRC-RSN-CDE                 10000000
100100         MOVE PV-PRC-RSN-CDE    TO AMSGLNO                        10010000
100200         MOVE PV-SKU-NBR         TO ASKUO                         10020000
100300         MOVE XL001-SKU-DESC     TO ASKUDSCO                      10030000
100400         PERFORM 2230-GET-UNITS-IN-SKU                            10040000
100500         MOVE PV-UNTS-IN-SKU TO AUNTSKUO                          10050000
100600         PERFORM 2270-GET-TOTAL-UNTS-IN-CTN                       10060000
100700         MOVE ZEROES               TO AUNTCTNO                    10070000
100800         MOVE PV-TOT-UNTS-IN-CTN   TO AUNTCTNO                    10080000
100900     ELSE                                                         10090000
101000       PERFORM 2290-SELECT-OUTBOUND-SRC-CDE                       10100000
101100       IF SUT00024-CART-SRC-CDE NOT = 'CPS'                       10110000
101200         PERFORM 2300-GET-PORCVR-CRTN                             10120000
101300         IF PC033-RCVR-SEQ-NBR-CTN = 0                            10130000
101400             PERFORM 2301-GET-RCVR-NBR                            10140000
101500         END-IF                                                   10150000
101600         IF PS-VALID-INPUT                                        10160000
101700             INITIALIZE XL001-ITEM-COMMAREA                       10170000
101800             SET XL001-SELECT-UPC                                 10180000
101900                 XL001-SELECT-SKU TO TRUE                         10190000
102000             IF PC033-UPC-NBR > 0                                 10200000
102100                 SET XL001-BY-UPC-NBR         TO TRUE             10210000
102200                 MOVE PC033-UPC-NBR           TO XL001-KEY-UPC-NBR10220000
102300             ELSE                                                 10230000
102400                 SET XL001-BY-NUMERIC-SKU     TO TRUE             10240000
102500                 MOVE PC033-SKU-NBR-N         TO XL001-KEY-SKU    10250000
102600             END-IF                                               10260000
102700             PERFORM 8600-CALL-XLKUT001                           10270000
102800             EVALUATE TRUE                                        10280000
102900                 WHEN XL001-UPC-SQLCODE = ZERO                    10290000
103000                 WHEN XL001-UPC-SQLCODE = -811                    10300000
103100                     MOVE XL001-ITM-NBR       TO PC033-ITM-NBR    10310000
103200                     MOVE XL001-SKU-NBR       TO PC033-SKU-NBR-N  10320000
103300                                                 DK-SKU-NBR       10330000
103400                     MOVE XL001-UPC-NBR       TO PC033-UPC-NBR    10340000
103500                                                 DK-UPC-NBR       10350000
103600                     MOVE XL001-INTR-UPC-ID   TO PC033-INTR-UPC-ID10360000
103700                 WHEN OTHER                                       10370000
103800                     MOVE ZEROES              TO PC033-ITM-NBR    10380000
103900                     MOVE ZEROES              TO PC033-SKU-NBR-N  10390000
104000                                                 DK-SKU-NBR       10400000
104100                                                 PC033-UPC-NBR    10410000
104200                                                 DK-UPC-NBR       10420000
104300                                                 PC033-INTR-UPC-ID10430000
104400             END-EVALUATE                                         10440000
104500             IF PC033-ITM-NBR > 0                                 10450000
104600                 PERFORM 2310-CHECK-TRECITM                       10460000
104700                 IF PS-ITM-FOUND-ON-PORCVR                        10470000
104800                     MOVE PC033-REASON-CDE   TO PV-PRC-RSN-CDE    10480000
104900                     MOVE PV-PRC-RSN-CDE     TO AMSGLNO           10490000
105000                     MOVE XL001-SKU-NBR      TO ASKUO             10500000
105100                     MOVE XL001-SKU-DESC     TO ASKUDSCO          10510000
105200                     PERFORM 2230-GET-UNITS-IN-SKU                10520000
105300                     MOVE PV-UNTS-IN-SKU     TO AUNTSKUO          10530000
105400                     PERFORM 2270-GET-TOTAL-UNTS-IN-CTN           10540000
105500                     MOVE ZEROES             TO AUNTCTNO          10550000
105600                     MOVE PV-TOT-UNTS-IN-CTN TO AUNTCTNO          10560000
105700                 ELSE                                             10570000
105800                     IF PS-ITM-FOUND-ON-PO                        10580000
105900                         IF PC033-UPC-ENTERED                     10590000
106000                             MOVE DP015-UNP-ALP-BRT-MDT  TO AUPCA 10600000
106100                             MOVE -1                     TO AUPCL 10610000
106200                         ELSE                                     10620000
106300                             MOVE DP015-UNP-ALP-BRT-MDT  TO ASKUA 10630000
106400                             MOVE -1                     TO ASKUL 10640000
106500                         END-IF                                   10650000
106600                         MOVE PC-ITM-NOT-ON-RCVR    TO AMSGLNO    10660000
106700                         PERFORM 8100-SEND-DATA-ONLY              10670000
106800                         PERFORM 8200-RETURN-TRANID               10680000
106900                     ELSE                                         10690000
107000                         IF PC033-UPC-ENTERED                     10700000
107100                             MOVE DP015-UNP-ALP-BRT-MDT  TO AUPCA 10710000
107200                             MOVE -1                     TO AUPCL 10720000
107300                         ELSE                                     10730000
107400                             MOVE DP015-UNP-ALP-BRT-MDT  TO ASKUA 10740000
107500                             MOVE -1                     TO ASKUL 10750000
107600                         END-IF                                   10760000
107700                         MOVE PC-ITM-NOT-ON-PO      TO AMSGLNO    10770000
107800                         PERFORM 8100-SEND-DATA-ONLY              10780000
107900                         PERFORM 8200-RETURN-TRANID               10790000
108000                     END-IF                                       10800000
108100                 END-IF                                           10810000
108200             ELSE                                                 10820000
108300                 MOVE PC-ITM-NOT-ON-PO      TO AMSGLNO            10830000
108400                 PERFORM 8100-SEND-DATA-ONLY                      10840000
108500                 PERFORM 8200-RETURN-TRANID                       10850000
108600             END-IF                                               10860000
108700         END-IF                                                   10870000
108800       ELSE                                                       10880000
108900           MOVE PC-UNT-CNT-BE-ADD-PHYSL TO AMSGLNO                10890000
109000           PERFORM 8100-SEND-DATA-ONLY                            10900000
109100           PERFORM 8200-RETURN-TRANID                             10910000
109200       END-IF                                                     10920000
109300     END-IF.                                                      10930000
109400                                                                  10940000
109500 2202-SKU-EDITS.                                                  10950000
109501                                                                  10950107
109510*CHECK TO MAKE SURE THEY ARE SIGNED IN AS A DC LOCATION           10951007
109511*ONLY DO THIS CHECK IF PROCESSING DAMAGED UNITS                   10951108
109523     IF  PC033-REASON-CDE = 'DMGD UNT'                            10952308
109524         PERFORM 2245-CHECK-IF-DC-LOC                             10952408
109525     END-IF.                                                      10952508
109530                                                                  10953007
109600*CHECK TO MAKE SURE THE SKU IS NUMERIC                            10960000
109700     IF (PC033-SKU-ENTERED AND  PV-SKU-NBR = 0) AND               10970007
109710         PS-VALID-INPUT                                           10971007
109800         SET PS-INVALID-INPUT        TO TRUE                      10980000
109900         MOVE DP015-UNP-ALP-BRT-MDT  TO AUPCA                     10990000
110000         MOVE -1                     TO AUPCL                     11000000
110100         MOVE PC-SKU-MUST-BE-GT-0    TO AMSGLNO                   11010000
110200     END-IF.                                                      11020000
110300     IF PS-VALID-INPUT                                            11030000
110400         INITIALIZE DP010I-NUMERIC-EDIT-AREA                      11040000
110500         MOVE PV-SKU-NBR    TO DP010I-UNEDITED-FIELD              11050000
110600         MOVE 8             TO DP010I-MAXIMUM-DIGITS              11060000
110700         MOVE 0             TO DP010I-MAXIMUM-DECIMALS            11070000
110800         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  11080000
110900                                                                  11090000
111010         CALL DP010I-NUMERIC-EDIT-ROUTINE                         11101011
111020                         USING DP010I-NUMERIC-EDIT-AREA           11102011
111100         IF  DP010I-ERROR-DETECTED                                11110000
111200             SET PS-INVALID-INPUT        TO TRUE                  11120000
111300             MOVE DP015-UNP-ALP-BRT-MDT  TO ASKUA                 11130000
111400             MOVE -1                     TO ASKUL                 11140000
111500             MOVE PC-MUST-BE-NUM-MSG     TO AMSGLNO               11150000
111600             PERFORM 8100-SEND-DATA-ONLY                          11160000
111700             PERFORM 8200-RETURN-TRANID                           11170000
111800         ELSE                                                     11180000
111900             SET PS-VALID-INPUT          TO TRUE                  11190000
112000             MOVE DP010I-NUMERIC-FIELD   TO PC033-SKU-NBR-N       11200000
112100                                            DK-SKU-NBR            11210000
112200         END-IF                                                   11220000
112300     END-IF                                                       11230000
112400                                                                  11240000
112500     IF PS-VALID-INPUT                                            11250000
112600         PERFORM 2220-CHECK-IF-SKU-IN-CTN                         11260000
112700         IF PC033-MULT-VALUES-YES                                 11270000
112800             CONTINUE                                             11280000
112900         ELSE                                                     11290000
113000             PERFORM 2202A-CONTINUE                               11300000
113100         END-IF                                                   11310000
113200     END-IF.                                                      11320000
113300                                                                  11330000
113400 2202A-CONTINUE.                                                  11340000
113500     IF PS-SKU-FOUND-IN-CTN                                       11350000
113600         MOVE -1               TO AADJQTYL                        11360000
113700         MOVE DP015-UNP-ALP-NOR-MDT TO ASKUA                      11370000
113800         MOVE PC033-CARTON     TO PV-SHIPT-UNT-ID                 11380000
113900*LMM                              DK-SHIPT-UNT-ID                 11390000
114000         MOVE PV-SHIPT-UNT-ID  TO ACARTNO                         11400000
114100         MOVE PC033-REASON-CDE TO PV-PRC-RSN-CDE                  11410000
114200         MOVE PV-PRC-RSN-CDE   TO AMSGLNO                         11420000
114300         MOVE XLT00003-SKU-DESC     TO ASKUDSCO                   11430000
114400         PERFORM 2230-GET-UNITS-IN-SKU                            11440000
114500         MOVE PV-UNTS-IN-SKU TO AUNTSKUO                          11450000
114600         PERFORM 2270-GET-TOTAL-UNTS-IN-CTN                       11460000
114700         MOVE ZEROES              TO AUNTCTNO                     11470000
114800         MOVE PV-TOT-UNTS-IN-CTN  TO AUNTCTNO                     11480000
114900     ELSE                                                         11490000
115000       PERFORM 2290-SELECT-OUTBOUND-SRC-CDE                       11500000
115100       IF SUT00024-CART-SRC-CDE NOT = 'CPS'                       11510000
115200         PERFORM 2300-GET-PORCVR-CRTN                             11520000
115300         IF PC033-RCVR-SEQ-NBR-CTN = 0                            11530000
115400             PERFORM 2301-GET-RCVR-NBR                            11540000
115500         END-IF                                                   11550000
115600         IF PS-VALID-INPUT                                        11560000
115700             INITIALIZE XL001-ITEM-COMMAREA                       11570000
116000             IF PC033-UPC-ENTERED                                 11600000
116100                 SET XL001-BY-UPC-NBR                             11610000
116110                     XL001-SELECT-SKU         TO TRUE             11611000
116200                 MOVE PC033-UPC-NBR           TO XL001-KEY-UPC-NBR11620000
116300             ELSE                                                 11630000
116310                 SET XL001-SELECT-UPC                             11631000
116320                     XL001-SELECT-SKU                             11632000
116400                     XL001-BY-NUMERIC-SKU     TO TRUE             11640000
116500                 MOVE PC033-SKU-NBR-N         TO XL001-KEY-SKU    11650000
116600             END-IF                                               11660000
116700             PERFORM 8600-CALL-XLKUT001                           11670000
116800             EVALUATE TRUE                                        11680000
116900                 WHEN XL001-UPC-NOT-FOUND                         11690000
117000                     SET PS-INVALID-INPUT        TO TRUE          11700000
117100                     MOVE DP015-UNP-ALP-BRT-MDT  TO AUPCA         11710000
117200                     MOVE -1                     TO AUPCL         11720000
117300                     MOVE PC-NOT-A-KOHLS-UPC     TO AMSGLNO       11730000
117400                 WHEN XL001-SKU-NOT-FOUND                         11740000
117500                     SET PS-INVALID-INPUT        TO TRUE          11750000
117600                     MOVE DP015-UNP-ALP-BRT-MDT  TO ASKUA         11760000
117700                     MOVE -1                     TO ASKUL         11770000
117800                     MOVE PC-NOT-A-KOHLS-SKU     TO AMSGLNO       11780000
117900                 WHEN XL001-UPC-SQLCODE = ZERO                    11790000
118000                 WHEN XL001-UPC-SQLCODE = -811                    11800000
118100                     MOVE XL001-ITM-NBR       TO PC033-ITM-NBR    11810000
118110                     IF PC033-UPC-ENTERED                         11811000
118200                         MOVE XL001-SKU-NBR   TO PC033-SKU-NBR-N  11820000
118300                                                 DK-SKU-NBR       11830000
118310                     ELSE                                         11831000
118400                         MOVE XL001-UPC-NBR   TO PC033-UPC-NBR    11840000
118500                                                 DK-UPC-NBR       11850000
118510                     END-IF                                       11851000
118600                     MOVE XL001-INTR-UPC-ID   TO PC033-INTR-UPC-ID11860000
118700                 WHEN OTHER                                       11870000
118800                     MOVE ZEROES              TO PC033-ITM-NBR    11880000
118900                     MOVE ZEROES              TO PC033-SKU-NBR-N  11890000
119000                                                 DK-SKU-NBR       11900000
119100                                                 PC033-UPC-NBR    11910000
119200                                                 DK-UPC-NBR       11920000
119300                                                 PC033-INTR-UPC-ID11930000
119400             END-EVALUATE                                         11940000
119500             IF PC033-ITM-NBR > 0                                 11950000
119600                 PERFORM 2310-CHECK-TRECITM                       11960000
119700                 IF PS-ITM-FOUND-ON-PORCVR                        11970000
119800                     MOVE PC033-REASON-CDE   TO PV-PRC-RSN-CDE    11980000
119900                     MOVE PV-PRC-RSN-CDE     TO AMSGLNO           11990000
120000                     MOVE XL001-SKU-NBR      TO ASKUO             12000000
120100                     MOVE XL001-SKU-DESC     TO ASKUDSCO          12010000
120200                     PERFORM 2230-GET-UNITS-IN-SKU                12020000
120300                     MOVE PV-UNTS-IN-SKU     TO AUNTSKUO          12030000
120400                     PERFORM 2270-GET-TOTAL-UNTS-IN-CTN           12040000
120500                     MOVE ZEROES             TO AUNTCTNO          12050000
120600                     MOVE PV-TOT-UNTS-IN-CTN TO AUNTCTNO          12060000
120700                 ELSE                                             12070000
120800                     IF PS-ITM-FOUND-ON-PO                        12080000
120900                         IF PC033-UPC-ENTERED                     12090000
121000                             MOVE DP015-UNP-ALP-BRT-MDT  TO AUPCA 12100000
121100                             MOVE -1                     TO AUPCL 12110000
121200                         ELSE                                     12120000
121300                             MOVE DP015-UNP-ALP-BRT-MDT  TO ASKUA 12130000
121400                             MOVE -1                     TO ASKUL 12140000
121500                         END-IF                                   12150000
121600                         MOVE PC-ITM-NOT-ON-RCVR    TO AMSGLNO    12160000
121700                         PERFORM 8100-SEND-DATA-ONLY              12170000
121800                         PERFORM 8200-RETURN-TRANID               12180000
121900                     ELSE                                         12190000
122000                         IF PC033-UPC-ENTERED                     12200000
122100                             MOVE DP015-UNP-ALP-BRT-MDT  TO AUPCA 12210000
122200                             MOVE -1                     TO AUPCL 12220000
122300                         ELSE                                     12230000
122400                             MOVE DP015-UNP-ALP-BRT-MDT  TO ASKUA 12240000
122500                             MOVE -1                     TO ASKUL 12250000
122600                         END-IF                                   12260000
122700                         MOVE PC-ITM-NOT-ON-PO      TO AMSGLNO    12270000
122800                         PERFORM 8100-SEND-DATA-ONLY              12280000
122900                         PERFORM 8200-RETURN-TRANID               12290000
123000                     END-IF                                       12300000
123100                 END-IF                                           12310000
123200             END-IF                                               12320000
123300         END-IF                                                   12330000
123400       ELSE                                                       12340000
123500           MOVE PC-UNT-CNT-BE-ADD-PHYSL TO AMSGLNO                12350000
123600           PERFORM 8100-SEND-DATA-ONLY                            12360000
123700           PERFORM 8200-RETURN-TRANID                             12370000
123800       END-IF                                                     12380000
123900     END-IF.                                                      12390000
124000                                                                  12400000
124100 2210-CHECK-IF-UPC-IN-CTN.                                        12410000
124200     MOVE PV-UPC-NBR-N     TO DK-UPC-NBR.                         12420000
124300                                                                  12430000
124400     IF PC033-MASTER-CARTON > ZEROS                               12440000
124500        MOVE PC033-MASTER-CARTON TO DK-SHIPT-UNT-ID               12450000
124600     ELSE                                                         12460000
124700        MOVE PC033-CARTON        TO DK-SHIPT-UNT-ID               12470000
124800     END-IF                                                       12480000
124900                                                                  12490000
125000     EXEC SQL                                                     12500000
125100         SELECT                                                   12510000
125200             TRN_NBR                                              12520000
125300         ,   RCVR_SEQ_NBR                                         12530000
125400         ,   TRN_LNE_NBR                                          12540000
125500         INTO                                                     12550000
125600             :SUT00028-TRN-NBR                                    12560000
125700         ,   :SUT00028-RCVR-SEQ-NBR                               12570000
125800         ,   :SUT00028-TRN-LNE-NBR                                12580000
125900         FROM  SUT_OTBND_UPC                                      12590000
126000         WHERE  UPC_NBR       = :DK-UPC-NBR                       12600000
126100           AND  SHIPT_UNT_ID  = :DK-SHIPT-UNT-ID                  12610000
126200     END-EXEC                                                     12620000
126300                                                                  12630000
126400     EVALUATE TRUE                                                12640000
126500         WHEN SQLCODE = ZERO                                      12650000
126600             MOVE SUT00028-TRN-NBR      TO PC033-PO-NBR           12660000
126700             MOVE SUT00028-RCVR-SEQ-NBR TO PC033-RCVR-SEQ-NBR-CTN 12670000
126800                                           DK-RCVR-SEQ-NBR        12680000
126900             MOVE SUT00028-TRN-LNE-NBR  TO PC033-PO-LINE-NBR      12690000
127000             SET PS-UPC-FOUND-IN-CTN                              12700000
127100                 PC033-OK-TO-UPDATE-YES TO TRUE                   12710000
127200             MOVE -1                    TO AADJQTYL               12720000
127300         WHEN SQLCODE = -811                                      12730000
127400             IF  PC033-OK-TO-UPDATE-YES OR PC033-MULT-VALUES-YES  12740000
127500                 CONTINUE                                         12750000
127600             ELSE                                                 12760000
127700                 MOVE SUT00028-TRN-NBR      TO PC033-PO-NBR       12770000
127800                 MOVE SUT00028-RCVR-SEQ-NBR TO                    12780000
127900                                           PC033-RCVR-SEQ-NBR-CTN 12790000
128000                                           DK-RCVR-SEQ-NBR        12800000
128100                 MOVE SUT00028-TRN-LNE-NBR  TO PC033-PO-LINE-NBR  12810000
128200                 PERFORM 2210A-PROCESS-MULTIPLES                  12820000
128300             END-IF                                               12830000
128400                                                                  12840000
128500         WHEN SQLCODE = +100                                      12850000
128600             SET PS-UPC-NOT-FOUND-IN-CTN TO TRUE                  12860000
128700         WHEN SQLWARN0 NOT = SPACES                               12870000
128800         WHEN SQLCODE NOT EQUAL ZERO                              12880000
128900             MOVE 1                      TO PV-ERROR-NBR          12890000
129000                                            PC033-ERROR-NBR       12900000
129100             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         12910000
129200             PERFORM 9903-WRITE-CICS-LOG                          12920000
129300                                                                  12930000
129400             MOVE '2210-CHECK-IF-UPC-IN-CTN' TO PC033-PARAGRAPH   12940000
129500             MOVE 'PCKRF863 '         TO PC033-MESSAGE-TEXT(1)    12950000
129600             MOVE DK-UPC-NBR          TO PC033-MESSAGE-TEXT(2)    12960000
129700             MOVE DK-SHIPT-UNT-ID     TO PC033-MESSAGE-TEXT(3)    12970000
129800             MOVE SQLCA               TO PC033-SQLCA              12980000
129900             MOVE 'SUT_OTBND_UPC'     TO PC033-DB2-TABLE-NAME(1)  12990000
130000             SET PC033-ABEND          TO TRUE                     13000000
130100             MOVE 99                  TO PC033-PGM-MSG-NBR        13010000
130200             PERFORM 8210-XCTL-ERROR-SCREEN                       13020000
130300     END-EVALUATE.                                                13030000
130400                                                                  13040000
130500 2210A-PROCESS-MULTIPLES.                                         13050000
130600                                                                  13060000
130700     PERFORM 7452-SELECT-OTBND-TRN.                               13070000
130800                                                                  13080000
130900     EVALUATE SQLCODE                                             13090000
131000         WHEN ZERO                                                13100000
131100             MOVE SUT00028-TRN-NBR    TO PC033-PO-NBR             13110000
131200             PERFORM 7453-SELECT-OTBND-UPC                        13120000
131300                                                                  13130000
131400             EVALUATE SQLCODE                                     13140000
131500                 WHEN ZERO                                        13150000
131600                     MOVE SUT00028-RCVR-SEQ-NBR                   13160000
131700                                      TO PC033-RCVR-SEQ-NBR-CTN   13170000
131800                                         DK-RCVR-SEQ-NBR          13180000
131900                     PERFORM 7454-SELECT-LNE-NBR                  13190000
132000                     EVALUATE SQLCODE                             13200000
132100                         WHEN ZERO                                13210000
132200                             MOVE SUT00028-TRN-LNE-NBR            13220000
132300                                      TO PC033-PO-LINE-NBR        13230000
132400                         WHEN -811                                13240000
132500**                           SINGLE PO/RCVR WITH MULT LINES       13250000
132600                             SET PC033-MULT-VALUES-YES            13260000
132700                                      TO TRUE                     13270000
132800                             INITIALIZE  PC033-PO-LINE-NBR        13280000
132900                     END-EVALUATE                                 13290000
133000                 WHEN -811                                        13300000
133100**                   SINGLE PO WITH MULT RECEIVERS                13310000
133200                     SET PC033-MULT-VALUES-YES TO TRUE            13320000
133300                     INITIALIZE    PC033-PO-LINE-NBR              13330000
133400                                   PC033-RCVR-SEQ-NBR-CTN         13340000
133500             END-EVALUATE                                         13350000
133600                                                                  13360000
133700         WHEN -811                                                13370000
133800             INITIALIZE PC033-PO-NBR                              13380000
133900                        PC033-RCVR-SEQ-NBR-CTN                    13390000
134000                        PC033-PO-LINE-NBR                         13400000
134100             SET PC033-MULT-VALUES-YES TO TRUE                    13410000
134200     END-EVALUATE.                                                13420000
134300                                                                  13430000
134400 2220-CHECK-IF-SKU-IN-CTN.                                        13440000
134500                                                                  13450000
134600     IF PC033-MASTER-CARTON > ZEROS                               13460000
134700        MOVE PC033-MASTER-CARTON TO DK-SHIPT-UNT-ID               13470000
134800     ELSE                                                         13480000
134900        MOVE PC033-CARTON        TO DK-SHIPT-UNT-ID               13490000
135000     END-IF                                                       13500000
135100                                                                  13510000
135200     EXEC SQL                                                     13520000
135300         SELECT  DISTINCT                                         13530000
135400                 XSKU.SKU_DESC                                    13540000
135500             ,   A.TRN_NBR                                        13550000
135600             ,   A.UPC_NBR                                        13560000
135700         INTO                                                     13570000
135800                :XLT00003-SKU-DESC                                13580000
135900             ,  :SUT00028-TRN-NBR                                 13590000
136000             ,  :SUT00028-UPC-NBR                                 13600000
136100         FROM                                                     13610000
136200                SUT_OTBND_UPC A                                   13620000
136300             ,  XLT_SKU       XSKU                                13630000
136400             ,  XLV_UPC       XUPC                                13640000
136500             ,  SUT_OTBND_CART B                                  13650000
136600         WHERE  A.UPC_NBR          = XUPC.UPC_NBR                 13660000
136700           AND  XSKU.INTR_UPC_ID   = XUPC.INTR_UPC_ID             13670000
136800           AND  A.SHIPT_UNT_ID     = B.SHIPT_UNT_ID               13680000
136900           AND  A.SHIPT_UNT_ID     = :DK-SHIPT-UNT-ID             13690000
137000           AND  XSKU.SKU_NBR       = :DK-SKU-NBR                  13700000
137100     END-EXEC.                                                    13710000
137200                                                                  13720000
137300     EVALUATE TRUE                                                13730000
137400         WHEN SQLCODE = ZERO                                      13740000
137500             MOVE SUT00028-TRN-NBR    TO PC033-PO-NBR             13750000
137600             MOVE SUT00028-UPC-NBR    TO PC033-UPC-NBR            13760000
137700                                         PV-UPC-NBR               13770000
137800                                         DK-UPC-NBR               13780000
137900             SET PS-SKU-FOUND-IN-CTN  TO TRUE                     13790000
138000*            ONLY ONE PO BUT COULD HAVE MULT RCVR/LINES           13800000
138100             PERFORM 2220A-PROCESS-MULTIPLES                      13810000
138200                                                                  13820000
138300         WHEN SQLCODE = -811                                      13830000
138400*            MULTIPLE PO NBRS                                     13840000
138500             SET PS-SKU-FOUND-IN-CTN                              13850000
138600                 PC033-MULT-VALUES-YES TO TRUE                    13860000
138700             INITIALIZE PC033-PO-NBR                              13870000
138800                        PC033-RCVR-SEQ-NBR-CTN                    13880000
138900                        PC033-PO-LINE-NBR                         13890000
139000                                                                  13900000
139100         WHEN SQLCODE = +100                                      13910000
139200             SET PS-SKU-NOT-FOUND-IN-CTN TO TRUE                  13920000
139300         WHEN SQLWARN0 NOT = SPACES                               13930000
139400         WHEN SQLCODE NOT EQUAL ZERO                              13940000
139500             MOVE 2                   TO PV-ERROR-NBR             13950000
139600                                         PC033-ERROR-NBR          13960000
139700             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         13970000
139800             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      13980000
139900             MOVE PC033-RCVR-SEQ-NBR-CTN TO PV-ERROR-RCVR-SEQ-NBR 13990000
140000             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  14000000
140100             PERFORM 9903-WRITE-CICS-LOG                          14010000
140200                                                                  14020000
140300             MOVE '2220-CHECK-IF-SKU-IN-CTN' TO PC033-PARAGRAPH   14030000
140400             MOVE 'PCKRF863 '         TO PC033-MESSAGE-TEXT(1)    14040000
140500             MOVE PC033-SKU-NBR       TO PC033-MESSAGE-TEXT(2)    14050000
140600             MOVE DK-SHIPT-UNT-ID     TO PC033-MESSAGE-TEXT(3)    14060000
140700             MOVE SQLCA               TO PC033-SQLCA              14070000
140800             MOVE 'SUT_OTBND_UPC'     TO PC033-DB2-TABLE-NAME(1)  14080000
140900             MOVE 'XLT_SKU'           TO PC033-DB2-TABLE-NAME(2)  14090000
141000             MOVE 'XLV_UPC'           TO PC033-DB2-TABLE-NAME(3)  14100000
141100             SET PC033-ABEND          TO TRUE                     14110000
141200             MOVE 99                  TO PC033-PGM-MSG-NBR        14120000
141300             PERFORM 8210-XCTL-ERROR-SCREEN                       14130000
141400     END-EVALUATE.                                                14140000
141500                                                                  14150000
141600 2220A-PROCESS-MULTIPLES.                                         14160000
141700     MOVE SUT00028-TRN-NBR            TO PC033-PO-NBR             14170000
141800     PERFORM 7460-DISTINCT-RCVR-NBR                               14180000
141900                                                                  14190000
142000     EVALUATE SQLCODE                                             14200000
142100         WHEN ZERO                                                14210000
142200*            SINGLE PO/RCVR SO CHECK FOR MULTIPLE LINES           14220000
142300             MOVE SUT00028-RCVR-SEQ-NBR TO PC033-RCVR-SEQ-NBR-CTN 14230000
142400                                           DK-RCVR-SEQ-NBR        14240000
142500             PERFORM 7461-DISTINCT-LINE                           14250000
142600                                                                  14260000
142700             EVALUATE SQLCODE                                     14270000
142800                 WHEN ZERO                                        14280000
142900*                    SINGLE PO/RCVR/LINE                          14290000
143000                     MOVE SUT00028-TRN-LNE-NBR  TO                14300000
143100                                                PC033-PO-LINE-NBR 14310000
143200                     SET PC033-OK-TO-UPDATE-YES TO TRUE           14320000
143300                 WHEN -811                                        14330000
143400*                    SAME PO/RCVR WITH MULT LINES                 14340000
143500                     SET PC033-MULT-VALUES-YES TO TRUE            14350000
143600                     INITIALIZE PC033-PO-LINE-NBR                 14360000
143700             END-EVALUATE                                         14370000
143800                                                                  14380000
143900         WHEN -811                                                14390000
144000                 SET PC033-MULT-VALUES-YES TO TRUE                14400000
144100                 INITIALIZE PC033-PO-LINE-NBR                     14410000
144200                            PC033-RCVR-SEQ-NBR-CTN                14420000
144300     END-EVALUATE.                                                14430000
144400*                                                                 14440000
144500 2230-GET-UNITS-IN-SKU.                                           14450000
144600     MOVE PC033-RCVR-SEQ-NBR-CTN TO DK-RCVR-SEQ-NBR.              14460000
144700     INITIALIZE PV-UNTS-IN-SKU                                    14470000
144800                PV-NULL-IND.                                      14480000
144900     EXEC SQL                                                     14490000
145000         SELECT  SUM(A.SHPD_UNT_QTY)                              14500000
145100         INTO   :PV-UNTS-IN-SKU :PV-NULL-IND                      14510000
145200         FROM   SUT_OTBND_UPC A                                   14520000
145300             ,  XLT_SKU       XSKU                                14530000
145400             ,  XLV_UPC       XUPC                                14540000
145500         WHERE  A.UPC_NBR          = XUPC.UPC_NBR                 14550000
145600           AND  XUPC.INTR_UPC_ID   = XSKU.INTR_UPC_ID             14560000
145700           AND  A.SHIPT_UNT_ID     = :DK-SHIPT-UNT-ID             14570000
145800           AND  XSKU.SKU_NBR       = :DK-SKU-NBR                  14580000
145900           AND  A.TRN_NBR          = :PC033-PO-NBR                14590000
146000           AND  A.RCVR_SEQ_NBR     = :DK-RCVR-SEQ-NBR             14600000
146100     END-EXEC.                                                    14610000
146200     EVALUATE TRUE                                                14620000
146300         WHEN SQLCODE = ZERO                                      14630000
146400         WHEN SQLCODE = +100                                      14640000
146500             IF PV-NULL-IND < 0                                   14650000
146600                 MOVE ZEROES TO PV-UNTS-IN-SKU                    14660000
146700             END-IF                                               14670000
146800         WHEN SQLWARN0 NOT = SPACES                               14680000
146900         WHEN SQLCODE NOT EQUAL ZERO                              14690000
147000             MOVE 3                   TO PV-ERROR-NBR             14700000
147100                                         PC033-ERROR-NBR          14710000
147200             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         14720000
147300             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      14730000
147400             MOVE PC033-RCVR-SEQ-NBR-CTN TO PV-ERROR-RCVR-SEQ-NBR 14740000
147500             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  14750000
147600             PERFORM 9903-WRITE-CICS-LOG                          14760000
147700                                                                  14770000
147800             MOVE '2230-GET-UNITS-IN-SKU' TO PC033-PARAGRAPH      14780000
147900             MOVE 'PCKRF863 '         TO PC033-MESSAGE-TEXT(1)    14790000
148000             MOVE DK-SHIPT-UNT-ID     TO PC033-MESSAGE-TEXT(2)    14800000
148100             MOVE SQLCA               TO PC033-SQLCA              14810000
148200             MOVE 'SUT_OTBND_UPC'     TO PC033-DB2-TABLE-NAME(1)  14820000
148300             MOVE 'XLT_SKU'           TO PC033-DB2-TABLE-NAME(2)  14830000
148400             MOVE 'XLV_UPC'           TO PC033-DB2-TABLE-NAME(3)  14840000
148500             SET PC033-ABEND          TO TRUE                     14850000
148600             MOVE 99                  TO PC033-PGM-MSG-NBR        14860000
148700             PERFORM 8210-XCTL-ERROR-SCREEN                       14870000
148800     END-EVALUATE.                                                14880000
148900                                                                  14890000
149000*-----------------------------------------------------------------14900000
149100 2235-GET-UNITS-IN-UPC.                                           14910000
149200     MOVE PC033-RCVR-SEQ-NBR-CTN TO DK-RCVR-SEQ-NBR.              14920000
149300     INITIALIZE PV-UNTS-IN-SKU                                    14930000
149400                PV-NULL-IND-2.                                    14940000
149500     EXEC SQL                                                     14950000
149600         SELECT  SUM(A.SHPD_UNT_QTY)                              14960000
149700         INTO   :PV-UNTS-IN-SKU :PV-NULL-IND-2                    14970000
149800         FROM   SUT_OTBND_UPC A                                   14980000
149900         WHERE  A.UPC_NBR          = :DK-UPC-NBR                  14990000
150000           AND  A.SHIPT_UNT_ID     = :DK-SHIPT-UNT-ID             15000000
150100           AND  A.TRN_NBR          = :PC033-PO-NBR                15010000
150200           AND  A.RCVR_SEQ_NBR     = :DK-RCVR-SEQ-NBR             15020000
150300           AND  A.TRN_LNE_NBR      = :PC033-PO-LINE-NBR           15030000
150400     END-EXEC.                                                    15040000
150500     EVALUATE TRUE                                                15050000
150600         WHEN SQLCODE = ZERO                                      15060000
150700         WHEN SQLCODE = +100                                      15070000
150800             IF PV-NULL-IND-2 < 0                                 15080000
150900                 MOVE ZEROES TO PV-UNTS-IN-SKU                    15090000
151000             END-IF                                               15100000
151100         WHEN SQLWARN0 NOT = SPACES                               15110000
151200         WHEN SQLCODE NOT EQUAL ZERO                              15120000
151300             MOVE 4                   TO PV-ERROR-NBR             15130000
151400                                         PC033-ERROR-NBR          15140000
151500             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         15150000
151600             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      15160000
151700             MOVE PC033-RCVR-SEQ-NBR-CTN TO PV-ERROR-RCVR-SEQ-NBR 15170000
151800             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  15180000
151900             PERFORM 9903-WRITE-CICS-LOG                          15190000
152000                                                                  15200000
152100             MOVE '2235-GET-UNITS-IN-UPC' TO PC033-PARAGRAPH      15210000
152200             MOVE 'PCKRF863 '         TO PC033-MESSAGE-TEXT(1)    15220000
152300             MOVE DK-SHIPT-UNT-ID     TO PC033-MESSAGE-TEXT(2)    15230000
152400             MOVE SQLCA               TO PC033-SQLCA              15240000
152500             MOVE 'SUT_OTBND_UPC'     TO PC033-DB2-TABLE-NAME(1)  15250000
152600             SET PC033-ABEND          TO TRUE                     15260000
152700             MOVE 99                  TO PC033-PGM-MSG-NBR        15270000
152800             PERFORM 8210-XCTL-ERROR-SCREEN                       15280000
152900     END-EVALUATE.                                                15290000
153000                                                                  15300000
153100*---------------------------------------------------------------- 15310000
153200 2240-EDIT-ADJ-TO-QTY.                                            15320000
153300     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     15330000
153400     MOVE PV-ADJ-ENTERED-QTY TO DP010I-UNEDITED-FIELD.            15340000
153500     MOVE 4      TO DP010I-MAXIMUM-DIGITS.                        15350000
153600     MOVE 0      TO DP010I-MAXIMUM-DECIMALS.                      15360000
153700     MOVE 0      TO PV-REMAINDER.                                 15370000
153800     PERFORM 2241-GET-LIMIT-QTY.                                  15380000
153900                                                                  15390000
154010     CALL DP010I-NUMERIC-EDIT-ROUTINE                             15401011
154020                         USING DP010I-NUMERIC-EDIT-AREA           15402011
154100     IF  DP010I-ERROR-DETECTED                                    15410000
154200         SET PS-INVALID-INPUT        TO TRUE                      15420000
154300         MOVE DP015-UNP-ALP-BRT-MDT  TO AADJQTYA                  15430000
154400         MOVE -1                     TO AADJQTYL                  15440000
154500         MOVE PC-MUST-BE-NUM-MSG     TO AMSGLNO                   15450000
154600     ELSE                                                         15460000
154700         IF DP010I-NUMERIC-FIELD   > PV-UNTS-IN-SKU               15470000
154800             COMPUTE  PV-REMAINDER = DP010I-NUMERIC-FIELD -       15480000
154900                                     PV-UNTS-IN-SKU               15490000
155000             IF PV-REMAINDER > KRPRPM-FUNC-QTY                    15500000
155100                 SET PS-INVALID-INPUT        TO TRUE              15510000
155200                 MOVE DP015-UNP-ALP-BRT-MDT  TO AADJQTYA          15520000
155300                 MOVE -1                     TO AADJQTYL          15530000
155400                 MOVE DP015-UNP-ALP-BRT-MDT  TO AMSGLNL           15540000
155500                 MOVE PC-ADJ-MUST-BE-LT-50   TO AMSGLNO           15550000
155600             ELSE                                                 15560000
155700                 SET PS-VALID-INPUT          TO TRUE              15570000
155800                 MOVE DP010I-NUMERIC-FIELD   TO                   15580000
155900                                           PV-ADJ-ENTERED-QUANTITY15590000
156000                 MOVE PV-ADJ-ENTERED-QUANTITY TO PC033-ADJ-AFT-QTY15600000
156100             END-IF                                               15610000
156200         ELSE                                                     15620000
156300             IF DP010I-NUMERIC-FIELD   < PV-UNTS-IN-SKU           15630000
156400                 COMPUTE  PV-REMAINDER = PV-UNTS-IN-SKU  -        15640000
156500                                         DP010I-NUMERIC-FIELD     15650000
156600                 IF PV-REMAINDER > KRPRPM-FUNC-QTY                15660000
156700                     SET PS-INVALID-INPUT        TO TRUE          15670000
156800                     MOVE DP015-UNP-ALP-BRT-MDT  TO AADJQTYA      15680000
156900                     MOVE -1                     TO AADJQTYL      15690000
157000                     MOVE DP015-UNP-ALP-BRT-MDT  TO AMSGLNL       15700000
157100                     MOVE PC-ADJ-MUST-BE-LT-50   TO AMSGLNO       15710000
157200                 ELSE                                             15720000
157300                     SET PS-VALID-INPUT           TO TRUE         15730000
157400                     MOVE DP010I-NUMERIC-FIELD    TO              15740000
157500                                           PV-ADJ-ENTERED-QUANTITY15750000
157600                     MOVE PV-ADJ-ENTERED-QUANTITY TO              15760000
157700                                                 PC033-ADJ-AFT-QTY15770000
157800                 END-IF                                           15780000
157900             ELSE                                                 15790000
158000                 SET PS-VALID-INPUT          TO TRUE              15800000
158100                 MOVE DP010I-NUMERIC-FIELD   TO                   15810000
158200                                           PV-ADJ-ENTERED-QUANTITY15820000
158300                 MOVE PV-ADJ-ENTERED-QUANTITY TO PC033-ADJ-AFT-QTY15830000
158400             END-IF                                               15840000
158500         END-IF                                                   15850000
158600     END-IF.                                                      15860000
158700*                                                                 15870000
158800 2241-GET-LIMIT-QTY.                                              15880000
158900     EXEC SQL                                                     15890000
159000         SELECT FUNC_QTY                                          15900000
159100         INTO :KRPRPM-FUNC-QTY                                    15910000
159200         FROM TKRPRPM                                             15920000
159300         WHERE                                                    15930000
159400                 SYS_PRC_FUNC_CDE     = 'CAMAXQ'                  15940000
159500             AND LOC_ID               = 90                        15950000
159600             AND INTFC_SYS_CDE        = 'KHL'                     15960000
159700             AND FUNC_PRC_STAT_CDE    = 'AC'                      15970000
159800     END-EXEC.                                                    15980000
159900                                                                  15990000
160000     EVALUATE TRUE                                                16000000
160100         WHEN SQLCODE = ZERO                                      16010000
160200             CONTINUE                                             16020000
160300         WHEN SQLCODE = +100                                      16030000
160400             MOVE 49  TO  KRPRPM-FUNC-QTY                         16040000
160500         WHEN SQLCODE = -904                                      16050000
160600         WHEN SQLCODE = -913                                      16060000
160700         WHEN SQLCODE = -911                                      16070000
160800             MOVE 120                 TO PV-ERROR-NBR             16080000
160900             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         16090000
161000             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      16100000
161100             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 16110000
161200             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  16120000
161300             PERFORM 9903-WRITE-CICS-LOG                          16130000
161400             PERFORM 9000-SOFT-ABORT                              16140000
161500         WHEN SQLWARN0 NOT = SPACES                               16150000
161600         WHEN SQLCODE < +0                                        16160000
161700         WHEN SQLCODE > +0                                        16170000
161800             MOVE 121                 TO PV-ERROR-NBR             16180000
161900                                         PC033-ERROR-NBR          16190000
162000             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         16200000
162100             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      16210000
162200             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 16220000
162300             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  16230000
162400             PERFORM 9903-WRITE-CICS-LOG                          16240000
162500             MOVE '2241-GET-LIMIT-QTY'   TO PC033-PARAGRAPH       16250000
162600             MOVE 'PCKRF863 - ERROR SELECTING PARM'               16260000
162700                                      TO PC033-MESSAGE-TEXT(1)    16270000
162800             MOVE SQLCA               TO PC033-SQLCA              16280000
162900             MOVE 'TKRPRPM'           TO PC033-DB2-TABLE-NAME(1)  16290000
163000             SET PC033-ABEND          TO TRUE                     16300000
163100             MOVE 99                  TO PC033-PGM-MSG-NBR        16310000
163200             PERFORM 8210-XCTL-ERROR-SCREEN                       16320000
163300     END-EVALUATE.                                                16330000
163400*                                                                 16340000
163410 2245-CHECK-IF-DC-LOC.                                            16341001
163493     EXEC SQL                                                     16349302
163494         SELECT  LOC_NM                                           16349402
163495               , LOC_TYP_CDE                                      16349502
163496           INTO :XLT00010-LOC-NM                                  16349602
163497               ,:XLT00010-LOC-TYP-CDE                             16349702
163498           FROM  XLT_LOC                                          16349802
163499          WHERE  LOC_NBR       =  :PC033-OPER-UNT-ID              16349903
163500            AND  LOC_TYP_CDE  ^= 'HQ'                             16350006
163501          WITH UR                                                 16350102
163502     END-EXEC.                                                    16350202
163503                                                                  16350301
163506     EVALUATE TRUE                                                16350609
163507         WHEN SQLCODE = ZERO                                      16350709
163508             CONTINUE                                             16350809
163509         WHEN SQLCODE = +100                                      16350909
163510             SET PS-INVALID-INPUT        TO TRUE                  16351009
163511             MOVE DP015-UNP-ALP-BRT-MDT  TO AUPCA                 16351109
163512             MOVE -1                     TO AUPCL                 16351209
163513             MOVE PC033-OPER-UNT-ID      TO PV-OPER-UNT-ID-DISP   16351309
163514             STRING PV-OPER-UNT-ID-DISP-X   DELIMITED BY SIZE     16351409
163515                    ' IS NOT DC LOC'        DELIMITED BY SIZE     16351509
163516                                       INTO AMSGLNO               16351609
163523         WHEN SQLWARN0 NOT = SPACES                               16352301
163524         WHEN SQLCODE < +0                                        16352401
163525         WHEN SQLCODE > +0                                        16352501
163526             MOVE 122                 TO PV-ERROR-NBR             16352609
163527                                         PC033-ERROR-NBR          16352701
163528             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         16352801
163529             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      16352901
163530             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 16353001
163531             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  16353101
163532             PERFORM 9903-WRITE-CICS-LOG                          16353201
163533             MOVE '2245-CHECK-IF-DC-LOC' TO PC033-PARAGRAPH       16353302
163534             MOVE 'PCKRF863 - ERROR CHECKING IF DC LOCATION'      16353402
163535                                      TO PC033-MESSAGE-TEXT(1)    16353501
163536             MOVE SQLCA               TO PC033-SQLCA              16353601
163537             MOVE 'XLT_LOC'           TO PC033-DB2-TABLE-NAME(1)  16353702
163538             SET PC033-ABEND          TO TRUE                     16353801
163539             MOVE 99                  TO PC033-PGM-MSG-NBR        16353901
163540             PERFORM 8210-XCTL-ERROR-SCREEN                       16354001
163541     END-EVALUATE.                                                16354101
163542*                                                                 16354201
163550 2250-SELECT-CART-UPC.                                            16355001
163600                                                                  16360000
163700*****   DETERMINE IF PO/RCVR/LINE IS VERIFIED. *******            16370000
163800     MOVE SPACE TO PS-PO-VERIFIED-SW.                             16380000
163900     PERFORM 3000-CHECK-PO-VRFD.                                  16390000
164000                                                                  16400000
164100*****   DETERMINE IF PO/RCVR IS AUTO VERIFYING ******             16410000
164200     MOVE SPACE TO PS-PO-AUTOVE-SW.                               16420000
164300     PERFORM 3200-CHECK-PO-AUTOVE.                                16430000
164400                                                                  16440000
164500     MOVE PV-ADJ-ENTERED-QUANTITY TO PV-ADJ-ENTERED-QTY-N.        16450000
164600                                                                  16460000
164700     COMPUTE PV-ADJ-BY-QTY =                                      16470000
164800             PV-UNTS-IN-SKU - PV-ADJ-ENTERED-QTY-N.               16480000
164900                                                                  16490000
165000     IF PC033-MASTER-CARTON > ZEROS                               16500000
165100        MOVE PC033-MASTER-CARTON TO DK-SHIPT-UNT-ID               16510000
165200     ELSE                                                         16520000
165300        MOVE PC033-CARTON        TO DK-SHIPT-UNT-ID               16530000
165400     END-IF                                                       16540000
165500                                                                  16550000
165600     MOVE PC033-RCVR-SEQ-NBR-CTN TO DK-RCVR-SEQ-NBR.              16560000
165700                                                                  16570000
165800     INITIALIZE DCLSUT00028.                                      16580000
165900     EXEC SQL                                                     16590000
166000         SELECT SHPD_UNT_QTY                                      16600000
166100         INTO   :SUT00028-SHPD-UNT-QTY                            16610000
166200         FROM   SUT_OTBND_UPC A                                   16620000
166300         WHERE  UPC_NBR            = :DK-UPC-NBR                  16630000
166400           AND  SHIPT_UNT_ID       = :DK-SHIPT-UNT-ID             16640000
166500           AND  A.TRN_NBR          = :PC033-PO-NBR                16650000
166600           AND  A.RCVR_SEQ_NBR     = :DK-RCVR-SEQ-NBR             16660000
166700           AND  A.TRN_LNE_NBR      = :PC033-PO-LINE-NBR           16670000
166800     END-EXEC.                                                    16680000
166900     EVALUATE TRUE                                                16690000
167000         WHEN SQLCODE = ZERO                                      16700000
167100             MOVE SUT00028-SHPD-UNT-QTY  TO PV-BEFORE-UPC-QTY     16710000
167200             PERFORM 2260-CALC-QUANTITY                           16720000
167300         WHEN SQLCODE = +100                                      16730000
167400             MOVE PV-ADJ-BY-QTY TO PV-REMAINDER                   16740000
167500             PERFORM 2261-GET-NEXT-UPC                            16750000
167600         WHEN SQLWARN0 NOT = SPACES                               16760000
167700         WHEN SQLCODE NOT EQUAL ZERO                              16770000
167800             MOVE 5                   TO PV-ERROR-NBR             16780000
167900                                         PC033-ERROR-NBR          16790000
168000             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         16800000
168100             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      16810000
168200             MOVE PC033-RCVR-SEQ-NBR-CTN TO PV-ERROR-RCVR-SEQ-NBR 16820000
168300             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  16830000
168400             PERFORM 9903-WRITE-CICS-LOG                          16840000
168500                                                                  16850000
168600             MOVE '2250-SELECT-CART-UPC' TO PC033-PARAGRAPH       16860000
168700             MOVE 'PCKRF863 '            TO PC033-MESSAGE-TEXT(1) 16870000
168800             MOVE DK-SHIPT-UNT-ID        TO PC033-MESSAGE-TEXT(2) 16880000
168900             MOVE SQLCA               TO PC033-SQLCA              16890000
169000             MOVE 'SUT_OTBND_UPC'     TO PC033-DB2-TABLE-NAME(1)  16900000
169100             SET PC033-ABEND          TO TRUE                     16910000
169200             MOVE 99                  TO PC033-PGM-MSG-NBR        16920000
169300             PERFORM 8210-XCTL-ERROR-SCREEN                       16930000
169400     END-EVALUATE.                                                16940000
169500*                                                                 16950000
169600*---------------------------------------------------------------- 16960000
169700 2260-CALC-QUANTITY.                                              16970000
169800     EVALUATE TRUE                                                16980000
169900        WHEN SUT00028-SHPD-UNT-QTY < PV-ADJ-ENTERED-QTY-N         16990000
170000                    AND PC033-DAMAGED-UNITS                       17000000
170100             MOVE PC-0  TO DK-ADJ-TO-QTY                          17010000
170200             SET PS-NO-REMAINDER TO TRUE                          17020000
170300             MOVE PC-DMG-EXCED-UPC-QTY-MSG TO AMSGLNO             17030000
170400             PERFORM 8100-SEND-DATA-ONLY                          17040000
170500             PERFORM 8200-RETURN-TRANID                           17050000
170600                                                                  17060000
170700        WHEN SUT00028-SHPD-UNT-QTY > PV-ADJ-BY-QTY                17070000
170800             COMPUTE PV-ADJ-TO-QTY =                              17080000
170900                     SUT00028-SHPD-UNT-QTY - PV-ADJ-BY-QTY        17090000
171000             MOVE PV-ADJ-TO-QTY  TO DK-ADJ-TO-QTY                 17100000
171100             SET PS-NO-REMAINDER TO TRUE                          17110000
171200                                                                  17120000
171300        WHEN SUT00028-SHPD-UNT-QTY = PV-ADJ-BY-QTY                17130000
171400             COMPUTE PV-ADJ-TO-QTY =                              17140000
171500                     SUT00028-SHPD-UNT-QTY - PV-ADJ-BY-QTY        17150000
171600             MOVE PC-0  TO DK-ADJ-TO-QTY                          17160000
171700             SET PS-NO-REMAINDER TO TRUE                          17170000
171800                                                                  17180000
171900*FIRST TAKE ALL OF ORIG UPC QTY.  THEN GET NEXT UPC.              17190000
172000        WHEN SUT00028-SHPD-UNT-QTY < PV-ADJ-BY-QTY                17200000
172100             AND SUT00028-SHPD-UNT-QTY > 0                        17210000
172200             MOVE PC-0  TO DK-ADJ-TO-QTY                          17220000
172300*UPDATE ORIG UPC QTY                                              17230000
172400             PERFORM 7100-UPDATE-CART-UPC                         17240000
172500             MOVE SUT00028-SHPD-UNT-QTY TO PV-ADJ-BEF-QTY         17250000
172600             IF PC033-DAMAGED-UNITS                               17260000
172700                 MOVE 'PCKR863D' TO SU035-PRC-RSN-CDE             17270000
172800             ELSE                                                 17280000
172900                 MOVE 'PCKRF863' TO SU035-PRC-RSN-CDE             17290000
173000             END-IF                                               17300000
173100             PERFORM 7000-INSERT-TSUQADJ                          17310000
173200             PERFORM 7200-CHECK-FOR-DMG-CART                      17320000
173300             SET PS-BACKOUT-NEEDED   TO TRUE                      17330000
173400             IF PS-DO-UNIT-ADJ-YES AND PS-TSUQADJ-INSERTED        17340000
173500                 PERFORM 2260C-BUILD-UNIT-ADJ-COMMAREA            17350000
173600                 IF PC033-DAMAGED-UNITS                           17360000
173700                     MOVE 'PCKR863D' TO SU035-PRC-RSN-CDE         17370000
173800                                        SU035-PROGRAM-NAME        17380000
173900                 ELSE                                             17390000
174000                     MOVE 'PCKRF863' TO SU035-PRC-RSN-CDE         17400000
174100                                        SU035-PROGRAM-NAME        17410000
174200                 END-IF                                           17420000
174300                 SET PS-NO-ODD-UNITS-LINE-ADJ TO TRUE             17430000
174400                 IF PS-PO-AUTOVE-YES                              17440000
174500                     IF PS-PO-PREPK-NO OR                         17450000
174600                        PS-DAMAGED-YES                            17460000
174700                        IF PS-DAMAGED-YES                         17470000
174800                            SET PS-ODD-UNITS-LINE-ADJ  TO TRUE    17480000
174900                            MOVE PV-ADJ-BEF-QTY  TO               17490000
175000                                         SU035-BEFORE-QTY         17500000
175100                                         PV-BEFORE-ODD-UNT-QTY    17510000
175200                            MOVE PC033-ADJ-AFT-QTY TO             17520000
175300                                         SU035-AFTER-QTY          17530000
175400                                         PV-AFTER-ODD-UNT-QTY     17540000
175500                        END-IF                                    17550000
175600                        IF PS-PO-VERIFIED-YES                     17560000
175700                            PERFORM 8500-LINK-SUKUT702            17570000
175800                        ELSE                                      17580000
175900                            SET SU035-LOG-ONLY  TO  TRUE          17590000
176000                            PERFORM 8500-LINK-SUKUT702            17600000
176100                        END-IF                                    17610000
176200                     ELSE                                         17620000
176300                        PERFORM 5100-BEST-CASE-SCENARIO           17630000
176400                     END-IF                                       17640000
176500                 ELSE                                             17650000
176600                     IF PS-PO-PREPK-YES                           17660000
176700                         PERFORM 5100-BEST-CASE-SCENARIO          17670000
176800                     ELSE                                         17680000
176900                         PERFORM 8500-LINK-SUKUT702               17690000
177000                     END-IF                                       17700000
177100                 END-IF                                           17710000
177200                 IF SU035-UPDATE-ERROR OR SU035-NO-CHANGE         17720000
177300                     CONTINUE                                     17730000
177400                 ELSE                                             17740000
177500                     IF PC033-DAMAGED-UNITS                       17750000
177600                         PERFORM 6500-CHECK-VIRTUAL-CRTN          17760000
177700                     END-IF                                       17770000
177800                 END-IF                                           17780000
177900             END-IF                                               17790000
178000             SET PS-REMAINDER TO TRUE                             17800000
178100             COMPUTE PV-REMAINDER  =                              17810000
178200                     PV-ADJ-BY-QTY - SUT00028-SHPD-UNT-QTY        17820000
178300                                                                  17830000
178400        WHEN SUT00028-SHPD-UNT-QTY = 0                            17840000
178500           MOVE PV-ADJ-BY-QTY  TO PV-REMAINDER                    17850000
178600           PERFORM 2261-GET-NEXT-UPC                              17860000
178700                                                                  17870000
178800     END-EVALUATE.                                                17880000
178900                                                                  17890000
179000     IF PS-NO-REMAINDER                                           17900000
179100         IF PS-DAMAGED-YES AND PV-ADJ-BY-QTY NEGATIVE             17910000
179200             SET PS-INVALID-INPUT        TO TRUE                  17920000
179300             MOVE DP015-UNP-ALP-BRT-MDT  TO AUPCA                 17930000
179400             MOVE -1                     TO AUPCL                 17940000
179500             MOVE PC-UNT-CNT-BE-ADD-DMG  TO AMSGLNO               17950000
179600             PERFORM 8100-SEND-DATA-ONLY                          17960000
179700             PERFORM 8200-RETURN-TRANID                           17970000
179800         ELSE                                                     17980000
179900             IF SUT00028-UPC-NBR > 0                              17990000
180000                 MOVE SUT00028-UPC-NBR   TO DK-UPC-NBR            18000000
180100             END-IF                                               18010000
180200             PERFORM 7100-UPDATE-CART-UPC                         18020000
180300             MOVE SUT00028-SHPD-UNT-QTY TO PV-ADJ-BEF-QTY         18030000
180400             IF PC033-DAMAGED-UNITS                               18040000
180500                 MOVE 'PCKR863D' TO SU035-PRC-RSN-CDE             18050000
180600             ELSE                                                 18060000
180700                 MOVE 'PCKRF863' TO SU035-PRC-RSN-CDE             18070000
180800             END-IF                                               18080000
180900             PERFORM 7000-INSERT-TSUQADJ                          18090000
181000             PERFORM 7200-CHECK-FOR-DMG-CART                      18100000
181100             SET PS-BACKOUT-NEEDED   TO TRUE                      18110000
181200             IF PS-DO-UNIT-ADJ-YES AND PS-TSUQADJ-INSERTED        18120000
181300                 PERFORM 2260C-BUILD-UNIT-ADJ-COMMAREA            18130000
181400                 IF PC033-DAMAGED-UNITS                           18140000
181500                     MOVE 'PCKR863D' TO SU035-PRC-RSN-CDE         18150000
181600                                        SU035-PROGRAM-NAME        18160000
181700                 ELSE                                             18170000
181800                     MOVE 'PCKRF863' TO SU035-PRC-RSN-CDE         18180000
181900                                        SU035-PROGRAM-NAME        18190000
182000                 END-IF                                           18200000
182100                 SET PS-NO-ODD-UNITS-LINE-ADJ TO TRUE             18210000
182200                 IF PS-PO-AUTOVE-YES                              18220000
182300                     IF PS-PO-PREPK-NO OR                         18230000
182400                        PS-DAMAGED-YES                            18240000
182500                        IF PS-DAMAGED-YES                         18250000
182600                            SET PS-ODD-UNITS-LINE-ADJ  TO TRUE    18260000
182700                            MOVE PV-ADJ-BEF-QTY  TO               18270000
182800                                         SU035-BEFORE-QTY         18280000
182900                                         PV-BEFORE-ODD-UNT-QTY    18290000
183000                            MOVE PC033-ADJ-AFT-QTY TO             18300000
183100                                         SU035-AFTER-QTY          18310000
183200                                         PV-AFTER-ODD-UNT-QTY     18320000
183300                        END-IF                                    18330000
183400                        IF PS-PO-VERIFIED-YES                     18340000
183500                            PERFORM 8500-LINK-SUKUT702            18350000
183600                        ELSE                                      18360000
183700                            SET SU035-LOG-ONLY  TO  TRUE          18370000
183800                            PERFORM 8500-LINK-SUKUT702            18380000
183900                        END-IF                                    18390000
184000                     ELSE                                         18400000
184100                        PERFORM 5100-BEST-CASE-SCENARIO           18410000
184200                     END-IF                                       18420000
184300                 ELSE                                             18430000
184400                     IF PS-PO-PREPK-YES                           18440000
184500                         PERFORM 5100-BEST-CASE-SCENARIO          18450000
184600                     ELSE                                         18460000
184700                         PERFORM 8500-LINK-SUKUT702               18470000
184800                     END-IF                                       18480000
184900                 END-IF                                           18490000
185000                 IF SU035-UPDATE-ERROR OR SU035-NO-CHANGE         18500000
185100                     CONTINUE                                     18510000
185200                 ELSE                                             18520000
185300                     IF PC033-DAMAGED-UNITS                       18530000
185400                         PERFORM 6500-CHECK-VIRTUAL-CRTN          18540000
185500                     END-IF                                       18550000
185600                 END-IF                                           18560000
185700             END-IF                                               18570000
185800          END-IF                                                  18580000
185900     ELSE                                                         18590000
186000        IF PS-REMAINDER                                           18600000
186100           PERFORM 2261-GET-NEXT-UPC UNTIL PS-NO-REMAINDER        18610000
186200        END-IF                                                    18620000
186300     END-IF.                                                      18630000
186400                                                                  18640000
186500 2260A-RANDOM-NBR.                                                18650000
186600     MOVE ZERO  TO SQLCODE.                                       18660000
186700     PERFORM UNTIL SQLCODE = +100                                 18670000
186800         PERFORM 2260B-CREATE-RANDOM-NBR                          18680000
186900         MOVE DP902-RANDOM-NUMBER TO PV-FINCL-ADJ-ID              18690000
187000         PERFORM 7462-SELECT-TFINADJ                              18700000
187100     END-PERFORM.                                                 18710000
187200                                                                  18720000
187300 2260B-CREATE-RANDOM-NBR.                                         18730000
187400     INITIALIZE DP902-RANDNBR-ROUTINE-FIELDS.                     18740000
187500     CALL PC-RANDOM-NBR-GENERATOR USING                           18750000
187600                            DFHEIBLK                              18760000
187700                            DFHCOMMAREA                           18770000
187800                            DP902-RANDNBR-ROUTINE-FIELDS.         18780000
187900                                                                  18790000
188000     IF DP902-SUCCESSFUL                                          18800000
188100         CONTINUE                                                 18810000
188200     ELSE                                                         18820000
188300         MOVE 41                      TO PV-ERROR-NBR             18830000
188400                                         PC033-ERROR-NBR          18840000
188500         MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER             18850000
188600         MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR          18860000
188700         MOVE PC033-RCVR-SEQ-NBR-CTN TO PV-ERROR-RCVR-SEQ-NBR     18870000
188800         MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR      18880000
188900         PERFORM 9903-WRITE-CICS-LOG                              18890000
189000         MOVE '2210-CHECK-IF-UPC-IN-CTN' TO PC033-PARAGRAPH       18900000
189100         MOVE 'PCKRF863 '             TO PC033-MESSAGE-TEXT(1)    18910000
189200         MOVE 'CALLING DPKUT902'      TO PC033-MESSAGE-TEXT(2)    18920000
189300         MOVE SQLCA                   TO PC033-SQLCA              18930000
189400         MOVE 'DPKUT902     '         TO PC033-DB2-TABLE-NAME(1)  18940000
189500         MOVE 'RANDOM NBR   '         TO PC033-DB2-TABLE-NAME(2)  18950000
189600         MOVE 'GENERATOR     '        TO PC033-DB2-TABLE-NAME(3)  18960000
189700         SET PC033-ABEND              TO TRUE                     18970000
189800         MOVE 99                      TO PC033-PGM-MSG-NBR        18980000
189900         PERFORM 8210-XCTL-ERROR-SCREEN                           18990000
190000     END-IF.                                                      19000000
190100                                                                  19010000
190200 2260C-BUILD-UNIT-ADJ-COMMAREA.                                   19020000
190300                                                                  19030000
190400     INITIALIZE SU035-COMM-AREA.                                  19040000
190500                                                                  19050000
190600     MOVE PV-FINCL-ADJ-ID         TO SU035-FINCL-ADJ-ID.          19060000
190700     MOVE DK-SHIPT-UNT-ID         TO SU035-SHIPT-UNT-ID.          19070000
190800     MOVE PC033-UPC-NBR           TO SU035-UPC-NBR.               19080000
190900     MOVE PC033-OPER-UNT-ID       TO SU035-ORIG-OPER-UNT-ID       19090000
191000                                                                  19100000
191100     COMPUTE SU035-ADJUST-QTY =                                   19110000
191200                       PV-ADJ-TO-QTY  -  PV-ADJ-BEF-QTY           19120000
191300     END-COMPUTE.                                                 19130000
191400                                                                  19140000
191500     MOVE PC033-USER-ID           TO SU035-CREATE-USER-ID.        19150000
191600     MOVE PC033-PO-NBR            TO SU035-PO.                    19160000
191700     IF DK-RCVR-SEQ-NBR  > ZEROES                                 19170000
191800         MOVE DK-RCVR-SEQ-NBR     TO SU035-REC-SEQ-NBR            19180000
191900     ELSE                                                         19190000
192000         MOVE PKSLIP-REC-SEQ-NBR  TO SU035-REC-SEQ-NBR            19200000
192100     END-IF.                                                      19210000
192200     MOVE PC033-PO-LINE-NBR       TO SU035-PO-LNE-NBR.            19220000
192300     MOVE PC033-STR-NBR           TO SU035-DEST-LOC-NBR.          19230000
192400     MOVE 'N'                     TO SU035-CASEPACK-DELETE-IND.   19240000
192500     MOVE 'Y'                     TO SU035-UPDATE-UNTS-WORKED-IND.19250000
192600     MOVE  SPACES                 TO SU035-CART-CREATE-SRC.       19260000
192700     MOVE  SPACES                 TO SU035-SUCCESS-IND.           19270000
192800     MOVE 'Y'                     TO SU035-UPDATE-DISTDT-IND.     19280000
192900     MOVE ZERO                    TO SU035-CYC-ADJ-NBR.           19290000
193000     MOVE ZEROES                  TO SU035-ADJ-AUDIT-CNTL-NBR.    19300000
193100                                                                  19310000
193200 2261-GET-NEXT-UPC.                                               19320000
193300*SINCE THERE IS A REMAINDER, NEED TO GET THE NEXT UPC AND         19330000
193400*TAKE THE REMAINING UNITS FROM THAT QTY                           19340000
193500                                                                  19350000
193600     PERFORM 7500-OPEN-NEXT-UPC-CSR                               19360000
193700     PERFORM 7510-FETCH-NEXT-UPC-CSR                              19370000
193800     PERFORM UNTIL PS-END-OF-CURSOR OR PS-NO-REMAINDER            19380000
193900         PERFORM 2280-GET-SHPD-UNT-QTY                            19390000
194000         COMPUTE DK-ADJ-TO-QTY =                                  19400000
194100             SUT00028-SHPD-UNT-QTY - PV-REMAINDER                 19410000
194200         MOVE SUT00028-UPC-NBR   TO DK-UPC-NBR                    19420000
194300         PERFORM 7100-UPDATE-CART-UPC                             19430000
194400         MOVE SUT00028-SHPD-UNT-QTY TO PV-ADJ-BEF-QTY             19440000
194500         IF PC033-DAMAGED-UNITS                                   19450000
194600             MOVE 'PCKR863D' TO SU035-PRC-RSN-CDE                 19460000
194700         ELSE                                                     19470000
194800             MOVE 'PCKRF863' TO SU035-PRC-RSN-CDE                 19480000
194900         END-IF                                                   19490000
195000         PERFORM 7000-INSERT-TSUQADJ                              19500000
195100         SET PS-BACKOUT-NEEDED   TO TRUE                          19510000
195200         IF PS-DO-UNIT-ADJ-YES AND PS-TSUQADJ-INSERTED            19520000
195300             PERFORM 2260C-BUILD-UNIT-ADJ-COMMAREA                19530000
195400             IF PC033-DAMAGED-UNITS                               19540000
195500                 MOVE 'PCKR863D' TO SU035-PRC-RSN-CDE             19550000
195600                                    SU035-PROGRAM-NAME            19560000
195700             ELSE                                                 19570000
195800                 MOVE 'PCKRF863' TO SU035-PRC-RSN-CDE             19580000
195900                                    SU035-PROGRAM-NAME            19590000
196000             END-IF                                               19600000
196100             SET PS-NO-ODD-UNITS-LINE-ADJ TO TRUE                 19610000
196200             IF PS-PO-AUTOVE-YES                                  19620000
196300                 IF PS-PO-PREPK-NO OR                             19630000
196400                    PS-DAMAGED-YES                                19640000
196500                    IF PS-DAMAGED-YES                             19650000
196600                        SET PS-ODD-UNITS-LINE-ADJ  TO TRUE        19660000
196700                        MOVE PV-ADJ-BEF-QTY  TO                   19670000
196800                                         SU035-BEFORE-QTY         19680000
196900                                         PV-BEFORE-ODD-UNT-QTY    19690000
197000                        MOVE DK-ADJ-TO-QTY  TO                    19700000
197100                                         SU035-AFTER-QTY          19710000
197200                                         PV-AFTER-ODD-UNT-QTY     19720000
197300                    END-IF                                        19730000
197400                    IF PS-PO-VERIFIED-YES                         19740000
197500                        PERFORM 8500-LINK-SUKUT702                19750000
197600                    ELSE                                          19760000
197700                        SET SU035-LOG-ONLY  TO  TRUE              19770000
197800                        PERFORM 8500-LINK-SUKUT702                19780000
197900                    END-IF                                        19790000
198000                 ELSE                                             19800000
198100                    PERFORM 5100-BEST-CASE-SCENARIO               19810000
198200                 END-IF                                           19820000
198300             ELSE                                                 19830000
198400                 IF PS-PO-PREPK-YES                               19840000
198500                     PERFORM 5100-BEST-CASE-SCENARIO              19850000
198600                 ELSE                                             19860000
198700                     PERFORM 8500-LINK-SUKUT702                   19870000
198800                 END-IF                                           19880000
198900             END-IF                                               19890000
199000             IF SU035-UPDATE-ERROR OR SU035-NO-CHANGE             19900000
199100                 CONTINUE                                         19910000
199200             ELSE                                                 19920000
199300                 IF PC033-DAMAGED-UNITS                           19930000
199400                     PERFORM 6500-CHECK-VIRTUAL-CRTN              19940000
199500                 END-IF                                           19950000
199600             END-IF                                               19960000
199700         END-IF                                                   19970000
199800         PERFORM 7510-FETCH-NEXT-UPC-CSR                          19980000
199900     END-PERFORM.                                                 19990000
200000                                                                  20000000
200100     PERFORM 7520-CLOSE-NEXT-UPC-CSR.                             20010000
200200                                                                  20020000
200300 2265-GET-SKU.                                                    20030000
200400                                                                  20040000
200500     INITIALIZE XL001-ITEM-COMMAREA                               20050000
200600     SET XL001-SELECT-SKU                                         20060000
200700         XL001-SELECT-UPC                                         20070000
200800         XL001-BY-UPC-NBR        TO TRUE.                         20080000
200900                                                                  20090000
201000     MOVE PC033-UPC-NBR          TO XL001-KEY-UPC-NBR.            20100000
201100                                                                  20110000
201200     PERFORM 8600-CALL-XLKUT001.                                  20120000
201300                                                                  20130000
201400     EVALUATE TRUE                                                20140000
201500         WHEN XL001-UPC-NOT-FOUND                                 20150000
201600             SET PS-INVALID-INPUT        TO TRUE                  20160000
201700             MOVE DP015-UNP-ALP-BRT-MDT  TO AUPCA                 20170000
201800             MOVE -1                     TO AUPCL                 20180000
201900             MOVE PC-NOT-A-KOHLS-UPC     TO AMSGLNO               20190000
202000         WHEN XL001-SKU-NOT-FOUND                                 20200000
202100             SET PS-INVALID-INPUT        TO TRUE                  20210000
202200             MOVE DP015-UNP-ALP-BRT-MDT  TO ASKUA                 20220000
202300             MOVE -1                     TO ASKUL                 20230000
202400             MOVE PC-NOT-A-KOHLS-SKU     TO AMSGLNO               20240000
202500         WHEN XL001-SKU-SQLCODE = ZERO                            20250000
202600         WHEN XL001-SKU-SQLCODE = -811                            20260000
202700             MOVE XL001-SKU-NBR       TO PC033-SKU-NBR-N          20270000
202800                                         DK-SKU-NBR               20280000
202900             MOVE XL001-INTR-UPC-ID   TO PC033-INTR-UPC-ID        20290000
203000             MOVE XL001-ITM-NBR       TO PC033-ITM-NBR            20300000
203100         WHEN OTHER                                               20310000
203200             MOVE 6                   TO PV-ERROR-NBR             20320000
203300                                         PC033-ERROR-NBR          20330000
203400             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         20340000
203500             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      20350000
203600             MOVE PC033-RCVR-SEQ-NBR-CTN TO PV-ERROR-RCVR-SEQ-NBR 20360000
203700             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  20370000
203800             PERFORM 9903-WRITE-CICS-LOG                          20380000
203900                                                                  20390000
204000             MOVE '2265-GET-SKU'      TO PC033-PARAGRAPH          20400000
204100             MOVE 'PCKRF863 '         TO PC033-MESSAGE-TEXT(1)    20410000
204200             MOVE 'XLKUT001'          TO PC033-MESSAGE-TEXT(2)    20420000
204300             MOVE SQLCA               TO PC033-SQLCA              20430000
204400             SET PC033-ABEND          TO TRUE                     20440000
204500             MOVE 99                  TO PC033-PGM-MSG-NBR        20450000
204600             PERFORM 8210-XCTL-ERROR-SCREEN                       20460000
204700     END-EVALUATE.                                                20470000
204800                                                                  20480000
204900 2266-GET-UPC.                                                    20490000
205000                                                                  20500000
205100     INITIALIZE XL001-ITEM-COMMAREA                               20510000
205200     SET XL001-SELECT-UPC                                         20520000
205300         XL001-BY-UPC-NBR        TO TRUE                          20530000
205400                                                                  20540000
205500     MOVE PC033-UPC-NBR          TO XL001-KEY-UPC-NBR.            20550000
205600                                                                  20560000
205700     PERFORM 8600-CALL-XLKUT001.                                  20570000
205800                                                                  20580000
205900     EVALUATE TRUE                                                20590000
206000         WHEN XL001-SKU-SQLCODE = ZERO                            20600000
206100         WHEN XL001-SKU-SQLCODE = -811                            20610000
206200         WHEN XL001-SKU-SQLCODE = +100                            20620000
206300             MOVE XL001-INTR-UPC-ID   TO PC033-INTR-UPC-ID        20630000
206400             MOVE XL001-ITM-NBR       TO PC033-ITM-NBR            20640000
206500         WHEN OTHER                                               20650000
206600             MOVE 44                  TO PV-ERROR-NBR             20660000
206700                                         PC033-ERROR-NBR          20670000
206800             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         20680000
206900             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      20690000
207000             MOVE PC033-RCVR-SEQ-NBR-CTN TO PV-ERROR-RCVR-SEQ-NBR 20700000
207100             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  20710000
207200             PERFORM 9903-WRITE-CICS-LOG                          20720000
207300                                                                  20730000
207400             MOVE '2266-GET-UPC'      TO PC033-PARAGRAPH          20740000
207500             MOVE 'PCKRF863 '         TO PC033-MESSAGE-TEXT(1)    20750000
207600             MOVE 'XLKUT001'          TO PC033-MESSAGE-TEXT(2)    20760000
207700             MOVE SQLCA               TO PC033-SQLCA              20770000
207800             SET PC033-ABEND          TO TRUE                     20780000
207900             MOVE 99                  TO PC033-PGM-MSG-NBR        20790000
208000             PERFORM 8210-XCTL-ERROR-SCREEN                       20800000
208100     END-EVALUATE.                                                20810000
208200                                                                  20820000
208300 2270-GET-TOTAL-UNTS-IN-CTN.                                      20830000
208400     MOVE PC033-RCVR-SEQ-NBR-CTN TO DK-RCVR-SEQ-NBR.              20840000
208500     INITIALIZE PV-TOT-UNTS-IN-CTN                                20850000
208600                PV-NULL-IND-3.                                    20860000
208700     EXEC SQL                                                     20870000
208800         SELECT SUM(A.SHPD_UNT_QTY)                               20880000
208900         INTO   :PV-TOT-UNTS-IN-CTN :PV-NULL-IND-3                20890000
209000         FROM   SUT_OTBND_UPC A                                   20900000
209100         WHERE  A.SHIPT_UNT_ID     = :DK-SHIPT-UNT-ID             20910000
209200           AND  A.TRN_NBR          = :PC033-PO-NBR                20920000
209300           AND  A.RCVR_SEQ_NBR     = :DK-RCVR-SEQ-NBR             20930000
209400     END-EXEC.                                                    20940000
209500                                                                  20950000
209600     EVALUATE TRUE                                                20960000
209700         WHEN SQLCODE = ZERO                                      20970000
209800             IF PV-NULL-IND-3 < 0                                 20980000
209900                 MOVE ZEROES TO PV-TOT-UNTS-IN-CTN                20990000
210000             END-IF                                               21000000
210100         WHEN SQLWARN0 NOT = SPACES                               21010000
210200         WHEN SQLCODE NOT EQUAL ZERO                              21020000
210300             MOVE 7                   TO PV-ERROR-NBR             21030000
210400                                         PC033-ERROR-NBR          21040000
210500             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         21050000
210600             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      21060000
210700             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 21070000
210800             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  21080000
210900             PERFORM 9903-WRITE-CICS-LOG                          21090000
211000             MOVE '2270-GET-TOTAL-UNTS-IN-CTN' TO PC033-PARAGRAPH 21100000
211100             MOVE 'PCKRF863 - GET TOTAL UNITS IN CTN'             21110000
211200                                      TO PC033-MESSAGE-TEXT(1)    21120000
211300             MOVE DK-SHIPT-UNT-ID     TO PC033-MESSAGE-TEXT(2)    21130000
211400             MOVE SQLCA               TO PC033-SQLCA              21140000
211500             MOVE 'SUT_OTBND_UPC'     TO PC033-DB2-TABLE-NAME(1)  21150000
211600             SET PC033-ABEND          TO TRUE                     21160000
211700             MOVE 99                  TO PC033-PGM-MSG-NBR        21170000
211800             PERFORM 8210-XCTL-ERROR-SCREEN                       21180000
211900     END-EVALUATE.                                                21190000
212000*                                                                 21200000
212100*                                                                 21210000
212200 2280-GET-SHPD-UNT-QTY.                                           21220000
212300     MOVE PC033-RCVR-SEQ-NBR-CTN TO DK-RCVR-SEQ-NBR.              21230000
212400     EXEC SQL                                                     21240000
212500         SELECT SHPD_UNT_QTY                                      21250000
212600         INTO   :SUT00028-SHPD-UNT-QTY                            21260000
212700         FROM   SUT_OTBND_UPC A                                   21270000
212800         WHERE  UPC_NBR        = :SUT00028-UPC-NBR                21280000
212900           AND  SHIPT_UNT_ID   = :DK-SHIPT-UNT-ID                 21290000
213000           AND  A.TRN_NBR          = :PC033-PO-NBR                21300000
213100           AND  A.RCVR_SEQ_NBR     = :DK-RCVR-SEQ-NBR             21310000
213200           AND  A.TRN_LNE_NBR      = :PC033-PO-LINE-NBR           21320000
213300     END-EXEC.                                                    21330000
213400     EVALUATE TRUE                                                21340000
213500         WHEN SQLCODE = ZERO                                      21350000
213600             CONTINUE                                             21360000
213700         WHEN SQLCODE = +100                                      21370000
213800             CONTINUE                                             21380000
213900         WHEN SQLWARN0 NOT = SPACES                               21390000
214000         WHEN SQLCODE NOT EQUAL ZERO                              21400000
214100             MOVE 8                   TO PV-ERROR-NBR             21410000
214200                                         PC033-ERROR-NBR          21420000
214300             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         21430000
214400             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      21440000
214500             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 21450000
214600             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  21460000
214700             PERFORM 9903-WRITE-CICS-LOG                          21470000
214800             MOVE '2280-GET-SHPD-UNT-QTY' TO PC033-PARAGRAPH      21480000
214900             MOVE 'PCKRF863 '         TO PC033-MESSAGE-TEXT(1)    21490000
215000             MOVE DK-SHIPT-UNT-ID     TO PC033-MESSAGE-TEXT(2)    21500000
215100             MOVE SQLCA               TO PC033-SQLCA              21510000
215200             MOVE 'SUT_OTBND_UPC'     TO PC033-DB2-TABLE-NAME(1)  21520000
215300             SET PC033-ABEND          TO TRUE                     21530000
215400             MOVE 99                  TO PC033-PGM-MSG-NBR        21540000
215500             PERFORM 8210-XCTL-ERROR-SCREEN                       21550000
215600     END-EVALUATE.                                                21560000
215700*                                                                 21570000
215800 2290-SELECT-OUTBOUND-SRC-CDE.                                    21580000
215900     MOVE PC033-RCVR-SEQ-NBR-CTN TO DK-RCVR-SEQ-NBR.              21590000
216000     EXEC SQL                                                     21600000
216100         SELECT CART_SRC_CDE                                      21610000
216200         INTO   :SUT00024-CART-SRC-CDE                            21620000
216300         FROM   SUT_OTBND_CART                                    21630000
216400         WHERE  SHIPT_UNT_ID   = :DK-SHIPT-UNT-ID                 21640000
216500     END-EXEC.                                                    21650000
216600                                                                  21660000
216700     EVALUATE TRUE                                                21670000
216800         WHEN SQLCODE = ZERO                                      21680000
216900             CONTINUE                                             21690000
217000         WHEN SQLWARN0 NOT = SPACES                               21700000
217100         WHEN SQLCODE NOT EQUAL ZERO                              21710000
217200             MOVE 13                  TO PV-ERROR-NBR             21720000
217300                                         PC033-ERROR-NBR          21730000
217400             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         21740000
217500             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      21750000
217600             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 21760000
217700             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  21770000
217800             PERFORM 9903-WRITE-CICS-LOG                          21780000
217900             MOVE '2290-SELECT-OUTBOUND-SRC-CDE'                  21790000
218000                                          TO PC033-PARAGRAPH      21800000
218100             MOVE 'PCKRF863 '         TO PC033-MESSAGE-TEXT(1)    21810000
218200             MOVE DK-SHIPT-UNT-ID     TO PC033-MESSAGE-TEXT(2)    21820000
218300             MOVE SQLCA               TO PC033-SQLCA              21830000
218400             MOVE 'SUT_OTBND_CART'    TO PC033-DB2-TABLE-NAME(1)  21840000
218500             SET PC033-ABEND          TO TRUE                     21850000
218600             MOVE 99                  TO PC033-PGM-MSG-NBR        21860000
218700             PERFORM 8210-XCTL-ERROR-SCREEN                       21870000
218800     END-EVALUATE.                                                21880000
218900*                                                                 21890000
219000 2300-GET-PORCVR-CRTN.                                            21900000
219100*                                                                 21910000
219200     EXEC SQL                                                     21920000
219300         SELECT                                                   21930000
219400             TRN_NBR                                              21940000
219500         ,   RCVR_SEQ_NBR                                         21950000
219600         ,   TRN_LNE_NBR                                          21960000
219700         INTO                                                     21970000
219800             :SUT00028-TRN-NBR                                    21980000
219900         ,   :SUT00028-RCVR-SEQ-NBR                               21990000
220000         ,   :SUT00028-TRN-LNE-NBR                                22000000
220100         FROM  SUT_OTBND_UPC                                      22010000
220200         WHERE  SHIPT_UNT_ID  = :DK-SHIPT-UNT-ID                  22020000
220300     END-EXEC                                                     22030000
220400                                                                  22040000
220500     EVALUATE TRUE                                                22050000
220600         WHEN SQLCODE = ZERO                                      22060000
220700             MOVE SUT00028-TRN-NBR      TO PC033-PO-NBR           22070000
220800             MOVE SUT00028-RCVR-SEQ-NBR TO PC033-RCVR-SEQ-NBR-CTN 22080000
220900                                           DK-RCVR-SEQ-NBR        22090000
221000             MOVE SUT00028-TRN-LNE-NBR  TO PC033-PO-LINE-NBR      22100000
221100         WHEN SQLCODE = -811                                      22110000
221200             IF  PC033-OK-TO-UPDATE-YES OR PC033-MULT-VALUES-YES  22120000
221300                 CONTINUE                                         22130000
221400             ELSE                                                 22140000
221500                 MOVE SUT00028-TRN-NBR      TO PC033-PO-NBR       22150000
221600                 MOVE SUT00028-RCVR-SEQ-NBR TO                    22160000
221700                                           PC033-RCVR-SEQ-NBR-CTN 22170000
221800                                           DK-RCVR-SEQ-NBR        22180000
221900                 MOVE SUT00028-TRN-LNE-NBR  TO PC033-PO-LINE-NBR  22190000
222000             END-IF                                               22200000
222100                                                                  22210000
222200         WHEN SQLCODE = +100                                      22220000
222300             SET PS-INVALID-INPUT   TO TRUE                       22230000
222400         WHEN SQLWARN0 NOT = SPACES                               22240000
222500         WHEN SQLCODE NOT EQUAL ZERO                              22250000
222600             SET PS-INVALID-INPUT        TO TRUE                  22260000
222700             MOVE 1                      TO PV-ERROR-NBR          22270000
222800                                            PC033-ERROR-NBR       22280000
222900             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         22290000
223000             PERFORM 9903-WRITE-CICS-LOG                          22300000
223100             MOVE '2300-GET-PORCVR-CRTN' TO PC033-PARAGRAPH       22310000
223200             MOVE 'PCKRF863 '         TO PC033-MESSAGE-TEXT(1)    22320000
223300             MOVE DK-SHIPT-UNT-ID     TO PC033-MESSAGE-TEXT(2)    22330000
223400             MOVE SQLCA               TO PC033-SQLCA              22340000
223500             MOVE 'SUT_OTBND_UPC'     TO PC033-DB2-TABLE-NAME(1)  22350000
223600             SET PC033-ABEND          TO TRUE                     22360000
223700             MOVE 99                  TO PC033-PGM-MSG-NBR        22370000
223800             PERFORM 8210-XCTL-ERROR-SCREEN                       22380000
223900     END-EVALUATE.                                                22390000
224000                                                                  22400000
224100*                                                                 22410000
224200 2301-GET-RCVR-NBR.                                               22420000
224300*                                                                 22430000
224400     EXEC SQL                                                     22440000
224500         SELECT C.REC_SEQ_NBR                                     22450000
224600         INTO   :PKSLIP-REC-SEQ-NBR                               22460000
224700         FROM   SUT_OTBND_UPC A                                   22470000
224800               ,SUT_OTBND_VND B                                   22480000
224900               ,TPKSLIP       C                                   22490000
225000         WHERE  A.SHIPT_UNT_ID   = :DK-SHIPT-UNT-ID               22500000
225100           AND  A.TRN_NBR        = :PC033-PO-NBR                  22510000
225200           AND  A.TRN_LNE_NBR    = :PC033-PO-LINE-NBR             22520000
225300*          AND  A.UPC_NBR        = :DK-UPC-NBR                    22530000
225400           AND  A.SHIPT_UNT_ID   = B.SHIPT_UNT_ID                 22540000
225500           AND  B.PO_NBR         = C.PO_NBR                       22550000
225600           AND  B.PKSL_SEQ_NBR   = C.SEQ_NBR                      22560000
225700           AND  C.VER_STAT_CDE   = 'A'                            22570000
225800     END-EXEC.                                                    22580000
225900     EVALUATE TRUE                                                22590000
226000         WHEN SQLCODE = ZERO                                      22600000
226100             MOVE PKSLIP-REC-SEQ-NBR TO PC033-RCVR-SEQ-NBR        22610000
226200                                        DK-RCVR-SEQ-NBR           22620000
226300         WHEN OTHER                                               22630000
226400             MOVE ZEROES             TO PC033-RCVR-SEQ-NBR        22640000
226500                                        DK-RCVR-SEQ-NBR           22650000
226600     END-EVALUATE.                                                22660000
226700                                                                  22670000
226800*                                                                 22680000
226900 2310-CHECK-TRECITM.                                              22690000
227000     IF DK-RCVR-SEQ-NBR  > ZEROES                                 22700000
227100         CONTINUE                                                 22710000
227200     ELSE                                                         22720000
227300         MOVE PKSLIP-REC-SEQ-NBR  TO DK-RCVR-SEQ-NBR              22730000
227400     END-IF.                                                      22740000
227500                                                                  22750000
227600     EXEC SQL                                                     22760000
227700         SELECT ORD_LNE_NBR                                       22770000
227800         INTO   :RECITM-ORD-LNE-NBR                               22780000
227900         FROM   TRECITM                                           22790000
228000         WHERE  ORD_NBR          = :PC033-PO-NBR                  22800000
228100           AND  REC_SEQ_NBR      = :DK-RCVR-SEQ-NBR               22810000
228200           AND  ITM_NBR          = :PC033-ITM-NBR                 22820000
228300           AND  VER_STATUS_CDE   = 'A'                            22830000
228400     END-EXEC.                                                    22840000
228500     EVALUATE TRUE                                                22850000
228600         WHEN SQLCODE = ZERO                                      22860000
228700         WHEN SQLCODE = -811                                      22870000
228800             SET PS-ITM-FOUND-ON-PORCVR  TO TRUE                  22880000
228900             MOVE RECITM-ORD-LNE-NBR    TO PC033-PO-LINE-NBR      22890000
229000         WHEN OTHER                                               22900000
229100             SET PS-ITM-NOT-ON-PORCVR    TO TRUE                  22910000
229200             PERFORM 2320-CHECK-ITM-ON-PO                         22920000
229300     END-EVALUATE.                                                22930000
229400                                                                  22940000
229500*                                                                 22950000
229600 2320-CHECK-ITM-ON-PO.                                            22960000
229700     EXEC SQL                                                     22970000
229800         SELECT ORD_LNE_NBR                                       22980000
229900         INTO   :RECITM-ORD-LNE-NBR                               22990000
230000         FROM   TRECITM                                           23000000
230100         WHERE  ORD_NBR          = :PC033-PO-NBR                  23010000
230200           AND  ITM_NBR          = :PC033-ITM-NBR                 23020000
230300           AND  VER_STATUS_CDE   = 'A'                            23030000
230400     END-EXEC.                                                    23040000
230500     EVALUATE TRUE                                                23050000
230600         WHEN SQLCODE = ZERO                                      23060000
230700         WHEN SQLCODE = -811                                      23070000
230800             SET PS-ITM-FOUND-ON-PO  TO TRUE                      23080000
230900             MOVE RECITM-ORD-LNE-NBR TO PC033-PO-LINE-NBR         23090000
231000         WHEN OTHER                                               23100000
231100             SET PS-ITM-NOT-ON-PO    TO TRUE                      23110000
231200     END-EVALUATE.                                                23120000
231300                                                                  23130000
231400*---------------------------------------------------------------- 23140000
231500 3000-CHECK-PO-VRFD.                                              23150000
231600                                                                  23160000
231700     IF DK-RCVR-SEQ-NBR  > ZEROES                                 23170000
231800         CONTINUE                                                 23180000
231900     ELSE                                                         23190000
232000         MOVE PKSLIP-REC-SEQ-NBR  TO DK-RCVR-SEQ-NBR              23200000
232100     END-IF.                                                      23210000
232200                                                                  23220000
232300     EXEC SQL                                                     23230000
232400         SELECT STATUS_CDE                                        23240000
232500               ,PREPK_ID                                          23250000
232600         INTO   :RECITM-STATUS-CDE                                23260000
232700               ,:RECITM-PREPK-ID                                  23270000
232800         FROM   TRECITM                                           23280000
232900         WHERE  ORD_NBR          = :PC033-PO-NBR                  23290000
233000           AND  REC_SEQ_NBR      = :DK-RCVR-SEQ-NBR               23300000
233100           AND  ORD_LNE_NBR      = :PC033-PO-LINE-NBR             23310000
233200     END-EXEC.                                                    23320000
233300     EVALUATE TRUE                                                23330000
233400         WHEN SQLCODE = ZERO                                      23340000
233500             MOVE RECITM-PREPK-ID  TO DK-PACK-ID                  23350000
233600                                      DK-SAVE-PACK-ID             23360000
233700             IF RECITM-STATUS-CDE = 'VE'                          23370000
233800                 SET PS-PO-VERIFIED-YES  TO TRUE                  23380000
233900             ELSE                                                 23390000
234000                 SET PS-PO-VERIFIED-NO   TO TRUE                  23400000
234100             END-IF                                               23410000
234200         WHEN OTHER                                               23420000
234300             SET PS-PO-VERIFIED-NO       TO TRUE                  23430000
234400     END-EVALUATE.                                                23440000
234500                                                                  23450000
234600 3100-CHECK-RCVR-NBR.                                             23460000
234700     EXEC SQL                                                     23470000
234800         SELECT C.REC_SEQ_NBR                                     23480000
234900         INTO   :PKSLIP-REC-SEQ-NBR                               23490000
235000         FROM   SUT_OTBND_UPC A                                   23500000
235100               ,SUT_OTBND_VND B                                   23510000
235200               ,TPKSLIP       C                                   23520000
235300         WHERE  A.SHIPT_UNT_ID   = :DK-SHIPT-UNT-ID               23530000
235400           AND  A.TRN_NBR        = :PC033-PO-NBR                  23540000
235500           AND  A.TRN_LNE_NBR    = :PC033-PO-LINE-NBR             23550000
235600*          AND  A.UPC_NBR        = :DK-UPC-NBR                    23560000
235700           AND  A.SHIPT_UNT_ID   = B.SHIPT_UNT_ID                 23570000
235800           AND  B.PO_NBR         = C.PO_NBR                       23580000
235900           AND  B.PKSL_SEQ_NBR   = C.SEQ_NBR                      23590000
236000           AND  C.VER_STAT_CDE   = 'A'                            23600000
236100     END-EXEC.                                                    23610000
236200     EVALUATE TRUE                                                23620000
236300         WHEN SQLCODE = ZERO                                      23630000
236400             MOVE PKSLIP-REC-SEQ-NBR TO PC033-RCVR-SEQ-NBR        23640000
236500                                        DK-RCVR-SEQ-NBR           23650000
236600         WHEN OTHER                                               23660000
236700             MOVE ZEROES             TO PC033-RCVR-SEQ-NBR        23670000
236800                                        DK-RCVR-SEQ-NBR           23680000
236900     END-EVALUATE.                                                23690000
237000                                                                  23700000
237100 3200-CHECK-PO-AUTOVE.                                            23710000
237200                                                                  23720000
237300     INITIALIZE RC040-FIELDS.                                     23730000
237400     MOVE PC033-OPER-UNT-ID   TO RC040-SIGNON-LOCATION.           23740000
237500     MOVE PC033-PO-NBR        TO RC040-PO-NBR.                    23750000
237600     MOVE DK-RCVR-SEQ-NBR     TO RC040-PO-RCVR.                   23760000
237700     MOVE 'PCKRF863'          TO RC040-CALLING-PROGRAM.           23770000
237800                                                                  23780000
237900     CALL RC040-AUTOVE-CHECK-PGM USING  DFHEIBLK                  23790000
238000                                        RC040-COMMAREA            23800000
238100                                        RC040-FIELDS.             23810000
238200                                                                  23820000
238300     EVALUATE TRUE                                                23830000
238400         WHEN RC040-SUCCESSFUL                                    23840000
238500             MOVE RC040-AUTO-VE-SW     TO PS-PO-AUTOVE-SW         23850000
238600         WHEN OTHER                                               23860000
238700             MOVE 'N'                  TO PS-PO-AUTOVE-SW         23870000
238800     END-EVALUATE.                                                23880000
238900                                                                  23890000
239000                                                                  23900000
239100 3300-CHECK-PO-PREPK.                                             23910000
239200                                                                  23920000
239300     MOVE SPACE TO PS-PO-PREPK-SW.                                23930000
239400     IF DK-RCVR-SEQ-NBR  > ZEROES                                 23940000
239500         CONTINUE                                                 23950000
239600     ELSE                                                         23960000
239700         MOVE PKSLIP-REC-SEQ-NBR  TO DK-RCVR-SEQ-NBR              23970000
239800     END-IF.                                                      23980000
239900                                                                  23990000
240000     EXEC SQL                                                     24000000
240100         SELECT PKGNG_CDE                                         24010000
240200               ,CURR_OPER_UNT_ID                                  24020000
240300         INTO :RECEIV-PKGNG-CDE                                   24030000
240400             ,:RECEIV-CURR-OPER-UNT-ID                            24040000
240500         FROM TRECEIV                                             24050000
240600         WHERE                                                    24060000
240700                 ORD_NBR              = :PC033-PO-NBR             24070000
240800             AND REC_SEQ_NBR          = :DK-RCVR-SEQ-NBR          24080000
240900             AND VER_STATUS_CDE       = 'A'                       24090000
241000     END-EXEC.                                                    24100000
241100                                                                  24110000
241200     EVALUATE TRUE                                                24120000
241300         WHEN SQLCODE = ZERO                                      24130000
241400             IF RECEIV-PKGNG-CDE = 'M' OR 'I'                     24140000
241500                 SET PS-PO-PREPK-YES  TO TRUE                     24150000
241600             ELSE                                                 24160000
241700                 SET PS-PO-PREPK-NO   TO TRUE                     24170000
241800             END-IF                                               24180000
241900         WHEN OTHER                                               24190000
242000             SET PS-PO-PREPK-NO   TO TRUE                         24200000
242100     END-EVALUATE.                                                24210000
242200                                                                  24220000
242300 4000-PROCESS-ADD.                                                24230000
242400     MOVE PC033-OPER-UNT-ID      TO PV-OPER-UNT-ID.               24240000
242500     MOVE PC033-USER-ID          TO PV-USER-ID.                   24250000
242600     MOVE PC033-CARTON           TO DK-SHIPT-UNT-ID.              24260000
242700     MOVE PC033-ADJ-AFT-QTY      TO PV-SHPD-UNT-QTY.              24270000
242800     MOVE PC033-SKU-NBR-N        TO DK-SKU-NBR.                   24280000
242900     IF PC033-RCVR-SEQ-NBR-MAP > 0                                24290000
243000         MOVE PC033-RCVR-SEQ-NBR-MAP TO DK-RCVR-SEQ-NBR           24300000
243100     ELSE                                                         24310000
243200         IF PC033-RCVR-SEQ-NBR-CTN = 0                            24320000
243300             PERFORM 3100-CHECK-RCVR-NBR                          24330000
243400         ELSE                                                     24340000
243500             MOVE PC033-RCVR-SEQ-NBR-CTN TO DK-RCVR-SEQ-NBR       24350000
243600         END-IF                                                   24360000
243700     END-IF.                                                      24370000
243800     PERFORM 3300-CHECK-PO-PREPK.                                 24380000
243900     MOVE RECEIV-CURR-OPER-UNT-ID TO PV-OPER-UNT-ID.              24390000
244000                                                                  24400000
244100*****   DETERMINE IF PO/RCVR/LINE IS VERIFIED. *******            24410000
244200     MOVE SPACE TO PS-PO-VERIFIED-SW.                             24420000
244300     PERFORM 3000-CHECK-PO-VRFD.                                  24430000
244400                                                                  24440000
244500*****   DETERMINE IF PO/RCVR IS AUTO VERIFYING ******             24450000
244600     MOVE SPACE TO PS-PO-AUTOVE-SW.                               24460000
244700     PERFORM 3200-CHECK-PO-AUTOVE.                                24470000
244800                                                                  24480000
244900     MOVE ZEROES              TO PV-ADJ-BEF-QTY.                  24490000
245000     MOVE PC033-ADJ-AFT-QTY   TO PV-ADJ-TO-QTY                    24500000
245100                                 SUT00028-SHPD-UNT-QTY.           24510000
245200     IF PC033-UPC-ENTERED                                         24520000
245300         MOVE RECITM-ORD-LNE-NBR     TO SUT00028-TRN-LNE-NBR      24530000
245400         MOVE PC033-RCVR-SEQ-NBR-CTN TO DK-RCVR-SEQ-NBR           24540000
245500         PERFORM 6530-INSERT-OTBND-UPC                            24550000
245600         MOVE ZEROES                 TO PV-ADJ-BEF-QTY            24560000
246000     END-IF.                                                      24600000
246100                                                                  24610000
246200     IF PC033-SKU-ENTERED                                         24620000
246300** FIRST LOOK FOR A VENDOR UPC                                    24630000
246400         INITIALIZE XL001-ITEM-COMMAREA                           24640000
246500         SET XL001-SELECT-UPC                                     24650000
246600             XL001-SELECT-SKU                                     24660000
246700             XL001-BY-NUMERIC-SKU     TO TRUE                     24670000
246800         MOVE 'V'                     TO XL001-KEY-UPC-TYP-CDE    24680000
246900         MOVE PC033-SKU-NBR-N         TO XL001-KEY-SKU            24690000
247000         PERFORM 8600-CALL-XLKUT001                               24700000
247100         EVALUATE TRUE                                            24710000
247200             WHEN XL001-UPC-SQLCODE = ZERO                        24720000
247300             WHEN XL001-UPC-SQLCODE = -811                        24730000
247400                 MOVE XL001-UPC-NBR       TO PC033-UPC-NBR        24740000
247500                                             DK-UPC-NBR           24750000
247600             WHEN XL001-UPC-SQLCODE = +100                        24760000
247700** IF THERE IS NO VENDOR UPC, CHECK FOR AN INTERNAL UPC           24770000
247800                 INITIALIZE XL001-ITEM-COMMAREA                   24780000
247900                 SET XL001-SELECT-UPC                             24790000
248000                     XL001-SELECT-SKU                             24800000
248100                     XL001-BY-NUMERIC-SKU  TO TRUE                24810000
248200                 MOVE 'I'             TO XL001-KEY-UPC-TYP-CDE    24820000
248300                 MOVE PC033-SKU-NBR-N TO XL001-KEY-SKU            24830000
248400                 PERFORM 8600-CALL-XLKUT001                       24840000
248500                 EVALUATE TRUE                                    24850000
248600                     WHEN XL001-UPC-SQLCODE = ZERO                24860000
248700                     WHEN XL001-UPC-SQLCODE = -811                24870000
248800                         MOVE XL001-UPC-NBR   TO PC033-UPC-NBR    24880000
248900                                                 DK-UPC-NBR       24890000
249000                     WHEN OTHER                                   24900000
249100                         MOVE ZEROES          TO PC033-UPC-NBR    24910000
249200                                                 DK-UPC-NBR       24920000
249300                 END-EVALUATE                                     24930000
249400             WHEN OTHER                                           24940000
249500                 MOVE ZEROES              TO PC033-UPC-NBR        24950000
249600             END-EVALUATE                                         24960000
249700             IF PC033-UPC-NBR > ZERO                              24970000
249800                 MOVE RECITM-ORD-LNE-NBR TO SUT00028-TRN-LNE-NBR  24980000
249900                 MOVE PC033-RCVR-SEQ-NBR-CTN TO DK-RCVR-SEQ-NBR   24990000
250000                 PERFORM 6530-INSERT-OTBND-UPC                    25000000
250100                 MOVE ZEROES  TO PV-ADJ-BEF-QTY                   25010000
250200             END-IF                                               25020000
250300         END-IF.                                                  25030000
250400                                                                  25040000
250500     PERFORM 7110-CHECK-UNIT-ADJ-PARM.                            25050000
250600     IF PC033-DAMAGED-UNITS                                       25060000
250700         MOVE 'PCKR863D' TO SU035-PRC-RSN-CDE                     25070000
250800     ELSE                                                         25080000
250900         MOVE 'PCKRF863' TO SU035-PRC-RSN-CDE                     25090000
251000     END-IF                                                       25100000
251100     PERFORM 7000-INSERT-TSUQADJ.                                 25110000
251200     PERFORM 7200-CHECK-FOR-DMG-CART                              25120000
251300     SET PS-BACKOUT-NEEDED   TO TRUE.                             25130000
251400     IF PS-DO-UNIT-ADJ-YES AND PS-TSUQADJ-INSERTED                25140000
251500         MOVE RECITM-ORD-LNE-NBR  TO  PC033-PO-LINE-NBR           25150000
251600         PERFORM 2260C-BUILD-UNIT-ADJ-COMMAREA                    25160000
251700         IF PC033-DAMAGED-UNITS                                   25170000
251800             MOVE 'PCKR863D' TO SU035-PRC-RSN-CDE                 25180000
251900                                SU035-PROGRAM-NAME                25190000
252000         ELSE                                                     25200000
252100             MOVE 'PCKRF863' TO SU035-PRC-RSN-CDE                 25210000
252200                                SU035-PROGRAM-NAME                25220000
252300         END-IF                                                   25230000
252400         IF PS-PO-AUTOVE-YES                                      25240000
252500             IF PS-PO-PREPK-NO                                    25250000
252600                IF PS-PO-VERIFIED-YES                             25260000
252700                    PERFORM 8500-LINK-SUKUT702                    25270000
252800                ELSE                                              25280000
252900                    SET SU035-LOG-ONLY  TO  TRUE                  25290000
253000                    PERFORM 8500-LINK-SUKUT702                    25300000
253100                END-IF                                            25310000
253200             ELSE                                                 25320000
253300                PERFORM 5100-BEST-CASE-SCENARIO                   25330000
253400             END-IF                                               25340000
253500         ELSE                                                     25350000
253600              IF PS-PO-PREPK-YES                                  25360000
253700                 PERFORM 5100-BEST-CASE-SCENARIO                  25370000
253800             ELSE                                                 25380000
253900                 PERFORM 8500-LINK-SUKUT702                       25390000
254000             END-IF                                               25400000
254100         END-IF                                                   25410000
254200     END-IF.                                                      25420000
254300                                                                  25430000
254400     IF SU035-UPDATE-ERROR OR SU035-NO-CHANGE                     25440000
254500         MOVE PC-FAILED-ST-UNT-ADJ-MSG TO AMSGLNO                 25450000
254600     ELSE                                                         25460000
254700         IF PS-TSUQADJ-INSERTED AND PS-CART-UPC-UPDATED           25470000
254800             MOVE PC-ADD-SUCCESSFUL-MSG TO AMSGLNO                25480000
254900         END-IF                                                   25490000
255000     END-IF.                                                      25500000
255100                                                                  25510000
255200                                                                  25520000
255300     INITIALIZE PV-ADJ-ENTERED-QTY.                               25530000
255400     MOVE PV-ADJ-ENTERED-QTY TO AADJQTYO.                         25540000
255500     PERFORM 2230-GET-UNITS-IN-SKU.                               25550000
255600     MOVE PV-UNTS-IN-SKU TO AUNTSKUO.                             25560000
255700     PERFORM 2270-GET-TOTAL-UNTS-IN-CTN .                         25570000
255800     MOVE ZEROES               TO AUNTCTNO.                       25580000
255900     MOVE PV-TOT-UNTS-IN-CTN   TO AUNTCTNO.                       25590000
256000                                                                  25600000
256100     MOVE -1                   TO AUPCL.                          25610000
256200     MOVE SPACES               TO ASKUO                           25620000
256300                                  AUPCO.                          25630000
256400     PERFORM 8000-SEND-MAP.                                       25640000
256500     PERFORM 8200-RETURN-TRANID.                                  25650000
256600                                                                  25660000
256700********************************************************          25670000
256800 5000-PROCESS-UPDATE.                                             25680000
256900                                                                  25690000
257000     MOVE PC033-USER-ID          TO PV-USER-ID                    25700000
257100     MOVE PC033-CARTON           TO DK-SHIPT-UNT-ID               25710000
257200     MOVE PC033-ADJ-AFT-QTY      TO DK-ADJ-TO-QTY                 25720000
257300     MOVE PC033-SKU-NBR-N        TO DK-SKU-NBR.                   25730000
257400     IF PC033-SKU-ENTERED                                         25740000
257500        MOVE PC033-SKU-NBR-N        TO DK-SKU-NBR                 25750000
257600        PERFORM 7600-OPEN-UPC-CSR                                 25760000
257700        PERFORM 7610-FETCH-UPC-CSR                                25770000
257800        PERFORM 7620-CLOSE-UPC-CSR                                25780000
257900     END-IF.                                                      25790000
258000     IF PC033-RCVR-SEQ-NBR-MAP > 0                                25800000
258100         MOVE PC033-RCVR-SEQ-NBR-MAP TO DK-RCVR-SEQ-NBR           25810000
258200     ELSE                                                         25820000
258300         IF PC033-RCVR-SEQ-NBR-CTN = 0                            25830000
258400             PERFORM 3100-CHECK-RCVR-NBR                          25840000
258500         ELSE                                                     25850000
258600             MOVE PC033-RCVR-SEQ-NBR-CTN TO DK-RCVR-SEQ-NBR       25860000
258700         END-IF                                                   25870000
258800     END-IF.                                                      25880000
258900     PERFORM 3300-CHECK-PO-PREPK.                                 25890000
259000     MOVE RECEIV-CURR-OPER-UNT-ID TO PV-OPER-UNT-ID               25900000
259100                                                                  25910000
259200*    IF PC033-UPC-ENTERED                                         25920000
259300        MOVE PC033-UPC-NBR    TO DK-UPC-NBR                       25930000
259400        PERFORM 2250-SELECT-CART-UPC UNTIL PS-NO-REMAINDER        25940000
259500*       INITIALIZE PC033-UPC-ENTERED-SW                           25950000
259600*    END-IF                                                       25960000
259700                                                                  25970000
259800     IF SU035-UPDATE-ERROR OR SU035-NO-CHANGE                     25980000
259900         MOVE PC-FAILED-ST-UNT-ADJ-MSG TO AMSGLNO                 25990000
260000     ELSE                                                         26000000
260100         IF PS-TSUQADJ-INSERTED AND PS-CART-UPC-UPDATED           26010000
260200             MOVE PC-UPD-SUCCESSFUL-MSG TO AMSGLNO                26020000
260300        END-IF                                                    26030000
260400     END-IF.                                                      26040000
260500                                                                  26050000
260600******************************************************************26060000
260700* THE CODE IN THE 5000- SERIES IS FROM SUKUT701.  IF 701 CHANGES  26070000
260800* CHECK THIS CODE TO SEE IF THIS NEEDS CHANGING.                  26080000
260900******************************************************************26090000
261000 5100-BEST-CASE-SCENARIO.                                         26100000
261100*                                                                 26110000
261200     MOVE PC033-PO-LINE-NBR TO PV-SAVE-PO-LINE-NBR.               26120000
261300     MOVE PC033-UPC-NBR     TO PV-SAVE-UPC-NBR.                   26130000
261400     MOVE PV-FINCL-ADJ-ID TO PV-SAVE-FINCL-ADJ-ID.                26140000
261500     MOVE 0               TO PV-SAVE-LAST-IDX.                    26150000
261600     MOVE PC033-PO-NBR    TO DK-PO-NBR.                           26160000
261700     IF PC033-PO-LINE-NBR > 0                                     26170000
261800         MOVE PC033-PO-LINE-NBR      TO DK-LNE-NBR                26180000
261900         PERFORM 5105-SELECT-PACK-ID                              26190000
262000         PERFORM 5110-OPEN-PACK-CURSOR                            26200000
262100         PERFORM 5115-PROCESS-PACK-CURSOR                         26210000
262200         PERFORM 5125-CLOSE-PACK-CURSOR                           26220000
262300     END-IF.                                                      26230000
262400     PERFORM 5200-OPEN-CARTON-LINE-CURSOR.                        26240000
262500     PERFORM 5210-PROCESS-CARTON-CURSOR                           26250000
262600         UNTIL PS-END-OF-CARTON-ITEM-CSR.                         26260000
262700     PERFORM 5220-CLOSE-CARTON-LINE-CURSOR.                       26270000
262800     SET PS-NO-ODD-UNITS-ADJUSTMENT TO TRUE.                      26280000
262900     SET PS-NO-ODD-UNIT-ON-OTHER-LINES TO TRUE.                   26290000
263000     SET PS-NO-ODD-UNITS-ADDED TO TRUE.                           26300000
263100     SET PS-ODD-UNITS-LEFT TO TRUE.                               26310000
263200                                                                  26320000
263300***  SET PV-SAVE-LINE-IDX TO 1 TO START THE PROCESSING.  THIS     26330000
263400***  WILL INCREMENT AFTER EVERY GROUP OF LINES FOR A PACK AS      26340000
263500***  THEY ARE PROCESSED.                                          26350000
263600     MOVE 1 TO PV-SAVE-LINE-IDX.                                  26360000
263700                                                                  26370000
263800     PERFORM 5700-CALL-BEST-CASE-RTN                              26380000
263900         UNTIL PACK-IND (PV-SAVE-LINE-IDX) NOT = 'Y'              26390000
264000            OR PV-SAVE-LINE-IDX > 500                             26400000
264100            OR SU035-UPDATE-ERROR OR SU035-NO-CHANGE.             26410000
264200                                                                  26420000
264300     IF PS-ODD-UNITS-ADJUSTMENT                                   26430000
264400        IF PS-ODD-UNITS-ADDED                                     26440000
264500            MOVE 'Y'   TO PV-ODD-UNT-IND                          26450000
264600            PERFORM 8700-UPDATE-OTBND-CART                        26460000
264700        ELSE                                                      26470000
264800            IF NOT PS-ODD-UNITS-ADDED AND                         26480000
264900               PS-ODD-UNIT-ON-OTHER-LINES                         26490000
265000                MOVE 'Y'   TO PV-ODD-UNT-IND                      26500000
265100                PERFORM 8700-UPDATE-OTBND-CART                    26510000
265200            ELSE                                                  26520000
265300                IF PS-NO-ODD-UNITS-LEFT AND NOT                   26530000
265400                   PS-ODD-UNIT-ON-OTHER-LINES                     26540000
265500                    MOVE 'N'   TO PV-ODD-UNT-IND                  26550000
265600                    PERFORM 8700-UPDATE-OTBND-CART                26560000
265700                ELSE                                              26570000
265800                    IF NOT PS-ODD-UNITS-ADDED AND                 26580000
265900                       NOT PS-ODD-UNIT-ON-OTHER-LINES             26590000
266000                        MOVE 'N'   TO PV-ODD-UNT-IND              26600000
266100                        PERFORM 8700-UPDATE-OTBND-CART            26610000
266200                    END-IF                                        26620000
266300                END-IF                                            26630000
266400            END-IF                                                26640000
266500        END-IF                                                    26650000
266600     END-IF.                                                      26660000
266700     SET PS-NO-ODD-UNITS-LINE-ADJ TO TRUE.                        26670000
266800     MOVE PV-SAVE-PO-LINE-NBR  TO PC033-PO-LINE-NBR.              26680000
266900     MOVE PV-SAVE-UPC-NBR      TO PC033-UPC-NBR.                  26690000
267000                                                                  26700000
267100 5105-SELECT-PACK-ID.                                             26710000
267200     MOVE RECEIV-CURR-OPER-UNT-ID        TO DK-OPER-UNT-ID.       26720000
267300     IF DK-RCVR-SEQ-NBR  > ZEROES                                 26730000
267400         CONTINUE                                                 26740000
267500     ELSE                                                         26750000
267600         MOVE PKSLIP-REC-SEQ-NBR  TO DK-RCVR-SEQ-NBR              26760000
267700     END-IF.                                                      26770000
267800                                                                  26780000
267900     EXEC SQL                                                     26790000
268000          SELECT PREPK_ID                                         26800000
268100          INTO  :RECITM-PREPK-ID                                  26810000
268200          FROM   TRECITM                                          26820000
268300          WHERE ORD_NBR            =  :DK-PO-NBR                  26830000
268400           AND  REC_SEQ_NBR        =  :DK-RCVR-SEQ-NBR            26840000
268500           AND  ORD_LNE_NBR        =  :DK-LNE-NBR                 26850000
268600     END-EXEC.                                                    26860000
268700                                                                  26870000
268800     EVALUATE TRUE                                                26880000
268900         WHEN SQLCODE = ZERO                                      26890000
269000             MOVE RECITM-PREPK-ID   TO DK-PACK-ID                 26900000
269100                                                                  26910000
269200         WHEN OTHER                                               26920000
269300             MOVE 0                 TO DK-PACK-ID                 26930000
269400                                       RECITM-PREPK-ID            26940000
269500     END-EVALUATE.                                                26950000
269600                                                                  26960000
269700 5110-OPEN-PACK-CURSOR.                                           26970000
269800                                                                  26980000
269900     EXEC SQL                                                     26990000
270000         OPEN PACK-CURSOR                                         27000000
270100     END-EXEC.                                                    27010000
270200                                                                  27020000
270300     EVALUATE TRUE                                                27030000
270400         WHEN SQLCODE = ZERO                                      27040000
270500             SET PS-NOT-END-OF-PAC-CURSOR        TO TRUE          27050000
270600                                                                  27060000
270700         WHEN SQLWARN0 NOT = SPACES                               27070000
270800         WHEN SQLCODE NOT EQUAL ZERO                              27080000
270900             MOVE 49                  TO PV-ERROR-NBR             27090000
271000                                         PC033-ERROR-NBR          27100000
271100             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         27110000
271200             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      27120000
271300             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 27130000
271400             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  27140000
271500             PERFORM 9903-WRITE-CICS-LOG                          27150000
271600             MOVE '5110-OPEN-PACK-CURSOR'  TO PC033-PARAGRAPH     27160000
271700             MOVE 'PCKRF863 '        TO PC033-MESSAGE-TEXT(1)     27170000
271800             MOVE DK-SHIPT-UNT-ID    TO PC033-MESSAGE-TEXT(2)     27180000
271900             MOVE SQLCA              TO PC033-SQLCA               27190000
272000             MOVE 'TRECITM      '    TO PC033-DB2-TABLE-NAME(1)   27200000
272100             SET PC033-ABEND         TO TRUE                      27210000
272200             MOVE 99                 TO PC033-PGM-MSG-NBR         27220000
272300             PERFORM 8210-XCTL-ERROR-SCREEN                       27230000
272400     END-EVALUATE.                                                27240000
272500                                                                  27250000
272600 5115-PROCESS-PACK-CURSOR.                                        27260000
272700     COMPUTE PV-SAVE-LAST-IDX = PV-SAVE-LAST-IDX + 1.             27270000
272800     SET PS-NO-PACK-RECS-PROCESSED   TO TRUE.                     27280000
272900     PERFORM 5120-FETCH-PACK-CURSOR                               27290000
273000         VARYING LINE-IDX FROM PV-SAVE-LAST-IDX BY 1              27300000
273100         UNTIL  LINE-IDX > 500                                    27310000
273200            OR PS-END-OF-PAC-CURSOR.                              27320000
273300                                                                  27330000
273400     IF PS-NO-PACK-RECS-PROCESSED                                 27340000
273500         COMPUTE PV-SAVE-LAST-IDX = PV-SAVE-LAST-IDX - 1          27350000
273600     END-IF.                                                      27360000
273700                                                                  27370000
273800     IF LINE-IDX > 500                                            27380000
273900         MOVE 500                 TO PV-ERROR-NBR                 27390000
274000                                     PC033-ERROR-NBR              27400000
274100         MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER             27410000
274200         MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR          27420000
274300         MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR     27430000
274400         MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR      27440000
274500         PERFORM 9903-WRITE-CICS-LOG                              27450000
274600         MOVE 'MORE THAN 500 ITEMS IN PACK'  TO PC033-PARAGRAPH   27460000
274700         MOVE 'PCKRF863 '         TO PC033-MESSAGE-TEXT(1)        27470000
274800         MOVE PC033-PO-NBR        TO PC033-MESSAGE-TEXT(2)        27480000
274900         MOVE SQLCA               TO PC033-SQLCA                  27490000
275000         MOVE 'TRECITM      '     TO PC033-DB2-TABLE-NAME(1)      27500000
275100         SET PC033-ABEND          TO TRUE                         27510000
275200         MOVE 99                  TO PC033-PGM-MSG-NBR            27520000
275300         PERFORM 8210-XCTL-ERROR-SCREEN                           27530000
275400     END-IF.                                                      27540000
275500                                                                  27550000
275600 5120-FETCH-PACK-CURSOR.                                          27560000
275700                                                                  27570000
275800     EXEC SQL                                                     27580000
275900          FETCH PACK-CURSOR                                       27590000
276000          INTO  :RECITM-ORD-LNE-NBR                               27600000
276100              , :RECITM-ITM-NBR                                   27610000
276200              , :RECITM-PREPK-RATO-QTY                            27620000
276300              , :RECITM-PREPK-DRV-LNE-CDE                         27630000
276400     END-EXEC.                                                    27640000
276500                                                                  27650000
276600     EVALUATE TRUE                                                27660000
276700         WHEN SQLCODE = ZERO                                      27670000
276800             SET PS-PACK-RECS-PROCESSED  TO TRUE                  27680000
276900             MOVE RECITM-ORD-LNE-NBR     TO PACK-LINE (LINE-IDX)  27690000
277000             MOVE RECITM-PREPK-RATO-QTY  TO PACK-RATO (LINE-IDX)  27700000
277100             MOVE 'Y'                    TO PACK-IND (LINE-IDX)   27710000
277200             MOVE RECITM-ITM-NBR         TO PACK-ITM (LINE-IDX)   27720000
277300             MOVE RECITM-PREPK-ID      TO PACK-PRPPK-ID (LINE-IDX)27730000
277400             MOVE RECITM-PREPK-DRV-LNE-CDE                        27740000
277500                              TO PACK-PREPK-DRV-LNE-CDE (LINE-IDX)27750000
277600             SET PV-SAVE-LAST-IDX     TO LINE-IDX                 27760000
277700         WHEN SQLCODE = +100                                      27770000
277800             SET PS-END-OF-PAC-CURSOR        TO TRUE              27780000
277900         WHEN SQLWARN0 NOT = SPACES                               27790000
278000         WHEN SQLCODE NOT EQUAL ZERO                              27800000
278100             MOVE 50                  TO PV-ERROR-NBR             27810000
278200                                         PC033-ERROR-NBR          27820000
278300             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         27830000
278400             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      27840000
278500             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 27850000
278600             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  27860000
278700             PERFORM 9903-WRITE-CICS-LOG                          27870000
278800             MOVE '5120-FETCH-PACK-CURSOR'  TO PC033-PARAGRAPH    27880000
278900             MOVE 'PCKRF863 '         TO PC033-MESSAGE-TEXT(1)    27890000
279000             MOVE PC033-PO-NBR        TO PC033-MESSAGE-TEXT(2)    27900000
279100             MOVE SQLCA               TO PC033-SQLCA              27910000
279200             MOVE 'TRECITM      '     TO PC033-DB2-TABLE-NAME(1)  27920000
279300             SET PC033-ABEND          TO TRUE                     27930000
279400             MOVE 99                  TO PC033-PGM-MSG-NBR        27940000
279500             PERFORM 8210-XCTL-ERROR-SCREEN                       27950000
279600     END-EVALUATE.                                                27960000
279700                                                                  27970000
279800 5125-CLOSE-PACK-CURSOR.                                          27980000
279900                                                                  27990000
280000     EXEC SQL                                                     28000000
280100          CLOSE PACK-CURSOR                                       28010000
280200     END-EXEC.                                                    28020000
280300                                                                  28030000
280400     EVALUATE TRUE                                                28040000
280500         WHEN SQLCODE = ZERO                                      28050000
280600             CONTINUE                                             28060000
280700         WHEN SQLWARN0 NOT = SPACES                               28070000
280800         WHEN SQLCODE NOT EQUAL ZERO                              28080000
280900             MOVE 50                  TO PV-ERROR-NBR             28090000
281000                                         PC033-ERROR-NBR          28100000
281100             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         28110000
281200             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      28120000
281300             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 28130000
281400             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  28140000
281500             PERFORM 9903-WRITE-CICS-LOG                          28150000
281600             MOVE '5125-CLOSE-PACK-CURSOR'  TO PC033-PARAGRAPH    28160000
281700             MOVE 'PCKRF863 '        TO PC033-MESSAGE-TEXT(1)     28170000
281800             MOVE PC033-PO-NBR       TO PC033-MESSAGE-TEXT(2)     28180000
281900             MOVE SQLCA              TO PC033-SQLCA               28190000
282000             MOVE 'TRECITM      '    TO PC033-DB2-TABLE-NAME(1)   28200000
282100             SET PC033-ABEND         TO TRUE                      28210000
282200             MOVE 99                 TO PC033-PGM-MSG-NBR         28220000
282300             PERFORM 8210-XCTL-ERROR-SCREEN                       28230000
282400     END-EVALUATE.                                                28240000
282500                                                                  28250000
282600 5200-OPEN-CARTON-LINE-CURSOR.                                    28260000
282700                                                                  28270000
282800     EXEC SQL                                                     28280000
282900         OPEN CARTON_LINE_CURSOR                                  28290000
283000     END-EXEC.                                                    28300000
283100                                                                  28310000
283200     EVALUATE TRUE                                                28320000
283300         WHEN SQLCODE = ZERO                                      28330000
283400             SET PS-NOT-END-OF-CARTON-ITEM-CSR                    28340000
283500                 PS-NO-OVER-SHORT-ERROR           TO TRUE         28350000
283600         WHEN SQLCODE < ZERO                                      28360000
283700         WHEN SQLCODE > ZERO                                      28370000
283800             MOVE 51                  TO PV-ERROR-NBR             28380000
283900                                         PC033-ERROR-NBR          28390000
284000             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         28400000
284100             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      28410000
284200             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 28420000
284300             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  28430000
284400             PERFORM 9903-WRITE-CICS-LOG                          28440000
284500             MOVE '5200-OPEN-CARTON-LINE-CURSR' TO PC033-PARAGRAPH28450000
284600             MOVE 'PCKRF863 '        TO PC033-MESSAGE-TEXT(1)     28460000
284700             MOVE PC033-PO-NBR       TO PC033-MESSAGE-TEXT(2)     28470000
284800             MOVE SQLCA              TO PC033-SQLCA               28480000
284900             MOVE 'TRECITM      '    TO PC033-DB2-TABLE-NAME(1)   28490000
285000             SET PC033-ABEND         TO TRUE                      28500000
285100             MOVE 99                 TO PC033-PGM-MSG-NBR         28510000
285200             PERFORM 8210-XCTL-ERROR-SCREEN                       28520000
285300     END-EVALUATE.                                                28530000
285400                                                                  28540000
285500 5210-PROCESS-CARTON-CURSOR.                                      28550000
285600     PERFORM 5215-FETCH-CARTON-LINE-CURSOR.                       28560000
285700     IF PS-NOT-END-OF-CARTON-ITEM-CSR                             28570000
285800         MOVE PV-CARTON-LINE-NBR   TO DK-LNE-NBR                  28580000
285900         PERFORM 5105-SELECT-PACK-ID                              28590000
286000         MOVE PV-CARTON-INTR-UPC  TO DK-INTR-UPC                  28600000
286100         IF PV-CARTON-REC-TYPE = 'B'                              28610000
286200             MOVE PV-CARTON-HOLD-UPC-NBR TO DK-UPC-NBR            28620000
286300             PERFORM 5300-GET-ITM-NBR                             28630000
286400             COMPUTE PV-SAVE-LAST-IDX = PV-SAVE-LAST-IDX + 1      28640000
286500             SET LINE-IDX TO PV-SAVE-LAST-IDX                     28650000
286600             MOVE 'Y'              TO PACK-IND (LINE-IDX)         28660000
286700             MOVE XL001-ITM-NBR    TO PACK-ITM (LINE-IDX)         28670000
286800             MOVE 999999999        TO PACK-LINE (LINE-IDX)        28680000
286900             MOVE PV-CARTON-ITEM-COUNT TO PACK-CRTN-QTY (LINE-IDX)28690000
287000             MOVE PV-CARTON-REC-TYPE                              28700000
287100                                 TO PACK-CRTN-REC-TYPE (LINE-IDX) 28710000
287200             MOVE PV-CARTON-INTR-UPC                              28720000
287300                                 TO PACK-CRTN-INTR-UPC (LINE-IDX) 28730000
287400             MOVE PV-CARTON-HOLD-UPC-NBR                          28740000
287500                                 TO PACK-CRTN-HOLD-UPC (LINE-IDX) 28750000
287600         ELSE                                                     28760000
287700             PERFORM 5310-GET-ITM-NBR                             28770000
287800             SET PS-NO-PACK-MATCH-FOUND TO TRUE                   28780000
287900             IF RECITM-PREPK-ID > 0                               28790000
288000                 PERFORM VARYING LINE-IDX FROM 1 BY 1             28800000
288100                     UNTIL PACK-LINE (LINE-IDX) = 0               28810000
288200                     OR PS-PACK-MATCH-FOUND                       28820000
288300                     OR LINE-IDX > 500                            28830000
288400                    IF RECITM-PREPK-ID = PACK-PRPPK-ID (LINE-IDX) 28840000
288500                        SET PS-PACK-MATCH-FOUND TO TRUE           28850000
288600                    END-IF                                        28860000
288700                 END-PERFORM                                      28870000
288800                 IF PS-NO-PACK-MATCH-FOUND                        28880000
288900                     PERFORM 5110-OPEN-PACK-CURSOR                28890000
289000                     PERFORM 5115-PROCESS-PACK-CURSOR             28900000
289100                     PERFORM 5125-CLOSE-PACK-CURSOR               28910000
289200                 END-IF                                           28920000
289300             END-IF                                               28930000
289400             SET PS-NO-UPC-MATCH-FOUND TO TRUE                    28940000
289500             PERFORM VARYING LINE-IDX FROM 1 BY 1                 28950000
289600                 UNTIL PACK-LINE (LINE-IDX) = 0                   28960000
289700                 OR PS-UPC-MATCH-FOUND                            28970000
289800                 OR LINE-IDX > 500                                28980000
289900                 IF PV-CARTON-LINE-NBR = PACK-LINE (LINE-IDX)     28990000
290000                     MOVE PV-CARTON-ITEM-COUNT                    29000000
290100                               TO PACK-CRTN-QTY (LINE-IDX)        29010000
290200                     MOVE PV-CARTON-REC-TYPE                      29020000
290300                               TO PACK-CRTN-REC-TYPE (LINE-IDX)   29030000
290400                     MOVE PV-CARTON-INTR-UPC                      29040000
290500                               TO PACK-CRTN-INTR-UPC (LINE-IDX)   29050000
290600                     MOVE PV-CARTON-HOLD-UPC-NBR                  29060000
290700                               TO PACK-CRTN-HOLD-UPC (LINE-IDX)   29070000
290800                     SET PS-UPC-MATCH-FOUND TO TRUE               29080000
290900                 END-IF                                           29090000
291000             END-PERFORM                                          29100000
291100             IF PS-NO-UPC-MATCH-FOUND                             29110000
291200                 COMPUTE PV-SAVE-LAST-IDX = PV-SAVE-LAST-IDX + 1  29120000
291300                 SET LINE-IDX TO PV-SAVE-LAST-IDX                 29130000
291400                 MOVE 'Y'              TO PACK-IND (LINE-IDX)     29140000
291500                 MOVE XL001-ITM-NBR    TO PACK-ITM (LINE-IDX)     29150000
291600                 MOVE 999999999        TO PACK-LINE (LINE-IDX)    29160000
291700                 MOVE PV-CARTON-ITEM-COUNT                        29170000
291800                               TO PACK-CRTN-QTY (LINE-IDX)        29180000
291900                 MOVE PV-CARTON-REC-TYPE                          29190000
292000                               TO PACK-CRTN-REC-TYPE (LINE-IDX)   29200000
292100                 MOVE PV-CARTON-INTR-UPC                          29210000
292200                               TO PACK-CRTN-INTR-UPC (LINE-IDX)   29220000
292300                 MOVE PV-CARTON-HOLD-UPC-NBR                      29230000
292400                               TO PACK-CRTN-HOLD-UPC (LINE-IDX)   29240000
292500             END-IF                                               29250000
292600         END-IF                                                   29260000
292700     END-IF.                                                      29270000
292800                                                                  29280000
292900 5215-FETCH-CARTON-LINE-CURSOR.                                   29290000
293000                                                                  29300000
293100     EXEC SQL                                                     29310000
293200         FETCH CARTON_LINE_CURSOR                                 29320000
293300         INTO    :PV-CARTON-REC-TYPE                              29330000
293400              ,  :PV-CARTON-INTR-UPC                              29340000
293500              ,  :PV-CARTON-LINE-NBR                              29350000
293600              ,  :PV-CARTON-HOLD-UPC-NBR                          29360000
293700              ,  :PV-CARTON-ITEM-COUNT                            29370000
293800     END-EXEC.                                                    29380000
293900                                                                  29390000
294000     EVALUATE TRUE                                                29400000
294100         WHEN SQLCODE = ZERO                                      29410000
294200             CONTINUE                                             29420000
294300         WHEN SQLCODE = +100                                      29430000
294400             SET PS-END-OF-CARTON-ITEM-CSR   TO TRUE              29440000
294500             MOVE 0             TO PV-CARTON-ITEM-COUNT           29450000
294600                                                                  29460000
294700         WHEN SQLWARN0 NOT = SPACES                               29470000
294800         WHEN SQLCODE < ZERO                                      29480000
294900         WHEN SQLCODE > ZERO                                      29490000
295000             MOVE 51                  TO PV-ERROR-NBR             29500000
295100                                         PC033-ERROR-NBR          29510000
295200             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         29520000
295300             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      29530000
295400             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 29540000
295500             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  29550000
295600             PERFORM 9903-WRITE-CICS-LOG                          29560000
295700             MOVE '5215-FETCH-CARTON-LINE-CURSR' TO               29570000
295800                                         PC033-PARAGRAPH          29580000
295900             MOVE 'PCKRF863 '         TO PC033-MESSAGE-TEXT(1)    29590000
296000             MOVE PC033-PO-NBR        TO PC033-MESSAGE-TEXT(2)    29600000
296100             MOVE SQLCA               TO PC033-SQLCA              29610000
296200             MOVE 'OTBND_UPC    '     TO PC033-DB2-TABLE-NAME(1)  29620000
296300             SET PC033-ABEND          TO TRUE                     29630000
296400             MOVE 99                  TO PC033-PGM-MSG-NBR        29640000
296500             PERFORM 8210-XCTL-ERROR-SCREEN                       29650000
296600     END-EVALUATE.                                                29660000
296700                                                                  29670000
296800******************************************************************29680000
296900*  CLOSE THE PO LINE CURSOR                                      *29690000
297000******************************************************************29700000
297100 5220-CLOSE-CARTON-LINE-CURSOR.                                   29710000
297200                                                                  29720000
297300     EXEC SQL                                                     29730000
297400         CLOSE CARTON_LINE_CURSOR                                 29740000
297500     END-EXEC.                                                    29750000
297600                                                                  29760000
297700     EVALUATE TRUE                                                29770000
297800         WHEN SQLCODE = ZERO                                      29780000
297900             CONTINUE                                             29790000
298000                                                                  29800000
298100         WHEN SQLWARN0 NOT = SPACES                               29810000
298200         WHEN SQLCODE < ZERO                                      29820000
298300         WHEN SQLCODE > ZERO                                      29830000
298400             MOVE 52                  TO PV-ERROR-NBR             29840000
298500                                         PC033-ERROR-NBR          29850000
298600             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         29860000
298700             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      29870000
298800             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 29880000
298900             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  29890000
299000             PERFORM 9903-WRITE-CICS-LOG                          29900000
299100             MOVE '5220-CLOSE-CARTON-LINE-CURSOR' TO              29910000
299200                                         PC033-PARAGRAPH          29920000
299300             MOVE 'PCKRF863 '         TO PC033-MESSAGE-TEXT(1)    29930000
299400             MOVE PC033-PO-NBR        TO PC033-MESSAGE-TEXT(2)    29940000
299500             MOVE SQLCA               TO PC033-SQLCA              29950000
299600             MOVE 'OTBND_UPC    '     TO PC033-DB2-TABLE-NAME(1)  29960000
299700             SET PC033-ABEND          TO TRUE                     29970000
299800             MOVE 99                  TO PC033-PGM-MSG-NBR        29980000
299900             PERFORM 8210-XCTL-ERROR-SCREEN                       29990000
300000     END-EVALUATE.                                                30000000
300100                                                                  30010000
300200 5300-GET-ITM-NBR.                                                30020000
300300     INITIALIZE XL001-ITEM-COMMAREA.                              30030000
300400                                                                  30040000
300500     SET  PS-ITM-NOT-FOUND        TO TRUE                         30050000
300600     MOVE DK-UPC-NBR              TO XL001-KEY-UPC-NBR.           30060000
300700                                                                  30070000
300800     SET  XL001-BY-UPC-NBR                                        30080000
300900          XL001-SELECT-SKU        TO TRUE.                        30090000
301100                                                                  30110000
301200     CALL XL001-VSM-PGM  USING DFHEIBLK                           30120000
301300                              XL001-COMMAREA                      30130000
301400                              XL001-ITEM-COMMAREA.                30140000
301500                                                                  30150000
301600     EVALUATE TRUE                                                30160000
301700         WHEN XL001-SKU-SQLCODE = +0                              30170000
301800             SET  PS-ITM-FOUND          TO TRUE                   30180000
301900         WHEN XL001-SKU-SQLCODE = +100                            30190000
302000             SET  PS-ITM-NOT-FOUND      TO TRUE                   30200000
302100         WHEN OTHER                                               30210000
302200             MOVE 53                  TO PV-ERROR-NBR             30220000
302300                                         PC033-ERROR-NBR          30230000
302400             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         30240000
302500             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      30250000
302600             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 30260000
302700             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  30270000
302800             PERFORM 9903-WRITE-CICS-LOG                          30280000
302900             MOVE '5300-GET-ITM-NBR  '  TO PC033-PARAGRAPH        30290000
303000             MOVE 'PCKRF863 '         TO PC033-MESSAGE-TEXT(1)    30300000
303100             MOVE PC033-PO-NBR        TO PC033-MESSAGE-TEXT(2)    30310000
303200             MOVE SQLCA               TO PC033-SQLCA              30320000
303300             MOVE 'XLKUT001     '     TO PC033-DB2-TABLE-NAME(1)  30330000
303400             SET PC033-ABEND          TO TRUE                     30340000
303500             MOVE 99                  TO PC033-PGM-MSG-NBR        30350000
303600             PERFORM 8210-XCTL-ERROR-SCREEN                       30360000
303700     END-EVALUATE.                                                30370000
303800                                                                  30380000
303900 5310-GET-ITM-NBR.                                                30390000
304000     INITIALIZE XL001-ITEM-COMMAREA.                              30400000
304100                                                                  30410000
304200     SET  PS-ITM-NOT-FOUND        TO TRUE                         30420000
304300     MOVE DK-INTR-UPC             TO XL001-KEY-INTR-UPC-ID.       30430000
304400                                                                  30440000
304500     SET  XL001-BY-INTR-UPC-ID                                    30450000
304600          XL001-SELECT-SKU                                        30460000
304700          XL001-SELECT-UPC        TO TRUE.                        30470000
304900     MOVE 'V'                     TO XL001-KEY-UPC-TYP-CDE.       30490000
305000                                                                  30500000
305100     CALL XL001-VSM-PGM  USING DFHEIBLK                           30510000
305200                              XL001-COMMAREA                      30520000
305300                              XL001-ITEM-COMMAREA.                30530000
305400                                                                  30540000
305500     EVALUATE TRUE                                                30550000
305600      WHEN (XL001-UPC-SQLCODE = -811 OR                           30560000
305700            XL001-UPC-SQLCODE = +0) AND                           30570000
305800           XL001-SKU-SQLCODE = +0                                 30580000
305900          SET  PS-ITM-FOUND          TO TRUE                      30590000
306000      WHEN XL001-UPC-SQLCODE = +100                               30600000
306100      WHEN XL001-SKU-SQLCODE = +100                               30610000
306200          PERFORM 5315-GET-ITM-NBR-I                              30620000
306300                                                                  30630000
306400      WHEN OTHER                                                  30640000
306500          MOVE 54                  TO PV-ERROR-NBR                30650000
306600                                      PC033-ERROR-NBR             30660000
306700          MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER            30670000
306800          MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR         30680000
306900          MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR    30690000
307000          MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR     30700000
307100          PERFORM 9903-WRITE-CICS-LOG                             30710000
307200          MOVE '5310-GET-ITM-NBR  '  TO PC033-PARAGRAPH           30720000
307300          MOVE 'PCKRF863 '         TO PC033-MESSAGE-TEXT(1)       30730000
307400          MOVE PC033-PO-NBR        TO PC033-MESSAGE-TEXT(2)       30740000
307500          MOVE SQLCA               TO PC033-SQLCA                 30750000
307600          MOVE 'XLKUT001     '     TO PC033-DB2-TABLE-NAME(1)     30760000
307700          SET PC033-ABEND          TO TRUE                        30770000
307800          MOVE 99                  TO PC033-PGM-MSG-NBR           30780000
307900          PERFORM 8210-XCTL-ERROR-SCREEN                          30790000
308000     END-EVALUATE.                                                30800000
308100                                                                  30810000
308200 5315-GET-ITM-NBR-I.                                              30820000
308300     INITIALIZE XL001-ITEM-COMMAREA.                              30830000
308400                                                                  30840000
308500     SET  PS-ITM-NOT-FOUND        TO TRUE                         30850000
308600     MOVE DK-INTR-UPC             TO XL001-KEY-INTR-UPC-ID.       30860000
308700                                                                  30870000
308800     SET  XL001-BY-INTR-UPC-ID                                    30880000
308900          XL001-SELECT-SKU                                        30890000
309000          XL001-SELECT-UPC        TO TRUE.                        30900000
309200                                                                  30920000
309300     CALL XL001-VSM-PGM  USING DFHEIBLK                           30930000
309400                              XL001-COMMAREA                      30940000
309500                              XL001-ITEM-COMMAREA.                30950000
309600                                                                  30960000
309700     EVALUATE TRUE                                                30970000
309800         WHEN XL001-UPC-SQLCODE = +0 AND                          30980000
309900              XL001-SKU-SQLCODE = +0                              30990000
310000            SET  PS-ITM-FOUND          TO TRUE                    31000000
310100         WHEN XL001-UPC-SQLCODE = +100                            31010000
310200         WHEN XL001-SKU-SQLCODE = +100                            31020000
310300            SET  PS-ITM-NOT-FOUND        TO TRUE                  31030000
310400         WHEN OTHER                                               31040000
310500             MOVE 55                  TO PV-ERROR-NBR             31050000
310600                                         PC033-ERROR-NBR          31060000
310700             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         31070000
310800             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      31080000
310900             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 31090000
311000             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  31100000
311100             PERFORM 9903-WRITE-CICS-LOG                          31110000
311200             MOVE '5315-GET-ITM-NBR-I'  TO PC033-PARAGRAPH        31120000
311300             MOVE 'PCKRF863 '         TO PC033-MESSAGE-TEXT(1)    31130000
311400             MOVE PC033-PO-NBR        TO PC033-MESSAGE-TEXT(2)    31140000
311500             MOVE SQLCA               TO PC033-SQLCA              31150000
311600             MOVE 'XLKUT001     '     TO PC033-DB2-TABLE-NAME(1)  31160000
311700             SET PC033-ABEND          TO TRUE                     31170000
311800             MOVE 99                  TO PC033-PGM-MSG-NBR        31180000
311900             PERFORM 8210-XCTL-ERROR-SCREEN                       31190000
312000     END-EVALUATE.                                                31200000
312100                                                                  31210000
312200 5700-CALL-BEST-CASE-RTN.                                         31220000
312300**THIS IS THE BEFORE PICTURE OF THE PACK                          31230000
312400     MOVE PACK-PRPPK-ID (PV-SAVE-LINE-IDX) TO PV-SAVE-PREPK-ID.   31240000
312500     INITIALIZE RC806-PRODUCT-PACK-VALIDATION.                    31250000
312600     SET RC806-VALIDATE-AND-CALC      TO TRUE.                    31260000
312700     MOVE 1                           TO RC806-INNER-PACK-QTY.    31270000
312800                                                                  31280000
312900     MOVE 0     TO PV-NUMBER-OF-LINES.                            31290000
313000     SET RC806-LINE-IDX TO 1.                                     31300000
313100     PERFORM VARYING LINE-IDX  FROM PV-SAVE-LINE-IDX BY 1         31310000
313200             UNTIL PACK-IND (LINE-IDX) NOT = 'Y'                  31320000
313300                OR PACK-PRPPK-ID (LINE-IDX) NOT = PV-SAVE-PREPK-ID31330000
313400                OR LINE-IDX > 500                                 31340000
313500         MOVE PACK-LINE (LINE-IDX) TO RC806-PKSL-LNE-NBR          31350000
313600                                       (RC806-LINE-IDX)           31360000
313700         MOVE PACK-RATO (LINE-IDX) TO RC806-PO-RATIO              31370000
313800                                       (RC806-LINE-IDX)           31380000
313900                                      RC806-RC-RATIO              31390000
314000                                       (RC806-LINE-IDX)           31400000
314100         IF PACK-LINE (LINE-IDX) = PC033-PO-LINE-NBR              31410000
314200             MOVE PACK-CRTN-QTY (LINE-IDX) TO                     31420000
314300                               PACK-AUDIT-QTY (LINE-IDX)          31430000
314400             MOVE PV-BEFORE-UPC-QTY TO RC806-UNIT-QTY             31440000
314500                                                 (RC806-LINE-IDX) 31450000
314600                                  RC806-RCVG-QTY (RC806-LINE-IDX) 31460000
314700                                  PACK-CRTN-QTY (LINE-IDX)        31470000
314800         ELSE                                                     31480000
314900             MOVE PACK-CRTN-QTY (LINE-IDX) TO RC806-UNIT-QTY      31490000
315000                                       (RC806-LINE-IDX)           31500000
315100                                      RC806-RCVG-QTY              31510000
315200                                       (RC806-LINE-IDX)           31520000
315300                               PACK-AUDIT-QTY (LINE-IDX)          31530000
315400         END-IF                                                   31540000
315500         SET RC806-LINE-IDX UP BY 1                               31550000
315600         ADD 1  TO PV-NUMBER-OF-LINES                             31560000
315700     END-PERFORM.                                                 31570000
315800     MOVE PV-NUMBER-OF-LINES  TO RC806-NBR-OF-LINES.              31580000
315900                                                                  31590000
316000     PERFORM 5720-VALIDATION-MODULE.                              31600000
316100                                                                  31610000
316200     SET LINE-IDX TO PV-SAVE-LINE-IDX.                            31620000
316300     IF RC806-NO-ERRORS                                           31630000
316400         PERFORM VARYING RC806-LINE-IDX FROM 1 BY 1               31640000
316500                 UNTIL RC806-LINE-IDX > RC806-NBR-OF-LINES        31650000
316600             MOVE RC806-BEST-CASE-UNITS (RC806-LINE-IDX)          31660000
316700                                       TO PACK-BEST-CASE-UNITS    31670000
316800                                           (LINE-IDX)             31680000
316900             MOVE RC806-ODD-UNITS (RC806-LINE-IDX)                31690000
317000                                       TO PACK-ODD-UNITS          31700000
317100                                           (LINE-IDX)             31710000
317200             SET LINE-IDX UP BY 1                                 31720000
317300         END-PERFORM                                              31730000
317400         MOVE RC806-BEST-CASE-PACKS    TO PV-SAVE-NBR-OF-PACKS    31740000
317500                                                                  31750000
317600**THIS IS THE AFTER PICTURE OF THE PACK                           31760000
317700         INITIALIZE RC806-PRODUCT-PACK-VALIDATION                 31770000
317800         SET RC806-VALIDATE-AND-CALC      TO TRUE                 31780000
317900         MOVE 1                           TO RC806-INNER-PACK-QTY 31790000
318000         MOVE 0     TO PV-NUMBER-OF-LINES                         31800000
318100         SET RC806-LINE-IDX TO 1                                  31810000
318200         PERFORM VARYING LINE-IDX  FROM PV-SAVE-LINE-IDX BY 1     31820000
318300                 UNTIL PACK-IND (LINE-IDX) NOT = 'Y'              31830000
318400                    OR PACK-PRPPK-ID (LINE-IDX) NOT =             31840000
318500                                              PV-SAVE-PREPK-ID    31850000
318600                    OR LINE-IDX > 500                             31860000
318700             MOVE PACK-LINE (LINE-IDX) TO RC806-PKSL-LNE-NBR      31870000
318800                                           (RC806-LINE-IDX)       31880000
318900             MOVE PACK-RATO (LINE-IDX) TO RC806-PO-RATIO          31890000
319000                                           (RC806-LINE-IDX)       31900000
319100                                          RC806-RC-RATIO          31910000
319200                                           (RC806-LINE-IDX)       31920000
319300             MOVE PACK-AUDIT-QTY (LINE-IDX) TO RC806-UNIT-QTY     31930000
319400                                           (RC806-LINE-IDX)       31940000
319500                                          RC806-RCVG-QTY          31950000
319600                                           (RC806-LINE-IDX)       31960000
319700             ADD 1  TO PV-NUMBER-OF-LINES                         31970000
319800             SET RC806-LINE-IDX UP BY 1                           31980000
319900         END-PERFORM                                              31990000
320000         MOVE PV-NUMBER-OF-LINES   TO RC806-NBR-OF-LINES          32000000
320100                                                                  32010000
320200         PERFORM 5720-VALIDATION-MODULE                           32020000
320300                                                                  32030000
320400         SET LINE-IDX TO PV-SAVE-LINE-IDX                         32040000
320500         PERFORM 5710-PROCESS-LINES                               32050000
320600             VARYING RC806-LINE-IDX                               32060000
320700             FROM 1 BY 1                                          32070000
320800             UNTIL RC806-PKSL-LNE-NBR(RC806-LINE-IDX) = 0 OR      32080000
320900                   SU035-UPDATE-ERROR OR SU035-NO-CHANGE          32090000
321000     END-IF.                                                      32100000
321100     COMPUTE PV-SAVE-LINE-IDX = PV-SAVE-LINE-IDX +                32110000
321200                                  PV-NUMBER-OF-LINES.             32120000
321300                                                                  32130000
321400 5710-PROCESS-LINES.                                              32140000
321500                                                                  32150000
321600     SET PS-NO-PACK-ADJUSTMENT TO TRUE.                           32160000
321700     SET PS-NO-ODD-UNITS-LINE-ADJ TO TRUE.                        32170000
321800     MOVE 0                    TO PV-ADJUST-QTY                   32180000
321900                                  PV-BEFORE-QTY                   32190000
322000                                  PV-AFTER-QTY                    32200000
322100                                  PV-PACK-DIFF                    32210000
322200                                  PV-ODD-DIFF                     32220000
322300                                  PV-ADJ-MINUS-ODD.               32230000
322400                                                                  32240000
322500     IF PACK-CRTN-QTY (LINE-IDX) = PACK-AUDIT-QTY (LINE-IDX)      32250000
322600      AND PV-SAVE-NBR-OF-PACKS = RC806-BEST-CASE-PACKS            32260000
322700      AND PACK-ODD-UNITS (LINE-IDX) =                             32270000
322800                      RC806-ODD-UNITS (RC806-LINE-IDX)            32280000
322900          IF PACK-ODD-UNITS (LINE-IDX) > 0                        32290000
323000             SET PS-ODD-UNIT-ON-OTHER-LINES TO TRUE               32300000
323100         END-IF                                                   32310000
323200     ELSE                                                         32320000
323300                                                                  32330000
323400         PERFORM 5730-SELECT-UPC                                  32340000
323500         MOVE PACK-LINE (LINE-IDX)   TO PC033-PO-LINE-NBR         32350000
323600*****THIS IS THE LINE THAT IS BEING UPDATED - USE THE SAVED       32360000
323700*****FINCL-ADJ-ID                                                 32370000
323800         IF PACK-CRTN-QTY (LINE-IDX) NOT =                        32380000
323900                                      PACK-AUDIT-QTY (LINE-IDX)   32390000
324000             MOVE PV-SAVE-FINCL-ADJ-ID     TO PV-FINCL-ADJ-ID     32400000
324100             SET PS-BACKOUT-NEEDED     TO TRUE                    32410000
324200         ELSE                                                     32420000
324300             PERFORM 2260A-RANDOM-NBR                             32430000
324400             SET PS-NO-BACKOUT-NEEDED   TO TRUE                   32440000
324500         END-IF                                                   32450000
324600         PERFORM 2260C-BUILD-UNIT-ADJ-COMMAREA                    32460000
324700         IF PS-PO-VERIFIED-NO                                     32470000
324800             SET SU035-LOG-ONLY    TO  TRUE                       32480000
324900         ELSE                                                     32490000
325000             SET SU035-LOG-ONLY-NO TO  TRUE                       32500000
325100         END-IF                                                   32510000
325200         IF PC033-DAMAGED-UNITS                                   32520000
325300             MOVE 'PCKR863D' TO SU035-PRC-RSN-CDE                 32530000
325400                                SU035-PROGRAM-NAME                32540000
325500         ELSE                                                     32550000
325600             MOVE 'PCKRF863' TO SU035-PRC-RSN-CDE                 32560000
325700                                SU035-PROGRAM-NAME                32570000
325800         END-IF                                                   32580000
325900*        IF PACK-CRTN-QTY (LINE-IDX) > 0 OR                       32590000
326000*           PACK-AUDIT-QTY (LINE-IDX) > 0                         32600000
326100             MOVE PACK-CRTN-INTR-UPC (LINE-IDX)                   32610000
326200                                           TO DK-INTR-UPC         32620000
326300                                              PV-CARTON-INTR-UPC  32630000
326400             MOVE PACK-CRTN-REC-TYPE (LINE-IDX)                   32640000
326500                                           TO PV-CARTON-REC-TYPE  32650000
326600             MOVE PACK-LINE (LINE-IDX)     TO PV-SAVE-ORD-LNE-NBR 32660000
326700             IF PV-SAVE-NBR-OF-PACKS NOT = RC806-BEST-CASE-PACKS  32670000
326800                 COMPUTE PV-PACK-DIFF =                           32680000
326900                    RC806-BEST-CASE-PACKS - PV-SAVE-NBR-OF-PACKS  32690000
327000                 IF PACK-LINE (LINE-IDX) = PC033-PO-LINE-NBR      32700000
327100                     COMPUTE PV-ADJUST-QTY =                      32710000
327200                     (PV-PACK-DIFF * PACK-RATO (LINE-IDX))        32720000
327300                     COMPUTE PV-BEFORE-QTY =                      32730000
327400                     (PV-SAVE-NBR-OF-PACKS * PACK-RATO (LINE-IDX))32740000
327500                     COMPUTE PV-AFTER-QTY =                       32750000
327600                     (RC806-BEST-CASE-PACKS * PACK-RATO(LINE-IDX))32760000
327700                 ELSE                                             32770000
327800                     COMPUTE PV-BEFORE-QTY =                      32780000
327900                     (PV-SAVE-NBR-OF-PACKS * PACK-RATO (LINE-IDX))32790000
328000                     MOVE PV-BEFORE-QTY  TO  PV-AFTER-QTY         32800000
328100                     MOVE ZEROES         TO  PV-ADJUST-QTY        32810000
328200                 END-IF                                           32820000
328300                 SET PS-PACK-ADJUSTMENT TO TRUE                   32830000
328400                 MOVE PACK-PRPPK-ID (LINE-IDX) TO PV-PACK-ID      32840000
328500                 IF PACK-PREPK-DRV-LNE-CDE (LINE-IDX) = 'A'       32850000
328600                     SET PS-PREPACK-DRIVER TO TRUE                32860000
328700                 END-IF                                           32870000
328800             END-IF                                               32880000
328900                                                                  32890000
329000                                                                  32900000
329100             IF PACK-ODD-UNITS (LINE-IDX) NOT =                   32910000
329200                      RC806-ODD-UNITS (RC806-LINE-IDX)            32920000
329300                 COMPUTE PV-ODD-DIFF =                            32930000
329400                      RC806-ODD-UNITS (RC806-LINE-IDX)            32940000
329500                        - PACK-ODD-UNITS (LINE-IDX)               32950000
329600                 SET PS-ODD-UNITS-LINE-ADJ   TO TRUE              32960000
329700                 MOVE PACK-PRPPK-ID (LINE-IDX)  TO PV-PACK-ID     32970000
329800                 MOVE PACK-ODD-UNITS (LINE-IDX) TO                32980000
329900                                     PV-BEFORE-ODD-UNT-QTY        32990000
330000                 MOVE RC806-ODD-UNITS (RC806-LINE-IDX) TO         33000000
330100                                     PV-AFTER-ODD-UNT-QTY         33010000
330200                 IF PACK-LINE (LINE-IDX) = PC033-PO-LINE-NBR      33020000
330300                     COMPUTE PV-ADJUST-QTY = PV-ADJUST-QTY +      33030000
330400                                            PV-ODD-DIFF           33040000
330500                     COMPUTE PV-BEFORE-QTY = PV-BEFORE-QTY +      33050000
330600                          PACK-ODD-UNITS (LINE-IDX)               33060000
330700                     COMPUTE PV-AFTER-QTY = PV-AFTER-QTY +        33070000
330800                          RC806-ODD-UNITS (RC806-LINE-IDX)        33080000
330900                 END-IF                                           33090000
331000             END-IF                                               33100000
331100*        END-IF                                                   33110000
331200         PERFORM 8500-LINK-SUKUT702                               33120000
331300         IF SU035-COMPLETE                                        33130000
331400           IF PS-BACKOUT-NEEDED                                   33140000
331500             IF PACK-ODD-UNITS (LINE-IDX) NOT =                   33150000
331600                      RC806-ODD-UNITS (RC806-LINE-IDX)            33160000
331700                 SET PS-ODD-UNITS-ADJUSTMENT TO TRUE              33170000
331800                 IF PACK-ODD-UNITS (LINE-IDX) = 0                 33180000
331900                     SET PS-ODD-UNITS-ADDED  TO TRUE              33190000
332000                 ELSE                                             33200000
332100                     IF RC806-ODD-UNITS (RC806-LINE-IDX) = 0      33210000
332200                         SET PS-NO-ODD-UNITS-LEFT  TO TRUE        33220000
332300                     END-IF                                       33230000
332400                 END-IF                                           33240000
332500             END-IF                                               33250000
332600           END-IF                                                 33260000
332700         ELSE                                                     33270000
332800           IF PACK-ODD-UNITS (LINE-IDX) NOT =                     33280000
332900                    RC806-ODD-UNITS (RC806-LINE-IDX)              33290000
333000               SET PS-ODD-UNITS-ADJUSTMENT TO TRUE                33300000
333100               IF RC806-ODD-UNITS (RC806-LINE-IDX) > 0            33310000
333200                   SET PS-ODD-UNIT-ON-OTHER-LINES TO TRUE         33320000
333300               END-IF                                             33330000
333400           END-IF                                                 33340000
333500         END-IF                                                   33350000
333600     END-IF.                                                      33360000
333700     SET LINE-IDX UP BY 1.                                        33370000
333800     SET PS-NOT-PREPACK-DRIVER TO TRUE.                           33380000
333900                                                                  33390000
334000 5720-VALIDATION-MODULE.                                          33400000
334100                                                                  33410000
334200     EXEC CICS LINK                                               33420000
334300         PROGRAM  (PC-RCKCS806)                                   33430000
334400         COMMAREA (RC806-PRODUCT-PACK-VALIDATION)                 33440000
334500         RESP     (PV-CICS-RESPONSE)                              33450000
334600     END-EXEC.                                                    33460000
334700                                                                  33470000
334800     IF PV-CICS-RESPONSE = DFHRESP(NORMAL)                        33480000
334900         CONTINUE                                                 33490000
335000     ELSE                                                         33500000
335100         MOVE 56                  TO PV-ERROR-NBR                 33510000
335200                                     PC033-ERROR-NBR              33520000
335300         MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER             33530000
335400         MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR          33540000
335500         MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR     33550000
335600         MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR      33560000
335700         PERFORM 9903-WRITE-CICS-LOG                              33570000
335800         MOVE '5720-VALIDATION-MODULE'  TO PC033-PARAGRAPH        33580000
335900         MOVE 'PCKRF863 '         TO PC033-MESSAGE-TEXT(1)        33590000
336000         MOVE PC033-PO-NBR        TO PC033-MESSAGE-TEXT(2)        33600000
336100         MOVE SQLCA               TO PC033-SQLCA                  33610000
336200         MOVE 'RCKCS806      '    TO PC033-DB2-TABLE-NAME(1)      33620000
336300         MOVE 'VALIDATION MOD'    TO PC033-DB2-TABLE-NAME(2)      33630000
336400         SET PC033-ABEND          TO TRUE                         33640000
336500         MOVE 99                  TO PC033-PGM-MSG-NBR            33650000
336600         PERFORM 8210-XCTL-ERROR-SCREEN                           33660000
336700     END-IF.                                                      33670000
336800                                                                  33680000
336900 5730-SELECT-UPC.                                                 33690000
337000                                                                  33700000
337100     MOVE PACK-ITM (LINE-IDX) TO DK-ITM-NBR.                      33710000
337200     EXEC SQL                                                     33720000
337300         SELECT A.UPC_NBR                                         33730000
337400           INTO :SUT00028-UPC-NBR                                 33740000
337500           FROM SUT_OTBND_UPC A                                   33750000
337600              , XLT_UPC B                                         33760000
337700              , XLT_SKU C                                         33770000
337800           WHERE A.SHIPT_UNT_ID = :DK-SHIPT-UNT-ID                33780000
337900             AND A.UPC_NBR      = B.UPC_NBR                       33790000
338000             AND B.INTR_UPC_ID  = C.INTR_UPC_ID                   33800000
338100             AND C.ITM_NBR      = :DK-ITM-NBR                     33810000
338200     END-EXEC.                                                    33820000
338300                                                                  33830000
338400     EVALUATE TRUE                                                33840000
338500         WHEN SQLCODE = ZERO                                      33850000
338600         WHEN SQLCODE = -811                                      33860000
338700             MOVE SUT00028-UPC-NBR    TO PC033-UPC-NBR            33870000
338800                                         DK-UPC-NBR               33880000
338900         WHEN SQLCODE = -904                                      33890000
339000         WHEN SQLCODE = -913                                      33900000
339100         WHEN SQLCODE = -911                                      33910000
339200             MOVE 90              TO PV-ERROR-NBR                 33920000
339300             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         33930000
339400             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      33940000
339500             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 33950000
339600             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  33960000
339700             MOVE DK-ITM-NBR             TO PV-ERROR-QTY          33970000
339800             PERFORM 9903-WRITE-CICS-LOG                          33980000
339900             PERFORM 9000-SOFT-ABORT                              33990000
340000         WHEN SQLWARN0 NOT = SPACES                               34000000
340100         WHEN SQLCODE < +0                                        34010000
340200         WHEN SQLCODE > +0                                        34020000
340300             MOVE 91              TO PV-ERROR-NBR                 34030000
340400                                     PC033-ERROR-NBR              34040000
340500             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         34050000
340600             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      34060000
340700             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 34070000
340800             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  34080000
340900             MOVE DK-ITM-NBR             TO PV-ERROR-QTY          34090000
341000             PERFORM 9903-WRITE-CICS-LOG                          34100000
341100             MOVE '5730-SELECT-UPC'         TO PC033-PARAGRAPH    34110000
341200             MOVE 'PCKRF863 - ERROR SELECTING UPC'                34120000
341300                                  TO PC033-MESSAGE-TEXT(1)        34130000
341400             STRING ' CARTON = '                                  34140000
341500                    PV-DISPLAY-SML                                34150000
341600                    ' ITEM = '                                    34160000
341700                    PV-ERROR-QTY  DELIMITED BY SPACES             34170000
341800                               INTO PC033-MESSAGE-TEXT(2)         34180000
341900             MOVE SQLCA           TO PC033-SQLCA                  34190000
342000             MOVE 'SUT00028'      TO PC033-DB2-TABLE-NAME(1)      34200000
342100             MOVE 'XLT00006'      TO PC033-DB2-TABLE-NAME(2)      34210000
342200             MOVE 'XLT00003'      TO PC033-DB2-TABLE-NAME(3)      34220000
342300             SET PC033-ABEND      TO TRUE                         34230000
342400             MOVE 99              TO PC033-PGM-MSG-NBR            34240000
342500             PERFORM 8210-XCTL-ERROR-SCREEN                       34250000
342600     END-EVALUATE.                                                34260000
342700                                                                  34270000
342800                                                                  34280000
342900 6500-CHECK-VIRTUAL-CRTN.                                         34290000
343000*                                                                 34300000
343100     SET PS-BACKOUT-NEEDED   TO TRUE.                             34310000
343200     IF DK-RCVR-SEQ-NBR = ZEROES                                  34320000
343300         MOVE PKSLIP-REC-SEQ-NBR    TO DK-RCVR-SEQ-NBR            34330000
343400     END-IF.                                                      34340000
343500                                                                  34350000
343600     EXEC SQL                                                     34360000
343700         SELECT A.SHIPT_UNT_ID                                    34370000
343800         INTO :SUT00028-SHIPT-UNT-ID                              34380000
343900         FROM SUT_OTBND_UPC  A                                    34390000
344000             ,SUT_OTBND_CART B                                    34400000
344100         WHERE   A.TRN_NBR            = :PC033-PO-NBR             34410000
344200             AND A.RCVR_SEQ_NBR       = :DK-RCVR-SEQ-NBR          34420000
344300             AND A.TRN_TYP_CDE        = 'PO'                      34430000
344400             AND A.SHIPT_UNT_ID       = B.SHIPT_UNT_ID            34440000
344500             AND B.CART_SRC_CDE       = 'DMG'                     34450000
344600     END-EXEC.                                                    34460000
344700                                                                  34470000
344800     EVALUATE TRUE                                                34480000
344900         WHEN SQLCODE = ZERO                                      34490000
345000         WHEN SQLCODE = -811                                      34500000
345100             MOVE SUT00028-SHIPT-UNT-ID  TO DK-SHIPT-UNT-ID       34510000
345200             SET PS-DAMAGED-YES          TO TRUE                  34520000
345300             PERFORM 6510-SELECT-OTBND-UPC                        34530000
345400         WHEN SQLCODE = +100                                      34540000
345500             PERFORM 6600-INSERT-VIRTUAL-CRTN                     34550000
345600         WHEN SQLCODE = -904                                      34560000
345700         WHEN SQLCODE = -913                                      34570000
345800         WHEN SQLCODE = -911                                      34580000
345900             MOVE 80              TO PV-ERROR-NBR                 34590000
346000             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         34600000
346100             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      34610000
346200             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 34620000
346300             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  34630000
346400             PERFORM 9903-WRITE-CICS-LOG                          34640000
346500             PERFORM 9000-SOFT-ABORT                              34650000
346600         WHEN SQLWARN0 NOT = SPACES                               34660000
346700         WHEN SQLCODE < +0                                        34670000
346800         WHEN SQLCODE > +0                                        34680000
346900             MOVE 81              TO PV-ERROR-NBR                 34690000
347000                                     PC033-ERROR-NBR              34700000
347100             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         34710000
347200             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      34720000
347300             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 34730000
347400             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  34740000
347500             PERFORM 9903-WRITE-CICS-LOG                          34750000
347600             MOVE '6500-CHECK-VIRTUAL-CRTN' TO PC033-PARAGRAPH    34760000
347700             MOVE 'PCKRF863 - ERROR SELECTING VIRTUAL'            34770000
347800                                  TO PC033-MESSAGE-TEXT(1)        34780000
347900             MOVE SQLCA           TO PC033-SQLCA                  34790000
348000             MOVE 'SUT0028'       TO PC033-DB2-TABLE-NAME(1)      34800000
348100             SET PC033-ABEND      TO TRUE                         34810000
348200             MOVE 99              TO PC033-PGM-MSG-NBR            34820000
348300             PERFORM 8210-XCTL-ERROR-SCREEN                       34830000
348400     END-EVALUATE.                                                34840000
348500                                                                  34850000
348600 6510-SELECT-OTBND-UPC.                                           34860000
348700     EXEC SQL                                                     34870000
348800         SELECT  SHPD_UNT_QTY                                     34880000
348900         INTO   :SUT00028-SHPD-UNT-QTY                            34890000
349000         FROM   SUT_OTBND_UPC                                     34900000
349100         WHERE  UPC_NBR          = :PC033-UPC-NBR                 34910000
349200           AND  SHIPT_UNT_ID     = :DK-SHIPT-UNT-ID               34920000
349300           AND  TRN_NBR          = :PC033-PO-NBR                  34930000
349400           AND  RCVR_SEQ_NBR     = :DK-RCVR-SEQ-NBR               34940000
349500           AND  TRN_LNE_NBR      = :PC033-PO-LINE-NBR             34950000
349600           AND  TRN_TYP_CDE      = 'PO'                           34960000
349700     END-EXEC.                                                    34970000
349800                                                                  34980000
349900     EVALUATE TRUE                                                34990000
350000         WHEN SQLCODE = ZERO                                      35000000
350100             PERFORM 6520-UPDATE-CARTON-QTY                       35010000
350200         WHEN SQLCODE = +100                                      35020000
350300             COMPUTE PV-ADJ-AMT =  PV-ADJ-BEF-QTY - PV-ADJ-TO-QTY 35030000
350400             MOVE PV-ADJ-AMT        TO PV-ADJ-TO-QTY              35040000
350500                                       SUT00028-SHPD-UNT-QTY      35050000
350600             MOVE PC033-PO-LINE-NBR TO SUT00028-TRN-LNE-NBR       35060000
350700             PERFORM 6530-INSERT-OTBND-UPC                        35070000
350800             MOVE  'PCKR863D'           TO SU035-PRC-RSN-CDE      35080000
350900             MOVE ZEROES TO PV-ADJ-BEF-QTY                        35090000
351000             PERFORM 7000-INSERT-TSUQADJ                          35100000
351100             PERFORM 2260C-BUILD-UNIT-ADJ-COMMAREA                35110000
351200             MOVE  'PCKR863D'           TO SU035-PRC-RSN-CDE      35120000
351300                                           SU035-PROGRAM-NAME     35130000
351400             SET PS-ODD-UNITS-LINE-ADJ    TO TRUE                 35140000
351500             IF PS-PO-PREPK-YES                                   35150000
351600                 MOVE PV-ADJ-BEF-QTY  TO SU035-BEFORE-ODD-UNT-QTY 35160000
351700                                         SU035-BEFORE-QTY         35170000
351800                                         PV-BEFORE-ODD-UNT-QTY    35180000
351900                 MOVE PV-ADJ-TO-QTY   TO SU035-AFTER-ODD-UNT-QTY  35190000
352000                                         SU035-AFTER-QTY          35200000
352100                                         PV-AFTER-ODD-UNT-QTY     35210000
352200             ELSE                                                 35220000
352300                 MOVE PV-ADJ-BEF-QTY  TO SU035-BEFORE-QTY         35230000
352400                 MOVE PV-ADJ-TO-QTY   TO SU035-AFTER-QTY          35240000
352500                 MOVE ZEROES          TO SU035-BEFORE-ODD-UNT-QTY 35250000
352600                                         SU035-AFTER-ODD-UNT-QTY  35260000
352700                                         PV-BEFORE-ODD-UNT-QTY    35270000
352800                                         PV-AFTER-ODD-UNT-QTY     35280000
352900             END-IF                                               35290000
353000             PERFORM 8500-LINK-SUKUT702                           35300000
353100         WHEN SQLCODE = -803                                      35310000
353200         WHEN SQLCODE = -904                                      35320000
353300         WHEN SQLCODE = -913                                      35330000
353400         WHEN SQLCODE = -911                                      35340000
353500             MOVE 105                    TO PV-ERROR-NBR          35350000
353600             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         35360000
353700             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      35370000
353800             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 35380000
353900             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  35390000
354000             PERFORM 9903-WRITE-CICS-LOG                          35400000
354100             PERFORM 9000-SOFT-ABORT                              35410000
354200         WHEN SQLWARN0 NOT = SPACES                               35420000
354300         WHEN SQLCODE < +0                                        35430000
354400         WHEN SQLCODE > +0                                        35440000
354500             MOVE 106             TO PV-ERROR-NBR                 35450000
354600                                     PC033-ERROR-NBR              35460000
354700             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         35470000
354800             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      35480000
354900             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 35490000
355000             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  35500000
355100             PERFORM 9903-WRITE-CICS-LOG                          35510000
355200             MOVE '6510-SELECT-OTBND-UPC  ' TO PC033-PARAGRAPH    35520000
355300             MOVE 'PCKRF863 - ERROR UPDATING VIRTUAL CRTN'        35530000
355400                                  TO PC033-MESSAGE-TEXT(1)        35540000
355500             MOVE SQLCA           TO PC033-SQLCA                  35550000
355600             MOVE 'OTBDUPC'       TO PC033-DB2-TABLE-NAME(1)      35560000
355700             SET PC033-ABEND      TO TRUE                         35570000
355800             MOVE 99              TO PC033-PGM-MSG-NBR            35580000
355900             PERFORM 8210-XCTL-ERROR-SCREEN                       35590000
356000     END-EVALUATE.                                                35600000
356100                                                                  35610000
356200 6520-UPDATE-CARTON-QTY.                                          35620000
356300*                                                                 35630000
356400     COMPUTE PV-ADJ-AMT      =  PV-ADJ-BEF-QTY - PV-ADJ-TO-QTY.   35640000
356500     MOVE  PC033-OPER-UNT-ID     TO  PV-OPER-UNT-ID.              35650000
356600     MOVE  'U'                   TO  PV-ADJ-FUNC-CDE.             35660000
356700     MOVE  PC033-USER-ID         TO  PV-USER-ID.                  35670000
356800                                                                  35680000
356900     EXEC SQL                                                     35690000
357000         UPDATE SUT_OTBND_UPC                                     35700000
357100           SET SHPD_UNT_QTY = :SUT00028-SHPD-UNT-QTY + :PV-ADJ-AMT35710000
357200         WHERE   TRN_NBR              = :PC033-PO-NBR             35720000
357300             AND RCVR_SEQ_NBR         = :DK-RCVR-SEQ-NBR          35730000
357400             AND TRN_LNE_NBR          = :PC033-PO-LINE-NBR        35740000
357500             AND TRN_TYP_CDE          = 'PO'                      35750000
357600             AND SHIPT_UNT_ID         = :DK-SHIPT-UNT-ID          35760000
357700             AND UPC_NBR              = :PC033-UPC-NBR            35770000
357800     END-EXEC.                                                    35780000
357900                                                                  35790000
358000     EVALUATE TRUE                                                35800000
358100         WHEN SQLCODE = ZERO                                      35810000
358200             MOVE SUT00028-SHPD-UNT-QTY TO PV-ADJ-BEF-QTY         35820000
358300             COMPUTE PV-SHPD-UNT-QTY = SUT00028-SHPD-UNT-QTY      35830000
358400                                                     + PV-ADJ-AMT 35840000
358500             MOVE PV-SHPD-UNT-QTY       TO PV-ADJ-TO-QTY          35850000
358600             MOVE  'PCKR863D'           TO SU035-PRC-RSN-CDE      35860000
358700             PERFORM 7000-INSERT-TSUQADJ                          35870000
358800             PERFORM 2260C-BUILD-UNIT-ADJ-COMMAREA                35880000
358900             MOVE  'PCKR863D'           TO SU035-PRC-RSN-CDE      35890000
359000                                           SU035-PROGRAM-NAME     35900000
359100             SET PS-ODD-UNITS-LINE-ADJ    TO TRUE                 35910000
359200             IF PS-PO-PREPK-YES                                   35920000
359300                 MOVE PV-ADJ-BEF-QTY  TO SU035-BEFORE-ODD-UNT-QTY 35930000
359400                                         SU035-BEFORE-QTY         35940000
359500                                         PV-BEFORE-ODD-UNT-QTY    35950000
359600                 MOVE PV-ADJ-TO-QTY   TO SU035-AFTER-ODD-UNT-QTY  35960000
359700                                         SU035-AFTER-QTY          35970000
359800                                         PV-AFTER-ODD-UNT-QTY     35980000
359900             ELSE                                                 35990000
360000                 MOVE PV-ADJ-BEF-QTY  TO SU035-BEFORE-QTY         36000000
360100                 MOVE PV-ADJ-TO-QTY   TO SU035-AFTER-QTY          36010000
360200                 MOVE ZEROES          TO SU035-BEFORE-ODD-UNT-QTY 36020000
360300                                         SU035-AFTER-ODD-UNT-QTY  36030000
360400                                         PV-BEFORE-ODD-UNT-QTY    36040000
360500                                         PV-AFTER-ODD-UNT-QTY     36050000
360600             END-IF                                               36060000
360700             PERFORM 8500-LINK-SUKUT702                           36070000
360800         WHEN SQLCODE = +100                                      36080000
360900             MOVE PV-ADJ-AMT        TO PV-ADJ-TO-QTY              36090000
361000                                       SUT00028-SHPD-UNT-QTY      36100000
361100             MOVE PC033-PO-LINE-NBR TO SUT00028-TRN-LNE-NBR       36110000
361200             PERFORM 6530-INSERT-OTBND-UPC                        36120000
361300             MOVE ZEROES TO PV-ADJ-BEF-QTY                        36130000
361400             MOVE  'PCKR863D'           TO SU035-PRC-RSN-CDE      36140000
361500             PERFORM 7000-INSERT-TSUQADJ                          36150000
361600             PERFORM 2260C-BUILD-UNIT-ADJ-COMMAREA                36160000
361700             MOVE  'PCKR863D'           TO SU035-PRC-RSN-CDE      36170000
361800                                           SU035-PROGRAM-NAME     36180000
361900             SET PS-ODD-UNITS-LINE-ADJ    TO TRUE                 36190000
362000             IF PS-PO-PREPK-YES                                   36200000
362100                 MOVE PV-ADJ-BEF-QTY  TO SU035-BEFORE-ODD-UNT-QTY 36210000
362200                                         SU035-BEFORE-QTY         36220000
362300                                         PV-BEFORE-ODD-UNT-QTY    36230000
362400                 MOVE PV-ADJ-TO-QTY   TO SU035-AFTER-ODD-UNT-QTY  36240000
362500                                         SU035-AFTER-QTY          36250000
362600                                         PV-AFTER-ODD-UNT-QTY     36260000
362700             ELSE                                                 36270000
362800                 MOVE PV-ADJ-BEF-QTY  TO SU035-BEFORE-QTY         36280000
362900                 MOVE PV-ADJ-TO-QTY   TO SU035-AFTER-QTY          36290000
363000                 MOVE ZEROES          TO SU035-BEFORE-ODD-UNT-QTY 36300000
363100                                         SU035-AFTER-ODD-UNT-QTY  36310000
363200                                         PV-BEFORE-ODD-UNT-QTY    36320000
363300                                         PV-AFTER-ODD-UNT-QTY     36330000
363400             END-IF                                               36340000
363500             PERFORM 8500-LINK-SUKUT702                           36350000
363600         WHEN SQLCODE = -803                                      36360000
363700         WHEN SQLCODE = -904                                      36370000
363800         WHEN SQLCODE = -913                                      36380000
363900         WHEN SQLCODE = -911                                      36390000
364000             MOVE 87              TO PV-ERROR-NBR                 36400000
364100             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         36410000
364200             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      36420000
364300             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 36430000
364400             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  36440000
364500             PERFORM 9903-WRITE-CICS-LOG                          36450000
364600             PERFORM 9000-SOFT-ABORT                              36460000
364700         WHEN SQLWARN0 NOT = SPACES                               36470000
364800         WHEN SQLCODE < +0                                        36480000
364900         WHEN SQLCODE > +0                                        36490000
365000             MOVE 88              TO PV-ERROR-NBR                 36500000
365100                                     PC033-ERROR-NBR              36510000
365200             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         36520000
365300             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      36530000
365400             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 36540000
365500             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  36550000
365600             PERFORM 9903-WRITE-CICS-LOG                          36560000
365700             MOVE '6520-UPDATE-CARTON-QTY ' TO PC033-PARAGRAPH    36570000
365800             MOVE 'PCKRF863 - ERROR UPDATING VIRTUAL CRTN'        36580000
365900                                  TO PC033-MESSAGE-TEXT(1)        36590000
366000             MOVE SQLCA           TO PC033-SQLCA                  36600000
366100             MOVE 'OTBDUPC'       TO PC033-DB2-TABLE-NAME(1)      36610000
366200             SET PC033-ABEND      TO TRUE                         36620000
366300             MOVE 99              TO PC033-PGM-MSG-NBR            36630000
366400             PERFORM 8210-XCTL-ERROR-SCREEN                       36640000
366500     END-EVALUATE.                                                36650000
366600                                                                  36660000
366700*                                                                 36670000
366800 6530-INSERT-OTBND-UPC.                                           36680000
366900*                                                                 36690000
367000     MOVE DK-SHIPT-UNT-ID          TO SUT00028-SHIPT-UNT-ID.      36700000
367100     MOVE PC033-PO-NBR             TO SUT00028-TRN-NBR            36710000
367200     MOVE DK-RCVR-SEQ-NBR          TO SUT00028-RCVR-SEQ-NBR       36720000
367300     MOVE 'PO'                     TO SUT00028-TRN-TYP-CDE        36730000
367400     MOVE PC033-UPC-NBR            TO SUT00028-UPC-NBR.           36740000
367500     MOVE PC033-OPER-UNT-ID        TO PV-OPER-UNT-ID.             36750000
367600     MOVE 'U'                      TO PV-ADJ-FUNC-CDE.            36760000
367700     MOVE  PC033-USER-ID           TO PV-USER-ID.                 36770000
367800                                                                  36780000
367900     EXEC SQL                                                     36790000
368000         INSERT INTO SUT_OTBND_UPC                                36800000
368100             ( SHIPT_UNT_ID                                       36810000
368200              ,TRN_NBR                                            36820000
368300              ,RCVR_SEQ_NBR                                       36830000
368400              ,TRN_LNE_NBR                                        36840000
368500              ,TRN_TYP_CDE                                        36850000
368600              ,UPC_NBR                                            36860000
368700              ,SHPD_UNT_QTY)                                      36870000
368800         VALUES (:SUT00028-SHIPT-UNT-ID                           36880000
368900                ,:SUT00028-TRN-NBR                                36890000
369000                ,:SUT00028-RCVR-SEQ-NBR                           36900000
369100                ,:SUT00028-TRN-LNE-NBR                            36910000
369200                ,:SUT00028-TRN-TYP-CDE                            36920000
369300                ,:SUT00028-UPC-NBR                                36930000
369400                ,:SUT00028-SHPD-UNT-QTY )                         36940000
369500     END-EXEC                                                     36950000
369600                                                                  36960000
369700     EVALUATE TRUE                                                36970000
369800         WHEN SQLCODE = ZERO                                      36980000
369810             SET PS-CART-UPC-UPDATED TO TRUE                      36981000
370000         WHEN SQLCODE = -803                                      37000000
370100         WHEN SQLCODE = -904                                      37010000
370200         WHEN SQLCODE = -913                                      37020000
370300         WHEN SQLCODE = -911                                      37030000
370400             MOVE 83              TO PV-ERROR-NBR                 37040000
370500             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         37050000
370600             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      37060000
370700             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 37070000
370800             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  37080000
370900             PERFORM 9903-WRITE-CICS-LOG                          37090000
371000             PERFORM 9000-SOFT-ABORT                              37100000
371100         WHEN SQLWARN0 NOT = SPACES                               37110000
371200         WHEN SQLCODE < +0                                        37120000
371300         WHEN SQLCODE > +0                                        37130000
371400             MOVE 84              TO PV-ERROR-NBR                 37140000
371500                                     PC033-ERROR-NBR              37150000
371600             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         37160000
371700             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      37170000
371800             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 37180000
371900             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  37190000
372000             PERFORM 9903-WRITE-CICS-LOG                          37200000
372100             MOVE '6530-INSERT-OTBND-UPC  ' TO PC033-PARAGRAPH    37210000
372200             MOVE 'PCKRF863 - ERROR UPDATING VIRTUAL CRTN'        37220000
372300                                  TO PC033-MESSAGE-TEXT(1)        37230000
372400             MOVE SQLCA           TO PC033-SQLCA                  37240000
372500             MOVE 'PKD-UPC'       TO PC033-DB2-TABLE-NAME(1)      37250000
372600             SET PC033-ABEND      TO TRUE                         37260000
372700             PERFORM 8210-XCTL-ERROR-SCREEN                       37270000
372800     END-EVALUATE.                                                37280000
372900                                                                  37290000
373000 6600-INSERT-VIRTUAL-CRTN.                                        37300000
373100                                                                  37310000
373200      INITIALIZE PC187-COMMAREA-REC.                              37320000
373300      INITIALIZE PC160-20-DIGIT-BARCODE.                          37330000
373400      MOVE PC033-OPER-UNT-ID     TO PC187-STR-NBR.                37340000
373500      MOVE  +1                   TO PC187-NO-OF-LBLS.             37350000
373600      PERFORM 6700-LINK-PCKCS721.                                 37360000
373700      MOVE PC187-START-MFST-NBR TO PV-LBL-MANIFEST-NBR.           37370000
373800      MOVE PV-LBL-MANIFEST-NBR  TO PV-LBL-MANI-NBR.               37380000
373900      MOVE PV-LBL-MANI-NBR      TO PC160-20-SML-BC-MNFST-NBR.     37390000
374000      MOVE ZEROES               TO PC160-20-SML-CONTAINER-CDE     37400000
374100      SET  PC160-20-SML-INTERNAL-LBL                              37410000
374200           PC160-20-SML-FROM-KOHLS                                37420000
374300           PC160-20-SML-INTERNAL-LBL   TO TRUE                    37430000
374400      MOVE PC033-OPER-UNT-ID       TO PC160-20-SML-BC-DIVERT-CDE  37440000
374500      MOVE RECEIV-CURR-OPER-UNT-ID TO PC160-20-SML-BC-DC-ORIGIN   37450000
374600                                                                  37460000
374700      MOVE PC160-20-DIGIT-BARCODE      TO DK-BARCODE-NBR.         37470000
374800                                                                  37480000
374900      PERFORM 6650-PROCESS-INSERTS-TO-OTBND.                      37490000
375000                                                                  37500000
375100*----------------------------------------------------------------*37510000
375200 6650-PROCESS-INSERTS-TO-OTBND.                                   37520000
375300      PERFORM 6660-INSERT-OTBND-CART.                             37530000
375400      PERFORM 6670-INSERT-OTBND-UPC.                              37540000
375500      MOVE  PC033-OPER-UNT-ID     TO  PV-OPER-UNT-ID.             37550000
375600      MOVE  'U'                   TO  PV-ADJ-FUNC-CDE.            37560000
375700      MOVE  'PCKR863D'            TO  SU035-PRC-RSN-CDE.          37570000
375800      MOVE  PC033-USER-ID         TO  PV-USER-ID.                 37580000
375900      MOVE SUT00024-SHIPT-UNT-ID  TO  DK-SHIPT-UNT-ID.            37590000
376000      MOVE ZEROES                 TO  PV-ADJ-BEF-QTY              37600000
376100      MOVE PV-ADJ-AMT             TO  PV-ADJ-TO-QTY.              37610000
376200      PERFORM 7000-INSERT-TSUQADJ.                                37620000
376300      PERFORM 2260C-BUILD-UNIT-ADJ-COMMAREA.                      37630000
376400      MOVE  'PCKR863D'            TO  SU035-PRC-RSN-CDE           37640000
376500                                      SU035-PROGRAM-NAME.         37650000
376600      SET PS-ODD-UNITS-LINE-ADJ    TO TRUE.                       37660000
376700      IF PS-PO-PREPK-YES                                          37670000
376800          MOVE PV-ADJ-BEF-QTY  TO SU035-BEFORE-ODD-UNT-QTY        37680000
376900                                  SU035-BEFORE-QTY                37690000
377000                                  PV-BEFORE-ODD-UNT-QTY           37700000
377100          MOVE PV-ADJ-TO-QTY   TO SU035-AFTER-ODD-UNT-QTY         37710000
377200                                  SU035-AFTER-QTY                 37720000
377300                                  PV-AFTER-ODD-UNT-QTY            37730000
377400      ELSE                                                        37740000
377500          MOVE PV-ADJ-BEF-QTY  TO SU035-BEFORE-QTY                37750000
377600          MOVE PV-ADJ-TO-QTY   TO SU035-AFTER-QTY                 37760000
377700          MOVE ZEROES          TO SU035-BEFORE-ODD-UNT-QTY        37770000
377800                                  SU035-AFTER-ODD-UNT-QTY         37780000
377900                                  PV-BEFORE-ODD-UNT-QTY           37790000
378000                                  PV-AFTER-ODD-UNT-QTY            37800000
378100      END-IF.                                                     37810000
378200      PERFORM 8500-LINK-SUKUT702.                                 37820000
378300                                                                  37830000
378400*----------------------------------------------------------------*37840000
378500 6660-INSERT-OTBND-CART.                                          37850000
378600                                                                  37860000
378700      INITIALIZE DCLSUT00024.                                     37870000
378800      MOVE DK-BARCODE-NBR          TO PV-BAR-CODE.                37880000
378900      MOVE PV-BAR-CODE-OTBND       TO SUT00024-SHIPT-UNT-ID       37890000
379000                                      SUT00024-PRNT-CART-ID       37900000
379010                                      SUT00024-ORIG-CART-ID.      37901000
379100      MOVE RECEIV-CURR-OPER-UNT-ID TO SUT00024-ORGN-LOC-NBR.      37910000
379200      MOVE PC033-OPER-UNT-ID       TO SUT00024-DEST-LOC-NBR.      37920000
379300      MOVE 'DMG'                   TO SUT00024-CART-SRC-CDE.      37930000
379400      MOVE PC033-USER-ID           TO SUT00024-CRE-USR-ID.        37940000
379500      MOVE 'PCKRF863'              TO SUT00024-CRE-PGM-NM.        37950000
379600      MOVE 'N'                     TO SUT00024-MSTR-CART-IND.     37960000
379800      MOVE 'Y'                     TO SUT00024-ACTV-IND.          37980000
379900      IF PS-PO-PREPK-YES                                          37990000
380000          MOVE 'Y'                 TO SUT00024-ODD-UNT-IND        38000000
380100      ELSE                                                        38010000
380200          MOVE 'N'                 TO SUT00024-ODD-UNT-IND        38020000
380300      END-IF.                                                     38030000
380400      MOVE 'F'                     TO SUT00024-CART-TYP-CDE.      38040000
380500                                                                  38050000
380600     EXEC SQL                                                     38060000
380700         INSERT INTO SUT_OTBND_CART                               38070000
380800             ( SHIPT_UNT_ID                                       38080000
380900              ,ORGN_LOC_NBR                                       38090000
381000              ,DEST_LOC_NBR                                       38100000
381100              ,CART_SRC_CDE                                       38110000
381200              ,CRE_DTE                                            38120000
381300              ,CRE_TM                                             38130000
381400              ,CRE_USR_ID                                         38140000
381500              ,CRE_PGM_NM                                         38150000
381600              ,MSTR_CART_IND                                      38160000
381700              ,PRNT_CART_ID                                       38170000
381800              ,ORIG_CART_ID                                       38180000
381900              ,CART_TYP_CDE                                       38190000
382000              ,LBL_PRT_SEQ_NBR                                    38200000
382100              ,CART_RVSN_NBR                                      38210000
382200              ,OTBND_TRIP_ID                                      38220000
382300              ,ACTV_IND                                           38230000
382400              ,ODD_UNT_IND)                                       38240000
382500         VALUES (:SUT00024-SHIPT-UNT-ID                           38250000
382600                ,:SUT00024-ORGN-LOC-NBR                           38260000
382700                ,:SUT00024-DEST-LOC-NBR                           38270000
382800                ,:SUT00024-CART-SRC-CDE                           38280000
382900                , CURRENT DATE                                    38290000
383000                , CURRENT TIME                                    38300000
383100                ,:SUT00024-CRE-USR-ID                             38310000
383200                ,:SUT00024-CRE-PGM-NM                             38320000
383300                ,:SUT00024-MSTR-CART-IND                          38330000
383400                ,:SUT00024-PRNT-CART-ID                           38340000
383500                ,:SUT00024-ORIG-CART-ID                           38350000
383600                ,:SUT00024-CART-TYP-CDE                           38360000
383700                , 0                                               38370000
383800                , 0                                               38380000
383900                , NULL                                            38390000
384000                ,:SUT00024-ACTV-IND                               38400000
384100                ,:SUT00024-ODD-UNT-IND)                           38410000
384200     END-EXEC                                                     38420000
384300                                                                  38430000
384400     EVALUATE TRUE                                                38440000
384500         WHEN SQLCODE = ZERO                                      38450000
384600             SET PS-DAMAGED-YES          TO TRUE                  38460000
384700         WHEN SQLCODE = -904                                      38470000
384800         WHEN SQLCODE = -913                                      38480000
384900         WHEN SQLCODE = -911                                      38490000
385000             MOVE 86              TO PV-ERROR-NBR                 38500000
385100             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         38510000
385200             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      38520000
385300             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 38530000
385400             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  38540000
385500             PERFORM 9903-WRITE-CICS-LOG                          38550000
385600             PERFORM 9000-SOFT-ABORT                              38560000
385700         WHEN SQLWARN0 NOT = SPACES                               38570000
385800         WHEN SQLCODE < +0                                        38580000
385900         WHEN SQLCODE > +0                                        38590000
386000             MOVE 87              TO PV-ERROR-NBR                 38600000
386100                                     PC033-ERROR-NBR              38610000
386200             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         38620000
386300             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      38630000
386400             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 38640000
386500             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  38650000
386600             PERFORM 9903-WRITE-CICS-LOG                          38660000
386700             MOVE '6660-INSERT-OTBND-CART ' TO PC033-PARAGRAPH    38670000
386800             MOVE 'PCKRF863 - ERROR UPDATING OUTBND CRTN'         38680000
386900                                  TO PC033-MESSAGE-TEXT(1)        38690000
387000             MOVE SQLCA           TO PC033-SQLCA                  38700000
387100             MOVE 'OTBDCTN'       TO PC033-DB2-TABLE-NAME(1)      38710000
387200             SET PC033-ABEND      TO TRUE                         38720000
387300             PERFORM 8210-XCTL-ERROR-SCREEN                       38730000
387400     END-EVALUATE.                                                38740000
387500                                                                  38750000
387600*----------------------------------------------------------------*38760000
387700 6670-INSERT-OTBND-UPC.                                           38770000
387800     MOVE SUT00024-SHIPT-UNT-ID    TO SUT00028-SHIPT-UNT-ID.      38780000
387900     MOVE PC033-PO-NBR             TO SUT00028-TRN-NBR            38790000
388000     MOVE DK-RCVR-SEQ-NBR          TO SUT00028-RCVR-SEQ-NBR       38800000
388100     MOVE PC033-PO-LINE-NBR        TO SUT00028-TRN-LNE-NBR        38810000
388200     MOVE 'PO'                     TO SUT00028-TRN-TYP-CDE        38820000
388300     MOVE PC033-UPC-NBR            TO SUT00028-UPC-NBR            38830000
388400     COMPUTE PV-ADJ-AMT   =  PV-ADJ-BEF-QTY - PV-ADJ-TO-QTY.      38840000
388500     MOVE PV-ADJ-AMT               TO SUT00028-SHPD-UNT-QTY       38850000
388600                                                                  38860000
388700     EXEC SQL                                                     38870000
388800         INSERT INTO SUT_OTBND_UPC                                38880000
388900             ( SHIPT_UNT_ID                                       38890000
389000              ,TRN_NBR                                            38900000
389100              ,RCVR_SEQ_NBR                                       38910000
389200              ,TRN_LNE_NBR                                        38920000
389300              ,TRN_TYP_CDE                                        38930000
389400              ,UPC_NBR                                            38940000
389500              ,SHPD_UNT_QTY)                                      38950000
389600         VALUES (:SUT00028-SHIPT-UNT-ID                           38960000
389700                ,:SUT00028-TRN-NBR                                38970000
389800                ,:SUT00028-RCVR-SEQ-NBR                           38980000
389900                ,:SUT00028-TRN-LNE-NBR                            38990000
390000                ,:SUT00028-TRN-TYP-CDE                            39000000
390100                ,:SUT00028-UPC-NBR                                39010000
390200                ,:SUT00028-SHPD-UNT-QTY)                          39020000
390300     END-EXEC                                                     39030000
390400                                                                  39040000
390500         EVALUATE TRUE                                            39050000
390600             WHEN SQLCODE = ZERO                                  39060000
390700                CONTINUE                                          39070000
390800             WHEN SQLWARN0 NOT = SPACES                           39080000
390900             WHEN SQLCODE < ZERO                                  39090000
391000             WHEN SQLCODE > ZERO                                  39100000
391100                 MOVE '6670-INSERT-OTBND-UPC '                    39110000
391200                                   TO DP013-PARAGRAPH             39120000
391300                 MOVE 'INSERT INTO TABLE  - '                     39130000
391400                                   TO DP013-MESSAGE-TEXT (1)      39140000
391500                 MOVE SQLCA        TO DP013-SQLCA                 39150000
391600                 MOVE 'SUT_OTBND_UPC  '                           39160000
391700                                   TO DP013-DB2-TABLE-NAME (1)    39170000
391800                 SET DP013-DB2-ABEND                              39180000
391900                     DP013-XCTL-DISPLAY-RESTART TO TRUE           39190000
392000                 SET DP013-ROLLBACK  TO TRUE                      39200000
392100                 PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG           39210000
392200         END-EVALUATE.                                            39220000
392300                                                                  39230000
392400*----------------------------------------------------------------*39240000
392500 6700-LINK-PCKCS721.                                              39250000
392600                                                                  39260000
392700     MOVE LENGTH OF PC187-COMMAREA-REC TO PV-COMMAREA-LENGTH.     39270000
392800     EXEC CICS                                                    39280000
392900         LINK PROGRAM  ('PCKCS721')                               39290000
393000              COMMAREA (PC187-COMMAREA-REC)                       39300000
393100              LENGTH   (PV-COMMAREA-LENGTH)                       39310000
393200              RESP     (PV-CICS-RESPONSE)                         39320000
393300     END-EXEC.                                                    39330000
393400                                                                  39340000
393500     EVALUATE TRUE                                                39350000
393600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 39360000
393700              IF  PC187-CRA-SUCCESSFUL                            39370000
393800                  CONTINUE                                        39380000
393900              ELSE                                                39390000
394000                 INITIALIZE PV-CICS-MSG-AREA                      39400000
394100                 MOVE PC033-PO-NBR       TO PV-ERROR-ORD-NBR      39410000
394200                 MOVE PC033-RCVR-SEQ-NBR-CTN TO                   39420000
394300                                            PV-ERROR-RCVR-SEQ-NBR 39430000
394400                 MOVE PC033-PO-LINE-NBR  TO PV-ERROR-ORD-LNE-NBR  39440000
394500                 MOVE PC033-STR-NBR      TO PV-ERROR-STR-NBR      39450000
394600                                                                  39460000
394700                 STRING 'PCKRF863 - 6700-LINK-PCKCS721 '          39470000
394800                    ' - CALL BARCODE SEQUENCE NBR'                39480000
394900                                      DELIMITED BY SIZE           39490000
395000                                 INTO PV-CICS-MSG-AREA            39500000
395100                 PERFORM 9990-WRITE-CICS                          39510000
395200                                                                  39520000
395300                 INITIALIZE PV-CICS-MSG-AREA                      39530000
395400                 STRING 'PCKRF863 - PO-RCVR - '                   39540000
395500                         PV-ERROR-ORD-NBR '-'                     39550000
395600                         PV-ERROR-RCVR-SEQ-NBR '-'                39560000
395700                         PV-ERROR-ORD-LNE-NBR                     39570000
395800                        ' STORE= ' PV-ERROR-STR-NBR               39580000
395900                                      DELIMITED BY SIZE           39590000
396000                                 INTO PV-CICS-MSG-AREA            39600000
396100                 PERFORM 9990-WRITE-CICS                          39610000
396200                 MOVE 85                  TO PV-ERROR-NBR         39620000
396300                                             PC033-ERROR-NBR      39630000
396400                 PERFORM 9903-WRITE-CICS-LOG                      39640000
396500                 MOVE '6700-LINK-PCKCS721'  TO PC033-PARAGRAPH    39650000
396600                 MOVE 'PCKRF863 '         TO PC033-MESSAGE-TEXT(1)39660000
396700                 MOVE 'ERROR IN PCKCS721' TO PC033-MESSAGE-TEXT(2)39670000
396800                 MOVE SQLCA             TO PC033-SQLCA            39680000
396900                 MOVE 'PCKCS721    '    TO PC033-DB2-TABLE-NAME(1)39690000
397000                 SET PC033-ABEND          TO TRUE                 39700000
397100                 PERFORM 8210-XCTL-ERROR-SCREEN                   39710000
397200             END-IF                                               39720000
397300     END-EVALUATE.                                                39730000
397400                                                                  39740000
397500 6800-SELECT-UPC-NBR-4-LINE.                                      39750000
397600*                                                                 39760000
397700     MOVE RC806-PKSL-LNE-NBR(RC806-LINE-IDX) TO DK-LNE-NBR.       39770000
397800     MOVE PC033-RCVR-SEQ-NBR-CTN             TO DK-RCVR-SEQ-NBR.  39780000
397900     EXEC SQL                                                     39790000
398000         SELECT UPC_NBR                                           39800000
398100         INTO :SUT00028-UPC-NBR                                   39810000
398200         FROM SUT_OTBND_UPC                                       39820000
398300         WHERE   TRN_NBR            = :PC033-PO-NBR               39830000
398400             AND RCVR_SEQ_NBR       = :DK-RCVR-SEQ-NBR            39840000
398500             AND TRN_LNE_NBR        = :DK-LNE-NBR                 39850000
398600             AND SHIPT_UNT_ID       = :DK-SHIPT-UNT-ID            39860000
398700     END-EXEC.                                                    39870000
398800                                                                  39880000
398900     EVALUATE TRUE                                                39890000
399000         WHEN SQLCODE = ZERO                                      39900000
399100         WHEN SQLCODE = -811                                      39910000
399200         WHEN SQLCODE = +100                                      39920000
399300             CONTINUE                                             39930000
399400         WHEN SQLCODE = -904                                      39940000
399500         WHEN SQLCODE = -913                                      39950000
399600         WHEN SQLCODE = -911                                      39960000
399700             MOVE        80              TO PV-ERROR-NBR          39970000
399800             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         39980000
399900             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      39990000
400000             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 40000000
400100             MOVE DK-LNE-NBR             TO PV-ERROR-ORD-LNE-NBR  40010000
400200             PERFORM 9903-WRITE-CICS-LOG                          40020000
400300             PERFORM 9000-SOFT-ABORT                              40030000
400400         WHEN SQLWARN0 NOT = SPACES                               40040000
400500         WHEN SQLCODE < +0                                        40050000
400600         WHEN SQLCODE > +0                                        40060000
400700             MOVE 81              TO PV-ERROR-NBR                 40070000
400800                                     PC033-ERROR-NBR              40080000
400900             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         40090000
401000             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      40100000
401100             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 40110000
401200             MOVE DK-LNE-NBR             TO PV-ERROR-ORD-LNE-NBR  40120000
401300             PERFORM 9903-WRITE-CICS-LOG                          40130000
401400             MOVE '6800-SELECT-UPC-NBR-4-LINE' TO PC033-PARAGRAPH 40140000
401500             MOVE 'PCKRF863 - ERROR SELECTING UPC/LINE'           40150000
401600                                  TO PC033-MESSAGE-TEXT(1)        40160000
401700             MOVE SQLCA           TO PC033-SQLCA                  40170000
401800             MOVE 'SUT0028'       TO PC033-DB2-TABLE-NAME(1)      40180000
401900             SET PC033-ABEND      TO TRUE                         40190000
402000             MOVE 99              TO PC033-PGM-MSG-NBR            40200000
402100             PERFORM 8210-XCTL-ERROR-SCREEN                       40210000
402200     END-EVALUATE.                                                40220000
402300                                                                  40230000
402400 7000-INSERT-TSUQADJ.                                             40240000
402500                                                                  40250000
402600     IF PS-DO-UNIT-ADJ-YES                                        40260000
402700         PERFORM 2260A-RANDOM-NBR                                 40270000
402800         MOVE PV-FINCL-ADJ-ID         TO SUQADJ-FINCL-ADJ-ID      40280000
402900     ELSE                                                         40290000
403000         MOVE ZERO                    TO SUQADJ-FINCL-ADJ-ID      40300000
403100     END-IF                                                       40310000
403200                                                                  40320000
403300     EXEC SQL                                                     40330000
403400         INSERT INTO TSUQADJ                                      40340000
403500         (                                                        40350000
403600          SHIPT_UNT_ID                                            40360000
403700         ,UPC_NBR                                                 40370000
403800         ,ADJ_TMST                                                40380000
403900         ,OPER_UNT_ID                                             40390000
404000         ,ADJ_FUNC_CDE                                            40400000
404100         ,ADJ_BEF_QTY                                             40410000
404200         ,ADJ_AFT_QTY                                             40420000
404300         ,PRC_RSN_CDE                                             40430000
404400         ,ADJ_USR_ID                                              40440000
404500         ,FINCL_ADJ_ID                                            40450000
404600         )                                                        40460000
404700         VALUES                                                   40470000
404800         (                                                        40480000
404900          :DK-SHIPT-UNT-ID                                        40490000
405000         ,:PC033-UPC-NBR                                          40500000
405100         ,CURRENT TIMESTAMP                                       40510000
405200         ,:PV-OPER-UNT-ID                                         40520000
405300         ,:PV-ADJ-FUNC-CDE                                        40530000
405400         ,:PV-ADJ-BEF-QTY                                         40540000
405500         ,:PV-ADJ-TO-QTY                                          40550000
405600         ,:SU035-PRC-RSN-CDE                                      40560000
405700         ,:PV-USER-ID                                             40570000
405800         ,:SUQADJ-FINCL-ADJ-ID                                    40580000
405900         )                                                        40590000
406000     END-EXEC                                                     40600000
406100     EVALUATE TRUE                                                40610000
406200         WHEN SQLCODE = +0                                        40620000
406300             SET PS-TSUQADJ-INSERTED TO TRUE                      40630000
406400         WHEN SQLCODE = -904                                      40640000
406500         WHEN SQLCODE = -913                                      40650000
406600         WHEN SQLCODE = -911                                      40660000
406700             MOVE 9                   TO PV-ERROR-NBR             40670000
406800             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         40680000
406900             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      40690000
407000             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 40700000
407100             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  40710000
407200             PERFORM 9903-WRITE-CICS-LOG                          40720000
407300             PERFORM 9000-SOFT-ABORT                              40730000
407400         WHEN SQLWARN0 NOT = SPACES                               40740000
407500         WHEN SQLCODE < +0                                        40750000
407600         WHEN SQLCODE > +0                                        40760000
407700             MOVE 10                  TO PV-ERROR-NBR             40770000
407800                                         PC033-ERROR-NBR          40780000
407900             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         40790000
408000             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      40800000
408100             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 40810000
408200             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  40820000
408300             PERFORM 9903-WRITE-CICS-LOG                          40830000
408400             MOVE '7000-INSERT-TSUQADJ' TO PC033-PARAGRAPH        40840000
408500             MOVE 'PCKRF863 - ERROR INSERTING TO TSUQADJ TABLE'   40850000
408600                                      TO PC033-MESSAGE-TEXT(1)    40860000
408700             MOVE DK-SHIPT-UNT-ID                                 40870000
408800                                      TO PC033-MESSAGE-TEXT(2)    40880000
408900             MOVE SQLCA               TO PC033-SQLCA              40890000
409000             MOVE 'TSUQADJ'           TO PC033-DB2-TABLE-NAME(1)  40900000
409100             SET PC033-ABEND          TO TRUE                     40910000
409200             MOVE 99                  TO PC033-PGM-MSG-NBR        40920000
409300             PERFORM 8210-XCTL-ERROR-SCREEN                       40930000
409400     END-EVALUATE.                                                40940000
409500*                                                                 40950000
409600 7100-UPDATE-CART-UPC.                                            40960000
409700     MOVE PC033-RCVR-SEQ-NBR-CTN  TO DK-RCVR-SEQ-NBR.             40970000
409800     EXEC SQL                                                     40980000
409900         UPDATE SUT_OTBND_UPC A                                   40990000
410000         SET                                                      41000000
410100              SHPD_UNT_QTY      = :DK-ADJ-TO-QTY                  41010000
410200       WHERE SHIPT_UNT_ID       = :DK-SHIPT-UNT-ID                41020000
410300         AND UPC_NBR            = :DK-UPC-NBR                     41030000
410400         AND  A.TRN_NBR         = :PC033-PO-NBR                   41040000
410500         AND  A.RCVR_SEQ_NBR    = :DK-RCVR-SEQ-NBR                41050000
410600         AND  A.TRN_LNE_NBR     = :PC033-PO-LINE-NBR              41060000
410700     END-EXEC                                                     41070000
410800                                                                  41080000
410900     EVALUATE TRUE                                                41090000
411000         WHEN SQLCODE = +0                                        41100000
411100             SET PS-CART-UPC-UPDATED TO TRUE                      41110000
411200             PERFORM 7110-CHECK-UNIT-ADJ-PARM                     41120000
411300         WHEN SQLCODE = -904                                      41130000
411400         WHEN SQLCODE = -913                                      41140000
411500         WHEN SQLCODE = -911                                      41150000
411600             MOVE 11                  TO PV-ERROR-NBR             41160000
411700             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         41170000
411800             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      41180000
411900             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 41190000
412000             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  41200000
412100             MOVE DK-UPC-NBR             TO PV-ERROR-UPC          41210000
412200             PERFORM 9903-WRITE-CICS-LOG                          41220000
412300             PERFORM 9000-SOFT-ABORT                              41230000
412400         WHEN SQLWARN0 NOT = SPACES                               41240000
412500         WHEN SQLCODE < +0                                        41250000
412600         WHEN SQLCODE > +0                                        41260000
412700             MOVE 12                  TO PV-ERROR-NBR             41270000
412800                                         PC033-ERROR-NBR          41280000
412900             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         41290000
413000             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      41300000
413100             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 41310000
413200             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  41320000
413300             MOVE DK-UPC-NBR             TO PV-ERROR-UPC          41330000
413400             PERFORM 9903-WRITE-CICS-LOG                          41340000
413500             MOVE '7100-UPDATE-CART-UPC' TO PC033-PARAGRAPH       41350000
413600             MOVE 'PCKRF863 - ERROR UPDATING THE SUT_OTBND_UPC'   41360000
413700                                      TO PC033-MESSAGE-TEXT(1)    41370000
413800             MOVE DK-SHIPT-UNT-ID     TO PV-ERROR-OPER            41380000
413900             MOVE SQLCA               TO PC033-SQLCA              41390000
414000             MOVE 'SUT_OTBND_UPC'     TO PC033-DB2-TABLE-NAME(1)  41400000
414100             SET PC033-ABEND          TO TRUE                     41410000
414200             MOVE 99                  TO PC033-PGM-MSG-NBR        41420000
414300             PERFORM 8210-XCTL-ERROR-SCREEN                       41430000
414400     END-EVALUATE.                                                41440000
414500*                                                                 41450000
414600 7110-CHECK-UNIT-ADJ-PARM.                                        41460000
414700     EXEC SQL                                                     41470000
414800         SELECT FUNC_TXT                                          41480000
414900         INTO :KRPRPM-FUNC-TXT                                    41490000
415000         FROM TKRPRPM                                             41500000
415100         WHERE                                                    41510000
415200                 SYS_PRC_FUNC_CDE     = 'UNTADJ'                  41520000
415300             AND LOC_ID               = :PC033-OPER-UNT-ID        41530000
415400             AND INTFC_SYS_CDE        = 'KHL'                     41540000
415500             AND FUNC_PRC_STAT_CDE    = 'AC'                      41550000
415600             AND CURRENT DATE BETWEEN                             41560000
415700                  DATE(FUNC_BEG_TMST) AND DATE(FUNC_END_TMST)     41570000
415800     END-EXEC.                                                    41580000
415900                                                                  41590000
416000     EVALUATE TRUE                                                41600000
416100         WHEN SQLCODE = ZERO                                      41610000
416200             IF KRPRPM-FUNC-TXT = 'Y'                             41620000
416300                 SET PS-DO-UNIT-ADJ-YES TO TRUE                   41630000
416400             ELSE                                                 41640000
416500                 SET PS-DO-UNIT-ADJ-NO  TO TRUE                   41650000
416600             END-IF                                               41660000
416700         WHEN SQLCODE = +100                                      41670000
416800             SET PS-DO-UNIT-ADJ-NO    TO TRUE                     41680000
416900         WHEN SQLCODE = -904                                      41690000
417000         WHEN SQLCODE = -913                                      41700000
417100         WHEN SQLCODE = -911                                      41710000
417200             MOVE 38                  TO PV-ERROR-NBR             41720000
417300             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         41730000
417400             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      41740000
417500             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 41750000
417600             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  41760000
417700             PERFORM 9903-WRITE-CICS-LOG                          41770000
417800             PERFORM 9000-SOFT-ABORT                              41780000
417900         WHEN SQLWARN0 NOT = SPACES                               41790000
418000         WHEN SQLCODE < +0                                        41800000
418100         WHEN SQLCODE > +0                                        41810000
418200             MOVE 39                  TO PV-ERROR-NBR             41820000
418300                                         PC033-ERROR-NBR          41830000
418400             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         41840000
418500             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      41850000
418600             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 41860000
418700             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  41870000
418800             PERFORM 9903-WRITE-CICS-LOG                          41880000
418900             MOVE '7110-CHECK-UNIT-ADJ-PARM'                      41890000
419000                                      TO PC033-PARAGRAPH          41900000
419100             MOVE 'PCKRF863 - ERROR SELECTING PARM'               41910000
419200                                      TO PC033-MESSAGE-TEXT(1)    41920000
419300             MOVE SQLCA               TO PC033-SQLCA              41930000
419400             MOVE 'TKRPRPM'           TO PC033-DB2-TABLE-NAME(1)  41940000
419500             SET PC033-ABEND          TO TRUE                     41950000
419600             MOVE 99                  TO PC033-PGM-MSG-NBR        41960000
419700             PERFORM 8210-XCTL-ERROR-SCREEN                       41970000
419800     END-EVALUATE.                                                41980000
419900*                                                                 41990000
420000 7200-CHECK-FOR-DMG-CART.                                         42000000
420100                                                                  42010000
420200     MOVE 'N'      TO PS-DAMAGED-SW.                              42020000
420300     EXEC SQL                                                     42030000
420400         SELECT 'Y'                                               42040000
420500         INTO :PS-DAMAGED-SW                                      42050000
420600         FROM                                                     42060000
420700            SUT_OTBND_CART CART                                   42070000
420800         WHERE CART.SHIPT_UNT_ID     = :PC033-CARTON              42080000
420900           AND CART.CART_SRC_CDE     = 'DMG'                      42090000
421000         END-EXEC                                                 42100000
421100                                                                  42110000
421200     EVALUATE TRUE                                                42120000
421300         WHEN SQLCODE = ZERO                                      42130000
421400         WHEN SQLCODE = -811                                      42140000
421500         WHEN SQLCODE = +100                                      42150000
421600             CONTINUE                                             42160000
421700         WHEN SQLCODE = -904                                      42170000
421800         WHEN SQLCODE = -913                                      42180000
421900         WHEN SQLCODE = -911                                      42190000
422000             MOVE 89                  TO PV-ERROR-NBR             42200000
422100             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         42210000
422200             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      42220000
422300             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 42230000
422400             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  42240000
422500             PERFORM 9903-WRITE-CICS-LOG                          42250000
422600             PERFORM 9000-SOFT-ABORT                              42260000
422700         WHEN SQLWARN0 NOT = SPACES                               42270000
422800         WHEN SQLCODE NOT EQUAL ZERO                              42280000
422900             MOVE 89                  TO PV-ERROR-NBR             42290000
423000                                         PC033-ERROR-NBR          42300000
423100             PERFORM 9903-WRITE-CICS-LOG                          42310000
423200             MOVE '7200-SELECT-OTBND-CART' TO PC033-PARAGRAPH     42320000
423300             MOVE 'PCKRF863 - SET DAMAGED SWITCH'                 42330000
423400                                      TO PC033-MESSAGE-TEXT(1)    42340000
423500             MOVE SQLCA               TO PC033-SQLCA              42350000
423600             MOVE 'SUT_OTBND_CART'    TO PC033-DB2-TABLE-NAME(1)  42360000
423700             SET PC033-ABEND          TO TRUE                     42370000
423800             MOVE 99                  TO PC033-PGM-MSG-NBR        42380000
423900             PERFORM 8210-XCTL-ERROR-SCREEN                       42390000
424000     END-EVALUATE.                                                42400000
424100                                                                  42410000
424200 7452-SELECT-OTBND-TRN.                                           42420000
424300                                                                  42430000
424400     EXEC SQL                                                     42440000
424500         SELECT                                                   42450000
424600             DISTINCT UPC.TRN_NBR                                 42460000
424700         INTO                                                     42470000
424800             :SUT00028-TRN-NBR                                    42480000
424900         FROM                                                     42490000
425000            SUT_OTBND_UPC  UPC                                    42500000
425100         WHERE UPC.SHIPT_UNT_ID     = :PC033-CARTON               42510000
425200           AND UPC.UPC_NBR          = :DK-UPC-NBR                 42520000
425300         END-EXEC                                                 42530000
425400                                                                  42540000
425500     EVALUATE TRUE                                                42550000
425600         WHEN SQLCODE = ZERO                                      42560000
425700         WHEN SQLCODE = -811                                      42570000
425800         WHEN SQLCODE = +100                                      42580000
425900             CONTINUE                                             42590000
426000         WHEN SQLCODE = -904                                      42600000
426100         WHEN SQLCODE = -913                                      42610000
426200         WHEN SQLCODE = -911                                      42620000
426300             MOVE 30                  TO PV-ERROR-NBR             42630000
426400             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         42640000
426500             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      42650000
426600             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 42660000
426700             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  42670000
426800             PERFORM 9903-WRITE-CICS-LOG                          42680000
426900             PERFORM 9000-SOFT-ABORT                              42690000
427000         WHEN SQLWARN0 NOT = SPACES                               42700000
427100         WHEN SQLCODE NOT EQUAL ZERO                              42710000
427200             MOVE 31                  TO PV-ERROR-NBR             42720000
427300                                         PC033-ERROR-NBR          42730000
427400             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         42740000
427500             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      42750000
427600             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 42760000
427700             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  42770000
427800             PERFORM 9903-WRITE-CICS-LOG                          42780000
427900             MOVE '7452-SELECT-OTBND-TRN' TO PC033-PARAGRAPH      42790000
428000             MOVE 'PCKRF863 - OBTAIN MULTIPLES  '                 42800000
428100                                      TO PC033-MESSAGE-TEXT(1)    42810000
428200             MOVE SQLCA               TO PC033-SQLCA              42820000
428300             MOVE 'SUT_OTBND_UPC'     TO PC033-DB2-TABLE-NAME(1)  42830000
428400             SET PC033-ABEND          TO TRUE                     42840000
428500             MOVE 99                  TO PC033-PGM-MSG-NBR        42850000
428600             PERFORM 8210-XCTL-ERROR-SCREEN                       42860000
428700     END-EVALUATE.                                                42870000
428800                                                                  42880000
428900 7453-SELECT-OTBND-UPC.                                           42890000
429000                                                                  42900000
429100     EXEC SQL                                                     42910000
429200         SELECT                                                   42920000
429300             DISTINCT UPC.RCVR_SEQ_NBR                            42930000
429400         INTO                                                     42940000
429500             :SUT00028-RCVR-SEQ-NBR                               42950000
429600         FROM                                                     42960000
429700            SUT_OTBND_UPC  UPC                                    42970000
429800         WHERE UPC.SHIPT_UNT_ID     = :PC033-CARTON               42980000
429900           AND UPC.UPC_NBR          = :DK-UPC-NBR                 42990000
430000           AND UPC.TRN_NBR          = :PC033-PO-NBR               43000000
430100         END-EXEC                                                 43010000
430200                                                                  43020000
430300     EVALUATE TRUE                                                43030000
430400         WHEN SQLCODE = ZERO                                      43040000
430500         WHEN SQLCODE = -811                                      43050000
430600         WHEN SQLCODE = +100                                      43060000
430700             CONTINUE                                             43070000
430800         WHEN SQLCODE = -904                                      43080000
430900         WHEN SQLCODE = -913                                      43090000
431000         WHEN SQLCODE = -911                                      43100000
431100             MOVE 32                  TO PV-ERROR-NBR             43110000
431200             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         43120000
431300             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      43130000
431400             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 43140000
431500             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  43150000
431600             PERFORM 9903-WRITE-CICS-LOG                          43160000
431700             PERFORM 9000-SOFT-ABORT                              43170000
431800         WHEN SQLWARN0 NOT = SPACES                               43180000
431900         WHEN SQLCODE NOT EQUAL ZERO                              43190000
432000             MOVE 33                  TO PV-ERROR-NBR             43200000
432100                                         PC033-ERROR-NBR          43210000
432200             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         43220000
432300             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      43230000
432400             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 43240000
432500             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  43250000
432600             PERFORM 9903-WRITE-CICS-LOG                          43260000
432700             MOVE '7453-SELECT-OTBND-UPC' TO PC033-PARAGRAPH      43270000
432800             MOVE 'PCKRF863 - SET JEWELRY SWITCH'                 43280000
432900                                      TO PC033-MESSAGE-TEXT(1)    43290000
433000             MOVE SQLCA               TO PC033-SQLCA              43300000
433100             MOVE 'SUT_OTBND_UPC'     TO PC033-DB2-TABLE-NAME(1)  43310000
433200             SET PC033-ABEND          TO TRUE                     43320000
433300             MOVE 99                  TO PC033-PGM-MSG-NBR        43330000
433400             PERFORM 8210-XCTL-ERROR-SCREEN                       43340000
433500     END-EVALUATE.                                                43350000
433600                                                                  43360000
433700 7454-SELECT-LNE-NBR.                                             43370000
433800                                                                  43380000
433900     MOVE PC033-RCVR-SEQ-NBR-CTN  TO DK-RCVR-SEQ-NBR.             43390000
434000                                                                  43400000
434100     EXEC SQL                                                     43410000
434200         SELECT                                                   43420000
434300             DISTINCT UPC.TRN_LNE_NBR                             43430000
434400         INTO                                                     43440000
434500             :SUT00028-TRN-LNE-NBR                                43450000
434600         FROM                                                     43460000
434700            SUT_OTBND_UPC  UPC                                    43470000
434800         WHERE UPC.SHIPT_UNT_ID     = :PC033-CARTON               43480000
434900           AND UPC.UPC_NBR          = :DK-UPC-NBR                 43490000
435000           AND UPC.TRN_NBR          = :PC033-PO-NBR               43500000
435100           AND UPC.RCVR_SEQ_NBR     = :DK-RCVR-SEQ-NBR            43510000
435200         END-EXEC                                                 43520000
435300                                                                  43530000
435400     EVALUATE TRUE                                                43540000
435500         WHEN SQLCODE = ZERO                                      43550000
435600         WHEN SQLCODE = -811                                      43560000
435700         WHEN SQLCODE = +100                                      43570000
435800             CONTINUE                                             43580000
435900         WHEN SQLCODE = -904                                      43590000
436000         WHEN SQLCODE = -913                                      43600000
436100         WHEN SQLCODE = -911                                      43610000
436200             MOVE 34                  TO PV-ERROR-NBR             43620000
436300             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         43630000
436400             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      43640000
436500             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 43650000
436600             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  43660000
436700             PERFORM 9903-WRITE-CICS-LOG                          43670000
436800             PERFORM 9000-SOFT-ABORT                              43680000
436900         WHEN SQLWARN0 NOT = SPACES                               43690000
437000         WHEN SQLCODE NOT EQUAL ZERO                              43700000
437100             MOVE 35                  TO PV-ERROR-NBR             43710000
437200                                         PC033-ERROR-NBR          43720000
437300             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         43730000
437400             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      43740000
437500             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 43750000
437600             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  43760000
437700             PERFORM 9903-WRITE-CICS-LOG                          43770000
437800             MOVE '7454-SELECT-LNE-NBR' TO PC033-PARAGRAPH        43780000
437900             MOVE 'PCKRF863 - SET JEWELRY SWITCH'                 43790000
438000                                      TO PC033-MESSAGE-TEXT(1)    43800000
438100             MOVE SQLCA               TO PC033-SQLCA              43810000
438200             MOVE 'SUT_OTBND_UPC'     TO PC033-DB2-TABLE-NAME(1)  43820000
438300             SET PC033-ABEND          TO TRUE                     43830000
438400             MOVE 99                  TO PC033-PGM-MSG-NBR        43840000
438500             PERFORM 8210-XCTL-ERROR-SCREEN                       43850000
438600     END-EVALUATE.                                                43860000
438700                                                                  43870000
438800 7460-DISTINCT-RCVR-NBR.                                          43880000
438900                                                                  43890000
439000                                                                  43900000
439100     EXEC SQL                                                     43910000
439200         SELECT                                                   43920000
439300                 DISTINCT A.RCVR_SEQ_NBR                          43930000
439400         INTO                                                     43940000
439500                :SUT00028-RCVR-SEQ-NBR                            43950000
439600         FROM                                                     43960000
439700                SUT_OTBND_UPC A                                   43970000
439800             ,  XLT_SKU       XSKU                                43980000
439900             ,  XLV_UPC       XUPC                                43990000
440000         WHERE  A.UPC_NBR          = XUPC.UPC_NBR                 44000000
440100           AND  XSKU.INTR_UPC_ID   = XUPC.INTR_UPC_ID             44010000
440200           AND  A.SHIPT_UNT_ID     = :DK-SHIPT-UNT-ID             44020000
440300           AND  XSKU.SKU_NBR       = :DK-SKU-NBR                  44030000
440400           AND  A.TRN_NBR          = :PC033-PO-NBR                44040000
440500     END-EXEC.                                                    44050000
440600                                                                  44060000
440700     EVALUATE TRUE                                                44070000
440800         WHEN SQLCODE = ZERO                                      44080000
440900         WHEN SQLCODE = -811                                      44090000
441000         WHEN SQLCODE = +100                                      44100000
441100             CONTINUE                                             44110000
441200         WHEN SQLWARN0 NOT = SPACES                               44120000
441300         WHEN SQLCODE NOT EQUAL ZERO                              44130000
441400             MOVE 36                  TO PV-ERROR-NBR             44140000
441500                                         PC033-ERROR-NBR          44150000
441600             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         44160000
441700             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      44170000
441800             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 44180000
441900             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  44190000
442000             PERFORM 9903-WRITE-CICS-LOG                          44200000
442100             MOVE '7460-DISTINCT-RCVR-NBR' TO PC033-PARAGRAPH     44210000
442200             MOVE 'PCKRF863 '                                     44220000
442300                                      TO PC033-MESSAGE-TEXT(1)    44230000
442400             MOVE PC033-SKU-NBR       TO PC033-MESSAGE-TEXT(2)    44240000
442500             MOVE SQLCA               TO PC033-SQLCA              44250000
442600             MOVE 'SUT_OTBND_UPC'     TO PC033-DB2-TABLE-NAME(1)  44260000
442700             MOVE 'XLT_SKU'           TO PC033-DB2-TABLE-NAME(2)  44270000
442800             MOVE 'XLV_UPC'           TO PC033-DB2-TABLE-NAME(3)  44280000
442900             SET PC033-ABEND          TO TRUE                     44290000
443000             MOVE 99                  TO PC033-PGM-MSG-NBR        44300000
443100             PERFORM 8210-XCTL-ERROR-SCREEN                       44310000
443200     END-EVALUATE.                                                44320000
443300                                                                  44330000
443400 7461-DISTINCT-LINE.                                              44340000
443500     MOVE PC033-RCVR-SEQ-NBR-CTN  TO DK-RCVR-SEQ-NBR.             44350000
443600                                                                  44360000
443700     EXEC SQL                                                     44370000
443800         SELECT                                                   44380000
443900                 DISTINCT A.TRN_LNE_NBR                           44390000
444000         INTO                                                     44400000
444100                :SUT00028-TRN-LNE-NBR                             44410000
444200         FROM                                                     44420000
444300                SUT_OTBND_UPC A                                   44430000
444400             ,  XLT_SKU       XSKU                                44440000
444500             ,  XLV_UPC       XUPC                                44450000
444600         WHERE  A.UPC_NBR          = XUPC.UPC_NBR                 44460000
444700           AND  XSKU.INTR_UPC_ID   = XUPC.INTR_UPC_ID             44470000
444800           AND  A.SHIPT_UNT_ID     = :DK-SHIPT-UNT-ID             44480000
444900           AND  XSKU.SKU_NBR       = :DK-SKU-NBR                  44490000
445000           AND  A.TRN_NBR          = :PC033-PO-NBR                44500000
445100           AND  A.RCVR_SEQ_NBR     = :DK-RCVR-SEQ-NBR             44510000
445200     END-EXEC.                                                    44520000
445300                                                                  44530000
445400     EVALUATE TRUE                                                44540000
445500         WHEN SQLCODE = ZERO                                      44550000
445600         WHEN SQLCODE = -811                                      44560000
445700         WHEN SQLCODE = +100                                      44570000
445800             CONTINUE                                             44580000
445900         WHEN SQLWARN0 NOT = SPACES                               44590000
446000         WHEN SQLCODE NOT EQUAL ZERO                              44600000
446100             MOVE 37                  TO PV-ERROR-NBR             44610000
446200                                         PC033-ERROR-NBR          44620000
446300             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         44630000
446400             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      44640000
446500             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 44650000
446600             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  44660000
446700             PERFORM 9903-WRITE-CICS-LOG                          44670000
446800             MOVE '7461-DISTINCT-LINE'  TO PC033-PARAGRAPH        44680000
446900             MOVE 'PCKRF863 '         TO PC033-MESSAGE-TEXT(1)    44690000
447000             MOVE PC033-SKU-NBR       TO PC033-MESSAGE-TEXT(2)    44700000
447100             MOVE SQLCA               TO PC033-SQLCA              44710000
447200             MOVE 'SUT_OTBND_UPC'     TO PC033-DB2-TABLE-NAME(1)  44720000
447300             MOVE 'XLT_SKU'           TO PC033-DB2-TABLE-NAME(2)  44730000
447400             MOVE 'XLV_UPC'           TO PC033-DB2-TABLE-NAME(3)  44740000
447500             SET PC033-ABEND          TO TRUE                     44750000
447600             MOVE 99                  TO PC033-PGM-MSG-NBR        44760000
447700             PERFORM 8210-XCTL-ERROR-SCREEN                       44770000
447800     END-EVALUATE.                                                44780000
447900                                                                  44790000
448000 7462-SELECT-TFINADJ.                                             44800000
448100                                                                  44810000
448200     EXEC SQL                                                     44820000
448300         SELECT   PRC_RSN_CDE                                     44830000
448400         INTO     :SUT00030-PRC-RSN-CDE                           44840000
448500         FROM     SUT_FINCL_ADJ                                   44850000
448600         WHERE    FINCL_ADJ_ID = :PV-FINCL-ADJ-ID                 44860000
448700     END-EXEC.                                                    44870000
448800                                                                  44880000
448900     EVALUATE TRUE                                                44890000
449000         WHEN SQLCODE = ZERO                                      44900000
449100         WHEN SQLCODE = +100                                      44910000
449200             CONTINUE                                             44920000
449300         WHEN SQLCODE = -904                                      44930000
449400         WHEN SQLCODE = -913                                      44940000
449500         WHEN SQLCODE = -911                                      44950000
449600             MOVE 42                  TO PV-ERROR-NBR             44960000
449700             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         44970000
449800             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      44980000
449900             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 44990000
450000             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  45000000
450100             PERFORM 9903-WRITE-CICS-LOG                          45010000
450200             PERFORM 9000-SOFT-ABORT                              45020000
450300         WHEN SQLWARN0 NOT = SPACES                               45030000
450400         WHEN SQLCODE NOT EQUAL ZERO                              45040000
450500             MOVE 40                  TO PV-ERROR-NBR             45050000
450600             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         45060000
450700             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      45070000
450800             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 45080000
450900             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  45090000
451000                                         PC033-ERROR-NBR          45100000
451100             PERFORM 9903-WRITE-CICS-LOG                          45110000
451200             MOVE '7462-SELECT-TFINADJ'  TO PC033-PARAGRAPH       45120000
451300             MOVE 'PCKRF863 '                                     45130000
451400                                      TO PC033-MESSAGE-TEXT(1)    45140000
451500             MOVE PC033-SKU-NBR       TO PC033-MESSAGE-TEXT(2)    45150000
451600             MOVE SQLCA               TO PC033-SQLCA              45160000
451700             MOVE 'TSUQADJ'           TO PC033-DB2-TABLE-NAME(1)  45170000
451800             SET PC033-ABEND          TO TRUE                     45180000
451900             MOVE 99                  TO PC033-PGM-MSG-NBR        45190000
452000             PERFORM 8210-XCTL-ERROR-SCREEN                       45200000
452100     END-EVALUATE.                                                45210000
452200/                                                                 45220000
452300* OPEN NEXT UPC CURSOR                                            45230000
452400 7500-OPEN-NEXT-UPC-CSR.                                          45240000
452500         EXEC SQL                                                 45250000
452600              OPEN NEXT-UPC-CSR                                   45260000
452700         END-EXEC                                                 45270000
452800         EVALUATE TRUE                                            45280000
452900             WHEN SQLCODE = ZERO                                  45290000
453000                 CONTINUE                                         45300000
453100             WHEN SQLCODE = -904                                  45310000
453200             WHEN SQLCODE = -913                                  45320000
453300             WHEN SQLCODE = -911                                  45330000
453400                 MOVE 20                  TO PV-ERROR-NBR         45340000
453500                 MOVE PC033-OPER-UNT-ID   TO PV-ERROR-OPER        45350000
453600                 MOVE PC033-PO-NBR        TO PV-ERROR-ORD-NBR     45360000
453700                 MOVE DK-RCVR-SEQ-NBR     TO PV-ERROR-RCVR-SEQ-NBR45370000
453800                 MOVE PC033-PO-LINE-NBR   TO PV-ERROR-ORD-LNE-NBR 45380000
453900                 PERFORM 9903-WRITE-CICS-LOG                      45390000
454000                 PERFORM 9000-SOFT-ABORT                          45400000
454100             WHEN SQLWARN0 NOT = SPACES                           45410000
454200             WHEN SQLCODE < ZERO                                  45420000
454300             WHEN SQLCODE > ZERO                                  45430000
454400                 MOVE 21              TO PV-ERROR-NBR             45440000
454500                                         PC033-ERROR-NBR          45450000
454600                 MOVE PC033-OPER-UNT-ID   TO PV-ERROR-OPER        45460000
454700                 MOVE PC033-PO-NBR        TO PV-ERROR-ORD-NBR     45470000
454800                 MOVE DK-RCVR-SEQ-NBR     TO PV-ERROR-RCVR-SEQ-NBR45480000
454900                 MOVE PC033-PO-LINE-NBR   TO PV-ERROR-ORD-LNE-NBR 45490000
455000                 PERFORM 9903-WRITE-CICS-LOG                      45500000
455100                 MOVE '7500-OPEN-NEXT-UPC-CSR'                    45510000
455200                                      TO PC033-PARAGRAPH          45520000
455300                 MOVE 'PCKRF863 - OPEN CURSOR - '                 45530000
455400                                      TO PC033-MESSAGE-TEXT(1)    45540000
455500                 MOVE PC033-SKU-NBR   TO PC033-MESSAGE-TEXT(2)    45550000
455600                 MOVE SQLCA           TO PC033-SQLCA              45560000
455700                 MOVE 'XLT_SKU'       TO PC033-DB2-TABLE-NAME(1)  45570000
455800                 MOVE 'XLV_UPC'       TO PC033-DB2-TABLE-NAME(2)  45580000
455900                 MOVE 'SUT_OTBND_UPC' TO PC033-DB2-TABLE-NAME(3)  45590000
456000                 SET PC033-ABEND      TO TRUE                     45600000
456100                 MOVE 99              TO PC033-PGM-MSG-NBR        45610000
456200                 PERFORM 8210-XCTL-ERROR-SCREEN                   45620000
456300         END-EVALUATE.                                            45630000
456400*                                                                 45640000
456500*                                                                 45650000
456600*FETCH NEXT UPC CURSOR - GET NEXT UPC # IN SKU                    45660000
456700 7510-FETCH-NEXT-UPC-CSR.                                         45670000
456800                                                                  45680000
456900     EXEC SQL                                                     45690000
457000          FETCH NEXT-UPC-CSR                                      45700000
457100            INTO :SUT00028-UPC-NBR                                45710000
457200              ,  :SUT00028-TRN-NBR                                45720000
457300              ,  :SUT00028-RCVR-SEQ-NBR                           45730000
457400              ,  :SUT00028-TRN-LNE-NBR                            45740000
457500              ,  :PC033-INTR-UPC-ID                               45750000
457600     END-EXEC                                                     45760000
457700     EVALUATE TRUE                                                45770000
457800         WHEN SQLCODE = ZERO                                      45780000
457900*            GET SUT00028-SHPD-UNT-QTY FOR NEW UPC #              45790000
458000*            PERFORM 2280-GET-SHPD-UNT-QTY                        45800000
458100             CONTINUE                                             45810000
458200         WHEN SQLCODE = +100                                      45820000
458300             SET PS-NO-REMAINDER  TO TRUE                         45830000
458400             SET PS-END-OF-CURSOR TO TRUE                         45840000
458500         WHEN SQLCODE = -904                                      45850000
458600         WHEN SQLCODE = -913                                      45860000
458700         WHEN SQLCODE = -911                                      45870000
458800             MOVE 22                  TO PV-ERROR-NBR             45880000
458900             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         45890000
459000             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      45900000
459100             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 45910000
459200             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  45920000
459300             PERFORM 9903-WRITE-CICS-LOG                          45930000
459400             PERFORM 9000-SOFT-ABORT                              45940000
459500         WHEN SQLWARN0 NOT = SPACES                               45950000
459600         WHEN SQLCODE < ZERO                                      45960000
459700         WHEN SQLCODE > ZERO                                      45970000
459800             MOVE 23              TO PV-ERROR-NBR                 45980000
459900                                     PC033-ERROR-NBR              45990000
460000             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         46000000
460100             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      46010000
460200             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 46020000
460300             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  46030000
460400             PERFORM 9903-WRITE-CICS-LOG                          46040000
460500             MOVE '7510-FETCH-NEXT-UPC-CSR' TO PC033-PARAGRAPH    46050000
460600             MOVE 'PCKRF863 - FETCH CURSOR'                       46060000
460700                                  TO PC033-MESSAGE-TEXT(1)        46070000
460800             MOVE PC033-SKU-NBR   TO PC033-MESSAGE-TEXT(2)        46080000
460900             MOVE SQLCA           TO PC033-SQLCA                  46090000
461000             MOVE 'XLT_SKU'           TO PC033-DB2-TABLE-NAME(1)  46100000
461100             MOVE 'XLV_UPC'           TO PC033-DB2-TABLE-NAME(2)  46110000
461200             MOVE 'SUT_OTBND_UPC' TO PC033-DB2-TABLE-NAME(3)      46120000
461300             SET PC033-ABEND      TO TRUE                         46130000
461400             MOVE 99              TO PC033-PGM-MSG-NBR            46140000
461500             PERFORM 8210-XCTL-ERROR-SCREEN                       46150000
461600     END-EVALUATE.                                                46160000
461700*                                                                 46170000
461800*                                                                 46180000
461900* CLOSE NEXT UPC CURSOR                                           46190000
462000 7520-CLOSE-NEXT-UPC-CSR.                                         46200000
462100     EXEC SQL                                                     46210000
462200          CLOSE NEXT-UPC-CSR                                      46220000
462300     END-EXEC                                                     46230000
462400     EVALUATE TRUE                                                46240000
462500         WHEN SQLCODE = ZERO                                      46250000
462600             CONTINUE                                             46260000
462700         WHEN SQLWARN0 NOT = SPACES                               46270000
462800         WHEN SQLCODE < ZERO                                      46280000
462900         WHEN SQLCODE > ZERO                                      46290000
463000             MOVE 24                     TO PV-ERROR-NBR          46300000
463100                                            PC033-ERROR-NBR       46310000
463200             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         46320000
463300             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      46330000
463400             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 46340000
463500             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  46350000
463600             PERFORM 9903-WRITE-CICS-LOG                          46360000
463700             MOVE '7520-CLOSE-NEXT-UPC-CSR' TO PC033-PARAGRAPH    46370000
463800             MOVE 'PCKRF863 - CLOSE CURSOR'                       46380000
463900                                  TO PC033-MESSAGE-TEXT(1)        46390000
464000             MOVE PC033-SKU-NBR   TO PC033-MESSAGE-TEXT(2)        46400000
464100             MOVE SQLCA           TO PC033-SQLCA                  46410000
464200             MOVE 'XLT_SKU'           TO PC033-DB2-TABLE-NAME(1)  46420000
464300             MOVE 'XLV_UPC'           TO PC033-DB2-TABLE-NAME(2)  46430000
464400             MOVE 'SUT_OTBND_UPC' TO PC033-DB2-TABLE-NAME(3)      46440000
464500             SET PC033-ABEND      TO TRUE                         46450000
464600             MOVE 99              TO PC033-PGM-MSG-NBR            46460000
464700             PERFORM 8210-XCTL-ERROR-SCREEN                       46470000
464800     END-EVALUATE.                                                46480000
464900*                                                                 46490000
465000*                                                                 46500000
465100* OPEN UPC CURSOR                                                 46510000
465200 7600-OPEN-UPC-CSR.                                               46520000
465300         EXEC SQL                                                 46530000
465400              OPEN UPC-CSR                                        46540000
465500         END-EXEC                                                 46550000
465600         EVALUATE TRUE                                            46560000
465700             WHEN SQLCODE = ZERO                                  46570000
465800                 CONTINUE                                         46580000
465900             WHEN SQLCODE = -904                                  46590000
466000             WHEN SQLCODE = -913                                  46600000
466100             WHEN SQLCODE = -911                                  46610000
466200                 MOVE 25                  TO PV-ERROR-NBR         46620000
466300                 MOVE PC033-OPER-UNT-ID   TO PV-ERROR-OPER        46630000
466400                 MOVE PC033-PO-NBR        TO PV-ERROR-ORD-NBR     46640000
466500                 MOVE DK-RCVR-SEQ-NBR     TO PV-ERROR-RCVR-SEQ-NBR46650000
466600                 MOVE PC033-PO-LINE-NBR   TO PV-ERROR-ORD-LNE-NBR 46660000
466700                 PERFORM 9903-WRITE-CICS-LOG                      46670000
466800                 PERFORM 9000-SOFT-ABORT                          46680000
466900             WHEN SQLWARN0 NOT = SPACES                           46690000
467000             WHEN SQLCODE < ZERO                                  46700000
467100             WHEN SQLCODE > ZERO                                  46710000
467200                 MOVE 26              TO PV-ERROR-NBR             46720000
467300                                         PC033-ERROR-NBR          46730000
467400                 MOVE PC033-OPER-UNT-ID   TO PV-ERROR-OPER        46740000
467500                 MOVE PC033-PO-NBR        TO PV-ERROR-ORD-NBR     46750000
467600                 MOVE DK-RCVR-SEQ-NBR     TO PV-ERROR-RCVR-SEQ-NBR46760000
467700                 MOVE PC033-PO-LINE-NBR   TO PV-ERROR-ORD-LNE-NBR 46770000
467800                 PERFORM 9903-WRITE-CICS-LOG                      46780000
467900                 MOVE '7600-OPEN-UPC-CSR'  TO PC033-PARAGRAPH     46790000
468000                 MOVE 'PCKRF863 - OPEN  CURSOR'                   46800000
468100                                      TO PC033-MESSAGE-TEXT(1)    46810000
468200                 MOVE PC033-SKU-NBR   TO PC033-MESSAGE-TEXT(2)    46820000
468300                 MOVE SQLCA           TO PC033-SQLCA              46830000
468400                 MOVE 'XLT_SKU'       TO PC033-DB2-TABLE-NAME(1)  46840000
468500                 MOVE 'XLV_UPC'       TO PC033-DB2-TABLE-NAME(2)  46850000
468600                 MOVE 'SUT_OTBND_UPC' TO PC033-DB2-TABLE-NAME(3)  46860000
468700                 SET PC033-ABEND      TO TRUE                     46870000
468800                 MOVE 99              TO PC033-PGM-MSG-NBR        46880000
468900                 PERFORM 8210-XCTL-ERROR-SCREEN                   46890000
469000         END-EVALUATE.                                            46900000
469100*                                                                 46910000
469200*                                                                 46920000
469300*FETCH UPC CURSOR - GET NEXT UPC # IN SKU                         46930000
469400 7610-FETCH-UPC-CSR.                                              46940000
469500     EXEC SQL                                                     46950000
469600          FETCH UPC-CSR                                           46960000
469700            INTO :SUT00028-UPC-NBR                                46970000
469800              ,  :SUT00028-TRN-NBR                                46980000
469900              ,  :SUT00028-RCVR-SEQ-NBR                           46990000
470000              ,  :SUT00028-TRN-LNE-NBR                            47000000
470100              ,  :PC033-INTR-UPC-ID                               47010000
470200     END-EXEC                                                     47020000
470300                                                                  47030000
470400     EVALUATE TRUE                                                47040000
470500         WHEN SQLCODE = ZERO                                      47050000
470600             MOVE SUT00028-UPC-NBR TO DK-UPC-NBR                  47060000
470700                                      PC033-UPC-NBR               47070000
470800         WHEN SQLCODE = +100                                      47080000
470900             SET PS-END-OF-CURSOR TO TRUE                         47090000
471000         WHEN SQLCODE = -904                                      47100000
471100         WHEN SQLCODE = -913                                      47110000
471200         WHEN SQLCODE = -911                                      47120000
471300             MOVE 27                  TO PV-ERROR-NBR             47130000
471400             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         47140000
471500             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      47150000
471600             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 47160000
471700             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  47170000
471800             PERFORM 9903-WRITE-CICS-LOG                          47180000
471900             PERFORM 9000-SOFT-ABORT                              47190000
472000         WHEN SQLWARN0 NOT = SPACES                               47200000
472100         WHEN SQLCODE < ZERO                                      47210000
472200         WHEN SQLCODE > ZERO                                      47220000
472300             MOVE 28              TO PV-ERROR-NBR                 47230000
472400                                     PC033-ERROR-NBR              47240000
472500             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         47250000
472600             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      47260000
472700             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 47270000
472800             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  47280000
472900             PERFORM 9903-WRITE-CICS-LOG                          47290000
473000             MOVE '7610-FETCH-UPC-CSR'  TO PC033-PARAGRAPH        47300000
473100             MOVE 'PCKRF863 - FETCH CURSOR'                       47310000
473200                                  TO PC033-MESSAGE-TEXT(1)        47320000
473300             MOVE PC033-SKU-NBR   TO PC033-MESSAGE-TEXT(2)        47330000
473400             MOVE SQLCA           TO PC033-SQLCA                  47340000
473500             MOVE 'XLT_SKU'           TO PC033-DB2-TABLE-NAME(1)  47350000
473600             MOVE 'XLV_UPC'           TO PC033-DB2-TABLE-NAME(2)  47360000
473700             MOVE 'SUT_OTBND_UPC' TO PC033-DB2-TABLE-NAME(3)      47370000
473800             SET PC033-ABEND      TO TRUE                         47380000
473900             MOVE 99              TO PC033-PGM-MSG-NBR            47390000
474000             PERFORM 8210-XCTL-ERROR-SCREEN                       47400000
474100     END-EVALUATE.                                                47410000
474200*                                                                 47420000
474300*                                                                 47430000
474400* CLOSE UPC CURSOR                                                47440000
474500 7620-CLOSE-UPC-CSR.                                              47450000
474600     EXEC SQL                                                     47460000
474700          CLOSE UPC-CSR                                           47470000
474800     END-EXEC                                                     47480000
474900     EVALUATE TRUE                                                47490000
475000         WHEN SQLCODE = ZERO                                      47500000
475100             CONTINUE                                             47510000
475200         WHEN SQLWARN0 NOT = SPACES                               47520000
475300         WHEN SQLCODE < ZERO                                      47530000
475400         WHEN SQLCODE > ZERO                                      47540000
475500             MOVE 29              TO PV-ERROR-NBR                 47550000
475600                                     PC033-ERROR-NBR              47560000
475700             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         47570000
475800             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      47580000
475900             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 47590000
476000             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  47600000
476100             PERFORM 9903-WRITE-CICS-LOG                          47610000
476200             MOVE '7620-CLOSE-NEXT-UPC-CSR'                       47620000
476300                                  TO PC033-PARAGRAPH              47630000
476400             MOVE 'PCKRF863 - CLOSE CURSOR'                       47640000
476500                                  TO PC033-MESSAGE-TEXT(1)        47650000
476600             MOVE PC033-SKU-NBR   TO PC033-MESSAGE-TEXT(2)        47660000
476700             MOVE SQLCA           TO PC033-SQLCA                  47670000
476800             MOVE 'XLT_SKU'           TO PC033-DB2-TABLE-NAME(1)  47680000
476900             MOVE 'XLV_UPC'           TO PC033-DB2-TABLE-NAME(2)  47690000
477000             MOVE 'SUT_OTBND_UPC' TO PC033-DB2-TABLE-NAME(3)      47700000
477100             SET PC033-ABEND      TO TRUE                         47710000
477200             MOVE 99              TO PC033-PGM-MSG-NBR            47720000
477300             PERFORM 8210-XCTL-ERROR-SCREEN                       47730000
477400     END-EVALUATE.                                                47740000
477500*                                                                 47750000
477600*                                                                 47760000
477700 8000-SEND-MAP.                                                   47770000
477800     EXEC CICS                                                    47780000
477900         SEND MAP       ('PC863A')                                47790000
478000              MAPSET    ('PCKM863')                               47800000
478100              ERASE                                               47810000
478200              CURSOR                                              47820000
478300              RESP      (PV-CICS-RESPONSE)                        47830000
478400     END-EXEC.                                                    47840000
478500                                                                  47850000
478600     EVALUATE TRUE                                                47860000
478700         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 47870000
478800             CONTINUE                                             47880000
478900         WHEN OTHER                                               47890000
479000             MOVE '8000-SEND-MAP'      TO DP013-PARAGRAPH         47900000
479100             MOVE 'UNABLE TO SEND MAP' TO DP013-MESSAGE-TEXT (1)  47910000
479200             SET DP013-CICS-ABEND      TO TRUE                    47920000
479300             SET DP013-NO-ROLLBACK     TO TRUE                    47930000
479400             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               47940000
479500     END-EVALUATE.                                                47950000
479600*                                                                 47960000
479700*                                                                 47970000
479800 8100-SEND-DATA-ONLY.                                             47980000
479900     EXEC CICS                                                    47990000
480000         SEND MAP       ('PC863A')                                48000000
480100              MAPSET    ('PCKM863')                               48010000
480200              CURSOR                                              48020000
480300              DATAONLY                                            48030000
480400              RESP      (PV-CICS-RESPONSE)                        48040000
480500     END-EXEC.                                                    48050000
480600                                                                  48060000
480700     EVALUATE TRUE                                                48070000
480800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 48080000
480900             CONTINUE                                             48090000
481000         WHEN OTHER                                               48100000
481100             MOVE '8100-SEND-DATA-ONLY' TO DP013-PARAGRAPH        48110000
481200             MOVE 'UNABLE TO SEND DATA' TO DP013-MESSAGE-TEXT (1) 48120000
481300             SET DP013-CICS-ABEND       TO TRUE                   48130000
481400             SET DP013-NO-ROLLBACK      TO TRUE                   48140000
481500             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               48150000
481600     END-EVALUATE.                                                48160000
481700*                                                                 48170000
481800*                                                                 48180000
481900 8200-RETURN-TRANID.                                              48190000
482000     MOVE LENGTH OF CA-COMMAREA TO PC-COMMAREA-LENGTH             48200000
482100     EXEC CICS                                                    48210000
482200         RETURN TRANSID  (PC-TRANID)                              48220000
482300                COMMAREA (CA-COMMAREA)                            48230000
482400                LENGTH   (PC-COMMAREA-LENGTH)                     48240000
482500                RESP     (PV-CICS-RESPONSE)                       48250000
482600     END-EXEC.                                                    48260000
482700                                                                  48270000
482800     EVALUATE TRUE                                                48280000
482900         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 48290000
483000             CONTINUE                                             48300000
483100         WHEN OTHER                                               48310000
483200             MOVE '8200-RETURN-TRANIND' TO DP013-PARAGRAPH        48320000
483300             MOVE 'UNABLE TO RETURN TO TRANID'                    48330000
483400                 TO DP013-MESSAGE-TEXT (1)                        48340000
483500             SET DP013-CICS-ABEND       TO TRUE                   48350000
483600             SET DP013-NO-ROLLBACK      TO TRUE                   48360000
483700             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               48370000
483800     END-EVALUATE.                                                48380000
483900*                                                                 48390000
484000*                                                                 48400000
484100 8210-XCTL-ERROR-SCREEN.                                          48410000
484200     IF NOT PC033-ABEND                                           48420000
484300         SET PC033-INITIALIZE-SCREEN  TO TRUE                     48430000
484400     END-IF                                                       48440000
484500     MOVE DFHEIBLK                    TO PC033-DFHEIBLK.          48450000
484600     MOVE PC-CURRENT-PROGRAM-NAME     TO PC033-LAST-PROGRAM.      48460000
484700     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH       48470000
484800     MOVE 'PCKRF852'                  TO PV-TRANSFER-PROGRAM      48480000
484900     IF PC033-PGM-MSG-NBR = ZERO                                  48490000
485000         MOVE 3                       TO PC033-PGM-MSG-NBR        48500000
485100     END-IF                                                       48510000
485200                                                                  48520000
485300     EXEC CICS                                                    48530000
485400         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    48540000
485500               COMMAREA  (CA-COMMAREA)                            48550000
485600               LENGTH    (PV-COMMAREA-LENGTH)                     48560000
485700               RESP      (PV-CICS-RESPONSE)                       48570000
485800     END-EXEC.                                                    48580000
485900                                                                  48590000
486000     EVALUATE TRUE                                                48600000
486100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 48610000
486200             CONTINUE                                             48620000
486300         WHEN OTHER                                               48630000
486400             MOVE '8200-XCTL'                                     48640000
486500                                      TO DP013-PARAGRAPH          48650000
486600             MOVE 'PCKRF863 - UNABLE TO XCTL TO PROGRAM: '        48660000
486700                                      TO DP013-MESSAGE-TEXT (1)   48670000
486800             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   48680000
486900             SET DP013-CICS-ABEND                                 48690000
487000                 DP013-ROLLBACK       TO TRUE                     48700000
487100             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               48710000
487200             MOVE PC-TRANS-UNAVAILABLE-MSG                        48720000
487300                                      TO AMSGLNO                  48730000
487400             SET PC033-PROCESS-SCREEN TO TRUE                     48740000
487500             MOVE -1                  TO ACARTNL                  48750000
487600             PERFORM 8000-SEND-MAP                                48760000
487700             PERFORM 8200-RETURN-TRANID                           48770000
487800     END-EVALUATE.                                                48780000
487900                                                                  48790000
488000 8220-XCTL-PO-ENTRY-SCREEN.                                       48800000
488100                                                                  48810000
488200     SET PC033-INITIALIZE-SCREEN      TO TRUE                     48820000
488300                                                                  48830000
488400     MOVE DFHEIBLK                    TO PC033-DFHEIBLK.          48840000
488500     MOVE PC-CURRENT-PROGRAM-NAME     TO PC033-LAST-PROGRAM.      48850000
488600     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH       48860000
488700     MOVE 'PCKRF900'                  TO PV-TRANSFER-PROGRAM      48870000
488800                                                                  48880000
488900     EXEC CICS                                                    48890000
489000         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    48900000
489100               COMMAREA  (CA-COMMAREA)                            48910000
489200               LENGTH    (PV-COMMAREA-LENGTH)                     48920000
489300               RESP      (PV-CICS-RESPONSE)                       48930000
489400     END-EXEC.                                                    48940000
489500                                                                  48950000
489600     EVALUATE TRUE                                                48960000
489700         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 48970000
489800             CONTINUE                                             48980000
489900         WHEN OTHER                                               48990000
490000             MOVE '8220-XCTL-PO-ENTRY-SCREEN'                     49000000
490100                                      TO DP013-PARAGRAPH          49010000
490200             MOVE 'PCKRF863 - UNABLE TO XCTL TO PROGRAM: '        49020000
490300                                      TO DP013-MESSAGE-TEXT (1)   49030000
490400             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   49040000
490500             SET DP013-CICS-ABEND                                 49050000
490600                 DP013-ROLLBACK       TO TRUE                     49060000
490700             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               49070000
490800             MOVE PC-TRANS-UNAVAILABLE-MSG                        49080000
490900                                      TO AMSGLNO                  49090000
491000             SET PC033-PROCESS-SCREEN TO TRUE                     49100000
491100             MOVE -1                  TO ACARTNL                  49110000
491200             PERFORM 8000-SEND-MAP                                49120000
491300             PERFORM 8200-RETURN-TRANID                           49130000
491400     END-EVALUATE.                                                49140000
491500                                                                  49150000
491600*                                                                 49160000
491700 8300-RETURN.                                                     49170000
491800     EXEC CICS                                                    49180000
491900         SEND FROM (PV-MESSAGE-AREA)                              49190000
492000              LENGTH (19)                                         49200000
492100              ERASE                                               49210000
492200     END-EXEC.                                                    49220000
492300                                                                  49230000
492400     EXEC CICS                                                    49240000
492500         RETURN                                                   49250000
492600     END-EXEC.                                                    49260000
492700*                                                                 49270000
492800*                                                                 49280000
492900 8400-XCTL-TO-HELP.                                               49290000
493000     MOVE LENGTH OF PC192-COMMAREA    TO PC-COMMAREA-LENGTH       49300000
493100                                                                  49310000
493200     EXEC CICS                                                    49320000
493300         XCTL                                                     49330000
493400             PROGRAM   (PV-TRANSFER-PROGRAM)                      49340000
493500             COMMAREA  (PC192-COMMAREA)                           49350000
493600             LENGTH    (PC-COMMAREA-LENGTH)                       49360000
493700             RESP      (PV-CICS-RESPONSE)                         49370000
493800     END-EXEC.                                                    49380000
493900                                                                  49390000
494000     EVALUATE TRUE                                                49400000
494100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 49410000
494200              CONTINUE                                            49420000
494300         WHEN OTHER                                               49430000
494400             MOVE '8400-XCTL-TO-HELP' TO DP013-PARAGRAPH          49440000
494500             MOVE 'PCKRF863 - UNABLE TO XCTL TO PROGRAM: '        49450000
494600                                      TO DP013-MESSAGE-TEXT (1)   49460000
494700             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   49470000
494800             SET DP013-CICS-ABEND                                 49480000
494900                 DP013-ROLLBACK       TO TRUE                     49490000
495000             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               49500000
495100             MOVE PC-TRANS-UNAVAILABLE-MSG                        49510000
495200                                      TO AMSGLNO                  49520000
495300             SET PC033-PROCESS-SCREEN TO TRUE                     49530000
495400             MOVE -1                  TO ACARTNL                  49540000
495500             PERFORM 8000-SEND-MAP                                49550000
495600             PERFORM 8200-RETURN-TRANID                           49560000
495700     END-EVALUATE.                                                49570000
495800                                                                  49580000
495900 8500-LINK-SUKUT702.                                              49590000
496000                                                                  49600000
496100     IF PS-PO-VERIFIED-YES                                        49610000
496200         SET SU035-LOG-ONLY-NO  TO TRUE                           49620000
496300     ELSE                                                         49630000
496400         SET SU035-LOG-ONLY  TO  TRUE                             49640000
496500     END-IF.                                                      49650000
496600                                                                  49660000
496700     EXEC SQL                                                     49670000
496800         SET :SU035-CRE-TMST  = CURRENT TIMESTAMP                 49680000
496900     END-EXEC.                                                    49690000
497000                                                                  49700000
497100     SET SU035-PACK-NO  TO TRUE.                                  49710000
497200     IF PS-ODD-UNITS-LINE-ADJ                                     49720000
497300         SET SU035-ODD-UNIT-YES        TO TRUE                    49730000
497400         SET SU035-PACK-YES            TO TRUE                    49740000
497500         MOVE PV-PACK-ID               TO SU035-PACK-ID           49750000
497600         MOVE PV-BEFORE-ODD-UNT-QTY    TO SU035-BEFORE-ODD-UNT-QTY49760000
497700         MOVE PV-AFTER-ODD-UNT-QTY     TO SU035-AFTER-ODD-UNT-QTY 49770000
497800     END-IF.                                                      49780000
497900     IF PS-DAMAGED-YES                                            49790000
498000*        MOVE PV-BEFORE-QTY       TO SU035-BEFORE-QTY             49800000
498100*        MOVE PV-AFTER-QTY        TO SU035-AFTER-QTY              49810000
498200         IF PS-PO-PREPK-NO                                        49820000
498300             SET SU035-ODD-UNIT-NO         TO TRUE                49830000
498400             SET SU035-PACK-NO             TO TRUE                49840000
498500         ELSE                                                     49850000
498600             SET SU035-ODD-UNIT-YES        TO TRUE                49860000
498700             SET SU035-PACK-YES            TO TRUE                49870000
498800             MOVE PV-PACK-ID               TO SU035-PACK-ID       49880000
498900         END-IF                                                   49890000
499000         SET PS-NO-PACK-ADJUSTMENT         TO TRUE                49900000
499100         MOVE PC033-OPER-UNT-ID            TO SU035-DEST-LOC-NBR  49910000
499200         MOVE 'N'                          TO PS-DAMAGED-SW       49920000
499300     ELSE                                                         49930000
499400         IF PS-PACK-ADJUSTMENT                                    49940000
499500             MOVE RC806-PKSL-LNE-NBR(RC806-LINE-IDX) TO           49950000
499600                                                SU035-PO-LNE-NBR  49960000
499700             PERFORM 6800-SELECT-UPC-NBR-4-LINE                   49970000
499800             MOVE SUT00028-UPC-NBR    TO SU035-UPC-NBR            49980000
499900             SET SU035-PACK-YES       TO TRUE                     49990000
500000             MOVE PV-PACK-ID          TO SU035-PACK-ID            50000000
500100             MOVE PV-PACK-DIFF        TO SU035-PACK-ADJUST-QTY    50010000
500200             MOVE PV-BEFORE-QTY       TO SU035-BEFORE-QTY         50020000
500300             MOVE PV-AFTER-QTY        TO SU035-AFTER-QTY          50030000
500400***HERE2                                                          50040000
500500             MOVE PV-ADJUST-QTY       TO SU035-ADJUST-QTY         50050000
500600             IF PS-PREPACK-DRIVER                                 50060000
500700                 MOVE 'A'   TO SU035-VRFY-ADJ-DRIVE-LNE           50070000
500800             END-IF                                               50080000
500900         ELSE                                                     50090000
501000             MOVE PC033-UPC-NBR       TO SU035-UPC-NBR            50100000
501100             MOVE PC033-PO-LINE-NBR   TO SU035-PO-LNE-NBR         50110000
501200             MOVE PV-ADJ-BEF-QTY      TO SU035-BEFORE-QTY         50120000
501300             MOVE PV-ADJ-TO-QTY       TO SU035-AFTER-QTY          50130000
501400         END-IF                                                   50140000
501500     END-IF.                                                      50150000
501600     SET SU035-UPDATE-DISTDT TO TRUE.                             50160000
501700                                                                  50170000
501800     MOVE LENGTH OF SU035-COMM-AREA      TO PV-COMMAREA-LENGTH.   50180000
501900                                                                  50190000
502000     EXEC CICS                                                    50200000
502100         LINK PROGRAM  (PC-SUKUT702)                              50210000
502200              COMMAREA (SU035-COMM-AREA)                          50220000
502300              LENGTH   (PV-COMMAREA-LENGTH)                       50230000
502400              RESP     (PV-CICS-RESPONSE)                         50240000
502500     END-EXEC.                                                    50250000
502600                                                                  50260000
502700     EVALUATE TRUE                                                50270000
502800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 50280000
502900             IF  SU035-INVALID-SQL     OR                         50290000
503000                 SU035-DATABASE-BUSY                              50300000
503100             INITIALIZE PV-CICS-MSG-AREA                          50310000
503200             MOVE PC033-PO-NBR       TO PV-ERROR-ORD-NBR          50320000
503300             MOVE PC033-RCVR-SEQ-NBR-CTN TO PV-ERROR-RCVR-SEQ-NBR 50330000
503400             MOVE PC033-PO-LINE-NBR  TO PV-ERROR-ORD-LNE-NBR      50340000
503500             MOVE PC033-STR-NBR      TO PV-ERROR-STR-NBR          50350000
503600                                                                  50360000
503700             STRING 'PCKRF863 - 8500-LINK-SUKUT702 '              50370000
503800                    ' - CALL UNIT ADJ MODULE    '                 50380000
503900                                      DELIMITED BY SIZE           50390000
504000                                 INTO PV-CICS-MSG-AREA            50400000
504100             PERFORM 9990-WRITE-CICS                              50410000
504200                                                                  50420000
504300             MOVE SU035-SQLCA    TO PV-CICS-MSG-AREA              50430000
504400             PERFORM 9990-WRITE-CICS                              50440000
504500                                                                  50450000
504600             INITIALIZE PV-CICS-MSG-AREA                          50460000
504700             STRING 'PCKRF863 - PO-RCVR - '                       50470000
504800                     PV-ERROR-ORD-NBR '-'                         50480000
504900                     PV-ERROR-RCVR-SEQ-NBR '-'                    50490000
505000                     PV-ERROR-ORD-LNE-NBR                         50500000
505100                    ' STORE= ' PV-ERROR-STR-NBR                   50510000
505200                                      DELIMITED BY SIZE           50520000
505300                                 INTO PV-CICS-MSG-AREA            50530000
505400                 PERFORM 9990-WRITE-CICS                          50540000
505500                 MOVE '8500-LINK-SUKUT702' TO DP013-PARAGRAPH     50550000
505600                 MOVE 'PCKRF863 - DB2 ERROR IN PROGRAM: '         50560000
505700                                        TO DP013-MESSAGE-TEXT (1) 50570000
505800                 MOVE 'SUKUT702'         TO DP013-MESSAGE-TEXT (2)50580000
505900                 SET DP013-CICS-ABEND                             50590000
506000                     DP013-ROLLBACK            TO TRUE            50600000
506100                 PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG           50610000
506200                 MOVE 43                 TO PV-ERROR-NBR          50620000
506300                                            PC033-ERROR-NBR       50630000
506400                 MOVE PC033-OPER-UNT-ID  TO PV-ERROR-OPER         50640000
506500                 MOVE PC033-PO-NBR       TO PV-ERROR-ORD-NBR      50650000
506600                 MOVE DK-RCVR-SEQ-NBR    TO PV-ERROR-RCVR-SEQ-NBR 50660000
506700                 MOVE PC033-PO-LINE-NBR  TO PV-ERROR-ORD-LNE-NBR  50670000
506800                 PERFORM 9903-WRITE-CICS-LOG                      50680000
506900                 MOVE '8500-LINK-SUKUT702'  TO PC033-PARAGRAPH    50690000
507000                 MOVE 'PCKRF863 '       TO PC033-MESSAGE-TEXT(1)  50700000
507100                 MOVE 'ERR IN SUKUT702' TO PC033-MESSAGE-TEXT(2)  50710000
507200                 MOVE 'SUKUT702     ' TO PC033-DB2-TABLE-NAME(1)  50720000
507300                 SET PC033-ABEND          TO TRUE                 50730000
507400                 MOVE 99                  TO PC033-PGM-MSG-NBR    50740000
507500                 PERFORM 8210-XCTL-ERROR-SCREEN                   50750000
507600             ELSE                                                 50760000
507700                 IF SU035-UPDATE-ERROR OR SU035-NO-CHANGE         50770000
507800                     IF PS-NO-BACKOUT-NEEDED                      50780000
507900                         CONTINUE                                 50790000
508000                     ELSE                                         50800000
508100                         MOVE PV-ADJ-TO-QTY  TO PV-ADJ-QTY        50810000
508200                         MOVE PV-ADJ-BEF-QTY TO PV-ADJ-TO-QTY     50820000
508300                         MOVE PV-ADJ-QTY     TO PV-ADJ-BEF-QTY    50830000
508400                         MOVE 'SYS REVS'     TO PV-USER-ID        50840000
508500                         PERFORM 7000-INSERT-TSUQADJ              50850000
508600                         MOVE PV-ADJ-TO-QTY  TO DK-ADJ-TO-QTY     50860000
508700                         PERFORM 7100-UPDATE-CART-UPC             50870000
508800                         IF PS-PO-PREPK-YES                       50880000
508900                             MOVE -1 TO                           50890000
509000                               RC806-PKSL-LNE-NBR(RC806-LINE-IDX) 50900000
509100                             MOVE 501 TO  PV-SAVE-LINE-IDX        50910000
509200                         END-IF                                   50920000
509300                     END-IF                                       50930000
509400                 ELSE                                             50940000
509500                     IF PS-PO-PREPK-YES                           50950000
509600                         IF SU035-PO-LNE-NBR = PV-SAVE-PO-LINE-NBR50960000
509700                             PERFORM 8800-GET-TPOPRPK             50970000
509800                         END-IF                                   50980000
509900                     END-IF                                       50990000
510000                 END-IF                                           51000000
510100             END-IF                                               51010000
510200         WHEN OTHER                                               51020000
510300             INITIALIZE PV-CICS-MSG-AREA                          51030000
510400             STRING 'PCKRF863 - 8500-LINK-SUKUT702 '              51040000
510500                    ' - CALL UNIT ADJ MODULE    '                 51050000
510600                                      DELIMITED BY SIZE           51060000
510700                                 INTO PV-CICS-MSG-AREA            51070000
510800             PERFORM 9990-WRITE-CICS                              51080000
510900                                                                  51090000
511000             MOVE SU035-SQLCA    TO PV-CICS-MSG-AREA              51100000
511100             PERFORM 9990-WRITE-CICS                              51110000
511200                                                                  51120000
511300             INITIALIZE PV-CICS-MSG-AREA                          51130000
511400             MOVE PC033-PO-NBR       TO PV-ERROR-ORD-NBR          51140000
511500             MOVE PC033-RCVR-SEQ-NBR-CTN TO PV-ERROR-RCVR-SEQ-NBR 51150000
511600             MOVE PC033-PO-LINE-NBR  TO PV-ERROR-ORD-LNE-NBR      51160000
511700             MOVE PC033-STR-NBR      TO PV-ERROR-STR-NBR          51170000
511800             MOVE PC033-CARTON       TO PV-DISPLAY-SML            51180000
511900                                                                  51190000
512000             STRING 'PCKRF863 - PO-RCVR - '                       51200000
512100                     PV-ERROR-ORD-NBR '-'                         51210000
512200                     PV-ERROR-RCVR-SEQ-NBR '-'                    51220000
512300                     PV-ERROR-ORD-LNE-NBR                         51230000
512400                    ' STORE= ' PV-ERROR-STR-NBR                   51240000
512500                    ' SML= ' PV-DISPLAY-SML                       51250000
512600                                      DELIMITED BY SIZE           51260000
512700                                 INTO PV-CICS-MSG-AREA            51270000
512800             PERFORM 9990-WRITE-CICS                              51280000
512900             MOVE 43                  TO PV-ERROR-NBR             51290000
513000                                         PC033-ERROR-NBR          51300000
513100             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         51310000
513200             PERFORM 9903-WRITE-CICS-LOG                          51320000
513300             MOVE '8500-LINK-SUKUT702' TO DP013-PARAGRAPH         51330000
513400             MOVE 'PCKRF863 - DB2 ERROR IN PROGRAM: '             51340000
513500                                      TO DP013-MESSAGE-TEXT (1)   51350000
513600             MOVE 'SUKUT702'         TO DP013-MESSAGE-TEXT (2)    51360000
513700             SET DP013-CICS-ABEND                                 51370000
513800                 DP013-ROLLBACK            TO TRUE                51380000
513900             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               51390000
514000             MOVE '8500-LINK-SUKUT702'  TO PC033-PARAGRAPH        51400000
514100             MOVE 'PCKRF863 '         TO PC033-MESSAGE-TEXT(1)    51410000
514200             MOVE 'ERROR IN SUKUT702' TO PC033-MESSAGE-TEXT(2)    51420000
514300             MOVE 'SUKUT702     '     TO PC033-DB2-TABLE-NAME(1)  51430000
514400             SET PC033-ABEND          TO TRUE                     51440000
514500             MOVE 99                  TO PC033-PGM-MSG-NBR        51450000
514600             PERFORM 8210-XCTL-ERROR-SCREEN                       51460000
514700     END-EVALUATE.                                                51470000
514800                                                                  51480000
514900                                                                  51490000
515000*-----------------------------------------------------------------51500000
515100 8600-CALL-XLKUT001.                                              51510000
515200       CALL XL001-VSM-PGM      USING DFHEIBLK                     51520000
515300                                XL001-COMMAREA                    51530000
515400                                XL001-ITEM-COMMAREA.              51540000
515500                                                                  51550000
515600       EVALUATE TRUE                                              51560000
515700           WHEN XL001-SUCCESSFUL                                  51570000
515800           WHEN XL001-SKU-NOT-FOUND                               51580000
515900           WHEN XL001-UPC-NOT-FOUND                               51590000
516000           WHEN XL001-UPC-CONTENTION                              51600000
516100           WHEN XL001-SKU-CONTENTION                              51610000
516200               CONTINUE                                           51620000
516300           WHEN XL001-SQL-ERROR                                   51630000
516400           WHEN XL001-INVALID-ACCESS                              51640000
516500               MOVE '8600-LINK-XLKUT001' TO DP013-PARAGRAPH       51650000
516600               MOVE 'PCKRF863 - DB2 ERROR IN PROGRAM: '           51660000
516700                                        TO DP013-MESSAGE-TEXT (1) 51670000
516800               MOVE 'XLKUT001'          TO DP013-MESSAGE-TEXT (2) 51680000
516900               SET DP013-CICS-ABEND                               51690000
517000                   DP013-ROLLBACK            TO TRUE              51700000
517100               PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG             51710000
517200               MOVE PC-TRANS-UNAVAILABLE-MSG TO AMSGLNO           51720000
517300               SET PC033-PROCESS-SCREEN      TO TRUE              51730000
517400               PERFORM 8000-SEND-MAP                              51740000
517500               PERFORM 8200-RETURN-TRANID                         51750000
517600           WHEN OTHER                                             51760000
517700               MOVE '8600-LINK-XLKUT001' TO DP013-PARAGRAPH       51770000
517800               MOVE 'PCKRF863 - UNDETERMINED ERROR IN PGM: '      51780000
517900                                        TO DP013-MESSAGE-TEXT (1) 51790000
518000               MOVE 'XLKUT001'          TO DP013-MESSAGE-TEXT (2) 51800000
518100               SET DP013-CICS-ABEND                               51810000
518200                   DP013-ROLLBACK           TO TRUE               51820000
518300               PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG             51830000
518400               MOVE PC-TRANS-UNAVAILABLE-MSG TO AMSGLNO           51840000
518500               SET PC033-PROCESS-SCREEN TO TRUE                   51850000
518600               PERFORM 8000-SEND-MAP                              51860000
518700               PERFORM 8200-RETURN-TRANID                         51870000
518800       END-EVALUATE.                                              51880000
518900                                                                  51890000
519000*-----------------------------------------------------------------51900000
519100 8700-UPDATE-OTBND-CART.                                          51910000
519200     EXEC SQL                                                     51920000
519300         UPDATE SUT_OTBND_CART                                    51930000
519400         SET                                                      51940000
519500             ODD_UNT_IND     = :PV-ODD-UNT-IND                    51950000
519600         WHERE SHIPT_UNT_ID  = :DK-SHIPT-UNT-ID                   51960000
519700     END-EXEC.                                                    51970000
519800                                                                  51980000
519900     EVALUATE TRUE                                                51990000
520000         WHEN SQLCODE = +0                                        52000000
520100             CONTINUE                                             52010000
520200                                                                  52020000
520300         WHEN SQLCODE = -904                                      52030000
520400         WHEN SQLCODE = -913                                      52040000
520500         WHEN SQLCODE = -911                                      52050000
520600             MOVE 60                  TO PV-ERROR-NBR             52060000
520700             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         52070000
520800             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      52080000
520900             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 52090000
521000             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  52100000
521100             MOVE DK-SHIPT-UNT-ID        TO PV-DISPLAY-SML        52110000
521200             PERFORM 9903-WRITE-CICS-LOG                          52120000
521300             PERFORM 9000-SOFT-ABORT                              52130000
521400         WHEN SQLWARN0 NOT = SPACES                               52140000
521500         WHEN SQLCODE < +0                                        52150000
521600         WHEN SQLCODE > +0                                        52160000
521700             MOVE 61                  TO PV-ERROR-NBR             52170000
521800                                         PC033-ERROR-NBR          52180000
521900             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         52190000
522000             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      52200000
522100             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 52210000
522200             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  52220000
522300             MOVE DK-SHIPT-UNT-ID        TO PV-DISPLAY-SML        52230000
522400             PERFORM 9903-WRITE-CICS-LOG                          52240000
522500             MOVE '8700-UPDATE-OTBND-CART' TO PC033-PARAGRAPH     52250000
522600             MOVE 'PCKRF863 - ERROR UPDATING THE SUT_OTBND_CART'  52260000
522700                                      TO PC033-MESSAGE-TEXT(1)    52270000
522800             MOVE DK-SHIPT-UNT-ID     TO PV-ERROR-OPER            52280000
522900             MOVE SQLCA               TO PC033-SQLCA              52290000
523000             MOVE 'SUT_OTBND_CART'    TO PC033-DB2-TABLE-NAME(1)  52300000
523100             SET PC033-ABEND          TO TRUE                     52310000
523200             MOVE 99                  TO PC033-PGM-MSG-NBR        52320000
523300             PERFORM 8210-XCTL-ERROR-SCREEN                       52330000
523400     END-EVALUATE.                                                52340000
523500                                                                  52350000
523600*-----------------------------------------------------------------52360000
523700 8800-GET-TPOPRPK.                                                52370000
523800     EXEC SQL                                                     52380000
523900         SELECT PK_SKU_NBR                                        52390000
524000         INTO   :POPRPK-PK-SKU-NBR                                52400000
524100         FROM   TPOPRPK                                           52410000
524200         WHERE  PO_NBR         = :PC033-PO-NBR                    52420000
524300           AND  PO_PREPK_ID    = :DK-SAVE-PACK-ID                 52430000
524400           AND  PREPK_STAT_CDE = 'A'                              52440000
524500     END-EXEC.                                                    52450000
524600                                                                  52460000
524700     EVALUATE TRUE                                                52470000
524800         WHEN SQLCODE = +0                                        52480000
524900             SET PS-NO-OTBND-PK-FOUND TO TRUE                     52490000
525000             PERFORM 8850-SELECT-OTBND-PACK                       52500000
525100             IF PS-OTBND-PK-FOUND                                 52510000
525200                 IF PV-PACK-DIFF < 0                              52520000
525300                     COMPUTE SUT00041-SHPD-PK-QTY =               52530000
525400                             SUT00041-SHPD-PK-QTY + PV-PACK-DIFF  52540000
525500                     IF SUT00041-SHPD-PK-QTY < 0                  52550000
525600                         MOVE 0    TO SUT00041-SHPD-PK-QTY        52560000
525700                     END-IF                                       52570000
525800                     PERFORM 8900-UPDATE-OTBND-PACK               52580000
525900                 ELSE                                             52590000
526000                     COMPUTE SUT00041-SHPD-PK-QTY =               52600000
526100                             SUT00041-SHPD-PK-QTY + PV-PACK-DIFF  52610000
526200                     PERFORM 8900-UPDATE-OTBND-PACK               52620000
526300                 END-IF                                           52630000
526400             ELSE                                                 52640000
526500                 IF PV-PACK-DIFF > 0                              52650000
526600                     PERFORM 8950-INSERT-OTBND-PACK               52660000
526700                 END-IF                                           52670000
526800             END-IF                                               52680000
526900         WHEN SQLCODE = +100                                      52690000
527000         WHEN SQLCODE = -904                                      52700000
527100         WHEN SQLCODE = -913                                      52710000
527200         WHEN SQLCODE = -911                                      52720000
527300             MOVE 62                  TO PV-ERROR-NBR             52730000
527400             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         52740000
527500             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      52750000
527600             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 52760000
527700             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  52770000
527800             MOVE DK-SHIPT-UNT-ID        TO PV-DISPLAY-SML        52780000
527900             PERFORM 9903-WRITE-CICS-LOG                          52790000
528000             PERFORM 9000-SOFT-ABORT                              52800000
528100         WHEN SQLWARN0 NOT = SPACES                               52810000
528200         WHEN SQLCODE < +0                                        52820000
528300         WHEN SQLCODE > +0                                        52830000
528400             MOVE 63                  TO PV-ERROR-NBR             52840000
528500                                         PC033-ERROR-NBR          52850000
528600             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         52860000
528700             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      52870000
528800             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 52880000
528900             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  52890000
529000             MOVE DK-SHIPT-UNT-ID        TO PV-DISPLAY-SML        52900000
529100             PERFORM 9903-WRITE-CICS-LOG                          52910000
529200             MOVE '8800-GET-TPOPRPK'       TO PC033-PARAGRAPH     52920000
529300             MOVE 'PCKRF863 - ERROR SELECTING PO PACK SKU NBR '   52930000
529400                                      TO PC033-MESSAGE-TEXT(1)    52940000
529500             MOVE DK-SHIPT-UNT-ID     TO PV-ERROR-OPER            52950000
529600             MOVE SQLCA               TO PC033-SQLCA              52960000
529700             MOVE 'TPOPRPK       '    TO PC033-DB2-TABLE-NAME(1)  52970000
529800             SET PC033-ABEND          TO TRUE                     52980000
529900             MOVE 99                  TO PC033-PGM-MSG-NBR        52990000
530000             PERFORM 8210-XCTL-ERROR-SCREEN                       53000000
530100     END-EVALUATE.                                                53010000
530200                                                                  53020000
530300*-----------------------------------------------------------------53030000
530400 8850-SELECT-OTBND-PACK.                                          53040000
530500*-----------------------------------------------------------------53050000
530600     EXEC SQL                                                     53060000
530700         SELECT SHPD_PK_QTY                                       53070000
530800         INTO   :SUT00041-SHPD-PK-QTY                             53080000
530900         FROM SUT_OTBND_PK                                        53090000
531000         WHERE  SHIPT_UNT_ID = :DK-SHIPT-UNT-ID                   53100000
531100           AND  TRN_NBR      = :PC033-PO-NBR                      53110000
531200           AND  RCVR_SEQ_NBR = :DK-RCVR-SEQ-NBR                   53120000
531300           AND  PK_SKU_NBR   = :POPRPK-PK-SKU-NBR                 53130000
531400     END-EXEC.                                                    53140000
531500                                                                  53150000
531600     EVALUATE TRUE                                                53160000
531700        WHEN SQLCODE = ZERO                                       53170000
531800            SET PS-OTBND-PK-FOUND    TO TRUE                      53180000
531900        WHEN SQLCODE = +100                                       53190000
532000           CONTINUE                                               53200000
532100         WHEN SQLCODE = -904                                      53210000
532200         WHEN SQLCODE = -913                                      53220000
532300         WHEN SQLCODE = -911                                      53230000
532400             MOVE 107                 TO PV-ERROR-NBR             53240000
532500             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         53250000
532600             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      53260000
532700             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 53270000
532800             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  53280000
532900             MOVE DK-SHIPT-UNT-ID        TO PV-DISPLAY-SML        53290000
533000             PERFORM 9903-WRITE-CICS-LOG                          53300000
533100             PERFORM 9000-SOFT-ABORT                              53310000
533200         WHEN SQLWARN0 NOT = SPACES                               53320000
533300         WHEN SQLCODE < +0                                        53330000
533400         WHEN SQLCODE > +0                                        53340000
533500             MOVE 108                 TO PV-ERROR-NBR             53350000
533600                                         PC033-ERROR-NBR          53360000
533700             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         53370000
533800             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      53380000
533900             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 53390000
534000             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  53400000
534100             MOVE DK-SHIPT-UNT-ID        TO PV-DISPLAY-SML        53410000
534200             PERFORM 9903-WRITE-CICS-LOG                          53420000
534300             MOVE '8850-SELECT-OTBND-PACK' TO PC033-PARAGRAPH     53430000
534400             MOVE 'PCKRF863 - ERROR SELECTING OTBND PACK NBR '    53440000
534500                                      TO PC033-MESSAGE-TEXT(1)    53450000
534600             MOVE DK-SHIPT-UNT-ID     TO PV-ERROR-OPER            53460000
534700             MOVE SQLCA               TO PC033-SQLCA              53470000
534800             MOVE 'OTBD PK  '         TO PC033-DB2-TABLE-NAME(1)  53480000
534900             SET PC033-ABEND          TO TRUE                     53490000
535000             MOVE 99                  TO PC033-PGM-MSG-NBR        53500000
535100             PERFORM 8210-XCTL-ERROR-SCREEN                       53510000
535200     END-EVALUATE.                                                53520000
535300                                                                  53530000
535400*-----------------------------------------------------------------53540000
535500 8900-UPDATE-OTBND-PACK.                                          53550000
535600                                                                  53560000
535700     MOVE PC033-RCVR-SEQ-NBR-CTN  TO DK-RCVR-SEQ-NBR.             53570000
535800                                                                  53580000
535900     EXEC SQL                                                     53590000
536000         UPDATE SUT_OTBND_PK                                      53600000
536100         SET  SHPD_PK_QTY    = :SUT00041-SHPD-PK-QTY              53610000
536200         WHERE SHIPT_UNT_ID  = :DK-SHIPT-UNT-ID                   53620000
536300           AND TRN_NBR       = :PC033-PO-NBR                      53630000
536400           AND RCVR_SEQ_NBR  = :DK-RCVR-SEQ-NBR                   53640000
536500           AND PK_SKU_NBR    = :POPRPK-PK-SKU-NBR                 53650000
536600     END-EXEC.                                                    53660000
536700                                                                  53670000
536800     EVALUATE TRUE                                                53680000
536900         WHEN SQLCODE = +0                                        53690000
537000             CONTINUE                                             53700000
537100         WHEN SQLCODE = +100                                      53710000
537200             PERFORM 8950-INSERT-OTBND-PACK                       53720000
537300         WHEN SQLCODE = -904                                      53730000
537400         WHEN SQLCODE = -913                                      53740000
537500         WHEN SQLCODE = -911                                      53750000
537600             MOVE 64                  TO PV-ERROR-NBR             53760000
537700             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         53770000
537800             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      53780000
537900             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 53790000
538000             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  53800000
538100             MOVE DK-SHIPT-UNT-ID        TO PV-DISPLAY-SML        53810000
538200             PERFORM 9903-WRITE-CICS-LOG                          53820000
538300             PERFORM 9000-SOFT-ABORT                              53830000
538400         WHEN SQLWARN0 NOT = SPACES                               53840000
538500         WHEN SQLCODE < +0                                        53850000
538600         WHEN SQLCODE > +0                                        53860000
538700             MOVE 65                  TO PV-ERROR-NBR             53870000
538800                                         PC033-ERROR-NBR          53880000
538900             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         53890000
539000             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      53900000
539100             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 53910000
539200             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  53920000
539300             MOVE DK-SHIPT-UNT-ID        TO PV-DISPLAY-SML        53930000
539400             PERFORM 9903-WRITE-CICS-LOG                          53940000
539500             MOVE '8900-UPDATE-OTBND-PACK' TO PC033-PARAGRAPH     53950000
539600             MOVE 'PCKRF863 - ERROR UPDATING THE SUT_OTBND_PK'    53960000
539700                                      TO PC033-MESSAGE-TEXT(1)    53970000
539800             MOVE DK-SHIPT-UNT-ID     TO PV-ERROR-OPER            53980000
539900             MOVE SQLCA               TO PC033-SQLCA              53990000
540000             MOVE 'SUT_OTBND_PK'      TO PC033-DB2-TABLE-NAME(1)  54000000
540100             SET PC033-ABEND          TO TRUE                     54010000
540200             MOVE 99                  TO PC033-PGM-MSG-NBR        54020000
540300             PERFORM 8210-XCTL-ERROR-SCREEN                       54030000
540400     END-EVALUATE.                                                54040000
540500                                                                  54050000
540600*-----------------------------------------------------------------54060000
540700 8950-INSERT-OTBND-PACK.                                          54070000
540800     EXEC SQL                                                     54080000
540900         INSERT INTO SUT_OTBND_PK                                 54090000
541000               ( SHIPT_UNT_ID                                     54100000
541100                ,TRN_NBR                                          54110000
541200                ,RCVR_SEQ_NBR                                     54120000
541300                ,TRN_TYP_CDE                                      54130000
541400                ,PK_SKU_NBR                                       54140000
541500                ,SHPD_PK_QTY )                                    54150000
541600         VALUES                                                   54160000
541700              (:DK-SHIPT-UNT-ID                                   54170000
541800             , :PC033-PO-NBR                                      54180000
541900             , :DK-RCVR-SEQ-NBR                                   54190000
542000             , 'PO'                                               54200000
542100             , :POPRPK-PK-SKU-NBR                                 54210000
542200             , :PV-PACK-DIFF )                                    54220000
542300     END-EXEC.                                                    54230000
542400                                                                  54240000
542500     EVALUATE TRUE                                                54250000
542600         WHEN SQLCODE = +0                                        54260000
542700             CONTINUE                                             54270000
542800         WHEN SQLCODE = -904                                      54280000
542900         WHEN SQLCODE = -913                                      54290000
543000         WHEN SQLCODE = -911                                      54300000
543100             MOVE 66                  TO PV-ERROR-NBR             54310000
543200             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         54320000
543300             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      54330000
543400             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 54340000
543500             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  54350000
543600             MOVE DK-SHIPT-UNT-ID        TO PV-DISPLAY-SML        54360000
543700             PERFORM 9903-WRITE-CICS-LOG                          54370000
543800             PERFORM 9000-SOFT-ABORT                              54380000
543900         WHEN SQLWARN0 NOT = SPACES                               54390000
544000         WHEN SQLCODE < +0                                        54400000
544100         WHEN SQLCODE > +0                                        54410000
544200             MOVE 67                  TO PV-ERROR-NBR             54420000
544300                                         PC033-ERROR-NBR          54430000
544400             MOVE PC033-OPER-UNT-ID      TO PV-ERROR-OPER         54440000
544500             MOVE PC033-PO-NBR           TO PV-ERROR-ORD-NBR      54450000
544600             MOVE DK-RCVR-SEQ-NBR        TO PV-ERROR-RCVR-SEQ-NBR 54460000
544700             MOVE PC033-PO-LINE-NBR      TO PV-ERROR-ORD-LNE-NBR  54470000
544800             MOVE DK-SHIPT-UNT-ID        TO PV-DISPLAY-SML        54480000
544900             PERFORM 9903-WRITE-CICS-LOG                          54490000
545000             MOVE '8950-INSERT-OTBND-PACK' TO PC033-PARAGRAPH     54500000
545100             MOVE 'PCKRF863 - ERROR INSERTING THE SUT_OTBND_PK'   54510000
545200                                      TO PC033-MESSAGE-TEXT(1)    54520000
545300             MOVE DK-SHIPT-UNT-ID     TO PV-ERROR-OPER            54530000
545400             MOVE SQLCA               TO PC033-SQLCA              54540000
545500             MOVE 'SUT_OTBND_PK'      TO PC033-DB2-TABLE-NAME(1)  54550000
545600             SET PC033-ABEND          TO TRUE                     54560000
545700             MOVE 99                  TO PC033-PGM-MSG-NBR        54570000
545800             PERFORM 8210-XCTL-ERROR-SCREEN                       54580000
545900     END-EVALUATE.                                                54590000
546000                                                                  54600000
546100*-----------------------------------------------------------------54610000
546200 9000-SOFT-ABORT.                                                 54620000
546300                                                                  54630000
546400     EXEC CICS                                                    54640000
546500         SYNCPOINT ROLLBACK                                       54650000
546600     END-EXEC                                                     54660000
546700                                                                  54670000
546800     MOVE 4                           TO PC033-PGM-MSG-NBR        54680000
546900     MOVE SQLCODE                     TO PC033-SQLCODE            54690000
547000     PERFORM 8210-XCTL-ERROR-SCREEN.                              54700000
547100                                                                  54710000
547200 9100-XCTL-TO-SELECTED-PROGRAM.                                   54720000
547300     SET PC033-INITIALIZE-SCREEN     TO TRUE.                     54730000
547400     MOVE PC-CURRENT-PROGRAM-NAME TO PC033-LAST-PROGRAM.          54740000
547500                                                                  54750000
547600     MOVE LENGTH OF CA-COMMAREA TO PC-COMMAREA-LENGTH             54760000
547700     EXEC CICS                                                    54770000
547800         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    54780000
547900               COMMAREA  (CA-COMMAREA)                            54790000
548000               LENGTH    (PC-COMMAREA-LENGTH)                     54800000
548100               RESP      (PV-CICS-RESPONSE)                       54810000
548200     END-EXEC.                                                    54820000
548300                                                                  54830000
548400     EVALUATE TRUE                                                54840000
548500         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 54850000
548600             CONTINUE                                             54860000
548700         WHEN OTHER                                               54870000
548800             MOVE '9100-XCTL-TO-SELECTED-PROGRAM'                 54880000
548900                 TO DP013-PARAGRAPH                               54890000
549000             MOVE 'UNABLE TO XCTL TO PROGRAM: '                   54900000
549100                 TO DP013-MESSAGE-TEXT (1)                        54910000
549200             MOVE PV-TRANSFER-PROGRAM                             54920000
549300                 TO DP013-MESSAGE-TEXT (2)                        54930000
549400             SET DP013-CICS-ABEND  TO TRUE                        54940000
549500             SET DP013-NO-ROLLBACK TO TRUE                        54950000
549600             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               54960000
549700             MOVE PC-TRANS-UNAVAILABLE-MSG TO AMSGLNO             54970000
549800             SET PC033-PROCESS-SCREEN TO TRUE                     54980000
549900             PERFORM 8000-SEND-MAP                                54990000
550000             PERFORM 8200-RETURN-TRANID                           55000000
550100     END-EVALUATE.                                                55010000
550200                                                                  55020000
550300                                                                  55030000
550400 9903-WRITE-CICS-LOG.                                             55040000
550500                                                                  55050000
550600     MOVE SQLCODE                     TO PV-SQLCODE               55060000
550700     MOVE PC033-CARTON                TO PV-DISPLAY-SML           55070000
550800                                                                  55080000
550900     MOVE LENGTH OF PV-CICS-MSG-AREA  TO PV-COMMAREA-LENGTH.      55090000
551000     EXEC CICS                                                    55100000
551100         WRITEQ TD                                                55110000
551200             QUEUE  ('CSSL')                                      55120000
551300             FROM   (PV-LOG-MSG1)                                 55130000
551400             LENGTH (PV-COMMAREA-LENGTH)                          55140000
551500             RESP   (PV-CICS-RESPONSE)                            55150000
551600     END-EXEC.                                                    55160000
551700                                                                  55170000
551800     MOVE LENGTH OF PV-CICS-MSG-AREA  TO PV-COMMAREA-LENGTH.      55180000
551900     EXEC CICS                                                    55190000
552000         WRITEQ TD                                                55200000
552100             QUEUE  ('CSSL')                                      55210000
552200             FROM   (PV-LOG-MSG2)                                 55220000
552300             LENGTH (PV-COMMAREA-LENGTH)                          55230000
552400             RESP   (PV-CICS-RESPONSE)                            55240000
552500     END-EXEC.                                                    55250000
552600                                                                  55260000
552700     MOVE LENGTH OF PV-CICS-MSG-AREA  TO PV-COMMAREA-LENGTH.      55270000
552800     EXEC CICS                                                    55280000
552900         WRITEQ TD                                                55290000
553000             QUEUE  ('CSSL')                                      55300000
553100             FROM   (PV-LOG-MSG3)                                 55310000
553200             LENGTH (PV-COMMAREA-LENGTH)                          55320000
553300             RESP   (PV-CICS-RESPONSE)                            55330000
553400     END-EXEC.                                                    55340000
553500                                                                  55350000
553600 9990-WRITE-CICS.                                                 55360000
553700     MOVE LENGTH OF PV-CICS-MSG-AREA  TO PV-COMMAREA-LENGTH.      55370000
553800                                                                  55380000
553900     EXEC CICS                                                    55390000
554000         WRITEQ TD                                                55400000
554100         QUEUE ('CSSL')                                           55410000
554200         FROM (PV-CICS-MSG-AREA)                                  55420000
554300         LENGTH (PV-COMMAREA-LENGTH)                              55430000
554400         RESP (PV-CICS-RESPONSE)                                  55440000
554500     END-EXEC.                                                    55450000
554600                                                                  55460000
554700     MOVE SPACES TO PV-CICS-MSG-AREA.                             55470000
554800                                                                  55480000
554900 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  55490000
555000     MOVE PC-CURRENT-PROGRAM-NAME  TO DP013-PROGRAM.              55500000
555100     MOVE DFHEIBLK                 TO DP013-DFHEIBLK.             55510000
555200     INITIALIZE DP013-SRC-TASK-NUMBER                             55520000
555300                DP013-STACK.                                      55530000
555400     SET DP013-LINK-RETURN TO TRUE.                               55540000
555500                                                                  55550000
555600     EXEC CICS                                                    55560000
555700         LINK                                                     55570000
555800             PROGRAM   (DP013-NAME)                               55580000
555900             COMMAREA  (DP013-PARAMETERS)                         55590000
556000             LENGTH    (DP013-LENGTH)                             55600000
556100     END-EXEC.                                                    55610000
