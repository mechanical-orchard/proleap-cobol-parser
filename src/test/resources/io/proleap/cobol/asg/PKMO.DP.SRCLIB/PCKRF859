000100******************************************************************00010099
000200 IDENTIFICATION DIVISION.                                         00020099
000300******************************************************************00030099
000400 PROGRAM-ID.             PCKRF859.                                00040099
000500 AUTHOR.                 GERMAN BANDA.                            00050099
000600 INSTALLATION.           KOHLS.                                   00060099
000700 DATE-WRITTEN            JULY,2001.                               00070099
000800 DATE-COMPILED.                                                   00080099
000900                                                                  00090099
001000******************************************************************00100099
001100* RECLAIM LABEL PROGRAM FOR RF                                    00110099
001200*      THE SCREEN WILL ALLOW AN ASSOCIATE TO RECLAIM CHECK-IN     00120099
001300*      CARTONS (PROCESSED USING UCC128 DATA), AND CASEPACK SPLIT  00130099
001400*      PHYSICAL LABELS THAT HAVE BEEN DIVERTED OR LOADED ONTO A   00140099
001500*      TRAILER. THIS WILL THEN ALLOW THE ASSOCIATE TO DELETE LINES00150099
001600*      PROCESSED BY CASEPACK AND REDOWNLOAD THEM CORRECTLY.       00160099
001700** ** ** ** ** ** ** ** ** ** ** ** ** ** ** ** ** ** ** ** ** ** 00170099
001800* THIS PROGRAM WILL NOW DO BOTH RECLAIM AND USED LABEL PROCESSING.00180099
001900* AS PART OF THE AUTOVE PROJECT 6/2004 DEANNA BRANTNER            00190099
002000******************************************************************00200099
002100* FOR THE RFID PROJECT CHANGED PARAGRAPH 5325- TO ALSO CHECK FOR  00210099
002200* SGN-LOC-ID OF 'RFDC' AND 'RFDF'. CHG0058309  JIM ARENDT         00220099
002300******************************************************************00230099
002400* 02/17/2014    JIM ARENDT         CHG0068598                     00240099
002500* FOR COMBO AUDITS NEED TO RESET BOTH AUDIT NUMBERS.  ADDED NEW   00250099
002600* PARAGRAPH 2002-COMBO-AUDIT-RTN TO PROCESS THE QC AUDIT FOLLOWED 00260099
002700* BY THE 'RF' AUDIT.                                              00270099
002800******************************************************************00280099
002900* 09/30/2014    JIM ARENDT         CHG0094517                     00290099
003000* EXTENDED PO# FROM 7 TO 8 DIGITS WHERE NEEDED.                   00300099
003100******************************************************************00310099
003200 ENVIRONMENT DIVISION.                                            00320099
003300 DATA DIVISION.                                                   00330099
003400                                                                  00340099
003500******************************************************************00350099
003600 WORKING-STORAGE SECTION.                                         00360099
003700******************************************************************00370099
003800 01  CA-COMMAREA.                                                 00380099
003900     COPY PCWS033.                                                00390099
004000                                                                  00400099
004100***************************************************************** 00410099
004200*   RCWS040 - IS THE LAYOUT THAT IS USED TO PASS INFO TO THE    * 00420099
004300*             AUTOVERIFY (AUTOVE) ELIGIBILITY MODULE (RCKUT127).* 00430099
004400***************************************************************** 00440099
004500     COPY RCWS040.                                                00450099
004600/                                                                 00460099
004700 01  WS-AUTO-CONVEYOR-PARAMETERS.                                 00470099
004800     05  WS-AUTOCY-DIRECTIVE-MODE      PIC X(01)     VALUE SPACES.00480099
004900         88  ALL-CARTONS-DIRECTIVES-MODE             VALUE 'A'.   00490099
005000         88  EXCEPTION-DIRECTIVES-MODE               VALUE 'E'.   00500099
005100         88  NO-DIRECTIVES-MODE                      VALUE 'N'.   00510099
005200/                                                                 00520099
005300******************************************************************00530099
005400*    DIRECTIVE GENERATOR REQUEST COMMUNICATION AREA               00540099
005500******************************************************************00550099
005600     COPY SUWS090.                                                00560099
005700/                                                                 00570099
005800 01  DK-DB2-KEYS.                                                 00580099
005900     05  DK-CTN                   PIC S9(18)V COMP-3.             00590099
006000     05  DK-STATUS                PIC  X(01) VALUE SPACE.         00600099
006100     05  DK-CRTN-STATUS           PIC  X(02) VALUE SPACE.         00610099
006200     05  DK-AUDIT-CNTL-NBR        PIC S9(09) COMP.                00620099
006300     05  DK-SHIPT-UNT-ID          PIC S9(18)V COMP-3.             00630099
006400     05  DK-VENDOR-SHIPT-UNT      PIC S9(18)V COMP-3.             00640099
006500     05  DK-OPER-UNT-ID           PIC  S9(4) COMP.                00650099
006600     05  DK-CARTON-TMST           PIC  X(26).                     00660099
006700     05  DK-OTBND-TRIP-ID         PIC  S9(9) COMP.                00670099
006800     05  DK-BRCDE-NBR             PIC  X(22).                     00680099
006900     05  DK-LABOR-OPER            PIC  S9(4) COMP VALUE 0.        00690099
007000     05  DK-PO-NBR                PIC  S9(9) COMP VALUE 0.        00700099
007100     05  DK-PO-LINE-NBR           PIC  S9(9) COMP VALUE 0.        00710099
007200     05  DK-REC-SEQ-NBR           PIC  S9(9) COMP VALUE 0.        00720099
007300     05  DK-RCVR-SEQ-NBR          PIC  S9(9) COMP VALUE 0.        00730099
007400     05  DK-DMG-SHIPT-UNT-ID      PIC S9(18)V COMP-3.             00740099
007500     05  DK-PACK-ID               PIC S9(04)  COMP SYNC.          00750099
007600     05  DK-BARCODE.                                              00760099
007700         10  DK-BRCDE-ZEROS           PIC  X(02).                 00770099
007800         10  DK-BRCDE-REST            PIC  X(20).                 00780099
007900                                                                  00790099
008000 01  DN-DB2-NULL-INDICATORS.                                      00800099
008100     05  DN-AUDIT-IND               PIC S9(04) COMP VALUE ZEROES. 00810099
008200                                                                  00820099
008300 01  PC-PROGRAM-CONSTANTS.                                        00830099
008400     05  PC-RCKCS806                  PIC X(8)  VALUE  'RCKCS806'.00840099
008500     05  PC-DEFAULT-DATE          PIC X(26)   VALUE               00850099
008600                                  '9999-09-09-09.09.09.999999'.   00860099
008700     05  PC-TRANSFER-DOWN-LENGTH         PIC S9(04)  VALUE +9     00870099
008800                                                     COMP.        00880099
008900     05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)  VALUE        00890099
009000         'PCKRF859'.                                              00900099
009100     05  PC-PREV-MENU-PROGRAM            PIC  X(08)               00910099
009200                                              VALUE  'PCKRF885'.  00920099
009300     05  PC-ERROR-MESSAGE-PROGRAM        PIC  X(08)               00930099
009400                                              VALUE 'PCKRF871'.   00940099
009500     05  PC-SUKUT702                     PIC  X(08)               00950099
009600                                              VALUE 'SUKUT702'.   00960099
009700     05  PC-TMKCS520                     PIC X(08)                00970099
009800                                              VALUE  'TMKCS520'.  00980099
009900     05  PC-SUKUT129                     PIC X(08)                00990099
010000                                              VALUE  'SUKUT129'.  01000099
010100     05  PC-RANDOM-NBR-GENERATOR         PIC  X(08)               01010099
010200                                             VALUE 'DPKUT902'.    01020099
010300     05  PC-AUTOVE-MODULE          PIC X(08)  VALUE 'RCKUT127'.   01030099
010400     05  PC-AUTOVE-MODULE-LENGTH   PIC S9(04) VALUE  +400         01040099
010500                                                    COMP SYNC.    01050099
010600     05  PC-CURRENT-TRANID               PIC  X(04)  VALUE 'E859'.01060099
010700     05  PC-CONTAINER-UPD-TRAN           PIC  X(04)  VALUE 'I210'.01070099
010800     05  PC-END-OF-SESSION-MSG           PIC  X(19)  VALUE        01080099
010900         'END OF SESSION     '.                                   01090099
011000     05  PC-INVALID-SELECTION-MSG        PIC  X(19)  VALUE        01100099
011100         'INVALID SELECTION  '.                                   01110099
011200     05  PC-UNRECOGNIZED-PF-KEY-MSG      PIC  X(19)  VALUE        01120099
011300         'UNRECOGNIZED PF KEY'.                                   01130099
011400     05  PC-ACCESS-NOT-ALLOWED-MSG       PIC  X(19)  VALUE        01140099
011500         'USER NOT AUTHORIZED'.                                   01150099
011600     05  PC-NON-NUMERIC-SELECTION-MSG    PIC  X(19)  VALUE        01160099
011700         'NUMERIC VALUE REQ. '.                                   01170099
011800     05  PC-PROGRAM-FUNCTION-KEYS        PIC  X(19)  VALUE        01180099
011900         'F0 =END            '.                                   01190099
012000     05  PC-TRANS-UNAVAILABLE-MSG        PIC  X(19)  VALUE        01200099
012100         'TRANS NOT AVAILABLE'.                                   01210099
012200     05  PC-CICS-ABEND-MSG               PIC  X(19)  VALUE        01220099
012300         'CICS ABEND -CALL DP'.                                   01230099
012400     05  PC-CICSAUTH-MSG                 PIC  X(19)  VALUE        01240099
012500         'CICSAUTH BAD RETURN'.                                   01250099
012600     05  PC-UNAVAIL-SELECTION-MSG        PIC  X(19)  VALUE        01260099
012700         'SELECTION NOT AVAIL'.                                   01270099
012800     05  PC-CARTON-STATUS-ERROR          PIC  X(19)  VALUE        01280099
012900         'CARTON STATUS ERROR'.                                   01290099
013000     05  PC-PLS-ENT-FLD-MSG              PIC X(19) VALUE          01300099
013100                                           'PLEASE ENTER FIELD '. 01310099
013200     05  PC-FIRST-1-NOT-0-MSG       PIC X(19) VALUE               01320099
013300                                           'FIRST DIGIT NOT 0  '. 01330099
013400     05  PC-MORE-DIGITS-REQD        PIC X(19) VALUE               01340099
013500                                           'MORE DIGITS REQUIRD'. 01350099
013600     05  PC-MUST-BE-NUM-MSG         PIC X(19) VALUE               01360099
013700                                           'MUST BE NUMERIC    '. 01370099
013800     05  PC-MUST-BE-GT-0-MSG        PIC X(19) VALUE               01380099
013900                                           'MUST BE > ZERO     '. 01390099
014000     05  PC-MUST-BE-KOHLS-SML       PIC X(19) VALUE               01400099
014100                                           'MUST BE KOHLS SML  '. 01410099
014200     05  PC-DC-NOT-SET-RECLAIM      PIC X(19) VALUE               01420099
014300                                           'DC-NOT RECLAIMING  '. 01430099
014400     05  PC-DC-MUST-BE-DC           PIC X(19) VALUE               01440099
014500                                           'MUST BE YOUR DC    '. 01450099
014600     05  PC-CANNOT-UNUSE-DMG        PIC X(19) VALUE               01460099
014700                                           'CANNOT UNUSE DMG LB'. 01470099
014800     05  PC-CANNOT-RECLAIM-DMG      PIC X(19) VALUE               01480099
014900                                           'CANNOT RECLAIM DMG '. 01490099
015000     05  PC-MUST-UNUSE-PHY-LBL      PIC X(19) VALUE               01500099
015100                                           'MUST UNUSE PHY LBL '. 01510099
015200     05  PC-LABEL-RECLAIM-MSG       PIC X(19) VALUE               01520099
015300                                           'LABEL ALRDY RECLAIM'. 01530099
015400     05  PC-LABEL-UNUSED-MSG        PIC X(19) VALUE               01540099
015500                                           'LABEL ALRDY UNUSED '. 01550099
015600     05  PC-FAST-XFER-MSG           PIC X(19) VALUE               01560099
015700                                           'CANT RCLM FAST XFER'. 01570099
015800     05  PC-DG-ERROR-PARM           PIC X(19) VALUE               01580099
015900                                           'PARM ERROR/SUKUT129'. 01590099
016000     05  PC-DG-ERROR-DB2            PIC X(19) VALUE               01600099
016100                                           'DB2  ERROR/SUKUT129'. 01610099
016200     05  PC-DG-ERROR-MQ             PIC X(19) VALUE               01620099
016300                                           'MQ   ERROR/SUKUT129'. 01630099
016400     05  PC-DG-ERROR-OTHR           PIC X(19) VALUE               01640099
016500                                           'OTHR ERROR/SUKUT129'. 01650099
016600     05  PC-DIRECTIVE-NOT-SENT-MSG  PIC  X(40)       VALUE        01660099
016700         'ERROR ENCOUNTERED IN DIRECTIVE GENERATOR'.              01670099
016800     05  PC-A                            PIC X(01)   VALUE 'A'.   01680099
016900     05  PC-I                            PIC X(01)   VALUE 'I'.   01690099
017000     05  PC-0                            PIC  X(01)  VALUE '0'.   01700099
017100     05  PC-4                            PIC  X(01)  VALUE '4'.   01710099
017200     05  PC-5                            PIC  X(01)  VALUE '5'.   01720099
017300     05  PC-18                           PIC S9(04)  VALUE 18     01730099
017400                                                     COMP SYNC.   01740099
017500     05  PC-20                           PIC S9(04)  VALUE 20     01750099
017600                                                     COMP SYNC.   01760099
017700     05  PC-22                           PIC S9(04)  VALUE 22     01770099
017800                                                     COMP SYNC.   01780099
017900     05  PC-DLX                   PIC X(03) VALUE 'DLX'.          01790099
018000     05  PC-DLLBIN                PIC X(06) VALUE 'DLLBIN'.       01800099
018100     05  PC-CARTON                PIC X(06) VALUE 'CARTON'.       01810099
018200     05  PC-RECLAIM               PIC X(07) VALUE 'RECLAIM'.      01820099
018300                                                                  01830099
018400                                                                  01840099
018500 01  PS-PROGRAM-SWITCHES.                                         01850099
018600     05  PS-DIRECTIVE-FOUND-SW          PIC  X(01)  VALUE 'N'.    01860099
018700         88  PS-DIRECTIVE-NOTFOUND                  VALUE 'N'.    01870099
018800         88  PS-DIRECTIVE-FOUND                     VALUE 'Y'.    01880099
018900     05  PS-PROCESSING-FIRST-FETCH-SW   PIC  X(01)  VALUE 'N'.    01890099
019000         88  PS-NOT-PROCESSING-FIRST-FETCH          VALUE 'N'.    01900099
019100         88  PS-PROCESSING-FIRST-FETCH              VALUE 'Y'.    01910099
019200     05  PS-DONT-APPLY-CRT-UPDATES-SW   PIC  X(01)  VALUE 'N'.    01920099
019300         88  PS-APPLY-CRT-UPDATES                   VALUE 'N'.    01930099
019400         88  PS-DONT-APPLY-CRT-UPDATES              VALUE 'Y'.    01940099
019500     05  PS-OTBND-PK-FOUND-SW           PIC  X(01)  VALUE 'Y'.    01950099
019600         88  PS-NO-OTBND-PK-FOUND                   VALUE 'N'.    01960099
019700         88  PS-OTBND-PK-FOUND                      VALUE 'Y'.    01970099
019800     05  PS-UPDATE-NBR-PACKS-SW         PIC  X(01)  VALUE 'N'.    01980099
019900         88  PS-DONT-UPDATE-NBR-PACKS               VALUE 'N'.    01990099
020000         88  PS-UPDATE-NBR-PACKS                    VALUE 'Y'.    02000099
020100     05  PS-BACK-OUT-UPDATES-SW         PIC  X(01)  VALUE 'N'.    02010099
020200         88  PS-BACK-OUT-UPDATES                    VALUE 'Y'.    02020099
020300         88  PS-DONT-BACK-OUT-UPDATES               VALUE 'N'.    02030099
020400     05  PS-APPLY-UPDATES-SECOND-PS-SW   PIC X(01)  VALUE 'N'.    02040099
020500         88  PS-APPLY-TO-ALL-PACKS                  VALUE 'N'.    02050099
020600         88  PS-APPLY-UPDATES-SECOND-PASS           VALUE 'Y'.    02060099
020700     05  PS-ODD-UNITS-IN-CARTON-SW      PIC  X(01)  VALUE 'N'.    02070099
020800         88  PS-NO-ODD-UNITS-IN-CARTON              VALUE 'N'.    02080099
020900         88  PS-ODD-UNITS-IN-CARTON                 VALUE 'Y'.    02090099
021000     05  PS-PRE-PACK-PROCESSING-SW      PIC  X(01)  VALUE 'N'.    02100099
021100         88  PS-NO-PRE-PACK-PROCESSING              VALUE 'N'.    02110099
021200         88  PS-PRE-PACK-PROCESSING                 VALUE 'Y'.    02120099
021300     05  PS-EOC-PAC-CSR-SW              PIC  X(01)  VALUE 'N'.    02130099
021400         88  PS-EOC-PAC-CSR                         VALUE 'Y'.    02140099
021500         88  PS-NOT-EOC-PAC-CSR                     VALUE 'N'.    02150099
021600     05  PS-PACK-RECS-PROCESSED-SW      PIC  X(01)  VALUE 'N'.    02160099
021700         88  PS-PACK-RECS-PROCESSED                 VALUE 'Y'.    02170099
021800         88  PS-NO-PACK-RECS-PROCESSED              VALUE 'N'.    02180099
021900     05  PS-INVALID-INPUT-SW             PIC  X(01)  VALUE 'N'.   02190099
022000         88  PS-INVALID-INPUT                        VALUE 'Y'.   02200099
022100         88  PS-VALID-INPUT                          VALUE 'N'.   02210099
022200     05  PS-BLND-RECV-SIMPL-LOC-SW    PIC  X(01)  VALUE 'N'.      02220099
022300         88  PS-BLND-RECV-SIMPL-LOC-FND           VALUE 'Y'.      02230099
022400         88  PS-BLND-RECV-SIMPL-LOC-NOT-FND       VALUE 'N'.      02240099
022500     05  PS-OTBND-CART-CREATE-SOURCE     PIC  X(03)  VALUE SPACE. 02250099
022600         88  PS-CREATED-BY-CSEPK                     VALUE 'CPS'. 02260099
022700         88  PS-CREATED-BY-ASN                       VALUE 'ASN'. 02270099
022800         88  PS-CREATED-BY-SMO                       VALUE 'SMO'. 02280099
022900     05  PS-ERROR-SW                     PIC  X(01)  VALUE 'N'.   02290099
023000         88  PS-ERROR                                VALUE 'Y'.   02300099
023100         88  PS-ERROR-NO                             VALUE 'N'.   02310099
023200     05  PS-VENDOR-CARTON-AUDIT-SW       PIC  X(01)  VALUE 'N'.   02320099
023300         88  PS-VENDOR-CARTON-AUDIT                  VALUE 'Y'.   02330099
023400         88  PS-NO-VENDOR-CARTON-AUDIT               VALUE 'N'.   02340099
023500     05  PS-VENDOR-CARTON-FND-SW         PIC  X(01)  VALUE 'N'.   02350099
023600         88  PS-VENDOR-CARTON-FND                    VALUE 'Y'.   02360099
023700         88  PS-NO-VENDOR-CARTON-FND                 VALUE 'N'.   02370099
023800     05  PS-FAST-XFER-CRTN-FND-SW        PIC  X(01)  VALUE 'N'.   02380099
023900         88  PS-FAST-XFER-CRTN-FND                   VALUE 'Y'.   02390099
024000         88  PS-NO-FAST-XFER-CRTN-FND                VALUE 'N'.   02400099
024100     05  PS-P2L-BOUND-BRCDE-FND-SW       PIC  X(01)  VALUE 'N'.   02410099
024200         88  PS-P2L-BOUND-BRCDE-FND                  VALUE 'Y'.   02420099
024300         88  PS-NO-P2L-BOUND-BRCDE-FND               VALUE 'N'.   02430099
024400     05  PS-FINCL-ADJST-PROCESS-SW       PIC  X(01)  VALUE 'N'.   02440099
024500         88  PS-MORE-FINCL-ADJST-YES                 VALUE 'Y'.   02450099
024600         88  PS-MORE-FINCL-ADJST-NO                  VALUE 'N'.   02460099
024700     05  PS-TSUQADJ-DMG-PROCESS-SW       PIC  X(01)  VALUE 'N'.   02470099
024800         88  PS-MORE-TSUQADJ-DMG-YES                 VALUE 'Y'.   02480099
024900         88  PS-MORE-TSUQADJ-DMG-NO                  VALUE 'N'.   02490099
025000     05  PS-FINCL-ADJ-ID-EXISTS-SW      PIC  X(01)  VALUE 'N'.    02500099
025100         88  PS-FINCL-ADJ-ID-EXISTS                 VALUE 'Y'.    02510099
025200         88  PS-FINCL-ADJ-ID-NOT-EXISTS             VALUE 'N'.    02520099
025300     05  PS-DMG-CRTN-EXISTS-SW          PIC  X(01)  VALUE 'N'.    02530099
025400         88  PS-DMG-CRTN-EXISTS                     VALUE 'Y'.    02540099
025500         88  PS-DMG-CRTN-NOT-EXISTS                 VALUE 'N'.    02550099
025600     05  PS-ADJSTMNTS-EXIST-SW          PIC  X(01)  VALUE 'N'.    02560099
025700         88  PS-ADJSTMNTS-EXIST                     VALUE 'Y'.    02570099
025800         88  PS-ADJSTMNTS-NOT-EXIST                 VALUE 'N'.    02580099
025900     05  PS-TRBL-FOUND-SW               PIC  X(01)  VALUE 'N'.    02590099
026000         88  PS-TRBL-FOUND                          VALUE 'Y'.    02600099
026100         88  PS-TRBL-NOT-FOUND                      VALUE 'N'.    02610099
026200     05  PS-DC-INTERFC-LABOR-SW         PIC  X(01)  VALUE 'N'.    02620099
026300         88  PS-DC-INTERFC-LABOR-YES                VALUE 'Y'.    02630099
026400         88  PS-DC-INTERFC-LABOR-NO                 VALUE 'N'.    02640099
026500     05  PS-ASSOC-LABOR-ASGMT-SW        PIC  X(01)  VALUE 'N'.    02650099
026600         88  PS-ASSOC-LABOR-ASGMT-YES               VALUE 'Y'.    02660099
026700         88  PS-ASSOC-LABOR-ASGMT-NO                VALUE 'N'.    02670099
026800     05  PS-LABOR-NEXT-SEQ-SW           PIC  X(01)  VALUE 'N'.    02680099
026900         88  PS-LABOR-NEXT-SEQ-YES                  VALUE 'Y'.    02690099
027000         88  PS-LABOR-NEXT-SEQ-NO                   VALUE 'N'.    02700099
027100     05  PS-PACK-BY-STORE-SW            PIC  X(01)  VALUE 'N'.    02710099
027200         88  PS-PACK-BY-STORE-YES                   VALUE 'Y'.    02720099
027300         88  PS-PACK-BY-STORE-NO                    VALUE 'N'.    02730099
027400     05  PS-PBS-DC-RTV-SW               PIC  X(01)  VALUE 'N'.    02740099
027500         88  PS-PBS-DC-RTV-YES                      VALUE 'Y'.    02750099
027600         88  PS-PBS-DC-RTV-NO                       VALUE 'N'.    02760099
027700     05  PS-OTBND-CART-SW                PIC  X(01)  VALUE 'N'.   02770099
027800         88  PS-OTBND-CART-YES                       VALUE 'Y'.   02780099
027900         88  PS-OTBND-CART-NO                        VALUE 'N'.   02790099
028000     05  PS-INACTIVE-LABEL-SW            PIC  X(01)  VALUE 'N'.   02800099
028100         88  PS-LABEL-RECLAIM                        VALUE 'Y'.   02810099
028200         88  PS-LABEL-UNUSED                         VALUE 'Z'.   02820099
028300     05  PS-PRMTED-QCAUD-CRTN-SW         PIC  X(01)  VALUE 'N'.   02830099
028400         88  PS-PRMTED-QCAUD-CRTN-YES                VALUE 'Y'.   02840099
028500         88  PS-PRMTED-QCAUD-CRTN-NO                 VALUE 'N'.   02850099
028600     05  PS-PRMTED-RFAUD-CRTN-SW         PIC  X(01)  VALUE 'N'.   02860099
028700         88  PS-PRMTED-RFAUD-CRTN-YES                VALUE 'Y'.   02870099
028800         88  PS-PRMTED-RFAUD-CRTN-NO                 VALUE 'N'.   02880099
028900     05  PS-PROCESS-AUDIT-SW             PIC  X(01)  VALUE 'N'.   02890099
029000         88  PS-PROCESS-QC                           VALUE 'Q'.   02900099
029100         88  PS-PROCESS-RF                           VALUE 'R'.   02910099
029200         88  PS-PROCESS-NONE                         VALUE 'N'.   02920099
029300     05  PS-DELETE-QC-SW                 PIC  X(01)  VALUE 'N'.   02930099
029400         88  PS-DELETE-QC-YES                        VALUE 'Y'.   02940099
029500         88  PS-DELETE-QC-NO                         VALUE 'N'.   02950099
029600*                                                                 02960099
029700 01  PV-PROGRAM-VARIABLES.                                        02970099
029800     05  PV-PACK-ID                      PIC S9(04)  COMP SYNC.   02980099
029900     05  PV-PACK-DIFF                    PIC  S9(9) COMP VALUE 0. 02990099
030000     05  PV-ODD-DIFF                     PIC  S9(9) COMP VALUE 0. 03000099
030100     05  PV-SAVE-PACK-DIFF               PIC  S9(9) COMP VALUE 0. 03010099
030200     05  PV-UPDATE-QTY                   PIC  S9(9) COMP.         03020099
030300     05  PV-SAVE-NBR-OF-PACKS            PIC  S9(5) COMP-3.       03030099
030400     05  PV-CARTON-LINE-IDX              PIC  S9(4) COMP VALUE 0. 03040099
030500     05  PV-NUMBER-OF-LINES              PIC  S9(5) COMP-3.       03050099
030600     05  PV-USER-ID                      PIC  X(08).              03060099
030700     05  PV-RF-AUD-CNTL-NBR              PIC S9(9)  COMP.         03070099
030800     05  PV-RF-CART-PRMPT-CDE            PIC  X(1)  VALUE SPACES. 03080099
030900     05  PV-HOLD-QC-AUDIT-NBR            PIC S9(9)  COMP.         03090099
031000     05  PV-SUB                          PIC S9(4) COMP           03100099
031100                                                VALUE ZERO.       03110099
031200     05  PV-BARCODE-1-22.                                         03120099
031300         10  PV-BARCODE-1-18             PIC 9(18)  VALUE ZEROES. 03130099
031400         10  FILLER                      PIC X(04)  VALUE SPACES. 03140099
031500     05  PV-BARCODE.                                              03150099
031600         10  PV-BARCODE-1-2              PIC 9(02)  VALUE ZEROES. 03160099
031700         10  PV-BARCODE-3-20             PIC 9(18)  VALUE ZEROES. 03170099
031800     05  PV-MESSAGE-AREA                 PIC  X(19)  VALUE SPACE. 03180099
031900     05  PV-DISP-FINC-ADJ-ID             PIC  9(09) VALUE 0.      03190099
032000     05  PV-DISP-CARTON-ID               PIC  9(18).              03200099
032100     05  PV-DISP-PACK-ID                 PIC  9(06).              03210099
032200     05  PV-DISPLAY-PO-RCVR              PIC  9(06).              03220099
032300     05  PV-DISP-SHIPT-UNT-ID            PIC  9(18).              03230099
032400     05  PV-DISP-CICS-RESPONSE           PIC  9(09)  VALUE ZEROS. 03240099
032500     05  PV-CICS-RESPONSE                PIC S9(08)  VALUE ZEROS  03250099
032600                                                     COMP SYNC.   03260099
032700     05  PV-TRANSFER-PROGRAM             PIC  X(08)  VALUE SPACE. 03270099
032800     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     03280099
032900                                                     COMP SYNC.   03290099
033000*                                                                 03300099
033100     05  PV-SCAN-TIMESTAMP               PIC  X(26)  VALUE SPACE. 03310099
033200     05  PV-TIMESTAMP                    PIC  X(26)  VALUE SPACE. 03320099
033300*                                                                 03330099
033400     05  PV-CARTON-NBR                   PIC  X(22).              03340099
033500*                                                                 03350099
033600     05  PV-CTN-X                        PIC  X(18).              03360099
033700     05  PV-CTN-N REDEFINES PV-CTN-X     PIC  9(18).              03370099
033800     05  PV-18-DIGIT-BCDE REDEFINES PV-CTN-X.                     03380099
033900         10  PV-18-SML-PACKAGING-TYP         PIC 9(01).           03390099
034000         10  PV-18-SML-SOFTWARE-SRC          PIC 9(01).           03400099
034100         10  PV-18-SML-BC-DIVERT.                                 03410099
034200             15  PV-18-SML-BC-DIVERT-PFX     PIC 9(01).           03420099
034300             15  PV-18-SML-BC-DIVERT-CDE     PIC 9(04).           03430099
034400         10  PV-18-SML-BC-DC-ORIGIN          PIC 9(03).           03440099
034500         10  PV-18-SML-BC-MNFST-NBR          PIC 9(08).           03450099
034600*                                                                 03460099
034700     05  PV-CTN-P.                                                03470099
034800         10  PV-CTN-CHAR              PIC X(01)                   03480099
034900                            OCCURS 20 TIMES.                      03490099
035000     05  PV-CTN-18                    PIC X(18) VALUE ZEROES.     03500099
035100     05  PV-CTN-T REDEFINES PV-CTN-18 PIC 9(18).                  03510099
035200                                                                  03520099
035300     05  PV-BARCODE-CHECKER           PIC X(20).                  03530099
035400* VALID PATTERNS                                                  03540099
035500         88  PV-VALID-BARCODE         VALUES                      03550099
035600             '00499999999999999999'                               03560099
035700             'B049999999999999999B'                               03570099
035800             'BB499999999999999999'                               03580099
035900             '499999999999999999BB'                               03590099
036000             '409999999999999999BB'                               03600099
036100             '449999999999999999BB'                               03610099
036200             'B409999999999999999B'                               03620099
036300             'B499999999999999999B'                               03630099
036400             'B449999999999999999B'.                              03640099
036500         88  PV-2-LEAD-ZEROES         VALUE                       03650099
036600             '00499999999999999999'.                              03660099
036700         88  PV-LEAD-TRAIL-SPACES     VALUE                       03670099
036800             'B499999999999999999B'                               03680099
036900             'B409999999999999999B'                               03690099
037000             'B449999999999999999B'.                              03700099
037100         88  PV-2-LEAD-SPACES         VALUE                       03710099
037200             'BB499999999999999999'.                              03720099
037300         88  PV-TRAIL-SPACES          VALUE                       03730099
037400             '499999999999999999BB'                               03740099
037500             '409999999999999999BB'                               03750099
037600             '449999999999999999BB'.                              03760099
037700                                                                  03770099
037800* INVALID PATTERNS                                                03780099
037900         88  PV-NOT-START-WITH-4      VALUES                      03790099
038000             '999999999999999999BB'                               03800099
038100             'B999999999999999999B'                               03810099
038200             'BB999999999999999999'.                              03820099
038300         88  PV-NOT-START-WITH-004    VALUES                      03830099
038400             '00999999999999999999'.                              03840099
038500         88  PV-INVALID-ALL-BLANK     VALUES                      03850099
038600             'BBBBBBBBBBBBBBBBBBBB'.                              03860099
038700                                                                  03870099
038800     05  PV-BARCODE-EDIT-MASK REDEFINES                           03880099
038900                              PV-BARCODE-CHECKER.                 03890099
039000         10  PV-BARCODE-CHAR          PIC X(01)                   03900099
039100                              OCCURS 20 TIMES.                    03910099
039200     05  PV-CHAR-COUNT                   PIC S9(04)  VALUE ZEROS  03920099
039300                                                     COMP SYNC.   03930099
039400     05  PV-CHILD-COUNT                  PIC S9(04)  VALUE ZEROS  03940099
039500                                                     COMP SYNC.   03950099
039600     05  PV-OTBND-UPC-COUNT              PIC S9(04) COMP          03960099
039700                                                       VALUE ZERO.03970099
039800     05  PV-FINCL-ADJ-ID                 PIC S9(9)   COMP SYNC.   03980099
039900     05  PV-ADJUST-COUNT                 PIC S9(04)  VALUE +0     03990099
040000                                                    COMP SYNC.    04000099
040100     05  PV-PRMTD-QCCRTN-COUNT           PIC S9(04)  VALUE +0     04010099
040200                                                    COMP SYNC.    04020099
040300     05  PV-PRMTD-RFCRTN-COUNT           PIC S9(04)  VALUE +0     04030099
040400                                                    COMP SYNC.    04040099
040500                                                                  04050099
040510     05  PV-CTN-SNGL-DGIT-CHECK          PIC X(01)   VALUE SPACE. 04051099
040520         88 PV-SNGL-DGIT-VALID       VALUE                        04052099
040530                       '0', '1', '2', '3', '4',                   04053099
040540                       '5', '6', '7', '8', '9'.                   04054099
040550                                                                  04055099
040600     05  PV-CTN.                                                  04060099
040700         10  PV-CTN-FIRST-DIGIT      PIC  X(01).                  04070099
040800         10  PV-CTN-LAST-17          PIC  X(17).                  04080099
040900         10  PV-CTN-FILLER           PIC  X(04).                  04090099
041000     05  FILLER REDEFINES PV-CTN.                                 04100099
041100         10  PV-CTN-SCAN-00          PIC  X(02).                  04110099
041200         10  PV-CTN-SCAN-THIRD-DGT   PIC  X(01).                  04120099
041300         10  PV-CTN-SCAN-LAST-17     PIC  X(17).                  04130099
041400         10  PV-CTN-SCAN-LAST-2      PIC  X(02).                  04140099
041500     05  FILLER REDEFINES PV-CTN.                                 04150099
041600         10  PV-CTN-SCAN-00          PIC  X(02).                  04160099
041700         10  PV-CTN-SCAN-LAST-18     PIC  X(18).                  04170099
041800         10  PV-CTN-SCAN-LAST-2      PIC  X(02).                  04180099
041900                                                                  04190099
042000     05  PV-SUB1                         PIC S9(4) COMP SYNC.     04200099
042100     05  PV-SUB2                         PIC S9(4) COMP SYNC.     04210099
042200                                                                  04220099
042300     05  PV-INPUT-FIELD                  PIC X(22).               04230099
042400     05  FILLER REDEFINES PV-INPUT-FIELD.                         04240099
042500         10  PV-INPUT-BYTES OCCURS 22 TIMES.                      04250099
042600             15  PV-IN-BYTE              PIC X(01).               04260099
042700                                                                  04270099
042800     05  PV-OUTPUT-FIELD                 PIC X(22).               04280099
042900     05  FILLER REDEFINES PV-OUTPUT-FIELD.                        04290099
043000         10  PV-OUTPUT-BYTE OCCURS 22 TIMES.                      04300099
043100             15  PV-OUT-BYTE             PIC X(01).               04310099
043200*                                                                 04320099
043300     05  PV-VENDOR-SSCC                  PIC S9(18) VALUE 0       04330099
043400                                                    COMP-3.       04340099
043500     05  PV-OTBD-TRIP-ID-TRLR            PIC S9(09)               04350099
043600                                              VALUE ZEROES.       04360099
043700     05  PV-DEST-OPER-TRLR               PIC S9(04)  VALUE  0     04370099
043800                                                     COMP.        04380099
043900     05  PV-OTBD-TRIP-ID-CRTN            PIC S9(09)               04390099
044000                                              VALUE ZEROES.       04400099
044100     05  PV-DEST-OPER-CRTN               PIC S9(04)  VALUE  0     04410099
044200                                                     COMP.        04420099
044300     05  PV-FINCL-SUM-NET-QTY            PIC  S9(4) COMP.         04430099
044400     05  PV-FINCL-NEW-AFT-QTY            PIC  S9(4) COMP.         04440099
044500     05  PV-FINCL-NEW-BEF-QTY            PIC  S9(4) COMP.         04450099
044600     05  PV-DB2-VE-COUNT                 PIC S9(09)   VALUE +0    04460099
044700                                                      COMP-3.     04470099
044800     05  PV-BEF-QTY                      PIC  S9(4) COMP          04480099
044900                                              VALUE ZEROES.       04490099
045000     05  PV-AFT-QTY                      PIC  S9(4) COMP          04500099
045100                                              VALUE ZEROES.       04510099
045200     05  PV-AFTER-QTY                    PIC  S9(4) COMP          04520099
045300                                              VALUE ZEROES.       04530099
045400     05  PV-DMG-NET-QTY                  PIC  S9(4) COMP          04540099
045500                                              VALUE ZEROES.       04550099
045600                                                                  04560099
045700     05  PV-CRTN-STAT-TMST.                                       04570099
045800         10  PV-CRTN-STAT-CCYY         PIC  X(04)  VALUE SPACE.   04580099
045900         10  FILLER                    PIC  X(01)  VALUE '-'.     04590099
046000         10  PV-CRTN-STAT-MM           PIC  X(02)  VALUE SPACE.   04600099
046100         10  FILLER                    PIC  X(01)  VALUE '-'.     04610099
046200         10  PV-CRTN-STAT-DD           PIC  X(02)  VALUE SPACE.   04620099
046300         10  FILLER                    PIC  X(01)  VALUE '-'.     04630099
046400         10  PV-CRTN-STAT-HR           PIC  X(02)  VALUE SPACE.   04640099
046500         10  FILLER                    PIC  X(01)  VALUE '.'.     04650099
046600         10  PV-CRTN-STAT-MN           PIC  X(02)  VALUE SPACE.   04660099
046700         10  FILLER                    PIC  X(01)  VALUE '.'.     04670099
046800         10  PV-CRTN-STAT-SC           PIC  X(02)  VALUE SPACE.   04680099
046900         10  FILLER                    PIC  X(01)  VALUE '.'.     04690099
047000         10  PV-CRTN-STAT-MS           PIC  X(06)  VALUE SPACE.   04700099
047100*                                                                 04710099
047200         10  PV-PO-RCVR.                                          04720099
047300* CHG0094517 CHANGED NEXT LINE FROM 9(07) TO 9(08).               04730099
047400             15 PV-PO-OUT                PIC  9(08).              04740099
047500             15 FILLER                   PIC  X(01)  VALUE '-'.   04750099
047600             15 PV-RCVR-OUT              PIC 9(03).               04760099
047700*                                                                 04770099
047800 01  PV-LOG-MSG.                                                  04780099
047900     05  FILLER                       PIC X(12) VALUE             04790099
048000         ' E851 ERROR '.                                          04800099
048100     05  FILLER                       PIC X(09) VALUE             04810099
048200         'SQLCODE= '.                                             04820099
048300     05  PV-SQLCODE                   PIC -9(03).                 04830099
048400     05  FILLER                       PIC X(06) VALUE             04840099
048500         ' ERR= '.                                                04850099
048600     05  PV-ERROR-NBR                 PIC 9(03) VALUE ZERO.       04860099
048700     05  FILLER                       PIC X(06) VALUE             04870099
048800         ' UPC= '.                                                04880099
048900     05  PV-DISPLAY-CARTON            PIC 9(18) VALUE ZEROES.     04890099
049000                                                                  04900099
049100     05  PV-DISPLAY-PO            PIC  9(09) VALUE 0.             04910099
049200     05  PV-DISPLAY-RCVR          PIC  9(04) VALUE 0.             04920099
049300     05  PV-DISPLAY-LINE          PIC  9(04) VALUE 0.             04930099
049400     05  PV-DISPLAY-DEST          PIC  9(04) VALUE 0.             04940099
049500     05  PV-DISPLAY-PACK          PIC  9(04) VALUE 0.             04950099
049600     05  PV-DISPLAY-SQLCODE       PIC -9(04).                     04960099
049700     05  PV-DISPLAY-OPER          PIC  9(04) VALUE 0.             04970099
049800     05  PV-DISPLAY-QTY           PIC  9(09) VALUE 0.             04980099
049900     05  PV-DISPLAY-SHIPT-UNIT    PIC  9(18) VALUE 0.             04990099
050000     05  PV-DISP-NOTIF-NBR        PIC  9(09) VALUE 0.             05000099
050100     05  PV-CICS-RESP             PIC S9(04) COMP VALUE 0.        05010099
050200                                                                  05020099
050300     05  PV-LABOR-SSCC              PIC S9(18) VALUE 0 COMP-3.    05030099
050400     05  PV-LABOR-PO-NBR            PIC  9(09) VALUE 0.           05040099
050500     05  PV-LABOR-RCVR-NBR          PIC  X(03) VALUE SPACES.      05050099
050600     05  PS-AC-CRTN-DEST-CD         PIC  X(01) VALUE SPACES.      05060099
050700         88  PS-AC-CRTN-TO-P2L                 VALUE 'P'.         05070099
050800         88  PS-AC-CRTN-TO-LOC                 VALUE 'S'.         05080099
050900     05  PV-LABOR-CRTN-LOC        PIC S9(04)   VALUE 0.           05090099
051000                                                                  05100099
051100     05  PV-LABOR-ASGMT-STRT-DTE    PIC  X(10) VALUE SPACES.      05110099
051200     05  PV-LABOR-ASGMT-NBR-TXT     PIC  X(10) VALUE SPACES.      05120099
051300     05  PV-LABOR-ASGMT-NBR-SEQ-NBR PIC S9(09) COMP VALUE 0.      05130099
051400     05  PV-LABOR-SEQ-START-NBR     PIC S9(09) COMP VALUE 0.      05140099
051500     05  PV-LABOR-DUMMY-TK          PIC  X(08) VALUE SPACES.      05150099
051600     05  PV-LABOR-USER-ID           PIC  X(08) VALUE SPACES.      05160099
051700     05  PV-LABOR-CURRENT-DATE      PIC  X(10) VALUE SPACES.      05170099
051800     05  PV-LABOR-CURRENT-TIME      PIC  X(08) VALUE SPACES.      05180099
051900     05  PV-CURRENT-PARAGRAPH       PIC  X(04) VALUE SPACES.      05190099
052000     05  PV-ERROR-CONDITION         PIC  X(40) VALUE SPACES.      05200099
052100     05  PV-CICS-MSG-AREA2          PIC X(100) VALUE SPACES.      05210099
052200                                                                  05220099
052300     05  PV-CARTON-MSG.                                           05230099
052400         10  FILLER                   PIC X(01) VALUE SPACE.      05240099
052500         10  FILLER                   PIC X(08) VALUE 'PCKRF881'. 05250099
052600         10  FILLER                   PIC X(01) VALUE '-'.        05260099
052700         10  PV-CTN-PARA              PIC X(04) VALUE SPACES.     05270099
052800         10  FILLER                   PIC X(05) VALUE ' REC='.    05280099
052900         10  PV-CTN-RET-CDE           PIC X(02) VALUE SPACES.     05290099
053000         10  FILLER                   PIC X(10)                   05300099
053100                             VALUE ' CTN STAT='.                  05310099
053200         10  PV-CTN-STATUS            PIC X(02) VALUE SPACES.     05320099
053300         10  FILLER                   PIC X(01) VALUE '/'.        05330099
053400         10  PV-CTN-STAT-DESC         PIC X(19) VALUE SPACES.     05340099
053500         10  FILLER                   PIC X(05) VALUE ' SER='.    05350099
053600         10  PV-CTN-TRLR-SERIAL       PIC 9(09) VALUE ZEROES.     05360099
053700         10  FILLER                   PIC X(06) VALUE ' TRIP='.   05370099
053800         10  PV-CTN-TRIP              PIC 9(09) VALUE ZEROES.     05380099
053900         10  FILLER                   PIC X(06) VALUE ' STAT='.   05390099
054000         10  PV-CTN-TRIP-STAT         PIC X(02) VALUE SPACES.     05400099
054100         10  FILLER                   PIC X(06) VALUE ' USER='.   05410099
054200         10  PV-CTN-STAT-USERID       PIC X(08) VALUE SPACES.     05420099
054300                                                                  05430099
054400 01  TB-PACK-TABLE.                                               05440099
054500     05  TB-PACK-ITEM OCCURS 500 TIMES INDEXED BY LINE-IDX.       05450099
054600         10  PACK-IND                    PIC   X(01).             05460099
054700         10  PACK-PRPPK-ID               PIC  S9(4) COMP.         05470099
054800         10  PACK-PREPK-DRV-LNE-CDE      PIC   X(01).             05480099
054900         10  PACK-LINE                   PIC  S9(9) COMP.         05490099
055000         10  PACK-ITM                    PIC  S9(15) COMP-3.      05500099
055100         10  PACK-UPC                    PIC  S9(15) COMP-3.      05510099
055200         10  PACK-RATO                   PIC  S9(4) COMP.         05520099
055300         10  PACK-AUDIT-QTY              PIC  S9(09) COMP-3.      05530099
055400         10  PACK-CRTN-QTY               PIC  S9(09) COMP-3.      05540099
055500         10  PACK-CRTN-REC-TYPE          PIC   X(01).             05550099
055600         10  PACK-CRTN-INTR-UPC          PIC  S9(9)  COMP.        05560099
055700         10  PACK-CRTN-HOLD-UPC          PIC  S9(15)V COMP-3.     05570099
055800         10  PACK-AUD-REC-TYPE           PIC   X(02).             05580099
055900         10  PACK-AUD-INTR-UPC           PIC  S9(9)  COMP.        05590099
056000         10  PACK-AUD-HOLD-UPC           PIC  S9(15)V COMP-3.     05600099
056100         10  PACK-BEST-CASE-UNITS        PIC  S9(07) COMP-3.      05610099
056200         10  PACK-ODD-UNITS              PIC  S9(05) COMP-3.      05620099
056300         10  PACK-BACKOUT-IND            PIC   X(01).             05630099
056400******************************************************************05640099
056500*  LAYOUT FOR THE TRAILER AUDIT MANIFESTING MESSAGES              05650099
056600******************************************************************05660099
056700     COPY PCWS034.                                                05670099
056800                                                                  05680099
056900******************************************************************05690099
057000*    PREPACK VERIFICATION                                         05700099
057100******************************************************************05710099
057200     COPY RCWS806.                                                05720099
057300                                                                  05730099
057400******************************************************************05740099
057500*  LAYOUT TO PASS TO THE UNIT ADJUSTMENT PROGRAMS                 05750099
057600******************************************************************05760099
057700     COPY SUWS035.                                                05770099
057800                                                                  05780099
057900***************************************************************** 05790099
058000*   SUWS036 - IS THE LAYOUT THAT IS USED TO PASS INFO TO THE    * 05800099
058100*             UPDATE UNIT QUANTITIES MODULE (SUKUT706).         * 05810099
058200***************************************************************** 05820099
058300     COPY SUWS036.                                                05830099
058400                                                                  05840099
058500******************************************************************05850099
058600*  LAYOUT FOR THE CARTON STATUS MODULE (PCKUT713)                 05860099
058700******************************************************************05870099
058800     COPY PCWS046.                                                05880099
058900                                                                  05890099
059600*----------------------------------------------------------------*05960099
059700*    COMMAREA FOR TMKCS520.                                      *05970099
059800*----------------------------------------------------------------*05980099
059900     COPY TMWS500.                                                05990099
060000                                                                  06000099
060100*----------------------------------------------------------------*06010099
060200*    DLKUP001 COMMAREA - NUMBER EVENTS WITHIN LABOR ASSIGNMENT.  *06020099
060300*----------------------------------------------------------------*06030099
060400     COPY DLWS001.                                                06040099
060500                                                                  06050099
060600*----------------------------------------------------------------*06060099
060700*    DLKUT001 COMMAREA - DETERMINE ASSOCIATE RELATIONSHIP TO     *06070099
060800*                        ASSIGNMENT.                             *06080099
060900*----------------------------------------------------------------*06090099
061000     COPY DLWS003.                                                06100099
061100                                                                  06110099
061200*----------------------------------------------------------------*06120099
061300*    XLKUP033 COMMAREA - WRITE DATA TO EAI EXPORT TABLES         *06130099
061400*----------------------------------------------------------------*06140099
061500     COPY XLWS072.                                                06150099
061600     COPY SUWS050.                                                06160099
061700                                                                  06170099
061800******************************************************************06180099
061900*  RANDOM NUMBER AREA.                                            06190099
062000******************************************************************06200099
062100     COPY DPWS902.                                                06210099
062200                                                                  06220099
062300******************************************************************06230099
062400*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               06240099
062500******************************************************************06250099
062600     COPY DPWS013.                                                06260099
062700                                                                  06270099
062800******************************************************************06280099
062900*    COPY BOOK FOR THE CICSAUTH SUBROUTINE                        06290099
063000******************************************************************06300099
063100     COPY DPWS008.                                                06310099
063200                                                                  06320099
063300******************************************************************06330099
063400*  SENDING/RECEIVING AREA FOR THE NUMERIC EDIT ROUTINE (DPKUT100) 06340099
063500******************************************************************06350099
063600     COPY DPWS010I.                                               06360099
063700                                                                  06370099
063800******************************************************************06380099
063900* HELP SCREEN COMMAREA                                            06390099
064000     COPY PCWS192.                                                06400099
064100                                                                  06410099
064200******************************************************************06420099
064300* HELP SCREEN WORK AREA                                           06430099
064400******************************************************************06440099
064500     COPY PCWS188.                                                06450099
064600                                                                  06460099
064700******************************************************************06470099
064800*  GENERATED DSECT FOR THE PCKM859 MAPSET                         06480099
064900******************************************************************06490099
065000     COPY PCKM859.                                                06500099
065100                                                                  06510099
065200******************************************************************06520099
065300*  KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST   06530099
065400******************************************************************06540099
065500     COPY DPWS015.                                                06550099
065600                                                                  06560099
065700******************************************************************06570099
065800*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      06580099
065900******************************************************************06590099
066000     COPY DFHAID.                                                 06600099
066100                                                                  06610099
066200******************************************************************06620099
066300*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE RECEIVING          06630099
066400*  TABLE                                                          06640099
066500******************************************************************06650099
066600     EXEC SQL                                                     06660099
066700         INCLUDE TRECEIV                                          06670099
066800     END-EXEC.                                                    06680099
066900                                                                  06690099
067000******************************************************************06700099
067100*    PO PREPACK TABLE                                             06710099
067200******************************************************************06720099
067300     EXEC SQL                                                     06730099
067400         INCLUDE TPOPRPK                                          06740099
067500     END-EXEC.                                                    06750099
067600                                                                  06760099
067700******************************************************************06770099
067800*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT      06780099
067900*  PACK TABLE (SUT_OTBND_PK)                                      06790099
068000******************************************************************06800099
068100     EXEC SQL                                                     06810099
068200         INCLUDE SUT00041                                         06820099
068300     END-EXEC.                                                    06830099
068400                                                                  06840099
068500******************************************************************06850099
068600*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE UPC TABLE (XLT_UPC)06860099
068700******************************************************************06870099
068800     EXEC SQL                                                     06880099
068900         INCLUDE XLT00006                                         06890099
069000     END-EXEC.                                                    06900099
069100                                                                  06910099
069200******************************************************************06920099
069300*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT      06930099
069400*  AUDIT TABLE (TSUNAUD)                                          06940099
069500******************************************************************06950099
069600     EXEC SQL                                                     06960099
069700         INCLUDE TSUNAUD                                          06970099
069800     END-EXEC.                                                    06980099
069900                                                                  06990099
070000******************************************************************07000099
070100*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT      07010099
070200*  CARTON AUDIT TABLE (TSUATRN)                                   07020099
070300******************************************************************07030099
070400     EXEC SQL                                                     07040099
070500         INCLUDE TSUATRN                                          07050099
070600     END-EXEC.                                                    07060099
070700                                                                  07070099
070800******************************************************************07080099
070900*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE CONTAINER DIVERT   07090099
071000*  TABLE                                                          07100099
071100******************************************************************07110099
071200     EXEC SQL                                                     07120099
071300         INCLUDE TSUCRDV                                          07130099
071400     END-EXEC.                                                    07140099
071500                                                                  07150099
071600******************************************************************07160099
071700*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIP UNIT LOCATION 07170099
071800*  TABLE                                                          07180099
071900******************************************************************07190099
072000     EXEC SQL                                                     07200099
072100         INCLUDE SUT00027                                         07210099
072200     END-EXEC.                                                    07220099
072300                                                                  07230099
072400******************************************************************07240099
072500*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT      07250099
072600*  UPC TABLE (SUT_OTBND_UPC)                                      07260099
072700******************************************************************07270099
072800     EXEC SQL                                                     07280099
072900         INCLUDE SUT00028                                         07290099
073000     END-EXEC.                                                    07300099
073100                                                                  07310099
073200******************************************************************07320099
073300*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PARM TABLE TO      07330099
073400*  CHECK IF DC IS MANIFESTING                                     07340099
073500******************************************************************07350099
073600     EXEC SQL                                                     07360099
073700         INCLUDE TKRPRPM                                          07370099
073800     END-EXEC.                                                    07380099
073900/                                                                 07390099
074000******************************************************************07400099
074100*  DB2 DECLARATION - CARTON DIRECTIVE TRACKING TABLE              07410099
074200*      TABLE (SUT_CART_DIRV_TRKG)                                 07420099
074300******************************************************************07430099
074400     EXEC SQL                                                     07440099
074500         INCLUDE SUT00102                                         07450099
074600     END-EXEC.                                                    07460099
074700/                                                                 07470099
074800******************************************************************07480099
074900*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT      07490099
075000*  CARTON TABLE (SUT_OTBND_CART)                                  07500099
075100******************************************************************07510099
075200     EXEC SQL                                                     07520099
075300         INCLUDE SUT00024                                         07530099
075400     END-EXEC.                                                    07540099
075500                                                                  07550099
075600******************************************************************07560099
075700     EXEC SQL                                                     07570099
075800         INCLUDE TSULBXF                                          07580099
075900     END-EXEC.                                                    07590099
076000                                                                  07600099
076100******************************************************************07610099
076200     EXEC SQL                                                     07620099
076300         INCLUDE TSHUNLO                                          07630099
076400     END-EXEC.                                                    07640099
076500                                                                  07650099
076600******************************************************************07660099
076700**UCC128 PO AUDIT REQUEST TABLE (SUT_PO_AUD_REQ) *****************07670099
076800******************************************************************07680099
076900     EXEC SQL                                                     07690099
077000         INCLUDE SUT00015                                         07700099
077100     END-EXEC.                                                    07710099
077200                                                                  07720099
077300******************************************************************07730099
077400* XLT_LOC TABLE                                                   07740099
077500******************************************************************07750099
077600     EXEC SQL                                                     07760099
077700         INCLUDE XLT00010                                         07770099
077800     END-EXEC.                                                    07780099
077900                                                                  07790099
078000******************************************************************07800099
078100**LABEL PRINT DATA TABLE                                          07810099
078200******************************************************************07820099
078300     EXEC SQL                                                     07830099
078400         INCLUDE TLBPTDA                                          07840099
078500     END-EXEC.                                                    07850099
078600                                                                  07860099
078700******************************************************************07870099
078800** VIRTUAL LABEL  TABLE                                           07880099
078900******************************************************************07890099
079000     EXEC SQL                                                     07900099
079100         INCLUDE TLBVRDA                                          07910099
079200     END-EXEC.                                                    07920099
079300******************************************************************07930099
079400** AUDIT ADJUSTMENT TABLE                                         07940099
079500******************************************************************07950099
079600     EXEC SQL                                                     07960099
079700         INCLUDE TSUQADJ                                          07970099
079800     END-EXEC.                                                    07980099
079900                                                                  07990099
080000******************************************************************08000099
080100** FINANCIAL ADJUSTMENT TABLE (SUT_FINCL_ADJ)                     08010099
080200******************************************************************08020099
080300     EXEC SQL                                                     08030099
080400         INCLUDE SUT00030                                         08040099
080500     END-EXEC.                                                    08050099
080600                                                                  08060099
080700******************************************************************08070099
080800** OUTBOUND VENDOR TABLE (SUT_OTBND_VND)                          08080099
080900******************************************************************08090099
081000     EXEC SQL                                                     08100099
081100         INCLUDE SUT00026                                         08110099
081200     END-EXEC.                                                    08120099
081300                                                                  08130099
081400******************************************************************08140099
081500**  RC - RECEIPT ITEM TABLE                                       08150099
081600******************************************************************08160099
081700     EXEC SQL                                                     08170099
081800         INCLUDE TRECITM                                          08180099
081900     END-EXEC.                                                    08190099
082000                                                                  08200099
082100******************************************************************08210099
082200**  TR - TROUBLE TABLE                                            08220099
082300******************************************************************08230099
082400     EXEC SQL                                                     08240099
082500         INCLUDE TTRBNTF                                          08250099
082600     END-EXEC.                                                    08260099
082700                                                                  08270099
082800******************************************************************08280099
082900     EXEC SQL                                                     08290099
083000         INCLUDE TSHIPMT                                          08300099
083100     END-EXEC.                                                    08310099
083200                                                                  08320099
083300******************************************************************08330099
083400     EXEC SQL                                                     08340099
083500         INCLUDE TSHPTPO                                          08350099
083600     END-EXEC.                                                    08360099
083700                                                                  08370099
083800******************************************************************08380099
083900     EXEC SQL                                                     08390099
084000         INCLUDE TDISTHD                                          08400099
084100     END-EXEC.                                                    08410099
084200                                                                  08420099
084300******************************************************************08430099
084400     EXEC SQL                                                     08440099
084500         INCLUDE TSHUUPC                                          08450099
084600     END-EXEC.                                                    08460099
084700                                                                  08470099
084800******************************************************************08480099
084900     EXEC SQL                                                     08490099
085000         INCLUDE TPKSLIP                                          08500099
085100     END-EXEC.                                                    08510099
085200                                                                  08520099
085300******************************************************************08530099
085400     EXEC SQL                                                     08540099
085500         INCLUDE TINPKSU                                          08550099
085600     END-EXEC.                                                    08560099
085700                                                                  08570099
085800******************************************************************08580099
085900     EXEC SQL                                                     08590099
086000         INCLUDE TP2LMOD                                          08600099
086100     END-EXEC.                                                    08610099
086200                                                                  08620099
086300******************************************************************08630099
086400** OUTBOUND PACKED TABLE                                          08640099
086500******************************************************************08650099
086600     EXEC SQL                                                     08660099
086700         INCLUDE SUT00025                                         08670099
086800     END-EXEC.                                                    08680099
086900                                                                  08690099
087000*----------------------------------------------------------------*08700099
087100* SQL AND COBOL DECLARATIONS FOR PROCESS MESSAGE CONTROL          08710099
087200* TABLE (SUT_PRC_MSG_CNTL)                                        08720099
087300*----------------------------------------------------------------*08730099
087400     EXEC SQL                                                     08740099
087500         INCLUDE SUT00094                                         08750099
087600     END-EXEC.                                                    08760099
087700******************************************************************08770099
087800     EXEC SQL                                                     08780099
087900         DECLARE FINCL-ADJST CURSOR FOR                           08790099
088000            SELECT PO_NBR                                         08800099
088100                 , RCVR_LNE_NBR                                   08810099
088200                 , RCVR_SEQ_NBR                                   08820099
088300                 , DEST_LOC_NBR                                   08830099
088400                 , A.UPC_NBR                                      08840099
088500                 , A.OPER_UNT_ID                                  08850099
088600                 , B.AUTO_APL_IND                                 08860099
088700                 , B.RSLV_TMST                                    08870099
088800                 , A.FINCL_ADJ_ID                                 08880099
088900                 , SUM(B.FINCL_BEF_QTY) - SUM(B.FINCL_AFT_QTY)    08890099
089000              FROM TSUQADJ A                                      08900099
089100                ,  SUT_FINCL_ADJ B                                08910099
089200             WHERE A.SHIPT_UNT_ID    =  B.SHIPT_UNT_ID            08920099
089300               AND A.SHIPT_UNT_ID    =  :SUT00024-SHIPT-UNT-ID    08930099
089400               AND A.FINCL_ADJ_ID    =  B.FINCL_ADJ_ID            08940099
089500               AND A.ADJ_TMST       >=  :DK-CARTON-TMST           08950099
089600             GROUP BY PO_NBR                                      08960099
089700                    , RCVR_SEQ_NBR                                08970099
089800                    , RCVR_LNE_NBR                                08980099
089900                    , DEST_LOC_NBR                                08990099
090000                    , A.OPER_UNT_ID                               09000099
090100                    , A.UPC_NBR                                   09010099
090200                    , B.AUTO_APL_IND                              09020099
090300                    , B.RSLV_TMST                                 09030099
090400                    , A.FINCL_ADJ_ID                              09040099
090500                    , A.ADJ_TMST                                  09050099
090600             ORDER BY B.AUTO_APL_IND DESC, ADJ_TMST DESC          09060099
090700     END-EXEC.                                                    09070099
090800                                                                  09080099
090900******************************************************************09090099
091000     EXEC SQL                                                     09100099
091100         DECLARE TSUQADJ-DMG CURSOR FOR                           09110099
091200            SELECT                                                09120099
091300                   ADJ_AFT_QTY - ADJ_BEF_QTY                      09130099
091400              FROM TSUQADJ A                                      09140099
091500                  ,SUT_FINCL_ADJ B                                09150099
091600             WHERE A.SHIPT_UNT_ID    =  :DK-SHIPT-UNT-ID          09160099
091700               AND A.PRC_RSN_CDE     =  'PCKR863D'                09170099
091800               AND A.UPC_NBR         =  :SUQADJ-UPC-NBR           09180099
091900               AND A.ADJ_TMST       >=  :DK-CARTON-TMST           09190099
092000               AND A.FINCL_ADJ_ID    =  B.FINCL_ADJ_ID            09200099
092100               AND B.AUTO_APL_IND    =  'Y'                       09210099
092200             ORDER BY  A.UPC_NBR, A.ADJ_TMST DESC                 09220099
092300     END-EXEC.                                                    09230099
092400                                                                  09240099
092500     EXEC SQL                                                     09250099
092600          DECLARE PACK-CURSOR CURSOR FOR                          09260099
092700          SELECT                                                  09270099
092800                 A.ORD_LNE_NBR                                    09280099
092900              ,  A.ITM_NBR                                        09290099
093000              ,  A.STATUS_CDE                                     09300099
093100              ,  A.PREPK_RATO_QTY                                 09310099
093200              ,  A.PREPK_DRV_LNE_CDE                              09320099
093300              ,  A.PREPK_ID                                       09330099
093400          FROM                                                    09340099
093500                 TRECITM  A                                       09350099
093600          WHERE                                                   09360099
093700                A.ORD_NBR          =  :DK-PO-NBR                  09370099
093800           AND  A.REC_SEQ_NBR      =  :DK-REC-SEQ-NBR             09380099
093900           AND  A.VER_STATUS_CDE   =  'A'                         09390099
094000           AND  A.PREPK_ID         =  :DK-PACK-ID                 09400099
094100     END-EXEC.                                                    09410099
094200                                                                  09420099
094300******************************************************************09430099
094400*  COMMUNICATIONS AREA FOR DB2                                    09440099
094500******************************************************************09450099
094600     EXEC SQL                                                     09460099
094700         INCLUDE SQLCA                                            09470099
094800     END-EXEC.                                                    09480099
094900                                                                  09490099
095000******************************************************************09500099
095100 LINKAGE SECTION.                                                 09510099
095200******************************************************************09520099
095300 01  DFHCOMMAREA.                                                 09530099
095400     05  FILLER                         OCCURS  1 TO 4072 TIMES   09540099
095500                                      DEPENDING ON EIBCALEN.      09550099
095600         10  FILLER                   PIC X.                      09560099
095700                                                                  09570099
095800******************************************************************09580099
095900 PROCEDURE DIVISION.                                              09590099
096000******************************************************************09600099
096100 0000-PROGRAM-MAINLINE.                                           09610099
096200     MOVE DFHCOMMAREA      TO CA-COMMAREA.                        09620099
096300     MOVE LOW-VALUES       TO PC859AI.                            09630099
096400     MOVE ZEROES           TO PC033-CARTON                        09640099
096500                              PC033-STR-NBR                       09650099
096600                              PC033-PO-NBR                        09660099
096700                              PC033-RCVR-SEQ-NBR                  09670099
096800                              PC033-PO-LINE-NBR                   09680099
096900                              PC033-ADJ-AFT-QTY                   09690099
097000                              PC033-OTBD-TRIP-ID                  09700099
097100                              PC033-RCVR-SEQ-NBR-CTN              09710099
097200                              PC033-RCVR-SEQ-NBR-MAP.             09720099
097300     MOVE SPACES           TO PC033-MAP-CARTON                    09730099
097400                              PC033-BRCDE-NBR.                    09740099
097500                                                                  09750099
097600                                                                  09760099
097700     EVALUATE TRUE                                                09770099
097800         WHEN EIBCALEN = ZERO                                     09780099
097900         WHEN EIBAID = DFHCLEAR                                   09790099
098000         WHEN PC033-INITIALIZE-SCREEN                             09800099
098100              SET PC033-PROCESS-SCREEN TO TRUE                    09810099
098200              IF PC033-RECLAIM                                    09820099
098300                  MOVE '** RECLAIM **' TO ATITLEO                 09830099
098400              ELSE                                                09840099
098500                  MOVE '** UNUSED  **' TO ATITLEO                 09850099
098600              END-IF                                              09860099
098700              PERFORM 8000-SEND-MAP                               09870099
098800              PERFORM 8200-RETURN-TRANID                          09880099
098900                                                                  09890099
099000         WHEN EIBTRNID = 'Z278'                                   09900099
099100*            RETURNING FROM F1 HELP INFO SCREEN                   09910099
099200             MOVE DFHCOMMAREA         TO PC192-COMMAREA           09920099
099300             MOVE PC192-HOST-SAVE-AREA                            09930099
099400                                      TO CA-COMMAREA              09940099
099500             SET PC033-PROCESS-SCREEN TO TRUE                     09950099
099600             MOVE PC192-HOST-SAVE-MAP TO PC859AO                  09960099
099700             MOVE -1                  TO ACARTNL                  09970099
099800             MOVE PV-CARTON-NBR       TO ACARTNO                  09980099
099900             PERFORM 8000-SEND-MAP                                09990099
100000             PERFORM 8200-RETURN-TRANID                           10000099
100100                                                                  10010099
100200         WHEN EIBAID = DFHENTER                                   10020099
100300             SET PS-ERROR-NO                                      10030099
100400                 PS-NO-VENDOR-CARTON-FND                          10040099
100500                 PS-NO-P2L-BOUND-BRCDE-FND                        10050099
100600                 PS-NO-FAST-XFER-CRTN-FND                         10060099
100700                 PS-PBS-DC-RTV-NO          TO TRUE                10070099
100800             IF PC033-RECLAIM                                     10080099
100900                 MOVE '** RECLAIM **' TO ATITLEO                  10090099
101000                 PERFORM 0500-PROCESS-SCREEN-FIELDS               10100099
101100                 PERFORM 1500-INTERFACE-TO-LABOR                  10110099
101200                 IF PS-NO-VENDOR-CARTON-FND AND                   10120099
101300                    PS-NO-FAST-XFER-CRTN-FND                      10130099
101400                     PERFORM 2000-PROCESS-CARTON                  10140099
101500                     IF PS-NO-P2L-BOUND-BRCDE-FND                 10150099
101600                        PERFORM 4000-PROCESS-MFST-CARTONS         10160099
101700                        INITIALIZE SU036-COMM-AREA                10170099
101800                        SET SU036-LOG-ONLY         TO TRUE        10180099
101900                        SET SU036-DECREMENT-UNITS  TO TRUE        10190099
102000                        MOVE SUT00024-SHIPT-UNT-ID TO PC033-CARTON10200099
102100                        IF PS-ADJSTMNTS-EXIST                     10210099
102200                          MOVE SU035-PO          TO PC033-PO-NBR  10220099
102300                          MOVE SU035-REC-SEQ-NBR TO               10230099
102400                                                PC033-RCVR-SEQ-NBR10240099
102500                        END-IF                                    10250099
102600                        PERFORM 2410-LINK-SUKUT706                10260099
102700                        IF PC046-MULTIPLE                         10270099
102800                             MOVE 'MULTIPLE'     TO APORCVRO      10280099
102900                        ELSE                                      10290099
103000                             MOVE PC046-PO-NBR   TO PV-PO-OUT     10300099
103100                             MOVE PC046-RCVR-NBR TO PV-RCVR-OUT   10310099
103200                             MOVE PV-PO-RCVR     TO APORCVRO      10320099
103300                        END-IF                                    10330099
103400                     END-IF                                       10340099
103500                     IF PS-CREATED-BY-SMO                         10350099
103600                         MOVE PC034-DIV-INACT-SMO-CTN-MSG TO      10360099
103700                                                          AMSGLN1O10370099
103800                         MOVE SPACES TO        AMSGLN2O           10380099
103900                     ELSE                                         10390099
104000                        MOVE PC034-LABEL-RECLAIMED-MSG TO AMSGLN1O10400099
104100                         MOVE SPACES                   TO AMSGLN2O10410099
104200                     END-IF                                       10420099
104300                   ELSE                                           10430099
104400                     IF PS-FAST-XFER-CRTN-FND                     10440099
104500                         MOVE PC-FAST-XFER-MSG      TO AMSGLN1O   10450099
104600                         MOVE SPACES                TO AMSGLN2O   10460099
104700                     ELSE                                         10470099
104800                        MOVE PC034-LABEL-RECLAIMED-MSG TO AMSGLN1O10480099
104900                        MOVE SPACES                    TO AMSGLN2O10490099
105000                     END-IF                                       10500099
105100                 END-IF                                           10510099
105200                 PERFORM 2010-SEL-AUTO-DIRECTIVE                  10520099
105300                 IF ( ALL-CARTONS-DIRECTIVES-MODE ) OR            10530099
105400                    ( EXCEPTION-DIRECTIVES-MODE )                 10540099
105500                     PERFORM 2020-SEL-CARTON-DIRECTIVE            10550099
105600                     IF ( PS-DIRECTIVE-FOUND )                    10560099
105700                         PERFORM 2030-BUILD-REQUEST               10570099
105800                         PERFORM 2050-CALL-DIRECTIVE-REQUEST      10580099
105900                     END-IF                                       10590099
106000                 END-IF                                           10600099
106100            ELSE                                                  10610099
106200                IF PC033-UNUSED                                   10620099
106300                    MOVE '** UNUSED  **' TO ATITLEO               10630099
106400                    IF PC033-PGM-MSG-NBR = 20 OR 22 OR 23 OR 24   10640099
106500                                  OR 25 OR 28 OR 29 OR 31 OR 32   10650099
106600                        MOVE LOW-VALUES      TO PC859AO           10660099
106700                        MOVE DP015-UNP-ALP-NOR-MDT TO ACARTNA     10670099
106800                        MOVE PV-CARTON-NBR         TO ACARTNO     10680099
106900                        MOVE 'UNABLE TO INACTIVT'  TO AMSGLN1O    10690099
107000                        MOVE SPACES                TO AMSGLN2O    10700099
107100                        MOVE -1                    TO ACARTNL     10710099
107200                        MOVE ZEROES          TO PC033-PGM-MSG-NBR 10720099
107300                        SET PS-INVALID-INPUT TO TRUE              10730099
107400                        SET PC033-PROCESS-SCREEN TO TRUE          10740099
107500                        PERFORM 8000-SEND-MAP                     10750099
107600                        PERFORM 8200-RETURN-TRANID                10760099
107700                    ELSE                                          10770099
107800                        IF  PC033-LABEL-NOT-FOUND                 10780099
107900                            SET PC033-LABEL-FOUND       TO TRUE   10790099
108000                            MOVE LOW-VALUES             TO PC859AO10800099
108100                            MOVE DP015-UNP-ALP-NOR-MDT  TO ACARTNA10810099
108200                            MOVE PV-CARTON-NBR          TO ACARTNO10820099
108300                            MOVE '  PLEASE REENTER  '  TO AMSGLN1O10830099
108400                            MOVE SPACES                TO AMSGLN2O10840099
108500                            MOVE -1                    TO ACARTNL 10850099
108600                            PERFORM 8000-SEND-MAP                 10860099
108700                            PERFORM 8200-RETURN-TRANID            10870099
108800                        ELSE                                      10880099
108900                             PERFORM 0750-PROCESS-SCREEN-FIELDS   10890099
109000                        END-IF                                    10900099
109100                    END-IF                                        10910099
109200                END-IF                                            10920099
109300            END-IF                                                10930099
109400                                                                  10940099
109500         WHEN EIBAID = DFHPF1                                     10950099
109600             PERFORM 1000-RECEIVE-MAP                             10960099
109700             MOVE PC859AO             TO PC192-HOST-SAVE-MAP      10970099
109800             PERFORM 1200-HELP-SCREEN                             10980099
109900                                                                  10990099
110000         WHEN EIBAID = DFHPF3                                     11000099
110100              MOVE PC-PREV-MENU-PROGRAM  TO PV-TRANSFER-PROGRAM   11010099
110200              PERFORM 2100-XCTL-TO-SELECTED-PROGRAM               11020099
110300                                                                  11030099
110400         WHEN EIBAID = DFHPF2                                     11040099
110500*           LABEL IS ALREADY INACTIVE.  LEAVE AS INACTIVE         11050099
110600             SET PC033-INITIALIZE-SCREEN TO TRUE                  11060099
110700             MOVE -1                     TO ACARTNL               11070099
110800             MOVE PV-CARTON-NBR          TO ACARTNO               11080099
110900             PERFORM 8100-SEND-DATA-ONLY                          11090099
111000             PERFORM 8200-RETURN-TRANID                           11100099
111100                                                                  11110099
111200         WHEN OTHER                                               11120099
111300              MOVE PC-UNRECOGNIZED-PF-KEY-MSG TO AMSGLN1O         11130099
111400              MOVE SPACES                     TO AMSGLN2O         11140099
111500              PERFORM 8100-SEND-DATA-ONLY                         11150099
111600              PERFORM 8200-RETURN-TRANID                          11160099
111700     END-EVALUATE.                                                11170099
111800                                                                  11180099
111900     MOVE PV-CARTON-NBR  TO ACARTNO.                              11190099
112000     MOVE -1              TO ACARTNL                              11200099
112100     PERFORM 8100-SEND-DATA-ONLY                                  11210099
112200     PERFORM 8200-RETURN-TRANID                                   11220099
112300     GOBACK.                                                      11230099
112400                                                                  11240099
112500*----------------------------------------------------------       11250099
112600 0500-PROCESS-SCREEN-FIELDS.                                      11260099
112700** THIS STARTS THE RECLAIM PROCESS **                             11270099
112800*----------------------------------------------------------       11280099
112900      PERFORM 1000-RECEIVE-MAP.                                   11290099
113000      PERFORM 1100-EDIT-SELECTION.                                11300099
113100      PERFORM 1145-CHECK-DC-RECLAIM.                              11310099
113200      PERFORM 1150-PROCESS-TABLE-EDITS.                           11320099
113300      IF PS-VENDOR-CARTON-FND OR PS-VENDOR-CARTON-AUDIT OR        11330099
113400         PS-P2L-BOUND-BRCDE-FND                                   11340099
113500         PERFORM 2355-POPULATE-MAP-INBOUND                        11350099
113600      ELSE                                                        11360099
113700         MOVE PV-CTN-N         TO SUT00024-SHIPT-UNT-ID           11370099
113800         PERFORM 2310-SELECT-OTBND-CART                           11380099
113900         PERFORM 2350-POPULATE-MAP                                11390099
114000      END-IF.                                                     11400099
114100                                                                  11410099
114200*----------------------------------------------------------       11420099
114300 0750-PROCESS-SCREEN-FIELDS.                                      11430099
114400** THIS STARTS THE UNUSED PROCESS **                              11440099
114500*----------------------------------------------------------       11450099
114600     PERFORM 1000-RECEIVE-MAP.                                    11460099
114700     PERFORM 1100-EDIT-SELECTION.                                 11470099
114800     PERFORM 1150-PROCESS-TABLE-EDITS.                            11480099
114900                                                                  11490099
115000     IF PS-P2L-BOUND-BRCDE-FND                                    11500099
115100         MOVE SULBXF-SHIPT-UNT-ID   TO PV-CTN-N                   11510099
115200                                       PV-VENDOR-SSCC             11520099
115300         MOVE  SULBXF-BRCDE-NBR     TO PV-BARCODE                 11530099
115400         PERFORM 2355-POPULATE-MAP-INBOUND                        11540099
115500         PERFORM 5100-UPDATE-TLBVRDA                              11550099
115600         PERFORM 5300-DELETE-TSULBXF                              11560099
115700         PERFORM 5325-DELETE-TSHUNLO                              11570099
115800         MOVE 'LABEL INACTIVATED'    TO AMSGLN1O                  11580099
115900         MOVE SPACES                 TO AMSGLN2O                  11590099
116000     ELSE                                                         11600099
116100         IF PS-VENDOR-CARTON-FND                                  11610099
116200           MOVE 'CANNOT UNUSE SSCC' TO AMSGLN1O                   11620099
116300           MOVE SPACES              TO AMSGLN2O                   11630099
116400           MOVE PV-CARTON-NBR       TO ACARTNO                    11640099
116500           PERFORM 8100-SEND-DATA-ONLY                            11650099
116600           PERFORM 8200-RETURN-TRANID                             11660099
116700         ELSE                                                     11670099
116800           IF PS-VALID-INPUT                                      11680099
116900             PERFORM 2300-CHECK-TABLES                            11690099
117000             EVALUATE TRUE                                        11700099
117100                 WHEN PS-ERROR                                    11710099
117200                     IF SUT00024-ACTV-IND = 'N'                   11720099
117300                        MOVE PV-CARTON-NBR      TO ACARTNO        11730099
117400                        PERFORM 8100-SEND-DATA-ONLY               11740099
117500                        PERFORM 8200-RETURN-TRANID                11750099
117600                     ELSE                                         11760099
117700                        PERFORM 8210-XCTL-ERROR-SCREEN            11770099
117800                     END-IF                                       11780099
117900                 WHEN OTHER                                       11790099
118000                   IF PC033-OPER-UNT-ID = SUT00024-ORGN-LOC-NBR   11800099
118100                      PERFORM 2500-DETERMINE-LAST-ACTIVITY        11810099
118200                      IF PS-ERROR                                 11820099
118300                          CONTINUE                                11830099
118400                      ELSE                                        11840099
118500                          IF PS-NO-FAST-XFER-CRTN-FND             11850099
118600                            PERFORM 6100-CHECK-FOR-ADJUSTMENTS    11860099
118700                            IF PS-ADJSTMNTS-EXIST                 11870099
118800                               INITIALIZE SU035-COMM-AREA         11880099
118900                               PERFORM 2600-CALL-AUTOVE-MODULE    11890099
119000                               INITIALIZE SU035-COMM-AREA         11900099
119100                               IF RC040-AUTO-VE-YES               11910099
119200                                   IF RECITM-STATUS-CDE = 'VE'    11920099
119300                                     SET SU035-LOG-ONLY-NO TO TRUE11930099
119400                                   ELSE                           11940099
119500                                     SET SU035-LOG-ONLY TO TRUE   11950099
119600                                   END-IF                         11960099
119700                               ELSE                               11970099
119800                                   SET SU035-LOG-ONLY-NO   TO TRUE11980099
119900                               END-IF                             11990099
120000                               PERFORM 6200-PROCESS-ADJ-CURSOR    12000099
120100                               IF (RECEIV-PKGNG-CDE = 'I' OR 'M'  12010099
120200                                  AND PS-APPLY-CRT-UPDATES) OR    12020099
120300                                 ((RECEIV-PKGNG-CDE NOT = 'I' AND 12030099
120400                                   RECEIV-PKGNG-CDE NOT = 'M') AND12040099
120500                                 (SU035-COMPLETE OR               12050099
120600                                  SU035-VERIFIED OR               12060099
120700                                  SU035-POST-VERIFIED OR          12070099
120800                                  SU035-UPDATE-TYPE-IND = ' '))   12080099
120900                                  PERFORM 7000-CHECK-TSUQADJ-4-DMG12090099
121000                                  IF PS-DMG-CRTN-EXISTS           12100099
121100                                      PERFORM 7100-CHECK-OTBND-UPC12110099
121200                                      IF SU035-COMPLETE OR        12120099
121300                                         SU035-VERIFIED OR        12130099
121400                                         SU035-POST-VERIFIED OR   12140099
121500                                       SU035-UPDATE-TYPE-IND = ' '12150099
121600                                        PERFORM 2400-PROCESS-LABEL12160099
121700                                        IF SU036-COMPLETE OR      12170099
121800                                           SU036-VERIFIED OR      12180099
121900                                           SU036-POST-VERIFIED OR 12190099
122000                                       SU036-UPDATE-TYPE-IND = ' '12200099
122100                                             PERFORM              12210099
122200                                         4000-PROCESS-MFST-CARTONS12220099
122300                                        ELSE                      12230099
122400                                          MOVE 'UNUSED LBL FAILED'12240099
122500                                                      TO AMSGLN1O 12250099
122600                                          MOVE SPACES TO AMSGLN2O 12260099
122700                                        END-IF                    12270099
122800                                      ELSE                        12280099
122900                                          MOVE 'UNUSED LBL FAILED'12290099
123000                                                      TO AMSGLN1O 12300099
123100                                          MOVE SPACES TO AMSGLN2O 12310099
123200                                      END-IF                      12320099
123300                                  ELSE                            12330099
123400                                      PERFORM 2400-PROCESS-LABEL  12340099
123500                                      IF SU036-COMPLETE OR        12350099
123600                                         SU036-VERIFIED OR        12360099
123700                                         SU036-POST-VERIFIED OR   12370099
123800                                       SU036-UPDATE-TYPE-IND = ' '12380099
123900                                           PERFORM                12390099
124000                                         4000-PROCESS-MFST-CARTONS12400099
124100                                      ELSE                        12410099
124200                                          MOVE 'UNUSED LBL FAILED'12420099
124300                                                      TO AMSGLN1O 12430099
124400                                          MOVE SPACES TO AMSGLN2O 12440099
124500                                      END-IF                      12450099
124600                                  END-IF                          12460099
124700                             ELSE                                 12470099
124800                              MOVE 'UNUSED LBL FAILED' TO AMSGLN1O12480099
124900                              MOVE SPACES              TO AMSGLN2O12490099
125000                             END-IF                               12500099
125100                         ELSE                                     12510099
125200                             PERFORM 2400-PROCESS-LABEL           12520099
125300                             IF SU036-COMPLETE OR                 12530099
125400                                SU036-VERIFIED OR                 12540099
125500                                SU036-POST-VERIFIED OR            12550099
125600                                SU036-UPDATE-TYPE-IND = ' '       12560099
125700                                 PERFORM 4000-PROCESS-MFST-CARTONS12570099
125800                             END-IF                               12580099
125900                         END-IF                                   12590099
126000                      ELSE                                        12600099
126100                          PERFORM 2900-INACTIVATE-LABEL           12610099
126200                          PERFORM 2920-UPDATE-OTBND-UPC           12620099
126300                             IF PS-FAST-XFER-CRTN-FND             12630099
126400                              MOVE 'LABEL INACTIVATED' TO AMSGLN1O12640099
126500                              MOVE SPACES              TO AMSGLN2O12650099
126600                             END-IF                               12660099
126700                      END-IF                                      12670099
126800                    END-IF                                        12680099
126900                   ELSE                                           12690099
127000                       MOVE DP015-UNP-ALP-BRT-MDT TO ACARTNA      12700099
127100                       MOVE -1                    TO ACARTNL      12710099
127200                       MOVE PC-DC-MUST-BE-DC     TO AMSGLN1O      12720099
127300                       MOVE SPACES               TO AMSGLN2O      12730099
127400                       MOVE PV-CARTON-NBR        TO ACARTNO       12740099
127500                       PERFORM 8100-SEND-DATA-ONLY                12750099
127600                       PERFORM 8200-RETURN-TRANID                 12760099
127700                   END-IF                                         12770099
127800                 END-EVALUATE                                     12780099
127900         ELSE                                                     12790099
128000             MOVE PV-CARTON-NBR      TO ACARTNO                   12800099
128100             PERFORM 8100-SEND-DATA-ONLY                          12810099
128200             PERFORM 8200-RETURN-TRANID                           12820099
128300         END-IF                                                   12830099
128400         END-IF                                                   12840099
128500     END-IF.                                                      12850099
128600                                                                  12860099
128700*----------------------------------------------------------       12870099
128800 1000-RECEIVE-MAP.                                                12880099
128900     EXEC CICS                                                    12890099
129000         RECEIVE MAP    ('PC859A')                                12900099
129100                 MAPSET ('PCKM859')                               12910099
129200                 RESP   (PV-CICS-RESPONSE)                        12920099
129300     END-EXEC.                                                    12930099
129400                                                                  12940099
129500     EVALUATE TRUE                                                12950099
129600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 12960099
129700              PERFORM 1010-RECEIVE-SCREEN-FIELDS                  12970099
129800         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                12980099
129900              CONTINUE                                            12990099
130000         WHEN OTHER                                               13000099
130100              MOVE '1000-RECEIVE-MAP' TO DP013-PARAGRAPH          13010099
130200              MOVE 'UNABLE TO RECEIVE MAP'                        13020099
130300                                     TO DP013-MESSAGE-TEXT (1)    13030099
130400              SET DP013-LOGIC-ABEND  TO TRUE                      13040099
130500              SET DP013-ROLLBACK     TO TRUE                      13050099
130600              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              13060099
130700     END-EVALUATE.                                                13070099
130800                                                                  13080099
130900*-------------------------------------------------------------    13090099
131000 1010-RECEIVE-SCREEN-FIELDS.                                      13100099
131100*-------------------------------------------------------------    13110099
131200     IF  ACARTNL > ZERO                                           13120099
131300         IF ACARTNI = LOW-VALUES                                  13130099
131400             MOVE SPACES TO PV-CTN                                13140099
131500                            PV-CARTON-NBR                         13150099
131600         ELSE                                                     13160099
131700             MOVE ACARTNI TO PV-CTN                               13170099
131800                             PV-CARTON-NBR                        13180099
131900         END-IF                                                   13190099
132000     ELSE                                                         13200099
132100         IF ACARTNA = DP015-ERASE-EOF                             13210099
132200             MOVE SPACES TO PV-CTN                                13220099
132300                            PV-CARTON-NBR                         13230099
132400         END-IF                                                   13240099
132500     END-IF.                                                      13250099
132600                                                                  13260099
132700*-------------------------------------------------------------    13270099
132800 1100-EDIT-SELECTION.                                             13280099
132900*-------------------------------------------------------------    13290099
133000     IF PV-CARTON-NBR = LOW-VALUES                                13300099
133100         MOVE  PC033-CARTON  TO PV-CARTON-NBR                     13310099
133200                                PV-CTN-N                          13320099
133300         MOVE  PV-CTN-N      TO PV-CTN                            13330099
133400     END-IF                                                       13340099
133410                                                                  13341099
133500     IF PV-CARTON-NBR = LOW-VALUES                                13350099
133600        SET PS-INVALID-INPUT                                      13360099
133700            PS-ERROR                TO TRUE                       13370099
133800        MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA                    13380099
133900        MOVE -1                     TO ACARTNL                    13390099
134000        MOVE PV-CARTON-NBR          TO ACARTNO                    13400099
134100        MOVE PC-MUST-BE-GT-0-MSG    TO AMSGLN1O                   13410099
134200        MOVE SPACES                 TO AMSGLN2O                   13420099
134300        PERFORM 8100-SEND-DATA-ONLY                               13430099
134400        PERFORM 8200-RETURN-TRANID                                13440099
134500     END-IF                                                       13450099
134600                                                                  13460099
134700     MOVE PV-CTN                     TO DP010I-UNEDITED-FIELD.    13470099
134800     MOVE 1                          TO DP010I-MAXIMUM-DIGITS.    13480099
134900     MOVE 0                          TO DP010I-MAXIMUM-DECIMALS.  13490099
135000     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     13500099
135100                                                                  13510099
135200     MOVE 0 TO PV-CHAR-COUNT.                                     13520099
135300     INSPECT PV-CTN TALLYING PV-CHAR-COUNT FOR CHARACTERS         13530099
135400                 BEFORE INITIAL SPACE.                            13540099
135500                                                                  13550099
135600     PERFORM 1130-INIT-ATTR.                                      13560099
135700                                                                  13570099
135800     EVALUATE TRUE                                                13580099
135900         WHEN PV-CTN = SPACES                                     13590099
136000             SET PS-INVALID-INPUT                                 13600099
136100                 PS-ERROR                TO TRUE                  13610099
136200             MOVE -1                     TO ACARTNL               13620099
136300             MOVE PV-CARTON-NBR          TO ACARTNO               13630099
136400             MOVE PC-PLS-ENT-FLD-MSG     TO AMSGLN1O              13640099
136500             MOVE SPACES                 TO AMSGLN2O              13650099
136510                                                                  13651099
136600         WHEN PV-CHAR-COUNT = PC-18                               13660099
136700                                                                  13670099
136705             MOVE  PV-CTN-FIRST-DIGIT TO PV-CTN-SNGL-DGIT-CHECK   13670599
136706             IF  PV-SNGL-DGIT-VALID                               13670699
136710                 CONTINUE                                         13671099
136720             ELSE                                                 13672099
136721                 SET PS-INVALID-INPUT                             13672199
136722                     PS-ERROR                TO TRUE              13672299
136723                 MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA           13672399
136724                 MOVE -1                     TO ACARTNL           13672499
136725                 MOVE PV-CARTON-NBR          TO ACARTNO           13672599
136726                 MOVE PC-MUST-BE-NUM-MSG     TO AMSGLN1O          13672699
136727                 MOVE SPACES                 TO AMSGLN2O          13672799
136730             END-IF                                               13673099
136740                                                                  13674099
137900         WHEN PV-CHAR-COUNT < PC-18                               13790099
138000             SET PS-INVALID-INPUT                                 13800099
138100                 PS-ERROR                TO TRUE                  13810099
138200             MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA               13820099
138300             MOVE -1                     TO ACARTNL               13830099
138400             MOVE PV-CARTON-NBR          TO ACARTNO               13840099
138500             MOVE PC-MORE-DIGITS-REQD    TO AMSGLN1O              13850099
138600             MOVE SPACES                 TO AMSGLN2O              13860099
138610                                                                  13861099
138700         WHEN PV-CHAR-COUNT = PC-22                               13870099
138800              PERFORM 1140-EDIT-22-DIGIT-BARCODE                  13880099
138810                                                                  13881099
138900         WHEN OTHER                                               13890099
139000             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              13900099
139100             MOVE PV-CTN-LAST-17      TO DP010I-UNEDITED-FIELD    13910099
139200             MOVE 17     TO DP010I-MAXIMUM-DIGITS                 13920099
139300             MOVE 0      TO DP010I-MAXIMUM-DECIMALS               13930099
139400                                                                  13940099
139510             CALL DP010I-NUMERIC-EDIT-ROUTINE                     13951099
139520                         USING DP010I-NUMERIC-EDIT-AREA           13952099
139600                                                                  13960099
139700             IF  DP010I-ERROR-DETECTED                            13970099
139800                 SET PS-INVALID-INPUT                             13980099
139900                     PS-ERROR                TO TRUE              13990099
140000                 MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA           14000099
140100                 MOVE -1                     TO ACARTNL           14010099
140200                 MOVE PV-CARTON-NBR          TO ACARTNO           14020099
140300                 MOVE PC-MUST-BE-NUM-MSG     TO AMSGLN1O          14030099
140400                 MOVE SPACES                 TO AMSGLN2O          14040099
140500             ELSE                                                 14050099
140600                 IF DP010I-NUMERIC-FIELD = ZEROES                 14060099
140700                     SET PS-INVALID-INPUT                         14070099
140800                         PS-ERROR                TO TRUE          14080099
140900                     MOVE -1                     TO ACARTNL       14090099
141000                     MOVE PV-CARTON-NBR          TO ACARTNO       14100099
141100                     MOVE PC-MUST-BE-GT-0-MSG    TO AMSGLN1O      14110099
141200                     MOVE SPACES                 TO AMSGLN2O      14120099
141300                 ELSE                                             14130099
141400                     MOVE DP015-UNP-ALP-NOR-OFF  TO ACARTNA       14140099
141500                     MOVE PV-CARTON-NBR          TO ACARTNO       14150099
141600                 END-IF                                           14160099
141700             END-IF                                               14170099
141800     END-EVALUATE.                                                14180099
141900                                                                  14190099
142000     IF  PS-INVALID-INPUT                                         14200099
142100         SET PS-ERROR        TO TRUE                              14210099
142200         MOVE PV-CARTON-NBR          TO ACARTNO                   14220099
142300         PERFORM 8100-SEND-DATA-ONLY                              14230099
142400         PERFORM 8200-RETURN-TRANID                               14240099
142500     ELSE                                                         14250099
142600         IF PV-CHAR-COUNT = PC-18                                 14260099
142700            MOVE PV-CTN              TO PV-CTN-N                  14270099
142800                                        PC033-CARTON              14280099
142900         ELSE                                                     14290099
143000            IF PV-CHAR-COUNT = PC-20                              14300099
143100               MOVE PV-CTN(3:18)        TO PV-CTN-N               14310099
143200                                           PC033-CARTON           14320099
143300            ELSE                                                  14330099
143400                IF PV-CHAR-COUNT = PC-22                          14340099
143500                    CONTINUE                                      14350099
143600                ELSE                                              14360099
143700                    SET PS-ERROR        TO TRUE                   14370099
143800                    MOVE -1                     TO ACARTNL        14380099
143900                    MOVE PV-CARTON-NBR          TO ACARTNO        14390099
144000                    MOVE PC-MUST-BE-KOHLS-SML   TO AMSGLN1O       14400099
144100                    MOVE SPACES                 TO AMSGLN2O       14410099
144200                    PERFORM 8100-SEND-DATA-ONLY                   14420099
144300                    PERFORM 8200-RETURN-TRANID                    14430099
144400                END-IF                                            14440099
144500            END-IF                                                14450099
144600         END-IF                                                   14460099
144700     END-IF.                                                      14470099
144800                                                                  14480099
144900*-------------------------------------------------------------    14490099
145000 1130-INIT-ATTR.                                                  14500099
145100*-------------------------------------------------------------    14510099
145200     MOVE DP015-UNP-ALP-NOR-MDT      TO ACARTNA.                  14520099
145300                                                                  14530099
145400     IF PV-CHAR-COUNT = 22                                        14540099
145500         MOVE PV-CTN (3:20)  TO ACARTNO                           14550099
145600     ELSE                                                         14560099
145700         MOVE PV-CTN         TO ACARTNO                           14570099
145800     END-IF.                                                      14580099
145900     MOVE SPACES         TO AMSGLN1O.                             14590099
146000     MOVE SPACES         TO AMSGLN2O.                             14600099
146100                                                                  14610099
146200*-------------------------------------------------------------    14620099
146300 1140-EDIT-22-DIGIT-BARCODE.                                      14630099
146400*-------------------------------------------------------------    14640099
146500     MOVE PV-CTN              TO PV-INPUT-FIELD.                  14650099
146600     MOVE SPACES              TO PV-OUTPUT-FIELD.                 14660099
146700     MOVE +22                 TO PV-SUB2.                         14670099
146800                                                                  14680099
146900     PERFORM                                                      14690099
147000       VARYING PV-SUB1 FROM 22 BY -1                              14700099
147100         UNTIL PV-SUB1 = ZERO OR PS-INVALID-INPUT                 14710099
147200                                                                  14720099
147300         IF PV-IN-BYTE (PV-SUB1) > SPACES                         14730099
147400             IF PV-IN-BYTE (PV-SUB1) NUMERIC                      14740099
147500                 MOVE PV-IN-BYTE (PV-SUB1)                        14750099
147600                   TO PV-OUT-BYTE (PV-SUB2)                       14760099
147700                 SUBTRACT 1 FROM PV-SUB2                          14770099
147800             ELSE                                                 14780099
147900                 SET PS-INVALID-INPUT        TO TRUE              14790099
148000                 MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA           14800099
148100                 MOVE -1                     TO ACARTNL           14810099
148200                 MOVE PC-MUST-BE-NUM-MSG     TO AMSGLN1O          14820099
148300                 MOVE SPACES                 TO AMSGLN2O          14830099
148400             END-IF                                               14840099
148500         END-IF                                                   14850099
148600     END-PERFORM.                                                 14860099
148700                                                                  14870099
148800     IF PS-VALID-INPUT                                            14880099
148900         INSPECT PV-OUTPUT-FIELD                                  14890099
149000           REPLACING ALL SPACES BY ZEROES                         14900099
149100         MOVE PV-OUTPUT-FIELD TO DK-BRCDE-NBR                     14910099
149200     END-IF.                                                      14920099
149300                                                                  14930099
149400*-------------------------------------------------------------    14940099
149500 1145-CHECK-DC-RECLAIM.                                           14950099
149600*-------------------------------------------------------------    14960099
149700     MOVE PC033-OPER-UNT-ID   TO DK-OPER-UNT-ID.                  14970099
149800                                                                  14980099
149900     EXEC SQL                                                     14990099
150000          SELECT FUNC_END_TMST                                    15000099
150100          INTO  :KRPRPM-FUNC-END-TMST                             15010099
150200          FROM   TKRPRPM                                          15020099
150300          WHERE  SYS_PRC_FUNC_CDE  = 'LBLRCL'                     15030099
150400            AND  LOC_ID            = :DK-OPER-UNT-ID              15040099
150500            AND  INTFC_SYS_CDE     = 'KHL'                        15050099
150600            AND  FUNC_PRC_STAT_CDE = 'AC'                         15060099
150700            AND  FUNC_TXT          = 'Y'                          15070099
150800     END-EXEC.                                                    15080099
150900                                                                  15090099
151000     EVALUATE TRUE                                                15100099
151100         WHEN SQLCODE = ZERO                                      15110099
151200              CONTINUE                                            15120099
151300         WHEN SQLCODE = +100                                      15130099
151400                                                                  15140099
151500              SET PS-INVALID-INPUT        TO TRUE                 15150099
151600              MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA              15160099
151700              MOVE -1                     TO ACARTNL              15170099
151800              MOVE PV-CARTON-NBR          TO ACARTNO              15180099
151900              MOVE PC-DC-NOT-SET-RECLAIM  TO AMSGLN1O             15190099
152000              MOVE SPACES                 TO AMSGLN2O             15200099
152100              PERFORM 8100-SEND-DATA-ONLY                         15210099
152200              PERFORM 8200-RETURN-TRANID                          15220099
152300                                                                  15230099
152400         WHEN SQLWARN0 NOT = SPACES                               15240099
152500         WHEN SQLCODE < ZERO                                      15250099
152600         WHEN SQLCODE > ZERO                                      15260099
152700             MOVE '1145-CHECK-DC-RECLAIM      '                   15270099
152800                 TO DP013-PARAGRAPH                               15280099
152900             MOVE 'SELECT OF TKRPRPM TABLE'                       15290099
153000                 TO DP013-MESSAGE-TEXT (1)                        15300099
153100             MOVE SUT00024-SHIPT-UNT-ID                           15310099
153200                 TO DP013-MESSAGE-TEXT (2)                        15320099
153300             MOVE SQLCA            TO DP013-SQLCA                 15330099
153400             MOVE 'TKRPRPM '                                      15340099
153500                                    TO DP013-DB2-TABLE-NAME (1)   15350099
153600             SET DP013-DB2-ABEND   TO TRUE                        15360099
153700             SET DP013-ROLLBACK TO TRUE                           15370099
153800             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               15380099
153900             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           15390099
154000             MOVE SPACES                    TO AMSGLN2O           15400099
154100             MOVE -1                     TO  ACARTNL              15410099
154200             MOVE PV-CARTON-NBR          TO ACARTNO               15420099
154300             PERFORM 8100-SEND-DATA-ONLY                          15430099
154400             PERFORM 8200-RETURN-TRANID                           15440099
154500     END-EVALUATE.                                                15450099
154600                                                                  15460099
154700*-------------------------------------------------------------    15470099
154800 1150-PROCESS-TABLE-EDITS.                                        15480099
154900*-------------------------------------------------------------    15490099
155000     IF  PV-CHAR-COUNT = 22                                       15500099
155100         PERFORM 1360-CHECK-P2L-CARTON                            15510099
155200     ELSE                                                         15520099
155300        SET PS-NO-VENDOR-CARTON-AUDIT TO TRUE                     15530099
155400        IF (PV-18-SML-PACKAGING-TYP = 4) AND                      15540099
155500           (PV-18-SML-SOFTWARE-SRC  = 1)                          15550099
155600             MOVE SPACES       TO DK-BRCDE-NBR                    15560099
155700             MOVE '00'         TO DK-BRCDE-NBR (1:2)              15570099
155800             MOVE PV-CTN-X     TO DK-BRCDE-NBR (3:18)             15580099
155900        ELSE                                                      15590099
156000             PERFORM 1300-CHECK-SYS-AUD-BRCDE                     15600099
156100             IF  PS-VENDOR-CARTON-AUDIT                           15610099
156200                 CONTINUE                                         15620099
156300             ELSE                                                 15630099
156400                 PERFORM 1350-CHECK-P2L-CARTON                    15640099
156500             END-IF                                               15650099
156600             IF  (PS-VENDOR-CARTON-AUDIT AND                      15660099
156700                 PS-P2L-BOUND-BRCDE-FND) OR                       15670099
156800                 PS-VENDOR-CARTON-FND                             15680099
156900                 CONTINUE                                         15690099
157000             ELSE                                                 15700099
157100                 PERFORM 1375-CHECK-PBS-DC-RTV                    15710099
157200             END-IF                                               15720099
157300             IF PS-INVALID-INPUT                                  15730099
157400                MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA            15740099
157500                MOVE -1                     TO ACARTNL            15750099
157600                MOVE PV-CARTON-NBR          TO ACARTNO            15760099
157700                MOVE PC-MUST-BE-KOHLS-SML   TO AMSGLN1O           15770099
157800                MOVE SPACES                 TO AMSGLN2O           15780099
157900                PERFORM 8100-SEND-DATA-ONLY                       15790099
158000                PERFORM 8200-RETURN-TRANID                        15800099
158100             END-IF                                               15810099
158200        END-IF                                                    15820099
158300     END-IF                                                       15830099
158400                                                                  15840099
158500     IF PS-VALID-INPUT                                            15850099
158600        IF PS-P2L-BOUND-BRCDE-FND OR PS-VENDOR-CARTON-FND OR      15860099
158700           PS-PBS-DC-RTV-YES                                      15870099
158800             CONTINUE                                             15880099
158900        ELSE                                                      15890099
159000            PERFORM 1400-CHECK-CREATE-SOURCE                      15900099
159100            IF PS-LABEL-RECLAIM OR PS-LABEL-UNUSED                15910099
159200                PERFORM 1160-SEND-MESSAGE-TO-SCREEN               15920099
159300            ELSE                                                  15930099
159400                IF SUT00024-CART-SRC-CDE = 'FXR'                  15940099
159500                    SET PS-FAST-XFER-CRTN-FND  TO TRUE            15950099
159600              ELSE                                                15960099
159700                 IF SUT00024-CART-SRC-CDE = 'DMG'                 15970099
159800                    IF PC033-RECLAIM                              15980099
159900                        MOVE PC-CANNOT-RECLAIM-DMG TO AMSGLN1O    15990099
160000                        MOVE SPACES                TO AMSGLN2O    16000099
160100                    ELSE                                          16010099
160200                        MOVE PC-CANNOT-UNUSE-DMG   TO AMSGLN1O    16020099
160300                        MOVE SPACES                TO AMSGLN2O    16030099
160400                    END-IF                                        16040099
160500                    MOVE DP015-UNP-ALP-BRT-MDT TO ACARTNA         16050099
160600                    MOVE -1                    TO ACARTNL         16060099
160700                    MOVE PV-CARTON-NBR         TO ACARTNO         16070099
160800                    PERFORM 8100-SEND-DATA-ONLY                   16080099
160900                    PERFORM 8200-RETURN-TRANID                    16090099
161000                ELSE                                              16100099
161100                  IF SUT00024-CART-SRC-CDE = 'CPS' AND            16110099
161200                     PC033-RECLAIM                                16120099
161300                        MOVE PC-MUST-UNUSE-PHY-LBL TO AMSGLN1O    16130099
161400                        MOVE SPACES                TO AMSGLN2O    16140099
161500                        MOVE DP015-UNP-ALP-BRT-MDT TO ACARTNA     16150099
161600                        MOVE -1                    TO ACARTNL     16160099
161700                        MOVE PV-CARTON-NBR         TO ACARTNO     16170099
161800                        PERFORM 8100-SEND-DATA-ONLY               16180099
161900                        PERFORM 8200-RETURN-TRANID                16190099
162000                ELSE                                              16200099
162100                  IF PS-VALID-INPUT  AND                          16210099
162200                       PC033-OPER-UNT-ID  =  SUT00024-ORGN-LOC-NBR16220099
162300                        CONTINUE                                  16230099
162400                    ELSE                                          16240099
162500                      IF PS-INVALID-INPUT                         16250099
162600                        IF PS-NO-VENDOR-CARTON-AUDIT              16260099
162700                            PERFORM 8700-SELECT-TSHUNLO           16270099
162800                            IF SQLCODE NOT = +100 AND             16280099
162900                               NOT PS-P2L-BOUND-BRCDE-FND         16290099
163000                                 CONTINUE                         16300099
163100                            ELSE                                  16310099
163200                              IF SUT00024-ACTV-IND = 'N'          16320099
163300                                  MOVE 'ALREADY INACTIVE  ' TO    16330099
163400                                                          AMSGLN1O16340099
163500                                  MOVE SPACES          TO AMSGLN2O16350099
163600                              ELSE                                16360099
163700                                  MOVE PC034-INVALID-CRTN-ID TO   16370099
163800                                                          AMSGLN1O16380099
163900                                  MOVE SPACES          TO AMSGLN2O16390099
164000                              END-IF                              16400099
164100                             MOVE DP015-UNP-ALP-BRT-MDT TO ACARTNA16410099
164200                              MOVE -1                   TO ACARTNL16420099
164300                              MOVE PV-CARTON-NBR        TO ACARTNO16430099
164400                              PERFORM 8100-SEND-DATA-ONLY         16440099
164500                              PERFORM 8200-RETURN-TRANID          16450099
164600                            END-IF                                16460099
164700                        ELSE                                      16470099
164800                            MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA16480099
164900                            MOVE -1                     TO ACARTNL16490099
165000                            MOVE PV-CARTON-NBR        TO ACARTNO  16500099
165100                            MOVE PC034-INVALID-CRTN-ID TO AMSGLN1O16510099
165200                            MOVE SPACES                TO AMSGLN2O16520099
165300                            PERFORM 8100-SEND-DATA-ONLY           16530099
165400                            PERFORM 8200-RETURN-TRANID            16540099
165500                        END-IF                                    16550099
165600                    ELSE                                          16560099
165700                        IF PC033-OPER-UNT-ID NOT =                16570099
165800                                             SUT00024-ORGN-LOC-NBR16580099
165900                            MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA16590099
166000                            MOVE -1                     TO ACARTNL16600099
166100                            MOVE PC-DC-MUST-BE-DC      TO AMSGLN1O16610099
166200                            MOVE SPACES                TO AMSGLN2O16620099
166300                            MOVE PV-CARTON-NBR         TO ACARTNO 16630099
166400                            PERFORM 8100-SEND-DATA-ONLY           16640099
166500                            PERFORM 8200-RETURN-TRANID            16650099
166600                        END-IF                                    16660099
166700                    END-IF                                        16670099
166800                END-IF                                            16680099
166900               END-IF                                             16690099
167000              END-IF                                              16700099
167100            END-IF                                                16710099
167200          END-IF                                                  16720099
167300        END-IF                                                    16730099
167400     ELSE                                                         16740099
167500         IF PS-INVALID-INPUT                                      16750099
167600             MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA               16760099
167700             MOVE -1                     TO ACARTNL               16770099
167800             MOVE PV-CARTON-NBR          TO ACARTNO               16780099
167900             MOVE PC-MUST-BE-KOHLS-SML   TO AMSGLN1O              16790099
168000             MOVE SPACES                 TO AMSGLN2O              16800099
168100             PERFORM 8100-SEND-DATA-ONLY                          16810099
168200             PERFORM 8200-RETURN-TRANID                           16820099
168300         END-IF                                                   16830099
168400     END-IF.                                                      16840099
168500                                                                  16850099
168600     IF PS-NO-VENDOR-CARTON-FND AND PS-NO-P2L-BOUND-BRCDE-FND     16860099
168700        AND PS-NO-FAST-XFER-CRTN-FND                              16870099
168800           PERFORM 1170-SELECT-VENDOR                             16880099
168900     END-IF.                                                      16890099
169000                                                                  16900099
169100*-------------------------------------------------------------    16910099
169200 1160-SEND-MESSAGE-TO-SCREEN.                                     16920099
169300*-------------------------------------------------------------    16930099
169400     IF PS-LABEL-RECLAIM                                          16940099
169500         MOVE PC-LABEL-RECLAIM-MSG TO AMSGLN1O                    16950099
169600     ELSE                                                         16960099
169700         MOVE PC-LABEL-UNUSED-MSG  TO AMSGLN1O                    16970099
169800     END-IF.                                                      16980099
169900     MOVE SPACES                   TO AMSGLN2O.                   16990099
170000     MOVE DP015-UNP-ALP-BRT-MDT    TO ACARTNA.                    17000099
170100     MOVE -1                       TO ACARTNL.                    17010099
170200     MOVE PV-CARTON-NBR         TO ACARTNO.                       17020099
170300     PERFORM 8100-SEND-DATA-ONLY.                                 17030099
170400     PERFORM 8200-RETURN-TRANID.                                  17040099
170500                                                                  17050099
170600*-------------------------------------------------------------    17060099
170700 1170-SELECT-VENDOR.                                              17070099
170800*-------------------------------------------------------------    17080099
170900*    INITIALIZE PV-BARCODE-1-22.                                  17090099
171000*    MOVE PV-CTN-N        TO PV-BARCODE-1-18.                     17100099
171100*    MOVE PV-BARCODE-1-22 TO DK-BRCDE-NBR.                        17110099
171200                                                                  17120099
171300     EXEC SQL                                                     17130099
171400        SELECT SHIPT_UNT_ID                                       17140099
171500         INTO  :DK-VENDOR-SHIPT-UNT                               17150099
171600         FROM   TSULBXF                                           17160099
171700         WHERE  BRCDE_NBR     = :DK-BRCDE-NBR                     17170099
171800           AND  STAT_CDE          =  'A'                          17180099
171900     END-EXEC.                                                    17190099
172000                                                                  17200099
172100     EVALUATE TRUE                                                17210099
172200         WHEN SQLCODE = ZERO                                      17220099
172300              CONTINUE                                            17230099
172400         WHEN SQLWARN0 NOT = SPACES                               17240099
172500         WHEN SQLCODE NOT EQUAL ZERO                              17250099
172600             MOVE '1170-SELECT-VENDOR'                            17260099
172700                 TO DP013-PARAGRAPH                               17270099
172800             MOVE 'SELECT OF TSULBXF FOR VENDOR'                  17280099
172900                 TO DP013-MESSAGE-TEXT (1)                        17290099
173000             MOVE DK-BRCDE-NBR                                    17300099
173100                 TO DP013-MESSAGE-TEXT (2)                        17310099
173200             MOVE SQLCA            TO DP013-SQLCA                 17320099
173300             MOVE 'TSULBXF'                                       17330099
173400                                    TO DP013-DB2-TABLE-NAME (1)   17340099
173500             SET DP013-DB2-ABEND   TO TRUE                        17350099
173600             SET DP013-ROLLBACK TO TRUE                           17360099
173700             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               17370099
173800             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           17380099
173900             MOVE SPACES                    TO AMSGLN2O           17390099
174000             MOVE -1                     TO  ACARTNL              17400099
174100             MOVE PV-CARTON-NBR          TO ACARTNO               17410099
174200             PERFORM 8100-SEND-DATA-ONLY                          17420099
174300             PERFORM 8200-RETURN-TRANID                           17430099
174400     END-EVALUATE.                                                17440099
174500                                                                  17450099
174600*-------------------------------------------------------------    17460099
174700 1200-HELP-SCREEN.                                                17470099
174800*-------------------------------------------------------------    17480099
174900     MOVE 'DPKRF278'                  TO PV-TRANSFER-PROGRAM      17490099
175000     MOVE PC-CURRENT-PROGRAM-NAME     TO PC192-PROGRAM-NAME       17500099
175100     COPY PCPD188.                                                17510099
175200     MOVE PC188-DISPLAY-DATE          TO PC192-DISPLAY-DATE.      17520099
175300     MOVE CA-COMMAREA                 TO PC192-HOST-SAVE-AREA     17530099
175400     PERFORM 2150-XCTL-TO-HELP.                                   17540099
175500                                                                  17550099
175600*-----------------------------------------------------------------17560099
175700* MUST SCAN KOHLS SML FOR RECLAIM LABEL. EXCEPTION, IS THE VENDOR 17570099
175800* CARTON MAY BE SCANNED IF THE CARTON IS PART OF A SYSTEM         17580099
175900* GENERATED AUDIT                                                 17590099
176000*-----------------------------------------------------------------17600099
176100 1300-CHECK-SYS-AUD-BRCDE.                                        17610099
176200     MOVE PV-CTN-N  TO   SUATRN-SHIPT-UNT-ID.                     17620099
176300                                                                  17630099
176400     EXEC SQL                                                     17640099
176500        SELECT  A.AUD_STAT_CDE                                    17650099
176600              , D.BRCDE_NBR                                       17660099
176700              , A.AUD_CNTL_NBR                                    17670099
176800         INTO  :SUT00015-AUD-STAT-CDE                             17680099
176900             , :SULBXF-BRCDE-NBR                                  17690099
177000             , :SUT00015-AUD-CNTL-NBR                             17700099
177100         FROM   SUT_PO_AUD_REQ A                                  17710099
177200             ,  TSUATRN B                                         17720099
177300             ,  TSUNAUD C                                         17730099
177400             ,  TSULBXF D                                         17740099
177500         WHERE  A.AUD_CNTL_NBR  = B.AUD_CNTL_NBR                  17750099
177600                AND A.AUD_CNTL_NBR  = C.AUD_CNTL_NBR              17760099
177700                AND C.AUD_CAT_CDE   = 'C'                         17770099
177800                AND B.SHIPT_UNT_ID  = :SUATRN-SHIPT-UNT-ID        17780099
177900                AND B.SHIPT_UNT_ID  = D.SHIPT_UNT_ID              17790099
178000     END-EXEC.                                                    17800099
178100                                                                  17810099
178200     EVALUATE TRUE                                                17820099
178300         WHEN SQLCODE = ZERO                                      17830099
178400         WHEN SQLCODE = -811                                      17840099
178500              SET PS-VENDOR-CARTON-AUDIT TO TRUE                  17850099
178600              MOVE SULBXF-BRCDE-NBR TO DK-BRCDE-NBR               17860099
178700         WHEN SQLCODE = +100                                      17870099
178800              SET PS-INVALID-INPUT TO TRUE                        17880099
178900         WHEN SQLWARN0 NOT = SPACES                               17890099
179000         WHEN SQLCODE NOT EQUAL ZERO                              17900099
179100             MOVE '1300-CHECK-SYS-PRMPTED-AUD'                    17910099
179200                 TO DP013-PARAGRAPH                               17920099
179300             MOVE 'SELECT OF PO_AUD_REQ TABLE'                    17930099
179400                 TO DP013-MESSAGE-TEXT (1)                        17940099
179500             MOVE PV-CTN-N                                        17950099
179600                 TO DP013-MESSAGE-TEXT (2)                        17960099
179700             MOVE SUATRN-SHIPT-UNT-ID   TO PV-DISP-SHIPT-UNT-ID   17970099
179800             MOVE PV-DISP-SHIPT-UNT-ID                            17980099
179900                 TO DP013-MESSAGE-TEXT (3)                        17990099
180000             MOVE SQLCA            TO DP013-SQLCA                 18000099
180100             MOVE 'SUT_PO_AUD_REQ'                                18010099
180200                                    TO DP013-DB2-TABLE-NAME (1)   18020099
180300             MOVE 'TSULBXF'                                       18030099
180400                                    TO DP013-DB2-TABLE-NAME (2)   18040099
180500             SET DP013-DB2-ABEND   TO TRUE                        18050099
180600             SET DP013-ROLLBACK TO TRUE                           18060099
180700             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               18070099
180800             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           18080099
180900             MOVE SPACES                    TO AMSGLN2O           18090099
181000             MOVE -1                     TO  ACARTNL              18100099
181100             MOVE PV-CARTON-NBR          TO ACARTNO               18110099
181200             PERFORM 8100-SEND-DATA-ONLY                          18120099
181300             PERFORM 8200-RETURN-TRANID                           18130099
181400     END-EVALUATE.                                                18140099
181500                                                                  18150099
181600*-----------------------------------------------------------------18160099
181700* MUST SCAN KOHLS SML FOR RECLAIM LABEL. EXCEPTION, IS THE CARTON 18170099
181800* DESTINED FOR P2L                                                18180099
181900*-----------------------------------------------------------------18190099
182000 1350-CHECK-P2L-CARTON.                                           18200099
182100     MOVE PV-CTN-N  TO   SULBXF-SHIPT-UNT-ID.                     18210099
182200                                                                  18220099
182300     EXEC SQL                                                     18230099
182400        SELECT  CART_LBL_TYP_CDE                                  18240099
182500             ,  BRCDE_NBR                                         18250099
182600         INTO  :SULBXF-CART-LBL-TYP-CDE                           18260099
182700             , :SULBXF-BRCDE-NBR                                  18270099
182800         FROM   TSULBXF                                           18280099
182900         WHERE  SHIPT_UNT_ID  = :SULBXF-SHIPT-UNT-ID              18290099
183000*          AND  CART_LBL_TYP_CDE  =  'P'                          18300099
183100           AND  STAT_CDE          =  'A'                          18310099
183200     END-EXEC.                                                    18320099
183300                                                                  18330099
183400     EVALUATE TRUE                                                18340099
183500         WHEN SQLCODE = ZERO                                      18350099
183600              IF SULBXF-CART-LBL-TYP-CDE = 'P'                    18360099
183700                  SET PS-P2L-BOUND-BRCDE-FND                      18370099
183800                      PS-VALID-INPUT         TO TRUE              18380099
183900                  MOVE SULBXF-BRCDE-NBR TO DK-BRCDE-NBR           18390099
184000              ELSE                                                18400099
184100                  SET PS-INVALID-INPUT TO TRUE                    18410099
184200              END-IF                                              18420099
184300         WHEN SQLCODE = +100                                      18430099
184400              MOVE SULBXF-SHIPT-UNT-ID TO PV-VENDOR-SSCC          18440099
184500              PERFORM 5325-DELETE-TSHUNLO                         18450099
184600              SET PS-VALID-INPUT                                  18460099
184700                  PS-VENDOR-CARTON-FND TO TRUE                    18470099
184800         WHEN SQLWARN0 NOT = SPACES                               18480099
184900         WHEN SQLCODE NOT EQUAL ZERO                              18490099
185000             MOVE '1350-CHECK-P2L-CARTON'                         18500099
185100                 TO DP013-PARAGRAPH                               18510099
185200             MOVE 'SELECT OF TSULBXF FOR P2L '                    18520099
185300                 TO DP013-MESSAGE-TEXT (1)                        18530099
185400             MOVE PV-CTN-N                                        18540099
185500                 TO DP013-MESSAGE-TEXT (2)                        18550099
185600             MOVE SQLCA            TO DP013-SQLCA                 18560099
185700             MOVE 'TSULBXF'                                       18570099
185800                                    TO DP013-DB2-TABLE-NAME (1)   18580099
185900             SET DP013-DB2-ABEND   TO TRUE                        18590099
186000             SET DP013-ROLLBACK TO TRUE                           18600099
186100             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               18610099
186200             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           18620099
186300             MOVE SPACES                    TO AMSGLN2O           18630099
186400             MOVE -1                     TO  ACARTNL              18640099
186500             MOVE PV-CARTON-NBR          TO ACARTNO               18650099
186600             PERFORM 8100-SEND-DATA-ONLY                          18660099
186700             PERFORM 8200-RETURN-TRANID                           18670099
186800     END-EVALUATE.                                                18680099
186900                                                                  18690099
187000*-----------------------------------------------------------------18700099
187100* MUST SCAN KOHLS SML FOR RECLAIM LABEL. EXCEPTION, IS THE CARTON 18710099
187200* DESTINED FOR P2L                                                18720099
187300*-----------------------------------------------------------------18730099
187400 1360-CHECK-P2L-CARTON.                                           18740099
187500     MOVE PV-CTN    TO   SULBXF-BRCDE-NBR.                        18750099
187600                                                                  18760099
187700     EXEC SQL                                                     18770099
187800        SELECT  CART_LBL_TYP_CDE                                  18780099
187900             ,  SHIPT_UNT_ID                                      18790099
188000         INTO  :SULBXF-CART-LBL-TYP-CDE                           18800099
188100             , :SULBXF-SHIPT-UNT-ID                               18810099
188200         FROM   TSULBXF                                           18820099
188300         WHERE  BRCDE_NBR     = :SULBXF-BRCDE-NBR                 18830099
188400           AND  CART_LBL_TYP_CDE  =  'P'                          18840099
188500           AND  STAT_CDE          =  'A'                          18850099
188600     END-EXEC.                                                    18860099
188700                                                                  18870099
188800     EVALUATE TRUE                                                18880099
188900         WHEN SQLCODE = ZERO                                      18890099
189000              SET PS-P2L-BOUND-BRCDE-FND                          18900099
189100                  PS-VALID-INPUT         TO TRUE                  18910099
189200              MOVE SULBXF-BRCDE-NBR      TO DK-BRCDE-NBR          18920099
189300              MOVE SULBXF-SHIPT-UNT-ID   TO SUT00024-SHIPT-UNT-ID 18930099
189400                                            PV-CTN-N              18940099
189500         WHEN SQLCODE = +100                                      18950099
189600              SET PS-INVALID-INPUT TO TRUE                        18960099
189700         WHEN SQLWARN0 NOT = SPACES                               18970099
189800         WHEN SQLCODE NOT EQUAL ZERO                              18980099
189900             MOVE '1360-CHECK-P2L-CARTON'                         18990099
190000                 TO DP013-PARAGRAPH                               19000099
190100             MOVE 'SELECT OF PO_AUD_REQ TABLE'                    19010099
190200                 TO DP013-MESSAGE-TEXT (1)                        19020099
190300             MOVE PV-CTN-N                                        19030099
190400                 TO DP013-MESSAGE-TEXT (2)                        19040099
190500             MOVE SULBXF-BRCDE-NBR      TO PV-DISP-SHIPT-UNT-ID   19050099
190600             MOVE PV-DISP-SHIPT-UNT-ID                            19060099
190700                 TO DP013-MESSAGE-TEXT (3)                        19070099
190800             MOVE SQLCA            TO DP013-SQLCA                 19080099
190900             MOVE 'TSULBXF'                                       19090099
191000                                    TO DP013-DB2-TABLE-NAME (1)   19100099
191100             SET DP013-DB2-ABEND   TO TRUE                        19110099
191200             SET DP013-ROLLBACK TO TRUE                           19120099
191300             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               19130099
191400             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           19140099
191500             MOVE SPACES                    TO AMSGLN2O           19150099
191600             MOVE -1                     TO  ACARTNL              19160099
191700             MOVE PV-CARTON-NBR          TO ACARTNO               19170099
191800             PERFORM 8100-SEND-DATA-ONLY                          19180099
191900             PERFORM 8200-RETURN-TRANID                           19190099
192000     END-EVALUATE.                                                19200099
192100                                                                  19210099
192200*-------------------------------------------------------------    19220099
192300 1375-CHECK-PBS-DC-RTV.                                           19230099
192400*-------------------------------------------------------------    19240099
192500     MOVE PV-CTN-N  TO   SUT00024-SHIPT-UNT-ID.                   19250099
192600                                                                  19260099
192700     EXEC SQL                                                     19270099
192800        SELECT  LOC_TYP_CDE                                       19280099
192900         INTO  :XLT00010-LOC-TYP-CDE                              19290099
193000         FROM   SUT_OTBND_CART                                    19300099
193100              , XLT_LOC                                           19310099
193200         WHERE  SHIPT_UNT_ID  = :SUT00024-SHIPT-UNT-ID            19320099
193300           AND  DEST_LOC_NBR  = LOC_NBR                           19330099
193400           AND  CART_TYP_CDE  = 'K'                               19340099
193500           AND  LOC_TYP_CDE   IN ('DC', 'RT')                     19350099
193600     END-EXEC.                                                    19360099
193700                                                                  19370099
193800     EVALUATE TRUE                                                19380099
193900         WHEN SQLCODE = ZERO                                      19390099
194000              SET PS-PBS-DC-RTV-YES                               19400099
194100                  PS-VALID-INPUT         TO TRUE                  19410099
194200         WHEN SQLCODE = +100                                      19420099
194300              CONTINUE                                            19430099
194400*             SET PS-INVALID-INPUT TO TRUE                        19440099
194500         WHEN SQLWARN0 NOT = SPACES                               19450099
194600         WHEN SQLCODE NOT EQUAL ZERO                              19460099
194700             MOVE '1375-CHECK-PBS-DC-RTV'  TO DP013-PARAGRAPH     19470099
194800             MOVE 'SELECT OF OTBND CART/XLLOC'                    19480099
194900                 TO DP013-MESSAGE-TEXT (1)                        19490099
195000             MOVE PV-CTN-N    TO DP013-MESSAGE-TEXT (2)           19500099
195100             MOVE SQLCA       TO DP013-SQLCA                      19510099
195200             MOVE 'OTBDCTN'   TO DP013-DB2-TABLE-NAME (1)         19520099
195300             SET DP013-DB2-ABEND TO TRUE                          19530099
195400             SET DP013-ROLLBACK  TO TRUE                          19540099
195500             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               19550099
195600             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           19560099
195700             MOVE SPACES                    TO AMSGLN2O           19570099
195800             MOVE -1                     TO  ACARTNL              19580099
195900             MOVE PV-CARTON-NBR          TO ACARTNO               19590099
196000             PERFORM 8100-SEND-DATA-ONLY                          19600099
196100             PERFORM 8200-RETURN-TRANID                           19610099
196200     END-EVALUATE.                                                19620099
196300                                                                  19630099
196400*-----------------------------------------------------------------19640099
196500* CHECK THAT BARCODES CREATED WERE PHYSICAL LABELS FROM CASEPACK  19650099
196600* SOURCE 'CPS' OR SCANNED CARTONS FROM CHECK-IN 'ASN' BUT NOT     19660099
196700* PACK BY STORE WHICH IS TYPE_CDE = 'K'                           19670099
196800* AS OF 3/2004, PACK BY STORE CARTONS (WHICH INCLUDES SMO CARTONS)19680099
196900* CAN BE INCLUDED.                                     DBRANTNER  19690099
197000* NEED TO ALLOW FOR A CARTON SOURCE OF 'DMG' SO THAT A SPECIAL ERR19700099
197100* MESSAGE CAN BE SHOWN ON THE SCREEN. 'DMG' CARTONS CANNOT BE     19710099
197200* RECLAIMED.   7/2004                                  DBRANTNER  19720099
197300* NEED TO CHECK ACTV-IND.  IF 'N', CHECK OTBND_LOC TO SEE IF THE  19730099
197400* LABEL HAS BEEN RECLAIMED OR UNUSED PREVIOUSLY.                  19740099
197500* RECLAIMED.   7/2004                                  DBRANTNER  19750099
197600* THE DC ACCIDENTALLY CREATED 2 FAST TRANSFER CARTONS FROM ONE    19760099
197700* REQUEST SO THEY WANT TO BE ABLE TO UNUSE FXR TYPE CARTONS.      19770099
197800*    5/2005                                  DBRANTNER            19780099
197900*-----------------------------------------------------------------19790099
198000 1400-CHECK-CREATE-SOURCE.                                        19800099
198100     MOVE PV-CTN-N  TO   SUT00024-SHIPT-UNT-ID.                   19810099
198200                                                                  19820099
198300     IF  PS-VENDOR-CARTON-AUDIT                                   19830099
198400         MOVE DK-BRCDE-NBR     TO  PV-BARCODE                     19840099
198500         MOVE PV-BARCODE-3-20  TO  SUT00024-SHIPT-UNT-ID          19850099
198600     END-IF.                                                      19860099
198700                                                                  19870099
198800     EXEC SQL                                                     19880099
198900        SELECT  ORGN_LOC_NBR                                      19890099
199000              , CART_SRC_CDE                                      19900099
199100              , SHIPT_UNT_ID                                      19910099
199200              , CART_TYP_CDE                                      19920099
199300              , ACTV_IND                                          19930099
199400              , TIMESTAMP (CRE_DTE, CRE_TM)                       19940099
199500         INTO  :SUT00024-ORGN-LOC-NBR                             19950099
199600              ,:SUT00024-CART-SRC-CDE                             19960099
199700              ,:SUT00024-SHIPT-UNT-ID                             19970099
199800              ,:SUT00024-CART-TYP-CDE                             19980099
199900              ,:SUT00024-ACTV-IND                                 19990099
200000              ,:DK-CARTON-TMST                                    20000099
200100        FROM   SUT_OTBND_CART A                                   20010099
200200        WHERE  SHIPT_UNT_ID     = :SUT00024-SHIPT-UNT-ID          20020099
200300*DMB       AND ACTV_IND         = 'Y'                             20030099
200400*DMB       AND CART_TYP_CDE     <> 'K'                            20040099
200500           AND CART_SRC_CDE IN ('ASN','CPS','SMO','DMG','FXR')    20050099
200600     END-EXEC.                                                    20060099
200700                                                                  20070099
200800     EVALUATE TRUE                                                20080099
200900         WHEN SQLCODE = ZERO                                      20090099
201000             MOVE SUT00024-CART-SRC-CDE                           20100099
201100                                    TO PS-OTBND-CART-CREATE-SOURCE20110099
201200             IF SUT00024-ACTV-IND = 'N'                           20120099
201300                 PERFORM 1410-SELECT-OTBND-LOC                    20130099
201400             ELSE                                                 20140099
201500                 IF PS-CREATED-BY-SMO                             20150099
201600                     SET PS-PACK-BY-STORE-YES TO TRUE             20160099
201700                 ELSE                                             20170099
201800                     IF SUT00024-CART-TYP-CDE = 'K'               20180099
201900                         SET PS-PACK-BY-STORE-YES TO TRUE         20190099
202000                     ELSE                                         20200099
202100                         SET PS-PACK-BY-STORE-NO  TO TRUE         20210099
202200                     END-IF                                       20220099
202300                 END-IF                                           20230099
202400             END-IF                                               20240099
202500         WHEN SQLCODE = +100                                      20250099
202600              SET PS-INVALID-INPUT TO TRUE                        20260099
202700         WHEN SQLWARN0 NOT = SPACES                               20270099
202800         WHEN SQLCODE NOT EQUAL ZERO                              20280099
202900             MOVE '1400-CHECK-CREATE-SOURCE '                     20290099
203000                 TO DP013-PARAGRAPH                               20300099
203100             MOVE 'SELECT OF SUT_OTBND_CART TABLE'                20310099
203200                 TO DP013-MESSAGE-TEXT (1)                        20320099
203300             MOVE PV-CTN-N                                        20330099
203400                 TO DP013-MESSAGE-TEXT (2)                        20340099
203500             MOVE SQLCA            TO DP013-SQLCA                 20350099
203600             MOVE 'SUT00024 '      TO DP013-DB2-TABLE-NAME (1)    20360099
203700             SET DP013-DB2-ABEND   TO TRUE                        20370099
203800             SET DP013-ROLLBACK    TO TRUE                        20380099
203900             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               20390099
204000             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           20400099
204100             MOVE SPACES                    TO AMSGLN2O           20410099
204200             MOVE -1               TO  ACARTNL                    20420099
204300             MOVE PV-CARTON-NBR          TO ACARTNO               20430099
204400             PERFORM 8100-SEND-DATA-ONLY                          20440099
204500             PERFORM 8200-RETURN-TRANID                           20450099
204600     END-EVALUATE.                                                20460099
204700                                                                  20470099
204800*----------------------------------------------------------------*20480099
204900 1410-SELECT-OTBND-LOC.                                           20490099
205000*----------------------------------------------------------------*20500099
205100     EXEC SQL                                                     20510099
205200        SELECT  SCN_CDE                                           20520099
205300         INTO  :SUT00027-SCN-CDE                                  20530099
205400        FROM   SUT_OTBND_LOC                                      20540099
205500        WHERE  SHIPT_UNT_ID  = :SUT00024-SHIPT-UNT-ID             20550099
205600          AND  SCN_CDE     IN ('RCLM', 'NUSE')                    20560099
205700     END-EXEC.                                                    20570099
205800                                                                  20580099
205900     EVALUATE TRUE                                                20590099
206000         WHEN SQLCODE = ZERO                                      20600099
206100         WHEN SQLCODE = -811                                      20610099
206200             IF SUT00027-SCN-CDE = 'RCLM'                         20620099
206300                 SET PS-LABEL-RECLAIM    TO TRUE                  20630099
206400             ELSE                                                 20640099
206500                 IF SUT00027-SCN-CDE = 'NUSE'                     20650099
206600                     SET PS-LABEL-UNUSED TO TRUE                  20660099
206700                 ELSE                                             20670099
206800                     SET PS-INVALID-INPUT TO TRUE                 20680099
206900                 END-IF                                           20690099
207000             END-IF                                               20700099
207100         WHEN SQLCODE = +100                                      20710099
207200              SET PS-INVALID-INPUT TO TRUE                        20720099
207300         WHEN SQLWARN0 NOT = SPACES                               20730099
207400         WHEN SQLCODE NOT EQUAL ZERO                              20740099
207500             MOVE '1410-SELECT-OTBND-LOC '      TO DP013-PARAGRAPH20750099
207600             MOVE 'SELECT OF SUT_OTBND_LOC TABLE'                 20760099
207700                 TO DP013-MESSAGE-TEXT (1)                        20770099
207800             MOVE PV-CTN-N                                        20780099
207900                 TO DP013-MESSAGE-TEXT (2)                        20790099
208000             MOVE SQLCA            TO DP013-SQLCA                 20800099
208100             MOVE 'SUT00024 '      TO DP013-DB2-TABLE-NAME (1)    20810099
208200             SET DP013-DB2-ABEND   TO TRUE                        20820099
208300             SET DP013-ROLLBACK    TO TRUE                        20830099
208400             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               20840099
208500             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           20850099
208600             MOVE SPACES                    TO AMSGLN2O           20860099
208700             MOVE -1               TO  ACARTNL                    20870099
208800             MOVE PV-CARTON-NBR    TO ACARTNO                     20880099
208900             PERFORM 8100-SEND-DATA-ONLY                          20890099
209000             PERFORM 8200-RETURN-TRANID                           20900099
209100     END-EVALUATE.                                                20910099
209200                                                                  20920099
209300*----------------------------------------------------------------*20930099
209400 1500-INTERFACE-TO-LABOR.                                         20940099
209500*-------------------------------------------------------------    20950099
209600     IF PS-NO-VENDOR-CARTON-FND                                   20960099
209700         PERFORM 1540-CHECK-DC-LABOR                              20970099
209800         IF PS-DC-INTERFC-LABOR-YES                               20980099
209900            PERFORM 1600-CHECK-LABOR-ASGMT                        20990099
210000         END-IF                                                   21000099
210100     END-IF.                                                      21010099
210200                                                                  21020099
210300*----------------------------------------------------------------*21030099
210400*                 LABOR - BEGIN                                  *21040099
210500*    DETERMINE IF DC IS INTERFACING WITH THE DC LABOR SYSTEM     *21050099
210600*----------------------------------------------------------------*21060099
210700 1540-CHECK-DC-LABOR.                                             21070099
210800                                                                  21080099
210900     MOVE '1540' TO PV-CURRENT-PARAGRAPH.                         21090099
211000     MOVE DK-OPER-UNT-ID     TO  DK-LABOR-OPER.                   21100099
211100                                                                  21110099
211200     EXEC SQL                                                     21120099
211300          SELECT  FUNC_TXT                                        21130099
211400            INTO :KRPRPM-FUNC-TXT                                 21140099
211500            FROM  TKRPRPM                                         21150099
211600           WHERE  LOC_ID            = :DK-LABOR-OPER              21160099
211700             AND  INTFC_SYS_CDE     = :PC-DLX                     21170099
211800             AND  SYS_PRC_FUNC_CDE  = :PC-DLLBIN                  21180099
211900     END-EXEC.                                                    21190099
212000                                                                  21200099
212100     EVALUATE TRUE                                                21210099
212200         WHEN SQLCODE = +0                                        21220099
212300              IF  KRPRPM-FUNC-TXT  = 'Y'                          21230099
212400                  SET  PS-DC-INTERFC-LABOR-YES TO   TRUE          21240099
212500              ELSE                                                21250099
212600                  SET  PS-DC-INTERFC-LABOR-NO   TO  TRUE          21260099
212700              END-IF                                              21270099
212800                                                                  21280099
212900         WHEN SQLCODE = +100                                      21290099
213000              SET  PS-DC-INTERFC-LABOR-NO   TO  TRUE              21300099
213100                                                                  21310099
213200         WHEN SQLCODE = -904                                      21320099
213300         WHEN SQLCODE = -911                                      21330099
213400         WHEN SQLCODE = -913                                      21340099
213500              STRING 'SQLCODE='                                   21350099
213600                      PV-DISPLAY-SQLCODE                          21360099
213700                      DELIMITED BY SIZE                           21370099
213800                      INTO PV-ERROR-CONDITION                     21380099
213900                                                                  21390099
214000              PERFORM 1900-FORMAT-MSG-AREA                        21400099
214100                                                                  21410099
214200         WHEN SQLWARN0 NOT = SPACES                               21420099
214300         WHEN SQLCODE < +0                                        21430099
214400         WHEN SQLCODE > +0                                        21440099
214500              MOVE '1540-CHECK-DC-LABOR'                          21450099
214600                                 TO DP013-PARAGRAPH               21460099
214700              MOVE 'CHECK IF INTERFACE WITH DC LABOR SYSTEM'      21470099
214800                                 TO DP013-MESSAGE-TEXT (1)        21480099
214900              MOVE SQLCA         TO DP013-SQLCA                   21490099
215000              MOVE 'TKRPRPM'     TO DP013-DB2-TABLE-NAME (1)      21500099
215100              SET DP013-DB2-ABEND                                 21510099
215200                  DP013-ROLLBACK TO TRUE                          21520099
215300              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              21530099
215400              MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O          21540099
215500              MOVE SPACES                    TO AMSGLN2O          21550099
215600              MOVE -1  TO ACARTNL                                 21560099
215700              MOVE PV-CARTON-NBR    TO ACARTNO                    21570099
215800              PERFORM 8100-SEND-DATA-ONLY                         21580099
215900              PERFORM 8200-RETURN-TRANID                          21590099
216000                                                                  21600099
216100     END-EVALUATE.                                                21610099
216200                                                                  21620099
216300*----------------------------------------------------------------*21630099
216400*    IF THE DC IS INTERFACING WITH THE DC LABOR SYSTEM, CHECK    *21640099
216500*    TO SEE IF THE ASSOCIATE IS CURRENTLY ACTIVE ON A LABOR      *21650099
216600*    ASSIGNMENT BY CALLING DLKUT001 USING DLWS003.               *21660099
216700*----------------------------------------------------------------*21670099
216800 1600-CHECK-LABOR-ASGMT.                                          21680099
216900                                                                  21690099
217000     MOVE '1600' TO PV-CURRENT-PARAGRAPH.                         21700099
217100     INITIALIZE  DL003-ASGMT-COMMAREA.                            21710099
217200     SET   DL003-BY-USER-KEY  TO  TRUE.                           21720099
217300     MOVE  PC033-USER-ID      TO  DL003-KEY-USER-ID.              21730099
217400     MOVE PC-CURRENT-PROGRAM-NAME                                 21740099
217500                              TO  DL003-ORIG-CALLING-PGM-NM.      21750099
217600                                                                  21760099
217700     CALL DL003-USER-PGM USING DFHEIBLK                           21770099
217800                               DL003-COMMAREA                     21780099
217900                               DL003-ASGMT-COMMAREA.              21790099
218000                                                                  21800099
218100     EVALUATE TRUE                                                21810099
218200         WHEN DL003-SUCCESSFUL                                    21820099
218300              EVALUATE TRUE                                       21830099
218400                  WHEN DL003-ASGMT-FOUND                          21840099
218500                       SET PS-ASSOC-LABOR-ASGMT-YES   TO TRUE     21850099
218600                                                                  21860099
218700                       MOVE DL003-ASGMT-START-DTE                 21870099
218800                                  TO  PV-LABOR-ASGMT-STRT-DTE     21880099
218900                       MOVE DL003-ASGMT-NBR-TXT                   21890099
219000                                  TO  PV-LABOR-ASGMT-NBR-TXT      21900099
219100                       MOVE DL003-ASGMT-NBR-SEQ-NBR               21910099
219200                                  TO  PV-LABOR-ASGMT-NBR-SEQ-NBR  21920099
219300                       PERFORM 1640-GET-LABOR-SEQ-NBR             21930099
219400                                                                  21940099
219500                  WHEN DL003-ASGMT-NOT-FOUND                      21950099
219600                       SET PS-ASSOC-LABOR-ASGMT-NO                21960099
219700                                  TO TRUE                         21970099
219800                       MOVE 'NO ACTIVE ASSIGNMENT' TO             21980099
219900                                       PV-ERROR-CONDITION         21990099
220000*                      PERFORM 1900-FORMAT-MSG-AREA               22000099
220100                                                                  22010099
220200                  WHEN DL003-ASGMT-MULT-FOUND                     22020099
220300                       SET PS-ASSOC-LABOR-ASGMT-YES TO TRUE       22030099
220400                       MOVE DL003-ASGMT-START-DTE                 22040099
220500                                  TO  PV-LABOR-ASGMT-STRT-DTE     22050099
220600                       MOVE DL003-ASGMT-NBR-TXT                   22060099
220700                                  TO  PV-LABOR-ASGMT-NBR-TXT      22070099
220800                       MOVE DL003-ASGMT-NBR-SEQ-NBR               22080099
220900                                  TO  PV-LABOR-ASGMT-NBR-SEQ-NBR  22090099
221000                                                                  22100099
221100                       MOVE DL003-ASGMT-FOUND-QTY                 22110099
221200                                      TO  PV-DISPLAY-QTY          22120099
221300                       STRING  'MULTIPLE ASGMTS='                 22130099
221400                               PV-DISPLAY-QTY                     22140099
221500                               DELIMITED BY SIZE                  22150099
221600                               INTO PV-ERROR-CONDITION            22160099
221700                       PERFORM 1900-FORMAT-MSG-AREA               22170099
221800                       PERFORM 1980-CALL-ERROR-RTN                22180099
221900                                                                  22190099
222000              END-EVALUATE                                        22200099
222100                                                                  22210099
222200         WHEN DL003-SQL-ERROR                                     22220099
222300              SET PS-ASSOC-LABOR-ASGMT-NO   TO TRUE               22230099
222400              MOVE DL003-ASGMT-SQLCODE TO PV-DISPLAY-SQLCODE      22240099
222500              STRING 'BAD SQLCODE=' PV-DISPLAY-SQLCODE            22250099
222600                     ' - SQL ERROR'                               22260099
222700                      DELIMITED BY SIZE                           22270099
222800                      INTO PV-ERROR-CONDITION                     22280099
222900              PERFORM 1900-FORMAT-MSG-AREA                        22290099
223000              PERFORM 1980-CALL-ERROR-RTN                         22300099
223100                                                                  22310099
223200         WHEN DL003-CALLED-MODULE-FAILURE                         22320099
223300              SET PS-ASSOC-LABOR-ASGMT-NO   TO TRUE               22330099
223400              MOVE DL003-ASGMT-SQLCODE                            22340099
223500                                     TO  PV-DISPLAY-SQLCODE       22350099
223600              STRING 'SQLCODE=' PV-DISPLAY-SQLCODE                22360099
223700                     ' - CALL MODULE FAILURE'                     22370099
223800                      DELIMITED BY SIZE                           22380099
223900                      INTO PV-ERROR-CONDITION                     22390099
224000              PERFORM 1900-FORMAT-MSG-AREA                        22400099
224100              PERFORM 1980-CALL-ERROR-RTN                         22410099
224200                                                                  22420099
224300         WHEN DL003-INVALID-ACCESS                                22430099
224400              SET PS-ASSOC-LABOR-ASGMT-NO   TO TRUE               22440099
224500              MOVE 'INVALID ACCESS' TO PV-ERROR-CONDITION         22450099
224600              PERFORM 1900-FORMAT-MSG-AREA                        22460099
224700              PERFORM 1980-CALL-ERROR-RTN                         22470099
224800                                                                  22480099
224900         WHEN OTHER                                               22490099
225000              SET PS-ASSOC-LABOR-ASGMT-NO   TO TRUE               22500099
225100              STRING 'OTHER RETURN CODE --> '                     22510099
225200                      DL003-RETURN-CODE                           22520099
225300                      DELIMITED BY SIZE                           22530099
225400                      INTO PV-ERROR-CONDITION                     22540099
225500              PERFORM 1900-FORMAT-MSG-AREA                        22550099
225600              PERFORM 1980-CALL-ERROR-RTN                         22560099
225700                                                                  22570099
225800     END-EVALUATE.                                                22580099
225900                                                                  22590099
226000*----------------------------------------------------------------*22600099
226100* IF DC IS INTERFACING WITH THE DC LABOR SYSTEM, AND ASSOCIATE   *22610099
226200* IS CURRENTLY ACTIVE ON A LABOR ASSIGNMENT, GET THE NEXT NEXT   *22620099
226300* SEQUENCE NUMBER FOR THE LABOR SYSTEM.                          *22630099
226400*----------------------------------------------------------------*22640099
226500 1640-GET-LABOR-SEQ-NBR.                                          22650099
226600                                                                  22660099
226700     MOVE '1640' TO PV-CURRENT-PARAGRAPH.                         22670099
226800     INITIALIZE DL001-ASGMT-COMMAREA.                             22680099
226900     SET DL001-BY-ASGMT-KEY                                       22690099
227000         DL001-COMMIT-UPDATE                                      22700099
227100         DL001-FIND-NEXT-ASGMT    TO TRUE.                        22710099
227200                                                                  22720099
227300     MOVE DL003-ASGMT-START-DTE   TO DL001-KEY-START-DTE.         22730099
227400     MOVE DL003-ASGMT-NBR-TXT     TO DL001-KEY-NBR-TXT.           22740099
227500     MOVE DL003-ASGMT-NBR-SEQ-NBR TO DL001-KEY-NBR-SEQ-NBR.       22750099
227600                                                                  22760099
227700     MOVE +1                  TO DL001-NBR-OF-NBRS-NEED-QTY.      22770099
227800                                                                  22780099
227900     MOVE PC-CURRENT-PROGRAM-NAME TO DL001-ORIG-CALLING-PGM-NM.   22790099
228000                                                                  22800099
228100     CALL DL001-USER-PGM USING DFHEIBLK                           22810099
228200                              DL001-COMMAREA                      22820099
228300                              DL001-ASGMT-COMMAREA.               22830099
228400                                                                  22840099
228500     EVALUATE TRUE                                                22850099
228600         WHEN DL001-SUCCESSFUL                                    22860099
228700              IF DL001-ASGMT-NEXT-USED                            22870099
228800                 SET  PS-LABOR-NEXT-SEQ-YES  TO  TRUE             22880099
228900                 MOVE DL001-NXT-START-DTE                         22890099
229000                                   TO PV-LABOR-ASGMT-STRT-DTE     22900099
229100                 MOVE DL001-NXT-NBR-TXT                           22910099
229200                                   TO PV-LABOR-ASGMT-NBR-TXT      22920099
229300                 MOVE DL001-NXT-NBR-SEQ-NBR                       22930099
229400                                   TO PV-LABOR-ASGMT-NBR-SEQ-NBR  22940099
229500                 MOVE DL001-SEQ-START-NBR                         22950099
229600                                   TO PV-LABOR-SEQ-START-NBR      22960099
229700              ELSE                                                22970099
229800                 SET  PS-LABOR-NEXT-SEQ-NO   TO  TRUE             22980099
229900                 MOVE DL001-SEQ-START-NBR                         22990099
230000                                   TO PV-LABOR-SEQ-START-NBR      23000099
230100              END-IF                                              23010099
230200                                                                  23020099
230300         WHEN OTHER                                               23030099
230400              SET  PS-LABOR-NEXT-SEQ-NO   TO  TRUE                23040099
230500              MOVE DL001-ASGMT-SQLCODE TO  PV-DISPLAY-SQLCODE     23050099
230600              STRING 'SQLCODE=' PV-DISPLAY-SQLCODE                23060099
230700                      DELIMITED BY SIZE                           23070099
230800                      INTO PV-ERROR-CONDITION                     23080099
230900              PERFORM 1900-FORMAT-MSG-AREA                        23090099
231000              STRING ' - RETURN CODE=' DL001-RETURN-CODE          23100099
231100                      DELIMITED BY SIZE                           23110099
231200                      INTO PV-ERROR-CONDITION                     23120099
231300              PERFORM 1900-FORMAT-MSG-AREA                        23130099
231400              PERFORM 1980-CALL-ERROR-RTN                         23140099
231500                                                                  23150099
231600     END-EVALUATE.                                                23160099
231700                                                                  23170099
231800*----------------------------------------------------------------*23180099
231900* SEND DATA TO EAI EXPORT DATABASE FOR LABOR SYSTEM              *23190099
232000*----------------------------------------------------------------*23200099
232100 1700-SEND-LABOR-TO-EAI.                                          23210099
232200                                                                  23220099
232300     MOVE '1700' TO PV-CURRENT-PARAGRAPH.                         23230099
232400     PERFORM 1740-GET-TRIP-ID.                                    23240099
232500     PERFORM 1780-GET-MODULE-DESC.                                23250099
232600                                                                  23260099
232700     INITIALIZE XL072-EAI-EXPORT-COMMAREA.                        23270099
232800     SET XL072-SU-APP-ID                                          23280099
232900         XL072-DO-NOT-COMMIT-UPDATE TO TRUE.                      23290099
233000                                                                  23300099
233100     MOVE PC-CARTON               TO XL072-EVNT-OBJ-TXT.          23310099
233200     MOVE PC-RECLAIM              TO XL072-EVNT-OBJ-ACTN-TXT.     23320099
233300                                                                  23330099
233400     MOVE  PC033-USER-ID          TO XL072-CRE-BY-USR-ID.         23340099
233500     MOVE PC-CURRENT-PROGRAM-NAME TO XL072-CRE-PGM-NM.            23350099
233600     MOVE PV-CTN-N                TO XL072-EVNT-KY-1-NBR.         23360099
233700     MOVE SHIPMT-TRIP-ID          TO XL072-EVNT-KY-2-NBR.         23370099
233800                                                                  23380099
233900     EXEC SQL                                                     23390099
234000         SET :PV-TIMESTAMP    = CURRENT TIMESTAMP                 23400099
234100     END-EXEC.                                                    23410099
234200                                                                  23420099
234300     MOVE PV-TIMESTAMP  TO XL072-EVNT-KY-1-TMST.                  23430099
234400                                                                  23440099
234500     INITIALIZE SU050-DTL-TXT-AREA.                               23450099
234600     SET SU050-CRTN-RECLAIM        TO TRUE.                       23460099
234700     MOVE PV-LABOR-ASGMT-STRT-DTE  TO SU050-AC-ASGMT-STRT-DTE.    23470099
234800     MOVE PV-LABOR-ASGMT-NBR-TXT   TO SU050-AC-ASGMT-NBR-TXT.     23480099
234900     MOVE PV-LABOR-ASGMT-NBR-SEQ-NBR                              23490099
235000                                   TO SU050-AC-ASGMT-NBR-SEQ-NBR. 23500099
235100                                                                  23510099
235200     MOVE PV-LABOR-SEQ-START-NBR   TO SU050-AC-ASGMT-SEQ-DTL-NBR. 23520099
235300     MOVE PS-AC-CRTN-DEST-CD       TO SU050-AC-CRTN-DEST-CD.      23530099
235400                                                                  23540099
235500     IF PS-AC-CRTN-TO-LOC                                         23550099
235600        MOVE PV-LABOR-CRTN-LOC TO SU050-AC-CRTN-DEST-LOC-NBR      23560099
235700     END-IF.                                                      23570099
235800                                                                  23580099
235900     SET  XL072-SUWS050-COPYBOOK   TO TRUE.                       23590099
236000     MOVE SU050-DTL-TXT-AREA       TO XL072-DTL-TXT.              23600099
236100                                                                  23610099
236200     CALL XL072-USER-PGM USING DFHEIBLK                           23620099
236300                              XL072-COMMAREA                      23630099
236400                              XL072-EAI-EXPORT-COMMAREA.          23640099
236500                                                                  23650099
236600     EVALUATE TRUE                                                23660099
236700         WHEN XL072-SUCCESSFUL                                    23670099
236800              CONTINUE                                            23680099
236900                                                                  23690099
237000         WHEN OTHER                                               23700099
237100              MOVE XL072-EAI-DB-SQLCODE TO  PV-DISPLAY-SQLCODE    23710099
237200              STRING 'SQLCODE='                                   23720099
237300                      PV-DISPLAY-SQLCODE                          23730099
237400                     ' - RETURN CODE='                            23740099
237500                      XL072-RETURN-CODE                           23750099
237600                      DELIMITED BY SIZE                           23760099
237700                      INTO PV-ERROR-CONDITION                     23770099
237800                                                                  23780099
237900              PERFORM 1900-FORMAT-MSG-AREA                        23790099
238000              PERFORM 1980-CALL-ERROR-RTN                         23800099
238100                                                                  23810099
238200     END-EVALUATE.                                                23820099
238300                                                                  23830099
238400*-------------------------------------------------------------    23840099
238500 1740-GET-TRIP-ID.                                                23850099
238600*-------------------------------------------------------------    23860099
238700     MOVE PC046-PO-NBR        TO DK-PO-NBR.                       23870099
238800     MOVE PC046-RCVR-NBR      TO DK-REC-SEQ-NBR.                  23880099
238900                                                                  23890099
239000     MOVE '1740' TO PV-CURRENT-PARAGRAPH.                         23900099
239100     EXEC SQL                                                     23910099
239200          SELECT  DISTINCT                                        23920099
239300                  B.TRIP_ID                                       23930099
239400            INTO :SHIPMT-TRIP-ID                                  23940099
239500            FROM  TSHPTPO A                                       23950099
239600                 ,TSHIPMT B                                       23960099
239700           WHERE  A.PO_NBR      = :DK-PO-NBR                      23970099
239800             AND  A.REC_SEQ_NBR = :DK-REC-SEQ-NBR                 23980099
239900             AND  A.SHIPT_ID    =  B.SHIPT_ID                     23990099
240000     END-EXEC                                                     24000099
240100                                                                  24010099
240200     EVALUATE TRUE                                                24020099
240300         WHEN SQLCODE = +0                                        24030099
240400         WHEN SQLCODE = -811                                      24040099
240500              CONTINUE                                            24050099
240600                                                                  24060099
240700         WHEN SQLWARN0 NOT = SPACE                                24070099
240800         WHEN SQLCODE < +0                                        24080099
240900         WHEN SQLCODE > +0                                        24090099
241000              MOVE SQLCODE           TO  PV-DISPLAY-SQLCODE       24100099
241100              STRING 'SQLCODE='                                   24110099
241200                      PV-DISPLAY-SQLCODE                          24120099
241300                      DELIMITED BY SIZE                           24130099
241400                      INTO PV-ERROR-CONDITION                     24140099
241500              PERFORM 1900-FORMAT-MSG-AREA                        24150099
241600                                                                  24160099
241700     END-EVALUATE.                                                24170099
241800                                                                  24180099
241900*-------------------------------------------------------------    24190099
242000 1780-GET-MODULE-DESC.                                            24200099
242100*-------------------------------------------------------------    24210099
242200     MOVE '1780' TO PV-CURRENT-PARAGRAPH.                         24220099
242300     EXEC SQL                                                     24230099
242400          SELECT  B.MODU_DESC                                     24240099
242500                 ,B.DFLT_STR_ZN_ID                                24250099
242600            INTO  :P2LMOD-MODU-DESC                               24260099
242700                 ,:P2LMOD-DFLT-STR-ZN-ID                          24270099
242800            FROM  TDISTHD   A                                     24280099
242900                 ,TP2LMOD   B                                     24290099
243000           WHERE  A.ORD_NBR      =  :DK-PO-NBR                    24300099
243100             AND  A.RCVR_SEQ_NBR =  :DK-REC-SEQ-NBR               24310099
243200             AND  A.TOT_CART_CNT >  0                             24320099
243300             AND  NOT A.PRC_AREA_MODU_ID = ' '                    24330099
243400             AND  B.OPER_UNT_ID = A.OPER_UNT_ID                   24340099
243500             AND  B.MODU_NBR    = SMALLINT(A.PRC_AREA_MODU_ID)    24350099
243600     END-EXEC.                                                    24360099
243700                                                                  24370099
243800     EVALUATE TRUE                                                24380099
243900         WHEN SQLCODE = +0                                        24390099
244000         WHEN SQLCODE = -811                                      24400099
244100              CONTINUE                                            24410099
244200         WHEN SQLCODE = +100                                      24420099
244300              MOVE ZEROS TO P2LMOD-MODU-DESC                      24430099
244400                            P2LMOD-DFLT-STR-ZN-ID                 24440099
244500         WHEN SQLWARN0 NOT = SPACE                                24450099
244600         WHEN SQLCODE < +0                                        24460099
244700         WHEN SQLCODE > +0                                        24470099
244800              MOVE SQLCODE           TO  PV-DISPLAY-SQLCODE       24480099
244900              STRING 'SQLCODE='                                   24490099
245000                      PV-DISPLAY-SQLCODE                          24500099
245100                      DELIMITED BY SIZE                           24510099
245200                      INTO PV-ERROR-CONDITION                     24520099
245300              PERFORM 1900-FORMAT-MSG-AREA                        24530099
245400     END-EVALUATE.                                                24540099
245500                                                                  24550099
245600*-------------------------------------------------------------    24560099
245700 1800-GET-LABOR-DATE-TIME.                                        24570099
245800*-------------------------------------------------------------    24580099
245900     EXEC SQL                                                     24590099
246000          SET  :PV-LABOR-CURRENT-DATE  =  CURRENT_DATE            24600099
246100              ,:PV-LABOR-CURRENT-TIME  =  CURRENT_TIME            24610099
246200     END-EXEC.                                                    24620099
246300                                                                  24630099
246400*----------------------------------------------------------------*24640099
246500*    PV-CICS-MSG-AREA2 IS 100 BYTES.                             *24650099
246600*       TOTAL LENGTH OF ALL FIELDS BEING DISPLAYED IS 91.        *24660099
246700*----------------------------------------------------------------*24670099
246800 1900-FORMAT-MSG-AREA.                                            24680099
246900                                                                  24690099
247000     MOVE DK-OPER-UNT-ID  TO PV-DISPLAY-OPER.                     24700099
247100     MOVE DK-PO-NBR       TO PV-DISPLAY-PO.                       24710099
247200     MOVE DK-REC-SEQ-NBR  TO PV-DISPLAY-RCVR.                     24720099
247300     MOVE RECITM-ORD-LNE-NBR                                      24730099
247400                          TO PV-DISPLAY-LINE.                     24740099
247500                                                                  24750099
247600     STRING PC-CURRENT-PROGRAM-NAME  ' - '                        24760099
247700            PV-CURRENT-PARAGRAPH     ' - '                        24770099
247800            PV-DISPLAY-OPER          ' - '                        24780099
247900            PV-DISPLAY-PO            ' - '                        24790099
248000            PV-DISPLAY-RCVR          ' - '                        24800099
248100            PV-DISPLAY-LINE          ' - '                        24810099
248200            DL003-KEY-USER-ID        ' - '                        24820099
248300            PV-ERROR-CONDITION                                    24830099
248400            DELIMITED BY SIZE                                     24840099
248500            INTO PV-CICS-MSG-AREA2.                               24850099
248600                                                                  24860099
248700     PERFORM 1940-WRITE-TO-CICS-LOG.                              24870099
248800                                                                  24880099
248900     MOVE SPACES   TO PV-CICS-MSG-AREA2.                          24890099
249000     STRING 'CARTON = '                                           24900099
249100            PV-DISP-SHIPT-UNT-ID                                  24910099
249200            DELIMITED BY SIZE                                     24920099
249300            INTO PV-CICS-MSG-AREA2.                               24930099
249400                                                                  24940099
249500     PERFORM 1940-WRITE-TO-CICS-LOG.                              24950099
249600                                                                  24960099
249700*-------------------------------------------------------------    24970099
249800 1920-FORMAT-MSG-AREA-2.                                          24980099
249900*-------------------------------------------------------------    24990099
250000     MOVE PV-LABOR-ASGMT-NBR-SEQ-NBR TO PV-DISPLAY-QTY.           25000099
250100                                                                  25010099
250200     STRING PC-CURRENT-PROGRAM-NAME  ' - '                        25020099
250300            PV-CURRENT-PARAGRAPH     ' - '                        25030099
250400            PV-LABOR-ASGMT-STRT-DTE  ' - '                        25040099
250500            PV-LABOR-ASGMT-NBR-TXT   ' - '                        25050099
250600            PV-DISPLAY-QTY           ' - '                        25060099
250700            PV-ERROR-CONDITION                                    25070099
250800            DELIMITED BY SIZE                                     25080099
250900            INTO PV-CICS-MSG-AREA2.                               25090099
251000                                                                  25100099
251100     PERFORM 1940-WRITE-TO-CICS-LOG.                              25110099
251200                                                                  25120099
251300*-------------------------------------------------------------    25130099
251400 1940-WRITE-TO-CICS-LOG.                                          25140099
251500*-------------------------------------------------------------    25150099
251600     MOVE LENGTH OF PV-CICS-MSG-AREA2 TO PV-COMMAREA-LENGTH.      25160099
251700                                                                  25170099
251800     EXEC CICS                                                    25180099
251900          WRITEQ TD                                               25190099
252000           QUEUE  ('CSSL')                                        25200099
252100            FROM  (PV-CICS-MSG-AREA2)                             25210099
252200          LENGTH  (PV-COMMAREA-LENGTH)                            25220099
252300            RESP  (PV-CICS-RESP)                                  25230099
252400     END-EXEC.                                                    25240099
252500                                                                  25250099
252600*-------------------------------------------------------------    25260099
252700 1980-CALL-ERROR-RTN.                                             25270099
252800*-------------------------------------------------------------    25280099
252900     SET DP013-DB2-ABEND   TO TRUE.                               25290099
253000     SET DP013-ROLLBACK TO TRUE.                                  25300099
253100     PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG.                      25310099
253200                                                                  25320099
253300     MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O.                  25330099
253400     MOVE SPACES                    TO AMSGLN2O.                  25340099
253500     MOVE -1                     TO  ACARTNL.                     25350099
253600     MOVE PV-CARTON-NBR          TO  ACARTNO.                     25360099
253700     PERFORM 8100-SEND-DATA-ONLY.                                 25370099
253800     PERFORM 8200-RETURN-TRANID.                                  25380099
253900                                                                  25390099
254000*-------------------------------------------------------------    25400099
254100 2000-PROCESS-CARTON.                                             25410099
254200*-------------------------------------------------------------    25420099
254300      IF PS-P2L-BOUND-BRCDE-FND                                   25430099
254400         MOVE SULBXF-SHIPT-UNT-ID   TO PV-CTN-N                   25440099
254500         SET PS-AC-CRTN-TO-P2L      TO TRUE                       25450099
254600         INITIALIZE PV-DB2-VE-COUNT                               25460099
254700         PERFORM 2005-CHCK-4-VRFD-LINES                           25470099
254800         IF PV-DB2-VE-COUNT > 0                                   25480099
254900            MOVE '  RECLAIM FAILED  '        TO AMSGLN1O          25490099
255000            MOVE PC034-VERFD-LINES-EXIST-MSG TO AMSGLN2O          25500099
255100            MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA                25510099
255200            MOVE -1                     TO ACARTNL                25520099
255300            MOVE PV-CARTON-NBR          TO ACARTNO                25530099
255400            PERFORM 8100-SEND-DATA-ONLY                           25540099
255500            PERFORM 8200-RETURN-TRANID                            25550099
255600         ELSE                                                     25560099
255700             MOVE  SULBXF-BRCDE-NBR      TO PV-BARCODE            25570099
255800             MOVE  SULBXF-SHIPT-UNT-ID   TO PV-VENDOR-SSCC        25580099
255900             PERFORM 5100-UPDATE-TLBVRDA                          25590099
256000             PERFORM 5300-DELETE-TSULBXF                          25600099
256100             PERFORM 5325-DELETE-TSHUNLO                          25610099
256200                                                                  25620099
256300             PERFORM 2002-COMBO-AUDIT-RTN                         25630099
256400         END-IF                                                   25640099
256500      ELSE                                                        25650099
256600         PERFORM 3000-LINK-TO-CRTN-STATUS                         25660099
256700         PERFORM 3200-EVALUATE-CRTN-STATUS                        25670099
256800                                                                  25680099
256900         MOVE PC046-VENDOR-SHIPT-UNT-ID TO PV-LABOR-SSCC          25690099
257000         MOVE PC046-PO-NBR          TO PV-LABOR-PO-NBR            25700099
257100         MOVE PC046-RCVR-NBR        TO PV-LABOR-RCVR-NBR          25710099
257200         SET PS-AC-CRTN-TO-LOC      TO TRUE                       25720099
257300         MOVE PC046-DEST-OPER-UNT-ID TO PV-LABOR-CRTN-LOC         25730099
257400                                                                  25740099
257500         SET PS-BLND-RECV-SIMPL-LOC-NOT-FND TO TRUE               25750099
257600         PERFORM 3360-CHECK-RDM-BLIND-RCVNG                       25760099
257700      END-IF.                                                     25770099
257800                                                                  25780099
257900      IF PS-ASSOC-LABOR-ASGMT-YES                                 25790099
258000         PERFORM 1700-SEND-LABOR-TO-EAI                           25800099
258100      END-IF.                                                     25810099
258200                                                                  25820099
258300*-----------------------------------------------------------------25830099
258400* CHECK TO SEE IF THIS IS A QC AUDIT, AN RF AUDIT OR A COMBINATION25840099
258500* OF QC AND RF AUDIT.                                             25850099
258600*-----------------------------------------------------------------25860099
258700 2002-COMBO-AUDIT-RTN.                                            25870099
258800*-----------------------------------------------------------------25880099
258900                                                                  25890099
259000     SET PS-PROCESS-NONE TO TRUE.                                 25900099
259100     PERFORM 5500-CHECK-PRMPTED-QC-CRTN.                          25910099
259200     PERFORM 5505-CHECK-PRMPTED-RF-CRTN.                          25920099
259300                                                                  25930099
259400     IF  PS-PRMTED-QCAUD-CRTN-YES                                 25940099
259500     AND PS-PRMTED-RFAUD-CRTN-NO                                  25950099
259600         SET PS-PROCESS-QC  TO TRUE                               25960099
259700         PERFORM 2003-PROCESS-ONCE                                25970099
259800     ELSE                                                         25980099
259900         IF  PS-PRMTED-QCAUD-CRTN-NO                              25990099
260000         AND PS-PRMTED-RFAUD-CRTN-YES                             26000099
260100             SET PS-PROCESS-RF         TO TRUE                    26010099
260200             MOVE PV-RF-AUD-CNTL-NBR   TO SUATRN-AUD-CNTL-NBR     26020099
260300             MOVE PV-RF-CART-PRMPT-CDE TO SUT00015-CART-PRMPT-CDE 26030099
260400             PERFORM 2003-PROCESS-ONCE                            26040099
260500         ELSE                                                     26050099
260600             PERFORM 2004-PROCESS-TWICE                           26060099
260700         END-IF                                                   26070099
260800     END-IF.                                                      26080099
260900                                                                  26090099
261000*-------------------------------------------------------------    26100099
261100 2003-PROCESS-ONCE.                                               26110099
261200*-------------------------------------------------------------    26120099
261300                                                                  26130099
261400     PERFORM 5600-DELETE-TSUATRN.                                 26140099
261500     IF PS-PROCESS-QC                                             26150099
261600       PERFORM 5620-AUD-QCCRTN-COUNT                              26160099
261700       IF PV-PRMTD-QCCRTN-COUNT > 0                               26170099
261800          MOVE 'C'  TO  SUT00015-CART-PRMPT-CDE                   26180099
261900          MOVE 'I'  TO  SUT00015-AUD-STAT-CDE                     26190099
262000       ELSE                                                       26200099
262100*         MOVE 'N'  TO SUT00015-AUD-STAT-CDE                      26210099
262200          PERFORM 5660-DELETE-SUT-PO-AUD-REQ                      26220099
262300          PERFORM 5670-DELETE-TSUNAUD                             26230099
262400       END-IF                                                     26240099
262500       PERFORM 5650-UPDATE-SUT-PO-AUD-REQ                         26250099
262600     ELSE                                                         26260099
262700       PERFORM 5630-AUD-RFCRTN-COUNT                              26270099
262800       IF PV-PRMTD-RFCRTN-COUNT > 0                               26280099
262900          MOVE 'C'  TO  SUT00015-CART-PRMPT-CDE                   26290099
263000          MOVE 'I'  TO  SUT00015-AUD-STAT-CDE                     26300099
263100       ELSE                                                       26310099
263200*         MOVE 'N'  TO SUT00015-AUD-STAT-CDE                      26320099
263300          PERFORM 5660-DELETE-SUT-PO-AUD-REQ                      26330099
263400          PERFORM 5670-DELETE-TSUNAUD                             26340099
263500       END-IF                                                     26350099
263600       PERFORM 5650-UPDATE-SUT-PO-AUD-REQ                         26360099
263700     END-IF.                                                      26370099
263800                                                                  26380099
263900*-------------------------------------------------------------    26390099
264000 2004-PROCESS-TWICE.                                              26400099
264100*-------------------------------------------------------------    26410099
264200                                                                  26420099
264300** PROCESS THE QC AUDIT                                           26430099
264400     SET PS-DELETE-QC-NO  TO TRUE.                                26440099
264500     PERFORM 5600-DELETE-TSUATRN.                                 26450099
264600     PERFORM 5620-AUD-QCCRTN-COUNT.                               26460099
264700     IF PV-PRMTD-QCCRTN-COUNT > 0                                 26470099
264800        MOVE 'C'  TO SUT00015-CART-PRMPT-CDE                      26480099
264900        MOVE 'I'  TO SUT00015-AUD-STAT-CDE                        26490099
265000     ELSE                                                         26500099
265100*       MOVE 'N'  TO SUT00015-AUD-STAT-CDE                        26510099
265200        PERFORM 5660-DELETE-SUT-PO-AUD-REQ                        26520099
265300        SET PS-DELETE-QC-YES TO TRUE                              26530099
265400**      PERFORM 5670-DELETE-TSUNAUD                               26540099
265500     END-IF.                                                      26550099
265600                                                                  26560099
265700     PERFORM 5650-UPDATE-SUT-PO-AUD-REQ.                          26570099
265800                                                                  26580099
265900** PROCESS THE RF AUDIT                                           26590099
266000     MOVE SUATRN-AUD-CNTL-NBR  TO PV-HOLD-QC-AUDIT-NBR.           26600099
266100     MOVE PV-RF-AUD-CNTL-NBR   TO SUATRN-AUD-CNTL-NBR.            26610099
266200     MOVE PV-RF-CART-PRMPT-CDE TO SUT00015-CART-PRMPT-CDE.        26620099
266300                                                                  26630099
266400     PERFORM 5600-DELETE-TSUATRN.                                 26640099
266500     PERFORM 5630-AUD-RFCRTN-COUNT.                               26650099
266600     IF PV-PRMTD-RFCRTN-COUNT > 0                                 26660099
266700        MOVE 'C'  TO  SUT00015-CART-PRMPT-CDE                     26670099
266800        MOVE 'I'  TO  SUT00015-AUD-STAT-CDE                       26680099
266900     ELSE                                                         26690099
267000*       MOVE 'N'  TO SUT00015-AUD-STAT-CDE                        26700099
267100        IF PS-DELETE-QC-YES                                       26710099
267200           PERFORM 5660-DELETE-SUT-PO-AUD-REQ                     26720099
267300           PERFORM 5670-DELETE-TSUNAUD                            26730099
267400           MOVE PV-HOLD-QC-AUDIT-NBR TO SUATRN-AUD-CNTL-NBR       26740099
267500           PERFORM 5670-DELETE-TSUNAUD                            26750099
267600        END-IF                                                    26760099
267700     END-IF.                                                      26770099
267800                                                                  26780099
267900     PERFORM 5650-UPDATE-SUT-PO-AUD-REQ.                          26790099
268000                                                                  26800099
268100*-----------------------------------------------------------------26810099
268200* PACK-TO-LITE CARTONS NEED TO GO TO DISTHD TO SEE IF ANY OF THE  26820099
268300* LINES IN THE CARTON HAVE BEEN PROCESSED BY P2L. IF THEY HAVE    26830099
268400* BEEN, RECLAIM WILL NOT BE ALLOWED.                              26840099
268500*-----------------------------------------------------------------26850099
268600 2005-CHCK-4-VRFD-LINES.                                          26860099
268700     EXEC SQL                                                     26870099
268800        SELECT COUNT(*)                                           26880099
268900            INTO :PV-DB2-VE-COUNT                                 26890099
269000          FROM TSHUUPC A                                          26900099
269100            ,  TINPKSU B                                          26910099
269200            ,  TPKSLIP C                                          26920099
269300            ,  TDISTHD D                                          26930099
269400         WHERE A.SHIPT_UNT_ID    =  B.SHIPT_UNT_ID                26940099
269500           AND A.SHIPT_UNT_ID    =  :SULBXF-SHIPT-UNT-ID          26950099
269600           AND A.TRN_NBR         =  B.PO_NBR                      26960099
269700           AND A.TRN_NBR         =  :SHUUPC-TRN-NBR               26970099
269800           AND B.PO_NBR          =  C.PO_NBR                      26980099
269900           AND B.SEQ_NBR         =  C.SEQ_NBR                     26990099
270000           AND C.PO_NBR          =  D.ORD_NBR                     27000099
270100           AND C.VER_STAT_CDE    =  'A'                           27010099
270200           AND C.REC_SEQ_NBR     =  D.RCVR_SEQ_NBR                27020099
270300           AND A.TRN_LNE_NBR     =  D.ORD_LNE_NBR                 27030099
270400           AND D.RSLTS_RCVD_TMST <> '9999-09-09-09.09.09.999999'  27040099
270500     END-EXEC.                                                    27050099
270600                                                                  27060099
270700     EVALUATE TRUE                                                27070099
270800         WHEN SQLCODE = ZERO                                      27080099
270900             CONTINUE                                             27090099
271000         WHEN SQLWARN0 NOT = SPACES                               27100099
271100         WHEN SQLCODE < ZERO                                      27110099
271200         WHEN SQLCODE > ZERO                                      27120099
271300             MOVE ' 2005-CHCK-4-VRFD-LINES'     TO DP013-PARAGRAPH27130099
271400             MOVE 'CHK OF VRFD LINES '   TO DP013-MESSAGE-TEXT (1)27140099
271500             MOVE SULBXF-SHIPT-UNT-ID    TO DP013-MESSAGE-TEXT (2)27150099
271600             MOVE SQLCA                  TO DP013-SQLCA           27160099
271700             MOVE 'TSHUUPC '           TO DP013-DB2-TABLE-NAME (1)27170099
271800             SET DP013-DB2-ABEND       TO TRUE                    27180099
271900             SET DP013-ROLLBACK        TO TRUE                    27190099
272000             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               27200099
272100             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           27210099
272200             MOVE SPACES                    TO  AMSGLN2O          27220099
272300             MOVE -1                     TO ACARTNL               27230099
272400             MOVE PV-CARTON-NBR          TO ACARTNO               27240099
272500             PERFORM 8100-SEND-DATA-ONLY                          27250099
272600             PERFORM 8200-RETURN-TRANID                           27260099
272700     END-EVALUATE.                                                27270099
272800/                                                                 27280099
272900******************************************************************27290099
273000* 2010-SEL-AUTO-DIRECTIVE                                        *27300099
273100*     DETERMINE AUTO CONVEYER MODE                               *27310099
273200*     'N' = NO DIRECTIVES                                        *27320099
273300*     'E' = ISSUED FOR EXCEPTIONS                                *27330099
273400*     'A' = ISSUED FOR ALL CARTONS                               *27340099
273500******************************************************************27350099
273600 2010-SEL-AUTO-DIRECTIVE.                                         27360099
273700                                                                  27370099
273800     MOVE PC033-OPER-UNT-ID TO DK-OPER-UNT-ID.                    27380099
273900                                                                  27390099
274000     EXEC SQL                                                     27400099
274100         SELECT FUNC_TXT                                          27410099
274200           INTO :WS-AUTOCY-DIRECTIVE-MODE                         27420099
274300           FROM TKRPRPM                                           27430099
274400          WHERE INTFC_SYS_CDE        = 'KHL'                      27440099
274500            AND SYS_PRC_FUNC_CDE     = 'ACAUDT'                   27450099
274600            AND FUNC_PRC_STAT_CDE    = 'AC'                       27460099
274700            AND FUNC_BEG_TMST       <=  CURRENT TIMESTAMP         27470099
274800            AND FUNC_END_TMST       >=  CURRENT TIMESTAMP         27480099
274900            AND LOC_ID               =  :DK-OPER-UNT-ID           27490099
275000     END-EXEC                                                     27500099
275100                                                                  27510099
275200     EVALUATE TRUE                                                27520099
275300       WHEN SQLCODE     = ZERO                                    27530099
275400           CONTINUE                                               27540099
275500       WHEN SQLCODE NOT = ZERO                                    27550099
275600           MOVE '2010-SEL-AUTO-DIRECTIVE'                         27560099
275700               TO DP013-PARAGRAPH                                 27570099
275800           MOVE 'AUTO CONVEYOR DIRECTIVE MODE NOT FOUND'          27580099
275900               TO DP013-MESSAGE-TEXT (1)                          27590099
276000           MOVE SQLCA                  TO DP013-SQLCA             27600099
276100           MOVE 'TKRPRPM'              TO DP013-DB2-TABLE-NAME (1)27610099
276200           SET DP013-DB2-ABEND         TO TRUE                    27620099
276300           SET DP013-NO-ROLLBACK       TO TRUE                    27630099
276400           PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                 27640099
276500           MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O             27650099
276600           MOVE SPACES                    TO AMSGLN2O             27660099
276700           PERFORM 8100-SEND-DATA-ONLY                            27670099
276800           PERFORM 8200-RETURN-TRANID                             27680099
276900     END-EVALUATE.                                                27690099
277000/                                                                 27700099
277100******************************************************************27710099
277200* 2020-SEL-CARTON-DIRECTIVE                                      *27720099
277300******************************************************************27730099
277400 2020-SEL-CARTON-DIRECTIVE.                                       27740099
277500                                                                  27750099
277600     EXEC SQL                                                     27760099
277700         SELECT DT1.BRCDE_NBR                                     27770099
277800               ,DT1.OPER_UNT_ID                                   27780099
277900               ,DT1.DIRV_RSN_CDE                                  27790099
278000               ,DT1.AUD_CNTL_NBR                                  27800099
278100               ,DT1.SHIPT_UNT_ID                                  27810099
278200               ,DT1.AUD_STAT_CDE                                  27820099
278300               ,DT1.PO_NBR                                        27830099
278400               ,DT1.RCVR_SEQ_NBR                                  27840099
278500               ,DT1.PO_LNE_NBR                                    27850099
278600               ,DT1.PREPK_ID                                      27860099
278700               ,DT1.STR_NBR                                       27870099
278800               ,DT1.LGCL_LOC_NM                                   27880099
278900               ,DT1.CASI_CDE                                      27890099
279000               ,DT1.CART_STAT_CDE                                 27900099
279100               ,DT1.AUD_FALR_RSN_NM                               27910099
279200               ,DT1.STR_ZN_ID                                     27920099
279300               ,DT1.SEASET_YR                                     27930099
279400               ,DT1.SEASET_SHRT_NM                                27940099
279500         INTO  :SUT00102-BRCDE-NBR                                27950099
279600              ,:SUT00102-OPER-UNT-ID                              27960099
279700              ,:SUT00102-DIRV-RSN-CDE                             27970099
279800              ,:SUT00102-AUD-CNTL-NBR                             27980099
279900              ,:SUT00102-SHIPT-UNT-ID                             27990099
280000              ,:SUT00102-AUD-STAT-CDE                             28000099
280100              ,:SUT00102-PO-NBR                                   28010099
280200              ,:SUT00102-RCVR-SEQ-NBR                             28020099
280300              ,:SUT00102-PO-LNE-NBR                               28030099
280400              ,:SUT00102-PREPK-ID                                 28040099
280500              ,:SUT00102-STR-NBR                                  28050099
280600              ,:SUT00102-LGCL-LOC-NM                              28060099
280700              ,:SUT00102-CASI-CDE                                 28070099
280800              ,:SUT00102-CART-STAT-CDE                            28080099
280900              ,:SUT00102-AUD-FALR-RSN-NM                          28090099
281000              ,:SUT00102-STR-ZN-ID                                28100099
281100              ,:SUT00102-SEASET-YR                                28110099
281200              ,:SUT00102-SEASET-SHRT-NM                           28120099
281300         FROM   SUT_CART_DIRV_TRKG  DT1                           28130099
281400         WHERE  DT1.BRCDE_NBR      = :DK-BRCDE-NBR                28140099
281500           AND  DT1.CRE_TMST =                                    28150099
281600                   (                                              28160099
281700                    SELECT MAX(CRE_TMST)                          28170099
281800                    FROM   SUT_CART_DIRV_TRKG  DT2                28180099
281900                    WHERE  DT2.BRCDE_NBR     =  DT1.BRCDE_NBR     28190099
282000                   )                                              28200099
282100     END-EXEC                                                     28210099
282200                                                                  28220099
282300     EVALUATE TRUE                                                28230099
282400       WHEN SQLCODE     = ZERO                                    28240099
282500            SET PS-DIRECTIVE-FOUND TO TRUE                        28250099
282600       WHEN SQLCODE     = +100                                    28260099
282700            SET PS-DIRECTIVE-NOTFOUND TO TRUE                     28270099
282800       WHEN OTHER                                                 28280099
282900             MOVE '2020-SEL-CARTON-DIRECTIVE  '                   28290099
283000                 TO DP013-PARAGRAPH                               28300099
283100             MOVE 'SELECT FAILED'                                 28310099
283200                 TO DP013-MESSAGE-TEXT (1)                        28320099
283300             MOVE SQLCA            TO DP013-SQLCA                 28330099
283400             MOVE 'SUT_CART_DIRV_TRKG'                            28340099
283500                 TO DP013-DB2-TABLE-NAME (1)                      28350099
283600             SET DP013-DB2-ABEND   TO TRUE                        28360099
283700             SET DP013-ROLLBACK    TO TRUE                        28370099
283800             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               28380099
283900             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           28390099
284000             MOVE SPACES                    TO AMSGLN2O           28400099
284100             MOVE -1                        TO ACARTNL            28410099
284200             MOVE PV-CARTON-NBR             TO ACARTNO            28420099
284300             PERFORM 8100-SEND-DATA-ONLY                          28430099
284400             PERFORM 8200-RETURN-TRANID                           28440099
284500     END-EVALUATE.                                                28450099
284600/                                                                 28460099
284700******************************************************************28470099
284800* 2030-BUILD-REQUEST                                             *28480099
284900******************************************************************28490099
285000 2030-BUILD-REQUEST.                                              28500099
285100                                                                  28510099
285200     SET  SU090-SUCCESS           TO TRUE.                        28520099
285300                                                                  28530099
285400     INITIALIZE                      SU090-ERR-PROGRAM            28540099
285500                                     SU090-ERR-PARAGRAPH          28550099
285600                                     SU090-SQLCODE                28560099
285700                                     SU090-MQ-COND-CODE           28570099
285800                                     SU090-MQ-REAS-CODE           28580099
285900                                     SU090-MQ-REAS-TXT.           28590099
286000                                                                  28600099
286100     MOVE PC-CURRENT-PROGRAM-NAME TO SU090-CALLING-PGM.           28610099
286200     SET  SU090-ONLINE            TO TRUE.                        28620099
286300     MOVE SUT00102-OPER-UNT-ID    TO SU090-OPER-UNT-ID.           28630099
286400     SET  SU090-ADD-ACTION        TO TRUE.                        28640099
286500     SET  SU090-CARTON-DIRECTIVE  TO TRUE.                        28650099
286600     MOVE 'RCL'                   TO SU090-DIRV-RSN-CDE.          28660099
286700                                                                  28670099
286800     EVALUATE TRUE                                                28680099
286900         WHEN SUT00102-SHIPT-UNT-ID = ZEROS                       28690099
287000             MOVE 'P' TO SU090-BRCDE-TYP-CDE                      28700099
287100         WHEN OTHER                                               28710099
287200             MOVE 'S' TO SU090-BRCDE-TYP-CDE                      28720099
287300     END-EVALUATE.                                                28730099
287400                                                                  28740099
287500     MOVE SUT00102-SHIPT-UNT-ID TO SU090-SML-BRCDE-NBR.           28750099
287600     MOVE SUT00102-BRCDE-NBR    TO SU090-P2L-BRCDE-NBR.           28760099
287700     MOVE SUT00102-PO-NBR       TO SU090-PO-NBR.                  28770099
287800     MOVE SUT00102-PO-LNE-NBR   TO SU090-PO-LNE-NBR.              28780099
287900     MOVE SUT00102-PREPK-ID     TO SU090-PO-PREPK-ID.             28790099
288000     MOVE SUT00102-RCVR-SEQ-NBR TO SU090-RCVR-SEQ-NBR.            28800099
288100                                                                  28810099
288200     EVALUATE SUT00102-AUD-STAT-CDE                               28820099
288300         WHEN 'F'                                                 28830099
288400             MOVE 'R' TO SU090-CASI-CDE                           28840099
288500         WHEN 'I'                                                 28850099
288600             MOVE 'U' TO SU090-CASI-CDE                           28860099
288700         WHEN 'N'                                                 28870099
288800             MOVE ' ' TO SU090-CASI-CDE                           28880099
288900         WHEN 'P'                                                 28890099
289000             MOVE ' ' TO SU090-CASI-CDE                           28900099
289100         WHEN OTHER                                               28910099
289200             MOVE ' ' TO SU090-CASI-CDE                           28920099
289300     END-EVALUATE.                                                28930099
289400                                                                  28940099
289500     MOVE 'I'                      TO SU090-CART-STAT-CDE.        28950099
289600     MOVE SUT00102-AUD-CNTL-NBR    TO SU090-AUD-CNTL-NBR.         28960099
289700     MOVE SUT00102-AUD-STAT-CDE    TO SU090-AUD-STAT-CDE.         28970099
289800     MOVE SUT00102-AUD-FALR-RSN-NM TO SU090-AUD-FAIL-RSN.         28980099
289900     MOVE SUT00102-STR-ZN-ID       TO SU090-STR-ZN.               28990099
290000     MOVE SUT00102-SEASET-YR       TO SU090-SEASET-YR.            29000099
290100     MOVE SUT00102-SEASET-SHRT-NM  TO SU090-SEASET-CDE.           29010099
290200     MOVE SUT00102-STR-NBR         TO SU090-STR-NBR.              29020099
290300     MOVE PC033-USER-ID            TO SU090-ASSOC-ID.             29030099
290400/                                                                 29040099
290500******************************************************************29050099
290600* 2050-CALL-DIRECTIVE-REQUEST                                    *29060099
290700*     CALL PGM SUKUT129. CHECK FOR ERRORS UPON RETURN            *29070099
290800******************************************************************29080099
290900 2050-CALL-DIRECTIVE-REQUEST.                                     29090099
291000                                                                  29100099
291100     INSPECT SU090-DG-REQUEST-COMMAREA                            29110099
291200         REPLACING ALL LOW-VALUES BY '?'.                         29120099
291300                                                                  29130099
291400     CALL PC-SUKUT129 USING DFHEIBLK                              29140099
291500                            SU090-COMMAREA                        29150099
291600                            SU090-DG-REQUEST-COMMAREA.            29160099
291700                                                                  29170099
291800     IF ( SU090-SUCCESS )                                         29180099
291900         CONTINUE                                                 29190099
292000     ELSE                                                         29200099
292100         MOVE '2050-CALL-DIRECTIVE-REQUEST'                       29210099
292200           TO DP013-PARAGRAPH                                     29220099
292300         MOVE PC-DIRECTIVE-NOT-SENT-MSG                           29230099
292400           TO DP013-MESSAGE-TEXT (1)                              29240099
292500         STRING 'RET-CODE = '   SU090-RET-CODE                    29250099
292600                ',PGM = '       SU090-ERR-PROGRAM                 29260099
292700                ',PARAGRAPH = ' SU090-ERR-PARAGRAPH               29270099
292800                ',ASSOC = '     SU090-ASSOC-ID                    29280099
292900                ',SML = '       SU090-SML-BRCDE-NBR               29290099
293000                ',P2L = '       SU090-P2L-BRCDE-NBR               29300099
293100             DELIMITED BY SIZE INTO DP013-MESSAGE-TEXT (2)        29310099
293200         PERFORM 9905-WRITE-CSSL-LOG                              29320099
293300         EVALUATE TRUE                                            29330099
293400             WHEN SU090-PARAMETER-ERROR                           29340099
293500                 MOVE PC-DG-ERROR-PARM TO AMSGLN1O                29350099
293600             WHEN SU090-DB2-ERROR                                 29360099
293700                 MOVE PC-DG-ERROR-DB2  TO AMSGLN1O                29370099
293800             WHEN SU090-MQ-ERROR                                  29380099
293900                 MOVE PC-DG-ERROR-MQ   TO AMSGLN1O                29390099
294000             WHEN SU090-OTHER-ERROR                               29400099
294100                 MOVE PC-DG-ERROR-OTHR TO AMSGLN1O                29410099
294200         END-EVALUATE                                             29420099
294300         MOVE SPACES                 TO AMSGLN2O                  29430099
294400         PERFORM 8100-SEND-DATA-ONLY                              29440099
294500         PERFORM 8200-RETURN-TRANID                               29450099
294600     END-IF.                                                      29460099
294700/                                                                 29470099
294800*-------------------------------------------------------------    29480099
294900 2100-XCTL-TO-SELECTED-PROGRAM.                                   29490099
295000*-------------------------------------------------------------    29500099
295100     SET PC033-INITIALIZE-SCREEN       TO  TRUE.                  29510099
295200     MOVE PC-CURRENT-PROGRAM-NAME      TO  PC033-LAST-PROGRAM.    29520099
295300     MOVE LENGTH OF CA-COMMAREA        TO  PV-COMMAREA-LENGTH.    29530099
295400                                                                  29540099
295500     EXEC CICS                                                    29550099
295600         XCTL                                                     29560099
295700             PROGRAM   (PV-TRANSFER-PROGRAM)                      29570099
295800             COMMAREA  (CA-COMMAREA)                              29580099
295900             LENGTH    (PV-COMMAREA-LENGTH)                       29590099
296000             RESP      (PV-CICS-RESPONSE)                         29600099
296100     END-EXEC.                                                    29610099
296200                                                                  29620099
296300     EVALUATE TRUE                                                29630099
296400         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 29640099
296500              CONTINUE                                            29650099
296600         WHEN OTHER                                               29660099
296700              MOVE '2100-XCTL-TO-SELECTED-PROGRAM'                29670099
296800                                     TO DP013-PARAGRAPH           29680099
296900              MOVE 'UNABLE TO XCTL THE FOLLOWING PROGRAM: '       29690099
297000                                     TO DP013-MESSAGE-TEXT (1)    29700099
297100              MOVE PV-TRANSFER-PROGRAM                            29710099
297200                                     TO DP013-MESSAGE-TEXT (2)    29720099
297300              SET DP013-CICS-ABEND   TO TRUE                      29730099
297400              SET DP013-ROLLBACK  TO TRUE                         29740099
297500              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              29750099
297600              MOVE PC-TRANS-UNAVAILABLE-MSG                       29760099
297700                                     TO AMSGLN1O                  29770099
297800              MOVE SPACES            TO AMSGLN2O                  29780099
297900              SET PC033-PROCESS-SCREEN  TO TRUE                   29790099
298000              MOVE PV-CARTON-NBR        TO  ACARTNO               29800099
298100              PERFORM 8100-SEND-DATA-ONLY                         29810099
298200              PERFORM 8200-RETURN-TRANID                          29820099
298300     END-EVALUATE.                                                29830099
298400                                                                  29840099
298500*-------------------------------------------------------------    29850099
298600 2150-XCTL-TO-HELP.                                               29860099
298700*-------------------------------------------------------------    29870099
298800     MOVE LENGTH OF PC192-COMMAREA    TO PV-COMMAREA-LENGTH       29880099
298900                                                                  29890099
299000     EXEC CICS                                                    29900099
299100         XCTL                                                     29910099
299200             PROGRAM   (PV-TRANSFER-PROGRAM)                      29920099
299300             COMMAREA  (PC192-COMMAREA)                           29930099
299400             LENGTH    (PV-COMMAREA-LENGTH)                       29940099
299500             RESP      (PV-CICS-RESPONSE)                         29950099
299600     END-EXEC.                                                    29960099
299700                                                                  29970099
299800     EVALUATE TRUE                                                29980099
299900         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 29990099
300000              CONTINUE                                            30000099
300100         WHEN OTHER                                               30010099
300200             MOVE '2150-XCTL-TO-HELP' TO DP013-PARAGRAPH          30020099
300300             MOVE 'PCKRF859 - UNABLE TO XCTL TO PROGRAM: '        30030099
300400                                      TO DP013-MESSAGE-TEXT (1)   30040099
300500             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   30050099
300600             SET DP013-CICS-ABEND                                 30060099
300700                 DP013-ROLLBACK       TO TRUE                     30070099
300800             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               30080099
300900             MOVE PC-TRANS-UNAVAILABLE-MSG                        30090099
301000                                      TO AMSGLN1O                 30100099
301100             MOVE SPACES              TO AMSGLN2O                 30110099
301200             SET PC033-PROCESS-SCREEN TO TRUE                     30120099
301300             MOVE -1                  TO ACARTNL                  30130099
301400             PERFORM 8000-SEND-MAP                                30140099
301500             PERFORM 8200-RETURN-TRANID                           30150099
301600     END-EVALUATE.                                                30160099
301700                                                                  30170099
301800*-------------------------------------------------------------    30180099
301900 2300-CHECK-TABLES.                                               30190099
302000*-------------------------------------------------------------    30200099
302100     MOVE PV-CTN-N                TO SUT00024-SHIPT-UNT-ID        30210099
302200                                     SUT00028-SHIPT-UNT-ID        30220099
302300                                     DK-CTN.                      30230099
302400     SET PC033-LABEL-FOUND        TO TRUE                         30240099
302500                                                                  30250099
302600     PERFORM 2310-SELECT-OTBND-CART.                              30260099
302700                                                                  30270099
302800     EVALUATE TRUE                                                30280099
302900                                                                  30290099
303000     WHEN PS-OTBND-CART-YES                                       30300099
303100         EVALUATE TRUE                                            30310099
303200             WHEN SUT00024-ACTV-IND = 'N'                         30320099
303300                 SET PS-ERROR                                     30330099
303400                     PC033-INITIALIZE-SCREEN TO TRUE              30340099
303500                 MOVE 1                      TO PC033-PGM-MSG-NBR 30350099
303600                 MOVE 'ALREADY INACTIVE  '   TO AMSGLN1O          30360099
303700                 MOVE SPACES                 TO AMSGLN2O          30370099
303800             WHEN SUT00024-CART-SRC-CDE = 'SMO'                   30380099
303900                SET PS-ERROR                                      30390099
304000                    PC033-INITIALIZE-SCREEN  TO TRUE              30400099
304100                MOVE 20               TO PC033-PGM-MSG-NBR        30410099
304200             WHEN SUT00024-CART-SRC-CDE = 'P2L'                   30420099
304300             WHEN SUT00024-CART-SRC-CDE = 'JWL'                   30430099
304400                SET PS-ERROR                                      30440099
304500                    PC033-INITIALIZE-SCREEN  TO TRUE              30450099
304600                MOVE 23          TO PC033-PGM-MSG-NBR             30460099
304700             WHEN SUT00024-CART-SRC-CDE = 'RDM'                   30470099
304800                SET PS-ERROR                                      30480099
304900                    PC033-INITIALIZE-SCREEN   TO TRUE             30490099
305000                MOVE 24               TO PC033-PGM-MSG-NBR        30500099
305100             WHEN SUT00024-CART-SRC-CDE = 'MSC'                   30510099
305200                PERFORM 2360-SELECT-COUNT-OTBND-UPC               30520099
305300                IF PV-OTBND-UPC-COUNT > 0                         30530099
305400                     SET PS-ERROR                                 30540099
305500                         PC033-INITIALIZE-SCREEN   TO TRUE        30550099
305600                     MOVE 25               TO PC033-PGM-MSG-NBR   30560099
305700                END-IF                                            30570099
305800             WHEN SUT00024-CART-SRC-CDE = 'MST'                   30580099
305900                  AND SUT00024-ACTV-IND = 'Y'                     30590099
306000                 PERFORM 2330-COUNT-CHILDREN                      30600099
306100                 IF PV-CHILD-COUNT = ZERO                         30610099
306200                     PERFORM 2340-COUNT-CHILDREN                  30620099
306300                 END-IF                                           30630099
306400                 IF PV-CHILD-COUNT > ZERO                         30640099
306500                     SET PS-ERROR                                 30650099
306600                         PC033-INITIALIZE-SCREEN  TO TRUE         30660099
306700                     MOVE 22          TO PC033-PGM-MSG-NBR        30670099
306800                 END-IF                                           30680099
306900             WHEN SUT00024-CART-SRC-CDE = 'DMG'                   30690099
307000                SET PS-ERROR                                      30700099
307100                    PC033-INITIALIZE-SCREEN TO TRUE               30710099
307200                MOVE 32                     TO PC033-PGM-MSG-NBR  30720099
307300             WHEN OTHER                                           30730099
307400                 SET PC033-PROCESS-SCREEN   TO TRUE               30740099
307500             END-EVALUATE                                         30750099
307600                                                                  30760099
307700         PERFORM 2350-POPULATE-MAP                                30770099
307800                                                                  30780099
307900     WHEN PS-OTBND-CART-NO                                        30790099
308000         SET PS-ERROR                                             30800099
308100             PC033-INITIALIZE-SCREEN   TO TRUE                    30810099
308200         MOVE 1                        TO PC033-PGM-MSG-NBR       30820099
308300                                                                  30830099
308400     WHEN OTHER                                                   30840099
308500         PERFORM 2350-POPULATE-MAP                                30850099
308600         SET PS-ERROR                                             30860099
308700             PC033-LABEL-NOT-FOUND                                30870099
308800             PC033-INITIALIZE-SCREEN  TO TRUE                     30880099
308900         MOVE 1                       TO PC033-PGM-MSG-NBR        30890099
309000     END-EVALUATE.                                                30900099
309100                                                                  30910099
309200*-------------------------------------------------------------    30920099
309300 2310-SELECT-OTBND-CART.                                          30930099
309400*-------------------------------------------------------------    30940099
309500     EXEC SQL                                                     30950099
309600         SELECT ORGN_LOC_NBR                                      30960099
309700             ,  DEST_LOC_NBR                                      30970099
309800             ,  CART_SRC_CDE                                      30980099
309900             ,  ACTV_IND                                          30990099
310000             ,  CRE_PGM_NM                                        31000099
310100             ,  ODD_UNT_IND                                       31010099
310200             ,  TIMESTAMP (CRE_DTE, CRE_TM)                       31020099
310300         INTO   :SUT00024-ORGN-LOC-NBR                            31030099
310400             ,  :SUT00024-DEST-LOC-NBR                            31040099
310500             ,  :SUT00024-CART-SRC-CDE                            31050099
310600             ,  :SUT00024-ACTV-IND                                31060099
310700             ,  :SUT00024-CRE-PGM-NM                              31070099
310800             ,  :SUT00024-ODD-UNT-IND                             31080099
310900             ,  :DK-CARTON-TMST                                   31090099
311000         FROM   SUT_OTBND_CART                                    31100099
311100         WHERE  SHIPT_UNT_ID   = :SUT00024-SHIPT-UNT-ID           31110099
311200     END-EXEC.                                                    31120099
311300                                                                  31130099
311400     EVALUATE TRUE                                                31140099
311500         WHEN SQLCODE = ZERO                                      31150099
311600            SET PS-OTBND-CART-YES TO TRUE                         31160099
311700         WHEN SQLCODE = +100                                      31170099
311800             PERFORM 2320-SELECT-OTBND-CART2                      31180099
311900         WHEN SQLCODE = -904                                      31190099
312000         WHEN SQLCODE = -913                                      31200099
312100         WHEN SQLCODE = -911                                      31210099
312200             MOVE 1                   TO PV-ERROR-NBR             31220099
312300             PERFORM 9903-WRITE-CICS-LOG                          31230099
312400             PERFORM 9000-SOFT-ABORT                              31240099
312500         WHEN SQLWARN0 NOT = SPACES                               31250099
312600         WHEN SQLCODE NOT EQUAL ZERO                              31260099
312700             MOVE 2                   TO PV-ERROR-NBR             31270099
312800                                         PC033-ERROR-NBR          31280099
312900             PERFORM 9903-WRITE-CICS-LOG                          31290099
313000             MOVE '2310-SELECT-OTBND-CART'                        31300099
313100                                      TO PC033-PARAGRAPH          31310099
313200             MOVE 'PCKRF859 - CHECK FOR CARTON'                   31320099
313300                                      TO PC033-MESSAGE-TEXT(1)    31330099
313400             MOVE SQLCA               TO PC033-SQLCA              31340099
313500             MOVE 'SUT00024'          TO PC033-DB2-TABLE-NAME(1)  31350099
313600             SET PC033-ABEND          TO TRUE                     31360099
313700             MOVE 99                  TO PC033-PGM-MSG-NBR        31370099
313800             PERFORM 8210-XCTL-ERROR-SCREEN                       31380099
313900     END-EVALUATE.                                                31390099
314000                                                                  31400099
314100*-------------------------------------------------------------    31410099
314200 2320-SELECT-OTBND-CART2.                                         31420099
314300*-------------------------------------------------------------    31430099
314400     EXEC SQL                                                     31440099
314500         SELECT ORGN_LOC_NBR                                      31450099
314600             ,  DEST_LOC_NBR                                      31460099
314700             ,  CART_SRC_CDE                                      31470099
314800             ,  ACTV_IND                                          31480099
314900             ,  SHIPT_UNT_ID                                      31490099
315000*            ,  ORGN_CART_ID                                      31500099
315100             ,  CRE_PGM_NM                                        31510099
315200             ,  ODD_UNT_IND                                       31520099
315300             ,  TIMESTAMP (CRE_DTE, CRE_TM)                       31530099
315400         INTO   :SUT00024-ORGN-LOC-NBR                            31540099
315500             ,  :SUT00024-DEST-LOC-NBR                            31550099
315600             ,  :SUT00024-CART-SRC-CDE                            31560099
315700             ,  :SUT00024-ACTV-IND                                31570099
315800             ,  :SUT00024-SHIPT-UNT-ID                            31580099
315900*            ,  :SUT00024-ORGN-CART-ID                            31590099
316000             ,  :SUT00024-CRE-PGM-NM                              31600099
316100             ,  :SUT00024-ODD-UNT-IND                             31610099
316200             ,  :DK-CARTON-TMST                                   31620099
316300         FROM   SUT_OTBND_CART                                    31630099
316400         WHERE  ORIG_CART_ID   = :SUT00024-SHIPT-UNT-ID           31640099
316500     END-EXEC.                                                    31650099
316600                                                                  31660099
316700     EVALUATE TRUE                                                31670099
316800         WHEN SQLCODE = ZERO                                      31680099
316900            SET PS-OTBND-CART-YES TO TRUE                         31690099
317000*           MOVE SUT00024-ORGN-CART-ID TO SUT00024-SHIPT-UNT-ID   31700099
317100         WHEN SQLCODE = +100                                      31710099
317200             SET PS-OTBND-CART-NO     TO TRUE                     31720099
317300         WHEN SQLCODE = -904                                      31730099
317400         WHEN SQLCODE = -913                                      31740099
317500         WHEN SQLCODE = -911                                      31750099
317600             MOVE 1                   TO PV-ERROR-NBR             31760099
317700             PERFORM 9903-WRITE-CICS-LOG                          31770099
317800             PERFORM 9000-SOFT-ABORT                              31780099
317900         WHEN SQLWARN0 NOT = SPACES                               31790099
318000         WHEN SQLCODE NOT EQUAL ZERO                              31800099
318100             MOVE 2                   TO PV-ERROR-NBR             31810099
318200                                         PC033-ERROR-NBR          31820099
318300             PERFORM 9903-WRITE-CICS-LOG                          31830099
318400             MOVE '2320-SELECT-OTBND-CART'                        31840099
318500                                      TO PC033-PARAGRAPH          31850099
318600             MOVE 'PCKRF859 - CHECK FOR CARTON'                   31860099
318700                                      TO PC033-MESSAGE-TEXT(1)    31870099
318800             MOVE SQLCA               TO PC033-SQLCA              31880099
318900             MOVE 'SUT00024'          TO PC033-DB2-TABLE-NAME(1)  31890099
319000             SET PC033-ABEND          TO TRUE                     31900099
319100             MOVE 99                  TO PC033-PGM-MSG-NBR        31910099
319200             PERFORM 8210-XCTL-ERROR-SCREEN                       31920099
319300     END-EVALUATE.                                                31930099
319400                                                                  31940099
319500******************************************************************31950099
319600 2330-COUNT-CHILDREN.                                             31960099
319700*-------------------------------------------------------------    31970099
319800     MOVE ZERO                        TO PV-CHILD-COUNT           31980099
319900     EXEC SQL                                                     31990099
320000         SELECT COUNT(*)                                          32000099
320100         INTO   :PV-CHILD-COUNT                                   32010099
320200         FROM   SUT_OTBND_CART A                                  32020099
320300         ,      SUT_OTBND_CART B                                  32030099
320400         WHERE  A.PRNT_CART_ID = :SUT00024-SHIPT-UNT-ID           32040099
320500           AND  B.PRNT_CART_ID = A.SHIPT_UNT_ID                   32050099
320600           AND  B.MSTR_CART_IND = 'N'                             32060099
320700     END-EXEC                                                     32070099
320800                                                                  32080099
320900      EVALUATE TRUE                                               32090099
321000          WHEN SQLCODE = ZERO                                     32100099
321100          WHEN SQLCODE = +100                                     32110099
321200             CONTINUE                                             32120099
321300         WHEN SQLCODE = -904                                      32130099
321400         WHEN SQLCODE = -913                                      32140099
321500         WHEN SQLCODE = -911                                      32150099
321600             MOVE 13                  TO PV-ERROR-NBR             32160099
321700             PERFORM 9903-WRITE-CICS-LOG                          32170099
321800             PERFORM 9000-SOFT-ABORT                              32180099
321900          WHEN SQLWARN0 NOT = SPACES                              32190099
322000          WHEN SQLCODE < ZERO                                     32200099
322100          WHEN SQLCODE > ZERO                                     32210099
322200             MOVE 14                  TO PV-ERROR-NBR             32220099
322300                                         PC033-ERROR-NBR          32230099
322400             PERFORM 9903-WRITE-CICS-LOG                          32240099
322500             MOVE '2330-COUNT-CHILDREN'                           32250099
322600                                      TO PC033-PARAGRAPH          32260099
322700             MOVE 'COUNT CHILD CARTONS'                           32270099
322800                                      TO PC033-MESSAGE-TEXT (1)   32280099
322900             MOVE DK-CTN              TO PC033-MESSAGE-TEXT (2)   32290099
323000             MOVE SQLCA               TO PC033-SQLCA              32300099
323100             MOVE 'SUT00024'          TO PC033-DB2-TABLE-NAME(1)  32310099
323200             SET PC033-ABEND          TO TRUE                     32320099
323300             MOVE 99                  TO PC033-PGM-MSG-NBR        32330099
323400             PERFORM 8210-XCTL-ERROR-SCREEN                       32340099
323500                                                                  32350099
323600      END-EVALUATE.                                               32360099
323700                                                                  32370099
323800*-------------------------------------------------------------    32380099
323900 2340-COUNT-CHILDREN.                                             32390099
324000*-------------------------------------------------------------    32400099
324100     MOVE ZERO                        TO PV-CHILD-COUNT           32410099
324200     EXEC SQL                                                     32420099
324300         SELECT COUNT(*)                                          32430099
324400         INTO   :PV-CHILD-COUNT                                   32440099
324500         FROM   SUT_OTBND_CART                                    32450099
324600         WHERE  PRNT_CART_ID = :SUT00024-SHIPT-UNT-ID             32460099
324700           AND  MSTR_CART_IND = 'N'                               32470099
324800     END-EXEC                                                     32480099
324900                                                                  32490099
325000      EVALUATE TRUE                                               32500099
325100          WHEN SQLCODE = ZERO                                     32510099
325200          WHEN SQLCODE = +100                                     32520099
325300             CONTINUE                                             32530099
325400         WHEN SQLCODE = -904                                      32540099
325500         WHEN SQLCODE = -913                                      32550099
325600         WHEN SQLCODE = -911                                      32560099
325700             MOVE 15                  TO PV-ERROR-NBR             32570099
325800             PERFORM 9903-WRITE-CICS-LOG                          32580099
325900             PERFORM 9000-SOFT-ABORT                              32590099
326000          WHEN SQLWARN0 NOT = SPACES                              32600099
326100          WHEN SQLCODE < ZERO                                     32610099
326200          WHEN SQLCODE > ZERO                                     32620099
326300             MOVE 16                  TO PV-ERROR-NBR             32630099
326400                                         PC033-ERROR-NBR          32640099
326500             PERFORM 9903-WRITE-CICS-LOG                          32650099
326600             MOVE '2340-COUNT-CHILDREN'                           32660099
326700                                      TO PC033-PARAGRAPH          32670099
326800             MOVE 'COUNT CHILD CARTONS'                           32680099
326900                                      TO PC033-MESSAGE-TEXT (1)   32690099
327000             MOVE DK-CTN              TO PC033-MESSAGE-TEXT (2)   32700099
327100             MOVE SQLCA               TO PC033-SQLCA              32710099
327200             MOVE 'SUT00024'          TO PC033-DB2-TABLE-NAME(1)  32720099
327300             SET PC033-ABEND          TO TRUE                     32730099
327400             MOVE 99                  TO PC033-PGM-MSG-NBR        32740099
327500             PERFORM 8210-XCTL-ERROR-SCREEN                       32750099
327600                                                                  32760099
327700      END-EVALUATE.                                               32770099
327800                                                                  32780099
327900*-------------------------------------------------------------    32790099
328000 2350-POPULATE-MAP.                                               32800099
328100*-------------------------------------------------------------    32810099
328200     MOVE PC033-CARTON                TO ACARTNO                  32820099
328300                                                                  32830099
328400     IF PS-OTBND-CART-YES                                         32840099
328500         PERFORM 2375-SELECT-OTBND-UPC                            32850099
328600         MOVE PC033-PO-NBR            TO PV-PO-OUT                32860099
328700         MOVE PC033-RCVR-SEQ-NBR      TO PV-RCVR-OUT              32870099
328800         MOVE PV-PO-RCVR              TO APORCVRO                 32880099
328900     ELSE                                                         32890099
329000         MOVE ZERO                    TO PV-PO-OUT                32900099
329100                                         PC033-PO-NBR             32910099
329200         MOVE ZERO                    TO PV-RCVR-OUT              32920099
329300                                         PC033-RCVR-SEQ-NBR       32930099
329400         MOVE PV-PO-RCVR              TO APORCVRO                 32940099
329500     END-IF.                                                      32950099
329600                                                                  32960099
329700*-------------------------------------------------------------    32970099
329800 2355-POPULATE-MAP-INBOUND.                                       32980099
329900*-------------------------------------------------------------    32990099
330000     MOVE PC033-CARTON    TO ACARTNO.                             33000099
330100     MOVE PV-CTN-N        TO SHUUPC-SHIPT-UNT-ID.                 33010099
330200                                                                  33020099
330300     INITIALIZE  SHUUPC-TRN-NBR                                   33030099
330400                 SHUUPC-TRN-LNE-NBR                               33040099
330500                 SHUUPC-RCVR-SEQ-NBR.                             33050099
330600                                                                  33060099
330700     EXEC SQL                                                     33070099
330800         SELECT DISTINCT                                          33080099
330900                TRN_NBR                                           33090099
331000              , TRN_LNE_NBR                                       33100099
331100              , RCVR_SEQ_NBR                                      33110099
331200         INTO   :SHUUPC-TRN-NBR                                   33120099
331300              , :SHUUPC-TRN-LNE-NBR                               33130099
331400              , :SHUUPC-RCVR-SEQ-NBR                              33140099
331500         FROM   TSHUUPC                                           33150099
331600         WHERE  SHIPT_UNT_ID   = :SHUUPC-SHIPT-UNT-ID             33160099
331700     END-EXEC.                                                    33170099
331800*                                                                 33180099
331900     EVALUATE TRUE                                                33190099
332000         WHEN SQLCODE = ZERO                                      33200099
332100         WHEN SQLCODE = -811                                      33210099
332200             MOVE SHUUPC-TRN-NBR      TO PV-PO-OUT                33220099
332300                                         PC033-PO-NBR             33230099
332400             MOVE SHUUPC-RCVR-SEQ-NBR TO PV-RCVR-OUT              33240099
332500                                         PC033-RCVR-SEQ-NBR       33250099
332600             MOVE PV-PO-RCVR          TO APORCVRO                 33260099
332700             MOVE SHUUPC-TRN-LNE-NBR  TO PC033-PO-LINE-NBR        33270099
332800         WHEN SQLCODE = +100                                      33280099
332900             SET  PC033-NO-LINE       TO TRUE                     33290099
333000             MOVE ZERO                TO PC033-PO-NBR             33300099
333100                                         PC033-PO-LINE-NBR        33310099
333200                                         PC033-RCVR-SEQ-NBR       33320099
333300         WHEN SQLCODE = -904                                      33330099
333400         WHEN SQLCODE = -913                                      33340099
333500         WHEN SQLCODE = -911                                      33350099
333600             MOVE 11                  TO PV-ERROR-NBR             33360099
333700             PERFORM 9903-WRITE-CICS-LOG                          33370099
333800             PERFORM 9000-SOFT-ABORT                              33380099
333900         WHEN SQLWARN0 NOT = SPACES                               33390099
334000         WHEN SQLCODE NOT EQUAL ZERO                              33400099
334100             MOVE 12                  TO PV-ERROR-NBR             33410099
334200                                         PC033-ERROR-NBR          33420099
334300             PERFORM 9903-WRITE-CICS-LOG                          33430099
334400             MOVE '2355-POPULATE-MAP-INBOUND' TO PC033-PARAGRAPH  33440099
334500             MOVE 'PCKRF859 - GET PO NBR' TO PC033-MESSAGE-TEXT(1)33450099
334600             MOVE SHUUPC-SHIPT-UNT-ID     TO PC033-MESSAGE-TEXT(2)33460099
334700             MOVE SQLCA                   TO PC033-SQLCA          33470099
334800             MOVE 'TSHUUPC '            TO PC033-DB2-TABLE-NAME(1)33480099
334900             SET PC033-ABEND            TO TRUE                   33490099
335000             MOVE 99                    TO PC033-PGM-MSG-NBR      33500099
335100             PERFORM 8210-XCTL-ERROR-SCREEN                       33510099
335200     END-EVALUATE.                                                33520099
335300                                                                  33530099
335400*-------------------------------------------------------------    33540099
335500 2360-SELECT-COUNT-OTBND-UPC.                                     33550099
335600*-------------------------------------------------------------    33560099
335700     EXEC SQL                                                     33570099
335800         SELECT COUNT(*)                                          33580099
335900         INTO   :PV-OTBND-UPC-COUNT                               33590099
336000         FROM   SUT_OTBND_UPC                                     33600099
336100         WHERE  SHIPT_UNT_ID   = :SUT00024-SHIPT-UNT-ID           33610099
336200           AND  SHPD_UNT_QTY   > 0                                33620099
336300     END-EXEC.                                                    33630099
336400*                                                                 33640099
336500     EVALUATE TRUE                                                33650099
336600         WHEN SQLCODE = ZERO                                      33660099
336700         WHEN SQLCODE = +100                                      33670099
336800             CONTINUE                                             33680099
336900         WHEN SQLCODE = -904                                      33690099
337000         WHEN SQLCODE = -913                                      33700099
337100         WHEN SQLCODE = -911                                      33710099
337200             MOVE 17                  TO PV-ERROR-NBR             33720099
337300             PERFORM 9903-WRITE-CICS-LOG                          33730099
337400             PERFORM 9000-SOFT-ABORT                              33740099
337500         WHEN SQLWARN0 NOT = SPACES                               33750099
337600         WHEN SQLCODE NOT EQUAL ZERO                              33760099
337700             MOVE 18                  TO PV-ERROR-NBR             33770099
337800                                         PC033-ERROR-NBR          33780099
337900             PERFORM 9903-WRITE-CICS-LOG                          33790099
338000             MOVE '2360-SELECT-COUNT-OTBND-UPC'                   33800099
338100                                        TO PC033-PARAGRAPH        33810099
338200             MOVE 'PCKRF859 - GET PO NBR        '                 33820099
338300                                        TO PC033-MESSAGE-TEXT(1)  33830099
338400             MOVE SUT00024-SHIPT-UNT-ID TO PC033-MESSAGE-TEXT(2)  33840099
338500             MOVE SQLCA               TO PC033-SQLCA              33850099
338600             MOVE 'SUT00028'          TO PC033-DB2-TABLE-NAME(1)  33860099
338700             SET PC033-ABEND          TO TRUE                     33870099
338800             MOVE 99                  TO PC033-PGM-MSG-NBR        33880099
338900             PERFORM 8210-XCTL-ERROR-SCREEN                       33890099
339000     END-EVALUATE.                                                33900099
339100                                                                  33910099
339200*-------------------------------------------------------------    33920099
339300 2375-SELECT-OTBND-UPC.                                           33930099
339400*-------------------------------------------------------------    33940099
339500     INITIALIZE  SUT00028-TRN-NBR                                 33950099
339600                 SUT00028-TRN-LNE-NBR                             33960099
339700                 SUT00028-RCVR-SEQ-NBR.                           33970099
339800                                                                  33980099
339900     EXEC SQL                                                     33990099
340000         SELECT DISTINCT                                          34000099
340100                TRN_NBR                                           34010099
340200              , TRN_LNE_NBR                                       34020099
340300              , RCVR_SEQ_NBR                                      34030099
340400         INTO   :SUT00028-TRN-NBR                                 34040099
340500              , :SUT00028-TRN-LNE-NBR                             34050099
340600              , :SUT00028-RCVR-SEQ-NBR                            34060099
340700         FROM   SUT_OTBND_UPC                                     34070099
340800         WHERE  SHIPT_UNT_ID   = :SUT00024-SHIPT-UNT-ID           34080099
340900     END-EXEC.                                                    34090099
341000*                                                                 34100099
341100     EVALUATE TRUE                                                34110099
341200         WHEN SQLCODE = ZERO                                      34120099
341300             SET PC033-SINGLE-LINE    TO TRUE                     34130099
341400             IF SUT00024-CART-SRC-CDE = 'FXR'                     34140099
341500                 MOVE ZERO            TO PC033-PO-NBR             34150099
341600                                         PC033-PO-LINE-NBR        34160099
341700                                         PC033-RCVR-SEQ-NBR       34170099
341800             ELSE                                                 34180099
341900                 MOVE SUT00028-TRN-NBR TO PC033-PO-NBR            34190099
342000                 MOVE SUT00028-TRN-LNE-NBR   TO PC033-PO-LINE-NBR 34200099
342100                 MOVE SUT00028-RCVR-SEQ-NBR  TO PC033-RCVR-SEQ-NBR34210099
342200                                                DK-RCVR-SEQ-NBR   34220099
342300                 IF SUT00028-RCVR-SEQ-NBR = 0                     34230099
342400                    PERFORM 2385-GET-RCVR-NBR                     34240099
342500                 END-IF                                           34250099
342600             END-IF                                               34260099
342700         WHEN SQLCODE = -811                                      34270099
342800             IF SUT00024-CART-SRC-CDE = 'FXR'                     34280099
342900                 MOVE ZERO            TO PC033-PO-NBR             34290099
343000                                         PC033-PO-LINE-NBR        34300099
343100                                         PC033-RCVR-SEQ-NBR       34310099
343200             ELSE                                                 34320099
343300                 MOVE SUT00028-TRN-NBR TO PC033-PO-NBR            34330099
343400                 MOVE SUT00028-RCVR-SEQ-NBR TO PC033-RCVR-SEQ-NBR 34340099
343500                                               DK-RCVR-SEQ-NBR    34350099
343600                 MOVE SUT00028-TRN-LNE-NBR  TO PC033-PO-LINE-NBR  34360099
343700                 IF SUT00028-RCVR-SEQ-NBR = 0                     34370099
343800                    PERFORM 2385-GET-RCVR-NBR                     34380099
343900                 END-IF                                           34390099
344000             END-IF                                               34400099
344100             SET PC033-MULTI-LINE     TO TRUE                     34410099
344200         WHEN SQLCODE = +100                                      34420099
344300             SET  PC033-NO-LINE       TO TRUE                     34430099
344400             MOVE ZERO                TO PC033-PO-NBR             34440099
344500                                         PC033-PO-LINE-NBR        34450099
344600                                         PC033-RCVR-SEQ-NBR       34460099
344700         WHEN SQLCODE = -904                                      34470099
344800         WHEN SQLCODE = -913                                      34480099
344900         WHEN SQLCODE = -911                                      34490099
345000             MOVE 11                  TO PV-ERROR-NBR             34500099
345100             PERFORM 9903-WRITE-CICS-LOG                          34510099
345200             PERFORM 9000-SOFT-ABORT                              34520099
345300         WHEN SQLWARN0 NOT = SPACES                               34530099
345400         WHEN SQLCODE NOT EQUAL ZERO                              34540099
345500             MOVE 12                  TO PV-ERROR-NBR             34550099
345600                                         PC033-ERROR-NBR          34560099
345700             PERFORM 9903-WRITE-CICS-LOG                          34570099
345800             MOVE '2375-SELECT-OTBND-UPC' TO PC033-PARAGRAPH      34580099
345900             MOVE 'PCKRF859 - GET PO NBR' TO PC033-MESSAGE-TEXT(1)34590099
346000             MOVE SUT00024-SHIPT-UNT-ID   TO PC033-MESSAGE-TEXT(2)34600099
346100             MOVE SQLCA                   TO PC033-SQLCA          34610099
346200             MOVE 'SUT00028'            TO PC033-DB2-TABLE-NAME(1)34620099
346300             SET PC033-ABEND            TO TRUE                   34630099
346400             MOVE 99                    TO PC033-PGM-MSG-NBR      34640099
346500             PERFORM 8210-XCTL-ERROR-SCREEN                       34650099
346600     END-EVALUATE.                                                34660099
346700                                                                  34670099
346800*-------------------------------------------------------------    34680099
346900 2385-GET-RCVR-NBR.                                               34690099
347000*-------------------------------------------------------------    34700099
347100     EXEC SQL                                                     34710099
347200         SELECT C.REC_SEQ_NBR                                     34720099
347300         INTO   :PKSLIP-REC-SEQ-NBR                               34730099
347400         FROM   SUT_OTBND_UPC A                                   34740099
347500               ,SUT_OTBND_VND B                                   34750099
347600               ,TPKSLIP       C                                   34760099
347700         WHERE  A.SHIPT_UNT_ID   = :SUT00024-SHIPT-UNT-ID         34770099
347800           AND  A.TRN_NBR        = :PC033-PO-NBR                  34780099
347900           AND  A.TRN_LNE_NBR    = :PC033-PO-LINE-NBR             34790099
348000           AND  A.SHIPT_UNT_ID   = B.SHIPT_UNT_ID                 34800099
348100           AND  B.PO_NBR         = C.PO_NBR                       34810099
348200           AND  B.PKSL_SEQ_NBR   = C.SEQ_NBR                      34820099
348300           AND  C.VER_STAT_CDE   = 'A'                            34830099
348400     END-EXEC.                                                    34840099
348500     EVALUATE TRUE                                                34850099
348600         WHEN SQLCODE = ZERO                                      34860099
348700             MOVE PKSLIP-REC-SEQ-NBR TO PC033-RCVR-SEQ-NBR        34870099
348800         WHEN OTHER                                               34880099
348900             MOVE ZEROES             TO PC033-RCVR-SEQ-NBR        34890099
349000     END-EVALUATE.                                                34900099
349100                                                                  34910099
349200*-------------------------------------------------------------    34920099
349300 2400-PROCESS-LABEL.                                              34930099
349400*-------------------------------------------------------------    34940099
349500     IF PS-ERROR-NO                                               34950099
349600        PERFORM 3360-CHECK-RDM-BLIND-RCVNG                        34960099
350000        PERFORM 2600-CALL-AUTOVE-MODULE                           35000099
350100        INITIALIZE SU036-COMM-AREA                                35010099
350200        IF RC040-AUTO-VE-YES                                      35020099
350300            IF RECITM-STATUS-CDE = 'VE'                           35030099
350400                SET SU036-LOG-ONLY-NO   TO TRUE                   35040099
350500            ELSE                                                  35050099
350600                SET SU036-LOG-ONLY      TO TRUE                   35060099
350700            END-IF                                                35070099
350800        ELSE                                                      35080099
350900            SET SU036-LOG-ONLY-NO   TO TRUE                       35090099
351000        END-IF                                                    35100099
351100        SET SU036-DECREMENT-UNITS  TO TRUE                        35110099
351200        MOVE SUT00024-SHIPT-UNT-ID TO PC033-CARTON                35120099
351300        PERFORM 2410-LINK-SUKUT706                                35130099
351400        IF SU036-COMPLETE OR SU036-VERIFIED OR SU036-POST-VERIFIED35140099
351500           OR SU036-UPDATE-TYPE-IND = ' '                         35150099
351600             PERFORM 2900-INACTIVATE-LABEL                        35160099
351700        END-IF                                                    35170099
351800     END-IF.                                                      35180099
351900                                                                  35190099
352000*----------------------------------------------------------------*35200099
352100*  LINK TO SUKUT706                                               35210099
352200*----------------------------------------------------------------*35220099
352300 2410-LINK-SUKUT706.                                              35230099
352400                                                                  35240099
352500     MOVE LENGTH OF SU036-COMM-AREA TO PV-COMMAREA-LENGTH.        35250099
352600     MOVE PC033-CARTON              TO SU036-SHIPT-UNT-ID.        35260099
352700     MOVE PC033-PO-NBR              TO SU036-PO.                  35270099
352800     IF DK-RCVR-SEQ-NBR  > 0                                      35280099
352900         MOVE DK-RCVR-SEQ-NBR       TO SU036-REC-SEQ-NBR          35290099
353000                                       PC033-RCVR-SEQ-NBR         35300099
353100     ELSE                                                         35310099
353200         MOVE PC046-RCVR-NBR        TO SU036-REC-SEQ-NBR          35320099
353300                                       PC033-RCVR-SEQ-NBR         35330099
353400     END-IF.                                                      35340099
353500     MOVE PC033-OPER-UNT-ID         TO SU036-ORIG-OPER-UNT-ID.    35350099
353600     IF  PC033-RECLAIM                                            35360099
353700         MOVE 'RECLAIM'             TO SU036-CREATE-USER-ID       35370099
353800         MOVE 'PCKRF859'            TO SU036-PROGRAM-NAME         35380099
353900         MOVE 'PCKRF859'            TO SU036-PRC-RSN-CDE          35390099
354000     ELSE                                                         35400099
354100         MOVE 'UNUSED  '            TO SU036-CREATE-USER-ID       35410099
354200         MOVE 'PCKRF859'            TO SU036-PROGRAM-NAME         35420099
354300         MOVE 'PCKRF859'            TO SU036-PRC-RSN-CDE          35430099
354400     END-IF.                                                      35440099
354500                                                                  35450099
354600     EXEC CICS                                                    35460099
354700         LINK PROGRAM  ('SUKUT706')                               35470099
354800              COMMAREA (SU036-COMM-AREA)                          35480099
354900              LENGTH   (PV-COMMAREA-LENGTH)                       35490099
355000              RESP     (PV-CICS-RESPONSE)                         35500099
355100     END-EXEC.                                                    35510099
355200                                                                  35520099
355300     EVALUATE TRUE                                                35530099
355400         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 35540099
355500             IF (SU036-UPDATE-ERROR  OR  SU036-NO-CHANGE)         35550099
355600                    AND  PC033-UNUSED                             35560099
355700                 MOVE 'UNUSED LBL FAILED' TO AMSGLN1O             35570099
355800                 MOVE SPACES              TO AMSGLN2O             35580099
355900             ELSE                                                 35590099
356000                 IF SU036-INVALID-SQL     OR                      35600099
356100                    SU036-DATABASE-BUSY   OR                      35610099
356200                    SU036-ERROR                                   35620099
356300                    STRING ' PCKRF859 - '    DELIMITED BY SIZE    35630099
356400                       '2410-LINK-SUKUT706 ' DELIMITED BY SIZE    35640099
356500                       ' RETURN MESSAGE - '  DELIMITED BY SIZE    35650099
356600                       SU036-SUCCESS-IND     DELIMITED BY SIZE    35660099
356700                                   INTO PC033-MESSAGE-TEXT(1)     35670099
356800                     PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG       35680099
356900                     MOVE '2410-LINK-SUKUT706'  TO PC033-PARAGRAPH35690099
357000                      PERFORM 8200-RETURN-TRANID                  35700099
357100                ELSE                                              35710099
357200                     MOVE 'LABEL INACTIVATED' TO AMSGLN1O         35720099
357300                     MOVE SPACES              TO AMSGLN2O         35730099
357400                 END-IF                                           35740099
357500             END-IF                                               35750099
357600         WHEN OTHER                                               35760099
357700             STRING ' PCKRF859 (OTHER) -' DELIMITED BY SIZE       35770099
357800                    '2410-LINK-SUKUT706 ' DELIMITED BY SIZE       35780099
357900                    ' RETURN MESSAGE - '  DELIMITED BY SIZE       35790099
358000                    SU036-SUCCESS-IND     DELIMITED BY SIZE       35800099
358100                                   INTO PC033-MESSAGE-TEXT(1)     35810099
358200             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               35820099
358300             MOVE '2410-LINK-SUKUT706'   TO PC033-PARAGRAPH       35830099
358400             PERFORM 8200-RETURN-TRANID                           35840099
358500     END-EVALUATE.                                                35850099
358600                                                                  35860099
358700*-----------------------------------------------------------------35870099
358800* DETERMINE LAST ACTIVITY FOR CARTON.                             35880099
358900*-----------------------------------------------------------------35890099
359000 2500-DETERMINE-LAST-ACTIVITY.                                    35900099
359100                                                                  35910099
359200     INITIALIZE  PC046-COMMAREA-REC.                              35920099
359300     SET   PC046-FROM-CRTN-STAT  TO  TRUE.                        35930099
359400     MOVE  SUT00024-SHIPT-UNT-ID TO  PC046-CARTON-ID.             35940099
359500                                                                  35950099
359600     CALL PC046-CARTON-STATUS-MODULE                              35960099
359700             USING DFHEIBLK                                       35970099
359800             PC046-COMMAREA                                       35980099
359900             PC046-COMMAREA-REC                                   35990099
360000     END-CALL                                                     36000099
360100                                                                  36010099
360200     PERFORM 2510-VALIDATE-STATUS-CALL.                           36020099
360300                                                                  36030099
360400*----------------------------------------------------------------*36040099
360500* CHECK RETURN CODE FROM CRTN STATUS PROGRAM TO SEE IF SUCCESSFUL*36050099
360600*----------------------------------------------------------------*36060099
360700 2510-VALIDATE-STATUS-CALL.                                       36070099
360800                                                                  36080099
360900     IF  PC046-ERROR                                              36090099
361000         SET  PS-ERROR                   TO  TRUE                 36100099
361100         MOVE PC034-CICS-FATAL-ERROR-MSG TO  AMSGLN1O             36110099
361200         MOVE SPACES                     TO  AMSGLN2O             36120099
361300         PERFORM 9904-WRITE-CRTN-MODULE-MSG                       36130099
361400     ELSE                                                         36140099
361500     IF  PC046-INVALID-SQL                                        36150099
361600         SET  PS-ERROR                   TO  TRUE                 36160099
361700         MOVE PC034-DB2-FATAL-ERROR-MSG  TO  AMSGLN1O             36170099
361800         MOVE SPACES                     TO  AMSGLN2O             36180099
361900         PERFORM 9904-WRITE-CRTN-MODULE-MSG                       36190099
362000     ELSE                                                         36200099
362100     IF  PC046-DATABASE-BUSY                                      36210099
362200         SET  PS-ERROR                      TO  TRUE              36220099
362300         MOVE PC034-TRANS-NOT-AVAILABLE-MSG TO  AMSGLN1O          36230099
362400         MOVE SPACES                        TO  AMSGLN2O          36240099
362500     ELSE                                                         36250099
362600     IF  PC046-CRTN-STAT-ERROR                                    36260099
362700         SET  PS-ERROR                 TO  TRUE                   36270099
362800         MOVE PC-CARTON-STATUS-ERROR   TO  AMSGLN1O               36280099
362900         MOVE SPACES                   TO AMSGLN2O                36290099
363000     ELSE                                                         36300099
363100     IF  PC046-SUCCESSFUL                                         36310099
363200         MOVE PC046-CRTN-STATUS      TO  DK-CRTN-STATUS           36320099
363300         MOVE PC046-RCVR-NBR         TO  PC033-RCVR-SEQ-NBR       36330099
363400     ELSE                                                         36340099
363500         SET  PS-ERROR                   TO  TRUE                 36350099
363600         MOVE PC034-CICS-FATAL-ERROR-MSG TO  AMSGLN1O             36360099
363700         MOVE SPACES                     TO  AMSGLN2O             36370099
363800     END-IF                                                       36380099
363900     END-IF                                                       36390099
364000     END-IF                                                       36400099
364100     END-IF                                                       36410099
364200     END-IF.                                                      36420099
364300                                                                  36430099
364400     IF PS-ERROR                                                  36440099
364500        MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA                    36450099
364600        MOVE -1                     TO ACARTNL                    36460099
364700        MOVE PV-CARTON-NBR          TO ACARTNO                    36470099
364800        PERFORM 8100-SEND-DATA-ONLY                               36480099
364900        PERFORM 8200-RETURN-TRANID                                36490099
365000     END-IF.                                                      36500099
365100                                                                  36510099
365200     IF PS-ERROR-NO                                               36520099
365300         IF SUT00024-ACTV-IND = 'Y'                               36530099
365400             IF DK-CRTN-STATUS  = '04' OR '05' OR '06'            36540099
365500                  SET PS-ERROR                                    36550099
365600                      PC033-INITIALIZE-SCREEN  TO TRUE            36560099
365700                  IF  DK-CRTN-STATUS  =  '04'                     36570099
365800                      MOVE 'SCANNED ON TRAILER' TO AMSGLN2O       36580099
365900                  ELSE                                            36590099
366000                      IF  DK-CRTN-STATUS  =  '05'                 36600099
366100                          MOVE 'ACTV DVRT RECLM CTN' TO AMSGLN2O  36610099
366200                      ELSE                                        36620099
366300                          IF  DK-CRTN-STATUS  =  '06'             36630099
366400                             MOVE 'LOADED ONTO TRAILR' TO AMSGLN2O36640099
366500                          END-IF                                  36650099
366600                      END-IF                                      36660099
366700                  END-IF                                          36670099
366800                  MOVE 'UNABLE TO INACTIVT' TO AMSGLN1O           36680099
366900                  MOVE SPACES               TO  AMSGLN2O          36690099
367000             ELSE                                                 36700099
367100                  IF DK-CRTN-STATUS  = '08'                       36710099
367200                     SET PS-ERROR                                 36720099
367300                         PC033-INITIALIZE-SCREEN  TO TRUE         36730099
367400                     MOVE 28      TO PC033-PGM-MSG-NBR            36740099
367500                     PERFORM 8210-XCTL-ERROR-SCREEN               36750099
367600                 END-IF                                           36760099
367700             END-IF                                               36770099
367800         END-IF                                                   36780099
367900     END-IF.                                                      36790099
368000                                                                  36800099
368100*----------------------------------------------------------------*36810099
368200*    CALL TO (AUTOVE) AUTOVERIFICATION MODULE (RCKUT127)          36820099
368300*----------------------------------------------------------------*36830099
368400 2600-CALL-AUTOVE-MODULE.                                         36840099
368500                                                                  36850099
368600     IF DK-RCVR-SEQ-NBR  > 0                                      36860099
368700         MOVE DK-RCVR-SEQ-NBR       TO PC033-RCVR-SEQ-NBR         36870099
368800                                       RC040-PO-RCVR              36880099
368900     ELSE                                                         36890099
369000         IF PC033-RCVR-SEQ-NBR > 0                                36900099
369100             MOVE PC033-RCVR-SEQ-NBR    TO RC040-PO-RCVR          36910099
369200         ELSE                                                     36920099
369300             MOVE PC046-RCVR-NBR        TO PC033-RCVR-SEQ-NBR     36930099
369400                                           RC040-PO-RCVR          36940099
369500         END-IF                                                   36950099
369600     END-IF.                                                      36960099
369700     PERFORM 2650-CHECK-PO-VRFD.                                  36970099
369800     INITIALIZE RC040-FIELDS.                                     36980099
369900     MOVE PC033-OPER-UNT-ID      TO RC040-SIGNON-LOCATION.        36990099
370000     MOVE PC033-PO-NBR           TO RC040-PO-NBR                  37000099
370100     MOVE 'PCKRF859'             TO RC040-CALLING-PROGRAM.        37010099
370200                                                                  37020099
370300     CALL RC040-AUTOVE-CHECK-PGM USING  DFHEIBLK                  37030099
370400                                        RC040-COMMAREA            37040099
370500                                        RC040-FIELDS.             37050099
370600                                                                  37060099
370700     EVALUATE TRUE                                                37070099
370800         WHEN RC040-SUCCESSFUL                                    37080099
370900             IF RC040-INVALID-SQL                                 37090099
371000                 SET PS-ERROR     TO TRUE                         37100099
371100                 MOVE PC034-DB2-FATAL-ERROR-MSG  TO  AMSGLN1O     37110099
371200                 MOVE SPACES                     TO  AMSGLN2O     37120099
371300             ELSE                                                 37130099
371400                 IF RC040-DATABASE-BUSY                           37140099
371500                    SET PS-ERROR                       TO TRUE    37150099
371600                    MOVE PC034-TRANS-NOT-AVAILABLE-MSG TO AMSGLN1O37160099
371700                    MOVE SPACES                        TO AMSGLN2O37170099
371800                 END-IF                                           37180099
371900             END-IF                                               37190099
372000         WHEN OTHER                                               37200099
372100             SET PS-ERROR     TO TRUE                             37210099
372200             MOVE PC034-CICS-FATAL-ERROR-MSG TO  AMSGLN1O         37220099
372300             MOVE SPACES                     TO  AMSGLN2O         37230099
372400     END-EVALUATE.                                                37240099
372500                                                                  37250099
372600     IF PS-ERROR                                                  37260099
372700        MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA                    37270099
372800        MOVE -1                     TO ACARTNL                    37280099
372900        MOVE PV-CARTON-NBR          TO ACARTNO                    37290099
373000        PERFORM 8100-SEND-DATA-ONLY                               37300099
373100        PERFORM 8200-RETURN-TRANID                                37310099
373200     END-IF.                                                      37320099
373300                                                                  37330099
373400*---------------------------------------------------------------- 37340099
373500 2650-CHECK-PO-VRFD.                                              37350099
373600*---------------------------------------------------------------- 37360099
373700     IF DK-RCVR-SEQ-NBR  > ZEROES                                 37370099
373800         MOVE DK-RCVR-SEQ-NBR     TO DK-REC-SEQ-NBR               37380099
373900     ELSE                                                         37390099
374000         MOVE PC033-RCVR-SEQ-NBR  TO DK-REC-SEQ-NBR               37400099
374100     END-IF.                                                      37410099
374200                                                                  37420099
374300     EXEC SQL                                                     37430099
374400         SELECT STATUS_CDE                                        37440099
374500         INTO   :RECITM-STATUS-CDE                                37450099
374600         FROM   TRECITM                                           37460099
374700         WHERE  ORD_NBR          = :PC033-PO-NBR                  37470099
374800           AND  REC_SEQ_NBR      = :DK-REC-SEQ-NBR                37480099
374900           AND  ORD_LNE_NBR      = :PC033-PO-LINE-NBR             37490099
375000     END-EXEC.                                                    37500099
375100     EVALUATE TRUE                                                37510099
375200         WHEN SQLCODE = ZERO                                      37520099
375300             CONTINUE                                             37530099
375400         WHEN SQLCODE = -904                                      37540099
375500         WHEN SQLCODE = -913                                      37550099
375600         WHEN SQLCODE = -911                                      37560099
375700             MOVE 110                 TO PV-ERROR-NBR             37570099
375800             PERFORM 9903-WRITE-CICS-LOG                          37580099
375900             PERFORM 9000-SOFT-ABORT                              37590099
376000         WHEN SQLCODE = +100                                      37600099
376100         WHEN SQLWARN0 NOT = SPACES                               37610099
376200         WHEN SQLCODE NOT EQUAL ZERO                              37620099
376300             MOVE 111                 TO PV-ERROR-NBR             37630099
376400                                         PC033-ERROR-NBR          37640099
376500             PERFORM 9903-WRITE-CICS-LOG                          37650099
376600             MOVE '2650-CHECK-PO-VRFD ' TO PC033-PARAGRAPH        37660099
376700             MOVE 'PCKRF859 - CHECK STATUS CDE'                   37670099
376800                                      TO PC033-MESSAGE-TEXT(1)    37680099
376900             MOVE SUT00024-SHIPT-UNT-ID TO PC033-MESSAGE-TEXT(2)  37690099
377000             MOVE SQLCA                 TO PC033-SQLCA            37700099
377100             MOVE 'SUT00024'            TO PC033-DB2-TABLE-NAME(1)37710099
377200             SET PC033-ABEND            TO TRUE                   37720099
377300             MOVE 99                    TO PC033-PGM-MSG-NBR      37730099
377400             PERFORM 8210-XCTL-ERROR-SCREEN                       37740099
377500     END-EVALUATE.                                                37750099
377600                                                                  37760099
377700*----------------------------------------------------------------*37770099
377800 2900-INACTIVATE-LABEL.                                           37780099
377900*----------------------------------------------------------------*37790099
378000     MOVE 'N'                         TO DK-STATUS                37800099
378100     IF SUT00024-CART-SRC-CDE = 'CPS'                             37810099
378200         MOVE PC-CURRENT-PROGRAM-NAME TO SUT00024-CRE-PGM-NM      37820099
378300     END-IF.                                                      37830099
378400     PERFORM 2910-SUT-OTBND-CART.                                 37840099
378500                                                                  37850099
378600*-----------------------------------------------------------      37860099
378700 2910-SUT-OTBND-CART.                                             37870099
378800     EXEC SQL                                                     37880099
378900         UPDATE SUT_OTBND_CART                                    37890099
379000         SET ACTV_IND          = :DK-STATUS                       37900099
379100          ,  CRE_PGM_NM        = :SUT00024-CRE-PGM-NM             37910099
379200         WHERE  SHIPT_UNT_ID   = :SUT00024-SHIPT-UNT-ID           37920099
379300     END-EXEC.                                                    37930099
379400                                                                  37940099
379500     EVALUATE TRUE                                                37950099
379600         WHEN SQLCODE = ZERO                                      37960099
379700             CONTINUE                                             37970099
379800         WHEN SQLCODE = -904                                      37980099
379900         WHEN SQLCODE = -913                                      37990099
380000         WHEN SQLCODE = -911                                      38000099
380100             MOVE 5                   TO PV-ERROR-NBR             38010099
380200             PERFORM 9903-WRITE-CICS-LOG                          38020099
380300             PERFORM 9000-SOFT-ABORT                              38030099
380400         WHEN SQLCODE = +100                                      38040099
380500         WHEN SQLWARN0 NOT = SPACES                               38050099
380600         WHEN SQLCODE NOT EQUAL ZERO                              38060099
380700             MOVE 6                   TO PV-ERROR-NBR             38070099
380800                                         PC033-ERROR-NBR          38080099
380900             PERFORM 9903-WRITE-CICS-LOG                          38090099
381000             MOVE '2910-SUT-OTBND-CART' TO PC033-PARAGRAPH        38100099
381100             MOVE 'PCKRF859 - UPDATE ACTV-IND'                    38110099
381200                                      TO PC033-MESSAGE-TEXT(1)    38120099
381300             MOVE SUT00024-SHIPT-UNT-ID TO PC033-MESSAGE-TEXT(2)  38130099
381400             MOVE SQLCA                 TO PC033-SQLCA            38140099
381500             MOVE 'SUT00024'            TO PC033-DB2-TABLE-NAME(1)38150099
381600             SET PC033-ABEND            TO TRUE                   38160099
381700             MOVE 99                    TO PC033-PGM-MSG-NBR      38170099
381800             PERFORM 8210-XCTL-ERROR-SCREEN                       38180099
381900                                                                  38190099
382000     END-EVALUATE.                                                38200099
382100                                                                  38210099
382200*-----------------------------------------------------------      38220099
382300 2920-UPDATE-OTBND-UPC.                                           38230099
382400     EXEC SQL                                                     38240099
382500         UPDATE SUT_OTBND_UPC                                     38250099
382600         SET SHPD_UNT_QTY      = 0                                38260099
382700         WHERE  SHIPT_UNT_ID   = :SUT00024-SHIPT-UNT-ID           38270099
382800     END-EXEC.                                                    38280099
382900                                                                  38290099
383000     EVALUATE TRUE                                                38300099
383100         WHEN SQLCODE = ZERO                                      38310099
383200             CONTINUE                                             38320099
383300         WHEN SQLCODE = -904                                      38330099
383400         WHEN SQLCODE = -913                                      38340099
383500         WHEN SQLCODE = -911                                      38350099
383600             MOVE 150                 TO PV-ERROR-NBR             38360099
383700             PERFORM 9903-WRITE-CICS-LOG                          38370099
383800             PERFORM 9000-SOFT-ABORT                              38380099
383900         WHEN SQLCODE = +100                                      38390099
384000         WHEN SQLWARN0 NOT = SPACES                               38400099
384100         WHEN SQLCODE NOT EQUAL ZERO                              38410099
384200             MOVE 151                 TO PV-ERROR-NBR             38420099
384300                                         PC033-ERROR-NBR          38430099
384400             PERFORM 9903-WRITE-CICS-LOG                          38440099
384500             MOVE '2920-UPDATE-OTBND-UPC' TO PC033-PARAGRAPH      38450099
384600             MOVE 'PCKRF859 - UPDATE SHPD-UNT-QTY'                38460099
384700                                      TO PC033-MESSAGE-TEXT(1)    38470099
384800             MOVE SUT00024-SHIPT-UNT-ID TO PC033-MESSAGE-TEXT(2)  38480099
384900             MOVE SQLCA                 TO PC033-SQLCA            38490099
385000             MOVE 'SUT00028'            TO PC033-DB2-TABLE-NAME(1)38500099
385100             SET PC033-ABEND            TO TRUE                   38510099
385200             MOVE 99                    TO PC033-PGM-MSG-NBR      38520099
385300             PERFORM 8210-XCTL-ERROR-SCREEN                       38530099
385400                                                                  38540099
385500     END-EVALUATE.                                                38550099
385600                                                                  38560099
385700****************************************************************  38570099
385800 3000-LINK-TO-CRTN-STATUS.                                        38580099
385900****************************************************************  38590099
386000     INITIALIZE  PC046-COMMAREA-REC.                              38600099
386100     MOVE PC-CURRENT-PROGRAM-NAME TO PC046-CALLING-PGM-NME.       38610099
386200     IF  PS-VENDOR-CARTON-AUDIT                                   38620099
386300         MOVE DK-BRCDE-NBR     TO  PV-BARCODE                     38630099
386400         MOVE PV-BARCODE-3-20  TO  PC046-CARTON-ID                38640099
386500     ELSE                                                         38650099
386600         MOVE PV-CTN-N         TO  PC046-CARTON-ID                38660099
386700     END-IF.                                                      38670099
386800     SET PC046-CALC-UNITS TO TRUE.                                38680099
386900                                                                  38690099
387000                                                                  38700099
387100     CALL PC046-CARTON-STATUS-MODULE                              38710099
387200             USING DFHEIBLK                                       38720099
387300             PC046-COMMAREA                                       38730099
387400             PC046-COMMAREA-REC                                   38740099
387500     END-CALL.                                                    38750099
387600     PERFORM 3100-VALIDATE-STATUS-CALL.                           38760099
387700                                                                  38770099
387800     IF  PC046-SUCCESSFUL                                         38780099
387900         MOVE ZEROES TO PV-DB2-VE-COUNT                           38790099
388000         PERFORM 3300-CHECK-FOR-VERFD-LNES                        38800099
388100         IF PV-DB2-VE-COUNT > 0                                   38810099
388200            MOVE '  RECLAIM FAILED  '        TO AMSGLN1O          38820099
388300            MOVE PC034-VERFD-LINES-EXIST-MSG TO AMSGLN2O          38830099
388400            MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA                38840099
388500            MOVE -1                     TO ACARTNL                38850099
388600            MOVE PV-CARTON-NBR          TO ACARTNO                38860099
388700            PERFORM 8100-SEND-DATA-ONLY                           38870099
388800            PERFORM 8200-RETURN-TRANID                            38880099
388900         END-IF                                                   38890099
389000     END-IF.                                                      38900099
389100                                                                  38910099
389200*----------------------------------------------------------------*38920099
389300* CHECK RETURN CODE FROM CRTN STATUS PROGRAM TO SEE IF SUCCESSFUL*38930099
389400*----------------------------------------------------------------*38940099
389500 3100-VALIDATE-STATUS-CALL.                                       38950099
389600                                                                  38960099
389700     IF  PC046-SUCCESSFUL                                         38970099
389800         CONTINUE                                                 38980099
389900     ELSE                                                         38990099
390000     SET PS-ERROR     TO TRUE                                     39000099
390100     IF  PC046-ERROR                                              39010099
390200         MOVE PC034-CICS-FATAL-ERROR-MSG TO  AMSGLN1O             39020099
390300         MOVE SPACES                     TO  AMSGLN2O             39030099
390400         PERFORM 9904-WRITE-CRTN-MODULE-MSG                       39040099
390500     ELSE                                                         39050099
390600     IF  PC046-INVALID-SQL                                        39060099
390700         MOVE PC034-DB2-FATAL-ERROR-MSG  TO  AMSGLN1O             39070099
390800         MOVE SPACES                     TO  AMSGLN2O             39080099
390900         PERFORM 9904-WRITE-CRTN-MODULE-MSG                       39090099
391000     ELSE                                                         39100099
391100     IF  PC046-DATABASE-BUSY                                      39110099
391200         MOVE PC034-TRANS-NOT-AVAILABLE-MSG  TO  AMSGLN1O         39120099
391300         MOVE SPACES                     TO  AMSGLN2O             39130099
391400     ELSE                                                         39140099
391500         MOVE PC034-CICS-FATAL-ERROR-MSG TO  AMSGLN1O             39150099
391600         MOVE SPACES                     TO  AMSGLN2O             39160099
391700                                                                  39170099
391800     END-IF                                                       39180099
391900     END-IF                                                       39190099
392000     END-IF                                                       39200099
392100     END-IF.                                                      39210099
392200                                                                  39220099
392300     IF PS-ERROR                                                  39230099
392400        MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA                    39240099
392500        MOVE -1                     TO ACARTNL                    39250099
392600        MOVE PV-CARTON-NBR          TO ACARTNO                    39260099
392700        PERFORM 8100-SEND-DATA-ONLY                               39270099
392800        PERFORM 8200-RETURN-TRANID                                39280099
392900     END-IF.                                                      39290099
393000                                                                  39300099
393100******************************************************************39310099
393200**IF THE CARTON IS ASSCIATED TO A TRAILER, THE DOOR MUST BE IN A  39320099
393300**STATUS OF 'DO'                                                  39330099
393400** AS OF 7/2004 FOR THE AUTOVE PROJECT THIS WAS CHANGED TO MATCH  39340099
393500** WHAT IS BEING DONE FOR CARTON ADJUSTMENTS.                     39350099
393600******************************************************************39360099
393700 3200-EVALUATE-CRTN-STATUS.                                       39370099
393800                                                                  39380099
393900     EVALUATE TRUE                                                39390099
394000        WHEN PC046-CHECKED-IN                                     39400099
394100        WHEN PS-VENDOR-CARTON-AUDIT                               39410099
394200        WHEN PC046-CASEPACK-SPLIT                                 39420099
394300        WHEN PC046-DIVERTED-TO-TRLR                               39430099
394400        WHEN PC046-SCANNED-OFF-TRLR                               39440099
394500             CONTINUE                                             39450099
394600        WHEN PC046-SCANNED-ONTO-TRLR                              39460099
394700        WHEN PC046-LOADED-ONTO-TRLR                               39470099
394800             IF PC046-TRIP-STATUS = 'DO' OR 'AO' OR '  '          39480099
394900                CONTINUE                                          39490099
395000             ELSE                                                 39500099
395100                SET PS-ERROR  TO TRUE                             39510099
395200                MOVE '  RECLAIM FAILED  '      TO AMSGLN1O        39520099
395300                MOVE 'ON CLOSED TRAILER '      TO AMSGLN2O        39530099
395400             END-IF                                               39540099
395500        WHEN PC046-CRE-BY-ASN                                     39550099
395600             SET PS-ERROR  TO TRUE                                39560099
395700             MOVE PC034-CRTN-NOT-CKED-IN-MSG TO AMSGLN1O          39570099
395800             MOVE SPACES                     TO  AMSGLN2O         39580099
395900        WHEN OTHER                                                39590099
396000             SET PS-ERROR  TO TRUE                                39600099
396100             MOVE PC034-INVALID-CRTN-ID  TO AMSGLN1O              39610099
396200             MOVE SPACES                 TO  AMSGLN2O             39620099
396300     END-EVALUATE.                                                39630099
396400                                                                  39640099
396500     IF PS-ERROR                                                  39650099
396600        MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA                    39660099
396700        MOVE -1                     TO ACARTNL                    39670099
396800        MOVE PV-CARTON-NBR          TO ACARTNO                    39680099
396900        PERFORM 8100-SEND-DATA-ONLY                               39690099
397000        PERFORM 8200-RETURN-TRANID                                39700099
397100     END-IF.                                                      39710099
397200                                                                  39720099
397300******************************************************************39730099
397400*CHECK IF ANY OF THE LINES IN THE CARTON HAVE BEEN VERIFIED.      39740099
397500******************************************************************39750099
397600 3300-CHECK-FOR-VERFD-LNES.                                       39760099
397700                                                                  39770099
397800     IF PC046-CARTON-ID   >  0                                    39780099
397900         MOVE PC046-CARTON-ID       TO SUT00027-SHIPT-UNT-ID      39790099
398000     ELSE                                                         39800099
398100         MOVE SUT00024-SHIPT-UNT-ID TO SUT00027-SHIPT-UNT-ID      39810099
398200     END-IF.                                                      39820099
398300     IF PC046-PO-NBR   >  0                                       39830099
398400         MOVE PC046-PO-NBR        TO RECITM-ORD-NBR               39840099
398500     ELSE                                                         39850099
398600         IF PC033-PO-NBR   >  0                                   39860099
398700             MOVE PC033-PO-NBR    TO RECITM-ORD-NBR               39870099
398800         ELSE                                                     39880099
398900             ADD +2               TO PV-DB2-VE-COUNT              39890099
399000         END-IF                                                   39900099
399100     END-IF.                                                      39910099
399200     IF PC046-RCVR-NBR NOT = '000' AND PC046-RCVR-NBR  NOT = '   '39920099
399300         MOVE PC046-RCVR-NBR          TO RECITM-REC-SEQ-NBR       39930099
399400     ELSE                                                         39940099
399500         IF PC033-RCVR-SEQ-NBR NOT = ZEROES                       39950099
399600             MOVE PC033-RCVR-SEQ-NBR  TO RECITM-REC-SEQ-NBR       39960099
399700         ELSE                                                     39970099
399800             ADD +2                   TO PV-DB2-VE-COUNT          39980099
399900         END-IF                                                   39990099
400000     END-IF.                                                      40000099
400100                                                                  40010099
400200     IF PV-DB2-VE-COUNT = ZEROES                                  40020099
400300         EXEC SQL                                                 40030099
400400              SELECT COUNT(*)                                     40040099
400500                INTO :PV-DB2-VE-COUNT                             40050099
400600                FROM SUT_OTBND_CART A                             40060099
400700                  ,  SUT_OTBND_UPC  B                             40070099
400800                  ,  TRECITM        C                             40080099
400900               WHERE A.SHIPT_UNT_ID    =  B.SHIPT_UNT_ID          40090099
401000                 AND A.SHIPT_UNT_ID    =  :SUT00027-SHIPT-UNT-ID  40100099
401100                 AND A.ACTV_IND        =  'Y'                     40110099
401200                 AND B.TRN_NBR         =  :RECITM-ORD-NBR         40120099
401300                 AND B.TRN_NBR         =  C.ORD_NBR               40130099
401400                 AND B.TRN_LNE_NBR     =  C.ORD_LNE_NBR           40140099
401500                 AND C.REC_SEQ_NBR     =  :RECITM-REC-SEQ-NBR     40150099
401600                 AND C.VER_STATUS_CDE  =  'A'                     40160099
401700                 AND C.STATUS_CDE      =  'VE'                    40170099
401800          END-EXEC                                                40180099
401900                                                                  40190099
402000         EVALUATE TRUE                                            40200099
402100             WHEN SQLCODE = ZERO                                  40210099
402200                 CONTINUE                                         40220099
402300             WHEN SQLWARN0 NOT = SPACES                           40230099
402400             WHEN SQLCODE < ZERO                                  40240099
402500             WHEN SQLCODE > ZERO                                  40250099
402600                 MOVE '3300-CHECK-FOR-VERFD-LNES '                40260099
402700                                                TO DP013-PARAGRAPH40270099
402800                 MOVE 'SELECT OF TRECITM TABLE'                   40280099
402900                                         TO DP013-MESSAGE-TEXT (1)40290099
403000                 MOVE SUT00027-SHIPT-UNT-ID                       40300099
403100                                         TO DP013-MESSAGE-TEXT (2)40310099
403200                 MOVE SQLCA            TO DP013-SQLCA             40320099
403300                 MOVE 'TRECITM '    TO DP013-DB2-TABLE-NAME (1)   40330099
403400                 SET DP013-DB2-ABEND   TO TRUE                    40340099
403500                 SET DP013-ROLLBACK TO TRUE                       40350099
403600                 PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG           40360099
403700                 MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O       40370099
403800                 MOVE SPACES                    TO  AMSGLN2O      40380099
403900                 MOVE -1                     TO ACARTNL           40390099
404000                 MOVE PV-CARTON-NBR          TO ACARTNO           40400099
404100                 PERFORM 8100-SEND-DATA-ONLY                      40410099
404200                 PERFORM 8200-RETURN-TRANID                       40420099
404300         END-EVALUATE                                             40430099
404400     END-IF.                                                      40440099
404500                                                                  40450099
404600******************************************************************40460099
404700*CHECK IF DC IS USING RDM BLIND RECEIVING                         40470099
404800******************************************************************40480099
404900 3360-CHECK-RDM-BLIND-RCVNG.                                      40490099
405000                                                                  40500099
405100     MOVE PC046-DEST-OPER-UNT-ID TO DK-OPER-UNT-ID.               40510099
405200                                                                  40520099
405300     EXEC SQL                                                     40530099
405400          SELECT FUNC_END_TMST                                    40540099
405500          INTO  :KRPRPM-FUNC-END-TMST                             40550099
405600          FROM   TKRPRPM                                          40560099
405700          WHERE  SYS_PRC_FUNC_CDE  = 'RDMRCV'                     40570099
405800            AND  LOC_ID            = :DK-OPER-UNT-ID              40580099
405900            AND  INTFC_SYS_CDE     = 'RDM'                        40590099
406000            AND  FUNC_PRC_STAT_CDE = 'AC'                         40600099
406100            AND  FUNC_TXT          = 'Y'                          40610099
406200     END-EXEC.                                                    40620099
406300                                                                  40630099
406400     EVALUATE TRUE                                                40640099
406500         WHEN SQLCODE = ZERO                                      40650099
406600             SET PS-BLND-RECV-SIMPL-LOC-FND TO TRUE               40660099
406700         WHEN SQLCODE = +100                                      40670099
406800             SET PS-BLND-RECV-SIMPL-LOC-NOT-FND TO TRUE           40680099
406900         WHEN SQLWARN0 NOT = SPACES                               40690099
407000         WHEN SQLCODE < ZERO                                      40700099
407100         WHEN SQLCODE > ZERO                                      40710099
407200             MOVE '3360-CHECK-RDM-BLIND-RCVNG'                    40720099
407300                 TO DP013-PARAGRAPH                               40730099
407400             MOVE 'SELECT OF TKRPRPM TABLE'                       40740099
407500                 TO DP013-MESSAGE-TEXT (1)                        40750099
407600             MOVE DK-SHIPT-UNT-ID                                 40760099
407700                 TO DP013-MESSAGE-TEXT (2)                        40770099
407800             MOVE SQLCA            TO DP013-SQLCA                 40780099
407900             MOVE 'TKRPRPM '                                      40790099
408000                                    TO DP013-DB2-TABLE-NAME (1)   40800099
408100             SET DP013-DB2-ABEND   TO TRUE                        40810099
408200             SET DP013-ROLLBACK TO TRUE                           40820099
408300             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               40830099
408400             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           40840099
408500             MOVE SPACES                    TO  AMSGLN2O          40850099
408600             MOVE -1                     TO  ACARTNL              40860099
408700             MOVE PV-CARTON-NBR          TO ACARTNO               40870099
408800             PERFORM 8100-SEND-DATA-ONLY                          40880099
408900             PERFORM 8200-RETURN-TRANID                           40890099
409000     END-EVALUATE.                                                40900099
409100                                                                  40910099
409200*-----------------------------------------------------------------40920099
409300 4000-PROCESS-MFST-CARTONS.                                       40930099
409400*-------------------------------------------------------------    40940099
409500     EVALUATE TRUE                                                40950099
409600       WHEN PC046-CHECKED-IN                                      40960099
409700       WHEN PC046-SCANNED-OFF-TRLR                                40970099
409800            CONTINUE                                              40980099
409900       WHEN PC046-LOADED-ONTO-TRLR                                40990099
410000          PERFORM 4100-INACTV-DIVERT-TABLE                        41000099
410100          PERFORM 4200-INSERT-SCNOFF-OTBND-LOC                    41010099
410200       WHEN PC046-DIVERTED-TO-TRLR                                41020099
410300          PERFORM 4100-INACTV-DIVERT-TABLE                        41030099
410400       WHEN PC046-SCANNED-ONTO-TRLR                               41040099
410500          PERFORM 4100-INACTV-DIVERT-TABLE                        41050099
410600          PERFORM 4300-INACTIVATE-SHON                            41060099
410700          PERFORM 4200-INSERT-SCNOFF-OTBND-LOC                    41070099
410800     END-EVALUATE.                                                41080099
410900                                                                  41090099
411000     IF PS-CREATED-BY-ASN                                         41100099
411100          PERFORM 4050-PRCESS-CHKED-IN-CARTONS                    41110099
411200     END-IF.                                                      41120099
411300                                                                  41130099
411400     IF PS-NO-P2L-BOUND-BRCDE-FND AND PC033-RECLAIM               41140099
411500         PERFORM 6100-CHECK-FOR-ADJUSTMENTS                       41150099
411600         IF PS-ADJSTMNTS-EXIST                                    41160099
411700             INITIALIZE SU035-COMM-AREA                           41170099
411800             SET SU035-LOG-ONLY         TO TRUE                   41180099
411900             PERFORM 6200-PROCESS-ADJ-CURSOR                      41190099
412000             PERFORM 7000-CHECK-TSUQADJ-4-DMG                     41200099
412100             IF PS-DMG-CRTN-EXISTS                                41210099
412200                 PERFORM 7100-CHECK-OTBND-UPC                     41220099
412300             END-IF                                               41230099
412400         END-IF                                                   41240099
412500     END-IF.                                                      41250099
412600                                                                  41260099
412700     PERFORM 5350-UPDATE-OTBND-CART.                              41270099
412800     PERFORM 5400-INSERT-RECLAIM-OTBND-LOC.                       41280099
412900     PERFORM 5450-DELETE-PRCD-MSG.                                41290099
413000                                                                  41300099
413100*---------------------------------------------------------------- 41310099
413200 4050-PRCESS-CHKED-IN-CARTONS.                                    41320099
413300*-------------------------------------------------------------    41330099
413400     IF PS-PACK-BY-STORE-NO                                       41340099
413500         PERFORM 5100-UPDATE-TLBVRDA                              41350099
413600     END-IF.                                                      41360099
413700     PERFORM 5200-DELETE-OTBND-LOC.                               41370099
413800     PERFORM 5250-GET-VENDOR-SSCC.                                41380099
413900     PERFORM 5300-DELETE-TSULBXF.                                 41390099
414000     PERFORM 5325-DELETE-TSHUNLO.                                 41400099
414100     PERFORM 5000-DELETE-TLBPTDA.                                 41410099
414200                                                                  41420099
414300     PERFORM 2002-COMBO-AUDIT-RTN.                                41430099
414400                                                                  41440099
414800                                                                  41480099
414900*-----------------------------------------------------------------41490099
415000*IF THE CARTON WAS DIVERTED, THE ACTIVE ENTRY CODE WILL = 'A'.    41500099
415100*-----------------------------------------------------------------41510099
415200 4100-INACTV-DIVERT-TABLE.                                        41520099
415300     MOVE PC046-CARTON-ID    TO SUCRDV-SHIPT-UNT-ID.              41530099
415400                                                                  41540099
415500     EXEC SQL                                                     41550099
415600         UPDATE TSUCRDV                                           41560099
415700         SET                                                      41570099
415800             ACTV_CDE        =  :PC-I                             41580099
415900         WHERE  SHIPT_UNT_ID =  :SUCRDV-SHIPT-UNT-ID              41590099
416000     END-EXEC.                                                    41600099
416100                                                                  41610099
416200     EVALUATE TRUE                                                41620099
416300         WHEN SQLCODE = ZERO                                      41630099
416400         WHEN SQLCODE = +100                                      41640099
416500              CONTINUE                                            41650099
416600         WHEN SQLWARN0 NOT = SPACES                               41660099
416700         WHEN SQLCODE NOT EQUAL ZERO                              41670099
416800             MOVE '4100-INACTV-DIVERT-TABLE'                      41680099
416900                 TO DP013-PARAGRAPH                               41690099
417000             MOVE 'SELECT OF TSUCRDV TABLE'                       41700099
417100                 TO DP013-MESSAGE-TEXT (1)                        41710099
417200             MOVE DK-SHIPT-UNT-ID                                 41720099
417300                 TO DP013-MESSAGE-TEXT (2)                        41730099
417400             MOVE SQLCA            TO DP013-SQLCA                 41740099
417500             MOVE 'SUT_AUD_TRLR_CART'                             41750099
417600                                    TO DP013-DB2-TABLE-NAME (1)   41760099
417700             SET DP013-DB2-ABEND   TO TRUE                        41770099
417800             SET DP013-ROLLBACK TO TRUE                           41780099
417900             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               41790099
418000             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           41800099
418100             MOVE SPACES                    TO  AMSGLN2O          41810099
418200             MOVE -1                     TO  ACARTNL              41820099
418300             MOVE PV-CARTON-NBR          TO ACARTNO               41830099
418400             PERFORM 8100-SEND-DATA-ONLY                          41840099
418500             PERFORM 8200-RETURN-TRANID                           41850099
418600     END-EVALUATE.                                                41860099
418700                                                                  41870099
418800*-----------------------------------------------------------------41880099
418900*INSERT ROW TO SUT_OTBND_LOC TO SCAN CARTON OFF OF TRAILER        41890099
419000*WHEN AUDITING TO CONVEYOR OR ANOTHER TRAILER                     41900099
419100*-----------------------------------------------------------------41910099
419200 4200-INSERT-SCNOFF-OTBND-LOC.                                    41920099
419300                                                                  41930099
419400     MOVE PC046-VENDOR-SHIPT-UNT-ID    TO SUT00027-SHIPT-UNT-ID.  41940099
419500     MOVE PC033-OPER-UNT-ID            TO SUT00027-LOC-NBR.       41950099
419600     MOVE 'SHOF'                       TO SUT00027-SCN-CDE.       41960099
419700     MOVE PC033-USER-ID                TO SUT00027-CRE-USR-ID.    41970099
419800     MOVE PC046-OTBD-TRIP-ID           TO SUT00027-OTBND-TRIP-ID. 41980099
419900                                                                  41990099
420000     EXEC SQL                                                     42000099
420100         INSERT INTO SUT_OTBND_LOC                                42010099
420200               (SHIPT_UNT_ID                                      42020099
420300              , LOC_NBR                                           42030099
420400              , SCN_CDE                                           42040099
420500              , CRE_USR_ID                                        42050099
420600              , CRE_TMST                                          42060099
420700              , INBD_TRIP_ID                                      42070099
420800              , ACTV_CDE)                                         42080099
420900         VALUES (:SUT00027-SHIPT-UNT-ID                           42090099
421000               , :SUT00027-LOC-NBR                                42100099
421100               , :SUT00027-SCN-CDE                                42110099
421200               , :SUT00027-CRE-USR-ID                             42120099
421300               ,  CURRENT TIMESTAMP                               42130099
421400               , :SUT00027-INBD-TRIP-ID                           42140099
421500               , :PC-I)                                           42150099
421600     END-EXEC.                                                    42160099
421700                                                                  42170099
421800     EVALUATE TRUE                                                42180099
421900         WHEN SQLCODE = ZERO                                      42190099
422000              CONTINUE                                            42200099
422100         WHEN SQLWARN0 NOT = SPACES                               42210099
422200         WHEN SQLCODE NOT EQUAL ZERO                              42220099
422300             MOVE '4200-INSERT-SCNOFF-OTBND-LOC'                  42230099
422400                 TO DP013-PARAGRAPH                               42240099
422500             MOVE 'INSERT TO SUT_OTBND_LOC TABLE'                 42250099
422600                 TO DP013-MESSAGE-TEXT (1)                        42260099
422700             MOVE SUT00027-SHIPT-UNT-ID                           42270099
422800                 TO DP013-MESSAGE-TEXT (2)                        42280099
422900             MOVE SQLCA            TO DP013-SQLCA                 42290099
423000             MOVE 'SUT00027'                                      42300099
423100                                    TO DP013-DB2-TABLE-NAME (1)   42310099
423200             SET DP013-DB2-ABEND   TO TRUE                        42320099
423300             SET DP013-ROLLBACK TO TRUE                           42330099
423400             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               42340099
423500             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           42350099
423600             MOVE SPACES                    TO  AMSGLN2O          42360099
423700             MOVE -1                     TO  ACARTNL              42370099
423800             MOVE PV-CARTON-NBR          TO ACARTNO               42380099
423900             PERFORM 8100-SEND-DATA-ONLY                          42390099
424000             PERFORM 8200-RETURN-TRANID                           42400099
424100     END-EVALUATE.                                                42410099
424200                                                                  42420099
424300*-----------------------------------------------------------------42430099
424400* RI-EXISTS BETWEEN SUT_OTBND_LOC AND SUT_OTBND_CART, SO          42440099
424500* CARTON IDS ON SUT_OTBND_LOC MUST EXIST ON SUT_OTBND_CART        42450099
424600* VENDOR CARTONS THAT ARE PROCESSED THROUGH THE CHECK-IN APPL     42460099
424700* WILL HAVE A ROW ON TSULBXF AND REFER BACK TO THE VENDOR BARCODE 42470099
424800* ON SUT_OTBND_LOC.CARTONS CREATED FROM OTHER SOURCES             42480099
424900* (CASEPACK,SMOOTHING ETC) WILL USE THE NEWLY CREATED KOHLS       42490099
425000* BARCODE.                                                        42500099
425100*-----------------------------------------------------------------42510099
425200 4300-INACTIVATE-SHON.                                            42520099
425300                                                                  42530099
425400     MOVE PC046-VENDOR-SHIPT-UNT-ID  TO SUT00027-SHIPT-UNT-ID.    42540099
425500                                                                  42550099
425600     EXEC SQL                                                     42560099
425700         UPDATE SUT_OTBND_LOC                                     42570099
425800         SET                                                      42580099
425900             ACTV_CDE        =  :PC-I                             42590099
426000         WHERE  SHIPT_UNT_ID =  :SUT00027-SHIPT-UNT-ID            42600099
426100           AND  CRE_TMST IN                                       42610099
426200                 (SELECT MAX(B.CRE_TMST)                          42620099
426300                    FROM SUT_OTBND_LOC B                          42630099
426400                   WHERE B.SHIPT_UNT_ID = :SUT00027-SHIPT-UNT-ID) 42640099
426500     END-EXEC.                                                    42650099
426600                                                                  42660099
426700     EVALUATE TRUE                                                42670099
426800         WHEN SQLCODE = ZERO                                      42680099
426900              CONTINUE                                            42690099
427000         WHEN SQLWARN0 NOT = SPACES                               42700099
427100         WHEN SQLCODE NOT EQUAL ZERO                              42710099
427200             MOVE '4300-INACTIVATE-SHON'                          42720099
427300                 TO DP013-PARAGRAPH                               42730099
427400             MOVE 'UPDATE OF SUT_OTBND_LOC TABLE'                 42740099
427500                 TO DP013-MESSAGE-TEXT (1)                        42750099
427600             MOVE SUT00027-SHIPT-UNT-ID                           42760099
427700                 TO DP013-MESSAGE-TEXT (2)                        42770099
427800             MOVE SQLCA            TO DP013-SQLCA                 42780099
427900             MOVE 'SUT00027'                                      42790099
428000                                    TO DP013-DB2-TABLE-NAME (1)   42800099
428100             SET DP013-DB2-ABEND   TO TRUE                        42810099
428200             SET DP013-ROLLBACK TO TRUE                           42820099
428300             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               42830099
428400             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           42840099
428500             MOVE SPACES                    TO  AMSGLN2O          42850099
428600             MOVE -1                     TO  ACARTNL              42860099
428700             MOVE PV-CARTON-NBR          TO ACARTNO               42870099
428800             PERFORM 8100-SEND-DATA-ONLY                          42880099
428900             PERFORM 8200-RETURN-TRANID                           42890099
429000     END-EVALUATE.                                                42900099
429100                                                                  42910099
429200*----------------------------------------------------------------*42920099
429300 5000-DELETE-TLBPTDA.                                             42930099
429400*-------------------------------------------------------------    42940099
429500     MOVE PV-VENDOR-SSCC             TO LBPTDA-SHIPT-UNT-ID.      42950099
429600                                                                  42960099
429700     IF  PS-P2L-BOUND-BRCDE-FND                                   42970099
429800         MOVE SULBXF-SHIPT-UNT-ID    TO LBPTDA-SHIPT-UNT-ID       42980099
429900     END-IF.                                                      42990099
430000                                                                  43000099
430100     EXEC SQL                                                     43010099
430200          DELETE                                                  43020099
430300            FROM TLBPTDA                                          43030099
430400           WHERE SHIPT_UNT_ID = :LBPTDA-SHIPT-UNT-ID              43040099
430500     END-EXEC.                                                    43050099
430600                                                                  43060099
430700     EVALUATE TRUE                                                43070099
430800         WHEN SQLCODE = ZERO                                      43080099
430900         WHEN SQLCODE = +100                                      43090099
431000              CONTINUE                                            43100099
431100         WHEN SQLWARN0 NOT = SPACES                               43110099
431200         WHEN SQLCODE NOT EQUAL ZERO                              43120099
431300             MOVE '5000-DELETE-TLBPTDA '                          43130099
431400                 TO DP013-PARAGRAPH                               43140099
431500             MOVE 'DELETE OF TLBPTDA TABLE'                       43150099
431600                 TO DP013-MESSAGE-TEXT (1)                        43160099
431700             MOVE LBPTDA-SHIPT-UNT-ID                             43170099
431800                 TO DP013-MESSAGE-TEXT (2)                        43180099
431900             MOVE SQLCA            TO DP013-SQLCA                 43190099
432000             MOVE 'TLBPTDA '                                      43200099
432100                                    TO DP013-DB2-TABLE-NAME (1)   43210099
432200             SET DP013-DB2-ABEND   TO TRUE                        43220099
432300             SET DP013-ROLLBACK TO TRUE                           43230099
432400             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               43240099
432500             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           43250099
432600             MOVE SPACES                    TO  AMSGLN2O          43260099
432700             MOVE -1                     TO  ACARTNL              43270099
432800             MOVE PV-CARTON-NBR          TO ACARTNO               43280099
432900             PERFORM 8100-SEND-DATA-ONLY                          43290099
433000             PERFORM 8200-RETURN-TRANID                           43300099
433100     END-EVALUATE.                                                43310099
433200                                                                  43320099
433300*-------------------------------------------------------------    43330099
433400 5100-UPDATE-TLBVRDA.                                             43340099
433500*-------------------------------------------------------------    43350099
433600     MOVE PC046-KOHLS-BARCODE        TO  PV-BARCODE-1-22          43360099
433700     MOVE ZEROES                     TO  PV-BARCODE-1-2           43370099
433800     MOVE PV-BARCODE-1-18            TO  PV-BARCODE-3-20          43380099
433900     MOVE PV-BARCODE                 TO  LBVRDA-BRCDE-NBR         43390099
434000                                                                  43400099
434100     IF  PS-P2L-BOUND-BRCDE-FND                                   43410099
434200         MOVE SULBXF-BRCDE-NBR       TO  LBVRDA-BRCDE-NBR         43420099
434300     END-IF.                                                      43430099
434400                                                                  43440099
434500     EXEC SQL                                                     43450099
434600         UPDATE TLBVRDA                                           43460099
434700         SET                                                      43470099
434800             LBL_ASG_IND     =  'N'                               43480099
434900         WHERE  BRCDE_NBR    =  :LBVRDA-BRCDE-NBR                 43490099
435000     END-EXEC.                                                    43500099
435100                                                                  43510099
435200     EVALUATE TRUE                                                43520099
435300         WHEN SQLCODE = ZERO                                      43530099
435400         WHEN SQLCODE = +100                                      43540099
435500              CONTINUE                                            43550099
435600         WHEN SQLWARN0 NOT = SPACES                               43560099
435700         WHEN SQLCODE NOT EQUAL ZERO                              43570099
435800             MOVE '5100-UPDATE-TLBVRDA '                          43580099
435900                 TO DP013-PARAGRAPH                               43590099
436000             MOVE 'UPDATE OF TLBVRDA TABLE'                       43600099
436100                 TO DP013-MESSAGE-TEXT (1)                        43610099
436200             MOVE LBVRDA-BRCDE-NBR                                43620099
436300                 TO DP013-MESSAGE-TEXT (2)                        43630099
436400             MOVE SQLCA            TO DP013-SQLCA                 43640099
436500             MOVE 'TLBVRDA '                                      43650099
436600                                    TO DP013-DB2-TABLE-NAME (1)   43660099
436700             SET DP013-DB2-ABEND   TO TRUE                        43670099
436800             SET DP013-ROLLBACK TO TRUE                           43680099
436900             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               43690099
437000             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           43700099
437100             MOVE SPACES                    TO  AMSGLN2O          43710099
437200             MOVE -1                     TO  ACARTNL              43720099
437300             MOVE PV-CARTON-NBR          TO ACARTNO               43730099
437400             PERFORM 8100-SEND-DATA-ONLY                          43740099
437500             PERFORM 8200-RETURN-TRANID                           43750099
437600     END-EVALUATE.                                                43760099
437700                                                                  43770099
437800*----------------------------------------------------------------*43780099
437900 5200-DELETE-OTBND-LOC.                                           43790099
438000*-------------------------------------------------------------    43800099
438100     MOVE PC046-VENDOR-SHIPT-UNT-ID  TO SUT00027-SHIPT-UNT-ID.    43810099
438200                                                                  43820099
438300     EXEC SQL                                                     43830099
438400          DELETE                                                  43840099
438500            FROM SUT_OTBND_LOC                                    43850099
438600           WHERE SHIPT_UNT_ID = :SUT00027-SHIPT-UNT-ID            43860099
438700             AND SCN_CDE      = 'RECV'                            43870099
438800     END-EXEC.                                                    43880099
438900                                                                  43890099
439000     EVALUATE TRUE                                                43900099
439100         WHEN SQLCODE = ZERO                                      43910099
439200         WHEN SQLCODE = +100                                      43920099
439300              CONTINUE                                            43930099
439400         WHEN SQLWARN0 NOT = SPACES                               43940099
439500         WHEN SQLCODE NOT EQUAL ZERO                              43950099
439600             MOVE '5200-DELETE-OTBND-LOC '                        43960099
439700                 TO DP013-PARAGRAPH                               43970099
439800             MOVE 'DELETE OF TLBPTDA TABLE'                       43980099
439900                 TO DP013-MESSAGE-TEXT (1)                        43990099
440000             MOVE SUT00027-SHIPT-UNT-ID                           44000099
440100                 TO DP013-MESSAGE-TEXT (2)                        44010099
440200             MOVE SQLCA            TO DP013-SQLCA                 44020099
440300             MOVE 'SUT00027'                                      44030099
440400                                    TO DP013-DB2-TABLE-NAME (1)   44040099
440500             SET DP013-DB2-ABEND   TO TRUE                        44050099
440600             SET DP013-ROLLBACK TO TRUE                           44060099
440700             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               44070099
440800             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           44080099
440900             MOVE SPACES                    TO  AMSGLN2O          44090099
441000             MOVE -1                     TO  ACARTNL              44100099
441100             MOVE PV-CARTON-NBR          TO ACARTNO               44110099
441200             PERFORM 8100-SEND-DATA-ONLY                          44120099
441300             PERFORM 8200-RETURN-TRANID                           44130099
441400     END-EVALUATE.                                                44140099
441500                                                                  44150099
441600*-------------------------------------------------------------    44160099
441700 5250-GET-VENDOR-SSCC.                                            44170099
441800*-------------------------------------------------------------    44180099
441900*    MOVE PV-BARCODE                 TO SULBXF-BRCDE-NBR.         44190099
442000*                                                                 44200099
442100* DP CHANGED TO MOVE KOHLS BARCODE                                44210099
442200*                                                                 44220099
442300     MOVE PC046-KOHLS-BARCODE        TO  PV-BARCODE-1-22          44230099
442400     MOVE ZEROES                     TO  PV-BARCODE-1-2           44240099
442500     MOVE PV-BARCODE-1-18            TO  PV-BARCODE-3-20          44250099
442600     MOVE PV-BARCODE                 TO SULBXF-BRCDE-NBR.         44260099
442700                                                                  44270099
442800     EXEC SQL                                                     44280099
442900         SELECT  SHIPT_UNT_ID                                     44290099
443000           INTO :PV-VENDOR-SSCC                                   44300099
443100           FROM TSULBXF                                           44310099
443200          WHERE BRCDE_NBR    =  :SULBXF-BRCDE-NBR                 44320099
443300     END-EXEC.                                                    44330099
443400                                                                  44340099
443500     EVALUATE TRUE                                                44350099
443600         WHEN SQLCODE = ZERO                                      44360099
443700              CONTINUE                                            44370099
443800         WHEN SQLCODE = +100                                      44380099
443900              MOVE  ZEROES  TO  PV-VENDOR-SSCC                    44390099
444000         WHEN SQLWARN0 NOT = SPACES                               44400099
444100         WHEN SQLCODE NOT EQUAL ZERO                              44410099
444200             MOVE '5250-GET-VENDOR-SSCC'                          44420099
444300                 TO DP013-PARAGRAPH                               44430099
444400             MOVE 'GET VENDOR SSCC CODE   '                       44440099
444500                 TO DP013-MESSAGE-TEXT (1)                        44450099
444600             MOVE SQLCA            TO DP013-SQLCA                 44460099
444700             MOVE 'TSULBXF '                                      44470099
444800                                    TO DP013-DB2-TABLE-NAME (1)   44480099
444900             SET DP013-DB2-ABEND   TO TRUE                        44490099
445000             SET DP013-ROLLBACK TO TRUE                           44500099
445100             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               44510099
445200             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           44520099
445300             MOVE SPACES                    TO  AMSGLN2O          44530099
445400             MOVE -1                     TO  ACARTNL              44540099
445500             MOVE PV-CARTON-NBR          TO ACARTNO               44550099
445600             PERFORM 8100-SEND-DATA-ONLY                          44560099
445700             PERFORM 8200-RETURN-TRANID                           44570099
445800     END-EVALUATE.                                                44580099
445900                                                                  44590099
446000*--------------------------------------------------------------   44600099
446100 5300-DELETE-TSULBXF.                                             44610099
446200*-------------------------------------------------------------    44620099
446300     IF  PS-P2L-BOUND-BRCDE-FND                                   44630099
446400         CONTINUE                                                 44640099
446500     ELSE                                                         44650099
446600         MOVE PV-BARCODE             TO SULBXF-BRCDE-NBR          44660099
446700     END-IF.                                                      44670099
446800                                                                  44680099
446900     EXEC SQL                                                     44690099
447000         DELETE                                                   44700099
447100           FROM TSULBXF                                           44710099
447200          WHERE BRCDE_NBR    =  :SULBXF-BRCDE-NBR                 44720099
447300     END-EXEC.                                                    44730099
447400                                                                  44740099
447500     EVALUATE TRUE                                                44750099
447600         WHEN SQLCODE = ZERO                                      44760099
447700         WHEN SQLCODE = +100                                      44770099
447800              CONTINUE                                            44780099
447900         WHEN SQLWARN0 NOT = SPACES                               44790099
448000         WHEN SQLCODE NOT EQUAL ZERO                              44800099
448100             MOVE '5300-DELETE-TSULBXF '                          44810099
448200                 TO DP013-PARAGRAPH                               44820099
448300             MOVE 'UPDATE OF TLBVRDA TABLE'                       44830099
448400                 TO DP013-MESSAGE-TEXT (1)                        44840099
448500             MOVE LBVRDA-BRCDE-NBR                                44850099
448600                 TO DP013-MESSAGE-TEXT (2)                        44860099
448700             MOVE SQLCA            TO DP013-SQLCA                 44870099
448800             MOVE 'TSULBXF '                                      44880099
448900                                    TO DP013-DB2-TABLE-NAME (1)   44890099
449000             SET DP013-DB2-ABEND   TO TRUE                        44900099
449100             SET DP013-ROLLBACK TO TRUE                           44910099
449200             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               44920099
449300             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           44930099
449400             MOVE SPACES                    TO  AMSGLN2O          44940099
449500             MOVE -1                     TO  ACARTNL              44950099
449600             MOVE PV-CARTON-NBR          TO ACARTNO               44960099
449700             PERFORM 8100-SEND-DATA-ONLY                          44970099
449800             PERFORM 8200-RETURN-TRANID                           44980099
449900     END-EVALUATE.                                                44990099
450000                                                                  45000099
450100*---------------------------------------------------------------- 45010099
450200 5325-DELETE-TSHUNLO.                                             45020099
450300*-------------------------------------------------------------    45030099
450400     MOVE PV-VENDOR-SSCC             TO SHUNLO-SHIPT-UNT-ID.      45040099
450500                                                                  45050099
450600     EXEC SQL                                                     45060099
450700         DELETE                                                   45070099
450800           FROM TSHUNLO                                           45080099
450900          WHERE SHIPT_UNT_ID =  :SHUNLO-SHIPT-UNT-ID              45090099
451000***         AND SCN_LOC_ID   =  'RECV'                            45100099
451100            AND SCN_LOC_ID  IN ('RECV', 'RFDC', 'RFDF')           45110099
451200     END-EXEC.                                                    45120099
451300                                                                  45130099
451400     EVALUATE TRUE                                                45140099
451500         WHEN SQLCODE = ZERO                                      45150099
451600         WHEN SQLCODE = +100                                      45160099
451700              CONTINUE                                            45170099
451800         WHEN SQLWARN0 NOT = SPACES                               45180099
451900         WHEN SQLCODE NOT EQUAL ZERO                              45190099
452000             MOVE '5325-DELETE-TSHUNLO '                          45200099
452100                 TO DP013-PARAGRAPH                               45210099
452200             MOVE 'DELETE CHECK-IN ROW FROM TSHUNLO'              45220099
452300                 TO DP013-MESSAGE-TEXT (1)                        45230099
452400             MOVE SQLCA            TO DP013-SQLCA                 45240099
452500             MOVE 'TSHUNLO '                                      45250099
452600                                    TO DP013-DB2-TABLE-NAME (1)   45260099
452700             SET DP013-DB2-ABEND   TO TRUE                        45270099
452800             SET DP013-ROLLBACK TO TRUE                           45280099
452900             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               45290099
453000             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           45300099
453100             MOVE SPACES                    TO  AMSGLN2O          45310099
453200             MOVE -1                     TO  ACARTNL              45320099
453300             MOVE PV-CARTON-NBR          TO ACARTNO               45330099
453400             PERFORM 8100-SEND-DATA-ONLY                          45340099
453500             PERFORM 8200-RETURN-TRANID                           45350099
453600     END-EVALUATE.                                                45360099
453700                                                                  45370099
453800*---------------------------------------------------------------- 45380099
453900 5350-UPDATE-OTBND-CART.                                          45390099
454000*-------------------------------------------------------------    45400099
454100     MOVE PC046-VENDOR-SHIPT-UNT-ID  TO SUT00024-SHIPT-UNT-ID.    45410099
454200                                                                  45420099
454300     EXEC SQL                                                     45430099
454400         UPDATE SUT_OTBND_CART                                    45440099
454500         SET                                                      45450099
454600             ACTV_IND        =  'N'                               45460099
454700         WHERE SHIPT_UNT_ID  =  :SUT00024-SHIPT-UNT-ID            45470099
454800     END-EXEC.                                                    45480099
454900                                                                  45490099
455000     EVALUATE TRUE                                                45500099
455100         WHEN SQLCODE = ZERO                                      45510099
455200         WHEN SQLCODE = +100                                      45520099
455300              CONTINUE                                            45530099
455400         WHEN SQLWARN0 NOT = SPACES                               45540099
455500         WHEN SQLCODE NOT EQUAL ZERO                              45550099
455600             MOVE '5350-UPDATE-OTBND-CART'                        45560099
455700                 TO DP013-PARAGRAPH                               45570099
455800             MOVE 'UPDATE OF SUT_OTBND_CART TABLE'                45580099
455900                 TO DP013-MESSAGE-TEXT (1)                        45590099
456000             MOVE LBVRDA-BRCDE-NBR                                45600099
456100                 TO DP013-MESSAGE-TEXT (2)                        45610099
456200             MOVE SQLCA            TO DP013-SQLCA                 45620099
456300             MOVE 'SUT_OTBND_CART'                                45630099
456400                                    TO DP013-DB2-TABLE-NAME (1)   45640099
456500             SET DP013-DB2-ABEND   TO TRUE                        45650099
456600             SET DP013-ROLLBACK TO TRUE                           45660099
456700             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               45670099
456800             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           45680099
456900             MOVE SPACES                    TO  AMSGLN2O          45690099
457000             MOVE -1                     TO  ACARTNL              45700099
457100             MOVE PV-CARTON-NBR          TO ACARTNO               45710099
457200             PERFORM 8100-SEND-DATA-ONLY                          45720099
457300             PERFORM 8200-RETURN-TRANID                           45730099
457400     END-EVALUATE.                                                45740099
457500                                                                  45750099
457600*-----------------------------------------------------------------45760099
457700*INSERT ROW TO OTBND-LOC TO INDICATE RECLAIMED CARTON             45770099
457800*-----------------------------------------------------------------45780099
457900 5400-INSERT-RECLAIM-OTBND-LOC.                                   45790099
458000                                                                  45800099
458100     MOVE PC046-VENDOR-SHIPT-UNT-ID     TO SUT00027-SHIPT-UNT-ID. 45810099
458200     MOVE PC033-OPER-UNT-ID             TO SUT00027-LOC-NBR.      45820099
458300     IF PC033-RECLAIM                                             45830099
458400         MOVE 'RCLM'                    TO SUT00027-SCN-CDE       45840099
458500     ELSE                                                         45850099
458600         MOVE 'NUSE'                    TO SUT00027-SCN-CDE       45860099
458700     END-IF.                                                      45870099
458800     MOVE  PC033-USER-ID                TO SUT00027-CRE-USR-ID.   45880099
458900                                                                  45890099
459000     EXEC SQL                                                     45900099
459100         INSERT INTO SUT_OTBND_LOC                                45910099
459200               (SHIPT_UNT_ID                                      45920099
459300              , LOC_NBR                                           45930099
459400              , SCN_CDE                                           45940099
459500              , CRE_USR_ID                                        45950099
459600              , CRE_TMST                                          45960099
459700              , INBD_TRIP_ID                                      45970099
459800              , ACTV_CDE)                                         45980099
459900         VALUES (:SUT00027-SHIPT-UNT-ID                           45990099
460000               , :SUT00027-LOC-NBR                                46000099
460100               , :SUT00027-SCN-CDE                                46010099
460200               , :SUT00027-CRE-USR-ID                             46020099
460300               ,  CURRENT TIMESTAMP                               46030099
460400               ,  0                                               46040099
460500               , :PC-I)                                           46050099
460600     END-EXEC.                                                    46060099
460700                                                                  46070099
460800     EVALUATE TRUE                                                46080099
460900         WHEN SQLCODE = ZERO                                      46090099
461000              CONTINUE                                            46100099
461100         WHEN SQLWARN0 NOT = SPACES                               46110099
461200         WHEN SQLCODE NOT EQUAL ZERO                              46120099
461300             MOVE '5400-INSERT-RECLAIM-OTBND-LOC'                 46130099
461400                 TO DP013-PARAGRAPH                               46140099
461500             MOVE 'INSERT TO SUT_OTBND_LOC TABLE'                 46150099
461600                 TO DP013-MESSAGE-TEXT (1)                        46160099
461700             MOVE SUT00027-SHIPT-UNT-ID                           46170099
461800                 TO DP013-MESSAGE-TEXT (2)                        46180099
461900             MOVE SQLCA            TO DP013-SQLCA                 46190099
462000             MOVE 'SUT00027'       TO DP013-DB2-TABLE-NAME (1)    46200099
462100             SET DP013-DB2-ABEND   TO TRUE                        46210099
462200             SET DP013-ROLLBACK    TO TRUE                        46220099
462300             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               46230099
462400             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           46240099
462500             MOVE SPACES                    TO  AMSGLN2O          46250099
462600             MOVE -1                        TO  ACARTNL           46260099
462700             MOVE PV-CARTON-NBR          TO ACARTNO               46270099
462800             PERFORM 8100-SEND-DATA-ONLY                          46280099
462900             PERFORM 8200-RETURN-TRANID                           46290099
463000     END-EVALUATE.                                                46300099
463100                                                                  46310099
463200*--------------------------------------------------------------   46320099
463300 5450-DELETE-PRCD-MSG.                                            46330099
463400*-------------------------------------------------------------    46340099
463500     MOVE PC046-VENDOR-SHIPT-UNT-ID TO  SUT00094-SHIPT-UNT-ID     46350099
463600                                                                  46360099
463700     EXEC SQL                                                     46370099
463800         DELETE                                                   46380099
463900           FROM SUT_PRC_MSG_CNTL                                  46390099
464000          WHERE SHIPT_UNT_ID =  :SUT00094-SHIPT-UNT-ID            46400099
464100     END-EXEC.                                                    46410099
464200                                                                  46420099
464300     EVALUATE TRUE                                                46430099
464400         WHEN SQLCODE = ZERO                                      46440099
464500         WHEN SQLCODE = +100                                      46450099
464600              CONTINUE                                            46460099
464700         WHEN SQLWARN0 NOT = SPACES                               46470099
464800         WHEN SQLCODE NOT EQUAL ZERO                              46480099
464900             MOVE '5450-DELETE-PRCD-MSG'                          46490099
465000                 TO DP013-PARAGRAPH                               46500099
465100             MOVE 'DELETE PRCD MESSAGE CARTON '                   46510099
465200                 TO DP013-MESSAGE-TEXT (1)                        46520099
465300             MOVE SUT00094-SHIPT-UNT-ID                           46530099
465400                 TO DP013-MESSAGE-TEXT (2)                        46540099
465500             MOVE SQLCA            TO DP013-SQLCA                 46550099
465600             MOVE 'SUT_PRC_MSG_CNTL '                             46560099
465700                                    TO DP013-DB2-TABLE-NAME (1)   46570099
465800             SET DP013-DB2-ABEND   TO TRUE                        46580099
465900             SET DP013-ROLLBACK TO TRUE                           46590099
466000             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               46600099
466100             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           46610099
466200             MOVE SPACES                    TO  AMSGLN2O          46620099
466300             MOVE -1                     TO  ACARTNL              46630099
466400             MOVE PV-CARTON-NBR          TO ACARTNO               46640099
466500             PERFORM 8100-SEND-DATA-ONLY                          46650099
466600             PERFORM 8200-RETURN-TRANID                           46660099
466700     END-EVALUATE.                                                46670099
466800                                                                  46680099
466900*-------------------------------------------------------------    46690099
467000 5500-CHECK-PRMPTED-QC-CRTN.                                      46700099
467100*-------------------------------------------------------------    46710099
467200                                                                  46720099
467300     MOVE PV-VENDOR-SSCC             TO SUATRN-SHIPT-UNT-ID.      46730099
467400                                                                  46740099
467500     EXEC SQL                                                     46750099
467600         SELECT B.AUD_CNTL_NBR                                    46760099
467700              , A.CART_PRMPT_CDE                                  46770099
467800           INTO :SUATRN-AUD-CNTL-NBR                              46780099
467900              , :SUT00015-CART-PRMPT-CDE                          46790099
468000           FROM SUT_PO_AUD_REQ A                                  46800099
468100             ,  TSUATRN B                                         46810099
468200          WHERE B.SHIPT_UNT_ID    =  :SUATRN-SHIPT-UNT-ID         46820099
468300            AND A.AUD_CNTL_NBR    =  B.AUD_CNTL_NBR               46830099
468400            AND A.AUD_STAT_CDE    = 'I'                           46840099
468500            AND A.PKGNG_TYP_CDE    <> 'RF'                        46850099
468600            AND B.UNT_AUD_STAT_CDE <> 'CM'                        46860099
468700     END-EXEC.                                                    46870099
468800                                                                  46880099
468900     EVALUATE TRUE                                                46890099
469000         WHEN SQLCODE = ZERO                                      46900099
469100              SET PS-PRMTED-QCAUD-CRTN-YES TO TRUE                46910099
469200                                                                  46920099
469300         WHEN SQLCODE = +100                                      46930099
469400              SET PS-PRMTED-QCAUD-CRTN-NO  TO TRUE                46940099
469500                                                                  46950099
469600         WHEN SQLWARN0 NOT = SPACES                               46960099
469700         WHEN SQLCODE NOT EQUAL ZERO                              46970099
469800             MOVE '5500-CHECK-PRMPTED-QC-CRTN' TO DP013-PARAGRAPH 46980099
469900             MOVE 'CHECK FOR PRMPTED AUDITS  '                    46990099
470000                                         TO DP013-MESSAGE-TEXT (1)47000099
470100             MOVE SUATRN-SHIPT-UNT-ID    TO DP013-MESSAGE-TEXT (2)47010099
470200             MOVE SQLCA                  TO DP013-SQLCA           47020099
470300             MOVE 'TSUATRN '           TO DP013-DB2-TABLE-NAME (1)47030099
470400             MOVE 'SUT_PO_AUD_REQ'     TO DP013-DB2-TABLE-NAME (2)47040099
470500             SET DP013-DB2-ABEND       TO TRUE                    47050099
470600             SET DP013-ROLLBACK        TO TRUE                    47060099
470700             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               47070099
470800             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           47080099
470900             MOVE SPACES                    TO  AMSGLN2O          47090099
471000             MOVE -1                     TO  ACARTNL              47100099
471100             MOVE PV-CARTON-NBR          TO ACARTNO               47110099
471200             PERFORM 8100-SEND-DATA-ONLY                          47120099
471300             PERFORM 8200-RETURN-TRANID                           47130099
471400     END-EVALUATE.                                                47140099
471500                                                                  47150099
471600*-------------------------------------------------------------    47160099
471700 5505-CHECK-PRMPTED-RF-CRTN.                                      47170099
471800*-------------------------------------------------------------    47180099
471900                                                                  47190099
472000     MOVE PV-VENDOR-SSCC             TO SUATRN-SHIPT-UNT-ID.      47200099
472100                                                                  47210099
472200     EXEC SQL                                                     47220099
472300         SELECT B.AUD_CNTL_NBR                                    47230099
472400              , A.CART_PRMPT_CDE                                  47240099
472500           INTO :PV-RF-AUD-CNTL-NBR                               47250099
472600              , :PV-RF-CART-PRMPT-CDE                             47260099
472700           FROM SUT_PO_AUD_REQ A                                  47270099
472800             ,  TSUATRN B                                         47280099
472900          WHERE B.SHIPT_UNT_ID    =  :SUATRN-SHIPT-UNT-ID         47290099
473000            AND A.AUD_CNTL_NBR    =  B.AUD_CNTL_NBR               47300099
473100            AND A.AUD_STAT_CDE    = 'I'                           47310099
473200            AND A.PKGNG_TYP_CDE   = 'RF'                          47320099
473300            AND B.UNT_AUD_STAT_CDE <> 'CM'                        47330099
473400     END-EXEC.                                                    47340099
473500                                                                  47350099
473600     EVALUATE TRUE                                                47360099
473700         WHEN SQLCODE = ZERO                                      47370099
473800              SET PS-PRMTED-RFAUD-CRTN-YES TO TRUE                47380099
473900                                                                  47390099
474000         WHEN SQLCODE = +100                                      47400099
474100              SET PS-PRMTED-RFAUD-CRTN-NO  TO TRUE                47410099
474200                                                                  47420099
474300         WHEN SQLWARN0 NOT = SPACES                               47430099
474400         WHEN SQLCODE NOT EQUAL ZERO                              47440099
474500             MOVE '5505-CHECK-PRMPTED-RF-CRTN' TO DP013-PARAGRAPH 47450099
474600             MOVE 'CHECK FOR PRMPTED RF AUDITS'                   47460099
474700                                         TO DP013-MESSAGE-TEXT (1)47470099
474800             MOVE SUATRN-SHIPT-UNT-ID    TO DP013-MESSAGE-TEXT (2)47480099
474900             MOVE SQLCA                  TO DP013-SQLCA           47490099
475000             MOVE 'TSUATRN '           TO DP013-DB2-TABLE-NAME (1)47500099
475100             MOVE 'SUT_PO_AUD_REQ'     TO DP013-DB2-TABLE-NAME (2)47510099
475200             SET DP013-DB2-ABEND       TO TRUE                    47520099
475300             SET DP013-ROLLBACK        TO TRUE                    47530099
475400             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               47540099
475500             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           47550099
475600             MOVE SPACES                    TO  AMSGLN2O          47560099
475700             MOVE -1                     TO  ACARTNL              47570099
475800             MOVE PV-CARTON-NBR          TO ACARTNO               47580099
475900             PERFORM 8100-SEND-DATA-ONLY                          47590099
476000             PERFORM 8200-RETURN-TRANID                           47600099
476100     END-EVALUATE.                                                47610099
476200                                                                  47620099
476300*---------------------------------------------------------------- 47630099
476400 5600-DELETE-TSUATRN.                                             47640099
476500*-------------------------------------------------------------    47650099
476600     MOVE PV-VENDOR-SSCC             TO SHUNLO-SHIPT-UNT-ID.      47660099
476700                                                                  47670099
476800     EXEC SQL                                                     47680099
476900         DELETE                                                   47690099
477000           FROM TSUATRN                                           47700099
477100          WHERE SHIPT_UNT_ID =  :SHUNLO-SHIPT-UNT-ID              47710099
477200            AND AUD_CNTL_NBR =  :SUATRN-AUD-CNTL-NBR              47720099
477300     END-EXEC.                                                    47730099
477400                                                                  47740099
477500     EVALUATE TRUE                                                47750099
477600         WHEN SQLCODE = ZERO                                      47760099
477700         WHEN SQLCODE = +100                                      47770099
477800              CONTINUE                                            47780099
477900         WHEN SQLWARN0 NOT = SPACES                               47790099
478000         WHEN SQLCODE NOT EQUAL ZERO                              47800099
478100             MOVE '5600-DELETE-TSUATRN'  TO DP013-PARAGRAPH       47810099
478200             MOVE 'DELETE ROW FROM TSUATRN'                       47820099
478300                                         TO DP013-MESSAGE-TEXT (1)47830099
478400             MOVE SUATRN-AUD-CNTL-NBR    TO DP013-MESSAGE-TEXT (2)47840099
478500             MOVE SHUNLO-SHIPT-UNT-ID    TO DP013-MESSAGE-TEXT (3)47850099
478600             MOVE SQLCA                  TO DP013-SQLCA           47860099
478700             MOVE 'TSUATRN '       TO DP013-DB2-TABLE-NAME (1)    47870099
478800             SET DP013-DB2-ABEND   TO TRUE                        47880099
478900             SET DP013-ROLLBACK    TO TRUE                        47890099
479000             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               47900099
479100             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           47910099
479200             MOVE SPACES                    TO AMSGLN2O           47920099
479300             MOVE -1                        TO ACARTNL            47930099
479400             MOVE PV-CARTON-NBR             TO ACARTNO            47940099
479500             PERFORM 8100-SEND-DATA-ONLY                          47950099
479600             PERFORM 8200-RETURN-TRANID                           47960099
479700     END-EVALUATE.                                                47970099
479800                                                                  47980099
479900*-------------------------------------------------------------    47990099
480000 5620-AUD-QCCRTN-COUNT.                                           48000099
480100*-------------------------------------------------------------    48010099
480200     MOVE ZEROES TO PV-PRMTD-QCCRTN-COUNT.                        48020099
480300                                                                  48030099
480400     EXEC SQL                                                     48040099
480500       SELECT COUNT(*)                                            48050099
480600         INTO :PV-PRMTD-QCCRTN-COUNT                              48060099
480700         FROM TSUATRN                                             48070099
480800         WHERE AUD_CNTL_NBR   = :SUATRN-AUD-CNTL-NBR              48080099
480900     END-EXEC                                                     48090099
481000                                                                  48100099
481100     EVALUATE TRUE                                                48110099
481200         WHEN SQLCODE = +0                                        48120099
481300         WHEN SQLCODE = +100                                      48130099
481400             CONTINUE                                             48140099
481500         WHEN OTHER                                               48150099
481600             MOVE '5620-AUD-QCCRTN-COUNT'                         48160099
481700                                   TO DP013-PARAGRAPH             48170099
481800             MOVE 'COUNT PRMTPD QC CARTONS'                       48180099
481900                                   TO DP013-MESSAGE-TEXT (1)      48190099
482000             MOVE DK-SHIPT-UNT-ID  TO DP013-MESSAGE-TEXT (2)      48200099
482100             MOVE SUATRN-AUD-CNTL-NBR                             48210099
482200                                   TO DP013-MESSAGE-TEXT (3)      48220099
482300             MOVE SQLCA            TO DP013-SQLCA                 48230099
482400             MOVE 'TSUATRN '       TO DP013-DB2-TABLE-NAME (1)    48240099
482500             SET DP013-DB2-ABEND   TO TRUE                        48250099
482600             SET DP013-ROLLBACK TO TRUE                           48260099
482700             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               48270099
482800             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           48280099
482900             MOVE SPACES                    TO  AMSGLN2O          48290099
483000             MOVE -1                     TO  ACARTNL              48300099
483100             MOVE PV-CARTON-NBR          TO ACARTNO               48310099
483200             PERFORM 8100-SEND-DATA-ONLY                          48320099
483300             PERFORM 8200-RETURN-TRANID                           48330099
483400     END-EVALUATE.                                                48340099
483500                                                                  48350099
483600*-------------------------------------------------------------    48360099
483700 5630-AUD-RFCRTN-COUNT.                                           48370099
483800*-------------------------------------------------------------    48380099
483900     MOVE ZEROES TO PV-PRMTD-RFCRTN-COUNT.                        48390099
484000                                                                  48400099
484100     EXEC SQL                                                     48410099
484200       SELECT COUNT(*)                                            48420099
484300         INTO :PV-PRMTD-RFCRTN-COUNT                              48430099
484400         FROM TSUATRN                                             48440099
484500         WHERE AUD_CNTL_NBR   = :SUATRN-AUD-CNTL-NBR              48450099
484600     END-EXEC                                                     48460099
484700                                                                  48470099
484800     EVALUATE TRUE                                                48480099
484900         WHEN SQLCODE = +0                                        48490099
485000         WHEN SQLCODE = +100                                      48500099
485100             CONTINUE                                             48510099
485200         WHEN OTHER                                               48520099
485300             MOVE '5630-AUD-RFCRTN-COUNT '                        48530099
485400                                   TO DP013-PARAGRAPH             48540099
485500             MOVE 'COUNT PRMTPD RF CARTONS'                       48550099
485600                                   TO DP013-MESSAGE-TEXT (1)      48560099
485700             MOVE DK-SHIPT-UNT-ID  TO DP013-MESSAGE-TEXT (2)      48570099
485800             MOVE SUATRN-AUD-CNTL-NBR                             48580099
485900                                   TO DP013-MESSAGE-TEXT (3)      48590099
486000             MOVE SQLCA            TO DP013-SQLCA                 48600099
486100             MOVE 'TSUATRN'        TO DP013-DB2-TABLE-NAME (1)    48610099
486200             SET DP013-DB2-ABEND   TO TRUE                        48620099
486300             SET DP013-ROLLBACK    TO TRUE                        48630099
486400             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               48640099
486500             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           48650099
486600             MOVE SPACES                    TO AMSGLN2O           48660099
486700             MOVE -1                        TO ACARTNL            48670099
486800             MOVE PV-CARTON-NBR             TO ACARTNO            48680099
486900             PERFORM 8100-SEND-DATA-ONLY                          48690099
487000             PERFORM 8200-RETURN-TRANID                           48700099
487100     END-EVALUATE.                                                48710099
487200                                                                  48720099
487300*-------------------------------------------------------------    48730099
487400 5650-UPDATE-SUT-PO-AUD-REQ.                                      48740099
487500*-------------------------------------------------------------    48750099
487600                                                                  48760099
487700     EXEC SQL                                                     48770099
487800         UPDATE SUT_PO_AUD_REQ                                    48780099
487900         SET                                                      48790099
488000              CART_PRMPT_CDE  = :SUT00015-CART-PRMPT-CDE          48800099
488100           ,  AUD_STAT_CDE    = :SUT00015-AUD-STAT-CDE            48810099
488200       WHERE AUD_CNTL_NBR     = :SUATRN-AUD-CNTL-NBR              48820099
488300     END-EXEC                                                     48830099
488400                                                                  48840099
488500     EVALUATE TRUE                                                48850099
488600         WHEN SQLCODE = +0                                        48860099
488700         WHEN SQLCODE = +100                                      48870099
488800             CONTINUE                                             48880099
488900         WHEN OTHER                                               48890099
489000             MOVE '5650-UPDATE-SUT-PO-AUD-REQ' TO DP013-PARAGRAPH 48900099
489100             MOVE 'UPDATE PO AUD REQUEST TABLE'                   48910099
489200                                         TO DP013-MESSAGE-TEXT (1)48920099
489300             MOVE SUATRN-AUD-CNTL-NBR    TO DP013-MESSAGE-TEXT (2)48930099
489400             MOVE SQLCA             TO DP013-SQLCA                48940099
489500             MOVE 'SUT_PO_AUD_REQ'  TO DP013-DB2-TABLE-NAME (1)   48950099
489600             SET DP013-DB2-ABEND    TO TRUE                       48960099
489700             SET DP013-ROLLBACK     TO TRUE                       48970099
489800             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               48980099
489900             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           48990099
490000             MOVE SPACES                    TO  AMSGLN2O          49000099
490100             MOVE -1                        TO  ACARTNL           49010099
490200             MOVE PV-CARTON-NBR          TO ACARTNO               49020099
490300             PERFORM 8100-SEND-DATA-ONLY                          49030099
490400             PERFORM 8200-RETURN-TRANID                           49040099
490500     END-EVALUATE.                                                49050099
490600                                                                  49060099
490700*---------------------------------------------------------------- 49070099
490800 5660-DELETE-SUT-PO-AUD-REQ.                                      49080099
490900*-------------------------------------------------------------    49090099
491000     EXEC SQL                                                     49100099
491100         DELETE                                                   49110099
491200           FROM SUT_PO_AUD_REQ                                    49120099
491300          WHERE AUD_CNTL_NBR =  :SUATRN-AUD-CNTL-NBR              49130099
491400     END-EXEC.                                                    49140099
491500                                                                  49150099
491600     EVALUATE TRUE                                                49160099
491700         WHEN SQLCODE = ZERO                                      49170099
491800         WHEN SQLCODE = +100                                      49180099
491900              CONTINUE                                            49190099
492000         WHEN SQLWARN0 NOT = SPACES                               49200099
492100         WHEN SQLCODE NOT EQUAL ZERO                              49210099
492200             MOVE '5660-DELETE-SUT-PO-AUD-REQ'                    49220099
492300                                   TO DP013-PARAGRAPH             49230099
492400             MOVE 'DELETE ROW FROM SUT-PO-AUD-REQ'                49240099
492500                                   TO DP013-MESSAGE-TEXT (1)      49250099
492600             MOVE SUATRN-AUD-CNTL-NBR                             49260099
492700                                   TO DP013-MESSAGE-TEXT (2)      49270099
492800             MOVE SQLCA            TO DP013-SQLCA                 49280099
492900             MOVE 'SUT_PO_AUD_REQ' TO DP013-DB2-TABLE-NAME (1)    49290099
493000             SET DP013-DB2-ABEND   TO TRUE                        49300099
493100             SET DP013-ROLLBACK    TO TRUE                        49310099
493200             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               49320099
493300             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           49330099
493400             MOVE SPACES                    TO  AMSGLN2O          49340099
493500             MOVE -1               TO  ACARTNL                    49350099
493600             MOVE PV-CARTON-NBR    TO ACARTNO                     49360099
493700             PERFORM 8100-SEND-DATA-ONLY                          49370099
493800             PERFORM 8200-RETURN-TRANID                           49380099
493900     END-EVALUATE.                                                49390099
494000                                                                  49400099
494100*---------------------------------------------------------------- 49410099
494200 5670-DELETE-TSUNAUD.                                             49420099
494300*-------------------------------------------------------------    49430099
494400     EXEC SQL                                                     49440099
494500         DELETE                                                   49450099
494600           FROM TSUNAUD                                           49460099
494700          WHERE AUD_CNTL_NBR =  :SUATRN-AUD-CNTL-NBR              49470099
494800     END-EXEC.                                                    49480099
494900                                                                  49490099
495000     EVALUATE TRUE                                                49500099
495100         WHEN SQLCODE = ZERO                                      49510099
495200         WHEN SQLCODE = +100                                      49520099
495300              CONTINUE                                            49530099
495400         WHEN SQLWARN0 NOT = SPACES                               49540099
495500         WHEN SQLCODE NOT EQUAL ZERO                              49550099
495600             MOVE '5670-DELETE-TSUNAUD'                           49560099
495700                                   TO DP013-PARAGRAPH             49570099
495800             MOVE 'DELETE ROW FROM TSUNAUD '                      49580099
495900                                   TO DP013-MESSAGE-TEXT (1)      49590099
496000             MOVE SUATRN-AUD-CNTL-NBR                             49600099
496100                                   TO DP013-MESSAGE-TEXT (2)      49610099
496200             MOVE SQLCA            TO DP013-SQLCA                 49620099
496300             MOVE 'TSUNAUD '       TO DP013-DB2-TABLE-NAME (1)    49630099
496400             SET DP013-DB2-ABEND   TO TRUE                        49640099
496500             SET DP013-ROLLBACK    TO TRUE                        49650099
496600             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               49660099
496700             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           49670099
496800             MOVE SPACES                    TO  AMSGLN2O          49680099
496900             MOVE -1               TO  ACARTNL                    49690099
497000             MOVE PV-CARTON-NBR    TO ACARTNO                     49700099
497100             PERFORM 8100-SEND-DATA-ONLY                          49710099
497200             PERFORM 8200-RETURN-TRANID                           49720099
497300     END-EVALUATE.                                                49730099
497400                                                                  49740099
500600*-------------------------------------------------------------    50060099
500700 6100-CHECK-FOR-ADJUSTMENTS.                                      50070099
500800*-------------------------------------------------------------    50080099
500900        EXEC SQL                                                  50090099
501000            SELECT B.AUTO_APL_IND                                 50100099
501100              INTO :SUT00030-AUTO-APL-IND                         50110099
501200              FROM TSUQADJ A                                      50120099
501300                ,  SUT_FINCL_ADJ B                                50130099
501400             WHERE A.SHIPT_UNT_ID    =  B.SHIPT_UNT_ID            50140099
501500               AND A.SHIPT_UNT_ID    =  :SUT00024-SHIPT-UNT-ID    50150099
501600               AND A.FINCL_ADJ_ID    =  B.FINCL_ADJ_ID            50160099
501700               AND A.ADJ_TMST       >=  :DK-CARTON-TMST           50170099
501800        END-EXEC.                                                 50180099
501900                                                                  50190099
502000     EVALUATE TRUE                                                50200099
502100         WHEN SQLCODE = ZERO                                      50210099
502200         WHEN SQLCODE = -811                                      50220099
502300              SET PS-ADJSTMNTS-EXIST     TO TRUE                  50230099
502400         WHEN SQLCODE = +100                                      50240099
502500              SET PS-ADJSTMNTS-NOT-EXIST TO TRUE                  50250099
502600         WHEN SQLWARN0 NOT = SPACES                               50260099
502700         WHEN SQLCODE NOT EQUAL ZERO                              50270099
502800             MOVE '6100-CHECK-FOR-ADJUSTMENTS ' TO DP013-PARAGRAPH50280099
502900             MOVE 'CHECK FOR ADJUSTMENT DATA '                    50290099
503000                                         TO DP013-MESSAGE-TEXT (1)50300099
503100             MOVE SUT00024-SHIPT-UNT-ID  TO DP013-MESSAGE-TEXT (2)50310099
503200             MOVE SQLCA                  TO DP013-SQLCA           50320099
503300             MOVE 'TSUQADJ '           TO DP013-DB2-TABLE-NAME (1)50330099
503400             SET DP013-DB2-ABEND       TO TRUE                    50340099
503500             SET DP013-ROLLBACK        TO TRUE                    50350099
503600             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               50360099
503700             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           50370099
503800             MOVE SPACES                    TO  AMSGLN2O          50380099
503900             MOVE -1                     TO  ACARTNL              50390099
504000             MOVE PV-CARTON-NBR          TO ACARTNO               50400099
504100             PERFORM 8100-SEND-DATA-ONLY                          50410099
504200             PERFORM 8200-RETURN-TRANID                           50420099
504300     END-EVALUATE.                                                50430099
504400                                                                  50440099
504500*-------------------------------------------------------------    50450099
504600 6200-PROCESS-ADJ-CURSOR.                                         50460099
504700*-------------------------------------------------------------    50470099
504800     SET PS-APPLY-CRT-UPDATES      TO TRUE.                       50480099
504900     SET PS-MORE-FINCL-ADJST-YES TO TRUE.                         50490099
505000                                                                  50500099
505100     PERFORM 6220-OPEN-FINCL-ADJST-CURSOR.                        50510099
505200     SET PS-PROCESSING-FIRST-FETCH TO TRUE.                       50520099
505300     PERFORM 6230-FETCH-FINCL-ADJST-CSR                           50530099
505400       UNTIL PS-MORE-FINCL-ADJST-NO                               50540099
505500     PERFORM 6240-CLOSE-FINCL-ADJST-CSR.                          50550099
505600     IF RECEIV-PKGNG-CDE = 'I' OR 'M' AND                         50560099
505700        PS-APPLY-CRT-UPDATES                                      50570099
505800         MOVE 'N' TO SUT00024-ODD-UNT-IND                         50580099
505900         PERFORM 7470-UPDATE-OTBND-CART                           50590099
506000     END-IF.                                                      50600099
506100                                                                  50610099
506200*-------------------------------------------------------------    50620099
506300 6220-OPEN-FINCL-ADJST-CURSOR.                                    50630099
506400*-------------------------------------------------------------    50640099
506500     EXEC SQL                                                     50650099
506600         OPEN FINCL-ADJST                                         50660099
506700     END-EXEC.                                                    50670099
506800                                                                  50680099
506900     EVALUATE TRUE                                                50690099
507000         WHEN SQLCODE = ZERO                                      50700099
507100              CONTINUE                                            50710099
507200         WHEN SQLWARN0 NOT = SPACES                               50720099
507300         WHEN SQLCODE NOT EQUAL ZERO                              50730099
507400             MOVE '6220-OPEN-FINCL-ADJST-CURSOR'                  50740099
507500                 TO DP013-PARAGRAPH                               50750099
507600             MOVE 'SELECT FINCL ADJUSTMENT DATA '                 50760099
507700                 TO DP013-MESSAGE-TEXT (1)                        50770099
507800             MOVE DK-SHIPT-UNT-ID                                 50780099
507900                 TO DP013-MESSAGE-TEXT (2)                        50790099
508000             MOVE SQLCA            TO DP013-SQLCA                 50800099
508100             MOVE 'TSUQADJ '                                      50810099
508200                                    TO DP013-DB2-TABLE-NAME (1)   50820099
508300             SET DP013-DB2-ABEND   TO TRUE                        50830099
508400             SET DP013-ROLLBACK TO TRUE                           50840099
508500             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               50850099
508600             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           50860099
508700             MOVE SPACES                    TO  AMSGLN2O          50870099
508800             MOVE -1                     TO  ACARTNL              50880099
508900             MOVE PV-CARTON-NBR          TO ACARTNO               50890099
509000             PERFORM 8100-SEND-DATA-ONLY                          50900099
509100             PERFORM 8200-RETURN-TRANID                           50910099
509200     END-EVALUATE.                                                50920099
509300                                                                  50930099
509400******************************************************************50940099
509500 6230-FETCH-FINCL-ADJST-CSR.                                      50950099
509600******************************************************************50960099
509700     EXEC SQL                                                     50970099
509800         FETCH  FINCL-ADJST                                       50980099
509900         INTO  :SUT00030-PO-NBR                                   50990099
510000             , :SUT00030-RCVR-LNE-NBR                             51000099
510100             , :SUT00030-RCVR-SEQ-NBR                             51010099
510200             , :SUT00030-DEST-LOC-NBR                             51020099
510300             , :SUT00030-UPC-NBR                                  51030099
510400             , :SUQADJ-OPER-UNT-ID                                51040099
510500             , :SUT00030-AUTO-APL-IND                             51050099
510600             , :SUT00030-RSLV-TMST                                51060099
510700             , :SUT00030-FINCL-ADJ-ID                             51070099
510800             , :PV-FINCL-SUM-NET-QTY                              51080099
510900     END-EXEC.                                                    51090099
511000                                                                  51100099
511100     EVALUATE TRUE                                                51110099
511200         WHEN SQLCODE = ZERO                                      51120099
511300             MOVE SUT00030-DEST-LOC-NBR TO PC033-STR-NBR          51130099
511400             IF SUT00030-AUTO-APL-IND = 'Y'                       51140099
511500                 IF PS-PROCESSING-FIRST-FETCH                     51150099
511600                     PERFORM 6700-SELECT-RECEIVER                 51160099
511700                     SET PS-NOT-PROCESSING-FIRST-FETCH TO TRUE    51170099
511800                 END-IF                                           51180099
511900                 IF RECEIV-PKGNG-CDE = 'I' OR 'M'                 51190099
512000                     SET PS-PRE-PACK-PROCESSING TO TRUE           51200099
512100                     PERFORM 6235-PROCESS-PACK                    51210099
512200                 ELSE                                             51220099
512300                     SET PS-NO-PRE-PACK-PROCESSING TO TRUE        51230099
512400                     PERFORM 6250-LINK-UNT-ADJUST-MOD             51240099
512500                 END-IF                                           51250099
512600             ELSE                                                 51260099
512700                 IF SUT00030-RSLV-TMST = PC-DEFAULT-DATE          51270099
512800                    PERFORM 6600-PROC-UNSUCCESSFUL-ADJ            51280099
512900                 END-IF                                           51290099
513000             END-IF                                               51300099
513100         WHEN SQLCODE = +100                                      51310099
513200              SET PS-MORE-FINCL-ADJST-NO TO TRUE                  51320099
513300         WHEN SQLWARN0 NOT = SPACES                               51330099
513400         WHEN SQLCODE NOT EQUAL ZERO                              51340099
513500             MOVE '6230-FETCH-FINCL-ADJST-CSR '                   51350099
513600                 TO DP013-PARAGRAPH                               51360099
513700             MOVE 'FETCH FINCL ADJUSTMENT DATA '                  51370099
513800                 TO DP013-MESSAGE-TEXT (1)                        51380099
513900             MOVE SUT00024-SHIPT-UNT-ID                           51390099
514000                 TO DP013-MESSAGE-TEXT (2)                        51400099
514100             MOVE SQLCA            TO DP013-SQLCA                 51410099
514200             MOVE 'TSUQADJ '       TO DP013-DB2-TABLE-NAME (1)    51420099
514300             SET DP013-DB2-ABEND   TO TRUE                        51430099
514400             SET DP013-ROLLBACK    TO TRUE                        51440099
514500             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               51450099
514600             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           51460099
514700             MOVE SPACES                    TO  AMSGLN2O          51470099
514800             MOVE -1                     TO  ACARTNL              51480099
514900             MOVE PV-CARTON-NBR          TO ACARTNO               51490099
515000             PERFORM 8100-SEND-DATA-ONLY                          51500099
515100             PERFORM 8200-RETURN-TRANID                           51510099
515200     END-EVALUATE.                                                51520099
515300                                                                  51530099
515400 6235-PROCESS-PACK.                                               51540099
515500                                                                  51550099
515600     INITIALIZE TB-PACK-TABLE                                     51560099
515700     PERFORM 6705-SELECT-PACK-ID.                                 51570099
515800     PERFORM 6800-PROCESS-PACK.                                   51580099
515900                                                                  51590099
516000     SET PS-DONT-UPDATE-NBR-PACKS   TO TRUE.                      51600099
516100     PERFORM 6980-CALL-BEST-CASE-RTN.                             51610099
516200     IF PS-APPLY-CRT-UPDATES                                      51620099
516300         IF PS-UPDATE-NBR-PACKS                                   51630099
516400             MOVE PV-SAVE-PACK-DIFF  TO PV-PACK-DIFF              51640099
516500             PERFORM 7455-PROCESS-OTBND-PK                        51650099
516600         END-IF                                                   51660099
516700     ELSE                                                         51670099
516800         SET PS-DONT-UPDATE-NBR-PACKS   TO TRUE                   51680099
516900         SET PS-APPLY-UPDATES-SECOND-PASS  TO TRUE                51690099
517000         PERFORM 6980-CALL-BEST-CASE-RTN                          51700099
517100         IF PS-UPDATE-NBR-PACKS                                   51710099
517200             MOVE PV-SAVE-PACK-DIFF  TO PV-PACK-DIFF              51720099
517300             PERFORM 7455-PROCESS-OTBND-PK                        51730099
517400         END-IF                                                   51740099
517500         IF PS-ODD-UNITS-IN-CARTON                                51750099
517600             IF SUT00024-ODD-UNT-IND = 'Y'                        51760099
517700                 CONTINUE                                         51770099
517800             ELSE                                                 51780099
517900                 MOVE 'Y' TO SUT00024-ODD-UNT-IND                 51790099
518000                 PERFORM 7470-UPDATE-OTBND-CART                   51800099
518100             END-IF                                               51810099
518200         ELSE                                                     51820099
518300             IF SUT00024-ODD-UNT-IND = 'N'                        51830099
518400                 CONTINUE                                         51840099
518500             ELSE                                                 51850099
518600                 MOVE 'N' TO SUT00024-ODD-UNT-IND                 51860099
518700                 PERFORM 7470-UPDATE-OTBND-CART                   51870099
518800             END-IF                                               51880099
518900         END-IF                                                   51890099
519000     END-IF.                                                      51900099
519100                                                                  51910099
519200                                                                  51920099
519300*-------------------------------------------------------------    51930099
519400 6240-CLOSE-FINCL-ADJST-CSR.                                      51940099
519500*-------------------------------------------------------------    51950099
519600     EXEC SQL                                                     51960099
519700        CLOSE FINCL-ADJST                                         51970099
519800     END-EXEC.                                                    51980099
519900                                                                  51990099
520000     EVALUATE TRUE                                                52000099
520100         WHEN SQLCODE = ZERO                                      52010099
520200              CONTINUE                                            52020099
520300         WHEN SQLWARN0 NOT = SPACES                               52030099
520400         WHEN SQLCODE NOT EQUAL ZERO                              52040099
520500             MOVE '6240-CLOSE-FINCL-ADJST-CSR '                   52050099
520600                 TO DP013-PARAGRAPH                               52060099
520700             MOVE 'CLOSE FINCL ADJUSTMENT CURSOR'                 52070099
520800                 TO DP013-MESSAGE-TEXT (1)                        52080099
520900             MOVE DK-SHIPT-UNT-ID                                 52090099
521000                 TO DP013-MESSAGE-TEXT (2)                        52100099
521100             MOVE SQLCA            TO DP013-SQLCA                 52110099
521200             MOVE 'TSUQADJ '                                      52120099
521300                                    TO DP013-DB2-TABLE-NAME (1)   52130099
521400             SET DP013-DB2-ABEND   TO TRUE                        52140099
521500             SET DP013-ROLLBACK TO TRUE                           52150099
521600             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               52160099
521700             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           52170099
521800             MOVE SPACES                    TO  AMSGLN2O          52180099
521900             MOVE -1                     TO  ACARTNL              52190099
522000             MOVE PV-CARTON-NBR          TO ACARTNO               52200099
522100             PERFORM 8100-SEND-DATA-ONLY                          52210099
522200             PERFORM 8200-RETURN-TRANID                           52220099
522300     END-EVALUATE.                                                52230099
522400                                                                  52240099
522500*-------------------------------------------------------------    52250099
522600 6250-LINK-UNT-ADJUST-MOD.                                        52260099
522700*-------------------------------------------------------------    52270099
522800     SET PS-FINCL-ADJ-ID-EXISTS  TO TRUE                          52280099
522900                                                                  52290099
523000     PERFORM UNTIL PS-FINCL-ADJ-ID-NOT-EXISTS                     52300099
523100         PERFORM 6300-CREATE-RANDOM-NBR                           52310099
523200                                                                  52320099
523300         MOVE DP902-RANDOM-NUMBER TO PV-FINCL-ADJ-ID              52330099
523400         PERFORM 6350-SELECT-FINCL-ADJ                            52340099
523500     END-PERFORM                                                  52350099
523600                                                                  52360099
523700     IF PC033-RECLAIM                                             52370099
523800         MOVE 'PCKRF859'            TO SU035-PRC-RSN-CDE          52380099
523900         MOVE 'PCKRF859'            TO SU035-PROGRAM-NAME         52390099
524000         MOVE 'RECLAIM'             TO SU035-CREATE-USER-ID       52400099
524100         MOVE 'RECLAIM '            TO PV-USER-ID                 52410099
524200     ELSE                                                         52420099
524300         MOVE 'PCKRF859'            TO SU035-PRC-RSN-CDE          52430099
524400         MOVE 'PCKRF859'            TO SU035-PROGRAM-NAME         52440099
524500         MOVE 'UNUSED '             TO SU035-CREATE-USER-ID       52450099
524600         MOVE 'UNUSED  '            TO PV-USER-ID                 52460099
524700     END-IF.                                                      52470099
524800                                                                  52480099
524900     IF SUT00030-PO-NBR  > 0                                      52490099
525000         MOVE SUT00030-PO-NBR           TO SU035-PO               52500099
525100         MOVE SUT00030-RCVR-SEQ-NBR     TO SU035-REC-SEQ-NBR      52510099
525200                                           PC033-RCVR-SEQ-NBR     52520099
525300         MOVE SUT00030-RCVR-LNE-NBR     TO SU035-PO-LNE-NBR       52530099
525400         MOVE SUT00030-DEST-LOC-NBR     TO SU035-DEST-LOC-NBR     52540099
525500     ELSE                                                         52550099
525600         MOVE PC033-PO-NBR              TO SU035-PO               52560099
525700         MOVE PC033-RCVR-SEQ-NBR        TO SU035-REC-SEQ-NBR      52570099
525800         MOVE PC033-PO-LINE-NBR         TO SU035-PO-LNE-NBR       52580099
525900         MOVE SUT00024-DEST-LOC-NBR     TO SU035-DEST-LOC-NBR     52590099
526000     END-IF.                                                      52600099
526100                                                                  52610099
526200     MOVE SUT00030-UPC-NBR          TO SU035-UPC-NBR              52620099
526300                                       SUQADJ-UPC-NBR             52630099
526400                                       PC033-UPC-NBR.             52640099
526500                                                                  52650099
526600     IF SU035-NO-CHANGE OR SU035-UPDATE-ERROR                     52660099
526700         MOVE 'SYS REVS'     TO PV-USER-ID                        52670099
526800         MOVE SU035-AFTER-QTY           TO PV-FINCL-NEW-BEF-QTY   52680099
526900         MOVE SU035-BEFORE-QTY          TO PV-FINCL-NEW-AFT-QTY   52690099
527000         IF PS-PRE-PACK-PROCESSING                                52700099
527100             MOVE PACK-LINE (LINE-IDX)      TO SU035-PO-LNE-NBR   52710099
527200             MOVE PACK-UPC (LINE-IDX)       TO SU035-UPC-NBR      52720099
527300                                               SUQADJ-UPC-NBR     52730099
527400                                               PC033-UPC-NBR      52740099
527500         END-IF                                                   52750099
527600     ELSE                                                         52760099
527700         IF PS-PRE-PACK-PROCESSING                                52770099
527800             MOVE PACK-LINE (LINE-IDX)      TO SU035-PO-LNE-NBR   52780099
527900             MOVE PACK-UPC (LINE-IDX)       TO SU035-UPC-NBR      52790099
528000                                               SUQADJ-UPC-NBR     52800099
528100                                               PC033-UPC-NBR      52810099
528200         ELSE                                                     52820099
528300             PERFORM 6360-SELECT-BEF-AFT-ADJ-QTY                  52830099
528400             COMPUTE PV-FINCL-NEW-AFT-QTY =                       52840099
528500                     SUT00030-FINCL-AFT-QTY + PV-FINCL-SUM-NET-QTY52850099
528600             MOVE SUT00030-FINCL-AFT-QTY TO PV-FINCL-NEW-BEF-QTY  52860099
528700             MOVE PV-FINCL-NEW-AFT-QTY   TO SU035-AFTER-QTY       52870099
528800             MOVE PV-FINCL-NEW-BEF-QTY   TO SU035-BEFORE-QTY      52880099
528900             MOVE PV-FINCL-SUM-NET-QTY   TO SU035-ADJUST-QTY      52890099
529000             SET SU035-PACK-NO  TO TRUE                           52900099
529100             SET SU035-ODD-UNIT-NO         TO TRUE                52910099
529200         END-IF                                                   52920099
529300     END-IF.                                                      52930099
529400                                                                  52940099
529500     MOVE SUT00024-SHIPT-UNT-ID     TO SU035-SHIPT-UNT-ID         52950099
529600                                       SUQADJ-SHIPT-UNT-ID.       52960099
529700     EXEC SQL                                                     52970099
529800         SET :SU035-CRE-TMST  = CURRENT TIMESTAMP                 52980099
529900     END-EXEC.                                                    52990099
530000                                                                  53000099
530100     MOVE PC033-OPER-UNT-ID        TO SU035-ORIG-OPER-UNT-ID.     53010099
530200                                                                  53020099
530300     MOVE ZEROES                    TO SU035-ADJ-AUDIT-CNTL-NBR.  53030099
530400     MOVE -1                        TO DN-AUDIT-IND               53040099
530500                                       PC033-STR-NBR              53050099
530600     MOVE ' '                       TO SU035-CASEPACK-DELETE-IND. 53060099
530700     MOVE 'Y'                     TO SU035-UPDATE-UNTS-WORKED-IND.53070099
530800     MOVE ' '                       TO SU035-CART-CREATE-SRC.     53080099
530900     MOVE PV-FINCL-ADJ-ID           TO SU035-FINCL-ADJ-ID.        53090099
531000                                                                  53100099
531100     IF PV-FINCL-NEW-BEF-QTY NOT EQUAL  TO PV-FINCL-NEW-AFT-QTY   53110099
531200         PERFORM 6400-INSERT-TSUQADJ                              53120099
531300     END-IF.                                                      53130099
531400                                                                  53140099
531500      IF SU035-NO-CHANGE OR SU035-UPDATE-ERROR                    53150099
531600           CONTINUE                                               53160099
531700     ELSE                                                         53170099
531800         SET SU035-UPDATE-DISTDT TO TRUE                          53180099
531900         PERFORM 6500-LINK-UNIT-ADJ-MODULE                        53190099
532000     END-IF.                                                      53200099
532100                                                                  53210099
532200******************************************************************53220099
532300*  6300-CREATE-RANDOM-NBR                                        *53230099
532400*  THIS PARAGRAPH WILL RANDOMLY CREATE A NEW AUDIT CNTL NUMBER   *53240099
532500******************************************************************53250099
532600 6300-CREATE-RANDOM-NBR.                                          53260099
532700                                                                  53270099
532800     INITIALIZE DP902-RANDNBR-ROUTINE-FIELDS.                     53280099
532900     CALL PC-RANDOM-NBR-GENERATOR USING                           53290099
533000                            DFHEIBLK                              53300099
533100                            DFHCOMMAREA                           53310099
533200                            DP902-RANDNBR-ROUTINE-FIELDS.         53320099
533300                                                                  53330099
533400     IF DP902-SUCCESSFUL                                          53340099
533500         CONTINUE                                                 53350099
533600     ELSE                                                         53360099
533700         MOVE '6300-CREATE-RANDOM-NBR'   TO DP013-PARAGRAPH       53370099
533800         MOVE 'SELECT RANDOM NUMBER  '   TO DP013-MESSAGE-TEXT (1)53380099
533900         MOVE DK-SHIPT-UNT-ID            TO DP013-MESSAGE-TEXT (2)53390099
534000         MOVE SQLCA            TO DP013-SQLCA                     53400099
534100         MOVE 'TSUQADJ '       TO DP013-DB2-TABLE-NAME (1)        53410099
534200         SET DP013-DB2-ABEND   TO TRUE                            53420099
534300         SET DP013-ROLLBACK    TO TRUE                            53430099
534400         PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                   53440099
534500         MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O               53450099
534600         MOVE SPACES                    TO  AMSGLN2O              53460099
534700         MOVE -1               TO ACARTNL                         53470099
534800         MOVE PV-CARTON-NBR    TO ACARTNO                         53480099
534900         PERFORM 8100-SEND-DATA-ONLY                              53490099
535000         PERFORM 8200-RETURN-TRANID                               53500099
535100     END-IF.                                                      53510099
535200                                                                  53520099
535300*-------------------------------------------------------------    53530099
535400 6350-SELECT-FINCL-ADJ.                                           53540099
535500*-------------------------------------------------------------    53550099
535600     EXEC SQL                                                     53560099
535700         SELECT   FINCL_ADJ_ID                                    53570099
535800         INTO     :SUT00030-FINCL-ADJ-ID                          53580099
535900         FROM     SUT_FINCL_ADJ                                   53590099
536000         WHERE    FINCL_ADJ_ID = :PV-FINCL-ADJ-ID                 53600099
536100     END-EXEC.                                                    53610099
536200                                                                  53620099
536300     EVALUATE TRUE                                                53630099
536400         WHEN SQLCODE = +0                                        53640099
536500         WHEN SQLCODE = -811                                      53650099
536600             SET PS-FINCL-ADJ-ID-EXISTS TO TRUE                   53660099
536700         WHEN SQLCODE = +100                                      53670099
536800             SET PS-FINCL-ADJ-ID-NOT-EXISTS TO TRUE               53680099
536900         WHEN OTHER                                               53690099
537000             MOVE '6350-SELECT-FINCL-ADJ '                        53700099
537100                 TO DP013-PARAGRAPH                               53710099
537200             MOVE 'SELECT RANDOM NUMBER  '                        53720099
537300                 TO DP013-MESSAGE-TEXT (1)                        53730099
537400             MOVE PV-FINCL-ADJ-ID                                 53740099
537500                 TO PV-DISP-FINC-ADJ-ID                           53750099
537600             MOVE PV-DISP-FINC-ADJ-ID                             53760099
537700                 TO DP013-MESSAGE-TEXT (2)                        53770099
537800             MOVE SQLCA            TO DP013-SQLCA                 53780099
537900             MOVE 'FINCLADJ'                                      53790099
538000                                    TO DP013-DB2-TABLE-NAME (1)   53800099
538100             SET DP013-DB2-ABEND   TO TRUE                        53810099
538200             SET DP013-ROLLBACK TO TRUE                           53820099
538300             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               53830099
538400             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           53840099
538500             MOVE SPACES                    TO  AMSGLN2O          53850099
538600             MOVE -1                     TO ACARTNL               53860099
538700             MOVE PV-CARTON-NBR          TO ACARTNO               53870099
538800             PERFORM 8100-SEND-DATA-ONLY                          53880099
538900             PERFORM 8200-RETURN-TRANID                           53890099
539000     END-EVALUATE.                                                53900099
539100                                                                  53910099
539200******************************************************************53920099
539300 6360-SELECT-BEF-AFT-ADJ-QTY.                                     53930099
539400******************************************************************53940099
539500                                                                  53950099
539600     EXEC SQL                                                     53960099
539700       SELECT DISTINCT                                            53970099
539800              A.FINCL_BEF_QTY                                     53980099
539900           ,  A.FINCL_AFT_QTY                                     53990099
540000         INTO :SUT00030-FINCL-BEF-QTY                             54000099
540100            , :SUT00030-FINCL-AFT-QTY                             54010099
540200         FROM SUT_FINCL_ADJ A                                     54020099
540300        WHERE A.AUTO_APL_IND    =  'Y'                            54030099
540400          AND A.PO_NBR          = :SUT00030-PO-NBR                54040099
540500          AND A.RCVR_LNE_NBR    = :SUT00030-RCVR-LNE-NBR          54050099
540600          AND A.RCVR_SEQ_NBR    = :SUT00030-RCVR-SEQ-NBR          54060099
540700          AND A.DEST_LOC_NBR    = :SUT00030-DEST-LOC-NBR          54070099
540800          AND A.CRE_TMST        =                                 54080099
540900                (SELECT MAX(D.CRE_TMST)                           54090099
541000                FROM TSUQADJ C                                    54100099
541100             ,       SUT_FINCL_ADJ D                              54110099
541200             WHERE C.SHIPT_UNT_ID    =  D.SHIPT_UNT_ID            54120099
541300                AND C.SHIPT_UNT_ID    = :SUT00024-SHIPT-UNT-ID    54130099
541400                AND D.RCVR_LNE_NBR    = :SUT00030-RCVR-LNE-NBR    54140099
541500                AND D.AUTO_APL_IND    =  'Y' )                    54150099
541600     END-EXEC.                                                    54160099
541700                                                                  54170099
541800     EVALUATE TRUE                                                54180099
541900         WHEN SQLCODE = +0                                        54190099
542000             CONTINUE                                             54200099
542100         WHEN OTHER                                               54210099
542200             MOVE SUT00030-PO-NBR       TO PV-DISPLAY-PO          54220099
542300             MOVE SUT00030-RCVR-LNE-NBR TO PV-DISPLAY-RCVR        54230099
542400             MOVE SUT00030-RCVR-LNE-NBR TO PV-DISPLAY-LINE        54240099
542500             MOVE SUT00030-DEST-LOC-NBR TO PV-DISPLAY-DEST        54250099
542600             MOVE '6360-SELECT-BEF-AFT-ADJ-QTY'                   54260099
542700                 TO DP013-PARAGRAPH                               54270099
542800             MOVE 'SELECT MAX ADJ QTY    '                        54280099
542900                 TO DP013-MESSAGE-TEXT (1)                        54290099
543000             MOVE SUT00024-SHIPT-UNT-ID                           54300099
543100                 TO DP013-MESSAGE-TEXT (2)                        54310099
543200             STRING               PV-DISPLAY-PO '/'               54320099
543300                                  PV-DISPLAY-RCVR '/'             54330099
543400                                  PV-DISPLAY-LINE '/'             54340099
543500                                  PV-DISPLAY-DEST                 54350099
543600             DELIMITED BY SIZE                                    54360099
543700                             INTO DP013-MESSAGE-TEXT(3)           54370099
543800             MOVE SQLCA            TO DP013-SQLCA                 54380099
543900             MOVE 'SUT_FINCL_ADJ'                                 54390099
544000                                    TO DP013-DB2-TABLE-NAME (1)   54400099
544100             SET DP013-DB2-ABEND   TO TRUE                        54410099
544200             SET DP013-ROLLBACK TO TRUE                           54420099
544300             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               54430099
544400             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           54440099
544500             MOVE SPACES                    TO  AMSGLN2O          54450099
544600             MOVE -1                     TO  ACARTNL              54460099
544700             MOVE PV-CARTON-NBR          TO ACARTNO               54470099
544800             PERFORM 8100-SEND-DATA-ONLY                          54480099
544900             PERFORM 8200-RETURN-TRANID                           54490099
545000     END-EVALUATE.                                                54500099
545100                                                                  54510099
545200******************************************************************54520099
545300 6370-SELECT-BEF-AFT-ADJ-QTY.                                     54530099
545400******************************************************************54540099
545500         MOVE SU035-PO-LNE-NBR TO PC033-PO-LINE-NBR.              54550099
545600                                                                  54560099
545700     EXEC SQL                                                     54570099
545800       SELECT DISTINCT                                            54580099
545900              A.FINCL_BEF_QTY                                     54590099
546000           ,  A.FINCL_AFT_QTY                                     54600099
546100           ,  A.UPC_NBR                                           54610099
546200         INTO :SUT00030-FINCL-BEF-QTY                             54620099
546300            , :SUT00030-FINCL-AFT-QTY                             54630099
546400            , :SUT00030-UPC-NBR                                   54640099
546500         FROM SUT_FINCL_ADJ A                                     54650099
546600        WHERE A.AUTO_APL_IND    =  'N'                            54660099
546700          AND A.PO_NBR          = :PC033-PO-NBR                   54670099
546800          AND A.RCVR_LNE_NBR    = :PC033-PO-LINE-NBR              54680099
546900          AND A.RCVR_SEQ_NBR    = :PC033-RCVR-SEQ-NBR             54690099
547000          AND A.DEST_LOC_NBR    = :SUT00024-DEST-LOC-NBR          54700099
547100          AND A.CRE_TMST        =                                 54710099
547200                (SELECT MAX(D.CRE_TMST)                           54720099
547300                FROM TSUQADJ C                                    54730099
547400             ,       SUT_FINCL_ADJ D                              54740099
547500             WHERE C.SHIPT_UNT_ID    =  D.SHIPT_UNT_ID            54750099
547600                AND C.SHIPT_UNT_ID    = :SUT00024-SHIPT-UNT-ID    54760099
547700                AND D.RCVR_LNE_NBR    = :PC033-PO-LINE-NBR        54770099
547800                AND D.AUTO_APL_IND    =  'N' )                    54780099
547900     END-EXEC.                                                    54790099
548000                                                                  54800099
548100     EVALUATE TRUE                                                54810099
548200         WHEN SQLCODE = +0                                        54820099
548300             CONTINUE                                             54830099
548400         WHEN OTHER                                               54840099
548500             MOVE PC033-PO-NBR         TO PV-DISPLAY-PO           54850099
548600             MOVE PC033-RCVR-SEQ-NBR   TO PV-DISPLAY-RCVR         54860099
548700             MOVE PC033-PO-LINE-NBR    TO PV-DISPLAY-LINE         54870099
548800             MOVE SUT00024-DEST-LOC-NBR TO PV-DISPLAY-DEST        54880099
548900             MOVE '6370-SELECT-BEF-AFT-ADJ-QTY' TO DP013-PARAGRAPH54890099
549000             MOVE 'SELECT MAX ADJ QTY '  TO DP013-MESSAGE-TEXT (1)54900099
549100             MOVE SUT00024-SHIPT-UNT-ID  TO DP013-MESSAGE-TEXT (2)54910099
549200             STRING           PV-DISPLAY-PO '/'                   54920099
549300                              PV-DISPLAY-RCVR '/'                 54930099
549400                              PV-DISPLAY-LINE '/'                 54940099
549500                              PV-DISPLAY-DEST                     54950099
549600             DELIMITED BY SIZE  INTO DP013-MESSAGE-TEXT(3)        54960099
549700             STRING ' SU035 UPD TYP: '                            54970099
549800                              SU035-UPDATE-TYPE-IND               54980099
549900                    ' CRA RET MSG: '                              54990099
550000                              SU035-CRA-RET-MSG                   55000099
550100             DELIMITED BY SIZE  INTO DP013-MESSAGE-TEXT(4)        55010099
550200             MOVE SQLCA            TO DP013-SQLCA                 55020099
550300             MOVE 'SUT_FINCL_ADJ'  TO DP013-DB2-TABLE-NAME (1)    55030099
550400             SET DP013-DB2-ABEND   TO TRUE                        55040099
550500             SET DP013-ROLLBACK    TO TRUE                        55050099
550600             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               55060099
550700             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           55070099
550800             MOVE SPACES                    TO  AMSGLN2O          55080099
550900             MOVE -1                     TO  ACARTNL              55090099
551000             MOVE PV-CARTON-NBR          TO ACARTNO               55100099
551100             PERFORM 8100-SEND-DATA-ONLY                          55110099
551200             PERFORM 8200-RETURN-TRANID                           55120099
551300     END-EVALUATE.                                                55130099
551400                                                                  55140099
551500*-------------------------------------------------------------    55150099
551600 6400-INSERT-TSUQADJ.                                             55160099
551700*-------------------------------------------------------------    55170099
551800     EXEC SQL                                                     55180099
551900         INSERT INTO TSUQADJ                                      55190099
552000         (                                                        55200099
552100          SHIPT_UNT_ID                                            55210099
552200         ,UPC_NBR                                                 55220099
552300         ,ADJ_TMST                                                55230099
552400         ,OPER_UNT_ID                                             55240099
552500         ,ADJ_FUNC_CDE                                            55250099
552600         ,ADJ_BEF_QTY                                             55260099
552700         ,ADJ_AFT_QTY                                             55270099
552800         ,PRC_RSN_CDE                                             55280099
552900         ,ADJ_USR_ID                                              55290099
553000         ,AUD_CNTL_NBR                                            55300099
553100         ,FINCL_ADJ_ID                                            55310099
553200         )                                                        55320099
553300         VALUES                                                   55330099
553400         (                                                        55340099
553500          :SUT00024-SHIPT-UNT-ID                                  55350099
553600         ,:SUQADJ-UPC-NBR                                         55360099
553700         ,:SU035-CRE-TMST                                         55370099
553800         ,:SU035-ORIG-OPER-UNT-ID                                 55380099
553900         ,'U'                                                     55390099
554000         ,:PV-FINCL-NEW-BEF-QTY                                   55400099
554100         ,:PV-FINCL-NEW-AFT-QTY                                   55410099
554200         ,:SU035-PRC-RSN-CDE                                      55420099
554300         ,:PV-USER-ID                                             55430099
554400         ,:SU035-ADJ-AUDIT-CNTL-NBR :DN-AUDIT-IND                 55440099
554500         ,:PV-FINCL-ADJ-ID                                        55450099
554600         )                                                        55460099
554700     END-EXEC.                                                    55470099
554800                                                                  55480099
554900     EVALUATE TRUE                                                55490099
555000         WHEN SQLCODE = +0                                        55500099
555100             CONTINUE                                             55510099
555200         WHEN OTHER                                               55520099
555300             MOVE '6400-INSERT-TSUQADJ'  TO DP013-PARAGRAPH       55530099
555400             MOVE 'INSERT INTO TSUQADJ'  TO DP013-MESSAGE-TEXT (1)55540099
555500             MOVE DK-SHIPT-UNT-ID        TO DP013-MESSAGE-TEXT (2)55550099
555600             MOVE SQLCA            TO DP013-SQLCA                 55560099
555700             MOVE 'TSUQADJ '       TO DP013-DB2-TABLE-NAME (1)    55570099
555800             SET DP013-DB2-ABEND   TO TRUE                        55580099
555900             SET DP013-ROLLBACK    TO TRUE                        55590099
556000             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               55600099
556100             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           55610099
556200             MOVE SPACES                    TO  AMSGLN2O          55620099
556300             MOVE -1               TO  ACARTNL                    55630099
556400             MOVE PV-CARTON-NBR          TO ACARTNO               55640099
556500             PERFORM 8100-SEND-DATA-ONLY                          55650099
556600             PERFORM 8200-RETURN-TRANID                           55660099
556700     END-EVALUATE.                                                55670099
556800                                                                  55680099
556900*-------------------------------------------------------------    55690099
557000 6500-LINK-UNIT-ADJ-MODULE.                                       55700099
557100*-------------------------------------------------------------    55710099
557200     MOVE LENGTH OF SU035-COMM-AREA      TO PV-COMMAREA-LENGTH.   55720099
557300                                                                  55730099
557400     EXEC CICS                                                    55740099
557500         LINK PROGRAM  (PC-SUKUT702)                              55750099
557600              COMMAREA (SU035-COMM-AREA)                          55760099
557700              LENGTH   (PV-COMMAREA-LENGTH)                       55770099
557800              RESP     (PV-CICS-RESPONSE)                         55780099
557900     END-EXEC.                                                    55790099
558000                                                                  55800099
558100     EVALUATE TRUE                                                55810099
558200         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 55820099
558300             IF SU035-NO-CHANGE    OR    SU035-UPDATE-ERROR       55830099
558400                 PERFORM 6250-LINK-UNT-ADJUST-MOD                 55840099
558500                 SET PS-BACK-OUT-UPDATES   TO TRUE                55850099
558600             ELSE                                                 55860099
558700                 IF SU035-INVALID-SQL   OR    SU035-DATABASE-BUSY 55870099
558800                     MOVE '6500-LINK-UNIT-ADJ-MOD'  TO            55880099
558900                                                   DP013-PARAGRAPH55890099
559000                     MOVE 'LINK TO SUKUT702' TO                   55900099
559100                                            DP013-MESSAGE-TEXT (1)55910099
559200                     MOVE DK-SHIPT-UNT-ID TO                      55920099
559300                                            DP013-MESSAGE-TEXT (2)55930099
559400                     MOVE SQLCA            TO DP013-SQLCA         55940099
559500                     MOVE 'SUT_FINCL_ADJ'  TO                     55950099
559600                                          DP013-DB2-TABLE-NAME (1)55960099
559700                     SET DP013-DB2-ABEND   TO TRUE                55970099
559800                     SET DP013-ROLLBACK    TO TRUE                55980099
559900                     PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG       55990099
560000                     MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O   56000099
560100                     MOVE SPACES                    TO  AMSGLN2O  56010099
560200                     MOVE -1               TO ACARTNL             56020099
560300                     MOVE PV-CARTON-NBR    TO ACARTNO             56030099
560400                     PERFORM 8100-SEND-DATA-ONLY                  56040099
560500                     PERFORM 8200-RETURN-TRANID                   56050099
560600                 ELSE                                             56060099
560700                     PERFORM 6525-UPDATE-OTBND-UPC                56070099
560800                 END-IF                                           56080099
560900             END-IF                                               56090099
561000         WHEN OTHER                                               56100099
561100             MOVE '6500-LINK-UNIT-ADJ-MODULE'   TO DP013-PARAGRAPH56110099
561200             MOVE 'LINK TO SUKUT702 '    TO DP013-MESSAGE-TEXT (1)56120099
561300             MOVE DK-SHIPT-UNT-ID        TO DP013-MESSAGE-TEXT (2)56130099
561400             MOVE SQLCA                TO DP013-SQLCA             56140099
561500             MOVE 'SUT_FINCL_ADJ'      TO DP013-DB2-TABLE-NAME (1)56150099
561600             SET DP013-DB2-ABEND       TO TRUE                    56160099
561700             SET DP013-ROLLBACK        TO TRUE                    56170099
561800             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               56180099
561900             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           56190099
562000             MOVE SPACES                    TO  AMSGLN2O          56200099
562100             MOVE -1                   TO  ACARTNL                56210099
562200             MOVE PV-CARTON-NBR        TO ACARTNO                 56220099
562300             PERFORM 8100-SEND-DATA-ONLY                          56230099
562400             PERFORM 8200-RETURN-TRANID                           56240099
562500     END-EVALUATE.                                                56250099
562600                                                                  56260099
562700*-------------------------------------------------------------    56270099
562800 6525-UPDATE-OTBND-UPC.                                           56280099
562900*-------------------------------------------------------------    56290099
563000* FOR SOME REASON, THIS PROGRAM SEEMS TO LOSE TRACK OF THE        56300099
563100* RCVR-SEQ-NBR FROM OTBND-UPC SO I ADDED THIS SELECT.             56310099
563200* D.BRANTNER 10/21/2004                                           56320099
563300                                                                  56330099
563400     MOVE SU035-SHIPT-UNT-ID TO DK-SHIPT-UNT-ID.                  56340099
563500     MOVE SU035-AFTER-QTY    TO PV-AFTER-QTY.                     56350099
563600     MOVE SU035-PO           TO DK-PO-NBR.                        56360099
563700     MOVE SU035-PO-LNE-NBR   TO DK-PO-LINE-NBR.                   56370099
563800     MOVE SU035-UPC-NBR      TO PC033-UPC-NBR.                    56380099
563900                                                                  56390099
564000     EXEC SQL                                                     56400099
564100         SELECT DISTINCT(RCVR_SEQ_NBR)                            56410099
564200         INTO  :DK-RCVR-SEQ-NBR                                   56420099
564300         FROM   SUT_OTBND_UPC                                     56430099
564400         WHERE  SHIPT_UNT_ID   = :DK-SHIPT-UNT-ID                 56440099
564500     END-EXEC.                                                    56450099
564600     EVALUATE TRUE                                                56460099
564700         WHEN SQLCODE = +0                                        56470099
564800         WHEN SQLCODE = -811                                      56480099
564900             CONTINUE                                             56490099
565000         WHEN OTHER                                               56500099
565100             MOVE '6525-UPDATE-OTBND-UPC  '   TO DP013-PARAGRAPH  56510099
565200             MOVE 'RETRIEVE RCVR SEQ NBR '                        56520099
565300                                         TO DP013-MESSAGE-TEXT (1)56530099
565400             MOVE DK-SHIPT-UNT-ID       TO DP013-MESSAGE-TEXT (2) 56540099
565500             MOVE PC033-UPC-NBR         TO DP013-MESSAGE-TEXT(3)  56550099
565600             MOVE DK-PO-NBR             TO PV-DISPLAY-PO          56560099
565700             MOVE DK-RCVR-SEQ-NBR       TO PV-DISPLAY-RCVR        56570099
565800             MOVE DK-PO-LINE-NBR        TO PV-DISPLAY-LINE        56580099
565900             STRING 'PO NBR: '   PV-DISPLAY-PO DELIMITED BY SIZE  56590099
566000                 ' RCVR NBR: ' PV-DISPLAY-RCVR DELIMITED BY SIZE  56600099
566100                 ' LINE NBR: ' PV-DISPLAY-LINE DELIMITED BY SIZE  56610099
566200                    INTO  DP013-MESSAGE-TEXT (4)                  56620099
566300             MOVE SQLCA             TO DP013-SQLCA                56630099
566400             MOVE 'SUT_OTBND_UPC'   TO DP013-DB2-TABLE-NAME (1)   56640099
566500             SET DP013-DB2-ABEND    TO TRUE                       56650099
566600             SET DP013-ROLLBACK     TO TRUE                       56660099
566700             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               56670099
566800             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           56680099
566900             MOVE SPACES                    TO  AMSGLN2O          56690099
567000             MOVE -1                        TO  ACARTNL           56700099
567100             MOVE PV-CARTON-NBR             TO ACARTNO            56710099
567200             PERFORM 8100-SEND-DATA-ONLY                          56720099
567300             PERFORM 8200-RETURN-TRANID                           56730099
567400     END-EVALUATE.                                                56740099
567500*                                                                 56750099
567600                                                                  56760099
567700     EXEC SQL                                                     56770099
567800         UPDATE SUT_OTBND_UPC                                     56780099
567900         SET                                                      56790099
568000              SHPD_UNT_QTY    = :PV-AFTER-QTY                     56800099
568100       WHERE SHIPT_UNT_ID     = :DK-SHIPT-UNT-ID                  56810099
568200         AND  UPC_NBR         = :PC033-UPC-NBR                    56820099
568300         AND  TRN_NBR         = :DK-PO-NBR                        56830099
568400         AND  RCVR_SEQ_NBR    = :DK-RCVR-SEQ-NBR                  56840099
568500         AND  TRN_LNE_NBR     = :DK-PO-LINE-NBR                   56850099
568600     END-EXEC                                                     56860099
568700                                                                  56870099
568800     EVALUATE TRUE                                                56880099
568900         WHEN SQLCODE = +0                                        56890099
569000             CONTINUE                                             56900099
569100         WHEN OTHER                                               56910099
569200             MOVE '6525-UPDATE-OTBND-UPC  '   TO DP013-PARAGRAPH  56920099
569300             MOVE 'UPDATE OUTBOUND UPC TBLE'                      56930099
569400                                         TO DP013-MESSAGE-TEXT (1)56940099
569500             MOVE DK-SHIPT-UNT-ID       TO DP013-MESSAGE-TEXT (2) 56950099
569600             MOVE PC033-UPC-NBR         TO DP013-MESSAGE-TEXT(3)  56960099
569700             MOVE DK-PO-NBR             TO PV-DISPLAY-PO          56970099
569800             MOVE DK-RCVR-SEQ-NBR       TO PV-DISPLAY-RCVR        56980099
569900             MOVE DK-PO-LINE-NBR        TO PV-DISPLAY-LINE        56990099
570000             STRING 'PO NBR: '   PV-DISPLAY-PO DELIMITED BY SIZE  57000099
570100                 ' RCVR NBR: ' PV-DISPLAY-RCVR DELIMITED BY SIZE  57010099
570200                 ' LINE NBR: ' PV-DISPLAY-LINE DELIMITED BY SIZE  57020099
570300                    INTO  DP013-MESSAGE-TEXT (4)                  57030099
570400             MOVE SQLCA             TO DP013-SQLCA                57040099
570500             MOVE 'SUT_OTBND_UPC'   TO DP013-DB2-TABLE-NAME (1)   57050099
570600             SET DP013-DB2-ABEND    TO TRUE                       57060099
570700             SET DP013-ROLLBACK     TO TRUE                       57070099
570800             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               57080099
570900             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           57090099
571000             MOVE SPACES                    TO  AMSGLN2O          57100099
571100             MOVE -1                        TO  ACARTNL           57110099
571200             MOVE PV-CARTON-NBR             TO ACARTNO            57120099
571300             PERFORM 8100-SEND-DATA-ONLY                          57130099
571400             PERFORM 8200-RETURN-TRANID                           57140099
571500     END-EVALUATE.                                                57150099
571600                                                                  57160099
571700*-------------------------------------------------------------    57170099
571800 6600-PROC-UNSUCCESSFUL-ADJ.                                      57180099
571900*-------------------------------------------------------------    57190099
572000     PERFORM 6605-COUNT-ADJUSTMENTS.                              57200099
572100     IF PV-ADJUST-COUNT = 1                                       57210099
572200        PERFORM 6610-FIND-UNRESOLVED-TROUBLE                      57220099
572300        IF PS-TRBL-FOUND                                          57230099
572400           PERFORM 6650-RESOLVE-TROUBLE                           57240099
572500        END-IF                                                    57250099
572600        PERFORM 6670-ACKNOWLEDGE-FAILED-ADJ                       57260099
572700     ELSE                                                         57270099
572800         IF PV-ADJUST-COUNT > 1                                   57280099
572900            PERFORM 6670-ACKNOWLEDGE-FAILED-ADJ                   57290099
573000         END-IF                                                   57300099
573100     END-IF.                                                      57310099
573200                                                                  57320099
573300*-------------------------------------------------------------    57330099
573400 6605-COUNT-ADJUSTMENTS.                                          57340099
573500*-------------------------------------------------------------    57350099
573600     EXEC SQL                                                     57360099
573700       SELECT COUNT(*)                                            57370099
573800         INTO :PV-ADJUST-COUNT                                    57380099
573900         FROM SUT_FINCL_ADJ                                       57390099
574000         WHERE PO_NBR         = :SUT00030-PO-NBR                  57400099
574100           AND RCVR_SEQ_NBR   = :SUT00030-RCVR-SEQ-NBR            57410099
574200           AND RCVR_LNE_NBR   = :SUT00030-RCVR-LNE-NBR            57420099
574300           AND AUTO_APL_IND   = 'N'                               57430099
574400           AND RSLV_TMST      = '9999-09-09-09.09.09.999999'      57440099
574500     END-EXEC                                                     57450099
574600                                                                  57460099
574700     EVALUATE TRUE                                                57470099
574800         WHEN SQLCODE = +0                                        57480099
574900         WHEN SQLCODE = +100                                      57490099
575000             CONTINUE                                             57500099
575100         WHEN OTHER                                               57510099
575200             MOVE '6605-COUNT-ADJUSTMENTS '                       57520099
575300                 TO DP013-PARAGRAPH                               57530099
575400             MOVE 'COUNT UNRESOLVED TROUBLE'                      57540099
575500                 TO DP013-MESSAGE-TEXT (1)                        57550099
575600             MOVE DK-SHIPT-UNT-ID                                 57560099
575700                 TO DP013-MESSAGE-TEXT (2)                        57570099
575800             MOVE SQLCA            TO DP013-SQLCA                 57580099
575900             MOVE 'SUT_FINCL_ADJ'                                 57590099
576000                                    TO DP013-DB2-TABLE-NAME (1)   57600099
576100             SET DP013-DB2-ABEND   TO TRUE                        57610099
576200             SET DP013-ROLLBACK TO TRUE                           57620099
576300             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               57630099
576400             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           57640099
576500             MOVE SPACES                    TO  AMSGLN2O          57650099
576600             MOVE -1                     TO  ACARTNL              57660099
576700             MOVE PV-CARTON-NBR          TO ACARTNO               57670099
576800             PERFORM 8100-SEND-DATA-ONLY                          57680099
576900             PERFORM 8200-RETURN-TRANID                           57690099
577000     END-EVALUATE.                                                57700099
577100                                                                  57710099
577200*-------------------------------------------------------------    57720099
577300 6610-FIND-UNRESOLVED-TROUBLE.                                    57730099
577400*-------------------------------------------------------------    57740099
577500     EXEC SQL                                                     57750099
577600         SELECT NOTIF_NBR                                         57760099
577700             INTO :TRBNTF-NOTIF-NBR                               57770099
577800             FROM TTRBNTF                                         57780099
577900             WHERE PO_NBR         = :SUT00030-PO-NBR              57790099
578000               AND TRBL_RSN_CDE   = 371                           57800099
578100               AND REC_SEQ_NBR    = :SUT00030-RCVR-SEQ-NBR        57810099
578200               AND PO_LNE_NBR     = :SUT00030-RCVR-LNE-NBR        57820099
578300               AND RESOLVED_IND IN ('N', 'I')                     57830099
578400     END-EXEC                                                     57840099
578500                                                                  57850099
578600     EVALUATE TRUE                                                57860099
578700         WHEN SQLCODE = +0                                        57870099
578800         WHEN SQLCODE = -811                                      57880099
578900             SET PS-TRBL-FOUND TO TRUE                            57890099
579000         WHEN SQLCODE = +100                                      57900099
579100             SET PS-TRBL-NOT-FOUND TO TRUE                        57910099
579200         WHEN OTHER                                               57920099
579300             MOVE '6610-FIND-UNRESOLVED-TROUBLE'                  57930099
579400                 TO DP013-PARAGRAPH                               57940099
579500             MOVE 'CHECK FOR TROUBLE     '                        57950099
579600                 TO DP013-MESSAGE-TEXT (1)                        57960099
579700             MOVE DK-SHIPT-UNT-ID                                 57970099
579800                 TO DP013-MESSAGE-TEXT (2)                        57980099
579900             MOVE SQLCA            TO DP013-SQLCA                 57990099
580000             MOVE 'TTRBNTF '                                      58000099
580100                                    TO DP013-DB2-TABLE-NAME (1)   58010099
580200             SET DP013-DB2-ABEND   TO TRUE                        58020099
580300             SET DP013-ROLLBACK TO TRUE                           58030099
580400             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               58040099
580500             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           58050099
580600             MOVE SPACES                    TO  AMSGLN2O          58060099
580700             MOVE -1                     TO  ACARTNL              58070099
580800             MOVE PV-CARTON-NBR          TO ACARTNO               58080099
580900             PERFORM 8100-SEND-DATA-ONLY                          58090099
581000             PERFORM 8200-RETURN-TRANID                           58100099
581100     END-EVALUATE.                                                58110099
581200                                                                  58120099
581300*-------------------------------------------------------------    58130099
581400 6650-RESOLVE-TROUBLE.                                            58140099
581500*-------------------------------------------------------------    58150099
581600     INITIALIZE TM500-FIELDS.                                     58160099
581700     SET TM500-UPDATE                                             58170099
581800         TM500-NO-DETAILS                                         58180099
581900         TM500-RESOLVE-SPECIFIC    TO  TRUE.                      58190099
582000                                                                  58200099
582100     MOVE 0                        TO  TM500-NOTIF-NBR.           58210099
582200     MOVE SUQADJ-OPER-UNT-ID       TO  TM500-OPER-UNT-ID.         58220099
582300     MOVE 1                        TO  TM500-FCLTY-ID.            58230099
582400                                                                  58240099
582500     MOVE SUT00030-PO-NBR          TO  TM500-PO-NBR.              58250099
582600                                                                  58260099
582700     MOVE SUT00030-RCVR-LNE-NBR    TO  TM500-PO-LNE-NBR.          58270099
582800     IF SUT00030-RCVR-LNE-NBR > 0                                 58280099
582900         SET TM500-LINE-LEVEL      TO  TRUE                       58290099
583000     ELSE                                                         58300099
583100         SET TM500-PO-LEVEL        TO  TRUE                       58310099
583200     END-IF.                                                      58320099
583300                                                                  58330099
583400     MOVE SUT00030-RCVR-SEQ-NBR    TO  TM500-REC-SEQ-NBR.         58340099
583500     MOVE 371                      TO  TM500-TRBL-RSN-CDE.        58350099
583600                                                                  58360099
583700     MOVE 'PCKRF859'               TO  TM500-CRE-UID              58370099
583800                                       TM500-NOTIF-UID.           58380099
583900     MOVE PC033-USER-ID            TO  TM500-RESOLVED-UID         58390099
584000                                       TM500-ACKNOWLG-UID.        58400099
584100                                                                  58410099
584200     STRING 'FAILED ADJUSTMENT SYSTEMICALLY ACKNOWLEDGED '        58420099
584300            'DUE TO RECLAIM ACTION APPLIED TO THIS CARTON'        58430099
584400                      DELIMITED BY SIZE                           58440099
584500            INTO TM500-FREEFORM-TEXT.                             58450099
584600                                                                  58460099
584700                                                                  58470099
584800     EXEC CICS LINK                                               58480099
584900          PROGRAM (PC-TMKCS520)                                   58490099
585000          COMMAREA(TM500-FIELDS)                                  58500099
585100          RESP    (PV-CICS-RESPONSE)                              58510099
585200     END-EXEC.                                                    58520099
585300                                                                  58530099
585400     IF TM500-CALL-SUCCESSFUL                                     58540099
585500             CONTINUE                                             58550099
585600     ELSE                                                         58560099
585700           MOVE '6650-RESOLVE-TROUBLE-CALL-TMKCS520'              58570099
585800               TO DP013-PARAGRAPH                                 58580099
585900           MOVE 'RESOLVE TROUBLE      '                           58590099
586000               TO DP013-MESSAGE-TEXT (1)                          58600099
586100           MOVE DK-SHIPT-UNT-ID                                   58610099
586200               TO DP013-MESSAGE-TEXT (2)                          58620099
586300           STRING 'SQL '                                          58630099
586400                TM500-SQLCODE                                     58640099
586500                ' NOTIF NBR '                                     58650099
586600                PV-DISP-NOTIF-NBR                                 58660099
586700                      DELIMITED BY SIZE                           58670099
586800                                   INTO DP013-MESSAGE-TEXT(3)     58680099
586900           MOVE TM500-RETURN-MSG       TO DP013-MESSAGE-TEXT(4)   58690099
587000           MOVE SQLCA            TO DP013-SQLCA                   58700099
587100           MOVE 'TTRBNTF '                                        58710099
587200                                  TO DP013-DB2-TABLE-NAME (1)     58720099
587300           SET DP013-DB2-ABEND   TO TRUE                          58730099
587400           SET DP013-ROLLBACK TO TRUE                             58740099
587500           PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                 58750099
587600           MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O             58760099
587700           MOVE SPACES                    TO  AMSGLN2O            58770099
587800           MOVE -1                     TO  ACARTNL                58780099
587900           MOVE PV-CARTON-NBR          TO ACARTNO                 58790099
588000           PERFORM 8100-SEND-DATA-ONLY                            58800099
588100           PERFORM 8200-RETURN-TRANID                             58810099
588200         MOVE '6650-RESOLVE-TROUBLE'                              58820099
588300                                TO DP013-PARAGRAPH                58830099
588400         MOVE 'CALL TMKCS520  ' TO DP013-MESSAGE-TEXT(1)          58840099
588500         MOVE SQLCA             TO DP013-SQLCA                    58850099
588600         MOVE SUT00030-PO-NBR   TO PV-DISPLAY-PO                  58860099
588700         MOVE SUT00030-RCVR-SEQ-NBR TO PV-DISPLAY-RCVR            58870099
588800         MOVE TM500-PO-LNE-NBR  TO PV-DISPLAY-LINE                58880099
588900         MOVE TM500-NOTIF-NBR   TO PV-DISP-NOTIF-NBR              58890099
589000         STRING 'PO '                                             58900099
589100                PV-DISPLAY-PO                                     58910099
589200                ' RECV '                                          58920099
589300                PV-DISPLAY-RCVR                                   58930099
589400                ' LINE '                                          58940099
589500                PV-DISPLAY-LINE                                   58950099
589600                ' RET CDE '                                       58960099
589700                TM500-RETURN-CODE                                 58970099
589800                      DELIMITED BY SIZE                           58980099
589900                                   INTO DP013-MESSAGE-TEXT(2)     58990099
590000         STRING 'SQL '                                            59000099
590100                TM500-SQLCODE                                     59010099
590200                ' NOTIF NBR '                                     59020099
590300                PV-DISP-NOTIF-NBR                                 59030099
590400                      DELIMITED BY SIZE                           59040099
590500                                   INTO DP013-MESSAGE-TEXT(3)     59050099
590600         MOVE TM500-RETURN-MSG       TO DP013-MESSAGE-TEXT(4)     59060099
590700         SET DP013-DB2-ABEND   TO TRUE                            59070099
590800         SET DP013-ROLLBACK TO TRUE                               59080099
590900         PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                   59090099
591000         MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O               59100099
591100         MOVE SPACES                    TO  AMSGLN2O              59110099
591200         MOVE -1                     TO  ACARTNL                  59120099
591300         MOVE PV-CARTON-NBR          TO ACARTNO                   59130099
591400         PERFORM 8100-SEND-DATA-ONLY                              59140099
591500         PERFORM 8200-RETURN-TRANID                               59150099
591600     END-IF.                                                      59160099
591700                                                                  59170099
591800*-------------------------------------------------------------    59180099
591900 6670-ACKNOWLEDGE-FAILED-ADJ.                                     59190099
592000*-------------------------------------------------------------    59200099
592100     EXEC SQL                                                     59210099
592200       UPDATE SUT_FINCL_ADJ                                       59220099
592300          SET RSLV_CMNT_TXT  = :TM500-FREEFORM-TEXT               59230099
592400             ,RSLV_BY_USR_ID = :PC033-USER-ID                     59240099
592500             ,RSLV_TMST      = CURRENT TIMESTAMP                  59250099
592600       WHERE  FINCL_ADJ_ID   = :SUT00030-FINCL-ADJ-ID             59260099
592700     END-EXEC                                                     59270099
592800                                                                  59280099
592900     EVALUATE TRUE                                                59290099
593000         WHEN SQLCODE = +0                                        59300099
593100         WHEN SQLCODE = +100                                      59310099
593200             CONTINUE                                             59320099
593300         WHEN OTHER                                               59330099
593400             MOVE '6670-ACKNOWLEDGE-FAILED-ADJ'                   59340099
593500                                   TO PV-CURRENT-PARAGRAPH        59350099
593600             MOVE SUT00030-FINCL-ADJ-ID  TO PV-DISP-FINC-ADJ-ID   59360099
593700             MOVE DK-SHIPT-UNT-ID        TO PV-DISP-CARTON-ID     59370099
593800             MOVE SQLCODE                TO PV-ERROR-CONDITION    59380099
593900             STRING PC-CURRENT-PROGRAM-NAME  ' - '                59390099
594000                    PV-CURRENT-PARAGRAPH     ' - '                59400099
594100                    PV-DISP-FINC-ADJ-ID      ' - '                59410099
594200                    PV-DISP-CARTON-ID        ' - '                59420099
594300                    PV-ERROR-CONDITION                            59430099
594400                    DELIMITED BY SIZE                             59440099
594500                    INTO PV-CICS-MSG-AREA2                        59450099
594600             PERFORM 1940-WRITE-TO-CICS-LOG                       59460099
594700                                                                  59470099
594800             MOVE '6670-ACKNOWLEDGE-FAILED-ADJ '                  59480099
594900                 TO DP013-PARAGRAPH                               59490099
595000             MOVE 'ACK FAILED ADJUSTMENT '                        59500099
595100                 TO DP013-MESSAGE-TEXT (1)                        59510099
595200             MOVE DK-SHIPT-UNT-ID                                 59520099
595300                 TO DP013-MESSAGE-TEXT (2)                        59530099
595400             MOVE SQLCA            TO DP013-SQLCA                 59540099
595500             MOVE 'SUT_FINCL_ADJ'                                 59550099
595600                                    TO DP013-DB2-TABLE-NAME (1)   59560099
595700             SET DP013-DB2-ABEND   TO TRUE                        59570099
595800             SET DP013-ROLLBACK TO TRUE                           59580099
595900             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               59590099
596000             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           59600099
596100             MOVE SPACES                    TO  AMSGLN2O          59610099
596200             MOVE -1                     TO  ACARTNL              59620099
596300             MOVE PV-CARTON-NBR          TO ACARTNO               59630099
596400             PERFORM 8100-SEND-DATA-ONLY                          59640099
596500             PERFORM 8200-RETURN-TRANID                           59650099
596600     END-EVALUATE.                                                59660099
596700                                                                  59670099
596800 6700-SELECT-RECEIVER.                                            59680099
596900     MOVE '6700' TO PV-CURRENT-PARAGRAPH.                         59690099
597000     MOVE SUT00030-PO-NBR     TO DK-PO-NBR.                       59700099
597100     MOVE SUT00030-RCVR-SEQ-NBR                                   59710099
597200                              TO DK-REC-SEQ-NBR.                  59720099
597300                                                                  59730099
597400     EXEC SQL                                                     59740099
597500        SELECT                                                    59750099
597600                PACK_BY_ST_IND                                    59760099
597700            ,   PKGNG_CDE                                         59770099
597800          INTO                                                    59780099
597900                :RECEIV-PACK-BY-ST-IND                            59790099
598000            ,   :RECEIV-PKGNG-CDE                                 59800099
598100          FROM  TRECEIV                                           59810099
598200          WHERE ORD_NBR           = :DK-PO-NBR                    59820099
598300            AND REC_SEQ_NBR       = :DK-REC-SEQ-NBR               59830099
598400     END-EXEC.                                                    59840099
598500                                                                  59850099
598600                                                                  59860099
598700     EVALUATE TRUE                                                59870099
598800         WHEN SQLCODE = ZERO                                      59880099
598900             CONTINUE                                             59890099
599000         WHEN SQLWARN0 NOT = SPACES                               59900099
599100         WHEN SQLCODE < ZERO                                      59910099
599200         WHEN SQLCODE > ZERO                                      59920099
599300             MOVE '6700-SELECT-RECEIVER'                          59930099
599400                 TO DP013-PARAGRAPH                               59940099
599500             MOVE SQLCA            TO DP013-SQLCA                 59950099
599600             MOVE 'TRECEIV      '  TO DP013-DB2-TABLE-NAME (1)    59960099
599700             PERFORM 1900-FORMAT-MSG-AREA                         59970099
599800             PERFORM 1980-CALL-ERROR-RTN                          59980099
599900     END-EVALUATE.                                                59990099
600000                                                                  60000099
600100                                                                  60010099
600200 6705-SELECT-PACK-ID.                                             60020099
600300                                                                  60030099
600400     MOVE '6705' TO PV-CURRENT-PARAGRAPH.                         60040099
600500     EXEC SQL                                                     60050099
600600          SELECT A.PREPK_ID                                       60060099
600700          INTO  :RECITM-PREPK-ID                                  60070099
600800          FROM   TRECITM A                                        60080099
600900             ,   TSHUUPC B                                        60090099
601000          WHERE A.ORD_NBR            =  :DK-PO-NBR                60100099
601100           AND  A.REC_SEQ_NBR        =  :DK-REC-SEQ-NBR           60110099
601200           AND  A.PREPK_DRV_LNE_CDE  =  'A'                       60120099
601300           AND  A.ORD_NBR            =  B.TRN_NBR                 60130099
601400           AND  A.ORD_LNE_NBR        =  B.TRN_LNE_NBR             60140099
601500           AND  B.SHIPT_UNT_ID       =  :DK-VENDOR-SHIPT-UNT      60150099
601600     END-EXEC.                                                    60160099
601700                                                                  60170099
601800     EVALUATE TRUE                                                60180099
601900         WHEN SQLCODE = ZERO                                      60190099
602000             MOVE RECITM-PREPK-ID   TO DK-PACK-ID                 60200099
602100                                                                  60210099
602200         WHEN SQLCODE = +100                                      60220099
602300             MOVE 0                 TO DK-PACK-ID                 60230099
602400                                       RECITM-PREPK-ID            60240099
602500                                                                  60250099
602600         WHEN SQLWARN0 NOT = SPACES                               60260099
602700         WHEN SQLCODE < ZERO                                      60270099
602800         WHEN SQLCODE > ZERO                                      60280099
602900             MOVE '6705-SELECT-PACK-ID '                          60290099
603000                 TO DP013-PARAGRAPH                               60300099
603100             MOVE SQLCA            TO DP013-SQLCA                 60310099
603200             MOVE 'TRECITM      '  TO DP013-DB2-TABLE-NAME (1)    60320099
603300             MOVE DK-VENDOR-SHIPT-UNT   TO PV-DISP-SHIPT-UNT-ID   60330099
603400             PERFORM 1900-FORMAT-MSG-AREA                         60340099
603500             PERFORM 1980-CALL-ERROR-RTN                          60350099
603600     END-EVALUATE.                                                60360099
603700                                                                  60370099
603800 6800-PROCESS-PACK.                                               60380099
603900     PERFORM 6900-OPEN-PACK-CURSOR.                               60390099
604000     PERFORM 6910-PROCESS-PACK-CURSOR.                            60400099
604100     PERFORM 6960-CLOSE-PACK-CURSOR.                              60410099
604200                                                                  60420099
604300 6900-OPEN-PACK-CURSOR.                                           60430099
604400                                                                  60440099
604500     MOVE '6900' TO PV-CURRENT-PARAGRAPH.                         60450099
604600     EXEC SQL                                                     60460099
604700         OPEN PACK-CURSOR                                         60470099
604800     END-EXEC.                                                    60480099
604900                                                                  60490099
605000     EVALUATE TRUE                                                60500099
605100         WHEN SQLCODE = ZERO                                      60510099
605200             SET PS-NOT-EOC-PAC-CSR           TO TRUE             60520099
605300                                                                  60530099
605400         WHEN SQLWARN0 NOT = SPACES                               60540099
605500         WHEN SQLCODE < ZERO                                      60550099
605600         WHEN SQLCODE > ZERO                                      60560099
605700             MOVE '6900-OPEN-PACK-CURSOR'                         60570099
605800                 TO DP013-PARAGRAPH                               60580099
605900             MOVE SQLCA            TO DP013-SQLCA                 60590099
606000             MOVE 'TRECITM       ' TO DP013-DB2-TABLE-NAME (1)    60600099
606100             PERFORM 1900-FORMAT-MSG-AREA                         60610099
606200             PERFORM 1980-CALL-ERROR-RTN                          60620099
606300     END-EVALUATE.                                                60630099
606400                                                                  60640099
606500 6910-PROCESS-PACK-CURSOR.                                        60650099
606600     MOVE '6910' TO PV-CURRENT-PARAGRAPH.                         60660099
606700     SET PS-NO-PACK-RECS-PROCESSED   TO TRUE.                     60670099
606800     PERFORM 6930-FETCH-PACK-CURSOR                               60680099
606900         VARYING LINE-IDX FROM 1 BY 1                             60690099
607000         UNTIL  LINE-IDX > 500                                    60700099
607100            OR PS-EOC-PAC-CSR.                                    60710099
607200                                                                  60720099
607300                                                                  60730099
607400     IF LINE-IDX > 500                                            60740099
607500         MOVE '6910-PROCESS-PACK-CURSOR'                          60750099
607600             TO DP013-PARAGRAPH                                   60760099
607700         MOVE ' MORE THAN 500 ITEMS' TO DP013-MESSAGE-TEXT (1)    60770099
607800         MOVE SQLCA            TO DP013-SQLCA                     60780099
607900         PERFORM 1900-FORMAT-MSG-AREA                             60790099
608000         PERFORM 1980-CALL-ERROR-RTN                              60800099
608100     END-IF.                                                      60810099
608200                                                                  60820099
608300 6930-FETCH-PACK-CURSOR.                                          60830099
608400                                                                  60840099
608500     MOVE '6930' TO PV-CURRENT-PARAGRAPH.                         60850099
608600     EXEC SQL                                                     60860099
608700          FETCH PACK-CURSOR                                       60870099
608800          INTO  :RECITM-ORD-LNE-NBR                               60880099
608900              , :RECITM-ITM-NBR                                   60890099
609000              , :RECITM-STATUS-CDE                                60900099
609100              , :RECITM-PREPK-RATO-QTY                            60910099
609200              , :RECITM-PREPK-DRV-LNE-CDE                         60920099
609300              , :RECITM-PREPK-ID                                  60930099
609400     END-EXEC.                                                    60940099
609500                                                                  60950099
609600     EVALUATE TRUE                                                60960099
609700         WHEN SQLCODE = ZERO                                      60970099
609800             MOVE RECITM-PREPK-RATO-QTY                           60980099
609900                                    TO PACK-RATO (LINE-IDX)       60990099
610000             MOVE 'Y'               TO PACK-IND (LINE-IDX)        61000099
610100             MOVE RECITM-ITM-NBR    TO PACK-ITM (LINE-IDX)        61010099
610200             MOVE RECITM-PREPK-DRV-LNE-CDE                        61020099
610300                      TO PACK-PREPK-DRV-LNE-CDE (LINE-IDX)        61030099
610400             MOVE RECITM-PREPK-ID                                 61040099
610500                      TO PACK-PRPPK-ID (LINE-IDX)                 61050099
610600             MOVE RECITM-ORD-LNE-NBR TO PACK-LINE (LINE-IDX)      61060099
610700             PERFORM 6940-GET-QUANTITY                            61070099
610800                                                                  61080099
610900         WHEN SQLCODE = +100                                      61090099
611000             SET PS-EOC-PAC-CSR           TO TRUE                 61100099
611100                                                                  61110099
611200         WHEN SQLWARN0 NOT = SPACES                               61120099
611300         WHEN SQLCODE < ZERO                                      61130099
611400         WHEN SQLCODE > ZERO                                      61140099
611500             MOVE '6930-FETCH-PACK-CURSOR'                        61150099
611600                 TO DP013-PARAGRAPH                               61160099
611700             MOVE SQLCA            TO DP013-SQLCA                 61170099
611800             MOVE 'TRECITM       ' TO DP013-DB2-TABLE-NAME (1)    61180099
611900             PERFORM 1900-FORMAT-MSG-AREA                         61190099
612000             PERFORM 1980-CALL-ERROR-RTN                          61200099
612100     END-EVALUATE.                                                61210099
612200                                                                  61220099
612300 6940-GET-QUANTITY.                                               61230099
612400     PERFORM 6950-SELECT-QUANTITY.                                61240099
612500     MOVE SUT00028-SHPD-UNT-QTY                                   61250099
612600                      TO PACK-CRTN-QTY  (LINE-IDX).               61260099
612700     MOVE SUT00028-UPC-NBR                                        61270099
612800                      TO PACK-UPC  (LINE-IDX).                    61280099
612900     IF SUT00030-RCVR-LNE-NBR = RECITM-ORD-LNE-NBR                61290099
613000         COMPUTE PACK-AUDIT-QTY (LINE-IDX) =                      61300099
613100              SUT00028-SHPD-UNT-QTY + PV-FINCL-SUM-NET-QTY        61310099
613200     ELSE                                                         61320099
613300         MOVE SUT00028-SHPD-UNT-QTY                               61330099
613400                      TO PACK-AUDIT-QTY (LINE-IDX)                61340099
613500     END-IF.                                                      61350099
613600                                                                  61360099
613700 6950-SELECT-QUANTITY.                                            61370099
613800* FOR SOME REASON, THIS PROGRAM SEEMS TO LOSE TRACK OF THE        61380099
613900* RCVR-SEQ-NBR FROM OTBND-UPC SO I ADDED THIS SELECT.             61390099
614000* D.BRANTNER 11/10/2004                                           61400099
614100                                                                  61410099
614200     EXEC SQL                                                     61420099
614300         SELECT DISTINCT(RCVR_SEQ_NBR)                            61430099
614400         INTO  :DK-RCVR-SEQ-NBR                                   61440099
614500         FROM   SUT_OTBND_UPC                                     61450099
614600         WHERE  SHIPT_UNT_ID   = :SUT00024-SHIPT-UNT-ID           61460099
614700           AND  TRN_NBR        = :DK-PO-NBR                       61470099
614800     END-EXEC.                                                    61480099
614900     EVALUATE TRUE                                                61490099
615000         WHEN SQLCODE = +0                                        61500099
615100         WHEN SQLCODE = -811                                      61510099
615200             CONTINUE                                             61520099
615300         WHEN OTHER                                               61530099
615400             MOVE '6950-SELECT-QUANTITY  '   TO DP013-PARAGRAPH   61540099
615500             MOVE 'RETRIEVE RCVR SEQ NBR '                        61550099
615600                                         TO DP013-MESSAGE-TEXT (1)61560099
615700             MOVE SUT00024-SHIPT-UNT-ID TO DP013-MESSAGE-TEXT (2) 61570099
615800             MOVE PC033-UPC-NBR         TO DP013-MESSAGE-TEXT(3)  61580099
615900             MOVE DK-PO-NBR             TO PV-DISPLAY-PO          61590099
616000             MOVE DK-RCVR-SEQ-NBR       TO PV-DISPLAY-RCVR        61600099
616100             MOVE DK-PO-LINE-NBR        TO PV-DISPLAY-LINE        61610099
616200             STRING 'PO NBR: '   PV-DISPLAY-PO DELIMITED BY SIZE  61620099
616300                 ' RCVR NBR: ' PV-DISPLAY-RCVR DELIMITED BY SIZE  61630099
616400                 ' LINE NBR: ' PV-DISPLAY-LINE DELIMITED BY SIZE  61640099
616500                    INTO  DP013-MESSAGE-TEXT (4)                  61650099
616600             MOVE SQLCA             TO DP013-SQLCA                61660099
616700             MOVE 'SUT_OTBND_UPC'   TO DP013-DB2-TABLE-NAME (1)   61670099
616800             SET DP013-DB2-ABEND    TO TRUE                       61680099
616900             SET DP013-ROLLBACK     TO TRUE                       61690099
617000             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               61700099
617100             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           61710099
617200             MOVE SPACES                    TO  AMSGLN2O          61720099
617300             MOVE -1                        TO  ACARTNL           61730099
617400             MOVE PV-CARTON-NBR             TO ACARTNO            61740099
617500             PERFORM 8100-SEND-DATA-ONLY                          61750099
617600             PERFORM 8200-RETURN-TRANID                           61760099
617700     END-EVALUATE.                                                61770099
617800*                                                                 61780099
617900     MOVE '6950' TO PV-CURRENT-PARAGRAPH.                         61790099
618000     EXEC SQL                                                     61800099
618100         SELECT SHPD_UNT_QTY                                      61810099
618200             ,  UPC_NBR                                           61820099
618300           INTO :SUT00028-SHPD-UNT-QTY                            61830099
618400             ,  :SUT00028-UPC-NBR                                 61840099
618500           FROM SUT_OTBND_UPC                                     61850099
618600         WHERE  SHIPT_UNT_ID   =  :SUT00024-SHIPT-UNT-ID          61860099
618700           AND  TRN_NBR        =  :DK-PO-NBR                      61870099
618800           AND  RCVR_SEQ_NBR   =  :DK-RCVR-SEQ-NBR                61880099
618900           AND  TRN_LNE_NBR    =  :RECITM-ORD-LNE-NBR             61890099
619000     END-EXEC.                                                    61900099
619100                                                                  61910099
619200     EVALUATE TRUE                                                61920099
619300         WHEN SQLCODE = ZERO                                      61930099
619400             CONTINUE                                             61940099
619500                                                                  61950099
619600         WHEN SQLWARN0 NOT = SPACES                               61960099
619700         WHEN SQLCODE < ZERO                                      61970099
619800         WHEN SQLCODE > ZERO                                      61980099
619900             MOVE '6950-SELECT-QUANTITY'                          61990099
620000                 TO DP013-PARAGRAPH                               62000099
620100             MOVE SUT00024-SHIPT-UNT-ID TO PV-DISP-SHIPT-UNT-ID   62010099
620200             MOVE DK-PO-NBR             TO PV-DISPLAY-PO          62020099
620300             MOVE DK-RCVR-SEQ-NBR       TO PV-DISPLAY-RCVR        62030099
620400             MOVE RECITM-ORD-LNE-NBR    TO PV-DISPLAY-LINE        62040099
620500             MOVE SQLCA            TO DP013-SQLCA                 62050099
620600             STRING ' 6950- SHIPT = '                             62060099
620700                    PV-DISP-SHIPT-UNT-ID                          62070099
620800                    ' PO-RECVR '                                  62080099
620900                    PV-DISPLAY-PO                                 62090099
621000                    ' - '                                         62100099
621100                    PV-DISPLAY-RCVR                               62110099
621200                    ' LINE '                                      62120099
621300                    PV-DISPLAY-LINE                               62130099
621400                    DELIMITED BY SIZE                             62140099
621500                     INTO PV-CICS-MSG-AREA2                       62150099
621600                                                                  62160099
621700             PERFORM 1940-WRITE-TO-CICS-LOG                       62170099
621800             MOVE SPACES   TO PV-CICS-MSG-AREA2                   62180099
621900             MOVE 'SUT00028 '      TO DP013-DB2-TABLE-NAME (1)    62190099
622000             PERFORM 1900-FORMAT-MSG-AREA                         62200099
622100             PERFORM 1980-CALL-ERROR-RTN                          62210099
622200     END-EVALUATE.                                                62220099
622300                                                                  62230099
622400                                                                  62240099
622500 6960-CLOSE-PACK-CURSOR.                                          62250099
622600                                                                  62260099
622700     MOVE '6960' TO PV-CURRENT-PARAGRAPH.                         62270099
622800     EXEC SQL                                                     62280099
622900          CLOSE PACK-CURSOR                                       62290099
623000     END-EXEC.                                                    62300099
623100                                                                  62310099
623200     EVALUATE TRUE                                                62320099
623300         WHEN SQLCODE = ZERO                                      62330099
623400             CONTINUE                                             62340099
623500                                                                  62350099
623600         WHEN SQLWARN0 NOT = SPACES                               62360099
623700         WHEN SQLCODE < ZERO                                      62370099
623800         WHEN SQLCODE > ZERO                                      62380099
623900             MOVE '6960-CLOSE-PACK-CURSOR'                        62390099
624000                 TO DP013-PARAGRAPH                               62400099
624100             MOVE SQLCA            TO DP013-SQLCA                 62410099
624200             MOVE 'TRECITM       ' TO DP013-DB2-TABLE-NAME (1)    62420099
624300             PERFORM 1900-FORMAT-MSG-AREA                         62430099
624400             PERFORM 1980-CALL-ERROR-RTN                          62440099
624500     END-EVALUATE.                                                62450099
624600                                                                  62460099
624700 6980-CALL-BEST-CASE-RTN.                                         62470099
624800     INITIALIZE RC806-PRODUCT-PACK-VALIDATION.                    62480099
624900     SET RC806-VALIDATE-AND-CALC      TO TRUE.                    62490099
625000     MOVE 1                           TO RC806-INNER-PACK-QTY.    62500099
625100                                                                  62510099
625200     MOVE 0     TO PV-NUMBER-OF-LINES.                            62520099
625300     SET RC806-LINE-IDX TO 1.                                     62530099
625400                                                                  62540099
625500     PERFORM VARYING LINE-IDX  FROM 1 BY 1                        62550099
625600             UNTIL PACK-LINE (LINE-IDX) = 0                       62560099
625700         MOVE PACK-LINE (LINE-IDX) TO RC806-PKSL-LNE-NBR          62570099
625800                                       (RC806-LINE-IDX)           62580099
625900         MOVE PACK-RATO (LINE-IDX) TO RC806-PO-RATIO              62590099
626000                                       (RC806-LINE-IDX)           62600099
626100                                      RC806-RC-RATIO              62610099
626200                                       (RC806-LINE-IDX)           62620099
626300         MOVE PACK-CRTN-QTY (LINE-IDX)                            62630099
626400                                   TO RC806-UNIT-QTY              62640099
626500                                       (RC806-LINE-IDX)           62650099
626600                                      RC806-RCVG-QTY              62660099
626700                                       (RC806-LINE-IDX)           62670099
626800         SET RC806-LINE-IDX UP BY 1                               62680099
626900         ADD 1  TO PV-NUMBER-OF-LINES                             62690099
627000     END-PERFORM.                                                 62700099
627100                                                                  62710099
627200     MOVE PV-NUMBER-OF-LINES  TO RC806-NBR-OF-LINES.              62720099
627300                                                                  62730099
627400     PERFORM 6990-VALIDATION-MODULE.                              62740099
627500                                                                  62750099
627600     SET LINE-IDX            TO 1                                 62760099
627700                                                                  62770099
627800     IF RC806-NO-ERRORS                                           62780099
627900         PERFORM VARYING RC806-LINE-IDX FROM 1 BY 1               62790099
628000                 UNTIL RC806-LINE-IDX > RC806-NBR-OF-LINES        62800099
628100             MOVE RC806-BEST-CASE-UNITS (RC806-LINE-IDX)          62810099
628200                                       TO PACK-BEST-CASE-UNITS    62820099
628300                                           (LINE-IDX)             62830099
628400             MOVE RC806-ODD-UNITS (RC806-LINE-IDX)                62840099
628500                                       TO PACK-ODD-UNITS          62850099
628600                                           (LINE-IDX)             62860099
628700             SET LINE-IDX UP BY 1                                 62870099
628800         END-PERFORM                                              62880099
628900         MOVE RC806-BEST-CASE-PACKS    TO PV-SAVE-NBR-OF-PACKS    62890099
629000                                                                  62900099
629100         INITIALIZE RC806-PRODUCT-PACK-VALIDATION                 62910099
629200         SET RC806-VALIDATE-AND-CALC      TO TRUE                 62920099
629300         MOVE 1                           TO RC806-INNER-PACK-QTY 62930099
629400         MOVE 0     TO PV-NUMBER-OF-LINES                         62940099
629500         SET RC806-LINE-IDX TO 1                                  62950099
629600                                                                  62960099
629700         PERFORM VARYING LINE-IDX  FROM 1 BY 1                    62970099
629800                 UNTIL PACK-LINE (LINE-IDX) = 0                   62980099
629900             MOVE PACK-LINE (LINE-IDX) TO RC806-PKSL-LNE-NBR      62990099
630000                                           (RC806-LINE-IDX)       63000099
630100             MOVE PACK-RATO (LINE-IDX) TO RC806-PO-RATIO          63010099
630200                                           (RC806-LINE-IDX)       63020099
630300                                          RC806-RC-RATIO          63030099
630400                                           (RC806-LINE-IDX)       63040099
630500             MOVE PACK-AUDIT-QTY (LINE-IDX)                       63050099
630600                                       TO RC806-UNIT-QTY          63060099
630700                                           (RC806-LINE-IDX)       63070099
630800                                          RC806-RCVG-QTY          63080099
630900                                           (RC806-LINE-IDX)       63090099
631000             SET RC806-LINE-IDX UP BY 1                           63100099
631100             ADD 1  TO PV-NUMBER-OF-LINES                         63110099
631200         END-PERFORM                                              63120099
631300         MOVE PV-NUMBER-OF-LINES   TO RC806-NBR-OF-LINES          63130099
631400         SET LINE-IDX    TO 1                                     63140099
631500                                                                  63150099
631600         PERFORM 6990-VALIDATION-MODULE                           63160099
631700                                                                  63170099
631800                                                                  63180099
631900         SET PS-NO-ODD-UNITS-IN-CARTON TO TRUE                    63190099
632000         PERFORM 6995-PROCESS-LINES                               63200099
632100             VARYING RC806-LINE-IDX                               63210099
632200             FROM 1 BY 1                                          63220099
632300             UNTIL RC806-PKSL-LNE-NBR(RC806-LINE-IDX) = ZERO      63230099
632400                                                                  63240099
632500     END-IF.                                                      63250099
632600                                                                  63260099
632700 6990-VALIDATION-MODULE.                                          63270099
632800                                                                  63280099
632900     MOVE '6990' TO PV-CURRENT-PARAGRAPH.                         63290099
633000     EXEC CICS LINK                                               63300099
633100         PROGRAM  (PC-RCKCS806)                                   63310099
633200         COMMAREA (RC806-PRODUCT-PACK-VALIDATION)                 63320099
633300         RESP     (PV-CICS-RESPONSE)                              63330099
633400     END-EXEC.                                                    63340099
633500                                                                  63350099
633600     IF PV-CICS-RESPONSE = DFHRESP(NORMAL)                        63360099
633700         CONTINUE                                                 63370099
633800     ELSE                                                         63380099
633900         MOVE PV-CICS-RESPONSE TO PV-DISP-CICS-RESPONSE           63390099
634000         MOVE '6990-VALIDATION-MODULE'                            63400099
634100             TO DP013-PARAGRAPH                                   63410099
634200         MOVE 'CALL RCKCS806'                                     63420099
634300                 TO DP013-MESSAGE-TEXT (1)                        63430099
634400         MOVE SQLCA            TO DP013-SQLCA                     63440099
634500         PERFORM 1900-FORMAT-MSG-AREA                             63450099
634600         PERFORM 1980-CALL-ERROR-RTN                              63460099
634700     END-IF.                                                      63470099
634800                                                                  63480099
634900 6995-PROCESS-LINES.                                              63490099
635000     INITIALIZE SU035-COMM-AREA.                                  63500099
635100     SET SU035-ODD-UNIT-NO   TO TRUE.                             63510099
635200     SET SU035-PACK-YES      TO TRUE.                             63520099
635300     MOVE 0                    TO PV-PACK-DIFF                    63530099
635400                                  PV-ODD-DIFF.                    63540099
635500                                                                  63550099
635600     IF (PACK-CRTN-QTY (LINE-IDX) = PACK-AUDIT-QTY (LINE-IDX)     63560099
635700      AND PV-SAVE-NBR-OF-PACKS = RC806-BEST-CASE-PACKS            63570099
635800      AND PACK-ODD-UNITS (LINE-IDX) =                             63580099
635900                      RC806-ODD-UNITS (RC806-LINE-IDX)            63590099
636000      AND PACK-BACKOUT-IND (LINE-IDX) NOT = 'Y')                  63600099
636100         CONTINUE                                                 63610099
636200     ELSE                                                         63620099
636300         MOVE PACK-AUDIT-QTY (LINE-IDX)                           63630099
636400                                       TO SU035-AFTER-QTY         63640099
636500                                          PV-FINCL-NEW-AFT-QTY    63650099
636600         MOVE PACK-CRTN-QTY (LINE-IDX)                            63660099
636700                                       TO SU035-BEFORE-QTY        63670099
636800                                          PV-FINCL-NEW-BEF-QTY    63680099
636900         IF PV-SAVE-NBR-OF-PACKS NOT = RC806-BEST-CASE-PACKS      63690099
637000             COMPUTE PV-PACK-DIFF =                               63700099
637100                RC806-BEST-CASE-PACKS - PV-SAVE-NBR-OF-PACKS      63710099
637200             MOVE PV-PACK-DIFF   TO SU035-PACK-ADJUST-QTY         63720099
637300             COMPUTE SU035-ADJUST-QTY =                           63730099
637400                 (PV-PACK-DIFF * PACK-RATO (LINE-IDX))            63740099
637500                                                                  63750099
637600             MOVE PACK-PRPPK-ID (LINE-IDX)                        63760099
637700                                         TO PV-PACK-ID            63770099
637800                                            SU035-PACK-ID         63780099
637900             IF PACK-PREPK-DRV-LNE-CDE (LINE-IDX) = 'A'           63790099
638000                 MOVE 'A'      TO SU035-VRFY-ADJ-DRIVE-LNE        63800099
638100             END-IF                                               63810099
638200         END-IF                                                   63820099
638300         IF PACK-ODD-UNITS (LINE-IDX) NOT =                       63830099
638400                  RC806-ODD-UNITS (RC806-LINE-IDX)                63840099
638500             COMPUTE PV-ODD-DIFF =                                63850099
638600                  RC806-ODD-UNITS (RC806-LINE-IDX)                63860099
638700                    - PACK-ODD-UNITS (LINE-IDX)                   63870099
638800             SET SU035-ODD-UNIT-YES  TO TRUE                      63880099
638900             MOVE PACK-PRPPK-ID (LINE-IDX)                        63890099
639000                                         TO PV-PACK-ID            63900099
639100                                            SU035-PACK-ID         63910099
639200             MOVE PACK-ODD-UNITS (LINE-IDX) TO                    63920099
639300                                 SU035-BEFORE-ODD-UNT-QTY         63930099
639400             MOVE RC806-ODD-UNITS (RC806-LINE-IDX) TO             63940099
639500                                 SU035-AFTER-ODD-UNT-QTY          63950099
639600             COMPUTE SU035-ADJUST-QTY = SU035-ADJUST-QTY +        63960099
639700                                    PV-ODD-DIFF                   63970099
639800         END-IF                                                   63980099
639900         SET PS-DONT-BACK-OUT-UPDATES   TO TRUE                   63990099
640000         PERFORM 6250-LINK-UNT-ADJUST-MOD                         64000099
640100         IF PS-BACK-OUT-UPDATES                                   64010099
640200             SET PS-DONT-APPLY-CRT-UPDATES TO TRUE                64020099
640300             MOVE PACK-CRTN-QTY (LINE-IDX) TO                     64030099
640400                  PACK-AUDIT-QTY (LINE-IDX)                       64040099
640500             MOVE 'Y'  TO PACK-BACKOUT-IND (LINE-IDX)             64050099
640600         END-IF                                                   64060099
640700         IF (PACK-ODD-UNITS (LINE-IDX) NOT =                      64070099
640800                  RC806-ODD-UNITS (RC806-LINE-IDX)) AND           64080099
640900            PS-DONT-BACK-OUT-UPDATES                              64090099
641000             IF PACK-ODD-UNITS (LINE-IDX) = 0                     64100099
641100                 SET PS-ODD-UNITS-IN-CARTON TO TRUE               64110099
641200             END-IF                                               64120099
641300         END-IF                                                   64130099
641400         IF PV-SAVE-NBR-OF-PACKS NOT = RC806-BEST-CASE-PACKS      64140099
641500            AND                                                   64150099
641600            PACK-PREPK-DRV-LNE-CDE (LINE-IDX) = 'A' AND           64160099
641700            PS-DONT-BACK-OUT-UPDATES                              64170099
641800             MOVE PV-PACK-DIFF  TO PV-SAVE-PACK-DIFF              64180099
641900             SET PS-UPDATE-NBR-PACKS   TO TRUE                    64190099
642000         END-IF                                                   64200099
642100     END-IF.                                                      64210099
642200     SET LINE-IDX UP BY 1.                                        64220099
642300                                                                  64230099
642400******************************************************************64240099
642500* MUST CHECK TSUQADJ TO SEE IF ANY UNITS FROM THE CARTON WERE PUT*64250099
642600* INTO A DAMAGED CARTON.  IF SO, THE DAMAGED CARTON NEEDS TO BE  *64260099
642700* "RECLAIMED."                                                   *64270099
642800******************************************************************64280099
642900 7000-CHECK-TSUQADJ-4-DMG.                                        64290099
643000                                                                  64300099
643100     MOVE PC046-CARTON-ID    TO DK-SHIPT-UNT-ID.                  64310099
643200     EXEC SQL                                                     64320099
643300         SELECT   A.UPC_NBR                                       64330099
643400         INTO     :SUQADJ-UPC-NBR                                 64340099
643500         FROM     TSUQADJ A                                       64350099
643600                 ,SUT_FINCL_ADJ B                                 64360099
643700         WHERE  A.SHIPT_UNT_ID   = :DK-SHIPT-UNT-ID               64370099
643800           AND  A.PRC_RSN_CDE    = 'PCKR863D'                     64380099
643900           AND  A.ADJ_TMST      >= :DK-CARTON-TMST                64390099
644000           AND  A.FINCL_ADJ_ID   = B.FINCL_ADJ_ID                 64400099
644100           AND  B.AUTO_APL_IND   = 'Y'                            64410099
644200     END-EXEC.                                                    64420099
644300                                                                  64430099
644400     EVALUATE TRUE                                                64440099
644500         WHEN SQLCODE = +0                                        64450099
644600         WHEN SQLCODE = -811                                      64460099
644700             SET PS-DMG-CRTN-EXISTS TO TRUE                       64470099
644800         WHEN SQLCODE = +100                                      64480099
644900             SET PS-DMG-CRTN-NOT-EXISTS TO TRUE                   64490099
645000         WHEN OTHER                                               64500099
645100             MOVE '7000-CHECK-TSUQADJ-4-DMG'  TO DP013-PARAGRAPH  64510099
645200             MOVE 'CHECK 4 DMG CARTON '  TO DP013-MESSAGE-TEXT (1)64520099
645300             MOVE DK-SHIPT-UNT-ID        TO DP013-MESSAGE-TEXT (2)64530099
645400             MOVE SQLCA             TO DP013-SQLCA                64540099
645500             MOVE 'TSUQADJ '        TO DP013-DB2-TABLE-NAME (1)   64550099
645600             SET DP013-DB2-ABEND    TO TRUE                       64560099
645700             SET DP013-ROLLBACK     TO TRUE                       64570099
645800             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               64580099
645900             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           64590099
646000             MOVE SPACES                    TO  AMSGLN2O          64600099
646100             MOVE -1                     TO  ACARTNL              64610099
646200             MOVE PV-CARTON-NBR          TO ACARTNO               64620099
646300             PERFORM 8100-SEND-DATA-ONLY                          64630099
646400             PERFORM 8200-RETURN-TRANID                           64640099
646500     END-EVALUATE.                                                64650099
646600                                                                  64660099
646700******************************************************************64670099
646800* MUST GO TO OTBND-UPC TO RETRIEVE PO AND RCVR.                   64680099
646900******************************************************************64690099
647000 7100-CHECK-OTBND-UPC.                                            64700099
647100                                                                  64710099
647200     EXEC SQL                                                     64720099
647300         SELECT   TRN_NBR                                         64730099
647400                 ,RCVR_SEQ_NBR                                    64740099
647500                 ,TRN_LNE_NBR                                     64750099
647600         INTO     :SUT00028-TRN-NBR                               64760099
647700                 ,:SUT00028-RCVR-SEQ-NBR                          64770099
647800                 ,:SUT00028-TRN-LNE-NBR                           64780099
647900         FROM     SUT_OTBND_UPC                                   64790099
648000         WHERE    SHIPT_UNT_ID = :DK-SHIPT-UNT-ID                 64800099
648100           AND    UPC_NBR      = :SUQADJ-UPC-NBR                  64810099
648200     END-EXEC.                                                    64820099
648300                                                                  64830099
648400     EVALUATE TRUE                                                64840099
648500         WHEN SQLCODE = +0                                        64850099
648600         WHEN SQLCODE = -811                                      64860099
648700             PERFORM 7200-GET-DMG-SHIPT-UNT                       64870099
648800         WHEN SQLCODE = +100                                      64880099
648900             CONTINUE                                             64890099
649000         WHEN OTHER                                               64900099
649100             MOVE '7100-CHECK-OTBND-UPC '  TO DP013-PARAGRAPH     64910099
649200             MOVE 'CHECKING OTBND UPC '  TO DP013-MESSAGE-TEXT (1)64920099
649300             MOVE DK-SHIPT-UNT-ID        TO DP013-MESSAGE-TEXT (2)64930099
649400             MOVE SQLCA             TO DP013-SQLCA                64940099
649500             MOVE 'OTBNDUPC'        TO DP013-DB2-TABLE-NAME (1)   64950099
649600             SET DP013-DB2-ABEND    TO TRUE                       64960099
649700             SET DP013-ROLLBACK     TO TRUE                       64970099
649800             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               64980099
649900             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           64990099
650000             MOVE SPACES                    TO  AMSGLN2O          65000099
650100             MOVE -1                     TO  ACARTNL              65010099
650200             MOVE PV-CARTON-NBR          TO ACARTNO               65020099
650300             PERFORM 8100-SEND-DATA-ONLY                          65030099
650400             PERFORM 8200-RETURN-TRANID                           65040099
650500     END-EVALUATE.                                                65050099
650600                                                                  65060099
650700******************************************************************65070099
650800* MUST JOIN OTBND-UPC AND OTBND-CART TO RETRIEVE SHIPT-UNT-ID     65080099
650900* OF DAMAGED CARTON.                                              65090099
651000******************************************************************65100099
651100 7200-GET-DMG-SHIPT-UNT.                                          65110099
651200                                                                  65120099
651300     IF DK-RCVR-SEQ-NBR  > ZEROES                                 65130099
651400         MOVE DK-RCVR-SEQ-NBR     TO DK-REC-SEQ-NBR               65140099
651500     ELSE                                                         65150099
651600         MOVE PC033-RCVR-SEQ-NBR  TO DK-REC-SEQ-NBR               65160099
651700     END-IF.                                                      65170099
651800                                                                  65180099
651900     EXEC SQL                                                     65190099
652000         SELECT   B.SHIPT_UNT_ID                                  65200099
652100                 ,B.DEST_LOC_NBR                                  65210099
652200         INTO     :DK-DMG-SHIPT-UNT-ID                            65220099
652300                 ,:SUT00024-DEST-LOC-NBR                          65230099
652400         FROM     SUT_OTBND_UPC A                                 65240099
652500                 ,SUT_OTBND_CART B                                65250099
652600         WHERE    A.SHIPT_UNT_ID = B.SHIPT_UNT_ID                 65260099
652700           AND    TRN_NBR        = :SUT00028-TRN-NBR              65270099
652800           AND    RCVR_SEQ_NBR   = :DK-REC-SEQ-NBR                65280099
652900           AND    UPC_NBR        = :SUQADJ-UPC-NBR                65290099
653000           AND    CART_SRC_CDE   = 'DMG'                          65300099
653100     END-EXEC.                                                    65310099
653200                                                                  65320099
653300     EVALUATE TRUE                                                65330099
653400         WHEN SQLCODE = +0                                        65340099
653500         WHEN SQLCODE = -811                                      65350099
653600             MOVE SUT00024-DEST-LOC-NBR TO SUT00030-DEST-LOC-NBR  65360099
653700             PERFORM 7300-PROCESS-DMG-SHIPT-UNT                   65370099
653800         WHEN SQLCODE = +100                                      65380099
653900             CONTINUE                                             65390099
654000         WHEN OTHER                                               65400099
654100             MOVE '7200-GET-DMG-SHIPT-UNT'  TO DP013-PARAGRAPH    65410099
654200             MOVE 'GET SHIPT-UNT-ID  '   TO DP013-MESSAGE-TEXT (1)65420099
654300             MOVE DK-SHIPT-UNT-ID        TO DP013-MESSAGE-TEXT (2)65430099
654400             MOVE SQLCA             TO DP013-SQLCA                65440099
654500             MOVE 'OTBNDCRT'        TO DP013-DB2-TABLE-NAME (1)   65450099
654600             SET DP013-DB2-ABEND    TO TRUE                       65460099
654700             SET DP013-ROLLBACK     TO TRUE                       65470099
654800             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               65480099
654900             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           65490099
655000             MOVE SPACES                    TO  AMSGLN2O          65500099
655100             MOVE -1                     TO  ACARTNL              65510099
655200             MOVE PV-CARTON-NBR          TO ACARTNO               65520099
655300             PERFORM 8100-SEND-DATA-ONLY                          65530099
655400             PERFORM 8200-RETURN-TRANID                           65540099
655500     END-EVALUATE.                                                65550099
655600                                                                  65560099
655700******************************************************************65570099
655800* MUST BACK OUT QTY CALCULATED USING BEF & AFT QTY FROM TSUQADJ   65580099
655900* FOR EACH ROW RETRIEVED FOR ORIGINAL CARTON AND UPC.             65590099
656000******************************************************************65600099
656100 7300-PROCESS-DMG-SHIPT-UNT.                                      65610099
656200     SET PS-MORE-TSUQADJ-DMG-YES TO TRUE.                         65620099
656300     PERFORM 7325-OPEN-TSUQADJ-DMG-CURSOR.                        65630099
656400                                                                  65640099
656500     PERFORM 7350-FETCH-TSUQADJ-DMG-CSR                           65650099
656600       UNTIL PS-MORE-TSUQADJ-DMG-NO                               65660099
656700     PERFORM 7375-CLOSE-TSUQADJ-DMG-CSR.                          65670099
656800                                                                  65680099
656900******************************************************************65690099
657000 7325-OPEN-TSUQADJ-DMG-CURSOR.                                    65700099
657100******************************************************************65710099
657200     EXEC SQL                                                     65720099
657300         OPEN TSUQADJ-DMG                                         65730099
657400     END-EXEC.                                                    65740099
657500                                                                  65750099
657600     EVALUATE TRUE                                                65760099
657700         WHEN SQLCODE = ZERO                                      65770099
657800              CONTINUE                                            65780099
657900         WHEN SQLWARN0 NOT = SPACES                               65790099
658000         WHEN SQLCODE NOT EQUAL ZERO                              65800099
658100             MOVE '7325-OPEN-TSUQADJ-DMG-CSR' TO DP013-PARAGRAPH  65810099
658200             MOVE 'SELECT TSUQADJ DMG CRTN DATA '                 65820099
658300                                         TO DP013-MESSAGE-TEXT (1)65830099
658400             MOVE DK-SHIPT-UNT-ID        TO DP013-MESSAGE-TEXT (2)65840099
658500             MOVE SQLCA                  TO DP013-SQLCA           65850099
658600             MOVE 'TSUQADJ '           TO DP013-DB2-TABLE-NAME (1)65860099
658700             SET DP013-DB2-ABEND       TO TRUE                    65870099
658800             SET DP013-ROLLBACK        TO TRUE                    65880099
658900             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               65890099
659000             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           65900099
659100             MOVE SPACES                    TO  AMSGLN2O          65910099
659200             MOVE -1                     TO  ACARTNL              65920099
659300             MOVE PV-CARTON-NBR          TO ACARTNO               65930099
659400             PERFORM 8100-SEND-DATA-ONLY                          65940099
659500             PERFORM 8200-RETURN-TRANID                           65950099
659600     END-EVALUATE.                                                65960099
659700                                                                  65970099
659800******************************************************************65980099
659900 7350-FETCH-TSUQADJ-DMG-CSR.                                      65990099
660000******************************************************************66000099
660100     EXEC SQL                                                     66010099
660200         FETCH  TSUQADJ-DMG                                       66020099
660300         INTO  :PV-DMG-NET-QTY                                    66030099
660400     END-EXEC.                                                    66040099
660500                                                                  66050099
660600     EVALUATE TRUE                                                66060099
660700         WHEN SQLCODE = ZERO                                      66070099
660800              PERFORM 7400-SELECT-OTBND-UPC                       66080099
660900              PERFORM 7450-UPDATE-OTBND-UPC                       66090099
661000         WHEN SQLCODE = +100                                      66100099
661100              SET PS-MORE-TSUQADJ-DMG-NO TO TRUE                  66110099
661200         WHEN SQLWARN0 NOT = SPACES                               66120099
661300         WHEN SQLCODE NOT EQUAL ZERO                              66130099
661400             MOVE '7350-FETCH-TSUQADJ-DMG-CSR ' TO DP013-PARAGRAPH66140099
661500             MOVE 'FETCH TSUQADJ DMG CRTN DATA '                  66150099
661600                                         TO DP013-MESSAGE-TEXT (1)66160099
661700             MOVE DK-SHIPT-UNT-ID        TO DP013-MESSAGE-TEXT (2)66170099
661800             MOVE SQLCA                  TO DP013-SQLCA           66180099
661900             MOVE 'TSUQADJ '           TO DP013-DB2-TABLE-NAME (1)66190099
662000             SET DP013-DB2-ABEND       TO TRUE                    66200099
662100             SET DP013-ROLLBACK        TO TRUE                    66210099
662200             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               66220099
662300             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           66230099
662400             MOVE SPACES                    TO  AMSGLN2O          66240099
662500             MOVE -1                     TO  ACARTNL              66250099
662600             MOVE PV-CARTON-NBR          TO ACARTNO               66260099
662700             PERFORM 8100-SEND-DATA-ONLY                          66270099
662800             PERFORM 8200-RETURN-TRANID                           66280099
662900     END-EVALUATE.                                                66290099
663000                                                                  66300099
663100*-------------------------------------------------------------    66310099
663200 7375-CLOSE-TSUQADJ-DMG-CSR.                                      66320099
663300*-------------------------------------------------------------    66330099
663400     EXEC SQL                                                     66340099
663500        CLOSE TSUQADJ-DMG                                         66350099
663600     END-EXEC.                                                    66360099
663700                                                                  66370099
663800     EVALUATE TRUE                                                66380099
663900         WHEN SQLCODE = ZERO                                      66390099
664000              CONTINUE                                            66400099
664100         WHEN SQLWARN0 NOT = SPACES                               66410099
664200         WHEN SQLCODE NOT EQUAL ZERO                              66420099
664300             MOVE '7375-CLOSE-TSUQADJ-DMG-CSR ' TO DP013-PARAGRAPH66430099
664400             MOVE 'CLOSE FINCL ADJUSTMENT CURSOR'                 66440099
664500                                         TO DP013-MESSAGE-TEXT (1)66450099
664600             MOVE DK-SHIPT-UNT-ID        TO DP013-MESSAGE-TEXT (2)66460099
664700             MOVE SQLCA                  TO DP013-SQLCA           66470099
664800             MOVE 'TSUQADJ '           TO DP013-DB2-TABLE-NAME (1)66480099
664900             SET DP013-DB2-ABEND       TO TRUE                    66490099
665000             SET DP013-ROLLBACK        TO TRUE                    66500099
665100             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               66510099
665200             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           66520099
665300             MOVE SPACES                    TO  AMSGLN2O          66530099
665400             MOVE -1                   TO  ACARTNL                66540099
665500             MOVE PV-CARTON-NBR          TO ACARTNO               66550099
665600             PERFORM 8100-SEND-DATA-ONLY                          66560099
665700             PERFORM 8200-RETURN-TRANID                           66570099
665800     END-EVALUATE.                                                66580099
665900                                                                  66590099
666000*---------------------------------------------------------------- 66600099
666100 7400-SELECT-OTBND-UPC.                                           66610099
666200*-------------------------------------------------------------    66620099
666300     EXEC SQL                                                     66630099
666400         SELECT SHPD_UNT_QTY                                      66640099
666500           INTO :PV-BEF-QTY                                       66650099
666600           FROM SUT_OTBND_UPC                                     66660099
666700         WHERE SHIPT_UNT_ID   =  :DK-DMG-SHIPT-UNT-ID             66670099
666800           AND TRN_NBR        = :SUT00028-TRN-NBR                 66680099
666900           AND RCVR_SEQ_NBR   = :DK-REC-SEQ-NBR                   66690099
667000           AND UPC_NBR        = :SUQADJ-UPC-NBR                   66700099
667100     END-EXEC.                                                    66710099
667200                                                                  66720099
667300     EVALUATE TRUE                                                66730099
667400         WHEN SQLCODE = ZERO                                      66740099
667500         WHEN SQLCODE = +100                                      66750099
667600              CONTINUE                                            66760099
667700         WHEN SQLWARN0 NOT = SPACES                               66770099
667800         WHEN SQLCODE NOT EQUAL ZERO                              66780099
667900             MOVE '7400-SELECT-OTBND-UPC'                         66790099
668000                                   TO PV-CURRENT-PARAGRAPH        66800099
668100             MOVE DK-DMG-SHIPT-UNT-ID    TO PV-DISP-CARTON-ID     66810099
668200             MOVE SQLCODE                TO PV-ERROR-CONDITION    66820099
668300             STRING PC-CURRENT-PROGRAM-NAME  ' - '                66830099
668400                    PV-CURRENT-PARAGRAPH     ' - '                66840099
668500                    PV-DISP-CARTON-ID        ' - '                66850099
668600                    PV-ERROR-CONDITION                            66860099
668700                    DELIMITED BY SIZE                             66870099
668800                    INTO PV-CICS-MSG-AREA2                        66880099
668900             PERFORM 1940-WRITE-TO-CICS-LOG                       66890099
669000                                                                  66900099
669100             MOVE '7400-SELECT-OTBND-UPC '    TO DP013-PARAGRAPH  66910099
669200             MOVE 'UPDATE OF SUT_OTBND_UPC TABLE'                 66920099
669300                                       TO DP013-MESSAGE-TEXT (1)  66930099
669400             MOVE DK-DMG-SHIPT-UNT-ID  TO DP013-MESSAGE-TEXT (2)  66940099
669500             MOVE SQLCA                TO DP013-SQLCA             66950099
669600             MOVE 'SUT_OTBND_UPC '     TO DP013-DB2-TABLE-NAME (1)66960099
669700             SET DP013-DB2-ABEND       TO TRUE                    66970099
669800             SET DP013-ROLLBACK        TO TRUE                    66980099
669900             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               66990099
670000             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           67000099
670100             MOVE SPACES                    TO  AMSGLN2O          67010099
670200             MOVE -1                   TO  ACARTNL                67020099
670300             MOVE PV-CARTON-NBR          TO ACARTNO               67030099
670400             PERFORM 8100-SEND-DATA-ONLY                          67040099
670500             PERFORM 8200-RETURN-TRANID                           67050099
670600     END-EVALUATE.                                                67060099
670700                                                                  67070099
670800*---------------------------------------------------------------- 67080099
670900 7450-UPDATE-OTBND-UPC.                                           67090099
671000*-------------------------------------------------------------    67100099
671100     EXEC SQL                                                     67110099
671200         UPDATE SUT_OTBND_UPC                                     67120099
671300         SET                                                      67130099
671400             SHPD_UNT_QTY  =  SHPD_UNT_QTY + :PV-DMG-NET-QTY      67140099
671500         WHERE SHIPT_UNT_ID   =  :DK-DMG-SHIPT-UNT-ID             67150099
671600           AND TRN_NBR        = :SUT00028-TRN-NBR                 67160099
671700           AND RCVR_SEQ_NBR   = :DK-REC-SEQ-NBR                   67170099
671800           AND UPC_NBR        = :SUQADJ-UPC-NBR                   67180099
671900     END-EXEC.                                                    67190099
672000                                                                  67200099
672100     EVALUATE TRUE                                                67210099
672200         WHEN SQLCODE = ZERO                                      67220099
672300             PERFORM  7500-INSERT-DMG-TSUQADJ                     67230099
672400         WHEN SQLCODE = +100                                      67240099
672500              CONTINUE                                            67250099
672600         WHEN SQLWARN0 NOT = SPACES                               67260099
672700         WHEN SQLCODE NOT EQUAL ZERO                              67270099
672800             MOVE '7450-UPDATE-OTBND-UPC'                         67280099
672900                                   TO PV-CURRENT-PARAGRAPH        67290099
673000             MOVE DK-DMG-SHIPT-UNT-ID    TO PV-DISP-CARTON-ID     67300099
673100             MOVE SQLCODE                TO PV-ERROR-CONDITION    67310099
673200             STRING PC-CURRENT-PROGRAM-NAME  ' - '                67320099
673300                    PV-CURRENT-PARAGRAPH     ' - '                67330099
673400                    PV-DISP-CARTON-ID        ' - '                67340099
673500                    PV-ERROR-CONDITION                            67350099
673600                    DELIMITED BY SIZE                             67360099
673700                    INTO PV-CICS-MSG-AREA2                        67370099
673800             PERFORM 1940-WRITE-TO-CICS-LOG                       67380099
673900                                                                  67390099
674000             MOVE '7450-UPDATE-OTBND-UPC '    TO DP013-PARAGRAPH  67400099
674100             MOVE 'UPDATE OF SUT_OTBND_UPC TABLE'                 67410099
674200                                       TO DP013-MESSAGE-TEXT (1)  67420099
674300             MOVE DK-DMG-SHIPT-UNT-ID  TO DP013-MESSAGE-TEXT (2)  67430099
674400             MOVE SQLCA                TO DP013-SQLCA             67440099
674500             MOVE 'SUT_OTBND_UPC '     TO DP013-DB2-TABLE-NAME (1)67450099
674600             SET DP013-DB2-ABEND       TO TRUE                    67460099
674700             SET DP013-ROLLBACK        TO TRUE                    67470099
674800             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               67480099
674900             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           67490099
675000             MOVE SPACES                    TO AMSGLN2O           67500099
675100             MOVE -1                        TO ACARTNL            67510099
675200             MOVE PV-CARTON-NBR             TO ACARTNO            67520099
675300             PERFORM 8100-SEND-DATA-ONLY                          67530099
675400             PERFORM 8200-RETURN-TRANID                           67540099
675500     END-EVALUATE.                                                67550099
675600                                                                  67560099
675700 7455-PROCESS-OTBND-PK.                                           67570099
675800     MOVE PV-PACK-ID        TO DK-PACK-ID.                        67580099
675900     PERFORM 7457-SELECT-PACK-SKU.                                67590099
676000     SET PS-NO-OTBND-PK-FOUND TO TRUE.                            67600099
676100     PERFORM 7459-SELECT-OTBND-PK.                                67610099
676200     IF PS-OTBND-PK-FOUND                                         67620099
676300         IF PV-PACK-DIFF < 0                                      67630099
676400             COMPUTE SUT00041-SHPD-PK-QTY =                       67640099
676500                       SUT00041-SHPD-PK-QTY + PV-PACK-DIFF        67650099
676600             IF SUT00041-SHPD-PK-QTY < 0                          67660099
676700                 MOVE 0    TO SUT00041-SHPD-PK-QTY                67670099
676800             END-IF                                               67680099
676900             PERFORM 7460-UPDATE-OTBND-PK                         67690099
677000         ELSE                                                     67700099
677100             COMPUTE SUT00041-SHPD-PK-QTY =                       67710099
677200                       SUT00041-SHPD-PK-QTY + PV-PACK-DIFF        67720099
677300             PERFORM 7460-UPDATE-OTBND-PK                         67730099
677400     ELSE                                                         67740099
677500         IF PV-PACK-DIFF > 0                                      67750099
677600             PERFORM 7462-INSERT-OTBND-PK                         67760099
677700         END-IF                                                   67770099
677800     END-IF.                                                      67780099
677900                                                                  67790099
678000 7457-SELECT-PACK-SKU.                                            67800099
678100                                                                  67810099
678200     MOVE SU035-PO         TO DK-PO-NBR.                          67820099
678300                                                                  67830099
678400     EXEC SQL                                                     67840099
678500         SELECT PK_SKU_NBR                                        67850099
678600         INTO   :POPRPK-PK-SKU-NBR                                67860099
678700         FROM TPOPRPK                                             67870099
678800         WHERE  PO_NBR       = :DK-PO-NBR                         67880099
678900           AND  PO_PREPK_ID  = :DK-PACK-ID                        67890099
679000     END-EXEC.                                                    67900099
679100                                                                  67910099
679200     EVALUATE TRUE                                                67920099
679300         WHEN SQLCODE = ZERO                                      67930099
679400             CONTINUE                                             67940099
679500         WHEN SQLCODE = +100                                      67950099
679600              CONTINUE                                            67960099
679700         WHEN SQLWARN0 NOT = SPACES                               67970099
679800         WHEN SQLCODE NOT EQUAL ZERO                              67980099
679900             MOVE '7457-SELECT-PACK-SKU'                          67990099
680000                                   TO PV-CURRENT-PARAGRAPH        68000099
680100             MOVE DK-PACK-ID       TO PV-DISP-PACK-ID             68010099
680200             MOVE DK-PO-NBR        TO PV-DISPLAY-PO               68020099
680300             MOVE SQLCODE                TO PV-ERROR-CONDITION    68030099
680400             STRING PC-CURRENT-PROGRAM-NAME  ' - '                68040099
680500                    PV-CURRENT-PARAGRAPH     ' - '                68050099
680600                    PV-DISP-PACK-ID          ' - '                68060099
680700                    PV-DISPLAY-PO            ' - '                68070099
680800                    PV-ERROR-CONDITION                            68080099
680900                    DELIMITED BY SIZE                             68090099
681000                    INTO PV-CICS-MSG-AREA2                        68100099
681100             PERFORM 1940-WRITE-TO-CICS-LOG                       68110099
681200                                                                  68120099
681300             MOVE '7457-SELECT-PACK-SKU  '    TO DP013-PARAGRAPH  68130099
681400             MOVE 'UPDATE OF SUT_OTBND_UPC TABLE'                 68140099
681500                                       TO DP013-MESSAGE-TEXT (1)  68150099
681600             MOVE PV-DISP-PACK-ID      TO DP013-MESSAGE-TEXT (2)  68160099
681700             MOVE PV-DISPLAY-PO        TO DP013-MESSAGE-TEXT (3)  68170099
681800             MOVE SQLCA                TO DP013-SQLCA             68180099
681900             MOVE 'TPOPRPK       '     TO DP013-DB2-TABLE-NAME (1)68190099
682000             SET DP013-DB2-ABEND       TO TRUE                    68200099
682100             SET DP013-ROLLBACK        TO TRUE                    68210099
682200             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               68220099
682300             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           68230099
682400             MOVE SPACES                    TO AMSGLN2O           68240099
682500             MOVE -1                        TO ACARTNL            68250099
682600             MOVE PV-CARTON-NBR             TO ACARTNO            68260099
682700             PERFORM 8100-SEND-DATA-ONLY                          68270099
682800             PERFORM 8200-RETURN-TRANID                           68280099
682900     END-EVALUATE.                                                68290099
683000                                                                  68300099
683100 7459-SELECT-OTBND-PK.                                            68310099
683200     MOVE SU035-REC-SEQ-NBR    TO DK-REC-SEQ-NBR.                 68320099
683300                                                                  68330099
683400     EXEC SQL                                                     68340099
683500         SELECT SHPD_PK_QTY                                       68350099
683600         INTO   :SUT00041-SHPD-PK-QTY                             68360099
683700         FROM SUT_OTBND_PK                                        68370099
683800         WHERE  SHIPT_UNT_ID = :SUT00024-SHIPT-UNT-ID             68380099
683900           AND  TRN_NBR      = :DK-PO-NBR                         68390099
684000           AND  RCVR_SEQ_NBR = :DK-REC-SEQ-NBR                    68400099
684100           AND  PK_SKU_NBR   = :POPRPK-PK-SKU-NBR                 68410099
684200     END-EXEC.                                                    68420099
684300                                                                  68430099
684400     EVALUATE TRUE                                                68440099
684500         WHEN SQLCODE = ZERO                                      68450099
684600             SET PS-OTBND-PK-FOUND  TO TRUE                       68460099
684700         WHEN SQLCODE = +100                                      68470099
684800              CONTINUE                                            68480099
684900         WHEN SQLWARN0 NOT = SPACES                               68490099
685000         WHEN SQLCODE NOT EQUAL ZERO                              68500099
685100             MOVE '7459-SELECT-OTBND-PK'                          68510099
685200                                   TO PV-CURRENT-PARAGRAPH        68520099
685300             MOVE SUT00024-SHIPT-UNT-ID                           68530099
685400                                   TO PV-DISP-CARTON-ID           68540099
685500             MOVE DK-PO-NBR        TO PV-DISPLAY-PO               68550099
685600             MOVE DK-REC-SEQ-NBR   TO PV-DISPLAY-PO-RCVR          68560099
685700             MOVE SQLCODE                TO PV-ERROR-CONDITION    68570099
685800             STRING PC-CURRENT-PROGRAM-NAME  ' - '                68580099
685900                    PV-CURRENT-PARAGRAPH     ' - '                68590099
686000                    PV-DISP-CARTON-ID        ' - '                68600099
686100                    PV-DISPLAY-PO            ' - '                68610099
686200                    PV-DISPLAY-PO-RCVR       ' - '                68620099
686300                    PV-ERROR-CONDITION                            68630099
686400                    DELIMITED BY SIZE                             68640099
686500                    INTO PV-CICS-MSG-AREA2                        68650099
686600             PERFORM 1940-WRITE-TO-CICS-LOG                       68660099
686700                                                                  68670099
686800             MOVE '7459-SELECT-OTBND-PK  '    TO DP013-PARAGRAPH  68680099
686900             MOVE 'SELECT OF SUT_OTBND_PK TABLE'                  68690099
687000                                       TO DP013-MESSAGE-TEXT (1)  68700099
687100             MOVE PV-DISP-CARTON-ID    TO DP013-MESSAGE-TEXT (2)  68710099
687200             MOVE PV-DISPLAY-PO        TO DP013-MESSAGE-TEXT (3)  68720099
687300             MOVE PV-DISPLAY-PO-RCVR   TO DP013-MESSAGE-TEXT (4)  68730099
687400             MOVE SQLCA                TO DP013-SQLCA             68740099
687500             MOVE 'SUT_OTBND_PK  '     TO DP013-DB2-TABLE-NAME (1)68750099
687600             SET DP013-DB2-ABEND       TO TRUE                    68760099
687700             SET DP013-ROLLBACK        TO TRUE                    68770099
687800             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               68780099
687900             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           68790099
688000             MOVE SPACES                    TO AMSGLN2O           68800099
688100             MOVE -1                        TO ACARTNL            68810099
688200             MOVE PV-CARTON-NBR             TO ACARTNO            68820099
688300             PERFORM 8100-SEND-DATA-ONLY                          68830099
688400             PERFORM 8200-RETURN-TRANID                           68840099
688500     END-EVALUATE.                                                68850099
688600                                                                  68860099
688700 7460-UPDATE-OTBND-PK.                                            68870099
688800                                                                  68880099
688900     EXEC SQL                                                     68890099
689000         UPDATE SUT_OTBND_PK                                      68900099
689100         SET    SHPD_PK_QTY    = :SUT00041-SHPD-PK-QTY            68910099
689200         WHERE  SHIPT_UNT_ID   = :SUT00024-SHIPT-UNT-ID           68920099
689300     END-EXEC.                                                    68930099
689400                                                                  68940099
689500     EVALUATE TRUE                                                68950099
689600         WHEN SQLCODE = ZERO                                      68960099
689700             CONTINUE                                             68970099
689800         WHEN SQLCODE = +100                                      68980099
689900              CONTINUE                                            68990099
690000         WHEN SQLWARN0 NOT = SPACES                               69000099
690100         WHEN SQLCODE NOT EQUAL ZERO                              69010099
690200             MOVE '7460-UPDATE-OTBND-PK'                          69020099
690300                                   TO PV-CURRENT-PARAGRAPH        69030099
690400             MOVE SUT00024-SHIPT-UNT-ID  TO PV-DISP-CARTON-ID     69040099
690500             MOVE SQLCODE                TO PV-ERROR-CONDITION    69050099
690600             STRING PC-CURRENT-PROGRAM-NAME  ' - '                69060099
690700                    PV-CURRENT-PARAGRAPH     ' - '                69070099
690800                    PV-DISP-CARTON-ID        ' - '                69080099
690900                    PV-ERROR-CONDITION                            69090099
691000                    DELIMITED BY SIZE                             69100099
691100                    INTO PV-CICS-MSG-AREA2                        69110099
691200             PERFORM 1940-WRITE-TO-CICS-LOG                       69120099
691300                                                                  69130099
691400             MOVE '7460-UPDATE-OTBND-PK  '    TO DP013-PARAGRAPH  69140099
691500             MOVE 'UPDATE OF SUT_OTBND_UPC TABLE'                 69150099
691600                                       TO DP013-MESSAGE-TEXT (1)  69160099
691700             MOVE PV-DISP-CARTON-ID    TO DP013-MESSAGE-TEXT (2)  69170099
691800             MOVE SQLCA                TO DP013-SQLCA             69180099
691900             MOVE 'SUT_OTBND_PK  '     TO DP013-DB2-TABLE-NAME (1)69190099
692000             SET DP013-DB2-ABEND       TO TRUE                    69200099
692100             SET DP013-ROLLBACK        TO TRUE                    69210099
692200             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               69220099
692300             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           69230099
692400             MOVE SPACES                    TO AMSGLN2O           69240099
692500             MOVE -1                        TO ACARTNL            69250099
692600             MOVE PV-CARTON-NBR             TO ACARTNO            69260099
692700             PERFORM 8100-SEND-DATA-ONLY                          69270099
692800             PERFORM 8200-RETURN-TRANID                           69280099
692900     END-EVALUATE.                                                69290099
693000                                                                  69300099
693100 7462-INSERT-OTBND-PK.                                            69310099
693200                                                                  69320099
693300     MOVE SUT00024-SHIPT-UNT-ID TO SUT00041-SHIPT-UNT-ID.         69330099
693400     MOVE DK-PO-NBR             TO SUT00041-TRN-NBR.              69340099
693500     MOVE DK-REC-SEQ-NBR        TO SUT00041-RCVR-SEQ-NBR.         69350099
693600     MOVE 'PO'                  TO SUT00041-TRN-TYP-CDE.          69360099
693700     MOVE POPRPK-PK-SKU-NBR     TO SUT00041-PK-SKU-NBR.           69370099
693800     MOVE PV-PACK-DIFF          TO SUT00041-SHPD-PK-QTY.          69380099
693900                                                                  69390099
694000     EXEC SQL                                                     69400099
694100         INSERT INTO SUT_OTBND_PK                                 69410099
694200         (                                                        69420099
694300            SHIPT_UNT_ID                                          69430099
694400         ,  TRN_NBR                                               69440099
694500         ,  RCVR_SEQ_NBR                                          69450099
694600         ,  TRN_TYP_CDE                                           69460099
694700         ,  PK_SKU_NBR                                            69470099
694800         ,  SHPD_PK_QTY                                           69480099
694900         )                                                        69490099
695000         VALUES                                                   69500099
695100         (                                                        69510099
695200            :SUT00041-SHIPT-UNT-ID                                69520099
695300         ,  :SUT00041-TRN-NBR                                     69530099
695400         ,  :SUT00041-RCVR-SEQ-NBR                                69540099
695500         ,  :SUT00041-TRN-TYP-CDE                                 69550099
695600         ,  :SUT00041-PK-SKU-NBR                                  69560099
695700         ,  :SUT00041-SHPD-PK-QTY                                 69570099
695800         )                                                        69580099
695900     END-EXEC.                                                    69590099
696000                                                                  69600099
696100     EVALUATE TRUE                                                69610099
696200         WHEN SQLCODE = ZERO                                      69620099
696300             CONTINUE                                             69630099
696400         WHEN SQLWARN0 NOT = SPACES                               69640099
696500         WHEN SQLCODE NOT EQUAL ZERO                              69650099
696600             MOVE '7462-INSERT-OTBND-PK'                          69660099
696700                                   TO PV-CURRENT-PARAGRAPH        69670099
696800             MOVE SUT00041-SHIPT-UNT-ID  TO PV-DISP-CARTON-ID     69680099
696900             MOVE SQLCODE                TO PV-ERROR-CONDITION    69690099
697000             STRING PC-CURRENT-PROGRAM-NAME  ' - '                69700099
697100                    PV-CURRENT-PARAGRAPH     ' - '                69710099
697200                    PV-DISP-CARTON-ID        ' - '                69720099
697300                    PV-ERROR-CONDITION                            69730099
697400                    DELIMITED BY SIZE                             69740099
697500                    INTO PV-CICS-MSG-AREA2                        69750099
697600             PERFORM 1940-WRITE-TO-CICS-LOG                       69760099
697700                                                                  69770099
697800             MOVE '7462-INSERT-OTBND-PK '     TO DP013-PARAGRAPH  69780099
697900             MOVE 'INSERT OF SUT_OTBND_PK TABLE'                  69790099
698000                                       TO DP013-MESSAGE-TEXT (1)  69800099
698100             MOVE PV-DISP-CARTON-ID    TO DP013-MESSAGE-TEXT (2)  69810099
698200             MOVE SQLCA                TO DP013-SQLCA             69820099
698300             MOVE 'SUT_OTBND_PK'       TO DP013-DB2-TABLE-NAME (1)69830099
698400             SET DP013-DB2-ABEND       TO TRUE                    69840099
698500             SET DP013-ROLLBACK        TO TRUE                    69850099
698600             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               69860099
698700             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           69870099
698800             MOVE SPACES                    TO AMSGLN2O           69880099
698900             MOVE -1                        TO ACARTNL            69890099
699000             MOVE PV-CARTON-NBR             TO ACARTNO            69900099
699100             PERFORM 8100-SEND-DATA-ONLY                          69910099
699200             PERFORM 8200-RETURN-TRANID                           69920099
699300     END-EVALUATE.                                                69930099
699400                                                                  69940099
699500 7470-UPDATE-OTBND-CART.                                          69950099
699600                                                                  69960099
699700     EXEC SQL                                                     69970099
699800         UPDATE SUT_OTBND_CART                                    69980099
699900         SET    ODD_UNT_IND     = :SUT00024-ODD-UNT-IND           69990099
700000         WHERE  SHIPT_UNT_ID    = :SUT00024-SHIPT-UNT-ID          70000099
700100           AND  ACTV_IND        = 'Y'                             70010099
700200     END-EXEC.                                                    70020099
700300                                                                  70030099
700400     EVALUATE TRUE                                                70040099
700500         WHEN SQLCODE = ZERO                                      70050099
700600             CONTINUE                                             70060099
700700         WHEN SQLWARN0 NOT = SPACES                               70070099
700800         WHEN SQLCODE NOT EQUAL ZERO                              70080099
700900             MOVE '7470-UPDATE-OTBND-CART'                        70090099
701000                                   TO PV-CURRENT-PARAGRAPH        70100099
701100             MOVE SUT00024-SHIPT-UNT-ID  TO PV-DISP-CARTON-ID     70110099
701200             MOVE SQLCODE                TO PV-ERROR-CONDITION    70120099
701300             STRING PC-CURRENT-PROGRAM-NAME  ' - '                70130099
701400                    PV-CURRENT-PARAGRAPH     ' - '                70140099
701500                    PV-DISP-CARTON-ID        ' - '                70150099
701600                    PV-ERROR-CONDITION                            70160099
701700                    DELIMITED BY SIZE                             70170099
701800                    INTO PV-CICS-MSG-AREA2                        70180099
701900             PERFORM 1940-WRITE-TO-CICS-LOG                       70190099
702000                                                                  70200099
702100             MOVE '7470-UPDATE-OTBND-CART'    TO DP013-PARAGRAPH  70210099
702200             MOVE 'UPDATE OF SUT_OTBND_CART TABLE'                70220099
702300                                       TO DP013-MESSAGE-TEXT (1)  70230099
702400             MOVE PV-DISP-CARTON-ID    TO DP013-MESSAGE-TEXT (2)  70240099
702500             MOVE SQLCA                TO DP013-SQLCA             70250099
702600             MOVE 'SUT_OTBND_CART'     TO DP013-DB2-TABLE-NAME (1)70260099
702700             SET DP013-DB2-ABEND       TO TRUE                    70270099
702800             SET DP013-ROLLBACK        TO TRUE                    70280099
702900             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               70290099
703000             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           70300099
703100             MOVE SPACES                    TO AMSGLN2O           70310099
703200             MOVE -1                        TO ACARTNL            70320099
703300             MOVE PV-CARTON-NBR             TO ACARTNO            70330099
703400             PERFORM 8100-SEND-DATA-ONLY                          70340099
703500             PERFORM 8200-RETURN-TRANID                           70350099
703600     END-EVALUATE.                                                70360099
703700                                                                  70370099
703800*-------------------------------------------------------------    70380099
703900 7500-INSERT-DMG-TSUQADJ.                                         70390099
704000*-------------------------------------------------------------    70400099
704100     INITIALIZE SU035-COMM-AREA.                                  70410099
704200     SET PS-FINCL-ADJ-ID-EXISTS  TO TRUE.                         70420099
704300     INITIALIZE   PV-FINCL-ADJ-ID.                                70430099
704400                                                                  70440099
704500     PERFORM UNTIL PS-FINCL-ADJ-ID-NOT-EXISTS                     70450099
704600         PERFORM 6300-CREATE-RANDOM-NBR                           70460099
704700         MOVE DP902-RANDOM-NUMBER TO PV-FINCL-ADJ-ID              70470099
704800         PERFORM 6350-SELECT-FINCL-ADJ                            70480099
704900     END-PERFORM.                                                 70490099
705000                                                                  70500099
705100     EXEC SQL                                                     70510099
705200         SET :SU035-CRE-TMST  = CURRENT TIMESTAMP                 70520099
705300     END-EXEC.                                                    70530099
705400                                                                  70540099
705500     MOVE ZEROES                    TO SU035-ADJ-AUDIT-CNTL-NBR.  70550099
705600     MOVE -1                        TO DN-AUDIT-IND.              70560099
705700                                                                  70570099
705800     COMPUTE PV-AFT-QTY  =      PV-BEF-QTY  + PV-DMG-NET-QTY.     70580099
705900                                                                  70590099
706000     MOVE PV-AFT-QTY            TO SU035-AFTER-QTY.               70600099
706100     MOVE PV-BEF-QTY            TO SU035-BEFORE-QTY.              70610099
706200     MOVE PV-DMG-NET-QTY        TO SU035-ADJUST-QTY.              70620099
706300     IF PC033-UNUSED                                              70630099
706400         MOVE 'UNUSED  '        TO PV-USER-ID                     70640099
706500         MOVE 'PCKRF859'        TO SU035-PRC-RSN-CDE              70650099
706600         IF RECITM-STATUS-CDE = 'VE'                              70660099
706700             SET SU035-LOG-ONLY-NO TO TRUE                        70670099
706800         ELSE                                                     70680099
706900             SET SU035-LOG-ONLY TO TRUE                           70690099
707000         END-IF                                                   70700099
707100     ELSE                                                         70710099
707200         MOVE 'RECLAIM '        TO PV-USER-ID                     70720099
707300         MOVE 'PCKRF859'        TO SU035-PRC-RSN-CDE              70730099
707400         IF PS-NO-P2L-BOUND-BRCDE-FND                             70740099
707500             SET SU035-LOG-ONLY         TO TRUE                   70750099
707600         END-IF                                                   70760099
707700     END-IF.                                                      70770099
707800                                                                  70780099
707900     EXEC SQL                                                     70790099
708000         INSERT INTO TSUQADJ                                      70800099
708100         (                                                        70810099
708200          SHIPT_UNT_ID                                            70820099
708300         ,UPC_NBR                                                 70830099
708400         ,ADJ_TMST                                                70840099
708500         ,OPER_UNT_ID                                             70850099
708600         ,ADJ_FUNC_CDE                                            70860099
708700         ,ADJ_BEF_QTY                                             70870099
708800         ,ADJ_AFT_QTY                                             70880099
708900         ,PRC_RSN_CDE                                             70890099
709000         ,ADJ_USR_ID                                              70900099
709100         ,AUD_CNTL_NBR                                            70910099
709200         ,FINCL_ADJ_ID                                            70920099
709300         )                                                        70930099
709400         VALUES                                                   70940099
709500         (                                                        70950099
709600          :DK-DMG-SHIPT-UNT-ID                                    70960099
709700         ,:SUQADJ-UPC-NBR                                         70970099
709800         ,:SU035-CRE-TMST                                         70980099
709900         ,:PC033-OPER-UNT-ID                                      70990099
710000         ,'U'                                                     71000099
710100         ,:PV-BEF-QTY                                             71010099
710200         ,:PV-AFT-QTY                                             71020099
710300         ,:SU035-PRC-RSN-CDE                                      71030099
710400         ,:PV-USER-ID                                             71040099
710500         ,:SU035-ADJ-AUDIT-CNTL-NBR :DN-AUDIT-IND                 71050099
710600         ,:PV-FINCL-ADJ-ID                                        71060099
710700         )                                                        71070099
710800     END-EXEC.                                                    71080099
710900                                                                  71090099
711000     EVALUATE TRUE                                                71100099
711100         WHEN SQLCODE = +0                                        71110099
711200             PERFORM 7600-CALL-SUKUT702                           71120099
711300         WHEN OTHER                                               71130099
711400             MOVE '7500-INSERT-DMG-TSUQADJ'  TO DP013-PARAGRAPH   71140099
711500             MOVE 'INSERT INTO TSUQADJ'  TO DP013-MESSAGE-TEXT (1)71150099
711600             MOVE DK-DMG-SHIPT-UNT-ID    TO DP013-MESSAGE-TEXT (2)71160099
711700             MOVE SQLCA            TO DP013-SQLCA                 71170099
711800             MOVE 'TSUQADJ '       TO DP013-DB2-TABLE-NAME (1)    71180099
711900             SET DP013-DB2-ABEND   TO TRUE                        71190099
712000             SET DP013-ROLLBACK    TO TRUE                        71200099
712100             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               71210099
712200             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           71220099
712300             MOVE SPACES                    TO AMSGLN2O           71230099
712400             MOVE -1               TO  ACARTNL                    71240099
712500             MOVE PV-CARTON-NBR          TO ACARTNO               71250099
712600             PERFORM 8100-SEND-DATA-ONLY                          71260099
712700             PERFORM 8200-RETURN-TRANID                           71270099
712800     END-EVALUATE.                                                71280099
712900                                                                  71290099
713000*-------------------------------------------------------------    71300099
713100 7600-CALL-SUKUT702.                                              71310099
713200*-------------------------------------------------------------    71320099
713300     MOVE DK-DMG-SHIPT-UNT-ID     TO SU035-SHIPT-UNT-ID           71330099
713400     MOVE SUQADJ-UPC-NBR          TO SU035-UPC-NBR                71340099
713500     EXEC SQL                                                     71350099
713600         SET :SU035-CRE-TMST  = CURRENT TIMESTAMP                 71360099
713700     END-EXEC.                                                    71370099
713800     MOVE SUQADJ-OPER-UNT-ID       TO SU035-ORIG-OPER-UNT-ID.     71380099
713900                                                                  71390099
714000     IF PC033-RECLAIM                                             71400099
714100         MOVE 'PCKRF859'           TO SU035-PRC-RSN-CDE           71410099
714200         MOVE 'PCKRF859'           TO SU035-PROGRAM-NAME          71420099
714300         MOVE 'RECLAIM'            TO SU035-CREATE-USER-ID        71430099
714400         MOVE 'RECLAIM '           TO PV-USER-ID                  71440099
714500     ELSE                                                         71450099
714600         MOVE 'PCKRF859'           TO SU035-PRC-RSN-CDE           71460099
714700         MOVE 'PCKRF859'           TO SU035-PROGRAM-NAME          71470099
714800         MOVE 'UNUSED '            TO SU035-CREATE-USER-ID        71480099
714900         MOVE 'UNUSED  '           TO PV-USER-ID                  71490099
715000     END-IF.                                                      71500099
715100     MOVE SUT00028-TRN-NBR         TO SU035-PO.                   71510099
715200     IF DK-RCVR-SEQ-NBR > 0                                       71520099
715300         MOVE DK-RCVR-SEQ-NBR      TO SU035-REC-SEQ-NBR           71530099
715400     ELSE                                                         71540099
715500         MOVE PC033-RCVR-SEQ-NBR   TO SU035-REC-SEQ-NBR           71550099
715600                                      DK-RCVR-SEQ-NBR             71560099
715700     END-IF.                                                      71570099
715800     MOVE SUT00028-TRN-LNE-NBR     TO SU035-PO-LNE-NBR.           71580099
715900     MOVE SUT00024-DEST-LOC-NBR    TO SU035-DEST-LOC-NBR.         71590099
716000     MOVE ' '                      TO SU035-CASEPACK-DELETE-IND.  71600099
716100     MOVE 'Y'                     TO SU035-UPDATE-UNTS-WORKED-IND.71610099
716200     MOVE ' '                      TO SU035-CART-CREATE-SRC.      71620099
716300     MOVE PV-FINCL-ADJ-ID          TO SU035-FINCL-ADJ-ID.         71630099
716400     SET SU035-PACK-NO             TO TRUE.                       71640099
716500     SET SU035-UPDATE-DISTDT       TO TRUE.                       71650099
716600     SET SU035-ODD-UNIT-NO         TO TRUE.                       71660099
716700                                                                  71670099
716800     PERFORM 6500-LINK-UNIT-ADJ-MODULE.                           71680099
716900                                                                  71690099
717000*-------------------------------------------------------------    71700099
717100 8000-SEND-MAP.                                                   71710099
717200*-------------------------------------------------------------    71720099
717300     EXEC CICS                                                    71730099
717400         SEND MAP       ('PC859A')                                71740099
717500              MAPSET    ('PCKM859')                               71750099
717600              ERASE                                               71760099
717700              RESP      (PV-CICS-RESPONSE)                        71770099
717800     END-EXEC.                                                    71780099
717900                                                                  71790099
718000     EVALUATE TRUE                                                71800099
718100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 71810099
718200              CONTINUE                                            71820099
718300         WHEN OTHER                                               71830099
718400              MOVE '8000-SEND-MAP'       TO DP013-PARAGRAPH       71840099
718500              MOVE 'UNABLE TO SEND MAP'  TO DP013-MESSAGE-TEXT (1)71850099
718600              SET DP013-CICS-ABEND       TO TRUE                  71860099
718700              SET DP013-ROLLBACK         TO TRUE                  71870099
718800              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              71880099
718900     END-EVALUATE.                                                71890099
719000                                                                  71900099
719100*-------------------------------------------------------------    71910099
719200 8100-SEND-DATA-ONLY.                                             71920099
719300*-------------------------------------------------------------    71930099
719400     MOVE -1 TO ACARTNL.                                          71940099
719500     EXEC CICS                                                    71950099
719600         SEND MAP       ('PC859A')                                71960099
719700              MAPSET    ('PCKM859')                               71970099
719800              CURSOR                                              71980099
719900              DATAONLY                                            71990099
720000               RESP      (PV-CICS-RESPONSE)                       72000099
720100     END-EXEC.                                                    72010099
720200                                                                  72020099
720300     EVALUATE TRUE                                                72030099
720400         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 72040099
720500              CONTINUE                                            72050099
720600         WHEN OTHER                                               72060099
720700              MOVE '8100-SEND-DATA-ONLY' TO DP013-PARAGRAPH       72070099
720800              MOVE 'UNABLE TO SEND DATA' TO DP013-MESSAGE-TEXT (1)72080099
720900              SET DP013-CICS-ABEND       TO TRUE                  72090099
721000              SET DP013-ROLLBACK         TO TRUE                  72100099
721100              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              72110099
721200     END-EVALUATE.                                                72120099
721300                                                                  72130099
721400*-------------------------------------------------------------    72140099
721500 8200-RETURN-TRANID.                                              72150099
721600*-------------------------------------------------------------    72160099
721700     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH       72170099
721800     EXEC CICS                                                    72180099
721900         RETURN TRANSID   (PC-CURRENT-TRANID)                     72190099
722000                COMMAREA  (CA-COMMAREA)                           72200099
722100                LENGTH    (PV-COMMAREA-LENGTH)                    72210099
722200                RESP      (PV-CICS-RESPONSE)                      72220099
722300     END-EXEC.                                                    72230099
722400                                                                  72240099
722500     EVALUATE TRUE                                                72250099
722600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 72260099
722700              CONTINUE                                            72270099
722800         WHEN OTHER                                               72280099
722900              MOVE '8200-RETURN-TRANID'                           72290099
723000                                     TO DP013-PARAGRAPH           72300099
723100              MOVE 'UNABLE TO RETURN TO TRANID'                   72310099
723200                                     TO DP013-MESSAGE-TEXT (1)    72320099
723300              SET DP013-CICS-ABEND   TO TRUE                      72330099
723400              SET DP013-ROLLBACK  TO TRUE                         72340099
723500              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              72350099
723600     END-EVALUATE.                                                72360099
723700                                                                  72370099
723800*-------------------------------------------------------------    72380099
723900 8210-XCTL-ERROR-SCREEN.                                          72390099
724000*-------------------------------------------------------------    72400099
724100     IF NOT PC033-ABEND                                           72410099
724200         SET PC033-INITIALIZE-SCREEN  TO TRUE                     72420099
724300     END-IF                                                       72430099
724400     MOVE DFHEIBLK                    TO PC033-DFHEIBLK           72440099
724500     MOVE PC-CURRENT-PROGRAM-NAME     TO PC033-LAST-PROGRAM.      72450099
724600     MOVE SUT00024-SHIPT-UNT-ID       TO PC033-CARTON.            72460099
724700     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH       72470099
724800     MOVE 'PCKRF852'                  TO PV-TRANSFER-PROGRAM      72480099
724900     IF PC033-PGM-MSG-NBR = ZERO                                  72490099
725000         MOVE 3                       TO PC033-PGM-MSG-NBR        72500099
725100     END-IF                                                       72510099
725200                                                                  72520099
725300     EXEC CICS                                                    72530099
725400         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    72540099
725500               COMMAREA  (CA-COMMAREA)                            72550099
725600               LENGTH    (PV-COMMAREA-LENGTH)                     72560099
725700               RESP      (PV-CICS-RESPONSE)                       72570099
725800     END-EXEC.                                                    72580099
725900                                                                  72590099
726000     EVALUATE TRUE                                                72600099
726100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 72610099
726200             CONTINUE                                             72620099
726300         WHEN OTHER                                               72630099
726400             MOVE '8210-XCTL-ERROR-SCREEN'                        72640099
726500                                      TO DP013-PARAGRAPH          72650099
726600             MOVE 'PCKRF859 - UNABLE TO XCTL TO PROGRAM: '        72660099
726700                                      TO DP013-MESSAGE-TEXT (1)   72670099
726800             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   72680099
726900             SET DP013-CICS-ABEND                                 72690099
727000                 DP013-ROLLBACK       TO TRUE                     72700099
727100             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               72710099
727200             MOVE PC-TRANS-UNAVAILABLE-MSG  TO AMSGLN1O           72720099
727300             MOVE SPACES                    TO AMSGLN2O           72730099
727400             SET PC033-PROCESS-SCREEN TO TRUE                     72740099
727500             MOVE -1                  TO ACARTNL                  72750099
727600             PERFORM 8000-SEND-MAP                                72760099
727700             PERFORM 8200-RETURN-TRANID                           72770099
727800     END-EVALUATE.                                                72780099
727900                                                                  72790099
728000*-------------------------------------------------------------    72800099
728100 8700-SELECT-TSHUNLO.                                             72810099
728200*-------------------------------------------------------------    72820099
728300     MOVE PV-VENDOR-SSCC             TO DK-SHIPT-UNT-ID.          72830099
728400                                                                  72840099
728500     EXEC SQL                                                     72850099
728600          SELECT   SHIPT_UNT_ID                                   72860099
728700            INTO  :SHUNLO-SHIPT-UNT-ID                            72870099
728800            FROM  TSHUNLO C                                       72880099
728900           WHERE  SHIPT_UNT_ID    = :DK-SHIPT-UNT-ID              72890099
729000             AND  ACTV_CDE        = 'A'                           72900099
729100             AND  SCN_LOC_ID      = 'RECV'                        72910099
729200     END-EXEC.                                                    72920099
729300                                                                  72930099
729400     EVALUATE TRUE                                                72940099
729500         WHEN SQLCODE = ZERO                                      72950099
729600         WHEN SQLCODE = -305                                      72960099
729700         WHEN SQLCODE = +100                                      72970099
729800             CONTINUE                                             72980099
729900         WHEN SQLWARN0 NOT = SPACE                                72990099
730000         WHEN SQLCODE NOT = ZERO                                  73000099
730100             MOVE '8700-SELECT-TSHUNLO'      TO DP013-PARAGRAPH   73010099
730200             MOVE 'SELECT SHUNLO      '  TO DP013-MESSAGE-TEXT (1)73020099
730300             MOVE DK-SHIPT-UNT-ID        TO PV-DISP-CARTON-ID     73030099
730400             MOVE PV-DISP-CARTON-ID      TO DP013-MESSAGE-TEXT (2)73040099
730500             MOVE SQLCA            TO DP013-SQLCA                 73050099
730600             MOVE 'TSHUNLO '       TO DP013-DB2-TABLE-NAME (1)    73060099
730700             SET DP013-DB2-ABEND   TO TRUE                        73070099
730800             SET DP013-ROLLBACK    TO TRUE                        73080099
730900             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               73090099
731000             MOVE PC034-DB2-FATAL-ERROR-MSG TO AMSGLN1O           73100099
731100             MOVE SPACES                    TO AMSGLN2O           73110099
731200             MOVE -1               TO  ACARTNL                    73120099
731300             MOVE PV-CARTON-NBR    TO ACARTNO                     73130099
731400             PERFORM 8100-SEND-DATA-ONLY                          73140099
731500             PERFORM 8200-RETURN-TRANID                           73150099
731600     END-EVALUATE.                                                73160099
731700                                                                  73170099
731800*-------------------------------------------------------------    73180099
731900 9000-SOFT-ABORT.                                                 73190099
732000*-------------------------------------------------------------    73200099
732100     EXEC CICS                                                    73210099
732200         SYNCPOINT ROLLBACK                                       73220099
732300     END-EXEC                                                     73230099
732400                                                                  73240099
732500     MOVE 'DB2 ACCESS ERROR'          TO AMSGLN1O.                73250099
732600     MOVE SPACES                      TO AMSGLN2O                 73260099
732700     MOVE PV-CARTON-NBR               TO ACARTNO                  73270099
732800     PERFORM 8100-SEND-DATA-ONLY                                  73280099
732900     PERFORM 8200-RETURN-TRANID.                                  73290099
733000                                                                  73300099
733100*-------------------------------------------------------------    73310099
733200 9903-WRITE-CICS-LOG.                                             73320099
733300*-------------------------------------------------------------    73330099
733400     MOVE SQLCODE                     TO PV-SQLCODE               73340099
733500     MOVE PC033-CARTON                TO PV-DISPLAY-CARTON        73350099
733600     MOVE PC033-PO-NBR                TO PV-DISPLAY-PO            73360099
733700     MOVE PC033-RCVR-SEQ-NBR          TO PV-DISPLAY-RCVR          73370099
733800     MOVE PC033-PO-LINE-NBR           TO PV-DISPLAY-LINE          73380099
733900                                                                  73390099
734000     EXEC CICS                                                    73400099
734100         WRITEQ TD                                                73410099
734200             QUEUE  ('CSSL')                                      73420099
734300             FROM   (PV-LOG-MSG)                                  73430099
734400             RESP   (PV-CICS-RESPONSE)                            73440099
734500     END-EXEC.                                                    73450099
734600/                                                                 73460099
734700*-------------------------------------------------------------    73470099
734800 9904-WRITE-CRTN-MODULE-MSG.                                      73480099
734900*-------------------------------------------------------------    73490099
735000                                                                  73500099
735100     MOVE '2500'                      TO  PV-CTN-PARA             73510099
735200     MOVE PC046-CRA-RET-CDE           TO  PV-CTN-RET-CDE          73520099
735300     MOVE PC046-CRTN-STATUS           TO  PV-CTN-STATUS           73530099
735400     MOVE PC046-CRTN-STAT-DESC        TO  PV-CTN-STAT-DESC        73540099
735500     MOVE PC046-TRLR-SRL              TO  PV-CTN-TRLR-SERIAL      73550099
735600     MOVE PC046-OTBD-TRIP-ID          TO  PV-CTN-TRIP             73560099
735700     MOVE PC046-TRIP-STATUS           TO  PV-CTN-TRIP-STAT        73570099
735800     MOVE PC046-STATUS-USERID         TO  PV-CTN-STAT-USERID      73580099
735900                                                                  73590099
736000     EXEC CICS                                                    73600099
736100         WRITEQ TD                                                73610099
736200             QUEUE  ('CSSL')                                      73620099
736300             FROM   (PV-CARTON-MSG)                               73630099
736400             RESP   (PV-CICS-RESPONSE)                            73640099
736500     END-EXEC.                                                    73650099
736600                                                                  73660099
736700     EXEC CICS                                                    73670099
736800         WRITEQ TD                                                73680099
736900             QUEUE  ('CSSL')                                      73690099
737000             FROM   (PC046-CRA-RET-MSG)                           73700099
737100             RESP   (PV-CICS-RESPONSE)                            73710099
737200     END-EXEC.                                                    73720099
737300/                                                                 73730099
737400*-------------------------------------------------------------    73740099
737500 9905-WRITE-CSSL-LOG.                                             73750099
737600*-------------------------------------------------------------    73760099
737700                                                                  73770099
737800     EXEC CICS                                                    73780099
737900         WRITEQ TD                                                73790099
738000             QUEUE  ('CSSL')                                      73800099
738100             FROM   (DP013-PARAGRAPH )                            73810099
738200             RESP   (PV-CICS-RESPONSE)                            73820099
738300     END-EXEC.                                                    73830099
738400                                                                  73840099
738500     EXEC CICS                                                    73850099
738600         WRITEQ TD                                                73860099
738700             QUEUE  ('CSSL')                                      73870099
738800             FROM   (DP013-MESSAGE-TEXT(1))                       73880099
738900             RESP   (PV-CICS-RESPONSE)                            73890099
739000     END-EXEC.                                                    73900099
739100                                                                  73910099
739200     EXEC CICS                                                    73920099
739300         WRITEQ TD                                                73930099
739400             QUEUE  ('CSSL')                                      73940099
739500             FROM   (DP013-MESSAGE-TEXT(2))                       73950099
739600             RESP   (PV-CICS-RESPONSE)                            73960099
739700     END-EXEC.                                                    73970099
739800/                                                                 73980099
739900*-------------------------------------------------------------    73990099
740000 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  74000099
740100*-------------------------------------------------------------    74010099
740200     MOVE PC-CURRENT-PROGRAM-NAME    TO DP013-PROGRAM.            74020099
740300     MOVE DFHEIBLK                   TO DP013-DFHEIBLK.           74030099
740400     INITIALIZE DP013-SRC-TASK-NUMBER                             74040099
740500                DP013-STACK.                                      74050099
740600     SET DP013-LINK-RETURN           TO TRUE.                     74060099
740700                                                                  74070099
740800     EXEC CICS                                                    74080099
740900         LINK                                                     74090099
741000             PROGRAM   (DP013-NAME)                               74100099
741100             COMMAREA  (DP013-PARAMETERS)                         74110099
741200             LENGTH    (DP013-LENGTH)                             74120099
741300     END-EXEC.                                                    74130099
741400*----------------------------------------------------------------*74140099
741500*    ABEND PROCESSOR MODULE                                      *74150099
741600*----------------------------------------------------------------*74160099
741700                                                                  74170099
741800     COPY DPPD014.                                                74180099
741900                                                                  74190099
