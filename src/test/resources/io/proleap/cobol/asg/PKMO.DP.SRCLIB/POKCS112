000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    POKCS112.                                         00020000
000300 AUTHOR.        CHRIS KUNSTMANN.                                  00030000
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
000500 DATE-WRITTEN.  09/99.                                            00050000
000600 DATE-COMPILED.                                                   00060000
000700*---------------------------------------------------------------* 00070000
000800*    W112 - INNER PREPACK INQUIRY PROGRAM                         00080000
000900*---------------------------------------------------------------* 00090000
001000*                                                               * 00100000
001100* THIS PROGRAM DISPLAYS ALL SELECTED PACK DATA FOR A GIVEN PO  *  00110000
001200* NBR.   F7/F8 TO SCROLL THROUGH LINES IN A PACK, IN CASE IT    * 00120000
001300* DOESN'T FIT ON ONE SCREEN. F19/F20 TO SCROLL FROM PACK TO     * 00130000
001400* PACK FOR A SPECIFIC PO.                                       * 00140000
001500*                                                               * 00150000
001600*---------------------------------------------------------------* 00160000
W24803* 05/06/03 - LAXMAN BOLINENI, IGSI       WR 24803               * 00170000
W24803*          - NEW COPYBOOKS XLT00003 AND XLT00004 ARE ADDED      * 00180000
W24803*          - DK-DB2-KEYS WERE REMOVED FROM WORKING-STORAGE      * 00190000
W24803*            SECTION                                            * 00200000
W24803*          - ALL THE OCCURENCES OF 2 CHARACTER CLASS WERE       * 00210000
W24803*            REPLACED WITH 2 DIGIT CLASS                        * 00220000
W24803*          - 2 DIGIT MAJOR CLASS WAS INCLUDED IN ADDITION TO    * 00230000
W24803*            2 DIGIT CLASS                                      * 00240000
W24803*          - ALL THE OCCURENCES OF 3 CHARACTER SEQUENCE WERE    * 00250000
W24803*            REPLACED WITH 8 DIGIT SKU                          * 00260000
W24803*---------------------------------------------------------------* 00270000
P5207 * 24/05/14 - SHEBENA  - CR NO - CHG0081355                      * 00271012
P5207 *         THE PROGRAM WAS MODIFIED AS TO RETRIEVE AND DISPLAY   * 00272011
P5207 *         THE MULTI PACK DETAILS AS WELL.                       * 00273011
P5207 *         CHANGE TAG - P5207                                    * 00274011
C98147*----------------------------------------------------------------*00274113
C98147* 11/25/14 - LINDA FRIESS     - CHG0098147                        00274213
C98147*         EXPANDED PO NUMBER TO 8 DIGITS IN MAP AND ADJUSTED      00274414
C98147*         FILLER IN PROGRAM                                       00274514
P5207 ******************************************************************00275005
076319* DATE  10/27/2021                                                00276016
076320*            - CHANGE CALL OF 'DPKUT100' TO                     * 00277016
076321*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 00278016
076322*              MAKING THE CALL DYNAMIC VS STATIC                * 00279016
076323*     MADE BY: GERMAN BANDA            WR/IR #: CHG0263126        00279117
076312*                                                               * 00279216
076318*---------------------------------------------------------------* 00279316
CICS  *  CHANGED 11/16/2022    BY BARB SCHULTZ    WR: CHG0278485        00279419
CICS  *                                                               * 00279518
CICS  *  ADDED COPYBOOK DPWS930 AND MADE THE CICS ARCHITECTURE CALL   * 00279618
CICS  *  DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.    * 00279718
076318*---------------------------------------------------------------* 00280018
001700                                                                  00281018
001800 ENVIRONMENT DIVISION.                                            00290000
001900                                                                  00300000
002000 DATA DIVISION.                                                   00310000
002100                                                                  00320000
002200 WORKING-STORAGE SECTION.                                         00330000
002300*                                                                 00340000
                                                                        00350000
002400 01  PC-PROGRAM-CONSTANTS.                                        00360000
002500     05  PC-CURRENT-MAP-NAME          PIC  X(08)     VALUE        00370000
002600                                                     'PO112A  '.  00380000
002700     05  PC-CURRENT-MAPSET-NAME       PIC  X(08)     VALUE        00390000
002800                                                     'POKM112 '.  00400000
002900     05  PC-CURRENT-PROGRAM-NAME      PIC  X(08)     VALUE        00410000
003000                                                     'POKCS112'.  00420000
003100     05  PC-LIST-QUEUE-SEQ            PIC  9(01)     VALUE 1.     00430000
003200     05  PC-LIST2-QUEUE-SEQ           PIC  9(01)     VALUE 4.     00440000
003300     05  PC-ITEMS-PER-PANEL           PIC S9(04)     VALUE +10    00450000
003400                                                      COMP SYNC.  00460000
003500     05  PC-MAX-BLOCKS                PIC S9(04)     VALUE +2     00470000
003600                                                      COMP SYNC.  00480000
003700     05  PC-MAX-ITEMS                 PIC S9(09)     VALUE        00490000
003800                                                         +1000000 00500000
003900                                                      COMP-3.     00510000
004000     05  PC-NUMBER-LENGTH             PIC S9(04)     VALUE +7     00520000
004100                                                      COMP SYNC.  00530000
004200                                                                  00540000
004300 01  PC-TSYMSG-NUMBERS.                                           00550000
004400     05  PC-TSYMSG-00008              PIC 9(5)       VALUE 00008. 00560000
           05  PC-TSYMSG-00057              PIC 9(5)       VALUE 00057. 00570000
004500     05  PC-TSYMSG-00069              PIC 9(5)       VALUE 00069. 00580000
004600     05  PC-TSYMSG-00070              PIC 9(5)       VALUE 00070. 00590000
004700     05  PC-TSYMSG-00279              PIC 9(5)       VALUE 00279. 00600000
004800     05  PC-TSYMSG-00461              PIC 9(5)       VALUE 00461. 00610000
004900     05  PC-TSYMSG-00588              PIC 9(5)       VALUE 00588. 00620000
005000     05  PC-TSYMSG-01279              PIC 9(5)       VALUE 01279. 00630000
005100     05  PC-TSYMSG-02093              PIC 9(5)       VALUE 02093. 00640000
005200     05  PC-TSYMSG-02095              PIC 9(5)       VALUE 02095. 00650000
005300     05  PC-TSYMSG-02096              PIC 9(5)       VALUE 02096. 00660000
005400     05  PC-TSYMSG-02117              PIC 9(5)       VALUE 02117. 00670000
           05  PC-TSYMSG-02762              PIC 9(5)       VALUE 02762. 00680000
005500                                                                  00690000
005600 01  PS-PROGRAM-SUBSCRIPTS.                                       00700000
005700     05  PS-SUB                       PIC S9(04)   VALUE +0       00710000
005800                                                     COMP SYNC.   00720000
005900                                                                  00730000
006000 01  PS-PROGRAM-SWITCHES.                                         00740000
006100     05  PS-ERROR-SW                  PIC X(01)      VALUE 'Y'.   00750000
006200         88  PS-ERROR-NO                             VALUE 'Y'.   00760000
006300         88  PS-ERROR                                VALUE 'N'.   00770000
006400     05  PS-COMMAREA-SW               PIC X(01)      VALUE 'N'.   00780000
006500         88  PS-COMMAREA-NOT-VALID                   VALUE 'N'.   00790000
006600         88  PS-COMMAREA-VALID                       VALUE 'Y'.   00800000
006700     05  PS-LIST-END-SW               PIC X(01)      VALUE 'N'.   00810000
006800         88  PS-LIST-NOT-END                         VALUE 'N'.   00820000
006900         88  PS-LIST-END                             VALUE 'Y'.   00830000
           05  PS-RV-STATUS-SW              PIC X(01)      VALUE 'N'.   00840000
               88  PS-RV-STATUS                            VALUE 'Y'.   00850000
               88  PS-NOT-RV-STATUS                        VALUE 'N'.   00860000
007000                                                                  00870000
007100 01  PV-PROGRAM-VARIABLES.                                        00880000
007200     05  PV-COMP3-FIELDS              COMP-3.                     00890000
007300         10  PV-READ-COUNT            PIC S9(09)     VALUE ZEROES.00900000
007400         10  PV-TOP-ITEM              PIC S9(09)     VALUE ZEROES.00910000
007500         10  PV-BOTTOM-ITEM           PIC S9(09)     VALUE ZEROES.00920000
007600                                                                  00930000
007700     05  PV-REMAINDER                 PIC S9(04)     VALUE ZEROES 00940000
007800                                                     COMP SYNC.   00950000
007900     05  PV-BLOCK-NUMBER              PIC S9(04)     VALUE ZEROES 00960000
008000                                                     COMP SYNC.   00970000
008100     05  PV-CICS-RESP                 PIC S9(04)     VALUE ZEROES 00980000
008200                                                     COMP SYNC.   00990000
008300     05  PV-HIGHEST-BLOCK-WRITTEN     PIC S9(04)     VALUE ZEROES 01000000
008400                                                     COMP SYNC.   01010000
008500     05  PV-PACK-HIGH-BLOCK-WRITTEN   PIC S9(04)     VALUE ZEROES 01020000
008600                                                     COMP SYNC.   01030000
008700     05  PV-PO-PREPK-ID               PIC S9(04)     VALUE ZEROES 01040000
008800                                                     COMP SYNC.   01050000
008900     05  PV-KEY-DATA.                                             01060000
009000         10  PV-LIST-QUEUE-NAME.                                  01070000
009100             15  PV-LIST-TERM-ID      PIC  X(04).                 01080000
009200             15  PV-LIST-TASK-NBR     PIC S9(05)     COMP-3.      01090000
009300             15  PV-LIST-SEQ          PIC  9(01).                 01100000
009400         10  PV-PACK-QUEUE-NAME.                                  01110000
009500             15  PV-PACK-TERM-ID      PIC  X(04).                 01120000
009600             15  PV-PACK-TASK-NBR     PIC S9(05)     COMP-3.      01130000
009700             15  PV-PACK-SEQ          PIC  9(01).                 01140000
009800         10  PV-PO-NBR                PIC S9(09)     COMP.        01150000
010000         10  FILLER                   PIC S9(09)     COMP.        01160000
W24803     05  PV-NULL-INDICATORS.                                      01170000
W24803         10 PV-MAJ-CL-NBR-IND         PIC S9(04)  COMP VALUE +0.  01180000
W24803         10 PV-SUB-CL-NBR-IND         PIC S9(04)  COMP VALUE +0.  01190000
W24803         10 PV-SKU-NBR-IND            PIC S9(04)  COMP VALUE +0.  01200000
W24803         10 PV-SKU-DESC-IND           PIC S9(04)  COMP VALUE +0.  01210000
W24803         10 PV-VS-NBR-IND             PIC S9(04)  COMP VALUE +0.  01220000
W24803         10 PV-CSTM-CLOR-DESC-IND     PIC S9(04)  COMP VALUE +0.  01230000
W24803         10 PV-SIZE-DESC-IND          PIC S9(04)  COMP VALUE +0.  01240000
W24803     05  PV-TEMP-SKU.                                             01250000
W24803         10 PV-TEMP-SKU-DEPT          PIC  9(03)  VALUE ZEROS.    01260000
W24803         10 PV-TEMP-SKU-CLASS         PIC  9(02)  VALUE ZEROS.    01270000
W24803         10 PV-TEMP-SKU-SEQ           PIC  9(03)  VALUE ZEROS.    01280000
W24803     05  PV-SKU-NBR REDEFINES PV-TEMP-SKU                         01290000
W24803                                      PIC  9(08).                 01300000
W24803     05  PV-MAJ-CL.                                               01310000
W24803         10 PV-MAJ-CL-1               PIC  9      VALUE ZEROS.    01320000
W24803         10 FILLER                    PIC  9      VALUE ZEROS.    01330000
W24803     05  PV-MAJ-CLASS REDEFINES PV-MAJ-CL                         01340000
W24803                                      PIC 9(02).                  01350000
010100                                                                  01360000
010200*---------------------------------------------------------------* 01370000
010300*    THE LAYOUT FOR THE TEMPORARY STORAGE QUEUE CONTAINING      * 01380000
      *    SELECTED LIST ITEMS TO BE PROCESSED BY THIS PROGRAM.       * 01390000
010400*---------------------------------------------------------------* 01400000
                                                                        01410000
           COPY POWS012.                                                01420000
                                                                        01430000
010200*---------------------------------------------------------------* 01440000
CICS  *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * 01450018
010400*---------------------------------------------------------------* 01460000
010500                                                                  01470000
010600     COPY DPWS030.                                                01480000
CICS       COPY DPWS930.                                                01481018
010700                                                                  01490000
010800*---------------------------------------------------------------* 01500000
010900*    STANDARD COMMAREA.                                         * 01510000
011000*---------------------------------------------------------------* 01520000
011100                                                                  01530000
011200     COPY DPWS020.                                                01540000
011300     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                01550000
011400                                                                  01560000
011500*---------------------------------------------------------------* 01570000
011600*    INTER-APPLICATION COMMAREA.                                * 01580000
011700*---------------------------------------------------------------* 01590000
011800                                                                  01600000
011900         10  INTER-APPL-COMM-AREA     PIC X(200).                 01610000
012000     COPY POWS013.                                                01620000
012100                                                                  01630000
012200*---------------------------------------------------------------* 01640000
012300*    SPECIFIC COMMMAREA FOR POKCS112.                           * 01650000
012400*---------------------------------------------------------------* 01660000
012500         10  ASC-SPECIFIC-COMMAREA.                               01670000
                   15  ASC-INT-APPL-FORMAT-IND   PIC  X(01).            01680000
                   15  ASC-USE-SELECTION-QUEUE-IND                      01690000
                                                 PIC  X(01).            01700000
                       88  ASC-USE-SELECTION-QUEUE          VALUE 'Y'.  01710000
      *            15  ASC-SEL-QUEUE-NAME        PIC  X(08).            01720000
                   15  ASC-NUMBER-OF-TS-ITEMS    PIC S9(05) COMP-3.     01730000
                   15  ASC-NUMBER-OF-SELECTED-ITEMS                     01740000
                                                 PIC S9(09) COMP-3.     01750000
                   15  ASC-SEL-SUB               PIC S9(04) COMP.       01760000
                   15  ASC-SEL-ITEM              PIC S9(04) COMP.       01770000
                   15  ASC-ITEM-NBR              PIC S9(04) COMP.       01780000
                   15  ASC-KEY-FIELDS.                                  01790000
                       20  ASC-KEY-PO-NBR        PIC S9(09) COMP.       01800000
                       20  ASC-KEY-DEPT-NBR      PIC  X(03).            01810000
                       20  ASC-KEY-PACK-ID       PIC S9(04) COMP.       01820000
                                                                        01830000
012600             15  ASC-KEY-DATA.                                    01840000
012700                 20  ASC-LIST-QUEUE-NAME.                         01850000
012800                     25  ASC-LIST-TERM-ID  PIC  X(04).            01860000
012900                     25  ASC-LIST-TASK-NBR PIC S9(05) COMP-3.     01870000
013000                     25  ASC-LIST-SEQ      PIC  9(01).            01880000
013100                 20  ASC-SEL-QUEUE-NAME.                          01890000
013200                     25  ASC-SEL-TERM-ID   PIC  X(04).            01900000
013300                     25  ASC-SEL-TASK-NBR  PIC S9(05) COMP-3.     01910000
013400                     25  ASC-SEL-SEQ       PIC  9(01).            01920000
013500                 20  ASC-PO-NBR            PIC S9(09) COMP.       01930000
013700                 20  ASC-TOTAL-UNITS       PIC S9(09) COMP.       01940000
                       20  ASC-NBR-INNER-PACKS   PIC S9(09) COMP.       01950000
013900                                                                  01960000
014000             15  ASC-PACK-LIST-NUMBER      PIC S9(03) COMP-3.     01970000
014100             15  ASC-PACK-PREPK-ID         PIC S9(04) COMP.       01980000
014300             15  ASC-PACK-SKU              PIC  9(08).            01990000
014300             15  ASC-PACK-DESC             PIC  X(40).            02000000
014400             15  ASC-PACK-UPC-NBR          PIC  9(15).            02010000
014500             15  ASC-PACK-CONVEYABLE       PIC  X.                02020000
014600             15  ASC-PACK-CARTONS          PIC S9(09) COMP.       02030000
014700             15  ASC-UNITS-PER-CARTON      PIC S9(09) COMP.       02040000
014800             15  ASC-PACK-INNER-QTY        PIC S9(09) COMP.       02050000
014900             15  ASC-PACK-SUB              PIC S9(04) COMP SYNC.  02060000
015000             15  ASC-NBR-PACKS-READ        PIC S9(09) COMP-3.     02070000
015100             15  ASC-PACK-DISPLAYED        PIC S9(04) COMP SYNC.  02080000
015200             15  ASC-PACK-HIGH-BLOCK-WRITTEN                      02090000
015300                                           PIC S9(04) COMP SYNC.  02100000
015400                                                                  02110000
015500* LINE LEVEL DATA FOR ONE PACK.                                   02120000
015600             15  ASC-BLOCK-ENTRIES         OCCURS 2 TIMES.        02130000
015700                 20  ASC-ITEM-ENTRIES      OCCURS 10 TIMES.       02140000
015800                     25  ASC-LIST-ITEM-NUMBER                     02150000
015900                                           PIC S9(09) COMP-3.     02160000
                           25  ASC-DEP-NBR       PIC  X(03).            02170000
W24803                     25  ASC-MAJ-CL-NBR    PIC  9(02).            02180000
W24803                     25  ASC-CL-NBR        PIC  9(02).            02190000
W24803                     25  ASC-SKU-NBR       PIC  9(08).            02200000
016200                     25  ASC-VEND-STYL-NAME PIC  X(10).           02210000
W24803                     25  ASC-SKU-DESC      PIC  X(13).            02220000
016400                     25  ASC-COLOR-DESC    PIC  X(10).            02230000
016500                     25  ASC-SIZE-DESC     PIC  X(10).            02240000
016600                     25  ASC-PREPK-RATO-QTY PIC S9(04) COMP.      02250000
016700                     25  ASC-UNT-QTY       PIC S9(05) COMP.       02260000
016800             15  ASC-BLK-SUB               PIC S9(04) COMP SYNC.  02270000
016900             15  ASC-ITEM-SUB              PIC S9(04) COMP SYNC.  02280000
017000             15  ASC-NBR-ITEMS-READ        PIC S9(09) COMP-3.     02290000
017100             15  ASC-ITEM-AT-TOP-OF-PANEL  PIC S9(09) COMP-3.     02300000
017200             15  ASC-ITEM-AT-BOT-OF-PANEL  PIC S9(09) COMP-3.     02310000
017300             15  ASC-HIGH-BLOCK-WRITTEN    PIC S9(04) COMP SYNC.  02320000
017400             15  ASC-ITEMS-LEFT-INDICATOR  PIC  X(01).            02330000
017500                 88  ASC-ITEMS-LEFT-ON-DB             VALUE 'Y'.  02340000
017600                 88  ASC-ITEMS-LEFT-ON-DB-NO          VALUE 'N'.  02350000
017700             15  ASC-START-ITEM-REQUEST.                          02360000
017800                 20  ASC-START-ITEM-REQUEST-N PIC  9(07).         02370000
W24803         10  FILLER                        PIC  X(1310).          02380000
017900                                                                  02390000
018000*---------------------------------------------------------------* 02400000
018100*    ABEND PROCESSING COPYBOOK.                                 * 02410000
018200*---------------------------------------------------------------* 02420000
018300                                                                  02430000
018400     COPY DPWS013.                                                02440000
018500                                                                  02450000
018600*---------------------------------------------------------------* 02460000
018700*    ATTRIBUTE SETTINGS COPYBOOK.                               * 02470000
018800*---------------------------------------------------------------* 02480000
018900                                                                  02490000
019000     COPY DPWS015.                                                02500000
019100                                                                  02510000
019200*---------------------------------------------------------------* 02520000
019300*    FUNCTION KEYS COPYBOOK.                                    * 02530000
019400*---------------------------------------------------------------* 02540000
019500                                                                  02550000
019600     COPY DPWS016.                                                02560000
019700                                                                  02570000
019800*---------------------------------------------------------------* 02580000
019900*    NUMERIC EDIT LAYOUT.                                       * 02590000
020000*---------------------------------------------------------------* 02600000
020100                                                                  02610000
020200     COPY DPWS010I.                                               02620000
020300                                                                  02630000
020400*---------------------------------------------------------------* 02640000
020500*    MAP LAYOUT                                                 * 02650000
020600*---------------------------------------------------------------* 02660000
020700                                                                  02670000
020800     COPY POKM112.                                                02680000
020900                                                                  02690000
021000 01  MR-OCCURS-LAYOUT          REDEFINES  PO112AO.                02700000
C98147     05  FILLER                PIC X(260).                        02710014
021200     05  MR-SCROLL-AREA OCCURS 10 TIMES.                          02720000
W24803         10  MR-DEPTL          PIC S9(04) COMP.                   02730000
W24803         10  MR-DEPTA          PIC  X(01).                        02740000
W24803         10  MR-DEPTC          PIC  X(01).                        02750000
021600         10  FILLER            PIC  X(01).                        02760000
W24803         10  MR-DEPTH          PIC  X(01).                        02770000
021800         10  FILLER            PIC  X(01).                        02780000
W24803         10  MR-DEPT           PIC  X(03).                        02790000
022000*                                                                 02800000
W24803         10  MR-MAJ-CLL        PIC S9(04) COMP.                   02810000
W24803         10  MR-MAJ-CLA        PIC  X(01).                        02820000
W24803         10  MR-MAJ-CLC        PIC  X(01).                        02830000
W24803         10  FILLER            PIC  X(01).                        02840000
W24803         10  MR-MAJ-CLH        PIC  X(01).                        02850000
W24803         10  FILLER            PIC  X(01).                        02860000
W24803         10  MR-MAJ-CL         PIC  X(02).                        02870000
022800*                                                                 02880000
W24803         10  MR-SUB-CLASSL     PIC S9(04) COMP.                   02890000
W24803         10  MR-SUB-CLASSA     PIC  X(01).                        02900000
W24803         10  MR-SUB-CLASSC     PIC  X(01).                        02910000
W24803         10  FILLER            PIC  X(01).                        02920000
W24803         10  MR-SUB-CLASSH     PIC  X(01).                        02930000
W24803         10  FILLER            PIC  X(01).                        02940000
W24803         10  MR-SUB-CLASS      PIC  X(02).                        02950000
W24803*                                                                 02960000
W24803         10  MR-SKUL           PIC S9(04) COMP.                   02970000
W24803         10  MR-SKUA           PIC  X(01).                        02980000
W24803         10  MR-SKUC           PIC  X(01).                        02990000
W24803         10  FILLER            PIC  X(01).                        03000000
W24803         10  MR-SKUH           PIC  X(01).                        03010000
W24803         10  FILLER            PIC  X(01).                        03020000
W24803         10  MR-SKU            PIC  X(08).                        03030000
023600*                                                                 03040000
023700         10  MR-STYLEL         PIC S9(04) COMP.                   03050000
023800         10  MR-STYLEA         PIC  X(01).                        03060000
023900         10  MR-STYLEC         PIC  X(01).                        03070000
024000         10  FILLER            PIC  X(01).                        03080000
024100         10  MR-STYLEH         PIC  X(01).                        03090000
024200         10  FILLER            PIC  X(01).                        03100000
024300         10  MR-STYLE          PIC  X(10).                        03110000
024400*                                                                 03120000
024500         10  MR-DESCL          PIC S9(04) COMP.                   03130000
024600         10  MR-DESCA          PIC  X(01).                        03140000
024700         10  MR-DESCC          PIC  X(01).                        03150000
024800         10  FILLER            PIC  X(01).                        03160000
024900         10  MR-DESCH          PIC  X(01).                        03170000
025000         10  FILLER            PIC  X(01).                        03180000
W24803         10  MR-DESC           PIC  X(13).                        03190000
025200*                                                                 03200000
025300         10  MR-COLORL         PIC S9(04) COMP.                   03210000
025400         10  MR-COLORA         PIC  X(01).                        03220000
025500         10  MR-COLORC         PIC  X(01).                        03230000
025600         10  FILLER            PIC  X(01).                        03240000
025700         10  MR-COLORH         PIC  X(01).                        03250000
025800         10  FILLER            PIC  X(01).                        03260000
025900         10  MR-COLOR          PIC  X(10).                        03270000
026000*                                                                 03280000
026100         10  MR-SIZEL          PIC S9(04) COMP.                   03290000
026200         10  MR-SIZEA          PIC  X(01).                        03300000
026300         10  MR-SIZEC          PIC  X(01).                        03310000
026400         10  FILLER            PIC  X(01).                        03320000
026500         10  MR-SIZEH          PIC  X(01).                        03330000
026600         10  FILLER            PIC  X(01).                        03340000
026700         10  MR-SIZE           PIC  X(10).                        03350000
026800*                                                                 03360000
026900         10  MR-CRTN-UNITSL    PIC S9(04) COMP.                   03370000
027000         10  MR-CRTN-UNITSA    PIC  X(01).                        03380000
027100         10  MR-CRTN-UNITSC    PIC  X(01).                        03390000
027200         10  FILLER            PIC  X(01).                        03400000
027300         10  MR-CRTN-UNITSH    PIC  X(01).                        03410000
027400         10  FILLER            PIC  X(01).                        03420000
027500         10  MR-CRTN-UNITS-X.                                     03430000
027600         15  MR-CRTN-UNITS     PIC  ZZ9.                          03440000
027700*                                                                 03450000
027800         10  MR-QTYL           PIC S9(04) COMP.                   03460000
027900         10  MR-QTYA           PIC  X(01).                        03470000
028000         10  MR-QTYC           PIC  X(01).                        03480000
028100         10  FILLER            PIC  X(01).                        03490000
028200         10  MR-QTYH           PIC  X(01).                        03500000
028300         10  FILLER            PIC  X(01).                        03510000
028400         10  MR-QTY-X.                                            03520000
028500             15  MR-QTY        PIC  Z(6).                         03530000
028600                                                                  03540000
028700                                                                  03550000
028800*---------------------------------------------------------------* 03560000
028900*    DB2 AREA FOR PO DATA                                       * 03570000
029000*---------------------------------------------------------------* 03580000
029100     EXEC SQL                                                     03590000
029200          INCLUDE TPURCHS                                         03600000
029300     END-EXEC.                                                    03610000
028800*---------------------------------------------------------------* 03620000
028900*    DB2 AREA FOR PO PREPACK DATA                               * 03630000
029000*---------------------------------------------------------------* 03640000
029100     EXEC SQL                                                     03650000
029200          INCLUDE TPOPRPK                                         03660000
029300     END-EXEC.                                                    03670000
029400*---------------------------------------------------------------* 03680000
029500*    DB2 AREA FOR PO ITEM DATA                                    03690000
029600*---------------------------------------------------------------* 03700000
029700     EXEC SQL                                                     03710000
029800          INCLUDE TPURITM                                         03720000
029900     END-EXEC.                                                    03730000
W24803*---------------------------------------------------------------* 03740000
W24803*    XLT_SKU TABLE                                                03750000
W24803*---------------------------------------------------------------* 03760000
W24803                                                                  03770000
W24803     EXEC SQL                                                     03780000
W24803        INCLUDE XLT00003                                          03790000
W24803     END-EXEC.                                                    03800000
W24803                                                                  03810000
W24803*---------------------------------------------------------------* 03820000
W24803*    XLT_VND_STYL TABLE                                           03830000
W24803*---------------------------------------------------------------* 03840000
W24803                                                                  03850000
W24803     EXEC SQL                                                     03860000
W24803        INCLUDE XLT00004                                          03870000
W24803     END-EXEC.                                                    03880000
W24803                                                                  03890000
030000*---------------------------------------------------------------* 03900000
030100*    DB2 AREA FOR COMMUNICATIONS                                * 03910000
030200*---------------------------------------------------------------* 03920000
030300     EXEC SQL                                                     03930000
030400          INCLUDE SQLCA                                           03940000
030500     END-EXEC.                                                    03950000
030600                                                                  03960000
030700*---------------------------------------------------------------* 03970000
030800*    CURSOR TO OBTAIN EXISTING PREPACK DATA                     * 03980000
030900*---------------------------------------------------------------* 03990000
031000                                                                  04000000
031100     EXEC SQL                                                     04010000
031200        DECLARE POPRPK-CSR CURSOR                                 04020000
031300          FOR SELECT                                              04030000
031400                PO_NBR                                            04040000
031500              , PO_PREPK_ID                                       04050000
031600              , PREPK_DESC                                        04060000
031700              , PREPK_UPC_NBR                                     04070000
031800              , INPK_UNT_QTY                                      04080000
031900              , INPK_CNVYB_IND                                    04090000
032000              , OTPK_UNT_QTY                                      04100000
032100              , OTPK_ORD_QTY                                      04110000
                    , PK_SKU_NBR                                        04120000
032200          FROM                                                    04130000
032300                TPOPRPK                                           04140000
032400          WHERE                                                   04150000
032500                PO_NBR         =  :ASC-KEY-PO-NBR                 04160000
                AND   PO_PREPK_ID    =  :ASC-KEY-PACK-ID                04170000
032700          ORDER BY                                                04180000
032800                PO_NBR                                            04190000
032900              , PO_PREPK_ID                                       04200000
033000     END-EXEC.                                                    04210000
033100                                                                  04220000
033200*---------------------------------------------------------------* 04230000
033300*    CURSOR TO OBTAIN PRPACK/PURITM DATA                        * 04240000
033400*---------------------------------------------------------------* 04250000
033500     EXEC SQL                                                     04260000
033600          DECLARE PURITM-CSR CURSOR                               04270000
033700          FOR SELECT                                              04280000
033800                PO_LNE_NBR                                        04290000
W24803              , MAJ_CL_NBR                                        04300000
W24803              , SUB_CL_NBR                                        04310000
W24803              , SKU_NBR                                           04320000
W24803              , SU.SKU_DESC                                       04330000
W24803              , VS_NBR                                            04340000
W24803              , CSTM_CLOR_DESC                                    04350000
W24803              , SU.SIZE_DESC                                      04360000
W24803              , CL_NBR                                            04370000
W24803              , SKU_SEQ_NBR                                       04380000
W24803              , PI.SKU_DESC                                       04390000
W24803              , VEND_STYL_NAME                                    04400000
W24803              , COLOR_DESC                                        04410000
W24803              , PI.SIZE_DESC                                      04420000
034500              , PI.PO_PREPK_ID                                    04430000
                    , PI.STATUS_CDE                                     04440000
F34600              , PREPK_RATO_QTY                                    04450000
034700              , UNT_QTY                                           04460000
                    , PU.DEPT_NBR                                       04470000
034800          FROM                                                    04480000
034900                TPOPRPK PK                                        04490000
W24803               ,TPURCHS PU                                        04500000
W24803               ,TPURITM PI                                        04510000
W24803                LEFT OUTER JOIN                                   04520000
W24803                XLT_SKU SU ON PI.ITM_NBR = SU.ITM_NBR             04530000
W24803                LEFT OUTER JOIN                                   04540000
W24803                XLT_VND_STYL VS ON SU.STYL_ID = VS.STYL_ID        04550000
035100          WHERE                                                   04560000
W24803                PK.PO_NBR         = :POPRPK-PO-NBR                04570000
W24803          AND   PK.PO_PREPK_ID    = :POPRPK-PO-PREPK-ID           04580000
035400          AND   PK.PO_NBR         = PI.PO_NBR                     04590000
                AND   PK.PO_NBR         = PU.PO_NBR                     04600000
035500          AND   PK.PO_PREPK_ID    = PI.PO_PREPK_ID                04610000
035600          AND   PI.VER_STATUS_CDE = 'A'                           04620000
                AND   PU.VER_STATUS_CDE = 'A'                           04630000
035700          ORDER BY                                                04640000
035800                PO_LNE_NBR                                        04650000
035900     END-EXEC.                                                    04660000
036000                                                                  04670000
036100 LINKAGE SECTION.                                                 04680000
036200                                                                  04690000
036300 01  DFHCOMMAREA.                                                 04700000
036400     05  FILLER                         OCCURS  1 TO 4072 TIMES   04710000
036500                                        DEPENDING ON EIBCALEN.    04720000
036600         10  FILLER                     PIC X.                    04730000
036700                                                                  04740000
036800                                                                  04750000
036900 PROCEDURE DIVISION.                                              04760000
037000                                                                  04770000
037100 0000-MAIN-MODULE.                                                04780000
037200                                                                  04790000
037300     INITIALIZE DP030-CICS-API-FIELDS.                            04800000
037400     MOVE +1                      TO DP030-NUMBER-OF-MAPS.        04810000
037500     MOVE PC-CURRENT-MAPSET-NAME  TO DP030-MAPSET-NAME.           04820000
037600     MOVE PC-CURRENT-MAP-NAME     TO DP030-MAP-NAME (1).          04830000
037700     SET DP030-RECEIVE-APPL-MAP   TO TRUE.                        04840000
037800     MOVE LENGTH OF PO112AI       TO DP030-MAP-LENGTH (1).        04850000
037900     MOVE 'PROGRAM ENTRY CALL'    TO DP013-MESSAGE-TEXT (1).      04860000
038000     PERFORM 0001-CALL-CICS-ARCH-API.                             04870000
038100                                                                  04880000
038200     PERFORM 1000-CONTROL-PROCESSING.                             04890000
038300                                                                  04900000
038400     MOVE 'PROGRAM EXIT CALL'     TO DP013-MESSAGE-TEXT (1).      04910000
038500     PERFORM 0001-CALL-CICS-ARCH-API.                             04920000
038600                                                                  04930000
038700*----------------------------------------------------------------*04940000
038800*   THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE    *04950000
038900*   AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.          *04960000
039000*----------------------------------------------------------------*04970000
039100                                                                  04980000
039200 0001-CALL-CICS-ARCH-API.                                         04990000
039300                                                                  05000000
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      05010018
039500                                    DFHCOMMAREA                   05020018
039600                                    DP030-CICS-API-FIELDS         05030018
039700                                    DP020-STANDARD-COMMAREA       05040018
039800                                    PO112AI.                      05050018
039900                                                                  05060000
040000     IF  DP030-RC-CALL-SUCCESSFUL                                 05070000
040100         CONTINUE                                                 05080000
040200     ELSE                                                         05090000
040300         SET DP013-NO-ROLLBACK        TO TRUE                     05100000
040400         SET DP013-XCTL-DISPLAY-RESTART TO TRUE                   05110000
040500         SET DP013-CICS-ABEND         TO TRUE                     05120000
CICS           MOVE '0001-CALL-CICS-ARCH-API' TO DP013-PARAGRAPH        05130018
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O05140018
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      05150018
040900         MOVE DP030-RETURN-CODE       TO DP013-MESSAGE-TEXT (3)   05160000
041000         PERFORM DP013-0000-PROCESS-ABEND                         05170000
041100     END-IF.                                                      05180000
041200                                                                  05190000
041300                                                                  05200000
041400 1000-CONTROL-PROCESSING.                                         05210000
041500*----------------------------------------------------------------*05220000
041600* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *05230000
041700* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *05240000
041800*                                                                *05250000
041900* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *05260000
042000*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *05270000
042100*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *05280000
042200*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *05290000
042300*----------------------------------------------------------------*05300000
042400                                                                  05310000
042500     EVALUATE TRUE                                                05320000
042600         WHEN DP020-NEXT-ACT-INITIAL                              05330000
043600             PERFORM 1100-PROCESS-INTER-APPL-COMM                 05340000
043700             IF PS-COMMAREA-NOT-VALID                             05350000
043800                 CONTINUE                                         05360000
044000             ELSE                                                 05370000
044100                 PERFORM 5000-CREATE-PACK-QUEUE                   05380000
044200                 PERFORM 4000-BUILD-INITIAL-PANEL                 05390000
044300             END-IF                                               05400000
044400                                                                  05410000
044500         WHEN DP020-NEXT-ACT-READ-MAP                             05420000
044800             PERFORM 2000-PROCESS-PANEL                           05430000
044900                                                                  05440000
045000         WHEN DP020-NEXT-ACT-RETURN                               05450000
045400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 05460000
045500                                                                  05470000
045600         WHEN OTHER                                               05480000
045700             SET DP013-LOGIC-ABEND    TO TRUE                     05490000
045800             SET DP013-NO-ROLLBACK    TO TRUE                     05500000
045900             MOVE '1000-CONTROL-PROCESSING'                       05510000
046000                                      TO DP013-PARAGRAPH          05520000
046100             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    05530000
046200                                      TO DP013-MESSAGE-TEXT(1)    05540000
046300             PERFORM DP013-0000-PROCESS-ABEND                     05550000
046400     END-EVALUATE.                                                05560000
046500                                                                  05570000
046600                                                                  05580000
046700 1100-PROCESS-INTER-APPL-COMM.                                    05590000
046800*----------------------------------------------------------------*05600000
046900* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *05610000
047000* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *05620000
047100*----------------------------------------------------------------*05630000
047200                                                                  05640000
047300     SET PS-COMMAREA-VALID            TO TRUE.                    05650000
047400     MOVE SPACE                       TO ASC-START-ITEM-REQUEST.  05660000
           INITIALIZE ASC-SPECIFIC-COMMAREA.                            05670000
047500                                                                  05680000
048100                                                                  05740000
048200     IF PO013-PO-NBR = ZERO                                       05750000
048300         MOVE PC-TSYMSG-00461         TO DP020-MSG-NUMBER         05760000
048400         SET PS-COMMAREA-NOT-VALID                                05770000
048500             DP020-MSG-FATAL          TO TRUE                     05780000
048600     ELSE                                                         05790000
048700         MOVE PO013-PO-NBR            TO ASC-KEY-PO-NBR           05800000
048800     END-IF.                                                      05810000
048900                                                                  05820000
049000     IF PO013-DEPT-NBR = SPACES                                   05830000
049100         MOVE PC-TSYMSG-00588         TO DP020-MSG-NUMBER         05840000
049200         SET PS-COMMAREA-NOT-VALID                                05850000
049300             DP020-MSG-FATAL          TO TRUE                     05860000
049400     ELSE                                                         05870000
049500         MOVE PO013-DEPT-NBR          TO ASC-KEY-DEPT-NBR         05880000
049600     END-IF.                                                      05890000
           IF PS-COMMAREA-NOT-VALID                                     05900000
              SET DP020-NEXT-ACT-APPL-ERROR                             05910000
                  DP020-MSG-FATAL  TO TRUE                              05920000
           END-IF.                                                      05930000
049700                                                                  05940000
           SET ASC-USE-SELECTION-QUEUE      TO TRUE.                    05950000
           MOVE PO013-NUMBER-OF-SELECTED-ITEMS                          05960000
                                        TO ASC-NUMBER-OF-SELECTED-ITEMS.05970000
           MOVE PO013-NUMBER-OF-TS-ITEMS TO ASC-NUMBER-OF-TS-ITEMS.     05980000
           MOVE PO013-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME.         05990000
049800     MOVE ZEROES                      TO PV-PO-PREPK-ID.          06000000
049900     MOVE +1                          TO ASC-BLK-SUB              06010000
050000                                         ASC-ITEM-SUB.            06020000
                                                                        06030000
           PERFORM 1120-PREPARE-LIST-ENTRY.                             06040000
 50100                                                                  06050000
050200                                                                  06060000
       1120-PREPARE-LIST-ENTRY.                                         06070000
      *----------------------------------------------------------------*06080000
      *                                                                *06090000
      *----------------------------------------------------------------*06100000
                                                                        06110000
           MOVE PO012-MAX-ITEMS         TO ASC-SEL-SUB.                 06120000
           MOVE ZERO                    TO ASC-SEL-ITEM                 06130000
                                           ASC-ITEM-NBR.                06140000
                                                                        06150000
           PERFORM 2010-GET-NEXT-PO-PACK.                               06160000
                                                                        06170000
050300 2000-PROCESS-PANEL.                                              06180000
050400*----------------------------------------------------------------*06190000
050500*    RECEIVE THE MAP AND PERFORM THE APPROPRIATE PARAGRAPH BASED *06200000
050600*    ON WHAT FUNCTION KEY WAS SELECTED.                          *06210000
050700*----------------------------------------------------------------*06220000
050800                                                                  06230000
050900     EVALUATE TRUE                                                06240000
051000         WHEN DP020-SRC-AID = DP016-CLEAR                         06250000
051100             MOVE ZERO TO ASC-ITEM-AT-TOP-OF-PANEL                06260000
051200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06270000
051300             PERFORM 3200-RESET-ATTRIBUTES                        06280000
051400                                                                  06290000
051500         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    06300000
                   MOVE ZERO                TO ASC-ITEM-AT-TOP-OF-PANEL 06310000
                   PERFORM 4000-BUILD-INITIAL-PANEL                     06320000
052600                                                                  06330000
052700* F20 'NEXT PK'                                                   06340000
052800** ---------------------- FK-NEXT-SELECTION ------------------*   06350000
052900         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             06360000
053000             IF ASC-ITEM-NBR <                                    06370000
                      ASC-NUMBER-OF-SELECTED-ITEMS                      06380000
053100                 PERFORM 2010-GET-NEXT-PO-PACK                    06390000
053200                 IF PS-LIST-END                                   06400000
053300                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         06410000
053400                     SET PS-LIST-NOT-END TO TRUE                  06420000
053500                 ELSE                                             06430000
                           ADD +1 TO ASC-ITEM-NBR                       06440000
                           PERFORM 5000-CREATE-PACK-QUEUE               06450000
053600                     PERFORM 4000-BUILD-INITIAL-PANEL             06460000
053700                 END-IF                                           06470000
053800                 PERFORM 3200-RESET-ATTRIBUTES                    06480000
053900             ELSE                                                 06490000
054000                 MOVE PC-TSYMSG-02096 TO DP020-MSG-NUMBER         06500000
054100                 SET DP020-MSG-INFORMATIONAL TO TRUE              06510000
054200             END-IF                                               06520000
054300                                                                  06530000
054400* F19 'PREV PK'                                                   06540000
054500** ---------------------- FK-PREV-SELECTION ------------------*   06550000
054600         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             06560000
054700             IF ASC-ITEM-NBR > 1                                  06570000
054800                 PERFORM 2020-GET-PREV-PO-PACK                    06580000
054900                  IF PS-LIST-END                                  06590000
055000                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         06600000
055100                     SET PS-LIST-NOT-END TO TRUE                  06610000
 55200                 ELSE                                             06620000
                           SUBTRACT +1 FROM ASC-ITEM-NBR                06630000
                           PERFORM 5000-CREATE-PACK-QUEUE               06640000
055300                     PERFORM 4000-BUILD-INITIAL-PANEL             06650000
055400                 END-IF                                           06660000
055500                 PERFORM 3200-RESET-ATTRIBUTES                    06670000
055600             ELSE                                                 06680000
055700                 MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER         06690000
055800                 SET DP020-MSG-INFORMATIONAL TO TRUE              06700000
055900             END-IF                                               06710000
056000                                                                  06720000
056100         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  06730000
056200             MOVE +1 TO PV-TOP-ITEM                               06740000
056300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06750000
056400             PERFORM 3200-RESET-ATTRIBUTES                        06760000
056500                                                                  06770000
056600         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   06780000
056700             PERFORM 2110-BROWSE-BACKWARD                         06790000
056800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06800000
056900             PERFORM 3200-RESET-ATTRIBUTES                        06810000
057000                                                                  06820000
057100         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   06830000
057200             PERFORM 2120-BROWSE-FORWARD                          06840000
057300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06850000
057400             PERFORM 3200-RESET-ATTRIBUTES                        06860000
057500                                                                  06870000
057600         WHEN DP020-SRC-AID = DP016-ENTER                         06880000
057700             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 06890000
057800             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   06900000
057900             IF  PS-ERROR                                         06910000
058000                 CONTINUE                                         06920000
058100             ELSE                                                 06930000
058200                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             06940000
058300                 PERFORM 3200-RESET-ATTRIBUTES                    06950000
058400             END-IF                                               06960000
058500                                                                  06970000
058600         WHEN OTHER                                               06980000
058700             SET DP013-NO-ROLLBACK    TO TRUE                     06990000
058800             SET DP013-XCTL-DISPLAY-RESTART TO TRUE               07000000
058900             SET DP013-CICS-ABEND     TO TRUE                     07010000
059000             MOVE '2000-PROCESS-PANEL' TO DP013-PARAGRAPH         07020000
059100             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      07030000
059200                                      TO DP013-MESSAGE-TEXT (1)   07040000
059300             PERFORM DP013-0000-PROCESS-ABEND                     07050000
059400                                                                  07060000
059500     END-EVALUATE.                                                07070000
059600                                                                  07080000
       2010-GET-NEXT-PO-PACK.                                           07090000
      *----------------------------------------------------------------*07100000
      *                                                                *07110000
      *----------------------------------------------------------------*07120000
                                                                        07130000
           ADD +1                          TO ASC-SEL-SUB               07140000
           IF ASC-SEL-SUB > PO012-MAX-ITEMS                             07150000
              ADD +1                       TO ASC-SEL-ITEM              07160000
                                              ASC-ITEM-NBR              07170000
              MOVE +1                      TO ASC-SEL-SUB               07180000
           END-IF.                                                      07190000
           IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                 07200000
              PERFORM 9100-READ-SEL-QUEUE                               07210000
              IF PO012-ITEM (ASC-SEL-SUB) > ZERO                        07220000
                 MOVE PO012-PACK-ID (ASC-SEL-SUB)                       07230000
                                             TO ASC-KEY-PACK-ID         07240000
                 SET PO012-INQ (ASC-SEL-SUB) TO TRUE                    07250000
                 PERFORM 9200-REWRITE-LIST-QUEUE                        07260000
           ELSE                                                         07270000
                 SUBTRACT +1 FROM ASC-SEL-SUB                           07280000
      *          ------BOTTOM OF LIST----------                         07290000
                 MOVE PC-TSYMSG-00070        TO DP020-MSG-NUMBER        07300000
                 SET DP020-MSG-INFORMATIONAL                            07310000
                     PS-LIST-END             TO TRUE                    07320000
              END-IF                                                    07330000
           ELSE                                                         07340000
               SUBTRACT +1 FROM ASC-SEL-ITEM                            07350000
                                ASC-ITEM-NBR                            07360000
               MOVE PO012-MAX-ITEMS     TO ASC-SEL-SUB                  07370000
               MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             07380000
               SET DP020-MSG-INFORMATIONAL TO TRUE                      07390000
               SET PS-LIST-END             TO TRUE                      07400000
           END-IF.                                                      07410000
                                                                        07420000
       2020-GET-PREV-PO-PACK.                                           07430000
           SUBTRACT +1 FROM ASC-SEL-SUB.                                07440000
           IF  ASC-SEL-SUB < +1                                         07450000
               SUBTRACT +1 FROM ASC-SEL-ITEM                            07460000
                                ASC-ITEM-NBR                            07470000
               MOVE PO012-MAX-ITEMS         TO ASC-SEL-SUB              07480000
           END-IF.                                                      07490000
                                                                        07500000
           IF ASC-SEL-ITEM > ZERO                                       07510000
              PERFORM 9100-READ-SEL-QUEUE                               07520000
              MOVE PO012-PACK-ID (ASC-SEL-SUB)                          07530000
                                           TO ASC-KEY-PACK-ID           07540000
           ELSE                                                         07550000
              MOVE +1                      TO ASC-SEL-ITEM              07560000
                                              ASC-ITEM-NBR              07570000
                                              ASC-SEL-SUB               07580000
      *       ---------TOP OF LIST-------------                         07590000
              MOVE PC-TSYMSG-00069         TO DP020-MSG-NUMBER          07600000
              SET DP020-MSG-INFORMATIONAL                               07610000
                  PS-LIST-END              TO TRUE                      07620000
           END-IF.                                                      07630000
                                                                        07640000
059700                                                                  07650000
059800 2110-BROWSE-BACKWARD.                                            07660000
059900*----------------------------------------------------------------*07670000
060000*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *07680000
060100*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *07690000
060200*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *07700000
060300*    MESSAGE.                                                    *07710000
060400*----------------------------------------------------------------*07720000
060500                                                                  07730000
060600     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    07740000
060700         GIVING PV-TOP-ITEM.                                      07750000
060800                                                                  07760000
060900     IF  PV-TOP-ITEM < +1                                         07770000
061000         MOVE +1                      TO PV-TOP-ITEM              07780000
061100*        -- TOP OF LIST --                                        07790000
061200         MOVE PC-TSYMSG-00069         TO DP020-MSG-NUMBER         07800000
061300         SET DP020-MSG-INFORMATIONAL  TO TRUE                     07810000
061400     END-IF.                                                      07820000
061500                                                                  07830000
061600                                                                  07840000
061700 2120-BROWSE-FORWARD.                                             07850000
061800*----------------------------------------------------------------*07860000
061900*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *07870000
062000*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *07880000
062100*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *07890000
062200*----------------------------------------------------------------*07900000
062300                                                                  07910000
062400     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              07920000
062500         GIVING PV-TOP-ITEM.                                      07930000
062600     IF  PV-TOP-ITEM > ASC-NBR-ITEMS-READ                         07940000
062700         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            07950000
062800                                      TO PV-TOP-ITEM              07960000
062900*        -- BOTTOM OF LIST --                                     07970000
063000         MOVE PC-TSYMSG-00070         TO DP020-MSG-NUMBER         07980000
063100         SET DP020-MSG-INFORMATIONAL  TO TRUE                     07990000
063200     ELSE                                                         08000000
063300         COMPUTE PV-BOTTOM-ITEM =                                 08010000
063400             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 08020000
063500         IF  PV-BOTTOM-ITEM > ASC-NBR-ITEMS-READ                  08030000
063600*            -- BOTTOM OF LIST --                                 08040000
063700             MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER         08050000
063800             SET DP020-MSG-INFORMATIONAL                          08060000
063900                                      TO TRUE                     08070000
064000         END-IF                                                   08080000
064100     END-IF.                                                      08090000
064200                                                                  08100000
064300 2130-CHECK-FOR-JUMP-BROWSE.                                      08110000
064400*----------------------------------------------------------------*08120000
064500*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *08130000
064600*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *08140000
064700*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *08150000
064800*    RATHER THAN HITTING PF8 TO PAGE FORWARD TO THAT POINT.      *08160000
064900*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *08170000
065000*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *08180000
065100*----------------------------------------------------------------*08190000
065200                                                                  08200000
065300     SET PS-ERROR-NO                  TO TRUE.                    08210000
065400     IF (ASC-START-ITEM-REQUEST = SPACE)                          08220000
065500         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            08230000
065600                                      TO PV-TOP-ITEM              08240000
065700     ELSE                                                         08250000
065800         MOVE ASC-START-ITEM-REQUEST  TO DP010I-UNEDITED-FIELD    08260000
065900         MOVE PC-NUMBER-LENGTH        TO DP010I-MAXIMUM-DIGITS    08270000
066000         MOVE +0                      TO DP010I-MAXIMUM-DECIMALS  08280000
066100         SET DP010I-NEGATIVE-NOT-ALLOWED                          08290000
066200                                      TO TRUE                     08300000
264220         CALL DP010I-NUMERIC-EDIT-ROUTINE                         08311015
264230                         USING DP010I-NUMERIC-EDIT-AREA           08312015
066400                                                                  08320000
066500         IF  NOT DP010I-ERROR-DETECTED                            08330000
066600             MOVE DP010I-NUMERIC-FIELD                            08340000
066700                                      TO ASC-START-ITEM-REQUEST-N 08350000
066800             IF  ASC-START-ITEM-REQUEST-N > ZERO                  08360000
066900                 IF  ASC-START-ITEM-REQUEST-N >                   08370000
067000                                          ASC-NBR-ITEMS-READ      08380000
067100                     MOVE SPACE       TO ASC-START-ITEM-REQUEST   08390000
067200                     COMPUTE PV-TOP-ITEM =                        08400000
067300                             ASC-NBR-ITEMS-READ                   08410000
067400                             - PC-ITEMS-PER-PANEL + 1             08420000
067500                     IF  PV-TOP-ITEM < +1                         08430000
067600                         MOVE +1      TO PV-TOP-ITEM              08440000
067700                         MOVE PC-TSYMSG-00070                     08450000
067800                                      TO DP020-MSG-NUMBER         08460000
067900                         SET DP020-MSG-INFORMATIONAL              08470000
068000                                      TO TRUE                     08480000
068100                     END-IF                                       08490000
068200                 ELSE                                             08500000
068300                     MOVE ASC-START-ITEM-REQUEST-N                08510000
068400                                      TO PV-TOP-ITEM              08520000
068500                     MOVE SPACE       TO ASC-START-ITEM-REQUEST   08530000
068600                     COMPUTE PV-BOTTOM-ITEM =                     08540000
068700                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     08550000
068800                     IF  PV-BOTTOM-ITEM > ASC-NBR-ITEMS-READ      08560000
068900*                        -- BOTTOM OF LIST --                     08570000
069000                         MOVE PC-TSYMSG-00070                     08580000
069100                                      TO DP020-MSG-NUMBER         08590000
069200                         SET DP020-MSG-INFORMATIONAL              08600000
069300                                      TO TRUE                     08610000
069400                     END-IF                                       08620000
069500                 END-IF                                           08630000
069600             ELSE                                                 08640000
069700*                --- VALUE OUT OF RANGE ----                      08650000
069800                 MOVE PC-TSYMSG-01279 TO DP020-MSG-NUMBER         08660000
069900                 MOVE -1              TO ASTRTITL                 08670000
070000                 SET DP030-SET-CURSOR-APPL-1                      08680000
070100                                      TO TRUE                     08690000
070200                 MOVE DP015-REVERSE   TO ASTRTITH                 08700000
070300                 MOVE DP015-RED       TO ASTRTITC                 08710000
070400                 MOVE DP015-UNP-NUM-BRT-MDT                       08720000
070500                                      TO ASTRTITA                 08730000
070600                 SET DP020-MSG-FATAL                              08740000
070700                     PS-ERROR         TO TRUE                     08750000
070800             END-IF                                               08760000
070900                                                                  08770000
071000         ELSE                                                     08780000
071100             MOVE PC-TSYMSG-00008     TO DP020-MSG-NUMBER         08790000
071200             MOVE -1                  TO ASTRTITL                 08800000
071300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08810000
071400             MOVE DP015-REVERSE       TO ASTRTITH                 08820000
071500             MOVE DP015-RED           TO ASTRTITC                 08830000
071600             MOVE DP015-UNP-NUM-BRT-MDT                           08840000
071700                                      TO ASTRTITA                 08850000
071800             SET DP020-MSG-FATAL                                  08860000
071900                 PS-ERROR             TO TRUE                     08870000
072000         END-IF                                                   08880000
072100     END-IF.                                                      08890000
072200                                                                  08900000
072300                                                                  08910000
078200 2200-MOVE-SCREEN-TO-COMMAREA.                                    08920000
078300*----------------------------------------------------------------*08930000
078400*    RESET ATTRIBUTES.                                           *08940000
078500*----------------------------------------------------------------*08950000
078600                                                                  08960000
078700     IF ASTRTITL > ZERO                                           08970000
078800         MOVE ASTRTITI                TO ASC-START-ITEM-REQUEST   08980000
078900     ELSE                                                         08990000
079000         IF ASTRTITF = DP015-ERASE-EOF                            09000000
079100             INITIALIZE ASC-START-ITEM-REQUEST                    09010000
079200         END-IF                                                   09020000
079300     END-IF.                                                      09030000
079400                                                                  09040000
079500                                                                  09050000
079600 3200-RESET-ATTRIBUTES.                                           09060000
079700*----------------------------------------------------------------*09070000
079800*    RESET ATTRIBUTES.                                           *09080000
079900*----------------------------------------------------------------*09090000
080000                                                                  09100000
080100     MOVE DP015-UNP-ALP-NOR-OFF       TO ASTRTITA.                09110000
080200     MOVE DP015-GREEN                 TO ASTRTITC.                09120000
080300     MOVE DP015-UNDERLINE             TO ASTRTITH.                09130000
080400     MOVE -1                          TO ASTRTITL.                09140000
080500     SET DP030-SET-CURSOR-APPL-1      TO TRUE.                    09150000
080600                                                                  09160000
080700                                                                  09170000
080800 4000-BUILD-INITIAL-PANEL.                                        09180000
080900*----------------------------------------------------------------*09190000
081000*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *09200000
081100*    INITIALIZE ALL COUNTERS AND FLAGS.                          *09210000
081200*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *09220000
081300*    DISPLAY THE PANEL TO USER.                                  *09230000
081400*----------------------------------------------------------------*09240000
081500                                                                  09250000
081600     IF ASC-NBR-PACKS-READ > ZERO                                 09260000
081700*  GET ALL THE PREPACK LINE DATA FOR THIS PO.                     09270000
081800                                                                  09280000
081900         PERFORM 8200-DELETE-ITEM-QUEUE                           09290000
082000         INITIALIZE ASC-BLOCK-ENTRIES (1)                         09300000
082100                    ASC-BLOCK-ENTRIES (2)                         09310000
082200         MOVE +1                      TO ASC-BLK-SUB              09320000
                                               ASC-ITEM-SUB             09330000
082300*        MOVE +0                      TO ASC-ITEM-SUB             09340000
082400         MOVE +0                      TO ASC-NBR-ITEMS-READ       09350000
082500                                         ASC-HIGH-BLOCK-WRITTEN   09360000
082600                                         ASC-ITEM-AT-TOP-OF-PANEL 09370000
082700                                                                  09380000
082800         SET ASC-ITEMS-LEFT-ON-DB     TO TRUE                     09390000
082900         INITIALIZE ASC-TOTAL-UNITS                               09400000
083000                    ASC-NBR-INNER-PACKS                           09410000
083100                                                                  09420000
083200         PERFORM 4200-OPEN-PURITM-CSR                             09430000
083300         PERFORM 4250-PROCESS-PURITM-LINE                         09440000
083400         PERFORM 4299-CLOSE-PURITM-CSR                            09450000
083500     END-IF.                                                      09460000
083600                                                                  09470000
083700     MOVE +1                          TO  PV-TOP-ITEM.            09480000
083800     IF ASC-NBR-ITEMS-READ = ZERO                                 09490000
083900         SET DP020-NEXT-ACT-APPL-ERROR                            09500000
084000             DP020-MSG-FATAL          TO TRUE                     09510000
084100         MOVE PC-TSYMSG-02117         TO DP020-MSG-NUMBER         09520000
084200     ELSE                                                         09530000
084300         MOVE -1                      TO ASTRTITL                 09540000
084400         SET DP030-SET-CURSOR-APPL-1  TO TRUE                     09550000
084500         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     09560000
084600     END-IF.                                                      09570000
                                                                        09580000
           IF PS-RV-STATUS                                              09590000
              MOVE PC-TSYMSG-02762     TO DP020-MSG-NUMBER              09600000
              SET DP020-MSG-INFORMATIONAL TO TRUE                       09610000
           END-IF.                                                      09620000
084700                                                                  09630000
084800 4200-OPEN-PURITM-CSR.                                            09640000
084900*----------------------------------------------------------------*09650000
085000* OPEN THE CURSOR.                                               *09660000
085100*----------------------------------------------------------------*09670000
085200                                                                  09680000
W24803     INITIALIZE DCLTPOPRPK                                        09690000
W24803                DCLTPURITM                                        09700000
W24803                DCLTPURCHS.                                       09710000
W24803     MOVE ASC-KEY-PO-NBR   TO POPRPK-PO-NBR.                      09720000
W24803     MOVE ASC-KEY-PACK-ID  TO POPRPK-PO-PREPK-ID.                 09730000
085300     EXEC SQL                                                     09740000
085400          OPEN PURITM-CSR                                         09750000
085500     END-EXEC.                                                    09760000
085600                                                                  09770000
085700     EVALUATE TRUE                                                09780000
085800         WHEN SQLCODE = ZERO                                      09790000
085900           CONTINUE                                               09800000
086000         WHEN SQLWARN0 NOT EQUAL SPACE                            09810000
086100         WHEN SQLCODE NOT EQUAL ZERO                              09820000
086200           MOVE '4200-OPEN-PURITM-CSR'                            09830000
086300                                      TO DP013-PARAGRAPH          09840000
086400           MOVE 'OPEN PURITM CURSOR'  TO DP013-MESSAGE-TEXT (1)   09850000
086500           MOVE SQLCA                 TO DP013-SQLCA              09860000
086600           MOVE 'TPURITM'             TO DP013-DB2-TABLE-NAME (1) 09870000
086700           MOVE 'TPOPRPK'             TO DP013-DB2-TABLE-NAME (2) 09880000
086800           SET DP013-DB2-ABEND        TO TRUE                     09890000
086900           PERFORM DP013-0000-PROCESS-ABEND                       09900000
087000     END-EVALUATE.                                                09910000
087100                                                                  09920000
087200                                                                  09930000
087300 4250-PROCESS-PURITM-LINE.                                        09940000
087400*----------------------------------------------------------------*09950000
087500* PROCESS PREPACK LINE INFORMATION                               *09960000
087600*----------------------------------------------------------------*09970000
087700                                                                  09980000
087800     PERFORM                                                      09990000
087900       VARYING PV-READ-COUNT                                      10000000
088000       FROM 1 BY 1                                                10010000
088100       UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                      10020000
088200          OR (ASC-ITEMS-LEFT-ON-DB-NO))                           10030000
088300                                                                  10040000
088400         PERFORM 4275-FETCH-PURITM                                10050000
088500                                                                  10060000
               IF  PURITM-STATUS-CDE = 'RV'                             10070000
                   SET PS-RV-STATUS TO TRUE                             10080000
               END-IF                                                   10090000
                                                                        10100000
088600         IF  ASC-ITEMS-LEFT-ON-DB                                 10110000
088700             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                10120000
088800                 ADD +1               TO ASC-ITEM-SUB             10130000
088900             ELSE                                                 10140000
089000                 ADD +1               TO ASC-BLK-SUB              10150000
089100                 MOVE +1              TO ASC-ITEM-SUB             10160000
089200                                                                  10170000
089300                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS                  10180000
089400                     MOVE +1          TO ASC-BLK-SUB              10190000
                           PERFORM 7200-WRITE-ITEM-QUEUE                10200000
089600                     MOVE ASC-BLOCK-ENTRIES (PC-MAX-BLOCKS)       10210000
089700                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 10220000
089800                     ADD +1           TO ASC-BLK-SUB              10230000
089900                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   10240000
090000                 END-IF                                           10250000
090100             END-IF                                               10260000
090200             ADD +1                   TO ASC-NBR-ITEMS-READ       10270000
090300             MOVE ASC-NBR-ITEMS-READ                              10280000
090400                                      TO ASC-LIST-ITEM-NUMBER     10290000
090500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  10300000
                   MOVE PURCHS-DEPT-NBR     TO ASC-DEP-NBR              10310000
                                            (ASC-BLK-SUB, ASC-ITEM-SUB) 10320000
W24803                                         PV-TEMP-SKU-DEPT         10330000
W24803             IF PV-SKU-NBR-IND = 0                                10340000
W24803                MOVE XLT00004-MAJ-CL-NBR   TO ASC-MAJ-CL-NBR      10350000
W24803                                      (ASC-BLK-SUB, ASC-ITEM-SUB) 10360000
W24803                MOVE XLT00004-SUB-CL-NBR   TO ASC-CL-NBR          10370000
W24803                                      (ASC-BLK-SUB, ASC-ITEM-SUB) 10380000
W24803                MOVE XLT00003-SKU-NBR      TO ASC-SKU-NBR         10390000
W24803                                      (ASC-BLK-SUB, ASC-ITEM-SUB) 10400000
W24803                MOVE XLT00004-VS-NBR       TO ASC-VEND-STYL-NAME  10410000
W24803                                      (ASC-BLK-SUB, ASC-ITEM-SUB) 10420000
W24803                MOVE XLT00003-SKU-DESC     TO ASC-SKU-DESC        10430000
W24803                                      (ASC-BLK-SUB, ASC-ITEM-SUB) 10440000
W24803                MOVE XLT00003-CSTM-CLOR-DESC TO ASC-COLOR-DESC    10450000
W24803                                      (ASC-BLK-SUB, ASC-ITEM-SUB) 10460000
W24803                MOVE XLT00003-SIZE-DESC    TO ASC-SIZE-DESC       10470000
W24803                                      (ASC-BLK-SUB, ASC-ITEM-SUB) 10480000
W24803             ELSE                                                 10490000
W24803                MOVE PURITM-CL-NBR         TO ASC-CL-NBR          10500000
W24803                                      (ASC-BLK-SUB, ASC-ITEM-SUB) 10510000
W24803                                              PV-TEMP-SKU-CLASS   10520000
W24803                MOVE PURITM-CL-NBR (1:1)   TO PV-MAJ-CL-1         10530000
W24803                MOVE PV-MAJ-CLASS          TO ASC-MAJ-CL-NBR      10540000
W24803                                      (ASC-BLK-SUB, ASC-ITEM-SUB) 10550000
W24803                MOVE PURITM-SKU-SEQ-NBR    TO PV-TEMP-SKU-SEQ     10560000
W24803                MOVE PV-SKU-NBR            TO ASC-SKU-NBR         10570000
W24803                                      (ASC-BLK-SUB, ASC-ITEM-SUB) 10580000
W24803                MOVE PURITM-VEND-STYL-NAME TO ASC-VEND-STYL-NAME  10590000
W24803                                      (ASC-BLK-SUB, ASC-ITEM-SUB) 10600000
W24803                MOVE PURITM-SKU-DESC       TO ASC-SKU-DESC        10610000
W24803                                      (ASC-BLK-SUB, ASC-ITEM-SUB) 10620000
W24803                MOVE PURITM-COLOR-DESC     TO ASC-COLOR-DESC      10630000
W24803                                      (ASC-BLK-SUB, ASC-ITEM-SUB) 10640000
W24803                MOVE PURITM-SIZE-DESC      TO ASC-SIZE-DESC       10650000
W24803                                      (ASC-BLK-SUB, ASC-ITEM-SUB) 10660000
W24803             END-IF                                               10670000
091800             MOVE PURITM-PREPK-RATO-QTY                           10680000
091900                                      TO ASC-PREPK-RATO-QTY       10690000
092000                             (ASC-BLK-SUB, ASC-ITEM-SUB)          10700000
092100             MOVE PURITM-UNT-QTY      TO ASC-UNT-QTY              10710000
092200                             (ASC-BLK-SUB, ASC-ITEM-SUB)          10720000
092300             ADD PURITM-UNT-QTY       TO ASC-TOTAL-UNITS          10730000
092400         END-IF                                                   10740000
092500     END-PERFORM.                                                 10750000
           IF  ASC-NBR-ITEMS-READ > ZERO                                10760000
               MOVE +1                      TO ASC-BLK-SUB              10770000
               PERFORM 7200-WRITE-ITEM-QUEUE                            10780000
               ADD +1                       TO ASC-BLK-SUB              10790000
               PERFORM 7200-WRITE-ITEM-QUEUE                            10800000
                                                                        10810000
               MOVE 1                       TO ASC-BLK-SUB              10820000
                                               PV-BLOCK-NUMBER          10830000
           END-IF.                                                      10840000
                                                                        10850000
 92600                                                                  10860000
093600                                                                  10870000
093700 4275-FETCH-PURITM.                                               10880000
093800*----------------------------------------------------------------*10890000
093900* FETCH PREPACK LINE INFORMATION                                 *10900000
094000*----------------------------------------------------------------*10910000
094100                                                                  10920000
094200     EXEC SQL                                                     10930000
094300       FETCH PURITM-CSR                                           10940000
094400         INTO :PURITM-PO-LNE-NBR                                  10950000
W24803             ,:XLT00004-MAJ-CL-NBR:PV-MAJ-CL-NBR-IND              10960000
W24803             ,:XLT00004-SUB-CL-NBR:PV-SUB-CL-NBR-IND              10970000
W24803             ,:XLT00003-SKU-NBR:PV-SKU-NBR-IND                    10980000
W24803             ,:XLT00003-SKU-DESC:PV-SKU-DESC-IND                  10990000
W24803             ,:XLT00004-VS-NBR:PV-VS-NBR-IND                      11000000
W24803             ,:XLT00003-CSTM-CLOR-DESC:PV-CSTM-CLOR-DESC-IND      11010000
W24803             ,:XLT00003-SIZE-DESC:PV-SIZE-DESC-IND                11020000
W24803             ,:PURITM-CL-NBR                                      11030000
W24803             ,:PURITM-SKU-SEQ-NBR                                 11040000
W24803             ,:PURITM-SKU-DESC                                    11050000
W24803             ,:PURITM-VEND-STYL-NAME                              11060000
W24803             ,:PURITM-COLOR-DESC                                  11070000
W24803             ,:PURITM-SIZE-DESC                                   11080000
095100             ,:PURITM-PO-PREPK-ID                                 11090000
                   ,:PURITM-STATUS-CDE                                  11100000
095200             ,:PURITM-PREPK-RATO-QTY                              11110000
095300             ,:PURITM-UNT-QTY                                     11120000
                   ,:PURCHS-DEPT-NBR                                    11130000
095400     END-EXEC.                                                    11140000
095500                                                                  11150000
095600     EVALUATE TRUE                                                11160000
095700       WHEN SQLCODE = +0                                          11170000
095800         CONTINUE                                                 11180000
095900       WHEN SQLCODE = +100                                        11190000
096000         SET ASC-ITEMS-LEFT-ON-DB-NO  TO TRUE                     11200000
096100                                                                  11210000
096200       WHEN SQLWARN0 NOT = SPACE                                  11220000
096300       WHEN SQLCODE < +0                                          11230000
096400       WHEN SQLCODE > +0                                          11240000
096500         MOVE '4275-FETCH-PURITM'     TO DP013-PARAGRAPH          11250000
096600         MOVE 'FETCH PURITM CURSOR'   TO DP013-MESSAGE-TEXT(1)    11260000
096700         MOVE SQLCA                   TO DP013-SQLCA              11270000
096800         MOVE 'TPURITM'               TO DP013-DB2-TABLE-NAME (1) 11280000
096900         MOVE 'TPOPRPK'               TO DP013-DB2-TABLE-NAME (2) 11290000
097000         SET DP013-DB2-ABEND                                      11300000
097100             DP013-XCTL-DISPLAY-RESTART TO TRUE                   11310000
097200         PERFORM DP013-0000-PROCESS-ABEND                         11320000
097300     END-EVALUATE.                                                11330000
097400                                                                  11340000
097500                                                                  11350000
097600 4299-CLOSE-PURITM-CSR.                                           11360000
097700*----------------------------------------------------------------*11370000
097800* CLOSE THE CURSOR.                                              *11380000
097900*----------------------------------------------------------------*11390000
098000                                                                  11400000
098100     EXEC SQL                                                     11410000
098200         CLOSE PURITM-CSR                                         11420000
098300     END-EXEC.                                                    11430000
098400                                                                  11440000
098500     EVALUATE TRUE                                                11450000
098600         WHEN SQLCODE = ZERO                                      11460000
098700           CONTINUE                                               11470000
098800         WHEN SQLWARN0 NOT EQUAL SPACE                            11480000
098900         WHEN SQLCODE NOT EQUAL ZERO                              11490000
099000           MOVE '4299-CLOSE-PURITM-CSR'                           11500000
099100                                      TO DP013-PARAGRAPH          11510000
099200           MOVE 'CLOSE PURITM CURSOR' TO DP013-MESSAGE-TEXT (1)   11520000
099300           MOVE SQLCA                 TO DP013-SQLCA              11530000
099400           SET DP013-DB2-ABEND        TO TRUE                     11540000
099500           PERFORM DP013-0000-PROCESS-ABEND                       11550000
099600     END-EVALUATE.                                                11560000
099700                                                                  11570000
099800                                                                  11580000
099900 4400-MOVE-COMMAREA-TO-SCREEN.                                    11590000
100000*----------------------------------------------------------------*11600000
100100*    FORMAT THE MAP AND DETERMINE THE CURSOR POSITION.           *11610000
100200*----------------------------------------------------------------*11620000
100300                                                                  11630000
100400     MOVE ASC-KEY-PO-NBR              TO APONUMO.                 11640000
100500     MOVE ASC-TOTAL-UNITS             TO ATOTUNTO.                11650000
100600     IF ASC-PACK-INNER-QTY = ZEROES                               11660000
100700         MOVE ZEROES                  TO ASC-NBR-INNER-PACKS      11670000
100800     ELSE                                                         11680000
100900         COMPUTE ASC-NBR-INNER-PACKS =                            11690000
101000                     ASC-UNITS-PER-CARTON  /                      11700000
101100                     ASC-PACK-INNER-QTY                           11710000
101200     END-IF.                                                      11720000
101300                                                                  11730000
101400     MOVE ASC-NBR-INNER-PACKS         TO ANOFINPO.                11740006
101500                                                                  11750000
101600     MOVE ASC-KEY-PACK-ID             TO APACKIDO.                11760000
101800     MOVE ASC-PACK-DESC                                           11770000
101900                                      TO APDESCRO.                11780000
101800     MOVE ASC-PACK-SKU                                            11790000
101900                                      TO APCKSKUO.                11800000
102000     MOVE ASC-PACK-UPC-NBR                                        11810000
102100                                      TO APCKUPCO.                11820000
102400     MOVE ASC-PACK-CARTONS                                        11820100
102500                                      TO ANOFCTNO.                11820200
102200     MOVE ASC-PACK-CONVEYABLE                                     11820300
102300                                      TO ACIPINDO.                11820400
P5207 *    IF PO013-PO-PKGNG-CDE = 'M'                                  11821009
P5207      IF ASC-UNITS-PER-CARTON = 0                                  11821111
P5207        MOVE 1                         TO ANOFINPO                 11822006
P5207        MOVE ASC-PACK-INNER-QTY        TO AUPRCTNO                 11870005
P5207        MOVE ASC-PACK-INNER-QTY        TO AUPRINPO                 11890005
P5207      ELSE                                                         11900105
102600       MOVE ASC-UNITS-PER-CARTON                                  11900500
102700                                      TO AUPRCTNO                 11900600
102800       MOVE ASC-PACK-INNER-QTY                                    11900700
102900                                      TO AUPRINPO                 11900800
P5207      END-IF.                                                      11901005
103000                                                                  11910000
103100     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             11920000
103200         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          11930000
103300         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          11940000
103400             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             11950000
103500                 GIVING PV-BLOCK-NUMBER                           11960000
103600                 REMAINDER PV-REMAINDER                           11970000
103700             IF  PV-REMAINDER > ZERO                              11980000
103800                 ADD +1               TO PV-BLOCK-NUMBER          11990000
103900             END-IF                                               12000000
104500*    END-IF.                                                      12010000
104600             MOVE +1                  TO ASC-BLK-SUB              12020000
                   PERFORM 9120-READ-ITEM-QUEUE                         12030000
                   ADD +1                   TO ASC-BLK-SUB              12040000
                                               PV-BLOCK-NUMBER          12050000
                   PERFORM 9120-READ-ITEM-QUEUE                         12060000
           END-IF.                                                      12070000
           MOVE +1 TO ASC-BLK-SUB.                                      12080000
104700     COMPUTE ASC-ITEM-SUB =                                       12090000
104800         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              12100000
104900         + PC-ITEMS-PER-PANEL).                                   12110000
105000                                                                  12120000
105100     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        12130000
105200         ADD +1                       TO ASC-BLK-SUB              12140000
105300         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            12150000
105400     END-IF.                                                      12160000
105500                                                                  12170000
105600     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           12180000
105700         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                12190000
105800     PERFORM 4420-FORMAT-ITEM-LINES                               12200000
105900         VARYING PS-SUB                                           12210000
106000         FROM PC-ITEMS-PER-PANEL BY -1                            12220000
106100         UNTIL PS-SUB < +1.                                       12230000
106200                                                                  12240000
106300     MOVE PV-TOP-ITEM                 TO ASC-ITEM-AT-TOP-OF-PANEL 12250000
106400                                         ASTRTITO.                12260000
106500     MOVE ASC-ITEM-AT-BOT-OF-PANEL    TO AENDITO.                 12270000
106600     MOVE ASC-NBR-ITEMS-READ          TO ATOTITO.                 12280000
           MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO ATOTPKO.                12290000
106700                                                                  12300000
106900     IF ASC-NBR-PACKS-READ = ZEROES                               12310000
107000         MOVE ZEROES                  TO ASTRTPKO                 12320000
107100     ELSE                                                         12330000
107200         MOVE ASC-ITEM-NBR            TO ASTRTPKO                 12340000
107400     END-IF.                                                      12350000
107500                                                                  12360000
107600                                                                  12370000
107700     IF  DP020-MSG-NUMBER-X = SPACE                               12380000
107800         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NBR-ITEMS-READ        12390000
107900*            --- MORE ITEMS TO DISPLAY ----                       12400000
108000             MOVE PC-TSYMSG-00279     TO DP020-MSG-NUMBER         12410000
108100             SET DP020-MSG-INFORMATIONAL TO TRUE                  12420000
108200         ELSE                                                     12430000
108300             MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER         12440000
108400             SET DP020-MSG-INFORMATIONAL TO TRUE                  12450000
108500         END-IF                                                   12460000
108600     END-IF.                                                      12470000
108700                                                                  12480000
108800                                                                  12490000
108900 4420-FORMAT-ITEM-LINES.                                          12500000
109000*----------------------------------------------------------------*12510000
109100*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *12520000
109200*----------------------------------------------------------------*12530000
109300                                                                  12540000
109400     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NBR-ITEMS-READ            12550000
109500         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                12560000
W24803         MOVE SPACES                  TO MR-DEPT (PS-SUB)         12570000
W24803                                         MR-MAJ-CL (PS-SUB)       12580000
W24803                                         MR-SUB-CLASS (PS-SUB)    12590000
W24803                                         MR-SKU (PS-SUB)          12600000
109900                                         MR-STYLE (PS-SUB)        12610000
110000                                         MR-DESC (PS-SUB)         12620000
110100                                         MR-COLOR (PS-SUB)        12630000
110200                                         MR-SIZE (PS-SUB)         12640000
110300                                         MR-CRTN-UNITS-X (PS-SUB) 12650000
110400                                         MR-QTY-X (PS-SUB)        12660000
110500     ELSE                                                         12670000
110600         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           12680000
110700             MOVE ASC-DEP-NBR (ASC-BLK-SUB, ASC-ITEM-SUB)         12690000
W24803                                      TO MR-DEPT (PS-SUB)         12700000
W24803             MOVE ASC-MAJ-CL-NBR (ASC-BLK-SUB, ASC-ITEM-SUB)      12710000
W24803                                      TO MR-MAJ-CL (PS-SUB)       12720000
110800             MOVE ASC-CL-NBR (ASC-BLK-SUB, ASC-ITEM-SUB)          12730000
W24803                                      TO MR-SUB-CLASS (PS-SUB)    12740000
W24803             MOVE ASC-SKU-NBR (ASC-BLK-SUB, ASC-ITEM-SUB)         12750000
W24803                                      TO MR-SKU (PS-SUB)          12760000
111200             MOVE ASC-VEND-STYL-NAME (ASC-BLK-SUB, ASC-ITEM-SUB)  12770000
111300                                      TO MR-STYLE (PS-SUB)        12780000
111400             MOVE ASC-SKU-DESC (ASC-BLK-SUB, ASC-ITEM-SUB)        12790000
111500                                      TO MR-DESC (PS-SUB)         12800000
111600             MOVE ASC-COLOR-DESC (ASC-BLK-SUB, ASC-ITEM-SUB)      12810000
111700                                      TO MR-COLOR (PS-SUB)        12820000
111800             MOVE ASC-SIZE-DESC (ASC-BLK-SUB, ASC-ITEM-SUB)       12830000
111900                                      TO MR-SIZE (PS-SUB)         12840000
112000             MOVE ASC-PREPK-RATO-QTY (ASC-BLK-SUB, ASC-ITEM-SUB)  12850000
112100                                      TO MR-CRTN-UNITS (PS-SUB)   12860000
112200             MOVE ASC-UNT-QTY (ASC-BLK-SUB, ASC-ITEM-SUB)         12870000
112300                                      TO MR-QTY (PS-SUB)          12880000
112400         END-IF                                                   12890000
112500     END-IF.                                                      12900000
112600     SUBTRACT +1 FROM ASC-ITEM-SUB.                               12910000
112700     IF  ASC-ITEM-SUB < + 1                                       12920000
112800         MOVE PC-ITEMS-PER-PANEL      TO ASC-ITEM-SUB             12930000
112900         MOVE +1                      TO ASC-BLK-SUB              12940000
113000     END-IF.                                                      12950000
113100                                                                  12960000
113200                                                                  12970000
113300 5000-CREATE-PACK-QUEUE.                                          12980000
113400*----------------------------------------------------------------*12990000
113500*    WRITE A NEW PACK BLOCK FROM THE ARRAY TO TEMPORARY STORAGE. *13000000
113600*----------------------------------------------------------------*13010000
113700                                                                  13020000
113800*    PERFORM 8100-DELETE-SEL-QUEUE.                               13030000
113900     SET ASC-ITEMS-LEFT-ON-DB         TO TRUE.                    13040000
114000                                                                  13050000
114100     PERFORM 5100-OPEN-POPRPK-CSR.                                13060000
114200     PERFORM 5200-PROCESS-POPRPK.                                 13070000
114300     PERFORM 5300-CLOSE-POPRPK-CSR.                               13080000
114400                                                                  13090000
114500                                                                  13100000
114600 5100-OPEN-POPRPK-CSR.                                            13110000
114700*----------------------------------------------------------------*13120000
114800* OPEN THE CURSOR.                                               *13130000
114900*----------------------------------------------------------------*13140000
115000                                                                  13150000
115100     EXEC SQL                                                     13160000
115200          OPEN POPRPK-CSR                                         13170000
115300     END-EXEC.                                                    13180000
115400                                                                  13190000
115500     EVALUATE TRUE                                                13200000
115600         WHEN SQLCODE = ZERO                                      13210000
115700              CONTINUE                                            13220000
115800         WHEN SQLWARN0 NOT EQUAL SPACE                            13230000
115900         WHEN SQLCODE NOT EQUAL ZERO                              13240000
116000              MOVE '5100-OPEN-POPRPK-CSR'                         13250000
116100                           TO  DP013-PARAGRAPH                    13260000
116200              MOVE 'OPEN PREPACK CURSOR'                          13270000
116300                           TO  DP013-MESSAGE-TEXT (1)             13280000
116400              MOVE SQLCA   TO  DP013-SQLCA                        13290000
116500              SET DP013-DB2-ABEND                                 13300000
116600                           TO  TRUE                               13310000
116700              PERFORM DP013-0000-PROCESS-ABEND                    13320000
116800     END-EVALUATE.                                                13330000
116900                                                                  13340000
117000 5200-PROCESS-POPRPK.                                             13350000
117100******************************************************            13360000
117200*  PROCESS ALL POPRPK DATA HERE                                   13370000
117300******************************************************            13380000
117400                                                                  13390000
117500     PERFORM                                                      13400000
117600       VARYING PV-READ-COUNT                                      13410000
117700       FROM    1 BY 1                                             13420000
117800       UNTIL   ((PV-READ-COUNT > PC-MAX-ITEMS)                    13430000
117900         OR    (ASC-ITEMS-LEFT-ON-DB-NO))                         13440000
118000                                                                  13450000
118100         PERFORM 5250-FETCH-POPRPK                                13460000
118200                                                                  13470000
118300         IF ASC-ITEMS-LEFT-ON-DB                                  13480000
118400             ADD +1                   TO ASC-PACK-SUB             13490000
119300             IF PV-PO-PREPK-ID = ZEROES                           13500000
119400               AND POPRPK-PO-PREPK-ID > ZEROES                    13510000
119500* SAVE THE FIRST PREPACK DATA FOUND.                              13520000
119600                 MOVE POPRPK-PO-PREPK-ID                          13530000
119700                                      TO PV-PO-PREPK-ID           13540000
119800             END-IF                                               13550000
119900             ADD +1                   TO  ASC-NBR-PACKS-READ      13560000
120000* SAVE ALL PREPACK DATA IN PACK QUEUE                             13570000
120100             MOVE ASC-NBR-PACKS-READ  TO ASC-PACK-LIST-NUMBER     13580000
120200                                                                  13590000
120300             MOVE POPRPK-PO-PREPK-ID  TO ASC-PACK-PREPK-ID        13600000
120400                                                                  13610000
120500             MOVE POPRPK-PK-SKU-NBR                               13620000
120600                                      TO ASC-PACK-SKU             13630000
120700                                                                  13640000
120800             MOVE POPRPK-PREPK-DESC   TO ASC-PACK-DESC            13650000
120700                                                                  13660000
120500             MOVE POPRPK-PREPK-UPC-NBR                            13670000
120600                                      TO ASC-PACK-UPC-NBR         13680000
120900                                                                  13690000
121000             MOVE POPRPK-INPK-CNVYB-IND TO ASC-PACK-CONVEYABLE    13700000
121100                                                                  13710000
121200             MOVE POPRPK-OTPK-ORD-QTY TO ASC-PACK-CARTONS         13720000
121300                                                                  13730000
121400             MOVE POPRPK-OTPK-UNT-QTY TO ASC-UNITS-PER-CARTON     13740000
121500                                                                  13750000
121600             MOVE POPRPK-INPK-UNT-QTY TO ASC-PACK-INNER-QTY       13760000
121700                                                                  13770000
121800         END-IF                                                   13780000
121900     END-PERFORM.                                                 13790000
123900                                                                  13800000
124000 5250-FETCH-POPRPK.                                               13810000
124100*----------------------------------------------------------------*13820000
124200* FETCH PREPACK INFORMATION                                      *13830000
124300*----------------------------------------------------------------*13840000
124400                                                                  13850000
124500     EXEC SQL                                                     13860000
124600         FETCH POPRPK-CSR                                         13870000
124700         INTO :POPRPK-PO-NBR                                      13880000
124800             ,:POPRPK-PO-PREPK-ID                                 13890000
124900             ,:POPRPK-PREPK-DESC                                  13900000
125000             ,:POPRPK-PREPK-UPC-NBR                               13910000
125100             ,:POPRPK-INPK-UNT-QTY                                13920000
125200             ,:POPRPK-INPK-CNVYB-IND                              13930000
125300             ,:POPRPK-OTPK-UNT-QTY                                13940000
125400             ,:POPRPK-OTPK-ORD-QTY                                13950000
                   ,:POPRPK-PK-SKU-NBR                                  13960000
125500     END-EXEC.                                                    13970000
125600                                                                  13980000
125700     EVALUATE TRUE                                                13990000
125800       WHEN SQLCODE = +0                                          14000000
125900           CONTINUE                                               14010000
126000       WHEN SQLCODE = +100                                        14020000
126100           SET ASC-ITEMS-LEFT-ON-DB-NO TO TRUE                    14030000
126200                                                                  14040000
126300       WHEN SQLWARN0 NOT = SPACE                                  14050000
126400       WHEN SQLCODE < +0                                          14060000
126500       WHEN SQLCODE > +0                                          14070000
126600             MOVE '5250-FETCH-POPRPK'                             14080000
126700                                      TO DP013-PARAGRAPH          14090000
126800             MOVE 'FETCH CURSOR'      TO DP013-MESSAGE-TEXT(1)    14100000
126900             MOVE SQLCA               TO DP013-SQLCA              14110000
127000             MOVE 'TPOPRPK'           TO DP013-DB2-TABLE-NAME (1) 14120000
127100             SET DP013-DB2-ABEND                                  14130000
127200                 DP013-XCTL-DISPLAY-RESTART TO TRUE               14140000
127300             PERFORM DP013-0000-PROCESS-ABEND                     14150000
127400     END-EVALUATE.                                                14160000
127500                                                                  14170000
127600                                                                  14180000
127700 5300-CLOSE-POPRPK-CSR.                                           14190000
127800*----------------------------------------------------------------*14200000
127900* CLOSE THE CURSOR.                                              *14210000
128000*----------------------------------------------------------------*14220000
128100                                                                  14230000
128200     EXEC SQL                                                     14240000
128300         CLOSE POPRPK-CSR                                         14250000
128400     END-EXEC.                                                    14260000
128500                                                                  14270000
128600     EVALUATE TRUE                                                14280000
128700         WHEN SQLCODE = ZERO                                      14290000
128800           CONTINUE                                               14300000
128900         WHEN SQLWARN0 NOT EQUAL SPACE                            14310000
129000         WHEN SQLCODE NOT EQUAL ZERO                              14320000
129100           MOVE '5300-CLOSE-POPRPK-CSR'                           14330000
129200                                      TO  DP013-PARAGRAPH         14340000
129300           MOVE 'CLOSE PREPACK CURSOR'                            14350000
129400                                      TO  DP013-MESSAGE-TEXT (1)  14360000
129500           MOVE SQLCA                 TO  DP013-SQLCA             14370000
129600           SET DP013-DB2-ABEND        TO  TRUE                    14380000
129700           PERFORM DP013-0000-PROCESS-ABEND                       14390000
129800     END-EVALUATE.                                                14400000
130100                                                                  14410000
       7200-WRITE-ITEM-QUEUE.                                           14420000
      *----------------------------------------------------------------*14430000
      *    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *14440000
      *----------------------------------------------------------------*14450000
                                                                        14460000
           COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                           14470000
             ASC-HIGH-BLOCK-WRITTEN + 1.                                14480000
                                                                        14490000
           EXEC CICS                                                    14500000
                 WRITEQ TS                                              14510000
                    QUEUE (ASC-LIST-QUEUE-NAME)                         14520000
                     FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))             14530000
                    ITEM  (PV-HIGHEST-BLOCK-WRITTEN)                    14540000
                     RESP  (PV-CICS-RESP)                               14550000
           END-EXEC.                                                    14560000
                                                                        14570000
           IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      14580000
                SET DP013-CICS-ABEND                                    14590000
                    DP013-NO-ROLLBACK        TO TRUE                    14600000
                 MOVE '7200-WRITE-ITEM-QUEUE' TO DP013-PARAGRAPH        14610000
                MOVE 'ATTEMPTING TO WRITE IEM QUEUE  '                  14620000
                                             TO DP013-MESSAGE-TEXT(1)   14630000
                PERFORM DP013-0000-PROCESS-ABEND                        14640000
            END-IF.                                                     14650000
            ADD +1                           TO ASC-HIGH-BLOCK-WRITTEN. 14660000
                                                                        14670000
135800 8100-DELETE-SEL-QUEUE.                                           14680000
135900*----------------------------------------------------------------*14690000
136000*  DELETE THE PACK TEMP STORAGE QUEUE.                           *14700000
136100*----------------------------------------------------------------*14710000
136200                                                                  14720000
136300     EXEC CICS                                                    14730000
136400         DELETEQ TS                                               14740000
136500             QUEUE (ASC-SEL-QUEUE-NAME)                           14750000
136600             RESP  (PV-CICS-RESP)                                 14760000
136700     END-EXEC.                                                    14770000
136800                                                                  14780000
136900     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       14790000
137000        (PV-CICS-RESP = DFHRESP(QIDERR))                          14800000
137100         CONTINUE                                                 14810000
137200     ELSE                                                         14820000
137300         SET DP013-CICS-ABEND         TO TRUE                     14830000
137400         SET DP013-NO-ROLLBACK        TO TRUE                     14840000
137500                                                                  14850000
137600         MOVE '8100-DELETE-SEL-QUEUE'                             14860000
137700                                      TO DP013-PARAGRAPH          14870000
137800         MOVE 'ERROR TRYING TO DELETE PACK ID QUEUE'              14880000
137900                                      TO DP013-MESSAGE-TEXT (1)   14890000
138000         PERFORM DP013-0000-PROCESS-ABEND                         14900000
138100     END-IF.                                                      14910000
138200                                                                  14920000
138300                                                                  14930000
138400 8200-DELETE-ITEM-QUEUE.                                          14940000
138500*----------------------------------------------------------------*14950000
138600*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *14960000
138700*----------------------------------------------------------------*14970000
138800                                                                  14980000
138900     EXEC CICS                                                    14990000
139000         DELETEQ TS                                               15000000
139100             QUEUE (ASC-LIST-QUEUE-NAME)                          15010000
139200             RESP  (PV-CICS-RESP)                                 15020000
139300     END-EXEC.                                                    15030000
139400                                                                  15040000
139500     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       15050000
139600        (PV-CICS-RESP = DFHRESP(QIDERR))                          15060000
139700         CONTINUE                                                 15070000
139800     ELSE                                                         15080000
139900         SET DP013-CICS-ABEND         TO TRUE                     15090000
140000         SET DP013-NO-ROLLBACK        TO TRUE                     15100000
140100                                                                  15110000
140200         MOVE '8200-DELETE-ITEM-QUEUE'                            15120000
140300                                      TO DP013-PARAGRAPH          15130000
140400         MOVE 'ERROR TRYING TO DELETE ITEM QUEUE'                 15140000
140500                                      TO DP013-MESSAGE-TEXT (1)   15150000
140600         PERFORM DP013-0000-PROCESS-ABEND                         15160000
140700     END-IF.                                                      15170000
140800                                                                  15180000
140900     MOVE +0                          TO ASC-HIGH-BLOCK-WRITTEN.  15190000
141000                                                                  15200000
141100                                                                  15210000
141200 9100-READ-SEL-QUEUE.                                             15220000
141300*----------------------------------------------------------------*15230000
141400*    READ A BLOCK FROM PACK TEMP STORAGE QUEUE INTO THE ARRAY.   *15240000
141500*----------------------------------------------------------------*15250000
141600                                                                  15260000
141700     EXEC CICS                                                    15270000
141800         READQ TS                                                 15280000
141900             QUEUE (ASC-SEL-QUEUE-NAME)                           15290000
142000             INTO  (PO012-PO-SELECT-RECORD)                       15300000
142100             ITEM  (ASC-SEL-ITEM)                                 15310000
142200             RESP  (PV-CICS-RESP)                                 15320000
142300     END-EXEC.                                                    15330000
142400                                                                  15340000
142500     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          15350000
142700         CONTINUE                                                 15360000
142800     ELSE                                                         15370000
               IF PV-CICS-RESP = DFHRESP(QIDERR)                        15380000
                  MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER              15390000
                  SET DP020-MSG-WARNING TO TRUE                         15400000
                  SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                 15410000
               ELSE                                                     15420000
142900            SET DP013-LOGIC-ABEND                                 15430000
143000                DP013-NO-ROLLBACK        TO TRUE                  15440000
143100            MOVE '9100-READ-SEL-QUEUE'   TO DP013-PARAGRAPH       15450000
143200         MOVE 'ERROR TRYING TO READ FROM TS QUEUE'                15460000
143300                                      TO DP013-MESSAGE-TEXT(1)    15470000
143400         PERFORM DP013-0000-PROCESS-ABEND                         15480000
143500     END-IF.                                                      15490000
144000                                                                  15500000
 44100 9120-READ-ITEM-QUEUE.                                            15510000
      *----------------------------------------------------------------*15520000
      *    READ A BLOCK FROM ITEM TEMP STORAGE QUEUE INTO THE ARRAY.   *15530000
      *----------------------------------------------------------------*15540000
                                                                        15550000
           EXEC CICS                                                    15560000
             READQ TS                                                   15570000
                   QUEUE (ASC-LIST-QUEUE-NAME)                          15580000
                  INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))                15590000
                   ITEM  (PV-BLOCK-NUMBER)                              15600000
                  RESP  (PV-CICS-RESP)                                  15610000
           END-EXEC.                                                    15620000
                                                                        15630000
           IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       15640000
           OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                       15650000
               CONTINUE                                                 15660000
144200     ELSE                                                         15670000
              SET DP013-CICS-ABEND                                      15680000
                  DP013-NO-ROLLBACK        TO TRUE                      15690000
              MOVE '9120-READ-ITEM-QUEUE'  TO DP013-PARAGRAPH           15700000
              MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'       15710000
                                           TO DP013-MESSAGE-TEXT(1)     15720000
              PERFORM DP013-0000-PROCESS-ABEND                          15730000
           END-IF.                                                      15740000
                                                                        15750000
           IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         15760000
               INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               15770000
           END-IF.                                                      15780000
                                                                        15790000
       9200-REWRITE-LIST-QUEUE.                                         15800000
144300*----------------------------------------------------------------*15810000
144400*    READ A BLOCK FROM ITEM TEMP STORAGE QUEUE INTO THE ARRAY.   *15820000
144500*----------------------------------------------------------------*15830000
144600                                                                  15840000
144700     EXEC CICS                                                    15850000
144800         WRITEQ TS                                                15860000
144900             QUEUE (ASC-SEL-QUEUE-NAME)                           15870000
145000             FROM  (PO012-PO-SELECT-RECORD)                       15880000
145100             ITEM  (ASC-SEL-ITEM)                                 15890000
145200             RESP  (PV-CICS-RESP)                                 15900000
                   REWRITE                                              15910000
145300     END-EXEC.                                                    15920000
145400                                                                  15930000
145500     IF PV-CICS-RESP NOT = DFHRESP(NORMAL)                        15940000
               SET DP013-CICS-ABEND                                     15950000
                   DP013-NO-ROLLBACK        TO TRUE                     15960000
               MOVE '9200-REWRITE-LIST-QUEUE' TO DP013-PARAGRAPH        15970000
               MOVE 'ERROR TRYING TO REWRITE LIST SELECTIONS QUEUE'     15980000
                                              TO DP013-MESSAGE-TEXT(1)  15990000
               PERFORM DP013-0000-PROCESS-ABEND                         16000000
146500     END-IF.                                                      16010000
146600                                                                  16020000
147100                                                                  16030000
147200*----------------------------------------------------------------*16040000
147300*    ABEND PROCESSOR MODULE                                      *16050000
147400*----------------------------------------------------------------*16060000
147500                                                                  16070000
147600     COPY DPPD013.                                                16080000
