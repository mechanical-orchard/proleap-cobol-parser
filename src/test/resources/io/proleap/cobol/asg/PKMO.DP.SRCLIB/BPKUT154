000100******************************************************************00010099
000200 IDENTIFICATION DIVISION.                                         00020017
000300******************************************************************00030017
000400*                                                                 00040017
000500 PROGRAM-ID.     BPKUT154.                                        00050099
000600 AUTHOR.         COGNIZANT.                                       00060017
000700 INSTALLATION.   KOHLS DEPARTMENT STORES.                         00070017
000800 DATE-WRITTEN.   05/03/2010.                                      00080017
000900 DATE-COMPILED.                                                   00090017
001000                                                                  00100017
001100******************************************************************00110017
001200*  THIS PROGRAM FORMATS THE FOLLOWING FILES CREATED FROM THE     *00120017
001300*  SEASONAL EXTRACT CONSOLIDATED JOB BPK154                      *00130099
001400*                                                                *00140085
001500*            1.PKB_ACTUAL_SALES     FILE                         *00150017
001600*            2.PKB_ACTUAL_RECEIPTS  FILE                         *00160017
001700*            3.PKB_ACTUAL_SALES_LY  FILE                         *00170017
001800*            4.PKB_ACTUAL_OTHINV_DC FILE                         *00180099
001900*            5.PKB_ACTUAL_OTHINV_CT FILE                         *00190099
002000*            6.PKB_ACTUAL_OTHINV_DT FILE                         *00200099
002100*            7.PKB_ACTUAL_OTHINV_CC FILE                         *00210099
002200*            8.PKB_ACTUAL_OTHINV    FILE                         *00220099
002300*            9.PKB_ACTUAL_MKDNS     FILE                         *00230099
002400*           10.PKB_ACTUAL_INVBAL_BOPFILE                         *00240099
002500*           11.PKB_ACTUAL_INVBAL_EOPFILE                         *00250099
002600*                                                                *00260017
002700* -THIS ALSO CREATES THE TRANSACTION ID AND THE SEQUENCE NUMBER  *00270017
002800*  TO BE WRITTEN INTO THE FOUR OUTPUT FILES.                     *00280017
002900*                                                                *00290017
003000* -FOR EACH RUN, TRANSACTION ID WILL BE INCREMENTED AND ITS      *00300017
003100*  THE SAME FOR A SINGLE RUN.                                    *00310017
003200*                                                                *00320017
003300* -FOR EACH FILE, THE SEQUENCE NO WILL BE INCREMENTED FROM 1     *00330017
003400*  TO N.                                                         *00340017
003500******************************************************************00350017
003600*    P R O G R A M   M O D I F I C A T I O N   H I S T O  R Y    *00360017
003700*    --------------------------------------------------------    *00370017
003800*   05-03-2010  COGNIZANT       INITIAL VERSION                  *00380017
11752A*   03-10-2017  J SELWITSCHKA   CHANGES FOR EP UPGRADE           *00381099
11752A*   06-23-2017  J SELWITSCHKA   NEW VERSION BPKUT154 IS A COPY    00382099
11752A*                               OF BPKUT153 WITH EP UPGRADE       00383099
11752A*                               CHANGES. CREATED BECAUSE EP       00384099
11752A*                               UPGRADE VERSION WILL BE RUNNING   00384199
11752A*                               IN PARALLEL WITH OLD VERSION.     00385099
11752A*   07-17-2017  J SELWITSCHKA   CHANGE ORDER OF MARKDOWNS.        00385199
C12018*   11-14-2017  J SELWITSCHKA   IF ALL METRICS FOR A RECORD ARE   00385299
C12018*                               ZERO, WRITE THE RECORD WITH ALL   00385399
C12018*                               NULLS.                            00385499
11752A*                                                                 00386099
003900******************************************************************00390017
004000 ENVIRONMENT DIVISION.                                            00400017
004100******************************************************************00410017
004200                                                                  00420017
004300******************************************************************00430017
004400 CONFIGURATION SECTION.                                           00440017
004500******************************************************************00450017
004600                                                                  00460017
004700 SOURCE-COMPUTER.        IBM-3090.                                00470017
004800 OBJECT-COMPUTER.        IBM-3090.                                00480017
004900                                                                  00490017
005000******************************************************************00500017
005100 INPUT-OUTPUT SECTION.                                            00510017
005200******************************************************************00520017
005300                                                                  00530017
005400 FILE-CONTROL.                                                    00540017
005500                                                                  00550017
005600     SELECT MLT-SALES-IN-FILE                                     00560017
005700         ASSIGN TO INP01.                                         00570017
005800                                                                  00580017
005900     SELECT MLT-SALES-LY-IN-FILE                                  00590017
006000         ASSIGN TO INP02.                                         00600017
006100                                                                  00610017
006200     SELECT MLT-RECEIPT-IN-FILE                                   00620017
006300         ASSIGN TO INP03.                                         00630017
006400                                                                  00640017
006500     SELECT MLT-INVBAL-BOP-IN-FILE                                00650099
006600         ASSIGN TO INP04.                                         00660017
006700                                                                  00670099
006800     SELECT MLT-INVBAL-EOP-IN-FILE                                00680099
006900         ASSIGN TO INP05.                                         00690099
007000                                                                  00700049
007100     SELECT MLT-MKDNS-BVIN-FILE                                   00710049
007200         ASSIGN TO INP06.                                         00720099
007300                                                                  00730050
007400     SELECT MLT-OTHINV-BVIN-FILE                                  00740049
007500         ASSIGN TO INP07.                                         00750099
007600                                                                  00760051
007700     SELECT MLT-GDCHN-IN-FILE                                     00770067
007800         ASSIGN TO INP08.                                         00780099
007900                                                                  00790065
008000     SELECT MLT-GDTOT-IN-FILE                                     00800067
008100         ASSIGN TO INP09.                                         00810099
008200                                                                  00820065
008300     SELECT MLT-GCTOT-IN-FILE                                     00830067
008400         ASSIGN TO INP10.                                         00840099
008500                                                                  00850065
008600     SELECT MLT-GCCHN-IN-FILE                                     00860099
008700         ASSIGN TO INP11.                                         00870099
008800                                                                  00880099
008900     SELECT MLT-ODCHN-IN-FILE                                     00890067
009000         ASSIGN TO INP12.                                         00900099
009100                                                                  00910065
009200     SELECT MLT-ODTOT-IN-FILE                                     00920067
009300         ASSIGN TO INP13.                                         00930099
009400                                                                  00940065
009500     SELECT MLT-OCTOT-IN-FILE                                     00950067
009600         ASSIGN TO INP14.                                         00960099
009700                                                                  00970065
009800     SELECT MLT-OCCHN-IN-FILE                                     00980099
009900         ASSIGN TO INP15.                                         00990099
010000                                                                  01000099
010100     SELECT TRANS-IN-FILE                                         01010099
010200         ASSIGN TO INP16.                                         01020099
010300                                                                  01030099
010400     SELECT MLT-SALES-OUT-FILE                                    01040065
010500         ASSIGN TO OUT01.                                         01050017
010600                                                                  01060017
010700     SELECT MLT-SALES-LY-OUT-FILE                                 01070017
010800         ASSIGN TO OUT02.                                         01080017
010900                                                                  01090017
011000     SELECT MLT-RECEIPT-OUT-FILE                                  01100017
011100         ASSIGN TO OUT03.                                         01110017
011200                                                                  01120017
011300     SELECT MLT-MKDNS-BVOUT-FILE                                  01130053
011400         ASSIGN TO OUT04.                                         01140083
011500                                                                  01150049
011600     SELECT MLT-OTHINV-BVOUT-FILE                                 01160053
011700         ASSIGN TO OUT05.                                         01170083
011800                                                                  01180065
011900     SELECT MLT-GDCHN-OUT-FILE                                    01190067
012000         ASSIGN TO OUT06.                                         01200083
012100                                                                  01210065
012200     SELECT MLT-GDTOT-OUT-FILE                                    01220067
012300         ASSIGN TO OUT07.                                         01230083
012400                                                                  01240065
012500     SELECT MLT-GCTOT-OUT-FILE                                    01250067
012600         ASSIGN TO OUT08.                                         01260099
012700                                                                  01270099
012800     SELECT MLT-GCCHN-OUT-FILE                                    01280099
012900         ASSIGN TO OUT09.                                         01290099
013000                                                                  01300099
013100     SELECT MLT-INVBAL-BOP-OUT-FILE                               01310099
013200         ASSIGN TO OUT10.                                         01320099
013300                                                                  01330099
013400     SELECT MLT-INVBAL-EOP-OUT-FILE                               01340099
013500         ASSIGN TO OUT11.                                         01350099
013600                                                                  01360099
013700     SELECT TRANS-OUT-FILE                                        01370017
013800         ASSIGN TO OUT12.                                         01380099
013900                                                                  01390017
014000******************************************************************01400017
014100 DATA DIVISION.                                                   01410017
014200******************************************************************01420017
014300                                                                  01430017
014400******************************************************************01440017
014500 FILE SECTION.                                                    01450017
014600******************************************************************01460017
014700                                                                  01470050
014800 FD  MLT-SALES-IN-FILE                                            01480050
014900     RECORDING MODE IS F                                          01490050
015000     LABEL RECORDS ARE STANDARD                                   01500050
015100     BLOCK CONTAINS 0 RECORDS.                                    01510050
015200                                                                  01520050
015300 01  MLT-SALES-IN-RECORD                    PIC X(700).           01530050
015400                                                                  01540017
015500 FD  MLT-SALES-LY-IN-FILE                                         01550017
015600     RECORDING MODE IS F                                          01560017
015700     LABEL RECORDS ARE STANDARD                                   01570017
015800     BLOCK CONTAINS 0 RECORDS.                                    01580017
015900                                                                  01590017
016000 01  MLT-SALES-LY-IN-RECORD                 PIC X(700).           01600017
016100                                                                  01610017
016200 FD  MLT-RECEIPT-IN-FILE                                          01620017
016300     RECORDING MODE IS F                                          01630017
016400     LABEL RECORDS ARE STANDARD                                   01640017
016500     BLOCK CONTAINS 0 RECORDS.                                    01650017
016600                                                                  01660017
016700 01  MLT-RECEIPT-IN-RECORD                  PIC X(700).           01670017
016800                                                                  01680050
016900 FD  MLT-INVBAL-BOP-IN-FILE                                       01690099
017000     RECORDING MODE IS F                                          01700050
017100     LABEL RECORDS ARE STANDARD                                   01710050
017200     BLOCK CONTAINS 0 RECORDS.                                    01720050
017300                                                                  01730050
017400 01  MLT-INVBAL-BOP-IN-RECORD               PIC X(700).           01740099
017500                                                                  01750017
017600 FD  MLT-INVBAL-EOP-IN-FILE                                       01760099
017700     RECORDING MODE IS F                                          01770099
017800     LABEL RECORDS ARE STANDARD                                   01780099
017900     BLOCK CONTAINS 0 RECORDS.                                    01790099
018000                                                                  01800099
018100 01  MLT-INVBAL-EOP-IN-RECORD               PIC X(700).           01810099
018200                                                                  01820099
018300 FD  MLT-MKDNS-BVIN-FILE                                          01830050
018400     RECORDING MODE IS F                                          01840050
018500     LABEL RECORDS ARE STANDARD                                   01850050
018600     BLOCK CONTAINS 0 RECORDS.                                    01860050
018700                                                                  01870050
018800 01  MLT-MKDNS-BVIN-RECORD                  PIC X(350).           01880050
018900                                                                  01890050
019000 FD  MLT-OTHINV-BVIN-FILE                                         01900050
019100     RECORDING MODE IS F                                          01910050
019200     LABEL RECORDS ARE STANDARD                                   01920050
019300     BLOCK CONTAINS 0 RECORDS.                                    01930050
019400                                                                  01940050
019500 01  MLT-OTHINV-BVIN-RECORD                 PIC X(350).           01950050
019600                                                                  01960051
019700 FD  MLT-GDCHN-IN-FILE                                            01970068
019800     RECORDING MODE IS F                                          01980065
019900     LABEL RECORDS ARE STANDARD                                   01990065
020000     BLOCK CONTAINS 0 RECORDS.                                    02000065
020100                                                                  02010065
020200 01  MLT-GDCHN-IN-RECORD                PIC X(700).               02020068
020300                                                                  02030065
020400 FD  MLT-GDTOT-IN-FILE                                            02040068
020500     RECORDING MODE IS F                                          02050065
020600     LABEL RECORDS ARE STANDARD                                   02060065
020700     BLOCK CONTAINS 0 RECORDS.                                    02070065
020800                                                                  02080065
020900 01  MLT-GDTOT-IN-RECORD                PIC X(700).               02090068
021000                                                                  02100065
021100 FD  MLT-GCTOT-IN-FILE                                            02110068
021200     RECORDING MODE IS F                                          02120065
021300     LABEL RECORDS ARE STANDARD                                   02130065
021400     BLOCK CONTAINS 0 RECORDS.                                    02140065
021500                                                                  02150065
021600 01  MLT-GCTOT-IN-RECORD                PIC X(700).               02160099
021700                                                                  02170085
021800 FD  MLT-GCCHN-IN-FILE                                            02180099
021900     RECORDING MODE IS F                                          02190099
022000     LABEL RECORDS ARE STANDARD                                   02200099
022100     BLOCK CONTAINS 0 RECORDS.                                    02210099
022200                                                                  02220099
022300 01  MLT-GCCHN-IN-RECORD                PIC X(700).               02230099
022400                                                                  02240099
022500 FD  MLT-ODCHN-IN-FILE                                            02250085
022600     RECORDING MODE IS F                                          02260085
022700     LABEL RECORDS ARE STANDARD                                   02270085
022800     BLOCK CONTAINS 0 RECORDS.                                    02280085
022900                                                                  02290085
023000 01  MLT-ODCHN-IN-RECORD                PIC X(700).               02300085
023100                                                                  02310085
023200 FD  MLT-ODTOT-IN-FILE                                            02320085
023300     RECORDING MODE IS F                                          02330085
023400     LABEL RECORDS ARE STANDARD                                   02340085
023500     BLOCK CONTAINS 0 RECORDS.                                    02350085
023600                                                                  02360085
023700 01  MLT-ODTOT-IN-RECORD                PIC X(700).               02370085
023800                                                                  02380085
023900 FD  MLT-OCTOT-IN-FILE                                            02390085
024000     RECORDING MODE IS F                                          02400085
024100     LABEL RECORDS ARE STANDARD                                   02410085
024200     BLOCK CONTAINS 0 RECORDS.                                    02420085
024300                                                                  02430085
024400 01  MLT-OCTOT-IN-RECORD                PIC X(700).               02440085
024500                                                                  02450099
024600 FD  MLT-OCCHN-IN-FILE                                            02460099
024700     RECORDING MODE IS F                                          02470099
024800     LABEL RECORDS ARE STANDARD                                   02480099
024900     BLOCK CONTAINS 0 RECORDS.                                    02490099
025000                                                                  02500099
025100 01  MLT-OCCHN-IN-RECORD                PIC X(700).               02510099
025200                                                                  02520099
025300 FD  MLT-INVBAL-BOP-OUT-FILE                                      02530099
025400     RECORDING MODE IS F                                          02540099
025500     LABEL RECORDS ARE STANDARD                                   02550099
025600     BLOCK CONTAINS 0 RECORDS.                                    02560099
025700                                                                  02570099
025800 01  MLT-INVBAL-BOP-OUT-RECORD           PIC X(800).              02580099
025900                                                                  02590085
026000 FD  MLT-INVBAL-EOP-OUT-FILE                                      02600099
026100     RECORDING MODE IS F                                          02610099
026200     LABEL RECORDS ARE STANDARD                                   02620099
026300     BLOCK CONTAINS 0 RECORDS.                                    02630099
026400                                                                  02640099
026500 01  MLT-INVBAL-EOP-OUT-RECORD           PIC X(800).              02650099
026600                                                                  02660065
026700 FD  TRANS-IN-FILE                                                02670065
026800     RECORDING MODE IS F                                          02680017
026900     LABEL RECORDS ARE STANDARD                                   02690017
027000     BLOCK CONTAINS 0 RECORDS.                                    02700017
027100                                                                  02710017
027200 01  TRANS-IN-RECORD                        PIC X(80).            02720017
027300                                                                  02730017
027400 FD  MLT-SALES-OUT-FILE                                           02740050
027500     RECORDING MODE IS F                                          02750050
027600     LABEL RECORDS ARE STANDARD                                   02760050
027700     BLOCK CONTAINS 0 RECORDS.                                    02770050
027800                                                                  02780050
027900 01  MLT-SALES-OUT-RECORD                   PIC X(800).           02790099
028000                                                                  02800050
028100 FD  MLT-SALES-LY-OUT-FILE                                        02810017
028200     RECORDING MODE IS F                                          02820017
028300     LABEL RECORDS ARE STANDARD                                   02830017
028400     BLOCK CONTAINS 0 RECORDS.                                    02840017
028500                                                                  02850017
028600 01  MLT-SALES-LY-OUT-RECORD                PIC X(800).           02860099
028700                                                                  02870017
028800 FD  MLT-RECEIPT-OUT-FILE                                         02880017
028900     RECORDING MODE IS F                                          02890017
029000     LABEL RECORDS ARE STANDARD                                   02900017
029100     BLOCK CONTAINS 0 RECORDS.                                    02910017
029200                                                                  02920017
029300 01  MLT-RECEIPT-OUT-RECORD                 PIC X(800).           02930099
029400                                                                  02940050
029500 FD  MLT-MKDNS-BVOUT-FILE                                         02950050
029600     RECORDING MODE IS F                                          02960050
029700     LABEL RECORDS ARE STANDARD                                   02970050
029800     BLOCK CONTAINS 0 RECORDS.                                    02980050
029900                                                                  02990050
030000 01  MLT-MKDNS-BVOUT-RECORD                 PIC X(800).           03000099
030100                                                                  03010050
030200 FD  MLT-OTHINV-BVOUT-FILE                                        03020050
030300     RECORDING MODE IS F                                          03030050
030400     LABEL RECORDS ARE STANDARD                                   03040050
030500     BLOCK CONTAINS 0 RECORDS.                                    03050050
030600                                                                  03060050
030700 01  MLT-OTHINV-BVOUT-RECORD                PIC X(800).           03070099
030800                                                                  03080050
030900 FD  MLT-GDCHN-OUT-FILE                                           03090069
031000     RECORDING MODE IS F                                          03100065
031100     LABEL RECORDS ARE STANDARD                                   03110065
031200     BLOCK CONTAINS 0 RECORDS.                                    03120065
031300                                                                  03130065
031400 01  MLT-GDCHN-OUT-RECORD                PIC X(800).              03140099
031500                                                                  03150065
031600 FD  MLT-GDTOT-OUT-FILE                                           03160069
031700     RECORDING MODE IS F                                          03170065
031800     LABEL RECORDS ARE STANDARD                                   03180065
031900     BLOCK CONTAINS 0 RECORDS.                                    03190065
032000                                                                  03200065
032100 01  MLT-GDTOT-OUT-RECORD                PIC X(800).              03210099
032200                                                                  03220065
032300 FD  MLT-GCTOT-OUT-FILE                                           03230069
032400     RECORDING MODE IS F                                          03240065
032500     LABEL RECORDS ARE STANDARD                                   03250065
032600     BLOCK CONTAINS 0 RECORDS.                                    03260065
032700                                                                  03270065
032800 01  MLT-GCTOT-OUT-RECORD                PIC X(800).              03280099
032900                                                                  03290065
033000 FD  MLT-GCCHN-OUT-FILE                                           03300099
033100     RECORDING MODE IS F                                          03310099
033200     LABEL RECORDS ARE STANDARD                                   03320099
033300     BLOCK CONTAINS 0 RECORDS.                                    03330099
033400                                                                  03340099
033500 01  MLT-GCCHN-OUT-RECORD                PIC X(800).              03350099
033600                                                                  03360099
033700 FD  TRANS-OUT-FILE                                               03370017
033800     RECORDING MODE IS F                                          03380017
033900     LABEL RECORDS ARE STANDARD                                   03390017
034000     BLOCK CONTAINS 0 RECORDS.                                    03400017
034100                                                                  03410017
034200 01  TRANS-OUT-RECORD                       PIC X(80).            03420017
034300                                                                  03430017
034400                                                                  03440017
034500******************************************************************03450017
034600 WORKING-STORAGE SECTION.                                         03460017
034700******************************************************************03470017
034800                                                                  03480017
034900 01  PS-PROGRAM-SWITCHES.                                         03490017
035000     05  PS-INVBAL-BOP-SW               PIC X     VALUE 'N'.      03500099
035100         88  PS-INVBAL-BOP-FILE-DONE              VALUE 'Y'.      03510099
035200         88  PS-INVBAL-BOP-FILE-NOT-DONE          VALUE 'N'.      03520099
035300     05  PS-INVBAL-EOP-SW               PIC X     VALUE 'N'.      03530099
035400         88  PS-INVBAL-EOP-FILE-DONE              VALUE 'Y'.      03540099
035500         88  PS-INVBAL-EOP-FILE-NOT-DONE          VALUE 'N'.      03550099
035600     05  PS-SALES-LY-FILE-SW           PIC X      VALUE 'N'.      03560017
035700         88  PS-SALES-LY-FILE-DONE                VALUE 'Y'.      03570017
035800         88  PS-SALES-LY-FILE-NOT-DONE            VALUE 'N'.      03580017
035900     05  PS-SALES-SW                   PIC X      VALUE 'N'.      03590017
036000         88  PS-SALES-FILE-DONE                   VALUE 'Y'.      03600017
036100         88  PS-SALES-FILE-NOT-DONE               VALUE 'N'.      03610017
036200     05  PS-SALES-BV-SW                PIC X      VALUE 'N'.      03620051
036300         88  PS-SALES-BVFILE-DONE                 VALUE 'Y'.      03630051
036400         88  PS-SALES-BVFILE-NOT-DONE             VALUE 'N'.      03640051
036500     05  PS-RECEIPT-SW                 PIC X      VALUE 'N'.      03650017
036600         88  PS-RECEIPT-FILE-DONE                 VALUE 'Y'.      03660017
036700         88  PS-RECEIPT-FILE-NOT-DONE             VALUE 'N'.      03670017
036800     05  PS-RECEIPT-BV-SW              PIC X      VALUE 'N'.      03680051
036900         88  PS-RECEIPT-BVFILE-DONE               VALUE 'Y'.      03690051
037000         88  PS-RECEIPT-BVFILE-NOT-DONE           VALUE 'N'.      03700051
037100     05  PS-MKDNS-BV-SW                PIC X      VALUE 'N'.      03710053
037200         88  PS-MKDNS-BVFILE-DONE                 VALUE 'Y'.      03720053
037300         88  PS-MKDNS-BVFILE-NOT-DONE             VALUE 'N'.      03730053
037400     05  PS-OTHINV-BV-SW               PIC X      VALUE 'N'.      03740053
037500         88  PS-OTHINV-BVFILE-DONE                VALUE 'Y'.      03750053
037600         88  PS-OTHINV-BVFILE-NOT-DONE            VALUE 'N'.      03760053
037700     05  PS-TRANS-FILE-SW              PIC X      VALUE 'N'.      03770017
037800         88  PS-TRANS-FILE-DONE                   VALUE 'Y'.      03780017
037900         88  PS-TRANS-FILE-NOT-DONE               VALUE 'N'.      03790017
038000     05  PS-GDCHN-SW                   PIC X      VALUE 'N'.      03800067
038100         88  PS-GDCHN-FILE-DONE                VALUE 'Y'.         03810067
038200         88  PS-GDCHN-FILE-NOT-DONE            VALUE 'N'.         03820067
038300     05  PS-GDTOT-FILE-SW              PIC X      VALUE 'N'.      03830067
038400         88  PS-GDTOT-FILE-DONE                   VALUE 'Y'.      03840067
038500         88  PS-GDTOT-FILE-NOT-DONE               VALUE 'N'.      03850067
038600     05  PS-GCTOT-FILE-SW              PIC X      VALUE 'N'.      03860067
038700         88  PS-GCTOT-FILE-DONE                   VALUE 'Y'.      03870067
038800         88  PS-GCTOT-FILE-NOT-DONE               VALUE 'N'.      03880067
038900     05  PS-GCCHN-FILE-SW              PIC X      VALUE 'N'.      03890099
039000         88  PS-GCCHN-FILE-DONE                   VALUE 'Y'.      03900099
039100         88  PS-GCCHN-FILE-NOT-DONE               VALUE 'N'.      03910099
039200     05  PS-ODCHN-FILE-SW              PIC X      VALUE 'N'.      03920067
039300         88  PS-ODCHN-FILE-DONE                   VALUE 'Y'.      03930067
039400         88  PS-ODCHN-FILE-NOT-DONE               VALUE 'N'.      03940067
039500     05  PS-ODTOT-FILE-SW              PIC X      VALUE 'N'.      03950067
039600         88  PS-ODTOT-FILE-DONE                   VALUE 'Y'.      03960067
039700         88  PS-ODTOT-FILE-NOT-DONE               VALUE 'N'.      03970067
039800     05  PS-OCTOT-FILE-SW              PIC X      VALUE 'N'.      03980067
039900         88  PS-OCTOT-FILE-DONE                   VALUE 'Y'.      03990067
040000         88  PS-OCTOT-FILE-NOT-DONE               VALUE 'N'.      04000067
040100     05  PS-OCCHN-FILE-SW              PIC X      VALUE 'N'.      04010099
040200         88  PS-OCCHN-FILE-DONE                   VALUE 'Y'.      04020099
040300         88  PS-OCCHN-FILE-NOT-DONE               VALUE 'N'.      04030099
040400                                                                  04040067
040500     05  PS-GROTHINV-FILE-SW           PIC X      VALUE SPACES.   04050086
040600         88  PS-GDCHN-FILE                        VALUE 'A'.      04060086
040700         88  PS-GDTOT-FILE                        VALUE 'B'.      04070086
040800         88  PS-GCCHN-FILE                        VALUE 'C'.      04080086
040900         88  PS-GCTOT-FILE                        VALUE 'D'.      04090086
041000         88  PS-ODCHN-FILE                        VALUE 'E'.      04100086
041100         88  PS-ODTOT-FILE                        VALUE 'F'.      04110086
041200         88  PS-OCCHN-FILE                        VALUE 'G'.      04120086
041300         88  PS-OCTOT-FILE                        VALUE 'H'.      04130086
041400         88  PS-OTHINV-CC-FILE                    VALUE 'I'.      04140086
041500                                                                  04150086
041600 01  PV-PROGRAM-VARIABLES.                                        04160017
041700     05  PV-ACT-OUT-RECORD.                                       04170030
041800       10 PV-ACT-HDR-RECORD         PIC X(85) VALUE SPACES.       04180031
041900       10 PV-ACT-DET-RECORD         PIC X(715) VALUE SPACES.      04190099
11752A     05  PV-OUT-RECORD              PIC X(800) VALUE SPACES.      04191099
11752A     05  PV-POS1                    PIC 9(4)  VALUE ZEROES.       04192099
11752A     05  PV-POS2                    PIC 9(4)  VALUE ZEROES.       04193099
11752A     05  PV-CURRENT-DATE            PIC X(21) VALUE SPACES.       04200199
042000     05  PV-PRODUCT-NAME            PIC X(7).                     04201099
042100     05  PV-ORG-NAME                PIC X(7).                     04210099
042200     05  PV-CALENDAR-NAME           PIC X(30).                    04220042
042300     05  PV-ORGANIZATION-NAME       PIC X(30).                    04230093
046700     05 PV-ACTUAL-RECEIPTS-BV.                                    04240052
046800        10 PV-TRANS-ID8              PIC 9(09) VALUE ZEROES.      04250052
046900        10 PV-SEQ-NO8                PIC 9(09) VALUE ZEROES.      04260052
047000        10 PV-PRODUCT-NAME8          PIC X(30) VALUE SPACES.      04270065
047100        10 PV-ORGANIZATION-NAME8     PIC X(30) VALUE SPACES.      04280052
047200        10 PV-CALENDAR-NAME8         PIC X(30) VALUE SPACES.      04290052
047300        10 PV-GREC-CST-BTY           PIC S9(11)V9(5).             04300099
047400        10 PV-GREC-DLR-BTY           PIC S9(11)V9(5).             04310099
047500        10 FILLER                    PIC X(210) VALUE ZEROES.     04320052
047600     05 PV-ACTUAL-SALES-BV.                                       04330052
047700        10 PV-TRANS-ID7              PIC 9(09) VALUE ZEROES.      04340052
047800        10 PV-SEQ-NO7                PIC 9(09) VALUE ZEROES.      04350052
047900        10 PV-PRODUCT-NAME7          PIC X(30) VALUE SPACES.      04360065
048000        10 PV-ORGANIZATION-NAME7     PIC X(30) VALUE SPACES.      04370052
048100        10 PV-CALENDAR-NAME7         PIC X(30) VALUE SPACES.      04380052
048200        10 PV-SLS-DLR-BTY            PIC S9(11)V9(5).             04390099
048300        10 FILLER                    PIC X(226) VALUE ZEROES.     04400052
048400     05 PV-ACTUAL-GOTH-BPK350.                                    04410099
048500        10 PV-TRANS-ID9             PIC 9(09).                    04420086
048600        10 PV-SEQ9                  PIC 9(09).                    04430086
048700        10 PV-PRODUCT-NAME9         PIC X(30).                    04440086
048800        10 PV-ORGANIZATION-NAME9    PIC X(30).                    04450086
048900        10 PV-CALENDAR-NAME9.                                     04460086
049000           15 PV-SEASON9            PIC X.                        04470086
049100           15 PV-YEAR9              PIC X(4).                     04480086
049200           15 FILLER                PIC X.                        04490067
049300           15 PV-WEEK-NBR9          PIC X(02).                    04500086
049400           15 FILLER                PIC X(22).                    04510086
049500         10 PV-GOTH-ADJ-CST         PIC S9(11)V9(5).              04520099
049600     05 PV-ACTUAL-GREC-TWKPOSS.                                   04530094
049700        10 PV-TRANS-ID10            PIC 9(09).                    04540094
049800        10 PV-SEQ10                 PIC 9(09).                    04550094
049900        10 PV-PRODUCT-NAME10.                                     04560094
050000           15 FILLER                PIC X.                        04570094
050100           15 PV-DEPARTMENT-NBR10   PIC X(03).                    04580094
050200           15 FILLER                PIC X.                        04590094
050300           15 PV-CLASS-NBR10        PIC X(02).                    04600094
050400           15 FILLER                PIC X.                        04610094
050500        10 PV-ORGANIZATION-NAME10   PIC X(30).                    04620094
050600        10 PV-CALENDAR-NAME10.                                    04630094
050700           15 PV-SEASON10           PIC X.                        04640094
050800           15 PV-YEAR10             PIC X(4).                     04650094
050900           15 FILLER                PIC X.                        04660094
051000           15 PV-WEEK-NBR10         PIC X(02).                    04670094
051100           15 FILLER                PIC X(22).                    04680094
051200         10 PV-GREC-NET-CST         PIC S9(11)V9(5).              04690099
11752A     05  PV-GREC-CST-TOT            PIC S9(11)V9(5)               04691099
11752A                                               VALUE ZEROES.      04692099
11752A     05  PV-GREC-RTL-TOT            PIC S9(11)V9(5)               04693099
11752A                                               VALUE ZEROES.      04694099
051300     05  PV-GREC-POS-CST            PIC +9(11).99999              04700099
051400                                               VALUE ZEROES.      04710092
051500     05  PV-GROS-OTH-CST            PIC +9(11).99999              04720099
051600                                               VALUE ZEROES.      04730092
051700     05  PV-C-SLS-DLR               PIC +9(11).99999              04740099
051800                                               VALUE ZEROES.      04750092
051900     05  PV-N-SLS-DLR               PIC +9(11).99999              04760099
052000                                               VALUE ZEROES.      04770092
052100     05  PV-C-SLS-DLR-LY            PIC +9(11).99999              04780099
052200                                               VALUE ZEROES.      04790092
052300     05  PV-N-SLS-DLR-LY            PIC +9(11).99999              04800099
052400                                               VALUE ZEROES.      04810035
052500     05  PV-ACCTPAY-CST            PIC +9(11).99999 VALUE ZEROS.  04820099
052600     05  PV-ACCTPAY-DLR            PIC +9(11).99999 VALUE ZEROS.  04830099
052700     05  PV-CONSIGN-CST            PIC +9(11).99999 VALUE ZEROS.  04840099
052800     05  PV-CONSIGN-DLR            PIC +9(11).99999 VALUE ZEROS.  04850099
052900     05  PV-CONVERT-CST            PIC +9(11).99999 VALUE ZEROS.  04860099
053000     05  PV-CONVERT-DLR            PIC +9(11).99999 VALUE ZEROS.  04870099
053100     05  PV-CUST-DIR-CST           PIC +9(11).99999 VALUE ZEROS.  04880099
053200     05  PV-CUST-DIR-DLR           PIC +9(11).99999 VALUE ZEROS.  04890099
053300     05  PV-DECOM-CST              PIC +9(11).99999 VALUE ZEROS.  04900099
053400     05  PV-DECOM-DLR              PIC +9(11).99999 VALUE ZEROS.  04910099
053500     05  PV-FLBACK-CST             PIC +9(11).99999 VALUE ZEROS.  04920099
053600     05  PV-FLBACK-DLR             PIC +9(11).99999 VALUE ZEROS.  04930099
053700     05  PV-GREC-UNT               PIC +9(11).99999 VALUE ZEROS.  04940099
053800     05  PV-I-FLBACK-CST           PIC +9(11).99999 VALUE ZEROS.  04950099
053900     05  PV-I-FLBACK-DLR           PIC +9(11).99999 VALUE ZEROS.  04960099
054000     05  PV-IECOM-CST              PIC +9(11).99999 VALUE ZEROS.  04970099
054100     05  PV-IECOM-DLR              PIC +9(11).99999 VALUE ZEROS.  04980099
054200     05  PV-IMPORT-CST             PIC +9(11).99999 VALUE ZEROS.  04990099
054300     05  PV-IMPORT-DLR             PIC +9(11).99999 VALUE ZEROS.  05000099
054400     05  PV-INFOREM-CST            PIC +9(11).99999 VALUE ZEROS.  05010099
054500     05  PV-INFOREM-DLR            PIC +9(11).99999 VALUE ZEROS.  05020099
054600     05  PV-LANDED-CST             PIC +9(11).99999 VALUE ZEROS.  05030099
054700     05  PV-LANDED-DLR             PIC +9(11).99999 VALUE ZEROS.  05040099
054800     05  PV-MODSTK-CST             PIC +9(11).99999 VALUE ZEROS.  05050099
054900     05  PV-MODSTK-DLR             PIC +9(11).99999 VALUE ZEROS.  05060099
055000     05  PV-SAMPLES-CST            PIC +9(11).99999 VALUE ZEROS.  05070099
055100     05  PV-SAMPLES-DLR            PIC +9(11).99999 VALUE ZEROS.  05080099
055200     05  PV-SPECIAL-CST            PIC +9(11).99999 VALUE ZEROS.  05090099
055300     05  PV-SPECIAL-DLR            PIC +9(11).99999 VALUE ZEROS.  05100099
055400     05  PV-STANDARD-CST           PIC +9(11).99999 VALUE ZEROS.  05110099
055500     05  PV-STANDARD-DLR           PIC +9(11).99999 VALUE ZEROS.  05120099
055600     05  PV-VENGEN-CST             PIC +9(11).99999 VALUE ZEROS.  05130099
055700     05  PV-VENGEN-DLR             PIC +9(11).99999 VALUE ZEROS.  05140099
055800     05  PV-EOP-DLR                PIC +9(11).9(5) VALUE ZEROS.   05150099
055900     05  PV-EOP-CST                PIC +9(11).9(5) VALUE ZEROS.   05160099
056000     05  PV-EOP-UNT                PIC +9(11).9(5) VALUE ZEROS.   05170099
11752A     05  PV-SLS-UNT                PIC +9(11).9(5) VALUE ZEROS.   05171099
11752A     05  PV-SLSCLR-DLR             PIC +9(11).9(5) VALUE ZEROS.   05172099
056100     05  PV-BOP-DLR                PIC +9(11).9(5) VALUE ZEROS.   05180099
056200     05  PV-BOP-CST                PIC +9(11).9(5) VALUE ZEROS.   05190099
056300     05  PV-GREC-CST               PIC +9(11).9(5) VALUE ZEROS.   05200099
056400     05  PV-GOTH-CST               PIC +9(11).9(5) VALUE ZEROS.   05210099
056500     05  PV-N-SLS10-DLR            PIC +9(11).9(5) VALUE ZEROS.   05220099
056600     05  PV-N-SLS11-DLR            PIC +9(11).9(5) VALUE ZEROS.   05230099
056700     05  PV-N-SLS12-DLR            PIC +9(11).9(5) VALUE ZEROS.   05240099
056800     05  PV-N-SLS1-DLR             PIC +9(11).9(5) VALUE ZEROS.   05250099
056900     05  PV-N-SLS2-DLR             PIC +9(11).9(5) VALUE ZEROS.   05260099
057000     05  PV-N-SLS3-DLR             PIC +9(11).9(5) VALUE ZEROS.   05270099
057100     05  PV-N-SLS4-DLR             PIC +9(11).9(5) VALUE ZEROS.   05280099
057200     05  PV-N-SLS5-DLR             PIC +9(11).9(5) VALUE ZEROS.   05290099
057300     05  PV-N-SLS6-DLR             PIC +9(11).9(5) VALUE ZEROS.   05300099
057400     05  PV-N-SLS7-DLR             PIC +9(11).9(5) VALUE ZEROS.   05310099
057500     05  PV-N-SLS8-DLR             PIC +9(11).9(5) VALUE ZEROS.   05320099
057600     05  PV-N-SLS9-DLR             PIC +9(11).9(5) VALUE ZEROS.   05330099
057700     05  PV-SLS-DLR                PIC +9(11).9(5) VALUE ZEROS.   05340099
057800     05  PV-SLS-EFC-CST            PIC +9(11).9(5) VALUE ZEROS.   05350099
057900     05  PV-SLS-EFC-DLR            PIC +9(11).9(5) VALUE ZEROS.   05360099
11752A*    05  PV-GREC-EFC-CST           PIC +9(11).9(5) VALUE ZEROS.   05370099
11752A*    05  PV-GREC-EFC-DLR           PIC +9(11).9(5) VALUE ZEROS.   05380099
11752A     05  PV-GREC-TOT-CST           PIC +9(11).9(5) VALUE ZEROS.   05381099
11752A     05  PV-GREC-TOT-RTL           PIC +9(11).9(5) VALUE ZEROS.   05382099
058200     05  PV-ASSC-DISC-DLR          PIC +9(11).9(5) VALUE ZEROS.   05390099
058300     05  PV-PERM-DLR               PIC +9(11).9(5) VALUE ZEROS.   05400099
058400     05  PV-GOLDSTAR-DLR           PIC +9(11).9(5) VALUE ZEROS.   05410099
058500     05  PV-PLUMD-DLR              PIC +9(11).9(5) VALUE ZEROS.   05420099
058600     05  PV-MKTOFF-DLR             PIC +9(11).9(5) VALUE ZEROS.   05430099
058700     05  PV-OTHRMKDN-DLR           PIC +9(11).9(5) VALUE ZEROS.   05440099
058800     05  PV-BO-ADJ-CST             PIC +9(11).9(5) VALUE ZEROS.   05450099
058900     05  PV-DA-ADJ-CST             PIC +9(11).9(5) VALUE ZEROS.   05460099
059000     05  PV-DA-ADJ-DLR             PIC +9(11).9(5) VALUE ZEROS.   05470099
059100     05  PV-FRT-CST                PIC +9(11).9(5) VALUE ZEROS.   05480099
059200     05  PV-LIC-FEE-CST            PIC +9(11).9(5) VALUE ZEROS.   05490099
059300     05  PV-OTHER-ADJ-CST          PIC +9(11).9(5) VALUE ZEROS.   05500099
059400     05  PV-OTHER-ADJ-DLR          PIC +9(11).9(5) VALUE ZEROS.   05510099
059500     05  PV-RTV-ADJ-CST            PIC +9(11).9(5) VALUE ZEROS.   05520099
059600     05  PV-RTV-ADJ-DLR            PIC +9(11).9(5) VALUE ZEROS.   05530099
059700     05  PV-SHR-DLR                PIC +9(11).9(5) VALUE ZEROS.   05540099
059800     05  PV-DA-REV-ADJ-CST         PIC +9(11).9(5) VALUE ZEROS.   05550099
059900     05  PV-DA-REV-ADJ-DLR         PIC +9(11).9(5) VALUE ZEROS.   05560099
060000     05  PV-INVBAL-BOP-READ-COUNT    PIC 9(9)   VALUE ZEROES.     05570099
060100     05  PV-INVBAL-EOP-READ-COUNT    PIC 9(9)   VALUE ZEROES.     05580099
060200     05  PV-INVBAL-BOP-WRITE-COUNT   PIC 9(9)   VALUE ZEROES.     05590099
060300     05  PV-INVBAL-EOP-WRITE-COUNT   PIC 9(9)   VALUE ZEROES.     05600099
060400     05  PV-SALES-LY-READ-COUNT     PIC 9(9)   VALUE ZEROES.      05610017
060500     05  PV-SALES-LY-WRITE-COUNT    PIC 9(9)   VALUE ZEROES.      05620017
060600     05  PV-SALES-READ-COUNT        PIC 9(9)   VALUE ZEROES.      05630017
060700     05  PV-SALES-WRITE-COUNT       PIC 9(9)   VALUE ZEROES.      05640017
060800     05  PV-SALES-BVREAD-COUNT      PIC 9(9)   VALUE ZEROES.      05650051
060900     05  PV-SALES-BVWRITE-COUNT     PIC 9(9)   VALUE ZEROES.      05660051
061000     05  PV-RECEIPT-READ-COUNT      PIC 9(9)   VALUE ZEROES.      05670017
061100     05  PV-RECEIPT-WRITE-COUNT     PIC 9(9)   VALUE ZEROES.      05680017
061200     05  PV-RECEIPT-BVREAD-COUNT    PIC 9(9)   VALUE ZEROES.      05690051
061300     05  PV-RECEIPT-BVWRITE-COUNT   PIC 9(9)   VALUE ZEROES.      05700053
061400     05  PV-MKDNS-BVWRITE-COUNT     PIC 9(9)   VALUE ZEROES.      05710053
061500     05  PV-MKDNS-BVREAD-COUNT      PIC 9(9)   VALUE ZEROES.      05720053
061600     05  PV-OTHINV-BVREAD-COUNT     PIC 9(9)   VALUE ZEROES.      05730053
061700     05  PV-OTHINV-BVWRITE-COUNT    PIC 9(9)   VALUE ZEROES.      05740053
061800     05  PV-GDCHN-READ-COUNT        PIC 9(9)   VALUE ZEROES.      05750067
061900     05  PV-GDCHN-WRITE-COUNT       PIC 9(9)   VALUE ZEROES.      05760067
062000     05  PV-GDTOT-READ-COUNT        PIC 9(9)   VALUE ZEROES.      05770067
062100     05  PV-GDTOT-WRITE-COUNT       PIC 9(9)   VALUE ZEROES.      05780067
062200     05  PV-GCTOT-READ-COUNT        PIC 9(9)   VALUE ZEROES.      05790067
062300     05  PV-GCTOT-WRITE-COUNT       PIC 9(9)   VALUE ZEROES.      05800067
062400     05  PV-GCCHN-READ-COUNT        PIC 9(9)   VALUE ZEROES.      05810099
062500     05  PV-GCCHN-WRITE-COUNT       PIC 9(9)   VALUE ZEROES.      05820099
062600     05  PV-ODCHN-READ-COUNT        PIC 9(9)   VALUE ZEROES.      05830067
062700     05  PV-ODCHN-WRITE-COUNT       PIC 9(9)   VALUE ZEROES.      05840067
062800     05  PV-ODTOT-READ-COUNT        PIC 9(9)   VALUE ZEROES.      05850067
062900     05  PV-ODTOT-WRITE-COUNT       PIC 9(9)   VALUE ZEROES.      05860067
063000     05  PV-OCTOT-READ-COUNT        PIC 9(9)   VALUE ZEROES.      05870067
063100     05  PV-OCTOT-WRITE-COUNT       PIC 9(9)   VALUE ZEROES.      05880067
063200     05  PV-OCCHN-READ-COUNT        PIC 9(9)   VALUE ZEROES.      05890099
063300     05  PV-OCCHN-WRITE-COUNT       PIC 9(9)   VALUE ZEROES.      05900099
063400     05  PV-SPACE-CNT               PIC 9(1)   VALUE ZEROES.      05910067
063500     05  PV-START-POS               PIC 9(1)   VALUE ZEROES.      05920017
063600     05  PV-END-POS                 PIC 9(1)   VALUE ZEROES.      05930017
063700     05  PV-STRT-TRN-POS            PIC 9(1)   VALUE ZEROES.      05940017
063800     05  PV-END-TRN-POS             PIC 9(1)   VALUE ZEROES.      05950017
063900     05  PV-SEQ-NO                  PIC 9(9)   VALUE ZEROES.      05960017
064000     05  PV-OTHINV-CC-SEQNO         PIC 9(9)   VALUE ZEROES.      05970086
064100     05  PV-GDCHN-SEQNO             PIC 9(9)   VALUE ZEROES.      05980086
064200     05  PV-GDTOT-SEQNO             PIC 9(9)   VALUE ZEROES.      05990086
064300     05  PV-GCCHN-SEQNO             PIC 9(9)   VALUE ZEROES.      06000086
064400     05  PV-GCTOT-SEQNO             PIC 9(9)   VALUE ZEROES.      06010086
064500     05  PV-ODCHN-SEQNO             PIC 9(9)   VALUE ZEROES.      06020086
064600     05  PV-ODTOT-SEQNO             PIC 9(9)   VALUE ZEROES.      06030086
064700     05  PV-OCCHN-SEQNO             PIC 9(9)   VALUE ZEROES.      06040086
064800     05  PV-OCTOT-SEQNO             PIC 9(9)   VALUE ZEROES.      06050088
064900     05  PV-SEQ-NO-TMP              PIC Z(9)   VALUE ZEROES.      06060017
065000     05  PV-TRANS-ID-TMP            PIC Z(9)   VALUE ZEROES.      06070017
065100     05  PV-TRANS-REC.                                            06080017
065200         10  PV-TRANS-ID            PIC 9(9)   VALUE ZEROES.      06090017
065300         10  FILLER                 PIC X(71)  VALUE SPACES.      06100017
11752A     05  PV-PERM-DLR-NUM            PIC S9(06)V9(05) VALUE ZERO.  06101099
11752A     05  PV-GOLDSTAR-DLR-NUM        PIC S9(06)V9(05) VALUE ZERO.  06102099
065400                                                                  06110017
065500******************************************************************06120017
065600*  INPUT-ML ACTUAL RECORD LAYOUT.                                 06130017
065700******************************************************************06140017
11752A*    COPY BPRD150.                                                06150099
11752A     COPY BPRD151.                                                06151099
065900******************************************************************06160017
066000 PROCEDURE DIVISION.                                              06170017
066100******************************************************************06180017
066200* MAIN PROCESSING PARA                                            06190017
066300******************************************************************06200017
066400                                                                  06210017
066500 0000-MAINLINE.                                                   06220017
066600                                                                  06230017
066700     DISPLAY ' '.                                                 06240017
066800     DISPLAY '******************'.                                06250017
066900     DISPLAY '* BEGIN BPKUT154 *'.                                06260099
067000     DISPLAY '******************'.                                06270017
067100     DISPLAY ' '.                                                 06280017
067200                                                                  06290017
067300     PERFORM 1000-INITIALIZE.                                     06300017
067400                                                                  06310017
067500     MOVE  ZEROES       TO  PV-SEQ-NO                             06320017
067600     PERFORM 2000-FORMAT-SALES-PARA                               06330017
067700        THRU 2000-EXIT  UNTIL PS-SALES-FILE-DONE.                 06340017
067800                                                                  06350017
067900     MOVE  ZEROES       TO  PV-SEQ-NO                             06360017
11752A*    PERFORM 1020-READ-SALES-LY-IN                                06370099
11752A*       THRU 1020-EXIT.                                           06380099
11752A*                                                                 06390099
11752A*    PERFORM 3000-FORMAT-SALES-LY-PARA                            06400099
11752A*       THRU 3000-EXIT  UNTIL PS-SALES-LY-FILE-DONE.              06410099
11752A*                                                                 06420099
068600     MOVE  ZEROES       TO  PV-SEQ-NO                             06430017
068700     PERFORM 1030-READ-RECEIPT-IN                                 06440033
068800        THRU 1030-EXIT.                                           06450033
068900                                                                  06460017
069000     PERFORM 4000-FORMAT-RECEIPT-PARA                             06470017
069100        THRU 4000-EXIT  UNTIL PS-RECEIPT-FILE-DONE.               06480017
069200                                                                  06490017
069300     MOVE  ZEROES       TO  PV-SEQ-NO                             06500052
069400                                                                  06510052
069500     PERFORM 1040-READ-MKDNS-BV-IN                                06520085
069600        THRU 1040-EXIT.                                           06530085
069700                                                                  06540052
069800     PERFORM 5000-FORMAT-MKDNS-BV-PARA                            06550085
069900        THRU 5000-EXIT  UNTIL PS-MKDNS-BVFILE-DONE.               06560085
070000                                                                  06570052
070100     MOVE  ZEROES       TO  PV-SEQ-NO                             06580052
070200                                                                  06590052
070300     PERFORM 1050-READ-OTHINV-BV-IN                               06600085
070400        THRU 1050-EXIT.                                           06610085
070500                                                                  06620052
070600     PERFORM 6000-FORMAT-OTHINV-BV-PARA                           06630085
070700        THRU 6000-EXIT  UNTIL PS-OTHINV-BVFILE-DONE.              06640085
070800                                                                  06650052
070900     MOVE ZEROES      TO PV-SEQ-NO                                06660099
071000                                                                  06670085
071100     PERFORM 1070-READ-GDCHN-IN                                   06680065
071200        THRU 1070-EXIT.                                           06690065
071300                                                                  06700099
071400     PERFORM 8000-FORMAT-GDCHN-PARA                               06710099
071500        THRU 8000-EXIT  UNTIL PS-GDCHN-FILE-DONE.                 06720099
071600                                                                  06730099
071700     PERFORM 1080-READ-GDTOT-IN                                   06740099
071800        THRU 1080-EXIT.                                           06750099
071900                                                                  06760099
072000     PERFORM 8100-FORMAT-GDTOT-PARA                               06770099
072100        THRU 8100-EXIT  UNTIL PS-GDTOT-FILE-DONE.                 06780099
072200                                                                  06790099
072300                                                                  06800099
072400     PERFORM 1090-READ-GCTOT-IN                                   06810099
072500        THRU 1090-EXIT.                                           06820099
072600                                                                  06830067
072700     PERFORM 8200-FORMAT-GCTOT-PARA                               06840099
072800        THRU 8200-EXIT  UNTIL PS-GCTOT-FILE-DONE.                 06850099
072900                                                                  06860086
073000     PERFORM 1060-READ-GCCHN-IN                                   06870099
073100        THRU 1060-EXIT.                                           06880099
073200                                                                  06890099
073300     PERFORM 8800-FORMAT-GCCHN-PARA                               06900099
073400        THRU 8800-EXIT  UNTIL PS-GCCHN-FILE-DONE.                 06910099
073500                                                                  06920099
073600     PERFORM 1100-READ-ODCHN-IN                                   06930099
073700        THRU 1100-EXIT.                                           06940099
073800                                                                  06950067
073900     PERFORM 8300-FORMAT-ODCHN-PARA                               06960099
074000        THRU 8300-EXIT  UNTIL PS-ODCHN-FILE-DONE.                 06970099
074100                                                                  06980067
074200                                                                  06990067
074300     PERFORM 1200-READ-ODTOT-IN                                   07000099
074400        THRU 1200-EXIT.                                           07010099
074500                                                                  07020067
074600     PERFORM 8400-FORMAT-ODTOT-PARA                               07030099
074700        THRU 8400-EXIT  UNTIL PS-ODTOT-FILE-DONE.                 07040099
074800                                                                  07050067
074900*    MOVE  PV-GCTOT-SEQNO TO  PV-OCTOT-SEQNO                      07060099
075000                                                                  07070067
075100     PERFORM 1300-READ-OCTOT-IN                                   07080099
075200        THRU 1300-EXIT.                                           07090099
075300                                                                  07100067
075400     PERFORM 8500-FORMAT-OCTOT-PARA                               07110099
075500        THRU 8500-EXIT  UNTIL PS-OCTOT-FILE-DONE.                 07120099
075600                                                                  07130067
075700     PERFORM 1600-READ-OCCHN-IN                                   07140099
075800        THRU 1600-EXIT.                                           07150099
075900                                                                  07160099
076000     PERFORM 8900-FORMAT-OCCHN-PARA                               07170099
076100        THRU 8900-EXIT  UNTIL PS-OCCHN-FILE-DONE.                 07180099
076200                                                                  07190099
076300     MOVE  ZEROES       TO  PV-SEQ-NO                             07200099
076400     PERFORM 1400-READ-INVBAL-BOP-IN                              07210099
076500        THRU 1400-EXIT.                                           07220099
076600                                                                  07230099
076700     PERFORM 8600-FORMAT-INVBAL-BOP-PARA                          07240099
076800        THRU 8600-EXIT  UNTIL PS-INVBAL-BOP-FILE-DONE.            07250099
076900                                                                  07260099
077000     MOVE  ZEROES       TO  PV-SEQ-NO                             07270099
077100     PERFORM 1500-READ-INVBAL-EOP-IN                              07280099
077200        THRU 1500-EXIT.                                           07290099
077300                                                                  07300099
077400     PERFORM 8700-FORMAT-INVBAL-EOP-PARA                          07310099
077500        THRU 8700-EXIT  UNTIL PS-INVBAL-EOP-FILE-DONE.            07320099
077600                                                                  07330099
077700                                                                  07340067
077800     PERFORM 9999-END-OF-JOB.                                     07350085
077900                                                                  07360017
078000     DISPLAY ' '.                                                 07370017
078100     DISPLAY '******************'.                                07380017
078200     DISPLAY '* END   BPKUT154 *'.                                07390099
078300     DISPLAY '******************'.                                07400017
078400     DISPLAY ' '.                                                 07410017
078500                                                                  07420017
078600     GOBACK.                                                      07430017
078700     EJECT                                                        07440017
078800                                                                  07450017
078900******************************************************************07460017
079000*   OPEN INPUT AND OUTPUT FILE AND PERFORM THE INITIAL READ.     *07470017
079100******************************************************************07480017
079200 1000-INITIALIZE.                                                 07490017
079300     DISPLAY '1000-INITIALIZE'.                                   07500017
079400                                                                  07510017
079500     OPEN INPUT  MLT-INVBAL-BOP-IN-FILE                           07520099
079600                 MLT-INVBAL-EOP-IN-FILE                           07530099
079700                 MLT-SALES-LY-IN-FILE                             07540017
079800                 MLT-SALES-IN-FILE                                07550017
079900                 MLT-RECEIPT-IN-FILE                              07560017
080000                 MLT-MKDNS-BVIN-FILE                              07570054
080100                 MLT-OTHINV-BVIN-FILE                             07580054
080200                 MLT-GDCHN-IN-FILE                                07590067
080300                 MLT-GDTOT-IN-FILE                                07600067
080400                 MLT-GCTOT-IN-FILE                                07610067
080410                 MLT-GCCHN-IN-FILE                                07620099
080500                 MLT-ODCHN-IN-FILE                                07630067
080600                 MLT-ODTOT-IN-FILE                                07640067
080700                 MLT-OCTOT-IN-FILE                                07650067
080710                 MLT-OCCHN-IN-FILE                                07660099
080800                 TRANS-IN-FILE                                    07670021
080900          OUTPUT MLT-SALES-LY-OUT-FILE                            07680083
081000                 MLT-SALES-OUT-FILE                               07690017
081100                 MLT-RECEIPT-OUT-FILE                             07700017
081200                 MLT-MKDNS-BVOUT-FILE                             07710054
081300                 MLT-OTHINV-BVOUT-FILE                            07720054
081400                 MLT-INVBAL-BOP-OUT-FILE                          07730099
081500                 MLT-INVBAL-EOP-OUT-FILE                          07740099
081600                 MLT-GDCHN-OUT-FILE                               07750067
081700                 MLT-GDTOT-OUT-FILE                               07760067
081800                 MLT-GCTOT-OUT-FILE                               07770067
081810                 MLT-GCCHN-OUT-FILE                               07780099
081900                 TRANS-OUT-FILE.                                  07790099
082000                                                                  07800017
082100     PERFORM 1010-READ-SALES-IN                                   07810017
082200        THRU 1010-EXIT.                                           07820017
082300                                                                  07830034
082400     PERFORM 1800-READ-TRANS-IN                                   07840099
082500        THRU 1800-EXIT.                                           07850099
082600                                                                  07860017
11752A     MOVE FUNCTION CURRENT-DATE TO PV-CURRENT-DATE.               07861099
11752A                                                                  07862099
082700******************************************************************07870017
082800*   FORMAT THE  FILE1 - PKB_ACTUAL_SALES     SEPARATED BY         07880017
082900*   DELIMITERS.                                                   07890017
083000******************************************************************07900017
083100 2000-FORMAT-SALES-PARA.                                          07910017
083200                                                                  07920017
083300     INITIALIZE  PV-ACT-OUT-RECORD                                07930017
083400                 PV-SPACE-CNT                                     07940017
083500                 PV-START-POS                                     07950017
083600                 PV-END-POS                                       07960017
083700                 PV-PRODUCT-NAME                                  07970042
083800                 PV-CALENDAR-NAME                                 07980042
083900                                                                  07990017
084000     ADD 01                 TO PV-SEQ-NO                          08000017
084100     MOVE PV-SEQ-NO         TO PV-SEQ-NO-TMP                      08010017
084200     MOVE PV-SEQ-NO-TMP     TO BP150-SEQ1                         08020017
084300     MOVE PV-TRANS-ID-TMP   TO BP150-TRANS-ID1                    08030017
084400                                                                  08040017
084500     INSPECT PV-SEQ-NO-TMP    TALLYING                            08050017
084600             PV-SPACE-CNT    FOR LEADING SPACES                   08060017
084700                                                                  08070017
084800     COMPUTE PV-START-POS = PV-SPACE-CNT  + 1                     08080017
084900     COMPUTE PV-END-POS   = 9 - PV-SPACE-CNT                      08090017
085000                                                                  08100038
11752A* WRITE HEADER RECORD AS FIRST RECORD IN FILE                     08101099
11752A     IF PV-SALES-READ-COUNT = 1                                   08102099
11752A        STRING 'TRANS_ID'          DELIMITED BY SIZE '|'          08103099
11752A               'PRODUCT_NAME'      DELIMITED BY SIZE '|'          08104099
11752A               'ORGANIZATION_NAME' DELIMITED BY SIZE '|'          08104199
11752A               'CALENDAR_NAME'     DELIMITED BY SIZE '|'          08104399
11752A               'SLS_RTL'           DELIMITED BY SIZE              08104499
11752A                               INTO PV-ACT-OUT-RECORD             08105099
11752A        WRITE  MLT-SALES-OUT-RECORD FROM PV-ACT-OUT-RECORD        08106099
11752A        INITIALIZE PV-ACT-OUT-RECORD                              08106199
11752A     END-IF                                                       08107099
11752A                                                                  08108099
085100     STRING  'C'   BP150-DEPARTMENT-NBR1 '_'                      08110039
085200             BP150-CLASS-NBR1       DELIMITED BY SPACES           08120039
085300             INTO PV-PRODUCT-NAME                                 08130042
085400                                                                  08140038
085500     STRING        BP150-SEASON1    DELIMITED BY SPACE            08150039
085600                   BP150-YEAR1      'W'                           08160043
085700                   BP150-WEEK-NBR1  DELIMITED BY SPACES           08170039
085800             INTO PV-CALENDAR-NAME                                08180042
085900                                                                  08190039
086000     MOVE   BP150-C-SLS-DLR          TO PV-C-SLS-DLR              08200024
086100     MOVE   BP150-N-SLS-DLR          TO PV-N-SLS-DLR              08210024
086200     MOVE   BP150-N-SLS10-DLR        TO PV-N-SLS10-DLR            08220037
086300     MOVE   BP150-N-SLS11-DLR        TO PV-N-SLS11-DLR            08230037
086400     MOVE   BP150-N-SLS12-DLR        TO PV-N-SLS12-DLR            08240037
086500     MOVE   BP150-N-SLS1-DLR         TO PV-N-SLS1-DLR             08250037
086600     MOVE   BP150-N-SLS2-DLR         TO PV-N-SLS2-DLR             08260037
086700     MOVE   BP150-N-SLS3-DLR         TO PV-N-SLS3-DLR             08270037
086800     MOVE   BP150-N-SLS4-DLR         TO PV-N-SLS4-DLR             08280037
086900     MOVE   BP150-N-SLS5-DLR         TO PV-N-SLS5-DLR             08290037
087000     MOVE   BP150-N-SLS6-DLR         TO PV-N-SLS6-DLR             08300037
087100     MOVE   BP150-N-SLS7-DLR         TO PV-N-SLS7-DLR             08310037
087200     MOVE   BP150-N-SLS8-DLR         TO PV-N-SLS8-DLR             08320037
087300     MOVE   BP150-N-SLS9-DLR         TO PV-N-SLS9-DLR             08330037
087400     MOVE   BP150-SLS-DLR            TO PV-SLS-DLR                08340037
11752A*    STRING BP150-TRANS-ID1(PV-STRT-TRN-POS:PV-END-TRN-POS) ','   08350099
11752A*           BP150-SEQ1(PV-START-POS:PV-END-POS)    ','            08360099
11752A*           PV-PRODUCT-NAME                        ','            08361099
11752A*           BP150-ORGANIZATION-NAME1               ','            08361199
11752A*           PV-CALENDAR-NAME                       ','            08361299
11752A*           DELIMITED BY SPACE INTO PV-ACT-HDR-RECORD             08361399
11752A     STRING PV-CURRENT-DATE (1:14)                 '|'            08362099
11752A            PV-PRODUCT-NAME                        '|'            08370099
11752A            BP150-ORGANIZATION-NAME1               '|'            08380099
11752A            PV-CALENDAR-NAME                       '|'            08390099
11752A            DELIMITED BY SPACE INTO PV-ACT-HDR-RECORD             08400099
088100      STRING PV-ACT-HDR-RECORD DELIMITED BY SPACE                 08410031
11752A*           PV-C-SLS-DLR DELIMITED BY SIZE      ','               08420099
11752A*           PV-N-SLS-DLR DELIMITED BY SIZE      ','               08430099
11752A*         PV-N-SLS10-DLR DELIMITED BY SIZE      ','               08440099
11752A*         PV-N-SLS11-DLR DELIMITED BY SIZE      ','               08450099
11752A*         PV-N-SLS12-DLR DELIMITED BY SIZE      ','               08460099
11752A*         PV-N-SLS1-DLR  DELIMITED BY SIZE      ','               08470099
11752A*         PV-N-SLS2-DLR  DELIMITED BY SIZE      ','               08480099
11752A*         PV-N-SLS3-DLR  DELIMITED BY SIZE      ','               08490099
11752A*         PV-N-SLS4-DLR  DELIMITED BY SIZE      ','               08500099
11752A*         PV-N-SLS5-DLR  DELIMITED BY SIZE      ','               08510099
11752A*         PV-N-SLS6-DLR  DELIMITED BY SIZE      ','               08520099
11752A*         PV-N-SLS7-DLR  DELIMITED BY SIZE      ','               08530099
11752A*         PV-N-SLS8-DLR  DELIMITED BY SIZE      ','               08540099
11752A*         PV-N-SLS9-DLR  DELIMITED BY SIZE      ','               08550099
089600          PV-SLS-DLR     DELIMITED BY SIZE                        08560099
089700                               INTO PV-ACT-OUT-RECORD             08570030
11752A*    WRITE  MLT-SALES-OUT-RECORD FROM PV-ACT-OUT-RECORD.          08570199
11752A*    ADD  01                  TO  PV-SALES-WRITE-COUNT            08570299
C12018     INSPECT PV-ACT-OUT-RECORD REPLACING ALL                      08571099
C12018             '+00000000000.00000' BY '                  '         08572099
C12018     INITIALIZE PV-OUT-RECORD                                     08573099
C12018                PV-POS2                                           08574099
C12018     PERFORM VARYING PV-POS1 FROM 1 BY 1                          08575099
C12018        UNTIL PV-POS1 > 800                                       08576099
C12018        IF PV-ACT-OUT-RECORD (PV-POS1:1) NOT = SPACE              08577099
C12018           ADD     1 TO PV-POS2                                   08578099
C12018           MOVE PV-ACT-OUT-RECORD (PV-POS1:1)                     08579099
C12018             TO PV-OUT-RECORD (PV-POS2:1)                         08579199
C12018        END-IF                                                    08579299
C12018     END-PERFORM                                                  08579399
C12018     WRITE  MLT-SALES-OUT-RECORD FROM PV-OUT-RECORD.              08580099
C12018     ADD  01                  TO  PV-SALES-WRITE-COUNT.           08590099
090000                                                                  08600017
090100     PERFORM 1010-READ-SALES-IN                                   08610017
090200        THRU 1010-EXIT.                                           08620017
090300 2000-EXIT.                                                       08630017
090400     EXIT.                                                        08640017
090500******************************************************************08650051
090600*   FORMAT THE  FILE2 - PKB_ACTUAL_SALES_LY  SEPARATED BY         08660017
090700*   DELIMITERS.                                                   08670017
090800******************************************************************08680017
090900 3000-FORMAT-SALES-LY-PARA.                                       08690017
091000                                                                  08700017
091100     INITIALIZE  PV-ACT-OUT-RECORD                                08710017
091200                 PV-SPACE-CNT                                     08720017
091300                 PV-START-POS                                     08730017
091400                 PV-END-POS                                       08740017
091500                 PV-PRODUCT-NAME                                  08750042
091600                 PV-CALENDAR-NAME                                 08760042
091700                                                                  08770017
091800     ADD 01                 TO PV-SEQ-NO                          08780017
091900     MOVE PV-SEQ-NO         TO PV-SEQ-NO-TMP                      08790017
092000     MOVE PV-SEQ-NO-TMP     TO BP150-SEQ4                         08800017
092100     MOVE PV-TRANS-ID-TMP   TO BP150-TRANS-ID4                    08810017
092200                                                                  08820017
092300     INSPECT PV-SEQ-NO-TMP    TALLYING                            08830017
092400             PV-SPACE-CNT    FOR LEADING SPACES                   08840017
092500                                                                  08850017
092600     COMPUTE PV-START-POS = PV-SPACE-CNT  + 1                     08860017
092700     COMPUTE PV-END-POS   = 9 - PV-SPACE-CNT                      08870017
092800                                                                  08880039
092900     STRING  'C'   BP150-DEPARTMENT-NBR4 '_'                      08890039
093000             BP150-CLASS-NBR4       DELIMITED BY SPACES           08900039
093100             INTO PV-PRODUCT-NAME                                 08910042
093200                                                                  08920039
093300     STRING        BP150-SEASON4    DELIMITED BY SPACE            08930039
093400                   BP150-YEAR4      'W'                           08940043
093500                   BP150-WEEK-NBR4  DELIMITED BY SPACES           08950039
093600             INTO PV-CALENDAR-NAME                                08960042
093700                                                                  08970039
093800                                                                  08980017
093900     MOVE   BP150-C-SLS-DLR-LY TO PV-C-SLS-DLR-LY                 08990025
094000     MOVE   BP150-N-SLS-DLR-LY TO PV-N-SLS-DLR-LY                 09000025
094100     STRING BP150-TRANS-ID4(PV-STRT-TRN-POS:PV-END-TRN-POS) ','   09010032
094200            BP150-SEQ4(PV-START-POS:PV-END-POS)    ','            09020032
094300            PV-PRODUCT-NAME                     ','               09030042
094400            BP150-ORGANIZATION-NAME4               ','            09040032
094500            PV-CALENDAR-NAME                    ','               09050042
094600            DELIMITED BY SPACE INTO PV-ACT-HDR-RECORD             09060032
094700      STRING PV-ACT-HDR-RECORD DELIMITED BY SPACE                 09070032
094800            PV-C-SLS-DLR-LY DELIMITED BY SIZE      ','            09080032
094900            PV-N-SLS-DLR-LY DELIMITED BY SIZE                     09090032
095000                               INTO PV-ACT-OUT-RECORD             09100032
095100     WRITE  MLT-SALES-LY-OUT-RECORD FROM PV-ACT-OUT-RECORD.       09110017
095200     ADD  01                  TO  PV-SALES-LY-WRITE-COUNT         09120017
095300                                                                  09130017
095400     PERFORM 1020-READ-SALES-LY-IN                                09140017
095500        THRU 1020-EXIT.                                           09150017
095600 3000-EXIT.                                                       09160017
095700     EXIT.                                                        09170017
095800******************************************************************09180017
095900*   FORMAT THE  FILE3 - PKB_ACTUAL_RECEIPTS   SEPARATED BY        09190052
096000*   DELIMITERS.                                                   09200017
096100******************************************************************09210017
096200 4000-FORMAT-RECEIPT-PARA.                                        09220017
096300                                                                  09230017
096400     INITIALIZE  PV-ACT-OUT-RECORD                                09240017
096500                 PV-SPACE-CNT                                     09250017
096600                 PV-START-POS                                     09260017
096700                 PV-END-POS                                       09270017
096800                 PV-PRODUCT-NAME                                  09280042
096900                 PV-CALENDAR-NAME                                 09290042
11752A                 PV-GREC-CST-TOT                                  09291099
11752A                 PV-GREC-RTL-TOT                                  09292099
097000                                                                  09300017
097100     ADD 01                 TO PV-SEQ-NO                          09310017
097200     MOVE PV-SEQ-NO         TO PV-SEQ-NO-TMP                      09320017
097300     MOVE PV-SEQ-NO-TMP     TO BP150-SEQ2                         09330017
097400     MOVE PV-TRANS-ID-TMP   TO BP150-TRANS-ID2                    09340017
097500                                                                  09350017
097600     INSPECT PV-SEQ-NO-TMP    TALLYING                            09360017
097700             PV-SPACE-CNT    FOR LEADING SPACES                   09370017
097800                                                                  09380017
097900     COMPUTE PV-START-POS = PV-SPACE-CNT  + 1                     09390017
098000     COMPUTE PV-END-POS   = 9 - PV-SPACE-CNT                      09400017
098100                                                                  09410039
11752A* WRITE HEADER RECORD AS FIRST RECORD IN FILE                     09411099
11752A     IF PV-RECEIPT-READ-COUNT = 1                                 09412099
11752A        STRING 'TRANS_ID'          DELIMITED BY SIZE '|'          09413099
11752A               'PRODUCT_NAME'      DELIMITED BY SIZE '|'          09414099
11752A               'ORGANIZATION_NAME' DELIMITED BY SIZE '|'          09415099
11752A               'CALENDAR_NAME'     DELIMITED BY SIZE '|'          09416099
11752A               'RECTOT_CST'        DELIMITED BY SIZE '|'          09417099
11752A               'RECTOT_RTL'        DELIMITED BY SIZE '|'          09418099
11752A               'RECTOT_UNT'        DELIMITED BY SIZE              09418299
11752A                               INTO PV-ACT-OUT-RECORD             09420599
11752A        WRITE  MLT-RECEIPT-OUT-RECORD FROM PV-ACT-OUT-RECORD      09420699
11752A        INITIALIZE PV-ACT-OUT-RECORD                              09420799
11752A     END-IF                                                       09420899
11752A                                                                  09420999
098200     STRING  'C'   BP150-DEPARTMENT-NBR2 '_'                      09421099
098300             BP150-CLASS-NBR2       DELIMITED BY SPACES           09430039
098400             INTO PV-PRODUCT-NAME                                 09440042
098500                                                                  09450039
098600     STRING        BP150-SEASON2    DELIMITED BY SPACE            09460039
098700                   BP150-YEAR2      'W'                           09470043
098800                   BP150-WEEK-NBR2  DELIMITED BY SPACES           09480039
098900             INTO PV-CALENDAR-NAME                                09490042
099000                                                                  09500039
099100                                                                  09510017
11752A     ADD    BP150-ACCTPAY-CST        TO PV-GREC-CST-TOT           09520099
11752A     ADD    BP150-CONSIGN-CST        TO PV-GREC-CST-TOT           09540099
11752A     ADD    BP150-CONVERT-CST        TO PV-GREC-CST-TOT           09560099
11752A     ADD    BP150-CUST-DIR-CST       TO PV-GREC-CST-TOT           09580099
11752A     ADD    BP150-DECOM-CST          TO PV-GREC-CST-TOT           09600099
11752A     ADD    BP150-FLBACK-CST         TO PV-GREC-CST-TOT           09620099
11752A     ADD    BP150-I-FLBACK-CST       TO PV-GREC-CST-TOT           09650099
11752A     ADD    BP150-IECOM-CST          TO PV-GREC-CST-TOT           09670099
11752A     ADD    BP150-IMPORT-CST         TO PV-GREC-CST-TOT           09690099
11752A     ADD    BP150-INFOREM-CST        TO PV-GREC-CST-TOT           09710099
11752A     ADD    BP150-LANDED-CST         TO PV-GREC-CST-TOT           09730099
11752A     ADD    BP150-MODSTK-CST         TO PV-GREC-CST-TOT           09750099
11752A     ADD    BP150-SAMPLES-CST        TO PV-GREC-CST-TOT           09770099
11752A     ADD    BP150-SPECIAL-CST        TO PV-GREC-CST-TOT           09790099
11752A     ADD    BP150-STANDARD-CST       TO PV-GREC-CST-TOT           09810099
11752A     ADD    BP150-VENGEN-CST         TO PV-GREC-CST-TOT           09830099
11752A                                                                  09860099
11752A     ADD    BP150-ACCTPAY-DLR        TO PV-GREC-RTL-TOT           09860299
11752A     ADD    BP150-CONSIGN-DLR        TO PV-GREC-RTL-TOT           09860499
11752A     ADD    BP150-CONVERT-DLR        TO PV-GREC-RTL-TOT           09860699
11752A     ADD    BP150-CUST-DIR-DLR       TO PV-GREC-RTL-TOT           09860899
11752A     ADD    BP150-DECOM-DLR          TO PV-GREC-RTL-TOT           09861099
11752A     ADD    BP150-FLBACK-DLR         TO PV-GREC-RTL-TOT           09861299
11752A     ADD    BP150-I-FLBACK-DLR       TO PV-GREC-RTL-TOT           09861499
11752A     ADD    BP150-IECOM-DLR          TO PV-GREC-RTL-TOT           09861699
11752A     ADD    BP150-IMPORT-DLR         TO PV-GREC-RTL-TOT           09861899
11752A     ADD    BP150-INFOREM-DLR        TO PV-GREC-RTL-TOT           09862099
11752A     ADD    BP150-LANDED-DLR         TO PV-GREC-RTL-TOT           09862299
11752A     ADD    BP150-MODSTK-DLR         TO PV-GREC-RTL-TOT           09862499
11752A     ADD    BP150-SAMPLES-DLR        TO PV-GREC-RTL-TOT           09862699
11752A     ADD    BP150-SPECIAL-DLR        TO PV-GREC-RTL-TOT           09862899
11752A     ADD    BP150-STANDARD-DLR       TO PV-GREC-RTL-TOT           09863099
11752A     ADD    BP150-VENGEN-DLR         TO PV-GREC-RTL-TOT           09863299
11752A*    MOVE   BP150-ACCTPAY-CST        TO PV-ACCTPAY-CST            09863599
11752A*    MOVE   BP150-ACCTPAY-DLR        TO PV-ACCTPAY-DLR            09863699
11752A*    MOVE   BP150-CONSIGN-CST        TO PV-CONSIGN-CST            09863799
11752A*    MOVE   BP150-CONSIGN-DLR        TO PV-CONSIGN-DLR            09864099
11752A*    MOVE   BP150-CONVERT-CST        TO PV-CONVERT-CST            09865099
11752A*    MOVE   BP150-CONVERT-DLR        TO PV-CONVERT-DLR            09866099
11752A*    MOVE   BP150-CUST-DIR-CST       TO PV-CUST-DIR-CST           09867099
11752A*    MOVE   BP150-CUST-DIR-DLR       TO PV-CUST-DIR-DLR           09868099
11752A*    MOVE   BP150-DECOM-CST          TO PV-DECOM-CST              09869099
11752A*    MOVE   BP150-DECOM-DLR          TO PV-DECOM-DLR              09869199
11752A*    MOVE   BP150-FLBACK-CST         TO PV-FLBACK-CST             09869299
11752A*    MOVE   BP150-FLBACK-DLR         TO PV-FLBACK-DLR             09869399
11752A*    MOVE   BP150-GREC-UNT           TO PV-GREC-UNT               09869499
11752A*    MOVE   BP150-I-FLBACK-CST       TO PV-I-FLBACK-CST           09869599
11752A*    MOVE   BP150-I-FLBACK-DLR       TO PV-I-FLBACK-DLR           09869699
11752A*    MOVE   BP150-IECOM-CST          TO PV-IECOM-CST              09869799
11752A*    MOVE   BP150-IECOM-DLR          TO PV-IECOM-DLR              09869899
11752A*    MOVE   BP150-IMPORT-CST         TO PV-IMPORT-CST             09869999
11752A*    MOVE   BP150-IMPORT-DLR         TO PV-IMPORT-DLR             09870099
11752A*    MOVE   BP150-INFOREM-CST        TO PV-INFOREM-CST            09870199
11752A*    MOVE   BP150-INFOREM-DLR        TO PV-INFOREM-DLR            09870299
11752A*    MOVE   BP150-LANDED-CST         TO PV-LANDED-CST             09870399
11752A*    MOVE   BP150-LANDED-DLR         TO PV-LANDED-DLR             09870499
11752A*    MOVE   BP150-MODSTK-CST         TO PV-MODSTK-CST             09870599
11752A*    MOVE   BP150-MODSTK-DLR         TO PV-MODSTK-DLR             09870699
11752A*    MOVE   BP150-SAMPLES-CST        TO PV-SAMPLES-CST            09870799
11752A*    MOVE   BP150-SAMPLES-DLR        TO PV-SAMPLES-DLR            09870899
11752A*    MOVE   BP150-SPECIAL-CST        TO PV-SPECIAL-CST            09870999
11752A*    MOVE   BP150-SPECIAL-DLR        TO PV-SPECIAL-DLR            09871099
11752A*    MOVE   BP150-STANDARD-CST       TO PV-STANDARD-CST           09871199
11752A*    MOVE   BP150-STANDARD-DLR       TO PV-STANDARD-DLR           09871299
11752A*    MOVE   BP150-VENGEN-CST         TO PV-VENGEN-CST             09871399
11752A*    MOVE   BP150-VENGEN-DLR         TO PV-VENGEN-DLR             09871499
11752A*    MOVE   BP150-GREC-EFC-CST       TO PV-GREC-EFC-CST           09871599
11752A*    MOVE   BP150-GREC-EFC-DLR       TO PV-GREC-EFC-DLR           09871699
11752A     MOVE   PV-GREC-CST-TOT          TO PV-GREC-TOT-CST           09871999
11752A     MOVE   PV-GREC-RTL-TOT          TO PV-GREC-TOT-RTL           09872099
11752A     MOVE   BP150-GREC-UNT           TO PV-GREC-UNT               09872199
11752A*    STRING BP150-TRANS-ID2(PV-STRT-TRN-POS:PV-END-TRN-POS) ','   09873099
11752A*           BP150-SEQ2(PV-START-POS:PV-END-POS)    ','            09880099
11752A*           PV-PRODUCT-NAME                     ','               09890099
11752A*           BP150-ORGANIZATION-NAME2               ','            09900099
11752A*           PV-CALENDAR-NAME                    ','               09910099
11752A*           DELIMITED BY SPACE INTO PV-ACT-HDR-RECORD             09920099
11752A     STRING PV-CURRENT-DATE (1:14)                 '|'            09921099
11752A            PV-PRODUCT-NAME                        '|'            09923099
11752A            BP150-ORGANIZATION-NAME2               '|'            09924099
11752A            PV-CALENDAR-NAME                       '|'            09925099
11752A            DELIMITED BY SPACE INTO PV-ACT-HDR-RECORD             09926099
103300      STRING PV-ACT-HDR-RECORD DELIMITED BY SPACE                 09930032
11752A*           PV-ACCTPAY-CST  DELIMITED BY SIZE      ','            09940099
11752A*           PV-ACCTPAY-DLR  DELIMITED BY SIZE      ','            09950099
11752A*           PV-CONSIGN-CST  DELIMITED BY SIZE      ','            09960099
11752A*           PV-CONSIGN-DLR  DELIMITED BY SIZE      ','            09970099
11752A*           PV-CONVERT-CST  DELIMITED BY SIZE      ','            09980099
11752A*           PV-CONVERT-DLR  DELIMITED BY SIZE      ','            09990099
11752A*           PV-CUST-DIR-CST DELIMITED BY SIZE      ','            10000099
11752A*           PV-CUST-DIR-DLR DELIMITED BY SIZE      ','            10010099
11752A*           PV-DECOM-CST    DELIMITED BY SIZE      ','            10020099
11752A*           PV-DECOM-DLR    DELIMITED BY SIZE      ','            10030099
11752A*           PV-FLBACK-CST   DELIMITED BY SIZE      ','            10040099
11752A*           PV-FLBACK-DLR   DELIMITED BY SIZE      ','            10050099
11752A*           PV-GREC-UNT     DELIMITED BY SIZE      ','            10060099
11752A*           PV-I-FLBACK-CST DELIMITED BY SIZE      ','            10070099
11752A*           PV-I-FLBACK-DLR DELIMITED BY SIZE      ','            10080099
11752A*           PV-IECOM-CST    DELIMITED BY SIZE      ','            10090099
11752A*           PV-IECOM-DLR    DELIMITED BY SIZE      ','            10100099
11752A*           PV-IMPORT-CST   DELIMITED BY SIZE      ','            10110099
11752A*           PV-IMPORT-DLR   DELIMITED BY SIZE      ','            10120099
11752A*           PV-INFOREM-CST  DELIMITED BY SIZE      ','            10130099
11752A*           PV-INFOREM-DLR  DELIMITED BY SIZE      ','            10140099
11752A*           PV-LANDED-CST   DELIMITED BY SIZE      ','            10150099
11752A*           PV-LANDED-DLR   DELIMITED BY SIZE      ','            10160099
11752A*           PV-MODSTK-CST   DELIMITED BY SIZE      ','            10170099
11752A*           PV-MODSTK-DLR   DELIMITED BY SIZE      ','            10180099
11752A*           PV-SAMPLES-CST  DELIMITED BY SIZE      ','            10190099
11752A*           PV-SAMPLES-DLR  DELIMITED BY SIZE      ','            10200099
11752A*           PV-SPECIAL-CST  DELIMITED BY SIZE      ','            10210099
11752A*           PV-SPECIAL-DLR  DELIMITED BY SIZE      ','            10220099
11752A*           PV-STANDARD-CST DELIMITED BY SIZE      ','            10230099
11752A*           PV-STANDARD-DLR DELIMITED BY SIZE      ','            10240099
11752A*           PV-VENGEN-CST   DELIMITED BY SIZE      ','            10250099
11752A*           PV-VENGEN-DLR   DELIMITED BY SIZE      ','            10260099
11752A*           PV-GREC-EFC-CST DELIMITED BY SIZE      ','            10270099
11752A*           PV-GREC-EFC-DLR DELIMITED BY SIZE                     10271099
11752A            PV-GREC-TOT-CST DELIMITED BY SIZE      '|'            10281599
11752A            PV-GREC-TOT-RTL DELIMITED BY SIZE      '|'            10282099
11752A            PV-GREC-UNT     DELIMITED BY SIZE                     10283099
106900                               INTO PV-ACT-OUT-RECORD             10290032
11752A*    WRITE  MLT-RECEIPT-OUT-RECORD FROM PV-ACT-OUT-RECORD.        10290199
11752A*    ADD  01                  TO  PV-RECEIPT-WRITE-COUNT          10290299
C12018     INSPECT PV-ACT-OUT-RECORD REPLACING ALL                      10290399
C12018             '+00000000000.00000' BY '                  '         10290499
C12018     INITIALIZE PV-OUT-RECORD                                     10290599
C12018                PV-POS2                                           10290699
C12018     PERFORM VARYING PV-POS1 FROM 1 BY 1                          10290799
C12018        UNTIL PV-POS1 > 800                                       10290899
C12018        IF PV-ACT-OUT-RECORD (PV-POS1:1) NOT = SPACE              10290999
C12018           ADD     1 TO PV-POS2                                   10291099
C12018           MOVE PV-ACT-OUT-RECORD (PV-POS1:1)                     10291199
C12018             TO PV-OUT-RECORD (PV-POS2:1)                         10291299
C12018        END-IF                                                    10291399
C12018     END-PERFORM                                                  10291499
C12018     WRITE  MLT-RECEIPT-OUT-RECORD FROM PV-OUT-RECORD.            10291599
C12018     ADD  01                  TO  PV-RECEIPT-WRITE-COUNT.         10292099
107200                                                                  10320017
107300     PERFORM 1030-READ-RECEIPT-IN                                 10330017
107400        THRU 1030-EXIT.                                           10340017
107500 4000-EXIT.                                                       10350017
107600     EXIT.                                                        10360017
107700******************************************************************10370053
107800*   FORMAT THE  FILE5 - PKB_ACTUAL_MKDNS     SEPARATED BY         10380053
107900*   DELIMITERS.                                                   10390053
108000******************************************************************10400053
108100 5000-FORMAT-MKDNS-BV-PARA.                                       10410085
108200                                                                  10420053
108300     INITIALIZE  PV-ACT-OUT-RECORD                                10430053
108400                 PV-SPACE-CNT                                     10440053
108500                 PV-START-POS                                     10450053
108600                 PV-END-POS                                       10460053
108700                                                                  10470053
108800     ADD 01                 TO PV-SEQ-NO                          10480053
108900     MOVE PV-SEQ-NO         TO PV-SEQ-NO-TMP                      10490053
109000     MOVE PV-SEQ-NO-TMP     TO BP150-SEQ5                         10500053
109100     MOVE PV-TRANS-ID-TMP   TO BP150-TRANS-ID5                    10510053
109200                                                                  10520053
109300     INSPECT PV-SEQ-NO-TMP    TALLYING                            10530053
109400             PV-SPACE-CNT    FOR LEADING SPACES                   10540053
109500                                                                  10550053
109600     COMPUTE PV-START-POS = PV-SPACE-CNT  + 1                     10560053
109700     COMPUTE PV-END-POS   = 9 - PV-SPACE-CNT                      10570053
109800                                                                  10580053
11752A* WRITE HEADER RECORD AS FIRST RECORD IN FILE                     10581099
11752A     IF PV-MKDNS-BVREAD-COUNT = 1                                 10582099
11752A        STRING 'TRANS_ID'          DELIMITED BY SIZE '|'          10583099
11752A               'PRODUCT_NAME'      DELIMITED BY SIZE '|'          10584099
11752A               'ORGANIZATION_NAME' DELIMITED BY SIZE '|'          10585099
11752A               'CALENDAR_NAME'     DELIMITED BY SIZE '|'          10586099
11752A               'MDAD_RTL'          DELIMITED BY SIZE '|'          10587099
11752A               'MDMOFF_RTL'        DELIMITED BY SIZE '|'          10587199
11752A               'MDOTH_RTL'         DELIMITED BY SIZE '|'          10587299
11752A               'MDPMD_RTL'         DELIMITED BY SIZE '|'          10587399
11752A               'MDPLU_RTL'         DELIMITED BY SIZE              10587499
11752A                               INTO PV-ACT-OUT-RECORD             10588099
11752A        WRITE  MLT-MKDNS-BVOUT-RECORD FROM PV-ACT-OUT-RECORD      10589099
11752A        INITIALIZE PV-ACT-OUT-RECORD                              10589199
11752A     END-IF                                                       10589399
11752A                                                                  10589499
109900     MOVE   BP150-ASSC-DISC-DLR      TO PV-ASSC-DISC-DLR          10590053
11752A*    MOVE   BP150-PERM-DLR           TO PV-PERM-DLR               10600099
11752A*    MOVE   BP150-GOLDSTAR-DLR       TO PV-GOLDSTAR-DLR           10610099
11752A     MOVE   BP150-PERM-DLR           TO PV-PERM-DLR-NUM           10611099
11752A     MOVE   BP150-GOLDSTAR-DLR       TO PV-GOLDSTAR-DLR-NUM       10612099
11752A     ADD    PV-GOLDSTAR-DLR-NUM      TO PV-PERM-DLR-NUM           10613099
11752A     MOVE   PV-PERM-DLR-NUM          TO PV-PERM-DLR               10614099
110200     MOVE   BP150-PLUMD-DLR          TO PV-PLUMD-DLR              10620099
110300     MOVE   BP150-MKTOFF-DLR         TO PV-MKTOFF-DLR             10630053
110400     MOVE   BP150-OTHRMKDN-DLR       TO PV-OTHRMKDN-DLR           10640053
110500                                                                  10650053
11752A*    STRING BP150-TRANS-ID5(PV-STRT-TRN-POS:PV-END-TRN-POS) ','   10660099
11752A*           BP150-SEQ5(PV-START-POS:PV-END-POS)    ','            10670099
11752A*           BP150-PRODUCT-NAME5(1:4)               '_'            10671099
11752A*           BP150-PRODUCT-NAME5(5:2)               ','            10671199
11752A*           BP150-ORGANIZATION-NAME5               ','            10671299
11752A*           BP150-CALENDAR-NAME5                   ','            10671399
11752A*           DELIMITED BY SPACE INTO PV-ACT-HDR-RECORD             10671499
11752A     STRING PV-CURRENT-DATE (1:14)                 '|'            10672099
11752A            BP150-PRODUCT-NAME5(1:4)               '_'            10680099
11752A            BP150-PRODUCT-NAME5(5:2)               '|'            10690099
11752A            BP150-ORGANIZATION-NAME5               '|'            10700099
11752A            BP150-CALENDAR-NAME5                   '|'            10710099
11752A            DELIMITED BY SPACE INTO PV-ACT-HDR-RECORD             10720099
11752A*     STRING PV-ACT-HDR-RECORD DELIMITED BY SPACE                 10730099
11752A*        PV-ASSC-DISC-DLR   DELIMITED BY SIZE      ','            10740099
11752A*        PV-PERM-DLR        DELIMITED BY SIZE      ','            10750099
11752A*        PV-GOLDSTAR-DLR    DELIMITED BY SIZE      ','            10760099
11752A*        PV-PLUMD-DLR       DELIMITED BY SIZE      ','            10770099
11752A*        PV-MKTOFF-DLR      DELIMITED BY SIZE      ','            10780099
11752A*        PV-OTHRMKDN-DLR    DELIMITED BY SIZE                     10790099
11752A      STRING PV-ACT-HDR-RECORD DELIMITED BY SPACE                 10791099
11752A         PV-ASSC-DISC-DLR   DELIMITED BY SIZE      '|'            10792099
11752A         PV-MKTOFF-DLR      DELIMITED BY SIZE      '|'            10792199
11752A         PV-OTHRMKDN-DLR    DELIMITED BY SIZE      '|'            10792299
11752A         PV-PERM-DLR        DELIMITED BY SIZE      '|'            10793099
11752A         PV-PLUMD-DLR       DELIMITED BY SIZE                     10795099
112000                            INTO PV-ACT-OUT-RECORD                10800053
11752A*    WRITE  MLT-MKDNS-BVOUT-RECORD FROM PV-ACT-OUT-RECORD.        10800199
11752A*    ADD  01                  TO  PV-MKDNS-BVWRITE-COUNT          10800299
C12018     INSPECT PV-ACT-OUT-RECORD REPLACING ALL                      10809299
C12018             '+00000000000.00000' BY '                  '         10809399
C12018     INITIALIZE PV-OUT-RECORD                                     10809499
C12018                PV-POS2                                           10809599
C12018     PERFORM VARYING PV-POS1 FROM 1 BY 1                          10809699
C12018        UNTIL PV-POS1 > 800                                       10809799
C12018        IF PV-ACT-OUT-RECORD (PV-POS1:1) NOT = SPACE              10809899
C12018           ADD     1 TO PV-POS2                                   10809999
C12018           MOVE PV-ACT-OUT-RECORD (PV-POS1:1)                     10810099
C12018             TO PV-OUT-RECORD (PV-POS2:1)                         10810199
C12018        END-IF                                                    10810299
C12018     END-PERFORM                                                  10810399
C12018     WRITE  MLT-MKDNS-BVOUT-RECORD FROM PV-OUT-RECORD.            10811099
C12018     ADD  01                  TO  PV-MKDNS-BVWRITE-COUNT.         10820099
112300                                                                  10830053
112400     PERFORM 1040-READ-MKDNS-BV-IN                                10840085
112500        THRU 1040-EXIT.                                           10850085
112600 5000-EXIT.                                                       10860085
112700     EXIT.                                                        10870053
112800******************************************************************10880067
112900*   FORMAT THE  FILE6 - PKB_ACTUAL_OTHINV    SEPARATED BY         10890067
113000*   DELIMITERS.                                                   10900067
113100******************************************************************10910067
113200 6000-FORMAT-OTHINV-BV-PARA.                                      10920085
113300                                                                  10930067
113400     INITIALIZE  PV-ACT-OUT-RECORD                                10940067
113500                 PV-SPACE-CNT                                     10950067
113600                 PV-START-POS                                     10960067
113700                 PV-END-POS                                       10970067
113800                                                                  10980067
113900     ADD 01                 TO PV-SEQ-NO                          10990067
114000     MOVE PV-SEQ-NO         TO PV-SEQ-NO-TMP                      11000067
114100     MOVE PV-SEQ-NO-TMP     TO BP150-SEQ6                         11010067
114200     MOVE PV-TRANS-ID-TMP   TO BP150-TRANS-ID6                    11020067
114300                                                                  11030067
114400     INSPECT PV-SEQ-NO-TMP    TALLYING                            11040067
114500             PV-SPACE-CNT    FOR LEADING SPACES                   11050067
114600                                                                  11060067
114700     COMPUTE PV-START-POS = PV-SPACE-CNT  + 1                     11070067
114800     COMPUTE PV-END-POS   = 9 - PV-SPACE-CNT                      11080067
114900                                                                  11090067
11752A* WRITE HEADER RECORD AS FIRST RECORD IN FILE                     11091099
11752A     IF PV-OTHINV-BVREAD-COUNT = 1                                11092099
11752A        STRING 'TRANS_ID'          DELIMITED BY SIZE '|'          11093099
11752A               'PRODUCT_NAME'      DELIMITED BY SIZE '|'          11094099
11752A               'ORGANIZATION_NAME' DELIMITED BY SIZE '|'          11095099
11752A               'CALENDAR_NAME'     DELIMITED BY SIZE '|'          11096099
11752A               'FRT_CST'           DELIMITED BY SIZE '|'          11096199
11752A               'RTV_CST'           DELIMITED BY SIZE '|'          11096299
11752A               'RTV_RTL'           DELIMITED BY SIZE '|'          11096399
11752A               'SHR_RTL'           DELIMITED BY SIZE '|'          11096499
11752A               'BOADJ_CST'         DELIMITED BY SIZE '|'          11097099
11752A               'CC_CST'            DELIMITED BY SIZE '|'          11097199
11752A               'DA_CST'            DELIMITED BY SIZE '|'          11098099
11752A               'DA_RTL'            DELIMITED BY SIZE '|'          11099099
11752A               'LICFEE_CST'        DELIMITED BY SIZE '|'          11099299
11752A               'OADJ_CST'          DELIMITED BY SIZE '|'          11099399
11752A               'OADJ_RTL'          DELIMITED BY SIZE              11099499
11752A                               INTO PV-ACT-OUT-RECORD             11099899
11752A        WRITE  MLT-OTHINV-BVOUT-RECORD FROM PV-ACT-OUT-RECORD     11099999
11752A        INITIALIZE PV-ACT-OUT-RECORD                              11100099
11752A     END-IF                                                       11100199
11752A                                                                  11100299
115000     MOVE   BP150-BO-ADJ-CST         TO PV-BO-ADJ-CST             11101099
115100     MOVE   BP150-DA-ADJ-CST         TO PV-DA-ADJ-CST             11110067
115200     MOVE   BP150-DA-ADJ-DLR         TO PV-DA-ADJ-DLR             11120067
115300     MOVE   BP150-FRT-CST            TO PV-FRT-CST                11130067
115400     MOVE   BP150-LIC-FEE-CST        TO PV-LIC-FEE-CST            11140067
115500     MOVE   BP150-OTHER-ADJ-CST      TO PV-OTHER-ADJ-CST          11150067
115600     MOVE   BP150-OTHER-ADJ-DLR      TO PV-OTHER-ADJ-DLR          11160067
115700     MOVE   BP150-RTV-ADJ-CST        TO PV-RTV-ADJ-CST            11170067
115800     MOVE   BP150-RTV-ADJ-DLR        TO PV-RTV-ADJ-DLR            11180067
115900     MOVE   BP150-SHR-DLR            TO PV-SHR-DLR                11190067
11752A*    MOVE   BP150-DA-REV-ADJ-CST     TO PV-DA-REV-ADJ-CST         11200099
11752A*    MOVE   BP150-DA-REV-ADJ-DLR     TO PV-DA-REV-ADJ-DLR         11210099
116200                                                                  11220067
11752A*    STRING BP150-TRANS-ID6(PV-STRT-TRN-POS:PV-END-TRN-POS) ','   11230099
11752A*           BP150-SEQ6(PV-START-POS:PV-END-POS)    ','            11240099
11752A*           BP150-PRODUCT-NAME6(1:4)               '_'            11240199
11752A*           BP150-PRODUCT-NAME6(5:2)               ','            11240299
11752A*           BP150-ORGANIZATION-NAME6               ','            11240399
11752A*           BP150-CALENDAR-NAME6                   ','            11240499
11752A*           DELIMITED BY SPACE INTO PV-ACT-HDR-RECORD             11240599
11752A     STRING PV-CURRENT-DATE (1:14)                 '|'            11241099
11752A            BP150-PRODUCT-NAME6(1:4)               '_'            11250099
11752A            BP150-PRODUCT-NAME6(5:2)               '|'            11260099
11752A            BP150-ORGANIZATION-NAME6               '|'            11270099
11752A            BP150-CALENDAR-NAME6                   '|'            11280099
11752A            DELIMITED BY SPACE INTO PV-ACT-HDR-RECORD             11290099
11752A*     STRING PV-ACT-HDR-RECORD DELIMITED BY SPACE                 11300099
11752A*        PV-BO-ADJ-CST      DELIMITED BY SIZE      ','            11310099
11752A*        PV-DA-ADJ-CST      DELIMITED BY SIZE      ','            11320099
11752A*        PV-DA-ADJ-DLR      DELIMITED BY SIZE      ','            11330099
11752A*        PV-FRT-CST         DELIMITED BY SIZE      ','            11340099
11752A*        PV-LIC-FEE-CST     DELIMITED BY SIZE      ','            11350099
11752A*        PV-OTHER-ADJ-CST   DELIMITED BY SIZE      ','            11360099
11752A*        PV-OTHER-ADJ-DLR   DELIMITED BY SIZE      ','            11370099
11752A*        PV-RTV-ADJ-CST     DELIMITED BY SIZE      ','            11380099
11752A*        PV-RTV-ADJ-DLR     DELIMITED BY SIZE      ','            11390099
11752A*        PV-SHR-DLR         DELIMITED BY SIZE      ','            11400099
11752A*        PV-DA-REV-ADJ-CST  DELIMITED BY SIZE      ','            11410099
11752A*        PV-DA-REV-ADJ-DLR  DELIMITED BY SIZE                     11420099
11752A      STRING PV-ACT-HDR-RECORD DELIMITED BY SPACE                 11421099
11752A         PV-FRT-CST           DELIMITED BY SIZE      '|'          11421199
11752A         PV-RTV-ADJ-CST       DELIMITED BY SIZE      '|'          11421299
11752A         PV-RTV-ADJ-DLR       DELIMITED BY SIZE      '|'          11421399
11752A         PV-SHR-DLR           DELIMITED BY SIZE      '|'          11421499
11752A         PV-BO-ADJ-CST        DELIMITED BY SIZE      '|'          11422099
11752A         '+00000000000.00000' DELIMITED BY SIZE      '|'          11422199
11752A         PV-DA-ADJ-CST        DELIMITED BY SIZE      '|'          11423099
11752A         PV-DA-ADJ-DLR        DELIMITED BY SIZE      '|'          11424099
11752A         PV-LIC-FEE-CST       DELIMITED BY SIZE      '|'          11426099
11752A         PV-OTHER-ADJ-CST     DELIMITED BY SIZE      '|'          11427099
11752A         PV-OTHER-ADJ-DLR     DELIMITED BY SIZE                   11428099
118300                            INTO PV-ACT-OUT-RECORD                11430067
11752A*    WRITE  MLT-OTHINV-BVOUT-RECORD FROM PV-ACT-OUT-RECORD.       11440099
11752A*    ADD  01                  TO  PV-OTHINV-BVWRITE-COUNT         11450099
C12018     INSPECT PV-ACT-OUT-RECORD REPLACING ALL                      11459299
C12018             '+00000000000.00000' BY '                  '         11459399
C12018     INITIALIZE PV-OUT-RECORD                                     11459499
C12018                PV-POS2                                           11459599
C12018     PERFORM VARYING PV-POS1 FROM 1 BY 1                          11459699
C12018        UNTIL PV-POS1 > 800                                       11459799
C12018        IF PV-ACT-OUT-RECORD (PV-POS1:1) NOT = SPACE              11459899
C12018           ADD     1 TO PV-POS2                                   11459999
C12018           MOVE PV-ACT-OUT-RECORD (PV-POS1:1)                     11460099
C12018             TO PV-OUT-RECORD (PV-POS2:1)                         11460199
C12018        END-IF                                                    11460299
C12018     END-PERFORM                                                  11460399
C12018     WRITE  MLT-OTHINV-BVOUT-RECORD FROM PV-OUT-RECORD.           11460699
C12018     ADD  01                  TO  PV-OTHINV-BVWRITE-COUNT.        11460799
118600                                                                  11461067
118700     PERFORM 1050-READ-OTHINV-BV-IN                               11470085
118800        THRU 1050-EXIT.                                           11480085
118900 6000-EXIT.                                                       11490085
119000     EXIT.                                                        11500067
119100******************************************************************11510099
119200*   FORMAT THE  FILE9  GROSS RECEIPTS FROM TWKPOSS                11520099
119300*   DEPARTMENT CHANNEL WISE DELIMITERS.                           11530099
119400******************************************************************11540099
119500 8000-FORMAT-GDCHN-PARA.                                          11550099
119600                                                                  11560099
119700     INITIALIZE  PV-ACT-OUT-RECORD                                11570099
119800                 PV-SPACE-CNT                                     11580099
119900                 PV-START-POS                                     11590099
120000                 PV-END-POS                                       11600099
120100                 PV-PRODUCT-NAME                                  11610099
120200                 PV-CALENDAR-NAME                                 11620099
120300                 PV-ORGANIZATION-NAME                             11630099
120400     ADD 01                 TO PV-SEQ-NO                          11640099
120500     MOVE PV-SEQ-NO         TO PV-SEQ-NO-TMP                      11650099
120600     MOVE PV-SEQ-NO-TMP     TO PV-SEQ10                           11660099
120700     MOVE PV-TRANS-ID-TMP   TO PV-TRANS-ID10                      11670099
120800                                                                  11680099
120900     INSPECT PV-SEQ-NO-TMP    TALLYING                            11690099
121000             PV-SPACE-CNT    FOR LEADING SPACES                   11700099
121100                                                                  11710099
121200     COMPUTE PV-START-POS = PV-SPACE-CNT  + 1                     11720099
121300     COMPUTE PV-END-POS   = 9 - PV-SPACE-CNT.                     11730099
121400                                                                  11740099
121500     STRING  'DPT'   PV-DEPARTMENT-NBR10                          11750099
121600                                 DELIMITED BY SPACES              11760099
121700             INTO PV-PRODUCT-NAME                                 11770099
121800                                                                  11780099
121900     STRING    PV-SEASON10   DELIMITED BY SPACE                   11790099
122000               PV-YEAR10     'W'                                  11800099
122100               PV-WEEK-NBR10 DELIMITED BY SPACES                  11810099
122200             INTO PV-CALENDAR-NAME                                11820099
122300     MOVE   PV-GREC-NET-CST           TO PV-GREC-CST              11830099
122400     MOVE   ZEROES                    TO PV-GOTH-CST              11840099
122500     MOVE   PV-ORGANIZATION-NAME10    TO PV-ORGANIZATION-NAME.    11850099
122600     STRING PV-TRANS-ID10(PV-STRT-TRN-POS:PV-END-TRN-POS) ','     11860099
122700            PV-SEQ10(PV-START-POS:PV-END-POS)    ','              11870099
122800            PV-PRODUCT-NAME                      ','              11880099
122900            PV-ORGANIZATION-NAME                 ','              11890099
123000            PV-CALENDAR-NAME                       ','            11900099
123100            DELIMITED BY SPACE INTO PV-ACT-HDR-RECORD             11910099
123200      STRING PV-ACT-HDR-RECORD DELIMITED BY SPACE                 11920099
123300            PV-GREC-CST     DELIMITED BY SIZE      ','            11930099
123400            PV-GOTH-CST     DELIMITED BY SIZE                     11940099
123500                            INTO PV-ACT-OUT-RECORD                11950099
123600      PERFORM 9000-OTHINV-WRITE-PARA                              11960099
123700              THRU 9000-EXIT.                                     11970099
123800     ADD  01  TO  PV-GDCHN-WRITE-COUNT                            11980099
123900                                                                  11990099
124000     PERFORM 1070-READ-GDCHN-IN                                   12000099
124100        THRU 1070-EXIT.                                           12010099
124200 8000-EXIT.                                                       12020099
124300     EXIT.                                                        12030099
124400******************************************************************12040099
124500*   FORMAT THE  FILE9  GROSS RECEIPTS FROM TWKPOSS                12050099
124600*   DEPARTMENT TOTAL CO WISE DELIMITERS.                          12060099
124700******************************************************************12070099
124800 8100-FORMAT-GDTOT-PARA.                                          12080099
124900                                                                  12090099
125000     INITIALIZE  PV-ACT-OUT-RECORD                                12100099
125100                 PV-SPACE-CNT                                     12110099
125200                 PV-START-POS                                     12120099
125300                 PV-END-POS                                       12130099
125400                 PV-PRODUCT-NAME                                  12140099
125500                 PV-CALENDAR-NAME                                 12150099
125600                 PV-ORGANIZATION-NAME                             12160099
125700     COMPUTE PV-GDTOT-SEQNO = PV-GDTOT-SEQNO + 1                  12170099
125800     MOVE PV-GDTOT-SEQNO    TO PV-SEQ-NO                          12180099
125900     MOVE PV-SEQ-NO         TO PV-SEQ-NO-TMP                      12190099
126000     MOVE PV-SEQ-NO-TMP     TO PV-SEQ10                           12200099
126100     MOVE PV-TRANS-ID-TMP   TO PV-TRANS-ID10                      12210099
126200                                                                  12220099
126300     INSPECT PV-SEQ-NO-TMP    TALLYING                            12230099
126400             PV-SPACE-CNT    FOR LEADING SPACES                   12240099
126500                                                                  12250099
126600     COMPUTE PV-START-POS = PV-SPACE-CNT  + 1                     12260099
126700     COMPUTE PV-END-POS   = 9 - PV-SPACE-CNT.                     12270099
126800                                                                  12280099
126900                                                                  12290099
127000     STRING  'DPT'   PV-DEPARTMENT-NBR10                          12300099
127100                                 DELIMITED BY SPACES              12310099
127200             INTO PV-PRODUCT-NAME                                 12320099
127300                                                                  12330099
127400     STRING     PV-SEASON10   DELIMITED BY SPACE                  12340099
127500                PV-YEAR10     'W'                                 12350099
127600                PV-WEEK-NBR10 DELIMITED BY SPACES                 12360099
127700             INTO PV-CALENDAR-NAME                                12370099
127800                                                                  12380099
127900     MOVE   PV-GREC-NET-CST           TO PV-GREC-CST              12390099
128000     MOVE   ZEROES                    TO PV-GOTH-CST              12400099
128100     IF PV-ORGANIZATION-NAME10 = 'TOTALCO'                        12410099
128200        MOVE 'CO' TO PV-ORGANIZATION-NAME                         12420099
128300     ELSE                                                         12430099
128400        MOVE PV-ORGANIZATION-NAME10 TO PV-ORGANIZATION-NAME       12440099
128500     END-IF                                                       12450099
128600     STRING PV-TRANS-ID10(PV-STRT-TRN-POS:PV-END-TRN-POS) ','     12460099
128700            PV-SEQ10(PV-START-POS:PV-END-POS)      ','            12470099
128800            PV-PRODUCT-NAME                        ','            12480099
128900            PV-ORGANIZATION-NAME                   ','            12490099
129000            PV-CALENDAR-NAME                       ','            12500099
129100            DELIMITED BY SPACE INTO PV-ACT-HDR-RECORD             12510099
129200      STRING PV-ACT-HDR-RECORD DELIMITED BY SPACE                 12520099
129300            PV-GREC-CST     DELIMITED BY SIZE      ','            12530099
129400            PV-GOTH-CST     DELIMITED BY SIZE                     12540099
129500                            INTO PV-ACT-OUT-RECORD                12550099
129600      PERFORM 9000-OTHINV-WRITE-PARA                              12560099
129700         THRU 9000-EXIT.                                          12570099
129800                                                                  12580099
129900     ADD  01  TO  PV-GDTOT-WRITE-COUNT                            12590099
130000     PERFORM 1080-READ-GDTOT-IN                                   12600099
130100        THRU 1080-EXIT.                                           12610099
130200 8100-EXIT.                                                       12620099
130300     EXIT.                                                        12630099
130400******************************************************************12640099
130500*   FORMAT THE  FILE9  GROSS RECEIPTS FROM TWKPOSS                12650099
130600*   CLASS      TOTAL CO WISE DELIMITERS.                          12660099
130700******************************************************************12670099
130800 8200-FORMAT-GCTOT-PARA.                                          12680099
130900                                                                  12690099
131000     INITIALIZE  PV-ACT-OUT-RECORD                                12700099
131100                 PV-SPACE-CNT                                     12710099
131200                 PV-START-POS                                     12720099
131300                 PV-END-POS                                       12730099
131400                 PV-PRODUCT-NAME                                  12740099
131500                 PV-CALENDAR-NAME                                 12750099
131600                 PV-ORGANIZATION-NAME                             12760099
131700     COMPUTE PV-GCTOT-SEQNO = PV-GCTOT-SEQNO + 1                  12770099
131800     MOVE PV-GCTOT-SEQNO    TO PV-SEQ-NO                          12780099
131900     MOVE PV-SEQ-NO         TO PV-SEQ-NO-TMP                      12790099
132000     MOVE PV-SEQ-NO-TMP     TO PV-SEQ10                           12800099
132100     MOVE PV-TRANS-ID-TMP   TO PV-TRANS-ID10                      12810099
132200                                                                  12820099
132300     INSPECT PV-SEQ-NO-TMP    TALLYING                            12830099
132400             PV-SPACE-CNT    FOR LEADING SPACES                   12840099
132500                                                                  12850099
132600     COMPUTE PV-START-POS = PV-SPACE-CNT  + 1                     12860099
132700     COMPUTE PV-END-POS   = 9 - PV-SPACE-CNT.                     12870099
132800                                                                  12880099
132900     STRING  'C' PV-DEPARTMENT-NBR10 '_'                          12890099
133000           PV-CLASS-NBR10      DELIMITED BY SPACES                12900099
133100             INTO PV-PRODUCT-NAME                                 12910099
133200                                                                  12920099
133300     STRING    PV-SEASON10   DELIMITED BY SPACE                   12930099
133400               PV-YEAR10     'W'                                  12940099
133500               PV-WEEK-NBR10 DELIMITED BY SPACES                  12950099
133600             INTO PV-CALENDAR-NAME                                12960099
133700     MOVE   PV-GREC-NET-CST           TO PV-GREC-CST              12970099
133800     MOVE   ZEROES                    TO PV-GOTH-CST              12980099
133900     IF PV-ORGANIZATION-NAME10 = 'TOTALCO'                        12990099
134000        MOVE 'CO' TO PV-ORGANIZATION-NAME                         13000099
134100     ELSE                                                         13010099
134200        MOVE PV-ORGANIZATION-NAME10 TO PV-ORGANIZATION-NAME       13020099
134300     END-IF                                                       13030099
134400     STRING PV-TRANS-ID10(PV-STRT-TRN-POS:PV-END-TRN-POS) ','     13040099
134500            PV-SEQ10(PV-START-POS:PV-END-POS)    ','              13050099
134600            PV-PRODUCT-NAME                        ','            13060099
134700            PV-ORGANIZATION-NAME                   ','            13070099
134800            PV-CALENDAR-NAME                       ','            13080099
134900            DELIMITED BY SPACE INTO PV-ACT-HDR-RECORD             13090099
135000     STRING PV-ACT-HDR-RECORD DELIMITED BY SPACE                  13100099
135100            PV-GREC-CST     DELIMITED BY SIZE      ','            13110099
135200            PV-GOTH-CST     DELIMITED BY SIZE                     13120099
135300                            INTO PV-ACT-OUT-RECORD                13130099
135400      PERFORM 9000-OTHINV-WRITE-PARA                              13140099
135500         THRU 9000-EXIT.                                          13150099
135600                                                                  13160099
135700     ADD  01  TO  PV-GCTOT-WRITE-COUNT                            13170099
135800                                                                  13180099
135900     PERFORM 1090-READ-GCTOT-IN                                   13190099
136000        THRU 1090-EXIT.                                           13200099
136100 8200-EXIT.                                                       13210099
136200     EXIT.                                                        13220099
136300******************************************************************13230099
136400*   FORMAT THE  FILE9  GROSS RECEIPTS FROM TWKPOSS                13240099
136500*   CLASS      CHANNEL  WISE DELIMITERS.                          13250099
136600******************************************************************13260099
136700 8800-FORMAT-GCCHN-PARA.                                          13270099
136800                                                                  13280099
136900     INITIALIZE  PV-ACT-OUT-RECORD                                13290099
137000                 PV-SPACE-CNT                                     13300099
137100                 PV-START-POS                                     13310099
137200                 PV-END-POS                                       13320099
137300                 PV-PRODUCT-NAME                                  13330099
137400                 PV-CALENDAR-NAME                                 13340099
137500                 PV-ORGANIZATION-NAME                             13350099
137600     COMPUTE PV-GCCHN-SEQNO = PV-GCCHN-SEQNO + 1                  13360099
137700     MOVE PV-GCCHN-SEQNO    TO PV-SEQ-NO                          13370099
137800     MOVE PV-SEQ-NO         TO PV-SEQ-NO-TMP                      13380099
137900     MOVE PV-SEQ-NO-TMP     TO PV-SEQ10                           13390099
138000     MOVE PV-TRANS-ID-TMP   TO PV-TRANS-ID10                      13400099
138100                                                                  13410099
138200     INSPECT PV-SEQ-NO-TMP    TALLYING                            13420099
138300             PV-SPACE-CNT    FOR LEADING SPACES                   13430099
138400                                                                  13440099
138500     COMPUTE PV-START-POS = PV-SPACE-CNT  + 1                     13450099
138600     COMPUTE PV-END-POS   = 9 - PV-SPACE-CNT.                     13460099
138700                                                                  13470099
138800     STRING  'C' PV-DEPARTMENT-NBR10 '_'                          13480099
138900           PV-CLASS-NBR10      DELIMITED BY SPACES                13490099
139000             INTO PV-PRODUCT-NAME                                 13500099
139100                                                                  13510099
139200     STRING    PV-SEASON10   DELIMITED BY SPACE                   13520099
139300               PV-YEAR10     'W'                                  13530099
139400               PV-WEEK-NBR10 DELIMITED BY SPACES                  13540099
139500             INTO PV-CALENDAR-NAME                                13550099
139600     MOVE   PV-GREC-NET-CST           TO PV-GREC-CST              13560099
139700     MOVE   ZEROES                    TO PV-GOTH-CST              13570099
139800     MOVE   PV-ORGANIZATION-NAME10    TO PV-ORGANIZATION-NAME     13580099
139900     STRING PV-TRANS-ID10(PV-STRT-TRN-POS:PV-END-TRN-POS) ','     13590099
140000            PV-SEQ10(PV-START-POS:PV-END-POS)    ','              13600099
140100            PV-PRODUCT-NAME                        ','            13610099
140200            PV-ORGANIZATION-NAME                   ','            13620099
140300            PV-CALENDAR-NAME                       ','            13630099
140400            DELIMITED BY SPACE INTO PV-ACT-HDR-RECORD             13640099
140500     STRING PV-ACT-HDR-RECORD DELIMITED BY SPACE                  13650099
140600            PV-GREC-CST     DELIMITED BY SIZE      ','            13660099
140700            PV-GOTH-CST     DELIMITED BY SIZE                     13670099
140800                            INTO PV-ACT-OUT-RECORD                13680099
140900      PERFORM 9000-OTHINV-WRITE-PARA                              13690099
141000         THRU 9000-EXIT.                                          13700099
141100                                                                  13710099
141200     ADD  01  TO  PV-GCCHN-WRITE-COUNT                            13720099
141300                                                                  13730099
141400     PERFORM 1060-READ-GCCHN-IN                                   13740099
141500        THRU 1060-EXIT.                                           13750099
141600 8800-EXIT.                                                       13760099
141700     EXIT.                                                        13770099
141800******************************************************************13780099
141900*   FORMAT THE  FILE9  GROSS OTHINV   FROM BPK300                 13790099
142000*   DEPT CHANNEL     CO WISE DELIMITERS.                          13800099
142100******************************************************************13810099
142200 8300-FORMAT-ODCHN-PARA.                                          13820099
142300                                                                  13830099
142400     INITIALIZE  PV-ACT-OUT-RECORD                                13840099
142500                 PV-SPACE-CNT                                     13850099
142600                 PV-START-POS                                     13860099
142700                 PV-END-POS                                       13870099
142800                 PV-PRODUCT-NAME                                  13880099
142900                 PV-CALENDAR-NAME                                 13890099
143000                 PV-ORGANIZATION-NAME                             13900099
143100     COMPUTE PV-GDCHN-SEQNO = PV-GDCHN-SEQNO + 1                  13910099
143200     MOVE PV-GDCHN-SEQNO    TO PV-SEQ-NO                          13920099
143300     MOVE PV-SEQ-NO         TO PV-SEQ-NO-TMP                      13930099
143400     MOVE PV-SEQ-NO-TMP     TO PV-SEQ9                            13940099
143500     MOVE PV-TRANS-ID-TMP   TO PV-TRANS-ID9                       13950099
143600                                                                  13960099
143700     INSPECT PV-SEQ-NO-TMP    TALLYING                            13970099
143800             PV-SPACE-CNT    FOR LEADING SPACES                   13980099
143900                                                                  13990099
144000     COMPUTE PV-START-POS = PV-SPACE-CNT  + 1                     14000099
144100     COMPUTE PV-END-POS   = 9 - PV-SPACE-CNT.                     14010099
144200                                                                  14020099
144300     STRING  'DPT'   PV-PRODUCT-NAME9(2:3)                        14030099
144400                     DELIMITED BY SPACES                          14040099
144500             INTO PV-PRODUCT-NAME                                 14050099
144600     MOVE PV-ORGANIZATION-NAME9       TO PV-ORGANIZATION-NAME     14060099
144700     MOVE   ZEROES                    TO PV-GREC-CST              14070099
144800     MOVE   PV-GOTH-ADJ-CST           TO PV-GOTH-CST              14080099
144900     STRING PV-TRANS-ID9(PV-STRT-TRN-POS:PV-END-TRN-POS) ','      14090099
145000            PV-SEQ9(PV-START-POS:PV-END-POS)        ','           14100099
145100            PV-PRODUCT-NAME                         ','           14110099
145200            PV-ORGANIZATION-NAME                    ','           14120099
145300            PV-CALENDAR-NAME9                       ','           14130099
145400            DELIMITED BY SPACE INTO PV-ACT-HDR-RECORD             14140099
145500      STRING PV-ACT-HDR-RECORD DELIMITED BY SPACE                 14150099
145600            PV-GREC-CST     DELIMITED BY SIZE      ','            14160099
145700            PV-GOTH-CST     DELIMITED BY SIZE                     14170099
145800                            INTO PV-ACT-OUT-RECORD                14180099
145900      PERFORM 9000-OTHINV-WRITE-PARA                              14190099
146000         THRU 9000-EXIT.                                          14200099
146100      ADD  01                  TO  PV-ODCHN-WRITE-COUNT           14210099
146200                                                                  14220099
146300      PERFORM 1100-READ-ODCHN-IN                                  14230099
146400         THRU 1100-EXIT.                                          14240099
146500 8300-EXIT.                                                       14250099
146600     EXIT.                                                        14260099
146700******************************************************************14270099
146800*   FORMAT THE  FILE9  GROSS OTHINV   FROM BPK300                 14280099
146900*   DEPT TOTALCO     WISE DELIMITERS.                             14290099
147000******************************************************************14300099
147100 8400-FORMAT-ODTOT-PARA.                                          14310099
147200                                                                  14320099
147300     INITIALIZE  PV-ACT-OUT-RECORD                                14330099
147400                 PV-SPACE-CNT                                     14340099
147500                 PV-START-POS                                     14350099
147600                 PV-END-POS                                       14360099
147700                 PV-PRODUCT-NAME                                  14370099
147800                 PV-CALENDAR-NAME                                 14380099
147900                 PV-ORGANIZATION-NAME                             14390099
148000     COMPUTE PV-GDTOT-SEQNO = PV-GDTOT-SEQNO + 1                  14400099
148100     MOVE PV-GDTOT-SEQNO    TO PV-SEQ-NO                          14410099
148200     MOVE PV-SEQ-NO         TO PV-SEQ-NO-TMP                      14420099
148300     MOVE PV-SEQ-NO-TMP     TO PV-SEQ9                            14430099
148400     MOVE PV-TRANS-ID-TMP   TO PV-TRANS-ID9                       14440099
148500                                                                  14450099
148600     INSPECT PV-SEQ-NO-TMP    TALLYING                            14460099
148700             PV-SPACE-CNT    FOR LEADING SPACES                   14470099
148800                                                                  14480099
148900     COMPUTE PV-START-POS = PV-SPACE-CNT  + 1                     14490099
149000     COMPUTE PV-END-POS   = 9 - PV-SPACE-CNT.                     14500099
149100                                                                  14510099
149200     STRING  'DPT'   PV-PRODUCT-NAME9(2:3)                        14520099
149300                     DELIMITED BY SPACES                          14530099
149400             INTO PV-PRODUCT-NAME                                 14540099
149500                                                                  14550099
149600     IF PV-ORGANIZATION-NAME9 = 'TOTALCO'                         14560099
149700        MOVE 'CO' TO PV-ORGANIZATION-NAME                         14570099
149800     ELSE                                                         14580099
149900        MOVE PV-ORGANIZATION-NAME9 TO PV-ORGANIZATION-NAME        14590099
150000     END-IF                                                       14600099
150100                                                                  14610099
150200     MOVE   ZEROES                    TO PV-GREC-CST              14620099
150300     MOVE   PV-GOTH-ADJ-CST           TO PV-GOTH-CST              14630099
150400     STRING PV-TRANS-ID9(PV-STRT-TRN-POS:PV-END-TRN-POS) ','      14640099
150500            PV-SEQ9(PV-START-POS:PV-END-POS)        ','           14650099
150600            PV-PRODUCT-NAME                         ','           14660099
150700            PV-ORGANIZATION-NAME                    ','           14670099
150800            PV-CALENDAR-NAME9                       ','           14680099
150900            DELIMITED BY SPACE INTO PV-ACT-HDR-RECORD             14690099
151000      STRING PV-ACT-HDR-RECORD DELIMITED BY SPACE                 14700099
151100            PV-GREC-CST     DELIMITED BY SIZE      ','            14710099
151200            PV-GOTH-CST     DELIMITED BY SIZE                     14720099
151300                            INTO PV-ACT-OUT-RECORD                14730099
151400      PERFORM 9000-OTHINV-WRITE-PARA                              14740099
151500         THRU 9000-EXIT.                                          14750099
151600     ADD  01                  TO  PV-ODTOT-WRITE-COUNT            14760099
151700                                                                  14770099
151800     PERFORM 1200-READ-ODTOT-IN                                   14780099
151900        THRU 1200-EXIT.                                           14790099
152000 8400-EXIT.                                                       14800099
152100     EXIT.                                                        14810099
152200******************************************************************14820099
152300*   FORMAT THE  FILE9  GROSS OTHINV   FROM BPK300                 14830099
152400*   CLASS TOTAL CO   WISE DELIMITERS.                             14840099
152500******************************************************************14850099
152600 8500-FORMAT-OCTOT-PARA.                                          14860099
152700                                                                  14870099
152800     INITIALIZE  PV-ACT-OUT-RECORD                                14880099
152900                 PV-SPACE-CNT                                     14890099
153000                 PV-START-POS                                     14900099
153100                 PV-END-POS                                       14910099
153200                 PV-PRODUCT-NAME                                  14920099
153300                 PV-CALENDAR-NAME                                 14930099
153400                 PV-ORGANIZATION-NAME                             14940099
153500     COMPUTE PV-GCTOT-SEQNO = PV-GCTOT-SEQNO + 1                  14950099
153600     MOVE PV-GCTOT-SEQNO    TO PV-SEQ-NO                          14960099
153700     MOVE PV-SEQ-NO         TO PV-SEQ-NO-TMP                      14970099
153800     MOVE PV-SEQ-NO-TMP     TO PV-SEQ9                            14980099
153900     MOVE PV-TRANS-ID-TMP   TO PV-TRANS-ID9                       14990099
154000                                                                  15000099
154100     INSPECT PV-SEQ-NO-TMP    TALLYING                            15010099
154200             PV-SPACE-CNT    FOR LEADING SPACES                   15020099
154300                                                                  15030099
154400     COMPUTE PV-START-POS = PV-SPACE-CNT  + 1                     15040099
154500     COMPUTE PV-END-POS   = 9 - PV-SPACE-CNT.                     15050099
154600                                                                  15060099
154700     MOVE   ZEROES                    TO PV-GREC-CST              15070099
154800     MOVE   PV-GOTH-ADJ-CST           TO PV-GOTH-CST              15080099
154900     MOVE   PV-PRODUCT-NAME9          TO PV-PRODUCT-NAME          15090099
155000                                                                  15100099
155100     IF PV-ORGANIZATION-NAME9 = 'TOTALCO'                         15110099
155200        MOVE 'CO' TO PV-ORGANIZATION-NAME                         15120099
155300     ELSE                                                         15130099
155400        MOVE PV-ORGANIZATION-NAME9 TO PV-ORGANIZATION-NAME        15140099
155500     END-IF                                                       15150099
155600                                                                  15160099
155700     STRING PV-TRANS-ID9(PV-STRT-TRN-POS:PV-END-TRN-POS) ','      15170099
155800            PV-SEQ9(PV-START-POS:PV-END-POS)        ','           15180099
155900            PV-PRODUCT-NAME(1:4)                    '_'           15190099
156000            PV-PRODUCT-NAME(5:2)                    ','           15200099
156100            PV-ORGANIZATION-NAME                    ','           15210099
156200            PV-CALENDAR-NAME9                       ','           15220099
156300            DELIMITED BY SPACE INTO PV-ACT-HDR-RECORD             15230099
156400      STRING PV-ACT-HDR-RECORD DELIMITED BY SPACE                 15240099
156500            PV-GREC-CST     DELIMITED BY SIZE      ','            15250099
156600            PV-GOTH-CST     DELIMITED BY SIZE                     15260099
156700                            INTO PV-ACT-OUT-RECORD                15270099
156800      PERFORM 9000-OTHINV-WRITE-PARA                              15280099
156900         THRU 9000-EXIT.                                          15290099
157000                                                                  15300099
157100     ADD  01                  TO  PV-OCTOT-WRITE-COUNT            15310099
157200                                                                  15320099
157300     PERFORM 1300-READ-OCTOT-IN                                   15330099
157400        THRU 1300-EXIT.                                           15340099
157500                                                                  15350099
157600 8500-EXIT.                                                       15360099
157700     EXIT.                                                        15370099
157800******************************************************************15380099
157900*   FORMAT THE  FILE9  GROSS OTHINV   FROM BPK300                 15390099
158000*   CLASS CHANNEL    WISE DELIMITERS.                             15400099
158100******************************************************************15410099
158200 8900-FORMAT-OCCHN-PARA.                                          15420099
158300                                                                  15430099
158400     INITIALIZE  PV-ACT-OUT-RECORD                                15440099
158500                 PV-SPACE-CNT                                     15450099
158600                 PV-START-POS                                     15460099
158700                 PV-END-POS                                       15470099
158800                 PV-PRODUCT-NAME                                  15480099
158900                 PV-CALENDAR-NAME                                 15490099
159000                 PV-ORGANIZATION-NAME                             15500099
159100     COMPUTE PV-GCCHN-SEQNO = PV-GCCHN-SEQNO + 1                  15510099
159200     MOVE PV-GCCHN-SEQNO    TO PV-SEQ-NO                          15520099
159300     MOVE PV-SEQ-NO         TO PV-SEQ-NO-TMP                      15530099
159400     MOVE PV-SEQ-NO-TMP     TO PV-SEQ9                            15540099
159500     MOVE PV-TRANS-ID-TMP   TO PV-TRANS-ID9                       15550099
159600                                                                  15560099
159700     INSPECT PV-SEQ-NO-TMP    TALLYING                            15570099
159800             PV-SPACE-CNT    FOR LEADING SPACES                   15580099
159900                                                                  15590099
160000     COMPUTE PV-START-POS = PV-SPACE-CNT  + 1                     15600099
160100     COMPUTE PV-END-POS   = 9 - PV-SPACE-CNT.                     15610099
160200                                                                  15620099
160300     MOVE   ZEROES                    TO PV-GREC-CST              15630099
160400     MOVE   PV-GOTH-ADJ-CST           TO PV-GOTH-CST              15640099
160500     MOVE   PV-PRODUCT-NAME9          TO PV-PRODUCT-NAME          15650099
160600     MOVE   PV-ORGANIZATION-NAME9     TO PV-ORGANIZATION-NAME     15660099
160700     STRING PV-TRANS-ID9(PV-STRT-TRN-POS:PV-END-TRN-POS) ','      15670099
160800            PV-SEQ9(PV-START-POS:PV-END-POS)        ','           15680099
160900            PV-PRODUCT-NAME(1:4)                    '_'           15690099
161000            PV-PRODUCT-NAME(5:2)                    ','           15700099
161100            PV-ORGANIZATION-NAME                    ','           15710099
161200            PV-CALENDAR-NAME9                       ','           15720099
161300            DELIMITED BY SPACE INTO PV-ACT-HDR-RECORD             15730099
161400      STRING PV-ACT-HDR-RECORD DELIMITED BY SPACE                 15740099
161500            PV-GREC-CST     DELIMITED BY SIZE      ','            15750099
161600            PV-GOTH-CST     DELIMITED BY SIZE                     15760099
161700                            INTO PV-ACT-OUT-RECORD                15770099
161800      PERFORM 9000-OTHINV-WRITE-PARA                              15780099
161900         THRU 9000-EXIT.                                          15790099
162000                                                                  15800099
162100     ADD  01                  TO  PV-OCCHN-WRITE-COUNT            15810099
162200                                                                  15820099
162300     PERFORM 1600-READ-OCCHN-IN                                   15830099
162400        THRU 1600-EXIT.                                           15840099
162500                                                                  15850099
162600 8900-EXIT.                                                       15860099
162700     EXIT.                                                        15870099
162800******************************************************************15880099
162900*   FORMAT THE  PKB_ACTUAL_INVBAL_BOP_CC/CT/DT/DC LEVELS          15890099
163000*                                                                 15900099
163100******************************************************************15910099
163200 8600-FORMAT-INVBAL-BOP-PARA.                                     15920099
163300                                                                  15930099
163400     INITIALIZE  PV-ACT-OUT-RECORD                                15940099
163500                 PV-SPACE-CNT                                     15950099
163600                 PV-START-POS                                     15960099
163700                 PV-END-POS                                       15970099
163800                 PV-PRODUCT-NAME                                  15980099
163900                 PV-CALENDAR-NAME                                 15990099
164000                 PV-ORG-NAME                                      16000099
164100     ADD 01                 TO PV-SEQ-NO                          16010099
164200     MOVE PV-SEQ-NO         TO PV-SEQ-NO-TMP                      16020099
164300     MOVE PV-SEQ-NO-TMP     TO BP150-SEQ7                         16030099
164400     MOVE PV-TRANS-ID-TMP   TO BP150-TRANS-ID7                    16040099
164500                                                                  16050099
164600     INSPECT PV-SEQ-NO-TMP    TALLYING                            16060099
164700             PV-SPACE-CNT    FOR LEADING SPACES                   16070099
164800                                                                  16080099
164900     COMPUTE PV-START-POS = PV-SPACE-CNT  + 1                     16090099
165000     COMPUTE PV-END-POS   = 9 - PV-SPACE-CNT                      16100099
165100                                                                  16110099
11752A* WRITE HEADER RECORD AS FIRST RECORD IN FILE                     16111099
11752A     IF PV-INVBAL-BOP-READ-COUNT = 1                              16112099
11752A        STRING 'TRANS_ID'          DELIMITED BY SIZE '|'          16113099
11752A               'PRODUCT_NAME'      DELIMITED BY SIZE '|'          16114099
11752A               'ORGANIZATION_NAME' DELIMITED BY SIZE '|'          16115099
11752A               'CALENDAR_NAME'     DELIMITED BY SIZE '|'          16116099
11752A               'TRANS_TYPE'        DELIMITED BY SIZE '|'          16116199
11752A               'BOP_CST'           DELIMITED BY SIZE              16117099
11752A                               INTO PV-ACT-OUT-RECORD             16118099
11752A        WRITE  MLT-INVBAL-BOP-OUT-RECORD FROM PV-ACT-OUT-RECORD   16119099
11752A        INITIALIZE PV-ACT-OUT-RECORD                              16119199
11752A     END-IF                                                       16119299
11752A                                                                  16119399
165200     IF BP150-CLASS-NBR7 = 'DP'                                   16120099
165300          STRING  'DPT' BP150-DEPARTMENT-NBR7                     16130099
165400                    DELIMITED BY SPACES                           16140099
165500             INTO PV-PRODUCT-NAME                                 16150099
165600     ELSE                                                         16160099
165700          STRING  'C' BP150-DEPARTMENT-NBR7 '_'                   16170099
165800             BP150-CLASS-NBR7       DELIMITED BY SPACES           16180099
165900             INTO PV-PRODUCT-NAME                                 16190099
166000     END-IF.                                                      16200099
166100     STRING        BP150-SEASON7    DELIMITED BY SPACE            16210099
166200                   BP150-YEAR7     'W'                            16220099
166300                   BP150-WEEK-NBR7  DELIMITED BY SPACES           16230099
166400             INTO PV-CALENDAR-NAME                                16240099
166500     IF BP150-ORGANIZATION-NAME7 = 'TOTALCO'                      16250099
166600        MOVE 'CO' TO PV-ORG-NAME                                  16260099
166700     ELSE                                                         16270099
166800        MOVE BP150-ORGANIZATION-NAME7 TO PV-ORG-NAME              16280099
166900     END-IF                                                       16290099
167000                                                                  16300099
167100     MOVE   BP150-BOP-CST TO PV-BOP-CST                           16310099
11752A*    MOVE   BP150-BOP-DLR TO PV-BOP-DLR                           16320099
11752A*    STRING BP150-TRANS-ID7(PV-STRT-TRN-POS:PV-END-TRN-POS) ','   16330099
11752A*           BP150-SEQ7(PV-START-POS:PV-END-POS)    ','            16340099
11752A*           PV-PRODUCT-NAME                     ','               16340199
11752A*           PV-ORG-NAME                            ','            16340299
11752A*           PV-CALENDAR-NAME                    ','               16340399
11752A*           DELIMITED BY SPACE INTO PV-ACT-HDR-RECORD             16340499
11752A     STRING PV-CURRENT-DATE (1:14)                 '|'            16341099
11752A            PV-PRODUCT-NAME                        '|'            16350099
11752A            PV-ORG-NAME                            '|'            16360099
11752A            PV-CALENDAR-NAME                       '|'            16370099
11752A                                                   '|'            16371099
11752A            DELIMITED BY SPACE INTO PV-ACT-HDR-RECORD             16380099
167900      STRING PV-ACT-HDR-RECORD DELIMITED BY SPACE                 16390099
11752A*           PV-BOP-CST      DELIMITED BY SIZE      ','            16400099
11752A*           PV-BOP-DLR      DELIMITED BY SIZE                     16400199
11752A            PV-BOP-CST      DELIMITED BY SIZE                     16401099
168200                               INTO PV-ACT-OUT-RECORD             16420099
11752A*    WRITE  MLT-INVBAL-BOP-OUT-RECORD FROM PV-ACT-OUT-RECORD.     16430099
11752A*    ADD  01                  TO  PV-INVBAL-BOP-WRITE-COUNT       16440099
C12018     INSPECT PV-ACT-OUT-RECORD REPLACING ALL                      16441099
C12018             '+00000000000.00000' BY '                  '         16441199
C12018     INITIALIZE PV-OUT-RECORD                                     16441299
C12018                PV-POS2                                           16441399
C12018     PERFORM VARYING PV-POS1 FROM 1 BY 1                          16441499
C12018        UNTIL PV-POS1 > 800                                       16441599
C12018        IF PV-ACT-OUT-RECORD (PV-POS1:1) NOT = SPACE              16441699
C12018           ADD     1 TO PV-POS2                                   16441799
C12018           MOVE PV-ACT-OUT-RECORD (PV-POS1:1)                     16441899
C12018             TO PV-OUT-RECORD (PV-POS2:1)                         16441999
C12018        END-IF                                                    16442099
C12018     END-PERFORM                                                  16442199
C12018     WRITE  MLT-INVBAL-BOP-OUT-RECORD FROM PV-OUT-RECORD.         16442299
C12018     ADD  01                  TO  PV-INVBAL-BOP-WRITE-COUNT.      16443099
168500                                                                  16450099
168600     PERFORM 1400-READ-INVBAL-BOP-IN                              16460099
168700        THRU 1400-EXIT.                                           16470099
168800 8600-EXIT.                                                       16480099
168900     EXIT.                                                        16490099
169000******************************************************************16500099
169100*   FORMAT THE  PKB_ACTUAL_INVBAL_EOP_CC/CT/DT/DC LEVELS          16510099
169200*                                                                 16520099
169300******************************************************************16530099
169400 8700-FORMAT-INVBAL-EOP-PARA.                                     16540099
169500                                                                  16550099
169600     INITIALIZE  PV-ACT-OUT-RECORD                                16560099
169700                 PV-SPACE-CNT                                     16570099
169800                 PV-START-POS                                     16580099
169900                 PV-END-POS                                       16590099
170000                 PV-PRODUCT-NAME                                  16600099
170100                 PV-CALENDAR-NAME                                 16610099
170200                 PV-ORG-NAME                                      16620099
170300     ADD 01                 TO PV-SEQ-NO                          16630099
170400     MOVE PV-SEQ-NO         TO PV-SEQ-NO-TMP                      16640099
170500     MOVE PV-SEQ-NO-TMP     TO BP150-SEQ8                         16650099
170600     MOVE PV-TRANS-ID-TMP   TO BP150-TRANS-ID8                    16660099
170700                                                                  16670099
170800     INSPECT PV-SEQ-NO-TMP    TALLYING                            16680099
170900             PV-SPACE-CNT    FOR LEADING SPACES                   16690099
171000                                                                  16700099
171100     COMPUTE PV-START-POS = PV-SPACE-CNT  + 1                     16710099
171200     COMPUTE PV-END-POS   = 9 - PV-SPACE-CNT                      16720099
171300                                                                  16730099
11752A* WRITE HEADER RECORD AS FIRST RECORD IN FILE                     16731099
11752A     IF PV-INVBAL-EOP-READ-COUNT = 1                              16732099
11752A        STRING 'TRANS_ID'          DELIMITED BY SIZE '|'          16733099
11752A               'PRODUCT_NAME'      DELIMITED BY SIZE '|'          16734099
11752A               'ORGANIZATION_NAME' DELIMITED BY SIZE '|'          16735099
11752A               'CALENDAR_NAME'     DELIMITED BY SIZE '|'          16736099
11752A               'TRANS_TYPE'        DELIMITED BY SIZE '|'          16737099
11752A               'EOP_CST'           DELIMITED BY SIZE '|'          16738099
11752A               'EOP_RTL'           DELIMITED BY SIZE '|'          16739099
11752A               'EOP_UNT'           DELIMITED BY SIZE '|'          16739199
11752A               'SLS_UNT'           DELIMITED BY SIZE '|'          16739299
11752A               'SLSCLR_RTL'        DELIMITED BY SIZE              16739399
11752A                               INTO PV-ACT-OUT-RECORD             16739499
11752A        WRITE  MLT-INVBAL-EOP-OUT-RECORD FROM PV-ACT-OUT-RECORD   16739599
11752A        INITIALIZE PV-ACT-OUT-RECORD                              16739699
11752A     END-IF                                                       16739799
11752A                                                                  16739899
171400     IF BP150-CLASS-NBR8 = 'DP'                                   16740099
171500          STRING  'DPT' BP150-DEPARTMENT-NBR8                     16750099
171600                    DELIMITED BY SPACES                           16760099
171700             INTO PV-PRODUCT-NAME                                 16770099
171800     ELSE                                                         16780099
171900          STRING  'C' BP150-DEPARTMENT-NBR8 '_'                   16790099
172000             BP150-CLASS-NBR8       DELIMITED BY SPACES           16800099
172100             INTO PV-PRODUCT-NAME                                 16810099
172200     END-IF.                                                      16820099
172300     IF BP150-ORGANIZATION-NAME8 = 'TOTALCO'                      16830099
172400        MOVE 'CO' TO PV-ORG-NAME                                  16840099
172500     ELSE                                                         16850099
172600        MOVE BP150-ORGANIZATION-NAME8 TO PV-ORG-NAME              16860099
172700     END-IF                                                       16870099
172800     STRING        BP150-SEASON8    DELIMITED BY SPACE            16880099
172900                   BP150-YEAR8     'W'                            16890099
173000                   BP150-WEEK-NBR8  DELIMITED BY SPACES           16900099
173100             INTO PV-CALENDAR-NAME                                16910099
173200                                                                  16920099
173300     MOVE   BP150-EOP-CST TO PV-EOP-CST                           16930099
173400     MOVE   BP150-EOP-DLR TO PV-EOP-DLR                           16940099
173500     MOVE   BP150-EOP-UNT TO PV-EOP-UNT                           16950099
11752A     MOVE   BP150-SLS-UNT TO PV-SLS-UNT                           16951099
11752A     MOVE   BP150-SLS-CLR-RTL TO PV-SLSCLR-DLR                    16952099
11752A*    STRING BP150-TRANS-ID8(PV-STRT-TRN-POS:PV-END-TRN-POS) ','   16960099
11752A*           BP150-SEQ8(PV-START-POS:PV-END-POS)    ','            16970099
11752A*           PV-PRODUCT-NAME                     ','               16980099
11752A*           PV-ORG-NAME                            ','            16990099
11752A*           PV-CALENDAR-NAME                    ','               17000099
11752A*           DELIMITED BY SPACE INTO PV-ACT-HDR-RECORD             17010099
11752A     STRING PV-CURRENT-DATE (1:14)                 '|'            17011099
11752A            PV-PRODUCT-NAME                        '|'            17013099
11752A            PV-ORG-NAME                            '|'            17014099
11752A            PV-CALENDAR-NAME                       '|'            17015099
11752A                                                   '|'            17015199
11752A            DELIMITED BY SPACE INTO PV-ACT-HDR-RECORD             17016099
174200      STRING PV-ACT-HDR-RECORD DELIMITED BY SPACE                 17020099
11752A*           PV-EOP-CST      DELIMITED BY SIZE      ','            17030099
11752A*           PV-EOP-DLR      DELIMITED BY SIZE      ','            17040099
11752A            PV-EOP-CST      DELIMITED BY SIZE      '|'            17041099
11752A            PV-EOP-DLR      DELIMITED BY SIZE      '|'            17042099
11752A            PV-EOP-UNT      DELIMITED BY SIZE      '|'            17050099
11752A            PV-SLS-UNT      DELIMITED BY SIZE      '|'            17051099
11752A            PV-SLSCLR-DLR   DELIMITED BY SIZE                     17052099
174600                               INTO PV-ACT-OUT-RECORD             17060099
11752A*    WRITE  MLT-INVBAL-EOP-OUT-RECORD FROM PV-ACT-OUT-RECORD.     17070099
11752A*    ADD  01                  TO  PV-INVBAL-EOP-WRITE-COUNT       17080099
C12018     INSPECT PV-ACT-OUT-RECORD REPLACING ALL                      17083399
C12018             '+00000000000.00000' BY '                  '         17083499
C12018     INITIALIZE PV-OUT-RECORD                                     17083599
C12018                PV-POS2                                           17083699
C12018     PERFORM VARYING PV-POS1 FROM 1 BY 1                          17083799
C12018        UNTIL PV-POS1 > 800                                       17083899
C12018        IF PV-ACT-OUT-RECORD (PV-POS1:1) NOT = SPACE              17083999
C12018           ADD     1 TO PV-POS2                                   17084099
C12018           MOVE PV-ACT-OUT-RECORD (PV-POS1:1)                     17084199
C12018             TO PV-OUT-RECORD (PV-POS2:1)                         17084299
C12018        END-IF                                                    17084399
C12018     END-PERFORM                                                  17084499
C12018     WRITE  MLT-INVBAL-EOP-OUT-RECORD FROM PV-OUT-RECORD.         17084599
C12018     ADD  01                  TO  PV-INVBAL-EOP-WRITE-COUNT.      17084699
174900                                                                  17090099
175000     PERFORM 1500-READ-INVBAL-EOP-IN                              17100099
175100        THRU 1500-EXIT.                                           17110099
175200 8700-EXIT.                                                       17120099
175300     EXIT.                                                        17130099
175400******************************************************************17140099
175500*   READ THE PKB_ACTUAL_SALES   FILE                              17150099
175600******************************************************************17160099
175700 1010-READ-SALES-IN.                                              17170099
175800                                                                  17180099
175900     INITIALIZE BP150-ACTUAL-SALES.                               17190099
176000     READ MLT-SALES-IN-FILE  INTO BP150-ACTUAL-SALES              17200099
176100        AT END                                                    17210099
176200           SET PS-SALES-FILE-DONE  TO TRUE                        17220099
176300        NOT AT END                                                17230017
176400            ADD  01                TO  PV-SALES-READ-COUNT.       17240017
176500 1010-EXIT.                                                       17250017
176600     EXIT.                                                        17260017
176700******************************************************************17270017
176800*   READ  THE PKB_ACTUAL_SALES_LY FILE                            17280017
176900******************************************************************17290017
177000 1020-READ-SALES-LY-IN.                                           17300017
177100                                                                  17310017
177200     INITIALIZE BP150-ACTUAL-SALES-LY                             17320017
177300     READ MLT-SALES-LY-IN-FILE INTO BP150-ACTUAL-SALES-LY         17330017
177400        AT END                                                    17340017
177500           SET PS-SALES-LY-FILE-DONE TO TRUE                      17350017
177600        NOT AT END                                                17360017
177700            ADD  01              TO  PV-SALES-LY-READ-COUNT.      17370017
177800 1020-EXIT.                                                       17380017
177900     EXIT.                                                        17390017
178000******************************************************************17400017
178100*   READ THE PKB_ACTUAL_RECEIPTS   FILE                           17410017
178200******************************************************************17420017
178300 1030-READ-RECEIPT-IN.                                            17430017
178400                                                                  17440017
178500     INITIALIZE BP150-ACTUAL-RECEIPTS                             17450017
178600     READ MLT-RECEIPT-IN-FILE INTO BP150-ACTUAL-RECEIPTS          17460017
178700        AT END                                                    17470017
178800           SET PS-RECEIPT-FILE-DONE TO TRUE                       17480017
178900        NOT AT END                                                17490017
179000            ADD  01                 TO  PV-RECEIPT-READ-COUNT.    17500017
179100 1030-EXIT.                                                       17510017
179200     EXIT.                                                        17520017
179300******************************************************************17530052
179400*   READ THE BV PKB_ACTUAL_MKDNS    FILE                          17540052
179500******************************************************************17550052
179600 1040-READ-MKDNS-BV-IN.                                           17560085
179700                                                                  17570052
179800     INITIALIZE BP150-ACTUAL-MKDNS-BV                             17580053
179900     READ MLT-MKDNS-BVIN-FILE INTO BP150-ACTUAL-MKDNS-BV          17590053
180000        AT END                                                    17600052
180100           SET PS-MKDNS-BVFILE-DONE TO TRUE                       17610053
180200        NOT AT END                                                17620052
180300            ADD  01           TO  PV-MKDNS-BVREAD-COUNT.          17630053
180400 1040-EXIT.                                                       17640085
180500     EXIT.                                                        17650052
180600******************************************************************17660053
180700*   READ THE BV PKB_ACTUAL_OTHINV   FILE                          17670053
180800******************************************************************17680053
180900 1050-READ-OTHINV-BV-IN.                                          17690085
181000                                                                  17700053
181100     INITIALIZE BP150-ACTUAL-OTHINV-BV                            17710053
181200     READ MLT-OTHINV-BVIN-FILE INTO BP150-ACTUAL-OTHINV-BV        17720053
181300        AT END                                                    17730053
181400           SET PS-OTHINV-BVFILE-DONE TO TRUE                      17740053
181500        NOT AT END                                                17750053
181600            ADD  01           TO  PV-OTHINV-BVREAD-COUNT.         17760053
181700 1050-EXIT.                                                       17770085
181800     EXIT.                                                        17780053
181900******************************************************************17790066
182000*   READ THE    GROSS RECEIPT DEPT CHANNEL LEVEL                  17800066
182100******************************************************************17810066
182200 1070-READ-GDCHN-IN.                                              17820066
182300     INITIALIZE PV-ACTUAL-GREC-TWKPOSS.                           17830092
182400     READ MLT-GDCHN-IN-FILE INTO PV-ACTUAL-GREC-TWKPOSS           17840092
182500        AT END                                                    17850066
182600           SET PS-GDCHN-FILE-DONE TO TRUE                         17860067
182700        NOT AT END                                                17870066
182800            ADD  01           TO  PV-GDCHN-READ-COUNT.            17880067
182900 1070-EXIT.                                                       17890066
183000     EXIT.                                                        17900066
183100******************************************************************17910067
183200*   READ THE    GROSS RECEIPT DEPT TOTALCO LEVEL                  17920067
183300******************************************************************17930067
183400 1080-READ-GDTOT-IN.                                              17940067
183500     INITIALIZE PV-ACTUAL-GREC-TWKPOSS.                           17950092
183600     READ MLT-GDTOT-IN-FILE INTO PV-ACTUAL-GREC-TWKPOSS           17960092
183700        AT END                                                    17970067
183800           SET PS-GDTOT-FILE-DONE TO TRUE                         17980067
183900        NOT AT END                                                17990067
184000            ADD  01           TO  PV-GDTOT-READ-COUNT.            18000067
184100 1080-EXIT.                                                       18010067
184200     EXIT.                                                        18020067
184300******************************************************************18030067
184400*   READ THE    GROSS RECEIPT CLASS TOTALCO LEVEL                 18040067
184500******************************************************************18050067
184600 1090-READ-GCTOT-IN.                                              18060099
184700                                                                  18070067
184800     INITIALIZE PV-ACTUAL-GREC-TWKPOSS.                           18080092
184900     READ MLT-GCTOT-IN-FILE INTO PV-ACTUAL-GREC-TWKPOSS           18090092
185000        AT END                                                    18100067
185100           SET PS-GCTOT-FILE-DONE TO TRUE                         18110067
185200        NOT AT END                                                18120067
185300            ADD  01           TO  PV-GCTOT-READ-COUNT.            18130067
185400 1090-EXIT.                                                       18140099
185500     EXIT.                                                        18150067
185600******************************************************************18160099
185700*   READ THE    GROSS RECEIPT CLASS CHANNEL LEVEL                 18170099
185800******************************************************************18180099
185900 1060-READ-GCCHN-IN.                                              18190099
186000                                                                  18200099
186100     INITIALIZE PV-ACTUAL-GREC-TWKPOSS.                           18210099
186200     READ MLT-GCCHN-IN-FILE INTO PV-ACTUAL-GREC-TWKPOSS           18220099
186300        AT END                                                    18230099
186400           SET PS-GCCHN-FILE-DONE TO TRUE                         18240099
186500        NOT AT END                                                18250099
186600            ADD  01           TO  PV-GCCHN-READ-COUNT.            18260099
186700 1060-EXIT.                                                       18270099
186800     EXIT.                                                        18280099
186900******************************************************************18290067
187000*   READ THE    GROSS OTHINV  DEPT CHANNEL  LEVEL                 18300067
187100******************************************************************18310067
187200 1100-READ-ODCHN-IN.                                              18320099
187300                                                                  18330067
187400     INITIALIZE PV-ACTUAL-GOTH-BPK350.                            18340099
187500     READ MLT-ODCHN-IN-FILE INTO PV-ACTUAL-GOTH-BPK350            18350099
187600        AT END                                                    18360067
187700           SET PS-ODCHN-FILE-DONE TO TRUE                         18370067
187800        NOT AT END                                                18380067
187900            ADD  01           TO  PV-ODCHN-READ-COUNT.            18390067
188000 1100-EXIT.                                                       18400099
188100     EXIT.                                                        18410067
188200******************************************************************18420067
188300*   READ THE    GROSS OTHINV DEPT CTOTALCO  LEVEL                 18430067
188400******************************************************************18440067
188500 1200-READ-ODTOT-IN.                                              18450099
188600                                                                  18460067
188700     INITIALIZE PV-ACTUAL-GOTH-BPK350.                            18470099
188800     READ MLT-ODTOT-IN-FILE INTO PV-ACTUAL-GOTH-BPK350            18480099
188900        AT END                                                    18490067
189000           SET PS-ODTOT-FILE-DONE TO TRUE                         18500067
189100        NOT AT END                                                18510067
189200            ADD  01           TO  PV-ODTOT-READ-COUNT.            18520067
189300 1200-EXIT.                                                       18530099
189400     EXIT.                                                        18540067
189500******************************************************************18550067
189600*   READ THE    GROSS OTHINV CLAS TOTALCO   LEVEL                 18560067
189700******************************************************************18570067
189800 1300-READ-OCTOT-IN.                                              18580099
189900                                                                  18590067
190000     INITIALIZE PV-ACTUAL-GOTH-BPK350                             18600099
190100     READ MLT-OCTOT-IN-FILE INTO PV-ACTUAL-GOTH-BPK350            18610099
190200        AT END                                                    18620067
190300           SET PS-OCTOT-FILE-DONE TO TRUE                         18630067
190400        NOT AT END                                                18640067
190500            ADD  01           TO  PV-OCTOT-READ-COUNT.            18650067
190600 1300-EXIT.                                                       18660099
190700     EXIT.                                                        18670067
190800******************************************************************18680099
190900*   READ THE    GROSS OTHINV CLASS CHANNEL  LEVEL                 18690099
191000******************************************************************18700099
191100 1600-READ-OCCHN-IN.                                              18710099
191200                                                                  18720099
191300     INITIALIZE PV-ACTUAL-GOTH-BPK350                             18730099
191400     READ MLT-OCCHN-IN-FILE INTO PV-ACTUAL-GOTH-BPK350            18740099
191500        AT END                                                    18750099
191600           SET PS-OCCHN-FILE-DONE TO TRUE                         18760099
191700        NOT AT END                                                18770099
191800            ADD  01           TO  PV-OCCHN-READ-COUNT.            18780099
191900 1600-EXIT.                                                       18790099
192000     EXIT.                                                        18800099
192100******************************************************************18810099
192200*   READ THE    INVBAL BOP FILE                                   18820099
192300******************************************************************18830099
192400 1400-READ-INVBAL-BOP-IN.                                         18840099
192500                                                                  18850099
192600     INITIALIZE BP150-ACTUAL-INVBAL-BOP-CT                        18860099
192700     READ MLT-INVBAL-BOP-IN-FILE INTO                             18870099
192800                                BP150-ACTUAL-INVBAL-BOP-CT        18880099
192900        AT END                                                    18890099
193000           SET PS-INVBAL-BOP-FILE-DONE TO TRUE                    18900099
193100        NOT AT END                                                18910099
193200            ADD  01           TO  PV-INVBAL-BOP-READ-COUNT.       18920099
193300 1400-EXIT.                                                       18930099
193400     EXIT.                                                        18940099
193500******************************************************************18950099
193600*   READ THE    INVBAL EOP FILE                                   18960099
193700******************************************************************18970099
193800 1500-READ-INVBAL-EOP-IN.                                         18980099
193900                                                                  18990099
194000     INITIALIZE BP150-ACTUAL-INVBAL-EOP-CT                        19000099
194100     READ MLT-INVBAL-EOP-IN-FILE INTO                             19010099
194200                                BP150-ACTUAL-INVBAL-EOP-CT        19020099
194300        AT END                                                    19030099
194400           SET PS-INVBAL-EOP-FILE-DONE TO TRUE                    19040099
194500        NOT AT END                                                19050099
194600            ADD  01           TO  PV-INVBAL-EOP-READ-COUNT.       19060099
194700 1500-EXIT.                                                       19070099
194800     EXIT.                                                        19080099
194900******************************************************************19090099
195000*   1.READ TRANSACTION ID FILE                                    19100067
195100*   2.GENERATE THE CURRENT RUN TRANSACTION ID AND WRITE INTO      19110017
195200*     THE TRANSACTION FILE.                                       19120017
195300******************************************************************19130017
195400 1800-READ-TRANS-IN.                                              19140099
195500                                                                  19150017
195600     INITIALIZE PV-TRANS-ID                                       19160017
195700     READ TRANS-IN-FILE INTO PV-TRANS-REC                         19170017
195800        AT END                                                    19180017
195900           SET PS-TRANS-FILE-DONE  TO TRUE                        19190017
196000        NOT AT END                                                19200017
196100           ADD 01                  TO   PV-TRANS-ID               19210017
196200           WRITE TRANS-OUT-RECORD  FROM PV-TRANS-REC              19220017
196300           MOVE PV-TRANS-ID        TO PV-TRANS-ID-TMP             19230017
196400           INSPECT PV-TRANS-ID-TMP  TALLYING                      19240017
196500                   PV-SPACE-CNT    FOR LEADING SPACES             19250017
196600                                                                  19260017
196700           COMPUTE PV-STRT-TRN-POS = PV-SPACE-CNT  + 1            19270017
196800           COMPUTE PV-END-TRN-POS  = 9 - PV-SPACE-CNT.            19280017
196900                                                                  19290017
197000 1800-EXIT.                                                       19300099
197100     EXIT.                                                        19310017
197200******************************************************************19320085
197300*  9000 WRITE OUTPUT INTO OTHINV-CC,DC,DT,CT LEVELS               19330085
197400                                                                  19340086
197500 9000-OTHINV-WRITE-PARA.                                          19350085
197600*                                                                 19360085
197700       IF PV-PRODUCT-NAME(1:3) = 'DPT'                            19370085
197800          IF PV-ORGANIZATION-NAME  = 'CO'                         19380099
197900             WRITE  MLT-GDTOT-OUT-RECORD                          19390085
198000                      FROM PV-ACT-OUT-RECORD                      19400085
198100          ELSE                                                    19410085
198200             WRITE  MLT-GDCHN-OUT-RECORD                          19420085
198300                      FROM PV-ACT-OUT-RECORD                      19430085
198400          END-IF                                                  19440085
198500       ELSE IF PV-PRODUCT-NAME(1:1) = 'C'                         19450085
198600          IF PV-ORGANIZATION-NAME  = 'CO'                         19460099
198700             WRITE  MLT-GCTOT-OUT-RECORD                          19470085
198800                      FROM PV-ACT-OUT-RECORD                      19480085
198900          ELSE                                                    19490099
199000             WRITE  MLT-GCCHN-OUT-RECORD                          19500099
199100                      FROM PV-ACT-OUT-RECORD                      19510099
199200          END-IF                                                  19520085
199300         END-IF                                                   19530099
199400       END-IF.                                                    19540085
199500*                                                                 19550085
199600 9000-EXIT.                                                       19560085
199700     EXIT.                                                        19570085
199800******************************************************************19580085
199900* SEQUENCE NO CALCULATION PARA                                    19590086
200000******************************************************************19600086
200100 9100-SEQNO-CALC-PARA.                                            19610086
200200*                                                                 19620086
200300     EVALUATE TRUE                                                19630086
200400        WHEN PS-GDCHN-FILE                                        19640086
200500            MOVE PV-GDCHN-SEQNO TO PV-SEQ-NO                      19650090
200600        WHEN PS-GDTOT-FILE                                        19660086
200700            MOVE PV-GDTOT-SEQNO TO PV-SEQ-NO                      19670090
200800        WHEN PS-GCCHN-FILE                                        19680086
200900            MOVE PV-GCCHN-SEQNO TO PV-SEQ-NO                      19690090
201000        WHEN PS-GCTOT-FILE                                        19700086
201100            MOVE PV-GCTOT-SEQNO TO PV-SEQ-NO                      19710090
201200        WHEN PS-ODCHN-FILE                                        19720086
201300            MOVE PV-ODCHN-SEQNO TO PV-SEQ-NO                      19730090
201400        WHEN PS-ODTOT-FILE                                        19740086
201500            MOVE PV-ODTOT-SEQNO TO PV-SEQ-NO                      19750090
201600        WHEN PS-OCCHN-FILE                                        19760086
201700            MOVE PV-OCCHN-SEQNO TO PV-SEQ-NO                      19770090
201800        WHEN PS-OCTOT-FILE                                        19780086
201900            MOVE PV-OCTOT-SEQNO TO PV-SEQ-NO                      19790090
202000        WHEN OTHER                                                19800086
202100            DISPLAY 'UNKNOWN INPUT FILE'                          19810086
202200     END-EVALUATE                                                 19820086
202300     MOVE PV-SEQ-NO         TO PV-SEQ-NO-TMP                      19830086
202400     MOVE PV-SEQ-NO-TMP     TO BP150-SEQ3                         19840086
202500                               PV-SEQ9                            19850086
202600                               PV-SEQ10                           19860092
202700     MOVE PV-TRANS-ID-TMP   TO BP150-TRANS-ID3                    19870092
202800                               PV-TRANS-ID9                       19880092
202900                               PV-TRANS-ID10                      19890092
203000                                                                  19900092
203100     INSPECT PV-SEQ-NO-TMP    TALLYING                            19910092
203200             PV-SPACE-CNT    FOR LEADING SPACES                   19920092
203300                                                                  19930092
203400     COMPUTE PV-START-POS = PV-SPACE-CNT  + 1                     19940092
203500     COMPUTE PV-END-POS   = 9 - PV-SPACE-CNT.                     19950092
203600*                                                                 19960092
203700 9100-EXIT.                                                       19970092
203800     EXIT.                                                        19980092
203900******************************************************************19990086
204000*  CLOSE ALL OPEN FILES.                                          20000017
204100******************************************************************20010017
204200 9999-END-OF-JOB.                                                 20020085
204300                                                                  20030017
204400     CLOSE MLT-INVBAL-BOP-IN-FILE                                 20044099
204500           MLT-INVBAL-EOP-IN-FILE                                 20050099
204600           MLT-SALES-LY-IN-FILE                                   20060017
204700           MLT-SALES-IN-FILE                                      20070017
204800           MLT-RECEIPT-IN-FILE                                    20080017
204900           MLT-MKDNS-BVIN-FILE                                    20090054
205000           MLT-OTHINV-BVIN-FILE                                   20100054
205100           MLT-INVBAL-BOP-OUT-FILE                                20110099
205200           MLT-INVBAL-EOP-OUT-FILE                                20120099
205300           MLT-GDCHN-IN-FILE                                      20130067
205400           MLT-GDTOT-IN-FILE                                      20140067
205500           MLT-GCTOT-IN-FILE                                      20150067
205600           MLT-GCCHN-IN-FILE                                      20160099
205700           MLT-ODCHN-IN-FILE                                      20170067
205800           MLT-ODTOT-IN-FILE                                      20180067
205900           MLT-OCTOT-IN-FILE                                      20190067
206000           MLT-OCCHN-IN-FILE                                      20200099
206100           TRANS-IN-FILE                                          20210017
206200           MLT-SALES-LY-OUT-FILE                                  20220017
206300           MLT-SALES-OUT-FILE                                     20230017
206400           MLT-RECEIPT-OUT-FILE                                   20240017
206500           MLT-MKDNS-BVOUT-FILE                                   20250054
206600           MLT-OTHINV-BVOUT-FILE                                  20260054
206700           MLT-GDCHN-OUT-FILE                                     20270067
206800           MLT-GDTOT-OUT-FILE                                     20280067
206900           MLT-GCTOT-OUT-FILE                                     20290067
207000           MLT-GCCHN-OUT-FILE                                     20300099
207100           TRANS-OUT-FILE.                                        20310099
207200                                                                  20320017
207300     DISPLAY ' '.                                                 20330017
207400     DISPLAY '****************************************'.          20340017
207500     DISPLAY '   BPKUT154 OUTPUT REC COUNTS:'.                    20350099
207600     DISPLAY ' '.                                                 20360017
207700     DISPLAY ' SALES READ  COUNT    :' PV-SALES-READ-COUNT.       20370054
207800     DISPLAY ' SALES WRITE COUNT    :' PV-SALES-WRITE-COUNT.      20380054
207900     DISPLAY ' SALES-LY READ  COUNT  :' PV-SALES-LY-READ-COUNT.   20390054
208000     DISPLAY ' SALES-LY WRITE COUNT  :' PV-SALES-LY-WRITE-COUNT.  20400054
208100     DISPLAY ' RECEIPT READ  COUNT   :' PV-RECEIPT-READ-COUNT.    20410054
208200     DISPLAY ' RECEIPT WRITE COUNT   :' PV-RECEIPT-WRITE-COUNT.   20420054
208300     DISPLAY ' BV MKDNS READ COUNT :' PV-MKDNS-BVREAD-COUNT.      20430054
208400     DISPLAY ' BV MKDNS WRITE COUNT:' PV-MKDNS-BVWRITE-COUNT.     20440054
208500     DISPLAY ' BV OTHINV READ COUNT :' PV-OTHINV-BVREAD-COUNT.    20450054
208600     DISPLAY ' BV OTHINV WRITE COUNT:' PV-OTHINV-BVWRITE-COUNT.   20460054
208700     DISPLAY ' INVBAL BOP READ COUNT  :'                          20470099
208800                                 PV-INVBAL-BOP-READ-COUNT.        20480099
208900     DISPLAY ' INVBAL BOP WRITE COUNT :'                          20490099
209000                                 PV-INVBAL-BOP-WRITE-COUNT.       20500099
209100     DISPLAY ' INVBAL EOP READ COUNT  :'                          20510099
209200                                 PV-INVBAL-EOP-READ-COUNT.        20520099
209300     DISPLAY ' INVBAL EOP WRITE COUNT :'                          20530099
209400                                 PV-INVBAL-EOP-WRITE-COUNT.       20540099
209500     DISPLAY ' OTHINV GDC READ COUNT  :' PV-GDCHN-READ-COUNT.     20550088
209600     DISPLAY ' OTHINV GDC WRITE COUNT :' PV-GDCHN-WRITE-COUNT.    20560088
209700     DISPLAY ' OTHINV GDT READ COUNT  :' PV-GDTOT-READ-COUNT.     20570088
209800     DISPLAY ' OTHINV GDT WRITE COUNT :' PV-GDTOT-WRITE-COUNT.    20580088
209900     DISPLAY ' OTHINV GCT READ COUNT  :' PV-GCTOT-READ-COUNT.     20590088
210000     DISPLAY ' OTHINV GCT WRITE COUNT  :' PV-GCTOT-WRITE-COUNT.   20600088
210100     DISPLAY ' OTHINV GCC READ COUNT  :' PV-GCCHN-READ-COUNT.     20610099
210200     DISPLAY ' OTHINV GCC WRITE COUNT  :' PV-GCCHN-WRITE-COUNT.   20620099
210300     DISPLAY ' OTHINV ODC READ COUNT  :' PV-ODCHN-READ-COUNT.     20630088
210400     DISPLAY ' OTHINV ODC WRITE COUNT :' PV-ODCHN-WRITE-COUNT.    20640088
210500     DISPLAY ' OTHINV ODT READ COUNT  :' PV-ODTOT-READ-COUNT.     20650088
210600     DISPLAY ' OTHINV ODT WRITE COUNT :' PV-ODTOT-WRITE-COUNT.    20660088
210700     DISPLAY ' OTHINV OCT READ COUNT  :' PV-OCTOT-READ-COUNT.     20670088
210800     DISPLAY ' OTHINV OCT WRITE COUNT :' PV-OCTOT-WRITE-COUNT.    20680088
210900     DISPLAY ' OTHINV OCC READ COUNT  :' PV-OCCHN-READ-COUNT.     20690099
211000     DISPLAY ' OTHINV OCC WRITE COUNT :' PV-OCCHN-WRITE-COUNT.    20700099
211100     DISPLAY '****************************************'.          20710088
211200                                                                  20720017
