000100******************************************************************00010061
000200 IDENTIFICATION DIVISION.                                         00020061
000300******************************************************************00030061
000400                                                                  00040061
000500 PROGRAM-ID.             TMKUT007.                                00050061
000600 AUTHOR.                 RON KRIER.                               00060061
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070061
000800 DATE-WRITTEN            10-9-96.                                 00080061
000900 DATE-COMPILED.                                                   00090061
001000                                                                  00100061
001100*----------------------------------------------------------------*00110061
001200* THIS PROGRAM WILL TAKE IN AN EXTRACT FILE FROM THE TMKUT006    *00120061
001300* PROGRAM AND WILL SUMMARIZE THE RECORDS ASSOCIATED TO THE VENDOR*00130061
001400* REPORTING AREA BY VENDOR.  THIS WILL BE DONE FOR VENDOR RANKING*00140061
001500* FOR VARIOUS TROUBLE REPORTS.                                   *00150061
001600*----------------------------------------------------------------*00160061
001700                                                                  00170061
001800******************************************************************00180061
001900 ENVIRONMENT DIVISION.                                            00190061
002000******************************************************************00200061
002100                                                                  00210061
002200 CONFIGURATION SECTION.                                           00220061
002300                                                                  00230061
002400 SOURCE-COMPUTER.        IBM-3090.                                00240061
002500 OBJECT-COMPUTER.        IBM-3090.                                00250061
002600                                                                  00260061
002700 INPUT-OUTPUT SECTION.                                            00270061
002800                                                                  00280061
002900 FILE-CONTROL.                                                    00290061
003000                                                                  00300061
003100      SELECT EXTRACT-TRBL-FILE-IN       ASSIGN TO INP01.          00310061
003200                                                                  00320061
003300      SELECT EXTRACT-TRBL-FILE-OUT      ASSIGN TO OUT01.          00330061
003400                                                                  00340061
003500******************************************************************00350061
003600 DATA DIVISION.                                                   00360061
003700******************************************************************00370061
003800                                                                  00380061
003900 FILE SECTION.                                                    00390061
004000 FD  EXTRACT-TRBL-FILE-IN                                         00400061
004100     LABEL RECORDS ARE STANDARD                                   00410061
004200     BLOCK CONTAINS 0 RECORDS                                     00420061
004300     RECORDING MODE IS F                                          00430061
004400     RECORD CONTAINS 400 CHARACTERS                               00440061
004500     DATA RECORD IS TE-TRBL-EXTRACT-RCD-IN.                       00450061
004600                                                                  00460061
004700 01  TE-TRBL-EXTRACT-RCD-IN          PIC X(400).                  00470061
004800                                                                  00480061
004900                                                                  00490061
005000 FD  EXTRACT-TRBL-FILE-OUT                                        00500061
005100     LABEL RECORDS ARE STANDARD                                   00510061
005200     BLOCK CONTAINS 0 RECORDS                                     00520061
005300     RECORDING MODE IS F                                          00530061
005400     RECORD CONTAINS 400 CHARACTERS                               00540061
005500     DATA RECORD IS TE-TRBL-EXTRACT-RCD-OUT.                      00550061
005600                                                                  00560061
005700 01  TE-TRBL-EXTRACT-RCD-OUT         PIC X(400).                  00570061
005800*------------------------------------------------------*          00580061
005900 WORKING-STORAGE SECTION.                                         00590061
006000*------------------------------------------------------*          00600061
006100 01 PC-PROGRAM-CONSTANTS.                                         00610061
006200    05 PC-PROGRAM-NAME               PIC X(08) VALUE 'TMKUT007'.  00620061
006300    05 PC-DEFAULT-CC-DATE            PIC X(08) VALUE '99990909'.  00630061
006500    05 PC-99999                      PIC S9(5) VALUE +99999.      00640061
006600    05 PC-A                          PIC X(01) VALUE 'A'.         00650061
007500    05 PC-B                          PIC X(01) VALUE 'B'.         00660061
007520    05 PC-60                         PIC 9(02) VALUE 60.          00670061
008000                                                                  00680061
009600 01  WS-VENDOR-TOTAL-RECORD.                                      00690061
009700     05  VTR-RECORD-TYPE             PIC X(2)      VALUE 'AL'.    00700061
009810     05  VTR-SORT-FIELD              PIC X(25).                   00710061
009900     05  VTR-REPORT-DIVISION         PIC X(2)      VALUE 'LL'.    00720061
009910     05  VTR-REPORT-NOTIF-CDE        PIC X(1).                    00730061
010000     05  FILLER                      PIC X(09)     VALUE SPACES.  00740061
010010     05  VTR-ENT-ID                  PIC S9(9)     COMP.          00750061
010020     05  VTR-ENT-NAME-DESC           PIC X(30).                   00760061
010030     05  VTR-ASSIGN-TOT-QTY          PIC S9(7)     COMP-3.        00770061
010040     05  VTR-RESOLVED-HOURS          PIC S9(5)     COMP-3.        00780061
010050     05  VTR-RESOLVED-MINUTES        PIC S9(3)     COMP-3.        00790061
010050     05  VTR-RCVRS-VRFYD-QTY         PIC S9(9)     COMP-3.        00800061
010050     05  VTR-VRFYD-TRBL-QTY          PIC S9(9)     COMP-3.        00810061
010060     05  FILLER                      PIC X(308).                  00820061
008000                                                                  00830061
008000***************************************************************** 00840061
008000* WHEN CREATING 'AL' RECORDS FOR TMKRP012, YOU MUST SET UP AND  * 00850061
008000* MOVE WS-TMKRP012-SORTFIELD TO VTR-SORT-FIELD BEFORE WRITING   * 00860061
008000***************************************************************** 00870061
009600 01  WS-TMKRP012-SORTFIELD.                                       00880061
009810     05  VTR-SORT-FIELD-HOLD.                                     00890061
009820         10  FILLER                  PIC X(02)     VALUE '04'.    00900061
009830         10  VTR-SF-TRBL-QTY         PIC 9(5).                    00910061
009840         10  VTR-SF-VND-NBR          PIC 9(9).                    00920061
009850         10  FILLER                  PIC X(09).                   00930061
008000                                                                  00940061
008000***************************************************************** 00950061
008000* BEFORE WRITING OUT  THE 'AA' RECORD AND WHEN CREATING THE 'AL'* 00960061
008000*        RECORDS FOR TMKRP015, YOU MUST SET UP AND MOVE         * 00970061
008000* WS-TMKRP015-SORTFIELD TO VHR-SORT-FIELD BEFORE WRITING THE'AA'* 00980061
008000* AND WS-TMKRP015-SORTFIELD TO VDTL-SORT-FIELD BEFORE WRITING   * 00990061
008000* THE 'AL' RECORDS                                              * 01000061
008000***************************************************************** 01010061
009600 01  WS-TMKRP015-SORTFIELD.                                       01020061
009810     05  VDTL-SORT-FIELD-HOLD.                                    01030061
009830         10  VDTL-SF-ENT-ID          PIC S9(09) COMP   VALUE 0.   01040061
009840         10  VDTL-SF-DEPT-NBR        PIC  X(03) VALUE  ZEROS.     01050061
009840         10  VDTL-SF-TRBL-RSN        PIC S9(04) COMP   VALUE 0.   01060061
009840         10  VDTL-SF-NOTIF-CDE       PIC  X(01) VALUE  SPACES.    01070061
009850         10  FILLER                  PIC  X(15) VALUE SPACES.     01080061
008000                                                                  01090061
009600 01  WS-VDR-DEPT-RECORD.                                          01100061
009700******* HEADER                                                    01110061
009700     05  VDTL-RECORD-TYPE            PIC X(2)      VALUE 'BF'.    01120061
009810     05  VDTL-SORT-FIELD             PIC X(25)     VALUE SPACES.  01130061
009900     05  VDTL-REPORT-DIVISION        PIC X(2)      VALUE 'LL'.    01140061
009910     05  VDTL-REPORT-NOTIF-CDE       PIC X(1).                    01150061
010000     05  FILLER                      PIC X(09)     VALUE SPACES.  01160061
009700******* DETAIL                                                    01170061
010010     05  VDTL-ENT-ID                 PIC S9(9)     COMP.          01180061
010020     05  VDTL-ENT-NAME-DESC          PIC X(30).                   01181062
010020     05  VDTL-DEPT-NBR               PIC X(03).                   01190061
010020     05  VDTL-DEPT-DESCRIPTION       PIC X(32).                   01200061
010030     05  VDTL-ASSIGN-TOT-QTY         PIC S9(7)     COMP-3.        01210061
010040     05  VDTL-AVG-RESOLV-HRS         PIC S9(5)     COMP-3.        01220064
010050     05  VDTL-AVG-RESOLV-MINS        PIC S9(3)     COMP-3.        01230064
010050     05  VDTL-RCVRS-VRFYD-QTY        PIC S9(9)     COMP-3.        01240061
010050     05  VDTL-VRFYD-TRBL-QTY         PIC S9(9)     COMP-3.        01250061
010060     05  FILLER                      PIC X(273).                  01260062
010300                                                                  01270061
010400 01 PS-PROGRAM-SWITCHES.                                          01280061
010500    05 PS-END-OF-FILE-SW             PIC X(01)     VALUE SPACE.   01290061
010600       88 PS-EOF                                   VALUE 'Y'.     01300061
010700       88 PS-NOT-EOF                               VALUE 'N'.     01310061
011500    05 WS-FIRST-TIME-PROC-SW         PIC X(01)     VALUE 'Y'.     01320061
011600       88 WS-FIRST-TIME-PROC                       VALUE 'Y'.     01330061
011700       88 WS-NOT-FIRST-TIME-PROC                   VALUE 'N'.     01340061
011500    05 WS-FIRST-TIME-DEPT-SW         PIC X(01)     VALUE 'Y'.     01350061
011600       88 WS-FIRST-TIME-DEPT                       VALUE 'Y'.     01360061
011700       88 WS-NOT-FIRST-TIME-DEPT                   VALUE 'N'.     01370061
011800    05 WS-FIRST-OCCUR-SW             PIC X(01)     VALUE SPACE.   01380061
011900       88  WS-FIRST-OCCUR-FOUND                    VALUE 'Y'.     01390061
012000       88  WS-FIRST-OCCUR-NOT-FOUND                VALUE 'N'.     01400061
013000    05 WS-INCLUDE-TOTAL-SW           PIC X(01)     VALUE SPACE.   01410061
013100       88  WS-INCLUDE-IN-TOTAL                     VALUE 'Y'.     01420061
013200       88  WS-OMIT-IN-TOTAL                        VALUE 'N'.     01430061
013300    05 WS-PROCESS-RECORD-SW          PIC X(01)     VALUE SPACE.   01440061
013400       88  WS-PROCESS-RECORD                       VALUE 'Y'.     01450061
013500       88  WS-OMIT-RECORD                          VALUE 'N'.     01460061
013510    05 WS-DUPLICATE-KEY-SW           PIC X(01)     VALUE SPACE.   01470061
013520       88  WS-DUPLICATE-KEY                        VALUE 'Y'.     01480061
013530       88  WS-NOT-DUPLICATE-KEY                    VALUE 'N'.     01490061
013600                                                                  01500061
013700 01 WS-HOLD-ACCUMULATORS.                                         01510061
013701****** VENDOR TOTALS FOR 'AL' RECORD                              01520061
013800    05  WS-ASSIGN-TROUBLE-QTY        PIC S9(7)     COMP-3         01530061
013900                                                   VALUE ZEROS.   01540061
014000    05  WS-ASSIGN-NOTIFY-QTY         PIC S9(7)     COMP-3         01550061
014100                                                   VALUE ZEROS.   01560061
014200    05  WS-ASSIGN-TOT-QTY            PIC S9(7)     COMP-3         01570061
014300                                                   VALUE ZEROS.   01580061
014400    05  WS-RESOLVE-TROUBLE-MIN       PIC S9(9)     COMP-3         01590061
014500                                                   VALUE ZEROS.   01600061
014600    05  WS-RESOLVE-NOTIFY-MIN        PIC S9(9)     COMP-3         01610061
014700                                                   VALUE ZEROS.   01620061
014710    05  WS-RESOLVE-TOT-MIN           PIC S9(9)     COMP-3         01630061
014720                                                   VALUE ZEROS.   01640061
014721    05  WS-RESOLVE-TROUBLE-QTY       PIC S9(5)     COMP-3         01650061
014722                                                   VALUE ZEROS.   01660061
014723    05  WS-RESOLVE-NOTIFY-QTY        PIC S9(5)     COMP-3         01670061
014724                                                   VALUE ZEROS.   01680061
014725    05  WS-RESOLVE-TOT-QTY           PIC S9(5)     COMP-3         01690061
014726                                                   VALUE ZEROS.   01700061
014730    05  WS-HOLD-MINUTES              PIC S9(9)     COMP-3         01710061
014740                                                   VALUE ZEROS.   01720061
014741    05  WS-AVG-MINUTES               PIC S9(9)     COMP-3         01730061
014742                                                   VALUE ZEROS.   01740061
014750    05  WS-HOLD-QUANTITY             PIC S9(5)     COMP-3         01750061
014760                                                   VALUE ZEROS.   01760061
014760****** VENDOR/DEPT TOTALS FOR 'BF' RECORD                         01770061
013800    05  WS-ASSIGN-TROUBLE-QTY-VDPT   PIC S9(7)     COMP-3         01780061
013900                                                   VALUE ZEROS.   01790061
014000    05  WS-ASSIGN-NOTIFY-QTY-VDPT    PIC S9(7)     COMP-3         01800061
014100                                                   VALUE ZEROS.   01810061
014200    05  WS-ASSIGN-TOT-QTY-VDPT       PIC S9(7)     COMP-3         01820061
014300                                                   VALUE ZEROS.   01830061
014400    05  WS-RESOLVE-TROUBLE-MIN-VDPT  PIC S9(9)     COMP-3         01840061
014500                                                   VALUE ZEROS.   01850061
014600    05  WS-RESOLVE-NOTIFY-MIN-VDPT   PIC S9(9)     COMP-3         01860061
014700                                                   VALUE ZEROS.   01870061
014710    05  WS-RESOLVE-TOT-MIN-VDPT      PIC S9(9)     COMP-3         01880061
014720                                                   VALUE ZEROS.   01890061
014721    05  WS-RESOLVE-TROUBLE-QTY-VDPT  PIC S9(5)     COMP-3         01900061
014722                                                   VALUE ZEROS.   01910061
014723    05  WS-RESOLVE-NOTIFY-QTY-VDPT   PIC S9(5)     COMP-3         01920061
014724                                                   VALUE ZEROS.   01930061
014725    05  WS-RESOLVE-TOT-QTY-VDPT      PIC S9(5)     COMP-3         01940061
014726                                                   VALUE ZEROS.   01950061
014760****** ASSORTED COUNTERS                                          01960061
014800    05  WS-RCD-READ-COUNT            PIC S9(7)     COMP-3         01970061
014900                                                   VALUE ZEROS.   01980061
015000    05  WS-RCD-BYPASS-COUNT          PIC S9(7)     COMP-3         01990061
015100                                                   VALUE ZEROS.   02000061
015200    05  WS-RCD-PROCESS-COUNT         PIC S9(7)     COMP-3         02010061
015300                                                   VALUE ZEROS.   02020061
015400    05  WS-RCD-DTL-WRITE-COUNT       PIC S9(7)     COMP-3         02030061
015500                                                   VALUE ZEROS.   02040061
015600    05  WS-RCD-VNDTOT-WRITE-COUNT    PIC S9(7)     COMP-3         02050061
015700                                                   VALUE ZEROS.   02060061
015600    05  WS-RCD-VNDDPT-WRITE-COUNT    PIC S9(7)     COMP-3         02070061
015700                                                   VALUE ZEROS.   02080061
015800                                                                  02090061
015900 01 WS-HOLD-FIELDS.                                               02100061
016000    05  WS-HOLD-ENT-ID               PIC S9(09)    COMP           02110061
016100                                                   VALUE ZEROS.   02120061
016200    05  WS-HOLD-ENT-NAME-DESC        PIC X(20)     VALUE SPACES.  02130061
016400                                                                  02140061
016500 01 PV-PROGRAM-VARIABLES.                                         02150061
016900    05  PV-PREV-ENT-ID               PIC S9(09)    COMP           02160061
017000                                                   VALUE ZEROS.   02170061
016900    05  PV-PREV-DEPT                 PIC  X(03)    VALUE SPACES.  02180061
016900    05  PV-PREV-DEPT-DESC            PIC  X(32)    VALUE SPACES.  02190061
017100    05  PV-CURR-KEY.                                              02200061
017200        10  PV-CURR-PO-NBR           PIC S9(09)    COMP           02210061
017300                                                   VALUE ZEROS.   02220061
017400        10  PV-CURR-REC-SEQ-NBR      PIC S9(09)    COMP           02230061
017500                                                   VALUE ZEROS.   02240061
017501        10  PV-CURR-REASON-CDE       PIC S9(04)    COMP           02250061
017502                                                   VALUE ZEROS.   02260061
017510        10  PV-CURR-NOTIF-DATE       PIC X(08)     VALUE SPACES.  02270061
017600                                                                  02280061
017700    05  PV-PREV-KEY.                                              02290061
017800        10  PV-PREV-PO-NBR           PIC S9(09)    COMP           02300061
017900                                                   VALUE ZEROS.   02310061
018000        10  PV-PREV-REC-SEQ-NBR      PIC S9(09)    COMP           02320061
018100                                                   VALUE ZEROS.   02330061
018101        10  PV-PREV-REASON-CDE       PIC S9(04)    COMP           02340061
018102                                                   VALUE ZEROS.   02350061
018110        10  PV-PREV-NOTIF-DATE       PIC X(08)     VALUE SPACES.  02360061
018200                                                                  02370061
018300    05  PV-RESOLVED-HOURS            PIC S9(07)    COMP-3         02380061
018400                                                   VALUE ZEROS.   02390061
018500    05  PV-RESOLVED-MINUTES          PIC S9(07)    COMP-3         02400061
018600                                                   VALUE ZEROS.   02410061
018900    05  PV-CALC-TEMP-QTY             PIC S9(05)    COMP-3         02420061
019000                                                   VALUE ZEROS.   02430061
019010    05  WS-CALC-MINUTES              PIC S9(09)    COMP-3         02440061
019020                                                   VALUE ZEROS.   02450061
023200    05 PV-BEG-DATE.                                               02460061
023300       10 PV-BEG-YYYY.                                            02470061
023400          15 PV-BEG-CC               PIC  9(02)    VALUE 0.       02480061
023500          15 PV-BEG-YY               PIC  9(02)    VALUE 0.       02490061
023600       10 PV-BEG-MM                  PIC  9(02)    VALUE 0.       02500061
023700       10 PV-BEG-DD                  PIC  9(02)    VALUE 0.       02510061
023800    05 PV-END-DATE.                                               02520061
023900       10 PV-END-YYYY.                                            02530061
024000          15 PV-END-CC               PIC  9(02)    VALUE 0.       02540061
024100          15 PV-END-YY               PIC  9(02)    VALUE 0.       02550061
024200       10 PV-END-MM                  PIC  9(02)    VALUE 0.       02560061
024300       10 PV-END-DD                  PIC  9(02)    VALUE 0.       02570061
028200                                                                  02580061
029400 01  CC-CONTROL-CARD-PARAMETERS.                                  02590061
029700     05  CC-PROCESS-INPUT-CDE        PIC X(01)     VALUE SPACE.   02600061
029800         88  CC-DO-NOT-WRITE-TO-OUTPUT             VALUE 'A'.     02610061
029900         88  CC-WRITE-ALL-NON-VEND-DETAIL          VALUE 'B'.     02620061
029910         88  CC-WRITE-ALL-TO-OUTPUT                VALUE 'C'.     02630061
030000     05  CC-TOTAL-TROUBLE-ASSIGN-CDE PIC X(01)     VALUE SPACE.   02640061
030100         88  CC-TOTAL-FOR-ALL-TRBL-ASSIGN          VALUE 'A'.     02650061
030200         88  CC-TOTAL-FOR-TRBL-NOTIFY              VALUE 'B'.     02660061
030300     05  CC-PROCESS-INCLUDE-CDE      PIC X(01)     VALUE SPACE.   02670061
030400         88  CC-INCLUDE-ASSIGN-ONLY                VALUE 'A'.     02680061
030500         88  CC-INCLUDE-RESOLVE-ONLY               VALUE 'R'.     02690061
030600         88  CC-INCLUDE-ASSIGN-RESOLVE             VALUE 'B'.     02700061
030700     05  CC-PROCESS-DUPLICATE-CDE    PIC X(01)     VALUE SPACE.   02710061
030800         88  CC-PROCESS-ALL                        VALUE 'A'.     02720061
030900         88  CC-BYPASS-DUPLICATES                  VALUE 'B'.     02730061
030910     05  CC-NOTIF-DATE-USAGE-CDE     PIC X(01)     VALUE SPACE.   02740061
030920         88  CC-USE-NOTIF-DATE-IN-COMP             VALUE 'Y'.     02750061
030930         88  CC-DO-NOT-USE-NOTIF-DATE              VALUE 'N'.     02760061
030910     05  CC-DEPT-PROCESS-CDE         PIC X(01)     VALUE SPACE.   02770061
030920         88  CC-CREATE-VNDDEPT-TOT                 VALUE 'Y'.     02780061
030930         88  CC-DO-NOT-CREATE-VNDDEPT-TOT          VALUE SPACE.   02790061
031000     05 FILLER                      PIC X(75)      VALUE SPACE.   02800061
031100                                                                  02810061
031200*** FILE LAYOUT AREA ****                                         02820061
031300     COPY TMRD001.                                                02830072
031400                                                                  02840061
033600 EJECT                                                            02850061
033700 PROCEDURE DIVISION.                                              02860061
033800                                                                  02870061
033900 0000-MAINLINE-PROCESSING.                                        02880061
034000                                                                  02890061
034100     PERFORM 1000-INITIALIZATION.                                 02900061
034200                                                                  02910061
034300     PERFORM 2000-MAIN-LOOP                                       02920061
034400         UNTIL PS-EOF.                                            02930061
034500                                                                  02940061
034600     PERFORM 9000-END-OF-PROGRAM.                                 02950061
034700                                                                  02960061
034800     STOP RUN.                                                    02970061
034900 EJECT                                                            02980061
035000 1000-INITIALIZATION.                                             02990061
035100                                                                  03000061
035200     ACCEPT CC-CONTROL-CARD-PARAMETERS FROM SYSIN.                03010061
035300                                                                  03020061
035400     OPEN INPUT  EXTRACT-TRBL-FILE-IN.                            03030061
035500     OPEN OUTPUT EXTRACT-TRBL-FILE-OUT.                           03040061
035600                                                                  03050061
035700     PERFORM 7000-READ-INPUT-FILE.                                03060061
035800                                                                  03070061
035900     IF  PS-EOF                                                   03080061
036000         NEXT SENTENCE                                            03090061
036100     ELSE                                                         03100061
036200         MOVE TM001-BEGIN-YYYY TO                                 03110061
036300              PV-BEG-YYYY                                         03120061
036400         MOVE TM001-BEGIN-MM TO                                   03130061
036500              PV-BEG-MM                                           03140061
036600         MOVE TM001-BEGIN-DD TO                                   03150061
036700              PV-BEG-DD                                           03160061
036800         MOVE TM001-END-YYYY TO                                   03170061
036900              PV-END-YYYY                                         03180061
037000         MOVE TM001-END-MM TO                                     03190061
037100              PV-END-MM                                           03200061
037200         MOVE TM001-END-DD TO                                     03210061
037300              PV-END-DD                                           03220061
037300                                                                  03230061
037300****************************************************************  03240061
037300* IF CREATING VENDOR/DEPARTMENT TOTAL RECORDS (BF) FOR TMKRP015*  03250061
037300* THEN IT IS NECESSARY TO MOVE 0'S AND/OR SPACES TO THE SORT   *  03260061
037300* FIELDS ON THE HEADER RECORD (AA) BEFORE REWRITING IT.        *  03270061
037300****************************************************************  03280061
037300         IF CC-CREATE-VNDDEPT-TOT                                 03290061
037400             MOVE ZEROS           TO VDTL-SF-ENT-ID               03300061
037400                                     VDTL-SF-DEPT-NBR             03310061
037400                                     VDTL-SF-TRBL-RSN             03320061
037400             MOVE SPACES          TO VDTL-SF-NOTIF-CDE            03330061
037400             MOVE WS-TMKRP015-SORTFIELD TO TM001-SORT-FIELD       03340061
037600         END-IF                                                   03350061
037400         PERFORM 8100-WRITE-OUTPUT-FILE                           03360061
037500         PERFORM 7000-READ-INPUT-FILE                             03370061
037600     END-IF.                                                      03380061
037700                                                                  03390061
050900 EJECT                                                            03400061
051000 2000-MAIN-LOOP.                                                  03410061
051100                                                                  03420061
051110     IF  TM001-RECORD-TYPE-DETAIL                                 03430061
051120         IF  TM001-RPT-AREA-VENDOR                                03440061
051130             PERFORM 2100-PROCESS-RECORD                          03450061
051140         ELSE                                                     03460061
051150             NEXT SENTENCE                                        03470061
051160     ELSE                                                         03480061
051170         NEXT SENTENCE.                                           03490061
051180                                                                  03500061
037300****************************************************************  03510061
037300* IF CREATING VENDOR/DEPARTMENT TOTAL RECORDS (BF) FOR TMKRP015*  03520061
037300* THEN IT IS NECESSARY TO SET UP THE SORT FIELDS ON THE 'BA'   *  03530061
037300* DETAIL RECORD BEFORE REWRITING IT, SO IT WILL SORT IN THE    *  03540061
037300* PROPER SEQUENCE LATER.                                       *  03550061
037300****************************************************************  03560061
037400     IF CC-CREATE-VNDDEPT-TOT                                     03570061
037400         MOVE TM001-ENT-ID       TO VDTL-SF-ENT-ID                03580061
037400         MOVE TM001-DEPT-NBR     TO VDTL-SF-DEPT-NBR              03590061
037400         MOVE TM001-TRBL-RSN-CDE TO VDTL-SF-TRBL-RSN              03600061
037400         MOVE SPACES             TO VDTL-SF-NOTIF-CDE             03610061
037400         MOVE WS-TMKRP015-SORTFIELD TO TM001-SORT-FIELD           03620061
037400     END-IF.                                                      03630061
037400                                                                  03640061
051181     PERFORM 8000-WRITE-OUTPUT-CONTROL.                           03650061
051182                                                                  03660061
051190     PERFORM 7000-READ-INPUT-FILE.                                03670061
051191                                                                  03680061
051192 EJECT                                                            03690061
051193                                                                  03700061
051194 2100-PROCESS-RECORD.                                             03710061
051100                                                                  03720061
051200     IF  CC-INCLUDE-ASSIGN-RESOLVE                                03730061
051300         SET WS-PROCESS-RECORD TO TRUE                            03740061
051400     ELSE                                                         03750061
051500         SET WS-OMIT-RECORD TO TRUE                               03760061
051600         PERFORM 2110-CHECK-FOR-PROCESS.                          03770061
051610                                                                  03780061
051700     IF  WS-PROCESS-RECORD                                        03790061
051710         IF  TM001-ENT-ID = PV-PREV-ENT-ID                        03800061
051930             IF CC-CREATE-VNDDEPT-TOT                             03810061
051924                  PERFORM 3100-CHECK-DEPT-NBR                     03820061
051924             END-IF                                               03830061
051720             PERFORM 2200-SAME-ENT-ID                             03840061
051723         ELSE                                                     03850061
051724             IF WS-FIRST-TIME-PROC                                03860061
051724                 SET WS-NOT-FIRST-TIME-PROC TO TRUE               03870061
                       PERFORM 3100-CHECK-DEPT-NBR                      03871071
051724             ELSE                                                 03880061
051724                 IF CC-CREATE-VNDDEPT-TOT                         03890061
051724                     PERFORM 3200-WRITE-VNDDEPT-TOTAL             03900061
051724                     PERFORM 3400-RESET-VNDDEPT                   03910061
051724                     PERFORM 3000-GET-VNDDEPT-INFO                03920061
051724                 END-IF                                           03930061
051724             END-IF                                               03940061
051724             PERFORM 2300-NEW-ENT-ID                              03950061
051725             MOVE TM001-ENT-ID TO                                 03960061
051726                  PV-PREV-ENT-ID                                  03970061
051727                  WS-HOLD-ENT-ID                                  03980061
051728             MOVE TM001-ENT-NAME-DESC TO                          03990061
051729                  WS-HOLD-ENT-NAME-DESC                           04000061
      *            PERFORM 3000-GET-VNDDEPT-INFO                        04001070
111130             PERFORM 2200-SAME-ENT-ID                             04010070
051731     ELSE                                                         04020061
051732         NEXT SENTENCE.                                           04030061
051740                                                                  04040061
051828                                                                  04050061
051829                                                                  04060061
051830 2110-CHECK-FOR-PROCESS.                                          04070061
051831                                                                  04080061
051840     IF  CC-INCLUDE-ASSIGN-ONLY                                   04090061
051850         IF  TM001-NOTIF-DATE >= PV-BEG-DATE                      04100061
051860         AND TM001-NOTIF-DATE <= PV-END-DATE                      04110061
051870             SET WS-PROCESS-RECORD TO TRUE                        04120061
051880         ELSE                                                     04130061
051890             NEXT SENTENCE                                        04140061
051891     ELSE                                                         04150061
051892         IF  TM001-RESOLVED-DATE >= PV-BEG-DATE                   04160061
051893         AND TM001-RESOLVED-DATE <= PV-END-DATE                   04170061
051894             SET WS-PROCESS-RECORD TO TRUE                        04180061
051895         ELSE                                                     04190061
051896             NEXT SENTENCE.                                       04200061
051897                                                                  04210061
051898 EJECT                                                            04220061
051899 2200-SAME-ENT-ID.                                                04230061
051900                                                                  04240061
051901     MOVE TM001-PO-NBR TO                                         04250061
051902          PV-CURR-PO-NBR.                                         04260061
051903     MOVE TM001-REC-SEQ-NBR TO                                    04270061
051904          PV-CURR-REC-SEQ-NBR.                                    04280061
051905     MOVE TM001-TRBL-RSN-CDE TO                                   04290061
051906          PV-CURR-REASON-CDE.                                     04300061
051907     IF  CC-USE-NOTIF-DATE-IN-COMP                                04310061
051908         MOVE TM001-NOTIF-DATE TO                                 04320061
051909              PV-CURR-NOTIF-DATE                                  04330061
051910     ELSE                                                         04340061
051911         MOVE PC-DEFAULT-CC-DATE TO                               04350061
051912              PV-CURR-NOTIF-DATE.                                 04360061
051913                                                                  04370061
051914     IF  PV-CURR-KEY IS EQUAL TO PV-PREV-KEY                      04380061
051916         SET WS-DUPLICATE-KEY TO TRUE                             04390061
051917         PERFORM 2210-CHECK-FOR-RESOLVE                           04400061
051918     ELSE                                                         04410061
051919         ADD +1 TO WS-ASSIGN-TOT-QTY                              04420061
051919                   WS-ASSIGN-TOT-QTY-VDPT                         04430061
051920         MOVE PV-CURR-KEY TO PV-PREV-KEY                          04440061
051921         SET WS-NOT-DUPLICATE-KEY TO TRUE                         04450061
051922         PERFORM 2210-CHECK-FOR-RESOLVE                           04460061
051923         IF  TM001-TRBL-RSN-NOTIF                                 04470061
051924             ADD +1 TO WS-ASSIGN-NOTIFY-QTY                       04480061
051924                       WS-ASSIGN-NOTIFY-QTY-VDPT                  04490061
051925         ELSE                                                     04500061
051926             ADD +1 TO WS-ASSIGN-TROUBLE-QTY                      04510061
051926                       WS-ASSIGN-TROUBLE-QTY-VDPT                 04520061
051927         END-IF                                                   04530061
051929     END-IF.                                                      04540061
051930                                                                  04550061
051930                                                                  04560061
051931 2210-CHECK-FOR-RESOLVE.                                          04570061
051932                                                                  04580061
051933     IF  TM001-RPT-RESOLVED                                       04590061
051934         ADD TM001-RESOLVED-MINUTES TO                            04600061
051935             WS-RESOLVE-TOT-MIN                                   04610061
051935             WS-RESOLVE-TOT-MIN-VDPT                              04620061
051936         MULTIPLY TM001-RESOLVED-HOURS BY PC-60                   04630061
051937             GIVING WS-CALC-MINUTES                               04640061
051938         ADD WS-CALC-MINUTES TO                                   04650061
051939             WS-RESOLVE-TOT-MIN                                   04660061
051939             WS-RESOLVE-TOT-MIN-VDPT                              04670061
051940         ADD +1 TO WS-RESOLVE-TOT-QTY                             04680061
051940                   WS-RESOLVE-TOT-QTY-VDPT                        04690061
051941         IF  TM001-TRBL-RSN-NOTIF                                 04700061
051942             ADD TM001-RESOLVED-MINUTES TO                        04710061
051943                 WS-RESOLVE-NOTIFY-MIN                            04720061
051943                 WS-RESOLVE-NOTIFY-MIN-VDPT                       04730061
051944             ADD WS-CALC-MINUTES TO                               04740061
051945                 WS-RESOLVE-NOTIFY-MIN                            04750061
051945                 WS-RESOLVE-NOTIFY-MIN-VDPT                       04760061
051946             ADD +1 TO WS-RESOLVE-NOTIFY-QTY                      04770061
051946                       WS-RESOLVE-NOTIFY-QTY-VDPT                 04780061
051947         ELSE                                                     04790061
051948             ADD TM001-RESOLVED-MINUTES TO                        04800061
051949                 WS-RESOLVE-TROUBLE-MIN                           04810061
051949                 WS-RESOLVE-TROUBLE-MIN-VDPT                      04820061
051950             ADD WS-CALC-MINUTES TO                               04830061
051951                 WS-RESOLVE-TROUBLE-MIN                           04840061
051951                 WS-RESOLVE-TROUBLE-MIN-VDPT                      04850061
051952             ADD +1 TO WS-RESOLVE-TROUBLE-QTY                     04860061
051952                       WS-RESOLVE-TROUBLE-QTY-VDPT                04870061
051953         END-IF                                                   04880061
051954     END-IF.                                                      04890061
051955 EJECT                                                            04900061
051956 2300-NEW-ENT-ID.                                                 04910061
051957                                                                  04920061
051958     IF  WS-ASSIGN-TROUBLE-QTY = ZERO                             04930061
051959     AND WS-ASSIGN-NOTIFY-QTY  = ZERO                             04940061
051960     AND WS-ASSIGN-TOT-QTY     = ZERO                             04950061
051970         NEXT SENTENCE                                            04960061
051980     ELSE                                                         04970061
051990         PERFORM 2310-WRITE-ENT-TOTAL-RECORD                      04980061
051991         MOVE ZEROS TO WS-ASSIGN-TROUBLE-QTY                      04990061
051992                       WS-ASSIGN-NOTIFY-QTY                       05000061
051993                       WS-ASSIGN-TOT-QTY                          05010061
051994                       WS-RESOLVE-TROUBLE-MIN                     05020061
051996                       WS-RESOLVE-NOTIFY-MIN                      05030061
051998                       WS-RESOLVE-TOT-MIN                         05040061
051999                       WS-RESOLVE-TROUBLE-QTY                     05050061
052000                       WS-RESOLVE-NOTIFY-QTY                      05060061
052001                       WS-RESOLVE-TOT-QTY.                        05070061
052002                                                                  05080061
052003***************************************************************** 05090061
052003*    THIS PARAGRAPH WRITES OUT THE 'AL' RECORD                  * 05100061
052003***************************************************************** 05110061
052004 2310-WRITE-ENT-TOTAL-RECORD.                                     05120061
052005                                                                  05130061
052006     IF  CC-TOTAL-FOR-ALL-TRBL-ASSIGN                             05140061
052007         MOVE WS-HOLD-ENT-ID TO  VTR-SF-VND-NBR                   05150061
052009                                 VTR-ENT-ID                       05160061
052009                                 VDTL-ENT-ID                      05170061
052009                                 VDTL-SF-ENT-ID                   05180061
052010         MOVE WS-HOLD-ENT-NAME-DESC TO VTR-ENT-NAME-DESC          05190061
052012         MOVE PC-A TO VTR-REPORT-NOTIF-CDE                        05200061
052009                      VDTL-SF-NOTIF-CDE                           05210061
052013         MOVE ZEROS TO VTR-RESOLVED-HOURS                         05220061
052014                       VTR-RESOLVED-MINUTES                       05230061
052015         MOVE WS-ASSIGN-TOT-QTY TO VTR-ASSIGN-TOT-QTY             05240061
052017         MOVE WS-RESOLVE-TOT-MIN TO WS-HOLD-MINUTES               05250061
052019         MOVE WS-RESOLVE-TOT-QTY TO WS-HOLD-QUANTITY              05260061
052021         PERFORM 2400-GET-HOURS-MIN                               05270061
052022         SUBTRACT WS-ASSIGN-TOT-QTY FROM                          05280061
052023                  PC-99999 GIVING                                 05290061
052024                  PV-CALC-TEMP-QTY                                05300061
052025         MOVE PV-CALC-TEMP-QTY TO VTR-SF-TRBL-QTY                 05310061
052026         IF CC-CREATE-VNDDEPT-TOT                                 05320061
052026             MOVE ZEROS        TO VDTL-SF-DEPT-NBR                05330061
052026                                  VDTL-SF-TRBL-RSN                05340061
052026             MOVE WS-TMKRP015-SORTFIELD TO VTR-SORT-FIELD         05350061
052026         ELSE                                                     05360061
052026             MOVE WS-TMKRP012-SORTFIELD TO VTR-SORT-FIELD         05370061
052026         END-IF                                                   05380061
052027         WRITE TE-TRBL-EXTRACT-RCD-OUT FROM                       05390061
052028               WS-VENDOR-TOTAL-RECORD                             05400061
052029         ADD +1 TO WS-RCD-VNDTOT-WRITE-COUNT                      05410061
052030     ELSE                                                         05420061
052031         MOVE WS-HOLD-ENT-ID TO VTR-SF-VND-NBR                    05430061
052033                                VTR-ENT-ID                        05440061
052009                                VDTL-ENT-ID                       05450061
052009                                VDTL-SF-ENT-ID                    05460061
052034         MOVE WS-HOLD-ENT-NAME-DESC TO VTR-ENT-NAME-DESC          05470061
052036         MOVE PC-A TO VTR-REPORT-NOTIF-CDE                        05480061
052009                      VDTL-SF-NOTIF-CDE                           05490061
052037         MOVE ZEROS TO VTR-RESOLVED-HOURS                         05500061
052038                       VTR-RESOLVED-MINUTES                       05510061
052039         MOVE WS-ASSIGN-TROUBLE-QTY  TO VTR-ASSIGN-TOT-QTY        05520061
052041         MOVE WS-RESOLVE-TROUBLE-MIN TO WS-HOLD-MINUTES           05530061
052043         MOVE WS-RESOLVE-TROUBLE-QTY TO WS-HOLD-QUANTITY          05540061
052045         PERFORM 2400-GET-HOURS-MIN                               05550061
052046         SUBTRACT WS-ASSIGN-TROUBLE-QTY FROM                      05560061
052047                  PC-99999 GIVING                                 05570061
052048                  PV-CALC-TEMP-QTY                                05580061
052049         MOVE PV-CALC-TEMP-QTY TO VTR-SF-TRBL-QTY                 05590061
052026         IF CC-CREATE-VNDDEPT-TOT                                 05600061
052026             MOVE ZEROS         TO VDTL-SF-DEPT-NBR               05610061
052026                                   VDTL-SF-TRBL-RSN               05620061
052026             MOVE WS-TMKRP015-SORTFIELD TO VTR-SORT-FIELD         05630061
052026         ELSE                                                     05640061
052026             MOVE WS-TMKRP012-SORTFIELD TO VTR-SORT-FIELD         05650061
052026         END-IF                                                   05660061
052051         WRITE TE-TRBL-EXTRACT-RCD-OUT FROM                       05670061
052052               WS-VENDOR-TOTAL-RECORD                             05680061
052053         ADD +1 TO WS-RCD-VNDTOT-WRITE-COUNT                      05690061
052054         MOVE PC-B TO VTR-REPORT-NOTIF-CDE                        05700061
052009                      VDTL-SF-NOTIF-CDE                           05710061
052055         MOVE ZEROS TO VTR-RESOLVED-HOURS                         05720061
052056                       VTR-RESOLVED-MINUTES                       05730061
052057         MOVE WS-ASSIGN-NOTIFY-QTY  TO VTR-ASSIGN-TOT-QTY         05740061
052059         MOVE WS-RESOLVE-NOTIFY-MIN TO WS-HOLD-MINUTES            05750061
052061         MOVE WS-RESOLVE-NOTIFY-QTY TO WS-HOLD-QUANTITY           05760061
052063         PERFORM 2400-GET-HOURS-MIN                               05770061
052064         SUBTRACT WS-ASSIGN-NOTIFY-QTY FROM                       05780061
052065                  PC-99999 GIVING                                 05790061
052066                  PV-CALC-TEMP-QTY                                05800061
052067         MOVE PV-CALC-TEMP-QTY      TO VTR-SF-TRBL-QTY            05810061
052026         IF CC-CREATE-VNDDEPT-TOT                                 05820061
052026             MOVE ZEROS             TO VDTL-SF-DEPT-NBR           05830061
052026                                       VDTL-SF-TRBL-RSN           05840061
052026             MOVE WS-TMKRP015-SORTFIELD TO VTR-SORT-FIELD         05850061
052026         ELSE                                                     05860061
052026             MOVE WS-TMKRP012-SORTFIELD TO VTR-SORT-FIELD         05870061
052026         END-IF                                                   05880061
052069         WRITE TE-TRBL-EXTRACT-RCD-OUT FROM                       05890061
052070               WS-VENDOR-TOTAL-RECORD                             05900061
052071         ADD +1 TO WS-RCD-VNDTOT-WRITE-COUNT.                     05910061
052080                                                                  05920061
052100 EJECT                                                            05930061
056610 2400-GET-HOURS-MIN.                                              05940061
056620                                                                  05950061
056621     IF  WS-HOLD-MINUTES = ZERO                                   05960061
056622     OR  WS-HOLD-QUANTITY = ZERO                                  05970061
056623         NEXT SENTENCE                                            05980061
056624     ELSE                                                         05990061
056625         DIVIDE WS-HOLD-MINUTES                                   06000061
056626                      BY WS-HOLD-QUANTITY                         06010061
056627                  GIVING WS-AVG-MINUTES ROUNDED                   06020061
056628                  ON SIZE ERROR                                   06030061
056629                       MOVE 0 TO WS-AVG-MINUTES                   06040061
056630         END-DIVIDE                                               06050061
056631                                                                  06060061
056632         DIVIDE WS-AVG-MINUTES BY PC-60                           06070061
056633                GIVING VTR-RESOLVED-HOURS                         06080061
056634                REMAINDER VTR-RESOLVED-MINUTES                    06090061
056635                ON SIZE ERROR                                     06100061
056636                      MOVE 0 TO VTR-RESOLVED-HOURS                06110061
056637                                VTR-RESOLVED-MINUTES              06120061
056638         END-DIVIDE.                                              06130061
056639                                                                  06140061
056639****************************************************************  06150061
056639*  THIS PARAGRAPH GETS VENDOR AND DEPARTMENT INFORMATION FOR   *  06160061
056639*  FOR THE VENDOR/DEPARTMENT RECORD (BF)                       *  06170061
056639****************************************************************  06180061
056639 3000-GET-VNDDEPT-INFO.                                           06190061
056639     MOVE TM001-DEPT-NBR         TO VDTL-DEPT-NBR                 06200061
056639                                    VDTL-SF-DEPT-NBR              06210061
056639                                    PV-PREV-DEPT.                 06220061
056639     MOVE TM001-DEPT-DESC        TO VDTL-DEPT-DESCRIPTION         06230061
056639                                    PV-PREV-DEPT-DESC.            06240061
056639                                                                  06250061
056639****************************************************************  06260061
056639*  THIS PARAGRAPH CHECKS TO SEE IF THIS IS THE FIRST TIME FOR A*  06270061
056639*  SPECIFIC DEPT. AND WHETHER OR NOT THE DEPT. NBR HAS CHANGED *  06280061
056639*  IF SO, THE 'BF' RECORD IS WRITTEN AND COUNTERS RESET BEFORE *  06290061
056639*  CONTINUING ACCUMULATING NBR OF TROUBLES FOR THE NEW DEPT.   *  06300061
056639****************************************************************  06310061
056639 3100-CHECK-DEPT-NBR.                                             06320061
051930                                                                  06330061
051930     IF TM001-DEPT-NBR = PV-PREV-DEPT                             06340061
051930         NEXT SENTENCE                                            06350061
051930     ELSE                                                         06360061
051930         IF WS-FIRST-TIME-DEPT                                    06370061
051930             PERFORM 3000-GET-VNDDEPT-INFO                        06380061
051930             SET WS-NOT-FIRST-TIME-DEPT TO TRUE                   06390061
051930         ELSE                                                     06400061
051930             PERFORM 3200-WRITE-VNDDEPT-TOTAL                     06410061
051930             PERFORM 3400-RESET-VNDDEPT                           06420061
051930             PERFORM 3000-GET-VNDDEPT-INFO                        06430061
051930         END-IF                                                   06440061
051930     END-IF.                                                      06450061
051930                                                                  06460061
056639****************************************************************  06470061
056639*        THIS PARAGRAPH WRITES OUT THE 'BF' RECORD             *  06480061
056639*  THIS PARAGRAPH COMPLETES THE VENDOR/DEPARTMENT RECORD INFO  *  06490061
056639*  BEING PREPARED BY THIS PROGRAM AND WRITES OUT THE RECORD.   *  06500061
056639****************************************************************  06510061
056639 3200-WRITE-VNDDEPT-TOTAL.                                        06520061
056639                                                                  06530061
           IF  PV-PREV-DEPT = SPACE                                     06531069
               MOVE ZERO TO PV-PREV-DEPT.                               06532069
                                                                        06533069
056639     IF  CC-TOTAL-FOR-ALL-TRBL-ASSIGN                             06540061
056639         MOVE WS-HOLD-ENT-ID TO VDTL-ENT-ID                       06550061
056639                                VDTL-SF-ENT-ID                    06560061
056639         MOVE WS-HOLD-ENT-NAME-DESC TO VDTL-ENT-NAME-DESC         06561062
056639         MOVE PV-PREV-DEPT TO VDTL-DEPT-NBR                       06570061
056639                              VDTL-SF-DEPT-NBR                    06580061
056639         MOVE PV-PREV-DEPT-DESC TO VDTL-DEPT-DESCRIPTION          06590061
056639         MOVE PC-A  TO VDTL-REPORT-NOTIF-CDE                      06600061
056639                       VDTL-SF-NOTIF-CDE                          06610061
056639         MOVE ZEROS TO VDTL-AVG-RESOLV-HRS                        06620064
056639                       VDTL-AVG-RESOLV-MINS                       06630064
056639                       VDTL-SF-TRBL-RSN                           06640061
056639         MOVE WS-ASSIGN-TOT-QTY-VDPT  TO VDTL-ASSIGN-TOT-QTY      06650061
056639         MOVE WS-RESOLVE-TOT-MIN-VDPT TO WS-HOLD-MINUTES          06660061
056639         MOVE WS-RESOLVE-TOT-QTY-VDPT TO WS-HOLD-QUANTITY         06670061
056639         PERFORM 3300-GET-VDPT-HOURS-MIN                          06680061
052026         MOVE WS-TMKRP015-SORTFIELD   TO VDTL-SORT-FIELD          06690061
056639         WRITE TE-TRBL-EXTRACT-RCD-OUT FROM                       06700061
056639               WS-VDR-DEPT-RECORD                                 06710061
056639         ADD +1 TO WS-RCD-VNDDPT-WRITE-COUNT                      06720061
056639     ELSE                                                         06730061
056639         MOVE WS-HOLD-ENT-ID TO VDTL-ENT-ID                       06740061
056639                                VDTL-SF-ENT-ID                    06750061
056639         MOVE WS-HOLD-ENT-NAME-DESC TO VDTL-ENT-NAME-DESC         06751062
056639         MOVE PV-PREV-DEPT TO VDTL-DEPT-NBR                       06760067
056639                              VDTL-SF-DEPT-NBR                    06770067
056639         MOVE PV-PREV-DEPT-DESC TO VDTL-DEPT-DESCRIPTION          06780061
056639         MOVE PC-A  TO VDTL-REPORT-NOTIF-CDE                      06790061
056639                       VDTL-SF-NOTIF-CDE                          06800061
056639         MOVE ZEROS TO VDTL-AVG-RESOLV-HRS                        06810064
056639                       VDTL-AVG-RESOLV-MINS                       06820064
056639                       VDTL-SF-TRBL-RSN                           06830061
056639         MOVE WS-ASSIGN-TROUBLE-QTY-VDPT  TO VDTL-ASSIGN-TOT-QTY  06840061
056639         MOVE WS-RESOLVE-TROUBLE-MIN-VDPT TO WS-HOLD-MINUTES      06850061
056639         MOVE WS-RESOLVE-TROUBLE-QTY-VDPT TO WS-HOLD-QUANTITY     06860061
056639         PERFORM 3300-GET-VDPT-HOURS-MIN                          06870061
056639         MOVE WS-TMKRP015-SORTFIELD       TO VDTL-SORT-FIELD      06880061
056639         WRITE TE-TRBL-EXTRACT-RCD-OUT FROM                       06890061
056639               WS-VDR-DEPT-RECORD                                 06900061
056639         ADD +1 TO WS-RCD-VNDDPT-WRITE-COUNT                      06910061
056639         MOVE PC-B  TO VDTL-REPORT-NOTIF-CDE                      06920061
056639                       VDTL-SF-NOTIF-CDE                          06930061
056639         MOVE ZEROS TO VDTL-AVG-RESOLV-HRS                        06940064
056639                       VDTL-AVG-RESOLV-MINS                       06950064
056639                       VDTL-SF-TRBL-RSN                           06960061
056639         MOVE WS-ASSIGN-NOTIFY-QTY-VDPT  TO VDTL-ASSIGN-TOT-QTY   06970061
056639         MOVE WS-RESOLVE-NOTIFY-MIN-VDPT TO WS-HOLD-MINUTES       06980061
056639         MOVE WS-RESOLVE-NOTIFY-QTY-VDPT TO WS-HOLD-QUANTITY      06990061
056639         PERFORM 3300-GET-VDPT-HOURS-MIN                          07000061
056639         MOVE WS-TMKRP015-SORTFIELD      TO VDTL-SORT-FIELD       07010061
056639         WRITE TE-TRBL-EXTRACT-RCD-OUT FROM                       07020061
056639               WS-VDR-DEPT-RECORD                                 07030061
056639         ADD +1 TO WS-RCD-VNDDPT-WRITE-COUNT                      07040061
056639     END-IF.                                                      07050061
056639                                                                  07060061
056639                                                                  07070061
056639****************************************************************  07080061
056639*  THIS PARAGRAPH CALCULATES THE RESOLVED HOURS AND MINUTES    *  07090061
056639*  FOR THE VENDOR/DEPARTMENT RECORD                            *  07100061
056639****************************************************************  07110061
056610 3300-GET-VDPT-HOURS-MIN.                                         07120061
051100                                                                  07130061
056621     IF  WS-HOLD-MINUTES = ZERO                                   07140061
056622     OR  WS-HOLD-QUANTITY = ZERO                                  07150061
056623         NEXT SENTENCE                                            07160061
056624     ELSE                                                         07170061
056625         DIVIDE WS-HOLD-MINUTES                                   07180061
056626                      BY WS-HOLD-QUANTITY                         07190061
056627                  GIVING WS-AVG-MINUTES ROUNDED                   07200061
056628                  ON SIZE ERROR                                   07210061
056629                       MOVE 0 TO WS-AVG-MINUTES                   07220061
056630         END-DIVIDE                                               07230061
056631                                                                  07240061
056632         DIVIDE WS-AVG-MINUTES BY PC-60                           07250061
056633                GIVING VDTL-AVG-RESOLV-HRS                        07260064
056634                REMAINDER VDTL-AVG-RESOLV-MINS                    07270064
056635                ON SIZE ERROR                                     07280061
056636                      MOVE 0 TO VDTL-AVG-RESOLV-HRS               07290064
056637                                VDTL-AVG-RESOLV-MINS              07300064
056638         END-DIVIDE.                                              07310061
056639                                                                  07320061
056639****************************************************************  07331066
056639*  THIS PARAGRAPH RESETS THE BUCKETS USED TO ACCUMULATE VENDOR/*  07340061
056639*  DEPARTMENT NUMBER OF TROUBLES, NOTIFYS AND RESOLVE TIMES.   *  07350061
056639*  IT ALSO MOVES CURRENT DEPT INFO TO PREV. DEPT INFO          *  07360061
056639****************************************************************  07370061
056639 3400-RESET-VNDDEPT.                                              07380061
056639                                                                  07390061
056639     INITIALIZE   WS-RESOLVE-TOT-MIN-VDPT                         07400061
056639                  WS-RESOLVE-TOT-QTY-VDPT                         07410061
056639                  WS-RESOLVE-NOTIFY-MIN-VDPT                      07420061
056639                  WS-RESOLVE-NOTIFY-QTY-VDPT                      07430061
056639                  WS-RESOLVE-TROUBLE-MIN-VDPT                     07440061
056639                  WS-RESOLVE-TROUBLE-QTY-VDPT                     07450061
056639                  WS-ASSIGN-TOT-QTY-VDPT                          07460061
056639                  WS-ASSIGN-NOTIFY-QTY-VDPT                       07470061
056639                  WS-ASSIGN-TROUBLE-QTY-VDPT.                     07480061
056639                                                                  07490061
084000 7000-READ-INPUT-FILE.                                            07500061
084100                                                                  07510061
084200      READ EXTRACT-TRBL-FILE-IN INTO                              07520061
084300           TM001-TROUBLE-EXT-RECORD                               07530061
084400      AT END                                                      07540061
084500           SET PS-EOF TO TRUE                                     07550061
084600      END-READ.                                                   07560061
084700                                                                  07570061
084800      IF  PS-EOF                                                  07580061
084900          NEXT SENTENCE                                           07590061
085000      ELSE                                                        07600061
085100          ADD +1 TO WS-RCD-READ-COUNT                             07610061
085200      END-IF.                                                     07620061
085300                                                                  07630061
085400                                                                  07640061
085500 8000-WRITE-OUTPUT-CONTROL.                                       07650061
085600                                                                  07660061
085610      IF  CC-WRITE-ALL-TO-OUTPUT                                  07670061
085611          IF  TM001-RPT-AREA-VENDOR                               07680061
085612          AND CC-BYPASS-DUPLICATES                                07690061
085613          AND WS-DUPLICATE-KEY                                    07700061
085614              ADD +1 TO WS-RCD-BYPASS-COUNT                       07710061
085615              SET WS-NOT-DUPLICATE-KEY TO TRUE                    07720061
085616          ELSE                                                    07730061
085620              PERFORM 8100-WRITE-OUTPUT-FILE                      07740061
085630      ELSE                                                        07750061
085640          IF  CC-DO-NOT-WRITE-TO-OUTPUT                           07760061
085650              ADD +1 TO WS-RCD-BYPASS-COUNT                       07770061
085660          ELSE                                                    07780061
085670              IF  CC-WRITE-ALL-NON-VEND-DETAIL                    07790061
085680                  IF  TM001-RPT-AREA-VENDOR                       07800061
085690                      ADD +1 TO WS-RCD-BYPASS-COUNT               07810061
085691                  ELSE                                            07820061
085692                      PERFORM 8100-WRITE-OUTPUT-FILE              07830061
085693              ELSE                                                07840061
085694                  PERFORM 8100-WRITE-OUTPUT-FILE.                 07850061
086100                                                                  07860061
086200                                                                  07870061
086210 8100-WRITE-OUTPUT-FILE.                                          07880061
086220                                                                  07890061
086240      WRITE TE-TRBL-EXTRACT-RCD-OUT FROM                          07900061
086250            TM001-TROUBLE-EXT-RECORD.                             07910061
086260                                                                  07920061
086270      ADD +1 TO WS-RCD-DTL-WRITE-COUNT.                           07930061
086280                                                                  07940061
086290                                                                  07950061
086300 9000-END-OF-PROGRAM.                                             07960061
086400     IF CC-CREATE-VNDDEPT-TOT                                     07970061
086400         PERFORM 3200-WRITE-VNDDEPT-TOTAL                         07980061
086400     END-IF.                                                      07990061
086410     PERFORM 2300-NEW-ENT-ID.                                     08000061
086800                                                                  08010061
086900     CLOSE EXTRACT-TRBL-FILE-IN                                   08020061
087000           EXTRACT-TRBL-FILE-OUT.                                 08030061
087100                                                                  08040061
087200     DISPLAY '** INPUT RECORDS READ =========== '                 08050061
087300             WS-RCD-READ-COUNT.                                   08060061
087400     DISPLAY '** INPUT RECORDS NOT WRITTEN ==== '                 08070061
087500             WS-RCD-BYPASS-COUNT.                                 08080061
087600     DISPLAY '** VENDOR TOTAL RECORDS WRITTEN = '                 08090061
087700             WS-RCD-VNDTOT-WRITE-COUNT                            08100061
086400     IF CC-CREATE-VNDDEPT-TOT                                     08110061
087600         DISPLAY '** VENDOR DEPT. RECORDS WRITTEN = '             08120061
087700                 WS-RCD-VNDDPT-WRITE-COUNT                        08130061
086400     END-IF.                                                      08140061
087800     DISPLAY '** DETAIL RECORDS WRITTEN ======= '                 08150061
087900             WS-RCD-DTL-WRITE-COUNT.                              08160061
088000     DISPLAY ' '.                                                 08170061
088100     DISPLAY '** CONTROL CARD FOR THIS RUN IS = '                 08180061
088200             CC-CONTROL-CARD-PARAMETERS.                          08190061
