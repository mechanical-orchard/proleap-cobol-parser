000100***************************************************************** 00010018
000200 IDENTIFICATION DIVISION.                                         00020019
000300***************************************************************** 00030019
000400                                                                  00040019
000500 PROGRAM-ID.             PCKRP036.                                00050019
000600 AUTHOR.                 BRENDA ROCKWELL.                         00060019
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070019
000800 DATE-WRITTEN            APRIL, 2012.                             00080019
000900 DATE-COMPILED.                                                   00090019
001000                                                                  00100019
001100***************************************************************** 00110019
001200*  THIS PROGRAM WILL PRINT THE HANGING PACKSLIPS REPORT         * 00120019
001300***************************************************************** 00130019
001400                                                                  00140019
001500***************************************************************** 00150019
001600 ENVIRONMENT DIVISION.                                            00160019
001700***************************************************************** 00170019
001800                                                                  00180019
001900 CONFIGURATION SECTION.                                           00190019
002000 SOURCE-COMPUTER.        IBM-3090.                                00200019
002100 OBJECT-COMPUTER.        IBM-3090.                                00210019
002200                                                                  00220019
002300 INPUT-OUTPUT SECTION.                                            00230019
002400                                                                  00240019
002500 FILE-CONTROL.                                                    00250019
002600                                                                  00260019
002700     SELECT INPUT01-FILE       ASSIGN TO INP01.                   00270019
002800     SELECT REPORT-FILE        ASSIGN TO RPT01.                   00280019
002900                                                                  00290019
003000***************************************************************** 00300019
003100 DATA DIVISION.                                                   00310019
003200***************************************************************** 00320019
003300                                                                  00330019
003400 FILE SECTION.                                                    00340019
003500                                                                  00350019
003600 FD  INPUT01-FILE                                                 00360019
003700     LABEL RECORDS ARE STANDARD                                   00370019
003800     RECORDING MODE IS F                                          00380019
003900     BLOCK CONTAINS 0 RECORDS                                     00390019
004000     RECORD CONTAINS 200 CHARACTERS.                              00400019
004100 01  INPUT01-RECORD                  PIC X(200).                  00410019
004200                                                                  00420019
004300 FD  REPORT-FILE                                                  00430019
004400     RECORDING MODE IS F                                          00440019
004500     BLOCK CONTAINS 0  RECORDS.                                   00450019
004600 01  REPORT-RECORD                   PIC  X(150).                 00460019
004700                                                                  00470019
004800 WORKING-STORAGE SECTION.                                         00480019
004900                                                                  00490019
005000 01  PROGRAM-SWITCHES.                                            00500019
005100     05  PS-END-OF-INPUT-SW          PIC  X(01)    VALUE 'N'.     00510019
005200         88  PS-END-OF-INPUT                       VALUE 'Y'.     00520019
005300     05  PS-FIRST-TIME-SW            PIC  X(01)    VALUE 'Y'.     00530019
005400         88  PS-FIRST-TIME                         VALUE 'Y'.     00540019
005500                                                                  00550019
005600 01  PC-CONSTANTS.                                                00560019
005700     05  PC-PROGRAM-NAME             PIC  X(08)    VALUE          00570019
005800                           'PCKRP036'.                            00580019
005900     05  PC-REPORT-NBR               PIC  X(02)    VALUE          00590019
006000                           '-1'.                                  00600019
006100                                                                  00610019
006200 01  PV-MISC-FIELDS.                                              00620019
006300     05  PV-LINE-CNT                 PIC S9(05) COMP-3 VALUE +0.  00630019
006400     05  PV-NBR-OF-LINES             PIC S9(05) COMP-3 VALUE +0.  00640019
006500     05  PV-LINE-LIMIT               PIC S9(03) COMP-3 VALUE +57. 00650019
006600     05  PV-PAGE-CNT                 PIC S9(05) COMP-3 VALUE +0.  00660019
006700     05  PV-USER-NAME                PIC X(25)     VALUE SPACES.  00670019
006800     05  PV-HOLD-NUMERIC             PIC 9(9)      VALUE ZERO.    00680019
006900     05  PV-TOTAL-CARTONS            PIC S9(9) COMP-3 VALUE +0.   00690019
007000     05  PV-TOTAL-SSCC               PIC S9(9) COMP-3 VALUE +0.   00700019
007100     05  PV-TOTAL-UNITS              PIC S9(9) COMP-3 VALUE +0.   00710019
007200     05  PV-TODAYS-DATE.                                          00720019
007300         10  PV-TODAYS-DATE-YY       PIC  9(02)    VALUE ZERO.    00730019
007400         10  PV-TODAYS-DATE-MM       PIC  9(02)    VALUE ZERO.    00740019
007500         10  PV-TODAYS-DATE-DD       PIC  9(02)    VALUE ZERO.    00750019
007600     05  PV-TODAYS-TIME.                                          00760019
007700         10  PV-TODAYS-TIME-HH       PIC  9(02)    VALUE ZERO.    00770019
007800         10  PV-TODAYS-TIME-MM       PIC  9(02)    VALUE ZERO.    00780019
007900         10  PV-TODAYS-TIME-SS       PIC  9(02)    VALUE ZERO.    00790019
008000         10  FILLER                  PIC  9(02)    VALUE ZERO.    00800019
008100     05  PV-FORMAT-DATE.                                          00810019
008200         10  PV-FORMAT-DATE-MM       PIC  X(02)    VALUE SPACES.  00820019
008300         10  FILLER                  PIC  X(01)    VALUE '/'.     00830019
008400         10  PV-FORMAT-DATE-DD       PIC  X(02)    VALUE SPACES.  00840019
008500         10  FILLER                  PIC  X(01)    VALUE '/'.     00850019
008600         10  PV-FORMAT-DATE-YYYY     PIC  X(04)    VALUE SPACES.  00860019
008700     05  PV-DC-LOCATION              PIC 9(04)         VALUE 0.   00870019
008800                                                                  00880019
008900****************************************************              00890019
009000* INPUT01 COPYBOOK                                 *              00900019
009100****************************************************              00910019
009200     COPY PCRD070.                                                00920019
009300                                                                  00930019
009400******************************************************************00940019
009500*    STANDARD HEADER FOR 150 COLUMN REPORT                       *00950019
009600******************************************************************00960019
009700     COPY DPWS150O.                                               00970019
009800                                                                  00980019
009900 01  HDR-LINES.                                                   00990019
010000     05  HDR01-LINE.                                              01000019
010100         10  FILLER                  PIC  X(65)    VALUE SPACES.  01010019
010200         10  FILLER                  PIC  X(20)    VALUE          01020019
010300             'HANGING PACKSLIPS   '.                              01030019
010400         10  FILLER                  PIC  X(65)    VALUE SPACES.  01040019
010500     05  HDR02-LINE.                                              01050019
010600         10  FILLER                  PIC  X(17)    VALUE          01060019
010700             'DC.............: '.                                 01070019
010800         10  HDR02-DC                PIC  ZZZZ9.                  01080019
010900         10  FILLER                  PIC  X(02)    VALUE SPACES.  01090019
011000         10  HDR02-DC-DESCRIPTION    PIC  X(40)    VALUE SPACES.  01100019
011100         10  FILLER                  PIC  X(86)    VALUE SPACES.  01110019
011200     05  HDR03-LINE.                                              01120019
011300         10  FILLER                  PIC  X(45)    VALUE          01130019
011400             '     ASN                  CRTN    SSCC    UNI'.     01140019
011500         10  FILLER                  PIC  X(45)    VALUE          01150019
011600             'T   PACKSLIP                                 '.     01160019
011700         10  FILLER                  PIC  X(39)    VALUE SPACES.  01170029
011710         10  FILLER                  PIC  X(06)    VALUE 'CREATE'.01171027
011800     05  HDR04-LINE.                                              01180019
011900         10  FILLER                  PIC  X(45)    VALUE          01190019
012000             ' DC  SCAC   PO      RCVR  COUNT   COUNT   COU'.     01200019
012100         10  FILLER                  PIC  X(45)    VALUE          01210019
012200             'NT  CRE DTE         BOL               VENDOR '.     01220019
012300         10  FILLER                  PIC  X(39)    VALUE          01230028
012400             '         CAN                           '.           01240028
012500         10  FILLER                  PIC  X(07) VALUE 'USER ID'.  01250027
012510         10  FILLER                  PIC  X(08)    VALUE SPACES.  01251027
012600     05  HDR05-LINE.                                              01260019
012700         10  FILLER                  PIC  X(45)    VALUE          01270019
012800             '---- ---- --------- ---- ------- ------- ----'.     01280019
012900         10  FILLER                  PIC  X(45)    VALUE          01290019
013000             '--- ---------- ---------------- -------------'.     01300019
013100         10  FILLER                  PIC  X(47)    VALUE          01310020
013200             '------- ------------------------------ --------'.   01320020
013300         10  FILLER                  PIC  X(13)    VALUE SPACES.  01330020
013400     05  BLANK-LINE                  PIC X(150)    VALUE SPACES.  01340019
013500     05  END-OF-REPORT-LINE.                                      01350019
013600         10  FILLER                  PIC  X(44)    VALUE SPACES.  01360019
013700         10  FILLER                  PIC  X(45)    VALUE          01370019
013800             '*******   E N D   O F   R E P O R T   *******'.     01380019
013900         10  FILLER                  PIC  X(43)    VALUE SPACES.  01390019
014000     05  NO-DATA-TO-REPORT-LINE.                                  01400019
014100         10  FILLER                  PIC  X(40)    VALUE SPACES.  01410019
014200         10  FILLER                  PIC  X(52)    VALUE          01420019
014300         '*******  N O   D A T A   T O   R E P O R T   *******'.  01430019
014400         10  FILLER                  PIC  X(40)    VALUE SPACES.  01440019
014500                                                                  01450019
014600 01  DETAIL-LINES.                                                01460019
014700     05  DTL01-LINE.                                              01470019
014800         10  DTL01-DC                PIC  Z999.                   01480019
014900         10  FILLER                  PIC  X(01)    VALUE SPACES.  01490019
015000         10  DTL01-SCAC              PIC  X(04)    VALUE SPACES.  01500019
015100         10  FILLER                  PIC  X(01)    VALUE SPACES.  01510019
015200         10  DTL01-PO                PIC ZZZZZZZ9 BLANK WHEN ZERO.01520019
015300         10  FILLER                  PIC  X(01)    VALUE ' '.     01530019
015400         10  DTL01-RECEIVER          PIC  ZZ9     BLANK WHEN ZERO.01540019
015500         10  FILLER                  PIC  X(03)    VALUE SPACES.  01550019
015600         10  DTL01-CARTON-CNT        PIC  ZZZ,ZZ9 BLANK WHEN ZERO.01560019
015700         10  FILLER                  PIC  X(01)    VALUE SPACES.  01570019
015800         10  DTL01-SSCC-CNT          PIC  ZZZ,ZZ9 BLANK WHEN ZERO.01580019
015900         10  FILLER                  PIC  X(01)    VALUE SPACES.  01590019
016000         10  DTL01-UNIT-CNT          PIC  ZZZ,ZZ9 BLANK WHEN ZERO.01600019
016100         10  FILLER                  PIC  X(01)    VALUE SPACES.  01610019
016200         10  DTL01-PKSLP-CRE-DT      PIC  X(10)    VALUE SPACES.  01620019
016300         10  FILLER                  PIC  X(01)    VALUE SPACES.  01630019
016400         10  DTL01-BOL               PIC  X(16)    VALUE SPACES.  01640019
016500         10  FILLER                  PIC  X(01)    VALUE SPACES.  01650019
016600         10  DTL01-VENDOR            PIC  X(20)    VALUE SPACES.  01660019
016700         10  FILLER                  PIC  X(01)    VALUE SPACES.  01670019
016800         10  DTL01-CAN               PIC  X(20)    VALUE SPACES.  01680019
016810         10  FILLER                  PIC  X(11)    VALUE SPACES.  01681026
016820         10  DTL01-USERID            PIC  X(08)    VALUE SPACES.  01682020
016900     05  DTL02-LINE.                                              01690019
017000         10  FILLER                  PIC  X(15)    VALUE SPACES.  01700019
017100         10  FILLER                  PIC  X(08)                   01710019
017200                          VALUE 'TOTALS: '.                       01720019
017300         10  DTL02-TTL-CTNS      PIC Z,ZZZ,ZZ9 BLANK WHEN ZERO.   01730019
017400         10  FILLER                  PIC  X(01)    VALUE SPACES.  01740019
017500         10  DTL02-TTL-SSCC      PIC   ZZZ,ZZ9 BLANK WHEN ZERO.   01750019
017600         10  FILLER                  PIC  X(01)    VALUE SPACES.  01760019
017700         10  DTL02-TTL-UNITS     PIC ZZZ,ZZZ,ZZ9 BLANK WHEN ZERO. 01770019
017800         10  FILLER                  PIC  X(01)    VALUE SPACES.  01780019
017900                                                                  01790019
018000******************************************************            01800019
018100*  XLT00010 - DC LOCATION TABLE                      *            01810019
018200******************************************************            01820019
018300     EXEC SQL                                                     01830019
018400          INCLUDE XLT00010                                        01840019
018500     END-EXEC.                                                    01850019
018600******************************************************            01860019
018700*  TSHIPMT - TSHIPMT TABLE                           *            01870019
018800******************************************************            01880019
018900     EXEC SQL                                                     01890019
019000          INCLUDE TSHIPMT                                         01900019
019100     END-EXEC.                                                    01910019
019200******************************************************            01920019
019300*  TTRIPST - TTRIPST TABLE (TRIP STATUS)             *            01930019
019400******************************************************            01940019
019500     EXEC SQL                                                     01950019
019600          INCLUDE TTRIPST                                         01960019
019700     END-EXEC.                                                    01970019
019710******************************************************            01971021
019720*  TPKSLIP - TPKSLIP TABLE (PACKSLIP)                *            01972021
019730******************************************************            01973021
019740     EXEC SQL                                                     01974021
019750          INCLUDE TPKSLIP                                         01975021
019760     END-EXEC.                                                    01976021
019800******************************************************            01980019
019900*  DB2 AREA FOR COMMUNICATIONS                       *            01990019
020000******************************************************            02000019
020100     EXEC SQL                                                     02010019
020200          INCLUDE SQLCA                                           02020019
020300     END-EXEC.                                                    02030019
020400                                                                  02040019
020500     COPY SQLCA2.                                                 02050019
020600                                                                  02060019
020700 PROCEDURE DIVISION.                                              02070019
020800                                                                  02080019
020900     DISPLAY '***BEGINNING PCKRP036***'.                          02090019
021000******************************************************            02100019
021100* 0000-MAINLINE.                                     *            02110019
021200******************************************************            02120019
021300 0000-MAINLINE.                                                   02130019
021400                                                                  02140019
021500     PERFORM 0010-INITIALIZATION.                                 02150019
021600                                                                  02160019
021700     PERFORM 1000-PROCESS-INPUT                                   02170019
021800        THRU 1000-PROCESS-INPUT-EXIT                              02180019
021900         UNTIL ( PS-END-OF-INPUT ).                               02190019
022000                                                                  02200019
022100     PERFORM 0020-END-PROGRAM.                                    02210019
022200     GOBACK.                                                      02220019
022300                                                                  02230019
022400******************************************************            02240019
022500* 0010-INITIALIZATION.                               *            02250019
022600******************************************************            02260019
022700 0010-INITIALIZATION.                                             02270019
022800                                                                  02280019
022900     OPEN INPUT  INPUT01-FILE                                     02290019
023000          OUTPUT REPORT-FILE.                                     02300019
023100                                                                  02310019
023200     ACCEPT PV-TODAYS-DATE   FROM DATE.                           02320019
023300     ACCEPT PV-TODAYS-TIME   FROM TIME.                           02330019
023400                                                                  02340019
023500     MOVE PV-TODAYS-DATE-MM      TO DP150O-RUN-MONTH.             02350019
023600     MOVE PV-TODAYS-DATE-DD      TO DP150O-RUN-DAY.               02360019
023700     MOVE PV-TODAYS-DATE-YY      TO DP150O-RUN-YEAR.              02370019
023800     MOVE PV-TODAYS-TIME-HH      TO DP150O-RUN-HOUR.              02380019
023900     MOVE PV-TODAYS-TIME-MM      TO DP150O-RUN-MINUTE.            02390019
024000     MOVE PC-PROGRAM-NAME        TO DP150O-PROGRAM-NAME.          02400019
024100     MOVE PC-REPORT-NBR          TO DP150O-REPORT-NUMBER.         02410019
024200                                                                  02420019
024300     PERFORM 9050-REPORT-HEADERS.                                 02430019
024400                                                                  02440019
024500******************************************************            02450019
024600* 0020-END-PROGRAM.                                  *            02460019
024700******************************************************            02470019
024800 0020-END-PROGRAM.                                                02480019
024900                                                                  02490019
025000     PERFORM 3000-TOTAL-RECORD.                                   02500019
025100                                                                  02510019
025200     IF ( PV-LINE-CNT > PV-LINE-LIMIT )                           02520019
025300         PERFORM 9050-REPORT-HEADERS                              02530019
025400     END-IF.                                                      02540019
025500                                                                  02550019
025600     IF ( PS-FIRST-TIME )                                         02560019
025700         WRITE REPORT-RECORD FROM NO-DATA-TO-REPORT-LINE          02570019
025800              AFTER ADVANCING 2 LINES                             02580019
025900     END-IF.                                                      02590019
026000                                                                  02600019
026100     WRITE REPORT-RECORD FROM END-OF-REPORT-LINE                  02610019
026200          AFTER ADVANCING 3 LINES.                                02620019
026300                                                                  02630019
026400     CLOSE INPUT01-FILE                                           02640019
026500           REPORT-FILE.                                           02650019
026600                                                                  02660019
026700******************************************************            02670019
026800* 1000-PROCESS-INPUT.                                *            02680019
026900******************************************************            02690019
027000 1000-PROCESS-INPUT.                                              02700019
027100                                                                  02710019
027200     READ INPUT01-FILE INTO PC070-RECORD-LAYOUT                   02720019
027300         AT END MOVE 'Y' TO PS-END-OF-INPUT-SW                    02730019
027400                GO TO 1000-PROCESS-INPUT-EXIT.                    02740019
027500                                                                  02750019
027600     IF ( PS-FIRST-TIME )                                         02760019
027700         MOVE 'N' TO PS-FIRST-TIME-SW                             02770019
027800         MOVE PC070-OPER-UNT-ID TO PV-DC-LOCATION                 02780019
027900                                   HDR02-DC                       02790019
028000         PERFORM 2000-VALIDATE-DC                                 02800019
028100         PERFORM 9040-PAGE-HEADERS                                02810019
028200     END-IF.                                                      02820019
028300                                                                  02830019
028400     PERFORM 5000-REPORT-DETAIL.                                  02840019
028500                                                                  02850019
028600 1000-PROCESS-INPUT-EXIT.                                         02860019
028700     EXIT.                                                        02870019
028800                                                                  02880019
028900******************************************************            02890019
029000* 2000-VALIDATE-DC.                                  *            02900019
029100******************************************************            02910019
029200 2000-VALIDATE-DC.                                                02920019
029300                                                                  02930019
029400     MOVE PV-DC-LOCATION TO XLT00010-LOC-NBR.                     02940019
029500                                                                  02950019
029600     EXEC SQL                                                     02960019
029700         SELECT A.LOC_NM                                          02970019
029800           INTO :XLT00010-LOC-NM                                  02980019
029900           FROM XLT_LOC A                                         02990019
030000          WHERE A.LOC_NBR     = :XLT00010-LOC-NBR                 03000019
030100           WITH UR                                                03010019
030200     END-EXEC.                                                    03020019
030300                                                                  03030019
030400     EVALUATE TRUE                                                03040019
030500       WHEN SQLCODE = ZERO                                        03050019
030600           MOVE XLT00010-LOC-NM TO HDR02-DC-DESCRIPTION           03060019
030700       WHEN OTHER                                                 03070019
030800           MOVE SPACES          TO HDR02-DC-DESCRIPTION           03080019
030900     END-EVALUATE.                                                03090019
031000                                                                  03100019
031100******************************************************            03110019
031200 3000-TOTAL-RECORD.                                               03120019
031300                                                                  03130019
031400     IF ( PV-LINE-CNT > PV-LINE-LIMIT )                           03140019
031500         PERFORM 9050-REPORT-HEADERS                              03150019
031600         PERFORM 9040-PAGE-HEADERS                                03160019
031700     END-IF.                                                      03170019
031800                                                                  03180019
031900     MOVE PV-TOTAL-CARTONS         TO DTL02-TTL-CTNS.             03190019
032000     MOVE PV-TOTAL-SSCC            TO DTL02-TTL-SSCC.             03200019
032100     MOVE PV-TOTAL-UNITS           TO DTL02-TTL-UNITS.            03210019
032200                                                                  03220019
032300     WRITE REPORT-RECORD FROM DTL02-LINE                          03230019
032400            AFTER ADVANCING 1 LINE.                               03240019
032500                                                                  03250019
032600     ADD  +1     TO PV-LINE-CNT.                                  03260019
032700                                                                  03270019
032800******************************************************            03280019
032900* 5000-REPORT-DETAIL.                                *            03290019
033000******************************************************            03300019
033100 5000-REPORT-DETAIL.                                              03310019
033200                                                                  03320019
033300     IF ( PV-LINE-CNT > PV-LINE-LIMIT )                           03330019
033400         PERFORM 9050-REPORT-HEADERS                              03340019
033500         PERFORM 9040-PAGE-HEADERS                                03350019
033600     END-IF.                                                      03360019
033700                                                                  03370019
033800     MOVE PC070-OPER-UNT-ID        TO DTL01-DC.                   03380019
033900     MOVE PC070-SCAC               TO DTL01-SCAC.                 03390019
034000     MOVE PC070-PO-NBR             TO DTL01-PO.                   03400019
034100     MOVE PC070-REC-SEQ-NBR        TO DTL01-RECEIVER.             03410019
034200     MOVE PC070-CARTON-CNT         TO DTL01-CARTON-CNT.           03420019
034300     MOVE PC070-SSCC-CNT           TO DTL01-SSCC-CNT.             03430019
034400     MOVE PC070-UNIT-CNT           TO DTL01-UNIT-CNT.             03440019
034500     MOVE PC070-PKSLP-CRE-TS       TO DTL01-PKSLP-CRE-DT.         03450019
034600     MOVE PC070-BOL-NBR            TO DTL01-BOL.                  03460019
034700     MOVE PC070-VENDOR-NAME        TO DTL01-VENDOR.               03470019
034800     PERFORM 5500-GET-CAN.                                        03480019
034801     PERFORM 5510-GET-CREATE-USERID.                              03480121
034900                                                                  03490019
035000     WRITE REPORT-RECORD FROM DTL01-LINE                          03500019
035100            AFTER ADVANCING 1 LINE.                               03510019
035200                                                                  03520019
035300     ADD  +1 TO PV-LINE-CNT                                       03530019
035400                PV-NBR-OF-LINES.                                  03540019
035500                                                                  03550019
035600     COMPUTE PV-TOTAL-CARTONS      =                              03560019
035700             PV-TOTAL-CARTONS + PC070-CARTON-CNT.                 03570019
035800     COMPUTE PV-TOTAL-SSCC         =                              03580019
035900             PV-TOTAL-SSCC    + PC070-SSCC-CNT.                   03590019
036000     COMPUTE PV-TOTAL-UNITS        =                              03600019
036100             PV-TOTAL-UNITS   + PC070-UNIT-CNT.                   03610019
036200                                                                  03620019
036300******************************************************            03630019
036400* 5500-GET-CAN.                                      *            03640019
036500******************************************************            03650019
036600 5500-GET-CAN.                                                    03660019
036700                                                                  03670019
036800     EXEC SQL                                                     03680019
036900         SELECT DISTINCT CARR_AUTH_ID                             03690019
037000                        ,LAST_UPD_DTE                             03700019
037100                        ,LAST_UPD_TME                             03710019
037200           INTO :SHIPMT-CARR-AUTH-ID                              03720019
037300               ,:SHIPMT-LAST-UPD-DTE                              03730019
037400               ,:SHIPMT-LAST-UPD-TME                              03740019
037500           FROM TSHIPMT A                                         03750019
037600               ,TTRIPST B                                         03760019
037700          WHERE A.TRIP_ID      = :PC070-TRIP-ID                   03770019
037800            AND A.PRO_SCAC_ID  = :PC070-SCAC                      03780019
037900            AND A.CARR_AUTH_ID > ' '                              03790019
038000            AND B.TRIP_ID      = A.TRIP_ID                        03800019
038100            AND B.OPER_UNT_ID  = :PC070-OPER-UNT-ID               03810019
038200          ORDER BY  LAST_UPD_DTE DESC                             03820019
038300                   ,LAST_UPD_TME DESC                             03830019
038400          WITH UR                                                 03840019
038500     END-EXEC.                                                    03850019
038600     EVALUATE TRUE                                                03860019
038700       WHEN SQLCODE = ZERO                                        03870019
038800       WHEN SQLCODE = -811                                        03880019
038900           MOVE SHIPMT-CARR-AUTH-ID  TO DTL01-CAN                 03890019
039000       WHEN OTHER                                                 03900019
039100           MOVE SPACES               TO DTL01-CAN                 03910019
039200     END-EVALUATE.                                                03920019
039201                                                                  03920121
039210******************************************************            03921021
039220* 5510-GET-CREATE-USERID                             *            03922021
039230******************************************************            03923021
039240 5510-GET-CREATE-USERID.                                          03924021
039250                                                                  03925021
039260     EXEC SQL                                                     03926021
039270         SELECT CRE_UID                                           03927021
039280              , CRE_TMST                                          03928023
039291           INTO :PKSLIP-CRE-UID                                   03929121
039292              , :PKSLIP-CRE-TMST                                  03929223
039294           FROM TPKSLIP                                           03929421
039296          WHERE OPER_UNT_ID    = :PC070-OPER-UNT-ID               03929621
039297            AND PO_NBR         = :PC070-PO-NBR                    03929721
039298            AND REC_SEQ_NBR    = :PC070-REC-SEQ-NBR               03929821
039299            AND SEQ_NBR        = :PC070-PKSLP-SEQ-NBR             03929921
039304          ORDER BY CRE_TMST DESC                                  03930423
039305          WITH UR                                                 03930523
039306     END-EXEC.                                                    03930623
039307     EVALUATE TRUE                                                03930723
039308       WHEN SQLCODE = ZERO                                        03930823
039309       WHEN SQLCODE = -811                                        03930923
039310           IF  PKSLIP-CRE-UID = 'RCKUP006'                        03931025
039311               MOVE SPACES           TO PKSLIP-CRE-UID            03931126
039312           END-IF                                                 03931223
039313           MOVE PKSLIP-CRE-UID       TO DTL01-USERID              03931323
039314       WHEN OTHER                                                 03931423
039315           MOVE SPACES               TO DTL01-USERID              03931523
039316     END-EVALUATE.                                                03931623
039320******************************************************            03932019
039400* 9040-PAGE-HEADERS.                                 *            03940019
039500******************************************************            03950019
039600 9040-PAGE-HEADERS.                                               03960019
039700                                                                  03970019
039800     IF ( PV-LINE-CNT > PV-LINE-LIMIT )                           03980019
039900         PERFORM 9050-REPORT-HEADERS                              03990019
040000     END-IF.                                                      04000019
040100                                                                  04010019
040200     WRITE REPORT-RECORD FROM HDR02-LINE                          04020019
040300            AFTER ADVANCING 2 LINES.                              04030019
040400     WRITE REPORT-RECORD FROM HDR03-LINE                          04040019
040500            AFTER ADVANCING 1 LINE.                               04050019
040600     WRITE REPORT-RECORD FROM HDR04-LINE                          04060019
040700            AFTER ADVANCING 1 LINES.                              04070019
040800     WRITE REPORT-RECORD FROM HDR05-LINE                          04080019
040900            AFTER ADVANCING 1 LINE.                               04090019
041000                                                                  04100019
041100     ADD  +5 TO PV-LINE-CNT.                                      04110019
041200                                                                  04120019
041300******************************************************            04130019
041400* 9050-REPORT-HEADERS.                               *            04140019
041500******************************************************            04150019
041600 9050-REPORT-HEADERS.                                             04160019
041700                                                                  04170019
041800     ADD +1           TO PV-PAGE-CNT.                             04180019
041900     MOVE PV-PAGE-CNT TO DP150O-PAGE-NUMBER.                      04190019
042000                                                                  04200019
042100     WRITE REPORT-RECORD FROM DP150O-STANDRD-HEADER-150-COLS      04210019
042200            AFTER ADVANCING PAGE.                                 04220019
042300     WRITE REPORT-RECORD FROM HDR01-LINE                          04230019
042400            AFTER ADVANCING 1 LINE.                               04240019
042500                                                                  04250019
042600     MOVE +2 TO PV-LINE-CNT.                                      04260019
042700                                                                  04270019
