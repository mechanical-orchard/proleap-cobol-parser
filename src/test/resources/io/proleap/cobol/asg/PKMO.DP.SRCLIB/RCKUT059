000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    RCKUT059.                                         00020001
000300 AUTHOR.        DENISE HAHN.                                      00030000
000310 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00031000
000320 DATE-WRITTEN.  3/26/98.                                          00032001
000334****************************************************************  00033401
000335*  THIS PROGRAM WILL UPDATE THE EXTRACT FILE CREATED BY        *  00033501
000336*  RCKUT058, WITH THE VENDOR DESCRIPTION FROM THE TENTNME      *  00033601
000337*  TABLE                                                       *  00033701
000370****************************************************************  00037001
000380 ENVIRONMENT DIVISION.                                            00038001
000390 INPUT-OUTPUT SECTION.                                            00039001
000400                                                                  00040001
000500 FILE-CONTROL.                                                    00050001
000600                                                                  00060001
000700     SELECT EXTRACT-FILE-IN    ASSIGN TO UT-S-INP01.              00070001
000800     SELECT EXTRACT-FILE-OUT   ASSIGN TO UT-S-OUT02.              00080001
000900                                                                  00090001
001000 DATA DIVISION.                                                   00100001
001100                                                                  00110001
001200 FILE SECTION.                                                    00120001
001210*                                                                 00121001
001220 FD  EXTRACT-FILE-IN                                              00122001
001230     RECORDING MODE IS F                                          00123001
001240     LABEL RECORDS ARE STANDARD                                   00124001
001250     RECORD CONTAINS 250                                          00125001
001260     BLOCK CONTAINS 0 RECORDS                                     00126001
001270     DATA RECORD IS EXTRACT-RECORD-IN.                            00127001
001280 01  EXTRACT-RECORD-IN          PIC X(250).                       00128001
001290*                                                                 00129001
001300 FD  EXTRACT-FILE-OUT                                             00130001
001400     RECORDING MODE IS F                                          00140001
001500     LABEL RECORDS ARE STANDARD                                   00150001
001600     RECORD CONTAINS 250                                          00160001
001700     BLOCK CONTAINS 0 RECORDS                                     00170001
001800     DATA RECORD IS EXTRACT-RECORD-OUT.                           00180001
001900 01  EXTRACT-RECORD-OUT          PIC X(250).                      00190001
002000*                                                                 00200001
002100/                                                                 00210001
002200 WORKING-STORAGE SECTION.                                         00220001
002300                                                                  00230001
003600*                                                                 00360001
003700 01  PS-PROGRAM-SWITCHES.                                         00370001
003800     05  PS-EOF-INPUT-SW              PIC X(01)  VALUE 'N'.       00380001
003900         88  PS-EOF-INPUT                        VALUE 'Y'.       00390001
004380                                                                  00438001
004390 01  PV-PROGRAM-VARIABLES.                                        00439001
005000                                                                  00500001
005001     05  PV-ABEND-CODE                PIC S9(04)   VALUE +0       00500103
005002                                                   COMP SYNC.     00500203
005010     05  PV-INPUT-COUNT               PIC  9(09) VALUE ZEROES.    00501002
005020     05  PV-OUTPUT-COUNT              PIC  9(09) VALUE ZEROES.    00502002
005021     05  PV-DISPLAY-COUNT             PIC ZZZ,ZZZ,ZZ9.            00502103
005022     05  PV-ENTNME-ENT-NAME-DESC      PIC  X(30) VALUE SPACE.     00502205
005030                                                                  00503002
012600     05  PV-DEPT                      PIC  X(03).                 01260003
016200     05  PV-SQLCODE                   PIC 9(9)  VALUE ZERO.       01620003
019516                                                                  01951601
022125                                                                  02212501
022126 01  PV-ABEND-FIELDS.                                             02212601
022127     05  PV-ABEND-PROGRAM             PIC X(8)   VALUE 'RCKUT059'.02212702
022128     05  PV-ABEND-PARAGRAPH           PIC X(50)  VALUE SPACES.    02212802
022129     05  PV-ABEND-OPERATION           PIC X(50)  VALUE SPACES.    02212902
022130     05  PV-ABEND-STRUCTURE-1         PIC X(8)   VALUE SPACES.    02213002
022131     05  PV-ABEND-STRUCTURE-2         PIC X(8)   VALUE SPACES.    02213102
022132     05  PV-ABEND-STRUCTURE-3         PIC X(8)   VALUE SPACES.    02213202
022133     05  PV-DB2-OPERATION-MESSAGE-1   PIC  X(79) VALUE SPACES.    02213302
022134     05  PV-DB2-OPERATION-MESSAGE-2   PIC  X(79) VALUE SPACES.    02213402
022135     05  PV-DB2-OPERATION-MESSAGE-3   PIC  X(79) VALUE SPACES.    02213502
022136     05  PV-DB2-OPERATION-MESSAGE-4   PIC  X(79) VALUE SPACES.    02213602
022137     05  PV-DB2-TABLE-NAME            PIC  X(8)  VALUE SPACES.    02213702
022138                                                                  02213801
022139 01  WS-WORKING-STORAGE-HOLD-FIELDS.                              02213901
022140*                                                                 02214001
022150     05  WS-PREVIOUS-ENT-ID           PIC S9(09) VALUE ZEROES     02215001
022160                                                 COMP.            02216001
022430******************************************************************02243001
022431*  USED FOR DB2 ERROR MESSAGE BUILDING                            02243101
022432******************************************************************02243201
022433     COPY DPWS004.                                                02243312
022434                                                                  02243403
022435                                                                  02243503
022436******************************************************************02243601
022437*   DB2 SQL COMMUNICATION AREA                                    02243701
022438******************************************************************02243801
022439     EXEC SQL                                                     02243901
022440          INCLUDE SQLCA                                           02244001
022450     END-EXEC.                                                    02245001
022460                                                                  02246001
022470******************************************************************02247001
022480*   DB2 DCLGEN FOR TENTNME TABLE                                  02248001
022490******************************************************************02249001
022500     EXEC SQL                                                     02250001
022600          INCLUDE TENTNME                                         02260001
022700     END-EXEC.                                                    02270001
022800                                                                  02280001
022900                                                                  02290001
030500***********************************************************       03050001
030600*  COPYBOOK USED IN CREATING EXTRACT FILE.                *       03060001
030700***********************************************************       03070001
030800     COPY RCRD035.                                                03080012
030900*                                                                 03090001
031000/                                                                 03100001
031010 PROCEDURE DIVISION.                                              03101001
031020                                                                  03102001
031030     PERFORM 1000-INITIALIZATION.                                 03103001
031040                                                                  03104001
031050     PERFORM 2000-PROCESS-EXTRACTS                                03105001
031060         UNTIL PS-EOF-INPUT.                                      03106001
031090                                                                  03109001
031100     CLOSE EXTRACT-FILE-IN                                        03110001
031200           EXTRACT-FILE-OUT.                                      03120001
031300                                                                  03130001
031400     MOVE PV-INPUT-COUNT TO PV-DISPLAY-COUNT                      03140001
031500     DISPLAY 'NUMBER OF INPUT RECORDS READ      '                 03150001
031600                                  PV-DISPLAY-COUNT.               03160001
031700     MOVE PV-OUTPUT-COUNT TO PV-DISPLAY-COUNT                     03170001
031800     DISPLAY 'NUMBER OF EXTRACT RECORDS WRITTEN '                 03180001
031900                                  PV-DISPLAY-COUNT.               03190001
032000     DISPLAY '                                      '.            03200001
032100     DISPLAY '--------------------------------------'.            03210001
032200                                                                  03220001
032300     GOBACK.                                                      03230001
032400                                                                  03240001
032500/                                                                 03250001
032510 1000-INITIALIZATION.                                             03251001
032520     MOVE '1000-INITIALIZATION     '   TO PV-ABEND-PARAGRAPH.     03252001
032540                                                                  03254001
032550     OPEN INPUT  EXTRACT-FILE-IN                                  03255001
032560          OUTPUT EXTRACT-FILE-OUT.                                03256001
033600                                                                  03360001
033700     DISPLAY '--------------------------------------'.            03370001
033800     DISPLAY '-        PROGRAM - RCKUT059          -'.            03380001
033900     DISPLAY '--------------------------------------'.            03390001
034000     DISPLAY '                                      '.            03400001
034100                                                                  03410001
034107     PERFORM 7000-READ-INPUT.                                     03410701
034110                                                                  03411009
042232                                                                  04223201
042233 2000-PROCESS-EXTRACTS.                                           04223301
042234                                                                  04223409
042235     ADD  1                          TO  PV-INPUT-COUNT.          04223509
042236                                                                  04223609
042285*-----------------------------------------------------------------04228501
042286* GET VENDOR DESCRIPTION FROM ENTITY NAME TABLE (TENTNME)         04228601
042287*-----------------------------------------------------------------04228701
042288     PERFORM 3000-TENTNME-INFO.                                   04228801
042329                                                                  04232901
042330*-----------------------------------------------------------------04233001
042331* POPULATE EXTRACT RECORD FIELDS                                  04233101
042332*-----------------------------------------------------------------04233201
042341     MOVE PV-ENTNME-ENT-NAME-DESC    TO  RC035-VEND-DESC.         04234101
042359                                                                  04235901
042360     WRITE EXTRACT-RECORD-OUT FROM RC035-RCVR-EXTRACT-RECORD.     04236001
042361                                                                  04236101
042362     ADD  1                          TO  PV-OUTPUT-COUNT.         04236204
042363                                                                  04236301
042364     PERFORM 7000-READ-INPUT.                                     04236409
048461                                                                  04846101
048462                                                                  04846201
048463 3000-TENTNME-INFO.                                               04846301
048464*-----------------------------------------------------------------04846401
048465* GET VENDOR DESCRIPTION FROM ENTITY NAME TABLE (TENTNME)         04846501
048466*-----------------------------------------------------------------04846601
048467     MOVE '3000-TENTNME-INFO       ' TO PV-ABEND-PARAGRAPH.       04846701
048469                                                                  04846901
048470     EXEC SQL                                                     04847001
048480          SELECT ENT_ID                                           04848001
048490                ,ENT_NAME_DESC                                    04849001
048500          INTO :ENTNME-ENT-ID                                     04850001
048600              ,:ENTNME-ENT-NAME-DESC                              04860001
048700          FROM TENTNME                                            04870001
048800          WHERE ENT_ID         = :RC035-ENT-ID                    04880010
048900            AND TYPE_CDE       = '01'                             04890001
049000     END-EXEC.                                                    04900001
049100                                                                  04910001
049200     EVALUATE TRUE                                                04920001
049300         WHEN SQLCODE = +0                                        04930001
049310             MOVE ENTNME-ENT-NAME-DESC TO PV-ENTNME-ENT-NAME-DESC 04931011
049500         WHEN SQLCODE = +100                                      04950001
049600             CONTINUE                                             04960001
049700         WHEN OTHER                                               04970001
049800              MOVE '3400-TENTNME-INFO'                            04980001
049900                           TO PV-ABEND-PARAGRAPH                  04990001
050000              MOVE 'SELECT TENTNME       '                        05000001
050100                           TO PV-ABEND-OPERATION                  05010001
050200              MOVE 'TENTNME'   TO PV-ABEND-STRUCTURE-1            05020001
050300              MOVE PV-DEPT     TO PV-ABEND-STRUCTURE-2            05030001
050400              PERFORM 9900-DB2-ABEND                              05040001
050500     END-EVALUATE.                                                05050001
057100                                                                  05710001
057300 7000-READ-INPUT.                                                 05730001
057312                                                                  05731201
057313     MOVE '7000-READ-INPUT'   TO PV-ABEND-PARAGRAPH.              05731301
057314                                                                  05731401
057315     READ EXTRACT-FILE-IN  INTO  RC035-RCVR-EXTRACT-RECORD        05731501
057317         AT END                                                   05731701
057318             SET PS-EOF-INPUT TO TRUE.                            05731804
057319                                                                  05731901
057320                                                                  05732001
067221                                                                  06722101
067222*                                                                 06722201
067293 9900-DB2-ABEND.                                                  06729301
067294                                                                  06729401
067295     MOVE SQLCODE TO PV-SQLCODE.                                  06729501
067296     DISPLAY '*** DB2 ERROR '.                                    06729601
067297     DISPLAY '*** SQLCODE   = ' PV-SQLCODE.                       06729701
067298     DISPLAY '*** PROGRAM   = ' PV-ABEND-PROGRAM.                 06729801
067299     DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               06729901
067300     DISPLAY '*** OPERATION = ' PV-ABEND-OPERATION.               06730001
067400     DISPLAY '*** MESSAGE   = ' PV-DB2-OPERATION-MESSAGE-1.       06740001
067500     DISPLAY '***           = ' PV-DB2-OPERATION-MESSAGE-2.       06750001
067600     DISPLAY '***           = ' PV-DB2-OPERATION-MESSAGE-3.       06760001
067700     DISPLAY '*** TABLE 1   = ' PV-ABEND-STRUCTURE-1.             06770001
067800                                                                  06780001
067900     IF PV-ABEND-STRUCTURE-2 > SPACES                             06790001
068000         DISPLAY '*** TABLE 2   = ' PV-ABEND-STRUCTURE-2          06800001
068100     END-IF.                                                      06810001
068200                                                                  06820001
068300                                                                  06830001
068400     COPY DPPD004.                                                06840012
068500                                                                  06850001
068600                                                                  06860001
068700     MOVE +4013                  TO PV-ABEND-CODE.                06870001
068800     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         06880001
