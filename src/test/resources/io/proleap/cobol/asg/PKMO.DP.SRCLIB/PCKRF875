000100 IDENTIFICATION DIVISION.                                         00010057
000200 TITLE 'MANIFESTING - REOPEN A CLOSED TRAILER'.                   00020057
000300                                                                  00030057
000400 PROGRAM-ID.             PCKRF875.                                00040057
000500 AUTHOR.                 DENNIS STEFFEN.                          00050057
000600 INSTALLATION.           KOHLS.                                   00060057
000700 DATE-WRITTEN.           APRIL 2001.                              00070057
000800 DATE-COMPILED.                                                   00080057
000900                                                                  00090057
001000                                                                  00100057
001100 ENVIRONMENT DIVISION.                                            00110057
001200 DATA DIVISION.                                                   00120057
001300                                                                  00130057
001400 WORKING-STORAGE SECTION.                                         00140057
001500                                                                  00150057
001600 01  PC-PROGRAM-CONSTANTS.                                        00160057
001700     05  PC-TRANID                    PIC X(04) VALUE 'E875'.     00170057
001800     05  PC-DLX                       PIC X(03) VALUE 'DLX'.      00180057
001900     05  PC-DLSHPI                    PIC X(06) VALUE 'DLSHPI'.   00190057
002000     05  PC-Y                         PIC X(01) VALUE 'Y'.        00200057
002100     05  PC-SHIPPING                  PIC X(08) VALUE 'SHIPPING'. 00210057
002200     05  PC-TRAILER-OPEN              PIC X(12) VALUE             00220057
002300         'TRAILER OPEN'.                                          00230057
002400     05  PV-CICS-MSG-AREA2            PIC X(100) VALUE SPACES.    00240057
002500     05  PV-ERROR-MESSAGE             PIC X(45) VALUE SPACES.     00250057
002600     05  PC-CURRENT-PROGRAM-NAME      PIC X(08) VALUE 'PCKRF875'. 00260057
002700     05  PC-DUMMY-TIMESTAMP           PIC X(26) VALUE             00270057
002800            '9999-09-09-09.09.09.999999'.                         00280057
002900     05  PC-MUST-BE-NUM-MSG           PIC X(19) VALUE             00290057
003000                                           'MUST BE NUMERIC    '. 00300057
003100     05  PV-DISPLAY-DOOR-ID           PIC  X(04)  VALUE SPACE.    00310057
003200     05  PV-DISPLAY-OPER              PIC  9(04)  VALUE ZEROES.   00320057
003300     05  PV-DISPLAY-DEST              PIC  9(04)  VALUE ZEROES.   00330057
003400     05  PV-DISPLAY-SEQ-NBR           PIC  9(11)  VALUE ZEROES.   00340057
003410     05  PV-DISPLAY-SRL-NBR           PIC  9(09)  VALUE ZEROES.   00341057
003420     05  PV-DISPLAY-SCAC              PIC  X(04)  VALUE SPACES.   00342057
003430     05  PV-DISPLAY-TRLR-ID           PIC  X(12)  VALUE ZEROES.   00343057
003440     05  PV-DISPLAY-TRIP              PIC  9(09)  VALUE ZEROES.   00344057
003450     05  PV-CURRENT-TIMESTAMP         PIC  X(26)  VALUE ZEROES.   00345057
003460                                                                  00346057
003470                                                                  00347057
003480* ERROR MESSAGES                                                 *00348057
003490     05  PC-UNRECOGNIZED-PF-KEY-MSG   PIC X(19) VALUE             00349057
003500                                           'UNRECOGNIZED PF KEY'. 00350057
003600     05  PC-ENTER-THROUGH-MENU-MSG    PIC X(19) VALUE             00360057
003700                                           'ENTER THROUGH MENU '. 00370057
003800     05  PC-TRANS-UNAVAILABLE-MSG     PIC X(19) VALUE             00380057
003900                                           'TRANS NOT AVAILABLE'. 00390057
004000     05  PC-WRONG-FACILITY            PIC X(19) VALUE             00400057
004100                                           'WRG FCLTY - F2 CONF'. 00410057
004200                                                                  00420057
004300 01  PS-PROGRAM-SWITCHES.                                         00430057
004400     05  PS-ERROR-SW                  PIC X(01)  VALUE 'N'.       00440057
004500         88  PS-ERRORS-YES                        VALUE 'Y'.      00450057
004600         88  PS-ERRORS-NO                         VALUE 'N'.      00460057
004700     05  PS-VALID-INPUT-SW            PIC  X(01)  VALUE 'N'.      00470057
004800         88  PS-VALID-INPUT                       VALUE 'Y'.      00480057
004900         88  PS-INVALID-INPUT                     VALUE 'N'.      00490057
005000     05  PS-XCTL-SW                   PIC X(04)   VALUE SPACES.   00500057
005100         88  PS-XCTL-E871                       VALUE 'E871'.     00510057
005200     05  PS-TCNTRID-SW                PIC X(01) VALUE 'N'.        00520057
005300         88  PS-TSUOBTS-YES                       VALUE 'Y'.      00530057
005400         88  PS-TSUOBTS-NO                        VALUE 'N'.      00540057
005500     05  PS-TRLR-SEALED-SW            PIC X(01) VALUE 'N'.        00550057
005600         88  PS-TRLR-SEALED                       VALUE 'Y'.      00560057
005700         88  PS-TRLR-NOT-SEALED                   VALUE 'N'.      00570057
005800     05  PS-OPEN-FOR-AUDIT-SW         PIC X(01) VALUE 'N'.        00580057
005900         88  PS-OPEN-FOR-AUDIT-YES                VALUE 'Y'.      00590057
006000         88  PS-OPEN-FOR-AUDIT-NO                 VALUE 'N'.      00600057
006100     05  PS-VALID-DOOR-ID-SW          PIC X(01) VALUE 'N'.        00610057
006200         88  PS-VALID-DOOR-YES                    VALUE 'Y'.      00620057
006300         88  PS-VALID-DOOR-NO                     VALUE 'N'.      00630057
006400     05  PS-DOOR-GROUP-FOUND-SW       PIC X(01) VALUE 'N'.        00640057
006500         88  PS-DOOR-GROUP-FOUND-YES            VALUE 'Y'.        00650057
006600         88  PS-DOOR-GROUP-FOUND-NO             VALUE 'N'.        00660057
006610     05  PS-ANOTHER-OPEN-SW           PIC X(01) VALUE 'N'.        00661063
006620         88  PS-ANOTHER-OPEN-NO                 VALUE 'N'.        00662059
006630         88  PS-ANOTHER-OPEN-YES                VALUE 'Y'.        00663059
006700                                                                  00670057
006800 01  PV-PROGRAM-VARIABLES.                                        00680057
006900     05  PV-DB2-COUNT                 PIC S9(03) COMP-3.          00690057
007000     05  PV-COMMAREA-LENGTH           PIC S9(04)  VALUE +0        00700057
007100                                                     COMP SYNC.   00710057
007200     05  PV-MESSAGE-AREA              PIC  X(19)  VALUE SPACE.    00720057
007300     05  PV-CICS-RESPONSE             PIC S9(09)  VALUE ZEROS     00730057
007400                                                     COMP SYNC.   00740057
007500     05  PV-TRANSFER-PROGRAM          PIC  X(08)  VALUE SPACE.    00750057
007600                                                                  00760057
007700     05  PV-SUB                       PIC S9(4) COMP              00770057
007800                                                VALUE ZERO.       00780057
007940     05  PV-COUNT                     PIC S9(4) COMP              00794059
008000                                                VALUE ZERO.       00800057
008010     05  PV-ERROR-DOOR                PIC X(04) VALUE SPACES.     00801059
008020     05  PV-ERROR-SCAC                PIC X(04) VALUE SPACES.     00802059
008021     05  PV-ERROR-SRL                 PIC S9(9) COMP.             00802167
008030     05  PV-ERROR-TRLR                PIC X(12) VALUE SPACES.     00803066
008040     05  PV-ERROR-TRIP                PIC S9(9) COMP.             00804059
008100                                                                  00810057
008200 01  PV-LOG-MSG.                                                  00820057
008300     05  FILLER                       PIC X(12) VALUE             00830057
008400         ' E875 ERROR '.                                          00840057
008500     05  FILLER                       PIC X(06) VALUE             00850057
008600         'USER= '.                                                00860057
008700     05  PV-USER-ID                   PIC X(08) VALUE SPACES.     00870057
008800     05  FILLER                       PIC X(10) VALUE             00880057
008900         ' SQLCODE= '.                                            00890057
009000     05  PV-SQLCODE                   PIC -9(03).                 00900057
009100     05  FILLER                       PIC X(06) VALUE             00910057
009200         ' ERR= '.                                                00920057
009300     05  PV-ERROR-NBR                 PIC 9(03) VALUE ZERO.       00930057
009400     05  FILLER                       PIC X(07) VALUE             00940057
009500         ' DOOR= '.                                               00950057
009600     05  PV-DISPLAY-DOOR              PIC X(04) VALUE ZEROES.     00960057
009700/                                                                 00970057
009800 01  PV-EDITING-FIELDS.                                           00980057
009900     05  PV-SCREEN-DOOR               PIC X(04).                  00990057
010000     05  PV-SCREEN-DEST               PIC X(04).                  01000057
010100     05  PV-SCREEN-SERIAL-NBR         PIC X(09).                  01010057
010200                                                                  01020057
010300/                                                                 01030057
010400 01  CA-COMMAREA.                                                 01040057
010500     COPY PCWS233.                                                01050057
010600     05  CA-PRIVATE-COMMAREA          PIC X(100).                 01060063
010700     05  CA-REDEFINED-COMMAREA REDEFINES CA-PRIVATE-COMMAREA.     01070063
010800         10  CA-CURR-SEAL             PIC X(20).                  01080063
010810         10  FILLER                   PIC X(80).                  01081063
010900/                                                                 01090057
011000*  MAP LAYOUT                                                     01100057
011100     COPY PCKM875.                                                01110057
011200                                                                  01120057
011300* HELP SCREEN COMMAREA                                            01130057
011400     COPY PCWS192.                                                01140057
011500* HELP SCREEN WORK AREA                                           01150057
011600     COPY PCWS188.                                                01160057
011700/                                                                 01170057
011800* COMMAREA FOR TRAILER AUDIT                                      01180057
011900     COPY PCWS045.                                                01190057
012000*         USED TO CALL DLKUP001 TO SECURE NEXT SEQ #              01200057
012100     COPY DLWS001.                                                01210057
012200*         ????                                                    01220057
012300     COPY DLWS011.                                                01230057
012400*         USED TO CALL DLKCS410                                   01240057
012500     COPY DLWS016.                                                01250057
012600*         USED WHEN CALLING XLKUP033 TO INSERT BUSINESS EVENT ROWS01260057
012700     COPY XLWS072.                                                01270057
012800     COPY PCWS242.                                                01280057
012900/                                                                 01290057
013000     COPY DPWS010I.                                               01300057
013100*  KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST   01310057
013200     COPY DPWS015.                                                01320057
013300                                                                  01330057
013400*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      01340057
013500     COPY DFHAID.                                                 01350057
013600                                                                  01360057
013700*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               01370057
013800     COPY DPWS013.                                                01380057
013900                                                                  01390057
014000/                                                                 01400057
014100*    OUTBOUND TRAILER DEFINITION                                  01410061
014200     EXEC SQL                                                     01420057
014300         INCLUDE TCNTRID                                          01430061
014400     END-EXEC.                                                    01440057
014401                                                                  01440161
014402*    OUTBOUND TRIP                                                01440261
014403     EXEC SQL                                                     01440361
014404         INCLUDE TSUOBTR                                          01440461
014405     END-EXEC.                                                    01440561
014406                                                                  01440661
014410*    OUTBOUND TRAILER STATUS                                      01441061
014420     EXEC SQL                                                     01442061
014430         INCLUDE TSUOBTS                                          01443061
014440     END-EXEC.                                                    01444061
014500*    DC DOOR TABLE                                                01450057
014600     EXEC SQL                                                     01460057
014700         INCLUDE TCNDCDR                                          01470057
014800     END-EXEC.                                                    01480057
014900                                                                  01490057
015000*    SUT_TRIP_WRKR_AUD                                            01500057
015100     EXEC SQL                                                     01510057
015200         INCLUDE SUT00006                                         01520057
015300     END-EXEC.                                                    01530057
015400                                                                  01540057
015500*    DOOR GROUP TEMPLATE                                          01550057
015600     EXEC SQL                                                     01560057
015700         INCLUDE DLT00000                                         01570057
015800     END-EXEC.                                                    01580057
015900                                                                  01590057
016000*    DOOR GROUP                                                   01600057
016100     EXEC SQL                                                     01610057
016200         INCLUDE DLT00001                                         01620057
016300     END-EXEC.                                                    01630057
016400                                                                  01640057
016500*    KOHLS TO RETEK PROCESSING PARAMETERS                         01650057
016600     EXEC SQL                                                     01660057
016700         INCLUDE TKRPRPM                                          01670057
016800     END-EXEC.                                                    01680057
016900                                                                  01690057
017000     EXEC SQL                                                     01700057
017100         INCLUDE SQLCA                                            01710057
017200     END-EXEC.                                                    01720057
017300                                                                  01730057
017400 LINKAGE SECTION.                                                 01740057
017500 01  DFHCOMMAREA.                                                 01750057
017600     05  FILLER                         OCCURS  1 TO 4072 TIMES   01760057
017700                                      DEPENDING ON EIBCALEN.      01770057
017800         10  FILLER                   PIC X.                      01780057
017900/                                                                 01790057
018000 PROCEDURE DIVISION.                                              01800057
018100 0000-PROGRAM-MAINLINE.                                           01810057
018200                                                                  01820057
018300     INITIALIZE CA-COMMAREA                                       01830057
018400     MOVE DFHCOMMAREA                 TO CA-COMMAREA              01840057
018500                                                                  01850057
018600     EVALUATE TRUE                                                01860057
018700         WHEN EIBCALEN = ZERO                                     01870057
018800             MOVE PC-ENTER-THROUGH-MENU-MSG                       01880057
018900                                      TO PV-MESSAGE-AREA          01890057
019000             PERFORM 8110-RETURN                                  01900057
019100                                                                  01910057
019200         WHEN EIBTRNID = 'Z278'                                   01920057
019300*            RETURNING FROM F1 HELP INFO SCREEN                   01930057
019400             MOVE DFHCOMMAREA         TO PC192-COMMAREA           01940057
019500             MOVE PC192-HOST-SAVE-AREA                            01950057
019600                                      TO CA-COMMAREA              01960057
019700             SET PC233-PROCESS-SCREEN TO TRUE                     01970057
019800             MOVE PC192-HOST-SAVE-MAP TO PC875AO                  01980057
019900             MOVE -1                  TO ASEALL                   01990057
020000             PERFORM 8000-SEND-MAP                                02000057
020100             PERFORM 8100-RETURN-TRANID                           02010057
020200                                                                  02020057
020300         WHEN PC233-INITIALIZE-SCREEN                             02030057
020400         WHEN EIBAID = DFHCLEAR                                   02040057
020500             SET PC233-PROCESS-SCREEN TO TRUE                     02050057
020600             PERFORM 1000-INITIALIZE                              02060057
020700             PERFORM 8000-SEND-MAP                                02070057
020800             PERFORM 8100-RETURN-TRANID                           02080057
020900*                                                                 02090057
021000         WHEN PC233-UPDATE-CONFIRMED                              02100057
021100             SET PC233-PROCESS-SCREEN TO TRUE                     02110057
021200             IF PC233-ROOT-PROGRAM = 'PCKRF892'                   02120057
021300                SET PS-OPEN-FOR-AUDIT-YES TO TRUE                 02130057
021400                PERFORM 2000-PROCESS                              02140057
021500                PERFORM 8230-XCTL-TO-AUDIT-ROOT                   02150057
021600             END-IF                                               02160057
021700                                                                  02170057
021800*            IF IN THE AUDIT SYSTEM, YOU WILL NOT GO PAST         02180057
021900*            THIS POINT                                           02190057
022000                                                                  02200057
022100             PERFORM 2000-PROCESS                                 02210057
022200             IF PS-ERRORS-NO                                      02220057
022300                 IF PC233-DIVERT-NBR > ZERO                       02230057
022400                         AND PC233-DIVERT-LOC-ID > SPACES         02240057
022500                     SET PC233-CUTOFF-START-CTN                   02250057
022600                                      TO TRUE                     02260057
022700                     MOVE 'PCKRF874'  TO PV-TRANSFER-PROGRAM      02270057
022800                     PERFORM 8200-XCTL                            02280057
022900                 ELSE                                             02290057
023000* DMH 8/7/02 BEGIN                                                02300057
023100*                    MOVE 'RE-OPEN TRAILER'                       02310057
023200*                                     TO AHDGO                    02320057
023300*                    MOVE 'TRAILER REOPENED'                      02330057
023400*                                     TO AMSGLNO                  02340057
023500*                    MOVE -1  TO ASEALL                           02350057
023600*                    PERFORM 8010-SEND-DATA-ONLY                  02360057
023700*                    PERFORM 8100-RETURN-TRANID                   02370057
023800                                                                  02380057
023900                     PERFORM 1000-INITIALIZE                      02390057
024000                     IF  PC233-ROOT-PROGRAM  = 'PCKRF875'         02400057
024100                         SET  PC233-TRAILER-REOPENED  TO  TRUE    02410057
024200                     END-IF                                       02420057
024300                     MOVE 'TRAILER REOPENED'  TO  AMSGLNO         02430057
024400                     PERFORM 8000-SEND-MAP                        02440057
024500                     PERFORM 8100-RETURN-TRANID                   02450057
024600* DMH 8/7/02 END                                                  02460057
024700                 END-IF                                           02470057
024800             END-IF                                               02480057
024900         WHEN EIBAID = DFHENTER                                   02490057
025000             PERFORM 8020-RECEIVE-MAP                             02500057
025100* DMH 8/7/02 BEGIN                                                02510057
025200             IF  PC233-TRAILER-REOPENED                           02520057
025300                 MOVE  PC233-MENU-PROGRAM                         02530057
025400                   TO PV-TRANSFER-PROGRAM                         02540057
025500                 PERFORM 8200-XCTL                                02550057
025600             ELSE                                                 02560057
025700* DMH 8/7/02 END                                                  02570057
025800                 PERFORM 2100-EDIT-INPUT                          02580057
025900                 IF  PS-INVALID-INPUT                             02590057
026000                     PERFORM 8210-XCTL-ERROR-SCREEN               02600057
026100                 ELSE                                             02610057
026200                     IF PC233-ROOT-PROGRAM = 'PCKRF892'           02620057
026300                         MOVE 'F4-OPN AUD F3-IGNR'                02630057
026400                                          TO AMSGLNO              02640057
026500                     ELSE                                         02650057
026600                         MOVE 'F4-OPEN    F3-IGNR'                02660057
026700                                          TO AMSGLNO              02670057
026800                     END-IF                                       02680057
026900                     MOVE -1              TO ASEALL               02690057
027000                     PERFORM 8000-SEND-MAP                        02700057
027100                     PERFORM 8100-RETURN-TRANID                   02710057
027200                 END-IF                                           02720057
027300             END-IF                                               02730057
027400         WHEN EIBAID = DFHPF3                                     02740057
027500             MOVE PC233-ROOT-PROGRAM  TO PV-TRANSFER-PROGRAM      02750057
027600             PERFORM 8200-XCTL                                    02760057
027700*                                                                 02770057
027800         WHEN EIBAID = DFHPF4                                     02780057
027900             PERFORM 8020-RECEIVE-MAP                             02790057
028000             PERFORM 2100-EDIT-INPUT                              02800057
028100                                                                  02810057
028200             IF PS-VALID-INPUT                                    02820057
028300                                                                  02830057
028400                 IF PC233-ROOT-PROGRAM = 'PCKRF892'               02840057
028500                    SET PS-OPEN-FOR-AUDIT-YES TO TRUE             02850057
028600                    PERFORM 2000-PROCESS                          02860057
028700                    PERFORM 8230-XCTL-TO-AUDIT-ROOT               02870057
028800                 END-IF                                           02880057
028900                 PERFORM 2000-PROCESS                             02890057
029000                 IF PS-ERRORS-NO                                  02900057
029100                     IF PC233-DIVERT-NBR > ZERO                   02910057
029200                              AND PC233-DIVERT-LOC-ID > SPACES    02920057
029300                             SET PC233-CUTOFF-START-CTN           02930057
029400                                      TO TRUE                     02940057
029500                             MOVE 'PCKRF874'                      02950057
029600                                      TO PV-TRANSFER-PROGRAM      02960057
029700                             PERFORM 8200-XCTL                    02970057
029800                     ELSE                                         02980057
029900                             MOVE 'RE-OPEN TRAILER'               02990057
030000                                      TO AHDGO                    03000057
030100                             MOVE 'TRAILER REOPENED'              03010057
030200                                      TO AMSGLNO                  03020057
030300                             MOVE -1  TO ASEALL                   03030057
030400                             SET  PC233-TRAILER-REOPENED          03040057
030500                                                      TO  TRUE    03050057
030600                             PERFORM 8010-SEND-DATA-ONLY          03060057
030700                             PERFORM 8100-RETURN-TRANID           03070057
030800                     END-IF                                       03080057
030900                 ELSE                                             03090057
031000                     PERFORM 8010-SEND-DATA-ONLY                  03100057
031100                     PERFORM 8100-RETURN-TRANID                   03110057
031200                 END-IF                                           03120057
031300                                                                  03130057
031400             ELSE                                                 03140057
031500                 IF PS-XCTL-E871                                  03150057
031600                     PERFORM 8210-XCTL-ERROR-SCREEN               03160057
031700                 ELSE                                             03170057
031800                     PERFORM 8010-SEND-DATA-ONLY                  03180057
031900                     PERFORM 8100-RETURN-TRANID                   03190057
032000                 END-IF                                           03200057
032100             END-IF                                               03210057
032200                                                                  03220057
032300         WHEN EIBAID = DFHPF1                                     03230057
032400             PERFORM 8020-RECEIVE-MAP                             03240057
032500             MOVE PC875AO             TO PC192-HOST-SAVE-MAP      03250057
032600             PERFORM 1200-HELP-SCREEN                             03260057
032700                                                                  03270057
032800         WHEN OTHER                                               03280057
032900             PERFORM 8020-RECEIVE-MAP                             03290057
033000             MOVE -1                  TO ASEALL                   03300057
033100             MOVE PC-UNRECOGNIZED-PF-KEY-MSG                      03310057
033200                                      TO AMSGLNO                  03320057
033300             PERFORM 8000-SEND-MAP                                03330057
033400             PERFORM 8100-RETURN-TRANID                           03340057
033500     END-EVALUATE.                                                03350057
033600                                                                  03360057
033700     GOBACK.                                                      03370057
033800                                                                  03380057
033900 1000-INITIALIZE.                                                 03390057
034000                                                                  03400057
034100     MOVE PC233-DOOR-ID               TO ADOORO                   03410057
034200     MOVE PC233-TRIP-ID               TO ATRIPO                   03420057
034300     MOVE PC233-SERIAL-NBR            TO ASERIALO                 03430057
034400     MOVE PC233-STR-NBR               TO ADESTO                   03440057
034500     MOVE PC233-OWNER-SCAC-ID         TO ASCACO                   03450057
034600     MOVE PC233-SEAL-ID               TO ASEALO                   03460057
034700     MOVE -1                          TO ASEALL                   03470057
034800     IF PC233-ROOT-PROGRAM = 'PCKRF892'                           03480057
034900        INITIALIZE PC045-COMMAREA-REC                             03490057
035000        MOVE PC233-HOST-SAVE-AREA     TO PC045-COMMAREA-REC       03500057
035100        MOVE 'OPEN FOR AUDIT '        TO AHDGO                    03510057
035200        MOVE 'F4-OPN AUD F3-IGNR'     TO AMSGLNO                  03520057
035300        MOVE DP015-UNP-ALP-NOR-MDT    TO ADOORA                   03530057
035400     ELSE                                                         03540057
035500        MOVE 'RE-OPEN TRAILER'        TO AHDGO                    03550057
035600        MOVE 'F4-REOPN F3-IGNR  '     TO AMSGLNO                  03560057
035700     END-IF                                                       03570057
035800                                                                  03580057
035900     INITIALIZE CA-REDEFINED-COMMAREA                             03590057
036000     MOVE PC-TRANID                   TO PC233-TRAN-ID            03600057
036100                                                                  03610057
036200     MOVE PC233-USER-ID               TO PV-USER-ID.              03620057
036300                                                                  03630057
036400*    MOVE PC-CURRENT-PROGRAM-NAME     TO PC233-LAST-PROGRAM.      03640057
036500                                                                  03650057
036600 1200-HELP-SCREEN.                                                03660057
036700     MOVE 'DPKRF278'                  TO PV-TRANSFER-PROGRAM      03670057
036800     MOVE PC-CURRENT-PROGRAM-NAME     TO PC192-PROGRAM-NAME       03680057
036900     COPY PCPD188.                                                03690057
037000     MOVE PC188-DISPLAY-DATE          TO PC192-DISPLAY-DATE.      03700057
037100     MOVE CA-COMMAREA                 TO PC192-HOST-SAVE-AREA     03710057
037200     PERFORM 8220-XCTL-TO-HELP.                                   03720057
037300                                                                  03730057
037400/                                                                 03740057
037500 2000-PROCESS.                                                    03750057
037600     IF PC233-ROOT-PROGRAM = 'PCKRF892'                           03760057
037700        CONTINUE                                                  03770057
037800     ELSE                                                         03780057
037900        PERFORM 3000-MANAGE-ASSIGNMENTS                           03790057
038000     END-IF.                                                      03800057
038100                                                                  03810057
038200     PERFORM 7050-SELECT-TSUOBTS.                                 03820057
038300     PERFORM 8400-GET-TIMESTAMP.                                  03830057
038400     PERFORM 7100-INSERT-TSUOBTS.                                 03840057
038500     PERFORM 7400-INSERT-WRKR-AUD.                                03850057
038600                                                                  03860057
038700     IF PC233-ROOT-PROGRAM = 'PCKRF892'                           03870057
038800        CONTINUE                                                  03880057
038900     ELSE                                                         03890057
039000        IF PC233-P4-INTERFACE-YES                                 03900057
039100           PERFORM 4900-CALL-XLKUP033                             03910057
039200        END-IF                                                    03920057
039300     END-IF.                                                      03930057
039400                                                                  03940057
039500/                                                                 03950057
039600 2100-EDIT-INPUT.                                                 03960057
039700                                                                  03970057
039800     SET PS-ERRORS-NO                                             03980057
039900         PS-VALID-INPUT               TO TRUE                     03990057
040000     MOVE SPACES                      TO AMSGLNO                  04000057
040100                                                                  04010057
040200     IF PC233-ROOT-PROGRAM = 'PCKRF892'                           04020057
040300        MOVE PC233-HOST-SAVE-AREA     TO PC045-COMMAREA-REC       04030057
040400        MOVE ADOORI   TO   CNDCDR-DOOR-ID                         04040057
040500        SET PS-VALID-DOOR-NO TO TRUE                              04050057
040600        PERFORM 6900-VALIDATE-DOOR-ID                             04060057
040700        IF PS-VALID-DOOR-NO                                       04070057
040800           MOVE 'OPEN FOR AUDIT '                                 04080057
040900                                        TO AHDGO                  04090057
041000           MOVE 'INVALID DOOR ID  '     TO AMSGLNO                04100057
041100           SET PS-ERRORS-YES            TO TRUE                   04110057
041200           MOVE DP015-UNP-ALP-NOR-MDT   TO ADOORA                 04120057
041300           MOVE -1                      TO ADOORL                 04130057
041400           PERFORM 8000-SEND-MAP                                  04140057
041500           PERFORM 8100-RETURN-TRANID                             04150057
041600        ELSE                                                      04160057
041700           MOVE PC045-COMMAREA-REC TO PC233-HOST-SAVE-AREA        04170057
041800        END-IF                                                    04180057
041900     END-IF                                                       04190057
042000                                                                  04200057
042100     IF  ASEALL > ZERO                                            04210057
042200         MOVE ASEALI TO PC233-SEAL-ID                             04220057
042300     ELSE                                                         04230057
042400         IF ASEALA = DP015-ERASE-EOF                              04240057
042500             MOVE SPACES TO PC233-SEAL-ID                         04250057
042600         END-IF                                                   04260057
042700     END-IF.                                                      04270057
042800                                                                  04280057
042900* SEE IF THE SEAL THAT WAS KEYED MATCHES THE SEAL ON THE TRAILER  04290057
043000     PERFORM 7000-SELECT-TSUOBTS.                                 04300057
043100     IF PS-TSUOBTS-YES                                            04310057
043200         EVALUATE TRUE                                            04320057
043300             WHEN SUOBTS-TRLR-SEAL-ID = SPACES                    04330057
043400                 CONTINUE                                         04340057
043500             WHEN SUOBTS-TRLR-SEAL-ID = PC233-SEAL-ID             04350057
043600                 CONTINUE                                         04360057
043700             WHEN OTHER                                           04370057
043800                 SET PS-XCTL-E871     TO TRUE                     04380057
043900                 MOVE 32              TO PC233-PGM-MSG-NBR        04390057
044000                 SET PC233-CONFIRM-TRAILER-SEAL TO TRUE           04400057
044100                 SET PS-INVALID-INPUT     TO TRUE                 04410057
044200         END-EVALUATE                                             04420057
044300     ELSE                                                         04430057
044400         MOVE 'RE-OPEN TRAILER'                                   04440057
044500                                      TO AHDGO                    04450057
044600         MOVE 'TRAILER NOT FOUND'     TO AMSGLNO                  04460057
044700         SET PS-ERRORS-YES            TO TRUE                     04470057
044800         MOVE -1                      TO ASEALL                   04480057
044900     END-IF.                                                      04490057
045000                                                                  04500057
045010*                                                                 04501059
045020*** ADD AN ADDITIONAL CHECK TO MAKE SURE THAT ANOTHER TRLR HAS    04502059
045030*** NOT BEEN OPENED/REOPENED AT THE DOOR                          04503059
045031*** DMH 12/28/2020                                                04503159
045040                                                                  04504059
045041     SET  PS-ANOTHER-OPEN-NO  TO  TRUE.                           04504159
045042     PERFORM 7020-CHECK-ALREADY-OPEN.                             04504259
045043     IF  PS-ANOTHER-OPEN-YES                                      04504359
045045         MOVE PV-ERROR-DOOR   TO PC233-ERROR-DOOR-NBR             04504564
045046         MOVE PV-ERROR-SRL    TO PC233-ERROR-SRL-NBR              04504667
045047         MOVE PV-ERROR-SCAC   TO PC233-ERROR-SCAC-ID              04504767
045048         MOVE PV-ERROR-TRLR   TO PC233-ERROR-TRLR-ID              04504867
045049         MOVE PV-ERROR-TRIP   TO PC233-ERROR-TRIP-ID              04504967
045050         MOVE 4               TO PC233-PGM-MSG-NBR                04505067
045051         SET PS-XCTL-E871                                         04505167
045053             PS-INVALID-INPUT     TO TRUE                         04505359
045054     END-IF.                                                      04505459
045055                                                                  04505559
045064                                                                  04506459
045070                                                                  04507059
045100****************************************************************  04510057
045200*    DETERMINES WHETHER INTERFACING OF MANAGING OF ASSIGNMENTS *  04520057
045300*    NEEDS TO BE DONE.                                         *  04530057
045400****************************************************************  04540057
045500 3000-MANAGE-ASSIGNMENTS.                                         04550057
045600                                                                  04560057
045700     EVALUATE TRUE                                                04570057
045800         WHEN PC233-P4-INTERFACE-YES                              04580057
045900              PERFORM 3100-FIND-DOOR-GROUP                        04590057
046000                                                                  04600057
046100         WHEN PC233-P4-INTERFACE-NO                               04610057
046200              CONTINUE                                            04620057
046300                                                                  04630057
046400         WHEN OTHER                                               04640057
046500              PERFORM 3200-SELECT-TKRPRPM-DLSHPI                  04650057
046600                                                                  04660057
046700              IF PC233-P4-INTERFACE-YES                           04670057
046800                 PERFORM 3100-FIND-DOOR-GROUP                     04680057
046900              END-IF                                              04690057
047000                                                                  04700057
047100     END-EVALUATE.                                                04710057
047200                                                                  04720057
047300****************************************************************  04730057
047400*    PC233-DOOR-ID IS THE DOOR NUMBER THAT THEY ARE WORKING AT.*  04740057
047500*          IF IT IS EQUAL TO THE PC233-P4-DOOR-ID, THEN WE     *  04750057
047600*          ARE DONE BECAUSE AN ASSIGNMENT HAS ALREADY BEEN     *  04760057
047700*          ESTABLISHED.                                        *  04770057
047800****************************************************************  04780057
047900 3100-FIND-DOOR-GROUP.                                            04790057
048000                                                                  04800057
048100     IF PC233-P4-DOOR-ID = PC233-DOOR-ID                          04810057
048200        INITIALIZE DL001-ASGMT-COMMAREA                           04820057
048300                                                                  04830057
048400        MOVE PC233-ASGMT-STRT-DTE    TO DL001-KEY-START-DTE       04840057
048500        MOVE PC233-ASGMT-NBR-TXT     TO DL001-KEY-NBR-TXT         04850057
048600        MOVE PC233-ASGMT-NBR-SEQ-NBR TO DL001-KEY-NBR-SEQ-NBR     04860057
048700                                                                  04870057
048710        PERFORM 4000-CALL-DLKUP001                                04871057
048711        IF DL001-ASGMT-CLOSED-RETURN                              04871157
048712            PERFORM 3600-CALL-DLKCS410                            04871257
048713        END-IF                                                    04871357
048714     ELSE                                                         04871457
048715        PERFORM 3400-DETERMINE-DOOR-GROUP                         04871557
048716                                                                  04871657
048717        IF PS-DOOR-GROUP-FOUND-YES                                04871757
048718           IF DLT00001-DOOR-GP-NBR =                              04871857
048719                                    PC233-P4-DOOR-GP-NBR          04871957
048720              MOVE PC233-DOOR-ID TO PC233-P4-DOOR-ID              04872057
048730           ELSE                                                   04873057
048740              PERFORM 3600-CALL-DLKCS410                          04874057
048750              INITIALIZE DL001-ASGMT-COMMAREA                     04875057
048760                                                                  04876057
048770              MOVE DL016-ESO-ASGMT-START-DTE   TO                 04877057
048780                                           DL001-KEY-START-DTE    04878057
048790              MOVE DL016-ESO-ASGMT-NBR-TXT     TO                 04879057
048800                                           DL001-KEY-NBR-TXT      04880057
048900              MOVE DL016-ESO-ASGMT-NBR-SEQ-NBR TO                 04890057
049000                                           DL001-KEY-NBR-SEQ-NBR  04900057
049100              PERFORM 4000-CALL-DLKUP001                          04910057
049200              IF DL001-ASGMT-CLOSED-RETURN                        04920057
049300                 PERFORM 3600-CALL-DLKCS410                       04930057
049400              END-IF                                              04940057
049500              MOVE PC233-DOOR-ID TO PC233-P4-DOOR-ID              04950057
049600              MOVE DLT00001-DOOR-GP-NBR TO                        04960057
049700                                    PC233-P4-DOOR-GP-NBR          04970057
049800           END-IF                                                 04980057
049900        END-IF                                                    04990057
050000     END-IF.                                                      05000057
050100                                                                  05010057
050200                                                                  05020057
050300****************************************************************  05030057
050400*    DETERMINES WHETHER INTERFACING OF MANAGING OF ASSIGNMENTS *  05040057
050500*    NEEDS TO BE DONE.                                         *  05050057
050600****************************************************************  05060057
050700 3200-SELECT-TKRPRPM-DLSHPI.                                      05070057
050800                                                                  05080057
050900     EXEC SQL                                                     05090057
051000       SELECT                                                     05100057
051100               FUNC_TXT                                           05110057
051200         INTO                                                     05120057
051300              :KRPRPM-FUNC-TXT                                    05130057
051400         FROM  TKRPRPM                                            05140057
051500        WHERE  LOC_ID            = :PC233-OPER-UNT-ID             05150057
051600          AND  INTFC_SYS_CDE     = :PC-DLX                        05160057
051700          AND  SYS_PRC_FUNC_CDE  = :PC-DLSHPI                     05170057
051800                                                                  05180057
051900     END-EXEC.                                                    05190057
052000                                                                  05200057
052100     EVALUATE TRUE                                                05210057
052200         WHEN SQLCODE = ZERO                                      05220057
052300              IF KRPRPM-FUNC-TXT = 'Y'                            05230057
052400                 SET PC233-P4-INTERFACE-YES TO TRUE               05240057
052500              ELSE                                                05250057
052600                 SET PC233-P4-INTERFACE-NO  TO TRUE               05260057
052700              END-IF                                              05270057
052800         WHEN SQLCODE = +100                                      05280057
052900              SET PC233-P4-INTERFACE-NO  TO TRUE                  05290057
053000         WHEN SQLCODE = -904                                      05300057
053100         WHEN SQLCODE = -913                                      05310057
053200         WHEN SQLCODE = -911                                      05320057
053300              MOVE 16                  TO PV-ERROR-NBR            05330057
053400              PERFORM 9903-WRITE-CICS-LOG                         05340057
053500              PERFORM 9000-SOFT-ABORT                             05350057
053600         WHEN SQLWARN0 NOT = SPACES                               05360057
053700         WHEN SQLCODE NOT EQUAL ZERO                              05370057
053800              SET PC233-P4-INTERFACE-NO  TO TRUE                  05380057
053900              PERFORM 3500-FORMAT-COMMON-DATA                     05390057
054000                                                                  05400057
054100              MOVE '3200-SELECT-TKRPRPM-DLSHPI'                   05410057
054200                                       TO PC233-PARAGRAPH         05420057
054300              STRING PC-CURRENT-PROGRAM-NAME                      05430057
054400                     ' - LOOKUP LABOR INTERFACING'                05440057
054500                      DELIMITED BY SIZE                           05450057
054600                      INTO PC233-MESSAGE-TEXT(1)                  05460057
054700              MOVE SQLCA               TO PC233-SQLCA             05470057
054800              MOVE 'TKRPRPM'           TO PC233-DB2-TABLE-NAME(1) 05480057
054900              SET PC233-ABEND          TO TRUE                    05490057
055000              MOVE 99                  TO PC233-PGM-MSG-NBR       05500057
055100              PERFORM 8210-XCTL-ERROR-SCREEN                      05510057
055200     END-EVALUATE.                                                05520057
055300                                                                  05530057
055400****************************************************************  05540057
055500*    FIND THE DOOR GROUP FOR THE DOOR.                         *  05550057
055600*                                                              *  05560057
055700****************************************************************  05570057
055800 3400-DETERMINE-DOOR-GROUP.                                       05580057
055900                                                                  05590057
056000     EXEC SQL                                                     05600057
056100       SELECT                                                     05610057
056200               GP.DOOR_GP_NBR                                     05620057
056300         INTO                                                     05630057
056400              :DLT00001-DOOR-GP-NBR                               05640057
056500         FROM  DLT_DOOR_GP      GP                                05650057
056600              ,DLT_DOOR_GP_TMPL TMPL                              05660057
056700                                                                  05670057
056800        WHERE  TMPL.DC_NBR        = :PC233-OPER-UNT-ID            05680057
056900          AND  GP.DOOR_ID         = :PC233-DOOR-ID                05690057
057000          AND  GP.DOOR_GP_TMPL_ID = TMPL.DOOR_GP_TMPL_ID          05700057
057100          AND  TMPL.ACTV_IND      = :PC-Y                         05710057
057200                                                                  05720057
057300     END-EXEC.                                                    05730057
057400                                                                  05740057
057500     EVALUATE TRUE                                                05750057
057600         WHEN SQLCODE = ZERO                                      05760057
057700              SET PS-DOOR-GROUP-FOUND-YES TO TRUE                 05770057
057701                                                                  05770157
057702* DMH - 1/21/2005 - BEGIN                                         05770257
057710         WHEN SQLCODE = +100                                      05771057
057711              SET PS-XCTL-E871     TO TRUE                        05771157
057712              MOVE 50              TO PC233-PGM-MSG-NBR           05771257
057714              SET PS-INVALID-INPUT TO TRUE                        05771457
057715              PERFORM 8210-XCTL-ERROR-SCREEN                      05771558
057716* DMH - 1/21/2005 - END                                           05771657
057717                                                                  05771757
057800         WHEN SQLCODE = -904                                      05780057
057900         WHEN SQLCODE = -913                                      05790057
058000         WHEN SQLCODE = -911                                      05800057
058100              MOVE 16                  TO PV-ERROR-NBR            05810057
058200              PERFORM 9903-WRITE-CICS-LOG                         05820057
058300              PERFORM 9000-SOFT-ABORT                             05830057
058400         WHEN SQLWARN0 NOT = SPACES                               05840057
058500         WHEN SQLCODE NOT EQUAL ZERO                              05850057
058600              SET PS-DOOR-GROUP-FOUND-NO  TO TRUE                 05860057
058700              PERFORM 3500-FORMAT-COMMON-DATA                     05870057
058800                                                                  05880057
058900             MOVE '3400-DETERMINE-DOOR-NUMBER'                    05890057
059000                                      TO PC233-PARAGRAPH          05900057
059100             MOVE 'PCKRF875 - FIND DOOR NUMBER        '           05910057
059200                                      TO PC233-MESSAGE-TEXT(1)    05920057
059300             MOVE SQLCA               TO PC233-SQLCA              05930057
059400             MOVE 'DLT_DOOR_GP'       TO PC233-DB2-TABLE-NAME(1)  05940057
059500             MOVE 'DLT_DOOR_GP_TMPL'  TO PC233-DB2-TABLE-NAME(2)  05950057
059600             SET PC233-ABEND          TO TRUE                     05960057
059700             MOVE 99                  TO PC233-PGM-MSG-NBR        05970057
059800             PERFORM 8210-XCTL-ERROR-SCREEN                       05980057
059900     END-EVALUATE.                                                05990057
060000                                                                  06000057
060100****************************************************************  06010057
060200*                                                              *  06020057
060300*                                                              *  06030057
060400****************************************************************  06040057
060500 3500-FORMAT-COMMON-DATA.                                         06050057
060600                                                                  06060057
060700     MOVE PC233-OPER-UNT-ID      TO PV-DISPLAY-OPER.              06070057
060800     MOVE PC233-ASGMT-NBR-SEQ-NBR TO PV-DISPLAY-SEQ-NBR.          06080057
060900     MOVE PC233-DOOR-ID          TO PV-DISPLAY-DOOR-ID.           06090057
061000     MOVE PC233-STR-NBR          TO PV-DISPLAY-DEST.              06100057
061100     MOVE PC233-SERIAL-NBR       TO PV-DISPLAY-SRL-NBR.           06110057
061200     MOVE PC233-OWNER-SCAC-ID    TO PV-DISPLAY-SCAC.              06120057
061300     MOVE PC233-TRIP-ID          TO PV-DISPLAY-TRIP.              06130057
061400     STRING  ' OPER-'                                             06140057
061500             PV-DISPLAY-OPER                                      06150057
061600             '  DOOR-'                                            06160057
061700             PV-DISPLAY-DOOR-ID                                   06170057
061800             '  DEST-'                                            06180057
061900             PV-DISPLAY-DEST        DELIMITED BY SIZE             06190057
062000             INTO                                                 06200057
062100             PC233-MESSAGE-TEXT(2).                               06210057
062200     STRING  ' TRLR SRL#-'                                        06220057
062300             PV-DISPLAY-SRL-NBR                                   06230057
062400             '   SCAC-'                                           06240057
062500             PV-DISPLAY-SCAC                                      06250057
062600             '   TRIP-'                                           06260057
062700             PV-DISPLAY-TRIP        DELIMITED BY SIZE             06270057
062800             INTO                                                 06280057
062900             PC233-MESSAGE-TEXT(3).                               06290057
063000                                                                  06300057
063100     MOVE 17                  TO PV-ERROR-NBR                     06310057
063200                                PC233-ERROR-NBR.                  06320057
063300     PERFORM 9903-WRITE-CICS-LOG.                                 06330057
063400                                                                  06340057
063500****************************************************************  06350057
063600*                                                              *  06360057
063700*                                                              *  06370057
063800****************************************************************  06380057
063900 3600-CALL-DLKCS410.                                              06390057
064000                                                                  06400057
064100     INITIALIZE  DL016-PGM-COMMAREA.                              06410057
064200     SET DL016-ESTABLISH-ASGMT TO TRUE.                           06420057
064300     SET DL016-COMMIT-UPDATE   TO TRUE.                           06430057
064400                                                                  06440057
064500     MOVE PC-CURRENT-PROGRAM-NAME TO DL016-CALLING-PGM-NM.        06450057
064600     MOVE PC233-USER-ID TO DL016-SIGN-ON-USR-ID.                  06460057
064700                                                                  06470057
064800     SET  DL011-AN-SHIP-WRK-TYP TO TRUE.                          06480057
064900     MOVE DL011-KEY-ASGMT-NBR-WRK-TYP TO DL016-ASGMT-NBR-WRK-TYP. 06490057
065000                                                                  06500057
065100     SET  DL011-SHIP-WRK-TYP TO TRUE.                             06510057
065200     MOVE DL011-KEY-WK-TYP TO DL016-EAI-WK-TYP-DESC.              06520057
065300                                                                  06530057
065400     MOVE DLT00001-DOOR-GP-NBR TO                                 06540057
065500                                   DL011-SD-WRK-AREA-DOOR-GROUP.  06550057
065600     MOVE DL011-SHIP-DOORGRP-WRK-AREA TO DL016-EAI-WK-AREA-DESC.  06560057
065700                                                                  06570057
065800     MOVE PC233-OPER-UNT-ID TO DL016-EAI-DC-NBR.                  06580057
065900     MOVE PC233-USER-ID     TO DL016-EAI-CRE-BY-USR-ID.           06590057
066000     SET  DL016-EAI-USR-IS-UNKNOWN TO TRUE.                       06600057
066100                                                                  06610057
066200     MOVE LENGTH OF DL016-PGM-COMMAREA                            06620057
066300                                      TO PV-COMMAREA-LENGTH.      06630057
066400                                                                  06640057
066500     EXEC CICS LINK                                               06650057
066600         PROGRAM  (DL016-USER-PGM)                                06660057
066700         COMMAREA (DL016-PGM-COMMAREA)                            06670057
066800         LENGTH   (PV-COMMAREA-LENGTH)                            06680057
066900         RESP     (PV-CICS-RESPONSE)                              06690057
067000     END-EXEC.                                                    06700057
067100                                                                  06710057
067200     IF  PV-CICS-RESPONSE = DFHRESP (NORMAL)                      06720057
067300                                                                  06730057
067400     EVALUATE TRUE                                                06740057
067500         WHEN DL016-SUCCESSFUL                                    06750057
067600              MOVE DL016-ESO-ASGMT-START-DTE TO                   06760057
067700                             PC233-ASGMT-STRT-DTE                 06770057
067800              MOVE DL016-ESO-ASGMT-NBR-TXT   TO                   06780057
067900                             PC233-ASGMT-NBR-TXT                  06790057
068000              MOVE DL016-ESO-ASGMT-NBR-SEQ-NBR TO                 06800057
068100                             PC233-ASGMT-NBR-SEQ-NBR              06810057
068200                                                                  06820057
068300         WHEN DL016-SQL-ERROR                                     06830057
068400              STRING ' DLKCS410 SQL ERROR FOR USER ID-'           06840057
068500                      PC233-USER-ID                               06850057
068600                      DELIMITED BY SIZE                           06860057
068700                      INTO PV-ERROR-MESSAGE                       06870057
068800                                                                  06880057
068900              PERFORM 3700-FORMAT-ERROR-MESSAGE                   06890057
069000                                                                  06900057
069100         WHEN DL016-CALLED-MODULE-FAILURE                         06910057
069200              STRING ' DLKCS410 CALLED MODULE FAILURE FOR '       06920057
069300                      PC233-USER-ID                               06930057
069400                      DELIMITED BY SIZE                           06940057
069500                      INTO PV-ERROR-MESSAGE                       06950057
069600                                                                  06960057
069700              PERFORM 3700-FORMAT-ERROR-MESSAGE                   06970057
069800                                                                  06980057
069900         WHEN DL016-INVALID-ACCESS                                06990057
070000              STRING ' DLKCS410 INVALID ACCESS FAILURE FOR '      07000057
070100                      PC233-USER-ID                               07010057
070200                      DELIMITED BY SIZE                           07020057
070300                      INTO PV-ERROR-MESSAGE                       07030057
070400                                                                  07040057
070500              PERFORM 3700-FORMAT-ERROR-MESSAGE                   07050057
070600                                                                  07060057
070700         WHEN OTHER                                               07070057
070800              STRING ' DLKCS410 OTHER TYPE FAILURE FOR '          07080057
070900                      PC233-USER-ID                               07090057
071000                      DELIMITED BY SIZE                           07100057
071100                      INTO PV-ERROR-MESSAGE                       07110057
071200                                                                  07120057
071300              PERFORM 3700-FORMAT-ERROR-MESSAGE                   07130057
071400                                                                  07140057
071500     END-EVALUATE                                                 07150057
071600     ELSE                                                         07160057
071700         MOVE '3600-CALL-DLKCS410' TO PC233-PARAGRAPH             07170057
071800         MOVE PV-CICS-RESPONSE     TO PC233-MESSAGE-TEXT (1)      07180057
071900         MOVE 'BAD RETURN FROM DLKCS410' TO                       07190057
072000                                      PC233-MESSAGE-TEXT (2)      07200057
072100         MOVE 2                    TO PC233-ERROR-NBR             07210057
072200         SET PC233-ABEND           TO TRUE                        07220057
072300         MOVE 99                   TO PC233-PGM-MSG-NBR           07230057
072400         PERFORM 8210-XCTL-ERROR-SCREEN                           07240057
072500     END-IF.                                                      07250057
072600                                                                  07260057
072700****************************************************************  07270057
072800*                                                              *  07280057
072900*                                                              *  07290057
073000****************************************************************  07300057
073100 3700-FORMAT-ERROR-MESSAGE.                                       07310057
073200                                                                  07320057
073300     PERFORM 3500-FORMAT-COMMON-DATA.                             07330057
073400                                                                  07340057
073500     INITIALIZE PV-CICS-MSG-AREA2.                                07350057
073600     STRING  PC-CURRENT-PROGRAM-NAME                              07360057
073700            '3600-CALL-DLKCS410'                                  07370057
073800             PV-ERROR-MESSAGE                                     07380057
073900             DELIMITED BY SIZE                                    07390057
074000             INTO PV-CICS-MSG-AREA2.                              07400057
074100     PERFORM 999A-WRITE-CSSL-MSG.                                 07410057
074200                                                                  07420057
074300     INITIALIZE PV-CICS-MSG-AREA2.                                07430057
074400     MOVE DL016-ASGMT-SQLCODE    TO PV-SQLCODE.                   07440057
074500                                                                  07450057
074600     STRING ' PCKRF875-' DL016-USER-PGM                           07460057
074700            ' -- ' DL016-CALL-MOD-FAIL-SQL-PARA                   07470057
074800            ' -- ' DL016-CALL-MOD-FAIL-NM                         07480057
074900            ' -- ' DL016-CALL-MOD-FAIL-ERR-CDE                    07490057
075000            ' -- ' PV-SQLCODE                                     07500057
075100             DELIMITED BY SIZE                                    07510057
075200             INTO PV-CICS-MSG-AREA2.                              07520057
075300     PERFORM 999A-WRITE-CSSL-MSG.                                 07530057
075400                                                                  07540057
075500****************************************************************  07550057
075600*                                                              *  07560057
075700*                                                              *  07570057
075800****************************************************************  07580057
075900 4000-CALL-DLKUP001.                                              07590057
076000                                                                  07600057
076100     SET DL001-BY-ASGMT-KEY                                       07610057
076200         DL001-COMMIT-UPDATE                                      07620057
076300         DL001-FIND-NEXT-ASGMT    TO TRUE.                        07630057
076400                                                                  07640057
076500     MOVE +1 TO DL001-NBR-OF-NBRS-NEED-QTY.                       07650057
076600                                                                  07660057
076700     SET DL001-FIND-NEXT-ASGMT    TO TRUE.                        07670057
076800                                                                  07680057
076900     MOVE PC-CURRENT-PROGRAM-NAME TO DL001-ORIG-CALLING-PGM-NM.   07690057
077000                                                                  07700057
077100     CALL DL001-USER-PGM USING DFHEIBLK                           07710057
077200                              DL001-COMMAREA                      07720057
077300                              DL001-ASGMT-COMMAREA.               07730057
077400                                                                  07740057
077500     EVALUATE TRUE                                                07750057
077600         WHEN DL001-SUCCESSFUL                                    07760057
077700              IF DL001-ASGMT-NEXT-USED                            07770057
077800                 MOVE DL001-NXT-START-DTE                         07780057
077900                               TO PC233-ASGMT-STRT-DTE            07790057
078000                 MOVE DL001-NXT-NBR-TXT                           07800057
078100                               TO PC233-ASGMT-NBR-TXT             07810057
078200                 MOVE DL001-NXT-NBR-SEQ-NBR                       07820057
078300                               TO PC233-ASGMT-NBR-SEQ-NBR         07830057
078400              END-IF                                              07840057
078500                                                                  07850057
078600         WHEN DL001-ASGMT-CLOSED-RETURN                           07860057
078700              CONTINUE                                            07870057
078800                                                                  07880057
078900         WHEN OTHER                                               07890057
079000              MOVE DL001-ASGMT-SQLCODE TO  PV-SQLCODE             07900057
079100              INITIALIZE PV-CICS-MSG-AREA2                        07910057
079200              STRING ' PCKRF875-4000- '                           07920057
079300                     'SQLCODE=' PV-SQLCODE                        07930057
079400                     ' - RETURN CODE=' DL001-RETURN-CODE          07940057
079500                      DELIMITED BY SIZE                           07950057
079600                      INTO PV-CICS-MSG-AREA2                      07960057
079700              MOVE LENGTH OF PV-CICS-MSG-AREA2                    07970057
079800                                             TO PV-COMMAREA-LENGTH07980057
079900              PERFORM 999A-WRITE-CSSL-MSG                         07990057
080000                                                                  08000057
080100              INITIALIZE PV-CICS-MSG-AREA2                        08010057
080200              STRING ' PCKRF875-' DL001-USER-PGM                  08020057
080300                      ' -- ' DL001-SQL-ERROR-PARA                 08030057
080400                      ' -- ' DL001-CALL-MOD-FAIL-NM               08040057
080500                      ' -- ' DL001-CALL-MOD-FAIL-ERR-CDE          08050057
080600                       DELIMITED BY SIZE                          08060057
080700                       INTO PV-CICS-MSG-AREA2                     08070057
080800              MOVE LENGTH OF PV-CICS-MSG-AREA2                    08080057
080900                                             TO PV-COMMAREA-LENGTH08090057
081000              PERFORM 999A-WRITE-CSSL-MSG                         08100057
081100                                                                  08110057
081200     END-EVALUATE.                                                08120057
081300                                                                  08130057
081400                                                                  08140057
081500****************************************************************  08150057
081600*                                                              *  08160057
081700*                                                              *  08170057
081800****************************************************************  08180057
081900 4900-CALL-XLKUP033.                                              08190057
082000                                                                  08200057
082100     INITIALIZE XL072-EAI-EXPORT-COMMAREA.                        08210057
082200                                                                  08220057
082300     SET  XL072-PC-APP-ID TO TRUE.                                08230057
082400     MOVE PC-SHIPPING       TO XL072-EVNT-OBJ-TXT.                08240057
082500     MOVE PC-TRAILER-OPEN   TO XL072-EVNT-OBJ-ACTN-TXT.           08250057
082600     MOVE PC233-USER-ID     TO XL072-CRE-BY-USR-ID.               08260057
082700     MOVE PC-CURRENT-PROGRAM-NAME TO XL072-CRE-PGM-NM.            08270057
082800     MOVE PC233-TRIP-ID     TO XL072-EVNT-KY-1-NBR.               08280057
082900     MOVE PC233-OPER-UNT-ID TO XL072-EVNT-KY-2-NBR.               08290057
083000     MOVE PC233-P4-DOOR-GP-NBR TO XL072-EVNT-KY-3-NBR.            08300057
083100     MOVE PC233-P4-DOOR-ID  TO XL072-EVNT-KY-1-TXT.               08310057
083200     MOVE PV-CURRENT-TIMESTAMP TO XL072-EVNT-KY-1-TMST.           08320057
083300                                                                  08330057
083400     INITIALIZE PC242-DTL-TXT-AREA.                               08340057
083500                                                                  08350057
083600     SET PC242-OPEN-OTBND-TRLR TO TRUE.                           08360057
083700     MOVE PC233-ASGMT-STRT-DTE                                    08370057
083800                               TO PC242-AH-ASGMT-STRT-DTE.        08380057
083900     MOVE PC233-ASGMT-NBR-TXT                                     08390057
084000                               TO PC242-AH-ASGMT-NBR-TXT.         08400057
084100     MOVE PC233-ASGMT-NBR-SEQ-NBR                                 08410057
084200                               TO PC242-AH-ASGMT-NBR-SEQ-NBR.     08420057
084300     MOVE DL001-SEQ-START-NBR                                     08430057
084400                               TO PC242-AH-ASGMT-SEQ-DTL-NBR.     08440057
084500                                                                  08450057
084600                                                                  08460057
084700     SET  XL072-PCWS242-COPYBOOK   TO TRUE.                       08470057
084800     SET  XL072-COMMIT-UPDATE      TO TRUE.                       08480057
084900     MOVE PC242-DTL-TXT-AREA       TO XL072-DTL-TXT.              08490057
085000                                                                  08500057
085100     CALL XL072-USER-PGM USING DFHEIBLK                           08510057
085200                              XL072-COMMAREA                      08520057
085300                              XL072-EAI-EXPORT-COMMAREA.          08530057
085400                                                                  08540057
085500     EVALUATE TRUE                                                08550057
085600         WHEN XL072-SUCCESSFUL                                    08560057
085700              CONTINUE                                            08570057
085800         WHEN OTHER                                               08580057
085900              MOVE PC233-OPER-UNT-ID TO  PV-DISPLAY-OPER          08590057
086000              MOVE XL072-EAI-DB-SQLCODE                           08600057
086100                                     TO  PV-SQLCODE               08610057
086200              INITIALIZE PV-CICS-MSG-AREA2                        08620057
086300              STRING ' PCKRF875-4900- '                           08630057
086400                      PV-DISPLAY-OPER   '-'                       08640057
086500                      PC233-ASGMT-STRT-DTE  ' - '                 08650057
086600                      PC233-ASGMT-NBR-TXT   ' - '                 08660057
086700                      PV-DISPLAY-SEQ-NBR ' - '                    08670057
086800                      PC233-USER-ID ' - '                         08680057
086900                     'SQLCODE=' PV-SQLCODE                        08690057
087000                     ' - RETURN CODE=' XL072-RETURN-CODE          08700057
087100                                                DELIMITED BY SIZE 08710057
087200                                           INTO PV-CICS-MSG-AREA2 08720057
087300              MOVE LENGTH OF PV-CICS-MSG-AREA2                    08730057
087400                                             TO PV-COMMAREA-LENGTH08740057
087500              PERFORM 999A-WRITE-CSSL-MSG                         08750057
087600                                                                  08760057
087700              INITIALIZE PV-CICS-MSG-AREA2                        08770057
087800              STRING ' PCKRF875-' XL072-USER-PGM                  08780057
087900                      ' -- ' XL072-SQL-ERROR-PARA                 08790057
088000                      ' -- ' XL072-CALL-MOD-FAIL-NM               08800057
088100                      ' -- ' XL072-CALL-MOD-FAIL-ERR-CDE          08810057
088200                                                DELIMITED BY SIZE 08820057
088300                                           INTO PV-CICS-MSG-AREA2 08830057
088400              MOVE LENGTH OF PV-CICS-MSG-AREA2                    08840057
088500                                             TO PV-COMMAREA-LENGTH08850057
088600              PERFORM 999A-WRITE-CSSL-MSG                         08860057
088700                                                                  08870057
088800              INITIALIZE PV-CICS-MSG-AREA2                        08880057
088900              STRING ' PCKRF875-' XL072-USER-PGM                  08890057
089000                      ' -- ' XL072-SQLCA                          08900057
089100                                                DELIMITED BY SIZE 08910057
089200                                           INTO PV-CICS-MSG-AREA2 08920057
089300              MOVE LENGTH OF PV-CICS-MSG-AREA2                    08930057
089400                                             TO PV-COMMAREA-LENGTH08940057
089500              PERFORM 999A-WRITE-CSSL-MSG                         08950057
089600                                                                  08960057
089700              MOVE 3                   TO PV-ERROR-NBR            08970057
089800                                          PC233-ERROR-NBR         08980057
089900              PERFORM 9903-WRITE-CICS-LOG                         08990057
090000              MOVE '4900-CALL-XLKUP033' TO PC233-PARAGRAPH        09000057
090100              MOVE 'PCKRF875 - CHECK TRAILER EXISTENCE'           09010057
090200                                       TO PC233-MESSAGE-TEXT(1)   09020057
090300              MOVE SQLCA               TO PC233-SQLCA             09030057
090400              SET PC233-ABEND          TO TRUE                    09040057
090500              MOVE 99                  TO PC233-PGM-MSG-NBR       09050057
090600              PERFORM 8210-XCTL-ERROR-SCREEN                      09060057
090700                                                                  09070057
090800     END-EVALUATE.                                                09080057
090900                                                                  09090057
091000/                                                                 09100057
091100 6900-VALIDATE-DOOR-ID.                                           09110057
091200     MOVE  PC045-OPER-UNT-ID  TO  CNDCDR-OPER-UNT-ID              09120057
091300                                                                  09130057
091400     EXEC SQL                                                     09140057
091500         SELECT                                                   09150057
091600             DOOR_TYP_CDE                                         09160057
091700         INTO                                                     09170057
091800             :CNDCDR-DOOR-TYP-CDE                                 09180057
091900         FROM                                                     09190057
092000            TCNDCDR                                               09200057
092100         WHERE DOOR_ID     =  :CNDCDR-DOOR-ID                     09210057
092200          AND OPER_UNT_ID=    :CNDCDR-OPER-UNT-ID                 09220057
092300     END-EXEC.                                                    09230057
092400                                                                  09240057
092500     EVALUATE TRUE                                                09250057
092600         WHEN SQLCODE = ZERO                                      09260057
092700             MOVE CNDCDR-DOOR-ID    TO PC233-DOOR-ID              09270057
092800             SET PS-VALID-DOOR-YES  TO TRUE                       09280057
092900         WHEN SQLCODE = +100                                      09290057
093000             SET PS-VALID-DOOR-NO   TO TRUE                       09300057
093100         WHEN SQLCODE = -904                                      09310057
093200         WHEN SQLCODE = -913                                      09320057
093300         WHEN SQLCODE = -911                                      09330057
093400             MOVE 3                   TO PV-ERROR-NBR             09340057
093500             PERFORM 9903-WRITE-CICS-LOG                          09350057
093600             PERFORM 9000-SOFT-ABORT                              09360057
093700         WHEN SQLWARN0 NOT = SPACES                               09370057
093800         WHEN SQLCODE NOT EQUAL ZERO                              09380057
093900             MOVE 4                   TO PV-ERROR-NBR             09390057
094000                                         PC233-ERROR-NBR          09400057
094100             PERFORM 9903-WRITE-CICS-LOG                          09410057
094200             MOVE '6900-VALIDATE-DOOR-ID'                         09420057
094300                                      TO PC233-PARAGRAPH          09430057
094400             MOVE 'PCKRF875 - CHECK TRAILER SEAL ID'              09440057
094500                                      TO PC233-MESSAGE-TEXT(1)    09450057
094600             MOVE SQLCA               TO PC233-SQLCA              09460057
094700             MOVE 'TCNDCDR'           TO PC233-DB2-TABLE-NAME(1)  09470057
094800             SET PC233-ABEND          TO TRUE                     09480057
094900             MOVE 99                  TO PC233-PGM-MSG-NBR        09490057
095000             PERFORM 8210-XCTL-ERROR-SCREEN                       09500057
095100     END-EVALUATE.                                                09510057
095200/                                                                 09520057
095300 7000-SELECT-TSUOBTS.                                             09530057
095400                                                                  09540057
095500     EXEC SQL                                                     09550057
095600         SELECT                                                   09560057
095700             OBTS.TRLR_SEAL_ID                                    09570057
095800         ,   OBTS.OTBND_STAT_TMST                                 09580057
095900         INTO                                                     09590057
096000           :SUOBTS-TRLR-SEAL-ID                                   09600057
096100         , :SUOBTS-OTBND-STAT-TMST                                09610057
096200         FROM                                                     09620057
096300            TSUOBTS OBTS                                          09630057
096400         WHERE OBTS.OTBND_TRIP_ID    = :PC233-TRIP-ID             09640057
096500           AND OBTS.OTBND_STAT_TMST  =                            09650057
096600           ( SELECT                                               09660057
096700                 MAX(OBTS1.OTBND_STAT_TMST)                       09670057
096800                 FROM                                             09680057
096900                 TSUOBTS OBTS1                                    09690057
097000                 WHERE OBTS1.OTBND_TRIP_ID = OBTS.OTBND_TRIP_ID   09700057
097100            )                                                     09710057
097200     END-EXEC.                                                    09720057
097300                                                                  09730057
097400     EVALUATE TRUE                                                09740057
097500         WHEN SQLCODE = ZERO                                      09750057
097600             SET PS-TSUOBTS-YES       TO TRUE                     09760057
097700         WHEN SQLCODE = +100                                      09770057
097800             SET PS-TSUOBTS-NO        TO TRUE                     09780057
097900         WHEN SQLCODE = -904                                      09790057
098000         WHEN SQLCODE = -913                                      09800057
098100         WHEN SQLCODE = -911                                      09810057
098200             MOVE 1                   TO PV-ERROR-NBR             09820057
098300             PERFORM 9903-WRITE-CICS-LOG                          09830057
098400             PERFORM 9000-SOFT-ABORT                              09840057
098500         WHEN SQLWARN0 NOT = SPACES                               09850057
098600         WHEN SQLCODE NOT EQUAL ZERO                              09860057
098700             MOVE 2                   TO PV-ERROR-NBR             09870057
098800                                         PC233-ERROR-NBR          09880057
098900             PERFORM 9903-WRITE-CICS-LOG                          09890057
099000             MOVE '7000-SELECT-TCNTRID'                           09900057
099100                                      TO PC233-PARAGRAPH          09910057
099200             MOVE 'PCKRF875 - CHECK TRAILER SEAL ID'              09920057
099300                                      TO PC233-MESSAGE-TEXT(1)    09930057
099400             MOVE SQLCA               TO PC233-SQLCA              09940057
099500             MOVE 'TCNTRID'           TO PC233-DB2-TABLE-NAME(1)  09950057
099600             SET PC233-ABEND          TO TRUE                     09960057
099700             MOVE 99                  TO PC233-PGM-MSG-NBR        09970057
099800             PERFORM 8210-XCTL-ERROR-SCREEN                       09980057
099900     END-EVALUATE.                                                09990057
100000/                                                                 10000057
100100 7010-CHECK-IF-SEALED.                                            10010057
100200                                                                  10020057
100300     EXEC SQL                                                     10030057
100400         SELECT                                                   10040057
100500             OBTS.TRLR_SEAL_ID                                    10050057
100600         INTO                                                     10060057
100700           :SUOBTS-TRLR-SEAL-ID                                   10070057
100800         FROM                                                     10080057
100900            TSUOBTS OBTS                                          10090057
101000         WHERE OBTS.OTBND_TRIP_ID    = :PC233-TRIP-ID             10100057
101100           AND OBTS.OTBND_STAT_TMST  =                            10110057
101200           ( SELECT                                               10120057
101300                 MAX(OBTS1.OTBND_STAT_TMST)                       10130057
101400                 FROM                                             10140057
101500                 TSUOBTS OBTS1                                    10150057
101600                 WHERE OBTS1.OTBND_TRIP_ID = OBTS.OTBND_TRIP_ID   10160057
101700            )                                                     10170057
101800     END-EXEC.                                                    10180057
101900                                                                  10190057
102000     EVALUATE TRUE                                                10200057
102100         WHEN SQLCODE = ZERO                                      10210057
102200             IF  SUOBTS-TRLR-SEAL-ID  >  SPACES                   10220057
102300                 SET PS-TRLR-SEALED       TO TRUE                 10230057
102400             ELSE                                                 10240057
102500                 SET PS-TRLR-NOT-SEALED   TO TRUE                 10250057
102600             END-IF                                               10260057
102700         WHEN SQLCODE = +100                                      10270057
102800             SET PS-TRLR-NOT-SEALED   TO TRUE                     10280057
102900         WHEN SQLCODE = -904                                      10290057
103000         WHEN SQLCODE = -913                                      10300057
103100         WHEN SQLCODE = -911                                      10310057
103200             MOVE 1                   TO PV-ERROR-NBR             10320057
103300             PERFORM 9903-WRITE-CICS-LOG                          10330057
103400             PERFORM 9000-SOFT-ABORT                              10340057
103500         WHEN SQLWARN0 NOT = SPACES                               10350057
103600         WHEN SQLCODE NOT EQUAL ZERO                              10360057
103700             MOVE 2                   TO PV-ERROR-NBR             10370057
103800                                         PC233-ERROR-NBR          10380057
103900             PERFORM 9903-WRITE-CICS-LOG                          10390057
104000             MOVE '7010-SELECT-TCNTRID'                           10400057
104100                                      TO PC233-PARAGRAPH          10410057
104200             MOVE 'PCKRF875 - CHECK IF TRLR SEALED '              10420057
104300                                      TO PC233-MESSAGE-TEXT(1)    10430057
104400             MOVE SQLCA               TO PC233-SQLCA              10440057
104500             MOVE 'TSUOBTS'           TO PC233-DB2-TABLE-NAME(1)  10450057
104600             SET PC233-ABEND          TO TRUE                     10460057
104700             MOVE 99                  TO PC233-PGM-MSG-NBR        10470057
104800             PERFORM 8210-XCTL-ERROR-SCREEN                       10480057
104900     END-EVALUATE.                                                10490057
105000/                                                                 10500057
105001******************************************************************10500159
105002* CHECK TO SEE IF ANOTHER TRAILER HAS BEEN OPENED AT THE DOOR    *10500259
105003******************************************************************10500359
105010 7020-CHECK-ALREADY-OPEN.                                         10501059
105051     EXEC SQL                                                     10505159
105052          SELECT C.SCAC_CDE                                       10505259
105053               , C.TRLR_ID                                        10505359
105054               , A.TRLR_SRL_NBR                                   10505467
105055               , A.OTBND_TRIP_ID                                  10505567
105056               , B.DOOR_ID                                        10505667
105067            INTO :PV-ERROR-SCAC                                   10506759
105068               , :PV-ERROR-TRLR                                   10506859
105069               , :PV-ERROR-SRL                                    10506967
105070               , :PV-ERROR-TRIP                                   10507067
105080               , :PV-ERROR-DOOR                                   10508067
105082            FROM TSUOBTR A                                        10508259
105083               , TSUOBTS B                                        10508359
105084               , TCNTRID C                                        10508459
105085           WHERE A.OTBND_TRIP_ID  =  B.OTBND_TRIP_ID              10508559
105086             AND A.TRLR_SRL_NBR   =  C.TRLR_SRL_NBR               10508659
105087             AND B.OTBND_STAT_TMST IN                             10508759
105088                 (SELECT MAX(D.OTBND_STAT_TMST)                   10508859
105089                    FROM TSUOBTS D                                10508959
105090                   WHERE D.STAT_OPER_UNT_ID = :PC233-OPER-UNT-ID  10509060
105091                     AND D.DOOR_ID          = :PC233-DOOR-ID)     10509160
105092             AND B.TRIP_STAT_CDE    = 'DO'                        10509259
105097     END-EXEC.                                                    10509759
105098                                                                  10509859
105099     EVALUATE TRUE                                                10509959
105100         WHEN SQLCODE = ZERO                                      10510059
105101             SET PS-ANOTHER-OPEN-YES  TO TRUE                     10510159
105102         WHEN SQLCODE = +100                                      10510259
105103             SET PS-ANOTHER-OPEN-NO   TO TRUE                     10510359
105104         WHEN SQLCODE = -904                                      10510459
105105         WHEN SQLCODE = -913                                      10510559
105106         WHEN SQLCODE = -911                                      10510659
105107             MOVE 3                   TO PV-ERROR-NBR             10510759
105108             PERFORM 9903-WRITE-CICS-LOG                          10510859
105109             PERFORM 9000-SOFT-ABORT                              10510959
105110         WHEN SQLWARN0 NOT = SPACES                               10511059
105111         WHEN SQLCODE NOT EQUAL ZERO                              10511159
105112             MOVE 4                   TO PV-ERROR-NBR             10511259
105113                                         PC233-ERROR-NBR          10511359
105114             PERFORM 9903-WRITE-CICS-LOG                          10511459
105115             MOVE '7020-CHECK-ALREADY-OPEN'                       10511559
105116                                      TO PC233-PARAGRAPH          10511659
105117             MOVE 'PCKRF875-CHECK TRLR ALREADY OPEN'              10511759
105118                                      TO PC233-MESSAGE-TEXT(1)    10511859
105119             MOVE SQLCA               TO PC233-SQLCA              10511959
105120             MOVE 'TSUOBTR'           TO PC233-DB2-TABLE-NAME(1)  10512059
105121             MOVE 'TSUOBTS'           TO PC233-DB2-TABLE-NAME(1)  10512159
105122             MOVE 'TCNTRID'           TO PC233-DB2-TABLE-NAME(1)  10512259
105123             SET PC233-ABEND          TO TRUE                     10512359
105124             MOVE 99                  TO PC233-PGM-MSG-NBR        10512459
105125             PERFORM 8210-XCTL-ERROR-SCREEN                       10512559
105126     END-EVALUATE.                                                10512659
105127                                                                  10512759
105128                                                                  10512859
105130 7050-SELECT-TSUOBTS.                                             10513057
105200                                                                  10520057
105300     EXEC SQL                                                     10530057
105400         SELECT                                                   10540057
105500             OTBND_TRIP_ID                                        10550057
105600            ,OTBND_STAT_TMST                                      10560057
105700            ,TRIP_STAT_CDE                                        10570057
105800            ,STAT_OPER_UNT_ID                                     10580057
105900            ,OTBND_STAT_USR_ID                                    10590057
106000            ,DOOR_ID                                              10600057
106100            ,TRLR_SEAL_ID                                         10610057
106200            ,SHIP_SCAC_CDE                                        10620057
106300            ,SHIP_DRV_LAST_NM                                     10630057
106400            ,SHIP_DRV_FRST_NM                                     10640057
106500            ,SHIP_DRV_ID                                          10650057
106600            ,TRLR_PRKG_LOC_DESC                                   10660057
106700            ,TRLR_PRKG_SLOT_NBR                                   10670057
106800            ,FINCL_POST_TMST                                      10680057
106900         INTO                                                     10690057
107000             :SUOBTS-OTBND-TRIP-ID                                10700057
107100         ,   :SUOBTS-OTBND-STAT-TMST                              10710057
107200         ,   :SUOBTS-TRIP-STAT-CDE                                10720057
107300         ,   :SUOBTS-STAT-OPER-UNT-ID                             10730057
107400         ,   :SUOBTS-OTBND-STAT-USR-ID                            10740057
107500         ,   :SUOBTS-DOOR-ID                                      10750057
107600         ,   :SUOBTS-TRLR-SEAL-ID                                 10760057
107700         ,   :SUOBTS-SHIP-SCAC-CDE                                10770057
107800         ,   :SUOBTS-SHIP-DRV-LAST-NM                             10780057
107900         ,   :SUOBTS-SHIP-DRV-FRST-NM                             10790057
108000         ,   :SUOBTS-SHIP-DRV-ID                                  10800057
108100         ,   :SUOBTS-TRLR-PRKG-LOC-DESC                           10810057
108200         ,   :SUOBTS-TRLR-PRKG-SLOT-NBR                           10820057
108300         ,   :SUOBTS-FINCL-POST-TMST                              10830057
108400         FROM                                                     10840057
108500            TSUOBTS OBTS                                          10850057
108600         WHERE OBTS.OTBND_TRIP_ID    = :PC233-TRIP-ID             10860057
108700           AND OBTS.OTBND_STAT_TMST  =                            10870057
108800           ( SELECT                                               10880057
108900                 MAX(OBTS1.OTBND_STAT_TMST)                       10890057
109000                 FROM                                             10900057
109100                 TSUOBTS OBTS1                                    10910057
109200                 WHERE OBTS1.OTBND_TRIP_ID = OBTS.OTBND_TRIP_ID   10920057
109300            )                                                     10930057
109400     END-EXEC.                                                    10940057
109500                                                                  10950057
109600     EVALUATE TRUE                                                10960057
109700         WHEN SQLCODE = ZERO                                      10970057
109800             SET PS-TSUOBTS-YES       TO TRUE                     10980057
109900         WHEN SQLCODE = +100                                      10990057
110000             SET PS-TSUOBTS-NO        TO TRUE                     11000057
110100         WHEN SQLCODE = -904                                      11010057
110200         WHEN SQLCODE = -913                                      11020057
110300         WHEN SQLCODE = -911                                      11030057
110400             MOVE 3                   TO PV-ERROR-NBR             11040057
110500             PERFORM 9903-WRITE-CICS-LOG                          11050057
110600             PERFORM 9000-SOFT-ABORT                              11060057
110700         WHEN SQLWARN0 NOT = SPACES                               11070057
110800         WHEN SQLCODE NOT EQUAL ZERO                              11080057
110900             MOVE 4                   TO PV-ERROR-NBR             11090057
111000                                         PC233-ERROR-NBR          11100057
111100             PERFORM 9903-WRITE-CICS-LOG                          11110057
111200             MOVE '7050-SELECT-TCNTRID'                           11120057
111300                                      TO PC233-PARAGRAPH          11130057
111400             MOVE 'PCKRF875 - CHECK TRAILER SEAL ID'              11140057
111500                                      TO PC233-MESSAGE-TEXT(1)    11150057
111600             MOVE SQLCA               TO PC233-SQLCA              11160057
111700             MOVE 'TCNTRID'           TO PC233-DB2-TABLE-NAME(1)  11170057
111800             SET PC233-ABEND          TO TRUE                     11180057
111900             MOVE 99                  TO PC233-PGM-MSG-NBR        11190057
112000             PERFORM 8210-XCTL-ERROR-SCREEN                       11200057
112100     END-EVALUATE.                                                11210057
112200/                                                                 11220057
112300 7100-INSERT-TSUOBTS.                                             11230057
112400                                                                  11240057
112500     IF PS-OPEN-FOR-AUDIT-YES                                     11250057
112600        MOVE 'AO'                     TO SUOBTS-TRIP-STAT-CDE     11260057
112700     ELSE                                                         11270057
112800        MOVE 'DO'                     TO SUOBTS-TRIP-STAT-CDE     11280057
112900     END-IF.                                                      11290057
113000                                                                  11300057
113100     MOVE  PC233-DOOR-ID              TO SUOBTS-DOOR-ID           11310057
113200     MOVE PC233-SEAL-ID               TO SUOBTS-TRLR-SEAL-ID      11320057
113300                                                                  11330057
113400     EXEC SQL                                                     11340057
113500       INSERT INTO TSUOBTS                                        11350057
113600           ( OTBND_TRIP_ID                                        11360057
113700            ,OTBND_STAT_TMST                                      11370057
113800            ,TRIP_STAT_CDE                                        11380057
113900            ,STAT_OPER_UNT_ID                                     11390057
114000            ,OTBND_STAT_USR_ID                                    11400057
114100            ,DOOR_ID                                              11410057
114200            ,TRLR_SEAL_ID                                         11420057
114300            ,SHIP_SCAC_CDE                                        11430057
114400            ,SHIP_DRV_LAST_NM                                     11440057
114500            ,SHIP_DRV_FRST_NM                                     11450057
114600            ,SHIP_DRV_ID                                          11460057
114700            ,TRLR_PRKG_LOC_DESC                                   11470057
114800            ,TRLR_PRKG_SLOT_NBR                                   11480057
114900            ,FINCL_POST_TMST                                      11490057
115000            ,CPCTY_PCT                                            11500057
115100            ,UNUSD_PLLT_QTY                                       11510057
115200            ,LOD_BR_QTY                                           11520057
115300           )                                                      11530057
115400       VALUES                                                     11540057
115500         (                                                        11550057
115600             :SUOBTS-OTBND-TRIP-ID                                11560057
115700         ,   :PV-CURRENT-TIMESTAMP                                11570057
115800         ,   :SUOBTS-TRIP-STAT-CDE                                11580057
115900         ,   :SUOBTS-STAT-OPER-UNT-ID                             11590057
116000         ,   :PC233-USER-ID                                       11600057
116100         ,   :SUOBTS-DOOR-ID                                      11610057
116200         ,   :SUOBTS-TRLR-SEAL-ID                                 11620057
116300         ,   :SUOBTS-SHIP-SCAC-CDE                                11630057
116400         ,   :SUOBTS-SHIP-DRV-LAST-NM                             11640057
116500         ,   :SUOBTS-SHIP-DRV-FRST-NM                             11650057
116600         ,   :SUOBTS-SHIP-DRV-ID                                  11660057
116700         ,   :SUOBTS-TRLR-PRKG-LOC-DESC                           11670057
116800         ,   :SUOBTS-TRLR-PRKG-SLOT-NBR                           11680057
116900         ,   :SUOBTS-FINCL-POST-TMST                              11690057
117000         ,   0                                                    11700057
117100         ,   0                                                    11710057
117200         ,   0                                                    11720057
117300         )                                                        11730057
117400     END-EXEC.                                                    11740057
117500                                                                  11750057
117600     EVALUATE TRUE                                                11760057
117700         WHEN SQLCODE = ZERO                                      11770057
117800         WHEN SQLCODE = +100                                      11780057
117900             CONTINUE                                             11790057
118000         WHEN SQLCODE = -904                                      11800057
118100         WHEN SQLCODE = -913                                      11810057
118200         WHEN SQLCODE = -911                                      11820057
118300             MOVE 5                   TO PV-ERROR-NBR             11830057
118400             PERFORM 9903-WRITE-CICS-LOG                          11840057
118500             PERFORM 9000-SOFT-ABORT                              11850057
118600         WHEN SQLWARN0 NOT = SPACES                               11860057
118700         WHEN SQLCODE NOT EQUAL ZERO                              11870057
118800             MOVE 6                   TO PV-ERROR-NBR             11880057
118900                                         PC233-ERROR-NBR          11890057
119000             PERFORM 9903-WRITE-CICS-LOG                          11900057
119100             MOVE '7100-INSERT-TSUOBTS'                           11910057
119200                                      TO PC233-PARAGRAPH          11920057
119300             MOVE 'PCKRF875 - CREATE OPEN TRAILER TRIP STATUS'    11930057
119400                                      TO PC233-MESSAGE-TEXT(1)    11940057
119500             MOVE SQLCA               TO PC233-SQLCA              11950057
119600             MOVE 'TSUOBTS'           TO PC233-DB2-TABLE-NAME(1)  11960057
119700             SET PC233-ABEND          TO TRUE                     11970057
119800             MOVE 99                  TO PC233-PGM-MSG-NBR        11980057
119900             PERFORM 8210-XCTL-ERROR-SCREEN                       11990057
120000     END-EVALUATE.                                                12000057
120100/                                                                 12010057
120200 7400-INSERT-WRKR-AUD.                                            12020057
120300     EXEC SQL                                                     12030057
120400         INSERT INTO SUT_TRIP_WRKR_AUD                            12040057
120500             (                                                    12050057
120600               OTBND_TRIP_ID                                      12060057
120700             , USR_ID                                             12070057
120800             , CRE_TMST                                           12080057
120900             , CRE_BY_PGM_NM                                      12090057
121000                 )                                                12100057
121100                                                                  12110057
121200             VALUES                                               12120057
121300                                                                  12130057
121400                 (                                                12140057
121500                 :PC233-TRIP-ID                                   12150057
121600             ,   :PC233-USER-ID                                   12160057
121700             ,   CURRENT TIMESTAMP                                12170057
121800             ,   :PC-CURRENT-PROGRAM-NAME                         12180057
121900                 )                                                12190057
122000     END-EXEC.                                                    12200057
122100                                                                  12210057
122200     EVALUATE TRUE                                                12220057
122300         WHEN SQLCODE = ZERO                                      12230057
122400             CONTINUE                                             12240057
122500         WHEN SQLCODE = -904                                      12250057
122600         WHEN SQLCODE = -913                                      12260057
122700         WHEN SQLCODE = -911                                      12270057
122800     EVALUATE TRUE                                                12280057
122900         WHEN SQLCODE = ZERO                                      12290057
123000         WHEN SQLCODE = +100                                      12300057
123100             CONTINUE                                             12310057
123200         WHEN SQLCODE = -904                                      12320057
123300         WHEN SQLCODE = -913                                      12330057
123400         WHEN SQLCODE = -911                                      12340057
123500             MOVE 5                   TO PV-ERROR-NBR             12350057
123600             PERFORM 9903-WRITE-CICS-LOG                          12360057
123700             PERFORM 9000-SOFT-ABORT                              12370057
123800         WHEN SQLWARN0 NOT = SPACES                               12380057
123900         WHEN SQLCODE NOT EQUAL ZERO                              12390057
124000             MOVE 6                   TO PV-ERROR-NBR             12400057
124100                                         PC233-ERROR-NBR          12410057
124200             PERFORM 9903-WRITE-CICS-LOG                          12420057
124300             MOVE '7400-INSERT-WRKR-AUD'                          12430057
124400                                      TO PC233-PARAGRAPH          12440057
124500             MOVE 'PCKRF875 - INSERT INTO WORKER AUDIT'           12450057
124600                                      TO PC233-MESSAGE-TEXT(1)    12460057
124700             MOVE SQLCA               TO PC233-SQLCA              12470057
124800             MOVE 'SUT_TRIP_WRKR_AUD' TO PC233-DB2-TABLE-NAME(1)  12480057
124900             SET PC233-ABEND          TO TRUE                     12490057
125000             MOVE 99                  TO PC233-PGM-MSG-NBR        12500057
125100             PERFORM 8210-XCTL-ERROR-SCREEN                       12510057
125200     END-EVALUATE.                                                12520057
125300/                                                                 12530057
125400                                                                  12540057
125500                                                                  12550057
125600 8000-SEND-MAP.                                                   12560057
125700                                                                  12570057
125800     EXEC CICS                                                    12580057
125900         SEND MAP       ('PC875A')                                12590057
126000              MAPSET    ('PCKM875')                               12600057
126100              ERASE                                               12610057
126200              CURSOR                                              12620057
126300              RESP      (PV-CICS-RESPONSE)                        12630057
126400     END-EXEC.                                                    12640057
126500                                                                  12650057
126600     EVALUATE TRUE                                                12660057
126700         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 12670057
126800             CONTINUE                                             12680057
126900         WHEN OTHER                                               12690057
127000             MOVE '8000-SEND-MAP'     TO DP013-PARAGRAPH          12700057
127100             MOVE 'PCKRF875 - UNABLE TO SEND MAP'                 12710057
127200                                      TO DP013-MESSAGE-TEXT (1)   12720057
127300             SET DP013-CICS-ABEND                                 12730057
127400                 DP013-ROLLBACK       TO TRUE                     12740057
127500             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               12750057
127600     END-EVALUATE.                                                12760057
127700                                                                  12770057
127800 8010-SEND-DATA-ONLY.                                             12780057
127900                                                                  12790057
128000     EXEC CICS                                                    12800057
128100         SEND MAP       ('PC875A')                                12810057
128200              MAPSET    ('PCKM875')                               12820057
128300              CURSOR                                              12830057
128400              DATAONLY                                            12840057
128500              RESP      (PV-CICS-RESPONSE)                        12850057
128600     END-EXEC.                                                    12860057
128700                                                                  12870057
128800     EVALUATE TRUE                                                12880057
128900         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 12890057
129000             CONTINUE                                             12900057
129100         WHEN OTHER                                               12910057
129200             MOVE '8010-SEND-DATA-ONLY'                           12920057
129300                                      TO DP013-PARAGRAPH          12930057
129400             MOVE 'PCKRF875 - UNABLE TO SEND DATA'                12940057
129500                                      TO DP013-MESSAGE-TEXT (1)   12950057
129600             SET DP013-CICS-ABEND                                 12960057
129700                 DP013-ROLLBACK       TO TRUE                     12970057
129800             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               12980057
129900     END-EVALUATE.                                                12990057
130000                                                                  13000057
130100 8020-RECEIVE-MAP.                                                13010057
130200                                                                  13020057
130300     EXEC CICS                                                    13030057
130400         RECEIVE MAP    ('PC875A')                                13040057
130500                 MAPSET ('PCKM875')                               13050057
130600                 RESP   (PV-CICS-RESPONSE)                        13060057
130700     END-EXEC.                                                    13070057
130800                                                                  13080057
130900     EVALUATE TRUE                                                13090057
131000         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 13100057
131100             CONTINUE                                             13110057
131200         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                13120057
131300             CONTINUE                                             13130057
131400         WHEN OTHER                                               13140057
131500            MOVE '8020-RECEIVE-MAP'   TO DP013-PARAGRAPH          13150057
131600            MOVE 'PCKRF875 - UNABLE TO RECEIVE MAP'               13160057
131700                                      TO DP013-MESSAGE-TEXT (1)   13170057
131800            SET DP013-LOGIC-ABEND     TO TRUE                     13180057
131900            SET DP013-ROLLBACK        TO TRUE                     13190057
132000            PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                13200057
132100     END-EVALUATE.                                                13210057
132200                                                                  13220057
132300 8100-RETURN-TRANID.                                              13230057
132400                                                                  13240057
132500     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH       13250057
132600     EXEC CICS                                                    13260057
132700         RETURN TRANSID  (PC-TRANID)                              13270057
132800                COMMAREA (CA-COMMAREA)                            13280057
132900                LENGTH   (PV-COMMAREA-LENGTH)                     13290057
133000                RESP     (PV-CICS-RESPONSE)                       13300057
133100     END-EXEC.                                                    13310057
133200                                                                  13320057
133300     EVALUATE TRUE                                                13330057
133400         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 13340057
133500             CONTINUE                                             13350057
133600         WHEN OTHER                                               13360057
133700             MOVE '8100-RETURN-TRANIND'                           13370057
133800                                      TO DP013-PARAGRAPH          13380057
133900             MOVE 'PCKRF875 - UNABLE TO RETURN TO TRANID'         13390057
134000                 TO DP013-MESSAGE-TEXT (1)                        13400057
134100             SET DP013-CICS-ABEND     TO TRUE                     13410057
134200             SET DP013-ROLLBACK       TO TRUE                     13420057
134300             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               13430057
134400     END-EVALUATE.                                                13440057
134500                                                                  13450057
134600 8110-RETURN.                                                     13460057
134700                                                                  13470057
134800     EXEC CICS                                                    13480057
134900         SEND FROM (PV-MESSAGE-AREA)                              13490057
135000              LENGTH (19)                                         13500057
135100              ERASE                                               13510057
135200     END-EXEC.                                                    13520057
135300                                                                  13530057
135400     EXEC CICS                                                    13540057
135500         RETURN                                                   13550057
135600     END-EXEC.                                                    13560057
135700                                                                  13570057
135800 8200-XCTL.                                                       13580057
135900     SET PC233-INITIALIZE-SCREEN      TO TRUE.                    13590057
136000     MOVE PC-CURRENT-PROGRAM-NAME     TO PC233-LAST-PROGRAM.      13600057
136100     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH       13610057
136200                                                                  13620057
136300     EXEC CICS                                                    13630057
136400         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    13640057
136500               COMMAREA  (CA-COMMAREA)                            13650057
136600               LENGTH    (PV-COMMAREA-LENGTH)                     13660057
136700               RESP      (PV-CICS-RESPONSE)                       13670057
136800     END-EXEC.                                                    13680057
136900                                                                  13690057
137000     EVALUATE TRUE                                                13700057
137100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 13710057
137200             CONTINUE                                             13720057
137300         WHEN OTHER                                               13730057
137400             MOVE '8200-XCTL'                                     13740057
137500                                      TO DP013-PARAGRAPH          13750057
137600             MOVE 'PCKRF875 - UNABLE TO XCTL TO PROGRAM: '        13760057
137700                                      TO DP013-MESSAGE-TEXT (1)   13770057
137800             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   13780057
137900             SET DP013-CICS-ABEND                                 13790057
138000                 DP013-ROLLBACK       TO TRUE                     13800057
138100             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               13810057
138200             MOVE PC-TRANS-UNAVAILABLE-MSG                        13820057
138300                                      TO AMSGLNO                  13830057
138400             SET PC233-PROCESS-SCREEN TO TRUE                     13840057
138500             MOVE -1                  TO ASEALL                   13850057
138600             PERFORM 8000-SEND-MAP                                13860057
138700             PERFORM 8100-RETURN-TRANID                           13870057
138800     END-EVALUATE.                                                13880057
138900                                                                  13890057
139000 8210-XCTL-ERROR-SCREEN.                                          13900057
139100     IF NOT PC233-ABEND                                           13910057
139200         SET PC233-INITIALIZE-SCREEN  TO TRUE                     13920057
139300     END-IF                                                       13930057
139400     IF PC233-PGM-MSG-NBR = ZERO                                  13940057
139500         MOVE 2                       TO PC233-PGM-MSG-NBR        13950057
139600     END-IF                                                       13960057
139700                                                                  13970057
139800     MOVE DFHEIBLK                    TO PC233-DFHEIBLK.          13980057
139900     MOVE PC-CURRENT-PROGRAM-NAME     TO PC233-LAST-PROGRAM.      13990057
140000     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH       14000057
140100     MOVE 'PCKRF871'                  TO PV-TRANSFER-PROGRAM      14010057
140200                                                                  14020057
140300     EXEC CICS                                                    14030057
140400         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    14040057
140500               COMMAREA  (CA-COMMAREA)                            14050057
140600               LENGTH    (PV-COMMAREA-LENGTH)                     14060057
140700               RESP      (PV-CICS-RESPONSE)                       14070057
140800     END-EXEC.                                                    14080057
140900                                                                  14090057
141000     EVALUATE TRUE                                                14100057
141100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 14110057
141200             CONTINUE                                             14120057
141300         WHEN OTHER                                               14130057
141400             MOVE '8200-XCTL'                                     14140057
141500                                      TO DP013-PARAGRAPH          14150057
141600             MOVE 'PCKRF875 - UNABLE TO XCTL TO PROGRAM: '        14160057
141700                                      TO DP013-MESSAGE-TEXT (1)   14170057
141800             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   14180057
141900             SET DP013-CICS-ABEND                                 14190057
142000                 DP013-ROLLBACK       TO TRUE                     14200057
142100             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               14210057
142200             MOVE PC-TRANS-UNAVAILABLE-MSG                        14220057
142300                                      TO AMSGLNO                  14230057
142400             SET PC233-PROCESS-SCREEN TO TRUE                     14240057
142500             MOVE -1                  TO ASEALL                   14250057
142600             PERFORM 8000-SEND-MAP                                14260057
142700             PERFORM 8100-RETURN-TRANID                           14270057
142800     END-EVALUATE.                                                14280057
142900                                                                  14290057
143000*                                                                 14300057
143100 8220-XCTL-TO-HELP.                                               14310057
143200                                                                  14320057
143300     MOVE LENGTH OF PC192-COMMAREA    TO PV-COMMAREA-LENGTH       14330057
143400                                                                  14340057
143500     EXEC CICS                                                    14350057
143600         XCTL                                                     14360057
143700             PROGRAM   (PV-TRANSFER-PROGRAM)                      14370057
143800             COMMAREA  (PC192-COMMAREA)                           14380057
143900             LENGTH    (PV-COMMAREA-LENGTH)                       14390057
144000             RESP      (PV-CICS-RESPONSE)                         14400057
144100     END-EXEC.                                                    14410057
144200                                                                  14420057
144300     EVALUATE TRUE                                                14430057
144400         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 14440057
144500              CONTINUE                                            14450057
144600         WHEN OTHER                                               14460057
144700             MOVE '8220-XCTL-TO-HELP' TO DP013-PARAGRAPH          14470057
144800             MOVE 'PCKRF875 - UNABLE TO XCTL TO PROGRAM: '        14480057
144900                                      TO DP013-MESSAGE-TEXT (1)   14490057
145000             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   14500057
145100             SET DP013-CICS-ABEND                                 14510057
145200                 DP013-ROLLBACK       TO TRUE                     14520057
145300             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               14530057
145400             MOVE PC-TRANS-UNAVAILABLE-MSG                        14540057
145500                                      TO AMSGLNO                  14550057
145600             SET PC233-PROCESS-SCREEN TO TRUE                     14560057
145700             MOVE -1                  TO ASEALL                   14570057
145800             PERFORM 8000-SEND-MAP                                14580057
145900             PERFORM 8100-RETURN-TRANID                           14590057
146000     END-EVALUATE.                                                14600057
146100/                                                                 14610057
146200 8230-XCTL-TO-AUDIT-ROOT.                                         14620057
146300                                                                  14630057
146400     SET  PC045-INITIALIZE-SCREEN                                 14640057
146500          PC233-INITIALIZE-SCREEN       TO  TRUE.                 14650057
146600     MOVE PC233-ROOT-PROGRAM            TO  PV-TRANSFER-PROGRAM   14660057
146700     MOVE PC-CURRENT-PROGRAM-NAME       TO  PC233-LAST-PROGRAM    14670057
146800                                            PC045-LAST-PROGRAM.   14680057
146900                                                                  14690057
147000     MOVE  PC233-HOST-SAVE-AREA         TO PC045-COMMAREA-REC.    14700057
147100     MOVE 'AO'                          TO                        14710057
147200                                          PC045-OTBND-TRIP-STATUS.14720057
147300     MOVE PC045-COMMAREA-REC            TO  PC233-HOST-SAVE-AREA. 14730057
147400                                                                  14740057
147500     MOVE LENGTH OF CA-COMMAREA         TO  PV-COMMAREA-LENGTH.   14750057
147600                                                                  14760057
147700     EXEC CICS                                                    14770057
147800         XCTL                                                     14780057
147900             PROGRAM   (PV-TRANSFER-PROGRAM)                      14790057
148000             COMMAREA  (CA-COMMAREA)                              14800057
148100             LENGTH    (PV-COMMAREA-LENGTH)                       14810057
148200             RESP      (PV-CICS-RESPONSE)                         14820057
148300     END-EXEC.                                                    14830057
148400                                                                  14840057
148500     EVALUATE TRUE                                                14850057
148600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 14860057
148700              CONTINUE                                            14870057
148800         WHEN OTHER                                               14880057
148900             MOVE '8230-XCTL-TO-AUDIT-R' TO DP013-PARAGRAPH       14890057
149000             MOVE 'PCKRF875 - UNABLE TO XCTL TO PROGRAM: '        14900057
149100                                      TO DP013-MESSAGE-TEXT (1)   14910057
149200             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   14920057
149300             SET DP013-CICS-ABEND                                 14930057
149400                 DP013-ROLLBACK       TO TRUE                     14940057
149500             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               14950057
149600             MOVE PC-TRANS-UNAVAILABLE-MSG                        14960057
149700                                      TO AMSGLNO                  14970057
149800             SET PC233-PROCESS-SCREEN TO TRUE                     14980057
149900             MOVE -1                  TO ASEALL                   14990057
150000             PERFORM 8000-SEND-MAP                                15000057
150100             PERFORM 8100-RETURN-TRANID                           15010057
150200     END-EVALUATE.                                                15020057
150300                                                                  15030057
150400****************************************************************  15040057
150500*    RETRIEVE THE CURRENT TIMESTAMP TO USE WHEN UPDATING ROWS. *  15050057
150600*                                                              *  15060057
150700****************************************************************  15070057
150800                                                                  15080057
150900 8400-GET-TIMESTAMP.                                              15090057
151000                                                                  15100057
151100     EXEC SQL                                                     15110057
151200                                                                  15120057
151300         SET :PV-CURRENT-TIMESTAMP  = CURRENT TIMESTAMP           15130057
151400                                                                  15140057
151500     END-EXEC.                                                    15150057
151600                                                                  15160057
151700/                                                                 15170057
151800 9000-SOFT-ABORT.                                                 15180057
151900                                                                  15190057
152000     EXEC CICS                                                    15200057
152100         SYNCPOINT ROLLBACK                                       15210057
152200     END-EXEC                                                     15220057
152300                                                                  15230057
152400     MOVE 1                           TO PC233-PGM-MSG-NBR        15240057
152500     MOVE SQLCODE                     TO PC233-SQLCODE            15250057
152600     PERFORM 8210-XCTL-ERROR-SCREEN.                              15260057
152700                                                                  15270057
152800                                                                  15280057
152900 9903-WRITE-CICS-LOG.                                             15290057
153000                                                                  15300057
153100     MOVE SQLCODE                     TO PV-SQLCODE               15310057
153200                                                                  15320057
153300     EXEC CICS                                                    15330057
153400         WRITEQ TD                                                15340057
153500             QUEUE  ('CSSL')                                      15350057
153600             FROM   (PV-LOG-MSG)                                  15360057
153700             RESP   (PV-CICS-RESPONSE)                            15370057
153800     END-EXEC.                                                    15380057
153900                                                                  15390057
154000 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  15400057
154100                                                                  15410057
154200     MOVE PC-CURRENT-PROGRAM-NAME     TO DP013-PROGRAM.           15420057
154300     MOVE DFHEIBLK                    TO DP013-DFHEIBLK.          15430057
154400     INITIALIZE DP013-SRC-TASK-NUMBER                             15440057
154500                DP013-STACK.                                      15450057
154600     SET DP013-LINK-RETURN            TO TRUE.                    15460057
154700                                                                  15470057
154800     EXEC CICS                                                    15480057
154900         LINK                                                     15490057
155000             PROGRAM   (DP013-NAME)                               15500057
155100             COMMAREA  (DP013-PARAMETERS)                         15510057
155200             LENGTH    (DP013-LENGTH)                             15520057
155300     END-EXEC.                                                    15530057
155400                                                                  15540057
155500 999A-WRITE-CSSL-MSG.                                             15550057
155600                                                                  15560057
155700     MOVE LENGTH OF PV-CICS-MSG-AREA2 TO PV-COMMAREA-LENGTH.      15570057
155800                                                                  15580057
155900     EXEC CICS                                                    15590057
156000         WRITEQ TD                                                15600057
156100             QUEUE  ('CSSL')                                      15610057
156200             FROM   (PV-CICS-MSG-AREA2)                           15620057
156300           LENGTH   (PV-COMMAREA-LENGTH)                          15630057
156400             RESP   (PV-CICS-RESPONSE)                            15640057
156500     END-EXEC.                                                    15650057
156600                                                                  15660057
