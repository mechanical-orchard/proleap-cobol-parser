000100 IDENTIFICATION DIVISION.                                         00010000
000200                                                                  00020000
000300 PROGRAM-ID.             TMKRP010.                                00030000
000400 AUTHOR.                 TAMARA KOLTUN.                           00040000
000500 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00050000
000600 DATE-WRITTEN            10/14/96.                                00060000
000700 DATE-COMPILED.                                                   00070000
000800                                                                  00080000
000900 ENVIRONMENT DIVISION.                                            00090000
001000 INPUT-OUTPUT SECTION.                                            00100000
001100                                                                  00110000
001200 FILE-CONTROL.                                                    00120000
001300                                                                  00130000
001400     SELECT TROUBLE-EXTRACT-FILE      ASSIGN TO INP01.            00140000
001500     SELECT OVERALL-TRBL-REPORT       ASSIGN TO RPT01.            00150000
001600                                                                  00160000
001700                                                                  00170000
001800 DATA DIVISION.                                                   00180000
001900                                                                  00190000
002000 FILE SECTION.                                                    00200000
002100 FD  TROUBLE-EXTRACT-FILE                                         00210000
002200     RECORDING MODE IS F                                          00220000
002300     LABEL RECORDS ARE STANDARD                                   00230000
002400     BLOCK CONTAINS 0 RECORDS.                                    00240000
002500                                                                  00250000
002600 01  TROUBLE-EXTRACT-RECORD         PIC X(400).                   00260000
002700                                                                  00270000
002800 FD  OVERALL-TRBL-REPORT                                          00280000
002900     RECORDING MODE IS F                                          00290000
003000     LABEL RECORDS ARE STANDARD                                   00300000
003100     BLOCK CONTAINS 0 RECORDS.                                    00310000
003200                                                                  00320000
003300 01  OVERALL-TRBL-RECORD            PIC X(132).                   00330000
003400                                                                  00340000
003500 WORKING-STORAGE SECTION.                                         00350000
003600 01  PS-SWITCHES.                                                 00360000
003700     05  PS-EOF-SW                   PIC  X(01)    VALUE 'N'.     00370000
003800         88  PS-EOF                                VALUE 'Y'.     00380000
003900         88  PS-NOT-EOF                            VALUE 'N'.     00390000
004000     05  PS-SPECIAL-RUN-SW           PIC  X(01)    VALUE 'N'.     00400000
004100         88  PS-SPECIAL-RUN                        VALUE 'Y'.     00410000
004200         88  PS-NOT-SPECIAL-RUN                    VALUE 'N'.     00420000
004300     05  PS-FIRST-TIME-THRU-SW       PIC  X(01)    VALUE 'F'.     00430000
004400         88  PS-FIRST-TIME-THRU                    VALUE 'F'.     00440000
004500         88  PS-NOT-FIRST-TIME-THRU                VALUE ' '.     00450000
004600     05  PS-REPORT-SW                PIC  X(01)    VALUE ' '.     00460000
004700         88  PS-TROUBLES-ASSIGNED-RPT              VALUE 'A'.     00470000
004800         88  PS-TOP-TROUBLES-RPT                   VALUE 'T'.     00480000
004900     05  PS-FIRST-GMM-SW             PIC  X(01)    VALUE 'F'.     00490000
005000         88  PS-FIRST-GMM                          VALUE 'F'.     00500000
005100         88  PS-NOT-FIRST-GMM                      VALUE 'N'.     00510000
005200     05  PS-FIRST-ANL-SW             PIC  X(01)    VALUE 'F'.     00520000
005300         88  PS-FIRST-ANALYST                      VALUE 'F'.     00530000
005400         88  PS-NOT-FIRST-ANALYST                  VALUE 'N'.     00540000
005500     05  PS-FIRST-VENDOR-SW          PIC  X(01)    VALUE 'F'.     00550000
005600         88  PS-FIRST-VENDOR                       VALUE 'F'.     00560000
005700         88  PS-NOT-FIRST-VENDOR                   VALUE 'N'.     00570000
005800     05  PS-FIRSTDC-SW               PIC  X(01)    VALUE 'F'.     00580000
005900         88  PS-FIRST-DC                           VALUE 'F'.     00590000
006000         88  PS-NOT-FIRST-DC                       VALUE 'N'.     00600000
006100     05  PS-AREA-SW                  PIC  X(01)    VALUE ' '.     00610000
006200         88  PS-AREA-GMM                           VALUE 'D'.     00620000
006300         88  PS-AREA-DC                            VALUE 'A'.     00630000
006400         88  PS-AREA-VENDOR                        VALUE 'A'.     00640000
006500     05  PS-FIRST-BA-RECORD-SW       PIC  X(01)    VALUE 'F'.     00650000
006600         88  PS-FIRST-BA-RECORD                    VALUE 'F'.     00660000
006700         88  PS-NOT-FIRST-BA-RECORD                VALUE ' '.     00670000
006800     05  PS-FIRST-CM-RECORD-SW       PIC  X(01)    VALUE 'F'.     00680000
006900         88  PS-FIRST-CM-RECORD                    VALUE 'F'.     00690000
007000         88  PS-NOT-FIRST-CM-RECORD                VALUE ' '.     00700000
007100     05  PS-FIRST-AL-RECORD-SW       PIC  X(01)    VALUE 'F'.     00710000
007200         88  PS-FIRST-AL-RECORD                    VALUE 'F'.     00720000
007300         88  PS-NOT-FIRST-AL-RECORD                VALUE ' '.     00730000
007400     05  PS-NOTIFY-TROUBLE-RPT-SW    PIC  X(01)    VALUE 'T'.     00740000
007500         88  PS-TROUBLE-RPT                        VALUE 'T'.     00750000
007600         88  PS-NOTIFY-TROUBLE-RPT                 VALUE 'N'.     00760000
007700 01  PC-PROGRAM-CONSTANTS.                                        00770000
007800     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          00780000
007900                                    'TMKRP010'.                   00790000
008000     05  PC-LINE-LIMIT               PIC S9(04)    VALUE +60      00800000
008100                                                   COMP SYNC.     00810000
008200     05  PC-SPECIAL-RUN-NOTE         PIC X(27)     VALUE          00820000
008300                                    '** SPECIAL REQUESTED RUN **'.00830000
008400     05  PC-ONE                      PIC 9(01)     VALUE  1.      00840000
008500     05  PC-TWO                      PIC 9(01)     VALUE  2.      00850000
008600     05  PC-THREE                    PIC 9(01)     VALUE  3.      00860000
008700     05  PC-FOUR                     PIC 9(01)     VALUE  4.      00870000
008800     05  PC-FIVE                     PIC 9(01)     VALUE  5.      00880000
008900     05  PC-SIX                      PIC 9(01)     VALUE  6.      00890000
009000     05  PC-NOT-FOUND                PIC X(17)     VALUE          00900000
009100                                         '*** NOT FOUND ***'.     00910000
009200     05  PC-AREA-GMM              PIC X(03)   VALUE 'GMM'.        00920000
009300     05  PC-AREA-DC               PIC X(03)   VALUE 'DC '.        00930000
009400     05  PC-AREA-MDS              PIC X(03)   VALUE 'MDS'.        00940000
009500     05  PC-AREA-VENDOR           PIC X(06)   VALUE 'VENDOR'.     00950000
009600     05  PC-MDS-DESC              PIC X(19)   VALUE               00960000
009700                                       'MERCHANDISE ANALYST'.     00970000
009800     05  PC-TBL-MAX               PIC 9(03)   VALUE 250.          00980000
009900     05  PC-MONTHLY               PIC X(13) VALUE '      MONTHLY'.00990000
010000     05  PC-WEEKLY                PIC X(13) VALUE '       WEEKLY'.01000000
010100     05  PC-FALL-SEASON           PIC X(13) VALUE '  FALL SEASON'.01010000
010200     05  PC-SPRING-SEASON         PIC X(13) VALUE 'SPRING SEASON'.01020000
010300     05  PC-FISCAL-YEAR           PIC X(13) VALUE 'FISCAL YEAR  '.01030000
010400     05  PC-CALENDAR-YEAR         PIC X(13) VALUE 'CALENDAR YEAR'.01040000
010500     05  PC-MONTH                 PIC X(11) VALUE '      MONTH'.  01050000
010600     05  PC-WEEK                  PIC X(11) VALUE '       WEEK'.  01060000
010700     05  PC-SEASON                PIC X(11) VALUE '     SEASON'.  01070000
010800     05  PC-FISCAL-YR             PIC X(11) VALUE '  FISCAL YR'.  01080000
010900     05  PC-CALENDAR-YR           PIC X(11) VALUE 'CALENDAR YR'.  01090000
011000     05  PC-AVERAGE               PIC X(07)   VALUE 'AVERAGE'.    01100000
011100     05  PC-TIME-TO-RESOLVE       PIC X(15)   VALUE               01110000
011200                                         'TIME TO RESOLVE'.       01120000
011300 01  PV-PROGRAM-VARIABLES.                                        01130000
011400     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     01140000
011500                                                   COMP SYNC.     01150000
011600     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  01160000
011700     05  PV-ABEND-SQLCODE            PIC  X(10)    VALUE SPACES.  01170000
011800     05  PV-REPORT-NAME              PIC  X(08)  VALUE 'TMKRP010'.01180000
011900     05  PV-LINE-COUNT               PIC S9(04)    VALUE +80      01190000
012000                                                   COMP SYNC.     01200000
012100     05  PV-PAGE-COUNT               PIC S9(04)    VALUE 0        01210000
012200                                                   COMP SYNC.     01220000
012300     05  PV-TOP-TRBLS-COUNT          PIC S9(10)    VALUE 1        01230000
012400                                                   COMP-3.        01240000
012500     05  PV-VENDOR-REC-COUNT         PIC S9(10)    VALUE 0        01250000
012600                                                   COMP-3.        01260000
012700     05  PV-VER-REC-COUNT            PIC S9(10)    VALUE 0        01270000
012800                                                   COMP-3.        01280000
012900     05  PV-VER-TRBL-COUNT           PIC S9(10)    VALUE 0        01290000
013000                                                   COMP-3.        01300000
013100     05  PV-VER-INTRBL-COUNT         PIC S9(10)    VALUE 0        01310000
013200                                                   COMP-3.        01320000
013300     05  PV-DETAIL-COUNT             PIC S9(10)    VALUE 0        01330000
013400                                                   COMP-3.        01340000
013500     05  PV-RCVRS-IN-TRBL-COUNT      PIC S9(10)    VALUE 0        01350000
013600                                                   COMP-3.        01360000
013700     05  PV-CURRENT-DATE             PIC  X(10)    VALUE SPACE.   01370000
013800     05  PV-START-DATE               PIC  X(08)    VALUE SPACE.   01380000
013900     05  PV-END-DATE                 PIC  X(08)    VALUE SPACE.   01390000
014000     05  PV-START-EXTRACT.                                        01400000
014100         10 PV-START-YYYY.                                        01410000
014200            15 PV-START-CC           PIC 9(02)     VALUE 0.       01420000
014300            15 PV-START-YY           PIC 9(02)     VALUE 0.       01430000
014400         10 FILLER                   PIC X(01)     VALUE SPACE.   01440000
014500         10 PV-START-MM              PIC 9(02)     VALUE 0.       01450000
014600         10 FILLER                   PIC X(01)     VALUE SPACE.   01460000
014700         10 PV-START-DD              PIC 9(02)     VALUE 0.       01470000
014800         10 FILLER                   PIC X(01)     VALUE SPACE.   01480000
014900     05  PV-START-EXTRACT-MMDDYY.                                 01490000
015000         10 PV-START-EXTR-MM         PIC 9(02)     VALUE 0.       01500000
015100         10 PV-START-EXTR-DD         PIC 9(02)     VALUE 0.       01510000
015200         10 PV-START-EXTR-YY         PIC 9(02)     VALUE 0.       01520000
015300     05  PV-END-EXTRACT.                                          01530000
015400         10 PV-END-YYYY.                                          01540000
015500            15 PV-END-CC             PIC 9(02)     VALUE 0.       01550000
015600            15 PV-END-YY             PIC 9(02)     VALUE 0.       01560000
015700         10 FILLER                   PIC X(01)     VALUE SPACE.   01570000
015800         10 PV-END-MM                PIC 9(02)     VALUE 0.       01580000
015900         10 FILLER                   PIC X(01)     VALUE SPACE.   01590000
016000         10 PV-END-DD                PIC 9(02)     VALUE 0.       01600000
016100         10 FILLER                   PIC X(01)     VALUE SPACE.   01610000
016200     05  PV-END-EXTRACT-MMDDYY.                                   01620000
016300         10 PV-END-EXTR-MM           PIC 9(02)     VALUE 0.       01630000
016400         10 PV-END-EXTR-DD           PIC 9(02)     VALUE 0.       01640000
016500         10 PV-END-EXTR-YY           PIC 9(02)     VALUE 0.       01650000
016800     05  PV-START-TMST              PIC  X(26)   VALUE SPACE.     01680000
016900     05  PV-END-TMST                PIC  X(26)   VALUE SPACE.     01690000
017000     05  PV-REPORT-DATE              PIC X(10)     VALUE SPACE.   01700000
017100     05  PV-AVG-TOT-HOURS            PIC 9(10)     VALUE 0.       01710000
017200     05  PV-AVG-TOT-MINUTES          PIC 9(10)     VALUE 0.       01720000
017300     05  PV-AVG-MINUTES              PIC 9(10)     VALUE 0.       01730000
017400     05  PV-GMM-SAVE                PIC  X(02)   VALUE SPACES.    01740000
017500     05  PV-GMM-NAME-SAVE           PIC  X(30)   VALUE 'XXXX'.    01750000
017600     05  PV-VENDOR-NBR-SAVE         PIC S9(09)   VALUE 0 COMP.    01760000
017700     05  PV-VENDOR-NAME-SAVE        PIC  X(30)   VALUE 'XXXX'.    01770000
017800     05  PV-DC-NAME-SAVE            PIC  X(30)   VALUE 'XXXX'.    01780000
017900     05  PV-PO-NBR-SAVE             PIC S9(9)    VALUE 0 COMP.    01790000
018000     05  PV-REC-SEQ-NBR-SAVE        PIC S9(9)    VALUE 0 COMP.    01800000
018100     05  PV-TRBL-RSN-CDE-SAVE       PIC S9(4)    VALUE 0 COMP.    01810000
018200     05  PV-RSN-CDE-TOT-QTY-SAVE    PIC S9(7)    VALUE 0 COMP-3.  01820000
018300     05  PV-TRBL-RSN-CDE-DESC-SAVE  PIC  X(20)   VALUE SPACE.     01830000
018400     05  PV-TOT-TROUBLE-SAVE        PIC S9(9)    VALUE 0 COMP-3.  01840000
018500     05  PV-NOTIF-DATE-SAVE         PIC  X(8)    VALUE SPACES.    01850000
018600     05  PV-PER-TO-TOT              PIC 9(3)V99  VALUE 0 COMP-3.  01860000
018700     05  PV-PER-OF-VER-REC          PIC 9(3)V99  VALUE 0 COMP-3.  01870000
018800     05  PV-DC-NAME-HOLD            PIC X(30)    VALUE SPACES.    01880000
018900     05  PV-RPT-AREA-SAVE           PIC X(01)    VALUE 'B'.       01890000
019000         88 PV-AREA-SAVE-BUYING  VALUE 'B'.                       01900000
019100         88 PV-AREA-SAVE-MDS     VALUE 'M'.                       01910000
019200         88 PV-AREA-SAVE-DC      VALUE 'D'.                       01920000
019300         88 PV-AREA-SAVE-VENDOR  VALUE 'V'.                       01930000
019400     05  PV-OPER-UNT-ID-SAVE         PIC 9(04)     VALUE 0.       01940000
019500     05  PV-OPER-UNT-ID-HOLD         PIC 9(04)     VALUE 0.       01950000
019600     05  PV-OPER-UNT-ID-X            PIC X(04)   VALUE SPACES.    01960000
019700                                                                  01970000
019800 01  CT-CPU-TIME.                                                 01980000
019900     03  CT-HOUR                     PIC  9(02)    VALUE ZERO.    01990000
020000     03  CT-MINUTE                   PIC  9(02)    VALUE ZERO.    02000000
020100     03  FILLER                      PIC  9(04)    VALUE ZERO.    02010000
020200                                                                  02020000
020300 01  CD-CPU-DATE.                                                 02030000
020400     03  CD-YEAR                     PIC  9(02)    VALUE ZERO.    02040000
020500     03  CD-MONTH                    PIC  9(02)    VALUE ZERO.    02050000
020600     03  CD-DAY                      PIC  9(02)    VALUE ZERO.    02060000
020700                                                                  02070000
020800 01  PA-PROGRAM-ACCUMULATORS.                                     02080000
020900     05  PA-RESOLVE-HOURS            PIC  S9(10)  VALUE 0 COMP-3. 02090000
021000     05  PA-RESOLVE-MINUTES          PIC  S9(10)  VALUE 0 COMP-3. 02100000
021100     05  PA-TOT-TRBLS                PIC  S9(10)  VALUE 0 COMP-3. 02110000
021200     05  PA-TOT-OF-PRBLMS            PIC  S9(10)  VALUE 0 COMP-3. 02120000
021300     05  PA-NBR-OF-RESOLVED-TRBLS    PIC  S9(10)  VALUE 0 COMP-3. 02130000
021400                                                                  02140000
021500 01  FF-FIELD-FORMATS.                                            02150000
021600     05  FF-ONES.                                                 02160000
021700         10  FILLER                  PIC   X(01)  VALUE '('.      02170000
021800         10  FF-ONES-QTY             PIC   9(01).                 02180000
021900         10  FILLER                  PIC   X(07)  VALUE ')      '.02190000
022000     05  FF-TENS.                                                 02200000
022100         10  FILLER                  PIC   X(01)  VALUE '('.      02210000
022200         10  FF-TENS-QTY             PIC   9(02).                 02220000
022300         10  FILLER                  PIC   X(06)  VALUE ')     '. 02230000
022400     05  FF-HUNDREDS.                                             02240000
022500         10  FILLER                  PIC   X(01)  VALUE '('.      02250000
022600         10  FF-HUNDREDS-QTY         PIC   9(03).                 02260000
022700         10  FILLER                  PIC   X(05)  VALUE ')    '.  02270000
022800     05  FF-THOUSANDS.                                            02280000
022900         10  FILLER                  PIC   X(01)  VALUE '('.      02290000
023000         10  FF-THOUSANDS-QTY        PIC   9,999.                 02300000
023100         10  FILLER                  PIC   X(03)  VALUE ')  '.    02310000
023200     05  FF-10-THOUSANDS.                                         02320000
023300         10  FILLER                  PIC   X(01)  VALUE '('.      02330000
023400         10  FF-10-THOUSANDS-QTY     PIC   99,999.                02340000
023500         10  FILLER                  PIC   X(02)  VALUE ') '.     02350000
023600     05  FF-100-THOUSANDS.                                        02360000
023700         10  FILLER                  PIC   X(01)  VALUE '('.      02370000
023800         10  FF-100-THOUSANDS-QTY    PIC   999,999.               02380000
023900         10  FILLER                  PIC   X(01)  VALUE ')'.      02390000
024000     05  FF-MILLIONS.                                             02400000
024100         10  FILLER                  PIC   X(01)  VALUE '('.      02410000
024200         10  FF-MILLIONS-QTY         PIC   9,999,999.             02420000
024300         10  FILLER                  PIC   X(01)  VALUE ')'.      02430000
024400                                                                  02440000
024500     COPY DPWS132O.                                               02450000
024600                                                                  02460000
024700 01  HL1-HEADING-LINE-1.                                          02470000
024800     05  FILLER                      PIC  X(02)    VALUE SPACES.  02480000
024900     05  HL1-SPECIAL-RUN-NOTE        PIC  X(27)    VALUE SPACES.  02490000
025000     05  FILLER                      PIC  X(21)    VALUE SPACES.  02500000
025100     05  HL1-REPORT-PERIOD           PIC  X(13)    VALUE SPACES.  02510000
025200     05  FILLER                      PIC  X(24)    VALUE          02520000
025300                                      ' OVERALL TROUBLE SUMMARY'. 02530000
025400     05  FILLER                      PIC  X(45)    VALUE SPACES.  02540000
025500 01  HL1-DATE-LINE-1.                                             02550000
025600     05  FILLER                      PIC  X(04)    VALUE '  * '.  02560000
025700     05  HL1-DATE-BEGIN-MM           PIC  X(02)    VALUE SPACES.  02570000
025800     05  FILLER                      PIC  X(01)    VALUE '/'.     02580000
025900     05  HL1-DATE-BEGIN-DD           PIC  X(02)    VALUE SPACES.  02590000
026000     05  FILLER                      PIC  X(01)    VALUE '/'.     02600000
026100     05  HL1-DATE-BEGIN-YYYY         PIC  X(04)    VALUE SPACES.  02610000
026200     05  FILLER                      PIC  X(03)    VALUE ' - '.   02620000
026300     05  HL1-DATE-END-MM             PIC  X(02)    VALUE SPACES.  02630000
026400     05  FILLER                      PIC  X(01)    VALUE '/'.     02640000
026500     05  HL1-DATE-END-DD             PIC  X(02)    VALUE SPACES.  02650000
026600     05  FILLER                      PIC  X(01)    VALUE '/'.     02660000
026700     05  HL1-DATE-END-YYYY           PIC  X(04)    VALUE SPACES.  02670000
026800     05  FILLER                      PIC  X(02)    VALUE ' *'.    02680000
026900     05  FILLER                      PIC  X(103)   VALUE SPACES.  02690000
027000                                                                  02700000
027100 01  HL2-HEADING-LINE-2.                                          02710000
027200     05  FILLER                      PIC  X(64)   VALUE SPACES.   02720000
027300     05  FILLER                      PIC  X(05)   VALUE 'TOTAL'.  02730000
027400     05  FILLER                      PIC  X(32)   VALUE SPACES.   02740000
027500     05  HL2-AVERAGE                 PIC  X(07)   VALUE SPACES.   02750000
027600     05  FILLER                      PIC  X(36)   VALUE SPACES.   02760000
027700                                                                  02770000
027800 01  HL3-HEADING-LINE-3.                                          02780000
027900     05  FILLER                      PIC  X(06)    VALUE SPACES.  02790000
028000     05  FILLER                      PIC  X(04)    VALUE 'AREA'.  02800000
028100     05  FILLER                      PIC  X(49)    VALUE SPACE.   02810000
028200     05  FILLER                      PIC  X(16)    VALUE          02820000
028300                                              'TROUBLE CREATED '. 02830000
028400     05  FILLER                      PIC  X(05)    VALUE SPACES.  02840000
028500     05  FILLER                      PIC  X(10)    VALUE          02850000
028600                                                   '% TO TOTAL'.  02860000
028700     05  FILLER                      PIC  X(07)    VALUE SPACES.  02870000
028800     05  HL3-TIME-TO-RESOLVE         PIC  X(15)    VALUE SPACES.  02880000
028900     05  FILLER                      PIC  X(27)    VALUE SPACES.  02890000
029000                                                                  02900000
029100 01  HL4-HEADING-LINE-4.                                          02910000
029200     05  FILLER                      PIC  X(04)    VALUE SPACES.  02920000
029300     05  FILLER                      PIC  X(21)    VALUE          02930000
029400                                         'TOP 5 TROUBLE REASONS'. 02940000
029500     05  FILLER                      PIC  X(107)   VALUE SPACE.   02950000
029600                                                                  02960000
029700 01  HL5-HEADING-LINE-5.                                          02970000
029800     05  FILLER                      PIC  X(06)    VALUE SPACES.  02980000
029900     05  FILLER                      PIC  X(07)    VALUE          02990000
030000                                                     'TROUBLE'.   03000000
030100     05  FILLER                      PIC  X(34)    VALUE SPACE.   03010000
030200     05  FILLER                      PIC  X(08)    VALUE          03020000
030300                                                     'CREATED '.  03030000
030400     05  FILLER                      PIC  X(86)    VALUE SPACES.  03040000
030500                                                                  03050000
030600 01  HL6-HEADING-LINE-6.                                          03060000
030700     05  FILLER                      PIC  X(06)    VALUE SPACES.  03070000
030800     05  FILLER                      PIC  X(06)    VALUE 'REASON'.03080000
030900     05  FILLER                      PIC  X(08)    VALUE SPACE.   03090000
031000     05  FILLER                      PIC  X(19)    VALUE          03100000
031100                                            'TROUBLE DESCRIPTION'.03110000
031200     05  FILLER                      PIC  X(08)    VALUE SPACES.  03120000
031300     05  FILLER                      PIC  X(08)    VALUE          03130000
031400                                            'QUANTITY'.           03140000
031500     05  FILLER                      PIC  X(07)    VALUE SPACES.  03150000
031600     05  FILLER                      PIC  X(10)    VALUE          03160000
031700                                            '% TO TOTAL'.         03170000
031800     05  FILLER                      PIC  X(52)    VALUE SPACES.  03180000
031900 01  HL7-HEADING-LINE-7.                                          03190000
032000     05  FILLER                      PIC  X(64)   VALUE SPACES.   03200000
032100     05  FILLER                      PIC  X(05)   VALUE 'TOTAL'.  03210000
032200     05  FILLER                      PIC  X(71)   VALUE SPACES.   03220000
032300                                                                  03230000
032400                                                                  03240000
032500 01  DL-GMM-INFO.                                                 03250000
032600     05  DL-GMM-AREA               PIC  X(03)    VALUE 'GMM'.     03260000
032700     05  FILLER                    PIC  X(03)    VALUE ' - '.     03270000
032800     05  DL-GMM-NBR                PIC  X(03)    VALUE SPACES.    03280000
032900     05  FILLER                    PIC  X(02)    VALUE SPACE.     03290000
033000                                                                  03300000
033100 01  DL-ANL-INFO.                                                 03310000
033200     05  DL-ANL-AREA               PIC  X(03)    VALUE 'MDS'.     03320000
033300     05  FILLER                    PIC  X(03)    VALUE ' - '.     03330000
033400     05  DL-ANL-NBR                PIC  X(03)    VALUE SPACES.    03340000
033500     05  FILLER                    PIC  X(02)    VALUE SPACE.     03350000
033600                                                                  03360000
033700 01  DL-DC-INFO.                                                  03370000
033800     05  DL-DC-AREA                PIC  X(03)    VALUE 'DC '.     03380000
033900     05  FILLER                    PIC  X(03)    VALUE ' - '.     03390000
034000     05  DL-DC-NBR                 PIC  X(04)    VALUE SPACES.    03400000
034100     05  FILLER                    PIC  X(01)    VALUE SPACE.     03410000
034200                                                                  03420000
034300 01  DL-VENDOR-INFO.                                              03430000
034400     05  DL-VENDOR-AREA            PIC  X(06)    VALUE            03440000
034500                                   'VENDOR'.                      03450000
034600     05  DL-VENDOR-NBR             PIC  9(01)    VALUE 0.         03460000
034700     05  FILLER                    PIC  X(04)    VALUE ' -  '.    03470000
034800                                                                  03480000
034900                                                                  03490000
035000 01  DL1-DETAIL-LINE-1.                                           03500000
035100     05  FILLER                      PIC  X(06)    VALUE SPACES.  03510000
035200     05  DL1-DETAIL-INFO             PIC  X(11)    VALUE SPACES.  03520000
035300     05  DL1-NAME                    PIC  X(30)    VALUE SPACES.  03530000
035400     05  FILLER                      PIC  X(14)    VALUE SPACE.   03540000
035500     05  DL1-TOT-ASSIGNED-TRBLS      PIC  Z,ZZZ,ZZ9   VALUE ZEROS.03550000
035600     05  FILLER                      PIC  X(12)    VALUE SPACE.   03560000
035700     05  DL1-PER-TO-TOT              PIC  ZZ9.99   VALUE ZEROS.   03570000
035800     05  FILLER                      PIC  X(14)    VALUE SPACE.   03580000
035900     05  DL1-AVG-TIME                PIC  X(06)    VALUE SPACE.   03590000
036000     05  FILLER                      PIC  X(24)    VALUE SPACE.   03600000
036100                                                                  03610000
036200 01  DL1-AVG-TIME-FIELDS.                                         03620000
036300     05  DL1-AVG-RESOLVE-HHH         PIC  Z(2)9    VALUE ZEROS.   03630000
036400     05  DL1-COLON                   PIC  X(01)    VALUE ':'.     03640000
036500     05  DL1-AVG-RESOLVE-MM          PIC  9(02)    VALUE ZEROS.   03650000
036600                                                                  03660000
036700 01  DL2-DETAIL-LINE-2.                                           03670000
036800     05  FILLER                      PIC  X(08)    VALUE SPACES.  03680000
036900     05  DL2-TROUBLE-NBR             PIC  Z(3)9    VALUE ZEROS.   03690000
037000     05  FILLER                      PIC  X(08)    VALUE SPACES.  03700000
037100     05  DL2-TROUBLE-DESCRIPTION     PIC  X(20)    VALUE SPACES.  03710000
037200     05  FILLER                      PIC  X(05)    VALUE SPACE.   03720000
037300     05  DL2-ASSIGNED-QTY            PIC  Z,ZZZ,ZZ9   VALUE ZEROS.03730000
037400     05  FILLER                      PIC  X(11)    VALUE SPACE.   03740000
037500     05  DL2-PER-TO-TOTAL            PIC  ZZ9.99   VALUE ZEROS.   03750000
037600     05  FILLER                      PIC  X(61)    VALUE SPACE.   03760000
037700                                                                  03770000
037800 01  TL1-TOTAL-LINE-1.                                            03780000
037900     05  FILLER                      PIC X(02)  VALUE SPACES.     03790000
038000     05  FILLER                      PIC X(26)  VALUE             03800000
038100                             'TOTAL TROUBLE CREATED FOR '.        03810000
038200     05  TL1-REPORT-PERIOD           PIC X(11)  VALUE SPACES.     03820000
038300     05  FILLER                      PIC X(08)  VALUE             03830000
038400                                                      ' ENDING '. 03840000
038500     05  TL1-DATE                    PIC X(10)  VALUE SPACES.     03850000
038600     05  FILLER                      PIC X(08)  VALUE SPACES.     03860000
038700     05  FILLER                      PIC X(01)  VALUE '-'.        03870000
038800     05  FILLER                      PIC X(01)  VALUE SPACE.      03880000
038900     05  TL1-TROUBLE-TOTAL           PIC Z,ZZZ,ZZ9.               03890000
039000     05  FILLER                      PIC X(54)  VALUE SPACE.      03900000
039100                                                                  03910000
039200 01  TL2-TOTAL-LINE-2.                                            03920000
039300     05  FILLER                      PIC X(02)  VALUE SPACES.     03930000
039400     05  FILLER                      PIC X(34)  VALUE             03940000
039500                           'TOTAL NOTIFY TROUBLE CREATED FOR '.   03950000
039600     05  TL2-REPORT-PERIOD           PIC X(11)  VALUE SPACES.     03960000
039700     05  FILLER                      PIC X(08)  VALUE             03970000
039800                                                      ' ENDING '. 03980000
039900     05  TL2-DATE                    PIC X(10)  VALUE SPACES.     03990000
040000     05  FILLER                      PIC X(01)  VALUE SPACES.     04000000
040100     05  FILLER                      PIC X(01)  VALUE '-'.        04010000
040200     05  FILLER                      PIC X(01)  VALUE SPACE.      04020000
040300     05  TL2-TROUBLE-TOTAL           PIC Z,ZZZ,ZZ9.               04030000
040400     05  FILLER                      PIC X(54)  VALUE SPACE.      04040000
040500                                                                  04050000
040600                                                                  04060000
040700 01  TL3-TOTAL-LINE-3.                                            04070000
040800     05  FILLER                      PIC X(02)  VALUE SPACES.     04080000
040900     05  FILLER                      PIC X(29)  VALUE             04090000
041000                             'TOTAL RECEIVERS VERIFIED FOR '.     04100000
041100     05  TL3-REPORT-PERIOD           PIC X(11)  VALUE SPACES.     04110000
041200     05  FILLER                      PIC X(08)  VALUE ' ENDING '. 04120000
041300     05  TL3-DATE                    PIC X(10)  VALUE SPACES.     04130000
041400     05  FILLER                      PIC X(05)  VALUE SPACES.     04140000
041500     05  FILLER                      PIC X(01)  VALUE '-'.        04150000
041600     05  FILLER                      PIC X(01)  VALUE SPACE.      04160000
041700     05  TL3-VER-REC-TOTAL           PIC Z,ZZZ,ZZ9.               04170000
041800     05  FILLER                      PIC X(54)  VALUE SPACE.      04180000
041900                                                                  04190000
042000 01  TL4-TOTAL-LINE-4.                                            04200000
042100     05  FILLER                      PIC X(02)  VALUE SPACES.     04210000
042200     05  FILLER                      PIC X(41)  VALUE             04220000
042300                  'PERCENT OF VERIFIED RECEIVERS IN TROUBLE'.     04230000
042400     05  FILLER                      PIC X(22)  VALUE SPACES.     04240000
042500     05  FILLER                      PIC X(01)  VALUE '-'.        04250000
042600     05  FILLER                      PIC X(04)  VALUE SPACE.      04260000
042700     05  TL4-PER-OF-VER-REC          PIC Z(02)9.99.               04270000
042800     05  FILLER                      PIC X(02)  VALUE SPACES.     04280000
042900     05  TL4-RCVRS-VER-TRBL          PIC X(09)  VALUE SPACES.     04290000
043000     05  FILLER                      PIC X(57)  VALUE SPACE.      04300000
043100                                                                  04310000
043200 01  TL5-TOTAL-LINE-5.                                            04320000
043300     05  FILLER                      PIC X(02)  VALUE SPACES.     04330000
043400     05  FILLER                      PIC X(41)  VALUE             04340000
043500                  'TOTAL RECEIVERS IN TROUBLE              '.     04350000
043600     05  FILLER                      PIC X(22)  VALUE SPACES.     04360000
043700     05  FILLER                      PIC X(01)  VALUE '-'.        04370000
043800     05  FILLER                      PIC X(01)  VALUE SPACES.     04380000
043900     05  TL5-RCVRS-IN-TRBL           PIC Z,ZZZ,ZZ9.               04390000
044000     05  FILLER                      PIC X(68)  VALUE SPACE.      04400000
044100                                                                  04410000
044200 01  BL-BLANK-LINE                   PIC  X(132)   VALUE SPACES.  04420000
044300 01  ER-END-REPORT-LINE.                                          04430000
044400     05  FILLER                      PIC X(02)  VALUE SPACE.      04440000
044500     05  FILLER                      PIC X(16)  VALUE             04450000
044600                                     '** END REPORT **'.          04460000
044700     05  FILLER                      PIC X(116) VALUE SPACE.      04470000
044800                                                                  04480000
044900     COPY DPWS004.                                                04490000
045000                                                                  04500000
045100     COPY TMRD001.                                                04510000
045200                                                                  04520000
045300** COPYBOOK FOR LOCATION MODULE -- XLKUT071                       04530000
045400                                                                  04540000
045500     COPY XLWS071.                                                04550000
045600                                                                  04560000
045700*---------------------------------------------------------------* 04570000
045800*    DB2 AREA FOR COMMUNICATIONS                                * 04580000
045900*---------------------------------------------------------------* 04590000
046000     EXEC SQL                                                     04600000
046100          INCLUDE SQLCA                                           04610000
046200     END-EXEC.                                                    04620000
046300                                                                  04630000
046400******************************************************************04640000
046500*  DB2 TABLE DECLARATIONS                                         04650000
046600******************************************************************04660000
046700*    TTRBRCN                                                      04670000
046800                                                                  04680000
046900     EXEC SQL                                                     04690000
047000         INCLUDE TTRBRCN                                          04700000
047100     END-EXEC                                                     04710000
047200                                                                  04720000
047300*    TTRBNTF                                                      04730000
047400                                                                  04740000
047500     EXEC SQL                                                     04750000
047600         INCLUDE TTRBNTF                                          04760000
047700     END-EXEC                                                     04770000
047800                                                                  04780000
047900***************************************************************** 04790000
048000 PROCEDURE DIVISION.                                              04800000
048100***************************************************************** 04810000
048200                                                                  04820000
048300 0000-MAINLINE.                                                   04830000
048400***************************************************************** 04840000
048500*  THIS PARAGRAPH DRIVES THE PROGRAM.                           * 04850000
048600***************************************************************** 04860000
048700     PERFORM 1000-INITIALIZE               THRU 1000-EXIT.        04870000
048800                                                                  04880000
048900     SET PS-NOT-EOF   TO TRUE.                                    04890000
049000     PERFORM 2000-MAIN-PROCESS                                    04900000
049100           UNTIL  PS-EOF.                                         04910000
049200                                                                  04920000
049300     PERFORM 9000-END-PROCESS                  THRU 9000-EXIT.    04930000
049400                                                                  04940000
049500 0000-EXIT.  STOP RUN.                                            04950000
049600                                                                  04960000
049700 1000-INITIALIZE.                                                 04970000
049800      OPEN INPUT  TROUBLE-EXTRACT-FILE.                           04980000
049900      OPEN OUTPUT OVERALL-TRBL-REPORT.                            04990000
050000**** READING THE HEADER RECORD.                                   05000000
050100      READ TROUBLE-EXTRACT-FILE    INTO                           05010000
050200                                  TM001-TROUBLE-EXT-RECORD        05020000
050300          AT END                                                  05030000
050400             SET PS-EOF TO TRUE                                   05040000
050500          NOT AT END                                              05050000
050600             MOVE TM001-RCVRS-VRFYD-QTY TO PV-VER-REC-COUNT       05060000
050700                                           TL3-VER-REC-TOTAL      05070000
050800             MOVE TM001-RCVRS-TRBL-QTY  TO PV-VER-TRBL-COUNT      05080000
050900***TCR                                     TL5-RCVRS-IN-TRBL      05090000
051000             PERFORM 1010-COUNT-RCVRS-IN-TRBL                     05100000
051100             MOVE TM001-VRFYD-TRBL-QTY  TO PV-VER-INTRBL-COUNT    05110000
051200             MOVE TM001-RUN-BEGIN-DATE  TO PV-START-EXTRACT       05120000
051300             MOVE TM001-RUN-END-DATE    TO PV-END-EXTRACT         05130000
051400             STRING                                               05140000
051500                   PV-END-MM                                      05150000
051600                   '/'                                            05160000
051700                   PV-END-DD                                      05170000
051800                   '/'                                            05180000
051900                   PV-END-YYYY                                    05190000
052000                DELIMITED BY SIZE                                 05200000
052100                INTO PV-REPORT-DATE                               05210000
052200              END-STRING                                          05220000
053400                                                                  05340000
053500             STRING                                               05350000
053600                   PV-START-YYYY                                  05360000
053700                   PV-START-MM                                    05370000
053800                   PV-START-DD                                    05380000
053900                DELIMITED BY SIZE                                 05390000
054000                INTO PV-START-DATE                                05400000
054100             END-STRING                                           05410000
054110                                                                  05411000
054200             STRING                                               05420000
054300                   PV-END-YYYY                                    05430000
054400                   PV-END-MM                                      05440000
054500                   PV-END-DD                                      05450000
054600                DELIMITED BY SIZE                                 05460000
054700                INTO PV-END-DATE                                  05470000
054800             END-STRING                                           05480000
056000                                                                  05600000
056100             MOVE PV-REPORT-DATE     TO TL1-DATE                  05610000
056200                                        TL2-DATE                  05620000
056300                                        TL3-DATE                  05630000
056400     END-READ.                                                    05640000
056500                                                                  05650000
056600** PV-CURRENT-DATE NOT REFERENCED, USED TO KEEP PGM DB2           05660000
056700     EXEC SQL                                                     05670000
056800         SET :PV-CURRENT-DATE = CURRENT DATE                      05680000
056900     END-EXEC.                                                    05690000
057000                                                                  05700000
057100     ACCEPT CT-CPU-TIME          FROM TIME.                       05710000
057200     MOVE   CT-HOUR              TO DP132O-RUN-HOUR.              05720000
057300     MOVE   CT-MINUTE            TO DP132O-RUN-MINUTE.            05730000
057400                                                                  05740000
057500     ACCEPT CD-CPU-DATE          FROM DATE.                       05750000
057600     MOVE CD-YEAR                TO DP132O-RUN-YEAR.              05760000
057700     MOVE CD-MONTH               TO DP132O-RUN-MONTH.             05770000
057800     MOVE CD-DAY                 TO DP132O-RUN-DAY.               05780000
057900                                                                  05790000
058000     MOVE 'TMKRP010'             TO DP132O-PROGRAM-NAME.          05800000
058100                                                                  05810000
058200     IF TM001-RUN-WEEKLY                                          05820000
058300        MOVE PC-ONE                 TO DP132O-REPORT-NUMBER       05830000
058400        MOVE PC-WEEKLY              TO HL1-REPORT-PERIOD          05840000
058500        MOVE PC-WEEK                TO TL1-REPORT-PERIOD          05850000
058600                                       TL2-REPORT-PERIOD          05860000
058700                                       TL3-REPORT-PERIOD          05870000
058800     ELSE                                                         05880000
058900       IF TM001-RUN-MONTHLY                                       05890000
059000        MOVE PC-TWO                 TO DP132O-REPORT-NUMBER       05900000
059100        MOVE PC-MONTHLY             TO HL1-REPORT-PERIOD          05910000
059200        MOVE PC-MONTH               TO TL1-REPORT-PERIOD          05920000
059300                                       TL2-REPORT-PERIOD          05930000
059400                                       TL3-REPORT-PERIOD          05940000
059500     ELSE                                                         05950000
059600       IF TM001-RUN-FISCAL-YR                                     05960000
059700        MOVE PC-THREE               TO DP132O-REPORT-NUMBER       05970000
059800        MOVE PC-FISCAL-YEAR         TO HL1-REPORT-PERIOD          05980000
059900        MOVE PC-FISCAL-YR           TO TL1-REPORT-PERIOD          05990000
060000                                       TL2-REPORT-PERIOD          06000000
060100                                       TL3-REPORT-PERIOD          06010000
060200     ELSE                                                         06020000
060300       IF TM001-RUN-CALENDAR-YR                                   06030000
060400        MOVE PC-FOUR                TO DP132O-REPORT-NUMBER       06040000
060500        MOVE PC-CALENDAR-YEAR       TO HL1-REPORT-PERIOD          06050000
060600        MOVE PC-CALENDAR-YR         TO TL1-REPORT-PERIOD          06060000
060700                                       TL2-REPORT-PERIOD          06070000
060800                                       TL3-REPORT-PERIOD          06080000
060900     ELSE                                                         06090000
061000       IF TM001-RUN-SEASONAL                                      06100000
061100        IF TM001-SPRING-SEASON                                    06110000
061200           MOVE PC-FIVE                TO DP132O-REPORT-NUMBER    06120000
061300           MOVE PC-SPRING-SEASON       TO HL1-REPORT-PERIOD       06130000
061400        ELSE                                                      06140000
061500           MOVE PC-SIX                 TO DP132O-REPORT-NUMBER    06150000
061600           MOVE PC-FALL-SEASON         TO HL1-REPORT-PERIOD       06160000
061700       END-IF                                                     06170000
061800        MOVE PC-SEASON              TO TL1-REPORT-PERIOD          06180000
061900                                       TL2-REPORT-PERIOD          06190000
062000                                       TL3-REPORT-PERIOD          06200000
062100             END-IF                                               06210000
062200           END-IF                                                 06220000
062300         END-IF                                                   06230000
062400       END-IF                                                     06240000
062500     END-IF                                                       06250000
062600                                                                  06260000
062700     IF TM001-RUN-SPECIAL                                         06270000
062800        SET PS-SPECIAL-RUN TO TRUE                                06280000
062900        MOVE PC-SPECIAL-RUN-NOTE TO HL1-SPECIAL-RUN-NOTE          06290000
063000        MOVE TM001-BEGIN-MM   TO HL1-DATE-BEGIN-MM                06300000
063100        MOVE TM001-BEGIN-DD   TO HL1-DATE-BEGIN-DD                06310000
063200        MOVE TM001-BEGIN-YYYY TO HL1-DATE-BEGIN-YYYY              06320000
063300        MOVE TM001-END-MM     TO HL1-DATE-END-MM                  06330000
063400        MOVE TM001-END-DD     TO HL1-DATE-END-DD                  06340000
063500        MOVE TM001-END-YYYY   TO HL1-DATE-END-YYYY                06350000
063600     ELSE                                                         06360000
063700        MOVE SPACE               TO HL1-SPECIAL-RUN-NOTE          06370000
063800     END-IF.                                                      06380000
063900                                                                  06390000
064000                                                                  06400000
064100*    MOVE 1                      TO DP132O-REPORT-NUMBER.         06410000
064200*DP132O-LASER-NEW-PAGE-INDICATR                                   06420000
064300 1000-EXIT.  EXIT.                                                06430000
064400                                                                  06440000
064500 1010-COUNT-RCVRS-IN-TRBL.                                        06450000
064600                                                                  06460000
064610* CREATE THE BEGIN AND END RUN DATES FOR THE SQL                  06461000
064662     STRING                                                       06466200
064663          TM001-RUN-BEGIN-DATE                                    06466300
064664          '-00.00.00.000000'                                      06466400
064665          DELIMITED BY SIZE                                       06466500
064666              INTO PV-START-TMST                                  06466600
064667     END-STRING                                                   06466700
064680                                                                  06468000
064690     STRING                                                       06469000
064691          TM001-RUN-END-DATE                                      06469100
064692          '-00.00.00.000000'                                      06469200
064693          DELIMITED BY SIZE                                       06469300
064694              INTO PV-END-TMST                                    06469400
064695     END-STRING                                                   06469500
064696                                                                  06469600
065210     EXEC SQL                                                     06521000
065220      SELECT COUNT (*) AS TOT2                                    06522000
065230      INTO  :PV-RCVRS-IN-TRBL-COUNT                               06523000
065240      FROM (SELECT COUNT (*)                                      06524000
065250            FROM   TTRBNTF A                                      06525000
065260                 , TTRBRCN B                                      06526000
065270            WHERE  RPT_PGM_NM     = :PV-REPORT-NAME               06527000
065280            AND   B.TRBL_RSN_CDE  = A.TRBL_RSN_CDE                06528000
065290            AND   NOTIF_TMST      BETWEEN :PV-START-TMST AND      06529000
065291                                          :PV-END-TMST            06529100
065292            GROUP BY                                              06529200
065293                  PO_NBR                                          06529300
065294                , REC_SEQ_NBR ) TOT1                              06529400
065295     END-EXEC.                                                    06529500
065296                                                                  06529600
066700     EVALUATE TRUE                                                06670000
066800         WHEN SQLCODE = +0                                        06680000
066900             MOVE PV-RCVRS-IN-TRBL-COUNT TO TL5-RCVRS-IN-TRBL     06690000
067000                                                                  06700000
067100         WHEN SQLCODE = +100                                      06710000
067200             CONTINUE                                             06720000
067300                                                                  06730000
067400         WHEN OTHER                                               06740000
067500              MOVE '1010-COUNT-RCVRS-IN-TRBL' TO                  06750000
067600                   PV-ABEND-PARAGRAPH                             06760000
067700              DISPLAY '******************************'            06770000
067800              DISPLAY 'ABEND IN TMKRP010 '                        06780000
067900              DISPLAY 'PARAGRAPH:1010-COUNT-RCVRS-IN-TBL'         06790000
068000              DISPLAY 'MESSAGE:  SQL ERROR SELECTING FROM TTRBRCN'06800000
068100              DISPLAY 'SQLCODE:  ' PV-ABEND-SQLCODE               06810000
068200              DISPLAY '******************************'            06820000
068300              DISPLAY ' '                                         06830000
068400              PERFORM 9999-SQL-ERROR                              06840000
068500      END-EVALUATE.                                               06850000
068600                                                                  06860000
068700 2000-MAIN-PROCESS.                                               06870000
068800      READ TROUBLE-EXTRACT-FILE    INTO                           06880000
068900                                  TM001-TROUBLE-EXT-RECORD        06890000
069000          AT END                                                  06900000
069100             SET PS-EOF TO TRUE                                   06910000
069200          NOT AT END                                              06920000
069300             EVALUATE TRUE                                        06930000
069400                 WHEN TM001-RECORD-TYPE-FINTOT                    06940000
069500                   MOVE TM001-ATL-ASSIGN-TOT-QTY TO               06950000
069600                                          TL1-TROUBLE-TOTAL       06960000
069700                                          TL2-TROUBLE-TOTAL       06970000
069800                                          PV-TOT-TROUBLE-SAVE     06980000
069900                   IF NOT PS-FIRST-TIME-THRU                      06990000
070000                     SET PS-NOTIFY-TROUBLE-RPT   TO TRUE          07000000
070100                     PERFORM 2900-RESET-RESTART  THRU 2900-EXIT   07010000
070200                   END-IF                                         07020000
070300                 WHEN TM001-RECORD-TYPE-DETAIL                    07030000
070400                 WHEN TM001-RECORD-TYPE-VNDDTLSUM                 07040000
070500                   ADD 1   TO PV-DETAIL-COUNT                     07050000
070600                   IF PS-FIRST-TIME-THRU                          07060000
070700                      PERFORM 2100-WRITE-TL1      THRU 2100-EXIT  07070000
070800                      SET PS-NOT-FIRST-TIME-THRU  TO TRUE         07080000
070900                   END-IF                                         07090000
071000                    PERFORM 2200-SUMMARY-AREAS-REPORTS            07100000
071100                                                THRU 2200-EXIT    07110000
071200                 WHEN TM001-RECORD-TYPE-RSNTOT                    07120000
071300                  IF PS-FIRST-CM-RECORD  AND                      07130000
071400                     PV-VENDOR-REC-COUNT = 0                      07140000
071500                    PERFORM 6000-WRITE-DETAIL-LINE  THRU 6000-EXIT07150000
071600                  END-IF                                          07160000
071700                    PERFORM 2300-TOP-TROUBLES-RPT   THRU 2300-EXIT07170000
071800                                                                  07180000
071900             END-EVALUATE.                                        07190000
072000 2000-EXIT.  EXIT.                                                07200000
072100                                                                  07210000
072200 2100-WRITE-TL1.                                                  07220000
072300     EVALUATE TRUE                                                07230000
072400       WHEN TM001-REPORT-TROUBLE                                  07240000
072500          PERFORM 6900-PRINT-HEADINGS  THRU 6900-EXIT             07250000
072600          WRITE OVERALL-TRBL-RECORD                               07260000
072700                        FROM TL1-TOTAL-LINE-1                     07270000
072800                             AFTER ADVANCING 4 LINES              07280000
072900           ADD 4   TO PV-LINE-COUNT                               07290000
073000           WRITE OVERALL-TRBL-RECORD                              07300000
073100                         FROM TL3-TOTAL-LINE-3                    07310000
073200                              AFTER ADVANCING 1 LINES             07320000
073300           ADD 1   TO PV-LINE-COUNT                               07330000
073400           IF PV-TOT-TROUBLE-SAVE      > 0                        07340000
073500              IF  PV-VER-REC-COUNT > 0                            07350000
073600                  COMPUTE PV-PER-OF-VER-REC =                     07360000
073700                          PV-VER-INTRBL-COUNT * 100 /             07370000
073800                          PV-VER-REC-COUNT                        07380000
073900              ELSE                                                07390000
074000                  MOVE 0   TO PV-PER-OF-VER-REC                   07400000
074100              END-IF                                              07410000
074200           ELSE                                                   07420000
074300              MOVE 0   TO PV-PER-OF-VER-REC                       07430000
074400           END-IF                                                 07440000
074500           MOVE  PV-PER-OF-VER-REC   TO TL4-PER-OF-VER-REC        07450000
074600           PERFORM 2110-MOVE-INTRBL                               07460000
074700           WRITE OVERALL-TRBL-RECORD                              07470000
074800                         FROM TL4-TOTAL-LINE-4                    07480000
074900                              AFTER ADVANCING 1 LINES             07490000
075000           ADD 1   TO PV-LINE-COUNT                               07500000
075100           WRITE OVERALL-TRBL-RECORD                              07510000
075200                         FROM TL5-TOTAL-LINE-5                    07520000
075300                              AFTER ADVANCING 1 LINES             07530000
075400           ADD 1   TO PV-LINE-COUNT                               07540000
075500       WHEN TM001-REPORT-NOTIFY                                   07550000
075600           WRITE OVERALL-TRBL-RECORD                              07560000
075700                         FROM TL2-TOTAL-LINE-2                    07570000
075800                              AFTER ADVANCING 4 LINES             07580000
075900     END-EVALUATE.                                                07590000
076000 2100-EXIT.  EXIT.                                                07600000
076100                                                                  07610000
076200 2110-MOVE-INTRBL.                                                07620000
076300                                                                  07630000
076400     IF  PV-VER-INTRBL-COUNT < 10                                 07640000
076500         MOVE PV-VER-INTRBL-COUNT TO                              07650000
076600              FF-ONES-QTY                                         07660000
076700         MOVE FF-ONES TO                                          07670000
076800              TL4-RCVRS-VER-TRBL                                  07680000
076900     ELSE                                                         07690000
077000     IF  PV-VER-INTRBL-COUNT < 100                                07700000
077100         MOVE PV-VER-INTRBL-COUNT TO                              07710000
077200              FF-TENS-QTY                                         07720000
077300         MOVE FF-TENS TO                                          07730000
077400              TL4-RCVRS-VER-TRBL                                  07740000
077500     ELSE                                                         07750000
077600     IF  PV-VER-INTRBL-COUNT < 1000                               07760000
077700         MOVE PV-VER-INTRBL-COUNT TO                              07770000
077800              FF-HUNDREDS-QTY                                     07780000
077900         MOVE FF-HUNDREDS TO                                      07790000
078000              TL4-RCVRS-VER-TRBL                                  07800000
078100     ELSE                                                         07810000
078200     IF  PV-VER-INTRBL-COUNT < 10000                              07820000
078300         MOVE PV-VER-INTRBL-COUNT TO                              07830000
078400              FF-THOUSANDS-QTY                                    07840000
078500         MOVE FF-THOUSANDS TO                                     07850000
078600              TL4-RCVRS-VER-TRBL                                  07860000
078700     ELSE                                                         07870000
078800     IF  PV-VER-INTRBL-COUNT < 100000                             07880000
078900         MOVE PV-VER-INTRBL-COUNT TO                              07890000
079000              FF-10-THOUSANDS-QTY                                 07900000
079100         MOVE FF-10-THOUSANDS TO                                  07910000
079200              TL4-RCVRS-VER-TRBL                                  07920000
079300     ELSE                                                         07930000
079400     IF  PV-VER-INTRBL-COUNT < 1000000                            07940000
079500         MOVE PV-VER-INTRBL-COUNT TO                              07950000
079600              FF-100-THOUSANDS-QTY                                07960000
079700         MOVE FF-100-THOUSANDS TO                                 07970000
079800              TL4-RCVRS-VER-TRBL                                  07980000
079900     ELSE                                                         07990000
080000         MOVE PV-VER-INTRBL-COUNT TO                              08000000
080100              FF-MILLIONS-QTY                                     08010000
080200         MOVE FF-MILLIONS TO                                      08020000
080300              TL4-RCVRS-VER-TRBL.                                 08030000
080400                                                                  08040000
080500                                                                  08050000
080600 2200-SUMMARY-AREAS-REPORTS.                                      08060000
080700     SET   PS-TROUBLES-ASSIGNED-RPT   TO TRUE.                    08070000
080800     IF PV-LINE-COUNT > PC-LINE-LIMIT                             08080000
080900        PERFORM 6900-PRINT-HEADINGS  THRU 6900-EXIT               08090000
081000     END-IF.                                                      08100000
081100     IF PS-FIRST-BA-RECORD OR                                     08110000
081200       (PS-FIRST-AL-RECORD AND PV-DETAIL-COUNT = 0)               08120000
081300         PERFORM 6920-PRINT-SPECIFIC-HEADINGS  THRU 6920-EXIT     08130000
081400         SET PS-NOT-FIRST-BA-RECORD  TO TRUE                      08140000
081500     END-IF.                                                      08150000
081600                                                                  08160000
081700     EVALUATE TRUE                                                08170000
081800         WHEN TM001-RPT-AREA-BUYING                               08180000
081900              IF PS-FIRST-GMM                                     08190000
082000                 SET PV-AREA-SAVE-BUYING   TO TRUE                08200000
082100              END-IF                                              08210000
082200              SET PS-AREA-GMM    TO TRUE                          08220000
082300              PERFORM 2210-GMM-TOTALS THRU 2210-EXIT              08230000
082400         WHEN TM001-RPT-AREA-ANALYST                              08240000
082500              IF PS-FIRST-ANALYST                                 08250000
082600                 PERFORM 6000-WRITE-DETAIL-LINE  THRU 6000-EXIT   08260000
082700                 SET  PV-AREA-SAVE-MDS     TO TRUE                08270000
082800                 SET PS-NOT-FIRST-ANALYST  TO TRUE                08280000
082900                 MOVE 0    TO PA-RESOLVE-HOURS                    08290000
083000                              PA-RESOLVE-MINUTES                  08300000
083100                              PV-AVG-MINUTES                      08310000
083200                              PA-NBR-OF-RESOLVED-TRBLS            08320000
083300                              PV-AVG-TOT-HOURS                    08330000
083400                              PV-AVG-TOT-MINUTES                  08340000
083500                              PA-TOT-OF-PRBLMS                    08350000
083600                              PA-TOT-TRBLS                        08360000
083700              END-IF                                              08370000
083800              PERFORM 2215-ACCUMULATE-TOTALS     THRU 2215-EXIT   08380000
083900         WHEN TM001-RPT-AREA-DC                                   08390000
084000              IF PS-FIRST-DC                                      08400000
084100               PERFORM 6000-WRITE-DETAIL-LINE    THRU 6000-EXIT   08410000
084200               SET  PV-AREA-SAVE-DC     TO TRUE                   08420000
084300              END-IF                                              08430000
084400              SET PV-AREA-SAVE-DC       TO TRUE                   08440000
084500              SET PS-AREA-DC            TO TRUE                   08450000
084600              PERFORM 2220-DC-TOTALS THRU 2220-EXIT               08460000
084700         WHEN TM001-RECORD-TYPE-VNDDTLSUM                         08470000
084800              IF PS-FIRST-AL-RECORD                               08480000
084900               PERFORM 6000-WRITE-DETAIL-LINE  THRU 6000-EXIT     08490000
085000               SET PS-NOT-FIRST-AL-RECORD      TO TRUE            08500000
085100               SET PV-AREA-SAVE-VENDOR       TO TRUE              08510000
085200               SET PS-AREA-VENDOR            TO TRUE              08520000
085300              END-IF                                              08530000
085400              PERFORM 2230-VENDOR-DETAILS THRU 2230-EXIT          08540000
085500     END-EVALUATE.                                                08550000
085600                                                                  08560000
085700     IF TM001-PO-NBR       NOT = PV-PO-NBR-SAVE                   08570000
085800         MOVE TM001-PO-NBR       TO PV-PO-NBR-SAVE                08580000
085900     END-IF.                                                      08590000
086000     IF TM001-REC-SEQ-NBR  NOT = PV-REC-SEQ-NBR-SAVE              08600000
086100         MOVE TM001-REC-SEQ-NBR  TO PV-REC-SEQ-NBR-SAVE           08610000
086200     END-IF.                                                      08620000
086300     IF TM001-TRBL-RSN-CDE NOT = PV-TRBL-RSN-CDE-SAVE             08630000
086400         MOVE TM001-TRBL-RSN-CDE TO PV-TRBL-RSN-CDE-SAVE          08640000
086500         MOVE TM001-TRBL-RSN-CDE-DESC                             08650000
086600                                 TO PV-TRBL-RSN-CDE-DESC-SAVE     08660000
086700     END-IF.                                                      08670000
086800                                                                  08680000
086900     IF TM001-NOTIF-DATE  NOT =  PV-NOTIF-DATE-SAVE               08690000
087000        MOVE TM001-NOTIF-DATE  TO  PV-NOTIF-DATE-SAVE             08700000
087100     END-IF.                                                      08710000
087200 2200-EXIT.  EXIT.                                                08720000
087300                                                                  08730000
087400 2210-GMM-TOTALS.                                                 08740000
087500     IF TM001-GMM-NBR NOT = PV-GMM-SAVE                           08750000
087600        IF NOT PS-FIRST-GMM                                       08760000
087700          PERFORM 6000-WRITE-DETAIL-LINE        THRU 6000-EXIT    08770000
087800        END-IF                                                    08780000
087900        MOVE 0    TO PA-RESOLVE-HOURS                             08790000
088000                     PA-RESOLVE-MINUTES                           08800000
088100                     PV-AVG-MINUTES                               08810000
088200                     PA-NBR-OF-RESOLVED-TRBLS                     08820000
088300                     PV-AVG-TOT-HOURS                             08830000
088400                     PV-AVG-TOT-MINUTES                           08840000
088500                     PA-TOT-OF-PRBLMS                             08850000
088600                     PA-TOT-TRBLS                                 08860000
088700        IF PS-FIRST-GMM                                           08870000
088800           SET PS-NOT-FIRST-GMM        TO TRUE                    08880000
088900        END-IF                                                    08890000
089000                                                                  08900000
089100                                                                  08910000
089200        MOVE TM001-GMM-NBR     TO PV-GMM-SAVE                     08920000
089300        MOVE TM001-GMM-NAME    TO PV-GMM-NAME-SAVE                08930000
089400     END-IF                                                       08940000
089500                                                                  08950000
089600     PERFORM 2215-ACCUMULATE-TOTALS   THRU 2215-EXIT.             08960000
089700 2210-EXIT.  EXIT.                                                08970000
089800                                                                  08980000
089900 2220-DC-TOTALS.                                                  08990000
090000     IF TM001-OPER-UNT-ID  NOT = PV-OPER-UNT-ID-SAVE              09000000
090100        IF NOT PS-FIRST-DC                                        09010000
090200           PERFORM 6000-WRITE-DETAIL-LINE         THRU 6000-EXIT  09020000
090300        END-IF                                                    09030000
090400        MOVE 0    TO PA-RESOLVE-HOURS                             09040000
090500                     PA-RESOLVE-MINUTES                           09050000
090600                     PV-AVG-MINUTES                               09060000
090700                     PA-NBR-OF-RESOLVED-TRBLS                     09070000
090800                     PV-AVG-TOT-HOURS                             09080000
090900                     PV-AVG-TOT-MINUTES                           09090000
091000                     PA-TOT-OF-PRBLMS                             09100000
091100                     PA-TOT-TRBLS                                 09110000
091200        IF PS-FIRST-DC                                            09120000
091300           SET PS-NOT-FIRST-DC         TO TRUE                    09130000
091400        END-IF                                                    09140000
091500        MOVE TM001-OPER-UNT-ID    TO PV-OPER-UNT-ID-SAVE          09150000
091600     END-IF                                                       09160000
091700                                                                  09170000
091800     PERFORM 2215-ACCUMULATE-TOTALS   THRU 2215-EXIT.             09180000
091900 2220-EXIT.  EXIT.                                                09190000
092000                                                                  09200000
092100 2230-VENDOR-DETAILS.                                             09210000
092200     ADD 1  TO PV-VENDOR-REC-COUNT                                09220000
092300     IF PV-VENDOR-REC-COUNT < 6                                   09230000
092400        PERFORM 6000-WRITE-DETAIL-LINE   THRU 6000-EXIT           09240000
092500     END-IF.                                                      09250000
092600 2230-EXIT.  EXIT.                                                09260000
092700                                                                  09270000
092800 2215-ACCUMULATE-TOTALS.                                          09280000
092900     IF TM001-NOTIF-DATE       <= PV-END-DATE     AND             09290000
093000        TM001-NOTIF-DATE       >= PV-START-DATE   AND             09300000
093100         ((TM001-PO-NBR       NOT  = PV-PO-NBR-SAVE)      OR      09310000
093200          (TM001-REC-SEQ-NBR  NOT  = PV-REC-SEQ-NBR-SAVE) OR      09320000
093300          (TM001-NOTIF-DATE   NOT = PV-NOTIF-DATE-SAVE)   OR      09330000
093400          (TM001-TRBL-RSN-CDE NOT  = PV-TRBL-RSN-CDE-SAVE))       09340000
093500        ADD 1   TO PA-TOT-TRBLS                                   09350000
093600      END-IF                                                      09360000
093700                                                                  09370000
093800     IF TM001-RESOLVED-DATE    <= PV-END-DATE     AND             09380000
093900        TM001-RESOLVED-DATE    >= PV-START-DATE   AND             09390000
094000        TM001-RPT-RESOLVED                                        09400000
094100          ADD TM001-RESOLVED-HOURS    TO PA-RESOLVE-HOURS         09410000
094200          ADD TM001-RESOLVED-MINUTES  TO PA-RESOLVE-MINUTES       09420000
094300          ADD 1      TO PA-NBR-OF-RESOLVED-TRBLS                  09430000
094400     END-IF.                                                      09440000
094500                                                                  09450000
094600 2215-EXIT.  EXIT.                                                09460000
094700                                                                  09470000
094800 2300-TOP-TROUBLES-RPT.                                           09480000
094900     SET PS-TOP-TROUBLES-RPT   TO TRUE                            09490000
095000                                                                  09500000
095100     IF PV-LINE-COUNT > PC-LINE-LIMIT                             09510000
095200        PERFORM 6910-PRINT-COMMON-HEADINGS  THRU 6910-EXIT        09520000
095300     END-IF.                                                      09530000
095400                                                                  09540000
095500     IF PS-FIRST-CM-RECORD                                        09550000
095600         PERFORM 6920-PRINT-SPECIFIC-HEADINGS  THRU 6920-EXIT     09560000
095700         SET PS-NOT-FIRST-CM-RECORD  TO TRUE                      09570000
095800     END-IF.                                                      09580000
095900                                                                  09590000
096000                                                                  09600000
096100     IF PV-TOP-TRBLS-COUNT < 6                                    09610000
096200        IF TM001-TRBL-RSN-CDE NOT = PV-TRBL-RSN-CDE-SAVE          09620000
096300         IF TM001-RTL-RSN-CDE-TOT-QTY > 0                         09630000
096400            PERFORM 6000-WRITE-DETAIL-LINE   THRU 6000-EXIT       09640000
096500            IF PV-TOP-TRBLS-COUNT = 5                             09650000
096600               MOVE TM001-RTL-RSN-CDE-TOT-QTY TO                  09660000
096700                                       PV-RSN-CDE-TOT-QTY-SAVE    09670000
096800            END-IF                                                09680000
096900            ADD  1  TO PV-TOP-TRBLS-COUNT                         09690000
097000         END-IF                                                   09700000
097100        END-IF                                                    09710000
097200     ELSE                                                         09720000
097300       IF TM001-RTL-RSN-CDE-TOT-QTY = PV-RSN-CDE-TOT-QTY-SAVE     09730000
097400         IF TM001-RTL-RSN-CDE-TOT-QTY > 0                         09740000
097500            ADD  1  TO PV-TOP-TRBLS-COUNT                         09750000
097600            PERFORM 6000-WRITE-DETAIL-LINE   THRU 6000-EXIT       09760000
097700         END-IF                                                   09770000
097800       END-IF                                                     09780000
097900     END-IF.                                                      09790000
098000 2300-EXIT.  EXIT.                                                09800000
098100                                                                  09810000
098200                                                                  09820000
098300 2900-RESET-RESTART.                                              09830000
098400     MOVE ' '   TO PS-REPORT-SW                                   09840000
098500                   PS-AREA-SW.                                    09850000
098600     SET  PS-FIRST-GMM             TO TRUE.                       09860000
098700     SET  PS-FIRST-DC              TO TRUE.                       09870000
098800     SET  PS-FIRST-BA-RECORD       TO TRUE.                       09880000
098900     SET  PS-FIRST-CM-RECORD       TO TRUE.                       09890000
099000     SET  PS-FIRST-TIME-THRU       TO TRUE.                       09900000
099100     SET  PS-FIRST-ANALYST         TO TRUE.                       09910000
099200     SET  PS-FIRST-AL-RECORD       TO TRUE.                       09920000
099300     MOVE 1  TO PV-TOP-TRBLS-COUNT.                               09930000
099400     MOVE 0  TO PV-VENDOR-REC-COUNT.                              09940000
099500     PERFORM 6910-PRINT-COMMON-HEADINGS  THRU 6910-EXIT.          09950000
099600 2900-EXIT.  EXIT.                                                09960000
099700                                                                  09970000
099800 6000-WRITE-DETAIL-LINE.                                          09980000
099900     IF PV-LINE-COUNT > PC-LINE-LIMIT                             09990000
100000        PERFORM 6900-PRINT-HEADINGS  THRU 6900-EXIT               10000000
100100     END-IF.                                                      10010000
100200                                                                  10020000
100300     EVALUATE TRUE                                                10030000
100400        WHEN PS-TROUBLES-ASSIGNED-RPT                             10040000
100500          IF PS-TROUBLE-RPT                                       10050000
100600             PERFORM 6200-CALC-AVG-RESOLVE-TIME THRU 6200-EXIT    10060000
100700             IF   PA-TOT-TRBLS        = 0  AND                    10070000
100800                  PV-AVG-TOT-HOURS    = 0  AND                    10080000
100900                  PV-AVG-TOT-MINUTES  = 0                         10090000
101000                  GO TO 6000-EXIT                                 10100000
101100             END-IF                                               10110000
101200         ELSE                                                     10120000
101300             MOVE SPACE TO DL1-AVG-TIME                           10130000
101400         END-IF                                                   10140000
101500         EVALUATE TRUE                                            10150000
101600           WHEN PV-AREA-SAVE-BUYING                               10160000
101700              MOVE PV-GMM-SAVE       TO DL-GMM-NBR                10170000
101800              MOVE DL-GMM-INFO       TO DL1-DETAIL-INFO           10180000
101900              MOVE PV-GMM-NAME-SAVE  TO DL1-NAME                  10190000
102000              MOVE PA-TOT-TRBLS      TO DL1-TOT-ASSIGNED-TRBLS    10200000
102100              PERFORM 6300-CLACULATE-TOTALS THRU 6300-EXIT        10210000
102200           WHEN PV-AREA-SAVE-MDS                                  10220000
102300              MOVE DL-ANL-INFO       TO DL1-DETAIL-INFO           10230000
102400              MOVE PC-MDS-DESC       TO DL1-NAME                  10240000
102500              MOVE PA-TOT-TRBLS      TO DL1-TOT-ASSIGNED-TRBLS    10250000
102600              PERFORM 6300-CLACULATE-TOTALS THRU 6300-EXIT        10260000
102700           WHEN PV-AREA-SAVE-DC                                   10270000
102800             IF NOT PS-FIRST-VENDOR                               10280000
102900                MOVE TM001-OPER-UNT-ID TO PV-OPER-UNT-ID-HOLD     10290000
103000                PERFORM 6100-GET-DC-NAME  THRU 6100-EXIT          10300000
103100                MOVE PV-OPER-UNT-ID-X  TO DL-DC-NBR               10310000
103200                MOVE DL-DC-INFO        TO DL1-DETAIL-INFO         10320000
103300                MOVE PV-DC-NAME-HOLD   TO DL1-NAME                10330000
103400                MOVE PA-TOT-TRBLS      TO DL1-TOT-ASSIGNED-TRBLS  10340000
103500             ELSE                                                 10350000
103600                MOVE PV-OPER-UNT-ID-SAVE TO PV-OPER-UNT-ID-HOLD   10360000
103700                PERFORM 6100-GET-DC-NAME THRU 6100-EXIT           10370000
103800                MOVE PV-OPER-UNT-ID-X    TO DL-DC-NBR             10380000
103900                MOVE DL-DC-INFO          TO DL1-DETAIL-INFO       10390000
104000                MOVE PV-DC-NAME-HOLD     TO DL1-NAME              10400000
104100                MOVE PA-TOT-TRBLS        TO DL1-TOT-ASSIGNED-TRBLS10410000
104200             END-IF                                               10420000
104300             PERFORM 6300-CLACULATE-TOTALS THRU 6300-EXIT         10430000
104400           WHEN TM001-RECORD-TYPE-VNDDTLSUM                       10440000
104500             MOVE TM001-VTL-ENT-ID    TO DL-VENDOR-NBR            10450000
104600             MOVE PV-VENDOR-REC-COUNT TO DL-VENDOR-NBR            10460000
104700             MOVE DL-VENDOR-INFO      TO DL1-DETAIL-INFO          10470000
104800             MOVE TM001-VTL-ENT-NAME-DESC                         10480000
104900                                      TO DL1-NAME                 10490000
105000             MOVE TM001-VTL-ASSIGN-TOT-QTY   TO                   10500000
105100                                DL1-TOT-ASSIGNED-TRBLS            10510000
105200             IF PS-TROUBLE-RPT                                    10520000
105300                 MOVE TM001-VTL-RESOLVED-HOURS   TO               10530000
105400                                    DL1-AVG-RESOLVE-HHH           10540000
105500                 MOVE TM001-VTL-RESOLVED-MINUTES TO               10550000
105600                                    DL1-AVG-RESOLVE-MM            10560000
105700                 MOVE DL1-AVG-TIME-FIELDS  TO DL1-AVG-TIME        10570000
105800             ELSE                                                 10580000
105900                 MOVE SPACE    TO DL1-AVG-TIME                    10590000
106000             END-IF                                               10600000
106100             IF PV-TOT-TROUBLE-SAVE > 0                           10610000
106200                COMPUTE PV-PER-TO-TOT =                           10620000
106300                               TM001-VTL-ASSIGN-TOT-QTY *         10630000
106400                               100 / PV-TOT-TROUBLE-SAVE          10640000
106500             ELSE                                                 10650000
106600                 MOVE 0   TO PV-TOT-TROUBLE-SAVE                  10660000
106700             END-IF                                               10670000
106800             MOVE PV-PER-TO-TOT     TO DL1-PER-TO-TOT             10680000
106900         END-EVALUATE                                             10690000
107000         WRITE OVERALL-TRBL-RECORD                                10700000
107100          FROM DL1-DETAIL-LINE-1                                  10710000
107200               AFTER ADVANCING 1 LINE                             10720000
107300          ADD 1   TO PV-LINE-COUNT                                10730000
107400        WHEN PS-TOP-TROUBLES-RPT                                  10740000
107500         MOVE TM001-RTL-TRBL-RSN-CDE    TO DL2-TROUBLE-NBR        10750000
107600         MOVE TM001-RTL-TRBL-RSN-CDE-DESC                         10760000
107700                                        TO DL2-TROUBLE-DESCRIPTION10770000
107800         MOVE TM001-RTL-RSN-CDE-TOT-QTY TO DL2-ASSIGNED-QTY       10780000
107900         IF  PV-TOT-TROUBLE-SAVE > 0                              10790000
108000             COMPUTE PV-PER-TO-TOT =                              10800000
108100                     TM001-RTL-RSN-CDE-TOT-QTY * 100 /            10810000
108200                     PV-TOT-TROUBLE-SAVE                          10820000
108300         ELSE                                                     10830000
108400             MOVE 0 TO PV-PER-TO-TOT                              10840000
108500         END-IF                                                   10850000
108600         MOVE PV-PER-TO-TOT            TO DL2-PER-TO-TOTAL        10860000
108700                                                                  10870000
108800         WRITE OVERALL-TRBL-RECORD                                10880000
108900             FROM DL2-DETAIL-LINE-2                               10890000
109000                  AFTER ADVANCING 1 LINE                          10900000
109100         ADD 1   TO PV-LINE-COUNT                                 10910000
109200     END-EVALUATE.                                                10920000
109300                                                                  10930000
109400                                                                  10940000
109500 6000-EXIT.  EXIT.                                                10950000
109600                                                                  10960000
109700 6100-GET-DC-NAME.                                                10970000
109800     INITIALIZE XL071-COMMAREA-REC.                               10980000
109900     MOVE PV-OPER-UNT-ID-HOLD TO PV-OPER-UNT-ID-X                 10990000
110000                                 XL071-LOCATION-NUMBER.           11000000
110100     CALL XL071-LOCATION-MODULE USING XL071-COMMAREA-REC.         11010000
110200                                                                  11020000
110300     EVALUATE TRUE                                                11030000
110400         WHEN XL071-NO-ERRORS                                     11040000
110500             MOVE XL071-LOC-NM          TO PV-DC-NAME-HOLD        11050000
110600         WHEN XL071-LOC-NOT-FOUND                                 11060000
110700         WHEN XL071-SQLCODE-N = -904                              11070000
110800         WHEN XL071-SQLCODE-N = -913                              11080000
110900             MOVE PC-NOT-FOUND   TO DL1-NAME                      11090000
111000         WHEN XL071-BAD-DB2-RETURN                                11100000
111100             MOVE XL071-SQLCODE TO PV-ABEND-SQLCODE               11110000
111200              DISPLAY '** ABEND ** IN TMKRP010'                   11120000
111300              DISPLAY 'PARAGRAPH:6100-GET-DC-NAME'                11130000
111400              DISPLAY 'SQLCODE:  ' PV-ABEND-SQLCODE               11140000
111500              DISPLAY                                             11150000
111600             'MESSAGE:  SQL ERROR SELECTING FROM XLT_LOC'         11160000
111700              PERFORM 9999-SQL-ERROR   THRU 9999-EXIT             11170000
111800     END-EVALUATE.                                                11180000
111900 6100-EXIT.  EXIT.                                                11190000
112000                                                                  11200000
112100 6200-CALC-AVG-RESOLVE-TIME.                                      11210000
112200       INITIALIZE                                                 11220000
112300                  DL1-AVG-RESOLVE-HHH                             11230000
112400                  DL1-AVG-RESOLVE-MM.                             11240000
112500                                                                  11250000
112600        IF PA-RESOLVE-HOURS          = 0 AND                      11260000
112700           PA-RESOLVE-MINUTES        = 0 AND                      11270000
112800           PA-NBR-OF-RESOLVED-TRBLS  = 0                          11280000
112900           MOVE 0   TO PV-AVG-TOT-HOURS                           11290000
113000           MOVE 0   TO PV-AVG-TOT-MINUTES                         11300000
113100       ELSE                                                       11310000
113200         MULTIPLY 60 BY PA-RESOLVE-HOURS                          11320000
113300         ADD PA-RESOLVE-HOURS TO PA-RESOLVE-MINUTES               11330000
113400         DIVIDE PA-RESOLVE-MINUTES                                11340000
113500                      BY PA-NBR-OF-RESOLVED-TRBLS                 11350000
113600                  GIVING PV-AVG-MINUTES ROUNDED                   11360000
113700                  ON SIZE ERROR                                   11370000
113800                       MOVE 0 TO PV-AVG-MINUTES                   11380000
113900         END-DIVIDE                                               11390000
114000                                                                  11400000
114100         DIVIDE PV-AVG-MINUTES BY 60                              11410000
114200                GIVING PV-AVG-TOT-HOURS                           11420000
114300                REMAINDER PV-AVG-TOT-MINUTES                      11430000
114400                ON SIZE ERROR                                     11440000
114500                      MOVE 0 TO PV-AVG-TOT-HOURS                  11450000
114600                                PV-AVG-TOT-MINUTES                11460000
114700         END-DIVIDE                                               11470000
114800      END-IF.                                                     11480000
114900                                                                  11490000
115000        MOVE PV-AVG-TOT-HOURS          TO DL1-AVG-RESOLVE-HHH     11500000
115100        MOVE PV-AVG-TOT-MINUTES        TO DL1-AVG-RESOLVE-MM.     11510000
115200        MOVE DL1-AVG-TIME-FIELDS       TO DL1-AVG-TIME.           11520000
115300                                                                  11530000
115400 6200-EXIT.  EXIT.                                                11540000
115500                                                                  11550000
115600 6300-CLACULATE-TOTALS.                                           11560000
115700      IF PV-TOT-TROUBLE-SAVE > 0                                  11570000
115800         COMPUTE PV-PER-TO-TOT = PA-TOT-TRBLS * 100 /             11580000
115900                                     PV-TOT-TROUBLE-SAVE          11590000
116000      ELSE                                                        11600000
116100         MOVE 0   TO PV-TOT-TROUBLE-SAVE                          11610000
116200      END-IF                                                      11620000
116300      MOVE PV-PER-TO-TOT     TO DL1-PER-TO-TOT.                   11630000
116400 6300-EXIT.  EXIT.                                                11640000
116500                                                                  11650000
116600 6900-PRINT-HEADINGS.                                             11660000
116700     PERFORM 6910-PRINT-COMMON-HEADINGS   THRU 6910-EXIT.         11670000
116800     PERFORM 6920-PRINT-SPECIFIC-HEADINGS THRU 6920-EXIT.         11680000
116900                                                                  11690000
117000 6900-EXIT.   EXIT.                                               11700000
117100*                                                                 11710000
117200 6910-PRINT-COMMON-HEADINGS.                                      11720000
117300     MOVE 0                          TO PV-LINE-COUNT             11730000
117400     ADD  1                          TO PV-PAGE-COUNT             11740000
117500     MOVE PV-PAGE-COUNT              TO DP132O-PAGE-NUMBER        11750000
117600                                                                  11760000
117700     WRITE OVERALL-TRBL-RECORD                                    11770000
117800           FROM DP132O-STANDRD-HEADER-132-COLS                    11780000
117900                AFTER ADVANCING PAGE                              11790000
118000       ADD 1  TO PV-LINE-COUNT.                                   11800000
118100     WRITE OVERALL-TRBL-RECORD                                    11810000
118200      FROM HL1-HEADING-LINE-1                                     11820000
118300           AFTER ADVANCING 2 LINES                                11830000
118400     ADD 2  TO PV-LINE-COUNT.                                     11840000
118500     IF PS-SPECIAL-RUN                                            11850000
118600         WRITE OVERALL-TRBL-RECORD                                11860000
118700               FROM HL1-DATE-LINE-1                               11870000
118800                   AFTER ADVANCING 1 LINE                         11880000
118900         ADD 1  TO PV-LINE-COUNT                                  11890000
119000     END-IF.                                                      11900000
119100 6910-EXIT.  EXIT.                                                11910000
119200                                                                  11920000
119300 6920-PRINT-SPECIFIC-HEADINGS.                                    11930000
119400     EVALUATE TRUE                                                11940000
119500        WHEN PS-TROUBLES-ASSIGNED-RPT                             11950000
119600            IF PS-TROUBLE-RPT                                     11960000
119700              MOVE PC-AVERAGE         TO HL2-AVERAGE              11970000
119800              MOVE PC-TIME-TO-RESOLVE TO HL3-TIME-TO-RESOLVE      11980000
119900            ELSE                                                  11990000
120000              MOVE SPACES             TO HL2-AVERAGE              12000000
120100              MOVE SPACES             TO HL3-TIME-TO-RESOLVE      12010000
120200            END-IF                                                12020000
120300            WRITE OVERALL-TRBL-RECORD                             12030000
120400             FROM HL2-HEADING-LINE-2                              12040000
120500                  AFTER ADVANCING 2 LINES                         12050000
120600            WRITE OVERALL-TRBL-RECORD                             12060000
120700             FROM HL3-HEADING-LINE-3                              12070000
120800                  AFTER ADVANCING 1 LINE                          12080000
120900            WRITE OVERALL-TRBL-RECORD                             12090000
121000             FROM BL-BLANK-LINE                                   12100000
121100                  AFTER ADVANCING 1 LINE                          12110000
121200           ADD 4  TO PV-LINE-COUNT                                12120000
121300        WHEN PS-TOP-TROUBLES-RPT                                  12130000
121400            WRITE OVERALL-TRBL-RECORD                             12140000
121500             FROM HL4-HEADING-LINE-4                              12150000
121600                  AFTER ADVANCING 3 LINES                         12160000
121700            WRITE OVERALL-TRBL-RECORD                             12170000
121800             FROM HL5-HEADING-LINE-5                              12180000
121900                  AFTER ADVANCING 2 LINES                         12190000
122000            WRITE OVERALL-TRBL-RECORD                             12200000
122100             FROM HL6-HEADING-LINE-6                              12210000
122200                  AFTER ADVANCING 1 LINE                          12220000
122300            WRITE OVERALL-TRBL-RECORD                             12230000
122400             FROM BL-BLANK-LINE                                   12240000
122500                  AFTER ADVANCING 1 LINES                         12250000
122600           ADD 7  TO PV-LINE-COUNT                                12260000
122700     END-EVALUATE.                                                12270000
122800 6920-EXIT.  EXIT.                                                12280000
122900                                                                  12290000
123000 9000-END-PROCESS.                                                12300000
123100     WRITE OVERALL-TRBL-RECORD                                    12310000
123200           FROM ER-END-REPORT-LINE                                12320000
123300                AFTER ADVANCING 2 LINES.                          12330000
123400                                                                  12340000
123500     CLOSE  TROUBLE-EXTRACT-FILE                                  12350000
123600            OVERALL-TRBL-REPORT.                                  12360000
123700 9000-EXIT.  EXIT.                                                12370000
123800                                                                  12380000
123900 9999-SQL-ERROR.                                                  12390000
124000                                                                  12400000
124100     COPY DPPD004.                                                12410000
124200                                                                  12420000
124300     MOVE +4013 TO PV-ABEND-CODE.                                 12430000
124400     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         12440000
124500 9999-EXIT.   EXIT.                                               12450000
124600                                                                  12460000
