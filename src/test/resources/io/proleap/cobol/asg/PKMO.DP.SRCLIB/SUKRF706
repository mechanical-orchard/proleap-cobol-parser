000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400*   THIS VERSION IS SENDING FORM AND DATA                         00040000
000500******************************************************************00050000
000600                                                                  00060000
000700 PROGRAM-ID.             SUKRF706.                                00070000
000800 AUTHOR.                 CHERI PARMLEY.                           00080000
000900 INSTALLATION.           KOHLS.                                   00090000
001000 DATE-WRITTEN.           JULY 11, 2013.                           00100000
001100 DATE-COMPILED.                                                   00110000
001200                                                                  00120000
001300******************************************************************00130000
001400* THIS PROGRAM DISPLAYS THE SCAN CARTON SCREEN ON THE LRT (LASER  00140000
001500* RADIO TERMINAL).  IT WILL ACCEPT THE ENTRY OF THE CARTON NUMBER.00150000
001600* IT WAS CLONED FROM SUKRF502 AND IS USED IN THE RFID FINAL LABEL 00160056
001700* REQUEST FUNCTION OFF THE UCC128 MENU OPTION 5.                  00170000
001800******************************************************************00180000
001900* 07/11/2013  CHERI PARMLEY                                      *00190000
002000*             INITIAL VERSION                                     00200000
002100******************************************************************00210000
002110* 09/26/14    CHERI PARMLEY  CHG0094517     TKID: TKMAF76        *00211078
002120*             CHANGED PO# FROM 7 DIGITS TO 8 DIGITS WERE NEEDED   00212077
002130******************************************************************00213088
002420* 06/24/15    CHERI PARMLEY  CHG0120422     TKID: TKMAF76        *00242085
002430*             USING XLT_BRND TABLE INSTEAD OF MDSE_PGM_ID         00243080
002440******************************************************************00243191
263968* CHANGED 11/16/2021    BY JIM HUNTER      WR: CHG0263968         00243291
263968* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00243391
263968* MAKING THE CALL DYNAMIC VS STATIC.                              00243491
002440******************************************************************00244080
002500 ENVIRONMENT DIVISION.                                            00250000
002600******************************************************************00260000
002700                                                                  00270000
002800******************************************************************00280000
002900 DATA DIVISION.                                                   00290000
003000******************************************************************00300000
003100                                                                  00310000
003200******************************************************************00320000
003300 WORKING-STORAGE SECTION.                                         00330000
003400******************************************************************00340000
003500*                                                                 00350000
003600*----------------------------------------------------------------*00360000
003700*  DB2 KEYS                                                      *00370000
003800*----------------------------------------------------------------*00380000
003900 01  DK-DB2-KEYS.                                                 00390000
004000     05  DK-CTN                          PIC  S9(18)V COMP-3.     00400000
004100     05  DK-CURR-OPER-UNT-ID             PIC  S9(04)  COMP.       00410000
004200     05  DK-DEST-OPER-UNT-ID             PIC  S9(04)  COMP.       00420000
004300     05  DK-OPER-UNT-ID                  PIC  S9(04)  COMP.       00430000
004400     05  DK-FCLTY-ID                     PIC  S9(04)  COMP.       00440000
004500     05  DK-MANIFEST                     PIC  S9(09)  COMP.       00450000
004600     05  DK-BATCH-NUMBER                 PIC  S9(04)  COMP.       00460000
004700     05  DK-PO                           PIC  S9(09)  COMP.       00470000
004800     05  DK-STORE                        PIC  S9(04)  COMP.       00480000
004900     05  DK-REC-SEQ-NBR                  PIC  S9(09)  COMP.       00490000
005000     05  DK-PO-LNE-NBR                   PIC  S9(09)  COMP.       00500000
005100     05  DK-PREPK-ID                     PIC  S9(04)  COMP.       00510000
005200     05  DK-OUTER-QTY                    PIC  S9(04)  COMP.       00520000
005300     05  DK-BARCODE-NBR                  PIC  X(22).              00530000
005400     05  DK-CART-LBL-TYP-CDE             PIC  X(01).              00540000
005500     05  DK-ERR-MSG-CDE                  PIC  X(01).              00550000
005600                                                                  00560000
005700*----------------------------------------------------------------*00570000
005800*  SML LABEL FORM & DATA FOR COMTEC AND RASCAL PRINTING          *00580000
005900*----------------------------------------------------------------*00590000
006000     COPY PCWS160.                                                00600000
006100*----------------------------------------------------------------*00610000
006200* HELP SCREEN COMMAREA                                            00620000
006300     COPY PCWS192.                                                00630000
006400*----------------------------------------------------------------*00640000
006500* HELP SCREEN WORK AREA                                           00650000
006600     COPY PCWS188.                                                00660000
006700*---------------------------------------------------------------* 00670000
006800* COPYBOOK FOR LOGISTICS DOMAIN ITEM ACCESS MODULE              * 00680000
006900*---------------------------------------------------------------* 00690000
007000     COPY XLWS001.                                                00700000
007100                                                                  00710000
007200/                                                                 00720000
007300*---------------------------------------------------------------* 00730000
007400*  RECORD LAYOUTS FOR THE TROUBLE CREATION ROUTINE                00740000
007500*---------------------------------------------------------------* 00750000
007600     COPY TMWS500.                                                00760000
007700                                                                  00770000
007800*---------------------------------------------------------------* 00780000
007900*  RECORD LAYOUTS FOR THE FREE ASTRAY HANDLER MODULE              00790000
008000*---------------------------------------------------------------* 00800000
008100     COPY SUWS044.                                                00810000
008200                                                                  00820000
008300*---------------------------------------------------------------* 00830000
008400*  RECORD LAYOUTS FOR THE AUTO VERF PARM CHECK MODULE             00840000
008500*---------------------------------------------------------------* 00850000
008600     COPY RCWS040.                                                00860000
008700                                                                  00870000
008800*---------------------------------------------------------------* 00880000
008900*  RECORD LAYOUTS FOR THE AUTO CONFIRMATION MODULE                00890000
009000*---------------------------------------------------------------* 00900000
009100     COPY RCWS041.                                                00910000
009200                                                                  00920000
009300*---------------------------------------------------------------* 00930000
009400*  COMMUNICATION AREA FOR THE ASSIGNMENT DATA                     00940000
009500*  USED IN THE DLX LABOR SYSTEM (DLKUP001)                        00950000
009600*---------------------------------------------------------------* 00960000
009700     COPY DLWS001.                                                00970000
009800                                                                  00980000
009900*---------------------------------------------------------------* 00990000
010000*  COMMUNICATION AREA FOR THE ASSIGNMENT DATA                     01000000
010100*  USED IN THE DLX LABOR SYSTEM (DLKUT001)                        01010000
010200*---------------------------------------------------------------* 01020000
010300     COPY DLWS003.                                                01030000
010400                                                                  01040000
010500*---------------------------------------------------------------* 01050000
010600*  COMMUNICATION AREA PASSED TO WRITE INFORMATION                 01060000
010700*  TO THE EAI EXPORT TABLES (XLKUP033)                            01070000
010800*---------------------------------------------------------------* 01080000
010900     COPY XLWS072.                                                01090000
011000                                                                  01100000
011100*---------------------------------------------------------------* 01110000
011200*  LAYOUT WHICH DEFINES THE DATA ELEMENTS                         01120000
011300*  FOUND WITHIN THE DTL_TXT                                       01130000
011400*---------------------------------------------------------------* 01140000
011500     COPY SUWS050.                                                01150000
011600                                                                  01160000
011700*----------------------------------------------------------------*01170000
011800* CT 11/06/08 BEGIN                                              *01180000
011900*    COPYBOOK USED BY TO SEND DIRECTIVE TO SUKUT129              *01190000
012000*----------------------------------------------------------------*01200000
012100                                                                  01210000
012200     COPY SUWS090.                                                01220000
012300                                                                  01230000
012400 01  PC056-COMMAREA.                                              01240000
012500     COPY PCWS056.                                                01250000
012600                                                                  01260000
012700*----------------------------------------------------------------*01270000
012800*    COPYBOOK FOR UNIT WORK MODULE - PCKUT790                    *01280000
012900*----------------------------------------------------------------*01290000
013000                                                                  01300000
013100     COPY PCWS260.                                                01310000
013200                                                                  01320000
013300*----------------------------------------------------------------*01330000
013400*  PROGRAM CONSTANTS                                             *01340000
013500*----------------------------------------------------------------*01350000
013600 01  PC-PROGRAM-CONSTANTS.                                        01360000
013700     05  PC-TRANID                       PIC  X(04)  VALUE 'S706'.01370000
013800     05  PC-MAX-RETRIES                  PIC S9(04)  VALUE +3     01380000
013900                                                     COMP SYNC.   01390000
014000     05  PC-ROW-NOT-FOUND                PIC S9(04)  VALUE +100   01400000
014100                                                     COMP SYNC.   01410000
014200     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     01420000
014300                                                     COMP SYNC.   01430000
014400     05  PC-MF-FORM-LENGTH               PIC S9(04)  VALUE +207   01440000
014500                                                     COMP SYNC.   01450000
014600     05  PC-MF-DATA-LENGTH               PIC S9(04)  VALUE +30    01460000
014700                                                     COMP SYNC.   01470000
014800     05  PC-FI-DATA-LENGTH               PIC S9(04)  VALUE +200   01480000
014900                                                     COMP SYNC.   01490000
015000     05  PC-FI-FORM-LENGTH               PIC S9(04)  VALUE +244   01500000
015100                                                     COMP SYNC.   01510000
015200     05  PC-RECEIVE-LENGTH               PIC S9(04)  VALUE +1     01520000
015300                                                     COMP SYNC.   01530000
015400     05  PC-RECEIVE-LENGTH-DISPLAY       PIC 9(8)    VALUE ZERO.  01540000
015500     05  PC-RFDF                         PIC  X(04)  VALUE 'RFDF'.01550039
015600     05  PC-RECV                         PIC  X(04)  VALUE 'RECV'.01560032
015700     05  PC-PBSA                         PIC  X(04)  VALUE 'PBSA'.01570000
015800     05  PC-PBSB                         PIC  X(04)  VALUE 'PBSB'.01580000
015900     05  PC-PBSC                         PIC  X(04)  VALUE 'PBSC'.01590000
016000     05  PC-PBSD                         PIC  X(04)  VALUE 'PBSD'.01600000
016100     05  PC-PBSE                         PIC  X(04)  VALUE 'PBSE'.01610000
016200     05  PC-FLAT                         PIC  X(04)  VALUE 'FLAT'.01620000
016300     05  PC-N                            PIC  X(01)  VALUE 'N'.   01630000
016400     05  PC-PO                           PIC  X(02)  VALUE 'PO'.  01640000
016500     05  PC-RCV                          PIC  X(03)  VALUE 'RCV'. 01650000
016600     05  PC-0                            PIC  X(01)  VALUE '0'.   01660000
016700     05  PC-4                            PIC  X(01)  VALUE '4'.   01670000
016800     05  PC-5                            PIC  X(01)  VALUE '5'.   01680000
016900     05  PC-00                           PIC  9(02)  VALUE 00.    01690000
017000     05  PC-COLON                        PIC  X(01)  VALUE ':'.   01700000
017100     05  PC-A                            PIC  X(01)  VALUE 'A'.   01710000
017200     05  PC-B                            PIC  X(01)  VALUE 'B'.   01720000
017300     05  PC-C                            PIC  X(01)  VALUE 'C'.   01730000
017400     05  PC-E                            PIC  X(01)  VALUE 'E'.   01740000
017500     05  PC-P                            PIC  X(01)  VALUE 'P'.   01750000
017600     05  PC-R                            PIC  X(01)  VALUE 'R'.   01760000
017700     05  PC-Y                            PIC  X(01)  VALUE 'Y'.   01770000
017800     05  PC-DS                           PIC  X(02)  VALUE 'DS'.  01780000
017900     05  PC-PS                           PIC  X(02)  VALUE 'PS'.  01790000
018000     05  PC-PP                           PIC  X(02)  VALUE 'PP'.  01800000
018100     05  PC-BC                           PIC  X(02)  VALUE 'BC'.  01810000
018200     05  PC-FA                           PIC  X(02)  VALUE 'FA'.  01820000
018300     05  PC-ASN                          PIC  X(03)  VALUE 'ASN'. 01830000
018400     05  PC-0-9                          PIC  9(01)  VALUE 0.     01840000
018500     05  PC-ACTIVE                       PIC  X(01)  VALUE 'A'.   01850000
018600     05  PC-M                            PIC  X(01)  VALUE 'M'.   01860000
018700     05  PC-I                            PIC  X(01)  VALUE 'I'.   01870000
018800     05  PC-D                            PIC  X(01)  VALUE 'D'.   01880025
018900     05  PC-SPACE                        PIC  X(01)  VALUE ' '.   01890000
019000     05  PC-1                            PIC S9(04)  VALUE 18     01900032
019100                                                     COMP SYNC.   01910032
019200     05  PC-18                           PIC S9(04)  VALUE 18     01920000
019300                                                     COMP SYNC.   01930000
019400     05  PC-19                           PIC S9(04)  VALUE 19     01940000
019500                                                     COMP SYNC.   01950000
019600     05  PC-20                           PIC S9(04)  VALUE 20     01960000
019700                                                     COMP SYNC.   01970000
019800     05  PC-NEG-9                        PIC S9(09)  VALUE        01980000
019900                                                      -999999999. 01990000
020000     05  PC-FKEYS                        PIC X(19)   VALUE        02000000
020100                                         'F4-PRT SML         '.   02010002
020200     05  PC-F5-AUDIT-FKEY                PIC X(19)   VALUE        02020000
020300                                         'F5-AUDIT           '.   02030000
020400     05  PC-FKEY2                        PIC X(19)   VALUE        02040000
020500                                         '                   '.   02050002
020600     05  PC-FKEY3                        PIC X(19)   VALUE        02060046
020700                                         'F4- IGNR&PRT      '.    02070046
020800     05  PC-MULTI-LINE                   PIC  X(04)  VALUE 'MULT'.02080000
020900     05  PC-NOLNE-LINE                   PIC  X(04)  VALUE 'NOLN'.02090000
021000     05  PC-MULT-SKU                     PIC  X(11)  VALUE        02100000
021100                                          '**MULT SKU*'.          02110000
021200     05  PC-NO-SKU-NUM                   PIC  X(11)  VALUE        02120000
021300                                          '*NO SKU NM*'.          02130000
021400     05  PC-ONE                          PIC  9(04)  VALUE 1      02140000
021500                                                     COMP.        02150000
021600     05  PC-DEFAULT-TIME                 PIC  X(26)  VALUE        02160000
021700                                 '9999-09-09-09.09.09.999999'.    02170000
021800**PACK BY STORE TROUBLE CODES                                     02180000
021900     05  PC-QTY-ERR-TRBL-CODE-350       PIC S9(04) COMP VALUE 350.02190000
022000     05  PC-UPC-NOT-ON-PO-TRBL-351      PIC S9(04) COMP VALUE 351.02200000
022100     05  PC-LNE-ZERO-TRBL-CODE-352      PIC S9(04) COMP VALUE 352.02210000
022200     05  PC-UPC-CRTN-TRBL-CODE-353      PIC S9(04) COMP VALUE 353.02220000
022300     05  PC-UPC-PKSL-TRBL-CODE-354      PIC S9(04) COMP VALUE 354.02230000
022400*----------------------------------------------------------------*02240000
022500* PROGRAM NAMES                                                  *02250000
022600*----------------------------------------------------------------*02260000
022700     05  PC-CURRENT-PROGRAM-NAME    PIC  X(08)  VALUE 'SUKRF706'. 02270000
022800     05  PC-SU-RFID-CONTROL-PGM     PIC  X(08)  VALUE 'SUKRF705'. 02280000
022900     05  PC-SU-LBL-PRT-PGM          PIC  X(08)  VALUE 'SUKRF707'. 02290000
023000     05  PC-SU-LBL-NEED-PGM         PIC  X(08)  VALUE 'SUKRF708'. 02300000
023100     05  PC-SU-MESSAGE-PGM          PIC  X(08)  VALUE 'SUKRF530'. 02310000
023200     05  PC-SU-CARTON-AUDIT-PGM     PIC  X(08)  VALUE 'SUKRF509'. 02320000
023300     05  PC-SU-AUDIT-STATUS-PGM     PIC  X(08)  VALUE 'SUKRF536'. 02330000
023400     05  PC-SU-AUDIT-DEF-PRMPT-PGM  PIC  X(08)  VALUE 'SUKRF534'. 02340000
023500     05  PC-SU-CARTON-AUDIT-STATUS  PIC  X(08)  VALUE 'SUKRF538'. 02350000
023600     05  PC-TROUBLE-WTR             PIC  X(08)  VALUE 'TMKCS521'. 02360000
023700     05  PC-FA-HANDLER-PGM          PIC  X(08)  VALUE 'SUKUT705'. 02370000
023800     05  PC-AUTOVE-DETERMIN-PGM     PIC  X(08)  VALUE 'RCKUT127'. 02380000
023900     05  PC-LINE-LOCATION-PGM       PIC  X(08)  VALUE 'PCKRF901'. 02390000
024000     05  PC-TROUBLE-LENGTH          PIC S9(04)  COMP VALUE +600.  02400000
024100     05  PC-SU-LBL-PRT-TRANS        PIC  X(08)  VALUE 'S707'.     02410006
024200     05  PC-SU-CRTN-VERIF-TRIGGER   PIC  X(08)  VALUE 'S764'.     02420000
024300     05  PC-CONTAINER-UPD-TRAN      PIC  X(04)  VALUE 'I210'.     02430000
024400                                                                  02440000
024500                                                                  02450000
024600*----------------------------------------------------------------*02460000
024700* ERROR MESSAGES                                                 *02470000
024800*----------------------------------------------------------------*02480000
024900     05  PC-DB2-DATABASE-ERROR-MSG  PIC X(19) VALUE               02490000
025000                                           'DB2 ACCESS ERROR   '. 02500000
025100     05  PC-UNRECOGNIZED-PF-KEY-MSG PIC X(19) VALUE               02510000
025200                                           'UNRECOGNIZED PF KEY'. 02520000
025300     05  PC-ENTER-THROUGH-MENU-MSG  PIC X(19) VALUE               02530000
025400                                           'ENTER THROUGH MENU '. 02540000
025500     05  PC-TRANS-UNAVAILABLE-MSG   PIC X(19) VALUE               02550000
025600                                           'TRANS NOT AVAILABLE'. 02560000
025700     05  PC-PLS-ENT-FLD-MSG         PIC X(19) VALUE               02570000
025800                                           'PLEASE ENTER FIELD '. 02580000
025900     05  PC-MUST-BE-NUM-MSG         PIC X(19) VALUE               02590000
026000                                           'MUST BE NUMERIC    '. 02600000
026100     05  PC-MUST-BE-GT-0-MSG        PIC X(19) VALUE               02610000
026200                                           'MUST BE > ZERO     '. 02620000
026300     05  PC-MUST-BE-PBS-MSG         PIC X(19) VALUE               02630000
026400                                           'RCVR NOT PK-BY-STR '. 02640000
026500     05  PC-FIRST-1-NOT-0-MSG       PIC X(19) VALUE               02650000
026600                                           'FIRST DIGIT NOT 0  '. 02660000
026700     05  PC-TOO-MANY-DIGITS         PIC X(19) VALUE               02670000
026800                                           'TOO MANY DIGITS    '. 02680000
026900     05  PC-STR-NOT-XCRIBED-MSG     PIC X(19) VALUE               02690000
027000                                           'STR NOT TRANSCRIBED'. 02700000
027100     05  PC-CICS-ERR-MSG            PIC X(19) VALUE               02710000
027200                                           'CICS ACCESS ERROR  '. 02720000
027300     05  PC-WRONG-FACILITY          PIC X(19) VALUE               02730000
027400                                           'WRG FCLTY - F2 CONF'. 02740000
027500     05  PC-MORE-DIGITS-REQD        PIC X(19) VALUE               02750000
027600                                           'MORE DIGITS REQUIRD'. 02760000
027700     05  PC-INVALID-CHECK-DIGIT     PIC X(19) VALUE               02770000
027800                                           'INVALID CHECK DIGIT'. 02780000
027810     05  PC-NO-TLBPTDA              PIC X(19) VALUE               02781089
027820                                           'NO PRT-USE CTN STAT'. 02782089
027900     05  PC-INVALID-RFID-CARTON     PIC X(19) VALUE               02790042
028000                                           'NOT RFID CARTON    '. 02800042
028100     05  PC-INVALID-BARCODE         PIC X(19) VALUE               02810000
028200                                           'INVALID BARCODE    '. 02820000
028300     05  PC-PACK-BY-STORE-ERROR     PIC X(19) VALUE               02830000
028400                                           'PACK BY STORE ERROR'. 02840000
028500     05  PC-VERFD-LINES-IN-CRTN     PIC X(19) VALUE               02850000
028600                                           'CRTN HAS VRFD LINES'. 02860000
028700     05  PC-CARTON-NOT-FOUND        PIC X(19) VALUE               02870008
028800                                           'CRTN NOT FOUND     '. 02880008
028900     05  PC-CARTON-DUPLICATE        PIC X(19) VALUE               02890048
029000                                           'DUPLICATE SCAN     '. 02900046
029100                                                                  02910000
029200*----------------------------------------------------------------*02920000
029300* LABEL MESSAGES                                                 *02930000
029400*----------------------------------------------------------------*02940000
029500     05  PC-DEFAULT-LABEL-MSG       PIC X(35) VALUE               02950000
029600                           '@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@'. 02960000
029700     05  PC-NOT-ATTACHED-RCVR-MSG   PIC X(35) VALUE               02970000
029800                           'CARTON NOT ATTACHED TO A RECEIVER  '. 02980000
029900     05  PC-NOT-FOUND-MSG           PIC X(35) VALUE               02990000
030000                           ' *** NO ITEM INFORMATION FOUND *** '. 03000000
030100     05  PC-FREE-ASTRAY-MSG         PIC X(35) VALUE               03010000
030200                           '* * * * *   FREE ASTRAY   * * * * *'. 03020000
030300     05  PC-FREE-ASTRY-NO-RCVR-MSG  PIC X(35) VALUE               03030000
030400                           'CARTON NOT ATTACHED TO A RECEIVER  '. 03040000
030500     05  PC-FREE-ASTRY-NO-TRIP-MSG  PIC X(35) VALUE               03050000
030600                           'RECEIVER NOT ATTACHED TO SCAC-TRLR '. 03060000
030700     05  PC-DUPLICATE-SCAN-MSG      PIC X(35) VALUE               03070000
030800                           '* * * * * DUPLICATE SCAN  * * * * *'. 03080000
030900     05  PC-DETAIL-CK-NEED-MSG      PIC X(35) VALUE               03090000
031000                           '* * * * DETAIL CHECK NEEDED * * * *'. 03100000
031100     05  PC-MISDIRECT-MSG          PIC X(35) VALUE                03110000
031200                           '* * *  M I S  -  D I R E C T * * * '. 03120000
031300                                                                  03130000
031400*----------------------------------------------------------------*03140000
031500                                                                  03150000
031600*----------------------------------------------------------------*03160000
031700*  PROGRAM SWITCHES                                              *03170000
031800*----------------------------------------------------------------*03180000
031900 01  PS-PROGRAM-SWITCHES.                                         03190000
032000     05  PS-FLOWBACK-BYPASS-AUDIT-SW     PIC  X(01)  VALUE 'N'.   03200000
032100         88  PS-FLOWBACK-BYPASS-AUDIT                VALUE 'Y'.   03210000
032200         88  PS-NO-FLOWBACK-BYPASS-AUDIT             VALUE 'N'.   03220000
032300     05  PS-DUPLICATE-CARTON-SW          PIC  X(01)  VALUE 'N'.   03230000
032400         88  PS-DUPLICATE-CARTON                     VALUE 'Y'.   03240000
032500         88  PS-NO-DUPLICATE-CARTON                  VALUE 'N'.   03250000
032600     05  PS-VALID-INPUT-SW               PIC  X(01)  VALUE 'Y'.   03260000
032700         88  PS-VALID-INPUT                          VALUE 'Y'.   03270000
032800         88  PS-INVALID-INPUT                        VALUE 'N'.   03280000
032900     05  PS-VALID-CARTON-SW              PIC  X(01)  VALUE 'Y'.   03290042
033000         88  PS-VALID-RFID-CARTON                    VALUE 'Y'.   03300042
033100         88  PS-INVALID-RFID-CARTON                  VALUE 'N'.   03310042
033200     05  PS-DID-CARTON-ALREADY-PRINT-SW  PIC  X(01)  VALUE 'N'.   03320049
033300         88  PS-CARTON-PRINTED                       VALUE 'Y'.   03330044
033400         88  PS-NO-CARTON-PRINTED                    VALUE 'N'.   03340044
033410     05  PS-TLBPTDA-EXISTS-SW            PIC  X(01)  VALUE 'N'.   03341090
033420         88  PS-TLBPTDA-EXISTS-YES                   VALUE 'Y'.   03342090
033430         88  PS-TLBPTDA-EXISTS-NO                    VALUE 'N'.   03343090
033500     05  PS-DUPLICATE-SW                 PIC  X(01)  VALUE 'N'.   03350000
033600         88  PS-DUPLICATE-FOUND                      VALUE 'Y'.   03360000
033700         88  PS-NO-DUPLICATE-FOUND                   VALUE 'N'.   03370000
033800     05  PS-WRONG-FCLTY-SW               PIC  X(01)  VALUE 'N'.   03380000
033900         88  PS-WRONG-FCLTY                          VALUE 'Y'.   03390000
034000     05  PS-NOT-FOUND-SW                 PIC  X(01)  VALUE 'Y'.   03400000
034100         88  PS-FOUND                                VALUE 'Y'.   03410000
034200         88  PS-NOT-FOUND                            VALUE 'N'.   03420000
034210     05  PS-TLBPTDA-SW                   PIC  X(01)  VALUE 'Y'.   03421090
034220         88  PS-TLBPTDA                              VALUE 'Y'.   03422090
034230         88  PS-NO-TLBPTDA                           VALUE 'N'.   03423090
034300     05  PS-SULBXF-RECORD-FOUND-SW       PIC  X(01)  VALUE 'Y'.   03430000
034400         88  PS-SULBXF-RECORD-FOUND                  VALUE 'Y'.   03440000
034500         88  PS-SULBXF-RECORD-NOT-FOUND              VALUE 'N'.   03450000
034600     05  PS-ACTIVE-XREF-ROW-FOUND-SW     PIC  X(01)  VALUE 'Y'.   03460000
034700         88  PS-ACTIVE-XREF-ROW-FOUND                VALUE 'Y'.   03470000
034800         88  PS-ACTIVE-XREF-ROW-NOT-FOUND            VALUE 'N'.   03480000
034900     05  PS-XREF-PBS-FOUND-SW            PIC  X(01)  VALUE 'N'.   03490000
035000         88  PS-XREF-PBS-FOUND                       VALUE 'Y'.   03500000
035100         88  PS-XREF-PBS-NOT-FOUND                   VALUE 'N'.   03510000
035200     05  PS-CHECK-DIGIT-IND              PIC  X(01)  VALUE 'N'.   03520000
035300         88  PS-VALID-CHECK-DIGIT                    VALUE 'Y'.   03530000
035400         88  PS-INVALID-CHECK-DIGIT                  VALUE 'N'.   03540000
035500     05  PS-SCANNED-DATA-IND             PIC  X(01)  VALUE 'Y'.   03550000
035600         88  PS-NOT-SCANNED-DATA                     VALUE 'N'.   03560000
035700         88  PS-SCANNED-DATA                         VALUE 'Y'.   03570000
035800     05  PS-OPER-IS-DC-STORE-SW          PIC  X(01)  VALUE ' '.   03580000
035900         88  PS-OPER-IS-DC                           VALUE 'D'.   03590000
036000         88  PS-OPER-IS-STORE                        VALUE 'S'.   03600000
036100         88  PS-OPER-IS-ECOMM-STORE                  VALUE 'E'.   03610000
036200     05  PS-OPER-IS-ECOMM-DC-SW          PIC  X(01)  VALUE 'N'.   03620000
036300         88  PS-OPER-NOT-ECOMM-DC                    VALUE 'N'.   03630000
036400         88  PS-OPER-IS-ECOMM-DC                     VALUE 'Y'.   03640000
036500     05  PS-OPER-IS-ECOMM-DS-SW          PIC  X(01)  VALUE 'N'.   03650000
036600         88  PS-OPER-NOT-ECOMM-DS                    VALUE 'N'.   03660000
036700         88  PS-OPER-IS-ECOMM-DS                     VALUE 'Y'.   03670000
036800     05  PS-NEW-STORE-FIXTURE-IND        PIC X(1)    VALUE 'N'.   03680000
036900         88  PS-NO-NEW-STORE-FIXTURE                 VALUE 'N'.   03690000
037000         88  PS-NEW-STORE-FIXTURE                    VALUE 'Y'.   03700000
037100     05  PS-REPRINT-FORM-SW              PIC  X(01)  VALUE 'N'.   03710000
037200         88  PS-REPRINT-FORM                         VALUE 'Y'.   03720000
037300         88  PS-NOT-REPRINT-FORM                     VALUE 'N'.   03730000
037400     05  PS-MSG-1-SW                     PIC  X(01)  VALUE 'N'.   03740000
037500         88  PS-NO-MSG-1                             VALUE 'N'.   03750000
037600         88  PS-YES-MSG-1                            VALUE 'Y'.   03760000
037700     05  PS-MSG-2-SW                     PIC  X(01)  VALUE 'N'.   03770000
037800         88  PS-NO-MSG-2                             VALUE 'N'.   03780000
037900         88  PS-YES-MSG-2                            VALUE 'Y'.   03790000
038000     05  PS-CARTON-EXISTS-SW             PIC  X(01)  VALUE 'Y'.   03800000
038100         88  PS-CARTON-EXISTS                        VALUE 'Y'.   03810000
038200         88  PS-CARTON-DOESNT-EXIST                  VALUE 'N'.   03820000
038300     05  PS-EO-UNITS-CSR-SW              PIC  X(01)  VALUE 'N'.   03830000
038400         88  PS-EO-UNITS-CSR                         VALUE 'Y'.   03840000
038500         88  PS-NOT-EO-UNITS-CSR                     VALUE 'N'.   03850000
038600     05  PS-EO-PREPK-CSR-SW              PIC  X(01)  VALUE 'N'.   03860000
038700         88  PS-EO-PREPK-CSR                         VALUE 'Y'.   03870000
038800         88  PS-NOT-EO-PREPK-CSR                     VALUE 'N'.   03880000
038900     05  PS-END-OF-VRTL-LBL-CSR-SW       PIC  X(01)  VALUE 'N'.   03890000
039000         88  PS-END-OF-VRTL-LBL-CSR                  VALUE 'Y'.   03900000
039100         88  PS-NOT-END-OF-VRTL-LBL-CSR              VALUE 'N'.   03910000
039200     05  PS-END-OF-REPRINT-CSR-SW        PIC  X(01)  VALUE 'N'.   03920000
039300         88  PS-END-OF-REPRINT-CSR                   VALUE 'Y'.   03930000
039400         88  PS-NOT-END-OF-REPRINT-CSR               VALUE 'N'.   03940000
039500     05  PS-END-OF-UPC-UNLOAD-CSR-SW     PIC  X(01)  VALUE 'N'.   03950000
039600         88  PS-END-OF-UPC-UNLOAD-CSR                VALUE 'Y'.   03960000
039700         88  PS-NOT-END-OF-UPC-UNLOAD-CSR            VALUE 'N'.   03970000
039800     05  PS-LABEL-DATA-FOUND-SW          PIC  X(01)  VALUE 'N'.   03980000
039900         88  PS-LABEL-DATA-FOUND                     VALUE 'Y'.   03990000
040000         88  PS-LABEL-DATA-NOT-FOUND                 VALUE 'N'.   04000000
040100     05  PS-DISPLAY-SUKRF530-SW          PIC  X(01)  VALUE 'N'.   04010000
040200         88  PS-DISPLAY-SUKRF530                     VALUE 'Y'.   04020000
040300         88  PS-DONT-DISPLAY-SUKRF530                VALUE 'N'.   04030000
040400     05  PS-SUCCESSFUL-UPDATE-SW         PIC  X(01)  VALUE 'N'.   04040000
040500         88  PS-SUCCESSFUL-UPDATE                    VALUE 'Y'.   04050000
040600         88  PS-NOT-SUCCESSFUL-UPDATE                VALUE 'N'.   04060000
040700     05  PS-DONE-SW                      PIC  X(01)  VALUE 'N'.   04070000
040800         88  PS-DONE                                 VALUE 'Y'.   04080000
040900         88  PS-NOT-DONE                             VALUE 'N'.   04090000
041000     05  PS-FOUND-ON-CURSOR-SW           PIC  X(01)  VALUE 'Y'.   04100000
041100         88  PS-FOUND-ON-CURSOR                      VALUE 'Y'.   04110000
041200         88  PS-NOT-FOUND-ON-CURSOR                  VALUE 'N'.   04120000
041300     05  PS-REPRINT-DUP-SW               PIC  X(01)  VALUE 'N'.   04130000
041400         88  PS-REPRINT-DUP                          VALUE 'Y'.   04140000
041500         88  PS-NOT-REPRINT-DUP                      VALUE 'N'.   04150000
041600     05  PS-TRNGLE-TRANS-SW              PIC  X(01)  VALUE 'N'.   04160000
041700         88  PS-TRNGLE-TRANS                         VALUE 'Y'.   04170000
041800         88  PS-NOT-TRNGLE-TRANS                     VALUE 'N'.   04180000
041900     05  PS-FIRST-PO-LINE-SW             PIC  X(01)  VALUE 'Y'.   04190000
042000         88  PS-FIRST-PO-LINE-FOR-CTN                VALUE 'Y'.   04200000
042100         88  PS-NOT-FIRST-PO-LINE-FOR-CTN            VALUE 'N'.   04210000
042200     05  PS-PRINT-AUDIT-LABEL-SW         PIC  X(01)  VALUE 'N'.   04220000
042300         88  PS-PRINT-AUDIT-LABEL                    VALUE 'Y'.   04230000
042400         88  PS-DONT-PRINT-AUDIT-LABEL               VALUE 'N'.   04240000
042500     05  PS-FIRST-ODD-UNTS-FETCH-SW      PIC  X(01)  VALUE 'Y'.   04250000
042600         88  PS-FIRST-ODD-UNTS-FETCH                 VALUE 'Y'.   04260000
042700         88  PS-NOT-FIRST-ODD-UNTS-FETCH             VALUE 'N'.   04270000
042800     05  PS-FOUND-ON-ODD-UNTS-CSR-SW     PIC  X(01)  VALUE 'Y'.   04280000
042900         88  PS-FOUND-ON-ODD-UNTS-CSR                VALUE 'Y'.   04290000
043000         88  PS-EO-ODD-UNTS-CSR                      VALUE 'N'.   04300000
043100     05  PS-ODD-UNT-CRTN-FOUND-SW        PIC  X(01)  VALUE 'N'.   04310000
043200         88  PS-ODD-UNT-CRTN-FOUND                   VALUE 'Y'.   04320000
043300         88  PS-NOT-ODD-UNT-CRTN-FOUND               VALUE 'N'.   04330000
043400     05  PS-FIRST-PREPK-SW               PIC  X(01)  VALUE 'Y'.   04340000
043500         88  PS-FIRST-PREPK                          VALUE 'Y'.   04350000
043600         88  PS-NOT-FIRST-PREPK                      VALUE 'N'.   04360000
043700     05  PS-HANG-FOLD-CSR-SW             PIC  X(01)  VALUE 'N'.   04370000
043800         88  PS-EO-HANG-FOLD-CSR                     VALUE 'Y'.   04380000
043900         88  PS-NOT-EO-HANG-FOLD-CSR                 VALUE 'N'.   04390000
044000     05  PS-EO-WEIGHTS-MSRS-CSR-SW       PIC  X(01)  VALUE 'N'.   04400000
044100         88  PS-EO-WEIGHTS-MSRS-CSR                  VALUE 'Y'.   04410000
044200         88  PS-NOT-EO-WEIGHTS-MSRS-CSR              VALUE 'N'.   04420000
044300     05  PS-HANG-FOLD-MIXED-SW           PIC  X(01)  VALUE 'N'.   04430000
044400         88  PS-HANG-FOLD-MIXED                      VALUE 'Y'.   04440000
044500         88  PS-NOT-HANG-FOLD-MIXED                  VALUE 'N'.   04450000
044600     05  PS-FIRST-UPC-CALL-SW            PIC  X(01)  VALUE 'N'.   04460000
044700         88  PS-FIRST-UPC-CALL                       VALUE 'Y'.   04470000
044800         88  PS-NOT-FIRST-UPC-CALL                   VALUE 'N'.   04480000
044900     05  PS-CARTON-STATUS-SW             PIC  X(01)  VALUE 'N'.   04490000
045000         88  PS-INACTV-CRTN-FND                      VALUE 'Y'.   04500000
045100         88  PS-ACTV-CRTN-FND                        VALUE 'N'.   04510000
045200     05  PS-INVALID-CREATE-SOURCE-SW     PIC  X(01)  VALUE 'N'.   04520000
045300         88  PS-INVALID-CRE-SOURCE                   VALUE 'Y'.   04530000
045400         88  PS-NOT-INVALID-CRE-SOURCE               VALUE 'N'.   04540000
045500     05  PS-BLND-RECV-SIMPL-LOC-SW       PIC  X(01)  VALUE 'N'.   04550000
045600         88  PS-BLND-RECV-SIMPL-LOC-FND              VALUE 'Y'.   04560000
045700         88  PS-BLND-RECV-SIMPL-LOC-NOT-FND          VALUE 'N'.   04570000
045800     05  PS-MISDIRECT-PACK-BY-STORE-SW   PIC  X(01)  VALUE 'N'.   04580000
045900         88  PS-MISDIRECT-PACK-BY-STORE              VALUE 'Y'.   04590000
046000         88  PS-MISDIRECT-PACK-BY-STORE-NO           VALUE 'N'.   04600000
046100     05  PS-INACTV-PBS-CARTON-FOUND-SW   PIC  X(01)  VALUE 'N'.   04610000
046200         88  PS-INACTV-PBS-CARTON-YES                VALUE 'Y'.   04620000
046300         88  PS-INACTV-PBS-CARTON-NO                 VALUE 'N'.   04630000
046400     05  PS-CASEPACK-LBL-PRINT-SW        PIC  X(01)  VALUE 'Y'.   04640000
046500         88  PS-CASEPK-FOUND                         VALUE 'Y'.   04650000
046600         88  PS-NO-CASEPK-FND                        VALUE 'N'.   04660000
046700     05  PS-PBS-TROUBLE-FOUND-SW         PIC  X(01)  VALUE 'N'.   04670000
046800         88  PS-TROUBLE-FOUND                        VALUE 'Y'.   04680000
046900         88  PS-NO-TROUBLE-FOUND                     VALUE 'N'.   04690000
047000     05  PS-PBS-RTV-ALLOC-SW             PIC  X(02)  VALUE '  '.  04700000
047100         88  PS-PBS-RTV-ALLOC                        VALUE 'RA'.  04710000
047200         88  PS-PBS-RTV-NO-ALLOC                     VALUE 'RN'.  04720000
047300     05  PS-AUDIT-PROMPT-CHECK-SW        PIC  X(01)  VALUE 'N'.   04730000
047400         88  PS-AUDIT-PROMPT-CHECK-YES               VALUE 'Y'.   04740000
047500         88  PS-AUDIT-PROMPT-CHECK-NO                VALUE 'N'.   04750000
047600     05  PS-INPK-AUD-INLINE-REQUIRED-SW  PIC  X(01)  VALUE 'Y'.   04760000
047700         88  PS-INPK-AUD-INLINE-YES                  VALUE 'Y'.   04770000
047800         88  PS-INPK-AUD-INLINE-NO                   VALUE 'N'.   04780000
047900     05  PS-PBS-CRTN-RCVR-MISMTCH-SW     PIC  X(01)  VALUE 'N'.   04790000
048000         88  PS-PBS-CRTN-RCVR-MISMTCH-YES            VALUE 'Y'.   04800000
048100         88  PS-PBS-CRTN-RCVR-MISMTCH-NO             VALUE 'N'.   04810000
048200     05  PS-FREE-ASTRAY-PROCESS-SW       PIC  X(01)  VALUE 'N'.   04820000
048300         88  PS-FREE-ASTRAY-PROCESS                  VALUE 'Y'.   04830000
048400         88  PS-FREE-ASTRAY-PROCESS-NO               VALUE 'N'.   04840000
048500     05  PS-SML-CREATION-SW              PIC  X(01)  VALUE 'N'.   04850000
048600         88  PS-CARTON-SML-CREATED                   VALUE 'S'.   04860000
048700         88  PS-CARTON-P2L-CREATED                   VALUE 'P'.   04870000
048800         88  PS-NO-CARTON-SML-CREATED                VALUE 'N'.   04880000
048900     05  PS-SULBXF-ROW-FOUND-SW          PIC  X(01)  VALUE 'N'.   04890000
049000         88  PS-SULBXF-ROW-FOUND                     VALUE 'Y'.   04900000
049100         88  PS-NO-SULBXF-ROW-FOUND                  VALUE 'N'.   04910000
049200     05  PS-RCVR-DATA-FOUND-SW           PIC  X(01)  VALUE 'Y'.   04920000
049300         88  PS-RCVR-DATA-FOUND-YES                  VALUE 'Y'.   04930000
049400         88  PS-RCVR-DATA-FOUND-NO                   VALUE 'N'.   04940000
049500     05  PS-UCC128-PKSLIP-ERROR-SW       PIC  X(01)  VALUE 'N'.   04950000
049600         88  PS-UCC128-PKSLIP-ERROR-YES              VALUE 'Y'.   04960000
049700         88  PS-UCC128-PKSLIP-ERROR-NO               VALUE 'N'.   04970000
049800     05  PS-FREE-ASTRAY-MSG-LBL-SW       PIC  X(01)  VALUE 'N'.   04980000
049900         88  PS-FREE-ASTRAY-MSG-LBL-YES              VALUE 'Y'.   04990000
050000         88  PS-FREE-ASTRAY-MSG-LBL-NO               VALUE 'N'.   05000000
050100     05  PS-WEIGHTS-MEAUSURES-CHECK-SW   PIC  X(01)  VALUE 'N'.   05010000
050200         88  PS-WEIGHTS-MEAUSURES-CHECK              VALUE 'Y'.   05020000
050300         88  PS-WEIGHTS-MEAUSURES-CHECK-NO           VALUE 'N'.   05030000
050400     05  PS-RECITM-VERIFIED-LINES-SW     PIC  X(01)  VALUE 'N'.   05040000
050500         88  PS-RECITM-VERIFIED-LINES-YES            VALUE 'Y'.   05050000
050600         88  PS-RECITM-VERIFIED-LINES-NO             VALUE 'N'.   05060000
050700     05  PS-ECOMM-STORE-WRONG-FCLTY-SW   PIC  X(01)  VALUE ' '.   05070000
050800         88  PS-ECOMM-STORE-NO-RCVR                  VALUE 'N'.   05080000
050900     05  PS-HANG-FOLD-IND-FOUND-SW       PIC  X(01)  VALUE 'N'.   05090000
051000         88  PS-HANG-FOLD-IND-FOUND-YES              VALUE 'Y'.   05100000
051100         88  PS-HANG-FOLD-IND-FOUND-NO               VALUE 'N'.   05110000
051200     05  PS-EAS-TAG-IND-FOUND-SW         PIC  X(01)  VALUE 'N'.   05120000
051300         88  PS-EAS-TAG-IND-FOUND-YES                VALUE 'Y'.   05130000
051400         88  PS-EAS-TAG-IND-FOUND-NO                 VALUE 'N'.   05140000
051410*CLP 06/24/15 START                                               05141080
051500     05  PS-BRAND-FOUND-SW            PIC  X(01)  VALUE 'N'.      05150080
051600         88  PS-BRAND-FOUND-YES                   VALUE 'Y'.      05160080
051700         88  PS-BRAND-FOUND-NO                    VALUE 'N'.      05170080
051800*CLP 06/24/15 END                                                 05180080
051900     05  PS-AUTO-CONVEY-LVL-SW           PIC  X(03)  VALUE SPACE. 05190000
052000         88  PS-AUTO-CONVEY-NO-CRTNS                 VALUE 'NNE'. 05200000
052100         88  PS-AUTO-CONVEY-EXCPT-CRTNS              VALUE 'EXC'. 05210000
052200         88  PS-AUTO-CONVEY-ALL-CRTNS                VALUE 'ALL'. 05220000
052300     05  PS-PROCESSING-ERROR-SW          PIC  X(01)  VALUE 'N'.   05230000
052400         88  PS-PROCESSING-ERROR-YES                 VALUE 'Y'.   05240000
052500         88  PS-PROCESSING-ERROR-NO                  VALUE 'N'.   05250000
052600     05  PS-OTBND-LOC-ENTRY-SW           PIC  X(01)  VALUE 'N'.   05260000
052700         88  PS-OTBND-LOC-ENTRY-EXIST                VALUE 'Y'.   05270000
052800         88  PS-OTBND-LOC-ENTRY-NOT-EXIST            VALUE 'N'.   05280000
052900     05  PS-DIRECTIVE-SW                 PIC  X(01)  VALUE 'N'.   05290000
053000         88  PS-DIRECTIVE-YES                        VALUE 'Y'.   05300000
053100         88  PS-DIRECTIVE-NO                         VALUE 'N'.   05310000
053200     05  PS-RFID-ON-LABEL-SW             PIC  X(01)  VALUE 'N'.   05320000
053300         88  PS-RFID-ON-LABEL-YES                    VALUE 'Y'.   05330000
053400         88  PS-RFID-ON-LABEL-NO                     VALUE 'N'.   05340000
053500                                                                  05350000
053600                                                                  05360000
053700*----------------------------------------------------------------*05370000
053800*  PROGRAM VARIABLES                                             *05380000
053900*----------------------------------------------------------------*05390000
054000 01  PV-PROGRAM-VARIABLES.                                        05400000
054100     05  PV-NULL-IND                     PIC S9(4)   VALUE ZERO   05410000
054200                                                     COMP SYNC.   05420000
054300     05  PV-NULL-CRE-TMST                PIC S9(4)   VALUE ZERO   05430000
054400                                                     COMP SYNC.   05440000
054500     05  PV-NULL-E-BUS-IND               PIC S9(4)   VALUE ZERO   05450000
054600                                                     COMP SYNC.   05460000
054700     05  PV-CICS-MSG-AREA-A.                                      05470000
054800         10  FILLER                      PIC  X(01)  VALUE SPACE. 05480000
054900         10  PV-CICS-MSG-AREA-B          PIC  X(80)  VALUE SPACE. 05490000
055000     05  PV-CICS-MSG-AREA.                                        05500000
055100         10  PV-CICS-MSG-AREA1           PIC  X(80)  VALUE SPACE. 05510000
055200         10  PV-CICS-MSG-AREA2           PIC  X(80)  VALUE SPACE. 05520000
055300         10  PV-CICS-MSG-AREA3           PIC  X(80)  VALUE SPACE. 05530000
055400         10  PV-CICS-MSG-AREA4           PIC  X(80)  VALUE SPACE. 05540000
055500         10  PV-CICS-MSG-AREA5           PIC  X(80)  VALUE SPACE. 05550000
055600         10  PV-CICS-MSG-AREA6           PIC  X(80)  VALUE SPACE. 05560000
055700         10  PV-CICS-MSG-AREA7           PIC  X(80)  VALUE SPACE. 05570000
055800         10  PV-CICS-MSG-AREA8           PIC  X(80)  VALUE SPACE. 05580000
055900         10  PV-CICS-MSG-AREA9           PIC  X(80)  VALUE SPACE. 05590000
056000         10  PV-CICS-MSG-AREA10          PIC  X(80)  VALUE SPACE. 05600000
056100         10  PV-CICS-MSG-AREA11          PIC  X(80)  VALUE SPACE. 05610000
056200         10  PV-CICS-MSG-AREA12          PIC  X(80)  VALUE SPACE. 05620000
056300         10  PV-CICS-MSG-AREA13          PIC  X(80)  VALUE SPACE. 05630000
056400         10  PV-CICS-MSG-AREA14          PIC  X(80)  VALUE SPACE. 05640000
056500         10  PV-CICS-MSG-AREA15          PIC  X(80)  VALUE SPACE. 05650000
056600         10  PV-CICS-MSG-AREA16          PIC  X(80)  VALUE SPACE. 05660000
056700         10  PV-CICS-MSG-AREA17          PIC  X(80)  VALUE SPACE. 05670000
056800         10  PV-CICS-MSG-AREA18          PIC  X(80)  VALUE SPACE. 05680000
056900         10  PV-CICS-MSG-AREA19          PIC  X(80)  VALUE SPACE. 05690000
057000         10  PV-CICS-MSG-AREA20          PIC  X(80)  VALUE SPACE. 05700000
057100     05  PV-MESSAGE-AREA                 PIC  X(19)  VALUE SPACE. 05710000
057200     05  PV-CICS-RESPONSE                PIC S9(09)  VALUE ZEROS  05720000
057300                                                     COMP SYNC.   05730000
057400     05  PV-RECEIVE-DATA                 PIC  X(01)  VALUE SPACE. 05740000
057500     05  PV-ERROR-TEXT                   PIC  X(100) VALUE SPACE. 05750000
057600     05  PV-TRANSFER-PROGRAM             PIC  X(08)  VALUE SPACE. 05760000
057700     05  PV-REPRINT-CSR-CNT              PIC S9(04)  VALUE ZEROS  05770000
057800                                                     COMP SYNC.   05780000
057900     05  PV-RECORD-COUNT                 PIC S9(09)  VALUE ZEROS  05790000
058000                                                     COMP SYNC.   05800000
058100     05  PV-COUNT-IND                    PIC S9(04)  VALUE ZEROS  05810000
058200                                                     COMP SYNC.   05820000
058300     05  PV-SELECT-COUNTER               PIC S9(04)  VALUE ZEROS  05830000
058400                                                     COMP SYNC.   05840000
058500     05  PV-CHAR-COUNT                   PIC S9(04)  VALUE ZEROS  05850000
058600                                                     COMP SYNC.   05860000
058700     05  PV-MULTI-LINE-COUNT             PIC S9(04)  VALUE ZEROS  05870000
058800                                                     COMP SYNC.   05880000
058900     05  PV-VERIF-RECITM-COUNT           PIC S9(04)  VALUE ZEROS  05890000
059000                                                     COMP SYNC.   05900000
059100     05  PV-ODDS-SUM                     PIC  9(04)  VALUE ZEROS. 05910000
059200     05  PV-EVENS-SUM                    PIC  9(04)  VALUE ZEROS. 05920000
059300     05  PV-TOTAL                        PIC  9(04).              05930000
059400     05  FILLER REDEFINES PV-TOTAL.                               05940000
059500         10  FILLER                      PIC  9(03).              05950000
059600         10  PV-TOTAL-LAST-DIGIT         PIC  9(01).              05960000
059700     05  PV-CHECK-DIGIT                  PIC  9(01).              05970000
059800     05  PV-WRITE-LENGTH                 PIC  9(04)  VALUE  80    05980000
059900                                                     COMP SYNC.   05990000
060000     05  PV-RBA                          PIC S9(08)  VALUE +0     06000000
060100                                                     COMP SYNC.   06010000
060200     05  PV-9999-9                       PIC  9(04)  VALUE 0000.  06020000
060300     05  PV-9999-X REDEFINES PV-9999-9.                           06030000
060400         10  PV-9999-1-2                 PIC  X(02).              06040000
060500         10  PV-9999-3-4                 PIC  X(02).              06050000
060600     05  PV-CTN-X                        PIC  X(18).              06060000
060700     05  PV-CTN-N REDEFINES PV-CTN-X     PIC  9(18).              06070000
060800     05  PV-CTN-1-18 REDEFINES PV-CTN-X.                          06080000
060900         10  PV-CTN-9-1                  PIC  9(01).              06090000
061000         10  PV-CTN-9-2                  PIC  9(01).              06100000
061100         10  PV-CTN-9-3                  PIC  9(01).              06110000
061200         10  PV-CTN-9-4                  PIC  9(01).              06120000
061300         10  PV-CTN-9-5                  PIC  9(01).              06130000
061400         10  PV-CTN-9-6                  PIC  9(01).              06140000
061500         10  PV-CTN-9-7                  PIC  9(01).              06150000
061600         10  PV-CTN-9-8                  PIC  9(01).              06160000
061700         10  PV-CTN-9-9                  PIC  9(01).              06170000
061800         10  PV-CTN-9-10                 PIC  9(01).              06180000
061900         10  PV-CTN-9-11                 PIC  9(01).              06190000
062000         10  PV-CTN-9-12                 PIC  9(01).              06200000
062100         10  PV-CTN-9-13                 PIC  9(01).              06210000
062200         10  PV-CTN-9-14                 PIC  9(01).              06220000
062300         10  PV-CTN-9-15                 PIC  9(01).              06230000
062400         10  PV-CTN-9-16                 PIC  9(01).              06240000
062500         10  PV-CTN-9-17                 PIC  9(01).              06250000
062600         10  PV-CTN-9-18                 PIC  9(01).              06260000
062700     05  PV-128-CARTON.                                           06270000
062800         10  PV-128-CARTON-13            PIC  9(13).              06280000
062900         10  PV-128-CARTON-5             PIC  9(05).              06290000
063000     05  PV-DB2-CURRENT-DATE             PIC X(10)    VALUE SPACE.06300000
063100     05  PV-DB2-COUNT                    PIC S9(09)   VALUE +0    06310000
063200                                                      COMP-3.     06320000
063300     05  PV-DB2-PKSLIP-COUNT             PIC S9(09)   VALUE +0    06330000
063400                                                      COMP-3.     06340000
063500     05  PV-DB2-COUNT-PBS                PIC S9(09)   VALUE +0    06350000
063600                                                      COMP-3.     06360000
063700     05  PV-DB2-ALLOC-COUNT              PIC S9(09)   VALUE +0    06370000
063800                                                      COMP-3.     06380000
063900     05  PV-DB2-RTV-COUNT                PIC S9(09)   VALUE +0    06390000
064000                                                      COMP-3.     06400000
064100     05  PV-DB2-LINE-COUNT               PIC S9(09)   VALUE +0    06410000
064200                                                      COMP-3.     06420000
064300     05  PV-PBS-SCN-LOC-ID               PIC   X(4).              06430000
064400     05  PV-UCC128-DAT-USG-CDE           PIC   X(1) VALUE SPACES. 06440000
064500                                                                  06450000
064600     05  PV-STORE-9-4                    PIC 9(04)    VALUE ZEROS.06460000
064700     05  PV-STORE-X   REDEFINES PV-STORE-9-4.                     06470000
064800         10  PV-STORE-X-4                PIC X(04).               06480000
064900     05  PV-STORE-NBR.                                            06490000
065000         10  PV-STORE-NBR-PFX            PIC 9(01) VALUE ZEROS.   06500000
065100         10  PV-STORE-NBR-4              PIC 9(04) VALUE ZEROS.   06510000
065200                                                                  06520000
065300     05  PV-STORE-NBR-PFX-HOLD           PIC 9(01) VALUE ZEROS.   06530000
065400     05  PV-AUDIT-CNTL-NBR               PIC 9(08) VALUE ZEROS.   06540001
065500     05  PV-MANIFEST-NEG                 PIC S9(08) VALUE ZEROS.  06550006
065510*CLP 06/24/2015 START                                             06551080
065540     05  PV-BUS-AREA-BRAND               PIC  X(35) VALUE SPACES. 06554080
065541     05  PV-DESC-LEN              PIC S9(04) VALUE +0             06554187
065542                                                COMP.             06554287
065543     05  PV-BUS-AREA-DESC-9       PIC  X(09)    VALUE SPACES.     06554387
065550*CLP 06/24/2015 END                                               06555080
065600                                                                  06560000
065700     05  PV-SCAC-TRLR.                                            06570000
065800         10  PV-VEH-SCAC                 PIC  X(04).              06580000
065900         10  FILLER                      PIC  X(01) VALUE SPACES. 06590000
066000         10  PV-VEH-TRLR                 PIC  X(10).              06600000
066100*                                                                 06610000
066200     05  PV-PRC-AREA-ID-X                PIC X(03).               06620000
066300     05  PV-PRC-AREA-9 REDEFINES PV-PRC-AREA-ID-X                 06630000
066400                                         PIC 9(03).               06640000
066500     05  PV-PRC-AREA-ID                  PIC S9(03) COMP.         06650000
066600                                                                  06660000
066700     05  PV-RCVR-SEQ-NBR                 PIC S9(09)   VALUE ZEROS 06670000
066800                                                      COMP.       06680000
066900     05  PV-CRTN-TRIP-ID                 PIC  S9(9)   VALUE ZEROS 06690000
067000                                                      COMP.       06700000
067100     05  PV-MAX-USER-BATCH               PIC S9(04)   VALUE ZEROS 06710000
067200                                                      COMP.       06720000
067210     05  PV-MAX-TIMESTAMP                PIC X(26)  VALUE SPACES. 06721075
067300     05  PV-VEND-STYL-NAME               PIC  X(20) VALUE SPACES. 06730000
067400     05  PV-DEPT-NUMBER                  PIC  X(03) VALUE SPACES. 06740000
067500     05  PV-CL-NBR                       PIC  X(02) VALUE SPACES. 06750000
067600     05  PV-SKU.                                                  06760000
067700         10  PV-DEPT-NBR                 PIC  X(03) VALUE SPACES. 06770000
067800         10  PV-SKU-DASH-1               PIC  X(01) VALUE SPACE.  06780000
067900         10  PV-CLASS-NBR                PIC  X(02) VALUE SPACES. 06790000
068000         10  PV-SKU-DASH-2               PIC  X(01) VALUE SPACE.  06800000
068100         10  PV-SKU-NBR                  PIC  X(03) VALUE SPACES. 06810000
068200     05  PV-SKU-OUT                      PIC  X(08).              06820000
068300     05  PV-SKU-OUT-9 REDEFINES PV-SKU-OUT                        06830000
068400                                         PIC  9(08).              06840000
068500     05  PV-SKU-LBL.                                              06850000
068600         10  FILLER                      PIC  X(01) VALUE '('.    06860000
068700         10  PV-DEPT-NUMBER-LBL          PIC  X(03) VALUE SPACES. 06870000
068800         10  FILLER                      PIC  X(01) VALUE '-'.    06880000
068900         10  PV-CL-NBR-LBL               PIC  X(02) VALUE SPACES. 06890000
069000         10  FILLER                      PIC  X(01) VALUE ')'.    06900000
069100         10  PV-SKU-NBR-LBL              PIC  9(08) VALUE ZERO.   06910000
069200     05  PV-CARTON-CNT                   PIC 9(04)    VALUE ZEROS.06920000
069300     05  PV-CARTON-CNT-X REDEFINES PV-CARTON-CNT.                 06930000
069400         10  PV-CARTON-CNT-LBL           PIC X(04).               06940000
069500*                                                                 06950000
069600     05  PV-MULTIPLE                     PIC  9(04)  VALUE ZEROS. 06960000
069700     05  PV-HOLD-MULTIPLE                PIC  9(04)  VALUE ZEROS. 06970000
069800     05  PV-REMAINDER                    PIC  9(04)  VALUE ZEROS. 06980000
069900*                                                                 06990000
070000     05  PV-INNR-PACK-QTY                PIC  S9(5) VALUE ZEROES  07000000
070100                                                    COMP.         07010000
070200     05  PV-OUTR-PACK-QTY                PIC  S9(5) VALUE ZEROES  07020000
070300                                                    COMP.         07030000
070400     05  PV-SHIPPED-QTY                  PIC  S9(9) VALUE ZEROES  07040000
070500                                                    COMP.         07050000
070600     05  PV-SHPD-QTY-TOTAL               PIC  S9(9) VALUE ZEROES  07060000
070700                                                    COMP.         07070000
070800     05  PV-WRKR-USR-ID                  PIC  X(08) VALUE ZEROES. 07080000
070900     05  PV-SESSION-ID                   PIC  X(08) VALUE ZEROES. 07090000
071000     05  PV-PREPK-ID                     PIC  S9(4) COMP.         07100000
071100     05  PV-PREPK-RATO-QTY               PIC  S9(4) COMP.         07110000
071200     05  PV-PREPK-UNT-QTY                PIC  S9(4) COMP.         07120000
071300     05  PV-CSE-PK-QTY                   PIC  S9(4) COMP.         07130000
071400     05  PV-ODD-CART-IND                 PIC   X(1).              07140000
071500     05  PV-SEASET-NM                    PIC   X(25).             07150000
071600     05  PV-PRNT-CART-SEQ-ID             PIC   S9(4) COMP.        07160000
071700*                                                                 07170000
071800     05  PV-UNION-TYPE                   PIC  X(01).              07180000
071900     05  PV-PREV-FETCH                   PIC  X(01).              07190000
072000     05  PV-PREV-LINE                    PIC  S9(9) COMP.         07200000
072100                                                                  07210000
072200     05  PV-BAR-CODE                     PIC  X(22) VALUE ZEROES. 07220000
072300     05  PV-BAR-CODE-N  REDEFINES  PV-BAR-CODE.                   07230000
072400         10 FILLER                       PIC  9(02).              07240000
072500         10 PV-BAR-CODE-OTBND            PIC  9(18).              07250000
072600         10 FILLER                       PIC  9(02).              07260000
072700     05  PV-BAR-CODE-R  REDEFINES  PV-BAR-CODE.                   07270000
072800         10 PV-BAR-CODE-DIVERT-PFX       PIC  9(01).              07280000
072900         10 PV-BAR-CODE-STORE-NBR        PIC  9(04).              07290000
073000         10 PV-BAR-CODE-OPER-UNIT        PIC  9(04).              07300000
073100         10 PV-BAR-CODE-POS-10-15        PIC  9(06).              07310000
073200         10 PV-BAR-CODE-LBL-MANIFEST     PIC  9(07).              07320000
073300     05  PV-DISPLAY-MANIFEST             PIC  9(09) VALUE ZEROES. 07330000
073400     05  PV-DISPLAY-CARTON               PIC  9(18) VALUE ZEROES. 07340000
073500     05  PV-DISPLAY-STORE                PIC  9(04) VALUE ZEROES. 07350000
073600     05  PV-DISPLAY-DEPT                 PIC  9(04) VALUE ZEROES. 07360000
073700     05  PV-DISPLAY-ITM-NBR              PIC  9(15) VALUE ZEROES. 07370000
073800     05  PV-DISPLAY-PO                   PIC  9(09) VALUE ZEROES. 07380000
073900     05  PV-DISPLAY-PO-RCVR              PIC  9(09) VALUE ZEROES. 07390000
074000     05  PV-DISPLAY-PO-LNE-NBR           PIC  9(09) VALUE ZEROES. 07400000
074100     05  PV-DISPLAY-ERROR-NBR            PIC  9(02) VALUE ZEROES. 07410000
074200     05  PV-DISPLAY-PACK-SKU             PIC  9(02) VALUE ZEROES. 07420000
074300     05  PV-DISPLAY-RET-CODE             PIC  9(02) VALUE ZEROES. 07430000
074400     05  PV-DISPLAY-CLASS                PIC  9(05) VALUE ZEROES. 07440000
074500     05  PV-DISPLAY-SQLCODE              PIC S9(04) VALUE ZEROES. 07450000
074600     05  PV-SQLCODE                      PIC S9(09) VALUE ZEROES. 07460000
074700     05  PV-PRINTER-ID.                                           07470000
074800         10  PV-PRINTER-ID-1-3           PIC  X(03) VALUE ZEROES. 07480000
074900         10  PV-PRINTER-ID-4-8           PIC  X(03) VALUE ZEROES. 07490000
075000     05  PV-LBL-MANIFEST-NBR             PIC  9(09) VALUE ZEROES. 07500000
075100     05  PV-LBL-MANIFEST-INCREMENT       PIC S9(09) VALUE +1      07510000
075200                                                     COMP.        07520000
075300     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      07530000
075400                                                    COMP SYNC.    07540000
075500     05  PV-DEPT-DESC                   PIC   X(25) VALUE SPACES. 07550000
075600     05  PV-MAJ-CL-DESC                 PIC   X(25) VALUE SPACES. 07560000
075700     05  PV-TRN-LNE-NBR                 PIC  S9(9) COMP.          07570000
075800     05  PV-HOLD-TRN-LNE-NBR            PIC  S9(9) COMP.          07580000
075900     05  PV-OPER-UNT-ID                 PIC  S9(04)  COMP.        07590000
076000     05  PV-CURR-OPER-UNT-ID            PIC  S9(04)  COMP.        07600000
076100     05  PV-REPURP-COUNT                PIC S9(09)  VALUE +0      07610000
076200                                                     COMP-3.      07620000
076300     05  PV-FIXTURE-ID                  PIC  X(10) VALUE SPACES.  07630000
076400                                                                  07640000
076500     05  PV-PCKCS721                  PIC X(08)  VALUE 'PCKCS721'.07650000
076600     05  PV-SUKCS583                  PIC X(08)  VALUE 'SUKCS583'.07660000
076700     05  PV-DONE-PROCESSING-SW        PIC X(01)  VALUE 'N'.       07670000
076800         88  PV-DONE-PROCESSING                  VALUE 'Y'.       07680000
076900     05  PV-PULL-NBR                  PIC  S9(9) VALUE +0 COMP.   07690000
077000     05  PV-PULL-LNE-NBR              PIC  S9(9) VALUE +0 COMP.   07700000
077100                                                                  07710000
077200 01  PV-COUNTERS.                                                 07720000
077300     05  PV-DPKUT038                  PIC X(08)  VALUE 'DPKUT038'.07730000
077400     05  PV-DPKUT038-CA-LENGTH        PIC S9(04) VALUE +1237      07740000
077500                                                 COMP.            07750000
077600     05  PV-DPKUT038-CICS-RESP        PIC S9(04) VALUE +0         07760000
077700                                                 COMP SYNC.       07770000
077800     05  PV-DPKUT038-DATE             PIC X(06)  VALUE SPACES.    07780000
077900     05  PV-DPKUT038-DATE-R REDEFINES PV-DPKUT038-DATE.           07790000
078000         10 PV-DPKUT038-YY               PIC  X(02).              07800000
078100         10 PV-DPKUT038-MM               PIC  X(02).              07810000
078200         10 PV-DPKUT038-DD               PIC  X(02).              07820000
078300     05  PV-DPKUT038-MJR-CL.                                      07830000
078400         10 FILLER                       PIC  X(01) VALUE SPACE.  07840000
078500         10 PV-DPKUT038-MJR-CL-2         PIC  X(01) VALUE SPACE.  07850000
078600*                                                                 07860000
078700     05  PV-CURRENT-DATE                 PIC X(10)  VALUE SPACES. 07870000
078800     05  PV-CURRENT-DATE-R REDEFINES     PV-CURRENT-DATE.         07880000
078900         10 PV-CURRENT-CC                PIC  9(02).              07890000
079000         10 PV-CURRENT-YY                PIC  9(02).              07900000
079100         10 FILLER                       PIC  X(01).              07910000
079200         10 PV-CURRENT-MM                PIC  9(02).              07920000
079300         10 FILLER                       PIC  X(01).              07930000
079400         10 PV-CURRENT-DD                PIC  9(02).              07940000
079500     05  PV-CURRENT-TIME                 PIC X(08)  VALUE SPACES. 07950000
079600     05  PV-CURRENT-TIME-R REDEFINES     PV-CURRENT-TIME.         07960000
079700         10 PV-CURRENT-HR                PIC  9(02).              07970000
079800         10 FILLER                       PIC  X(01).              07980000
079900         10 PV-CURRENT-MN                PIC  9(02).              07990000
080000         10 FILLER                       PIC  X(03).              08000000
080100*                                                                 08010000
080200     05  PV-BEGIN-TIME                   PIC X(26)  VALUE SPACES. 08020000
080300     05  PV-END-TIME                     PIC X(26)  VALUE SPACES. 08030000
080400*                                                                 08040000
080500     05  PV-TSHUNLO-CRE-TMST             PIC X(26)  VALUE SPACES. 08050000
080600     05  PV-TSHUNLO-TMST-EAI             PIC X(26)  VALUE SPACES. 08060000
080700     05  PV-TSHUNLO-PBS-CRE-TMST         PIC X(26)  VALUE SPACES. 08070000
080800     05  PV-TSHUNLO-PBS-TMST-R.                                   08080000
080900         10 PV-PBS-YYYY-MM-DD            PIC  X(10).              08090000
081000         10 PV-PBS-TMST-SPACE            PIC  X(01)  VALUE SPACES.08100000
081100         10 PV-PBS-HH                    PIC  X(02).              08110000
081200         10 PV-PBS-TMST-COLON            PIC  X(01)  VALUE ':'.   08120000
081300         10 PV-PBS-MM                    PIC  X(02).              08130000
081400         10 PV-PBS-TMST-SPACE-2          PIC  X(10)  VALUE SPACES.08140000
081500                                                                  08150000
081600     05  PV-SYSTEM-ID.                                            08160000
081700         10  FILLER              PIC  X(04)  VALUE SPACE.         08170000
081800         10  PV-REGION-IND       PIC  X(01).                      08180000
081900             88  PV-TEST-CICS                VALUE 'T'.           08190000
082000             88  PV-QA-CICS                  VALUE 'Q'.           08200000
082100             88  PV-PROD-CICS                VALUE 'P'.           08210000
082200             88  PV-LEARN-CICS               VALUE 'L'.           08220000
082300         10  FILLER              PIC  X(03)  VALUE SPACES.        08230000
082400*                                                                 08240000
082500*----------------------------------------------------------------*08250000
082600*                                                                *08260000
082700*----------------------------------------------------------------*08270000
082800     05  PV-PROGRAM-DATA.                                         08280000
082810*CLP 09/26/2014 START                                             08281077
082900         10  PV-PO                       PIC  X(08)  VALUE SPACE. 08290077
083000         10  PV-PO-N REDEFINES PV-PO     PIC  ZZZZZZZ9.           08300077
083100*                                                                 08310000
083200         10  PV-PO-RCVR.                                          08320000
083300             15 PV-PO-OUT                PIC 9(08).               08330077
083310*CLP 09/26/2014 END                                               08331077
083400             15 FILLER                   PIC X(01)  VALUE '-'.    08340077
083500             15 PV-RCVR-OUT              PIC 9(03).               08350000
083600*                                                                 08360000
083700                                                                  08370000
083800         10  PV-PO-LINE-N                  PIC 9(09).             08380000
083900         10  PV-PO-LINE-X REDEFINES PV-PO-LINE-N.                 08390000
084000             15 FILLER                     PIC X(05).             08400000
084100             15 PV-PO-LINE-OUT             PIC X(04).             08410000
084200                                                                  08420000
084300         10  PV-DRIVER-LINE-NO             PIC 9(09).             08430000
084400                                                                  08440000
084500         10  PV-PO-LINE-LBL.                                      08450000
084600             15  PV-LINE-LBL-1           PIC 9(01).               08460000
084700             15  PV-LINE-LBL-3           PIC 9(03).               08470000
084800                                                                  08480000
084900         10  PV-STORE                    PIC  X(04)  VALUE SPACE. 08490000
085000         10  PV-STORE-N REDEFINES PV-STORE PIC ZZZ9.              08500000
085100                                                                  08510000
085200         10  PV-CTN.                                              08520000
085300             15  PV-CTN-FIRST-DIGIT      PIC  X(01).              08530000
085400             15  PV-CTN-LAST-17          PIC  X(17).              08540000
085500             15  PV-CTN-FILLER           PIC  X(02).              08550000
085600         10  FILLER REDEFINES PV-CTN.                             08560000
085700             15  PV-CTN-SCAN-00          PIC  X(02).              08570000
085800             15  PV-CTN-SCAN-THIRD-DGT   PIC  X(01).              08580000
085900             15  PV-CTN-SCAN-LAST-17     PIC  X(17).              08590000
086000         10  FILLER REDEFINES PV-CTN.                             08600000
086100             15  PV-CTN-SCAN-00          PIC  X(02).              08610000
086200             15  PV-CTN-SCAN-LAST-18     PIC  X(18).              08620000
086300                                                                  08630000
086400         10  PV-BUS-AREA-ID              PIC  S9(2)V VALUE ZEROES 08640000
086500                                                     COMP-3.      08650000
086600*                                                                 08660000
086700         10  PV-HNG-FOLD-SEQ-NBR         PIC  S9(4) COMP.         08670000
086800         10  PV-PREV-HANG-FOLD-IND       PIC  X(01) VALUE SPACE.  08680000
086900         10  PV-HANG-FOLD-IND            PIC  X(01) VALUE SPACE.  08690000
087000*                                                                 08700000
087100         10  PV-TROUBLE-COUNT            PIC S9(09)  COMP.        08710000
087200         10  PV-TROUBLE-COUNT-REPUR      PIC S9(09)  COMP.        08720000
087300         10  PV-TROUBLE-CNT-REPUR-INNR   PIC S9(09)  COMP.        08730000
087400         10  PV-SHPD-PK-QTY              PIC S9(09)  COMP.        08740000
087500*----------------------------------------------------------------*08750000
087600*  GENERATED DSECT FOR THE SUKM706 MAPSET                         08760000
087700*----------------------------------------------------------------*08770000
087800     COPY SUKM706.                                                08780000
087900                                                                  08790000
088000*----------------------------------------------------------------*08800000
088100*  SENDING/RECEIVING AREA FOR THE NUMERIC EDIT ROUTINE (DPKUT100) 08810000
088200*----------------------------------------------------------------*08820000
088300     COPY DPWS010I.                                               08830000
088400                                                                  08840000
088500*----------------------------------------------------------------*08850000
088600*  KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST   08860000
088700*----------------------------------------------------------------*08870000
088800     COPY DPWS015.                                                08880000
088900                                                                  08890000
089000/                                                                 08900000
089100*----------------------------------------------------------------*08910000
089200*  COPYBOOK FOR CALLED MODULE TO RETURN BUSINESS AREA ID          08920000
089300*  VSM INTERFACE                                                  08930000
089400*----------------------------------------------------------------*08940000
089500     COPY XLWS073.                                                08950000
089600/                                                                 08960000
089700*----------------------------------------------------------------*08970000
089800*  COPYBOOK FOR CALLED MODULE TO RETURN SEASONAL SET AND FIXTURE  08980000
089900*  DATA                                                           08990000
090000*----------------------------------------------------------------*09000000
090100     COPY PCWS240.                                                09010000
090200/                                                                 09020000
090900*----------------------------------------------------------------*09090000
091000*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      09100000
091100*----------------------------------------------------------------*09110000
091200     COPY DFHAID.                                                 09120000
091300                                                                  09130000
091400*----------------------------------------------------------------*09140000
091500*    COPYBOOK USED BY MBS SYSTEM TO GET BUYER NAME               *09150000
091600*----------------------------------------------------------------*09160000
091700     COPY DPWS003.                                                09170000
091800                                                                  09180000
091900*----------------------------------------------------------------*09190000
092000 01  CA-COMMAREA.                                                 09200000
092100*----------------------------------------------------------------*09210000
092200*  COMMAREA LAYOUT FOR THE PACK BY STORE AUDIT PROJECT           *09220000
092300*----------------------------------------------------------------*09230000
092400     COPY SUWS001.                                                09240000
092500                                                                  09250000
092600*----------------------------------------------------------------*09260000
092700*  COMMAREA LAYOUT FOR THE AUDIT CHECK MODULE (SUKCS583)         *09270000
092800*----------------------------------------------------------------*09280000
092900     COPY SURD021.                                                09290000
093000                                                                  09300000
093100*----------------------------------------------------------------*09310000
093200*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               09320000
093300*----------------------------------------------------------------*09330000
093400     COPY DPWS013.                                                09340000
093500                                                                  09350000
093600*----------------------------------------------------------------*09360000
093700 01  CA-COMMAREA-CRTN-AUD.                                        09370000
093800*----------------------------------------------------------------*09380000
093900*  COMMAREA LAYOUT FOR THE PACK BY STORE AUDIT PROJECT           *09390000
094000*----------------------------------------------------------------*09400000
094100     COPY SUWS006.                                                09410000
094200                                                                  09420000
094300*----------------------------------------------------------------*09430000
094400*    STORE MANIFEST LAYOUT.                                       09440000
094500*----------------------------------------------------------------*09450000
094600     COPY PCWS187.                                                09460000
094700                                                                  09470000
094800*----------------------------------------------------------------*09480000
094900*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT      09490000
095000*  TABLE                                                          09500000
095100*----------------------------------------------------------------*09510000
095200     EXEC SQL                                                     09520000
095300         INCLUDE TSHPUNT                                          09530000
095400     END-EXEC.                                                    09540000
095500                                                                  09550000
095600*----------------------------------------------------------------*09560000
095700*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT UPC  09570000
095800*  TABLE                                                          09580000
095900*----------------------------------------------------------------*09590000
096000     EXEC SQL                                                     09600000
096100         INCLUDE TSHUUPC                                          09610000
096200     END-EXEC.                                                    09620000
096300                                                                  09630000
096400*----------------------------------------------------------------*09640000
096500*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPMENT UNIT      09650000
096600*  LOCATION TABLE                                                 09660000
096700*----------------------------------------------------------------*09670000
096800     EXEC SQL                                                     09680000
096900         INCLUDE TSHUNLO                                          09690000
097000     END-EXEC.                                                    09700000
097100                                                                  09710000
097200*----------------------------------------------------------------*09720000
097300*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE INBOUND EDI PACKSLI09730000
097400*  VENDOR SHIPMENT UNIT ASSOCIATION TABLE                         09740000
097500*----------------------------------------------------------------*09750000
097600     EXEC SQL                                                     09760000
097700         INCLUDE TINPKSU                                          09770000
097800     END-EXEC.                                                    09780000
097900                                                                  09790000
098000*----------------------------------------------------------------*09800000
098100*  DCLGEN LAYOUT AND COBOL DECLARATION FOR LOGISTICS DOMAIN       09810000
098200*  LOCATION MASTER TABLE (XLT_LOC)                                09820000
098300*----------------------------------------------------------------*09830000
098400     EXEC SQL                                                     09840000
098500         INCLUDE XLT00010                                         09850000
098600     END-EXEC.                                                    09860000
098700                                                                  09870000
098800*----------------------------------------------------------------*09880000
098900*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PO TABLE           09890000
099000*----------------------------------------------------------------*09900000
099100     EXEC SQL                                                     09910000
099200         INCLUDE TPURCHS                                          09920000
099300     END-EXEC.                                                    09930000
099400                                                                  09940000
099500*----------------------------------------------------------------*09950000
099600*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE MDSEAR TABLE       09960000
099700*----------------------------------------------------------------*09970000
099800     EXEC SQL                                                     09980000
099900         INCLUDE TMDSEAR                                          09990000
100000     END-EXEC.                                                    10000000
100100                                                                  10010000
100200*----------------------------------------------------------------*10020000
100300*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE MDSEDP TABLE       10030000
100400*----------------------------------------------------------------*10040000
100500     EXEC SQL                                                     10050000
100600         INCLUDE TMDSEDP                                          10060000
100700     END-EXEC.                                                    10070000
100800                                                                  10080000
100900*----------------------------------------------------------------*10090000
101000*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE STORE ZONE TABLE   10100000
101100*----------------------------------------------------------------*10110000
101200     EXEC SQL                                                     10120000
101300         INCLUDE TSTRZN                                           10130000
101400     END-EXEC.                                                    10140000
101500                                                                  10150000
101600*----------------------------------------------------------------*10160000
101700*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE LABEL PRINT DATA  *10170000
101800*  TABLE                                                         *10180000
101900*----------------------------------------------------------------*10190000
102000     EXEC SQL                                                     10200000
102100         INCLUDE TLBPTDA                                          10210000
102200     END-EXEC.                                                    10220000
102300                                                                  10230000
102400*----------------------------------------------------------------*10240000
102500*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE VIRTUAL LABEL     *10250000
102600*  TABLE                                                         *10260000
102700*----------------------------------------------------------------*10270000
102800     EXEC SQL                                                     10280000
102900         INCLUDE TLBVRDA                                          10290000
103000     END-EXEC.                                                    10300000
103100                                                                  10310000
103200*----------------------------------------------------------------*10320000
103300*  DCLGEN LAYOUT AND COBOL DECLARATION                           *10330000
103400*----------------------------------------------------------------*10340000
103500     EXEC SQL                                                     10350000
103600         INCLUDE TVHTRIP                                          10360000
103700     END-EXEC.                                                    10370000
103800                                                                  10380000
103900*----------------------------------------------------------------*10390000
104000*  DCLGEN LAYOUT AND COBOL DECLARATION                           *10400000
104100*----------------------------------------------------------------*10410000
104200     EXEC SQL                                                     10420000
104300         INCLUDE TSHIPMT                                          10430000
104400     END-EXEC.                                                    10440000
104500                                                                  10450000
104600*----------------------------------------------------------------*10460000
104700*  DCLGEN LAYOUT AND COBOL DECLARATION                           *10470000
104800*----------------------------------------------------------------*10480000
104900     EXEC SQL                                                     10490000
105000         INCLUDE TSHPTPO                                          10500000
105100     END-EXEC.                                                    10510000
105200                                                                  10520000
105300*----------------------------------------------------------------*10530000
105400*  DCLGEN LAYOUT AND COBOL DECLARATION                           *10540000
105500*----------------------------------------------------------------*10550000
105600     EXEC SQL                                                     10560000
105700         INCLUDE TRECEIV                                          10570000
105800     END-EXEC.                                                    10580000
105900                                                                  10590000
106000*----------------------------------------------------------------*10600000
106100*  DCLGEN LAYOUT AND COBOL DECLARATION                           *10610000
106200*----------------------------------------------------------------*10620000
106300     EXEC SQL                                                     10630000
106400         INCLUDE TPKSLIP                                          10640000
106500     END-EXEC.                                                    10650000
106600                                                                  10660000
106700*----------------------------------------------------------------*10670000
106800*  DCLGEN LAYOUT AND COBOL DECLARATION                           *10680000
106900*----------------------------------------------------------------*10690000
107000     EXEC SQL                                                     10700000
107100         INCLUDE TRECITM                                          10710000
107200     END-EXEC.                                                    10720000
107300                                                                  10730000
107400*----------------------------------------------------------------*10740000
107500*  DCLGEN LAYOUT AND COBOL DECLARATION                           *10750000
107600*----------------------------------------------------------------*10760000
107700     EXEC SQL                                                     10770000
107800         INCLUDE TRECDIS                                          10780000
107900     END-EXEC.                                                    10790000
108000                                                                  10800000
108100*----------------------------------------------------------------*10810000
108200*  DCLGEN LAYOUT AND COBOL DECLARATION                           *10820000
108300*----------------------------------------------------------------*10830000
108400     EXEC SQL                                                     10840000
108500         INCLUDE TPURITM                                          10850000
108600     END-EXEC.                                                    10860000
108700                                                                  10870000
108800*----------------------------------------------------------------*10880000
108900*  DCLGEN LAYOUT AND COBOL DECLARATION                           *10890000
109000*----------------------------------------------------------------*10900000
109100     EXEC SQL                                                     10910000
109200         INCLUDE TVNDDPT                                          10920000
109300     END-EXEC.                                                    10930000
109400                                                                  10940000
109500*----------------------------------------------------------------*10950000
109600*  DCLGEN LAYOUT AND COBOL DECLARATION FOR SEASONAL SET TABLE    *10960000
109700*----------------------------------------------------------------*10970000
109800     EXEC SQL                                                     10980058
109900         INCLUDE TSEASET                                          10990058
110000     END-EXEC.                                                    11000058
110100                                                                  11010000
110200*----------------------------------------------------------------*11020000
110300*  DCLGEN LAYOUT AND COBOL DECLARATION FOR MESSAGE TABLE         *11030000
110400*----------------------------------------------------------------*11040000
110500     EXEC SQL                                                     11050000
110600         INCLUDE TLBVRMG                                          11060000
110700     END-EXEC.                                                    11070000
110800                                                                  11080000
110900*----------------------------------------------------------------*11090000
111000*  DCLGEN LAYOUT AND COBOL DECLARATION FOR CARTON/LABEL CROSS REF*11100000
111100*----------------------------------------------------------------*11110000
111200     EXEC SQL                                                     11120000
111300         INCLUDE TSULBXF                                          11130000
111400     END-EXEC.                                                    11140000
111500                                                                  11150000
111600*----------------------------------------------------------------*11160000
111700*  DCLGEN LAYOUT AND COBOL DECLARATION                           *11170000
111800*----------------------------------------------------------------*11180000
111900     EXEC SQL                                                     11190000
112000         INCLUDE TDISTHD                                          11200000
112100     END-EXEC.                                                    11210000
112200                                                                  11220000
112300*----------------------------------------------------------------*11230000
112400*  DCLGEN LAYOUT AND COBOL DECLARATION                           *11240000
112500*----------------------------------------------------------------*11250000
112600*    EXEC SQL                                                     11260057
112700*        INCLUDE TP2LMOD                                          11270057
112800*    END-EXEC.                                                    11280057
112900                                                                  11290000
113000*----------------------------------------------------------------*11300000
113100*  DCLGEN LAYOUT AND COBOL DECLARATION                           *11310000
113200*----------------------------------------------------------------*11320000
113300     EXEC SQL                                                     11330000
113400         INCLUDE TCOCNTL                                          11340000
113500     END-EXEC.                                                    11350000
113600                                                                  11360000
113700*----------------------------------------------------------------*11370000
113800*  DCLGEN LAYOUT AND COBOL DECLARATION                           *11380000
113900*----------------------------------------------------------------*11390000
114000     EXEC SQL                                                     11400000
114100         INCLUDE TKRPRPM                                          11410000
114200     END-EXEC.                                                    11420000
114300                                                                  11430000
114400*----------------------------------------------------------------*11440000
114500*  DCLGEN LAYOUT AND COBOL DECLARATION OTBND SHIPT CARTON         11450000
114600*   (SUT_OTBND_CART)                                             *11460000
114700*----------------------------------------------------------------*11470000
114800     EXEC SQL                                                     11480000
114900         INCLUDE SUT00024                                         11490000
115000     END-EXEC.                                                    11500000
115100                                                                  11510000
115300*---------------------------------------------------------------* 11530000
115400* DCLGEN FOR SUT_PRC_MSG_CNTL                                     11540000
115500*---------------------------------------------------------------* 11550000
115600     EXEC SQL                                                     11560000
115700         INCLUDE SUT00094                                         11570000
115800     END-EXEC.                                                    11580000
116000                                                                  11600000
116100*----------------------------------------------------------------*11610000
116200*  DCLGEN LAYOUT AND COBOL DECLARATION OTBND SHIPT CARTON UPC     11620000
116300*   (SUT_OTBND_UPC)                                             * 11630000
116400*----------------------------------------------------------------*11640000
116500     EXEC SQL                                                     11650000
116600         INCLUDE SUT00028                                         11660000
116700     END-EXEC.                                                    11670000
116800                                                                  11680000
116900*----------------------------------------------------------------*11690000
117000*  DCLGEN LAYOUT AND COBOL DECLARATION OTBND LOCATION TABLE       11700000
117100*   (SUT_OTBND_LOC)                                             * 11710000
117200*----------------------------------------------------------------*11720000
117300     EXEC SQL                                                     11730000
117400         INCLUDE SUT00027                                         11740000
117500     END-EXEC.                                                    11750000
117600                                                                  11760000
117700*----------------------------------------------------------------*11770000
117800*  DCLGEN LAYOUT AND COBOL DECLARATION OTBND VENDOR  TABLE        11780000
117900*   (SUT_OTBND_VND)                                             * 11790000
118000*----------------------------------------------------------------*11800000
118100     EXEC SQL                                                     11810000
118200         INCLUDE SUT00026                                         11820000
118300     END-EXEC.                                                    11830000
118400                                                                  11840000
118500*---------------------------------------------------------------* 11850000
118600*      -TROUBLE NOTIFICATION TABLE                              * 11860000
118700*---------------------------------------------------------------* 11870000
118800     EXEC SQL                                                     11880000
118900          INCLUDE TTRBNTF                                         11890000
119000     END-EXEC.                                                    11900000
119100                                                                  11910000
119200                                                                  11920000
119300*---------------------------------------------------------------* 11930000
119400*      -TROUBLE REASON CODES TABLE                              * 11940000
119500*---------------------------------------------------------------* 11950000
119600     EXEC SQL                                                     11960000
119700          INCLUDE TTRBRSN                                         11970000
119800     END-EXEC.                                                    11980000
119900                                                                  11990000
120000*---------------------------------------------------------------* 12000000
120100*      -TROUBLE REASON CODES TABLE  - PROGRAM ID LEVEL          * 12010000
120200*---------------------------------------------------------------* 12020000
120300     EXEC SQL                                                     12030000
120400          INCLUDE TTRBRCN                                         12040000
120500     END-EXEC.                                                    12050000
120600                                                                  12060000
120700*---------------------------------------------------------------* 12070000
120800*   QC -PO AUDIT REQUEST TABLE                                  * 12080000
120900*---------------------------------------------------------------* 12090000
121000     EXEC SQL                                                     12100000
121100          INCLUDE SUT00015                                        12110000
121200     END-EXEC.                                                    12120000
121300                                                                  12130000
121400*---------------------------------------------------------------* 12140000
121600*   SUT_PNA_STA                                                 * 12160000
121700*---------------------------------------------------------------* 12170000
121800     EXEC SQL                                                     12180000
121900          INCLUDE SUT00107                                        12190000
122000     END-EXEC.                                                    12200000
122100                                                                  12210000
122200*---------------------------------------------------------------* 12220000
122300*   SUT_PNA_STA_DIVERT                                          * 12230000
122400*---------------------------------------------------------------* 12240000
122500     EXEC SQL                                                     12250000
122600          INCLUDE SUT00108                                        12260000
122700     END-EXEC.                                                    12270000
122800                                                                  12280000
122900*---------------------------------------------------------------* 12290000
123000*   SUT_PNA_STA_DOOR                                            * 12300000
123100*---------------------------------------------------------------* 12310000
123200     EXEC SQL                                                     12320000
123300          INCLUDE SUT00109                                        12330000
123400     END-EXEC.                                                    12340000
123500                                                                  12350000
123700*---------------------------------------------------------------* 12370000
123800*   TRIP STATUS TABLE                                           * 12380000
123900*---------------------------------------------------------------* 12390000
124000     EXEC SQL                                                     12400000
124100          INCLUDE TTRIPST                                         12410000
124200     END-EXEC.                                                    12420000
124300                                                                  12430000
124400*---------------------------------------------------------------* 12440000
124500*   OUTBOUND PACK TABLE (SUT_OTBND_PK)                          * 12450000
124600*---------------------------------------------------------------* 12460000
124700     EXEC SQL                                                     12470000
124800          INCLUDE SUT00041                                        12480000
124900     END-EXEC.                                                    12490000
125000                                                                  12500000
125100*---------------------------------------------------------------* 12510000
125200*   PO PREPACK TABLE (TPOPRPK)                                  * 12520000
125300*---------------------------------------------------------------* 12530000
125400     EXEC SQL                                                     12540000
125500          INCLUDE TPOPRPK                                         12550000
125600     END-EXEC.                                                    12560000
125700                                                                  12570000
125800*----------------------------------------------------------------*12580000
125900* DCLGEN FOR EAS MDSE TAG LOOKUP  (SFT_EAS_TG_MDSE)              *12590000
126000*----------------------------------------------------------------*12600000
126100     EXEC SQL                                                     12610000
126200          INCLUDE SFT00000                                        12620000
126300     END-EXEC.                                                    12630000
126400                                                                  12640000
126500*----------------------------------------------------------------*12650000
126600* DC DOOR TABLE                                                  *12660000
126700*----------------------------------------------------------------*12670000
126800     EXEC SQL                                                     12680000
126900          INCLUDE TCNDCDR                                         12690000
127000     END-EXEC.                                                    12700000
127100                                                                  12710000
127200*----------------------------------------------------------------*12720000
127300* DC DOOR TO STORE TABLE                                         *12730000
127400*----------------------------------------------------------------*12740000
127500     EXEC SQL                                                     12750000
127600          INCLUDE TCNDRST                                         12760000
127700     END-EXEC.                                                    12770000
127800                                                                  12780000
127810*CLP 06/24/2015 - START                                           12781080
127820*----------------------------------------------------------------*12782080
127830* SKU TABLE (XLT_SKU)                                             12783080
127840*----------------------------------------------------------------*12784080
127850     EXEC SQL                                                     12785080
127860          INCLUDE XLT00003                                        12786080
127870     END-EXEC.                                                    12787080
127880                                                                  12788080
127890*----------------------------------------------------------------*12789080
127891* VENDOR STYLE TABLE (XLT_VND_STYL)                               12789180
127892*----------------------------------------------------------------*12789280
127893     EXEC SQL                                                     12789380
127894          INCLUDE XLT00004                                        12789480
127895     END-EXEC.                                                    12789580
127896                                                                  12789680
127897*----------------------------------------------------------------*12789780
127898* BRAND TABLE (XLT_BRND)                                          12789880
127899*----------------------------------------------------------------*12789980
127900     EXEC SQL                                                     12790080
127901          INCLUDE XLT00043                                        12790180
127902     END-EXEC.                                                    12790280
127903                                                                  12790380
127904*CLP 06/24/2015 - END                                             12790480
129300*----------------------------------------------------------------*12930000
129400*    DB2 DCLGEN FOR THE WST_INTGRTN_TYP TABLE                     12940000
129500*----------------------------------------------------------------*12950000
129600     EXEC SQL                                                     12960000
129700          INCLUDE WST00008                                        12970000
129800     END-EXEC.                                                    12980000
129900/                                                                 12990000
130000*----------------------------------------------------------------*13000000
130100*    DB2 DCLGEN FOR THE WST_ATTR_DEFN TABLE                       13010000
130200*----------------------------------------------------------------*13020000
130300     EXEC SQL                                                     13030000
130400          INCLUDE WST00009                                        13040000
130500     END-EXEC.                                                    13050000
130600/                                                                 13060000
130700*----------------------------------------------------------------*13070000
130800*    DB2 DCLGEN FOR THE WST_ATTR_ELEM TABLE                       13080000
130900*----------------------------------------------------------------*13090000
131000     EXEC SQL                                                     13100000
131100          INCLUDE WST00010                                        13110000
131200     END-EXEC.                                                    13120000
131400*                                                                 13140000
131500*----------------------------------------------------------------*13150000
131600*    DB2 DCLGEN FOR THE SUT_TRLR_RPLN_CART TABLE                  13160000
131700*----------------------------------------------------------------*13170000
131800     EXEC SQL                                                     13180000
131900         INCLUDE SUT00113                                         13190000
132000     END-EXEC.                                                    13200000
132100*                                                                 13210000
132300/                                                                 13230000
132400*----------------------------------------------------------------*13240000
132500*  COMMUNICATIONS AREA FOR DB2                                    13250000
132600*----------------------------------------------------------------*13260000
132700     EXEC SQL                                                     13270000
132800         INCLUDE SQLCA                                            13280000
132900     END-EXEC.                                                    13290000
133000*----------------------------------------------------------------*13300000
133100*  CURSOR TO SELECT THE LINE(S), LINE NUMBER, PREPACK ID        * 13310000
133200*  AND SHIPPED QUANTITY                                         * 13320000
133300*---------------------------------------------------------------* 13330000
133400                                                                  13340000
133500                                                                  13350000
133600     EXEC SQL                                                     13360000
133700          DECLARE PREPK-CSR CURSOR FOR                            13370000
133800          SELECT A.TRN_NBR                                        13380000
133900                ,D.ORD_LNE_NBR                                    13390000
134000                ,D.PREPK_ID                                       13400000
134100                ,D.PREPK_RATO_QTY                                 13410000
134200                ,A.SHPD_QTY                                       13420000
134300                ,E.PREPK_LNE_PRC_CDE                              13430000
134400                ,E.UCC128_DAT_USG_CDE                             13440000
134500                ,E.PRC_AREA_MODU_ID                               13450000
134600          FROM   TSHUUPC A                                        13460000
134700               , TINPKSU B                                        13470000
134800               , TPKSLIP C                                        13480000
134900               , TRECITM D                                        13490000
135000               , TDISTHD E                                        13500000
135100          WHERE A.SHIPT_UNT_ID = :DK-CTN                          13510000
135200          AND  A.SHIPT_UNT_ID = B.SHIPT_UNT_ID                    13520000
135300          AND  B.PO_NBR       = C.PO_NBR                          13530000
135400          AND  B.SEQ_NBR      = C.SEQ_NBR                         13540000
135500          AND  C.VER_STAT_CDE = 'A'                               13550000
135600          AND  C.PO_NBR       = D.ORD_NBR                         13560000
135700          AND  C.REC_SEQ_NBR  = D.REC_SEQ_NBR                     13570000
135800          AND  C.REC_SEQ_NBR  = :PV-RCVR-SEQ-NBR                  13580000
135900          AND  A.TRN_LNE_NBR  = D.ORD_LNE_NBR                     13590000
136000          AND  E.ORD_NBR      = C.PO_NBR                          13600000
136100          AND  E.RCVR_SEQ_NBR = C.REC_SEQ_NBR                     13610000
136200          AND  E.ORD_LNE_NBR  = D.ORD_LNE_NBR                     13620000
136300          AND  E.TOT_CART_CNT > 0                                 13630000
136400     END-EXEC                                                     13640000
136500                                                                  13650000
136600*---------------------------------------------------------------* 13660000
136700*  CURSOR TO SELECT THE BARCODES FOR A CARTON, USED FOR A REPRINT 13670000
137000*---------------------------------------------------------------* 13700000
137100     EXEC SQL                                                     13710000
137200        DECLARE REPRINT-CSR CURSOR FOR                            13720000
137300        SELECT   BRCDE_NBR                                        13730000
137400        FROM TSULBXF A                                            13740000
137500        WHERE  A.SHIPT_UNT_ID          =   :DK-CTN                13750000
137600          AND  A.STAT_CDE              =   'A'                    13760000
137700     END-EXEC                                                     13770000
137800                                                                  13780000
137900*---------------------------------------------------------------* 13790000
138000*  CURSOR TO SELECT THE LINE(S) AND NUMBER OF UNITS WITHIN A    * 13800000
138100*  CARTON                                                       * 13810000
138200*---------------------------------------------------------------* 13820000
138300     EXEC SQL                                                     13830000
138400          DECLARE UNITS-CSR CURSOR FOR                            13840000
138500          SELECT SHPD_QTY                                         13850000
138600                ,TRN_LNE_NBR                                      13860000
138700                ,UCC128_DAT_USG_CDE                               13870000
138800                ,PRC_AREA_MODU_ID                                 13880000
138900          FROM   TSHUUPC A                                        13890000
139000                ,TDISTHD B                                        13900000
139100          WHERE SHIPT_UNT_ID  = :DK-CTN                           13910000
139200            AND A.TRN_NBR     =  B.ORD_NBR                        13920000
139300            AND A.TRN_LNE_NBR =  B.ORD_LNE_NBR                    13930000
139400            AND B.RCVR_SEQ_NBR = :PV-RCVR-SEQ-NBR                 13940000
139500            AND B.TOT_CART_CNT > 0                                13950000
139600          ORDER BY 2                                              13960000
139700     END-EXEC                                                     13970000
139800                                                                  13980000
139900                                                                  13990000
140000     EXEC SQL                                                     14000000
140100        DECLARE VRTL-LBL-PRT-CSR CURSOR FOR                       14010000
140200        SELECT   CART_LBL_TYP_CDE                                 14020000
140300                ,PREPK_PRCG_LNE_NBR                               14030000
140400                ,INPK_UNT_QTY                                     14040000
140500                ,PREPK_RATO_QTY                                   14050000
140600                ,DEST_OPER_UNT_ID                                 14060000
140700                ,CSE_PK_QTY                                       14070000
140800                ,ODD_CART_IND                                     14080000
140900                ,INPK_CNVYB_IND                                   14090000
141000                ,LBL_TYP_LBL_SEQ_ID                               14100000
141100                ,LBL_TYP_TOT_QTY                                  14110000
141200                ,BRCDE_NBR                                        14120000
141300                ,STR_ZN_ID                                        14130000
141400                ,MODU_DESC                                        14140000
141500                ,ITM_NBR                                          14150000
141600                ,DEPT_DESC                                        14160000
141700                ,MAJ_CL_DESC                                      14170000
141800                ,SEASET_NM                                        14180000
141900                ,FIXT_ID                                          14190000
142000                ,LBL_TYP_CDE                                      14200000
142100                ,PRNT_CART_SEQ_ID                                 14210000
142200                ,STRG_AREA_CDE                                    14220000
142300                ,OTPK_UNT_QTY                                     14230000
142400                ,EAS_TAG_IND                                      14240000
142500                ,DOOR_ID                                          14250000
142600                ,HNG_FOLD_SEQ_NBR                                 14260000
142610*CLP 06/24/15 START                                               14261080
142700                ,LBL_MSG_TXT                                      14270080
142710*CLP 06/24/15 END                                                 14271080
142800        FROM TLBVRDA A                                            14280000
142900        WHERE  A.PO_NBR                =   :DK-PO                 14290000
143000          AND  A.RCVR_SEQ_NBR          =   :DK-REC-SEQ-NBR        14300000
143100          AND  A.PO_LNE_NBR            =   :DK-PO-LNE-NBR         14310000
143200          AND  A.PREPK_ID              =   :DK-PREPK-ID           14320000
143300          AND  A.OTPK_UNT_QTY          =   :DK-OUTER-QTY          14330000
143400          AND  A.LBL_ASG_IND           =   'N'                    14340000
143500          AND  A.PRNT_CART_SEQ_ID      =   :LBVRDA-LBL-ASG-SEQ-NBR14350000
143600        ORDER BY LBL_TYP_LBL_SEQ_ID                               14360000
143700     END-EXEC                                                     14370000
143800*---------------------------------------------------------------* 14380000
143900*  CURSOR TO DETERMINE ODD UNITS IN A PREPACK                   * 14390000
144000*  CARTON                                                       * 14400000
144100*---------------------------------------------------------------* 14410000
144200     EXEC SQL                                                     14420000
144300          DECLARE ODD-UNITS-CSR CURSOR FOR                        14430000
144400           SELECT 'A',                                            14440000
144500                  TRN_LNE_NBR,                                    14450000
144600                  0                                               14460000
144700           FROM TSHUUPC                                           14470000
144800           WHERE SHIPT_UNT_ID = :DK-CTN                           14480000
144900           UNION                                                  14490000
145000           SELECT 'B', B.ORD_LNE_NBR, A.PREPK_ID                  14500000
145100           FROM  TRECITM A                                        14510000
145200               , TSHUUPC                                          14520000
145300               , TRECITM B                                        14530000
145400           WHERE A.ORD_NBR        = TRN_NBR                       14540000
145500               AND A.REC_SEQ_NBR  = :DK-REC-SEQ-NBR               14550000
145600               AND A.ORD_LNE_NBR  = TRN_LNE_NBR                   14560000
145700               AND SHIPT_UNT_ID   = :DK-CTN                       14570000
145800               AND B.ORD_NBR      = A.ORD_NBR                     14580000
145900               AND B.REC_SEQ_NBR  = A.REC_SEQ_NBR                 14590000
146000               AND B.PREPK_ID     = A.PREPK_ID                    14600000
146100           ORDER BY 2, 1                                          14610000
146400     END-EXEC                                                     14640000
146500*---------------------------------------------------------------* 14650000
146600*  CURSOR TO DETERMINE MERCHANDISE PRESENTATION                 * 14660000
146700*  HANG, FOLD OR MIXED                                          * 14670000
146800*---------------------------------------------------------------* 14680000
146900     EXEC SQL                                                     14690000
147000          DECLARE HANG_FOLD_CSR CURSOR FOR                        14700000
147100           SELECT DISTINCT(UPC_NBR)                               14710000
147200                , TRN_LNE_NBR                                     14720000
147300           FROM TSHUUPC                                           14730000
147400           WHERE SHIPT_UNT_ID = :DK-CTN                           14740000
147500     END-EXEC                                                     14750000
147600*---------------------------------------------------------------* 14760000
147700*  CURSOR TO DETERMINE IF ECOMM UPC NEEDS WEIGHTS MEASURES      * 14770000
147800*  CHECK                                                        * 14780000
147900*---------------------------------------------------------------* 14790000
148000     EXEC SQL                                                     14800000
148100          DECLARE WGHTS_MSRS_CSR CURSOR FOR                       14810000
148200           SELECT DISTINCT(UPC_NBR)                               14820000
148300           FROM TSHUUPC                                           14830000
148400           WHERE SHIPT_UNT_ID = :DK-CTN                           14840000
148500     END-EXEC                                                     14850000
148600*---------------------------------------------------------------* 14860000
148700*  CURSOR TO SELECT UPC FOR EACH CARTON TO POPULATE             * 14870000
148800*  THE OUTBOUND CARTON UPC TABLE                                * 14880000
148900*---------------------------------------------------------------* 14890000
149000     EXEC SQL                                                     14900000
149100          DECLARE UPC_UNLOAD_CSR CURSOR FOR                       14910000
149200           SELECT DISTINCT(UPC_NBR)                               14920000
149300                , TRN_NBR                                         14930000
149400                , TRN_LNE_NBR                                     14940000
149500                , TRN_TYP_CDE                                     14950000
149600                , SHPD_QTY                                        14960000
149700           FROM TSHUUPC                                           14970000
149800           WHERE SHIPT_UNT_ID = :DK-CTN                           14980000
149900     END-EXEC                                                     14990000
150000***************************************************************** 15000000
150100 LINKAGE SECTION.                                                 15010000
150200******************************************************************15020000
150300 01  DFHCOMMAREA.                                                 15030000
150400     05  FILLER                       OCCURS 1 TO 4072 TIMES      15040000
150500                                      DEPENDING ON EIBCALEN.      15050000
150600         10  FILLER                   PIC X.                      15060000
150700                                                                  15070000
150800******************************************************************15080000
150900 PROCEDURE DIVISION.                                              15090000
151000******************************************************************15100000
151100 0000-PROGRAM-MAINLINE.                                           15110000
151200                                                                  15120000
151300     MOVE DFHCOMMAREA TO CA-COMMAREA.                             15130000
151400                                                                  15140000
151500     EXEC CICS                                                    15150000
151600         ASSIGN USERID  (SU001-USER-ID)                           15160000
151700                RESP    (PV-CICS-RESPONSE)                        15170000
151800                NETNAME (SU001-SESSION-ID)                        15180000
151900     END-EXEC.                                                    15190000
152000                                                                  15200000
152100     EXEC CICS                                                    15210000
152200         ASSIGN                                                   15220000
152300             APPLID(PV-SYSTEM-ID)                                 15230000
152400     END-EXEC.                                                    15240000
152500                                                                  15250000
152600     EVALUATE TRUE                                                15260000
152700         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 15270000
152800             MOVE  SU001-USER-ID    TO  SU001-USER-ID-USE         15280000
152900         WHEN OTHER                                               15290000
153000            MOVE '0000-PROGRAM-MAINLINE' TO DP013-PARAGRAPH       15300000
153100            MOVE 'SUKRF706 - UNABLE TO ASSIGN USER-ID'            15310000
153200              TO DP013-MESSAGE-TEXT (1)                           15320000
153300            SET DP013-LOGIC-ABEND        TO TRUE                  15330000
153400            SET DP013-ROLLBACK           TO TRUE                  15340000
153500            PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                15350000
153600     END-EVALUATE.                                                15360000
153700                                                                  15370000
153800     EVALUATE TRUE                                                15380000
153900         WHEN EIBCALEN = ZERO                                     15390000
154000             MOVE PC-ENTER-THROUGH-MENU-MSG TO PV-MESSAGE-AREA    15400000
154100             PERFORM 8300-RETURN                                  15410000
154200                                                                  15420000
154300****************************************************************  15430000
154400* DPKRF278 IS THE PGM FOR THE HELP SCREEN.                        15440000
154500****************************************************************  15450000
154600         WHEN EIBTRNID = 'Z278'                                   15460000
154700             MOVE DFHCOMMAREA          TO PC192-COMMAREA          15470000
154800             MOVE PC192-HOST-SAVE-AREA TO CA-COMMAREA             15480000
154900             SET SU001-PROCESS-SCREEN  TO TRUE                    15490000
155000             INITIALIZE PV-PROGRAM-DATA                           15500000
155100             MOVE SPACES TO APORCVRO                              15510000
155200             MOVE SPACES TO ASTRO                                 15520000
155300             MOVE SPACES TO ALNEO                                 15530000
155400             MOVE SPACES TO AITEMO                                15540000
155500             MOVE SPACES TO ACARTNO                               15550000
155600             MOVE -1     TO ACARTNL                               15560000
155700             PERFORM 8000-SEND-MAP                                15570000
155800             PERFORM 8200-RETURN-TRANID                           15580000
155900                                                                  15590000
156000         WHEN SU001-INITIALIZE-SCREEN                             15600000
156100         WHEN EIBAID = DFHCLEAR                                   15610000
156200             SET SU001-PROCESS-SCREEN TO TRUE                     15620000
156300             PERFORM 1000-INITIALIZE                              15630000
156400             MOVE PC-CURRENT-PROGRAM-NAME TO SU001-LAST-PROGRAM   15640000
156500             PERFORM 8000-SEND-MAP                                15650000
156600             PERFORM 8200-RETURN-TRANID                           15660000
156700                                                                  15670000
156800         WHEN EIBAID = DFHENTER                                   15680000
156900             IF PV-TEST-CICS OR PV-QA-CICS                        15690000
157000                EXEC SQL                                          15700000
157100                    SET :PV-BEGIN-TIME = CURRENT TIMESTAMP        15710000
157200                END-EXEC                                          15720000
157300             END-IF                                               15730000
157400                                                                  15740000
157500             MOVE  SPACES             TO SU001-DUPLICATE-IND      15750000
157600                                         SU001-REPRINT-IND        15760000
157700                                         SU001-LBL-REPRINT-IND    15770000
157800             SET PS-VALID-INPUT                                   15780000
157900                 PS-VALID-RFID-CARTON                             15790043
158000                 PS-VALID-CHECK-DIGIT                             15800000
158100                 PS-NO-CARTON-PRINTED                             15810049
158200                 PS-DONT-DISPLAY-SUKRF530 TO TRUE                 15820000
158300             PERFORM 2000-PROCESS-SCREEN-FIELDS                   15830000
158400                                                                  15840000
158500             IF PS-VALID-INPUT                                    15850008
158600                 MOVE -1                 TO ACARTNL               15860000
158700                 IF  SU001-BATCH-PRINTER OR                       15870000
158800                     SU001-PRINT-AND-PEEL                         15880000
158900                     MOVE  PC-FKEYS  TO  AFKEYO                   15890000
159000                 ELSE                                             15900000
159100                     MOVE  PC-F5-AUDIT-FKEY TO AFKEYO             15910000
159200                 END-IF                                           15920000
159300                 MOVE PC-FKEY2       TO AFKEY2O                   15930000
159400                 MOVE SU001-CARTON   TO PV-CTN                    15940000
159500                                        PV-CTN-N                  15950000
159600                 MOVE SU001-PO       TO PV-PO-N                   15960000
159700                                        PV-PO-OUT                 15970000
159800                 IF SU044-NEW-REC-SEQ-NBR > 0                     15980000
159900                    MOVE SU044-NEW-REC-SEQ-NBR TO PV-RCVR-OUT     15990000
160000                    MOVE PV-PO-RCVR            TO APORCVRO        16000000
160100                 ELSE                                             16010000
160200                    MOVE SU001-RCVR-SEQ-NBR TO PV-RCVR-OUT        16020000
160300                    MOVE PV-PO-RCVR         TO APORCVRO           16030000
160400                 END-IF                                           16040000
160500                 IF SU001-P2L-LBL-CREATED                         16050000
160600                    MOVE SPACES      TO PV-STORE-X                16060000
160700                    MOVE 'P2L'       TO PV-STORE-X-4              16070000
160800                    MOVE PV-STORE-X  TO ASTRO                     16080000
160900                 ELSE                                             16090000
161000                    MOVE SU001-STORE    TO PV-STORE-N             16100000
161100                    MOVE PV-STORE       TO ASTRO                  16110000
161200                 END-IF                                           16120000
161300                                                                  16130000
161400                 EVALUATE TRUE                                    16140000
161500                    WHEN SU001-PREPK-ID > 0                       16150000
161600                       MOVE 'PCK:'      TO ALNEHDGO               16160000
161700                       MOVE SU001-PREPK-ID TO PV-PO-LINE-N        16170000
161800                    WHEN SU001-MULTI-LINE                         16180000
161900                       MOVE PC-MULTI-LINE TO PV-PO-LINE-OUT       16190000
162000                       MOVE  'MLT ITMS'   TO  PV-SKU-OUT          16200000
162100                    WHEN  SU001-NO-LINE                           16210000
162200                        MOVE PC-NOLNE-LINE TO PV-PO-LINE-OUT      16220000
162300                    WHEN  OTHER                                   16230000
162400                        CONTINUE                                  16240000
162500                 END-EVALUATE                                     16250000
162600                 MOVE PV-SKU-OUT        TO AITEMO                 16260000
162700                 MOVE PV-PO-LINE-OUT    TO ALNEO                  16270000
162800                 MOVE PV-CTN-X          TO ACARTNO                16280000
162900                                                                  16290000
163000                 IF PS-CARTON-PRINTED                             16300044
163100                     MOVE PC-CARTON-DUPLICATE                     16310056
163200                                     TO AMSGLNO                   16320056
163300                     MOVE PC-FKEY3   TO  AFKEYO                   16330056
163400                 END-IF                                           16340044
163500                                                                  16350056
163600                 IF PV-TEST-CICS OR PV-QA-CICS                    16360000
163700                    EXEC SQL                                      16370000
163800                       SET :PV-END-TIME = CURRENT TIMESTAMP       16380000
163900                    END-EXEC                                      16390000
164000                    MOVE SPACES TO PV-CICS-MSG-AREA-A             16400000
164100                    STRING 'SUKRF706 BEG TIME '  DELIMITED BY SIZE16410000
164200                         PV-BEGIN-TIME           DELIMITED BY SIZE16420000
164300                                           INTO PV-CICS-MSG-AREA-B16430000
164400                    MOVE LENGTH OF PV-CICS-MSG-AREA-A             16440000
164500                                           TO PV-COMMAREA-LENGTH  16450000
164600                    PERFORM 9998-WRITE-TO-CSSL                    16460000
164700                                                                  16470000
164800                    MOVE SPACES TO PV-CICS-MSG-AREA-A             16480000
164900                    STRING  'SUKRF706 END TIME ' DELIMITED BY SIZE16490000
165000                             PV-END-TIME         DELIMITED BY SIZE16500000
165100                           'NO XCTL '            DELIMITED BY SIZE16510000
165200                                        INTO PV-CICS-MSG-AREA-B   16520000
165300                    MOVE LENGTH OF PV-CICS-MSG-AREA-A             16530000
165400                                             TO PV-COMMAREA-LENGTH16540000
165500                    PERFORM 9998-WRITE-TO-CSSL                    16550000
165600                 END-IF                                           16560000
165700                 PERFORM 8000-SEND-MAP                            16570000
165800                 PERFORM 8200-RETURN-TRANID                       16580000
165900               ELSE                                               16590090
165910                 IF PS-NO-TLBPTDA                                 16591090
165920                    MOVE PC-NO-TLBPTDA                            16592090
165930                                         TO AMSGLNO               16593090
165940                    MOVE -1  TO ACARTNL                           16594090
165950                    PERFORM 8100-SEND-DATA-ONLY                   16595090
165960                    PERFORM 8200-RETURN-TRANID                    16596090
165970                 ELSE                                             16597090
166000                     IF PS-INVALID-RFID-CARTON                    16600090
166100                         MOVE PC-INVALID-RFID-CARTON              16610090
166200                                         TO AMSGLNO               16620090
166300                         MOVE -1  TO ACARTNL                      16630090
166400                         PERFORM 8100-SEND-DATA-ONLY              16640090
166500                         PERFORM 8200-RETURN-TRANID               16650090
166600                     ELSE                                         16660090
166700                         IF PS-INVALID-CHECK-DIGIT                16670090
166800                             MOVE PC-INVALID-CHECK-DIGIT          16680090
166900                                             TO AMSGLNO           16690090
167000                             MOVE -1  TO ACARTNL                  16700090
167100                             PERFORM 8100-SEND-DATA-ONLY          16710090
167200                             PERFORM 8200-RETURN-TRANID           16720090
167300                         ELSE                                     16730090
167400                             MOVE  PC-CARTON-NOT-FOUND            16740090
167500                                             TO AMSGLNO           16750090
167600                             MOVE -1  TO ACARTNL                  16760090
167700                             PERFORM 8100-SEND-DATA-ONLY          16770090
167800                             PERFORM 8200-RETURN-TRANID           16780090
167900                         END-IF                                   16790090
167910                     END-IF                                       16791090
168000                 END-IF                                           16800008
168100              END-IF                                              16810009
168200                                                                  16820000
168300         WHEN EIBAID = DFHPF1                                     16830000
168400              PERFORM 1200-HELP-SCREEN                            16840000
168500                                                                  16850000
168600         WHEN EIBAID = DFHPF3                                     16860000
168700             IF  SU001-ROWS-INSERTED  >  ZERO                     16870000
168800                MOVE PC-SU-LBL-NEED-PGM  TO PV-TRANSFER-PROGRAM   16880000
168900             ELSE                                                 16890000
169000                MOVE PC-SU-RFID-CONTROL-PGM TO PV-TRANSFER-PROGRAM16900000
169100             END-IF                                               16910000
169200             PERFORM 4000-XCTL-LRT-MENU                           16920000
169300                                                                  16930000
169400         WHEN EIBAID = DFHPF4                                     16940000
169500             IF  SU001-BATCH-PRINTER OR                           16950000
169600                 SU001-PRINT-AND-PEEL                             16960000
169700                 MOVE SU001-CARTON TO DK-CTN                      16970090
169800                     PERFORM 0511-CHECK-IF-CARTON-PRINTED         16980090
169900                     IF  PS-CARTON-PRINTED                        16990090
170101                        PERFORM 2500-GET-REPRINT-BATCH            17010190
170200                     END-IF                                       17020090
170300                     SET  SU001-INITIALIZE-SCREEN TO TRUE         17030090
170400                     MOVE PC-SU-LBL-PRT-PGM                       17040090
170410                                        TO PV-TRANSFER-PROGRAM    17041090
170500                     PERFORM 4000-XCTL-LRT-MENU                   17050090
170600             ELSE                                                 17060000
170700                MOVE PC-UNRECOGNIZED-PF-KEY-MSG TO AMSGLNO        17070000
170800                MOVE -1                         TO ACARTNL        17080000
170900                PERFORM 8100-SEND-DATA-ONLY                       17090000
171000                PERFORM 8200-RETURN-TRANID                        17100000
171100             END-IF                                               17110000
171200                                                                  17120000
171300         WHEN OTHER                                               17130000
171400             MOVE -1                         TO ACARTNL           17140000
171500             MOVE PC-UNRECOGNIZED-PF-KEY-MSG TO AMSGLNO           17150000
171600             PERFORM 8100-SEND-DATA-ONLY                          17160000
171700             PERFORM 8200-RETURN-TRANID                           17170000
171800     END-EVALUATE.                                                17180000
171900                                                                  17190000
172000     GOBACK.                                                      17200000
172100                                                                  17210000
172200 0500-CHECK-IF-DC.                                                17220000
172300                                                                  17230000
172400     EXEC SQL                                                     17240000
172500          SELECT LOC_TYP_CDE                                      17250000
172600               , LOC_10_ABBR_NM                                   17260000
172700               , E_BUS_IND                                        17270000
172800          INTO  :XLT00010-LOC-TYP-CDE                             17280000
172900               ,:XLT00010-LOC-10-ABBR-NM                          17290000
173000               ,:XLT00010-E-BUS-IND                               17300000
173100          FROM   XLT_LOC                                          17310000
173200          WHERE  LOC_NBR   = :SHPUNT-DEST-OPER-UNT-ID             17320000
173300     END-EXEC.                                                    17330000
173400                                                                  17340000
173500     EVALUATE TRUE                                                17350000
173600         WHEN SQLCODE = ZERO                                      17360000
173700            IF XLT00010-LOC-TYP-CDE = 'DC'                        17370000
173800              SET PS-OPER-IS-DC TO TRUE                           17380000
173900            ELSE                                                  17390000
174000                IF XLT00010-LOC-TYP-CDE = 'DS'                    17400000
174100                  IF XLT00010-E-BUS-IND = 'Y'                     17410000
174200                     SET PS-OPER-IS-ECOMM-STORE TO TRUE           17420000
174300                  ELSE                                            17430000
174400                     SET PS-OPER-IS-STORE TO TRUE                 17440000
174500                  END-IF                                          17450000
174600                END-IF                                            17460000
174700            END-IF                                                17470000
174800         WHEN SQLCODE = +100                                      17480000
174900         WHEN SQLCODE = -305                                      17490000
175000              CONTINUE                                            17500000
175100         WHEN SQLWARN0 NOT = SPACES                               17510000
175200         WHEN SQLCODE NOT EQUAL ZERO                              17520000
175300             MOVE '0500-CHECK-IF-DC'                              17530000
175400                             TO DP013-PARAGRAPH                   17540000
175500             MOVE 'SUKRF706 - CHECK IF OPER IS DC'                17550000
175600                             TO DP013-MESSAGE-TEXT(1)             17560000
175700             MOVE SHPUNT-DEST-OPER-UNT-ID                         17570000
175800                             TO DP013-MESSAGE-TEXT(2)             17580000
175900             MOVE SQLCA      TO DP013-SQLCA                       17590000
176000             MOVE 'XLT00010' TO DP013-DB2-TABLE-NAME(1)           17600000
176100             SET DP013-DB2-ABEND                                  17610000
176200                             TO TRUE                              17620000
176300             SET DP013-ROLLBACK                                   17630000
176400                             TO TRUE                              17640000
176500             SET DP013-XCTL-DISPLAY-RESTART                       17650000
176600                             TO TRUE                              17660000
176700             PERFORM DP014-0000-PROCESS-ABEND                     17670000
176800     END-EVALUATE.                                                17680000
176900                                                                  17690000
177000************************************************************      17700041
177100*MUST HAVE A ENTRY ON TABLE WITH 'RFDC' IN ORDER FOR CARTON       17710041
177200*TO BE PRINTED THRU THIS FUNCTION                                 17720041
177300************************************************************      17730041
177400                                                                  17740041
177500 0510-CHECK-FOR-PRINT.                                            17750041
177600                                                                  17760041
177700     EXEC SQL                                                     17770041
177800        SELECT  A.SCN_LOC_ID                                      17780041
177900            INTO :SHUNLO-SCN-LOC-ID                               17790041
178000       FROM TSHUNLO A                                             17800041
178100       WHERE  A.SHIPT_UNT_ID   = :DK-CTN                          17810041
178200         AND A.SCN_LOC_ID  = ('RFDC')                             17820041
178300         AND  A.ACTV_CDE  = 'I'                                   17830041
178400     END-EXEC.                                                    17840040
178500                                                                  17850040
178600     EVALUATE TRUE                                                17860040
178700          WHEN SQLCODE = ZERO                                     17870040
178800             CONTINUE                                             17880040
178900          WHEN SQLCODE = +100                                     17890040
179000               SET PS-CARTON-DOESNT-EXIST TO TRUE                 17900040
179100               SET PS-INVALID-RFID-CARTON TO TRUE                 17910042
179200          WHEN SQLWARN0 NOT = SPACES                              17920040
179300          WHEN SQLCODE < ZERO                                     17930040
179400          WHEN SQLCODE > ZERO                                     17940040
179500              MOVE '0510-CHECK-FOR-PRINT'                         17950040
179600                                TO DP013-PARAGRAPH                17960040
179700              MOVE 'SELECT FROM TABLE  - '                        17970040
179800                                TO DP013-MESSAGE-TEXT (1)         17980040
179900              MOVE DK-CTN       TO DP013-MESSAGE-TEXT (2)         17990040
180000              MOVE SQLCA        TO DP013-SQLCA                    18000040
180100              MOVE 'TSHUNLO '   TO DP013-DB2-TABLE-NAME (1)       18010040
180200              SET DP013-DB2-ABEND                                 18020040
180300                  DP013-XCTL-DISPLAY-RESTART TO TRUE              18030040
180400              SET DP013-ROLLBACK                                  18040040
180500                                TO TRUE                           18050040
180600              PERFORM DP014-0000-PROCESS-ABEND                    18060040
180700     END-EVALUATE.                                                18070040
180800                                                                  18080050
180900 0511-CHECK-IF-CARTON-PRINTED.                                    18090050
181000                                                                  18100050
181100     EXEC SQL                                                     18110050
181200        SELECT  A.SCN_LOC_ID                                      18120050
181300            INTO :SHUNLO-SCN-LOC-ID                               18130050
181400       FROM TSHUNLO A                                             18140050
181500       WHERE  A.SHIPT_UNT_ID   = :DK-CTN                          18150050
181600         AND A.SCN_LOC_ID  = ('RFDF')                             18160050
181700         AND  A.ACTV_CDE  = 'I'                                   18170050
181800     END-EXEC.                                                    18180050
181900                                                                  18190050
182000     EVALUATE TRUE                                                18200050
182100          WHEN SQLCODE = ZERO                                     18210050
182200                SET PS-CARTON-PRINTED TO TRUE                     18220050
182300          WHEN SQLCODE = +100                                     18230050
182400             CONTINUE                                             18240050
182500          WHEN SQLWARN0 NOT = SPACES                              18250050
182600          WHEN SQLCODE < ZERO                                     18260050
182700          WHEN SQLCODE > ZERO                                     18270050
182800              MOVE '0511-CHECK-IF-CARTON-PRINTED'                 18280056
182900                                TO DP013-PARAGRAPH                18290050
183000              MOVE 'SELECT FROM TABLE  - '                        18300050
183100                                TO DP013-MESSAGE-TEXT (1)         18310050
183200              MOVE DK-CTN       TO DP013-MESSAGE-TEXT (2)         18320050
183300              MOVE SQLCA        TO DP013-SQLCA                    18330050
183400              MOVE 'TSHUNLO '   TO DP013-DB2-TABLE-NAME (1)       18340050
183500              SET DP013-DB2-ABEND                                 18350050
183600                  DP013-XCTL-DISPLAY-RESTART TO TRUE              18360050
183700              SET DP013-ROLLBACK                                  18370050
183800                                TO TRUE                           18380050
183900              PERFORM DP014-0000-PROCESS-ABEND                    18390050
184000     END-EVALUATE.                                                18400050
184100                                                                  18410040
184101                                                                  18410190
184110******************************************************************18411090
184120* TLBPTDA ONLY STAYS FOR 10 DAYS, THEN IT IS PURGED.  IF THE DC  *18412090
184130* IS TRYING TO PRINT THE FINAL LABEL AFTER THE PURGE THEY WILL   *18413090
184140* HAVE TO USE THE CARTON STATUS APPLICATION                      *18414090
184150******************************************************************18415090
184160 0512-CHECK-IF-TLBPTDA-EXISTS.                                    18416090
184170                                                                  18417090
184180     EXEC SQL                                                     18418090
184190         SELECT LBL_PRT_BTCH_ID                                   18419090
184191               ,CRE_USR_ID                                        18419190
184192               ,TRIP_ID                                           18419290
184193         INTO   :LBPTDA-LBL-PRT-BTCH-ID                           18419390
184194               ,:LBPTDA-CRE-USR-ID                                18419490
184195               ,:LBPTDA-TRIP-ID                                   18419590
184196          FROM  TLBPTDA                                           18419690
184197          WHERE SHIPT_UNT_ID      = :DK-CTN                       18419790
184198     END-EXEC.                                                    18419890
184199                                                                  18419990
184200     EVALUATE TRUE                                                18420090
184201         WHEN SQLCODE = ZERO                                      18420190
184202         WHEN SQLCODE = -811                                      18420290
184203              SET PS-TLBPTDA-EXISTS-YES TO TRUE                   18420390
184204         WHEN SQLCODE = +100                                      18420490
184205         WHEN SQLCODE = -305                                      18420590
184206              SET PS-TLBPTDA-EXISTS-NO  TO TRUE                   18420690
184207              SET PS-INVALID-INPUT      TO TRUE                   18420790
184208         WHEN SQLWARN0 NOT = SPACES                               18420890
184209         WHEN SQLCODE NOT EQUAL ZERO                              18420990
184210             MOVE '0512-CHECK-IF-TLBPTDA-EXISTS'                  18421090
184211                             TO DP013-PARAGRAPH                   18421190
184212             MOVE                                                 18421290
184213                'SUKRF706-CHECK IF TLBPTDA STILL EXISTS '         18421390
184214                             TO DP013-MESSAGE-TEXT(1)             18421490
184215             MOVE SU001-MANIFEST                                  18421590
184216                             TO DP013-MESSAGE-TEXT(2)             18421690
184217             MOVE SU001-USER-ID                                   18421790
184218                             TO DP013-MESSAGE-TEXT(3)             18421890
184219             MOVE SQLCA      TO DP013-SQLCA                       18421990
184220             MOVE 'TLBPTDA'  TO DP013-DB2-TABLE-NAME(1)           18422090
184221             SET DP013-DB2-ABEND                                  18422190
184222                             TO TRUE                              18422290
184223             SET DP013-NO-ROLLBACK                                18422390
184224                             TO TRUE                              18422490
184225             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              18422590
184226             PERFORM DP014-0000-PROCESS-ABEND                     18422690
184227     END-EVALUATE.                                                18422790
184228                                                                  18422890
184229                                                                  18422990
184230 1000-INITIALIZE.                                                 18423000
184300                                                                  18430000
184400     IF  SU001-BATCH-PRINTER OR                                   18440000
184500         SU001-PRINT-AND-PEEL                                     18450000
184600         MOVE  PC-FKEYS  TO  AFKEYO                               18460000
184700     ELSE                                                         18470000
184800         MOVE  PC-F5-AUDIT-FKEY TO AFKEYO                         18480000
184900     END-IF.                                                      18490000
185000     MOVE PC-FKEY2       TO AFKEY2O.                              18500000
185100     MOVE SU001-AUDIT-CNTL-NBR TO PV-AUDIT-CNTL-NBR               18510001
185200                                                                  18520011
185300*****CONTROL # IS MADE NEGATIVE                                   18530056
185400                                                                  18540011
185500     MULTIPLY SU001-AUDIT-CNTL-NBR BY -1 GIVING PV-MANIFEST-NEG.  18550011
185600     MOVE  PV-MANIFEST-NEG    TO SU001-MANIFEST.                  18560011
185700     MOVE PV-AUDIT-CNTL-NBR   TO ACNTLO.                          18570001
185800                                                                  18580011
185900     EVALUATE TRUE                                                18590000
186000*    - SUKRF705                                                   18600007
186100         WHEN SU001-LAST-PROGRAM = PC-SU-RFID-CONTROL-PGM         18610006
186200             INITIALIZE PV-PROGRAM-DATA                           18620000
186300             MOVE SPACES TO APORCVRO                              18630000
186400             MOVE SPACES TO ASTRO                                 18640000
186500             MOVE SPACES TO ALNEO                                 18650000
186600             MOVE SPACES TO AITEMO                                18660000
186700             MOVE SPACES TO ACARTNO                               18670000
186800             MOVE -1     TO ACARTNL                               18680000
186900     MOVE -1                     TO ACARTNL.                      18690000
187000                                                                  18700000
187100                                                                  18710000
187200 1100-GET-ZONE-DESC.                                              18720000
187300                                                                  18730000
187400         MOVE SU001-PO   TO PURCHS-PO-NBR.                        18740000
187500                                                                  18750000
187600         EXEC SQL                                                 18760000
187700              SELECT C.STR_ZN_ID                                  18770000
187800              INTO   :MDSEDP-STR-ZN-ID                            18780000
187900              FROM   TPURCHS A,                                   18790000
188000                     TMDSEAR B,                                   18800000
188100                     TMDSEDP C                                    18810000
188200              WHERE  A.PO_NBR   = :PURCHS-PO-NBR                  18820000
188300                AND  A.VER_STATUS_CDE = 'A'                       18830000
188400                AND  A.DEPT_NBR = B.DEPT_NBR                      18840000
188500                AND  B.MDSELV_CDE = 'DPT'                         18850000
188600                AND  B.OPERCO_NBR = '03'                          18860000
188700                AND (B.STRT_DTE <= CURRENT DATE AND               18870000
188800                     B.END_DTE > CURRENT DATE)                    18880000
188900                AND  B.MDSEAR_DKEY = C.MDSEAR_DKEY                18890000
189000         END-EXEC                                                 18900000
189100                                                                  18910000
189200     EVALUATE TRUE                                                18920000
189300         WHEN SQLCODE = ZERO                                      18930000
189400             MOVE MDSEDP-STR-ZN-ID TO LBPTDA-STR-ZN-ID            18940000
189500         WHEN SQLCODE = +100                                      18950000
189600             MOVE SPACES TO LBPTDA-STR-ZN-ID                      18960000
189700         WHEN SQLWARN0 NOT = SPACES                               18970000
189800         WHEN SQLCODE NOT EQUAL ZERO                              18980000
189900             MOVE '1100-GET-ZONE-DESC'                            18990000
190000                             TO DP013-PARAGRAPH                   19000000
190100             MOVE 'SUKRF706 - GET ZONE DESC '                     19010000
190200                             TO DP013-MESSAGE-TEXT(1)             19020000
190300             MOVE PURCHS-PO-NBR                                   19030000
190400                             TO DP013-MESSAGE-TEXT(2)             19040000
190500             MOVE SQLCA      TO DP013-SQLCA                       19050000
190600             MOVE 'TMDSEDP'  TO DP013-DB2-TABLE-NAME(1)           19060000
190700             SET DP013-DB2-ABEND                                  19070000
190800                             TO TRUE                              19080000
190900             SET DP013-ROLLBACK                                   19090000
191000                             TO TRUE                              19100000
191100             SET DP013-XCTL-DISPLAY-RESTART                       19110000
191200                             TO TRUE                              19120000
191300             PERFORM DP014-0000-PROCESS-ABEND                     19130000
191400     END-EVALUATE.                                                19140000
191500                                                                  19150000
191600 1200-HELP-SCREEN.                                                19160000
191700     MOVE 'DPKRF278'                  TO PV-TRANSFER-PROGRAM      19170000
191800     MOVE PC-CURRENT-PROGRAM-NAME     TO PC192-PROGRAM-NAME       19180000
191900     COPY PCPD188.                                                19190000
192000     MOVE PC188-DISPLAY-DATE          TO PC192-DISPLAY-DATE.      19200000
192100     PERFORM 4200-XCTL-TO-HELP.                                   19210000
192200                                                                  19220000
192300                                                                  19230000
192400 2000-PROCESS-SCREEN-FIELDS.                                      19240000
192500                                                                  19250000
192600     PERFORM 2100-RECEIVE-MAP.                                    19260000
192700     PERFORM 2200-EDIT-INPUT.                                     19270000
192800                                                                  19280000
192900                                                                  19290000
193000 2100-RECEIVE-MAP.                                                19300000
193100                                                                  19310000
193200     EXEC CICS                                                    19320000
193300         RECEIVE MAP    ('SU706A')                                19330000
193400                 MAPSET ('SUKM706')                               19340000
193500                 RESP   (PV-CICS-RESPONSE)                        19350000
193600     END-EXEC.                                                    19360000
193700                                                                  19370000
193800     EVALUATE TRUE                                                19380000
193900         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 19390000
194000             PERFORM 2110-RECEIVE-SCREEN-FIELDS                   19400000
194100         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                19410000
194200             CONTINUE                                             19420000
194300         WHEN OTHER                                               19430000
194400            MOVE '2100-RECEIVE-MAP'      TO DP013-PARAGRAPH       19440000
194500            MOVE 'SUKRF706 - UNABLE TO RECEIVE MAP'               19450000
194600                                         TO DP013-MESSAGE-TEXT (1)19460000
194700            SET DP013-LOGIC-ABEND        TO TRUE                  19470000
194800            SET DP013-ROLLBACK           TO TRUE                  19480000
194900            PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                19490000
195000     END-EVALUATE.                                                19500000
195100                                                                  19510000
195200                                                                  19520000
195300 2110-RECEIVE-SCREEN-FIELDS.                                      19530000
195400                                                                  19540000
195500     IF  ACARTNL > ZERO                                           19550000
195600         MOVE ACARTNI TO PV-CTN                                   19560000
195700     ELSE                                                         19570000
195800         IF ACARTNA = DP015-ERASE-EOF                             19580000
195900             MOVE SPACES TO PV-CTN                                19590000
196000         END-IF                                                   19600000
196100     END-IF.                                                      19610000
196200                                                                  19620000
196300                                                                  19630000
196400                                                                  19640000
196500 2200-EDIT-INPUT.                                                 19650000
196600                                                                  19660000
196700     PERFORM 2210-INIT-ATTR.                                      19670000
196800     PERFORM 2230-EDIT-CTN.                                       19680000
196900                                                                  19690000
197000                                                                  19700000
197100 2210-INIT-ATTR.                                                  19710000
197200                                                                  19720000
197300     MOVE DP015-UNP-ALP-NOR-MDT      TO ACARTNA.                  19730000
197400                                                                  19740000
197500     MOVE PV-PO-RCVR     TO APORCVRO.                             19750000
197600     MOVE PV-STORE       TO ASTRO.                                19760000
197700     MOVE PV-CTN         TO ACARTNO.                              19770000
197800     MOVE PV-PO-LINE-OUT TO ALNEO.                                19780000
197900     MOVE PV-SKU-OUT     TO AITEMO.                               19790000
198000     MOVE SU001-AUDIT-CNTL-NBR TO PV-AUDIT-CNTL-NBR.              19800001
198100     MOVE PV-AUDIT-CNTL-NBR   TO ACNTLO.                          19810001
198200     MOVE SPACES         TO AMSGLNO.                              19820000
198300                                                                  19830000
198400                                                                  19840000
198500 2230-EDIT-CTN.                                                   19850000
198600     MOVE 0 TO PV-CHAR-COUNT.                                     19860000
198700     SET SU001-GOOD-CHECK-DIGIT TO TRUE.                          19870000
198800     INSPECT PV-CTN TALLYING PV-CHAR-COUNT FOR CHARACTERS         19880000
198900                 BEFORE INITIAL SPACE.                            19890000
199000     EVALUATE TRUE                                                19900000
199100         WHEN PV-CTN = SPACES                                     19910000
199200             SET PS-INVALID-INPUT        TO TRUE                  19920000
199300             MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA               19930000
199400             MOVE -1                     TO ACARTNL               19940000
199500             MOVE PC-PLS-ENT-FLD-MSG     TO AMSGLNO               19950000
199600         WHEN PV-CHAR-COUNT < PC-18                               19960000
199700             SET PS-INVALID-INPUT        TO TRUE                  19970000
199800             MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA               19980000
199900             MOVE -1                     TO ACARTNL               19990000
200000             MOVE PC-MORE-DIGITS-REQD    TO AMSGLNO               20000000
200100         WHEN OTHER                                               20010000
200200             SET DP010I-NEGATIVE-NOT-ALLOWED                      20020000
200300                 PS-NOT-SCANNED-DATA TO TRUE                      20030000
200400             IF PV-CHAR-COUNT = PC-18                             20040000
200500                 MOVE PV-CTN-LAST-17      TO DP010I-UNEDITED-FIELD20050000
200600             ELSE                                                 20060000
200700                 IF PV-CHAR-COUNT < PC-18                         20070000
200800                     MOVE PV-CTN          TO DP010I-UNEDITED-FIELD20080000
200900                 ELSE                                             20090000
201000                     MOVE PV-CTN-SCAN-LAST-17                     20100000
201100                                          TO DP010I-UNEDITED-FIELD20110000
201200                     SET PS-SCANNED-DATA TO TRUE                  20120000
201300                 END-IF                                           20130000
201400             END-IF                                               20140000
201500             MOVE 17     TO DP010I-MAXIMUM-DIGITS                 20150000
201600             MOVE 0      TO DP010I-MAXIMUM-DECIMALS               20160000
201700                                                                  20170000
263968             CALL DP010I-NUMERIC-EDIT-ROUTINE                     20181091
263968                  USING DP010I-NUMERIC-EDIT-AREA                  20182091
201900                                                                  20190000
202000             IF  DP010I-ERROR-DETECTED                            20200000
202100                 SET PS-INVALID-INPUT        TO TRUE              20210000
202200                 MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA           20220000
202300                 MOVE -1                     TO ACARTNL           20230000
202400                 MOVE PC-MUST-BE-NUM-MSG     TO AMSGLNO           20240000
202500             ELSE                                                 20250000
202600                 IF DP010I-NUMERIC-FIELD = ZEROES                 20260000
202700                     SET PS-INVALID-INPUT        TO TRUE          20270000
202800                     MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTNA       20280000
202900                     MOVE -1                     TO ACARTNL       20290000
203000                     MOVE PC-MUST-BE-GT-0-MSG    TO AMSGLNO       20300000
203100                 ELSE                                             20310000
203200                     MOVE  SPACES  TO  SU001-NOT-FOUND-IND        20320000
203300                                       SU001-MISDIRECT-IND        20330000
203400                                       SU001-FREE-ASTRAY-IND      20340000
203500                                       SU001-SHPUNT-NOT-FND-IND   20350000
203600                                       SU001-WRONG-FCLTY-IND      20360000
203700                      COMPUTE SU001-CARTON      ROUNDED =         20370000
203800                        DP010I-NUM-FIELD-17-DIG-0-DEC * 1         20380000
203900                      COMPUTE PV-CTN-N          ROUNDED =         20390000
204000                        DP010I-NUM-FIELD-17-DIG-0-DEC * 1         20400000
204100                      SET PS-NOT-TRNGLE-TRANS   TO TRUE           20410000
204200                      EVALUATE TRUE                               20420000
204300                         WHEN PV-CHAR-COUNT = PC-20               20430000
204400                               MOVE PV-CTN-SCAN-LAST-18 TO        20440000
204500                                                   PV-CTN-N       20450000
204600                                                   SU001-CARTON   20460000
204700                         WHEN PV-CHAR-COUNT = PC-18               20470000
204800                               MOVE PV-CTN  TO PV-CTN-N           20480000
204900                               MOVE PV-CTN-N TO SU001-CARTON      20490000
205000                      END-EVALUATE                                20500000
205100                     MOVE PV-CTN-N              TO ACARTNO        20510000
205200                     IF  SU001-BATCH-PRINTER OR                   20520000
205300                                     SU001-PRINT-AND-PEEL         20530000
205400                         IF  SU001-BATCH-NUMBER = ZEROES          20540000
205500                             PERFORM 2400-GET-BATCH-NUMBER        20550000
205600                             ADD  1  TO  PV-MAX-USER-BATCH        20560000
205700                                 GIVING  SU001-BATCH-NUMBER       20570000
205800                         END-IF                                   20580000
205900                     END-IF                                       20590000
206000                     PERFORM 2240-CHECK-TABLES                    20600000
206100                 END-IF                                           20610000
206200             END-IF                                               20620000
206300     END-EVALUATE.                                                20630000
206400                                                                  20640000
206500                                                                  20650000
206600 2240-CHECK-TABLES.                                               20660000
206700                                                                  20670000
206800     INITIALIZE SU001-PREPK-ID.                                   20680000
206900                                                                  20690000
207000     MOVE PV-CTN-N  TO SHPUNT-SHIPT-UNT-ID                        20700000
207100                       SHUUPC-SHIPT-UNT-ID                        20710000
207200                       DK-CTN.                                    20720000
207300     PERFORM 2250-SELECT-SHPUNT.                                  20730000
207400     SET SU001-NOT-PACK-BY-STORE                                  20740000
207500         SU001-NOT-MULTI-LINE                                     20750000
207600         SU001-LINE-FND                                           20760000
207700         PS-MISDIRECT-PACK-BY-STORE-NO                            20770000
207800         PS-INACTV-PBS-CARTON-NO                                  20780000
207900         PS-NOT-INVALID-CRE-SOURCE                                20790000
208000         SU001-ECOMM-DC-REPURPOSE-NO                              20800000
208100         SU001-AUTO-VE-NO          TO TRUE                        20810000
208200                                                                  20820056
208300     IF XLT00010-LOC-TYP-CDE = 'DS'                               20830016
208400        SET SU001-PACK-BY-STORE TO TRUE                           20840016
208500        PERFORM 2265-CHECK-INACTV-PBS                             20850016
208600     END-IF                                                       20860016
208700                                                                  20870056
208800*       IF RFID CARTON EXISTS (CREATED IN SUKRF502)               20880050
208900        PERFORM 0510-CHECK-FOR-PRINT                              20890040
209000        PERFORM 0511-CHECK-IF-CARTON-PRINTED                      20900050
209010        IF  PS-CARTON-PRINTED                                     20901090
209020            PERFORM 0512-CHECK-IF-TLBPTDA-EXISTS                  20902090
209030        END-IF                                                    20903090
209100                                                                  20910056
209200*    CARTON PRINTED ALREADY - SECOND SCAN                         20920048
209300     IF PS-CARTON-PRINTED                                         20930048
209310        IF  PS-TLBPTDA-EXISTS-YES                                 20931090
209400            PERFORM 2255-SELECT-SHUUPC                            20940090
209500            PERFORM 2410-DETERMINE-RECEIVER                       20950090
209510        ELSE                                                      20951090
209520            SET PS-INVALID-INPUT                                  20952090
209530                PS-NO-TLBPTDA                                     20953090
209540                SU001-NOT-FOUND            TO TRUE                20954090
209550        END-IF                                                    20955090
209600     ELSE                                                         20960048
209700         IF PS-CARTON-EXISTS                                      20970048
209800            PERFORM 2255-SELECT-SHUUPC                            20980048
209900            PERFORM 2410-DETERMINE-RECEIVER                       20990048
210000            PERFORM 3655-REPRINT-LABELS                           21000048
210100         ELSE                                                     21010048
210200            SET PS-INVALID-INPUT                                  21020048
210300                PS-NOT-FOUND                                      21030048
210400                SU001-NOT-FOUND            TO TRUE                21040048
210500         END-IF                                                   21050048
210600     END-IF.                                                      21060048
210700                                                                  21070000
210800 2250-SELECT-SHPUNT.                                              21080000
210900                                                                  21090000
211000     EXEC SQL                                                     21100000
211100         SELECT ORGN_OPER_UNT_ID,                                 21110000
211200                DEST_OPER_UNT_ID,                                 21120000
211300                SHIPT_UNT_SRC_ID,                                 21130000
211400                ACTV_IND                                          21140000
211500         INTO   :SHPUNT-ORGN-OPER-UNT-ID,                         21150000
211600                :SHPUNT-DEST-OPER-UNT-ID,                         21160000
211700                :SHPUNT-SHIPT-UNT-SRC-ID,                         21170000
211800                :SHPUNT-ACTV-IND                                  21180000
211900         FROM   TSHPUNT                                           21190000
212000         WHERE  SHIPT_UNT_ID   = :SHPUNT-SHIPT-UNT-ID             21200000
212100     END-EXEC.                                                    21210000
212200                                                                  21220000
212300     EVALUATE TRUE                                                21230000
212400         WHEN SQLCODE = ZERO                                      21240000
212500            IF SHPUNT-ACTV-IND = 'I'                              21250000
212600               SET PS-INACTV-CRTN-FND                             21260000
212700                   PS-CARTON-DOESNT-EXIST TO TRUE                 21270000
212800            ELSE                                                  21280000
212900              SET PS-CARTON-EXISTS TO TRUE                        21290000
213000            END-IF                                                21300000
213100                                                                  21310000
213200            IF SHPUNT-DEST-OPER-UNT-ID = 0                        21320000
213300                  MOVE SHPUNT-ORGN-OPER-UNT-ID TO                 21330000
213400                                        SHPUNT-DEST-OPER-UNT-ID   21340000
213500                                        PV-STORE                  21350000
213600                                        SU001-STORE               21360000
213700            ELSE                                                  21370000
213800                  MOVE SHPUNT-DEST-OPER-UNT-ID TO PV-STORE        21380000
213900                                                  SU001-STORE     21390000
214000            END-IF                                                21400000
214100            MOVE SHPUNT-ORGN-OPER-UNT-ID TO                       21410000
214200                                      SU001-ORIGIN-OPER-UNT-ID    21420000
214300            PERFORM 0500-CHECK-IF-DC                              21430000
214400         WHEN SQLCODE = +100                                      21440000
214500              SET PS-CARTON-DOESNT-EXIST TO TRUE                  21450000
214600              MOVE ZEROES TO SU001-PO                             21460000
214700                             SU001-RCVR-SEQ-NBR                   21470000
214800                             SU001-PO-LINE-NBR                    21480000
214900         WHEN SQLWARN0 NOT = SPACES                               21490000
215000         WHEN SQLCODE NOT EQUAL ZERO                              21500000
215100             MOVE '2250-SELECT-SHPUNT'                            21510000
215200                             TO DP013-PARAGRAPH                   21520000
215300             MOVE 'SUKRF706 - CHECK VALID CARTON'                 21530000
215400                             TO DP013-MESSAGE-TEXT(1)             21540000
215500             MOVE SHPUNT-SHIPT-UNT-ID                             21550000
215600                             TO DP013-MESSAGE-TEXT(2)             21560000
215700             MOVE SQLCA      TO DP013-SQLCA                       21570000
215800             MOVE 'TSHPUNT'  TO DP013-DB2-TABLE-NAME(1)           21580000
215900             SET DP013-DB2-ABEND                                  21590000
216000                             TO TRUE                              21600000
216100             SET DP013-ROLLBACK                                   21610000
216200                             TO TRUE                              21620000
216300             SET DP013-XCTL-DISPLAY-RESTART                       21630000
216400                             TO TRUE                              21640000
216500             PERFORM DP014-0000-PROCESS-ABEND                     21650000
216600     END-EVALUATE.                                                21660000
216700                                                                  21670000
216800                                                                  21680000
216900 2255-SELECT-SHUUPC.                                              21690000
217000                                                                  21700000
217100     EXEC SQL                                                     21710000
217200         SELECT DISTINCT                                          21720000
217300                TRN_NBR                                           21730000
217400              , TRN_LNE_NBR                                       21740000
217500         INTO   :SHUUPC-TRN-NBR                                   21750000
217600              , :SHUUPC-TRN-LNE-NBR                               21760000
217700         FROM   TSHUUPC                                           21770000
217800         WHERE  SHIPT_UNT_ID   = :SHPUNT-SHIPT-UNT-ID             21780000
217900     END-EXEC.                                                    21790000
218000*                                                                 21800000
218100     EVALUATE TRUE                                                21810000
218200         WHEN SQLCODE = ZERO                                      21820000
218300             MOVE SHUUPC-TRN-NBR     TO SU001-PO                  21830000
218400                                        PV-PO-N                   21840000
218500             MOVE SHUUPC-TRN-LNE-NBR TO SU001-PO-LINE-NBR         21850000
218600                                        PV-PO-LINE-N              21860000
218700                                        DK-PO-LNE-NBR             21870000
218800         WHEN SQLCODE = -811                                      21880000
218900             MOVE SHUUPC-TRN-NBR     TO SU001-PO                  21890000
219000             MOVE SHUUPC-TRN-LNE-NBR TO SU001-PO-LINE-NBR         21900000
219100             SET  SU001-MULTI-LINE   TO TRUE                      21910000
219200         WHEN SQLCODE = +100                                      21920000
219300             SET  SU001-NO-LINE           TO  TRUE                21930000
219400         WHEN SQLWARN0 NOT = SPACES                               21940000
219500         WHEN SQLCODE NOT EQUAL ZERO                              21950000
219600             MOVE '2255-SELECT-SHUUPC'                            21960000
219700                             TO DP013-PARAGRAPH                   21970000
219800             MOVE 'SUKRF706 - GET PO NBR        '                 21980000
219900                             TO DP013-MESSAGE-TEXT(1)             21990000
220000             MOVE SHPUNT-SHIPT-UNT-ID                             22000000
220100                             TO DP013-MESSAGE-TEXT(2)             22010000
220200             MOVE SQLCA      TO DP013-SQLCA                       22020000
220300             MOVE 'TSHUUPC'  TO DP013-DB2-TABLE-NAME(1)           22030000
220400             SET DP013-DB2-ABEND                                  22040000
220500                             TO TRUE                              22050000
220600             SET DP013-ROLLBACK                                   22060000
220700                             TO TRUE                              22070000
220800             SET DP013-XCTL-DISPLAY-RESTART                       22080000
220900                             TO TRUE                              22090000
221000             PERFORM DP014-0000-PROCESS-ABEND                     22100000
221100     END-EVALUATE.                                                22110000
221200                                                                  22120000
221300                                                                  22130000
221400 2260-SELECT-TSHUNLO.                                             22140000
221500                                                                  22150000
221600     INITIALIZE PV-DB2-COUNT.                                     22160000
221700                                                                  22170000
221800     EXEC SQL                                                     22180000
221900         SELECT  TRIP_ID                                          22190000
222000         INTO   :SHUNLO-TRIP-ID                                   22200000
222100         FROM   TSHUNLO                                           22210000
222200         WHERE  SHIPT_UNT_ID   = :SHPUNT-SHIPT-UNT-ID             22220000
222300           AND  SCN_LOC_ID     = :PC-RECV                         22230000
222400     END-EXEC.                                                    22240000
222500                                                                  22250000
222600     EVALUATE TRUE                                                22260000
222700         WHEN SQLCODE = ZERO                                      22270000
222800         WHEN SQLCODE = -811                                      22280000
222900              MOVE +1 TO PV-DB2-COUNT                             22290000
223000         WHEN SQLCODE = +100                                      22300000
223100              CONTINUE                                            22310000
223200         WHEN SQLWARN0 NOT = SPACES                               22320000
223300         WHEN SQLCODE NOT EQUAL ZERO                              22330000
223400             MOVE '2260-SELECT-TSHUNLO'                           22340000
223500                             TO DP013-PARAGRAPH                   22350000
223600             MOVE 'SUKRF706 - CHECK VALID CARTON'                 22360000
223700                             TO DP013-MESSAGE-TEXT(1)             22370000
223800             MOVE SHPUNT-SHIPT-UNT-ID                             22380000
223900                             TO DP013-MESSAGE-TEXT(2)             22390000
224000             MOVE SQLCA      TO DP013-SQLCA                       22400000
224100             MOVE 'TSHUNLO'  TO DP013-DB2-TABLE-NAME(1)           22410000
224200             SET DP013-DB2-ABEND                                  22420000
224300                             TO TRUE                              22430000
224400             SET DP013-ROLLBACK                                   22440000
224500                             TO TRUE                              22450000
224600             SET DP013-XCTL-DISPLAY-RESTART                       22460000
224700                             TO TRUE                              22470000
224800             PERFORM DP014-0000-PROCESS-ABEND                     22480000
224900     END-EVALUATE.                                                22490000
225000                                                                  22500000
225100                                                                  22510000
225200 2265-CHECK-INACTV-PBS.                                           22520000
225300                                                                  22530000
225400                                                                  22540000
225500     EXEC SQL                                                     22550000
225600         SELECT  CRE_TMST                                         22560000
225700               , SCN_LOC_ID                                       22570000
225800         INTO   :PV-TSHUNLO-PBS-CRE-TMST :PV-NULL-CRE-TMST        22580000
225900               ,:PV-PBS-SCN-LOC-ID                                22590000
226000         FROM   TSHUNLO                                           22600000
226100         WHERE  SHIPT_UNT_ID   = :SHPUNT-SHIPT-UNT-ID             22610000
226200           AND  SCN_LOC_ID                                        22620000
226300                       IN ('PBSA','PBSB','PBSC','PBSD','PBSE')    22630000
226400     END-EXEC.                                                    22640000
226500                                                                  22650000
226600     EVALUATE TRUE                                                22660000
226700         WHEN SQLCODE = ZERO                                      22670000
226800         WHEN SQLCODE = -811                                      22680000
226900             IF PV-NULL-CRE-TMST = -1                             22690000
227000                SET PS-INACTV-PBS-CARTON-NO TO TRUE               22700000
227100             ELSE                                                 22710000
227200                SET PS-INACTV-PBS-CARTON-YES TO TRUE              22720000
227300                MOVE PV-TSHUNLO-PBS-CRE-TMST TO                   22730000
227400                                            PV-TSHUNLO-PBS-TMST-R 22740000
227500                MOVE SPACES          TO PV-PBS-TMST-SPACE         22750000
227600                                        PV-PBS-TMST-SPACE-2       22760000
227700                MOVE PC-COLON        TO PV-PBS-TMST-COLON         22770000
227800             END-IF                                               22780000
227900         WHEN SQLCODE = +100                                      22790000
228000                SET PS-INACTV-PBS-CARTON-NO TO TRUE               22800000
228100         WHEN SQLWARN0 NOT = SPACES                               22810000
228200         WHEN SQLCODE NOT EQUAL ZERO                              22820000
228300             MOVE '2265-CHECK-INACTV-PBS'                         22830000
228400                             TO DP013-PARAGRAPH                   22840000
228500             MOVE 'SUKRF706 - CHECK INACTV CARTON'                22850000
228600                             TO DP013-MESSAGE-TEXT(1)             22860000
228700             MOVE SHPUNT-SHIPT-UNT-ID                             22870000
228800                             TO DP013-MESSAGE-TEXT(2)             22880000
228900             MOVE SQLCA      TO DP013-SQLCA                       22890000
229000             MOVE 'TSHUNLO'  TO DP013-DB2-TABLE-NAME(1)           22900000
229100             SET DP013-DB2-ABEND                                  22910000
229200                             TO TRUE                              22920000
229300             SET DP013-ROLLBACK                                   22930000
229400                             TO TRUE                              22940000
229500             SET DP013-XCTL-DISPLAY-RESTART                       22950000
229600                             TO TRUE                              22960000
229700             PERFORM DP014-0000-PROCESS-ABEND                     22970000
229800     END-EVALUATE.                                                22980000
229900                                                                  22990000
230000                                                                  23000000
230100******************************************************************23010000
230200 2280-SELECT-STORE-FROM-XREF.                                     23020000
230300******************************************************************23030000
230400                                                                  23040000
230500                                                                  23050000
230600     EXEC SQL                                                     23060000
230700         SELECT  DEST_OPER_UNT_ID                                 23070000
230800         INTO   :SULBXF-DEST-OPER-UNT-ID                          23080000
230900         FROM   TSULBXF                                           23090000
231000         WHERE  SHIPT_UNT_ID   = :DK-CTN                          23100000
231100           AND  STAT_CDE       = 'A'                              23110000
231200     END-EXEC.                                                    23120000
231300                                                                  23130000
231400     EVALUATE TRUE                                                23140000
231500         WHEN SQLCODE = ZERO                                      23150000
231600         WHEN SQLCODE = -811                                      23160000
231700             MOVE SULBXF-DEST-OPER-UNT-ID TO SU001-STORE          23170000
231800             SET PS-SULBXF-ROW-FOUND TO TRUE                      23180000
231900         WHEN SQLCODE = +100                                      23190000
232000             SET PS-NO-SULBXF-ROW-FOUND TO TRUE                   23200000
232100         WHEN SQLWARN0 NOT = SPACES                               23210000
232200         WHEN SQLCODE NOT EQUAL ZERO                              23220000
232300             MOVE '2280-SELECT-STORE-FROM-XREF'                   23230000
232400                             TO DP013-PARAGRAPH                   23240000
232500             MOVE 'SUKRF706 - CHECK VALID CARTON'                 23250000
232600                             TO DP013-MESSAGE-TEXT(1)             23260000
232700             MOVE SHPUNT-SHIPT-UNT-ID                             23270000
232800                             TO DP013-MESSAGE-TEXT(2)             23280000
232900             MOVE SQLCA      TO DP013-SQLCA                       23290000
233000             MOVE 'TSULBXF'  TO DP013-DB2-TABLE-NAME(1)           23300000
233100             SET DP013-DB2-ABEND                                  23310000
233200                             TO TRUE                              23320000
233300             SET DP013-ROLLBACK                                   23330000
233400                             TO TRUE                              23340000
233500             SET DP013-XCTL-DISPLAY-RESTART                       23350000
233600                             TO TRUE                              23360000
233700             PERFORM DP014-0000-PROCESS-ABEND                     23370000
233800     END-EVALUATE.                                                23380000
233900                                                                  23390000
234000                                                                  23400000
234100                                                                  23410000
234200 2285-CALL-DLKUP001-ASGMT-MOD.                                    23420000
234300                                                                  23430000
234400     INITIALIZE DL001-ASGMT-COMMAREA.                             23440000
234500     SET DL001-BY-ASGMT-KEY                                       23450000
234600         DL001-COMMIT-UPDATE                                      23460000
234700         DL001-FIND-NEXT-ASGMT    TO TRUE.                        23470000
234800     MOVE SU001-ASGMT-STRT-DTE    TO DL001-KEY-START-DTE.         23480000
234900     MOVE SU001-ASGMT-NBR-TXT     TO DL001-KEY-NBR-TXT.           23490000
235000     MOVE SU001-ASGMT-NBR-SEQ-NBR TO DL001-KEY-NBR-SEQ-NBR.       23500000
235100     MOVE +1                      TO DL001-NBR-OF-NBRS-NEED-QTY.  23510000
235200     MOVE PC-CURRENT-PROGRAM-NAME TO DL001-ORIG-CALLING-PGM-NM.   23520000
235300                                                                  23530000
235400     CALL DL001-USER-PGM USING DFHEIBLK                           23540000
235500                              DL001-COMMAREA                      23550000
235600                              DL001-ASGMT-COMMAREA.               23560000
235700                                                                  23570000
235800     EVALUATE TRUE                                                23580000
235900         WHEN DL001-SUCCESSFUL                                    23590000
236000              MOVE DL001-SEQ-START-NBR                            23600000
236100                                   TO SU001-SEQ-START-NBR         23610000
236200              IF DL001-ASGMT-NEXT-USED                            23620000
236300                 MOVE DL001-NXT-START-DTE                         23630000
236400                               TO SU001-ASGMT-STRT-DTE            23640000
236500                 MOVE DL001-NXT-NBR-TXT                           23650000
236600                               TO SU001-ASGMT-NBR-TXT             23660000
236700                 MOVE DL001-NXT-NBR-SEQ-NBR                       23670000
236800                               TO SU001-ASGMT-NBR-SEQ-NBR         23680000
236900                 PERFORM 2286-CALL-DLKUT001                       23690000
237000                 IF DL003-ASGMT-FOUND                             23700000
237100                     CONTINUE                                     23710000
237200                 ELSE                                             23720000
237300                     SET SU001-ASGMT-CLOSED-RETURN TO TRUE        23730000
237400                     MOVE SPACES TO SU001-ASGMT-STRT-DTE          23740000
237500                     MOVE PC-SU-MESSAGE-PGM                       23750000
237600                                   TO PV-TRANSFER-PROGRAM         23760000
237700                     PERFORM 4000-XCTL-LRT-MENU                   23770000
237800                 END-IF                                           23780000
237900              END-IF                                              23790000
238000         WHEN DL001-ASGMT-CLOSED-RETURN                           23800000
238100              SET SU001-ASGMT-CLOSED-RETURN TO TRUE               23810000
238200              MOVE SPACES TO SU001-ASGMT-STRT-DTE                 23820000
238300              MOVE PC-SU-MESSAGE-PGM                              23830000
238400                                  TO PV-TRANSFER-PROGRAM          23840000
238500              PERFORM 4000-XCTL-LRT-MENU                          23850000
238600         WHEN OTHER                                               23860000
238700              SET PV-DONE-PROCESSING          TO TRUE             23870000
238800              MOVE DL001-RETURN-SQLCODES TO PV-SQLCODE            23880000
238900              STRING ' SUKRF706 (OTHER) -' DELIMITED BY SIZE      23890000
239000               '2285-CALL-DLKUP001-ASGMT ' DELIMITED BY SIZE      23900000
239100                     'DL001-RETURN-CODE-'  DELIMITED BY SIZE      23910000
239200                     DL001-RETURN-CODE     DELIMITED BY SIZE      23920000
239300                     'DL-RETURN-SQLCODES ' DELIMITED BY SIZE      23930000
239400                       PV-SQLCODE          DELIMITED BY SIZE      23940000
239500                                      INTO PV-CICS-MSG-AREA       23950000
239600              MOVE LENGTH OF PV-CICS-MSG-AREA                     23960000
239700                                        TO PV-COMMAREA-LENGTH     23970000
239800              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              23980000
239900                                                                  23990000
240000              MOVE  '2285-CALL-DLKUP001-ASGMT '                   24000000
240100                              TO DP013-PARAGRAPH                  24010000
240200              MOVE 'CALL TO DLKUP001'                             24020000
240300                              TO DP013-MESSAGE-TEXT(1)            24030000
240400              MOVE 'CHECK CSSL FOR MORE DETAIL     '              24040000
240500                                TO DP013-MESSAGE-TEXT (2)         24050000
240600              MOVE SU001-MANIFEST TO  PV-DISPLAY-MANIFEST         24060000
240700              MOVE SU001-CARTON   TO  PV-DISPLAY-CARTON           24070000
240800              MOVE SU001-STORE    TO  PV-DISPLAY-STORE            24080000
240900              STRING ' TRIP - '           DELIMITED BY SIZE       24090000
241000                     PV-DISPLAY-MANIFEST  DELIMITED BY SIZE       24100000
241100                     '  CARTON - '        DELIMITED BY SIZE       24110000
241200                     PV-DISPLAY-CARTON    DELIMITED BY SIZE       24120000
241300                     '  STORE - '         DELIMITED BY SIZE       24130000
241400                     PV-DISPLAY-STORE     DELIMITED BY SIZE       24140000
241500                              INTO DP013-MESSAGE-TEXT (3)         24150000
241600              STRING ' SUKRF706 (OTHER) -' DELIMITED BY SIZE      24160000
241700               '2285-CALL-DLKUP001-ASGMT ' DELIMITED BY SIZE      24170000
241800                     'DL001-RETURN-CODE-'  DELIMITED BY SIZE      24180000
241900                     DL001-RETURN-CODE     DELIMITED BY SIZE      24190000
242000                     'DL-RETURN-SQLCODES ' DELIMITED BY SIZE      24200000
242100                       PV-SQLCODE          DELIMITED BY SIZE      24210000
242200                              INTO DP013-MESSAGE-TEXT (4)         24220000
242300              MOVE DL001-SQLCA    TO DP013-SQLCA                  24230000
242400              SET DP013-DB2-ABEND                                 24240000
242500                              TO TRUE                             24250000
242600              SET DP013-ROLLBACK                                  24260000
242700                              TO TRUE                             24270000
242800              SET DP013-XCTL-DISPLAY-RESTART                      24280000
242900                              TO TRUE                             24290000
243000              PERFORM DP014-0000-PROCESS-ABEND                    24300000
243100     END-EVALUATE.                                                24310000
243200                                                                  24320000
243300*-----------------------------------------------------------------24330000
243400*  CALL DLKUT001 TO DETERMINE IF THE REQUESTED ASSOCIATE IS      *24340000
243500*  CURRENTLY ACTIVE ON AN ACTIVE ASSIGNMENT.                     *24350000
243600*-----------------------------------------------------------------24360000
243700 2286-CALL-DLKUT001.                                              24370000
243800                                                                  24380000
243900     INITIALIZE  DL003-ASGMT-COMMAREA.                            24390000
244000                                                                  24400000
244100     MOVE SU001-USER-ID             TO DL003-KEY-USER-ID.         24410000
244200     MOVE PC-CURRENT-PROGRAM-NAME   TO DL003-ORIG-CALLING-PGM-NM. 24420000
244300     SET DL003-BY-USER-KEY TO TRUE.                               24430000
244400                                                                  24440000
244500     CALL DL003-USER-PGM USING DFHEIBLK                           24450000
244600                               DL003-COMMAREA                     24460000
244700                               DL003-ASGMT-COMMAREA.              24470000
244800                                                                  24480000
244900     EVALUATE TRUE                                                24490000
245000         WHEN DL003-SUCCESSFUL                                    24500000
245100             CONTINUE                                             24510000
245200         WHEN OTHER                                               24520000
245300              SET PV-DONE-PROCESSING          TO TRUE             24530000
245400              MOVE DL001-RETURN-SQLCODES TO PV-SQLCODE            24540000
245500              STRING ' SUKRF706 (OTHER) -' DELIMITED BY SIZE      24550000
245600               '2286-CALL-DLKUT001-ASGMT ' DELIMITED BY SIZE      24560000
245700                     'DL003-RETURN-CODE-'  DELIMITED BY SIZE      24570000
245800                     DL003-RETURN-CODE     DELIMITED BY SIZE      24580000
245900                     'DL-RETURN-SQLCODES ' DELIMITED BY SIZE      24590000
246000                       PV-SQLCODE          DELIMITED BY SIZE      24600000
246100                                      INTO PV-CICS-MSG-AREA       24610000
246200              MOVE LENGTH OF PV-CICS-MSG-AREA                     24620000
246300                                        TO PV-COMMAREA-LENGTH     24630000
246400              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              24640000
246500                                                                  24650000
246600              MOVE  '2286-CALL-DLKUT001-ASGMT '                   24660000
246700                              TO DP013-PARAGRAPH                  24670000
246800              MOVE 'CALL TO DLKUT001'                             24680000
246900                              TO DP013-MESSAGE-TEXT(1)            24690000
247000              MOVE 'CHECK CSSL FOR MORE DETAIL     '              24700000
247100                                TO DP013-MESSAGE-TEXT (2)         24710000
247200              MOVE SU001-MANIFEST TO  PV-DISPLAY-MANIFEST         24720000
247300              MOVE SU001-CARTON   TO  PV-DISPLAY-CARTON           24730000
247400              MOVE SU001-STORE    TO  PV-DISPLAY-STORE            24740000
247500              STRING ' TRIP - '           DELIMITED BY SIZE       24750000
247600                     PV-DISPLAY-MANIFEST  DELIMITED BY SIZE       24760000
247700                     '  CARTON - '        DELIMITED BY SIZE       24770000
247800                     PV-DISPLAY-CARTON    DELIMITED BY SIZE       24780000
247900                     '  STORE - '         DELIMITED BY SIZE       24790000
248000                     PV-DISPLAY-STORE     DELIMITED BY SIZE       24800000
248100                              INTO DP013-MESSAGE-TEXT (3)         24810000
248200              STRING ' SUKRF706 (OTHER) -' DELIMITED BY SIZE      24820000
248300               '2286-CALL-DLKUT001-ASGMT ' DELIMITED BY SIZE      24830000
248400                     'DL003-RETURN-CODE-'  DELIMITED BY SIZE      24840000
248500                     DL003-RETURN-CODE     DELIMITED BY SIZE      24850000
248600                     'DL-RETURN-SQLCODES ' DELIMITED BY SIZE      24860000
248700                       PV-SQLCODE          DELIMITED BY SIZE      24870000
248800                              INTO DP013-MESSAGE-TEXT (4)         24880000
248900              MOVE DL001-SQLCA    TO DP013-SQLCA                  24890000
249000              SET DP013-DB2-ABEND                                 24900000
249100                              TO TRUE                             24910000
249200              SET DP013-ROLLBACK                                  24920000
249300                              TO TRUE                             24930000
249400              SET DP013-XCTL-DISPLAY-RESTART                      24940000
249500                              TO TRUE                             24950000
249600              PERFORM DP014-0000-PROCESS-ABEND                    24960000
249700     END-EVALUATE.                                                24970000
249800                                                                  24980000
249900                                                                  24990000
250000                                                                  25000000
250100                                                                  25010000
250200******************************************************************25020000
250300 2335-OPEN-ODD-UNITS-CSR.                                         25030000
250400     SET PS-NOT-ODD-UNT-CRTN-FOUND TO TRUE.                       25040000
250500     MOVE SU001-RCVR-SEQ-NBR  TO DK-REC-SEQ-NBR.                  25050000
250600                                                                  25060000
250700         EXEC SQL                                                 25070000
250800              OPEN ODD-UNITS-CSR                                  25080000
250900         END-EXEC                                                 25090000
251000                                                                  25100000
251100                                                                  25110000
251200         EVALUATE TRUE                                            25120000
251300             WHEN SQLCODE = ZERO                                  25130000
251400                 CONTINUE                                         25140000
251500             WHEN SQLWARN0 NOT = SPACES                           25150000
251600             WHEN SQLCODE < ZERO                                  25160000
251700             WHEN SQLCODE > ZERO                                  25170000
251800                 MOVE '2335-OPEN-ODD-UNITS-CSR'                   25180000
251900                                   TO DP013-PARAGRAPH             25190000
252000                 MOVE 'OPEN ODD UNITS CSR - '                     25200000
252100                                   TO DP013-MESSAGE-TEXT (1)      25210000
252200                 MOVE SQLCA        TO DP013-SQLCA                 25220000
252300                 MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (1)    25230000
252400                 SET DP013-DB2-ABEND                              25240000
252500                     DP013-XCTL-DISPLAY-RESTART TO TRUE           25250000
252600                 SET DP013-ROLLBACK                               25260000
252700                                   TO TRUE                        25270000
252800                 PERFORM DP014-0000-PROCESS-ABEND                 25280000
252900         END-EVALUATE.                                            25290000
253000                                                                  25300000
253100 EJECT                                                            25310000
253200*----------------------------------------------------------------*25320000
253300*                                                                *25330000
253400*----------------------------------------------------------------*25340000
253500 2340-FETCH-ODD-UNITS-CSR.                                        25350000
253600                                                                  25360000
253700                                                                  25370000
253800     EXEC SQL                                                     25380000
253900        FETCH   ODD-UNITS-CSR                                     25390000
254000        INTO   :PV-UNION-TYPE                                     25400000
254100              ,:PV-TRN-LNE-NBR                                    25410000
254200              ,:RECITM-PREPK-ID                                   25420000
254300     END-EXEC.                                                    25430000
254400* PREPACK SHOULD BE ON BOTH TSHUUPC('A' UNION) AND TRECITM('B')   25440000
254500* THE FETCH SHOULD ALWAYS RETURN AN ROW FROM 'A' FOLLOWED BY A    25450000
254600* ROW FROM 'B'                                                    25460000
254700                                                                  25470000
254800     EVALUATE TRUE                                                25480000
254900       WHEN SQLCODE = ZEROS                                       25490000
255000            SET PS-FOUND-ON-ODD-UNTS-CSR TO TRUE                  25500000
255100                                                                  25510000
255200            IF PS-FIRST-ODD-UNTS-FETCH                            25520000
255300* FIRST CARTON CANNOT BE A 'B'                                    25530000
255400               IF PV-UNION-TYPE = 'B'                             25540000
255500                  SET PS-ODD-UNT-CRTN-FOUND TO TRUE               25550000
255600                  PERFORM 5005-PRINT-MESSAGE-LABELS               25560000
255700               ELSE                                               25570000
255800                  MOVE PV-UNION-TYPE TO PV-PREV-FETCH             25580000
255900                  MOVE PV-TRN-LNE-NBR TO PV-PREV-LINE             25590000
256000                  SET PS-NOT-FIRST-ODD-UNTS-FETCH TO TRUE         25600000
256100               END-IF                                             25610000
256200            ELSE                                                  25620000
256300              IF PV-UNION-TYPE = PV-PREV-FETCH                    25630000
256400                 SET PS-ODD-UNT-CRTN-FOUND TO TRUE                25640000
256500                 PERFORM 5005-PRINT-MESSAGE-LABELS                25650000
256600              ELSE                                                25660000
256700                 IF PV-TRN-LNE-NBR = PV-PREV-LINE                 25670000
256800                     MOVE PV-UNION-TYPE  TO PV-PREV-FETCH         25680000
256900                     MOVE PV-TRN-LNE-NBR TO PV-PREV-LINE          25690000
257000                 ELSE                                             25700000
257100** CHECK CASE WHERE 'A' FOLLOWED BY 'B' ARE THE SAME LINE         25710000
257200** THE LINE NUMBER SHOULD ONLY CHANGE WHEN THE PREV-FETCH = 'B'   25720000
257300                     IF PV-PREV-FETCH = 'A'                       25730000
257400                        SET PS-ODD-UNT-CRTN-FOUND TO TRUE         25740000
257500                        PERFORM 5005-PRINT-MESSAGE-LABELS         25750000
257600                     ELSE                                         25760000
257700                        MOVE PV-UNION-TYPE  TO PV-PREV-FETCH      25770000
257800                        MOVE PV-TRN-LNE-NBR TO PV-PREV-LINE       25780000
257900                     END-IF                                       25790000
258000                 END-IF                                           25800000
258100              END-IF                                              25810000
258200            END-IF                                                25820000
258300                                                                  25830000
258400       WHEN SQLCODE = +100                                        25840000
258500                SET  PS-EO-ODD-UNTS-CSR  TO TRUE                  25850000
258600*CHECK TO SEE IF LAST PREPACK IS AN 'A' WITH NO 'B'               25860000
258700                IF PV-UNION-TYPE  = 'A'                           25870000
258800                   SET PS-ODD-UNT-CRTN-FOUND TO TRUE              25880000
258900                   PERFORM 5005-PRINT-MESSAGE-LABELS              25890000
259000                END-IF                                            25900000
259100       WHEN OTHER                                                 25910000
259200             MOVE '2340-FETCH-ODD-UNITS-CSR'                      25920000
259300                             TO DP013-PARAGRAPH                   25930000
259400             MOVE 'SUKRF706 - CHECK FOR NOT FOUND       '         25940000
259500                             TO DP013-MESSAGE-TEXT(1)             25950000
259600             MOVE SU001-PO                                        25960000
259700                             TO DP013-MESSAGE-TEXT(2)             25970000
259800             MOVE SU001-CARTON                                    25980000
259900                             TO DP013-MESSAGE-TEXT(3)             25990000
260000             MOVE SQLCA      TO DP013-SQLCA                       26000000
260100             MOVE 'TSHUUPC'  TO DP013-DB2-TABLE-NAME(1)           26010000
260200             SET DP013-DB2-ABEND                                  26020000
260300                             TO TRUE                              26030000
260400             SET DP013-ROLLBACK                                   26040000
260500                             TO TRUE                              26050000
260600             SET DP013-XCTL-DISPLAY-RESTART                       26060000
260700                             TO TRUE                              26070000
260800             PERFORM DP014-0000-PROCESS-ABEND                     26080000
260900     END-EVALUATE.                                                26090000
261000                                                                  26100000
261100                                                                  26110000
261200 2345-CLOSE-ODD-UNITS-CSR.                                        26120000
261300                                                                  26130000
261400         EXEC SQL                                                 26140000
261500             CLOSE ODD-UNITS-CSR                                  26150000
261600         END-EXEC                                                 26160000
261700                                                                  26170000
261800                                                                  26180000
261900         EVALUATE TRUE                                            26190000
262000             WHEN SQLCODE = ZERO                                  26200000
262100                 CONTINUE                                         26210000
262200             WHEN SQLWARN0 NOT = SPACES                           26220000
262300             WHEN SQLCODE < ZERO                                  26230000
262400             WHEN SQLCODE > ZERO                                  26240000
262500                 MOVE '2370-CLOSE-ODD-UNITS-CSR'                  26250000
262600                                   TO DP013-PARAGRAPH             26260000
262700                 MOVE 'CLOSE ODD UNITS CSR - '                    26270000
262800                                   TO DP013-MESSAGE-TEXT (1)      26280000
262900                 MOVE SQLCA        TO DP013-SQLCA                 26290000
263000                 MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (1)    26300000
263100                 SET DP013-DB2-ABEND                              26310000
263200                     DP013-XCTL-DISPLAY-RESTART TO TRUE           26320000
263300                 SET DP013-ROLLBACK                               26330000
263400                                   TO TRUE                        26340000
263500                 PERFORM DP014-0000-PROCESS-ABEND                 26350000
263600         END-EVALUATE.                                            26360000
263700                                                                  26370000
263800                                                                  26380000
263900 EJECT                                                            26390000
264000******************************************************************26400000
264100 2350-OPEN-PREPK-CSR.                                             26410000
264200                                                                  26420000
264300         EXEC SQL                                                 26430000
264400              OPEN PREPK-CSR                                      26440000
264500         END-EXEC                                                 26450000
264600                                                                  26460000
264700                                                                  26470000
264800         EVALUATE TRUE                                            26480000
264900             WHEN SQLCODE = ZERO                                  26490000
265000                 CONTINUE                                         26500000
265100             WHEN SQLWARN0 NOT = SPACES                           26510000
265200             WHEN SQLCODE < ZERO                                  26520000
265300             WHEN SQLCODE > ZERO                                  26530000
265400                 MOVE '2350-OPEN-PREPK-CSR'                       26540000
265500                                   TO DP013-PARAGRAPH             26550000
265600                 MOVE 'OPEN PREPK  CURSOR - '                     26560000
265700                                   TO DP013-MESSAGE-TEXT (1)      26570000
265800                 MOVE SQLCA        TO DP013-SQLCA                 26580000
265900                 MOVE 'TSHUUPC '   TO DP013-DB2-TABLE-NAME (1)    26590000
266000                 SET DP013-DB2-ABEND                              26600000
266100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           26610000
266200                 SET DP013-ROLLBACK                               26620000
266300                                   TO TRUE                        26630000
266400                 PERFORM DP014-0000-PROCESS-ABEND                 26640000
266500         END-EVALUATE.                                            26650000
266600                                                                  26660000
266700 EJECT                                                            26670000
266800*----------------------------------------------------------------*26680000
266900*                                                                *26690000
267000*----------------------------------------------------------------*26700000
267100 2360-FETCH-PREPK-CSR.                                            26710000
267200                                                                  26720000
267300     MOVE  SU001-CARTON TO DK-CTN.                                26730000
267400     MOVE  ZERO   TO    DK-PO-LNE-NBR.                            26740000
267500                                                                  26750000
267600     EXEC SQL                                                     26760000
267700        FETCH   PREPK-CSR                                         26770000
267800        INTO   :SHUUPC-TRN-NBR                                    26780000
267900              ,:DISTHD-ORD-LNE-NBR                                26790000
268000              ,:RECITM-PREPK-ID                                   26800000
268100              ,:RECITM-PREPK-RATO-QTY                             26810000
268200              ,:SHUUPC-SHPD-QTY                                   26820000
268300              ,:DISTHD-PREPK-LNE-PRC-CDE                          26830000
268400              ,:DISTHD-UCC128-DAT-USG-CDE                         26840000
268500              ,:DISTHD-PRC-AREA-MODU-ID                           26850000
268600     END-EXEC.                                                    26860000
268700                                                                  26870000
268800     EVALUATE TRUE                                                26880000
268900       WHEN SQLCODE = ZEROS                                       26890000
269000            SET PS-FOUND-ON-CURSOR TO TRUE                        26900000
269100            IF DISTHD-UCC128-DAT-USG-CDE  = 'U'                   26910000
269200               DIVIDE SHUUPC-SHPD-QTY BY RECITM-PREPK-RATO-QTY    26920000
269300                      GIVING PV-MULTIPLE REMAINDER PV-REMAINDER   26930000
269400               IF PV-REMAINDER = 0                                26940000
269500                  IF PS-FIRST-PREPK                               26950000
269600                     MOVE PV-MULTIPLE TO PV-HOLD-MULTIPLE         26960000
269700                     SET PS-NOT-FIRST-PREPK TO TRUE               26970000
269800                  END-IF                                          26980000
269900               ELSE                                               26990000
270000                  SET PS-ODD-UNT-CRTN-FOUND TO TRUE               27000000
270100                  PERFORM 5005-PRINT-MESSAGE-LABELS               27010000
270200               END-IF                                             27020000
270300               IF PV-MULTIPLE NOT EQUAL PV-HOLD-MULTIPLE          27030000
270400                  SET PS-ODD-UNT-CRTN-FOUND TO TRUE               27040000
270500                  PERFORM 5005-PRINT-MESSAGE-LABELS               27050000
270600               END-IF                                             27060000
270700            END-IF                                                27070000
270800                                                                  27080000
270900            IF DISTHD-PREPK-LNE-PRC-CDE  = 'D'                    27090000
271000               MOVE DISTHD-ORD-LNE-NBR  TO  SU001-PO-LINE-NBR     27100000
271100                                            PV-PO-LINE-N          27110000
271200               PERFORM  7230-GET-DEPT-CL-SKU                      27120000
271300               PERFORM  7235-GET-OUTER-PACK                       27130000
271400***PV-OUTR-PACK-QTY POPULATES TLBPTDA AND DK-OUTER-QTY            27140000
271500***IS THE DRIVER LINE SHP-QTY USED IN SQL                         27150000
271600               MOVE SHUUPC-SHPD-QTY     TO  DK-OUTER-QTY          27160000
271700            END-IF                                                27170000
271800                                                                  27180000
271900            SET  SU001-MULTI-LINE    TO  TRUE                     27190000
272000            MOVE SHUUPC-TRN-NBR      TO  SU001-PO                 27200000
272100            MOVE RECITM-PREPK-ID     TO  SU001-PREPK-ID           27210000
272200                                         PV-PO-LINE-N             27220000
272300                                         DK-PREPK-ID              27230000
272400       WHEN SQLCODE = +100                                        27240000
272500                SET  PS-EO-PREPK-CSR TO TRUE                      27250000
272600       WHEN OTHER                                                 27260000
272700             MOVE '2360-FETCH-PREPK-CSR '                         27270000
272800                             TO DP013-PARAGRAPH                   27280000
272900             MOVE 'SUKRF706 - CHECK FOR NOT FOUND       '         27290000
273000                             TO DP013-MESSAGE-TEXT(1)             27300000
273100             MOVE SU001-PO                                        27310000
273200                             TO DP013-MESSAGE-TEXT(2)             27320000
273300             MOVE SU001-CARTON                                    27330000
273400                             TO DP013-MESSAGE-TEXT(3)             27340000
273500             MOVE SQLCA      TO DP013-SQLCA                       27350000
273600             MOVE 'TSHUUPC'  TO DP013-DB2-TABLE-NAME(1)           27360000
273700             SET DP013-DB2-ABEND                                  27370000
273800                             TO TRUE                              27380000
273900             SET DP013-ROLLBACK                                   27390000
274000                             TO TRUE                              27400000
274100             SET DP013-XCTL-DISPLAY-RESTART                       27410000
274200                             TO TRUE                              27420000
274300             PERFORM DP014-0000-PROCESS-ABEND                     27430000
274400     END-EVALUATE.                                                27440000
274500                                                                  27450000
274600                                                                  27460000
274700 2370-CLOSE-PREPK-CSR.                                            27470000
274800                                                                  27480000
274900         EXEC SQL                                                 27490000
275000             CLOSE PREPK-CSR                                      27500000
275100         END-EXEC                                                 27510000
275200                                                                  27520000
275300                                                                  27530000
275400         EVALUATE TRUE                                            27540000
275500             WHEN SQLCODE = ZERO                                  27550000
275600                 CONTINUE                                         27560000
275700             WHEN SQLWARN0 NOT = SPACES                           27570000
275800             WHEN SQLCODE < ZERO                                  27580000
275900             WHEN SQLCODE > ZERO                                  27590000
276000                 MOVE '2370-CLOSE-UNITS-CSR'                      27600000
276100                                   TO DP013-PARAGRAPH             27610000
276200                 MOVE 'CLOSE PREPK  CURSOR - '                    27620000
276300                                   TO DP013-MESSAGE-TEXT (1)      27630000
276400                 MOVE SQLCA        TO DP013-SQLCA                 27640000
276500                 MOVE 'TSHUUPC '   TO DP013-DB2-TABLE-NAME (1)    27650000
276600                 SET DP013-DB2-ABEND                              27660000
276700                     DP013-XCTL-DISPLAY-RESTART TO TRUE           27670000
276800                 SET DP013-ROLLBACK                               27680000
276900                                   TO TRUE                        27690000
277000                 PERFORM DP014-0000-PROCESS-ABEND                 27700000
277100         END-EVALUATE.                                            27710000
277200                                                                  27720000
277300                                                                  27730000
277400 2380-SELECT-PREPAK-INFO.                                         27740000
277500                                                                  27750000
277600     EXEC SQL                                                     27760000
277700          SELECT                                                  27770000
277800                 E.ORD_LNE_NBR                                    27780000
277900                ,D.PREPK_ID                                       27790000
278000          INTO  :DISTHD-ORD-LNE-NBR                               27800000
278100              , :RECITM-PREPK-ID                                  27810000
278200          FROM   TSHUUPC A                                        27820000
278300               , TINPKSU B                                        27830000
278400               , TPKSLIP C                                        27840000
278500               , TRECITM D                                        27850000
278600               , TDISTHD E                                        27860000
278700          WHERE A.SHIPT_UNT_ID = :DK-CTN                          27870000
278800          AND  A.SHIPT_UNT_ID = B.SHIPT_UNT_ID                    27880000
278900          AND  B.PO_NBR       = C.PO_NBR                          27890000
279000          AND  B.SEQ_NBR      = C.SEQ_NBR                         27900000
279100          AND  C.VER_STAT_CDE = 'A'                               27910000
279200          AND  C.PO_NBR       = D.ORD_NBR                         27920000
279300          AND  C.REC_SEQ_NBR  = D.REC_SEQ_NBR                     27930000
279400          AND  C.REC_SEQ_NBR  = :PV-RCVR-SEQ-NBR                  27940000
279500          AND  A.TRN_LNE_NBR  = D.ORD_LNE_NBR                     27950000
279600          AND  E.ORD_NBR      = C.PO_NBR                          27960000
279700          AND  E.RCVR_SEQ_NBR = C.REC_SEQ_NBR                     27970000
279800          AND  E.ORD_LNE_NBR  = D.ORD_LNE_NBR                     27980000
279900          AND  E.TOT_CART_CNT > 0                                 27990000
280000          AND  E.PREPK_LNE_PRC_CDE  = 'D'                         28000000
280100     END-EXEC                                                     28010000
280200                                                                  28020000
280300     EVALUATE TRUE                                                28030000
280400       WHEN SQLCODE = ZEROS                                       28040000
280500               MOVE DISTHD-ORD-LNE-NBR  TO  PV-DRIVER-LINE-NO     28050000
280600       WHEN SQLCODE = +100                                        28060000
280700               MOVE +0                  TO  PV-DRIVER-LINE-NO     28070000
280800                                            RECITM-PREPK-ID       28080000
280900       WHEN OTHER                                                 28090000
281000             MOVE '2380-SELECT-PREPAK-INFO'                       28100000
281100                             TO DP013-PARAGRAPH                   28110000
281200             MOVE 'SUKRF706 - GET PREPACK INFO          '         28120000
281300                             TO DP013-MESSAGE-TEXT(1)             28130000
281400             MOVE SU001-PO                                        28140000
281500                             TO DP013-MESSAGE-TEXT(2)             28150000
281600             MOVE SU001-CARTON                                    28160000
281700                             TO DP013-MESSAGE-TEXT(3)             28170000
281800             MOVE SQLCA      TO DP013-SQLCA                       28180000
281900             MOVE 'TSHUUPC'  TO DP013-DB2-TABLE-NAME(1)           28190000
282000             SET DP013-DB2-ABEND                                  28200000
282100                             TO TRUE                              28210000
282200             SET DP013-ROLLBACK                                   28220000
282300                             TO TRUE                              28230000
282400             SET DP013-XCTL-DISPLAY-RESTART                       28240000
282500                             TO TRUE                              28250000
282600             PERFORM DP014-0000-PROCESS-ABEND                     28260000
282700     END-EVALUATE.                                                28270000
282800                                                                  28280000
282900 EJECT                                                            28290000
283000*----------------------------------------------------------------*28300000
283100*  GET LABEL BATCH NUMBER                                        *28310000
283200*----------------------------------------------------------------*28320000
283300 2400-GET-BATCH-NUMBER.                                           28330000
283400                                                                  28340000
283500     MOVE  SU001-MANIFEST    TO  DK-MANIFEST.                     28350000
283600                                                                  28360000
283700     EXEC SQL                                                     28370000
283800         SELECT MAX(LBL_PRT_BTCH_ID)                              28380000
283900         INTO   :PV-MAX-USER-BATCH                                28390000
284000          FROM  TLBPTDA                                           28400000
284100          WHERE TRIP_ID           = :DK-MANIFEST                  28410000
284200            AND CRE_USR_ID        = :SU001-USER-ID                28420000
284300     END-EXEC.                                                    28430000
284400                                                                  28440000
284500     EVALUATE TRUE                                                28450000
284600         WHEN SQLCODE = ZERO                                      28460000
284700             IF  PV-MAX-USER-BATCH  >  ZERO                       28470000
284800                 CONTINUE                                         28480000
284900             ELSE                                                 28490000
285000                 MOVE  ZEROES  TO  PV-MAX-USER-BATCH              28500000
285100             END-IF                                               28510000
285200         WHEN SQLCODE = -305                                      28520000
285300             MOVE  ZEROES  TO  PV-MAX-USER-BATCH                  28530000
285400         WHEN SQLWARN0 NOT = SPACES                               28540000
285500         WHEN SQLCODE NOT EQUAL ZERO                              28550000
285600             MOVE '2400-GET-BATCH-NUMBER'                         28560000
285700                             TO DP013-PARAGRAPH                   28570000
285800             MOVE                                                 28580000
285900                'SUKRF706-GET HIGHEST BATCH NUMBER FOR TRIP/USER' 28590000
286000                             TO DP013-MESSAGE-TEXT(1)             28600000
286100             MOVE SU001-MANIFEST                                  28610000
286200                             TO DP013-MESSAGE-TEXT(2)             28620000
286300             MOVE SU001-USER-ID                                   28630000
286400                             TO DP013-MESSAGE-TEXT(3)             28640000
286500             MOVE SQLCA      TO DP013-SQLCA                       28650000
286600             MOVE 'TLBPTDA'  TO DP013-DB2-TABLE-NAME(1)           28660000
286700             SET DP013-DB2-ABEND                                  28670000
286800                             TO TRUE                              28680000
286900             SET DP013-ROLLBACK                                   28690000
287000                             TO TRUE                              28700000
287100             SET DP013-XCTL-DISPLAY-RESTART                       28710000
287200                             TO TRUE                              28720000
287300             PERFORM DP014-0000-PROCESS-ABEND                     28730000
287400     END-EVALUATE.                                                28740000
287500                                                                  28750000
287600                                                                  28760000
287700*----------------------------------------------------------------*28770000
287800*  DETERMINE RECEIVER                                            *28780000
287900*----------------------------------------------------------------*28790000
288000 2410-DETERMINE-RECEIVER.                                         28800000
288100                                                                  28810000
288200     MOVE  PV-CTN-N  TO  DK-CTN.                                  28820000
288300     MOVE  ZEROES    TO  SU001-RCVR-SEQ-NBR.                      28830000
288400     MOVE  SU001-PO  TO  DK-PO.                                   28840000
288500                                                                  28850000
288600     INITIALIZE  PV-RCVR-SEQ-NBR                                  28860000
288700                 PV-CRTN-TRIP-ID                                  28870000
288800                 VHTRIP-OWNER-SCAC-ID                             28880000
288900                 VHTRIP-VEH-NBR                                   28890000
289000                 RECEIV-PACK-BY-ST-IND                            28900000
289100                 RECEIV-PKGNG-CDE                                 28910000
289200                 RECEIV-CURR-OPER-UNT-ID.                         28920000
289300                                                                  28930000
289400                                                                  28940000
289500     EXEC SQL                                                     28950000
289600         SELECT DISTINCT                                          28960000
289700                C.REC_SEQ_NBR                                     28970000
289800              , A.TRIP_ID                                         28980000
289900              , A.OWNER_SCAC_ID                                   28990000
290000              , A.VEH_NBR                                         29000000
290100              , D.PACK_BY_ST_IND                                  29010000
290200              , D.PKGNG_CDE                                       29020000
290300              , D.OPER_UNT_ID                                     29030000
290400              , D.CURR_OPER_UNT_ID                                29040000
290500              , D.CRE_OPER_UNT_ID                                 29050000
290600              , E.CRE_SRC_CDE                                     29060000
290700              , F.SEQ_NBR                                         29070000
290800              , E.ORIG_PKSL_SEQ_NBR                               29080000
290900              , E.PKSL_STAT_CDE                                   29090000
291000         INTO   :PV-RCVR-SEQ-NBR                                  29100000
291100              , :PV-CRTN-TRIP-ID                                  29110000
291200              , :VHTRIP-OWNER-SCAC-ID                             29120000
291300              , :VHTRIP-VEH-NBR         :PV-NULL-IND              29130000
291400              , :RECEIV-PACK-BY-ST-IND                            29140000
291500              , :RECEIV-PKGNG-CDE                                 29150000
291600              , :RECEIV-OPER-UNT-ID                               29160000
291700              , :RECEIV-CURR-OPER-UNT-ID                          29170000
291800              , :RECEIV-CRE-OPER-UNT-ID                           29180000
291900              , :PKSLIP-CRE-SRC-CDE                               29190000
292000              , :INPKSU-SEQ-NBR                                   29200000
292100              , :PKSLIP-ORIG-PKSL-SEQ-NBR                         29210000
292200              , :PKSLIP-PKSL-STAT-CDE                             29220000
292300          FROM  TVHTRIP A                                         29230000
292400              , TSHIPMT B                                         29240000
292500              , TSHPTPO C                                         29250000
292600              , TRECEIV D                                         29260000
292700              , TPKSLIP E                                         29270000
292800              , TINPKSU F                                         29280000
292900              , TSHPUNT G                                         29290000
293000          WHERE A.TRIP_ID           = B.TRIP_ID                   29300000
293100            AND C.SHIPT_ID          = B.SHIPT_ID                  29310000
293200            AND C.PO_NBR            = :DK-PO                      29320000
293300            AND C.PO_NBR            = D.ORD_NBR                   29330000
293400            AND C.REC_SEQ_NBR       = D.REC_SEQ_NBR               29340000
293500            AND D.VER_STATUS_CDE    = 'A'                         29350000
293600            AND E.VER_STAT_CDE      = 'A'                         29360000
293700            AND C.PO_NBR            = E.PO_NBR                    29370000
293800            AND C.REC_SEQ_NBR       = E.REC_SEQ_NBR               29380000
293900            AND E.PO_NBR            = F.PO_NBR                    29390000
294000            AND E.SEQ_NBR           = F.SEQ_NBR                   29400000
294100            AND F.SHIPT_UNT_ID      = :DK-CTN                     29410000
294200            AND F.SHIPT_UNT_ID      = G.SHIPT_UNT_ID              29420000
294300            AND G.ACTV_IND          = 'A'                         29430000
294400     END-EXEC.                                                    29440000
294500                                                                  29450000
294600     EVALUATE TRUE                                                29460000
294700         WHEN SQLCODE = ZERO                                      29470000
294800             SET   SU001-CRTN-ATT-TO-RCVR                         29480000
294900                   PS-RCVR-DATA-FOUND-YES                         29490000
295000                   SU044-UPDATE-RCVR-PKSLIP TO TRUE               29500000
295100             IF  PV-RCVR-SEQ-NBR  >  ZERO                         29510000
295200                 MOVE  PV-RCVR-SEQ-NBR  TO  SU001-RCVR-SEQ-NBR    29520000
295300                                            PV-RCVR-OUT           29530000
295400                 IF PKSLIP-PKSL-STAT-CDE = 'IN'                   29540000
295500                    SET   SU001-NOT-CRTN-ATT-TO-TRIP              29550000
295600                          SU044-UPDATE-PKSLIP-ONLY   TO TRUE      29560000
295700                 ELSE                                             29570000
295800                    IF  PV-CRTN-TRIP-ID  =  SU001-MANIFEST        29580000
295900                        SET   SU001-CRTN-ATT-TO-TRIP TO TRUE      29590000
296000                    ELSE                                          29600000
296100                        SET   SU001-NOT-CRTN-ATT-TO-TRIP TO TRUE  29610000
296200                    END-IF                                        29620000
296300                 END-IF                                           29630000
296400             ELSE                                                 29640000
296500                 MOVE  ZEROES  TO  SU001-RCVR-SEQ-NBR             29650000
296600                                            PV-RCVR-OUT           29660000
296700                 SET   SU001-NOT-CRTN-ATT-TO-TRIP TO TRUE         29670000
296800             END-IF                                               29680000
296900             MOVE RECEIV-PKGNG-CDE   TO  SU001-PKGNG-CDE          29690000
297000             MOVE RECEIV-PACK-BY-ST-IND TO                        29700000
297100                                         SU001-RECEIV-PBS-IND     29710000
297200             MOVE INPKSU-SEQ-NBR     TO  SU001-PKSL-SEQ-NBR       29720000
297300         WHEN SQLCODE = +100                                      29730000
297400             MOVE  ZEROES  TO  SU001-RCVR-SEQ-NBR                 29740000
297500             PERFORM 2420-CHECK-TPKSLIP-EXISTS                    29750000
297600             IF PV-DB2-PKSLIP-COUNT > 0                           29760000
297700                SET PS-UCC128-PKSLIP-ERROR-NO TO TRUE             29770000
297800             ELSE                                                 29780000
297900                SET PS-UCC128-PKSLIP-ERROR-YES TO TRUE            29790000
298000             END-IF                                               29800000
298100                                                                  29810000
298200             SET   SU001-NOT-CRTN-ATT-TO-RCVR                     29820000
298300                   SU001-NOT-CRTN-ATT-TO-TRIP                     29830000
298400                   PS-RCVR-DATA-FOUND-NO      TO TRUE             29840000
298500             SET   SU044-UPDATE-PKSLIP-ONLY   TO TRUE             29850000
298600         WHEN SQLCODE = -811                                      29860000
298700             PERFORM 2415-DETERMINE-RECEIVER-2                    29870000
298800                                                                  29880000
298900         WHEN SQLWARN0 NOT = SPACES                               29890000
299000         WHEN SQLCODE NOT EQUAL ZERO                              29900000
299100             MOVE '2410-DETERMINE-RECEIVER'                       29910000
299200                             TO DP013-PARAGRAPH                   29920000
299300             MOVE 'SUKRF706 - DETERMINE RECEIVER NUMBER '         29930000
299400                             TO DP013-MESSAGE-TEXT(1)             29940000
299500             MOVE  SU001-MANIFEST TO  PV-DISPLAY-MANIFEST         29950000
299600             MOVE  SU001-CARTON   TO  PV-DISPLAY-CARTON           29960000
299700             MOVE  SU001-STORE    TO  PV-DISPLAY-STORE            29970000
299800             STRING ' TRIP - '            DELIMITED BY SIZE       29980000
299900                    PV-DISPLAY-MANIFEST   DELIMITED BY SIZE       29990000
300000                    '  CARTON - '         DELIMITED BY SIZE       30000000
300100                    PV-DISPLAY-CARTON     DELIMITED BY SIZE       30010000
300200                    '  STORE - '          DELIMITED BY SIZE       30020000
300300                    PV-DISPLAY-STORE      DELIMITED BY SIZE       30030000
300400                             INTO DP013-MESSAGE-TEXT (2)          30040000
300500             MOVE  SU001-PO       TO  PV-DISPLAY-PO               30050000
300600             STRING ' PO - '             DELIMITED BY SIZE        30060000
300700                    PV-DISPLAY-PO         DELIMITED BY SIZE       30070000
300800                    '  USERID - '         DELIMITED BY SIZE       30080000
300900                    SU001-USER-ID         DELIMITED BY SIZE       30090000
301000                             INTO DP013-MESSAGE-TEXT(3)           30100000
301100             MOVE SQLCA      TO DP013-SQLCA                       30110000
301200             MOVE 'TSHPTPO'  TO DP013-DB2-TABLE-NAME(1)           30120000
301300             SET DP013-DB2-ABEND                                  30130000
301400                             TO TRUE                              30140000
301500             SET DP013-ROLLBACK                                   30150000
301600                             TO TRUE                              30160000
301700             SET DP013-XCTL-DISPLAY-RESTART                       30170000
301800                             TO TRUE                              30180000
301900             PERFORM DP014-0000-PROCESS-ABEND                     30190000
302000     END-EVALUATE.                                                30200000
302100                                                                  30210000
302200                                                                  30220000
302300*----------------------------------------------------------------*30230000
302400*  DETERMINE RECEIVER - SPECIFIC TRAILER                         *30240000
302500*----------------------------------------------------------------*30250000
302600 2415-DETERMINE-RECEIVER-2.                                       30260000
302700                                                                  30270000
302800     MOVE  PV-CTN-N       TO  DK-CTN.                             30280000
302900     MOVE  ZEROES         TO  SU001-RCVR-SEQ-NBR.                 30290000
303000     MOVE  SU001-PO       TO  DK-PO.                              30300000
303100     MOVE  SU001-MANIFEST TO  DK-MANIFEST.                        30310000
303200                                                                  30320000
303300     INITIALIZE  PV-RCVR-SEQ-NBR                                  30330000
303400                 PV-CRTN-TRIP-ID                                  30340000
303500                 VHTRIP-OWNER-SCAC-ID                             30350000
303600                 VHTRIP-VEH-NBR                                   30360000
303700                 RECEIV-PACK-BY-ST-IND                            30370000
303800                 RECEIV-PKGNG-CDE.                                30380000
303900                                                                  30390000
304000     EXEC SQL                                                     30400000
304100         SELECT DISTINCT                                          30410000
304200                C.REC_SEQ_NBR                                     30420000
304300              , A.TRIP_ID                                         30430000
304400              , A.OWNER_SCAC_ID                                   30440000
304500              , A.VEH_NBR                                         30450000
304600              , D.PACK_BY_ST_IND                                  30460000
304700              , D.PKGNG_CDE                                       30470000
304800              , F.SEQ_NBR                                         30480000
304900              , E.ORIG_PKSL_SEQ_NBR                               30490000
305000              , E.PKSL_STAT_CDE                                   30500000
305100         INTO   :PV-RCVR-SEQ-NBR                                  30510000
305200              , :PV-CRTN-TRIP-ID                                  30520000
305300              , :VHTRIP-OWNER-SCAC-ID                             30530000
305400              , :VHTRIP-VEH-NBR         :PV-NULL-IND              30540000
305500              , :RECEIV-PACK-BY-ST-IND                            30550000
305600              , :RECEIV-PKGNG-CDE                                 30560000
305700              , :INPKSU-SEQ-NBR                                   30570000
305800              , :PKSLIP-ORIG-PKSL-SEQ-NBR                         30580000
305900              , :PKSLIP-PKSL-STAT-CDE                             30590000
306000          FROM  TVHTRIP A                                         30600000
306100              , TSHIPMT B                                         30610000
306200              , TSHPTPO C                                         30620000
306300              , TRECEIV D                                         30630000
306400              , TPKSLIP E                                         30640000
306500              , TINPKSU F                                         30650000
306600              , TSHPUNT G                                         30660000
306700          WHERE A.TRIP_ID           = :DK-MANIFEST                30670000
306800            AND A.TRIP_ID           = B.TRIP_ID                   30680000
306900            AND C.SHIPT_ID          = B.SHIPT_ID                  30690000
307000            AND C.PO_NBR            = :DK-PO                      30700000
307100            AND C.PO_NBR            = D.ORD_NBR                   30710000
307200            AND C.REC_SEQ_NBR       = D.REC_SEQ_NBR               30720000
307300            AND D.VER_STATUS_CDE    = 'A'                         30730000
307400            AND E.VER_STAT_CDE      = 'A'                         30740000
307500            AND C.PO_NBR            = E.PO_NBR                    30750000
307600            AND C.REC_SEQ_NBR       = E.REC_SEQ_NBR               30760000
307700            AND E.PO_NBR            = F.PO_NBR                    30770000
307800            AND E.SEQ_NBR           = F.SEQ_NBR                   30780000
307900            AND F.SHIPT_UNT_ID      = :DK-CTN                     30790000
308000            AND F.SHIPT_UNT_ID      = G.SHIPT_UNT_ID              30800000
308100            AND G.ACTV_IND          = 'A'                         30810000
308200     END-EXEC.                                                    30820000
308300                                                                  30830000
308400     EVALUATE TRUE                                                30840000
308500         WHEN SQLCODE = ZERO                                      30850000
308600             SET   SU001-CRTN-ATT-TO-RCVR                         30860000
308700                   PS-RCVR-DATA-FOUND-YES                         30870000
308800                   SU044-UPDATE-RCVR-PKSLIP TO TRUE               30880000
308900             IF  PV-RCVR-SEQ-NBR  >  ZERO                         30890000
309000                 MOVE  PV-RCVR-SEQ-NBR  TO  SU001-RCVR-SEQ-NBR    30900000
309100                                            PV-RCVR-OUT           30910000
309200                 IF PKSLIP-PKSL-STAT-CDE = 'IN'                   30920000
309300                    SET   SU001-NOT-CRTN-ATT-TO-TRIP              30930000
309400                          SU044-UPDATE-PKSLIP-ONLY   TO TRUE      30940000
309500                 ELSE                                             30950000
309600                    IF  PV-CRTN-TRIP-ID  =  SU001-MANIFEST        30960000
309700                        SET SU001-CRTN-ATT-TO-TRIP TO TRUE        30970000
309800                    ELSE                                          30980000
309900                        SET SU001-NOT-CRTN-ATT-TO-TRIP TO TRUE    30990000
310000                    END-IF                                        31000000
310100                 END-IF                                           31010000
310200             ELSE                                                 31020000
310300                 MOVE  ZEROES  TO  SU001-RCVR-SEQ-NBR             31030000
310400                                   PV-RCVR-OUT                    31040000
310500                 SET   SU001-NOT-CRTN-ATT-TO-TRIP TO TRUE         31050000
310600             END-IF                                               31060000
310700             MOVE   RECEIV-PKGNG-CDE   TO  SU001-PKGNG-CDE        31070000
310800             MOVE   RECEIV-PACK-BY-ST-IND TO                      31080000
310900                                         SU001-RECEIV-PBS-IND     31090000
311000             MOVE INPKSU-SEQ-NBR     TO  SU001-PKSL-SEQ-NBR       31100000
311100                                                                  31110000
311200         WHEN SQLCODE = +100                                      31120000
311300             MOVE  ZEROES  TO  SU001-RCVR-SEQ-NBR                 31130000
311400             PERFORM 2420-CHECK-TPKSLIP-EXISTS                    31140000
311500             IF PV-DB2-PKSLIP-COUNT > 0                           31150000
311600                SET PS-UCC128-PKSLIP-ERROR-NO TO TRUE             31160000
311700             ELSE                                                 31170000
311800                SET PS-UCC128-PKSLIP-ERROR-YES TO TRUE            31180000
311900             END-IF                                               31190000
312000                                                                  31200000
312100             SET   SU001-NOT-CRTN-ATT-TO-RCVR                     31210000
312200                   SU001-NOT-CRTN-ATT-TO-TRIP                     31220000
312300                   PS-RCVR-DATA-FOUND-NO      TO TRUE             31230000
312400             SET   SU044-UPDATE-PKSLIP-ONLY   TO TRUE             31240000
312500         WHEN SQLWARN0 NOT = SPACES                               31250000
312600         WHEN SQLCODE NOT EQUAL ZERO                              31260000
312700             MOVE '2415-DETERMINE-RECEIVER-2'                     31270000
312800                             TO DP013-PARAGRAPH                   31280000
312900             MOVE 'SUKRF706 - DETERMINE RCVR NBR FOR MLT TRIPS'   31290000
313000                             TO DP013-MESSAGE-TEXT(1)             31300000
313100             MOVE  SU001-MANIFEST TO  PV-DISPLAY-MANIFEST         31310000
313200             MOVE  SU001-CARTON   TO  PV-DISPLAY-CARTON           31320000
313300             MOVE  SU001-STORE    TO  PV-DISPLAY-STORE            31330000
313400             STRING ' TRIP - '            DELIMITED BY SIZE       31340000
313500                    PV-DISPLAY-MANIFEST   DELIMITED BY SIZE       31350000
313600                    '  CARTON - '         DELIMITED BY SIZE       31360000
313700                    PV-DISPLAY-CARTON     DELIMITED BY SIZE       31370000
313800                    '  STORE - '          DELIMITED BY SIZE       31380000
313900                    PV-DISPLAY-STORE      DELIMITED BY SIZE       31390000
314000                             INTO DP013-MESSAGE-TEXT (2)          31400000
314100             MOVE  SU001-PO       TO  PV-DISPLAY-PO               31410000
314200             STRING ' PO - '             DELIMITED BY SIZE        31420000
314300                    PV-DISPLAY-PO         DELIMITED BY SIZE       31430000
314400                    '  USERID - '         DELIMITED BY SIZE       31440000
314500                    SU001-USER-ID         DELIMITED BY SIZE       31450000
314600                             INTO DP013-MESSAGE-TEXT(3)           31460000
314700             MOVE SQLCA      TO DP013-SQLCA                       31470000
314800             MOVE 'TSHPTPO'  TO DP013-DB2-TABLE-NAME(1)           31480000
314900             SET DP013-DB2-ABEND                                  31490000
315000                             TO TRUE                              31500000
315100             SET DP013-ROLLBACK                                   31510000
315200                             TO TRUE                              31520000
315300             SET DP013-XCTL-DISPLAY-RESTART                       31530000
315400                             TO TRUE                              31540000
315500             PERFORM DP014-0000-PROCESS-ABEND                     31550000
315600     END-EVALUATE.                                                31560000
315700                                                                  31570000
315800                                                                  31580000
315900 2420-CHECK-TPKSLIP-EXISTS.                                       31590000
316000                                                                  31600000
316100     MOVE ZEROES  TO PV-DB2-PKSLIP-COUNT.                         31610000
316200                                                                  31620000
316300     EXEC SQL                                                     31630000
316400         SELECT COUNT(*)                                          31640000
316500         INTO   :PV-DB2-PKSLIP-COUNT                              31650000
316600         FROM   TPKSLIP A                                         31660000
316700             ,  TINPKSU B                                         31670000
316800         WHERE B.SHIPT_UNT_ID  = :DK-CTN                          31680000
316900           AND A.PO_NBR        = :DK-PO                           31690000
317000           AND A.SEQ_NBR       = B.SEQ_NBR                        31700000
317100           AND A.VER_STAT_CDE  = 'A'                              31710000
317200     END-EXEC.                                                    31720000
317300                                                                  31730000
317400         EVALUATE TRUE                                            31740000
317500             WHEN SQLCODE = ZERO                                  31750000
317600             WHEN SQLCODE = +100                                  31760000
317700                  CONTINUE                                        31770000
317800             WHEN SQLWARN0 NOT = SPACES                           31780000
317900             WHEN SQLCODE < ZERO                                  31790000
318000             WHEN SQLCODE > ZERO                                  31800000
318100                 MOVE '2420-CHECK-TPKSLIP-EXISTS'                 31810000
318200                                   TO DP013-PARAGRAPH             31820000
318300                 MOVE 'SELECT FROM TABLE  - '                     31830000
318400                                   TO DP013-MESSAGE-TEXT (1)      31840000
318500                 MOVE SQLCA        TO DP013-SQLCA                 31850000
318600                 MOVE 'TPKSLIP '   TO DP013-DB2-TABLE-NAME (1)    31860000
318700                 SET DP013-DB2-ABEND                              31870000
318800                     DP013-XCTL-DISPLAY-RESTART TO TRUE           31880000
318900                 SET DP013-ROLLBACK                               31890000
319000                                   TO TRUE                        31900000
319100                 PERFORM DP014-0000-PROCESS-ABEND                 31910000
319200         END-EVALUATE.                                            31920000
319300                                                                  31930000
319400                                                                  31940000
319500*----------------------------------------------------------------*31950000
319600*  CHECK IF THE CARTON HAS ANY LINES THAT HAVE BEEN VERIFIED     *31960000
319700*----------------------------------------------------------------*31970000
319800 2425-CHECK-VERIFIED-LINES.                                       31980000
319900                                                                  31990000
320000     SET  PS-RECITM-VERIFIED-LINES-NO  TO TRUE.                   32000000
320100     MOVE ZEROES               TO PV-VERIF-RECITM-COUNT.          32010000
320200     MOVE SU001-RCVR-SEQ-NBR   TO RECITM-REC-SEQ-NBR.             32020000
320300     MOVE SU001-CARTON         TO DK-CTN.                         32030000
320400                                                                  32040000
320500     EXEC SQL                                                     32050000
320600         SELECT COUNT(*)                                          32060000
320700         INTO   :PV-VERIF-RECITM-COUNT                            32070000
320800          FROM  TSHUUPC A                                         32080000
320900              , TRECITM B                                         32090000
321000          WHERE  A.SHIPT_UNT_ID    = :DK-CTN                      32100000
321100          AND    A.TRN_NBR     =  B.ORD_NBR                       32110000
321200          AND    A.TRN_LNE_NBR =  B.ORD_LNE_NBR                   32120000
321300          AND    B.REC_SEQ_NBR =  :RECITM-REC-SEQ-NBR             32130000
321400          AND    B.STATUS_CDE  =  'VE'                            32140000
321500          AND    B.VER_STATUS_CDE = 'A'                           32150000
321600     END-EXEC.                                                    32160000
321700                                                                  32170000
321800     EVALUATE TRUE                                                32180000
321900         WHEN SQLCODE = ZERO                                      32190000
322000         WHEN SQLCODE = +100                                      32200000
322100              IF PV-VERIF-RECITM-COUNT > 0                        32210000
322200                 SET PS-RECITM-VERIFIED-LINES-YES                 32220000
322300                     PS-ACTIVE-XREF-ROW-NOT-FOUND TO TRUE         32230000
322400                 PERFORM 3690-CHECK-SULBXF-FOR-ACTIVE             32240000
322500                 IF PS-ACTIVE-XREF-ROW-FOUND                      32250000
322600                    SET PS-RECITM-VERIFIED-LINES-NO TO TRUE       32260000
322700                 END-IF                                           32270000
322800              END-IF                                              32280000
322900         WHEN SQLWARN0 NOT = SPACES                               32290000
323000         WHEN SQLCODE NOT EQUAL ZERO                              32300000
323100             MOVE '2425-CHECK-VERIFIED-LINES'                     32310000
323200                             TO DP013-PARAGRAPH                   32320000
323300             MOVE 'SUKRF706 - CHECK FOR VERIFIED LINES '          32330000
323400                             TO DP013-MESSAGE-TEXT(1)             32340000
323500             MOVE  SU001-MANIFEST TO  PV-DISPLAY-MANIFEST         32350000
323600             MOVE  SU001-CARTON   TO  PV-DISPLAY-CARTON           32360000
323700             MOVE  SU001-STORE    TO  PV-DISPLAY-STORE            32370000
323800             STRING ' TRIP - '            DELIMITED BY SIZE       32380000
323900                    PV-DISPLAY-MANIFEST   DELIMITED BY SIZE       32390000
324000                    '  CARTON - '         DELIMITED BY SIZE       32400000
324100                    PV-DISPLAY-CARTON     DELIMITED BY SIZE       32410000
324200                    '  STORE - '          DELIMITED BY SIZE       32420000
324300                    PV-DISPLAY-STORE      DELIMITED BY SIZE       32430000
324400                             INTO DP013-MESSAGE-TEXT (2)          32440000
324500             MOVE  SU001-PO       TO  PV-DISPLAY-PO               32450000
324600             STRING ' PO - '             DELIMITED BY SIZE        32460000
324700                    PV-DISPLAY-PO         DELIMITED BY SIZE       32470000
324800                    '  USERID - '         DELIMITED BY SIZE       32480000
324900                    SU001-USER-ID         DELIMITED BY SIZE       32490000
325000                             INTO DP013-MESSAGE-TEXT(3)           32500000
325100             MOVE SQLCA      TO DP013-SQLCA                       32510000
325200             MOVE 'TRECITM'  TO DP013-DB2-TABLE-NAME(1)           32520000
325300             SET DP013-DB2-ABEND                                  32530000
325400                             TO TRUE                              32540000
325500             SET DP013-ROLLBACK                                   32550000
325600                             TO TRUE                              32560000
325700             SET DP013-XCTL-DISPLAY-RESTART                       32570000
325800                             TO TRUE                              32580000
325900             PERFORM DP014-0000-PROCESS-ABEND                     32590000
326000     END-EVALUATE.                                                32600000
326100                                                                  32610000
326200                                                                  32620000
326300 2450-OPEN-UNITS-CSR.                                             32630000
326400                                                                  32640000
326500     MOVE  SU001-CARTON TO DK-CTN.                                32650000
326600                                                                  32660000
326700     EXEC SQL                                                     32670000
326800          OPEN UNITS-CSR                                          32680000
326900     END-EXEC                                                     32690000
327000                                                                  32700000
327100                                                                  32710000
327200     EVALUATE TRUE                                                32720000
327300         WHEN SQLCODE = ZERO                                      32730000
327400             CONTINUE                                             32740000
327500         WHEN SQLWARN0 NOT = SPACES                               32750000
327600         WHEN SQLCODE < ZERO                                      32760000
327700         WHEN SQLCODE > ZERO                                      32770000
327800             MOVE '2450-OPEN-UNITS-CSR'                           32780000
327900                               TO DP013-PARAGRAPH                 32790000
328000             MOVE 'OPEN UNITS  CURSOR - '                         32800000
328100                               TO DP013-MESSAGE-TEXT (1)          32810000
328200             MOVE SQLCA        TO DP013-SQLCA                     32820000
328300             MOVE 'TSHUUPC '   TO DP013-DB2-TABLE-NAME (1)        32830000
328400             SET DP013-DB2-ABEND                                  32840000
328500                 DP013-XCTL-DISPLAY-RESTART TO TRUE               32850000
328600             SET DP013-ROLLBACK                                   32860000
328700                               TO TRUE                            32870000
328800             PERFORM DP014-0000-PROCESS-ABEND                     32880000
328900     END-EVALUATE.                                                32890000
329000                                                                  32900000
329100 EJECT                                                            32910000
329200*----------------------------------------------------------------*32920000
329300*                                                                *32930000
329400*----------------------------------------------------------------*32940000
329500 2460-FETCH-LINE-AND-UNITS.                                       32950000
329600                                                                  32960000
329700     EXEC SQL                                                     32970000
329800        FETCH   UNITS-CSR                                         32980000
329900        INTO   :SHUUPC-SHPD-QTY                                   32990000
330000             , :PV-TRN-LNE-NBR                                    33000000
330100             , :DISTHD-UCC128-DAT-USG-CDE                         33010000
330200             , :DISTHD-PRC-AREA-MODU-ID                           33020000
330300                                                                  33030000
330400     END-EXEC.                                                    33040000
330500                                                                  33050000
330600     EVALUATE TRUE                                                33060000
330700       WHEN SQLCODE = ZEROS                                       33070000
330800            SET PS-FOUND-ON-CURSOR TO TRUE                        33080000
330900            PERFORM  7230-GET-DEPT-CL-SKU                         33090000
331000            ADD  SHUUPC-SHPD-QTY     TO  PV-SHPD-QTY-TOTAL        33100000
331100            IF PS-FIRST-PO-LINE-FOR-CTN                           33110000
331200               ADD +1 TO PV-MULTI-LINE-COUNT                      33120000
331300               MOVE PV-TRN-LNE-NBR TO PV-HOLD-TRN-LNE-NBR         33130000
331400               SET  PS-NOT-FIRST-PO-LINE-FOR-CTN TO TRUE          33140000
331500            END-IF                                                33150000
331600            IF PV-TRN-LNE-NBR = PV-HOLD-TRN-LNE-NBR               33160000
331700               CONTINUE                                           33170000
331800            ELSE                                                  33180000
331900               ADD +1 TO PV-MULTI-LINE-COUNT                      33190000
332000               MOVE PV-TRN-LNE-NBR TO PV-HOLD-TRN-LNE-NBR         33200000
332100            END-IF                                                33210000
332200       WHEN SQLCODE = +100                                        33220000
332300            EVALUATE TRUE                                         33230000
332400               WHEN PV-MULTI-LINE-COUNT = 0                       33240000
332500                 SET SU001-NO-LINE           TO  TRUE             33250000
332600               WHEN PV-MULTI-LINE-COUNT > 1                       33260000
332700                 SET  SU001-MULTI-LINE       TO  TRUE             33270000
332800               WHEN OTHER                                         33280000
332900                 CONTINUE                                         33290000
333000            END-EVALUATE                                          33300000
333100            SET  PS-EO-UNITS-CSR   TO TRUE                        33310000
333200            MOVE PV-SHPD-QTY-TOTAL TO SU001-OUTR-PACK-QTY         33320000
333300                                      PV-OUTR-PACK-QTY            33330000
333400                                      DK-OUTER-QTY                33340000
333500            MOVE ZEROES            TO PV-SHPD-QTY-TOTAL           33350000
333600       WHEN OTHER                                                 33360000
333700             MOVE '2460-FETCH-LINE-AND-UNITS'                     33370000
333800                             TO DP013-PARAGRAPH                   33380000
333900             MOVE 'SUKRF706 - CHECK FOR NOT FOUND       '         33390000
334000                             TO DP013-MESSAGE-TEXT(1)             33400000
334100             MOVE SU001-PO                                        33410000
334200                             TO DP013-MESSAGE-TEXT(2)             33420000
334300             MOVE SU001-CARTON                                    33430000
334400                             TO DP013-MESSAGE-TEXT(3)             33440000
334500             MOVE SQLCA      TO DP013-SQLCA                       33450000
334600             MOVE 'TSHUUPC'  TO DP013-DB2-TABLE-NAME(1)           33460000
334700             SET DP013-DB2-ABEND                                  33470000
334800                             TO TRUE                              33480000
334900             SET DP013-ROLLBACK                                   33490000
335000                             TO TRUE                              33500000
335100             SET DP013-XCTL-DISPLAY-RESTART                       33510000
335200                             TO TRUE                              33520000
335300             PERFORM DP014-0000-PROCESS-ABEND                     33530000
335400     END-EVALUATE.                                                33540000
335500                                                                  33550000
335600                                                                  33560000
335700 2470-CLOSE-UNITS-CSR.                                            33570000
335800                                                                  33580000
335900     EXEC SQL                                                     33590000
336000         CLOSE UNITS-CSR                                          33600000
336100     END-EXEC                                                     33610000
336200                                                                  33620000
336300                                                                  33630000
336400     EVALUATE TRUE                                                33640000
336500         WHEN SQLCODE = ZERO                                      33650000
336600             CONTINUE                                             33660000
336700         WHEN SQLWARN0 NOT = SPACES                               33670000
336800         WHEN SQLCODE < ZERO                                      33680000
336900         WHEN SQLCODE > ZERO                                      33690000
337000             MOVE '2470-CLOSE-UNITS-CSR'                          33700000
337100                               TO DP013-PARAGRAPH                 33710000
337200             MOVE 'CLOSE UNITS  CURSOR - '                        33720000
337300                               TO DP013-MESSAGE-TEXT (1)          33730000
337400             MOVE SQLCA        TO DP013-SQLCA                     33740000
337500             MOVE 'TSHUUPC '   TO DP013-DB2-TABLE-NAME (1)        33750000
337600             SET DP013-DB2-ABEND                                  33760000
337700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               33770000
337800             SET DP013-ROLLBACK                                   33780000
337900                               TO TRUE                            33790000
338000             PERFORM DP014-0000-PROCESS-ABEND                     33800000
338100     END-EVALUATE.                                                33810000
338200                                                                  33820000
338300 2500-GET-REPRINT-BATCH.                                          33830070
338301                                                                  33830170
338304     EXEC SQL                                                     33830475
338305         SELECT MAX(CRE_TMST)                                     33830575
338306         INTO   :PV-MAX-TIMESTAMP                                 33830675
338307          FROM  TLBPTDA                                           33830775
338308          WHERE SHIPT_UNT_ID      = :DK-CTN                       33830875
338309            AND TRIP_ID           < 0                             33830975
338310                                                                  33831075
338311     END-EXEC.                                                    33831175
338312                                                                  33831275
338313     EVALUATE TRUE                                                33831375
338314         WHEN SQLCODE = ZERO                                      33831475
338315             CONTINUE                                             33831575
338320         WHEN SQLCODE = -305                                      33832075
338321*DMH 11/5/15 MOVE  ZEROES  TO  PV-MAX-TIMESTAMP                   33832190
338322             MOVE  PC-DEFAULT-TIME  TO  PV-MAX-TIMESTAMP          33832290
338323         WHEN SQLWARN0 NOT = SPACES                               33832375
338324         WHEN SQLCODE NOT EQUAL ZERO                              33832475
338325             MOVE '2500-GET-REPRINT-BATCH'                        33832575
338326                             TO DP013-PARAGRAPH                   33832675
338327             MOVE                                                 33832775
338328                'SUKRF706-GET HIGHEST TIMESTAMP FOR SHIPMENT    ' 33832875
338329                             TO DP013-MESSAGE-TEXT(1)             33832975
338330             MOVE SU001-MANIFEST                                  33833075
338331                             TO DP013-MESSAGE-TEXT(2)             33833175
338332             MOVE SU001-USER-ID                                   33833275
338333                             TO DP013-MESSAGE-TEXT(3)             33833375
338334             MOVE SQLCA      TO DP013-SQLCA                       33833475
338335             MOVE 'TLBPTDA'  TO DP013-DB2-TABLE-NAME(1)           33833575
338336             SET DP013-DB2-ABEND                                  33833675
338337                             TO TRUE                              33833775
338338             SET DP013-ROLLBACK                                   33833875
338339                             TO TRUE                              33833975
338340             SET DP013-XCTL-DISPLAY-RESTART                       33834075
338341                             TO TRUE                              33834175
338342             PERFORM DP014-0000-PROCESS-ABEND                     33834275
338343     END-EVALUATE.                                                33834375
338344                                                                  33834475
338345     EXEC SQL                                                     33834570
338346         SELECT LBL_PRT_BTCH_ID                                   33834670
338347               ,CRE_USR_ID                                        33834770
338348               ,TRIP_ID                                           33834874
338349         INTO   :LBPTDA-LBL-PRT-BTCH-ID                           33834970
338350               ,:LBPTDA-CRE-USR-ID                                33835070
338351               ,:LBPTDA-TRIP-ID                                   33835174
338352          FROM  TLBPTDA                                           33835270
338370          WHERE SHIPT_UNT_ID      = :DK-CTN                       33837074
338371            AND CRE_TMST          = :PV-MAX-TIMESTAMP             33837175
338380     END-EXEC.                                                    33838070
338390                                                                  33839070
338395     EVALUATE TRUE                                                33839570
338396         WHEN SQLCODE = ZERO                                      33839670
338397             MOVE LBPTDA-LBL-PRT-BTCH-ID TO SU001-BATCH-NUMBER    33839770
338398                                            SU001-BATCH-NO-USE    33839870
338399             MOVE LBPTDA-CRE-USR-ID      TO SU001-USER-ID         33839970
338400                                            SU001-USER-ID-USE     33840070
338401             MOVE LBPTDA-TRIP-ID         TO SU001-MANIFEST        33840174
338403         WHEN SQLCODE = +100                                      33840372
338404             MOVE ZERO TO SU001-BATCH-NUMBER                      33840470
338405         WHEN SQLWARN0 NOT = SPACES                               33840570
338406         WHEN SQLCODE NOT EQUAL ZERO                              33840670
338407             MOVE '2500-GET-LAST-BATCH'                           33840770
338408                             TO DP013-PARAGRAPH                   33840870
338409             MOVE                                                 33840970
338410                'SUKRF706-GET HIGHEST BATCH NUMBER FOR TRIP/USER' 33841070
338411                             TO DP013-MESSAGE-TEXT(1)             33841170
338412             MOVE SU001-MANIFEST                                  33841270
338413                             TO DP013-MESSAGE-TEXT(2)             33841370
338414             MOVE SU001-USER-ID                                   33841470
338415                             TO DP013-MESSAGE-TEXT(3)             33841570
338416             MOVE SQLCA      TO DP013-SQLCA                       33841670
338417             MOVE 'TLBPTDA'  TO DP013-DB2-TABLE-NAME(1)           33841770
338418             SET DP013-DB2-ABEND                                  33841870
338419                             TO TRUE                              33841970
338420             SET DP013-NO-ROLLBACK                                33842070
338421                             TO TRUE                              33842170
338422             SET DP013-XCTL-DISPLAY-RESTART  TO TRUE              33842270
338423             PERFORM DP014-0000-PROCESS-ABEND                     33842370
338424     END-EVALUATE.                                                33842470
338430 EJECT                                                            33843000
338500**********************************************************        33850000
338600 3500-GET-VIRTUAL-LABEL-DATA.                                     33860000
338700**********************************************************        33870000
338800                                                                  33880000
338900     PERFORM                                                      33890000
339000         WITH TEST AFTER                                          33900000
339100         VARYING PV-RETRY-COUNTER                                 33910000
339200         FROM 1 BY 1                                              33920000
339300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               33930000
339400                   OR PS-SUCCESSFUL-UPDATE                        33940000
339500                   OR PS-DONE)                                    33950000
339600                                                                  33960000
339700     EXEC SQL                                                     33970000
339800        SELECT   PREPK_ID                                         33980000
339900                ,LBL_ASG_SEQ_NBR                                  33990000
340000                ,CART_LBL_TYP_CDE                                 34000000
340100                ,PREPK_PRCG_LNE_NBR                               34010000
340200                ,INPK_UNT_QTY                                     34020000
340300                ,PREPK_RATO_QTY                                   34030000
340400                ,PREPK_UNT_QTY                                    34040000
340500                ,DEST_OPER_UNT_ID                                 34050000
340600                ,CSE_PK_QTY                                       34060000
340700                ,ODD_CART_IND                                     34070000
340800                ,INPK_CNVYB_IND                                   34080000
340900                ,LBL_TYP_LBL_SEQ_ID                               34090000
341000                ,LBL_TYP_TOT_QTY                                  34100000
341100                ,BRCDE_NBR                                        34110000
341200                ,STR_ZN_ID                                        34120000
341300                ,MODU_DESC                                        34130000
341400                ,ITM_NBR                                          34140000
341500                ,DEPT_DESC                                        34150000
341600                ,MAJ_CL_DESC                                      34160000
341700                ,SEASET_NM                                        34170000
341800                ,FIXT_ID                                          34180000
341900                ,LBL_TYP_CDE                                      34190000
342000                ,PRNT_CART_SEQ_ID                                 34200000
342100                ,STRG_AREA_CDE                                    34210000
342200                ,OTPK_UNT_QTY                                     34220000
342300                ,EAS_TAG_IND                                      34230000
342400                ,DOOR_ID                                          34240000
342500                ,HNG_FOLD_SEQ_NBR                                 34250000
342510*CLP 06/24/15 START                                               34251080
342600                ,LBL_MSG_TXT                                      34260080
342610*CLP 06/24/15 END                                                 34261080
342700        INTO     :LBVRDA-PREPK-ID                                 34270000
342800                ,:LBVRDA-LBL-ASG-SEQ-NBR                          34280000
342900                ,:LBVRDA-CART-LBL-TYP-CDE                         34290000
343000                ,:LBVRDA-PREPK-PRCG-LNE-NBR                       34300000
343100                ,:LBVRDA-INPK-UNT-QTY                             34310000
343200                ,:LBVRDA-PREPK-RATO-QTY                           34320000
343300                ,:LBVRDA-PREPK-UNT-QTY                            34330000
343400                ,:LBVRDA-DEST-OPER-UNT-ID                         34340000
343500                ,:LBVRDA-CSE-PK-QTY                               34350000
343600                ,:LBVRDA-ODD-CART-IND                             34360000
343700                ,:LBVRDA-INPK-CNVYB-IND                           34370000
343800                ,:LBVRDA-LBL-TYP-LBL-SEQ-ID                       34380000
343900                ,:LBVRDA-LBL-TYP-TOT-QTY                          34390000
344000                ,:LBVRDA-BRCDE-NBR                                34400000
344100                ,:LBVRDA-STR-ZN-ID                                34410000
344200                ,:LBVRDA-MODU-DESC                                34420000
344300                ,:LBVRDA-ITM-NBR                                  34430000
344400                ,:LBVRDA-DEPT-DESC                                34440000
344500                ,:LBVRDA-MAJ-CL-DESC                              34450000
344600                ,:LBVRDA-SEASET-NM                                34460000
344700                ,:LBVRDA-FIXT-ID                                  34470000
344800                ,:LBVRDA-LBL-TYP-CDE                              34480000
344900                ,:LBVRDA-PRNT-CART-SEQ-ID                         34490000
345000                ,:LBVRDA-STRG-AREA-CDE                            34500000
345100                ,:LBVRDA-OTPK-UNT-QTY                             34510000
345200                ,:LBVRDA-EAS-TAG-IND                              34520000
345300                ,:LBVRDA-DOOR-ID                                  34530000
345400                ,:LBVRDA-HNG-FOLD-SEQ-NBR                         34540000
345500                ,:LBVRDA-LBL-MSG-TXT                              34550080
345600        FROM TLBVRDA A                                            34560000
345700        WHERE  A.PO_NBR                =  :DK-PO                  34570000
345800          AND  A.RCVR_SEQ_NBR          =  :DK-REC-SEQ-NBR         34580000
345900          AND  A.PO_LNE_NBR            =  :DK-PO-LNE-NBR          34590000
346000          AND  A.PREPK_ID              =  :DK-PREPK-ID            34600000
346100          AND  A.OTPK_UNT_QTY          =  :DK-OUTER-QTY           34610000
346200          AND  A.LBL_ASG_IND           =  'N'                     34620000
346300          AND  A.LBL_TYP_CDE           =  'M'                     34630000
346400          AND  A.LBL_ASG_SEQ_NBR =                                34640000
346500             (SELECT  MIN(LBL_ASG_SEQ_NBR)                        34650000
346600                 FROM   TLBVRDA B                                 34660000
346700              WHERE B.PO_NBR            = A.PO_NBR                34670000
346800                    AND  B.RCVR_SEQ_NBR = A.RCVR_SEQ_NBR          34680000
346900                    AND  B.PO_LNE_NBR   = A.PO_LNE_NBR            34690000
347000                    AND  B.PREPK_ID     = A.PREPK_ID              34700000
347100                    AND  B.OTPK_UNT_QTY = A.OTPK_UNT_QTY          34710000
347200                    AND  B.LBL_ASG_IND  = A.LBL_ASG_IND           34720000
347300                    AND  A.LBL_TYP_CDE  = B.LBL_TYP_CDE)          34730000
347400     END-EXEC                                                     34740000
347500                                                                  34750000
347600         EVALUATE TRUE                                            34760000
347700             WHEN SQLCODE = ZERO                                  34770000
347800                PERFORM 3520-PROCESS-TLBVRDA                      34780000
347900             WHEN SQLCODE = +100                                  34790000
348000                SET SU001-UCC128-NO-LABEL-DATA TO TRUE            34800000
348100                PERFORM 3600-CHECK-MESSAGE-TABLE                  34810000
348200             WHEN SQLCODE = -904                                  34820000
348300             WHEN SQLCODE = -913                                  34830000
348400                 CONTINUE                                         34840000
348500             WHEN SQLWARN0 NOT = SPACES                           34850000
348600             WHEN SQLCODE < ZERO                                  34860000
348700             WHEN SQLCODE > ZERO                                  34870000
348800                 MOVE '3500-GET-VIRTUAL-LABEL-DATA'               34880000
348900                                   TO DP013-PARAGRAPH             34890000
349000                 MOVE 'UPDATE TABLE       - '                     34900000
349100                                   TO DP013-MESSAGE-TEXT (1)      34910000
349200                 MOVE SQLCA        TO DP013-SQLCA                 34920000
349300                 MOVE 'TLBVRDA '   TO DP013-DB2-TABLE-NAME (1)    34930000
349400                 SET DP013-DB2-ABEND                              34940000
349500                     DP013-XCTL-DISPLAY-RESTART TO TRUE           34950000
349600                 SET DP013-ROLLBACK                               34960000
349700                                   TO TRUE                        34970000
349800                 PERFORM DP014-0000-PROCESS-ABEND                 34980000
349900         END-EVALUATE                                             34990000
350000     END-PERFORM.                                                 35000000
350100                                                                  35010000
350200 3520-PROCESS-TLBVRDA.                                            35020000
350300      SET PS-LABEL-DATA-FOUND                                     35030000
350400          PS-FREE-ASTRAY-MSG-LBL-NO TO TRUE.                      35040000
350500      IF SU001-CRTN-ATT-TO-TRIP AND SU001-CRTN-ATT-TO-RCVR        35050000
350600         PERFORM 3550-CONSUME-TABLE-ROW                           35060000
350700         IF PS-SUCCESSFUL-UPDATE                                  35070000
350800            MOVE LBVRDA-DEST-OPER-UNT-ID TO SU001-STORE           35080000
350900            PERFORM 7210-GET-STORE-INFO                           35090000
351000         END-IF                                                   35100000
351100      ELSE                                                        35110000
351200         SET PS-FREE-ASTRAY-MSG-LBL-YES                           35120000
351300             PS-DONE                    TO TRUE                   35130000
351400         IF SU001-AUTO-VE-YES                                     35140000
351500            SET PS-FREE-ASTRAY-PROCESS TO TRUE                    35150000
351600            PERFORM 4250-LINK-TO-FRASTY-HANDLER                   35160000
351700            PERFORM 5005-PRINT-MESSAGE-LABELS                     35170000
351800         ELSE                                                     35180000
351900            PERFORM 5005-PRINT-MESSAGE-LABELS                     35190000
352000         END-IF                                                   35200000
352100      END-IF.                                                     35210000
352200**********************************************************        35220000
352300 3550-CONSUME-TABLE-ROW.                                          35230000
352400**********************************************************        35240000
352500     EXEC SQL                                                     35250000
352600         UPDATE TLBVRDA                                           35260000
352700           SET LBL_ASG_IND     = 'Y'                              35270000
352800         WHERE PO_NBR          = :DK-PO                           35280000
352900           AND RCVR_SEQ_NBR    = :DK-REC-SEQ-NBR                  35290000
353000           AND PO_LNE_NBR      = :DK-PO-LNE-NBR                   35300000
353100           AND PREPK_ID        = :DK-PREPK-ID                     35310000
353200           AND LBL_ASG_SEQ_NBR = :LBVRDA-LBL-ASG-SEQ-NBR          35320000
353300           AND LBL_ASG_IND     = 'N'                              35330000
353400     END-EXEC.                                                    35340000
353500                                                                  35350000
353600                                                                  35360000
353700         EVALUATE TRUE                                            35370000
353800             WHEN SQLCODE = ZERO                                  35380000
353900                SET PS-SUCCESSFUL-UPDATE TO TRUE                  35390000
354000                MOVE LBVRDA-BRCDE-NBR  TO                         35400000
354100                                          DK-BARCODE-NBR          35410000
354200                MOVE LBVRDA-CART-LBL-TYP-CDE TO                   35420000
354300                                          DK-CART-LBL-TYP-CDE     35430000
354400                MOVE LBVRDA-DEST-OPER-UNT-ID TO                   35440000
354500                                          DK-DEST-OPER-UNT-ID     35450000
354600                MOVE LBVRDA-EAS-TAG-IND TO                        35460000
354700                                        PS-EAS-TAG-IND-FOUND-SW   35470000
354800                MOVE SU001-OPER-UNT-ID TO DK-OPER-UNT-ID          35480000
355200             WHEN SQLCODE = +100                                  35520000
355300                SET PS-NOT-SUCCESSFUL-UPDATE TO TRUE              35530000
355400             WHEN SQLCODE = -904                                  35540000
355500             WHEN SQLCODE = -913                                  35550000
355600                 CONTINUE                                         35560000
355700             WHEN SQLWARN0 NOT = SPACES                           35570000
355800             WHEN SQLCODE < ZERO                                  35580000
355900             WHEN SQLCODE > ZERO                                  35590000
356000                 MOVE '3550-CONSUME-TABLE-ROW'                    35600000
356100                                   TO DP013-PARAGRAPH             35610000
356200                 MOVE 'UPDATE TABLE       - '                     35620000
356300                                   TO DP013-MESSAGE-TEXT (1)      35630000
356400                 MOVE SQLCA        TO DP013-SQLCA                 35640000
356500                 MOVE 'TLBVRDA '   TO DP013-DB2-TABLE-NAME (1)    35650000
356600                 SET DP013-DB2-ABEND                              35660000
356700                     DP013-XCTL-DISPLAY-RESTART TO TRUE           35670000
356800                 SET DP013-ROLLBACK                               35680000
356900                                   TO TRUE                        35690000
357000                 PERFORM DP014-0000-PROCESS-ABEND                 35700000
357100         END-EVALUATE.                                            35710000
357200                                                                  35720000
357300                                                                  35730000
357400 EJECT                                                            35740000
357500**********************************************************        35750000
357600 3560-CHECK-FOR-NEW-PO-LINE.                                      35760000
357700**********************************************************        35770000
357800     MOVE SU001-PO         TO   DK-PO.                            35780000
357900     MOVE SU001-MANIFEST   TO   DK-MANIFEST.                      35790000
358000     MOVE SU001-RCVR-SEQ-NBR TO DK-REC-SEQ-NBR.                   35800000
358100     MOVE 'Q'              TO   DK-ERR-MSG-CDE.                   35810000
358200                                                                  35820000
358300     EXEC SQL                                                     35830000
358400         SELECT PO_NBR                                            35840000
358500              , CRE_TMST                                          35850000
358600         INTO   :LBVRMG-PO-NBR                                    35860000
358700              , :LBVRMG-CRE-TMST                                  35870000
358800         FROM   TLBVRMG                                           35880000
358900         WHERE PO_NBR          = :DK-PO                           35890000
359000           AND RCVR_SEQ_NBR    = :DK-REC-SEQ-NBR                  35900000
359100           AND PO_LNE_NBR      = :DK-PO-LNE-NBR                   35910000
359200           AND PREPK_ID        = :DK-PREPK-ID                     35920000
359300           AND TRIP_ID         = :DK-MANIFEST                     35930000
359400           AND ERR_MSG_CDE     = :DK-ERR-MSG-CDE                  35940000
359500     END-EXEC.                                                    35950000
359600                                                                  35960000
359700         EVALUATE TRUE                                            35970000
359800             WHEN SQLCODE = ZERO                                  35980000
359900                SET PS-DONT-PRINT-AUDIT-LABEL TO TRUE             35990000
360000             WHEN SQLCODE = +100                                  36000000
360100                PERFORM 3650-UPDATE-MESSAGE-TABLE                 36010006
360200                MOVE ZEROES TO LBVRMG-CRE-TMST                    36020000
360300                SET PS-PRINT-AUDIT-LABEL TO TRUE                  36030000
360400             WHEN SQLWARN0 NOT = SPACES                           36040000
360500             WHEN SQLCODE < ZERO                                  36050000
360600             WHEN SQLCODE > ZERO                                  36060000
360700                 MOVE '3600-CHECK-MESSAGE-TABLE'                  36070000
360800                                   TO DP013-PARAGRAPH             36080000
360900                 MOVE 'SELECT FROM TABLE  - '                     36090000
361000                                   TO DP013-MESSAGE-TEXT (1)      36100000
361100                 MOVE SQLCA        TO DP013-SQLCA                 36110000
361200                 MOVE 'TLBVRMG '   TO DP013-DB2-TABLE-NAME (1)    36120000
361300                 SET DP013-DB2-ABEND                              36130000
361400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           36140000
361500                 SET DP013-ROLLBACK                               36150000
361600                                   TO TRUE                        36160000
361700                 PERFORM DP014-0000-PROCESS-ABEND                 36170000
361800         END-EVALUATE.                                            36180000
361900                                                                  36190000
362000 EJECT                                                            36200000
362100**********************************************************        36210000
362200 3569-SEL-MAX-CHECK-IN-TMST.                                      36220000
362300**********************************************************        36230000
362400                                                                  36240000
362500     MOVE SU001-CARTON        TO DK-CTN.                          36250000
362600                                                                  36260000
362700     EXEC SQL                                                     36270000
362800         SELECT MAX(CRE_TMST)                                     36280000
362900           INTO :PV-TSHUNLO-CRE-TMST                              36290000
363000           FROM TSHUNLO                                           36300000
363100         WHERE SHIPT_UNT_ID = :DK-CTN                             36310000
363200     END-EXEC                                                     36320000
363300                                                                  36330000
363400                                                                  36340000
363500     EVALUATE TRUE                                                36350000
363600         WHEN SQLCODE = ZERO                                      36360000
363700            MOVE PV-TSHUNLO-CRE-TMST TO PV-TSHUNLO-TMST-EAI       36370000
363800         WHEN SQLWARN0 NOT = SPACES                               36380000
363900         WHEN SQLCODE < ZERO                                      36390000
364000         WHEN SQLCODE > ZERO                                      36400000
364100             MOVE '3569-SEL-MAX-CHECK-IN-TMST'                    36410000
364200                               TO DP013-PARAGRAPH                 36420000
364300             MOVE 'SELECT FROM TABLE  - '                         36430000
364400                               TO DP013-MESSAGE-TEXT (1)          36440000
364500             MOVE 'CHECK CSSL FOR MORE DETAIL     '               36450000
364600                                TO DP013-MESSAGE-TEXT (2)         36460000
364700             MOVE SU001-MANIFEST TO  PV-DISPLAY-MANIFEST          36470000
364800             MOVE SU001-CARTON   TO  PV-DISPLAY-CARTON            36480000
364900             MOVE SU001-STORE    TO  PV-DISPLAY-STORE             36490000
365000             STRING ' TRIP - '           DELIMITED BY SIZE        36500000
365100                    PV-DISPLAY-MANIFEST  DELIMITED BY SIZE        36510000
365200                    '  CARTON - '        DELIMITED BY SIZE        36520000
365300                    PV-DISPLAY-CARTON    DELIMITED BY SIZE        36530000
365400                     '  STORE - '         DELIMITED BY SIZE       36540000
365500                    PV-DISPLAY-STORE     DELIMITED BY SIZE        36550000
365600                              INTO DP013-MESSAGE-TEXT (3)         36560000
365700             MOVE SQLCA        TO DP013-SQLCA                     36570000
365800             MOVE 'TSHUNLO '   TO DP013-DB2-TABLE-NAME (1)        36580000
365900             SET DP013-DB2-ABEND                                  36590000
366000                 DP013-XCTL-DISPLAY-RESTART TO TRUE               36600000
366100             SET DP013-ROLLBACK                                   36610000
366200                               TO TRUE                            36620000
366300             PERFORM DP014-0000-PROCESS-ABEND                     36630000
366400     END-EVALUATE.                                                36640000
366500                                                                  36650000
371600                                                                  37160000
371800**********************************************************        37180000
371900 3580-INACTIVATE-XREF.                                            37190000
372000**********************************************************        37200000
372100**IF THE DIVERT STATUS HAS BEEN CHANGED SINCE THE CARTON *        37210000
372200**WAS ORIGINALLY SCANNED, INACTIVATE THE ORIGINAL ROW    *        37220000
372300**AND CONTINUE TO PROCESS TO INSERT A NEW ROW            *        37230000
372400**********************************************************        37240000
372500                                                                  37250000
372600     EXEC SQL                                                     37260000
372700          UPDATE TSULBXF                                          37270000
372800             SET                                                  37280000
372900                  STAT_CDE           = :PC-I                      37290000
373000                , LAST_STAT_CHG_TMST = CURRENT TIMESTAMP          37300000
373100          WHERE  SHIPT_UNT_ID        = :DK-CTN                    37310000
373200            AND  BRCDE_NBR           = :SULBXF-BRCDE-NBR          37320000
373300     END-EXEC                                                     37330000
373400                                                                  37340000
373500         EVALUATE TRUE                                            37350000
373600             WHEN SQLCODE = ZERO                                  37360000
373700                CONTINUE                                          37370000
373800             WHEN SQLWARN0 NOT = SPACES                           37380000
373900             WHEN SQLCODE < ZERO                                  37390000
374000             WHEN SQLCODE > ZERO                                  37400000
374100                 MOVE '3580-INACTIVATE-XREF'                      37410000
374200                                   TO DP013-PARAGRAPH             37420000
374300                 MOVE 'UPDATE XREF TABLE  - '                     37430000
374400                                   TO DP013-MESSAGE-TEXT (1)      37440000
374500                 MOVE SQLCA        TO DP013-SQLCA                 37450000
374600                 MOVE 'TSULBXF '   TO DP013-DB2-TABLE-NAME (1)    37460000
374700                 SET DP013-DB2-ABEND                              37470000
374800                     DP013-XCTL-DISPLAY-RESTART TO TRUE           37480000
374900                 SET DP013-ROLLBACK                               37490000
375000                                   TO TRUE                        37500000
375100                 PERFORM DP014-0000-PROCESS-ABEND                 37510000
375200         END-EVALUATE.                                            37520000
375300                                                                  37530000
375400 EJECT                                                            37540000
375500**********************************************************        37550000
375600 3581-INACTIVATE-OTBND-CART.                                      37560000
375700**********************************************************        37570000
375800**IF THE DIVERT STATUS HAS BEEN CHANGED SINCE THE CARTON *        37580000
375900**WAS ORIGINALLY SCANNED, INACTIVATE THE OUTBOUND ROW    *        37590000
376000**AND CONTINUE TO PROCESS TO INSERT A NEW ROW            *        37600000
376100**********************************************************        37610000
376200                                                                  37620000
376300     MOVE SULBXF-BRCDE-NBR       TO PV-BAR-CODE.                  37630000
376400     MOVE PV-BAR-CODE-OTBND      TO SUT00024-SHIPT-UNT-ID.        37640000
376500                                                                  37650000
376600     EXEC SQL                                                     37660000
376700          UPDATE SUT_OTBND_CART                                   37670000
376800             SET                                                  37680000
376900                  ACTV_IND           = 'N'                        37690000
377000          WHERE  ORIG_CART_ID        = :DK-CTN                    37700000
377100            AND  SHIPT_UNT_ID        = :SUT00024-SHIPT-UNT-ID     37710000
377200            AND  ACTV_IND            = 'Y'                        37720000
377300     END-EXEC                                                     37730000
377400                                                                  37740000
377500         EVALUATE TRUE                                            37750000
377600             WHEN SQLCODE = ZERO                                  37760000
377700             WHEN SQLCODE = +100                                  37770000
377800                CONTINUE                                          37780000
377900             WHEN SQLWARN0 NOT = SPACES                           37790000
378000             WHEN SQLCODE < ZERO                                  37800000
378100             WHEN SQLCODE > ZERO                                  37810000
378200                 MOVE '3581-INACTIVATE-OTBND-CART'                37820000
378300                                   TO DP013-PARAGRAPH             37830000
378400                 MOVE 'UPDATE OTBND TABLE  - '                    37840000
378500                                   TO DP013-MESSAGE-TEXT (1)      37850000
378600                 MOVE SQLCA        TO DP013-SQLCA                 37860000
378700                 MOVE 'SUT_OTBND_CART' TO DP013-DB2-TABLE-NAME (1)37870000
378800                 SET DP013-DB2-ABEND                              37880000
378900                     DP013-XCTL-DISPLAY-RESTART TO TRUE           37890000
379000                 SET DP013-ROLLBACK                               37900000
379100                                   TO TRUE                        37910000
379200                 PERFORM DP014-0000-PROCESS-ABEND                 37920000
379300         END-EVALUATE.                                            37930000
379400                                                                  37940000
379500 EJECT                                                            37950000
379600**********************************************************        37960000
379700 3600-CHECK-MESSAGE-TABLE.                                        37970000
379800**********************************************************        37980000
379900     MOVE SU001-PO         TO   DK-PO.                            37990000
380000     MOVE SU001-MANIFEST   TO   DK-MANIFEST.                      38000000
380100     MOVE SU001-RCVR-SEQ-NBR TO DK-REC-SEQ-NBR.                   38010000
380200     PERFORM 3605-CHECK-ERROR-MESSAGE-CODE.                       38020000
380300                                                                  38030000
380400     EXEC SQL                                                     38040000
380500         SELECT PO_NBR                                            38050000
380600         INTO   :LBVRMG-PO-NBR                                    38060000
380700         FROM   TLBVRMG                                           38070000
380800         WHERE PO_NBR          = :DK-PO                           38080000
380900           AND RCVR_SEQ_NBR    = :DK-REC-SEQ-NBR                  38090000
381000           AND PO_LNE_NBR      = :DK-PO-LNE-NBR                   38100000
381100           AND WRKR_USR_ID     = :SU001-USER-ID                   38110000
381200           AND CICS_SESS_ID    = :SU001-SESSION-ID                38120000
381300           AND TRIP_ID         = :DK-MANIFEST                     38130000
381400           AND ERR_MSG_CDE     = :DK-ERR-MSG-CDE                  38140000
381500     END-EXEC.                                                    38150000
381600                                                                  38160000
381700         EVALUATE TRUE                                            38170000
381800             WHEN SQLCODE = ZERO                                  38180000
381900                SET PS-DONE TO TRUE                               38190000
382000                SET PS-DONT-DISPLAY-SUKRF530 TO TRUE              38200000
382100             WHEN SQLCODE = +100                                  38210000
382200                PERFORM 3650-UPDATE-MESSAGE-TABLE                 38220000
382300                SET PS-DISPLAY-SUKRF530 TO TRUE                   38230000
382400             WHEN SQLWARN0 NOT = SPACES                           38240000
382500             WHEN SQLCODE < ZERO                                  38250000
382600             WHEN SQLCODE > ZERO                                  38260000
382700                 MOVE '3600-CHECK-MESSAGE-TABLE'                  38270000
382800                                   TO DP013-PARAGRAPH             38280000
382900                 MOVE 'SELECT FROM TABLE  - '                     38290000
383000                                   TO DP013-MESSAGE-TEXT (1)      38300000
383100                 MOVE SQLCA        TO DP013-SQLCA                 38310000
383200                 MOVE 'TLBVRMG '   TO DP013-DB2-TABLE-NAME (1)    38320000
383300                 SET DP013-DB2-ABEND                              38330000
383400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           38340000
383500                 SET DP013-ROLLBACK                               38350000
383600                                   TO TRUE                        38360000
383700                 PERFORM DP014-0000-PROCESS-ABEND                 38370000
383800         END-EVALUATE.                                            38380000
383900                                                                  38390000
384000 EJECT                                                            38400000
384100******************************************************************38410000
384200 3605-CHECK-ERROR-MESSAGE-CODE.                                   38420000
384300******************************************************************38430000
384400     EVALUATE TRUE                                                38440000
384500       WHEN SU001-UCC128-IGNORED                                  38450000
384600            MOVE 'I' TO DK-ERR-MSG-CDE                            38460000
384700                                                                  38470000
384800       WHEN SU001-UCC128-NOT-AVAILABLE                            38480000
384900            MOVE 'N' TO DK-ERR-MSG-CDE                            38490000
385000                                                                  38500000
385100       WHEN SU001-UCC128-NO-LABEL-DATA                            38510000
385200            MOVE 'L' TO DK-ERR-MSG-CDE                            38520000
385300                                                                  38530000
385400       WHEN SU001-UCC128-UNABLE-TO-ASSIGN                         38540000
385500            MOVE 'X' TO DK-ERR-MSG-CDE                            38550000
385600                                                                  38560000
385700       WHEN SU001-UCC128-CENTRAL-STOCK                            38570000
385800            MOVE 'C' TO DK-ERR-MSG-CDE                            38580000
385900                                                                  38590000
386000       WHEN SU001-UCC128-DUP-CTN                                  38600000
386100            MOVE 'D' TO DK-ERR-MSG-CDE                            38610000
386200                                                                  38620000
386300       WHEN SU001-UCC128-PREPK-ORD                                38630000
386400            MOVE 'P' TO DK-ERR-MSG-CDE                            38640000
386500                                                                  38650000
386600       WHEN SU001-UCC128-PBS-RCVR                                 38660000
386700            MOVE 'A' TO DK-ERR-MSG-CDE                            38670000
386800                                                                  38680000
386900       WHEN SU001-UCC128-NO-RCVR                                  38690000
387000            MOVE 'B' TO DK-ERR-MSG-CDE                            38700000
387100                                                                  38710000
387200       WHEN OTHER                                                 38720000
387300            MOVE 'G' TO DK-ERR-MSG-CDE                            38730000
387400       END-EVALUATE.                                              38740000
387500                                                                  38750000
387600**********************************************************        38760000
387700 3610-CHECK-LBVRMG-FREE-ASTR.                                     38770000
387800**********************************************************        38780000
387900     MOVE SU001-PO           TO   DK-PO.                          38790000
388000     MOVE SU001-MANIFEST     TO   DK-MANIFEST.                    38800000
388100     MOVE SU001-RCVR-SEQ-NBR TO   DK-REC-SEQ-NBR.                 38810000
388200     MOVE 'T'                TO   DK-ERR-MSG-CDE.                 38820000
388300                                                                  38830000
388400     EXEC SQL                                                     38840000
388500         SELECT PO_NBR                                            38850000
388600         INTO   :LBVRMG-PO-NBR                                    38860000
388700         FROM   TLBVRMG                                           38870000
388800         WHERE PO_NBR          = :DK-PO                           38880000
388900           AND RCVR_SEQ_NBR    = :DK-REC-SEQ-NBR                  38890000
389000           AND WRKR_USR_ID     = :SU001-USER-ID                   38900000
389100           AND CICS_SESS_ID    = :SU001-SESSION-ID                38910000
389200           AND TRIP_ID         = :DK-MANIFEST                     38920000
389300           AND ERR_MSG_CDE     = :DK-ERR-MSG-CDE                  38930000
389400     END-EXEC.                                                    38940000
389500                                                                  38950000
389600         EVALUATE TRUE                                            38960000
389700             WHEN SQLCODE = ZERO                                  38970000
389800             WHEN SQLCODE = -811                                  38980000
389900                SET PS-DONT-DISPLAY-SUKRF530 TO TRUE              38990000
390000             WHEN SQLCODE = +100                                  39000000
390100                SET PS-DISPLAY-SUKRF530 TO TRUE                   39010000
390200             WHEN SQLWARN0 NOT = SPACES                           39020000
390300             WHEN SQLCODE < ZERO                                  39030000
390400             WHEN SQLCODE > ZERO                                  39040000
390500                 MOVE '3610-CHECK-LBVRMG-FREE-ASTR'               39050000
390600                                   TO DP013-PARAGRAPH             39060000
390700                 MOVE 'SELECT FROM TABLE  - '                     39070000
390800                                   TO DP013-MESSAGE-TEXT (1)      39080000
390900                 MOVE SQLCA        TO DP013-SQLCA                 39090000
391000                 MOVE 'TLBVRMG '   TO DP013-DB2-TABLE-NAME (1)    39100000
391100                 SET DP013-DB2-ABEND                              39110000
391200                     DP013-XCTL-DISPLAY-RESTART TO TRUE           39120000
391300                 SET DP013-ROLLBACK                               39130000
391400                                   TO TRUE                        39140000
391500                 PERFORM DP014-0000-PROCESS-ABEND                 39150000
391600         END-EVALUATE.                                            39160000
391700                                                                  39170000
391800 EJECT                                                            39180000
391900**********************************************************        39190000
392000 3650-UPDATE-MESSAGE-TABLE.                                       39200000
392100**********************************************************        39210000
392200     EXEC SQL                                                     39220000
392300         INSERT INTO TLBVRMG                                      39230000
392400               ( PO_NBR                                           39240000
392500                ,RCVR_SEQ_NBR                                     39250000
392600                ,PO_LNE_NBR                                       39260000
392700                ,PREPK_ID                                         39270000
392800                ,WRKR_USR_ID                                      39280000
392900                ,TRIP_ID                                          39290000
393000                ,CICS_SESS_ID                                     39300000
393100                ,CRE_TMST                                         39310000
393200                ,ERR_MSG_CDE)                                     39320000
393300         VALUES (:DK-PO                                           39330000
393400               , :DK-REC-SEQ-NBR                                  39340000
393500               , :DK-PO-LNE-NBR                                   39350000
393600               , :DK-PREPK-ID                                     39360000
393700               , :SU001-USER-ID                                   39370000
393800               , :DK-MANIFEST                                     39380000
393900               , :SU001-SESSION-ID                                39390000
394000               , CURRENT TIMESTAMP                                39400000
394100               , :DK-ERR-MSG-CDE)                                 39410000
394200     END-EXEC.                                                    39420000
394300                                                                  39430000
394400         EVALUATE TRUE                                            39440000
394500             WHEN SQLCODE = ZERO                                  39450000
394600                SET PS-SUCCESSFUL-UPDATE TO TRUE                  39460000
394700             WHEN SQLCODE = +100                                  39470000
394800             WHEN SQLWARN0 NOT = SPACES                           39480000
394900             WHEN SQLCODE < ZERO                                  39490000
395000             WHEN SQLCODE > ZERO                                  39500000
395100                 MOVE '3650-UPDATE-MESSAGE-TABLE'                 39510000
395200                                   TO DP013-PARAGRAPH             39520000
395300                 MOVE 'UPDATE TABLE       - '                     39530000
395400                                   TO DP013-MESSAGE-TEXT (1)      39540000
395500                 MOVE SQLCA        TO DP013-SQLCA                 39550000
395600                 MOVE 'TLBVRMG '   TO DP013-DB2-TABLE-NAME (1)    39560000
395700                 SET DP013-DB2-ABEND                              39570000
395800                     DP013-XCTL-DISPLAY-RESTART TO TRUE           39580000
395900                 SET DP013-ROLLBACK                               39590000
396000                                   TO TRUE                        39600000
396100                 PERFORM DP014-0000-PROCESS-ABEND                 39610000
396200         END-EVALUATE.                                            39620000
396300                                                                  39630000
396400 EJECT                                                            39640000
396500 3655-REPRINT-LABELS.                                             39650000
396600                                                                  39660000
396700     PERFORM 3660-OPEN-REPRINT-CSR.                               39670000
396800                                                                  39680000
396900     INITIALIZE PV-REPRINT-CSR-CNT.                               39690000
397000     PERFORM 3670-FETCH-REPRINT-CSR.                              39700000
397100     PERFORM 3697-CHECK-FOR-PRINT.                                39710032
397200                                                                  39720000
397310     PERFORM UNTIL PS-END-OF-REPRINT-CSR                          39731000
397400        IF NOT SU001-PACK-BY-STORE                                39740017
397500            PERFORM 3680-GET-REPRINT-LBVRDA                       39750017
397600        END-IF                                                    39760017
397700        IF PV-REPRINT-CSR-CNT = 0                                 39770000
397800           SET PS-NO-CASEPK-FND TO TRUE                           39780000
397900           PERFORM 5005-PRINT-MESSAGE-LABELS                      39790000
398000        ELSE                                                      39800000
398100           PERFORM 5000-PRINT-LABEL                               39810000
398200           PERFORM 3670-FETCH-REPRINT-CSR                         39820000
398300        END-IF                                                    39830000
398400     END-PERFORM.                                                 39840000
398500                                                                  39850000
398600     PERFORM 3675-CLOSE-REPRINT-CSR.                              39860000
398700*IF NOT FOUND ON TSULBXF OR TLBVRDA  COUNT = 0                    39870000
398800     IF PV-REPRINT-CSR-CNT = 0                                    39880000
398900           SET SU001-UCC128-NO-LABEL-DATA TO TRUE                 39890000
399000           PERFORM 3600-CHECK-MESSAGE-TABLE                       39900000
399100     ELSE                                                         39910000
399200        IF SU001-ROWS-INSERTED >=                                 39920000
399300           SU001-PRT-LBL-ON-SCN-CNT                               39930000
399400             MOVE  SU001-BATCH-NUMBER TO SU001-BATCH-NO-USE       39940000
399500             MOVE  SU001-PRINTER-ID  TO SU001-PRINTER-ID-USE      39950000
399600             PERFORM 7300-START-LABEL-PRINT                       39960000
399700             PERFORM 2400-GET-BATCH-NUMBER                        39970000
399800             ADD  1  TO  PV-MAX-USER-BATCH                        39980000
399900                 GIVING  SU001-BATCH-NUMBER                       39990000
400000             MOVE  SU001-BATCH-NUMBER TO SU001-BATCH-NO-USE       40000000
400100             MOVE  ZEROES             TO SU001-ROWS-INSERTED      40010000
400200        END-IF                                                    40020000
400300     END-IF.                                                      40030000
400400                                                                  40040000
400500 3660-OPEN-REPRINT-CSR.                                           40050000
400600                                                                  40060000
400700         EXEC SQL                                                 40070000
400800              OPEN REPRINT-CSR                                    40080000
400900         END-EXEC                                                 40090000
401000                                                                  40100000
401100                                                                  40110000
401200         EVALUATE TRUE                                            40120000
401300             WHEN SQLCODE = ZERO                                  40130000
401400                 CONTINUE                                         40140000
401500             WHEN SQLWARN0 NOT = SPACES                           40150000
401600             WHEN SQLCODE < ZERO                                  40160000
401700             WHEN SQLCODE > ZERO                                  40170000
401800                 MOVE '3660-OPEN-REPRINT-CSR'                     40180000
401900                                   TO DP013-PARAGRAPH             40190000
402000                 MOVE 'OPEN REPRINT-CSR     '                     40200000
402100                                   TO DP013-MESSAGE-TEXT (1)      40210000
402200                 MOVE DK-CTN                                      40220000
402300                                   TO DP013-MESSAGE-TEXT (2)      40230000
402400                 MOVE SQLCA        TO DP013-SQLCA                 40240000
402500                 MOVE 'TSULBXF'    TO DP013-DB2-TABLE-NAME (1)    40250000
402600                 SET DP013-DB2-ABEND                              40260000
402700                     DP013-XCTL-DISPLAY-RESTART TO TRUE           40270000
402800                 SET DP013-ROLLBACK                               40280000
402900                                   TO TRUE                        40290000
403000                 PERFORM DP014-0000-PROCESS-ABEND                 40300000
403100         END-EVALUATE.                                            40310000
403200                                                                  40320000
403300 3670-FETCH-REPRINT-CSR.                                          40330000
403400                                                                  40340000
403500      EXEC SQL                                                    40350000
403600        FETCH REPRINT-CSR                                         40360000
403700        INTO     :SULBXF-BRCDE-NBR                                40370000
403800         END-EXEC                                                 40380000
403900                                                                  40390000
404000     EVALUATE TRUE                                                40400000
404100         WHEN SQLCODE = ZERO                                      40410000
404200              ADD +1 TO PV-REPRINT-CSR-CNT                        40420000
404300         WHEN SQLCODE = +100                                      40430000
404400              SET PS-END-OF-REPRINT-CSR TO TRUE                   40440000
404500         WHEN SQLWARN0 NOT = SPACE                                40450000
404600         WHEN SQLCODE NOT = ZERO                                  40460000
404700              MOVE '3370-FETCH-REPRINT-CSR'                       40470000
404800                               TO DP013-PARAGRAPH                 40480000
404900              MOVE 'FETCH REPRINT-CSR      '                      40490000
405000                               TO DP013-MESSAGE-TEXT (1)          40500000
405100              MOVE SQLCA       TO DP013-SQLCA                     40510000
405200              SET DP013-DB2-ABEND                                 40520000
405300                               TO TRUE                            40530000
405400                 SET DP013-ROLLBACK                               40540000
405500                                   TO TRUE                        40550000
405600              PERFORM DP014-0000-PROCESS-ABEND                    40560000
405700     END-EVALUATE.                                                40570000
405800                                                                  40580000
405900 3675-CLOSE-REPRINT-CSR.                                          40590000
406000                                                                  40600000
406100         EXEC SQL                                                 40610000
406200              CLOSE REPRINT-CSR                                   40620000
406300         END-EXEC                                                 40630000
406400                                                                  40640000
406500                                                                  40650000
406600         EVALUATE TRUE                                            40660000
406700             WHEN SQLCODE = ZERO                                  40670000
406800                 CONTINUE                                         40680000
406900             WHEN SQLWARN0 NOT = SPACES                           40690000
407000             WHEN SQLCODE < ZERO                                  40700000
407100             WHEN SQLCODE > ZERO                                  40710000
407200                 MOVE '3675-CLOSE-REPRINT-CSR'                    40720000
407300                                   TO DP013-PARAGRAPH             40730000
407400                 MOVE 'CLOSE REPRINT CSR    '                     40740000
407500                                   TO DP013-MESSAGE-TEXT (1)      40750000
407600                 MOVE DK-CTN                                      40760000
407700                                   TO DP013-MESSAGE-TEXT (2)      40770000
407800                 MOVE SQLCA        TO DP013-SQLCA                 40780000
407900                 MOVE 'TSULBXF'    TO DP013-DB2-TABLE-NAME (1)    40790000
408000                 SET DP013-DB2-ABEND                              40800000
408100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           40810000
408200                 SET DP013-ROLLBACK                               40820000
408300                                   TO TRUE                        40830000
408400                 PERFORM DP014-0000-PROCESS-ABEND                 40840000
408500         END-EVALUATE.                                            40850000
408600                                                                  40860000
408700 3680-GET-REPRINT-LBVRDA.                                         40870000
408800                                                                  40880000
408910     MOVE SU001-RCVR-SEQ-NBR TO DK-REC-SEQ-NBR.                   40891060
409000     EXEC SQL                                                     40900000
409100        SELECT   PREPK_ID                                         40910000
409200                ,LBL_ASG_SEQ_NBR                                  40920000
409300                ,CART_LBL_TYP_CDE                                 40930000
409400                ,PREPK_PRCG_LNE_NBR                               40940000
409500                ,INPK_UNT_QTY                                     40950000
409600                ,PREPK_RATO_QTY                                   40960000
409700                ,PREPK_UNT_QTY                                    40970000
409800                ,DEST_OPER_UNT_ID                                 40980000
409900                ,CSE_PK_QTY                                       40990000
410000                ,ODD_CART_IND                                     41000000
410100                ,INPK_CNVYB_IND                                   41010000
410200                ,LBL_TYP_LBL_SEQ_ID                               41020000
410300                ,LBL_TYP_TOT_QTY                                  41030000
410400                ,BRCDE_NBR                                        41040000
410500                ,STR_ZN_ID                                        41050000
410600                ,MODU_DESC                                        41060000
410700                ,ITM_NBR                                          41070000
410800                ,DEPT_DESC                                        41080000
410900                ,MAJ_CL_DESC                                      41090000
411000                ,SEASET_NM                                        41100000
411100                ,FIXT_ID                                          41110000
411200                ,STRG_AREA_CDE                                    41120000
411300                ,OTPK_UNT_QTY                                     41130000
411400                ,EAS_TAG_IND                                      41140000
411500                ,DOOR_ID                                          41150000
411600                ,HNG_FOLD_SEQ_NBR                                 41160000
411610*CLP 06/24/15 START                                               41161080
411700                ,LBL_MSG_TXT                                      41170080
411710*CLP 06/24/15 END                                                 41171080
411800        INTO     :LBVRDA-PREPK-ID                                 41180000
411900                ,:LBVRDA-LBL-ASG-SEQ-NBR                          41190000
412000                ,:LBVRDA-CART-LBL-TYP-CDE                         41200000
412100                ,:LBVRDA-PREPK-PRCG-LNE-NBR                       41210000
412200                ,:LBVRDA-INPK-UNT-QTY                             41220000
412300                ,:LBVRDA-PREPK-RATO-QTY                           41230000
412400                ,:LBVRDA-PREPK-UNT-QTY                            41240000
412500                ,:LBVRDA-DEST-OPER-UNT-ID                         41250000
412600                ,:LBVRDA-CSE-PK-QTY                               41260000
412700                ,:LBVRDA-ODD-CART-IND                             41270000
412800                ,:LBVRDA-INPK-CNVYB-IND                           41280000
412900                ,:LBVRDA-LBL-TYP-LBL-SEQ-ID                       41290000
413000                ,:LBVRDA-LBL-TYP-TOT-QTY                          41300000
413100                ,:LBVRDA-BRCDE-NBR                                41310000
413200                ,:LBVRDA-STR-ZN-ID                                41320000
413300                ,:LBVRDA-MODU-DESC                                41330000
413400                ,:LBVRDA-ITM-NBR                                  41340000
413500                ,:LBVRDA-DEPT-DESC                                41350000
413600                ,:LBVRDA-MAJ-CL-DESC                              41360000
413700                ,:LBVRDA-SEASET-NM                                41370000
413800                ,:LBVRDA-FIXT-ID                                  41380000
413900                ,:LBVRDA-STRG-AREA-CDE                            41390000
414000                ,:LBVRDA-OTPK-UNT-QTY                             41400000
414100                ,:LBVRDA-EAS-TAG-IND                              41410000
414200                ,:LBVRDA-DOOR-ID                                  41420000
414300                ,:LBVRDA-HNG-FOLD-SEQ-NBR                         41430000
414400                ,:LBVRDA-LBL-MSG-TXT                              41440080
414500        FROM TLBVRDA A                                            41450000
414600        WHERE  A.PO_NBR                =  :DK-PO                  41460000
414700          AND  A.RCVR_SEQ_NBR          =  :DK-REC-SEQ-NBR         41470000
415000          AND  A.BRCDE_NBR             =  :SULBXF-BRCDE-NBR       41500000
415100     END-EXEC                                                     41510000
415200                                                                  41520000
415300      EVALUATE TRUE                                               41530000
415400          WHEN SQLCODE = ZERO                                     41540000
415500              MOVE  LBVRDA-DEST-OPER-UNT-ID TO SU001-STORE        41550000
415600              PERFORM 7210-GET-STORE-INFO                         41560000
415700          WHEN SQLCODE = +100                                     41570000
415800             SET PS-END-OF-REPRINT-CSR TO TRUE                    41580000
415900             INITIALIZE PV-REPRINT-CSR-CNT                        41590000
416000          WHEN SQLWARN0 NOT = SPACES                              41600000
416100          WHEN SQLCODE < ZERO                                     41610000
416200          WHEN SQLCODE > ZERO                                     41620000
416300              MOVE '3500-GET-VIRTUAL-LABEL-DATA'                  41630000
416400                                TO DP013-PARAGRAPH                41640000
416500              MOVE 'UPDATE TABLE       - '                        41650000
416600                                TO DP013-MESSAGE-TEXT (1)         41660000
416700              MOVE SQLCA        TO DP013-SQLCA                    41670000
416800              MOVE 'TLBVRDA '   TO DP013-DB2-TABLE-NAME (1)       41680000
416900              SET DP013-DB2-ABEND                                 41690000
417000                  DP013-XCTL-DISPLAY-RESTART TO TRUE              41700000
417100              SET DP013-ROLLBACK                                  41710000
417200                                TO TRUE                           41720000
417300              PERFORM DP014-0000-PROCESS-ABEND                    41730000
417400      END-EVALUATE.                                               41740000
417500                                                                  41750000
417600**********************************************************        41760000
417700 3685-CHECK-UCC128-USE.                                           41770000
417800**********************************************************        41780000
417900                                                                  41790000
418000     MOVE SU001-PO            TO DK-PO.                           41800000
418100     MOVE SU001-RCVR-SEQ-NBR  TO DK-REC-SEQ-NBR.                  41810000
418200     MOVE SU001-PO-LINE-NBR   TO DK-PO-LNE-NBR                    41820000
418300                                 PV-PO-LINE-N.                    41830000
418400                                                                  41840000
418500     EXEC SQL                                                     41850000
418600        SELECT   UCC128_DAT_USG_CDE                               41860000
418700                ,TOT_CART_CNT                                     41870000
418800        INTO     :DISTHD-UCC128-DAT-USG-CDE                       41880000
418900                ,:DISTHD-TOT-CART-CNT                             41890000
419000        FROM TDISTHD A                                            41900000
419100        WHERE  A.ORD_NBR               =  :DK-PO                  41910000
419200          AND  A.RCVR_SEQ_NBR          =  :DK-REC-SEQ-NBR         41920000
419300          AND  A.ORD_LNE_NBR           =  :DK-PO-LNE-NBR          41930000
419400     END-EXEC                                                     41940000
419500                                                                  41950000
419600      EVALUATE TRUE                                               41960000
419700          WHEN SQLCODE = ZERO                                     41970000
419800             MOVE DISTHD-UCC128-DAT-USG-CDE                       41980000
419900                                TO PV-UCC128-DAT-USG-CDE          41990000
420000          WHEN SQLCODE = +100                                     42000000
420100             MOVE SPACES TO PV-UCC128-DAT-USG-CDE                 42010000
420200          WHEN SQLWARN0 NOT = SPACES                              42020000
420300          WHEN SQLCODE < ZERO                                     42030000
420400          WHEN SQLCODE > ZERO                                     42040000
420500              MOVE '3685-CHECK-UCC128-USE'                        42050000
420600                                TO DP013-PARAGRAPH                42060000
420700              MOVE 'UPDATE TABLE       - '                        42070000
420800                                TO DP013-MESSAGE-TEXT (1)         42080000
420900              MOVE SQLCA        TO DP013-SQLCA                    42090000
421000              MOVE 'TDISTHD '   TO DP013-DB2-TABLE-NAME (1)       42100000
421100              SET DP013-DB2-ABEND                                 42110000
421200                  DP013-XCTL-DISPLAY-RESTART TO TRUE              42120000
421300              SET DP013-ROLLBACK                                  42130000
421400                                TO TRUE                           42140000
421500              PERFORM DP014-0000-PROCESS-ABEND                    42150000
421600      END-EVALUATE.                                               42160000
421700                                                                  42170000
421800**********************************************************        42180000
421900**********************************************************        42190000
422000 3690-CHECK-SULBXF-FOR-ACTIVE.                                    42200000
422100**********************************************************        42210000
422200                                                                  42220000
422300     MOVE SU001-CARTON        TO DK-CTN.                          42230000
422400                                                                  42240000
422500     EXEC SQL                                                     42250000
422600        SELECT   BRCDE_NBR                                        42260000
422700        INTO   :SULBXF-BRCDE-NBR                                  42270000
422800        FROM TSULBXF A                                            42280000
422900        WHERE  A.SHIPT_UNT_ID          =   :DK-CTN                42290000
423000          AND  A.STAT_CDE              =   'A'                    42300000
423100     END-EXEC                                                     42310000
423200                                                                  42320000
423300      EVALUATE TRUE                                               42330000
423400          WHEN SQLCODE = ZERO                                     42340000
423500          WHEN SQLCODE = -811                                     42350000
423600             SET PS-ACTIVE-XREF-ROW-FOUND  TO TRUE                42360000
423700          WHEN SQLCODE = +100                                     42370000
423800             PERFORM 3695-CHECK-SULBXF-2                          42380000
423900          WHEN SQLWARN0 NOT = SPACES                              42390000
424000          WHEN SQLCODE < ZERO                                     42400000
424100          WHEN SQLCODE > ZERO                                     42410000
424200              MOVE '3690-CHECK-SULBXF-FOR-ACTIVE'                 42420000
424300                                TO DP013-PARAGRAPH                42430000
424400              MOVE 'SELECT FROM TABLE  - '                        42440000
424500                                TO DP013-MESSAGE-TEXT (1)         42450000
424600              MOVE SQLCA        TO DP013-SQLCA                    42460000
424700              MOVE 'TSULBXF '   TO DP013-DB2-TABLE-NAME (1)       42470000
424800              SET DP013-DB2-ABEND                                 42480000
424900                  DP013-XCTL-DISPLAY-RESTART TO TRUE              42490000
425000              SET DP013-ROLLBACK                                  42500000
425100                                TO TRUE                           42510000
425200              PERFORM DP014-0000-PROCESS-ABEND                    42520000
425300      END-EVALUATE.                                               42530000
425400                                                                  42540000
425500**********************************************************        42550000
425600 3695-CHECK-SULBXF-2.                                             42560000
425700**********************************************************        42570000
425800                                                                  42580000
425900     EXEC SQL                                                     42590000
426000        SELECT  BRCDE_NBR                                         42600000
426100        INTO   :SULBXF-BRCDE-NBR                                  42610000
426200        FROM   TSULBXF A                                          42620000
426300        WHERE  A.SHIPT_UNT_ID          =   :DK-CTN                42630000
426400          AND  A.STAT_CDE              =   'I'                    42640000
426500     END-EXEC                                                     42650000
426600                                                                  42660000
426700      EVALUATE TRUE                                               42670000
426800          WHEN SQLCODE = ZERO                                     42680000
426900          WHEN SQLCODE = -811                                     42690000
427000             SET PS-ACTIVE-XREF-ROW-NOT-FOUND TO TRUE             42700000
427100          WHEN SQLCODE = +100                                     42710000
427200             SET PS-SULBXF-RECORD-NOT-FOUND TO TRUE               42720000
427300          WHEN SQLWARN0 NOT = SPACES                              42730000
427400          WHEN SQLCODE < ZERO                                     42740000
427500          WHEN SQLCODE > ZERO                                     42750000
427600              MOVE '3695-CHECK-SULBXF-2  '                        42760000
427700                                TO DP013-PARAGRAPH                42770000
427800              MOVE 'SELECT FROM TABLE  - '                        42780000
427900                                TO DP013-MESSAGE-TEXT (1)         42790000
428000              MOVE SQLCA        TO DP013-SQLCA                    42800000
428100              MOVE 'TSULBXF '   TO DP013-DB2-TABLE-NAME (1)       42810000
428200              SET DP013-DB2-ABEND                                 42820000
428300                  DP013-XCTL-DISPLAY-RESTART TO TRUE              42830000
428400              SET DP013-ROLLBACK                                  42840000
428500                                TO TRUE                           42850000
428600              PERFORM DP014-0000-PROCESS-ABEND                    42860000
428700      END-EVALUATE.                                               42870000
428800                                                                  42880000
428900**********************************************************        42890000
429000 3696-CHECK-SULBXF-FOR-PBS.                                       42900000
429100**********************************************************        42910000
429200                                                                  42920000
429300     MOVE SU001-CARTON        TO DK-CTN.                          42930000
429400                                                                  42940000
429500     EXEC SQL                                                     42950000
429600        SELECT   BRCDE_NBR                                        42960000
429700        INTO   :SULBXF-BRCDE-NBR                                  42970000
429800        FROM TSULBXF A                                            42980000
429900        WHERE  A.SHIPT_UNT_ID          =   :DK-CTN                42990000
430000          AND  A.STAT_CDE              =   'A'                    43000000
430100     END-EXEC                                                     43010000
430200                                                                  43020000
430300      EVALUATE TRUE                                               43030000
430400          WHEN SQLCODE = ZERO                                     43040000
430500          WHEN SQLCODE = -811                                     43050000
430600             SET PS-XREF-PBS-FOUND         TO TRUE                43060000
430700          WHEN SQLCODE = +100                                     43070000
430800             SET PS-XREF-PBS-NOT-FOUND    TO TRUE                 43080000
430900          WHEN SQLWARN0 NOT = SPACES                              43090000
431000          WHEN SQLCODE < ZERO                                     43100000
431100          WHEN SQLCODE > ZERO                                     43110000
431200              MOVE '3696-CHECK-SULBXF-FOR-ACTIVE'                 43120000
431300                                TO DP013-PARAGRAPH                43130000
431400              MOVE 'SELECT FROM TABLE  - '                        43140000
431500                                TO DP013-MESSAGE-TEXT (1)         43150000
431600              MOVE DK-CTN       TO DP013-MESSAGE-TEXT (2)         43160000
431700              MOVE SQLCA        TO DP013-SQLCA                    43170000
431800              MOVE 'TSULBXF '   TO DP013-DB2-TABLE-NAME (1)       43180000
431900              SET DP013-DB2-ABEND                                 43190000
432000                  DP013-XCTL-DISPLAY-RESTART TO TRUE              43200000
432100              SET DP013-ROLLBACK                                  43210000
432200                                TO TRUE                           43220000
432300              PERFORM DP014-0000-PROCESS-ABEND                    43230000
432400      END-EVALUATE.                                               43240000
432500                                                                  43250000
432600 3697-CHECK-FOR-PRINT.                                            43260032
432700                                                                  43270045
432800     SET PS-NO-CARTON-PRINTED TO TRUE.                            43280044
432900     EXEC SQL                                                     43290037
433000        SELECT  A.SCN_LOC_ID                                      43300037
433100            INTO :SHUNLO-SCN-LOC-ID                               43310038
433200       FROM TSHUNLO A                                             43320032
433300       WHERE  A.SHIPT_UNT_ID   = :DK-CTN                          43330032
433400         AND A.SCN_LOC_ID  LIKE ('RFD%')                          43340032
433500         AND  A.ACTV_CDE  = 'I'                                   43350032
433600         AND A.CRE_TMST =                                         43360032
433700             (SELECT MAX(B.CRE_TMST)                              43370032
433800              FROM TSHUNLO B                                      43380032
433900              WHERE  B.SHIPT_UNT_ID   = :DK-CTN                   43390032
434000              AND  B.ACTV_CDE  = 'I'                              43400032
434100              AND B.SCN_LOC_ID  LIKE ('RFD%') )                   43410032
434200     END-EXEC.                                                    43420032
434300                                                                  43430032
434400     EVALUATE TRUE                                                43440032
434500          WHEN SQLCODE = ZERO                                     43450032
434600             IF SHUNLO-SCN-LOC-ID = 'RFDC'                        43460036
434700                PERFORM 7410-CREATE-NEW-TSHUNLO                   43470057
434800             END-IF                                               43480032
434900             IF SHUNLO-SCN-LOC-ID = 'RFDF'                        43490036
435000                SET PS-CARTON-PRINTED TO TRUE                     43500044
435100*               SEND MESSAGE TO SCREEN THAT CARTON WAS PRINTED    43510050
435200             END-IF                                               43520032
435300          WHEN SQLCODE = +100                                     43530032
435400                 CONTINUE                                         43540032
435500*                TAKEN CARE OF IN 0510-CHECK-PRINT FOR NOT FOUND  43550044
435600          WHEN SQLWARN0 NOT = SPACES                              43560032
435700          WHEN SQLCODE < ZERO                                     43570032
435800          WHEN SQLCODE > ZERO                                     43580032
435900              MOVE '3697-CHECK-FOR-PRINT'                         43590040
436000                                TO DP013-PARAGRAPH                43600032
436100              MOVE 'SELECT FROM TABLE  - '                        43610032
436200                                TO DP013-MESSAGE-TEXT (1)         43620032
436300              MOVE DK-CTN       TO DP013-MESSAGE-TEXT (2)         43630032
436400              MOVE SQLCA        TO DP013-SQLCA                    43640032
436500              MOVE 'TSHUNLO '   TO DP013-DB2-TABLE-NAME (1)       43650032
436600              SET DP013-DB2-ABEND                                 43660032
436700                  DP013-XCTL-DISPLAY-RESTART TO TRUE              43670032
436800              SET DP013-ROLLBACK                                  43680032
436900                                TO TRUE                           43690032
437000              PERFORM DP014-0000-PROCESS-ABEND                    43700032
437100     END-EVALUATE.                                                43710032
437200                                                                  43720032
437300******************************************************************43730000
437400 4000-XCTL-LRT-MENU.                                              43740000
437500******************************************************************43750000
437600******************************************************************43760000
437700             IF PV-TEST-CICS OR PV-QA-CICS                        43770000
437800                EXEC SQL                                          43780000
437900                   SET :PV-END-TIME = CURRENT TIMESTAMP           43790000
438000                END-EXEC                                          43800000
438100                MOVE SPACES TO PV-CICS-MSG-AREA-A                 43810000
438200                STRING 'SUKRF706 BEG TIME '  DELIMITED BY SIZE    43820000
438300                     PV-BEGIN-TIME           DELIMITED BY SIZE    43830000
438400                                        INTO PV-CICS-MSG-AREA-B   43840000
438500                MOVE LENGTH OF PV-CICS-MSG-AREA-A                 43850000
438600                                        TO PV-COMMAREA-LENGTH     43860000
438700                PERFORM 9998-WRITE-TO-CSSL                        43870000
438800*                                                                 43880000
438900                MOVE SPACES TO PV-CICS-MSG-AREA-A                 43890000
439000                STRING 'SUKRF706 END TIME '    DELIMITED BY SIZE  43900000
439100                         PV-END-TIME         DELIMITED BY SIZE    43910000
439200                       ' - '                 DELIMITED BY SIZE    43920000
439300                       PV-TRANSFER-PROGRAM   DELIMITED BY SIZE    43930000
439400                                        INTO PV-CICS-MSG-AREA-B   43940000
439500                MOVE LENGTH OF PV-CICS-MSG-AREA-A                 43950000
439600                                        TO PV-COMMAREA-LENGTH     43960000
439700                PERFORM 9998-WRITE-TO-CSSL                        43970000
439800             END-IF                                               43980000
439900******************************************************************43990000
440000     SET SU001-INITIALIZE-SCREEN  TO TRUE.                        44000000
440100     MOVE PC-CURRENT-PROGRAM-NAME TO SU001-LAST-PROGRAM.          44010000
440200                                                                  44020000
440300     MOVE LENGTH OF CA-COMMAREA   TO PV-COMMAREA-LENGTH           44030000
440400     EXEC CICS                                                    44040000
440500         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    44050000
440600               COMMAREA  (CA-COMMAREA)                            44060000
440700               LENGTH    (PV-COMMAREA-LENGTH)                     44070000
440800               RESP      (PV-CICS-RESPONSE)                       44080000
440900     END-EXEC.                                                    44090000
441000                                                                  44100000
441100     EVALUATE TRUE                                                44110000
441200         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 44120000
441300             CONTINUE                                             44130000
441400         WHEN OTHER                                               44140000
441500             MOVE '4000-XCTL-TO-LRT-MENU'                         44150000
441600                 TO DP013-PARAGRAPH                               44160000
441700             MOVE 'SUKRF706 - UNABLE TO XCTL TO PROGRAM: '        44170000
441800                 TO DP013-MESSAGE-TEXT (1)                        44180000
441900             MOVE PV-TRANSFER-PROGRAM                             44190000
442000                 TO DP013-MESSAGE-TEXT (2)                        44200000
442100             SET DP013-CICS-ABEND  TO TRUE                        44210000
442200             SET DP013-ROLLBACK TO TRUE                           44220000
442300             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               44230000
442400             MOVE PC-TRANS-UNAVAILABLE-MSG TO AMSGLNO             44240000
442500             SET SU001-PROCESS-SCREEN TO TRUE                     44250000
442600             PERFORM 8000-SEND-MAP                                44260000
442700             PERFORM 8200-RETURN-TRANID                           44270000
442800     END-EVALUATE.                                                44280000
442900                                                                  44290000
443000******************************************************************44300000
443100                                                                  44310000
443200*                                                                 44320000
443300 4200-XCTL-TO-HELP.                                               44330000
443400                                                                  44340000
443500     MOVE LENGTH OF PC192-COMMAREA    TO PV-COMMAREA-LENGTH.      44350000
443600     SET  SU001-INITIALIZE-SCREEN     TO TRUE.                    44360000
443700     MOVE SU001-COMMON-DATA           TO PC192-HOST-SAVE-AREA.    44370000
443800                                                                  44380000
443900     EXEC CICS                                                    44390000
444000         XCTL                                                     44400000
444100             PROGRAM   (PV-TRANSFER-PROGRAM)                      44410000
444200             COMMAREA  (PC192-COMMAREA)                           44420000
444300             LENGTH    (PV-COMMAREA-LENGTH)                       44430000
444400             RESP      (PV-CICS-RESPONSE)                         44440000
444500     END-EXEC.                                                    44450000
444600                                                                  44460000
444700     EVALUATE TRUE                                                44470000
444800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 44480000
444900              CONTINUE                                            44490000
445000         WHEN OTHER                                               44500000
445100             MOVE '4200-XCTL-TO-HELP '                            44510000
445200                 TO DP013-PARAGRAPH                               44520000
445300             MOVE 'SUKRF706 - UNABLE TO XCTL TO PROGRAM: '        44530000
445400                 TO DP013-MESSAGE-TEXT (1)                        44540000
445500             MOVE PV-TRANSFER-PROGRAM                             44550000
445600                 TO DP013-MESSAGE-TEXT (2)                        44560000
445700             SET DP013-CICS-ABEND  TO TRUE                        44570000
445800             SET DP013-ROLLBACK TO TRUE                           44580000
445900             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               44590000
446000             MOVE PC-TRANS-UNAVAILABLE-MSG TO AMSGLNO             44600000
446100             SET SU001-PROCESS-SCREEN TO TRUE                     44610000
446200             PERFORM 8000-SEND-MAP                                44620000
446300             PERFORM 8200-RETURN-TRANID                           44630000
446400     END-EVALUATE.                                                44640000
446500                                                                  44650000
446600 4250-LINK-TO-FRASTY-HANDLER.                                     44660000
446700                                                                  44670000
446800                                                                  44680000
446900*    INITIALIZE SU044-COMM-AREA.                                  44690000
447000     MOVE SU001-CARTON             TO SU044-SHIPT-UNT-ID.         44700000
447100     MOVE SU001-PO                 TO SU044-PO.                   44710000
447200     MOVE SU001-RCVR-SEQ-NBR       TO SU044-ORIG-REC-SEQ-NBR.     44720000
447300     MOVE SU001-OPER-UNT-ID        TO SU044-OPER-UNT-ID.          44730000
447400     MOVE SU001-FCLTY-ID           TO SU044-FCLTY-ID.             44740000
447500     MOVE SU001-OWNER-SCAC-ID      TO SU044-SCAC-ID.              44750000
447600     MOVE SU001-MANIFEST           TO SU044-TRIP-ID.              44760000
447700     MOVE SU001-VEH-NBR            TO SU044-VEH-NBR.              44770000
447800     MOVE SU001-ORIGIN-OPER-UNT-ID TO SU044-CRTN-OPER-UNT-ID.     44780000
447900     MOVE PC-CURRENT-PROGRAM-NAME  TO SU044-PROGRAM-NAME.         44790000
448000     MOVE SU001-USER-ID            TO SU044-SIGNON-USER-ID.       44800000
448100     SET  SU044-SRC-CHECKIN        TO TRUE.                       44810000
448200     IF SU001-PACK-BY-STORE                                       44820000
448300        SET SU044-RCVR-PBS         TO TRUE                        44830000
448400        MOVE SU001-STORE           TO SU044-DEST-STR-NBR          44840000
448500     ELSE                                                         44850000
448600        MOVE ZEROES                TO SU044-DEST-STR-NBR          44860000
448700        IF RECEIV-PKGNG-CDE  = PC-M OR PC-I                       44870000
448800           SET SU044-RCVR-PREPK    TO TRUE                        44880000
448900        ELSE                                                      44890000
449000           SET SU044-RCVR-BULK     TO TRUE                        44900000
449100        END-IF                                                    44910000
449200     END-IF                                                       44920000
449300                                                                  44930000
449400     MOVE LENGTH OF SU044-COMM-AREA TO  PV-COMMAREA-LENGTH.       44940000
449500                                                                  44950000
449600     EXEC CICS                                                    44960000
449700         LINK PROGRAM  (PC-FA-HANDLER-PGM)                        44970000
449800              COMMAREA (SU044-COMM-AREA)                          44980000
449900              LENGTH   (PV-COMMAREA-LENGTH)                       44990000
450000     END-EXEC.                                                    45000000
450100                                                                  45010000
450200                                                                  45020000
450300     EVALUATE TRUE                                                45030000
450400         WHEN SU044-SUCCESSFUL                                    45040000
450500              CONTINUE                                            45050000
450600         WHEN OTHER                                               45060000
450700              SET PV-DONE-PROCESSING          TO TRUE             45070000
450800              MOVE SQLCODE              TO PV-SQLCODE             45080000
450900              STRING ' SUKRF706 (OTHER) -' DELIMITED BY SIZE      45090000
451000                     '4250-LINK-SUKUT705 ' DELIMITED BY SIZE      45100000
451100                     ' RETURN MESSAGE - '  DELIMITED BY SIZE      45110000
451200                     SU044-CRA-RET-MSG     DELIMITED BY SIZE      45120000
451300                     '  PARA-'             DELIMITED BY SIZE      45130000
451400                     SU044-CRA-REQ-ID      DELIMITED BY SIZE      45140000
451500                                      INTO PV-CICS-MSG-AREA       45150000
451600              MOVE LENGTH OF PV-CICS-MSG-AREA                     45160000
451700                                        TO PV-COMMAREA-LENGTH     45170000
451800              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              45180000
451900                                                                  45190000
452000              MOVE '4250-LINK-SUKUT705   '                        45200000
452100                              TO DP013-PARAGRAPH                  45210000
452200              MOVE 'LINK TO SUKUT705               '              45220000
452300                              TO DP013-MESSAGE-TEXT(1)            45230000
452400              STRING 'MSG - '            DELIMITED BY SIZE        45240000
452500                     SU044-CRA-RET-MSG   DELIMITED BY SIZE        45250000
452600                              INTO DP013-MESSAGE-TEXT (2)         45260000
452700              MOVE 'CHECK CSSL FOR MORE DETAIL     '              45270000
452800                                TO DP013-MESSAGE-TEXT (3)         45280000
452900              MOVE SU001-MANIFEST TO  PV-DISPLAY-MANIFEST         45290000
453000              MOVE SU001-CARTON   TO  PV-DISPLAY-CARTON           45300000
453100              MOVE SU001-STORE    TO  PV-DISPLAY-STORE            45310000
453200              STRING ' TRIP - '           DELIMITED BY SIZE       45320000
453300                     PV-DISPLAY-MANIFEST  DELIMITED BY SIZE       45330000
453400                     '  CARTON - '        DELIMITED BY SIZE       45340000
453500                     PV-DISPLAY-CARTON    DELIMITED BY SIZE       45350000
453600                     '  STORE - '         DELIMITED BY SIZE       45360000
453700                     PV-DISPLAY-STORE     DELIMITED BY SIZE       45370000
453800                              INTO DP013-MESSAGE-TEXT (4)         45380000
453900              MOVE SQLCA     TO DP013-SQLCA                       45390000
454000              SET DP013-DB2-ABEND                                 45400000
454100                              TO TRUE                             45410000
454200              SET DP013-ROLLBACK                                  45420000
454300                              TO TRUE                             45430000
454400              SET DP013-XCTL-DISPLAY-RESTART                      45440000
454500                              TO TRUE                             45450000
454600              PERFORM DP014-0000-PROCESS-ABEND                    45460000
454700     END-EVALUATE.                                                45470000
454800                                                                  45480000
454900                                                                  45490000
455000*----------------------------------------------------------------*45500000
455100* CHECK IF PO/RECEIVER IS IN TROUBLE                             *45510000
455200* EXCEPTIONS ARE STORAGE TROUBLE (999,301,998,)  AND             *45520000
455300* PBS EDIT TROUBLE  (350,351,352,353,354)                        *45530000
455400*----------------------------------------------------------------*45540000
455500 4450-CHECK-TROUBLE.                                              45550000
455600     MOVE SU001-RCVR-SEQ-NBR       TO DK-REC-SEQ-NBR.             45560000
455700     MOVE ZEROES                   TO PV-TROUBLE-COUNT.           45570000
455800                                                                  45580000
455900     EXEC SQL                                                     45590000
456000        SELECT COUNT(*)                                           45600000
456100          INTO :PV-TROUBLE-COUNT                                  45610000
456200          FROM TTRBNTF A                                          45620000
456300              ,TTRBRSN C                                          45630000
456400         WHERE A.PO_NBR       =  :DK-PO                           45640000
456500           AND A.REC_SEQ_NBR  =  :DK-REC-SEQ-NBR                  45650000
456600           AND A.RESOLVED_IND IN ('N','I','R')                    45660000
456700           AND A.TRBL_RSN_CDE = C.TRBL_RSN_CDE                    45670000
456800           AND C.NOTIF_IND    =  'T'                              45680000
456900           AND NOT EXISTS                                         45690000
457000              ( SELECT *                                          45700000
457100                FROM  TTRBRCN B                                   45710000
457200                WHERE B.RPT_PGM_NM  = 'SUKRF706'                  45720000
457300                  AND A.TRBL_RSN_CDE  =  B.TRBL_RSN_CDE )         45730000
457400     END-EXEC                                                     45740000
457500                                                                  45750000
457600     EVALUATE TRUE                                                45760000
457700         WHEN SQLCODE = ZERO                                      45770000
457800             IF PV-TROUBLE-COUNT > +0                             45780000
457900                SET PS-TROUBLE-FOUND TO TRUE                      45790000
458000             ELSE                                                 45800000
458100                SET PS-NO-TROUBLE-FOUND TO TRUE                   45810000
458200             END-IF                                               45820000
458300         WHEN SQLCODE = +100                                      45830000
458400             SET PS-NO-TROUBLE-FOUND TO TRUE                      45840000
458500         WHEN SQLWARN0 NOT = SPACES                               45850000
458600         WHEN SQLCODE < ZERO                                      45860000
458700         WHEN SQLCODE > ZERO                                      45870000
458800             MOVE SU001-CARTON   TO  PV-DISPLAY-CARTON            45880000
458900             MOVE DK-PO          TO  PV-DISPLAY-PO                45890000
459000             MOVE DK-REC-SEQ-NBR TO  PV-DISPLAY-PO-RCVR           45900000
459100             MOVE '4450-CHECK-TROUBLE      '                      45910000
459200                             TO DP013-PARAGRAPH                   45920000
459300             MOVE 'SUKRF706 - CHECK FOR TROUBLE   '               45930000
459400                             TO DP013-MESSAGE-TEXT(1)             45940000
459500             STRING '  CARTON - '        DELIMITED BY SIZE        45950000
459600                    PV-DISPLAY-CARTON    DELIMITED BY SIZE        45960000
459700                    ' PO, RCVR   '       DELIMITED BY SIZE        45970000
459800                    PV-DISPLAY-PO        DELIMITED BY SIZE        45980000
459900                    ' '                  DELIMITED BY SIZE        45990000
460000                    PV-DISPLAY-PO-RCVR   DELIMITED BY SIZE        46000000
460100                    ' '                  DELIMITED BY SIZE        46010000
460200                             INTO DP013-MESSAGE-TEXT (2)          46020000
460300             MOVE SQLCA      TO DP013-SQLCA                       46030000
460400             MOVE 'TTRBNTF'  TO DP013-DB2-TABLE-NAME(1)           46040000
460500             SET DP013-DB2-ABEND                                  46050000
460600                             TO TRUE                              46060000
460700             SET DP013-ROLLBACK                                   46070000
460800                             TO TRUE                              46080000
460900             SET DP013-XCTL-DISPLAY-RESTART                       46090000
461000                             TO TRUE                              46100000
461100             PERFORM DP014-0000-PROCESS-ABEND                     46110000
461200                                                                  46120000
461300     END-EVALUATE.                                                46130000
461400                                                                  46140000
461500/                                                                 46150000
461600*----------------------------------------------------------------*46160000
461700* CHECK IF THE PBS PO/RCVR THAT IS IN TROUBLE NEEDS TO CONTINUE  *46170000
461800* TO BE CHECKED FOR QC AUDIT                                     *46180000
461900*----------------------------------------------------------------*46190000
462000 4460-CHECK-PO-AUD-REQ.                                           46200000
462100     MOVE SU001-PO                 TO SUT00015-PO-NBR.            46210000
462200     MOVE SU001-RCVR-SEQ-NBR       TO SUT00015-RCVR-SEQ-NBR.      46220000
462300                                                                  46230000
462400     EXEC SQL                                                     46240000
462500         SELECT CART_PRMPT_CDE                                    46250000
462600         INTO   :SUT00015-CART-PRMPT-CDE                          46260000
462700         FROM  SUT_PO_AUD_REQ                                     46270000
462800         WHERE  PO_NBR           =  :SUT00015-PO-NBR              46280000
462900          AND   RCVR_SEQ_NBR     =  :SUT00015-RCVR-SEQ-NBR        46290000
463000     END-EXEC                                                     46300000
463100                                                                  46310000
463200     EVALUATE TRUE                                                46320000
463300         WHEN SQLCODE = ZERO                                      46330000
463400              IF SUT00015-CART-PRMPT-CDE = 'C'                    46340000
463500                 SET PS-AUDIT-PROMPT-CHECK-YES TO TRUE            46350000
463600              ELSE                                                46360000
463700                 SET PS-AUDIT-PROMPT-CHECK-NO TO TRUE             46370000
463800              END-IF                                              46380000
463900         WHEN SQLCODE = +100                                      46390000
464000              SET PS-AUDIT-PROMPT-CHECK-YES TO TRUE               46400000
464100         WHEN SQLWARN0 NOT = SPACES                               46410000
464200         WHEN SQLCODE < ZERO                                      46420000
464300         WHEN SQLCODE > ZERO                                      46430000
464400             MOVE SU001-CARTON   TO  PV-DISPLAY-CARTON            46440000
464500             MOVE DK-PO          TO  PV-DISPLAY-PO                46450000
464600             MOVE DK-REC-SEQ-NBR TO  PV-DISPLAY-PO-RCVR           46460000
464700             MOVE '4460-CHECK-PO-AUD-REQ   '                      46470000
464800                             TO DP013-PARAGRAPH                   46480000
464900             MOVE 'SUKRF706 - CHECK FOR AUDIT REQ '               46490000
465000                             TO DP013-MESSAGE-TEXT(1)             46500000
465100             STRING '  CARTON - '        DELIMITED BY SIZE        46510000
465200                    PV-DISPLAY-CARTON    DELIMITED BY SIZE        46520000
465300                    ' PO, RCVR   '       DELIMITED BY SIZE        46530000
465400                    PV-DISPLAY-PO        DELIMITED BY SIZE        46540000
465500                    ' '                  DELIMITED BY SIZE        46550000
465600                    PV-DISPLAY-PO-RCVR   DELIMITED BY SIZE        46560000
465700                    ' '                  DELIMITED BY SIZE        46570000
465800                             INTO DP013-MESSAGE-TEXT (2)          46580000
465900             MOVE SQLCA      TO DP013-SQLCA                       46590000
466000             MOVE 'SUT00015' TO DP013-DB2-TABLE-NAME(1)           46600000
466100             SET DP013-DB2-ABEND                                  46610000
466200                             TO TRUE                              46620000
466300             SET DP013-ROLLBACK                                   46630000
466400                             TO TRUE                              46640000
466500             SET DP013-XCTL-DISPLAY-RESTART                       46650000
466600                             TO TRUE                              46660000
466700             PERFORM DP014-0000-PROCESS-ABEND                     46670000
466800                                                                  46680000
466900     END-EVALUATE.                                                46690000
467000                                                                  46700000
467100/                                                                 46710000
467200 4500-CREATE-TROUBLE.                                             46720000
467300                                                                  46730000
467400     SET  TM500-ADD-DETAILS                                       46740000
467500          TM500-CREATE-AUTO        TO TRUE.                       46750000
467600                                                                  46760000
467700     EVALUATE TRUE                                                46770000
467800       WHEN PV-PBS-SCN-LOC-ID =  PC-PBSA                          46780000
467900            MOVE PC-QTY-ERR-TRBL-CODE-350  TO TM500-TRBL-RSN-CDE  46790000
468000       WHEN PV-PBS-SCN-LOC-ID =  PC-PBSB                          46800000
468100            MOVE PC-UPC-NOT-ON-PO-TRBL-351 TO TM500-TRBL-RSN-CDE  46810000
468200       WHEN PV-PBS-SCN-LOC-ID =  PC-PBSC                          46820000
468300            MOVE PC-LNE-ZERO-TRBL-CODE-352 TO TM500-TRBL-RSN-CDE  46830000
468400       WHEN PV-PBS-SCN-LOC-ID =  PC-PBSD                          46840000
468500            MOVE PC-UPC-CRTN-TRBL-CODE-353 TO TM500-TRBL-RSN-CDE  46850000
468600       WHEN PV-PBS-SCN-LOC-ID =  PC-PBSE                          46860000
468700            MOVE PC-UPC-PKSL-TRBL-CODE-354 TO TM500-TRBL-RSN-CDE  46870000
468800     END-EVALUATE                                                 46880000
468900                                                                  46890000
469000                                                                  46900000
469100     MOVE SU001-PO                 TO TM500-PO-NBR.               46910000
469200     MOVE SU001-OPER-UNT-ID        TO TM500-OPER-UNT-ID.          46920000
469300     MOVE SU001-FCLTY-ID           TO TM500-FCLTY-ID.             46930000
469400     MOVE SU001-RCVR-SEQ-NBR       TO TM500-REC-SEQ-NBR.          46940000
469500     MOVE PC-CURRENT-PROGRAM-NAME  TO TM500-NOTIF-UID.            46950000
469600                                                                  46960000
469700                                                                  46970000
469800     EXEC CICS                                                    46980000
469900         LINK PROGRAM  (PC-TROUBLE-WTR)                           46990000
470000              COMMAREA (TM500-FIELDS)                             47000000
470100              LENGTH   (PC-TROUBLE-LENGTH)                        47010000
470200     END-EXEC.                                                    47020000
470300                                                                  47030000
470400                                                                  47040000
470500     EVALUATE TRUE                                                47050000
470600         WHEN TM500-CALL-SUCCESSFUL                               47060000
470700         WHEN TM500-DUPLICATE-TROUBLE                             47070000
470800              CONTINUE                                            47080000
470900         WHEN OTHER                                               47090000
471000             MOVE 'SUKRF706 - 4500-CREATE-TROUBLE'                47100000
471100                                      TO DP013-PARAGRAPH          47110000
471200             STRING TM500-RETURN-CODE    DELIMITED BY SIZE        47120000
471300                    ' / '                DELIMITED BY SIZE        47130000
471400                    TM500-RETURN-MSG     DELIMITED BY '  '        47140000
471500                    ' SQLCODE:'          DELIMITED BY SIZE        47150000
471600                    TM500-SQLCODE        DELIMITED BY SIZE        47160000
471700                                     INTO DP013-MESSAGE-TEXT (1)  47170000
471800             MOVE  TM500-SQLCA         TO DP013-MESSAGE-TEXT (2)  47180000
471900             MOVE  SU001-CARTON  TO PV-DISPLAY-CARTON             47190000
472000             MOVE  SU001-PO      TO PV-DISPLAY-PO                 47200000
472100             MOVE  SU001-RCVR-SEQ-NBR TO PV-DISPLAY-PO-RCVR       47210000
472200             STRING '  CARTON - '        DELIMITED BY SIZE        47220000
472300                    PV-DISPLAY-CARTON    DELIMITED BY SIZE        47230000
472400                    ' PO, RCVR   '       DELIMITED BY SIZE        47240000
472500                    PV-DISPLAY-PO        DELIMITED BY SIZE        47250000
472600                    ' '                  DELIMITED BY SIZE        47260000
472700                    PV-DISPLAY-PO-RCVR   DELIMITED BY SIZE        47270000
472800                    ' '                  DELIMITED BY SIZE        47280000
472900                             INTO DP013-MESSAGE-TEXT (3)          47290000
473000             SET DP013-OTHER-ABEND                                47300000
473100                 DP013-ROLLBACK    TO TRUE                        47310000
473200             PERFORM DP014-0000-PROCESS-ABEND                     47320000
473300     END-EVALUATE.                                                47330000
473400                                                                  47340000
473500******************************************************************47350000
473600**CHECK IF THE PBS ORDER IS RTV WHERE THERE ARE NO ALLOCATIONS   *47360000
473700**FOR A STORE OR THE ALLOCATIONS ARE 'DC' OR 'RV'                *47370000
473800**FORMAT A MESSAGE LABEL IN THESE CASES (PBS RTV OR NO ALLOC)    *47380000
473900******************************************************************47390000
474000 4510-PROCESS-CHECK-RTV.                                          47400000
474100     MOVE SPACE TO PS-PBS-RTV-ALLOC-SW.                           47410000
474200     PERFORM 4520-CHECK-PBS-STORE-ALLOC.                          47420000
474300     IF PV-DB2-ALLOC-COUNT >  0                                   47430000
474400        CONTINUE                                                  47440000
474500     ELSE                                                         47450000
474600        PERFORM 4530-CHECK-RTV-ALLOC                              47460000
474700        IF PV-DB2-RTV-COUNT >  0                                  47470000
474800           SET PS-PBS-RTV-ALLOC TO TRUE                           47480000
474900        ELSE                                                      47490000
475000           SET PS-PBS-RTV-NO-ALLOC TO TRUE                        47500000
475100        END-IF                                                    47510000
475200     END-IF.                                                      47520000
475300******************************************************************47530000
475400 4520-CHECK-PBS-STORE-ALLOC.                                      47540000
475500     MOVE SU001-STORE              TO RECDIS-STR-NBR.             47550000
475600     MOVE ZEROES                   TO PV-DB2-ALLOC-COUNT.         47560000
475700                                                                  47570000
475800     EXEC SQL                                                     47580000
475900         SELECT COUNT(*)                                          47590000
476000           INTO :PV-DB2-ALLOC-COUNT                               47600000
476100           FROM TRECDIS A                                         47610000
476200          WHERE A.ORD_NBR         =  :DK-PO                       47620000
476300            AND A.REC_SEQ_NBR     =  :DK-REC-SEQ-NBR              47630000
476400            AND A.STR_NBR         =  :RECDIS-STR-NBR              47640000
476500            AND A.VERIFY_ITM_QTY  >  0                            47650000
476600     END-EXEC                                                     47660000
476700                                                                  47670000
476800     EVALUATE TRUE                                                47680000
476900         WHEN SQLCODE = ZERO                                      47690000
477000         WHEN SQLCODE = +100                                      47700000
477100             CONTINUE                                             47710000
477200         WHEN SQLWARN0 NOT = SPACES                               47720000
477300         WHEN SQLCODE < ZERO                                      47730000
477400         WHEN SQLCODE > ZERO                                      47740000
477500             MOVE SU001-CARTON   TO  PV-DISPLAY-CARTON            47750000
477600             MOVE DK-PO          TO  PV-DISPLAY-PO                47760000
477700             MOVE DK-REC-SEQ-NBR TO  PV-DISPLAY-PO-RCVR           47770000
477800             MOVE '4520-CHECK-PBS-STORE-ALLOC'                    47780000
477900                             TO DP013-PARAGRAPH                   47790000
478000             MOVE 'SUKRF706 - CHECK PBS ALLOCATION'               47800000
478100                             TO DP013-MESSAGE-TEXT(1)             47810000
478200             STRING '  CARTON - '        DELIMITED BY SIZE        47820000
478300                    PV-DISPLAY-CARTON    DELIMITED BY SIZE        47830000
478400                    ' PO, RCVR   '       DELIMITED BY SIZE        47840000
478500                    PV-DISPLAY-PO        DELIMITED BY SIZE        47850000
478600                    ' '                  DELIMITED BY SIZE        47860000
478700                    PV-DISPLAY-PO-RCVR   DELIMITED BY SIZE        47870000
478800                    ' '                  DELIMITED BY SIZE        47880000
478900                             INTO DP013-MESSAGE-TEXT (2)          47890000
479000             MOVE SQLCA      TO DP013-SQLCA                       47900000
479100             MOVE 'TRECDIS'  TO DP013-DB2-TABLE-NAME(1)           47910000
479200             SET DP013-DB2-ABEND                                  47920000
479300                             TO TRUE                              47930000
479400             SET DP013-ROLLBACK                                   47940000
479500                             TO TRUE                              47950000
479600             SET DP013-XCTL-DISPLAY-RESTART                       47960000
479700                             TO TRUE                              47970000
479800             PERFORM DP014-0000-PROCESS-ABEND                     47980000
479900                                                                  47990000
480000     END-EVALUATE.                                                48000000
480100                                                                  48010000
480200******************************************************************48020000
480300 4530-CHECK-RTV-ALLOC.                                            48030000
480400     MOVE ZEROES                   TO PV-DB2-RTV-COUNT.           48040000
480500                                                                  48050000
480600     EXEC SQL                                                     48060000
480700         SELECT COUNT(*)                                          48070000
480800           INTO :PV-DB2-RTV-COUNT                                 48080000
480900           FROM TRECDIS A                                         48090000
481000              , XLT_LOC B                                         48100000
481100          WHERE A.ORD_NBR         =  :DK-PO                       48110000
481200            AND A.REC_SEQ_NBR     =  :DK-REC-SEQ-NBR              48120000
481300            AND A.STR_NBR         =  B.LOC_NBR                    48130000
481400            AND B.LOC_TYP_CDE     IN  ('DC' , 'RV')               48140000
481500            AND A.VERIFY_ITM_QTY  >  0                            48150000
481600     END-EXEC                                                     48160000
481700                                                                  48170000
481800     EVALUATE TRUE                                                48180000
481900         WHEN SQLCODE = ZERO                                      48190000
482000             CONTINUE                                             48200000
482100         WHEN SQLWARN0 NOT = SPACES                               48210000
482200         WHEN SQLCODE < ZERO                                      48220000
482300         WHEN SQLCODE > ZERO                                      48230000
482400             MOVE SU001-CARTON   TO  PV-DISPLAY-CARTON            48240000
482500             MOVE DK-PO          TO  PV-DISPLAY-PO                48250000
482600             MOVE DK-REC-SEQ-NBR TO  PV-DISPLAY-PO-RCVR           48260000
482700             MOVE '4530-CHECK-RTV-ALLOC    '                      48270000
482800                             TO DP013-PARAGRAPH                   48280000
482900             MOVE 'SUKRF706 - CHECK RTV ALLOCATION'               48290000
483000                             TO DP013-MESSAGE-TEXT(1)             48300000
483100             STRING '  CARTON - '        DELIMITED BY SIZE        48310000
483200                    PV-DISPLAY-CARTON    DELIMITED BY SIZE        48320000
483300                    ' PO, RCVR   '       DELIMITED BY SIZE        48330000
483400                    PV-DISPLAY-PO        DELIMITED BY SIZE        48340000
483500                    ' '                  DELIMITED BY SIZE        48350000
483600                    PV-DISPLAY-PO-RCVR   DELIMITED BY SIZE        48360000
483700                    ' '                  DELIMITED BY SIZE        48370000
483800                             INTO DP013-MESSAGE-TEXT (2)          48380000
483900             MOVE SQLCA      TO DP013-SQLCA                       48390000
484000             MOVE 'TRECDIS'  TO DP013-DB2-TABLE-NAME(1)           48400000
484100             SET DP013-DB2-ABEND                                  48410000
484200                             TO TRUE                              48420000
484300             SET DP013-ROLLBACK                                   48430000
484400                             TO TRUE                              48440000
484500             SET DP013-XCTL-DISPLAY-RESTART                       48450000
484600                             TO TRUE                              48460000
484700             PERFORM DP014-0000-PROCESS-ABEND                     48470000
484800                                                                  48480000
484900     END-EVALUATE.                                                48490000
485000                                                                  48500000
485100******************************************************************48510000
485200 5000-PRINT-LABEL.                                                48520000
485300******************************************************************48530000
485400                                                                  48540000
485500*    SELECT FUNC_TXT HAS DIRECTIVE MODE DATA                      48550000
485600     PERFORM 5003-SELECT-FUNC-TXT.                                48560000
485700                                                                  48570000
485800*****FILL BAR CODE FOR SHIPPING LABEL - PACK BY STORE             48580000
485900     IF SU001-PACK-BY-STORE                                       48590000
486000           MOVE SULBXF-BRCDE-NBR TO PC160-BTCH-BARCODE            48600000
486100        MOVE 'K'                 TO DK-CART-LBL-TYP-CDE           48610000
486200        PERFORM 7210-GET-STORE-INFO                               48620000
486300        MOVE SU001-OPER-UNT-ID TO DK-OPER-UNT-ID                  48630000
486400        PERFORM 7215-GET-ECOMM-DC-INFO                            48640000
486500        PERFORM 1100-GET-ZONE-DESC                                48650000
486600        PERFORM 5060-CALL-SEA-SET-MODULE                          48660000
486700                                                                  48670000
486800         IF PS-CARTON-EXISTS                                      48680018
486900            PERFORM 7235-GET-OUTER-PACK                           48690018
487000            PERFORM 7230-GET-DEPT-CL-SKU                          48700018
487100            PERFORM 7400-GET-DEPT-NAME                            48710018
487200         END-IF                                                   48720018
487300        MOVE SU001-STORE           TO PV-STORE-9-4                48730000
487400                                      DK-DEST-OPER-UNT-ID         48740000
487500        MOVE PV-STORE-X-4          TO PV-STORE-NBR-4              48750000
487600        MOVE SU001-CURR-OPER-UNT-ID TO                            48760022
487700                                      PV-BAR-CODE-OPER-UNIT       48770000
487800        PERFORM 6400-DETERMINE-HANG-FOLD                          48780000
487900        PERFORM 7234-GET-CURRENT-DOOR                             48790000
488000        IF PS-NOT-REPRINT-DUP                                     48800000
488100           CONTINUE                                               48810006
488200        ELSE                                                      48820000
488300           IF PS-XREF-PBS-FOUND                                   48830000
488400**THE CARTON HAS BEEN PREVIOUSLY BEEN SCANNED, BUT THE DIVERT PREF48840000
488500**HAS BEEN CHANGED                                                48850000
488600              IF PV-STORE-NBR-PFX-HOLD = PV-STORE-NBR-PFX         48860000
488700                 CONTINUE                                         48870000
488800              ELSE                                                48880000
488900                 CONTINUE                                         48890006
489000           ELSE                                                   48900000
489100              CONTINUE                                            48910006
489200           END-IF                                                 48920000
489300        END-IF                                                    48930000
489400     ELSE                                                         48940000
489500         IF PS-CARTON-EXISTS                                      48950030
489600            PERFORM 7235-GET-OUTER-PACK                           48960030
489700            PERFORM 7230-GET-DEPT-CL-SKU                          48970030
489800            PERFORM 7400-GET-DEPT-NAME                            48980030
489900         END-IF                                                   48990030
490000        MOVE LBVRDA-BRCDE-NBR      TO PC160-DEST-BARCODE-TEXT     49000000
490100                                      PC160-BTCH-BARCODE          49010000
490200     END-IF.                                                      49020000
490300                                                                  49030000
490400     SET SU001-NO-P2L-LBL-CREATED TO TRUE.                        49040000
490500                                                                  49050000
490600                                                                  49060000
490700     IF SU001-BATCH-PRINTER OR SU001-PRINT-AND-PEEL               49070000
490800         SET SU021-AUDIT-IS-COMPLETE                              49080000
490900             PS-OPER-NOT-ECOMM-DC    TO TRUE                      49090000
491000                                                                  49100000
491100         IF SU001-PACK-BY-STORE                                   49110000
491200             MOVE 'N' TO LBVRDA-INPK-CNVYB-IND                    49120000
491300             PERFORM 7200-GATHER-LABEL-INFO                       49130000
491400         ELSE                                                     49140000
491500             PERFORM 7500-POPULATE-TLBPTDA-BULK                   49150000
491600         END-IF                                                   49160000
491700**BYPASS THE CALLED MODULES WHEN CREATING AN AUDIT                49170006
491800**LABEL AS THE INDICATORS DON'T APPEAR ON THE AUDIT LABEL         49180000
491900         IF  SU021-AUDIT-REQUIRED                                 49190000
492000             MOVE ZEROES  TO  PV-HNG-FOLD-SEQ-NBR                 49200000
492100                              PV-BUS-AREA-ID                      49210000
492200         ELSE                                                     49220000
492300                                                                  49230000
492400             IF PV-DEPT-NUMBER > SPACES                           49240000
492500                PERFORM 6700-LINK-XLKUT073                        49250000
492600             ELSE                                                 49260000
492700                MOVE ZEROES TO PV-BUS-AREA-ID                     49270000
492800             END-IF                                               49280000
492900         END-IF                                                   49290000
493000                                                                  49300000
493100         IF SU001-LBL-REPRINT                                     49310006
493200            CONTINUE                                              49320006
493300         ELSE                                                     49330006
493400            IF PS-PROCESSING-ERROR-NO AND                         49340006
493500               PS-CARTON-SML-CREATED                              49350006
493600               CONTINUE                                           49360006
493700            END-IF                                                49370006
493800         END-IF                                                   49380006
493900                                                                  49390000
494000         PERFORM 7205-INSERT-LABEL-TABLE                          49400000
494100                                                                  49410000
494200         IF SU001-ASGMT-STRT-DTE  > SPACES                        49420000
494300            AND (PS-CARTON-SML-CREATED OR PS-CARTON-P2L-CREATED)  49430000
494400            PERFORM 5700-CALL-XLKUP033-EAI                        49440000
494500         END-IF                                                   49450000
494600         IF  SU021-AUDIT-REQUIRED AND SU001-PROMPT-IND = 'Y'      49460000
494700             IF LBVRDA-INPK-CNVYB-IND = 'Y'                       49470000
494800                 SET PS-INPK-AUD-INLINE-YES TO TRUE               49480000
494900             ELSE                                                 49490000
495000               MOVE SU001-ASGMT-STRT-DTE TO SU006-ASGMT-STRT-DTE  49500000
495100               MOVE SU001-ASGMT-NBR-TXT  TO SU006-ASGMT-NBR-TXT   49510000
495200               MOVE SU001-ASGMT-NBR-SEQ-NBR TO                    49520000
495300                                        SU006-ASGMT-NBR-SEQ-NBR   49530000
495400               MOVE PC-SU-AUDIT-DEF-PRMPT-PGM                     49540000
495500                                          TO PV-TRANSFER-PROGRAM  49550000
495600               MOVE PC-N TO SU001-DUPLICATE-IND                   49560000
495700               MOVE PC-Y TO SU001-LABEL-IND                       49570000
495800                                                                  49580000
495900               PERFORM 4000-XCTL-LRT-MENU                         49590000
496000             END-IF                                               49600000
496100         END-IF                                                   49610000
496200                                                                  49620000
496300         IF ((SU001-ROWS-INSERTED >=                              49630000
496400            SU001-PRT-LBL-ON-SCN-CNT)                             49640000
496500            AND LBVRDA-INPK-CNVYB-IND = 'N')                      49650000
496600                 MOVE  SU001-BATCH-NUMBER TO SU001-BATCH-NO-USE   49660000
496700                 MOVE  SU001-PRINTER-ID  TO SU001-PRINTER-ID-USE  49670000
496800                 PERFORM 7300-START-LABEL-PRINT                   49680000
496900                 PERFORM 2400-GET-BATCH-NUMBER                    49690000
497000                 ADD  1  TO  PV-MAX-USER-BATCH                    49700000
497100                     GIVING  SU001-BATCH-NUMBER                   49710000
497200                 MOVE  SU001-BATCH-NUMBER TO SU001-BATCH-NO-USE   49720000
497300                 MOVE  ZEROES             TO SU001-ROWS-INSERTED  49730000
497400         END-IF                                                   49740000
497500******************************************************************49750000
497600*** MODULE TO SEE IF LAST CARTON SCANNED AND CONF/VERIF CAN       49760000
497700*** BE STARTED                                                    49770000
497800******************************************************************49780000
498600                                                                  49860000
498700     ELSE                                                         49870000
498800        IF PS-NOT-REPRINT-DUP                                     49880000
498900          EVALUATE TRUE                                           49890000
499000               WHEN PS-PRINT-AUDIT-LABEL                          49900000
499100               WHEN LBVRDA-CART-LBL-TYP-CDE  = 'C'                49910000
499200               WHEN LBVRDA-CART-LBL-TYP-CDE  = 'E'                49920000
499300               WHEN SU001-NOT-CRTN-ATT-TO-TRIP                    49930000
499400               WHEN SU001-NOT-CRTN-ATT-TO-RCVR                    49940000
499500               WHEN SU001-WRONG-FCLTY                             49950000
499600                  PERFORM 5005-PRINT-MESSAGE-LABELS               49960000
499700               WHEN OTHER                                         49970000
499800                  CONTINUE                                        49980000
499900          END-EVALUATE                                            49990000
500000        ELSE                                                      50000000
500100           IF LBVRDA-CART-LBL-TYP-CDE  =  'C' OR                  50010000
500200              LBVRDA-CART-LBL-TYP-CDE  =  'E'                     50020000
500300                PERFORM 5005-PRINT-MESSAGE-LABELS                 50030000
500400           END-IF                                                 50040000
500500        END-IF                                                    50050000
500600     END-IF.                                                      50060000
500700                                                                  50070000
500800******************************************************************50080056
500900* DETERMINE WHAT LEVEL THE DC IS TURNED ON FOR DUAL FEED P&A     *50090000
501000******************************************************************50100000
501100 5003-SELECT-FUNC-TXT.                                            50110000
501200                                                                  50120000
501300     MOVE SU001-OPER-UNT-ID TO DK-OPER-UNT-ID.                    50130000
501400                                                                  50140000
501500     EXEC SQL                                                     50150000
501600        SELECT                                                    50160000
501700            FUNC_TXT                                              50170000
501800        INTO                                                      50180000
501900            :KRPRPM-FUNC-TXT                                      50190000
502000        FROM                                                      50200000
502100            TKRPRPM                                               50210000
502200        WHERE SYS_PRC_FUNC_CDE = 'AUTOCY'                         50220000
502300          AND LOC_ID            = :DK-OPER-UNT-ID                 50230000
502400          AND CURRENT TIMESTAMP > FUNC_BEG_TMST                   50240000
502500     END-EXEC.                                                    50250000
502600                                                                  50260000
502700     MOVE KRPRPM-FUNC-TXT TO PS-AUTO-CONVEY-LVL-SW.               50270000
502800                                                                  50280000
502900                                                                  50290000
503000     EVALUATE TRUE                                                50300000
503100         WHEN SQLCODE = ZERO                                      50310000
503200             CONTINUE                                             50320000
503300         WHEN SQLCODE = +100                                      50330000
503400             MOVE 'NNE' TO PS-AUTO-CONVEY-LVL-SW                  50340000
503500         WHEN SQLWARN0 NOT = SPACES                               50350000
503600         WHEN SQLCODE NOT EQUAL ZERO                              50360000
503700             MOVE '5003-SELECT-FUNC-TXT'                          50370000
503800                             TO DP013-PARAGRAPH                   50380000
503900             MOVE 'SUKRF706 - CHECK OPER-UNT-ID FOR CURR TS'      50390000
504000                             TO DP013-MESSAGE-TEXT(1)             50400000
504100             MOVE DK-OPER-UNT-ID                                  50410000
504200                             TO DP013-MESSAGE-TEXT(2)             50420000
504300             MOVE SQLCA      TO DP013-SQLCA                       50430000
504400             MOVE 'TKRPRPM'  TO DP013-DB2-TABLE-NAME(1)           50440000
504500             SET DP013-DB2-ABEND            TO TRUE               50450000
504600             SET DP013-ROLLBACK             TO TRUE               50460000
504700             SET DP013-XCTL-DISPLAY-RESTART TO TRUE               50470000
504800             PERFORM DP014-0000-PROCESS-ABEND                     50480000
504900     END-EVALUATE.                                                50490000
505000                                                                  50500000
505100******************************************************************50510000
505200 5005-PRINT-MESSAGE-LABELS.                                       50520000
505300******************************************************************50530000
505400**                                                                50540000
505500     IF SU001-BATCH-PRINTER OR SU001-PRINT-AND-PEEL               50550000
505600         SET SU021-AUDIT-IS-COMPLETE TO TRUE                      50560000
505700         MOVE  3  TO PV-HNG-FOLD-SEQ-NBR                          50570000
505800         MOVE  0  TO PV-BUS-AREA-ID                               50580000
505900**WILL NOT CALL HANG FOLD MODULE AS INDICATOR DOES NOT APPEAR ON  50590000
506000**THE MESSAGE LABEL, HOWEVER, A VALUE IS REQUIRED FOR INSERT TO   50600000
506100**TLBPTDA FIELD                                                   50610006
506200         IF SU001-ECOMM-DC-REPURPOSE                              50620000
506300            PERFORM 6560-DETERMINE-WEIGHTS-MSRS                   50630000
506400         END-IF                                                   50640000
506500                                                                  50650000
506600         EVALUATE TRUE                                            50660000
506700             WHEN SU001-MULTI-LINE                                50670000
506800                MOVE PC-MULTI-LINE           TO PV-PO-LINE-OUT    50680000
506900                MOVE  '*MULTIPLE LINES*'     TO  PV-VEND-STYL-NAME50690000
507000             WHEN  SU001-NO-LINE                                  50700000
507100                MOVE PC-NOLNE-LINE           TO PV-PO-LINE-OUT    50710000
507200                MOVE  '** NO LINE NUMBER **' TO  PV-VEND-STYL-NAME50720000
507300             WHEN  OTHER                                          50730000
507400                 CONTINUE                                         50740000
507500         END-EVALUATE                                             50750000
507600         MOVE 'N' TO LBVRDA-INPK-CNVYB-IND                        50760000
507700         IF PS-CARTON-EXISTS                                      50770000
507800            PERFORM 7235-GET-OUTER-PACK                           50780000
507900            PERFORM 7230-GET-DEPT-CL-SKU                          50790000
508000            PERFORM 7400-GET-DEPT-NAME                            50800000
508100         END-IF                                                   50810000
508200         SET PS-EAS-TAG-IND-FOUND-NO TO TRUE                      50820000
508300         PERFORM 7200-GATHER-LABEL-INFO                           50830000
508400         PERFORM 7205-INSERT-LABEL-TABLE                          50840000
508600                                                                  50860000
508700         IF PS-NOT-REPRINT-DUP                                    50870000
508800            IF PS-UCC128-PKSLIP-ERROR-NO AND                      50880000
508900               PS-PBS-CRTN-RCVR-MISMTCH-NO AND                    50890000
509000               PS-CARTON-EXISTS                                   50900000
509100               IF SU001-ASGMT-STRT-DTE  > SPACES                  50910000
509200                  PERFORM 5700-CALL-XLKUP033-EAI                  50920000
509300               END-IF                                             50930000
509400            END-IF                                                50940000
509500         END-IF                                                   50950000
509600     END-IF.                                                      50960013
509700                                                                  50970013
509800 5060-CALL-SEA-SET-MODULE.                                        50980000
509900                                                                  50990000
510000     INITIALIZE PC240-ITEM-COMMAREA                               51000000
510100     MOVE SU001-CARTON                TO PC240-KEY-CARTON-ID      51010000
510200     MOVE SU001-PO                    TO PC240-KEY-PO             51020000
510300     MOVE SU001-STORE                 TO PC240-KEY-DEST-LOC       51030000
510400     SET  PC240-CHECK-IN              TO TRUE                     51040000
510500     CALL PC240-VSM-PGM USING DFHEIBLK                            51050000
510600                              PC240-COMMAREA                      51060000
510700                              PC240-ITEM-COMMAREA                 51070000
510800     EVALUATE TRUE                                                51080000
510900         WHEN PC240-SUCCESSFUL                                    51090000
511000             MOVE PC240-DIVERT-PFX-NBR TO PV-STORE-NBR-PFX        51100000
511100                                          PV-BAR-CODE-DIVERT-PFX  51110000
511200             MOVE PC240-SEASET-NM      TO SEASET-SEASET-NM        51120000
511300             IF PC240-FIXT-ID  > SPACES                           51130000
511400                MOVE PC240-FIXT-ID    TO PV-FIXTURE-ID            51140000
511500             END-IF                                               51150000
511600         WHEN PC240-ITEM-NOT-FOUND                                51160000
511700                MOVE PC-00 TO PV-STORE-NBR-PFX                    51170000
511800                              PV-BAR-CODE-DIVERT-PFX              51180000
511900         WHEN PC240-SQL-ERROR                                     51190000
512000         WHEN PC240-INVALID-ACCESS                                51200000
512100             MOVE '5060-CALL-SEA-SET-MODULE'                      51210000
512200                             TO DP013-PARAGRAPH                   51220000
512300             MOVE 'SUKRF706 - CHECK SEASONAL SET'                 51230000
512400                             TO DP013-MESSAGE-TEXT(1)             51240000
512500             MOVE  SU001-CARTON  TO PV-DISPLAY-CARTON             51250000
512600             MOVE  SU001-PO      TO PV-DISPLAY-PO                 51260000
512700             MOVE  SU001-RCVR-SEQ-NBR TO PV-DISPLAY-PO-RCVR       51270000
512800             MOVE  PC240-RETURN-CODE  TO PV-DISPLAY-RET-CODE      51280000
512900             MOVE  PC240-ERROR-NBR   TO PV-DISPLAY-ERROR-NBR      51290000
513000             STRING '  CARTON - '        DELIMITED BY SIZE        51300000
513100                    PV-DISPLAY-CARTON    DELIMITED BY SIZE        51310000
513200                    ' PO, RCVR, LINE '   DELIMITED BY SIZE        51320000
513300                    PV-DISPLAY-PO        DELIMITED BY SIZE        51330000
513400                    ' '                  DELIMITED BY SIZE        51340000
513500                    PV-DISPLAY-RET-CODE  DELIMITED BY SIZE        51350000
513600                    ' '                  DELIMITED BY SIZE        51360000
513700                    PV-DISPLAY-ERROR-NBR                          51370000
513800                                         DELIMITED BY SIZE        51380000
513900                             INTO DP013-MESSAGE-TEXT (2)          51390000
514000             MOVE PC240-SQLCA  TO DP013-SQLCA                     51400000
514100             SET DP013-DB2-ABEND                                  51410000
514200                             TO TRUE                              51420000
514300             SET DP013-ROLLBACK                                   51430000
514400                             TO TRUE                              51440000
514500             SET DP013-XCTL-DISPLAY-RESTART                       51450000
514600                             TO TRUE                              51460000
514700             PERFORM DP014-0000-PROCESS-ABEND                     51470000
514800                                                                  51480000
514900         WHEN OTHER                                               51490000
515000             MOVE '5060-CALL-SEA-SET-MODULE'                      51500000
515100                             TO DP013-PARAGRAPH                   51510000
515200             MOVE 'SUKRF706 - CHECK SEASONAL SET'                 51520000
515300                             TO DP013-MESSAGE-TEXT(1)             51530000
515400             MOVE  SU001-CARTON  TO PV-DISPLAY-CARTON             51540000
515500             MOVE  SU001-PO      TO PV-DISPLAY-PO                 51550000
515600             MOVE  SU001-RCVR-SEQ-NBR TO PV-DISPLAY-PO-RCVR       51560000
515700             MOVE  PC240-RETURN-CODE  TO PV-DISPLAY-RET-CODE      51570000
515800             MOVE  PC240-ERROR-NBR   TO PV-DISPLAY-ERROR-NBR      51580000
515900             STRING '  CARTON - '        DELIMITED BY SIZE        51590000
516000                    PV-DISPLAY-CARTON    DELIMITED BY SIZE        51600000
516100                    ' PO, RCVR, LINE '   DELIMITED BY SIZE        51610000
516200                    PV-DISPLAY-PO        DELIMITED BY SIZE        51620000
516300                    ' '                  DELIMITED BY SIZE        51630000
516400                    PV-DISPLAY-RET-CODE  DELIMITED BY SIZE        51640000
516500                    ' '                  DELIMITED BY SIZE        51650000
516600                    PV-DISPLAY-ERROR-NBR                          51660000
516700                                         DELIMITED BY SIZE        51670000
516800                             INTO DP013-MESSAGE-TEXT (2)          51680000
516900             MOVE PC240-SQLCA  TO DP013-SQLCA                     51690000
517000             SET DP013-DB2-ABEND                                  51700000
517100                             TO TRUE                              51710000
517200             SET DP013-ROLLBACK                                   51720000
517300                             TO TRUE                              51730000
517400             SET DP013-XCTL-DISPLAY-RESTART                       51740000
517500                             TO TRUE                              51750000
517600             PERFORM DP014-0000-PROCESS-ABEND                     51760000
517700     END-EVALUATE.                                                51770000
517800                                                                  51780000
517900*----------------------------------------------------------------*51790000
518000 5700-CALL-XLKUP033-EAI.                                          51800000
518100*----------------------------------------------------------------*51810000
518200     IF PV-TSHUNLO-TMST-EAI > SPACES                              51820000
518300        CONTINUE                                                  51830000
518400     ELSE                                                         51840000
518500        PERFORM 3569-SEL-MAX-CHECK-IN-TMST                        51850000
518600     END-IF                                                       51860000
518700                                                                  51870000
518800     INITIALIZE XL072-EAI-EXPORT-COMMAREA                         51880000
518900                SU050-DTL-TXT-AREA.                               51890000
519000     SET XL072-SU-APP-ID                                          51900000
519100         XL072-DO-NOT-COMMIT-UPDATE  TO TRUE.                     51910000
519200                                                                  51920000
519300                                                                  51930000
519400     MOVE 'CARTON'                TO XL072-EVNT-OBJ-TXT.          51940000
519500     MOVE 'CHECKIN'               TO XL072-EVNT-OBJ-ACTN-TXT.     51950000
519600     MOVE SU001-USER-ID           TO XL072-CRE-BY-USR-ID.         51960000
519700     MOVE PC-CURRENT-PROGRAM-NAME TO XL072-CRE-PGM-NM.            51970000
519800                                                                  51980000
519900     MOVE SU001-CARTON            TO XL072-EVNT-KY-1-NBR.         51990000
520000     MOVE SU001-MANIFEST          TO XL072-EVNT-KY-2-NBR.         52000000
520100     MOVE PV-TSHUNLO-TMST-EAI     TO XL072-EVNT-KY-1-TMST.        52010000
520200                                                                  52020000
520300     SET XL072-SUWS050-COPYBOOK   TO TRUE.                        52030000
520400     SET SU050-CRTN-CHECK-IN      TO TRUE.                        52040000
520500     MOVE SU001-ASGMT-STRT-DTE    TO SU050-AB-ASGMT-STRT-DTE.     52050000
520600     MOVE SU001-ASGMT-NBR-TXT     TO SU050-AB-ASGMT-NBR-TXT.      52060000
520700     MOVE SU001-ASGMT-NBR-SEQ-NBR TO SU050-AB-ASGMT-NBR-SEQ-NBR.  52070000
520800                                                                  52080000
520900     MOVE SU001-SEQ-START-NBR     TO SU050-AB-ASGMT-SEQ-DTL-NBR.  52090000
521000     MOVE SU001-DOOR-ID           TO SU050-AB-DOOR-NBR.           52100000
521100     MOVE ZEROES                  TO SU050-AB-CRTN-DEST-LOC-NBR.  52110000
521200                                                                  52120000
521300     IF SU021-100-PC-AUDIT-REQD OR SU021-REWORK                   52130000
521400         SET SU050-AB-CRTN-AUDIT-NEEDED TO TRUE                   52140000
521500     ELSE                                                         52150000
521600         SET SU050-AB-CRTN-ACTN-NONE    TO TRUE                   52160000
521700     END-IF                                                       52170000
521800                                                                  52180000
521900     EVALUATE TRUE                                                52190000
522000        WHEN PS-CARTON-SML-CREATED                                52200000
522100           IF LBVRDA-INPK-CNVYB-IND = 'Y'                         52210000
522200              SET SU050-AB-CRTN-TO-MULT-LOC TO TRUE               52220000
522300           ELSE                                                   52230000
522400              SET SU050-AB-CRTN-TO-LOC  TO TRUE                   52240000
522500           END-IF                                                 52250000
522600           MOVE SU001-STORE          TO SU050-AB-CRTN-DEST-LOC-NBR52260000
522700        WHEN PS-CARTON-P2L-CREATED                                52270000
522800           SET SU050-AB-CRTN-TO-P2L  TO TRUE                      52280000
522900           MOVE LBVRDA-STR-ZN-ID TO SU050-AB-STR-ZN-ID            52290000
523000           MOVE LBVRDA-MODU-DESC TO SU050-AB-P2L-MODU-DESC        52300000
523100        WHEN SU001-NO-PRINTER                                     52310000
523200        WHEN PS-NO-CASEPK-FND                                     52320000
523300        WHEN SU001-ECOMM-DC-REPURPOSE                             52330000
523400           SET SU050-AB-CRTN-TO-NONE TO TRUE                      52340000
523500        WHEN OTHER                                                52350000
523600           SET SU050-AB-CRTN-FREE-ASTRAY TO TRUE                  52360000
523700     END-EVALUATE                                                 52370000
523800                                                                  52380000
523900     MOVE SU050-DTL-TXT-AREA             TO XL072-DTL-TXT         52390000
524000                                                                  52400000
524100     CALL XL072-USER-PGM USING DFHEIBLK                           52410000
524200                              XL072-COMMAREA                      52420000
524300                              XL072-EAI-EXPORT-COMMAREA.          52430000
524400                                                                  52440000
524500     EVALUATE TRUE                                                52450000
524600         WHEN XL072-SUCCESSFUL                                    52460000
524700              CONTINUE                                            52470000
524800         WHEN OTHER                                               52480000
524900              SET PV-DONE-PROCESSING          TO TRUE             52490000
525000              MOVE XL072-RETURN-CODE     TO PV-SQLCODE            52500000
525100              STRING ' SUKRF706 (OTHER) -' DELIMITED BY SIZE      52510000
525200               '5700-CALL-XLKUP033-EAI '   DELIMITED BY SIZE      52520000
525300                     'XL072-RETURN-CODE-'  DELIMITED BY SIZE      52530000
525400                     PV-SQLCODE            DELIMITED BY SIZE      52540000
525500                                      INTO PV-CICS-MSG-AREA       52550000
525600              MOVE LENGTH OF PV-CICS-MSG-AREA                     52560000
525700                                        TO PV-COMMAREA-LENGTH     52570000
525800              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              52580000
525900                                                                  52590000
526000              MOVE  '5700-CALL-XLKUP033-EAI '                     52600000
526100                              TO DP013-PARAGRAPH                  52610000
526200              MOVE 'CALL TO XLKUP033'                             52620000
526300                              TO DP013-MESSAGE-TEXT(1)            52630000
526400              MOVE 'CHECK CSSL FOR MORE DETAIL     '              52640000
526500                                TO DP013-MESSAGE-TEXT (2)         52650000
526600              MOVE SU001-MANIFEST TO  PV-DISPLAY-MANIFEST         52660000
526700              MOVE SU001-CARTON   TO  PV-DISPLAY-CARTON           52670000
526800              MOVE SU001-STORE    TO  PV-DISPLAY-STORE            52680000
526900              STRING ' TRIP - '           DELIMITED BY SIZE       52690000
527000                     PV-DISPLAY-MANIFEST  DELIMITED BY SIZE       52700000
527100                     '  CARTON - '        DELIMITED BY SIZE       52710000
527200                     PV-DISPLAY-CARTON    DELIMITED BY SIZE       52720000
527300                     '  STORE - '         DELIMITED BY SIZE       52730000
527400                     PV-DISPLAY-STORE     DELIMITED BY SIZE       52740000
527500                              INTO DP013-MESSAGE-TEXT (3)         52750000
527600              MOVE XL072-SQLCA    TO DP013-SQLCA                  52760000
527700              SET DP013-DB2-ABEND                                 52770000
527800                              TO TRUE                             52780000
527900              SET DP013-ROLLBACK                                  52790000
528000                              TO TRUE                             52800000
528100              SET DP013-XCTL-DISPLAY-RESTART                      52810000
528200                              TO TRUE                             52820000
528300              PERFORM DP014-0000-PROCESS-ABEND                    52830000
528400     END-EVALUATE.                                                52840000
528500                                                                  52850000
528600                                                                  52860000
528700                                                                  52870000
528800                                                                  52880000
528900                                                                  52890000
529000 6400-DETERMINE-HANG-FOLD.                                        52900000
529100      INITIALIZE PV-HNG-FOLD-SEQ-NBR                              52910000
529200                 PV-PREV-HANG-FOLD-IND                            52920000
529300                 PV-HANG-FOLD-IND.                                52930000
529400                                                                  52940000
529500      SET PS-NOT-EO-HANG-FOLD-CSR                                 52950000
529600          PS-NOT-HANG-FOLD-MIXED                                  52960000
529700          PS-FIRST-UPC-CALL                                       52970000
529800          PS-HANG-FOLD-IND-FOUND-NO                               52980000
529900          PS-EAS-TAG-IND-FOUND-NO  TO TRUE                        52990000
530000                                                                  53000000
530100      PERFORM 6450-OPEN-HANG-FOLD-CSR                             53010000
530200      PERFORM 6500-FETCH-HANG-FOLD-CSR                            53020000
530300        UNTIL PS-EO-HANG-FOLD-CSR OR                              53030000
530400              PS-HANG-FOLD-MIXED                                  53040000
530500      PERFORM 6550-CLOSE-HANG-FOLD-CSR.                           53050000
530600                                                                  53060000
530700******************************************************************53070000
530800 6450-OPEN-HANG-FOLD-CSR.                                         53080000
530900                                                                  53090000
531000         EXEC SQL                                                 53100000
531100              OPEN HANG_FOLD_CSR                                  53110000
531200         END-EXEC                                                 53120000
531300                                                                  53130000
531400                                                                  53140000
531500         EVALUATE TRUE                                            53150000
531600             WHEN SQLCODE = ZERO                                  53160000
531700                 CONTINUE                                         53170000
531800             WHEN SQLWARN0 NOT = SPACES                           53180000
531900             WHEN SQLCODE < ZERO                                  53190000
532000             WHEN SQLCODE > ZERO                                  53200000
532100                 MOVE '6450-OPEN-HANG-FOLD-CSR'                   53210000
532200                                   TO DP013-PARAGRAPH             53220000
532300                 MOVE 'OPEN HANG FOLD CSR - '                     53230000
532400                                   TO DP013-MESSAGE-TEXT (1)      53240000
532500                 MOVE SQLCA        TO DP013-SQLCA                 53250000
532600                 MOVE 'TSHUUPC '   TO DP013-DB2-TABLE-NAME (1)    53260000
532700                 SET DP013-DB2-ABEND                              53270000
532800                     DP013-XCTL-DISPLAY-RESTART TO TRUE           53280000
532900                 SET DP013-ROLLBACK                               53290000
533000                                   TO TRUE                        53300000
533100                 PERFORM DP014-0000-PROCESS-ABEND                 53310000
533200         END-EVALUATE.                                            53320000
533300                                                                  53330000
533400 EJECT                                                            53340000
533500*----------------------------------------------------------------*53350000
533600*                                                                *53360000
533700*----------------------------------------------------------------*53370000
533800 6500-FETCH-HANG-FOLD-CSR.                                        53380000
533900                                                                  53390000
534000                                                                  53400000
534100     EXEC SQL                                                     53410000
534200        FETCH   HANG_FOLD_CSR                                     53420000
534300        INTO   :SHUUPC-UPC-NBR                                    53430000
534400             , :SHUUPC-TRN-LNE-NBR                                53440000
534500     END-EXEC.                                                    53450000
534600                                                                  53460000
534700     EVALUATE TRUE                                                53470000
534800       WHEN SQLCODE = ZEROS                                       53480000
534900            PERFORM 7245-CALL-XLKUT-DOMAIN-BY-UPC                 53490000
535000            IF XL001-UPC-NOT-FOUND                                53500000
535100               CONTINUE                                           53510000
535200            ELSE                                                  53520000
535300               IF PS-EAS-TAG-IND-FOUND-NO                         53530000
535400                  MOVE SHUUPC-TRN-LNE-NBR TO PURITM-PO-LNE-NBR    53540000
535500                  PERFORM 7225-SELECT-TPURITM                     53550000
535600                  PERFORM 7233-CHECK-EAS-TAG                      53560000
535700               END-IF                                             53570000
535800                                                                  53580000
535900               IF PS-HANG-FOLD-IND-FOUND-NO                       53590000
536000                  MOVE XL001-HNG-FOLD-CDE TO PV-HANG-FOLD-IND     53600000
536100                  EVALUATE TRUE                                   53610000
536200                    WHEN PV-HANG-FOLD-IND = 'H'                   53620000
536300                       MOVE 1 TO  PV-HNG-FOLD-SEQ-NBR             53630000
536400                       SET PS-HANG-FOLD-IND-FOUND-YES TO TRUE     53640000
536500                    WHEN PV-HANG-FOLD-IND = 'F'                   53650000
536600                       MOVE 2 TO  PV-HNG-FOLD-SEQ-NBR             53660000
536700                       SET PS-HANG-FOLD-IND-FOUND-YES TO TRUE     53670000
536800                    WHEN OTHER                                    53680000
536900                       MOVE 0 TO  PV-HNG-FOLD-SEQ-NBR             53690000
537000                  END-EVALUATE                                    53700000
537100               END-IF                                             53710000
537200                                                                  53720000
537300               IF PS-BRAND-FOUND-NO                               53730080
537400                  PERFORM 7236-CHECK-BRAND                        53740080
537500               END-IF                                             53750000
537600                                                                  53760000
537700               IF PS-EAS-TAG-IND-FOUND-YES AND                    53770000
537800                  PS-HANG-FOLD-IND-FOUND-YES AND                  53780000
537900                  PS-BRAND-FOUND-YES                              53790080
538000                     SET PS-EO-HANG-FOLD-CSR TO TRUE              53800000
538100               END-IF                                             53810000
538200            END-IF                                                53820000
538300                                                                  53830000
538400       WHEN SQLCODE = +100                                        53840000
538500                SET  PS-EO-HANG-FOLD-CSR TO TRUE                  53850000
538600       WHEN OTHER                                                 53860000
538700             MOVE '6500-FETCH-HANG-FOLD-CSR'                      53870000
538800                             TO DP013-PARAGRAPH                   53880000
538900             MOVE 'SUKRF706 - CHECK FOR NOT FOUND       '         53890000
539000                             TO DP013-MESSAGE-TEXT(1)             53900000
539100             MOVE SU001-PO                                        53910000
539200                             TO DP013-MESSAGE-TEXT(2)             53920000
539300             MOVE SU001-CARTON                                    53930000
539400                             TO DP013-MESSAGE-TEXT(3)             53940000
539500             MOVE SQLCA      TO DP013-SQLCA                       53950000
539600             MOVE 'TSHUUPC'  TO DP013-DB2-TABLE-NAME(1)           53960000
539700             SET DP013-DB2-ABEND                                  53970000
539800                             TO TRUE                              53980000
539900             SET DP013-ROLLBACK                                   53990000
540000                             TO TRUE                              54000000
540100             SET DP013-XCTL-DISPLAY-RESTART                       54010000
540200                             TO TRUE                              54020000
540300             PERFORM DP014-0000-PROCESS-ABEND                     54030000
540400     END-EVALUATE.                                                54040000
540500                                                                  54050000
540600 6550-CLOSE-HANG-FOLD-CSR.                                        54060000
540700                                                                  54070000
540800         EXEC SQL                                                 54080000
540900             CLOSE HANG_FOLD_CSR                                  54090000
541000         END-EXEC                                                 54100000
541100                                                                  54110000
541200                                                                  54120000
541300         EVALUATE TRUE                                            54130000
541400             WHEN SQLCODE = ZERO                                  54140000
541500                 CONTINUE                                         54150000
541600             WHEN SQLWARN0 NOT = SPACES                           54160000
541700             WHEN SQLCODE < ZERO                                  54170000
541800             WHEN SQLCODE > ZERO                                  54180000
541900                 MOVE '6550-CLOSE-HANG-FOLD-CSR'                  54190000
542000                                   TO DP013-PARAGRAPH             54200000
542100                 MOVE 'CLOSE HANG FOLD CSR - '                    54210000
542200                                   TO DP013-MESSAGE-TEXT (1)      54220000
542300                 MOVE SQLCA        TO DP013-SQLCA                 54230000
542400                 MOVE 'TSHUUPC '   TO DP013-DB2-TABLE-NAME (1)    54240000
542500                 SET DP013-DB2-ABEND                              54250000
542600                     DP013-XCTL-DISPLAY-RESTART TO TRUE           54260000
542700                 SET DP013-ROLLBACK                               54270000
542800                                   TO TRUE                        54280000
542900                 PERFORM DP014-0000-PROCESS-ABEND                 54290000
543000         END-EVALUATE.                                            54300000
543100                                                                  54310000
543200                                                                  54320000
543300 EJECT                                                            54330000
543400                                                                  54340000
543500 6560-DETERMINE-WEIGHTS-MSRS.                                     54350000
543600                                                                  54360000
543700      SET PS-NOT-EO-WEIGHTS-MSRS-CSR                              54370000
543800          PS-WEIGHTS-MEAUSURES-CHECK-NO TO TRUE                   54380000
543900                                                                  54390000
544000      PERFORM 6570-OPEN-WEIGHTS-MSRS-CSR                          54400000
544100      PERFORM 6580-FETCH-WEIGHTS-MSRS-CSR                         54410000
544200        UNTIL PS-EO-WEIGHTS-MSRS-CSR OR                           54420000
544300              PS-WEIGHTS-MEAUSURES-CHECK.                         54430000
544400      PERFORM 6590-CLOSE-WEIGHTS-MSRS-CSR.                        54440000
544500                                                                  54450000
544600******************************************************************54460000
544700 6570-OPEN-WEIGHTS-MSRS-CSR.                                      54470000
544800                                                                  54480000
544900         EXEC SQL                                                 54490000
545000              OPEN WGHTS_MSRS_CSR                                 54500000
545100         END-EXEC                                                 54510000
545200                                                                  54520000
545300                                                                  54530000
545400         EVALUATE TRUE                                            54540000
545500             WHEN SQLCODE = ZERO                                  54550000
545600                 CONTINUE                                         54560000
545700             WHEN SQLWARN0 NOT = SPACES                           54570000
545800             WHEN SQLCODE < ZERO                                  54580000
545900             WHEN SQLCODE > ZERO                                  54590000
546000                 MOVE '6570-OPEN-WEIGHTS-MSRS-CSR'                54600000
546100                                   TO DP013-PARAGRAPH             54610000
546200                 MOVE 'OPEN WGHTS MSURES CSR '                    54620000
546300                                   TO DP013-MESSAGE-TEXT (1)      54630000
546400                 MOVE SQLCA        TO DP013-SQLCA                 54640000
546500                 MOVE 'TSHUUPC '   TO DP013-DB2-TABLE-NAME (1)    54650000
546600                 SET DP013-DB2-ABEND                              54660000
546700                     DP013-XCTL-DISPLAY-RESTART TO TRUE           54670000
546800                 SET DP013-ROLLBACK                               54680000
546900                                   TO TRUE                        54690000
547000                 PERFORM DP014-0000-PROCESS-ABEND                 54700000
547100         END-EVALUATE.                                            54710000
547200                                                                  54720000
547300 EJECT                                                            54730000
547400*----------------------------------------------------------------*54740000
547500*                                                                *54750000
547600*----------------------------------------------------------------*54760000
547700 6580-FETCH-WEIGHTS-MSRS-CSR.                                     54770000
547800                                                                  54780000
547900                                                                  54790000
548000     EXEC SQL                                                     54800000
548100        FETCH   WGHTS_MSRS_CSR                                    54810000
548200        INTO   :SHUUPC-UPC-NBR                                    54820000
548300     END-EXEC.                                                    54830000
548400                                                                  54840000
548500     EVALUATE TRUE                                                54850000
548600       WHEN SQLCODE = ZEROS                                       54860000
548700            PERFORM 7245-CALL-XLKUT-DOMAIN-BY-UPC                 54870000
548800            IF XL001-SHIP-WD-QTY = 0 OR                           54880000
548900               XL001-SHIP-DPTH-QTY = 0 OR                         54890000
549000               XL001-SHIP-HT-QTY = 0 OR                           54900000
549100               XL001-SHIP-WT-QTY = 0                              54910000
549200                    SET PS-WEIGHTS-MEAUSURES-CHECK TO TRUE        54920000
549300            END-IF                                                54930000
549400       WHEN SQLCODE = +100                                        54940000
549500                SET  PS-EO-WEIGHTS-MSRS-CSR TO TRUE               54950000
549600       WHEN OTHER                                                 54960000
549700             MOVE '6580-FETCH-WEIGHTS-MSRS-CSR'                   54970000
549800                             TO DP013-PARAGRAPH                   54980000
549900             MOVE 'SUKRF706 - CHECK FOR NOT FOUND       '         54990000
550000                             TO DP013-MESSAGE-TEXT(1)             55000000
550100             MOVE SU001-PO                                        55010000
550200                             TO DP013-MESSAGE-TEXT(2)             55020000
550300             MOVE SU001-CARTON                                    55030000
550400                             TO DP013-MESSAGE-TEXT(3)             55040000
550500             MOVE SQLCA      TO DP013-SQLCA                       55050000
550600             MOVE 'TSHUUPC'  TO DP013-DB2-TABLE-NAME(1)           55060000
550700             SET DP013-DB2-ABEND                                  55070000
550800                             TO TRUE                              55080000
550900             SET DP013-ROLLBACK                                   55090000
551000                             TO TRUE                              55100000
551100             SET DP013-XCTL-DISPLAY-RESTART                       55110000
551200                             TO TRUE                              55120000
551300             PERFORM DP014-0000-PROCESS-ABEND                     55130000
551400     END-EVALUATE.                                                55140000
551500                                                                  55150000
551600 6590-CLOSE-WEIGHTS-MSRS-CSR.                                     55160000
551700                                                                  55170000
551800         EXEC SQL                                                 55180000
551900             CLOSE WGHTS_MSRS_CSR                                 55190000
552000         END-EXEC                                                 55200000
552100                                                                  55210000
552200                                                                  55220000
552300         EVALUATE TRUE                                            55230000
552400             WHEN SQLCODE = ZERO                                  55240000
552500                 CONTINUE                                         55250000
552600             WHEN SQLWARN0 NOT = SPACES                           55260000
552700             WHEN SQLCODE < ZERO                                  55270000
552800             WHEN SQLCODE > ZERO                                  55280000
552900                 MOVE '6590-CLOSE-WEIGHTS-MSRS-CSR'               55290000
553000                                   TO DP013-PARAGRAPH             55300000
553100                 MOVE 'CLOSE WGHTS MSURES CSR'                    55310000
553200                                   TO DP013-MESSAGE-TEXT (1)      55320000
553300                 MOVE SQLCA        TO DP013-SQLCA                 55330000
553400                 MOVE 'TSHUUPC '   TO DP013-DB2-TABLE-NAME (1)    55340000
553500                 SET DP013-DB2-ABEND                              55350000
553600                     DP013-XCTL-DISPLAY-RESTART TO TRUE           55360000
553700                 SET DP013-ROLLBACK                               55370000
553800                                   TO TRUE                        55380000
553900                 PERFORM DP014-0000-PROCESS-ABEND                 55390000
554000         END-EVALUATE.                                            55400000
554100                                                                  55410000
554200 6700-LINK-XLKUT073.                                              55420000
554300                                                                  55430000
554400     INITIALIZE XL073-COMMAREA-REC                                55440000
554500     MOVE PV-DEPT-NUMBER              TO XL073-DEPT-NBR           55450000
554600     CALL XL073-DEPT-CL-MODULE USING DFHEIBLK                     55460000
554700                                     XL073-COMMAREA               55470000
554800                                     XL073-COMMAREA-REC           55480000
554900     EVALUATE TRUE                                                55490000
555000         WHEN XL073-NO-ERRORS                                     55500000
555100             MOVE XL073-BUS-AREA-ID  TO PV-BUS-AREA-ID            55510000
555200         WHEN XL073-DEPT-NOT-FND                                  55520000
555300             MOVE ZEROES TO PV-BUS-AREA-ID                        55530000
555400         WHEN OTHER                                               55540000
555500              SET PV-DONE-PROCESSING          TO TRUE             55550000
555600              MOVE XL073-SQLCODE        TO PV-SQLCODE             55560000
555700              STRING ' SUKRF706 (OTHER) -' DELIMITED BY SIZE      55570000
555800                     '6700-LINK-XLKUT073 ' DELIMITED BY SIZE      55580000
555900                     ' TABLE  '            DELIMITED BY SIZE      55590000
556000                     XL073-DB2-TABLE                              55600000
556100                                           DELIMITED BY SIZE      55610000
556200                                      INTO PV-CICS-MSG-AREA       55620000
556300              MOVE LENGTH OF PV-CICS-MSG-AREA                     55630000
556400                                        TO PV-COMMAREA-LENGTH     55640000
556500              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              55650000
556600                                                                  55660000
556700              MOVE '6700-LINK-XLKUT073'                           55670000
556800                              TO DP013-PARAGRAPH                  55680000
556900              MOVE 'LINK TO XLKUT004               '              55690000
557000                              TO DP013-MESSAGE-TEXT(1)            55700000
557100              MOVE 'CHECK CSSL FOR MORE DETAIL     '              55710000
557200                                TO DP013-MESSAGE-TEXT (3)         55720000
557300              MOVE  SU001-CARTON  TO PV-DISPLAY-CARTON            55730000
557400              MOVE  SU001-PO      TO PV-DISPLAY-PO                55740000
557500              MOVE  SU001-RCVR-SEQ-NBR TO PV-DISPLAY-PO-RCVR      55750000
557600              MOVE  PV-PO-LINE-N      TO PV-DISPLAY-PO-LNE-NBR    55760000
557700              MOVE  PV-DEPT-NUMBER    TO PV-DISPLAY-DEPT          55770000
557800              STRING '  CARTON - '        DELIMITED BY SIZE       55780000
557900                     PV-DISPLAY-CARTON    DELIMITED BY SIZE       55790000
558000                     ' PO, RCVR, DEPT '   DELIMITED BY SIZE       55800000
558100                     PV-DISPLAY-PO        DELIMITED BY SIZE       55810000
558200                     ' '                  DELIMITED BY SIZE       55820000
558300                     PV-DISPLAY-PO-RCVR   DELIMITED BY SIZE       55830000
558400                     ' '                  DELIMITED BY SIZE       55840000
558500                     PV-DISPLAY-DEPT DELIMITED BY SIZE            55850000
558600                              INTO DP013-MESSAGE-TEXT (4)         55860000
558700              MOVE SQLCA     TO DP013-SQLCA                       55870000
558800              SET DP013-DB2-ABEND                                 55880000
558900                              TO TRUE                             55890000
559000              SET DP013-ROLLBACK                                  55900000
559100                              TO TRUE                             55910000
559200              SET DP013-XCTL-DISPLAY-RESTART                      55920000
559300                              TO TRUE                             55930000
559400              PERFORM DP014-0000-PROCESS-ABEND                    55940000
559500     END-EVALUATE.                                                55950000
559600                                                                  55960000
559700******************************************************************55970000
559800 6750-CHECK-ECOMM-REPURPOSE.                                      55980000
559900******************************************************************55990000
560000*      --REPURPOSE--                                              56000000
560100     SET SU001-ECOMM-DC-REPURPOSE-NO TO TRUE                      56010000
560200     MOVE ZEROES             TO LBVRDA-PREPK-ID                   56020000
560300     PERFORM 6760-CHECK-TROUBLE-REPURP.                           56030000
560400     IF PV-TROUBLE-COUNT-REPUR > +0                               56040000
560500        SET SU001-ECOMM-DC-REPURPOSE TO TRUE                      56050000
560600        PERFORM 7220-SELECT-TPURCHS                               56060000
560700        IF PURCHS-PKGNG-CDE = PC-M OR PC-I                        56070000
560800           MOVE SU001-PO-LINE-NBR  TO PURITM-PO-LNE-NBR           56080000
560900           PERFORM 7225-SELECT-TPURITM                            56090000
561000           MOVE PURITM-PO-PREPK-ID TO SU001-PREPK-ID              56100000
561100        END-IF                                                    56110000
561200     ELSE                                                         56120000
561300*SLH 05/08 - ADDED REPURP CHECK                                   56130000
561400* PV-REPURP-COUNT > 0 MEANS THE DC IS TURNED ON TO REPURP FOR EFC 56140000
561500        IF PV-REPURP-COUNT > 0                                    56150000
561600          IF SU001-PKGNG-CDE = PC-B OR PC-C                       56160000
561700             PERFORM 7220-SELECT-TPURCHS                          56170000
561800             IF PURCHS-PKGNG-CDE = PC-M OR PC-I OR PC-SPACE       56180000
561900                IF PURCHS-PKGNG-CDE = PC-M OR PC-I                56190000
562000                   MOVE SU001-PO-LINE-NBR  TO PURITM-PO-LNE-NBR   56200000
562100                   PERFORM 7225-SELECT-TPURITM                    56210000
562200                   MOVE PURITM-PO-PREPK-ID TO SU001-PREPK-ID      56220000
562300                END-IF                                            56230000
562400                SET SU001-ECOMM-DC-REPURPOSE TO TRUE              56240000
562500             ELSE                                                 56250000
562600                PERFORM 6770-CHCK-TRBL-REPUR-INNR                 56260000
562700                IF PV-TROUBLE-CNT-REPUR-INNR > +0                 56270000
562800                   SET SU001-ECOMM-DC-REPURPOSE TO TRUE           56280000
562900                END-IF                                            56290000
563000             END-IF                                               56300000
563100          END-IF                                                  56310000
563200       END-IF                                                     56320000
563300     END-IF.                                                      56330000
563400*----------------------------------------------------------------*56340000
563500* CHECK IF PO/RECEIVER IS IN TROUBLE                             *56350000
563600* CHECK IF TROUBLE 405 WAS CREATED. FLAG FOR REPURPOSE EVEN IF THE56360000
563700* TROUBLE HAS BEEN ACKNOWLEDGED.                                 *56370000
563800*----------------------------------------------------------------*56380000
563900 6760-CHECK-TROUBLE-REPURP.                                       56390000
564000     MOVE SU001-RCVR-SEQ-NBR       TO DK-REC-SEQ-NBR.             56400000
564100     MOVE ZEROES                   TO PV-TROUBLE-COUNT-REPUR.     56410000
564200                                                                  56420000
564300     EXEC SQL                                                     56430000
564400        SELECT COUNT(*)                                           56440000
564500          INTO :PV-TROUBLE-COUNT-REPUR                            56450000
564600          FROM TTRBNTF A                                          56460000
564700              ,TTRBRSN C                                          56470000
564800         WHERE A.PO_NBR       =  :DK-PO                           56480000
564900           AND A.REC_SEQ_NBR  =  :DK-REC-SEQ-NBR                  56490000
565000           AND A.TRBL_RSN_CDE = C.TRBL_RSN_CDE                    56500000
565100           AND C.NOTIF_IND    =  'T'                              56510000
565200           AND EXISTS                                             56520000
565300              ( SELECT *                                          56530000
565400                FROM  TTRBRCN B                                   56540000
565500                WHERE B.RPT_PGM_NM  = 'SUKEC502'                  56550000
565600                  AND A.TRBL_RSN_CDE  =  B.TRBL_RSN_CDE )         56560000
565700     END-EXEC                                                     56570000
565800                                                                  56580000
565900     EVALUATE TRUE                                                56590000
566000         WHEN SQLCODE = ZERO                                      56600000
566100         WHEN SQLCODE = +100                                      56610000
566200             CONTINUE                                             56620000
566300         WHEN SQLWARN0 NOT = SPACES                               56630000
566400         WHEN SQLCODE < ZERO                                      56640000
566500         WHEN SQLCODE > ZERO                                      56650000
566600             MOVE SU001-CARTON   TO  PV-DISPLAY-CARTON            56660000
566700             MOVE DK-PO          TO  PV-DISPLAY-PO                56670000
566800             MOVE DK-REC-SEQ-NBR TO  PV-DISPLAY-PO-RCVR           56680000
566900             MOVE '6760-CHECK-TROUBLE-REPURP '                    56690000
567000                             TO DP013-PARAGRAPH                   56700000
567100             MOVE 'SUKRF706 - CHECK FOR TRBL REPUR'               56710000
567200                             TO DP013-MESSAGE-TEXT(1)             56720000
567300             STRING '  CARTON - '        DELIMITED BY SIZE        56730000
567400                    PV-DISPLAY-CARTON    DELIMITED BY SIZE        56740000
567500                    ' PO, RCVR   '       DELIMITED BY SIZE        56750000
567600                    PV-DISPLAY-PO        DELIMITED BY SIZE        56760000
567700                    ' '                  DELIMITED BY SIZE        56770000
567800                    PV-DISPLAY-PO-RCVR   DELIMITED BY SIZE        56780000
567900                    ' '                  DELIMITED BY SIZE        56790000
568000                             INTO DP013-MESSAGE-TEXT (2)          56800000
568100             MOVE SQLCA      TO DP013-SQLCA                       56810000
568200             MOVE 'TTRBNTF'  TO DP013-DB2-TABLE-NAME(1)           56820000
568300             SET DP013-DB2-ABEND                                  56830000
568400                             TO TRUE                              56840000
568500             SET DP013-ROLLBACK                                   56850000
568600                             TO TRUE                              56860000
568700             SET DP013-XCTL-DISPLAY-RESTART                       56870000
568800                             TO TRUE                              56880000
568900             PERFORM DP014-0000-PROCESS-ABEND                     56890000
569000                                                                  56900000
569100     END-EVALUATE.                                                56910000
569200                                                                  56920000
569300*----------------------------------------------------------------*56930000
569400* CHECK IF PO/RECEIVER IS IN TROUBLE                             *56940000
569500* CHECK IF TROUBLE 406 WAS CREATED. TROUBLE CREATED WHEN CURRENT  56950000
569600* LOCATION ANY DC OTHER THAN 870 ECOMM AND CREATED FOR LOCATION  *56960000
569700* IS 870, AND THE INNER CRTN QTY IS > 1                           56970000
569800*----------------------------------------------------------------*56980000
569900 6770-CHCK-TRBL-REPUR-INNR.                                       56990000
570000     MOVE SU001-RCVR-SEQ-NBR       TO DK-REC-SEQ-NBR.             57000000
570100     MOVE ZEROES                   TO PV-TROUBLE-CNT-REPUR-INNR.  57010000
570200                                                                  57020000
570300     EXEC SQL                                                     57030000
570400        SELECT COUNT(*)                                           57040000
570500          INTO :PV-TROUBLE-CNT-REPUR-INNR                         57050000
570600          FROM TTRBNTF A                                          57060000
570700              ,TTRBRSN C                                          57070000
570800         WHERE A.PO_NBR       =  :DK-PO                           57080000
570900           AND A.REC_SEQ_NBR  =  :DK-REC-SEQ-NBR                  57090000
571000           AND A.RESOLVED_IND IN ('N','I','R')                    57100000
571100           AND A.TRBL_RSN_CDE = C.TRBL_RSN_CDE                    57110000
571200           AND C.NOTIF_IND    =  'T'                              57120000
571300           AND EXISTS                                             57130000
571400              ( SELECT *                                          57140000
571500                FROM  TTRBRCN B                                   57150000
571600                WHERE B.RPT_PGM_NM  = 'SUEC1502'                  57160000
571700                  AND A.TRBL_RSN_CDE  =  B.TRBL_RSN_CDE )         57170000
571800     END-EXEC                                                     57180000
571900                                                                  57190000
572000     EVALUATE TRUE                                                57200000
572100         WHEN SQLCODE = ZERO                                      57210000
572200         WHEN SQLCODE = +100                                      57220000
572300             CONTINUE                                             57230000
572400         WHEN SQLWARN0 NOT = SPACES                               57240000
572500         WHEN SQLCODE < ZERO                                      57250000
572600         WHEN SQLCODE > ZERO                                      57260000
572700             MOVE SU001-CARTON   TO  PV-DISPLAY-CARTON            57270000
572800             MOVE DK-PO          TO  PV-DISPLAY-PO                57280000
572900             MOVE DK-REC-SEQ-NBR TO  PV-DISPLAY-PO-RCVR           57290000
573000             MOVE '6770-CHCK-TRBL-REPUR-INNR '                    57300000
573100                             TO DP013-PARAGRAPH                   57310000
573200             MOVE 'SUKRF706 - CHECK FOR TRBL REPUR'               57320000
573300                             TO DP013-MESSAGE-TEXT(1)             57330000
573400             STRING '  CARTON - '        DELIMITED BY SIZE        57340000
573500                    PV-DISPLAY-CARTON    DELIMITED BY SIZE        57350000
573600                    ' PO, RCVR   '       DELIMITED BY SIZE        57360000
573700                    PV-DISPLAY-PO        DELIMITED BY SIZE        57370000
573800                    ' '                  DELIMITED BY SIZE        57380000
573900                    PV-DISPLAY-PO-RCVR   DELIMITED BY SIZE        57390000
574000                    ' '                  DELIMITED BY SIZE        57400000
574100                             INTO DP013-MESSAGE-TEXT (2)          57410000
574200             MOVE SQLCA      TO DP013-SQLCA                       57420000
574300             MOVE 'TTRBNTF'  TO DP013-DB2-TABLE-NAME(1)           57430000
574400             SET DP013-DB2-ABEND                                  57440000
574500                             TO TRUE                              57450000
574600             SET DP013-ROLLBACK                                   57460000
574700                             TO TRUE                              57470000
574800             SET DP013-XCTL-DISPLAY-RESTART                       57480000
574900                             TO TRUE                              57490000
575000             PERFORM DP014-0000-PROCESS-ABEND                     57500000
575100                                                                  57510000
575200     END-EVALUATE.                                                57520000
575300                                                                  57530000
580800*----------------------------------------------------------------*58080000
580900******************************************************************58090000
581000* TEMPORARY CODE TO CHECK IF AUDITS LABELS HAD BEEN REQUESTED    *58100000
581100* PRIOR TO THE CHANGES FOR AUDIT PROMPTING.                     **58110000
581200* IF AN AUDIT LABEL HAD BEEN PREVIOUSLY PRINTED FOR BULK/CASEPACK,58120000
581300* OR IF CARTONS HAVE BEEN PREVIOULSY CHECKED IN FOR A PO/TRIP FOR*58130000
581400* PACK BY STORE, THE NEW AUDIT MODULE WILL NOT BE CALLED.       **58140000
581500* 2002-03-18 DATE TWO WEEKS AFTER INSTALL                       **58150000
581600******************************************************************58160000
581700 7000-AUDIT-CHECK-PROCESSING.                                     58170000
581800                                                                  58180000
581900     IF SU001-FLOWBACK-YES                                        58190000
582000        PERFORM 7220-SELECT-TPURCHS                               58200000
582100        IF (PURCHS-PO-TYP-CDE = 'FB' OR                           58210000
582200            PURCHS-PO-TYP-CDE = 'IF') AND                         58220000
582300            PS-ACTIVE-XREF-ROW-FOUND AND                          58230000
582400            SU001-LBL-REPRINT                                     58240000
582500         SET PS-FLOWBACK-BYPASS-AUDIT TO TRUE                     58250000
582600        END-IF                                                    58260000
582700     END-IF                                                       58270000
582800                                                                  58280000
582900     PERFORM 7405-GET-CURRENT-DATE                                58290000
583000     IF PS-FLOWBACK-BYPASS-AUDIT OR                               58300000
583100        PS-SULBXF-ROW-FOUND                                       58310000
583200         CONTINUE                                                 58320000
583300     ELSE                                                         58330000
583400         PERFORM 7100-CHECK-CRTN-AUDIT-STATUS                     58340000
583500     END-IF.                                                      58350000
583600     SET PS-DONT-PRINT-AUDIT-LABEL  TO TRUE.                      58360000
583700                                                                  58370000
583800******************************************************************58380000
583900*CHECK INSTALL DATE FROM THE PARM TABLE                           58390000
584000******************************************************************58400000
584100 7050-CHECK-TKRPRPM.                                              58410000
584200                                                                  58420000
584300                                                                  58430000
584400     EXEC SQL                                                     58440000
584500          SELECT FUNC_BEG_TMST                                    58450000
584600          INTO  :KRPRPM-FUNC-BEG-TMST                             58460000
584700          FROM   TKRPRPM                                          58470000
584800          WHERE  LOC_ID            =  90                          58480000
584900            AND  SYS_PRC_FUNC_CDE  = 'BEGAUD'                     58490000
585000     END-EXEC.                                                    58500000
585100                                                                  58510000
585200                                                                  58520000
585300     EVALUATE TRUE                                                58530000
585400         WHEN SQLCODE = ZERO                                      58540000
585500             CONTINUE                                             58550000
585600         WHEN SQLCODE = +100                                      58560000
585700             MOVE ZEROES TO KRPRPM-FUNC-BEG-TMST                  58570000
585800         WHEN SQLWARN0 NOT = SPACES                               58580000
585900         WHEN SQLCODE < ZERO                                      58590000
586000         WHEN SQLCODE > ZERO                                      58600000
586100             MOVE '7050-CHECK-TKRPRPM'                            58610000
586200                             TO DP013-PARAGRAPH                   58620000
586300             MOVE 'SUKRF706 - CHECK VALID CARTON'                 58630000
586400                             TO DP013-MESSAGE-TEXT(1)             58640000
586500             MOVE SHPUNT-SHIPT-UNT-ID                             58650000
586600                             TO DP013-MESSAGE-TEXT(2)             58660000
586700             MOVE SQLCA      TO DP013-SQLCA                       58670000
586800             MOVE 'TKRPRPM'  TO DP013-DB2-TABLE-NAME(1)           58680000
586900             SET DP013-DB2-ABEND                                  58690000
587000                             TO TRUE                              58700000
587100             SET DP013-ROLLBACK                                   58710000
587200                             TO TRUE                              58720000
587300             SET DP013-XCTL-DISPLAY-RESTART                       58730000
587400                             TO TRUE                              58740000
587500             PERFORM DP014-0000-PROCESS-ABEND                     58750000
587600                                                                  58760000
587700     END-EVALUATE.                                                58770000
587800******************************************************************58780000
587900*SELECT DIVERT LOCATION BARCODE  FOR REPURPOSE                    58790000
588000******************************************************************58800000
588100 7055-CHECK-TKRPRPM-REPURP-LOC.                                   58810000
588200                                                                  58820000
588300     MOVE SU001-CURR-OPER-UNT-ID TO KRPRPM-LOC-ID.                58830000
588400                                                                  58840000
588500     EXEC SQL                                                     58850000
588600          SELECT FUNC_TXT                                         58860000
588700          INTO  :KRPRPM-FUNC-TXT                                  58870000
588800          FROM   TKRPRPM                                          58880000
588900          WHERE  LOC_ID            =  :KRPRPM-LOC-ID              58890000
589000            AND  SYS_PRC_FUNC_CDE  = 'ECRPRP'                     58900000
589100     END-EXEC.                                                    58910000
589200                                                                  58920000
589300                                                                  58930000
589400     EVALUATE TRUE                                                58940000
589500         WHEN SQLCODE = ZERO                                      58950000
589600             CONTINUE                                             58960000
589700         WHEN SQLWARN0 NOT = SPACES                               58970000
589800         WHEN SQLCODE < ZERO                                      58980000
589900         WHEN SQLCODE > ZERO                                      58990000
590000             MOVE '77055-CHECK-TKRPRPM-REPURP-LOC'                59000000
590100                             TO DP013-PARAGRAPH                   59010000
590200             MOVE 'SUKRF706 - CHECK REPURP BRCDE'                 59020000
590300                             TO DP013-MESSAGE-TEXT(1)             59030000
590400             MOVE SHPUNT-SHIPT-UNT-ID                             59040000
590500                             TO DP013-MESSAGE-TEXT(2)             59050000
590600             MOVE SQLCA      TO DP013-SQLCA                       59060000
590700             MOVE 'TKRPRPM'  TO DP013-DB2-TABLE-NAME(1)           59070000
590800             SET DP013-DB2-ABEND                                  59080000
590900                             TO TRUE                              59090000
591000             SET DP013-ROLLBACK                                   59100000
591100                             TO TRUE                              59110000
591200             SET DP013-XCTL-DISPLAY-RESTART                       59120000
591300                             TO TRUE                              59130000
591400             PERFORM DP014-0000-PROCESS-ABEND                     59140000
591500                                                                  59150000
591600     END-EVALUATE.                                                59160000
591700******************************************************************59170000
591800*CHECK FOR PREVIOUSLY CHECKED CARTONS                             59180000
591900******************************************************************59190000
592000 7070-CHECK-PREV-CKED-CRTNS.                                      59200000
592100                                                                  59210000
592200                                                                  59220000
592300     EXEC SQL                                                     59230000
592400         SELECT  MIN(B.CRE_TMST)                                  59240000
592500         INTO   :SHUNLO-CRE-TMST :PV-NULL-CRE-TMST                59250000
592600         FROM   TSHUUPC A                                         59260000
592700              , TSHUNLO B                                         59270000
592800         WHERE  A.SHIPT_UNT_ID   =  B.SHIPT_UNT_ID                59280000
592900           AND  A.TRN_NBR        = :SU001-PO                      59290000
593000           AND  B.TRIP_ID        = :SU001-MANIFEST                59300000
593100     END-EXEC.                                                    59310000
593200                                                                  59320000
593300     EVALUATE TRUE                                                59330000
593400         WHEN SQLCODE = ZERO                                      59340000
593500             IF PV-NULL-CRE-TMST = -1                             59350000
593600                MOVE PC-DEFAULT-TIME TO SHUNLO-CRE-TMST           59360000
593700             END-IF                                               59370000
593800         WHEN SQLCODE = +100                                      59380000
593900             MOVE ZEROES TO SHUNLO-CRE-TMST                       59390000
594000         WHEN SQLWARN0 NOT = SPACES                               59400000
594100         WHEN SQLCODE NOT EQUAL ZERO                              59410000
594200             MOVE '7070-CHECK-PREV-CKED-CRTNS'                    59420000
594300                             TO DP013-PARAGRAPH                   59430000
594400             MOVE 'SUKRF706 - CHECK VALID CARTON'                 59440000
594500                             TO DP013-MESSAGE-TEXT(1)             59450000
594600             MOVE SU001-CARTON                                    59460000
594700                             TO DP013-MESSAGE-TEXT(2)             59470000
594800             MOVE SU001-MANIFEST                                  59480000
594900                             TO DP013-MESSAGE-TEXT(3)             59490000
595000             MOVE SQLCA      TO DP013-SQLCA                       59500000
595100             MOVE 'TSHUNLO'  TO DP013-DB2-TABLE-NAME(1)           59510000
595200             SET DP013-DB2-ABEND                                  59520000
595300                             TO TRUE                              59530000
595400             SET DP013-ROLLBACK                                   59540000
595500                             TO TRUE                              59550000
595600             SET DP013-XCTL-DISPLAY-RESTART                       59560000
595700                             TO TRUE                              59570000
595800             PERFORM DP014-0000-PROCESS-ABEND                     59580000
595900     END-EVALUATE.                                                59590000
596000                                                                  59600000
596100*----------------------------------------------------------------*59610000
596200*  CALL TO AUDIT MODULE TO CHECK CARTON AUDIT STATUS             *59620000
596300*----------------------------------------------------------------*59630000
596400 7100-CHECK-CRTN-AUDIT-STATUS.                                    59640000
596500      INITIALIZE SU021-CARTON-AUDIT-RECORD.                       59650000
596600                                                                  59660000
596700      SET  SU021-CARTON-CHECK-IN                                  59670000
596800           SU021-AUDIT-IS-COMPLETE  TO TRUE.                      59680000
596900      MOVE SU001-PROMPT-IND  TO SU021-DEFERRED-AUDIT-IND.         59690000
597000                                                                  59700000
597100      MOVE SU001-PO            TO SU021-PO-NUMBER                 59710000
597200      MOVE SU001-PO-LINE-NBR   TO SU021-LINE-NBR                  59720000
597300                                     RECITM-PREPK-ID              59730000
597400      IF SU001-RECEIV-PBS-IND = 'Y'                               59740000
597500          MOVE +0              TO SU021-DRIVER-LINE-NBR           59750000
597600                                  SU021-PRE-PACK-ID               59760000
597700                                  SU001-PRE-PACK-ID               59770000
597800          MOVE PC-PS       TO SU021-PACKAGE-TYPE-CODE             59780000
597900      ELSE                                                        59790000
598000          IF SU001-PKGNG-CDE  = PC-M OR PC-I                      59800000
598100              PERFORM 2380-SELECT-PREPAK-INFO                     59810000
598200              MOVE PC-PP           TO SU021-PACKAGE-TYPE-CODE     59820000
598300              MOVE PV-DRIVER-LINE-NO                              59830000
598400                                   TO SU021-DRIVER-LINE-NBR       59840000
598500              MOVE RECITM-PREPK-ID TO SU021-PRE-PACK-ID           59850000
598600                                      SU001-PRE-PACK-ID           59860000
598700          ELSE                                                    59870000
598800              MOVE +0              TO SU021-DRIVER-LINE-NBR       59880000
598900                                      SU021-PRE-PACK-ID           59890000
599000                                      SU001-PRE-PACK-ID           59900000
599100              MOVE PC-BC       TO SU021-PACKAGE-TYPE-CODE         59910000
599200          END-IF                                                  59920000
599300      END-IF.                                                     59930000
599400      MOVE SU001-OPER-UNT-ID   TO SU021-OPER-UNT-ID               59940000
599500      MOVE SU001-RCVR-SEQ-NBR  TO SU021-REC-SEQ-NBR               59950000
599600      MOVE SU001-MANIFEST      TO SU021-INBOUND-TRIP-ID           59960000
599700      MOVE SU001-CARTON        TO SU021-SHIPT-UNT-ID              59970000
599800      MOVE SU001-USER-ID       TO SU021-USER-ID                   59980000
599900      PERFORM 7260-LINK-SUKCS583.                                 59990000
600000                                                                  60000000
600100      MOVE SU021-AUDIT-NUMBER  TO SU001-AUDIT-CNTL-NBR.           60010000
600200*----------------------------------------------------------------*60020000
600300*  GATHER LABEL INFORMATION                                      *60030000
600400*----------------------------------------------------------------*60040000
600500 7200-GATHER-LABEL-INFO.                                          60050000
600600                                                                  60060000
600700     INITIALIZE DCLTLBPTDA.                                       60070000
600800                                                                  60080000
600900     MOVE  ZEROES                 TO  LBPTDA-PREPK-ID             60090000
601000                                      LBPTDA-PREPK-RATO-QTY       60100000
601100                                      LBPTDA-PREPK-UNT-QTY        60110000
601200                                      LBPTDA-CSE-PK-QTY           60120000
601300                                      LBPTDA-LBL-TYP-LBL-SEQ-ID   60130000
601400                                      LBPTDA-LBL-TYP-TOT-QTY      60140000
601500                                      LBPTDA-ITM-NBR.             60150000
601600     MOVE  SPACES                 TO  LBPTDA-MODU-DESC            60160000
601700                                      LBPTDA-ODD-CART-IND         60170000
601800                                      LBPTDA-STRG-AREA-CDE.       60180000
601900*                                                                 60190006
602000     MOVE  SEASET-SEASET-NM        TO  LBPTDA-SEASET-NM.          60200000
602100     MOVE  PV-FIXTURE-ID           TO  LBPTDA-FIXT-ID.            60210000
602200     MOVE  'N'                     TO  LBPTDA-INPK-CNVYB-IND.     60220000
602300     MOVE  'S'                     TO  LBPTDA-CART-LBL-TYP-CDE.   60230000
602400     MOVE  PV-DEPT-DESC            TO  LBPTDA-DEPT-DESC.          60240000
602500     MOVE  PV-MAJ-CL-DESC          TO  LBPTDA-MAJ-CL-DESC.        60250000
602600     MOVE  PV-INNR-PACK-QTY        TO  LBPTDA-INPK-UNT-QTY.       60260000
602700     MOVE  PC160-BTCH-BARCODE      TO  LBPTDA-BRCDE-NBR.          60270000
602800*                                                                 60280006
602900     MOVE PV-HNG-FOLD-SEQ-NBR      TO  LBPTDA-HNG-FOLD-SEQ-NBR    60290000
603000     MOVE PS-EAS-TAG-IND-FOUND-SW                                 60300000
603100                               TO LBPTDA-EAS-TAG-IND              60310000
603200     MOVE CNDCDR-DOOR-ID       TO LBPTDA-DOOR-ID                  60320000
603210*CLP 06/24/2015 START                                             60321084
603300     IF PS-BRAND-FOUND-YES                                        60330080
603400        MOVE 35 TO LBPTDA-LBL-MSG-TXT-LEN                         60340081
603401*       GET THE BUSINESS DESC FIRST                               60340186
603402        PERFORM 6700-LINK-XLKUT073                                60340286
603410                                                                  60341082
603420        PERFORM 7270-INSPECT-BUS-AREA                             60342080
603430        MOVE PV-BUS-AREA-BRAND    TO LBPTDA-LBL-MSG-TXT-TEXT      60343081
603470*CLP 06/24/2015 END                                               60347080
603700     END-IF                                                       60370000
603800*                                                                 60380006
603900     IF SU001-NOT-MULTI-LINE                                      60390000
604000        IF PS-OPER-IS-ECOMM-DS                                    60400000
604100               MOVE  'E'           TO  LBPTDA-CART-LBL-TYP-CDE    60410000
604200               MOVE   PV-SKU-OUT-9 TO  LBPTDA-ITM-NBR             60420000
604300        END-IF                                                    60430000
604400     ELSE                                                         60440000
604500        IF PS-OPER-IS-ECOMM-DC AND                                60450000
604600             PS-OPER-IS-ECOMM-DS AND                              60460000
604700               PV-REPURP-COUNT > 0                                60470000
604800               MOVE  PC-FLAT  TO XLT00010-LOC-10-ABBR-NM          60480000
604900     END-IF                                                       60490000
605000                                                                  60500000
605100                                                                  60510000
605200     IF PS-ODD-UNT-CRTN-FOUND                                     60520000
605300        MOVE RECITM-PREPK-ID       TO LBPTDA-PREPK-ID             60530000
605400     END-IF                                                       60540000
605500                                                                  60550000
605600                                                                  60560000
605700     IF PS-REPRINT-DUP                                            60570000
605800        IF SU001-NO-LINE                                          60580000
605900           MOVE  '** NO LINE NUMBER **' TO  PV-VEND-STYL-NAME     60590000
606000        ELSE                                                      60600000
606100           PERFORM 7230-GET-DEPT-CL-SKU                           60610000
606200        END-IF                                                    60620000
606300     END-IF.                                                      60630000
606400                                                                  60640000
606500     IF SU001-MULTI-LINE                                          60650000
606600        MOVE  '*MULTIPLE LINES*' TO  PV-VEND-STYL-NAME            60660000
606700     END-IF.                                                      60670000
606800*----------------------------------------------------------------*60680000
606900*  INSERT ROW INTO LABEL TABLE FOR BATCH LABEL OPTION            *60690000
607000*----------------------------------------------------------------*60700000
607100 7205-INSERT-LABEL-TABLE.                                         60710000
607200                                                                  60720000
607300     MOVE SPACE                  TO   LBPTDA-PRC-MSG-CDE.         60730006
607400                                                                  60740000
607500     MOVE  SU001-CARTON           TO  LBPTDA-SHIPT-UNT-ID.        60750000
607600     MOVE  SU001-MANIFEST         TO  LBPTDA-TRIP-ID.             60760010
607700     MOVE  SU001-BATCH-NUMBER     TO  LBPTDA-LBL-PRT-BTCH-ID.     60770006
607800     MOVE  SU001-CURR-OPER-UNT-ID TO  LBPTDA-OPER-UNT-ID.         60780006
607900     MOVE  SU001-FCLTY-ID         TO  LBPTDA-FCLTY-ID.            60790006
608000     MOVE  SU001-PO               TO  LBPTDA-PO-NBR.              60800006
608400     MOVE SU001-RCVR-SEQ-NBR      TO  LBPTDA-RCVR-SEQ-NBR.        60840056
608600     MOVE  SU001-PO-LINE-NBR      TO  LBPTDA-PO-LNE-NBR.          60860006
608700     MOVE  SU001-STORE            TO  LBPTDA-DEST-OPER-UNT-ID.    60870000
608800     MOVE  SU001-OPER-UNT-ID      TO  LBPTDA-MISDIR-OPER-UNT-ID.  60880000
608900     MOVE  PV-OUTR-PACK-QTY       TO  LBPTDA-OTPK-UNT-QTY.        60890000
609000     MOVE  PV-HNG-FOLD-SEQ-NBR    TO  LBPTDA-HNG-FOLD-SEQ-NBR.    60900000
609100     MOVE  SU021-AUDIT-VALIDATION-SW                              60910000
609200                                  TO  LBPTDA-CART-ACTN-CDE.       60920000
609300     MOVE  PV-BUS-AREA-ID         TO  LBPTDA-BUS-AREA-ID.         60930000
609400     MOVE  PV-SKU-NBR-LBL         TO  LBPTDA-SKU-NBR.             60940000
609500                                                                  60950000
609600     IF SU001-MULTI-LINE                                          60960000
609700         IF LBVRDA-PREPK-ID > 0 OR                                60970000
609800            SU001-ECOMM-DC-REPURPOSE                              60980000
609900            CONTINUE                                              60990000
610000         ELSE                                                     61000000
610100            MOVE ZEROES               TO  LBPTDA-PO-LNE-NBR       61010000
610200                                          XL001-SKU-NBR           61020000
610300                                          LBPTDA-SKU-NBR          61030000
610400            MOVE SPACES               TO  PV-DEPT-NUMBER          61040000
610500                                          PV-CL-NBR               61050000
610600                                          XL001-DEPT-NBR-3CH      61060000
610700                                          XL001-SUB-CL-NBR-2CH    61070000
610800         END-IF                                                   61080000
610900     END-IF.                                                      61090000
611000                                                                  61100000
611100     MOVE  SPACE                 TO  LBPTDA-SU-FRE-ASTRA-IND      61110000
611200                                                                  61120000
611300     EVALUATE TRUE                                                61130000
611400        WHEN PS-PRINT-AUDIT-LABEL                                 61140000
611500          MOVE 'Q'               TO  LBPTDA-CART-LBL-TYP-CDE      61150000
611600          MOVE 'QC AUDIT '       TO  LBPTDA-BRCDE-NBR             61160000
611700     END-EVALUATE                                                 61170000
611800                                                                  61180000
611900     IF PS-ODD-UNT-CRTN-FOUND                                     61190000
612000          MOVE 'O'               TO  LBPTDA-CART-LBL-TYP-CDE      61200000
612100          MOVE 'ODD UNITS'       TO  LBPTDA-BRCDE-NBR             61210000
612200          MOVE 'Y'               TO  LBPTDA-ODD-CART-IND          61220000
612300          MOVE SPACES            TO  PV-VEND-STYL-NAME            61230000
612400     END-IF                                                       61240000
612500                                                                  61250000
612600     IF SU021-AUDIT-REQUIRED                                      61260000
612700        MOVE  'S'                TO  LBPTDA-CART-LBL-TYP-CDE      61270000
612800        MOVE  SU021-AUDIT-NUMBER TO  LBPTDA-BRCDE-NBR             61280000
612900     END-IF                                                       61290000
613000                                                                  61300000
613100     IF  SU001-REPRINT                                            61310000
613200           MOVE SU001-REPRINT-IND TO  LBPTDA-RPRT-IND.            61320000
613300                                                                  61330000
613400     EXEC SQL                                                     61340000
613500         INSERT INTO TLBPTDA                                      61350000
613600                ( TRIP_ID                                         61360000
613700                , CRE_USR_ID                                      61370000
613800                , LBL_PRT_BTCH_ID                                 61380000
613900                , SHIPT_UNT_ID                                    61390000
614000                , OPER_UNT_ID                                     61400000
614100                , FCLTY_ID                                        61410000
614200                , CRE_TMST                                        61420000
614300                , OWNR_SCAC_ID                                    61430000
614400                , VEH_NBR                                         61440000
614500                , RPRT_IND                                        61450000
614600                , SU_DUP_LBL_IND                                  61460000
614700                , SU_FRE_ASTRA_IND                                61470000
614800                , SU_MSSG_DAT_IND                                 61480000
614900                , SU_MISDIR_IND                                   61490000
615000                , MISDIR_OPER_UNT_ID                              61500000
615100                , PO_NBR                                          61510000
615200                , RCVR_SEQ_NBR                                    61520000
615300                , PO_LNE_NBR                                      61530000
615400                , DEST_OPER_UNT_ID                                61540000
615500                , STR_NM                                          61550000
615600                , STR_ZN_ID                                       61560000
615700                , SKU_DEPT_NBR                                    61570000
615800                , SKU_CL_NBR                                      61580000
615900                , VS_NBR                                          61590000
616000                , OTPK_UNT_QTY                                    61600000
616100                , INPK_UNT_QTY                                    61610000
616200                , PRTR_ID                                         61620000
616300                , BRCDE_NBR                                       61630000
616400                , DC_PRTD_AT_CDE                                  61640000
616500                , INVLD_DAT_ERR_CDE                               61650000
616600                , PREPK_ID                                        61660000
616700                , PREPK_RATO_QTY                                  61670000
616800                , PREPK_UNT_QTY                                   61680000
616900                , CSE_PK_QTY                                      61690000
617000                , ODD_CART_IND                                    61700000
617100                , INPK_CNVYB_IND                                  61710000
617200                , LBL_TYP_LBL_SEQ_ID                              61720000
617300                , LBL_TYP_TOT_QTY                                 61730000
617400                , MODU_DESC                                       61740000
617500                , ITM_NBR                                         61750000
617600                , DEPT_DESC                                       61760000
617700                , MAJ_CL_DESC                                     61770000
617800                , SEASET_NM                                       61780000
617900                , FIXT_ID                                         61790000
618000                , CART_LBL_TYP_CDE                                61800000
618100                , STRG_AREA_CDE                                   61810000
618200                , CART_ACTN_CDE                                   61820000
618300                , HNG_FOLD_SEQ_NBR                                61830000
618400                , BUS_AREA_ID                                     61840000
618500                , SKU_NBR                                         61850000
618510*CLP 06/24/15 START                                               61851080
618600                , LBL_MSG_TXT                                     61860080
618610*CLP 06/24/15 END                                                 61861080
618700                , EAS_TAG_IND                                     61870000
618800                , DOOR_ID                                         61880000
618900                , PRC_MSG_CDE )                                   61890000
619000         VALUES                                                   61900000
619100                ( :LBPTDA-TRIP-ID                                 61910000
619200                , :SU001-USER-ID                                  61920000
619300                , :LBPTDA-LBL-PRT-BTCH-ID                         61930000
619400                , :LBPTDA-SHIPT-UNT-ID                            61940000
619500                , :LBPTDA-OPER-UNT-ID                             61950000
619600                , :LBPTDA-FCLTY-ID                                61960000
619700                ,  CURRENT TIMESTAMP                              61970000
619800                , :SU001-OWNER-SCAC-ID                            61980000
619900                , :SU001-VEH-NBR                                  61990000
620000                , :LBPTDA-RPRT-IND                                62000000
620100                , :SU001-DUPLICATE-IND                            62010000
620200                , :LBPTDA-SU-FRE-ASTRA-IND                        62020000
620300                , :LBPTDA-SU-MSSG-DAT-IND                         62030000
620400                , :SU001-MISDIRECT-IND                            62040000
620500                , :LBPTDA-MISDIR-OPER-UNT-ID                      62050000
620600                , :LBPTDA-PO-NBR                                  62060000
620700                , :LBPTDA-RCVR-SEQ-NBR                            62070000
620800                , :LBPTDA-PO-LNE-NBR                              62080000
620900                , :LBPTDA-DEST-OPER-UNT-ID                        62090000
621000                , :XLT00010-LOC-10-ABBR-NM                        62100000
621100                , :LBPTDA-STR-ZN-ID                               62110000
621200                , :XL001-DEPT-NBR-3CH                             62120000
621300                , :XL001-SUB-CL-NBR-2CH                           62130000
621400                , :PV-VEND-STYL-NAME                              62140000
621500                , :LBPTDA-OTPK-UNT-QTY                            62150000
621600                , :LBPTDA-INPK-UNT-QTY                            62160000
621700                , :SU001-PRINTER-ID                               62170000
621800                , :LBPTDA-BRCDE-NBR                               62180000
621900                , :SU001-DC-PRTD-AT-CDE                           62190000
622000                , :LBPTDA-INVLD-DAT-ERR-CDE                       62200000
622100                , :LBPTDA-PREPK-ID                                62210000
622200                , :LBPTDA-PREPK-RATO-QTY                          62220000
622300                , :LBPTDA-PREPK-UNT-QTY                           62230000
622400                , :LBPTDA-CSE-PK-QTY                              62240000
622500                , :LBPTDA-ODD-CART-IND                            62250000
622600                , :LBPTDA-INPK-CNVYB-IND                          62260000
622700                , :LBPTDA-LBL-TYP-LBL-SEQ-ID                      62270000
622800                , :LBPTDA-LBL-TYP-TOT-QTY                         62280000
622900                , :LBPTDA-MODU-DESC                               62290000
623000                , :LBPTDA-ITM-NBR                                 62300000
623100                , :LBPTDA-DEPT-DESC                               62310000
623200                , :LBPTDA-MAJ-CL-DESC                             62320000
623300                , :LBPTDA-SEASET-NM                               62330000
623400                , :LBPTDA-FIXT-ID                                 62340000
623500                , :LBPTDA-CART-LBL-TYP-CDE                        62350000
623600                , :LBPTDA-STRG-AREA-CDE                           62360000
623700                , :LBPTDA-CART-ACTN-CDE                           62370000
623800                , :LBPTDA-HNG-FOLD-SEQ-NBR                        62380000
623900                , :LBPTDA-BUS-AREA-ID                             62390000
624000                , :LBPTDA-SKU-NBR                                 62400000
624100                , :LBPTDA-LBL-MSG-TXT                             62410080
624200                , :LBPTDA-EAS-TAG-IND                             62420000
624300                , :LBPTDA-DOOR-ID                                 62430000
624400                , :LBPTDA-PRC-MSG-CDE )                           62440000
624500     END-EXEC.                                                    62450000
624600                                                                  62460000
624700     EVALUATE TRUE                                                62470000
624800         WHEN SQLCODE = ZERO                                      62480000
624900              ADD  1  TO  SU001-ROWS-INSERTED                     62490000
625000                                                                  62500000
625100         WHEN SQLWARN0 NOT = SPACES                               62510000
625200         WHEN SQLCODE NOT EQUAL ZERO                              62520000
625300                                                                  62530000
625400             MOVE '7205-INSERT-LABEL-TABLE'                       62540000
625500                                       TO DP013-PARAGRAPH         62550000
625600             MOVE ' SUKRF706 - INSERT INTO LABEL PRINT DATA TBL'  62560000
625700                                       TO DP013-MESSAGE-TEXT(1)   62570000
625800             MOVE  SQLCODE             TO  PV-SQLCODE             62580000
625900             STRING ' SQLCODE - '         DELIMITED BY SIZE       62590000
626000                    PV-SQLCODE            DELIMITED BY SIZE       62600000
626100                                     INTO DP013-MESSAGE-TEXT(2)   62610000
626200             MOVE SQLCA                TO DP013-SQLCA             62620000
626300             MOVE 'TLBPTDA'            TO DP013-DB2-TABLE-NAME(1) 62630000
626400             SET  DP013-DB2-ABEND      TO TRUE                    62640000
626500             SET  DP013-ROLLBACK       TO TRUE                    62650000
626600             SET  DP013-XCTL-DISPLAY-RESTART                      62660000
626700                                       TO TRUE                    62670000
626800             PERFORM DP014-0000-PROCESS-ABEND                     62680000
626900                                                                  62690000
627000     END-EVALUATE.                                                62700000
627100                                                                  62710000
627200                                                                  62720000
627300*----------------------------------------------------------------*62730000
627400*                                                                *62740000
627500*----------------------------------------------------------------*62750000
627600 7210-GET-STORE-INFO.                                             62760000
627700                                                                  62770000
627800     MOVE  SU001-STORE TO  DK-STORE.                              62780000
627900                                                                  62790000
628000     EXEC SQL                                                     62800000
628100          SELECT  LOC_10_ABBR_NM                                  62810000
628200                , LOC_TYP_CDE                                     62820000
628300                , E_BUS_IND                                       62830000
628400          INTO    :XLT00010-LOC-10-ABBR-NM                        62840000
628500                , :XLT00010-LOC-TYP-CDE                           62850000
628600                , :XLT00010-E-BUS-IND :PV-NULL-E-BUS-IND          62860000
628700          FROM   XLT_LOC                                          62870000
628800          WHERE  LOC_NBR   = :DK-STORE                            62880000
628900     END-EXEC.                                                    62890000
629000                                                                  62900000
629100     EVALUATE TRUE                                                62910000
629200         WHEN SQLCODE = ZERO                                      62920000
629300           IF PV-NULL-E-BUS-IND = -1                              62930000
629400              MOVE 'N' TO XLT00010-E-BUS-IND                      62940000
629500           END-IF                                                 62950000
629600                                                                  62960000
629700           IF XLT00010-LOC-TYP-CDE = 'DS' AND                     62970000
629800              XLT00010-E-BUS-IND    = 'Y'                         62980000
629900                SET PS-OPER-IS-ECOMM-DS TO TRUE                   62990000
630000           END-IF                                                 63000000
630100                                                                  63010000
630200           IF XLT00010-LOC-TYP-CDE = 'DC' AND                     63020000
630300              XLT00010-E-BUS-IND    = 'Y'                         63030000
630400                SET PS-OPER-IS-ECOMM-DC TO TRUE                   63040000
630500           END-IF                                                 63050000
630600                                                                  63060000
630700         WHEN SQLCODE = +100                                      63070000
630800              MOVE 'INVALID   ' TO  XLT00010-LOC-10-ABBR-NM       63080000
630900                                                                  63090000
631000         WHEN SQLWARN0 NOT = SPACES                               63100000
631100         WHEN SQLCODE NOT EQUAL ZERO                              63110000
631200             MOVE '7210-GET-STORE-INFO'                           63120000
631300                             TO DP013-PARAGRAPH                   63130000
631400             MOVE 'SUKRF706 - GET STORE INFOMATION'               63140000
631500                             TO DP013-MESSAGE-TEXT(1)             63150000
631600             MOVE  SU001-MANIFEST TO  PV-DISPLAY-MANIFEST         63160000
631700             MOVE  SU001-CARTON   TO  PV-DISPLAY-CARTON           63170000
631800             MOVE  SU001-STORE    TO  PV-DISPLAY-STORE            63180000
631900             STRING ' TRIP - '            DELIMITED BY SIZE       63190000
632000                    PV-DISPLAY-MANIFEST   DELIMITED BY SIZE       63200000
632100                    '  CARTON - '         DELIMITED BY SIZE       63210000
632200                    PV-DISPLAY-CARTON     DELIMITED BY SIZE       63220000
632300                    '  STORE - '          DELIMITED BY SIZE       63230000
632400                    PV-DISPLAY-STORE      DELIMITED BY SIZE       63240000
632500                             INTO DP013-MESSAGE-TEXT (2)          63250000
632600             MOVE SQLCA      TO DP013-SQLCA                       63260000
632700             MOVE 'XLT00010' TO DP013-DB2-TABLE-NAME(1)           63270000
632800             SET DP013-DB2-ABEND                                  63280000
632900                             TO TRUE                              63290000
633000             SET DP013-ROLLBACK                                   63300000
633100                             TO TRUE                              63310000
633200             SET DP013-XCTL-DISPLAY-RESTART                       63320000
633300                             TO TRUE                              63330000
633400             PERFORM DP014-0000-PROCESS-ABEND                     63340000
633500     END-EVALUATE.                                                63350000
633600                                                                  63360000
633700                                                                  63370000
633800*----------------------------------------------------------------*63380000
633900*                                                                *63390000
634000*----------------------------------------------------------------*63400000
634100 7215-GET-ECOMM-DC-INFO.                                          63410000
634200                                                                  63420000
634300     EXEC SQL                                                     63430000
634400          SELECT  LOC_TYP_CDE                                     63440000
634500                , E_BUS_IND                                       63450000
634600          INTO    :XLT00010-LOC-TYP-CDE                           63460000
634700                , :XLT00010-E-BUS-IND :PV-NULL-E-BUS-IND          63470000
634800          FROM   XLT_LOC                                          63480000
634900          WHERE  LOC_NBR   = :DK-OPER-UNT-ID                      63490000
635000     END-EXEC.                                                    63500000
635100                                                                  63510000
635200     EVALUATE TRUE                                                63520000
635300         WHEN SQLCODE = ZERO                                      63530000
635400           IF PV-NULL-E-BUS-IND = -1                              63540000
635500              MOVE 'N' TO XLT00010-E-BUS-IND                      63550000
635600           END-IF                                                 63560000
635700           IF XLT00010-LOC-TYP-CDE = 'DC' AND                     63570000
635800              XLT00010-E-BUS-IND    = 'Y'                         63580000
635900                SET PS-OPER-IS-ECOMM-DC TO TRUE                   63590000
636000           END-IF                                                 63600000
636100                                                                  63610000
636200           IF XLT00010-LOC-TYP-CDE = 'DS' AND                     63620000
636300              XLT00010-E-BUS-IND    = 'Y'                         63630000
636400                SET PS-OPER-IS-ECOMM-DS TO TRUE                   63640000
636500           END-IF                                                 63650000
636600                                                                  63660000
636700         WHEN SQLCODE = +100                                      63670000
636800              MOVE 'INVALID   ' TO  XLT00010-LOC-10-ABBR-NM       63680000
636900                                                                  63690000
637000         WHEN SQLWARN0 NOT = SPACES                               63700000
637100         WHEN SQLCODE NOT EQUAL ZERO                              63710000
637200             MOVE '7215-GET-ECOMM-DC-INFO'                        63720000
637300                             TO DP013-PARAGRAPH                   63730000
637400             MOVE 'SUKRF706 - GET STORE INFOMATION'               63740000
637500                             TO DP013-MESSAGE-TEXT(1)             63750000
637600             MOVE  SU001-MANIFEST TO  PV-DISPLAY-MANIFEST         63760000
637700             MOVE  SU001-CARTON   TO  PV-DISPLAY-CARTON           63770000
637800             MOVE  SU001-OPER-UNT-ID  TO  PV-DISPLAY-STORE        63780000
637900             STRING ' TRIP - '            DELIMITED BY SIZE       63790000
638000                    PV-DISPLAY-MANIFEST   DELIMITED BY SIZE       63800000
638100                    '  CARTON - '         DELIMITED BY SIZE       63810000
638200                    PV-DISPLAY-CARTON     DELIMITED BY SIZE       63820000
638300                    '  STORE - '          DELIMITED BY SIZE       63830000
638400                    PV-DISPLAY-STORE      DELIMITED BY SIZE       63840000
638500                             INTO DP013-MESSAGE-TEXT (2)          63850000
638600             MOVE SQLCA      TO DP013-SQLCA                       63860000
638700             MOVE 'XLT00010' TO DP013-DB2-TABLE-NAME(1)           63870000
638800             SET DP013-DB2-ABEND                                  63880000
638900                             TO TRUE                              63890000
639000             SET DP013-ROLLBACK                                   63900000
639100                             TO TRUE                              63910000
639200             SET DP013-XCTL-DISPLAY-RESTART                       63920000
639300                             TO TRUE                              63930000
639400             PERFORM DP014-0000-PROCESS-ABEND                     63940000
639500     END-EVALUATE.                                                63950000
639600                                                                  63960000
639700                                                                  63970000
639800                                                                  63980000
639900                                                                  63990000
640000 7220-SELECT-TPURCHS.                                             64000000
640100                                                                  64010000
640200     EXEC SQL                                                     64020000
640300         SELECT  PKGNG_CDE                                        64030000
640400               , PO_TYP_CDE                                       64040000
640500               , SEASET_YR                                        64050000
640600               , SEASET_SHRT_NM                                   64060000
640700         INTO    :PURCHS-PKGNG-CDE                                64070000
640800               , :PURCHS-PO-TYP-CDE                               64080000
640900               , :PURCHS-SEASET-YR                                64090000
641000               , :PURCHS-SEASET-SHRT-NM                           64100000
641100         FROM   TPURCHS                                           64110000
641200         WHERE  PO_NBR         = :DK-PO                           64120000
641300           AND  VER_STATUS_CDE = 'A'                              64130000
641400     END-EXEC.                                                    64140000
641500                                                                  64150000
641600     EVALUATE TRUE                                                64160000
641700         WHEN SQLCODE = ZERO                                      64170000
641800             CONTINUE                                             64180000
641900         WHEN SQLWARN0 NOT = SPACES                               64190000
642000         WHEN SQLCODE NOT EQUAL ZERO                              64200000
642100             MOVE '7220-SELECT-TPURCHS'                           64210000
642200                             TO DP013-PARAGRAPH                   64220000
642300             MOVE 'SUKRF706 - CHECK TPURCHS '                     64230000
642400                             TO DP013-MESSAGE-TEXT(1)             64240000
642500             MOVE SHPUNT-SHIPT-UNT-ID                             64250000
642600                             TO DP013-MESSAGE-TEXT(2)             64260000
642700             MOVE SQLCA      TO DP013-SQLCA                       64270000
642800             MOVE 'TPURCHS'  TO DP013-DB2-TABLE-NAME(1)           64280000
642900             SET DP013-DB2-ABEND                                  64290000
643000                             TO TRUE                              64300000
643100             SET DP013-ROLLBACK                                   64310000
643200                             TO TRUE                              64320000
643300             SET DP013-XCTL-DISPLAY-RESTART                       64330000
643400                             TO TRUE                              64340000
643500             PERFORM DP014-0000-PROCESS-ABEND                     64350000
643600     END-EVALUATE.                                                64360000
643700                                                                  64370000
643800                                                                  64380000
643900                                                                  64390000
644000                                                                  64400000
644100 7225-SELECT-TPURITM.                                             64410000
644200                                                                  64420000
644300     EXEC SQL                                                     64430000
644400         SELECT  PO_PREPK_ID                                      64440000
644500               , UNT_RTL_PR_AMT                                   64450000
644600         INTO   :PURITM-PO-PREPK-ID                               64460000
644700              , :PURITM-UNT-RTL-PR-AMT                            64470000
644800         FROM   TPURITM                                           64480000
644900         WHERE  PO_NBR            = :DK-PO                        64490000
645000           AND  APP_PO_LNE_NBR    = :PURITM-PO-LNE-NBR            64500000
645100           AND  VER_STATUS_CDE    = 'A'                           64510000
645200     END-EXEC.                                                    64520000
645300                                                                  64530000
645400     EVALUATE TRUE                                                64540000
645500         WHEN SQLCODE = ZERO                                      64550000
645600         WHEN SQLCODE = +100                                      64560000
645700             CONTINUE                                             64570000
645800         WHEN SQLWARN0 NOT = SPACES                               64580000
645900         WHEN SQLCODE NOT EQUAL ZERO                              64590000
646000             MOVE '7225-SELECT-TPURITM'                           64600000
646100                             TO DP013-PARAGRAPH                   64610000
646200             MOVE 'SUKRF706 - CHECK TPURITM '                     64620000
646300                             TO DP013-MESSAGE-TEXT(1)             64630000
646400             MOVE SHPUNT-SHIPT-UNT-ID                             64640000
646500                             TO DP013-MESSAGE-TEXT(2)             64650000
646600             MOVE SQLCA      TO DP013-SQLCA                       64660000
646700             MOVE 'TPURITM'  TO DP013-DB2-TABLE-NAME(1)           64670000
646800             SET DP013-DB2-ABEND                                  64680000
646900                             TO TRUE                              64690000
647000             SET DP013-ROLLBACK                                   64700000
647100                             TO TRUE                              64710000
647200             SET DP013-XCTL-DISPLAY-RESTART                       64720000
647300                             TO TRUE                              64730000
647400             PERFORM DP014-0000-PROCESS-ABEND                     64740000
647500     END-EVALUATE.                                                64750000
647600                                                                  64760000
647700                                                                  64770000
647800                                                                  64780000
647900                                                                  64790000
648000                                                                  64800000
648100*----------------------------------------------------------------*64810000
648200 7230-GET-DEPT-CL-SKU.                                            64820000
648300                                                                  64830000
648400     INITIALIZE       PV-DEPT-NUMBER-LBL                          64840000
648500                      PV-INNR-PACK-QTY                            64850000
648600                      PV-CL-NBR-LBL                               64860000
648700                      PV-SKU-NBR-LBL.                             64870000
648800*                     PV-VEND-STYL-NAME.                          64880000
648900                                                                  64890000
649000     MOVE  SU001-PO           TO DK-PO.                           64900000
649100     MOVE  SU001-RCVR-SEQ-NBR TO DK-REC-SEQ-NBR.                  64910000
649200     MOVE  SU001-PO-LINE-NBR  TO DK-PO-LNE-NBR.                   64920000
649300                                                                  64930000
649400     EXEC SQL                                                     64940000
649500         SELECT A.DEPT_NBR                                        64950000
649600               ,C.INNR_PACK_QTY                                   64960000
649700               ,C.ITM_NBR                                         64970000
649800               ,D.CL_NBR                                          64980000
649900               ,D.VEND_STYL_NAME                                  64990000
650000               ,D.PO_PREPK_ID                                     65000000
650100           INTO :PV-DEPT-NUMBER,                                  65010000
650200                :PV-INNR-PACK-QTY,                                65020000
650300                :RECITM-ITM-NBR,                                  65030000
650400                :PV-CL-NBR,                                       65040000
650500                :PV-VEND-STYL-NAME ,                              65050000
650600                :PURITM-PO-PREPK-ID                               65060000
650700           FROM TPURCHS A                                         65070000
650800               ,TVNDDPT B                                         65080000
650900               ,TRECITM C                                         65090000
651000               ,TPURITM D                                         65100000
651100          WHERE A.PO_NBR         =  :DK-PO                        65110000
651200            AND A.VER_STATUS_CDE =  'A'                           65120000
651300            AND A.ENT_ID         =  B.ENT_ID                      65130000
651400            AND A.DEPT_NBR       =  B.DEPT_NBR                    65140000
651500            AND C.ORD_NBR        =  A.PO_NBR                      65150000
651600            AND C.REC_SEQ_NBR    =  :DK-REC-SEQ-NBR               65160000
651700            AND C.ORD_NBR        =  D.PO_NBR                      65170000
651800            AND C.ORD_LNE_NBR    =  :DK-PO-LNE-NBR                65180000
651900            AND C.ORD_LNE_NBR    =  D.APP_PO_LNE_NBR              65190000
652000            AND C.VER_STATUS_CDE =  'A'                           65200000
652100            AND C.PO_VER_NBR     =  D.VER_NBR                     65210000
652200     END-EXEC                                                     65220000
652300                                                                  65230000
652400     EVALUATE TRUE                                                65240000
652500         WHEN SQLCODE = ZERO                                      65250000
652600              PERFORM 7240-CALL-XLKUT-DOMAIN                      65260000
652700              MOVE  XL001-DEPT-NBR-3CH   TO PV-DEPT-NUMBER-LBL    65270000
652800              MOVE  XL001-SUB-CL-NBR-2CH TO PV-CL-NBR-LBL         65280000
652900              MOVE  XL001-SKU-NBR        TO PV-SKU-NBR-LBL        65290000
653000                                            PV-SKU-OUT-9          65300000
653100         WHEN SQLCODE = +100                                      65310000
653200              SET  SU001-INVLD-MTCH-PO-LNE TO TRUE                65320000
653300              MOVE  'NO ITM#'       TO  PV-SKU-OUT                65330000
653400                                                                  65340000
653500         WHEN SQLWARN0 NOT = SPACES                               65350000
653600         WHEN SQLCODE NOT EQUAL ZERO                              65360000
653700             MOVE '7230-GET-DEPT-CL-SKU'                          65370000
653800                             TO DP013-PARAGRAPH                   65380000
653900             MOVE 'SUKRF706 - GET DEPT/CL/SKU/INPK INFO'          65390000
654000                             TO DP013-MESSAGE-TEXT(1)             65400000
654100             MOVE  SU001-PO         TO  PV-DISPLAY-PO             65410000
654200             MOVE  SU001-RCVR-SEQ-NBR TO PV-DISPLAY-PO-RCVR       65420000
654300             MOVE  SU001-PO-LINE-NBR TO PV-DISPLAY-PO-LNE-NBR     65430000
654400             STRING ' PO/RCVR/LNE '       DELIMITED BY SIZE       65440000
654500                    PV-DISPLAY-PO         DELIMITED BY SIZE       65450000
654600                    ' - '                 DELIMITED BY SIZE       65460000
654700                    PV-DISPLAY-PO-RCVR    DELIMITED BY SIZE       65470000
654800                    ' - '                 DELIMITED BY SIZE       65480000
654900                    PV-DISPLAY-PO-LNE-NBR DELIMITED BY SIZE       65490000
655000                             INTO DP013-MESSAGE-TEXT (2)          65500000
655100             MOVE SQLCA      TO DP013-SQLCA                       65510000
655200             MOVE 'TPURCHS'  TO DP013-DB2-TABLE-NAME(1)           65520000
655300             MOVE 'TVNDDPT'  TO DP013-DB2-TABLE-NAME(2)           65530000
655400             SET DP013-DB2-ABEND                                  65540000
655500                             TO TRUE                              65550000
655600             SET DP013-ROLLBACK                                   65560000
655700                             TO TRUE                              65570000
655800             SET DP013-XCTL-DISPLAY-RESTART                       65580000
655900                             TO TRUE                              65590000
656000             PERFORM DP014-0000-PROCESS-ABEND                     65600000
656100     END-EVALUATE.                                                65610000
656200                                                                  65620000
656300                                                                  65630000
656400*----------------------------------------------------------------*65640000
656500*                                                                *65650000
656600*----------------------------------------------------------------*65660000
656700 7233-CHECK-EAS-TAG.                                              65670000
656800                                                                  65680000
656900                                                                  65690000
657000     MOVE PURITM-UNT-RTL-PR-AMT TO SFT00000-BEG-PRPT-AMT.         65700000
657100                                                                  65710000
657200     EXEC SQL                                                     65720000
657300          SELECT DEPT_NBR                                         65730000
657400          INTO  :SFT00000-DEPT-NBR                                65740000
657500          FROM   SFT_EAS_TG_MDSE                                  65750000
657600          WHERE ( DEPT_NBR        = :XL001-DEPT-NBR               65760000
657700                AND MAJ_CL_NBR    = :XL001-MAJ-CL-NBR             65770000
657800                AND SUB_CL_NBR    = :XL001-SUB-CL-NBR )           65780000
657900            OR  ( DEPT_NBR        = :XL001-DEPT-NBR               65790000
658000                AND MAJ_CL_NBR    = :XL001-MAJ-CL-NBR             65800000
658100                AND SUB_CL_NBR IS NULL )                          65810000
658200            AND BEG_PRPT_AMT      <= :SFT00000-BEG-PRPT-AMT       65820000
658300     END-EXEC.                                                    65830000
658400                                                                  65840000
658500     EVALUATE TRUE                                                65850000
658600         WHEN SQLCODE = ZERO                                      65860000
658700              SET PS-EAS-TAG-IND-FOUND-YES TO TRUE                65870000
658800         WHEN SQLCODE = +100                                      65880000
658900              SET PS-EAS-TAG-IND-FOUND-NO  TO TRUE                65890000
659000         WHEN SQLWARN0 NOT = SPACES                               65900000
659100         WHEN SQLCODE NOT EQUAL ZERO                              65910000
659200             MOVE XL001-DEPT-NBR  TO PV-DISPLAY-DEPT              65920000
659300             MOVE XL001-MAJ-CL-NBR TO PV-DISPLAY-CLASS            65930000
659400             MOVE '7233-CHECK-EAS-TAG '                           65940000
659500                             TO DP013-PARAGRAPH                   65950000
659600             MOVE 'SUKRF706 - GET EAS TAG IND   '                 65960000
659700                             TO DP013-MESSAGE-TEXT(1)             65970000
659800             MOVE  SU001-PO         TO  PV-DISPLAY-PO             65980000
659900             MOVE  SU001-RCVR-SEQ-NBR TO PV-DISPLAY-PO-RCVR       65990000
660000             MOVE  SU001-PO-LINE-NBR TO PV-DISPLAY-PO-LNE-NBR     66000000
660100             STRING ' PO/RCVR/LNE '       DELIMITED BY SIZE       66010000
660200                    PV-DISPLAY-PO         DELIMITED BY SIZE       66020000
660300                    '-'                   DELIMITED BY SIZE       66030000
660400                    PV-DISPLAY-PO-RCVR    DELIMITED BY SIZE       66040000
660500                    '-'                   DELIMITED BY SIZE       66050000
660600                    PV-DISPLAY-PO-LNE-NBR DELIMITED BY SIZE       66060000
660700                    '  DPT/CL/SKU - '     DELIMITED BY SIZE       66070000
660800                    PV-DISPLAY-DEPT       DELIMITED BY SIZE       66080000
660900                    '-'                   DELIMITED BY SIZE       66090000
661000                    PV-DISPLAY-CLASS      DELIMITED BY SIZE       66100000
661100                             INTO DP013-MESSAGE-TEXT (2)          66110000
661200             MOVE SQLCA      TO DP013-SQLCA                       66120000
661300             MOVE 'SFT_EAS_TG_MDSE'  TO DP013-DB2-TABLE-NAME(1)   66130000
661400             SET DP013-DB2-ABEND                                  66140000
661500                             TO TRUE                              66150000
661600             SET DP013-ROLLBACK                                   66160000
661700                             TO TRUE                              66170000
661800             SET DP013-XCTL-DISPLAY-RESTART                       66180000
661900                             TO TRUE                              66190000
662000             PERFORM DP014-0000-PROCESS-ABEND                     66200000
662100     END-EVALUATE.                                                66210000
662200                                                                  66220000
662300*----------------------------------------------------------------*66230000
662400*                                                                *66240000
662500*----------------------------------------------------------------*66250000
662600 7234-GET-CURRENT-DOOR.                                           66260000
662700                                                                  66270000
662800     MOVE SU001-STORE TO CNDRST-STR-NBR.                          66280000
662900     MOVE SU001-OPER-UNT-ID TO CNDCDR-OPER-UNT-ID.                66290000
663000                                                                  66300000
663100     EXEC SQL                                                     66310000
663200          SELECT A.DOOR_ID                                        66320000
663300          INTO   :CNDCDR-DOOR-ID                                  66330000
663400          FROM   TCNDCDR A                                        66340000
663500               , TCNDRST B                                        66350000
663600          WHERE  A.DOOR_ID         = B.DOOR_ID                    66360000
663700            AND  A.OPER_UNT_ID     = :CNDCDR-OPER-UNT-ID          66370000
663800            AND  A.OPER_UNT_ID     = B.OPER_UNT_ID                66380000
663900            AND  A.DOOR_TYP_CDE    = 'SH'                         66390000
664000            AND  B.STR_NBR         = :CNDRST-STR-NBR              66400000
664100            AND  B.END_TMST        = '9999-09-09-09.09.09.999999' 66410000
664200            AND  NOT   (DOOR_LOC_DESC  LIKE  '%UPS%'     OR       66420000
664300                        DOOR_LOC_DESC  LIKE  '%VIRTUAL%' OR       66430000
664400                        DOOR_LOC_DESC  LIKE  '%RE-OPEN%'          66440000
664500                       )                                          66450000
664600     END-EXEC.                                                    66460000
664700                                                                  66470000
664800     EVALUATE TRUE                                                66480000
664900         WHEN SQLCODE = ZERO                                      66490000
665000              CONTINUE                                            66500000
665100         WHEN SQLCODE = +100                                      66510000
665200         WHEN SQLCODE = -811                                      66520000
665300              MOVE SPACES TO CNDCDR-DOOR-ID                       66530000
665400         WHEN SQLWARN0 NOT = SPACES                               66540000
665500         WHEN SQLCODE NOT EQUAL ZERO                              66550000
665600             MOVE '7234-GET-CURRENT-DOOR '                        66560000
665700                             TO DP013-PARAGRAPH                   66570000
665800             MOVE 'SUKRF706 - SEL CURRENT DOOR ID '               66580000
665900                             TO DP013-MESSAGE-TEXT(1)             66590000
666000             MOVE  SU001-PO         TO  PV-DISPLAY-PO             66600000
666100             MOVE  SU001-RCVR-SEQ-NBR TO PV-DISPLAY-PO-RCVR       66610000
666200             MOVE  SU001-PO-LINE-NBR TO PV-DISPLAY-PO-LNE-NBR     66620000
666300             MOVE  SU001-STORE       TO PV-DISPLAY-STORE          66630000
666400             STRING ' PO/RCVR/STORE'      DELIMITED BY SIZE       66640000
666500                    PV-DISPLAY-PO         DELIMITED BY SIZE       66650000
666600                    '-'                   DELIMITED BY SIZE       66660000
666700                    PV-DISPLAY-PO-RCVR    DELIMITED BY SIZE       66670000
666800                    '-'                   DELIMITED BY SIZE       66680000
666900                    PV-DISPLAY-STORE      DELIMITED BY SIZE       66690000
667000                             INTO DP013-MESSAGE-TEXT (2)          66700000
667100             MOVE SQLCA      TO DP013-SQLCA                       66710000
667200             MOVE 'TCNDCDR'  TO DP013-DB2-TABLE-NAME(1)           66720000
667300             SET DP013-DB2-ABEND                                  66730000
667400                             TO TRUE                              66740000
667500             SET DP013-ROLLBACK                                   66750000
667600                             TO TRUE                              66760000
667700             SET DP013-XCTL-DISPLAY-RESTART                       66770000
667800                             TO TRUE                              66780000
667900             PERFORM DP014-0000-PROCESS-ABEND                     66790000
668000     END-EVALUATE.                                                66800000
668100                                                                  66810000
668200*----------------------------------------------------------------*66820000
668300*                                                                *66830000
668400*----------------------------------------------------------------*66840000
668500 7235-GET-OUTER-PACK.                                             66850000
668600                                                                  66860000
668700     MOVE SU001-CARTON           TO   DK-CTN.                     66870000
668800                                                                  66880000
668900     EXEC SQL                                                     66890000
669000          SELECT  SUM(SHPD_QTY)                                   66900000
669100            INTO :PV-SHIPPED-QTY                                  66910000
669200            FROM  TSHUUPC                                         66920000
669300           WHERE  SHIPT_UNT_ID  = :DK-CTN                         66930000
669400     END-EXEC                                                     66940000
669500                                                                  66950000
669600     EVALUATE TRUE                                                66960000
669700         WHEN SQLCODE = ZERO                                      66970000
669800              MOVE PV-SHIPPED-QTY  TO  PV-OUTR-PACK-QTY           66980000
669900                                                                  66990000
670000         WHEN SQLWARN0 NOT = SPACES                               67000000
670100         WHEN SQLCODE NOT EQUAL ZERO                              67010000
670200             MOVE '7235-GET-OUTER-PACK'                           67020000
670300                             TO DP013-PARAGRAPH                   67030000
670400             MOVE 'SUKRF706 - GET OUTER PACK QTY'                 67040000
670500                             TO DP013-MESSAGE-TEXT(1)             67050000
670600             MOVE  SU001-PO         TO  PV-DISPLAY-PO             67060000
670700             MOVE  SU001-RCVR-SEQ-NBR TO PV-DISPLAY-PO-RCVR       67070000
670800             MOVE  SU001-PO-LINE-NBR TO PV-DISPLAY-PO-LNE-NBR     67080000
670900             STRING ' PO/RCVR/LNE '       DELIMITED BY SIZE       67090000
671000                    PV-DISPLAY-PO         DELIMITED BY SIZE       67100000
671100                    '-'                   DELIMITED BY SIZE       67110000
671200                    PV-DISPLAY-PO-RCVR    DELIMITED BY SIZE       67120000
671300                    '-'                   DELIMITED BY SIZE       67130000
671400                    PV-DISPLAY-PO-LNE-NBR DELIMITED BY SIZE       67140000
671500                    '  DPT/CL/SKU - '     DELIMITED BY SIZE       67150000
671600                    PV-DEPT-NUMBER        DELIMITED BY SIZE       67160000
671700                    '-'                   DELIMITED BY SIZE       67170000
671800                    PV-CL-NBR             DELIMITED BY SIZE       67180000
671900                             INTO DP013-MESSAGE-TEXT (2)          67190000
672000             MOVE SQLCA      TO DP013-SQLCA                       67200000
672100             MOVE 'TSHUUPC'  TO DP013-DB2-TABLE-NAME(1)           67210000
672200             SET DP013-DB2-ABEND                                  67220000
672300                             TO TRUE                              67230000
672400             SET DP013-ROLLBACK                                   67240000
672500                             TO TRUE                              67250000
672600             SET DP013-XCTL-DISPLAY-RESTART                       67260000
672700                             TO TRUE                              67270000
672800             PERFORM DP014-0000-PROCESS-ABEND                     67280000
672900     END-EVALUATE.                                                67290000
673000                                                                  67300000
673100*----------------------------------------------------------------*67310000
673200*                                                                *67320000
673300*----------------------------------------------------------------*67330000
673400 7236-CHECK-BRAND.                                                67340080
673500                                                                  67350000
673600     MOVE XL001-SKU-NBR TO XLT00003-SKU-NBR.                      67360080
673700                                                                  67370000
673720     EXEC SQL                                                     67372080
673730        SELECT  BRND_DESC                                         67373080
673740               ,B.STYL_ID                                         67374080
673750               ,B.BRND_ID                                         67375080
673760         INTO   :XLT00043-BRND-DESC                               67376080
673770               ,:XLT00004-STYL-ID                                 67377080
673780               ,:XLT00004-BRND-ID                                 67378080
673790          FROM  XLT_SKU      A                                    67379080
673791             ,  XLT_VND_STYL B                                    67379180
673792             ,  XLT_BRND     C                                    67379280
673793         WHERE  SKU_NBR           =  :XLT00003-SKU-NBR            67379380
673794           AND  A.STYL_ID         =  B.STYL_ID                    67379480
673795           AND  B.BRND_ID         =  C.BRND_ID                    67379580
673796           AND  C.BRND_ID         >  0                            67379688
673797     END-EXEC.                                                    67379780
673798                                                                  67379880
675000     EVALUATE TRUE                                                67500000
675100         WHEN SQLCODE = ZERO                                      67510000
675200              SET PS-BRAND-FOUND-YES TO TRUE                      67520080
675300         WHEN SQLCODE = +100                                      67530000
675400              SET PS-BRAND-FOUND-NO TO TRUE                       67540080
675500         WHEN SQLWARN0 NOT = SPACES                               67550000
675600         WHEN SQLCODE NOT EQUAL ZERO                              67560000
675700             MOVE '7236-CHECK-BRAND'                              67570080
675800                             TO DP013-PARAGRAPH                   67580000
675900             MOVE 'SUKRF706 - GET OUTER PACK QTY'                 67590000
676000                             TO DP013-MESSAGE-TEXT(1)             67600000
676100             MOVE  SU001-PO         TO  PV-DISPLAY-PO             67610000
676200             MOVE  SU001-RCVR-SEQ-NBR TO PV-DISPLAY-PO-RCVR       67620000
676300             MOVE  SU001-PO-LINE-NBR TO PV-DISPLAY-PO-LNE-NBR     67630000
676400             STRING ' PO/RCVR/LNE '       DELIMITED BY SIZE       67640000
676500                    PV-DISPLAY-PO         DELIMITED BY SIZE       67650000
676600                    '-'                   DELIMITED BY SIZE       67660000
676700                    PV-DISPLAY-PO-RCVR    DELIMITED BY SIZE       67670000
676800                    '-'                   DELIMITED BY SIZE       67680000
676900                    PV-DISPLAY-PO-LNE-NBR DELIMITED BY SIZE       67690000
677000                    '  DPT/CL/SKU - '     DELIMITED BY SIZE       67700000
677100                    PV-DEPT-NUMBER        DELIMITED BY SIZE       67710000
677200                    '-'                   DELIMITED BY SIZE       67720000
677300                    PV-CL-NBR             DELIMITED BY SIZE       67730000
677400                             INTO DP013-MESSAGE-TEXT (2)          67740000
677500             MOVE SQLCA      TO DP013-SQLCA                       67750000
677600             MOVE 'XLT_BRND        '  TO DP013-DB2-TABLE-NAME(1)  67760080
677700             SET DP013-DB2-ABEND                                  67770000
677800                             TO TRUE                              67780000
677900             SET DP013-ROLLBACK                                   67790000
678000                             TO TRUE                              67800000
678100             SET DP013-XCTL-DISPLAY-RESTART                       67810000
678200                             TO TRUE                              67820000
678300             PERFORM DP014-0000-PROCESS-ABEND                     67830000
678400     END-EVALUATE.                                                67840000
678500                                                                  67850000
678600                                                                  67860000
678700 7240-CALL-XLKUT-DOMAIN.                                          67870000
678800     INITIALIZE XL001-ITEM-COMMAREA.                              67880000
678900                                                                  67890000
679000     MOVE RECITM-ITM-NBR        TO XL001-KEY-ITM-NBR.             67900000
679100                                                                  67910000
679200     SET  XL001-BY-ITEM                                           67920000
679300          XL001-SELECT-SKU                                        67930000
679400          XL001-SELECT-VND-STYL TO TRUE.                          67940000
679500                                                                  67950000
679600     CALL XL001-VSM-PGM USING  DFHEIBLK                           67960000
679700                               XL001-COMMAREA                     67970000
679800                               XL001-ITEM-COMMAREA.               67980000
679900     EVALUATE TRUE                                                67990000
680000                                                                  68000000
680100         WHEN XL001-SKU-SQLCODE = +0                              68010000
680200             CONTINUE                                             68020000
680300                                                                  68030000
680400         WHEN XL001-SKU-SQLCODE = +100                            68040000
680500             MOVE SPACES              TO XL001-DEPT-NBR-3CH       68050000
680600                                         XL001-SUB-CL-NBR-2CH     68060000
680700             MOVE ZEROES              TO XL001-SKU-NBR            68070000
680800                                                                  68080000
680900         WHEN XL001-INVALID-ACCESS                                68090000
681000             MOVE '7240-CALL-XLKUT-DOMAIN'                        68100000
681100                             TO DP013-PARAGRAPH                   68110000
681200             MOVE 'ACCESS INFO FOR XLKUT001 INCORRECT'            68120000
681300                             TO DP013-MESSAGE-TEXT (1)            68130000
681400             MOVE RECITM-ITM-NBR                                  68140000
681500                             TO PV-DISPLAY-ITM-NBR                68150000
681600             MOVE PV-DISPLAY-ITM-NBR                              68160000
681700                             TO DP013-MESSAGE-TEXT (2)            68170000
681800             MOVE SQLCA      TO DP013-SQLCA                       68180000
681900             MOVE 'XLV_SKU'  TO DP013-DB2-TABLE-NAME (1)          68190000
682000             SET DP013-DB2-ABEND                                  68200000
682100                 DP013-XCTL-DISPLAY-RESTART                       68210000
682200                             TO TRUE                              68220000
682300             PERFORM DP014-0000-PROCESS-ABEND                     68230000
682400                                                                  68240000
682500         WHEN OTHER                                               68250000
682600             MOVE '7240-CALL-XLKUT-DOMAIN'                        68260000
682700                             TO DP013-PARAGRAPH                   68270000
682800             MOVE 'UNSUCCESSFUL SELECT ON XLV_SKU'                68280000
682900                             TO DP013-MESSAGE-TEXT (1)            68290000
683000             MOVE RECITM-ITM-NBR                                  68300000
683100                             TO PV-DISPLAY-ITM-NBR                68310000
683200             MOVE PV-DISPLAY-ITM-NBR                              68320000
683300                             TO DP013-MESSAGE-TEXT (2)            68330000
683400             MOVE XL001-SKU-SQLCODE                               68340000
683500                             TO SQLCODE                           68350000
683600             MOVE SQLCA      TO DP013-SQLCA                       68360000
683700             MOVE 'XLV_SKU'  TO DP013-DB2-TABLE-NAME (1)          68370000
683800             SET DP013-DB2-ABEND                                  68380000
683900                 DP013-XCTL-DISPLAY-RESTART                       68390000
684000                             TO TRUE                              68400000
684100             PERFORM DP014-0000-PROCESS-ABEND                     68410000
684200     END-EVALUATE.                                                68420000
684300                                                                  68430000
684400*----------------------------------------------------------------*68440000
684500 7245-CALL-XLKUT-DOMAIN-BY-UPC.                                   68450000
684600     INITIALIZE XL001-ITEM-COMMAREA.                              68460000
684700                                                                  68470000
684800     MOVE SHUUPC-UPC-NBR        TO XL001-KEY-UPC-NBR.             68480000
684900                                                                  68490000
685000     SET  XL001-BY-UPC-NBR                                        68500000
685100          XL001-SELECT-SKU                                        68510000
685200          XL001-SELECT-VND-STYL TO TRUE.                          68520000
685300                                                                  68530000
685400     IF SU001-ECOMM-DC-REPURPOSE                                  68540000
685500        SET XL001-SELECT-WEB-SKU TO TRUE                          68550000
685600     END-IF                                                       68560000
685700                                                                  68570000
685800     CALL XL001-VSM-PGM USING  DFHEIBLK                           68580000
685900                               XL001-COMMAREA                     68590000
686000                               XL001-ITEM-COMMAREA.               68600000
686100     EVALUATE TRUE                                                68610000
686200                                                                  68620000
686300         WHEN XL001-SUCCESSFUL                                    68630000
686400             CONTINUE                                             68640000
686500         WHEN XL001-UPC-NOT-FOUND                                 68650000
686600                MOVE 0 TO  PV-HNG-FOLD-SEQ-NBR                    68660000
686700                SET  PS-EO-HANG-FOLD-CSR                          68670000
686800                     PS-WEIGHTS-MEAUSURES-CHECK TO TRUE           68680000
686900         WHEN XL001-WEB-ITEM-NOT-FOUND                            68690000
687000                SET  PS-WEIGHTS-MEAUSURES-CHECK TO TRUE           68700000
687100         WHEN XL001-INVALID-ACCESS                                68710000
687200             MOVE '7245-CALL-XLKUT-DOMAIN-BY-UPC'                 68720000
687300                             TO DP013-PARAGRAPH                   68730000
687400             MOVE 'ACCESS INFO FOR XLKUT001 INCORRECT'            68740000
687500                             TO DP013-MESSAGE-TEXT (1)            68750000
687600             MOVE SHUUPC-UPC-NBR                                  68760000
687700                             TO PV-DISPLAY-ITM-NBR                68770000
687800             MOVE PV-DISPLAY-ITM-NBR                              68780000
687900                             TO DP013-MESSAGE-TEXT (2)            68790000
688000             MOVE SQLCA      TO DP013-SQLCA                       68800000
688100             MOVE 'XLV_UPC'  TO DP013-DB2-TABLE-NAME (1)          68810000
688200             SET DP013-DB2-ABEND                                  68820000
688300                 DP013-XCTL-DISPLAY-RESTART                       68830000
688400                             TO TRUE                              68840000
688500             PERFORM DP014-0000-PROCESS-ABEND                     68850000
688600                                                                  68860000
688700         WHEN OTHER                                               68870000
688800             MOVE '7245-CALL-XLKUT-DOMAIN-BY-UPC'                 68880000
688900                             TO DP013-PARAGRAPH                   68890000
689000             MOVE 'UNSUCCESSFUL SELECT ON XLV_UPC'                68900000
689100                             TO DP013-MESSAGE-TEXT (1)            68910000
689200             MOVE SHUUPC-UPC-NBR                                  68920000
689300                             TO PV-DISPLAY-ITM-NBR                68930000
689400             MOVE PV-DISPLAY-ITM-NBR                              68940000
689500                             TO DP013-MESSAGE-TEXT (2)            68950000
689600             MOVE XL001-SKU-SQLCODE                               68960000
689700                             TO SQLCODE                           68970000
689800             MOVE SQLCA      TO DP013-SQLCA                       68980000
689900             MOVE 'XLV_UPC'  TO DP013-DB2-TABLE-NAME (1)          68990000
690000             SET DP013-DB2-ABEND                                  69000000
690100                 DP013-XCTL-DISPLAY-RESTART                       69010000
690200                             TO TRUE                              69020000
690300             PERFORM DP014-0000-PROCESS-ABEND                     69030000
690400     END-EVALUATE.                                                69040000
690500                                                                  69050000
690600*----------------------------------------------------------------*69060000
690700*  GET MANIFEST FROM PCKCS721.                                   *69070000
690800*----------------------------------------------------------------*69080000
690900 7250-LINK-PCKCS721.                                              69090000
691000                                                                  69100000
691100     MOVE LENGTH OF PC187-COMMAREA-REC  TO  PV-COMMAREA-LENGTH.   69110000
691200                                                                  69120000
691300     EXEC CICS                                                    69130000
691400         LINK PROGRAM  (PV-PCKCS721)                              69140000
691500              COMMAREA (PC187-COMMAREA-REC)                       69150000
691600              LENGTH   (PV-COMMAREA-LENGTH)                       69160000
691700              RESP     (PV-CICS-RESPONSE)                         69170000
691800     END-EXEC.                                                    69180000
691900                                                                  69190000
692000     EVALUATE TRUE                                                69200000
692100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 69210000
692200              IF  PC187-CRA-SUCCESSFUL                            69220000
692300                  CONTINUE                                        69230000
692400              ELSE                                                69240000
692500                  SET PV-DONE-PROCESSING          TO TRUE         69250000
692600                  MOVE SQLCODE              TO PV-SQLCODE         69260000
692700                  STRING ' PCKCS707 - '        DELIMITED BY SIZE  69270000
692800                         '7250-LINK-PCKCS721 ' DELIMITED BY SIZE  69280000
692900                         ' RETURN MESSAGE - '  DELIMITED BY SIZE  69290000
693000                         PC187-CRA-RET-MSG     DELIMITED BY SIZE  69300000
693100                         '  PARA-'             DELIMITED BY SIZE  69310000
693200                         PC187-CRA-REQ-ID      DELIMITED BY SIZE  69320000
693300                                          INTO PV-CICS-MSG-AREA   69330000
693400                  MOVE LENGTH OF PV-CICS-MSG-AREA                 69340000
693500                                            TO PV-COMMAREA-LENGTH 69350000
693600                  PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG          69360000
693700                                                                  69370000
693800                  MOVE '7250-LINK-PCKCS721   '                    69380000
693900                                  TO DP013-PARAGRAPH              69390000
694000                  MOVE 'LINK TO PCKCS721               '          69400000
694100                                  TO DP013-MESSAGE-TEXT(1)        69410000
694200                  STRING 'MSG - '        DELIMITED BY SIZE        69420000
694300                         PC187-CRA-RET-MSG DELIMITED BY SIZE      69430000
694400                                  INTO DP013-MESSAGE-TEXT (2)     69440000
694500                  MOVE 'CHECK CSSL FOR MORE DETAIL     '          69450000
694600                                    TO DP013-MESSAGE-TEXT (3)     69460000
694700                  MOVE SU001-MANIFEST TO PV-DISPLAY-MANIFEST      69470000
694800                  MOVE SU001-CARTON TO PV-DISPLAY-CARTON          69480000
694900                  MOVE SU001-STORE TO PV-DISPLAY-STORE            69490000
695000                  STRING ' TRIP - '       DELIMITED BY SIZE       69500000
695100                         PV-DISPLAY-MANIFEST DELIMITED BY SIZE    69510000
695200                         '  CARTON - '    DELIMITED BY SIZE       69520000
695300                         PV-DISPLAY-CARTON DELIMITED BY SIZE      69530000
695400                         '  STORE - '     DELIMITED BY SIZE       69540000
695500                         PV-DISPLAY-STORE DELIMITED BY SIZE       69550000
695600                                  INTO DP013-MESSAGE-TEXT (4)     69560000
695700                  MOVE SQLCA TO DP013-SQLCA                       69570000
695800                  SET DP013-DB2-ABEND                             69580000
695900                                  TO TRUE                         69590000
696000                  SET DP013-ROLLBACK                              69600000
696100                                  TO TRUE                         69610000
696200                  SET DP013-XCTL-DISPLAY-RESTART                  69620000
696300                                  TO TRUE                         69630000
696400                  PERFORM DP014-0000-PROCESS-ABEND                69640000
696500              END-IF                                              69650000
696600         WHEN OTHER                                               69660000
696700              SET PV-DONE-PROCESSING          TO TRUE             69670000
696800              MOVE SQLCODE              TO PV-SQLCODE             69680000
696900              STRING ' PCKCS707 (OTHER) -' DELIMITED BY SIZE      69690000
697000                     '7250-LINK-PCKCS721 ' DELIMITED BY SIZE      69700000
697100                     ' RETURN MESSAGE - '  DELIMITED BY SIZE      69710000
697200                     PC187-CRA-RET-MSG     DELIMITED BY SIZE      69720000
697300                     '  PARA-'             DELIMITED BY SIZE      69730000
697400                     PC187-CRA-REQ-ID      DELIMITED BY SIZE      69740000
697500                                      INTO PV-CICS-MSG-AREA       69750000
697600              MOVE LENGTH OF PV-CICS-MSG-AREA                     69760000
697700                                        TO PV-COMMAREA-LENGTH     69770000
697800              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              69780000
697900                                                                  69790000
698000              MOVE '7250-LINK-PCKCS721   '                        69800000
698100                              TO DP013-PARAGRAPH                  69810000
698200              MOVE 'LINK TO PCKCS721               '              69820000
698300                              TO DP013-MESSAGE-TEXT(1)            69830000
698400              STRING 'MSG - '            DELIMITED BY SIZE        69840000
698500                     PC187-CRA-RET-MSG   DELIMITED BY SIZE        69850000
698600                              INTO DP013-MESSAGE-TEXT (2)         69860000
698700              MOVE 'CHECK CSSL FOR MORE DETAIL     '              69870000
698800                                TO DP013-MESSAGE-TEXT (3)         69880000
698900              MOVE SU001-MANIFEST TO  PV-DISPLAY-MANIFEST         69890000
699000              MOVE SU001-CARTON   TO  PV-DISPLAY-CARTON           69900000
699100              MOVE SU001-STORE    TO  PV-DISPLAY-STORE            69910000
699200              STRING ' TRIP - '           DELIMITED BY SIZE       69920000
699300                     PV-DISPLAY-MANIFEST  DELIMITED BY SIZE       69930000
699400                     '  CARTON - '        DELIMITED BY SIZE       69940000
699500                     PV-DISPLAY-CARTON    DELIMITED BY SIZE       69950000
699600                     '  STORE - '         DELIMITED BY SIZE       69960000
699700                     PV-DISPLAY-STORE     DELIMITED BY SIZE       69970000
699800                              INTO DP013-MESSAGE-TEXT (4)         69980000
699900              MOVE SQLCA     TO DP013-SQLCA                       69990000
700000              SET DP013-DB2-ABEND                                 70000000
700100                              TO TRUE                             70010000
700200              SET DP013-ROLLBACK                                  70020000
700300                              TO TRUE                             70030000
700400              SET DP013-XCTL-DISPLAY-RESTART                      70040000
700500                              TO TRUE                             70050000
700600              PERFORM DP014-0000-PROCESS-ABEND                    70060000
700700     END-EVALUATE.                                                70070000
700800                                                                  70080000
700900                                                                  70090000
701000*----------------------------------------------------------------*70100000
701100*  LINK TO SUKCS583 TO DETERMINE IF THE CARTON NEEDS TO BE AUDITED70110000
701200*----------------------------------------------------------------*70120000
701300 7260-LINK-SUKCS583.                                              70130000
701400                                                                  70140000
701500     MOVE LENGTH OF SU021-CARTON-AUDIT-RECORD                     70150000
701600                                   TO PV-COMMAREA-LENGTH.         70160000
701700                                                                  70170000
701800     EXEC CICS                                                    70180000
701900         LINK PROGRAM  (PV-SUKCS583)                              70190000
702000              COMMAREA (SU021-CARTON-AUDIT-RECORD)                70200000
702100              LENGTH   (PV-COMMAREA-LENGTH)                       70210000
702200              RESP     (PV-CICS-RESPONSE)                         70220000
702300     END-EXEC.                                                    70230000
702400                                                                  70240000
702500     EVALUATE TRUE                                                70250000
702600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 70260000
702700              IF  SU021-INVALID-REQUEST OR                        70270000
702800                  SU021-DB2-ERROR                                 70280000
702900                  SET PV-DONE-PROCESSING          TO TRUE         70290000
703000                  MOVE SQLCODE              TO PV-SQLCODE         70300000
703100                  STRING ' SUKRF706 - '        DELIMITED BY SIZE  70310000
703200                         '7260-LINK-SUKCS583 ' DELIMITED BY SIZE  70320000
703300                         ' RETURN MESSAGE - '  DELIMITED BY SIZE  70330000
703400                         SU021-AUDIT-VALIDATION-SW                70340000
703500                                               DELIMITED BY SIZE  70350000
703600                                          INTO PV-CICS-MSG-AREA   70360000
703700                  MOVE LENGTH OF PV-CICS-MSG-AREA                 70370000
703800                                            TO PV-COMMAREA-LENGTH 70380000
703900                  PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG          70390000
704000                                                                  70400000
704100                                                                  70410000
704200                  MOVE '7260-LINK-SUKCS583'                       70420000
704300                                  TO DP013-PARAGRAPH              70430000
704400                  MOVE 'LINK TO SUKCS583               '          70440000
704500                                  TO DP013-MESSAGE-TEXT(1)        70450000
704600                  STRING 'MSG - '            DELIMITED BY SIZE    70460000
704700                         SU021-AUDIT-VALIDATION-SW                70470000
704800                                             DELIMITED BY SIZE    70480000
704900                                  INTO DP013-MESSAGE-TEXT (2)     70490000
705000                  MOVE 'CHECK CSSL FOR MORE DETAIL     '          70500000
705100                                    TO DP013-MESSAGE-TEXT (3)     70510000
705200                  MOVE  SU001-CARTON  TO PV-DISPLAY-CARTON        70520000
705300                  MOVE  SU001-PO      TO PV-DISPLAY-PO            70530000
705400                  MOVE  SU001-RCVR-SEQ-NBR TO PV-DISPLAY-PO-RCVR  70540000
705500                  MOVE  SU001-PO-LINE-NBR TO PV-DISPLAY-PO-LNE-NBR70550000
705600                  STRING '  CARTON - '        DELIMITED BY SIZE   70560000
705700                         PV-DISPLAY-CARTON    DELIMITED BY SIZE   70570000
705800                         ' PO, RCVR, LINE '   DELIMITED BY SIZE   70580000
705900                         PV-DISPLAY-PO        DELIMITED BY SIZE   70590000
706000                         ' '                  DELIMITED BY SIZE   70600000
706100                         PV-DISPLAY-PO-RCVR   DELIMITED BY SIZE   70610000
706200                         ' '                  DELIMITED BY SIZE   70620000
706300                         PV-DISPLAY-PO-LNE-NBR                    70630000
706400                                              DELIMITED BY SIZE   70640000
706500                                  INTO DP013-MESSAGE-TEXT (4)     70650000
706600                  MOVE SQLCA     TO DP013-SQLCA                   70660000
706700                  SET DP013-DB2-ABEND                             70670000
706800                                  TO TRUE                         70680000
706900                  SET DP013-ROLLBACK                              70690000
707000                                  TO TRUE                         70700000
707100                  SET DP013-XCTL-DISPLAY-RESTART                  70710000
707200                                  TO TRUE                         70720000
707300                  PERFORM DP014-0000-PROCESS-ABEND                70730000
707400              END-IF                                              70740000
707500         WHEN OTHER                                               70750000
707600              SET PV-DONE-PROCESSING          TO TRUE             70760000
707700              MOVE SQLCODE              TO PV-SQLCODE             70770000
707800              STRING ' PCKCS707 (OTHER) -' DELIMITED BY SIZE      70780000
707900                     '7260-LINK-SUKCS583 ' DELIMITED BY SIZE      70790000
708000                     ' RETURN MESSAGE - '  DELIMITED BY SIZE      70800000
708100                     SU021-AUDIT-VALIDATION-SW                    70810000
708200                                           DELIMITED BY SIZE      70820000
708300                                      INTO PV-CICS-MSG-AREA       70830000
708400              MOVE LENGTH OF PV-CICS-MSG-AREA                     70840000
708500                                        TO PV-COMMAREA-LENGTH     70850000
708600              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              70860000
708700                                                                  70870000
708800              MOVE '7260-LINK-SUKCS583'                           70880000
708900                              TO DP013-PARAGRAPH                  70890000
709000              MOVE 'LINK TO SUKCS583               '              70900000
709100                              TO DP013-MESSAGE-TEXT(1)            70910000
709200              STRING 'MSG - '            DELIMITED BY SIZE        70920000
709300                     SU021-AUDIT-VALIDATION-SW                    70930000
709400                                         DELIMITED BY SIZE        70940000
709500                              INTO DP013-MESSAGE-TEXT (2)         70950000
709600              MOVE 'CHECK CSSL FOR MORE DETAIL     '              70960000
709700                                TO DP013-MESSAGE-TEXT (3)         70970000
709800              MOVE  SU001-CARTON  TO PV-DISPLAY-CARTON            70980000
709900              MOVE  SU001-PO      TO PV-DISPLAY-PO                70990000
710000              MOVE  SU001-RCVR-SEQ-NBR TO PV-DISPLAY-PO-RCVR      71000000
710100              MOVE  SU001-PO-LINE-NBR TO PV-DISPLAY-PO-LNE-NBR    71010000
710200              STRING '  CARTON - '        DELIMITED BY SIZE       71020000
710300                     PV-DISPLAY-CARTON    DELIMITED BY SIZE       71030000
710400                     ' PO, RCVR, LINE '   DELIMITED BY SIZE       71040000
710500                     PV-DISPLAY-PO        DELIMITED BY SIZE       71050000
710600                     ' '                  DELIMITED BY SIZE       71060000
710700                     PV-DISPLAY-PO-RCVR   DELIMITED BY SIZE       71070000
710800                     ' '                  DELIMITED BY SIZE       71080000
710900                     PV-DISPLAY-PO-LNE-NBR                        71090000
711000                                          DELIMITED BY SIZE       71100000
711100                              INTO DP013-MESSAGE-TEXT (4)         71110000
711200              MOVE SQLCA     TO DP013-SQLCA                       71120000
711300              SET DP013-DB2-ABEND                                 71130000
711400                              TO TRUE                             71140000
711500              SET DP013-ROLLBACK                                  71150000
711600                              TO TRUE                             71160000
711700              SET DP013-XCTL-DISPLAY-RESTART                      71170000
711800                              TO TRUE                             71180000
711900              PERFORM DP014-0000-PROCESS-ABEND                    71190000
712000     END-EVALUATE.                                                71200000
712100                                                                  71210000
712200                                                                  71220000
712210*CLP 06/24/2015 START                                             71221080
712220***************************************************************** 71222080
712230* ONLY BRING BACK AS MANY CHARACTERS UP TO 9 FOR THE BUSINESS     71223080
712240* AREA DESCRIPTION                                                71224080
712250***************************************************************** 71225080
712260 7270-INSPECT-BUS-AREA.                                           71226080
712270                                                                  71227080
712271     MOVE XL073-BUS-AREA-DESC(1:9) TO PV-BUS-AREA-DESC-9.         71227187
712272                                                                  71227287
712273     MOVE +0                               TO PV-DESC-LEN.        71227387
712274     MOVE LENGTH OF PV-BUS-AREA-DESC-9     TO PV-DESC-LEN.        71227487
712275                                                                  71227587
712276     PERFORM                                                      71227687
712277       UNTIL PV-BUS-AREA-DESC-9(PV-DESC-LEN:1) > SPACES OR        71227787
712278         PV-DESC-LEN = +0                                         71227887
712279       COMPUTE PV-DESC-LEN   = PV-DESC-LEN - 1                    71227987
712280     END-PERFORM.                                                 71228087
712282                                                                  71228283
712293     MOVE SPACES  TO  PV-BUS-AREA-BRAND.                          71229380
712294                                                                  71229480
712295     EVALUATE TRUE                                                71229587
712296        WHEN  PV-DESC-LEN   =  9                                  71229687
712297            STRING   PV-BUS-AREA-DESC-9(1:9)                      71229787
712298                                 '-'                              71229887
712299                     XLT00043-BRND-DESC DELIMITED BY SIZE         71229987
712300            INTO  PV-BUS-AREA-BRAND                               71230087
712301        WHEN  PV-DESC-LEN   =  8                                  71230187
712302            STRING   PV-BUS-AREA-DESC-9(1:8)                      71230287
712303                                 '-'                              71230387
712304                     XLT00043-BRND-DESC DELIMITED BY SIZE         71230487
712305            INTO  PV-BUS-AREA-BRAND                               71230587
712306        WHEN  PV-DESC-LEN   =  7                                  71230687
712307            STRING   PV-BUS-AREA-DESC-9(1:7)                      71230787
712308                                 '-'                              71230887
712309                     XLT00043-BRND-DESC DELIMITED BY SIZE         71230987
712310            INTO  PV-BUS-AREA-BRAND                               71231087
712311        WHEN  PV-DESC-LEN   =  6                                  71231187
712312            STRING   PV-BUS-AREA-DESC-9(1:6)                      71231287
712313                                 '-'                              71231387
712314                     XLT00043-BRND-DESC DELIMITED BY SIZE         71231487
712315            INTO  PV-BUS-AREA-BRAND                               71231587
712316        WHEN  PV-DESC-LEN   =  5                                  71231687
712317            STRING   PV-BUS-AREA-DESC-9(1:5)                      71231787
712318                                 '-'                              71231887
712319                     XLT00043-BRND-DESC DELIMITED BY SIZE         71231987
712320            INTO  PV-BUS-AREA-BRAND                               71232087
712321        WHEN  PV-DESC-LEN   =  4                                  71232187
712322            STRING   PV-BUS-AREA-DESC-9(1:4)                      71232287
712323                                 '-'                              71232387
712324                     XLT00043-BRND-DESC DELIMITED BY SIZE         71232487
712325            INTO  PV-BUS-AREA-BRAND                               71232587
712326        WHEN  PV-DESC-LEN   =  3                                  71232687
712327            STRING   PV-BUS-AREA-DESC-9(1:3)                      71232787
712328                                 '-'                              71232887
712329                     XLT00043-BRND-DESC DELIMITED BY SIZE         71232987
712330            INTO  PV-BUS-AREA-BRAND                               71233087
712331        WHEN  PV-DESC-LEN   =  2                                  71233187
712332            STRING   PV-BUS-AREA-DESC-9(1:2)                      71233287
712333                                 '-'                              71233387
712334                     XLT00043-BRND-DESC DELIMITED BY SIZE         71233487
712335            INTO  PV-BUS-AREA-BRAND                               71233587
712336        WHEN  PV-DESC-LEN   =  1                                  71233687
712337            STRING   PV-BUS-AREA-DESC-9(1:1)                      71233787
712338                                 '-'                              71233887
712339                     XLT00043-BRND-DESC DELIMITED BY SIZE         71233987
712340            INTO  PV-BUS-AREA-BRAND                               71234087
712341        WHEN  OTHER                                               71234187
712342*           NO BUSINESS AREA AVAILABLE                            71234287
712343            STRING   PV-BUS-AREA-DESC-9(1:9)                      71234387
712344                                 '-'                              71234487
712345                     XLT00043-BRND-DESC DELIMITED BY SIZE         71234587
712346            INTO  PV-BUS-AREA-BRAND                               71234687
712347     END-EVALUATE.                                                71234787
712391*CLP 06/24/2015 END                                               71239180
712392                                                                  71239280
712393*----------------------------------------------------------------*71239300
712400* AUTOMATIC START OF LABEL PRINT TRANSACTION - S707              *71240006
712500*----------------------------------------------------------------*71250000
712600 7300-START-LABEL-PRINT.                                          71260000
712700                                                                  71270000
712800     SET  SU001-LBL-PRT-AT-SCAN TO TRUE.                          71280000
712900                                                                  71290000
713000     EXEC CICS                                                    71300000
713100          START TRANSID (PC-SU-LBL-PRT-TRANS)                     71310000
713200               FROM (SU001-COMMON-DATA)                           71320000
713300     END-EXEC.                                                    71330000
713400                                                                  71340000
713500     SET  SU001-PROCESS-SCREEN TO TRUE.                           71350000
713600                                                                  71360000
713700*----------------------------------------------------------------*71370000
713800* AUTOMATIC START OF CHECK FOR TRIGGER OF                        *71380000
713900* CONFIRMATION/VERIFICATION  (SUKUT707)                          *71390000
714000*----------------------------------------------------------------*71400000
714100 7350-START-VERIF-TRIGGER.                                        71410000
714200      INITIALIZE RC041-FIELDS.                                    71420000
714300      MOVE SU001-PO           TO RC041-PO-NBR                     71430000
714400      MOVE SU001-RCVR-SEQ-NBR TO RC041-REC-SEQ-NBR                71440000
714500      MOVE SU001-CURR-OPER-UNT-ID TO RC041-OPER-UNT-ID            71450000
714600      MOVE SU001-USER-ID      TO RC041-USER-ID                    71460000
714700      MOVE PC-CURRENT-PROGRAM-NAME TO RC041-PROGRAM-NAME          71470000
714800                                                                  71480000
714900      MOVE SU001-PO-LINE-NBR  TO RC041-PO-LNE-NBR                 71490000
715000      MOVE SU001-PREPK-ID     TO RC041-PREPACK-ID                 71500000
715100                                                                  71510000
715200      IF SU001-PACK-BY-STORE                                      71520000
715300         SET RC041-PBS TO TRUE                                    71530000
715400      ELSE                                                        71540000
715500         MOVE SU001-PKGNG-CDE TO RC041-PKGNG-CDE                  71550000
715600      END-IF                                                      71560000
715700                                                                  71570000
715800     EXEC CICS                                                    71580000
715900          START TRANSID (PC-SU-CRTN-VERIF-TRIGGER)                71590000
716000               FROM (RC041-FIELDS)                                71600000
716100     END-EXEC.                                                    71610000
716200                                                                  71620000
716300                                                                  71630000
716400*----------------------------------------------------------------*71640000
716500* GET DEPT NAME & MAJOR CLASS DESCRIPTION                         71650000
716600*----------------------------------------------------------------*71660000
716700 7400-GET-DEPT-NAME.                                              71670000
716800     PERFORM 7405-GET-CURRENT-DATE.                               71680000
716900                                                                  71690000
717000     SET DP003-MCL-LOOKUP              TO TRUE.                   71700000
717100     SET DP003-DPT-LOOKUP              TO TRUE.                   71710000
717200     MOVE 'MP'                         TO DP003-SYSTEM-CODE.      71720000
717300     MOVE '03'                         TO DP003-OP-CO-NMBR.       71730000
717400     MOVE PV-CURRENT-YY                TO PV-DPKUT038-YY.         71740000
717500     MOVE PV-CURRENT-MM                TO PV-DPKUT038-MM.         71750000
717600     MOVE PV-CURRENT-DD                TO PV-DPKUT038-DD          71760000
717700     MOVE PV-DPKUT038-DATE             TO DP003-CURRENT-DATE      71770000
717800                                          DP003-EFF-DATE.         71780000
717900                                                                  71790000
718000     MOVE PV-DEPT-NUMBER               TO DP003-DPT-INPUT.        71800000
718100     MOVE PV-CL-NBR                    TO PV-DPKUT038-MJR-CL.     71810000
718200     MOVE ZERO                         TO PV-DPKUT038-MJR-CL-2.   71820000
718300     MOVE PV-DPKUT038-MJR-CL           TO DP003-MCL-INPUT.        71830000
718400                                                                  71840000
718500     EXEC CICS                                                    71850000
718600         LINK PROGRAM  (PV-DPKUT038)                              71860000
718700              COMMAREA (DP003-MBS-SUBROUTINE-FIELDS)              71870000
718800              LENGTH   (PV-DPKUT038-CA-LENGTH)                    71880000
718900              RESP     (PV-DPKUT038-CICS-RESP)                    71890000
719000     END-EXEC.                                                    71900000
719100                                                                  71910000
719200     EVALUATE TRUE                                                71920000
719300         WHEN PV-DPKUT038-CICS-RESP = DFHRESP (NORMAL)            71930000
719400              MOVE DP003-DPT-DESCRIPTION TO PV-DEPT-DESC          71940000
719500              MOVE DP003-MCL-DESCRIPTION TO PV-MAJ-CL-DESC        71950000
719600*             MOVE PV-MAJ-CL-DESC  TO                             71960000
719700*                                       PC172-COMTEC-128-SUBCLASS 71970000
719800*                                       PC176-RASCAL-128-SUBCLASS 71980000
719900         WHEN OTHER                                               71990000
720000              MOVE SPACES          TO   PV-DEPT-DESC              72000000
720100                                        PV-MAJ-CL-DESC            72010000
720200*                                       PC172-COMTEC-128-SUBCLASS 72020000
720300*                                       PC176-RASCAL-128-SUBCLASS 72030000
720400     END-EVALUATE.                                                72040000
720500*-----------------------------------------------------------------72050000
720600*  GET CURRENT DATE                                               72060000
720700*-----------------------------------------------------------------72070000
720800 7405-GET-CURRENT-DATE.                                           72080000
720900                                                                  72090000
721000     EXEC SQL                                                     72100000
721100         SELECT  CURRENT DATE                                     72110000
721200                ,CURRENT TIME                                     72120000
721300           INTO  :PV-CURRENT-DATE                                 72130000
721400                ,:PV-CURRENT-TIME                                 72140000
721500           FROM  TCOCNTL                                          72150000
721600          WHERE  OPER_UNT_ID = 90                                 72160000
721700     END-EXEC.                                                    72170000
721800                                                                  72180000
721900 7410-CREATE-NEW-TSHUNLO.                                         72190057
722000**********************************************************        72200024
722100**AFTER YOU PRINT THE FINAL LABEL INACTIVATE THE         *        72210057
722110**'RFDC' ROW BY CREATING A NEW ROW 'RFDF' ON THE TSHUNLO *        72211057
722120**TABLE.                                                 *        72212057
722200**********************************************************        72220032
722300     MOVE  SU001-USER-ID          TO SHUNLO-CRE-USR-ID.           72230036
722400     MOVE  SU001-CURR-OPER-UNT-ID TO SHUNLO-OPER-UNT-ID.          72240039
722500                                                                  72250032
722600     EXEC SQL                                                     72260032
722700         INSERT INTO TSHUNLO                                      72270032
722800               ( SHIPT_UNT_ID                                     72280032
722900                ,OPER_UNT_ID                                      72290032
723000                ,FCLTY_ID                                         72300032
723100                ,SCN_LOC_ID                                       72310032
723200                ,CRE_USR_ID                                       72320032
723300                ,CRE_TMST                                         72330032
723400                ,TRIP_ID                                          72340032
723500                ,PRTR_TYP_CDE                                     72350032
723600                ,LBL_PRT_BTCH_ID                                  72360032
723700                ,ACTV_CDE)                                        72370032
723800         VALUES (:DK-CTN                                          72380032
723900               , :SHUNLO-OPER-UNT-ID                              72390039
724000               , 1                                                72400039
724100               , :PC-RFDF                                         72410032
724200               , :SHUNLO-CRE-USR-ID                               72420033
724300               ,  CURRENT TIMESTAMP                               72430032
724400               ,  999999999                                       72440059
724500               , :PC-N                                            72450032
724600               , 0                                                72460035
724700               , :PC-I)                                           72470032
724800     END-EXEC.                                                    72480032
724900                                                                  72490032
725000     EVALUATE TRUE                                                72500032
725100        WHEN SQLCODE = ZERO                                       72510032
725200             CONTINUE                                             72520032
725300        WHEN SQLWARN0 NOT = SPACES                                72530032
725400        WHEN SQLCODE < ZERO                                       72540032
725500        WHEN SQLCODE > ZERO                                       72550032
725600             MOVE '7410-CREATE-NEW-TSHUNLO'                       72560057
725700                               TO DP013-PARAGRAPH                 72570032
725800             MOVE 'INSERT INTO TABLE  - '                         72580032
725900                               TO DP013-MESSAGE-TEXT (1)          72590032
726000             MOVE SQLCA        TO DP013-SQLCA                     72600032
726100             MOVE 'TSHUNLO '   TO DP013-DB2-TABLE-NAME (1)        72610032
726200             SET DP013-DB2-ABEND                                  72620032
726300                 DP013-XCTL-DISPLAY-RESTART TO TRUE               72630032
726400             SET DP013-ROLLBACK                                   72640032
726500                               TO TRUE                            72650032
726600             PERFORM DP014-0000-PROCESS-ABEND                     72660032
726700     END-EVALUATE.                                                72670032
726800                                                                  72680025
726900*----------------------------------------------------------------*72690025
727000* POPULATE TLBPTDA PRIOR TO INSERT TO TABLE                       72700025
727100*----------------------------------------------------------------*72710025
727200 7500-POPULATE-TLBPTDA-BULK.                                      72720000
727300                                                                  72730000
727400     INITIALIZE  DCLTLBPTDA.                                      72740000
727500                                                                  72750000
727600     IF PS-PRINT-AUDIT-LABEL                                      72760000
727700        MOVE 'Q'                    TO LBPTDA-CART-LBL-TYP-CDE    72770000
727800     ELSE                                                         72780000
727900        MOVE LBVRDA-CART-LBL-TYP-CDE TO LBPTDA-CART-LBL-TYP-CDE   72790000
728000     END-IF                                                       72800000
728100                                                                  72810000
728200     IF LBVRDA-CART-LBL-TYP-CDE = 'P'                             72820000
728300        SET SU001-P2L-LBL-CREATED   TO TRUE                       72830000
728400     END-IF.                                                      72840000
728500     MOVE LBVRDA-DEST-OPER-UNT-ID   TO PV-STORE.                  72850000
728600     MOVE LBVRDA-PREPK-ID           TO LBPTDA-PREPK-ID            72860000
728700     MOVE LBVRDA-PREPK-RATO-QTY     TO LBPTDA-PREPK-RATO-QTY.     72870000
728800     MOVE LBVRDA-PREPK-UNT-QTY      TO LBPTDA-PREPK-UNT-QTY.      72880000
728900     MOVE LBVRDA-INPK-UNT-QTY       TO LBPTDA-INPK-UNT-QTY.       72890000
729000     MOVE LBVRDA-CSE-PK-QTY         TO LBPTDA-CSE-PK-QTY.         72900000
729100     MOVE LBVRDA-ODD-CART-IND       TO LBPTDA-ODD-CART-IND.       72910000
729200     MOVE LBVRDA-INPK-CNVYB-IND     TO LBPTDA-INPK-CNVYB-IND.     72920000
729300     MOVE LBVRDA-LBL-TYP-LBL-SEQ-ID TO LBPTDA-LBL-TYP-LBL-SEQ-ID. 72930000
729400     MOVE LBVRDA-LBL-TYP-TOT-QTY    TO LBPTDA-LBL-TYP-TOT-QTY.    72940000
729500     MOVE LBVRDA-MODU-DESC          TO LBPTDA-MODU-DESC.          72950000
729600     MOVE LBVRDA-ITM-NBR            TO LBPTDA-ITM-NBR.            72960000
729700     MOVE LBVRDA-DEPT-DESC          TO LBPTDA-DEPT-DESC.          72970000
729800     MOVE LBVRDA-MAJ-CL-DESC        TO LBPTDA-MAJ-CL-DESC.        72980000
729900     MOVE LBVRDA-SEASET-NM          TO LBPTDA-SEASET-NM.          72990000
730000     MOVE LBVRDA-FIXT-ID            TO LBPTDA-FIXT-ID.            73000000
730100     MOVE LBVRDA-BRCDE-NBR          TO LBPTDA-BRCDE-NBR.          73010000
730200     MOVE LBVRDA-STR-ZN-ID          TO LBPTDA-STR-ZN-ID.          73020000
730300     MOVE LBVRDA-STRG-AREA-CDE      TO LBPTDA-STRG-AREA-CDE.      73030000
730400                                                                  73040000
730500     MOVE LBVRDA-HNG-FOLD-SEQ-NBR   TO PV-HNG-FOLD-SEQ-NBR.       73050000
730600     MOVE LBVRDA-EAS-TAG-IND        TO LBPTDA-EAS-TAG-IND.        73060000
730700     MOVE LBVRDA-DOOR-ID            TO LBPTDA-DOOR-ID.            73070000
730800     MOVE 35                        TO LBPTDA-LBL-MSG-TXT-LEN.    73080081
730900     MOVE LBVRDA-LBL-MSG-TXT-TEXT   TO LBPTDA-LBL-MSG-TXT-TEXT.   73090082
731000*----------------------------------------------------------------*73100000
731100 7590-CREATE-RTV-OTBND.                                           73110000
731200      MOVE SU001-CURR-OPER-UNT-ID TO PC187-STR-NBR                73120000
731300      MOVE  +1                    TO PC187-NO-OF-LBLS             73130000
731400      PERFORM 7250-LINK-PCKCS721                                  73140000
731500      MOVE PC187-START-MFST-NBR TO PV-LBL-MANIFEST-NBR            73150000
731600      MOVE PV-LBL-MANIFEST-NBR  TO SU001-LBL-MANIFEST-NBR         73160000
731700      MOVE 'K'                  TO DK-CART-LBL-TYP-CDE            73170000
731800      MOVE ZEROES               TO PC160-BTCH-SML-CONTAINER-CDE   73180000
731900      SET  PC160-BTCH-SML-INTERNAL-LBL                            73190000
732000           PC160-BTCH-SML-FROM-KOHLS                              73200000
732100           PC160-PORT-SML-TXT-INTERNL-LBL                         73210000
732200           PC160-PORT-SML-TXT-FROM-KOHLS   TO TRUE                73220000
732300      MOVE SU001-CURR-OPER-UNT-ID TO PV-STORE-9-4                 73230000
732400      MOVE PV-STORE-X-4           TO PV-STORE-NBR-4               73240000
732500      MOVE PV-STORE-NBR           TO PC160-BTCH-SML-BC-DIVERT     73250000
732600      MOVE SU001-CURR-OPER-UNT-ID                                 73260000
732700                                 TO PC160-BTCH-SML-BC-DC-ORIGIN   73270000
732800                                    DK-DEST-OPER-UNT-ID           73280000
732900      MOVE SU001-LBL-MANIFEST-NBR TO                              73290000
733000                                    PC160-BTCH-SML-BC-MNFST-NBR   73300000
733100      MOVE PC160-BTCH-BARCODE    TO DK-BARCODE-NBR.               73310000
733200      SET PS-EAS-TAG-IND-FOUND-NO  TO TRUE.                       73320000
733300      PERFORM 7350-START-VERIF-TRIGGER.                           73330000
733400                                                                  73340000
733500*----------------------------------------------------------------*73350000
733600 7600-PROCESS-INSERTS-TO-OTBND.                                   73360000
733700      PERFORM 7610-INSERT-OTBND-CART.                             73370000
733800      PERFORM 7620-SELECT-CRTN-UPC.                               73380000
733900      PERFORM 7645-INSERT-OTBND-LOC.                              73390000
734000      IF SU001-AUTO-VE-NO                                         73400000
734100         PERFORM 7650-INSERT-OTBND-VND                            73410000
734200      ELSE                                                        73420000
734300          IF SU001-PKGNG-CDE  = PC-M OR PC-I                      73430000
734400             PERFORM 7680-SELECT-PK-SKU-NBR                       73440000
734500             PERFORM 7685-INSERT-OTBND-PACK                       73450000
734600          END-IF                                                  73460000
734700      END-IF.                                                     73470000
734800*----------------------------------------------------------------*73480000
734900****-------------------------------------------------------------*73490056
735000 7610-INSERT-OTBND-CART.                                          73500000
735100*----------------------------------------------------------------*73510000
735200                                                                  73520000
735300      MOVE DK-BARCODE-NBR          TO PV-BAR-CODE.                73530000
735400      MOVE PV-BAR-CODE-OTBND       TO SUT00024-SHIPT-UNT-ID       73540000
735500                                      SUT00024-PRNT-CART-ID.      73550000
735600      MOVE SU001-CURR-OPER-UNT-ID  TO SUT00024-ORGN-LOC-NBR.      73560000
735700      MOVE DK-DEST-OPER-UNT-ID     TO SUT00024-DEST-LOC-NBR.      73570000
735800      MOVE 'ASN'                   TO SUT00024-CART-SRC-CDE.      73580000
735900      MOVE  SU001-USER-ID          TO SUT00024-CRE-USR-ID.        73590000
736000      MOVE PC-CURRENT-PROGRAM-NAME TO SUT00024-CRE-PGM-NM.        73600000
736100      MOVE 'N'                     TO SUT00024-MSTR-CART-IND.     73610000
736200      MOVE SU001-CARTON            TO SUT00024-ORIG-CART-ID.      73620000
736300      MOVE 'Y'                     TO SUT00024-ACTV-IND.          73630000
736400      IF LBVRDA-INPK-CNVYB-IND  = 'Y'                             73640000
736500         MOVE PC-I                 TO SUT00024-CART-TYP-CDE       73650000
736600      ELSE                                                        73660000
736700         MOVE DK-CART-LBL-TYP-CDE  TO SUT00024-CART-TYP-CDE       73670000
736800      END-IF                                                      73680000
736900                                                                  73690000
737000      MOVE PS-EAS-TAG-IND-FOUND-SW TO SUT00024-EAS-TAG-IND.       73700000
737100                                                                  73710000
737200     EXEC SQL                                                     73720000
737300         INSERT INTO SUT_OTBND_CART                               73730000
737400             ( SHIPT_UNT_ID                                       73740000
737500              ,ORGN_LOC_NBR                                       73750000
737600              ,DEST_LOC_NBR                                       73760000
737700              ,CART_SRC_CDE                                       73770000
737800              ,CRE_DTE                                            73780000
737900              ,CRE_TM                                             73790000
738000              ,CRE_USR_ID                                         73800000
738100              ,CRE_PGM_NM                                         73810000
738200              ,MSTR_CART_IND                                      73820000
738300              ,PRNT_CART_ID                                       73830000
738400              ,ORIG_CART_ID                                       73840000
738500              ,CART_TYP_CDE                                       73850000
738600              ,LBL_PRT_SEQ_NBR                                    73860000
738700              ,CART_RVSN_NBR                                      73870000
738800              ,OTBND_TRIP_ID                                      73880000
738900              ,ACTV_IND                                           73890000
739000              ,EAS_TAG_IND)                                       73900000
739100         VALUES (:SUT00024-SHIPT-UNT-ID                           73910000
739200                ,:SUT00024-ORGN-LOC-NBR                           73920000
739300                ,:SUT00024-DEST-LOC-NBR                           73930000
739400                ,:SUT00024-CART-SRC-CDE                           73940000
739500                , CURRENT DATE                                    73950000
739600                , CURRENT TIME                                    73960000
739700                ,:SUT00024-CRE-USR-ID                             73970000
739800                ,:SUT00024-CRE-PGM-NM                             73980000
739900                ,:SUT00024-MSTR-CART-IND                          73990000
740000                ,:SUT00024-PRNT-CART-ID                           74000000
740100                ,:SUT00024-ORIG-CART-ID                           74010000
740200                ,:SUT00024-CART-TYP-CDE                           74020000
740300                , 0                                               74030000
740400                , 0                                               74040000
740500                , NULL                                            74050000
740600                ,:SUT00024-ACTV-IND                               74060000
740700                ,:SUT00024-EAS-TAG-IND)                           74070000
740800     END-EXEC                                                     74080000
740900                                                                  74090000
741000         EVALUATE TRUE                                            74100000
741100             WHEN SQLCODE = ZERO                                  74110000
741200                SET PS-DONE                                       74120000
741300                    PS-CARTON-SML-CREATED TO TRUE                 74130000
741400                                                                  74140000
741500* DMH 11/29/02 - BEGIN - TEMPORARY FIX UNTIL RECLAIM REDONE       74150000
741600             WHEN SQLCODE = -803                                  74160000
741700                  PERFORM 7660-DELETE-OTBD-UPC                    74170000
741800                  PERFORM 7665-DELETE-OTBD-VND                    74180000
741900                  PERFORM 7670-UPDATE-OTBD-CART                   74190000
742000                  SET PS-CARTON-SML-CREATED TO TRUE               74200000
742100* DMH 11/29/02 - END                                              74210000
742200                                                                  74220000
742300             WHEN SQLWARN0 NOT = SPACES                           74230000
742400             WHEN SQLCODE < ZERO                                  74240000
742500             WHEN SQLCODE > ZERO                                  74250000
742600                 MOVE '7610-INSERT-OTBND-CART'                    74260000
742700                                   TO DP013-PARAGRAPH             74270000
742800                 MOVE 'INSERT INTO TABLE  - '                     74280000
742900                                   TO DP013-MESSAGE-TEXT (1)      74290000
743000                 MOVE SQLCA        TO DP013-SQLCA                 74300000
743100                 MOVE 'SUT_OTBND_CART '                           74310000
743200                                   TO DP013-DB2-TABLE-NAME (1)    74320000
743300                 SET DP013-DB2-ABEND                              74330000
743400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           74340000
743500                 SET DP013-ROLLBACK                               74350000
743600                                   TO TRUE                        74360000
743700                 PERFORM DP014-0000-PROCESS-ABEND                 74370000
743800         END-EVALUATE.                                            74380000
743900                                                                  74390000
744000 EJECT                                                            74400000
744100*----------------------------------------------------------------*74410000
744200 7620-SELECT-CRTN-UPC.                                            74420000
744300      SET PS-NOT-END-OF-UPC-UNLOAD-CSR TO TRUE.                   74430000
744400      PERFORM 7625-OPEN-UPC-UNLOAD-CSR.                           74440000
744500      PERFORM 7630-FETCH-UPC-UNLOAD-CSR                           74450000
744600            UNTIL PS-END-OF-UPC-UNLOAD-CSR.                       74460000
744700      PERFORM 7640-CLOSE-UPC-UNLOAD-CSR.                          74470000
744800*----------------------------------------------------------------*74480000
744900 7625-OPEN-UPC-UNLOAD-CSR.                                        74490000
745000******************************************************************74500000
745100                                                                  74510000
745200         EXEC SQL                                                 74520000
745300              OPEN UPC_UNLOAD_CSR                                 74530000
745400         END-EXEC                                                 74540000
745500                                                                  74550000
745600                                                                  74560000
745700         EVALUATE TRUE                                            74570000
745800             WHEN SQLCODE = ZERO                                  74580000
745900                 CONTINUE                                         74590000
746000             WHEN SQLWARN0 NOT = SPACES                           74600000
746100             WHEN SQLCODE < ZERO                                  74610000
746200             WHEN SQLCODE > ZERO                                  74620000
746300                 MOVE '7625-OPEN-UPC-UNLOAD-CSR'                  74630000
746400                                   TO DP013-PARAGRAPH             74640000
746500                 MOVE 'OPEN UPC UNLOAD CSR- '                     74650000
746600                                   TO DP013-MESSAGE-TEXT (1)      74660000
746700                 MOVE SQLCA        TO DP013-SQLCA                 74670000
746800                 MOVE 'SUT_OTBND_UPC ' TO DP013-DB2-TABLE-NAME (1)74680000
746900                 SET DP013-DB2-ABEND                              74690000
747000                     DP013-XCTL-DISPLAY-RESTART TO TRUE           74700000
747100                 SET DP013-ROLLBACK                               74710000
747200                                   TO TRUE                        74720000
747300                 PERFORM DP014-0000-PROCESS-ABEND                 74730000
747400         END-EVALUATE.                                            74740000
747500                                                                  74750000
747600 EJECT                                                            74760000
747700*----------------------------------------------------------------*74770000
747800 7630-FETCH-UPC-UNLOAD-CSR.                                       74780000
747900*----------------------------------------------------------------*74790000
748000                                                                  74800000
748100     EXEC SQL                                                     74810000
748200        FETCH UPC_UNLOAD_CSR                                      74820000
748300        INTO   :SUT00028-UPC-NBR                                  74830000
748400              ,:SUT00028-TRN-NBR                                  74840000
748500              ,:SUT00028-TRN-LNE-NBR                              74850000
748600              ,:SUT00028-TRN-TYP-CDE                              74860000
748700              ,:SUT00028-SHPD-UNT-QTY                             74870000
748800     END-EXEC.                                                    74880000
748900                                                                  74890000
749000     EVALUATE TRUE                                                74900000
749100       WHEN SQLCODE = ZEROS                                       74910000
749200            PERFORM 7635-INSERT-OTBND-UPC                         74920000
749300       WHEN SQLCODE = +100                                        74930000
749400                SET  PS-END-OF-UPC-UNLOAD-CSR TO TRUE             74940000
749500       WHEN OTHER                                                 74950000
749600             MOVE '7630-FETCH-UPC-UNLOAD-CSR'                     74960000
749700                             TO DP013-PARAGRAPH                   74970000
749800             MOVE 'INSERT TO OTBND UPC TABLE      '               74980000
749900                             TO DP013-MESSAGE-TEXT(1)             74990000
750000             MOVE SU001-PO                                        75000000
750100                             TO DP013-MESSAGE-TEXT(2)             75010000
750200             MOVE SU001-CARTON                                    75020000
750300                             TO DP013-MESSAGE-TEXT(3)             75030000
750400             MOVE SQLCA      TO DP013-SQLCA                       75040000
750500             MOVE 'SUT_OTBND_UPC' TO DP013-DB2-TABLE-NAME(1)      75050000
750600             SET DP013-DB2-ABEND                                  75060000
750700                             TO TRUE                              75070000
750800             SET DP013-ROLLBACK                                   75080000
750900                             TO TRUE                              75090000
751000             SET DP013-XCTL-DISPLAY-RESTART                       75100000
751100                             TO TRUE                              75110000
751200             PERFORM DP014-0000-PROCESS-ABEND                     75120000
751300     END-EVALUATE.                                                75130000
751400                                                                  75140000
751500*-OUT------------------------------------------------------------*75150006
751600 7635-INSERT-OTBND-UPC.                                           75160000
751700*----------------------------------------------------------------*75170000
751800                                                                  75180000
751900     MOVE SUT00024-SHIPT-UNT-ID    TO SUT00028-SHIPT-UNT-ID.      75190000
752000                                                                  75200000
752100     IF SU001-AUTO-VE-YES                                         75210000
752200        MOVE SU001-RCVR-SEQ-NBR       TO SUT00028-RCVR-SEQ-NBR    75220000
752300     ELSE                                                         75230000
752400        MOVE ZEROES                   TO SUT00028-RCVR-SEQ-NBR    75240000
752500     END-IF                                                       75250000
752600                                                                  75260000
752700     IF LBVRDA-INPK-CNVYB-IND = 'Y'                               75270000
752800        IF SU001-PKGNG-CDE  = PC-M OR PC-I                        75280000
752900           PERFORM 7695-SELECT-PREPK-RATIO                        75290000
753000           MOVE RECITM-PREPK-RATO-QTY TO SUT00028-SHPD-UNT-QTY    75300000
753100        ELSE                                                      75310000
753200           MOVE LBVRDA-INPK-UNT-QTY  TO SUT00028-SHPD-UNT-QTY     75320000
753300        END-IF                                                    75330000
753400     END-IF                                                       75340000
753500                                                                  75350000
753600     EXEC SQL                                                     75360000
753700         INSERT INTO SUT_OTBND_UPC                                75370000
753800             ( SHIPT_UNT_ID                                       75380000
753900              ,TRN_NBR                                            75390000
754000              ,RCVR_SEQ_NBR                                       75400000
754100              ,TRN_LNE_NBR                                        75410000
754200              ,TRN_TYP_CDE                                        75420000
754300              ,UPC_NBR                                            75430000
754400              ,SHPD_UNT_QTY)                                      75440000
754500         VALUES (:SUT00028-SHIPT-UNT-ID                           75450000
754600                ,:SUT00028-TRN-NBR                                75460000
754700                ,:SUT00028-RCVR-SEQ-NBR                           75470000
754800                ,:SUT00028-TRN-LNE-NBR                            75480000
754900                ,:SUT00028-TRN-TYP-CDE                            75490000
755000                ,:SUT00028-UPC-NBR                                75500000
755100                ,:SUT00028-SHPD-UNT-QTY)                          75510000
755200     END-EXEC                                                     75520000
755300                                                                  75530000
755400         EVALUATE TRUE                                            75540000
755500             WHEN SQLCODE = ZERO                                  75550000
755600             WHEN SQLCODE = +100                                  75560000
755700                CONTINUE                                          75570000
755800             WHEN SQLWARN0 NOT = SPACES                           75580000
755900             WHEN SQLCODE < ZERO                                  75590000
756000             WHEN SQLCODE > ZERO                                  75600000
756100                 MOVE '7635-INSERT-OTBND-UPC '                    75610000
756200                                   TO DP013-PARAGRAPH             75620000
756300                 MOVE 'INSERT INTO TABLE  - '                     75630000
756400                                   TO DP013-MESSAGE-TEXT (1)      75640000
756500                 MOVE SQLCA        TO DP013-SQLCA                 75650000
756600                 MOVE 'SUT_OTBND_UPC  '                           75660000
756700                                   TO DP013-DB2-TABLE-NAME (1)    75670000
756800                 SET DP013-DB2-ABEND                              75680000
756900                     DP013-XCTL-DISPLAY-RESTART TO TRUE           75690000
757000                 SET DP013-ROLLBACK                               75700000
757100                                   TO TRUE                        75710000
757200                 PERFORM DP014-0000-PROCESS-ABEND                 75720000
757300         END-EVALUATE.                                            75730000
757400                                                                  75740000
757500 EJECT                                                            75750000
757600*----------------------------------------------------------------*75760000
757700 7640-CLOSE-UPC-UNLOAD-CSR.                                       75770000
757800*----------------------------------------------------------------*75780000
757900                                                                  75790000
758000         EXEC SQL                                                 75800000
758100             CLOSE UPC_UNLOAD_CSR                                 75810000
758200         END-EXEC                                                 75820000
758300                                                                  75830000
758400                                                                  75840000
758500         EVALUATE TRUE                                            75850000
758600             WHEN SQLCODE = ZERO                                  75860000
758700                 CONTINUE                                         75870000
758800             WHEN SQLWARN0 NOT = SPACES                           75880000
758900             WHEN SQLCODE < ZERO                                  75890000
759000             WHEN SQLCODE > ZERO                                  75900000
759100                 MOVE '7640-CLOSE-UPC-UNLOAD-CSR'                 75910000
759200                                   TO DP013-PARAGRAPH             75920000
759300                 MOVE 'CLOSE UPC UNLOAD CSR- '                    75930000
759400                                   TO DP013-MESSAGE-TEXT (1)      75940000
759500                 MOVE SQLCA        TO DP013-SQLCA                 75950000
759600                 MOVE 'SUT_OTBND_UPC ' TO DP013-DB2-TABLE-NAME (1)75960000
759700                 SET DP013-DB2-ABEND                              75970000
759800                     DP013-XCTL-DISPLAY-RESTART TO TRUE           75980000
759900                 SET DP013-ROLLBACK                               75990000
760000                                   TO TRUE                        76000000
760100                 PERFORM DP014-0000-PROCESS-ABEND                 76010000
760200         END-EVALUATE.                                            76020000
760300                                                                  76030000
760400*----------------------------------------------------------------*76040000
760500 7645-INSERT-OTBND-LOC.                                           76050000
760600*----------------------------------------------------------------*76060000
760700     MOVE SUT00024-SHIPT-UNT-ID  TO SUT00027-SHIPT-UNT-ID.        76070000
760800     MOVE SU001-CURR-OPER-UNT-ID TO SUT00027-LOC-NBR.             76080000
760900     MOVE SU001-STORE            TO SUT00024-DEST-LOC-NBR.        76090000
761000     MOVE 'RECV'                 TO SUT00027-SCN-CDE.             76100000
761100     MOVE  SU001-USER-ID         TO SUT00027-CRE-USR-ID.          76110000
761200     MOVE  'A'                   TO SUT00027-ACTV-CDE.            76120000
761300     MOVE SU001-MANIFEST         TO SUT00027-INBD-TRIP-ID.        76130000
761400                                                                  76140000
761500                                                                  76150000
761600     EXEC SQL                                                     76160000
761700         INSERT INTO SUT_OTBND_LOC                                76170000
761800             ( SHIPT_UNT_ID                                       76180000
761900              ,CRE_TMST                                           76190000
762000              ,OTBND_TRIP_ID                                      76200000
762100              ,LOC_NBR                                            76210000
762200              ,SCN_CDE                                            76220000
762300              ,CRE_USR_ID                                         76230000
762400              ,ACTV_CDE                                           76240000
762500              ,INBD_TRIP_ID)                                      76250000
762600        VALUES (:SUT00027-SHIPT-UNT-ID                            76260000
762700               , CURRENT TIMESTAMP                                76270000
762800               , NULL                                             76280000
762900               ,:SUT00027-LOC-NBR                                 76290000
763000               ,:SUT00027-SCN-CDE                                 76300000
763100               ,:SUT00027-CRE-USR-ID                              76310000
763200               ,:SUT00027-ACTV-CDE                                76320000
763300               ,:SUT00027-INBD-TRIP-ID)                           76330000
763400     END-EXEC                                                     76340000
763500                                                                  76350000
763600         EVALUATE TRUE                                            76360000
763700             WHEN SQLCODE = ZERO                                  76370000
763800             WHEN SQLCODE = +100                                  76380000
763900                CONTINUE                                          76390000
764000             WHEN SQLWARN0 NOT = SPACES                           76400000
764100             WHEN SQLCODE < ZERO                                  76410000
764200             WHEN SQLCODE > ZERO                                  76420000
764300                 MOVE '7645-INSERT-OTBND-LOC '                    76430000
764400                                   TO DP013-PARAGRAPH             76440000
764500                 MOVE 'INSERT INTO TABLE  - '                     76450000
764600                                   TO DP013-MESSAGE-TEXT (1)      76460000
764700                 MOVE SQLCA        TO DP013-SQLCA                 76470000
764800                 MOVE 'SUT_OTBND_LOC  '                           76480000
764900                                   TO DP013-DB2-TABLE-NAME (1)    76490000
765000                 SET DP013-DB2-ABEND                              76500000
765100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           76510000
765200                 SET DP013-ROLLBACK                               76520000
765300                                   TO TRUE                        76530000
765400                 PERFORM DP014-0000-PROCESS-ABEND                 76540000
765500         END-EVALUATE.                                            76550000
765600                                                                  76560000
765700                                                                  76570000
765800 EJECT                                                            76580000
765900*----------------------------------------------------------------*76590000
766000 7650-INSERT-OTBND-VND.                                           76600000
766100*----------------------------------------------------------------*76610000
766200     MOVE SU001-CARTON TO INPKSU-SHIPT-UNT-ID.                    76620000
766300                                                                  76630000
766400     EXEC SQL                                                     76640000
766500         SELECT PO_NBR                                            76650000
766600               ,SEQ_NBR                                           76660000
766700          INTO :INPKSU-PO-NBR                                     76670000
766800              ,:INPKSU-SEQ-NBR                                    76680000
766900          FROM  TINPKSU                                           76690000
767000         WHERE  SHIPT_UNT_ID = :INPKSU-SHIPT-UNT-ID               76700000
767100     END-EXEC                                                     76710000
767200                                                                  76720000
767300         EVALUATE TRUE                                            76730000
767400             WHEN SQLCODE = ZERO                                  76740000
767500                CONTINUE                                          76750000
767600             WHEN SQLCODE = +100                                  76760000
767700                MOVE '7650-INSERT-OTBND-VND' TO DP013-PARAGRAPH   76770000
767800                MOVE 'SUKRF706 - CARTON NOT FOUND INPKSU '        76780000
767900                                   TO DP013-MESSAGE-TEXT (1)      76790000
768000                MOVE SUT00024-SHIPT-UNT-ID                        76800000
768100                                   TO DP013-MESSAGE-TEXT (2)      76810000
768200                MOVE INPKSU-SHIPT-UNT-ID                          76820000
768300                                   TO DP013-MESSAGE-TEXT (3)      76830000
768400                SET DP013-LOGIC-ABEND        TO TRUE              76840000
768500                SET DP013-ROLLBACK           TO TRUE              76850000
768600                PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG            76860000
768700             WHEN SQLWARN0 NOT = SPACES                           76870000
768800             WHEN SQLCODE < ZERO                                  76880000
768900             WHEN SQLCODE > ZERO                                  76890000
769000                 MOVE '7650-INSERT-OTBND-VND '                    76900000
769100                                   TO DP013-PARAGRAPH             76910000
769200                 MOVE 'SELECT TINPKSU     - '                     76920000
769300                                   TO DP013-MESSAGE-TEXT (1)      76930000
769400                 MOVE SQLCA        TO DP013-SQLCA                 76940000
769500                 MOVE 'TINPKSU  '                                 76950000
769600                                   TO DP013-DB2-TABLE-NAME (1)    76960000
769700                 SET DP013-DB2-ABEND                              76970000
769800                     DP013-XCTL-DISPLAY-RESTART TO TRUE           76980000
769900                 SET DP013-ROLLBACK                               76990000
770000                                   TO TRUE                        77000000
770100                 PERFORM DP014-0000-PROCESS-ABEND                 77010000
770200         END-EVALUATE.                                            77020000
770300                                                                  77030000
770400     MOVE SUT00024-SHIPT-UNT-ID  TO SUT00026-SHIPT-UNT-ID.        77040000
770500     MOVE INPKSU-PO-NBR          TO SUT00026-PO-NBR.              77050000
770600     MOVE INPKSU-SEQ-NBR         TO SUT00026-PKSL-SEQ-NBR.        77060000
770700                                                                  77070000
770800     EXEC SQL                                                     77080000
770900         INSERT INTO SUT_OTBND_VND                                77090000
771000             ( SHIPT_UNT_ID                                       77100000
771100              ,PO_NBR                                             77110000
771200              ,PKSL_SEQ_NBR)                                      77120000
771300         VALUES (:SUT00026-SHIPT-UNT-ID                           77130000
771400                ,:SUT00026-PO-NBR                                 77140000
771500                ,:SUT00026-PKSL-SEQ-NBR)                          77150000
771600     END-EXEC                                                     77160000
771700                                                                  77170000
771800                                                                  77180000
771900         EVALUATE TRUE                                            77190000
772000             WHEN SQLCODE = ZERO                                  77200000
772100             WHEN SQLCODE = +100                                  77210000
772200                CONTINUE                                          77220000
772300             WHEN SQLWARN0 NOT = SPACES                           77230000
772400             WHEN SQLCODE < ZERO                                  77240000
772500             WHEN SQLCODE > ZERO                                  77250000
772600                 MOVE '7650-INSERT-OTBND-VND '                    77260000
772700                                   TO DP013-PARAGRAPH             77270000
772800                 MOVE 'INSERT INTO TABLE  - '                     77280000
772900                                   TO DP013-MESSAGE-TEXT (1)      77290000
773000                 MOVE SQLCA        TO DP013-SQLCA                 77300000
773100                 MOVE 'SUT_OTBND_VND  '                           77310000
773200                                   TO DP013-DB2-TABLE-NAME (1)    77320000
773300                 SET DP013-DB2-ABEND                              77330000
773400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           77340000
773500                 SET DP013-ROLLBACK                               77350000
773600                                   TO TRUE                        77360000
773700                 PERFORM DP014-0000-PROCESS-ABEND                 77370000
773800         END-EVALUATE.                                            77380000
773900                                                                  77390000
774000                                                                  77400000
774100 7660-DELETE-OTBD-UPC.                                            77410000
774200                                                                  77420000
774300     EXEC SQL                                                     77430000
774400          DELETE FROM SUT_OTBND_UPC                               77440000
774500           WHERE SHIPT_UNT_ID    = :SUT00024-SHIPT-UNT-ID         77450000
774600     END-EXEC.                                                    77460000
774700                                                                  77470000
774800     EVALUATE TRUE                                                77480000
774900       WHEN SQLCODE = ZEROS                                       77490000
775000       WHEN SQLCODE = +100                                        77500000
775100            CONTINUE                                              77510000
775200       WHEN OTHER                                                 77520000
775300             MOVE '7660-DELETE-OTBD-UPC     '                     77530000
775400                             TO DP013-PARAGRAPH                   77540000
775500             MOVE 'DELETE OUTOUND UPC TABLE       '               77550000
775600                             TO DP013-MESSAGE-TEXT(1)             77560000
775700             MOVE SUT00024-SHIPT-UNT-ID                           77570000
775800                             TO DP013-MESSAGE-TEXT(2)             77580000
775900             MOVE SQLCA      TO DP013-SQLCA                       77590000
776000             MOVE 'SUT_OTBND_UPC' TO DP013-DB2-TABLE-NAME(1)      77600000
776100             SET DP013-DB2-ABEND                                  77610000
776200                             TO TRUE                              77620000
776300             SET DP013-ROLLBACK                                   77630000
776400                             TO TRUE                              77640000
776500             SET DP013-XCTL-DISPLAY-RESTART                       77650000
776600                             TO TRUE                              77660000
776700             PERFORM DP014-0000-PROCESS-ABEND                     77670000
776800     END-EVALUATE.                                                77680000
776900                                                                  77690000
777000                                                                  77700000
777100 7665-DELETE-OTBD-VND.                                            77710000
777200                                                                  77720000
777300     EXEC SQL                                                     77730000
777400          DELETE FROM SUT_OTBND_VND                               77740000
777500           WHERE SHIPT_UNT_ID    = :SUT00024-SHIPT-UNT-ID         77750000
777600     END-EXEC.                                                    77760000
777700                                                                  77770000
777800     EVALUATE TRUE                                                77780000
777900       WHEN SQLCODE = ZEROS                                       77790000
778000       WHEN SQLCODE = +100                                        77800000
778100            CONTINUE                                              77810000
778200       WHEN OTHER                                                 77820000
778300             MOVE '7665-DELETE-OTBD-VND     '                     77830000
778400                             TO DP013-PARAGRAPH                   77840000
778500             MOVE 'DELETE OUTOUND VND TABLE       '               77850000
778600                             TO DP013-MESSAGE-TEXT(1)             77860000
778700             MOVE SUT00024-SHIPT-UNT-ID                           77870000
778800                             TO DP013-MESSAGE-TEXT(2)             77880000
778900             MOVE SQLCA      TO DP013-SQLCA                       77890000
779000             MOVE 'SUT_OTBND_VND' TO DP013-DB2-TABLE-NAME(1)      77900000
779100             SET DP013-DB2-ABEND                                  77910000
779200                             TO TRUE                              77920000
779300             SET DP013-ROLLBACK                                   77930000
779400                             TO TRUE                              77940000
779500             SET DP013-XCTL-DISPLAY-RESTART                       77950000
779600                             TO TRUE                              77960000
779700             PERFORM DP014-0000-PROCESS-ABEND                     77970000
779800     END-EVALUATE.                                                77980000
779900                                                                  77990000
780000                                                                  78000000
780100 7670-UPDATE-OTBD-CART.                                           78010000
780200                                                                  78020000
780300     EXEC SQL                                                     78030000
780400         UPDATE SUT_OTBND_CART                                    78040000
780500            SET                                                   78050000
780600               ORGN_LOC_NBR     =  :SUT00024-ORGN-LOC-NBR         78060000
780700              ,DEST_LOC_NBR     =  :SUT00024-DEST-LOC-NBR         78070000
780800              ,CART_SRC_CDE     =  :SUT00024-CART-SRC-CDE         78080000
780900              ,CRE_DTE          =   CURRENT DATE                  78090000
781000              ,CRE_TM           =   CURRENT TIME                  78100000
781100              ,CRE_USR_ID       =  :SUT00024-CRE-USR-ID           78110000
781200              ,CRE_PGM_NM       =  :SUT00024-CRE-PGM-NM           78120000
781300              ,MSTR_CART_IND    =  :SUT00024-MSTR-CART-IND        78130000
781400              ,PRNT_CART_ID     =  :SUT00024-PRNT-CART-ID         78140000
781500              ,ORIG_CART_ID     =  :SUT00024-ORIG-CART-ID         78150000
781600              ,CART_TYP_CDE     =  :SUT00024-CART-TYP-CDE         78160000
781700              ,LBL_PRT_SEQ_NBR  =   0                             78170000
781800              ,CART_RVSN_NBR    =   0                             78180000
781900              ,OTBND_TRIP_ID    =   NULL                          78190000
782000              ,ACTV_IND         =  :SUT00024-ACTV-IND             78200000
782100          WHERE                                                   78210000
782200               SHIPT_UNT_ID     =  :SUT00024-SHIPT-UNT-ID         78220000
782300     END-EXEC.                                                    78230000
782400                                                                  78240000
782500         EVALUATE TRUE                                            78250000
782600             WHEN SQLCODE = ZERO                                  78260000
782700                SET PS-DONE TO TRUE                               78270000
782800                                                                  78280000
782900             WHEN SQLWARN0 NOT = SPACES                           78290000
783000             WHEN SQLCODE < ZERO                                  78300000
783100             WHEN SQLCODE > ZERO                                  78310000
783200                 MOVE '7670-UPDATE-OTBD-CART '                    78320000
783300                                   TO DP013-PARAGRAPH             78330000
783400                 MOVE 'UPDATE INTO TABLE  - '                     78340000
783500                                   TO DP013-MESSAGE-TEXT (1)      78350000
783600                 MOVE SQLCA        TO DP013-SQLCA                 78360000
783700                 MOVE 'SUT_OTBND_CART '                           78370000
783800                                   TO DP013-DB2-TABLE-NAME (1)    78380000
783900                 SET DP013-DB2-ABEND                              78390000
784000                     DP013-XCTL-DISPLAY-RESTART TO TRUE           78400000
784100                 SET DP013-ROLLBACK                               78410000
784200                                   TO TRUE                        78420000
784300                 PERFORM DP014-0000-PROCESS-ABEND                 78430000
784400         END-EVALUATE.                                            78440000
784500                                                                  78450000
784600                                                                  78460000
784700 7680-SELECT-PK-SKU-NBR.                                          78470000
784800                                                                  78480000
784900     EXEC SQL                                                     78490000
785000          SELECT PK_SKU_NBR                                       78500000
785100          INTO  :POPRPK-PK-SKU-NBR                                78510000
785200          FROM   TPOPRPK                                          78520000
785300          WHERE  PO_NBR         = :SUT00028-TRN-NBR               78530000
785400          AND    PO_PREPK_ID    = :LBVRDA-PREPK-ID                78540000
785500          AND    PREPK_STAT_CDE =  'A'                            78550000
785600     END-EXEC.                                                    78560000
785700                                                                  78570000
785800     EVALUATE TRUE                                                78580000
785900         WHEN SQLCODE = ZERO                                      78590000
786000              CONTINUE                                            78600000
786100         WHEN SQLCODE = +100                                      78610000
786200             CONTINUE                                             78620000
786300         WHEN SQLWARN0 NOT = SPACES                               78630000
786400         WHEN SQLCODE NOT EQUAL ZERO                              78640000
786500             MOVE '7680-SELECT-PK-SKU-NBR'                        78650000
786600                             TO DP013-PARAGRAPH                   78660000
786700             MOVE 'SUKRF706 - SELECT PK SKU NUMBER'               78670000
786800                             TO DP013-MESSAGE-TEXT(1)             78680000
786900             MOVE SUT00024-SHIPT-UNT-ID                           78690000
787000                             TO DP013-MESSAGE-TEXT(2)             78700000
787100             MOVE SQLCA      TO DP013-SQLCA                       78710000
787200             MOVE 'TPOPRPK ' TO DP013-DB2-TABLE-NAME(1)           78720000
787300             SET DP013-DB2-ABEND                                  78730000
787400                             TO TRUE                              78740000
787500             SET DP013-ROLLBACK                                   78750000
787600                             TO TRUE                              78760000
787700             SET DP013-XCTL-DISPLAY-RESTART                       78770000
787800                             TO TRUE                              78780000
787900             PERFORM DP014-0000-PROCESS-ABEND                     78790000
788000     END-EVALUATE.                                                78800000
788100                                                                  78810000
788200*----------------------------------------------------------------*78820000
788300 7685-INSERT-OTBND-PACK.                                          78830000
788400*----------------------------------------------------------------*78840000
788500     MOVE ZEROES                 TO PV-SHPD-PK-QTY.               78850000
788600     MOVE SU001-RCVR-SEQ-NBR     TO SUT00041-RCVR-SEQ-NBR.        78860000
788700     COMPUTE PV-SHPD-PK-QTY =                                     78870000
788800                 (LBVRDA-OTPK-UNT-QTY / LBVRDA-PREPK-RATO-QTY )   78880000
788900     MOVE PV-SHPD-PK-QTY TO SUT00041-SHPD-PK-QTY.                 78890000
789000                                                                  78900000
789100     EXEC SQL                                                     78910000
789200         INSERT INTO SUT_OTBND_PK                                 78920000
789300             ( SHIPT_UNT_ID                                       78930000
789400              ,TRN_NBR                                            78940000
789500              ,RCVR_SEQ_NBR                                       78950000
789600              ,TRN_TYP_CDE                                        78960000
789700              ,PK_SKU_NBR                                         78970000
789800              ,SHPD_PK_QTY )                                      78980000
789900        VALUES (:SUT00024-SHIPT-UNT-ID                            78990000
790000               ,:SUT00028-TRN-NBR                                 79000000
790100               ,:SUT00041-RCVR-SEQ-NBR                            79010000
790200               ,'PO'                                              79020000
790300               ,:POPRPK-PK-SKU-NBR                                79030000
790400               ,:SUT00041-SHPD-PK-QTY)                            79040000
790500     END-EXEC                                                     79050000
790600                                                                  79060000
790700     EVALUATE TRUE                                                79070000
790800         WHEN SQLCODE = ZERO                                      79080000
790900         WHEN SQLCODE = +100                                      79090000
791000             CONTINUE                                             79100000
791100         WHEN SQLCODE = -803                                      79110000
791200             PERFORM 7690-DELETE-OTBND-PACK                       79120000
791300         WHEN SQLWARN0 NOT = SPACES                               79130000
791400         WHEN SQLCODE < ZERO                                      79140000
791500         WHEN SQLCODE > ZERO                                      79150000
791600              MOVE SQLCODE               TO PV-DISPLAY-SQLCODE    79160000
791700              MOVE SUT00024-SHIPT-UNT-ID TO PV-DISPLAY-CARTON     79170000
791800              MOVE SUT00028-TRN-NBR      TO PV-DISPLAY-PO         79180000
791900              MOVE SUT00041-RCVR-SEQ-NBR TO PV-DISPLAY-PO-RCVR    79190000
792000              MOVE POPRPK-PK-SKU-NBR     TO PV-DISPLAY-PACK-SKU   79200000
792100              STRING ' SUKRF706 (OTHER) -' DELIMITED BY SIZE      79210000
792200               '7685-INSERT-OTBND-PACK'    DELIMITED BY SIZE      79220000
792300                                      INTO PV-CICS-MSG-AREA-B     79230000
792400              MOVE LENGTH OF PV-CICS-MSG-AREA-A                   79240000
792500                                        TO PV-COMMAREA-LENGTH     79250000
792600              PERFORM 9998-WRITE-TO-CSSL                          79260000
792700              MOVE SPACES TO PV-CICS-MSG-AREA-A                   79270000
792800              STRING 'RET CODE '           DELIMITED BY SIZE      79280000
792900                   PV-DISPLAY-SQLCODE      DELIMITED BY SIZE      79290000
793000                     'CARTON ID '          DELIMITED BY SIZE      79300000
793100                       PV-DISPLAY-CARTON   DELIMITED BY SIZE      79310000
793200                     'PO/RCVR '            DELIMITED BY SIZE      79320000
793300                       PV-DISPLAY-PO       DELIMITED BY SIZE      79330000
793400                       ' - '               DELIMITED BY SIZE      79340000
793500                       PV-DISPLAY-PO-RCVR  DELIMITED BY SIZE      79350000
793600                     'PACK SKU '           DELIMITED BY SIZE      79360000
793700                       PV-DISPLAY-PACK-SKU DELIMITED BY SIZE      79370000
793800                                      INTO PV-CICS-MSG-AREA-B     79380000
793900              MOVE LENGTH OF PV-CICS-MSG-AREA-A                   79390000
794000                                        TO PV-COMMAREA-LENGTH     79400000
794100              PERFORM 9998-WRITE-TO-CSSL                          79410000
794200             MOVE '7685-INSERT-OTBND-PACK'                        79420000
794300                               TO DP013-PARAGRAPH                 79430000
794400             MOVE 'INSERT INTO TABLE  - '                         79440000
794500                               TO DP013-MESSAGE-TEXT (1)          79450000
794600             MOVE SQLCA        TO DP013-SQLCA                     79460000
794700             MOVE 'SUT_OTBND_PK   '                               79470000
794800                               TO DP013-DB2-TABLE-NAME (1)        79480000
794900             SET DP013-DB2-ABEND                                  79490000
795000                 DP013-XCTL-DISPLAY-RESTART TO TRUE               79500000
795100             SET DP013-ROLLBACK                                   79510000
795200                               TO TRUE                            79520000
795300             PERFORM DP014-0000-PROCESS-ABEND                     79530000
795400     END-EVALUATE.                                                79540000
795500                                                                  79550000
795600                                                                  79560000
795700 EJECT                                                            79570000
795800                                                                  79580000
795900 7690-DELETE-OTBND-PACK.                                          79590000
796000                                                                  79600000
796100                                                                  79610000
796200     EXEC SQL                                                     79620000
796300          DELETE FROM SUT_OTBND_PK                                79630000
796400           WHERE SHIPT_UNT_ID    = :SUT00024-SHIPT-UNT-ID         79640000
796500             AND TRN_NBR         = :SUT00028-TRN-NBR              79650000
796600             AND RCVR_SEQ_NBR    = :SUT00041-RCVR-SEQ-NBR         79660000
796700             AND TRN_TYP_CDE     = 'PO'                           79670000
796800             AND PK_SKU_NBR      = :POPRPK-PK-SKU-NBR             79680000
796900     END-EXEC.                                                    79690000
797000                                                                  79700000
797100     EVALUATE TRUE                                                79710000
797200         WHEN SQLCODE = ZERO                                      79720000
797300         WHEN SQLCODE = +100                                      79730000
797400             CONTINUE                                             79740000
797500         WHEN SQLWARN0 NOT = SPACES                               79750000
797600         WHEN SQLCODE < ZERO                                      79760000
797700         WHEN SQLCODE > ZERO                                      79770000
797800              MOVE SQLCODE               TO PV-SQLCODE            79780000
797900              MOVE SUT00024-SHIPT-UNT-ID TO PV-DISPLAY-CARTON     79790000
798000              MOVE SUT00028-TRN-NBR      TO PV-DISPLAY-PO         79800000
798100              MOVE SUT00041-RCVR-SEQ-NBR TO PV-DISPLAY-PO-RCVR    79810000
798200              MOVE POPRPK-PK-SKU-NBR     TO PV-DISPLAY-PACK-SKU   79820000
798300              STRING ' SUKRF706 (OTHER) -' DELIMITED BY SIZE      79830000
798400               '7690-DELETE-OTBND-PACK   ' DELIMITED BY SIZE      79840000
798500                     'RETURN-CODE-'        DELIMITED BY SIZE      79850000
798600                     PV-SQLCODE            DELIMITED BY SIZE      79860000
798700                     'CARTON ID '          DELIMITED BY SIZE      79870000
798800                       PV-DISPLAY-CARTON   DELIMITED BY SIZE      79880000
798900                     'PO NUMBER '          DELIMITED BY SIZE      79890000
799000                       PV-DISPLAY-PO       DELIMITED BY SIZE      79900000
799100                     'RCVR '               DELIMITED BY SIZE      79910000
799200                       PV-DISPLAY-PO-RCVR  DELIMITED BY SIZE      79920000
799300                     'PACK SKU '           DELIMITED BY SIZE      79930000
799400                       PV-DISPLAY-PACK-SKU DELIMITED BY SIZE      79940000
799500                                      INTO PV-CICS-MSG-AREA       79950000
799600              MOVE LENGTH OF PV-CICS-MSG-AREA                     79960000
799700                                        TO PV-COMMAREA-LENGTH     79970000
799800              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              79980000
799900             MOVE '7690-DELETE-OTBND-PACK'                        79990000
800000                               TO DP013-PARAGRAPH                 80000000
800100             MOVE 'DELETE FROM TABLE  - '                         80010000
800200                               TO DP013-MESSAGE-TEXT (1)          80020000
800300             MOVE SQLCA        TO DP013-SQLCA                     80030000
800400             MOVE 'SUT_OTBND_PK   '                               80040000
800500                               TO DP013-DB2-TABLE-NAME (1)        80050000
800600             SET DP013-DB2-ABEND                                  80060000
800700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               80070000
800800             SET DP013-ROLLBACK                                   80080000
800900                               TO TRUE                            80090000
801000             PERFORM DP014-0000-PROCESS-ABEND                     80100000
801100     END-EVALUATE.                                                80110000
801200                                                                  80120000
801300 7695-SELECT-PREPK-RATIO.                                         80130000
801400                                                                  80140000
801500     MOVE SU001-RCVR-SEQ-NBR           TO RECITM-REC-SEQ-NBR      80150000
801600     MOVE SUT00028-TRN-NBR             TO RECITM-ORD-NBR          80160000
801700     MOVE SUT00028-TRN-LNE-NBR         TO RECITM-ORD-LNE-NBR      80170000
801800                                                                  80180000
801900     EXEC SQL                                                     80190000
802000          SELECT PREPK_RATO_QTY                                   80200000
802100          INTO  :RECITM-PREPK-RATO-QTY                            80210000
802200          FROM   TRECITM                                          80220000
802300          WHERE  ORD_NBR        = :RECITM-ORD-NBR                 80230000
802400          AND    ORD_LNE_NBR    = :RECITM-ORD-LNE-NBR             80240000
802500          AND    REC_SEQ_NBR    = :RECITM-REC-SEQ-NBR             80250000
802600          AND    VER_STATUS_CDE = 'A'                             80260000
802700     END-EXEC.                                                    80270000
802800                                                                  80280000
802900     EVALUATE TRUE                                                80290000
803000         WHEN SQLCODE = ZERO                                      80300000
803100              CONTINUE                                            80310000
803200         WHEN SQLWARN0 NOT = SPACES                               80320000
803300         WHEN SQLCODE NOT EQUAL ZERO                              80330000
803400             MOVE '7695-SELECT-PREPK-RATIO'                       80340000
803500                             TO DP013-PARAGRAPH                   80350000
803600             MOVE 'SUKRF706 - SELECT PREPK RATO QTY '             80360000
803700                             TO DP013-MESSAGE-TEXT(1)             80370000
803800             MOVE SUT00024-SHIPT-UNT-ID                           80380000
803900                             TO DP013-MESSAGE-TEXT(2)             80390000
804000             MOVE SQLCA      TO DP013-SQLCA                       80400000
804100             MOVE 'TRECITM ' TO DP013-DB2-TABLE-NAME(1)           80410000
804200             SET DP013-DB2-ABEND                                  80420000
804300                             TO TRUE                              80430000
804400             SET DP013-ROLLBACK                                   80440000
804500                             TO TRUE                              80450000
804600             SET DP013-XCTL-DISPLAY-RESTART                       80460000
804700                             TO TRUE                              80470000
804800             PERFORM DP014-0000-PROCESS-ABEND                     80480000
804900     END-EVALUATE.                                                80490000
805000                                                                  80500000
805100                                                                  80510000
805200                                                                  80520000
805300*                                                                 80530000
805400******************************************************************80540000
805500 7645-SELECT-OTPK-QTY.                                            80550000
805600******************************************************************80560000
805700                                                                  80570000
805800     EXEC SQL                                                     80580000
805900         SELECT SUM(SHPD_UNT_QTY)                                 80590000
806000          INTO :PV-OUTR-PACK-QTY                                  80600000
806100          FROM SUT_OTBND_UPC                                      80610000
806200          WHERE SHIPT_UNT_ID = :DK-CTN                            80620000
806300          WITH UR                                                 80630000
806400     END-EXEC.                                                    80640000
806500                                                                  80650000
806600     EVALUATE TRUE                                                80660000
806700         WHEN SQLCODE = +0                                        80670000
806800              CONTINUE                                            80680000
806900         WHEN SQLCODE = +100                                      80690000
807000              MOVE +0 TO PV-OUTR-PACK-QTY                         80700000
807100         WHEN SQLWARN0 NOT = SPACES                               80710000
807200         WHEN SQLCODE NOT EQUAL ZERO                              80720000
807300             MOVE ' 7645-SELECT-OTPK-QTY       '                  80730000
807400                                         TO DP013-PARAGRAPH       80740000
807500             MOVE SQLCA        TO DP013-SQLCA                     80750000
807600             MOVE DK-CTN       TO PV-DISPLAY-CARTON               80760000
807700             MOVE 'SUKRF706 - CHECK OTBND UPC '                   80770000
807800                             TO DP013-MESSAGE-TEXT(1)             80780000
807900             MOVE PV-DISPLAY-CARTON                               80790000
808000                             TO DP013-MESSAGE-TEXT(2)             80800000
808100             MOVE 'SUT_OTBND_UPC'  TO DP013-DB2-TABLE-NAME(1)     80810000
808200             SET DP013-DB2-ABEND                                  80820000
808300                            TO TRUE                               80830000
808400             SET DP013-ROLLBACK                                   80840000
808500                            TO TRUE                               80850000
808600             SET DP013-XCTL-DISPLAY-RESTART                       80860000
808700                            TO TRUE                               80870000
808800             PERFORM DP014-0000-PROCESS-ABEND                     80880000
808900     END-EVALUATE.                                                80890000
809000                                                                  80900000
809100 7646-CALL-UNT-WKD-MODULE.                                        80910000
809200                                                                  80920000
809300     INITIALIZE PC260-COMM-AREA.                                  80930000
809400     MOVE SU001-CARTON                TO PC260-SHIPT-UNT-ID       80940000
809500     MOVE SU001-CURR-OPER-UNT-ID      TO PC260-OPER-UNT-ID        80950000
809600     MOVE 'REPLEN'                    TO PC260-PRCG-AREA-CDE      80960000
809700     SET PC260-TRANS-LINE-VERIFY      TO TRUE.                    80970000
809800     SET PC260-MOD-SUCCESSFUL         TO TRUE.                    80980000
809900                                                                  80990000
810000*    CALL PC260-VSM-PGM USING PC260-COMM-AREA.                    81000000
810100*    CALL 'PCKUT790' USING PC260-COMM-AREA.                       81010000
810200                                                                  81020000
810300     CALL PC260-VSM-PGM USING  DFHEIBLK                           81030000
810400                               PC260-COMMAREA                     81040000
810500                               PC260-COMM-AREA.                   81050000
810600     EVALUATE TRUE                                                81060000
810700         WHEN PC260-MOD-SUCCESSFUL                                81070000
810800             DISPLAY ' UNIT WORKED DATA UPDATED'                  81080000
810900         WHEN OTHER                                               81090000
811000             MOVE PC260-BAD-SQL-CDE    TO PV-SQLCODE              81100000
811100              STRING ' SUKRF706 (OTHER) -' DELIMITED BY SIZE      81110000
811200               '7646-CALL-UNT-WKD-MODULE ' DELIMITED BY SIZE      81120000
811300                     'DL-RETURN-SQLCODES ' DELIMITED BY SIZE      81130000
811400                       PV-SQLCODE          DELIMITED BY SIZE      81140000
811500                                      INTO PV-CICS-MSG-AREA       81150000
811600              MOVE LENGTH OF PV-CICS-MSG-AREA                     81160000
811700                                        TO PV-COMMAREA-LENGTH     81170000
811800              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              81180000
811900                                                                  81190000
812000              MOVE  '7646-CALL-UNT-WKD-MODULE'                    81200000
812100                              TO DP013-PARAGRAPH                  81210000
812200              MOVE PC260-PARAGRAPH                                81220000
812300                              TO DP013-MESSAGE-TEXT(1)            81230000
812400              MOVE PC260-MESSAGE-TEXT                             81240000
812500                                TO DP013-MESSAGE-TEXT (2)         81250000
812600              MOVE SU001-CARTON   TO  PV-DISPLAY-CARTON           81260000
812700              STRING '  CARTON - '        DELIMITED BY SIZE       81270000
812800                     PV-DISPLAY-CARTON    DELIMITED BY SIZE       81280000
812900                              INTO DP013-MESSAGE-TEXT (3)         81290000
813000              STRING ' SUKRF706 (OTHER) -' DELIMITED BY SIZE      81300000
813100               '7646-CALL-UNT-WKD-MODULE ' DELIMITED BY SIZE      81310000
813200                 'DL-RETURN-SQLCODES '     DELIMITED BY SIZE      81320000
813300                       PV-SQLCODE          DELIMITED BY SIZE      81330000
813400                              INTO DP013-MESSAGE-TEXT (4)         81340000
813500              SET DP013-DB2-ABEND                                 81350000
813600                              TO TRUE                             81360000
813700              SET DP013-ROLLBACK                                  81370000
813800                              TO TRUE                             81380000
813900              SET DP013-XCTL-DISPLAY-RESTART                      81390000
814000                              TO TRUE                             81400000
814100              PERFORM DP014-0000-PROCESS-ABEND                    81410000
814200     END-EVALUATE.                                                81420000
814300*                                                                 81430000
814400* EA 07/02/2010                                                  *81440000
814500 8000-SEND-MAP.                                                   81450000
814600                                                                  81460000
814700     EXEC CICS                                                    81470000
814800         SEND MAP       ('SU706A')                                81480000
814900              MAPSET    ('SUKM706')                               81490000
815000              ERASE                                               81500000
815100              CURSOR                                              81510000
815200              RESP      (PV-CICS-RESPONSE)                        81520000
815300     END-EXEC.                                                    81530000
815400                                                                  81540000
815500     EVALUATE TRUE                                                81550000
815600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 81560000
815700             CONTINUE                                             81570000
815800         WHEN OTHER                                               81580000
815900             MOVE '8000-SEND-MAP'      TO DP013-PARAGRAPH         81590000
816000             MOVE 'SUKRF706 - UNABLE TO SEND MAP'                 81600000
816100                                       TO DP013-MESSAGE-TEXT (1)  81610000
816200             SET DP013-CICS-ABEND      TO TRUE                    81620000
816300             SET DP013-ROLLBACK        TO TRUE                    81630000
816400             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               81640000
816500     END-EVALUATE.                                                81650000
816600                                                                  81660000
816700 8100-SEND-DATA-ONLY.                                             81670000
816800                                                                  81680000
816900     EXEC CICS                                                    81690000
817000         SEND MAP       ('SU706A')                                81700000
817100              MAPSET    ('SUKM706')                               81710000
817200              CURSOR                                              81720000
817300              DATAONLY                                            81730000
817400              RESP      (PV-CICS-RESPONSE)                        81740000
817500     END-EXEC.                                                    81750000
817600                                                                  81760000
817700     EVALUATE TRUE                                                81770000
817800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 81780000
817900             CONTINUE                                             81790000
818000         WHEN OTHER                                               81800000
818100             MOVE '8100-SEND-DATA-ONLY' TO DP013-PARAGRAPH        81810000
818200             MOVE 'SUKRF706 - UNABLE TO SEND DATA'                81820000
818300                                        TO DP013-MESSAGE-TEXT (1) 81830000
818400             SET DP013-CICS-ABEND       TO TRUE                   81840000
818500             SET DP013-ROLLBACK         TO TRUE                   81850000
818600             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               81860000
818700     END-EVALUATE.                                                81870000
818800                                                                  81880000
818900 8200-RETURN-TRANID.                                              81890000
819000                                                                  81900000
819100     MOVE LENGTH OF CA-COMMAREA  TO PV-COMMAREA-LENGTH            81910000
819200     EXEC CICS                                                    81920000
819300         RETURN TRANSID  (PC-TRANID)                              81930000
819400                COMMAREA (CA-COMMAREA)                            81940000
819500                LENGTH   (PV-COMMAREA-LENGTH)                     81950000
819600                RESP     (PV-CICS-RESPONSE)                       81960000
819700     END-EXEC.                                                    81970000
819800                                                                  81980000
819900     EVALUATE TRUE                                                81990000
820000         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 82000000
820100             CONTINUE                                             82010000
820200         WHEN OTHER                                               82020000
820300             MOVE '8200-RETURN-TRANIND' TO DP013-PARAGRAPH        82030000
820400             MOVE 'SUKRF706 - UNABLE TO RETURN TO TRANID'         82040000
820500                 TO DP013-MESSAGE-TEXT (1)                        82050000
820600             SET DP013-CICS-ABEND       TO TRUE                   82060000
820700             SET DP013-ROLLBACK         TO TRUE                   82070000
820800             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               82080000
820900     END-EVALUATE.                                                82090000
821000                                                                  82100000
821100 8300-RETURN.                                                     82110000
821200                                                                  82120000
821300     EXEC CICS                                                    82130000
821400         SEND FROM (PV-MESSAGE-AREA)                              82140000
821500              LENGTH (19)                                         82150000
821600              ERASE                                               82160000
821700     END-EXEC.                                                    82170000
821800                                                                  82180000
821900     EXEC CICS                                                    82190000
822000         RETURN                                                   82200000
822100     END-EXEC.                                                    82210000
822200                                                                  82220000
822300 9998-WRITE-TO-CSSL.                                              82230000
822400        EXEC CICS                                                 82240000
822500            WRITEQ TD                                             82250000
822600                QUEUE   ('CSSL')                                  82260000
822700                FROM    (PV-CICS-MSG-AREA-A)                      82270000
822800                LENGTH  (PV-COMMAREA-LENGTH)                      82280000
822900                RESP    (PV-CICS-RESPONSE)                        82290000
823000        END-EXEC.                                                 82300000
823100                                                                  82310000
823200 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  82320000
823300                                                                  82330000
823400     MOVE PC-CURRENT-PROGRAM-NAME  TO DP013-PROGRAM.              82340000
823500     MOVE DFHEIBLK                 TO DP013-DFHEIBLK.             82350000
823600     INITIALIZE DP013-SRC-TASK-NUMBER                             82360000
823700                DP013-STACK.                                      82370000
823800     SET DP013-LINK-RETURN TO TRUE.                               82380000
823900                                                                  82390000
824000     EXEC CICS                                                    82400000
824100         LINK                                                     82410000
824200             PROGRAM   (DP013-NAME)                               82420000
824300             COMMAREA  (DP013-PARAMETERS)                         82430000
824400             LENGTH    (DP013-LENGTH)                             82440000
824500     END-EXEC.                                                    82450000
824600                                                                  82460000
824700*----------------------------------------------------------------*82470000
824800*    ABEND PROCESSOR MODULE                                      *82480000
824900*----------------------------------------------------------------*82490000
825000                                                                  82500000
825100     COPY DPPD014.                                                82510000
825200                                                                  82520000
