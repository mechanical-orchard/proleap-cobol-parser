000100*-----------------------*                                         00010004
000200 IDENTIFICATION DIVISION.                                         00020004
000300*-----------------------*                                         00030004
000400 PROGRAM-ID.    RCKCS264.                                         00040004
000500 AUTHOR.        LARRY SCHLEICHER - STRATAGEM.                     00050004
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060004
000700 DATE-WRITTEN.  03-31-95.                                         00070004
000800 DATE-COMPILED.                                                   00080004
000900                                                                  00090004
001000*---------------------------------------------------------------* 00100004
001100*    E264 - PO AUDIT TRAIL LIST                                 * 00110004
001200*                                                               * 00120004
001300*    THIS PROGRAM DISPLAYS THE AUDIT INFORMATION FOR A          * 00130004
001400*    SHIPMENT.                                                  * 00140004
001500*                                                               * 00150004
001600*---------------------------------------------------------------* 00160004
001700* CHANGED 11/10/2021    BY JIM HUNTER      WR: CHG0263784         00170004
001800* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00180004
001900* MAKING THE CALL DYNAMIC VS STATIC.                              00190004
002000*---------------------------------------------------------------* 00200004
002100                                                                  00210004
002200 ENVIRONMENT DIVISION.                                            00220004
002300                                                                  00230004
002400 DATA DIVISION.                                                   00240004
002500                                                                  00250004
002600 WORKING-STORAGE SECTION.                                         00260004
002700                                                                  00270004
002800 01  PC-PROGRAM-CONSTANTS.                                        00280004
002900     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00290004
003000                                                    'RC264A  '.   00300004
003100     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00310004
003200                                                    'RCKM264 '.   00320004
003300     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00330004
003400                                                    'RCKCS264'.   00340004
003500     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00350004
003600     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00360004
003700     05  PC-DTL-QUEUE-SEQ               PIC  9(01)  VALUE 3.      00370004
003800     05  PC-FORCAST-SHIPMT-FORMAT       PIC  X(01)  VALUE '1'.    00380004
003900     05  PC-SHIPMT-LIST-FORMAT          PIC  X(01)  VALUE '2'.    00390004
004000     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +13     00400004
004100                                                    COMP SYNC.    00410004
004200     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00420004
004300                                                    COMP SYNC.    00430004
004400     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00440004
004500                                                    +1000000      00450004
004600                                                    COMP-3.       00460004
004700     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +5      00470004
004800                                                    COMP SYNC.    00480004
004900     05  PC-MAX-RETRIES                 PIC S9(3)    VALUE 3      00490004
005000                                                     COMP-3.      00500004
005100     05  PC-DEFAULT-DATE                PIC X(10)      VALUE      00510004
005200                                        '0001-01-01'.             00520004
005300     05  PC-DEFAULT-TIME                PIC X(08)      VALUE      00530004
005400                                        '00.00.00'.               00540004
005500                                                                  00550004
005600 01  DK-DB2-KEYS.                                                 00560004
005700     05  DK-SHIPT-ID                    PIC S9(9) COMP VALUE +0.  00570004
005800     05  DK-PO-NBR                      PIC S9(9) COMP VALUE +0.  00580004
005900                                                                  00590004
006000 01  PC-TSYMSG-NUMBERS.                                           00600004
006100     05  PC-TSYMSG-00008                PIC 9(5)    VALUE 00008.  00610004
006200     05  PC-TSYMSG-00050                PIC 9(5)    VALUE 00050.  00620004
006300     05  PC-TSYMSG-00069                PIC 9(5)    VALUE 00069.  00630004
006400     05  PC-TSYMSG-00070                PIC 9(5)    VALUE 00070.  00640004
006500     05  PC-TSYMSG-00101                PIC 9(5)    VALUE 00101.  00650004
006600     05  PC-TSYMSG-00148                PIC 9(5)    VALUE 00148.  00660004
006700     05  PC-TSYMSG-00279                PIC 9(5)    VALUE 00279.  00670004
006800     05  PC-TSYMSG-00302                PIC 9(5)    VALUE 00302.  00680004
006900                                                                  00690004
007000 01  PS-PROGRAM-SUBSCRIPTS.                                       00700004
007100     05  PS-SUB                         PIC S9(04)   VALUE +0     00710004
007200                                                     COMP SYNC.   00720004
007300                                                                  00730004
007400 01  PS-PROGRAM-SWITCHES.                                         00740004
007500     05  PS-ERROR-SW                    PIC X(01)    VALUE 'Y'.   00750004
007600         88  PS-NO-ERROR                             VALUE 'Y'.   00760004
007700         88  PS-ERROR                                VALUE 'N'.   00770004
007800     05  PS-COMMAREA-SW                 PIC X(01)    VALUE 'N'.   00780004
007900         88  PS-COMMAREA-VALID                       VALUE 'Y'.   00790004
008000         88  PS-COMMAREA-NOT-VALID                   VALUE 'N'.   00800004
008100     05  PS-LIST-END-SW                 PIC X(01)    VALUE 'N'.   00810004
008200         88  PS-LIST-END                             VALUE 'Y'.   00820004
008300         88  PS-NO-LIST-END                          VALUE 'N'.   00830004
008400     EJECT                                                        00840004
008500 01  PV-PROGRAM-VARIABLES.                                        00850004
008600     05  PV-REMAINDER                   PIC S9(04)   VALUE +0     00860004
008700                                                     COMP SYNC.   00870004
008800     05  PV-RETRY-COUNTER               PIC S9(04)   VALUE +0     00880004
008900                                                     COMP SYNC.   00890004
009000     05  PV-READ-COUNT                  PIC S9(09)   VALUE +0     00900004
009100                                                     COMP-3.      00910004
009200     05  PV-TOP-ITEM                    PIC S9(09)   VALUE +0     00920004
009300                                                     COMP-3.      00930004
009400     05  PV-BOTTOM-ITEM                 PIC S9(09)   VALUE +0     00940004
009500                                                     COMP-3.      00950004
009600     05  PV-BLOCK-NUMBER                PIC S9(04)   VALUE +0     00960004
009700                                                     COMP SYNC.   00970004
009800     05  PV-CICS-RESP                   PIC S9(04)   VALUE +0     00980004
009900                                                     COMP SYNC.   00990004
010000     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)   VALUE +0     01000004
010100                                                     COMP SYNC.   01010004
010200     05  PV-LIST-ITEM-NUMBER            PIC S9(04)   VALUE +0     01020004
010300                                                     COMP SYNC.   01030004
010400     05  PV-SQL-SUB                     PIC S9(4)    COMP.        01040004
010500     05  PV-DB2-DATE.                                             01050004
010600         10  PV-DB2-DATE-CCYY           PIC  X(04).               01060004
010700         10  FILLER                     PIC  X(01).               01070004
010800         10  PV-DB2-DATE-MM             PIC  X(02).               01080004
010900         10  FILLER                     PIC  X(01).               01090004
011000         10  PV-DB2-DATE-DD             PIC  X(02).               01100004
011100     05  PV-DB2-TIME.                                             01110004
011200         10  PV-DB2-TIME-HH             PIC  X(02).               01120004
011300         10  FILLER                     PIC  X(01).               01130004
011400         10  PV-DB2-TIME-MM             PIC  X(02).               01140004
011500         10  FILLER                     PIC  X(01).               01150004
011600         10  PV-DB2-TIME-SS             PIC  X(02).               01160004
011700                                                                  01170004
011800 01  PV-DB2-CRITERIA-AREA.                                        01180004
011900     15  PV-DB2-MESSAGE-NUMBER          PIC S9(05)  VALUE ZERO    01190004
012000                                                    COMP-3.       01200004
012100                                                                  01210004
012200 EJECT                                                            01220004
012300*---------------------------------------------------------------* 01230004
012400*    PARAMETERS FOR OBTAINING USER INFORMATION    (XLKUT067).   * 01240004
012500*---------------------------------------------------------------* 01250004
012600                                                                  01260004
012700     COPY XLWS067.                                                01270004
012800 EJECT                                                            01280004
012900******************************************************************01290005
013000** THE CALLING PARAMETER LIST (DPWS030/DPWS930) FOR THE CICS    **01300005
013010** ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                    **01301005
013100******************************************************************01310005
013200                                                                  01320004
013300     COPY DPWS030.                                                01330004
013310     COPY DPWS930.                                                01331005
013400 EJECT                                                            01340004
013500*---------------------------------------------------------------* 01350004
013600*    STANDARD COMMAREA.                                         * 01360004
013700*---------------------------------------------------------------* 01370004
013800                                                                  01380004
013900     COPY DPWS020.                                                01390004
014000     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                01400004
014100                                                                  01410004
014200*---------------------------------------------------------------* 01420004
014300*    INTER-APPLICATION COMMAREA.                                * 01430004
014400*---------------------------------------------------------------* 01440004
014500                                                                  01450004
014600         10  INTER-APPL-COMM-AREA       PIC X(200).               01460004
014700     COPY TRWS001.                                                01470004
014800     COPY RCWS015.                                                01480004
014900*---------------------------------------------------------------* 01490004
015000*    SPECIFIC COMMMAREA FOR RCKCS264.                           * 01500004
015100*---------------------------------------------------------------* 01510004
015200         10  ASC-SPECIFIC-COMMAREA.                               01520004
015300             15  ASC-LIST-KEYS.                                   01530004
015400                 20  ASC-KEY-SHIPT-ID                PIC S9(09)   01540004
015500                                                         COMP.    01550004
015600                 20  ASC-KEY-PO-NBR                  PIC S9(09)   01560004
015700                                                         COMP.    01570004
015800                 20  ASC-KEY-LAST-UPD-UID            PIC  X(08).  01580004
015900                 20  ASC-KEY-USER-NAME               PIC  X(30).  01590004
016000                 20  ASC-KEY-PRO-SCAC-ID             PIC  X(04).  01600004
016100                 20  ASC-KEY-PRO-NBR                 PIC  X(22).  01610004
016200                 20  ASC-KEY-BOL-NBR                 PIC  X(30).  01620004
016300                 20  ASC-KEY-ORIG-SCAC-ID            PIC  X(04).  01630004
016400             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                01640004
016500                 20  ASC-ITEM-ARRAY.                              01650004
016600                                                                  01660004
016700                     25  ASC-ITEM-ENTRIES OCCURS 13 TIMES.        01670004
016800                         30  ASC-LIST-ITEM-NUMBER    PIC S9(9)    01680004
016900                                                     COMP-3.      01690004
017000                         30  ASC-STATUS              PIC X(01).   01700004
017100                         30  ASC-ASN-CARTON          PIC 9(05).   01710004
017200                         30  ASC-ASN-DATE            PIC X(05).   01720004
017300                         30  ASC-ASN-TIME            PIC X(05).   01730004
017400                         30  ASC-FORECAST-CARTON     PIC 9(05).   01740004
017500                         30  ASC-FORECAST-DATE       PIC X(05).   01750004
017600                         30  ASC-FORECAST-TIME       PIC X(05).   01760004
017700                         30  ASC-CONFIRM-EXP-CTN     PIC 9(05).   01770004
017800                         30  ASC-CONFIRM-ADJ-CTN     PIC 9(05).   01780004
017900                         30  ASC-CONFIRM-DMG-CTN     PIC 9(05).   01790004
018000                         30  ASC-CONFIRM-DATE        PIC X(05).   01800004
018100                         30  ASC-CONFIRM-TIME        PIC X(05).   01810004
018200                         30  ASC-USER-ID             PIC X(08).   01820004
018300                                                                  01830004
018400             15  ASC-BLK-SUB                         PIC S9(04)   01840004
018500                                                         COMP     01850004
018600                                                         SYNC.    01860004
018700             15  ASC-ITEM-SUB                        PIC S9(04)   01870004
018800                                                         COMP     01880004
018900                                                         SYNC.    01890004
019000             15  ASC-SEL-SUB                         PIC S9(04)   01900004
019100                                                         COMP.    01910004
019200             15  ASC-SEL-ITEM                        PIC S9(04)   01920004
019300                                                         COMP.    01930004
019400             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)   01940004
019500                                                         COMP-3.  01950004
019600             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   01960004
019700                                                         COMP-3.  01970004
019800             15  ASC-NUMBER-OF-TS-ITEMS              PIC S9(05)   01980004
019900                                                         COMP-3.  01990004
020000             15  ASC-ITEMS-DISPLAYED                 PIC S9(03)   02000004
020100                                                         COMP-3.  02010004
020200             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   02020004
020300                                                         COMP-3.  02030004
020400             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)   02040004
020500                                                         COMP-3.  02050004
020600             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)   02060004
020700                                                         COMP     02070004
020800                                                         SYNC.    02080004
020900             15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   02090004
021000                                                         COMP-3.  02100004
021100             15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   02110004
021200                                                         COMP-3.  02120004
021300             15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  02130004
021400                 88  ASC-ITEMS-LEFT-ON-DB              VALUE 'Y'. 02140004
021500                 88  ASC-NO-ITEMS-LEFT-ON-DB           VALUE 'N'. 02150004
021600             15  ASC-USE-SELECTION-QUEUE-IND         PIC  X(01).  02160004
021700                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 02170004
021800             15  ASC-DESC-LINE-IND                   PIC  X(01).  02180004
021900                 88  ASC-DESC-LINE-DONE                VALUE 'Y'. 02190004
022000             15  ASC-CORR-LINE-IND                   PIC  X(01).  02200004
022100                 88  ASC-CORR-LINE-DONE                VALUE 'Y'. 02210004
022200             15  ASC-LIST-QUEUE-NAME.                             02220004
022300                 20  ASC-LIST-TERM-ID                PIC  X(04).  02230004
022400                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   02240004
022500                                                         COMP-3.  02250004
022600                 20  ASC-LIST-SEQ                    PIC  9(01).  02260004
022700             15  ASC-SEL-QUEUE-NAME.                              02270004
022800                 20  ASC-SEL-TERM-ID                 PIC  X(04).  02280004
022900                 20  ASC-SEL-TASK-NUMBER             PIC S9(05)   02290004
023000                                                          COMP-3. 02300004
023100                 20  ASC-SEL-SEQ                     PIC  9(01).  02310004
023200             15  ASC-DTL-QUEUE-NAME.                              02320004
023300                 20  ASC-DTL-TERM-ID                 PIC  X(04).  02330004
023400                 20  ASC-DTL-TASK-NUMBER             PIC S9(05)   02340004
023500                                                         COMP-3.  02350004
023600                 20  ASC-DTL-SEQ                     PIC  9(01).  02360004
023700                                                                  02370004
023800             15  ASC-START-ITEM-REQUEST.                          02380004
023900                 20  ASC-START-ITEM-REQUEST-N        PIC  9(05).  02390004
024000                                                                  02400004
024100     EJECT                                                        02410004
024200*---------------------------------------------------------------* 02420004
024300*    MESSAGE SELECTION TSQ B QUEUE RECORD LAYOUT.               * 02430004
024400*---------------------------------------------------------------* 02440004
024500                                                                  02450004
024600     COPY RCWS013.                                                02460004
024700                                                                  02470004
024800     EJECT                                                        02480004
024900*---------------------------------------------------------------* 02490004
025000*    ABEND PROCESSING COPYBOOK.                                 * 02500004
025100*---------------------------------------------------------------* 02510004
025200                                                                  02520004
025300     COPY DPWS013.                                                02530004
025400                                                                  02540004
025500     EJECT                                                        02550004
025600*---------------------------------------------------------------* 02560004
025700*    ATTRIBUTE SETTINGS COPYBOOK.                               * 02570004
025800*---------------------------------------------------------------* 02580004
025900                                                                  02590004
026000     COPY DPWS015.                                                02600004
026100                                                                  02610004
026200*---------------------------------------------------------------* 02620004
026300*    FUNCTION KEYS COPYBOOK.                                    * 02630004
026400*---------------------------------------------------------------* 02640004
026500                                                                  02650004
026600     COPY DPWS016.                                                02660004
026700                                                                  02670004
026800*---------------------------------------------------------------* 02680004
026900*    NUMERIC EDIT LAYOUT.                                       * 02690004
027000*---------------------------------------------------------------* 02700004
027100                                                                  02710004
027200     COPY DPWS010I.                                               02720004
027300                                                                  02730004
027400*---------------------------------------------------------------* 02740004
027500*    MAP LAYOUT                                                 * 02750004
027600*---------------------------------------------------------------* 02760004
027700                                                                  02770004
027800     COPY RCKM264.                                                02780004
027900                                                                  02790004
028000 01  MR-OCCURS-LAYOUT          REDEFINES  RC264AO.                02800004
028100* CHG0094517  CHANGED FILLER LENGTH FROM 178 TO 179               02810004
028200     05  FILLER                PIC X(179).                        02820004
028300     05  MR-SCROLL-AREA OCCURS 13 TIMES.                          02830004
028400         10  MR-STATUSL        PIC S9(04) COMP.                   02840004
028500         10  MR-STATUSA        PIC  X(01).                        02850004
028600         10  MR-STATUSC        PIC  X(01).                        02860004
028700         10  MR-STATUSH        PIC  X(01).                        02870004
028800         10  MR-STATUS         PIC  X(01).                        02880004
028900                                                                  02890004
029000         10  MR-ASN-CARTONL    PIC S9(04) COMP.                   02900004
029100         10  MR-ASN-CARTONA    PIC  X(01).                        02910004
029200         10  MR-ASN-CARTONC    PIC  X(01).                        02920004
029300         10  MR-ASN-CARTONH    PIC  X(01).                        02930004
029400         10  MR-ASN-CARTON-X.                                     02940004
029500             15  MR-ASN-CARTON     PIC  ZZZZ9.                    02950004
029600                                                                  02960004
029700         10  MR-ASN-DATEL      PIC S9(04) COMP.                   02970004
029800         10  MR-ASN-DATEA      PIC  X(01).                        02980004
029900         10  MR-ASN-DATEC      PIC  X(01).                        02990004
030000         10  MR-ASN-DATEH      PIC  X(01).                        03000004
030100         10  MR-ASN-DATE       PIC  X(05).                        03010004
030200                                                                  03020004
030300         10  MR-ASN-TIMEL      PIC S9(04) COMP.                   03030004
030400         10  MR-ASN-TIMEA      PIC  X(01).                        03040004
030500         10  MR-ASN-TIMEC      PIC  X(01).                        03050004
030600         10  MR-ASN-TIMEH      PIC  X(01).                        03060004
030700         10  MR-ASN-TIME       PIC  X(05).                        03070004
030800                                                                  03080004
030900         10  MR-FOR-CARTONL    PIC S9(04) COMP.                   03090004
031000         10  MR-FOR-CARTONA    PIC  X(01).                        03100004
031100         10  MR-FOR-CARTONC    PIC  X(01).                        03110004
031200         10  MR-FOR-CARTONH    PIC  X(01).                        03120004
031300         10  MR-FOR-CARTON-X.                                     03130004
031400             15  MR-FOR-CARTON     PIC  ZZZZ9.                    03140004
031500                                                                  03150004
031600         10  MR-FOR-DATEL      PIC S9(04) COMP.                   03160004
031700         10  MR-FOR-DATEA      PIC  X(01).                        03170004
031800         10  MR-FOR-DATEC      PIC  X(01).                        03180004
031900         10  MR-FOR-DATEH      PIC  X(01).                        03190004
032000         10  MR-FOR-DATE       PIC  X(05).                        03200004
032100                                                                  03210004
032200         10  MR-FOR-TIMEL      PIC S9(04) COMP.                   03220004
032300         10  MR-FOR-TIMEA      PIC  X(01).                        03230004
032400         10  MR-FOR-TIMEC      PIC  X(01).                        03240004
032500         10  MR-FOR-TIMEH      PIC  X(01).                        03250004
032600         10  MR-FOR-TIME       PIC  X(05).                        03260004
032700                                                                  03270004
032800         10  MR-CON-EXP-CTNL   PIC S9(04) COMP.                   03280004
032900         10  MR-CON-EXP-CTNA   PIC  X(01).                        03290004
033000         10  MR-CON-EXP-CTNC   PIC  X(01).                        03300004
033100         10  MR-CON-EXP-CTNH   PIC  X(01).                        03310004
033200         10  MR-CON-EXP-CTN-X.                                    03320004
033300             15  MR-CON-EXP-CTN    PIC  ZZZZ9.                    03330004
033400                                                                  03340004
033500         10  MR-CON-ADJ-CTNL   PIC S9(04) COMP.                   03350004
033600         10  MR-CON-ADJ-CTNA   PIC  X(01).                        03360004
033700         10  MR-CON-ADJ-CTNC   PIC  X(01).                        03370004
033800         10  MR-CON-ADJ-CTNH   PIC  X(01).                        03380004
033900         10  MR-CON-ADJ-CTN-X.                                    03390004
034000             15  MR-CON-ADJ-CTN    PIC  ZZZZ9.                    03400004
034100                                                                  03410004
034200         10  MR-CON-DMG-CTNL   PIC S9(04) COMP.                   03420004
034300         10  MR-CON-DMG-CTNA   PIC  X(01).                        03430004
034400         10  MR-CON-DMG-CTNC   PIC  X(01).                        03440004
034500         10  MR-CON-DMG-CTNH   PIC  X(01).                        03450004
034600         10  MR-CON-DMG-CTN-X.                                    03460004
034700             15  MR-CON-DMG-CTN    PIC  ZZZZ9.                    03470004
034800                                                                  03480004
034900         10  MR-CON-DATEL      PIC S9(04) COMP.                   03490004
035000         10  MR-CON-DATEA      PIC  X(01).                        03500004
035100         10  MR-CON-DATEC      PIC  X(01).                        03510004
035200         10  MR-CON-DATEH      PIC  X(01).                        03520004
035300         10  MR-CON-DATE       PIC  X(05).                        03530004
035400                                                                  03540004
035500         10  MR-CON-TIMEL      PIC S9(04) COMP.                   03550004
035600         10  MR-CON-TIMEA      PIC  X(01).                        03560004
035700         10  MR-CON-TIMEC      PIC  X(01).                        03570004
035800         10  MR-CON-TIMEH      PIC  X(01).                        03580004
035900         10  MR-CON-TIME       PIC  X(05).                        03590004
036000                                                                  03600004
036100         10  MR-USER-IDL       PIC S9(04) COMP.                   03610004
036200         10  MR-USER-IDA       PIC  X(01).                        03620004
036300         10  MR-USER-IDC       PIC  X(01).                        03630004
036400         10  MR-USER-IDH       PIC  X(01).                        03640004
036500         10  MR-USER-ID        PIC  X(08).                        03650004
036600                                                                  03660004
036700 EJECT                                                            03670004
036800*---------------------------------------------------------------* 03680004
036900*    DB2 AREA FOR SHIPMENT TABLE                                * 03690004
037000*---------------------------------------------------------------* 03700004
037100     EXEC SQL                                                     03710004
037200          INCLUDE TSHIPMT                                         03720004
037300     END-EXEC.                                                    03730004
037400                                                                  03740004
037500*---------------------------------------------------------------* 03750004
037600*    DB2 AREA FOR AUDIT SHIPMENT TABLE                          * 03760004
037700*---------------------------------------------------------------* 03770004
037800     EXEC SQL                                                     03780004
037900          INCLUDE TAUSHPO                                         03790004
038000     END-EXEC.                                                    03800004
038100                                                                  03810004
038200*---------------------------------------------------------------* 03820004
038300*    DB2 AREA FOR SHIPMENT TABLE                                * 03830004
038400*---------------------------------------------------------------* 03840004
038500     EXEC SQL                                                     03850004
038600          INCLUDE TSHPTPO                                         03860004
038700     END-EXEC.                                                    03870004
038800                                                                  03880004
038900*---------------------------------------------------------------* 03890004
039000*    DB2 AREA FOR COMMUNICATIONS                                * 03900004
039100*---------------------------------------------------------------* 03910004
039200     EXEC SQL                                                     03920004
039300          INCLUDE SQLCA                                           03930004
039400     END-EXEC.                                                    03940004
039500                                                                  03950004
039600*---------------------------------------------------------------* 03960004
039700*    CURSOR TO OBTAIN LONG DESCRIPTION AND CORRECTIVE ACTION    * 03970004
039800*---------------------------------------------------------------* 03980004
039900                                                                  03990004
040000     EXEC SQL                                                     04000004
040100          DECLARE AUSHPO-CSR CURSOR                               04010004
040200          FOR SELECT                                              04020004
040300                EXPTED_CART_CNT                                   04030004
040400              , ACTL_CART_CNT                                     04040004
040500              , DMG_CART_CNT                                      04050004
040600              , PKSL_IND                                          04060004
040700              , CARR_CART_CT                                      04070004
040800              , CARR_LAST_UPD_DTE                                 04080004
040900              , CARR_LAST_UPD_TIME                                04090004
041000              , VEND_CART_CT                                      04100004
041100              , VEND_LAST_UPD_DTE                                 04110004
041200              , VEND_LAST_UPD_TIME                                04120004
041300              , LAST_UPD_DTE                                      04130004
041400              , LAST_UPD_TIME                                     04140004
041500              , LAST_UPD_USER_ID                                  04150004
041600          FROM                                                    04160004
041700                TAUSHPO                                           04170004
041800          WHERE                                                   04180004
041900                PO_NBR         = :DK-PO-NBR                       04190004
042000            AND SHIPT_ID       = :DK-SHIPT-ID                     04200004
042100          ORDER BY                                                04210004
042200                LAST_UPD_DTE                                      04220004
042300              , LAST_UPD_TIME                                     04230004
042400              , VEND_LAST_UPD_DTE                                 04240004
042500              , VEND_LAST_UPD_TIME                                04250004
042600              , CARR_LAST_UPD_DTE                                 04260004
042700              , CARR_LAST_UPD_TIME                                04270004
042800     END-EXEC.                                                    04280004
042900                                                                  04290004
043000 EJECT                                                            04300004
043100 LINKAGE SECTION.                                                 04310004
043200                                                                  04320004
043300 01  DFHCOMMAREA.                                                 04330004
043400     05  FILLER                         OCCURS  1 TO 4072 TIMES   04340004
043500                                        DEPENDING ON EIBCALEN.    04350004
043600         10  FILLER                     PIC X.                    04360004
043700                                                                  04370004
043800 EJECT                                                            04380004
043900 PROCEDURE DIVISION.                                              04390004
044000                                                                  04400004
044100 0000-MAIN-MODULE.                                                04410004
044200                                                                  04420004
044300     INITIALIZE DP030-CICS-API-FIELDS.                            04430004
044400     MOVE +1                      TO DP030-NUMBER-OF-MAPS.        04440004
044500     MOVE PC-CURRENT-MAPSET-NAME  TO DP030-MAPSET-NAME.           04450004
044600     MOVE PC-CURRENT-MAP-NAME     TO DP030-MAP-NAME (1).          04460004
044700     SET DP030-RECEIVE-APPL-MAP   TO TRUE.                        04470004
044800     MOVE LENGTH OF RC264AI       TO DP030-MAP-LENGTH (1).        04480004
044900     MOVE 'PROGRAM ENTRY CALL'    TO DP013-MESSAGE-TEXT (1).      04490004
045000     PERFORM 0001-CALL-CICS-ARCH-API.                             04500004
045100                                                                  04510004
045200     PERFORM 1000-CONTROL-PROCESSING.                             04520004
045300                                                                  04530004
045400     MOVE 'PROGRAM EXIT CALL'     TO DP013-MESSAGE-TEXT (1).      04540004
045500     PERFORM 0001-CALL-CICS-ARCH-API.                             04550004
045600                                                                  04560004
045700*----------------------------------------------------------------*04570004
045800*   THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE    *04580004
045900*   AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.          *04590004
046000*----------------------------------------------------------------*04600004
046100                                                                  04610004
046200 0001-CALL-CICS-ARCH-API.                                         04620004
046300                                                                  04630004
046410     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      04641005
046500                                    DFHCOMMAREA                   04650005
046600                                    DP030-CICS-API-FIELDS         04660005
046700                                    DP020-STANDARD-COMMAREA       04670005
046800                                    RC264AI.                      04680005
046900                                                                  04690004
047000     IF  DP030-RC-CALL-SUCCESSFUL                                 04700004
047100         CONTINUE                                                 04710004
047200     ELSE                                                         04720004
047300         SET DP013-NO-ROLLBACK TO TRUE                            04730004
047400         SET DP013-XCTL-DISPLAY-RESTART TO TRUE                   04740004
047500         SET DP013-CICS-ABEND TO TRUE                             04750004
047600         MOVE 'BEFORE 0000-MAIN-MODULE' TO DP013-PARAGRAPH        04760004
047620         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O04762005
047630-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      04763005
047900         MOVE DP030-RETURN-CODE                                   04790004
048000                               TO DP013-MESSAGE-TEXT (3)          04800004
048100         PERFORM DP013-0000-PROCESS-ABEND                         04810004
048200     END-IF.                                                      04820004
048300                                                                  04830004
048400*----------------------------------------------------------------*04840004
048500* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *04850004
048600* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *04860004
048700*                                                                *04870004
048800* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *04880004
048900*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *04890004
049000*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *04900004
049100*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *04910004
049200*----------------------------------------------------------------*04920004
049300                                                                  04930004
049400 1000-CONTROL-PROCESSING.                                         04940004
049500                                                                  04950004
049600     EVALUATE TRUE                                                04960004
049700         WHEN DP020-NEXT-ACT-INITIAL                              04970004
049800             MOVE EIBTRMID          TO ASC-DTL-TERM-ID            04980004
049900             MOVE DP020-SRC-TASK-NUMBER                           04990004
050000                                    TO ASC-DTL-TASK-NUMBER        05000004
050100             MOVE PC-DTL-QUEUE-SEQ  TO ASC-DTL-SEQ                05010004
050200             PERFORM 1100-PROCESS-INTER-APPL-COMM                 05020004
050300***-----$TEMPLATE NOTE$-------------------------------------------05030004
050400*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,05040004
050500*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  05050004
050600*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.05060004
050700***---------------------------------------------------------------05070004
050800             IF  PS-COMMAREA-NOT-VALID                            05080004
050900                 SET DP020-NEXT-ACT-APPL-ERROR                    05090004
051000                               TO  TRUE                           05100004
051100             ELSE                                                 05110004
051200                 PERFORM 2050-DELETE-DETAIL-QUEUE                 05120004
051300                 PERFORM 4000-BUILD-INITIAL-PANEL                 05130004
051400             END-IF                                               05140004
051500                                                                  05150004
051600         WHEN DP020-NEXT-ACT-READ-MAP                             05160004
051700             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        05170004
051800                               TO PV-TOP-ITEM                     05180004
051900             PERFORM 2000-PROCESS-PANEL                           05190004
052000                                                                  05200004
052100         WHEN DP020-NEXT-ACT-RETURN                               05210004
052200             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        05220004
052300                               TO PV-TOP-ITEM                     05230004
052400             MOVE ZERO         TO ASC-ITEM-AT-TOP-OF-PANEL        05240004
052500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 05250004
052600                                                                  05260004
052700         WHEN OTHER                                               05270004
052800             SET DP013-LOGIC-ABEND TO TRUE                        05280004
052900             SET DP013-NO-ROLLBACK TO TRUE                        05290004
053000             MOVE '1000-CONTROL-PROCESSING'                       05300004
053100                               TO  DP013-PARAGRAPH                05310004
053200             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    05320004
053300                               TO  DP013-MESSAGE-TEXT(1)          05330004
053400             PERFORM DP013-0000-PROCESS-ABEND                     05340004
053500     END-EVALUATE.                                                05350004
053600                                                                  05360004
053700 EJECT                                                            05370004
053800*----------------------------------------------------------------*05380004
053900* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *05390004
054000* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *05400004
054100*----------------------------------------------------------------*05410004
054200                                                                  05420004
054300 1100-PROCESS-INTER-APPL-COMM.                                    05430004
054400                                                                  05440004
054500     SET PS-COMMAREA-VALID     TO TRUE.                           05450004
054600     INITIALIZE ASC-SPECIFIC-COMMAREA.                            05460004
054700     MOVE SPACE                TO ASC-START-ITEM-REQUEST.         05470004
054800     EVALUATE DP020-INT-APPL-FORMAT-IND                           05480004
054900         WHEN PC-FORCAST-SHIPMT-FORMAT                            05490004
055000             IF TR001-PO-NBR   > ZERO AND                         05500004
055100                TR001-SHIPT-ID > ZERO                             05510004
055200                 MOVE TR001-PO-NBR                                05520004
055300                               TO ASC-KEY-PO-NBR                  05530004
055400                                  DK-PO-NBR                       05540004
055500                 MOVE TR001-SHIPT-ID                              05550004
055600                               TO ASC-KEY-SHIPT-ID                05560004
055700                                  DK-SHIPT-ID                     05570004
055800             ELSE                                                 05580004
055900                 MOVE PC-TSYMSG-00148                             05590004
056000                               TO DP020-MSG-NUMBER                05600004
056100                 SET DP020-MSG-FATAL TO TRUE                      05610004
056200                 SET DP020-NEXT-ACT-APPL-ERROR TO TRUE            05620004
056300             END-IF                                               05630004
056400         WHEN PC-SHIPMT-LIST-FORMAT                               05640004
056500             SET ASC-USE-SELECTION-QUEUE TO TRUE                  05650004
056600             MOVE RC015-NUMBER-OF-TS-ITEMS                        05660004
056700                               TO ASC-NUMBER-OF-TS-ITEMS          05670004
056800             MOVE RC015-SEL-QUEUE-NAME                            05680004
056900                               TO ASC-SEL-QUEUE-NAME              05690004
057000             PERFORM 1120-PREPARE-LIST-ENTRY                      05700004
057100         WHEN OTHER                                               05710004
057200             MOVE PC-TSYMSG-00148                                 05720004
057300                           TO DP020-MSG-NUMBER                    05730004
057400             SET DP020-MSG-FATAL TO TRUE                          05740004
057500             SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                05750004
057600     END-EVALUATE.                                                05760004
057700                                                                  05770004
057800*----------------------------------------------------------------*05780004
057900*    GET READY TO START AT THE FIRST ITEM ON THE LIST.           *05790004
058000*----------------------------------------------------------------*05800004
058100                                                                  05810004
058200 1120-PREPARE-LIST-ENTRY.                                         05820004
058300                                                                  05830004
058400     MOVE RC013-MAX-ITEMS TO ASC-SEL-SUB.                         05840004
058500     MOVE ZERO            TO ASC-SEL-ITEM.                        05850004
058600     PERFORM 2140-GET-NEXT-RECORD.                                05860004
058700 EJECT                                                            05870004
058800*----------------------------------------------------------------*05880004
058900*    RECEIVE THE MAP AND PERFORM THE APPROPRIATE PARAGRAPH BASED *05890004
059000*    ON WHAT FUNCTION KEY WAS SELECTED.                          *05900004
059100*----------------------------------------------------------------*05910004
059200                                                                  05920004
059300 2000-PROCESS-PANEL.                                              05930004
059400                                                                  05940004
059500     EVALUATE TRUE                                                05950004
059600         WHEN DP020-SRC-AID = DP016-CLEAR                         05960004
059700             MOVE ZERO TO ASC-ITEM-AT-TOP-OF-PANEL                05970004
059800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 05980004
059900             PERFORM 3200-RESET-ATTRIBUTES                        05990004
060000                                                                  06000004
060100         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    06010004
060200             MOVE ASC-KEY-SHIPT-ID                                06020004
060300                           TO DK-SHIPT-ID                         06030004
060400             PERFORM 2050-DELETE-DETAIL-QUEUE                     06040004
060500             PERFORM 4000-BUILD-INITIAL-PANEL                     06050004
060600             PERFORM 3200-RESET-ATTRIBUTES                        06060004
060700                                                                  06070004
060800         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             06080004
060900             IF  ASC-USE-SELECTION-QUEUE                          06090004
061000                 PERFORM 2140-GET-NEXT-RECORD                     06100004
061100                 IF PS-LIST-END                                   06110004
061200                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         06120004
061300                     SET PS-NO-LIST-END TO TRUE                   06130004
061400                 ELSE                                             06140004
061500                     PERFORM 2050-DELETE-DETAIL-QUEUE             06150004
061600                     PERFORM 4000-BUILD-INITIAL-PANEL             06160004
061700                 END-IF                                           06170004
061800                 PERFORM 3200-RESET-ATTRIBUTES                    06180004
061900             ELSE                                                 06190004
062000                 MOVE PC-TSYMSG-00070                             06200004
062100                                  TO DP020-MSG-NUMBER             06210004
062200                 SET DP020-MSG-INFORMATIONAL TO TRUE              06220004
062300             END-IF                                               06230004
062400                                                                  06240004
062500         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             06250004
062600             IF  ASC-USE-SELECTION-QUEUE                          06260004
062700                 PERFORM 2150-GET-PREV-RECORD                     06270004
062800                 IF PS-LIST-END                                   06280004
062900                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         06290004
063000                     SET PS-NO-LIST-END TO TRUE                   06300004
063100                 ELSE                                             06310004
063200                     PERFORM 2050-DELETE-DETAIL-QUEUE             06320004
063300                     PERFORM 4000-BUILD-INITIAL-PANEL             06330004
063400                 END-IF                                           06340004
063500                 PERFORM 3200-RESET-ATTRIBUTES                    06350004
063600             ELSE                                                 06360004
063700                 MOVE PC-TSYMSG-00069                             06370004
063800                                  TO DP020-MSG-NUMBER             06380004
063900                 SET DP020-MSG-INFORMATIONAL TO TRUE              06390004
064000             END-IF                                               06400004
064100                                                                  06410004
064200         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  06420004
064300             MOVE +1 TO PV-TOP-ITEM                               06430004
064400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06440004
064500             PERFORM 3200-RESET-ATTRIBUTES                        06450004
064600                                                                  06460004
064700         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   06470004
064800             PERFORM 2110-BROWSE-BACKWARD                         06480004
064900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06490004
065000             PERFORM 3200-RESET-ATTRIBUTES                        06500004
065100                                                                  06510004
065200         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   06520004
065300             PERFORM 2120-BROWSE-FORWARD                          06530004
065400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06540004
065500             PERFORM 3200-RESET-ATTRIBUTES                        06550004
065600                                                                  06560004
065700         WHEN DP020-SRC-AID = DP016-ENTER                         06570004
065800             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   06580004
065900             IF  PS-ERROR                                         06590004
066000                 CONTINUE                                         06600004
066100             ELSE                                                 06610004
066200                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             06620004
066300                 PERFORM 3200-RESET-ATTRIBUTES                    06630004
066400             END-IF                                               06640004
066500                                                                  06650004
066600         WHEN OTHER                                               06660004
066700             SET DP013-NO-ROLLBACK TO TRUE                        06670004
066800             SET DP013-XCTL-DISPLAY-RESTART TO TRUE               06680004
066900             SET DP013-CICS-ABEND TO TRUE                         06690004
067000             MOVE '2000-PROCESS-PANEL' TO DP013-PARAGRAPH         06700004
067100             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      06710004
067200                                   TO DP013-MESSAGE-TEXT (1)      06720004
067300             PERFORM DP013-0000-PROCESS-ABEND                     06730004
067400                                                                  06740004
067500     END-EVALUATE.                                                06750004
067600 EJECT                                                            06760004
067700*----------------------------------------------------------------*06770004
067800*    DELETE THE TEMPORARY STORAGE QUEUE.                         *06780004
067900*----------------------------------------------------------------*06790004
068000                                                                  06800004
068100 2050-DELETE-DETAIL-QUEUE.                                        06810004
068200                                                                  06820004
068300     EXEC CICS                                                    06830004
068400         DELETEQ TS                                               06840004
068500             QUEUE (ASC-DTL-QUEUE-NAME)                           06850004
068600             RESP  (PV-CICS-RESP)                                 06860004
068700     END-EXEC.                                                    06870004
068800                                                                  06880004
068900     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       06890004
069000        (PV-CICS-RESP = DFHRESP(QIDERR))                          06900004
069100         CONTINUE                                                 06910004
069200     ELSE                                                         06920004
069300         SET DP013-CICS-ABEND TO TRUE                             06930004
069400         SET DP013-NO-ROLLBACK TO TRUE                            06940004
069500                                                                  06950004
069600         MOVE '2050-DELETE-DETAIL-QUEUE' TO DP013-PARAGRAPH       06960004
069700         MOVE 'ERROR TRYING TO DELETE DETAIL TEMP STORAGE QUEUE'  06970004
069800                        TO DP013-MESSAGE-TEXT (1)                 06980004
069900         PERFORM DP013-0000-PROCESS-ABEND                         06990004
070000     END-IF.                                                      07000004
070100                                                                  07010004
070200     MOVE +0 TO ASC-HIGHEST-BLOCK-WRITTEN.                        07020004
070300 EJECT                                                            07030004
070400*----------------------------------------------------------------*07040004
070500*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *07050004
070600*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *07060004
070700*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *07070004
070800*    MESSAGE.                                                    *07080004
070900*----------------------------------------------------------------*07090004
071000                                                                  07100004
071100 2110-BROWSE-BACKWARD.                                            07110004
071200                                                                  07120004
071300     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    07130004
071400         GIVING PV-TOP-ITEM.                                      07140004
071500                                                                  07150004
071600     IF  PV-TOP-ITEM < +1                                         07160004
071700         MOVE +1              TO PV-TOP-ITEM                      07170004
071800*        -- TOP OF LIST --                                        07180004
071900         MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER                 07190004
072000         SET DP020-MSG-INFORMATIONAL TO TRUE                      07200004
072100     END-IF.                                                      07210004
072200                                                                  07220004
072300 EJECT                                                            07230004
072400                                                                  07240004
072500*----------------------------------------------------------------*07250004
072600*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *07260004
072700*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *07270004
072800*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *07280004
072900*----------------------------------------------------------------*07290004
073000                                                                  07300004
073100 2120-BROWSE-FORWARD.                                             07310004
073200                                                                  07320004
073300     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              07330004
073400         GIVING PV-TOP-ITEM.                                      07340004
073500     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   07350004
073600         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            07360004
073700                                   TO PV-TOP-ITEM                 07370004
073800*        -- BOTTOM OF LIST --                                     07380004
073900         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            07390004
074000         SET DP020-MSG-INFORMATIONAL                              07400004
074100                                   TO TRUE                        07410004
074200     ELSE                                                         07420004
074300         COMPUTE PV-BOTTOM-ITEM =                                 07430004
074400             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 07440004
074500         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            07450004
074600*            -- BOTTOM OF LIST --                                 07460004
074700             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            07470004
074800             SET DP020-MSG-INFORMATIONAL                          07480004
074900                                   TO TRUE                        07490004
075000         END-IF                                                   07500004
075100     END-IF.                                                      07510004
075200 EJECT                                                            07520004
075300*----------------------------------------------------------------*07530004
075400*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *07540004
075500*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *07550004
075600*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *07560004
075700*    RATHER THAN HITTING PF8 TO PAGE FORWARD TO THAT POINT.      *07570004
075800*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *07580004
075900*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *07590004
076000*----------------------------------------------------------------*07600004
076100                                                                  07610004
076200 2130-CHECK-FOR-JUMP-BROWSE.                                      07620004
076300                                                                  07630004
076400     IF ASTRTITL > ZERO                                           07640004
076500         MOVE ASTRTITI             TO ASC-START-ITEM-REQUEST      07650004
076600     ELSE                                                         07660004
076700         IF ASTRTITF = DP015-ERASE-EOF                            07670004
076800             INITIALIZE ASC-START-ITEM-REQUEST                    07680004
076900         END-IF                                                   07690004
077000     END-IF.                                                      07700004
077100                                                                  07710004
077200     SET PS-NO-ERROR               TO TRUE.                       07720004
077300     IF (ASC-START-ITEM-REQUEST = SPACE)                          07730004
077400         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            07740004
077500                                   TO PV-TOP-ITEM                 07750004
077600     ELSE                                                         07760004
077700         MOVE ASC-START-ITEM-REQUEST                              07770004
077800                                   TO DP010I-UNEDITED-FIELD       07780004
077900         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       07790004
078000         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     07800004
078100         SET DP010I-NEGATIVE-NOT-ALLOWED                          07810004
078200                                   TO TRUE                        07820004
078300         CALL DP010I-NUMERIC-EDIT-ROUTINE                         07830004
078400              USING DP010I-NUMERIC-EDIT-AREA                      07840004
078500                                                                  07850004
078600         IF  NOT DP010I-ERROR-DETECTED                            07860004
078700             MOVE DP010I-NUMERIC-FIELD                            07870004
078800                                   TO  ASC-START-ITEM-REQUEST-N   07880004
078900             IF  ASC-START-ITEM-REQUEST-N > ZERO                  07890004
079000                 IF  ASC-START-ITEM-REQUEST-N >                   07900004
079100                                          ASC-NUMBER-OF-ITEMS-READ07910004
079200                     MOVE SPACE TO ASC-START-ITEM-REQUEST         07920004
079300                     COMPUTE PV-TOP-ITEM =                        07930004
079400                             ASC-NUMBER-OF-ITEMS-READ             07940004
079500                             - PC-ITEMS-PER-PANEL + 1             07950004
079600                     IF  PV-TOP-ITEM < +1                         07960004
079700                         MOVE +1   TO PV-TOP-ITEM                 07970004
079800                         MOVE PC-TSYMSG-00070                     07980004
079900                                   TO DP020-MSG-NUMBER            07990004
080000                         SET DP020-MSG-INFORMATIONAL              08000004
080100                                   TO TRUE                        08010004
080200                     END-IF                                       08020004
080300                 ELSE                                             08030004
080400                     MOVE ASC-START-ITEM-REQUEST-N                08040004
080500                                   TO PV-TOP-ITEM                 08050004
080600                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      08060004
080700                     COMPUTE PV-BOTTOM-ITEM =                     08070004
080800                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     08080004
080900                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ08090004
081000*                        -- BOTTOM OF LIST --                     08100004
081100                         MOVE PC-TSYMSG-00070                     08110004
081200                                   TO DP020-MSG-NUMBER            08120004
081300                         SET DP020-MSG-INFORMATIONAL              08130004
081400                                   TO TRUE                        08140004
081500                     END-IF                                       08150004
081600                 END-IF                                           08160004
081700             ELSE                                                 08170004
081800*                --- VALUE OUT OF RANGE ----                      08180004
081900                 MOVE PC-TSYMSG-00101                             08190004
082000                                   TO DP020-MSG-NUMBER            08200004
082100                 MOVE -1           TO ASTRTITL                    08210004
082200                 SET DP030-SET-CURSOR-APPL-1                      08220004
082300                                   TO TRUE                        08230004
082400                 MOVE DP015-REVERSE                               08240004
082500                                   TO ASTRTITH                    08250004
082600                 MOVE DP015-RED    TO ASTRTITC                    08260004
082700                 MOVE DP015-UNP-NUM-BRT-MDT                       08270004
082800                                   TO ASTRTITA                    08280004
082900                 SET DP020-MSG-FATAL                              08290004
083000                                   TO TRUE                        08300004
083100                 SET PS-ERROR      TO TRUE                        08310004
083200             END-IF                                               08320004
083300                                                                  08330004
083400         ELSE                                                     08340004
083500             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            08350004
083600             MOVE -1               TO ASTRTITL                    08360004
083700             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08370004
083800             MOVE DP015-REVERSE    TO ASTRTITH                    08380004
083900             MOVE DP015-RED        TO ASTRTITC                    08390004
084000             MOVE DP015-UNP-NUM-BRT-MDT                           08400004
084100                                   TO ASTRTITA                    08410004
084200             SET DP020-MSG-FATAL   TO TRUE                        08420004
084300             SET PS-ERROR          TO TRUE                        08430004
084400         END-IF                                                   08440004
084500     END-IF.                                                      08450004
084600 EJECT                                                            08460004
084700                                                                  08470004
084800*----------------------------------------------------------------*08480004
084900*    GET THE NEXT MESSAGE IF A LIST OF MESSAGES IS BEING         *08490004
085000*    PROCESSED.                                                  *08500004
085100*----------------------------------------------------------------*08510004
085200                                                                  08520004
085300 2140-GET-NEXT-RECORD.                                            08530004
085400                                                                  08540004
085500     ADD +1                       TO ASC-SEL-SUB.                 08550004
085600     IF  ASC-SEL-SUB > RC013-MAX-ITEMS                            08560004
085700         ADD +1                   TO ASC-SEL-ITEM                 08570004
085800         MOVE +1                  TO ASC-SEL-SUB                  08580004
085900     END-IF.                                                      08590004
086000     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                08600004
086100         PERFORM 9100-READ-SEL-QUEUE                              08610004
086200         IF  RC013-ITEM (ASC-SEL-SUB) > ZERO                      08620004
086300             MOVE RC013-SHIPT-ID (ASC-SEL-SUB)                    08630004
086400                                  TO ASC-KEY-SHIPT-ID             08640004
086500                                     DK-SHIPT-ID                  08650004
086600             MOVE RC013-PO-NBR   (ASC-SEL-SUB)                    08660004
086700                               TO ASC-KEY-PO-NBR                  08670004
086800                                  DK-PO-NBR                       08680004
086900             SET RC013-INQ (ASC-SEL-SUB) TO TRUE                  08690004
087000             PERFORM 9200-REWRITE-SEL-QUEUE                       08700004
087100         ELSE                                                     08710004
087200             SUBTRACT +1 FROM ASC-SEL-SUB                         08720004
087300             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             08730004
087400             SET DP020-MSG-INFORMATIONAL TO TRUE                  08740004
087500             SET PS-LIST-END             TO TRUE                  08750004
087600         END-IF                                                   08760004
087700     ELSE                                                         08770004
087800         SUBTRACT +1 FROM ASC-SEL-ITEM                            08780004
087900         MOVE RC013-MAX-ITEMS     TO ASC-SEL-SUB                  08790004
088000         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             08800004
088100         SET DP020-MSG-INFORMATIONAL TO TRUE                      08810004
088200         SET PS-LIST-END             TO TRUE                      08820004
088300     END-IF.                                                      08830004
088400                                                                  08840004
088500*----------------------------------------------------------------*08850004
088600*    GET THE PREVIOUS MESSAGE IF A LIST OF MESSAGES IS BEING     *08860004
088700*    PROCESSED.                                                  *08870004
088800*----------------------------------------------------------------*08880004
088900                                                                  08890004
089000 2150-GET-PREV-RECORD.                                            08900004
089100                                                                  08910004
089200     SUBTRACT +1 FROM ASC-SEL-SUB.                                08920004
089300     IF  ASC-SEL-SUB < +1                                         08930004
089400         SUBTRACT +1 FROM ASC-SEL-ITEM                            08940004
089500         MOVE RC013-MAX-ITEMS     TO ASC-SEL-SUB                  08950004
089600     END-IF.                                                      08960004
089700                                                                  08970004
089800     IF  ASC-SEL-ITEM > ZERO                                      08980004
089900         PERFORM 9100-READ-SEL-QUEUE                              08990004
090000         MOVE RC013-SHIPT-ID (ASC-SEL-SUB)                        09000004
090100                                  TO ASC-KEY-SHIPT-ID             09010004
090200                                     DK-SHIPT-ID                  09020004
090300     ELSE                                                         09030004
090400         MOVE +1                  TO ASC-SEL-ITEM                 09040004
090500                                     ASC-SEL-SUB                  09050004
090600         MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             09060004
090700         SET DP020-MSG-INFORMATIONAL TO TRUE                      09070004
090800         SET PS-LIST-END             TO TRUE                      09080004
090900     END-IF.                                                      09090004
091000                                                                  09100004
091100 EJECT                                                            09110004
091200*----------------------------------------------------------------*09120004
091300*    RESET ATTRIBUTES.                                           *09130004
091400*----------------------------------------------------------------*09140004
091500                                                                  09150004
091600 3200-RESET-ATTRIBUTES.                                           09160004
091700                                                                  09170004
091800     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   09180004
091900     MOVE DP015-GREEN              TO ASTRTITC.                   09190004
092000     MOVE DP015-UNDERLINE          TO ASTRTITH.                   09200004
092100     MOVE -1                       TO ASTRTITL.                   09210004
092200     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       09220004
092300                                                                  09230004
092400 EJECT                                                            09240004
092500                                                                  09250004
092600*----------------------------------------------------------------*09260004
092700*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *09270004
092800*    INITIALIZE ALL COUNTERS AND FLAGS.                          *09280004
092900*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *09290004
093000*    DISPLAY THE PANEL TO USER.                                  *09300004
093100*----------------------------------------------------------------*09310004
093200                                                                  09320004
093300 4000-BUILD-INITIAL-PANEL.                                        09330004
093400                                                                  09340004
093500     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            09350004
093600                                 ASC-BLOCK-ENTRIES (2).           09360004
093700     MOVE +1                 TO  ASC-BLK-SUB.                     09370004
093800     SET ASC-ITEMS-LEFT-ON-DB                                     09380004
093900                             TO  TRUE.                            09390004
094000                                                                  09400004
094100     MOVE +0                 TO  ASC-ITEM-SUB                     09410004
094200                                 ASC-NUMBER-OF-ITEMS-READ         09420004
094300                                 ASC-NUMBER-OF-SELECTED-ITEMS     09430004
094400                                 ASC-HIGHEST-BLOCK-WRITTEN        09440004
094500                                 ASC-START-OF-SELECTED-RANGE      09450004
094600                                 ASC-END-OF-SELECTED-RANGE        09460004
094700                                 ASC-ITEM-AT-TOP-OF-PANEL.        09470004
094800                                                                  09480004
094900     MOVE SPACE              TO  ASC-DESC-LINE-IND                09490004
095000                                 ASC-CORR-LINE-IND.               09500004
095100                                                                  09510004
095200     PERFORM 4010-OPEN-CURSOR.                                    09520004
095300                                                                  09530004
095400     PERFORM 4300-READ-ITEMS-FROM-DB.                             09540004
095500                                                                  09550004
095600     PERFORM 4020-CLOSE-CURSOR.                                   09560004
095700                                                                  09570004
095800     MOVE +1                 TO  PV-TOP-ITEM.                     09580004
095900     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          09590004
096000         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    09600004
096100         SET DP020-MSG-FATAL   TO  TRUE                           09610004
096200         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               09620004
096300     ELSE                                                         09630004
096400         MOVE -1             TO ASTRTITL                          09640004
096500         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      09650004
096600         PERFORM 6000-SELECT-TSHPTPO                              09660004
096700         IF SQLCODE = 0                                           09670004
096800             PERFORM 7000-SELECT-USER-INFO                        09680004
096900         END-IF                                                   09690004
097000         PERFORM 8000-SELECT-TSHIPMT                              09700004
097100         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     09710004
097200     END-IF.                                                      09720004
097300 EJECT                                                            09730004
097400*----------------------------------------------------------------*09740004
097500* OPEN THE CURSOR.                                               *09750004
097600*----------------------------------------------------------------*09760004
097700                                                                  09770004
097800 4010-OPEN-CURSOR.                                                09780004
097900                                                                  09790004
098000     EXEC SQL                                                     09800004
098100          OPEN AUSHPO-CSR                                         09810004
098200     END-EXEC.                                                    09820004
098300                                                                  09830004
098400     EVALUATE TRUE                                                09840004
098500         WHEN SQLCODE = ZERO                                      09850004
098600              CONTINUE                                            09860004
098700         WHEN SQLWARN0 NOT EQUAL SPACE                            09870004
098800         WHEN SQLCODE NOT EQUAL ZERO                              09880004
098900              MOVE '4010-OPEN-CURSOR'                             09890004
099000                           TO  DP013-PARAGRAPH                    09900004
099100              MOVE 'OPEN MESSAGE CURSOR'                          09910004
099200                           TO  DP013-MESSAGE-TEXT (1)             09920004
099300              MOVE SQLCA   TO  DP013-SQLCA                        09930004
099400              SET DP013-DB2-ABEND                                 09940004
099500                           TO  TRUE                               09950004
099600              PERFORM DP013-0000-PROCESS-ABEND                    09960004
099700     END-EVALUATE.                                                09970004
099800                                                                  09980004
099900 EJECT                                                            09990004
100000*----------------------------------------------------------------*10000004
100100* CLOSE THE CURSOR.                                              *10010004
100200*----------------------------------------------------------------*10020004
100300                                                                  10030004
100400 4020-CLOSE-CURSOR.                                               10040004
100500                                                                  10050004
100600     EXEC SQL                                                     10060004
100700         CLOSE AUSHPO-CSR                                         10070004
100800     END-EXEC.                                                    10080004
100900                                                                  10090004
101000     EVALUATE TRUE                                                10100004
101100         WHEN SQLCODE = ZERO                                      10110004
101200              CONTINUE                                            10120004
101300         WHEN SQLWARN0 NOT EQUAL SPACE                            10130004
101400         WHEN SQLCODE NOT EQUAL ZERO                              10140004
101500              MOVE '4020-CLOSE-CURSOR'                            10150004
101600                           TO  DP013-PARAGRAPH                    10160004
101700              MOVE 'CLOSE MESSAGE CURSOR'                         10170004
101800                           TO  DP013-MESSAGE-TEXT (1)             10180004
101900              MOVE SQLCA   TO  DP013-SQLCA                        10190004
102000              SET DP013-DB2-ABEND                                 10200004
102100                           TO  TRUE                               10210004
102200              PERFORM DP013-0000-PROCESS-ABEND                    10220004
102300     END-EVALUATE.                                                10230004
102400                                                                  10240004
102500 EJECT                                                            10250004
102600*----------------------------------------------------------------*10260004
102700*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *10270004
102800*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *10280004
102900*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *10290004
103000*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *10300004
103100*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *10310004
103200*                                                                *10320004
103300*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *10330004
103400*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *10340004
103500*    UPON INITIALIZATION.                                        *10350004
103600*----------------------------------------------------------------*10360004
103700                                                                  10370004
103800 4300-READ-ITEMS-FROM-DB.                                         10380004
103900                                                                  10390004
104000     PERFORM                                                      10400004
104100         VARYING PV-READ-COUNT                                    10410004
104200         FROM 1 BY 1                                              10420004
104300         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    10430004
104400            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         10440004
104500                                                                  10450004
104600         PERFORM 4310-FETCH                                       10460004
104700                                                                  10470004
104800         IF  ASC-ITEMS-LEFT-ON-DB                                 10480004
104900             PERFORM 4320-GET-SUB                                 10490004
105000             MOVE AUSHPO-LAST-UPD-DTE                             10500004
105100                               TO  PV-DB2-DATE                    10510004
105200             IF PV-DB2-DATE = PC-DEFAULT-DATE                     10520004
105300                 MOVE SPACES   TO  ASC-CONFIRM-DATE               10530004
105400                                       (ASC-BLK-SUB               10540004
105500                                        ASC-ITEM-SUB)             10550004
105600             ELSE                                                 10560004
105700                 STRING  PV-DB2-DATE-MM DELIMITED BY SIZE         10570004
105800                     '/' DELIMITED BY SIZE                        10580004
105900                     PV-DB2-DATE-DD DELIMITED BY SIZE             10590004
106000                             INTO  ASC-CONFIRM-DATE               10600004
106100                                       (ASC-BLK-SUB               10610004
106200                                        ASC-ITEM-SUB)             10620004
106300             END-IF                                               10630004
106400             MOVE AUSHPO-LAST-UPD-TIME                            10640004
106500                               TO  PV-DB2-TIME                    10650004
106600             IF PV-DB2-TIME = PC-DEFAULT-TIME                     10660004
106700                 MOVE SPACES   TO  ASC-CONFIRM-TIME               10670004
106800                                       (ASC-BLK-SUB               10680004
106900                                        ASC-ITEM-SUB)             10690004
107000             ELSE                                                 10700004
107100                 STRING  PV-DB2-TIME-HH DELIMITED BY SIZE         10710004
107200                     ':' DELIMITED BY SIZE                        10720004
107300                     PV-DB2-TIME-MM DELIMITED BY SIZE             10730004
107400                             INTO  ASC-CONFIRM-TIME               10740004
107500                                       (ASC-BLK-SUB               10750004
107600                                        ASC-ITEM-SUB)             10760004
107700             END-IF                                               10770004
107800             MOVE AUSHPO-LAST-UPD-USER-ID                         10780004
107900                               TO  ASC-USER-ID                    10790004
108000                                       (ASC-BLK-SUB               10800004
108100                                        ASC-ITEM-SUB)             10810004
108200             MOVE AUSHPO-EXPTED-CART-CNT                          10820004
108300                               TO ASC-CONFIRM-EXP-CTN             10830004
108400                                       (ASC-BLK-SUB               10840004
108500                                        ASC-ITEM-SUB)             10850004
108600             MOVE AUSHPO-ACTL-CART-CNT                            10860004
108700                               TO ASC-CONFIRM-ADJ-CTN             10870004
108800                                       (ASC-BLK-SUB               10880004
108900                                        ASC-ITEM-SUB)             10890004
109000             MOVE AUSHPO-DMG-CART-CNT                             10900004
109100                               TO ASC-CONFIRM-DMG-CTN             10910004
109200                                       (ASC-BLK-SUB               10920004
109300                                        ASC-ITEM-SUB)             10930004
109400             MOVE AUSHPO-CARR-CART-CT                             10940004
109500                               TO  ASC-FORECAST-CARTON            10950004
109600                                       (ASC-BLK-SUB               10960004
109700                                        ASC-ITEM-SUB)             10970004
109800             MOVE AUSHPO-CARR-LAST-UPD-DTE                        10980004
109900                               TO  PV-DB2-DATE                    10990004
110000             IF PV-DB2-DATE = PC-DEFAULT-DATE                     11000004
110100                 MOVE SPACES   TO  ASC-FORECAST-DATE              11010004
110200                                       (ASC-BLK-SUB               11020004
110300                                        ASC-ITEM-SUB)             11030004
110400             ELSE                                                 11040004
110500                 STRING  PV-DB2-DATE-MM DELIMITED BY SIZE         11050004
110600                     '/' DELIMITED BY SIZE                        11060004
110700                     PV-DB2-DATE-DD DELIMITED BY SIZE             11070004
110800                             INTO  ASC-FORECAST-DATE              11080004
110900                                       (ASC-BLK-SUB               11090004
111000                                        ASC-ITEM-SUB)             11100004
111100             END-IF                                               11110004
111200             MOVE AUSHPO-CARR-LAST-UPD-TIME                       11120004
111300                               TO  PV-DB2-TIME                    11130004
111400             IF PV-DB2-TIME = PC-DEFAULT-TIME                     11140004
111500                 MOVE SPACES   TO  ASC-FORECAST-TIME              11150004
111600                                       (ASC-BLK-SUB               11160004
111700                                        ASC-ITEM-SUB)             11170004
111800             ELSE                                                 11180004
111900                 STRING  PV-DB2-TIME-HH DELIMITED BY SIZE         11190004
112000                     ':' DELIMITED BY SIZE                        11200004
112100                     PV-DB2-TIME-MM DELIMITED BY SIZE             11210004
112200                             INTO  ASC-FORECAST-TIME              11220004
112300                                       (ASC-BLK-SUB               11230004
112400                                        ASC-ITEM-SUB)             11240004
112500             END-IF                                               11250004
112600             MOVE AUSHPO-VEND-CART-CT                             11260004
112700                               TO  ASC-ASN-CARTON                 11270004
112800                                       (ASC-BLK-SUB               11280004
112900                                        ASC-ITEM-SUB)             11290004
113000             MOVE AUSHPO-VEND-LAST-UPD-DTE                        11300004
113100                               TO  PV-DB2-DATE                    11310004
113200             IF PV-DB2-DATE = PC-DEFAULT-DATE                     11320004
113300                 MOVE SPACES   TO  ASC-ASN-DATE                   11330004
113400                                       (ASC-BLK-SUB               11340004
113500                                        ASC-ITEM-SUB)             11350004
113600             ELSE                                                 11360004
113700                 STRING  PV-DB2-DATE-MM DELIMITED BY SIZE         11370004
113800                     '/' DELIMITED BY SIZE                        11380004
113900                     PV-DB2-DATE-DD DELIMITED BY SIZE             11390004
114000                             INTO  ASC-ASN-DATE                   11400004
114100                                       (ASC-BLK-SUB               11410004
114200                                        ASC-ITEM-SUB)             11420004
114300             END-IF                                               11430004
114400             MOVE AUSHPO-VEND-LAST-UPD-TIME                       11440004
114500                               TO  PV-DB2-TIME                    11450004
114600             IF PV-DB2-TIME = PC-DEFAULT-TIME                     11460004
114700                 MOVE SPACES   TO  ASC-ASN-TIME                   11470004
114800                                       (ASC-BLK-SUB               11480004
114900                                        ASC-ITEM-SUB)             11490004
115000             ELSE                                                 11500004
115100                 STRING  PV-DB2-TIME-HH DELIMITED BY SIZE         11510004
115200                     ':' DELIMITED BY SIZE                        11520004
115300                     PV-DB2-TIME-MM DELIMITED BY SIZE             11530004
115400                             INTO  ASC-ASN-TIME                   11540004
115500                                       (ASC-BLK-SUB               11550004
115600                                        ASC-ITEM-SUB)             11560004
115700             END-IF                                               11570004
115800             MOVE AUSHPO-PKSL-IND                                 11580004
115900                               TO  ASC-STATUS                     11590004
116000                                       (ASC-BLK-SUB               11600004
116100                                        ASC-ITEM-SUB)             11610004
116200         END-IF                                                   11620004
116300     END-PERFORM.                                                 11630004
116400                                                                  11640004
116500     IF ASC-NUMBER-OF-ITEMS-READ > ZERO                           11650004
116600         MOVE +1                 TO ASC-BLK-SUB                   11660004
116700                                                                  11670004
116800         PERFORM 5100-WRITE-TEMP-STORAGE                          11680004
116900                                                                  11690004
117000         ADD +1                  TO ASC-BLK-SUB                   11700004
117100                                                                  11710004
117200         PERFORM 5100-WRITE-TEMP-STORAGE                          11720004
117300                                                                  11730004
117400         MOVE +1                 TO ASC-BLK-SUB                   11740004
117500                                    PV-BLOCK-NUMBER               11750004
117600                                                                  11760004
117700         PERFORM 4410-READ-TEMP-STORAGE                           11770004
117800                                                                  11780004
117900         IF ASC-HIGHEST-BLOCK-WRITTEN > 1                         11790004
118000             MOVE +2             TO ASC-BLK-SUB                   11800004
118100                                    PV-BLOCK-NUMBER               11810004
118200                                                                  11820004
118300             PERFORM 4410-READ-TEMP-STORAGE                       11830004
118400         END-IF                                                   11840004
118500     END-IF.                                                      11850004
118600                                                                  11860004
118700                                                                  11870004
118800 EJECT                                                            11880004
118900*----------------------------------------------------------------*11890004
119000*    FETCH THE TEXT CURSOR.                                      *11900004
119100*----------------------------------------------------------------*11910004
119200                                                                  11920004
119300 4310-FETCH.                                                      11930004
119400                                                                  11940004
119500     PERFORM                                                      11950004
119600         WITH TEST AFTER                                          11960004
119700         VARYING PV-SQL-SUB                                       11970004
119800         FROM 1 BY 1                                              11980004
119900         UNTIL PV-SQL-SUB GREATER THAN PC-MAX-RETRIES             11990004
120000            OR SQLCODE = 0                                        12000004
120100            OR SQLCODE = +100                                     12010004
120200                                                                  12020004
120300         EXEC SQL                                                 12030004
120400              FETCH AUSHPO-CSR                                    12040004
120500              INTO  :AUSHPO-EXPTED-CART-CNT                       12050004
120600                   ,:AUSHPO-ACTL-CART-CNT                         12060004
120700                   ,:AUSHPO-DMG-CART-CNT                          12070004
120800                   ,:AUSHPO-PKSL-IND                              12080004
120900                   ,:AUSHPO-CARR-CART-CT                          12090004
121000                   ,:AUSHPO-CARR-LAST-UPD-DTE                     12100004
121100                   ,:AUSHPO-CARR-LAST-UPD-TIME                    12110004
121200                   ,:AUSHPO-VEND-CART-CT                          12120004
121300                   ,:AUSHPO-VEND-LAST-UPD-DTE                     12130004
121400                   ,:AUSHPO-VEND-LAST-UPD-TIME                    12140004
121500                   ,:AUSHPO-LAST-UPD-DTE                          12150004
121600                   ,:AUSHPO-LAST-UPD-TIME                         12160004
121700                   ,:AUSHPO-LAST-UPD-USER-ID                      12170004
121800         END-EXEC                                                 12180004
121900                                                                  12190004
122000         EVALUATE TRUE                                            12200004
122100             WHEN SQLCODE = ZERO                                  12210004
122200             WHEN SQLCODE = +100                                  12220004
122300             WHEN SQLCODE = -904                                  12230004
122400             WHEN SQLCODE = -913                                  12240004
122500                  CONTINUE                                        12250004
122600             WHEN SQLWARN0 NOT EQUAL SPACE                        12260004
122700             WHEN SQLCODE NOT EQUAL ZERO                          12270004
122800                  MOVE '4310-FETCH-CURSOR'                        12280004
122900                               TO  DP013-PARAGRAPH                12290004
123000                  MOVE 'FETCH MESSAGE CURSOR'                     12300004
123100                               TO  DP013-MESSAGE-TEXT (1)         12310004
123200                  MOVE SQLCA   TO  DP013-SQLCA                    12320004
123300                  SET DP013-DB2-ABEND                             12330004
123400                               TO  TRUE                           12340004
123500                  PERFORM DP013-0000-PROCESS-ABEND                12350004
123600         END-EVALUATE                                             12360004
123700     END-PERFORM.                                                 12370004
123800                                                                  12380004
123900     IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                   12390004
124000         MOVE '4310-FETCH-CURSOR'                                 12400004
124100                               TO  DP013-PARAGRAPH                12410004
124200         MOVE 'MAX RETRIES EXCEEDED FOR FETCH CURSOR'             12420004
124300                               TO  DP013-MESSAGE-TEXT (1)         12430004
124400         MOVE SQLCA            TO  DP013-SQLCA                    12440004
124500         SET DP013-DB2-ABEND   TO  TRUE                           12450004
124600         PERFORM DP013-0000-PROCESS-ABEND                         12460004
124700     END-IF.                                                      12470004
124800                                                                  12480004
124900     IF  SQLCODE EQUAL +100                                       12490004
125000         SET ASC-NO-ITEMS-LEFT-ON-DB                              12500004
125100                               TO  TRUE                           12510004
125200     END-IF.                                                      12520004
125300                                                                  12530004
125400 EJECT                                                            12540004
125500*----------------------------------------------------------------*12550004
125600*    GET THE CORRECT SUBSCRIPTS FOR PLACING THE TEXT LINE.       *12560004
125700*----------------------------------------------------------------*12570004
125800                                                                  12580004
125900 4320-GET-SUB.                                                    12590004
126000                                                                  12600004
126100     IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                        12610004
126200         ADD +1            TO  ASC-ITEM-SUB                       12620004
126300     ELSE                                                         12630004
126400         ADD +1            TO  ASC-BLK-SUB                        12640004
126500         MOVE +1           TO  ASC-ITEM-SUB                       12650004
126600                                                                  12660004
126700         IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY                 12670004
126800             MOVE +1       TO  ASC-BLK-SUB                        12680004
126900             PERFORM 5100-WRITE-TEMP-STORAGE                      12690004
127000             MOVE ASC-BLOCK-ENTRIES                               12700004
127100                       (PC-MAX-BLOCKS-IN-ARRAY)                   12710004
127200             TO   ASC-BLOCK-ENTRIES(ASC-BLK-SUB)                  12720004
127300             ADD +1        TO  ASC-BLK-SUB                        12730004
127400             INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)           12740004
127500         END-IF                                                   12750004
127600     END-IF.                                                      12760004
127700                                                                  12770004
127800     ADD +1            TO ASC-NUMBER-OF-ITEMS-READ.               12780004
127900     MOVE ASC-NUMBER-OF-ITEMS-READ TO ASC-LIST-ITEM-NUMBER        12790004
128000                                      (ASC-BLK-SUB                12800004
128100                                       ASC-ITEM-SUB).             12810004
128200                                                                  12820004
128300*----------------------------------------------------------------*12830004
128400*    FORMAT THE MAP AND DETERMINE THE CURSOR POSITION.           *12840004
128500*----------------------------------------------------------------*12850004
128600                                                                  12860004
128700 4400-MOVE-COMMAREA-TO-SCREEN.                                    12870004
128800                                                                  12880004
128900     MOVE ASC-KEY-PO-NBR         TO APOO.                         12890004
129000*    MOVE ASC-KEY-PO-DESC        TO APODSCO.                      12900004
129100     MOVE ASC-KEY-PRO-SCAC-ID    TO AOWSCACO.                     12910004
129200     MOVE ASC-KEY-LAST-UPD-UID   TO AUPDUIDO.                     12920004
129300     MOVE ASC-KEY-USER-NAME      TO AUPDNMEO.                     12930004
129400     MOVE ASC-KEY-PRO-NBR        TO AFBO.                         12940004
129500     MOVE ASC-KEY-BOL-NBR        TO ABOLO.                        12950004
129600                                                                  12960004
129700     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             12970004
129800         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          12980004
129900         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          12990004
130000             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             13000004
130100                 GIVING PV-BLOCK-NUMBER                           13010004
130200                 REMAINDER PV-REMAINDER                           13020004
130300             IF  PV-REMAINDER > ZERO                              13030004
130400                 ADD +1 TO PV-BLOCK-NUMBER                        13040004
130500             END-IF                                               13050004
130600             MOVE +1    TO ASC-BLK-SUB                            13060004
130700             PERFORM 4410-READ-TEMP-STORAGE                       13070004
130800             ADD +1     TO ASC-BLK-SUB                            13080004
130900                           PV-BLOCK-NUMBER                        13090004
131000             PERFORM 4410-READ-TEMP-STORAGE                       13100004
131100     END-IF.                                                      13110004
131200     MOVE +1                       TO ASC-BLK-SUB.                13120004
131300     COMPUTE ASC-ITEM-SUB =                                       13130004
131400         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              13140004
131500         + PC-ITEMS-PER-PANEL).                                   13150004
131600                                                                  13160004
131700     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        13170004
131800         ADD +1   TO ASC-BLK-SUB                                  13180004
131900         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            13190004
132000     END-IF.                                                      13200004
132100                                                                  13210004
132200     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           13220004
132300         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                13230004
132400     PERFORM 4420-FORMAT-LIST-LINES                               13240004
132500         VARYING PS-SUB                                           13250004
132600         FROM PC-ITEMS-PER-PANEL BY -1                            13260004
132700         UNTIL PS-SUB < +1.                                       13270004
132800                                                                  13280004
132900     COMPUTE ASC-ITEMS-DISPLAYED =                                13290004
133000         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          13300004
133100     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    13310004
133200                                      ASTRTITO.                   13320004
133300     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    13330004
133400     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    13340004
133500                                                                  13350004
133600     IF  DP020-MSG-NUMBER-X = SPACE                               13360004
133700         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  13370004
133800*            --- MORE ITEMS TO DISPLAY ----                       13380004
133900             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            13390004
134000             SET DP020-MSG-INFORMATIONAL TO TRUE                  13400004
134100         END-IF                                                   13410004
134200     END-IF.                                                      13420004
134300                                                                  13430004
134400*----------------------------------------------------------------*13440004
134500*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *13450004
134600*----------------------------------------------------------------*13460004
134700                                                                  13470004
134800 4410-READ-TEMP-STORAGE.                                          13480004
134900                                                                  13490004
135000     EXEC CICS                                                    13500004
135100         READQ TS                                                 13510004
135200             QUEUE (ASC-DTL-QUEUE-NAME)                           13520004
135300             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               13530004
135400             ITEM  (PV-BLOCK-NUMBER)                              13540004
135500             RESP  (PV-CICS-RESP)                                 13550004
135600     END-EXEC.                                                    13560004
135700                                                                  13570004
135800     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       13580004
135900       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     13590004
136000         CONTINUE                                                 13600004
136100     ELSE                                                         13610004
136200         SET DP013-CICS-ABEND TO  TRUE                            13620004
136300         SET DP013-NO-ROLLBACK TO  TRUE                           13630004
136400         MOVE '4410-READ-TEMP-STORAGE'                            13640004
136500                               TO  DP013-PARAGRAPH                13650004
136600         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      13660004
136700                               TO  DP013-MESSAGE-TEXT(1)          13670004
136800         PERFORM DP013-0000-PROCESS-ABEND                         13680004
136900     END-IF.                                                      13690004
137000                                                                  13700004
137100*    SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             13710004
137200                                                                  13720004
137300     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         13730004
137400         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               13740004
137500     END-IF.                                                      13750004
137600 EJECT                                                            13760004
137700*----------------------------------------------------------------*13770004
137800*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *13780004
137900*----------------------------------------------------------------*13790004
138000                                                                  13800004
138100 4420-FORMAT-LIST-LINES.                                          13810004
138200                                                                  13820004
138300     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      13830004
138400         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                13840004
138500         MOVE SPACE              TO MR-STATUS       (PS-SUB)      13850004
138600                                    MR-ASN-CARTON-X (PS-SUB)      13860004
138700                                    MR-ASN-DATE     (PS-SUB)      13870004
138800                                    MR-ASN-TIME     (PS-SUB)      13880004
138900                                    MR-FOR-CARTON-X (PS-SUB)      13890004
139000                                    MR-FOR-DATE     (PS-SUB)      13900004
139100                                    MR-FOR-TIME     (PS-SUB)      13910004
139200                                    MR-CON-EXP-CTN-X (PS-SUB)     13920004
139300                                    MR-CON-ADJ-CTN-X (PS-SUB)     13930004
139400                                    MR-CON-DMG-CTN-X (PS-SUB)     13940004
139500                                    MR-CON-DATE     (PS-SUB)      13950004
139600                                    MR-CON-TIME     (PS-SUB)      13960004
139700                                    MR-USER-ID      (PS-SUB)      13970004
139800     ELSE                                                         13980004
139900         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           13990004
140000             MOVE ASC-STATUS          (ASC-BLK-SUB ASC-ITEM-SUB)  14000004
140100                                 TO MR-STATUS     (PS-SUB)        14010004
140200             MOVE ASC-ASN-CARTON      (ASC-BLK-SUB ASC-ITEM-SUB)  14020004
140300                                 TO MR-ASN-CARTON (PS-SUB)        14030004
140400             MOVE ASC-ASN-DATE        (ASC-BLK-SUB ASC-ITEM-SUB)  14040004
140500                                 TO MR-ASN-DATE   (PS-SUB)        14050004
140600             MOVE ASC-ASN-TIME        (ASC-BLK-SUB ASC-ITEM-SUB)  14060004
140700                                 TO MR-ASN-TIME   (PS-SUB)        14070004
140800             MOVE ASC-FORECAST-CARTON (ASC-BLK-SUB ASC-ITEM-SUB)  14080004
140900                                 TO MR-FOR-CARTON (PS-SUB)        14090004
141000             MOVE ASC-FORECAST-DATE   (ASC-BLK-SUB ASC-ITEM-SUB)  14100004
141100                                 TO MR-FOR-DATE   (PS-SUB)        14110004
141200             MOVE ASC-FORECAST-TIME   (ASC-BLK-SUB ASC-ITEM-SUB)  14120004
141300                                 TO MR-FOR-TIME   (PS-SUB)        14130004
141400             MOVE ASC-CONFIRM-EXP-CTN (ASC-BLK-SUB ASC-ITEM-SUB)  14140004
141500                                 TO MR-CON-EXP-CTN   (PS-SUB)     14150004
141600             MOVE ASC-CONFIRM-ADJ-CTN (ASC-BLK-SUB ASC-ITEM-SUB)  14160004
141700                                 TO MR-CON-ADJ-CTN   (PS-SUB)     14170004
141800             MOVE ASC-CONFIRM-DMG-CTN (ASC-BLK-SUB ASC-ITEM-SUB)  14180004
141900                                 TO MR-CON-DMG-CTN   (PS-SUB)     14190004
142000             MOVE ASC-CONFIRM-DATE    (ASC-BLK-SUB ASC-ITEM-SUB)  14200004
142100                                 TO MR-CON-DATE   (PS-SUB)        14210004
142200             MOVE ASC-CONFIRM-TIME    (ASC-BLK-SUB ASC-ITEM-SUB)  14220004
142300                                 TO MR-CON-TIME   (PS-SUB)        14230004
142400             MOVE ASC-USER-ID         (ASC-BLK-SUB ASC-ITEM-SUB)  14240004
142500                                 TO MR-USER-ID    (PS-SUB)        14250004
142600         END-IF                                                   14260004
142700     END-IF.                                                      14270004
142800     SUBTRACT +1 FROM ASC-ITEM-SUB.                               14280004
142900     IF  ASC-ITEM-SUB < + 1                                       14290004
143000         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  14300004
143100         MOVE +1                 TO ASC-BLK-SUB                   14310004
143200     END-IF.                                                      14320004
143300                                                                  14330004
143400*----------------------------------------------------------------*14340004
143500*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *14350004
143600*----------------------------------------------------------------*14360004
143700                                                                  14370004
143800 5100-WRITE-TEMP-STORAGE.                                         14380004
143900                                                                  14390004
144000     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     14400004
144100                               TO  PV-LIST-ITEM-NUMBER.           14410004
144200     COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                           14420004
144300         ASC-HIGHEST-BLOCK-WRITTEN + 1.                           14430004
144400                                                                  14440004
144500     EXEC CICS                                                    14450004
144600         WRITEQ TS                                                14460004
144700             QUEUE (ASC-DTL-QUEUE-NAME)                           14470004
144800             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               14480004
144900             ITEM  (PV-HIGHEST-BLOCK-WRITTEN)                     14490004
145000             RESP  (PV-CICS-RESP)                                 14500004
145100     END-EXEC.                                                    14510004
145200                                                                  14520004
145300     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      14530004
145400         SET DP013-CICS-ABEND                                     14540004
145500                       TO  TRUE                                   14550004
145600         SET DP013-NO-ROLLBACK                                    14560004
145700                       TO  TRUE                                   14570004
145800         MOVE '5100-WRITE-TEMP-STORAGE'                           14580004
145900                       TO  DP013-PARAGRAPH                        14590004
146000         MOVE 'ATTEMPTING TO WRITE TEMP STORAGE LIST BLOCK'       14600004
146100                       TO  DP013-MESSAGE-TEXT(1)                  14610004
146200         PERFORM DP013-0000-PROCESS-ABEND                         14620004
146300     END-IF.                                                      14630004
146400     ADD +1            TO  ASC-HIGHEST-BLOCK-WRITTEN.             14640004
146500                                                                  14650004
146600 EJECT                                                            14660004
146700*----------------------------------------------------------------*14670004
146800* READ AN CURRENT SHIPMENT ROW FROM THE TSHPTPO TABLE.           *14680004
146900*----------------------------------------------------------------*14690004
147000                                                                  14700004
147100 6000-SELECT-TSHPTPO.                                             14710004
147200     PERFORM                                                      14720004
147300         WITH TEST AFTER                                          14730004
147400         VARYING PV-RETRY-COUNTER                                 14740004
147500         FROM 1 BY 1                                              14750004
147600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               14760004
147700             OR (SQLCODE = +0))                                   14770004
147800                                                                  14780004
147900         EXEC SQL                                                 14790004
148000             SELECT  LAST_UPD_USER_ID                             14800004
148100            INTO     :SHPTPO-LAST-UPD-USER-ID                     14810004
148200           FROM   TSHPTPO                                         14820004
148300           WHERE  PO_NBR   = :DK-PO-NBR                           14830004
148400             AND  SHIPT_ID = :DK-SHIPT-ID                         14840004
148500         END-EXEC                                                 14850004
148600                                                                  14860004
148700         EVALUATE TRUE                                            14870004
148800             WHEN SQLCODE = +0                                    14880004
148900             WHEN SQLCODE = -904                                  14890004
149000             WHEN SQLCODE = -913                                  14900004
149100                 CONTINUE                                         14910004
149200                                                                  14920004
149300             WHEN SQLWARN0 NOT = SPACES                           14930004
149400             WHEN SQLCODE < +0                                    14940004
149500             WHEN SQLCODE > +0                                    14950004
149600                 MOVE '6000-SELECT-TSHPTPO'                       14960004
149700                                   TO DP013-PARAGRAPH             14970004
149800                 MOVE 'SELECT A TSHPTPO ROW   '                   14980004
149900                                   TO DP013-MESSAGE-TEXT(1)       14990004
150000                 MOVE SQLCA        TO DP013-SQLCA                 15000004
150100                 MOVE 'TSHPTPO'    TO DP013-DB2-TABLE-NAME (1)    15010004
150200                 SET DP013-DB2-ABEND                              15020004
150300                     DP013-XCTL-DISPLAY-RESTART TO TRUE           15030004
150400                 PERFORM DP013-0000-PROCESS-ABEND                 15040004
150500         END-EVALUATE                                             15050004
150600     END-PERFORM.                                                 15060004
150700                                                                  15070004
150800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        15080004
150900         MOVE '6000-SELECT-TSHPTPO '                              15090004
151000                                   TO DP013-PARAGRAPH             15100004
151100         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              15110004
151200                                   TO DP013-MESSAGE-TEXT (1)      15120004
151300         MOVE 'TO SELECT A TSHPTPO ROW'                           15130004
151400                                   TO DP013-MESSAGE-TEXT (2)      15140004
151500         MOVE SQLCA                TO DP013-SQLCA                 15150004
151600         MOVE 'TSHPTPO'            TO DP013-DB2-TABLE-NAME (1)    15160004
151700         SET DP013-DB2-ABEND                                      15170004
151800             DP013-XCTL-DISPLAY-RESTART                           15180004
151900                                   TO TRUE                        15190004
152000         PERFORM DP013-0000-PROCESS-ABEND                         15200004
152100     END-IF.                                                      15210004
152200     IF SQLCODE = +0                                              15220004
152300         MOVE SHPTPO-LAST-UPD-USER-ID                             15230004
152400                                   TO ASC-KEY-LAST-UPD-UID        15240004
152500     END-IF.                                                      15250004
152600                                                                  15260004
152700 EJECT                                                            15270004
152800*----------------------------------------------------------------*15280004
152900* CALL XLKUT067 TO OBTAIN THE USER NAME IN PROPER FORMAT         *15290004
153000*----------------------------------------------------------------*15300004
153100                                                                  15310004
153200 7000-SELECT-USER-INFO.                                           15320004
153300     INITIALIZE XL067-USER-COMMAREA.                              15330004
153400                                                                  15340004
153500     SET XL067-BY-USER-ID                                         15350004
153600         XL067-SELECT-KOHLS-USER TO TRUE                          15360004
153700     MOVE ASC-KEY-LAST-UPD-UID   TO XL067-KEY-USER-ID             15370004
153800                                                                  15380004
153900     CALL XL067-USER-PGM USING DFHEIBLK                           15390004
154000                               XL067-COMMAREA                     15400004
154100                               XL067-USER-COMMAREA.               15410004
154200                                                                  15420004
154300     EVALUATE TRUE                                                15430004
154400         WHEN XL067-SUCCESSFUL                                    15440004
154500             MOVE SPACES TO ASC-KEY-USER-NAME                     15450004
154600             MOVE XL067-COMBINED-NAME-2 TO ASC-KEY-USER-NAME      15460004
154700         WHEN XL067-KOHLS-NOT-FOUND                               15470004
154800         WHEN XL067-KOHLS-CONTENTION                              15480004
154900             MOVE SPACES TO ASC-KEY-USER-NAME                     15490004
155000             MOVE SPACES TO ASC-KEY-LAST-UPD-UID                  15500004
155100         WHEN OTHER                                               15510004
155200             MOVE '7000-SELECT-USER-INFO' TO DP013-PARAGRAPH      15520004
155300             MOVE 'CALL XLKUT067 '  TO DP013-MESSAGE-TEXT(1)      15530004
155400             STRING 'USER ID:  '      DELIMITED BY SIZE           15540004
155500                    XL067-KEY-USER-ID DELIMITED BY SIZE           15550004
155600                                 INTO DP013-MESSAGE-TEXT(2)       15560004
155700             MOVE XL067-SQLCA       TO DP013-SQLCA                15570004
155800             MOVE 'XLT_USR'         TO DP013-DB2-TABLE-NAME (1)   15580004
155900             SET DP013-DB2-ABEND                                  15590004
156000                 DP013-XCTL-DISPLAY-RESTART TO TRUE               15600004
156100                 PERFORM DP013-0000-PROCESS-ABEND                 15610004
156200     END-EVALUATE.                                                15620004
156300                                                                  15630004
156400 EJECT                                                            15640004
156500*----------------------------------------------------------------*15650004
156600* READ AN CURRENT SHIPMENT ROW FROM THE TSHIPMT TABLE.           *15660004
156700*----------------------------------------------------------------*15670004
156800                                                                  15680004
156900 8000-SELECT-TSHIPMT.                                             15690004
157000     PERFORM                                                      15700004
157100         WITH TEST AFTER                                          15710004
157200         VARYING PV-RETRY-COUNTER                                 15720004
157300         FROM 1 BY 1                                              15730004
157400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               15740004
157500             OR (SQLCODE = +0))                                   15750004
157600                                                                  15760004
157700         EXEC SQL                                                 15770004
157800             SELECT  PRO_SCAC_ID                                  15780004
157900                    ,PRO_NBR                                      15790004
158000                    ,BOL_NBR                                      15800004
158100                    ,ORIG_SCAC_ID                                 15810004
158200            INTO     :SHIPMT-PRO-SCAC-ID                          15820004
158300                    ,:SHIPMT-PRO-NBR                              15830004
158400                    ,:SHIPMT-BOL-NBR                              15840004
158500                    ,:SHIPMT-ORIG-SCAC-ID                         15850004
158600           FROM   TSHIPMT                                         15860004
158700           WHERE  SHIPT_ID = :DK-SHIPT-ID                         15870004
158800         END-EXEC                                                 15880004
158900                                                                  15890004
159000         EVALUATE TRUE                                            15900004
159100             WHEN SQLCODE = +0                                    15910004
159200             WHEN SQLCODE = -904                                  15920004
159300             WHEN SQLCODE = -913                                  15930004
159400                 CONTINUE                                         15940004
159500                                                                  15950004
159600             WHEN SQLWARN0 NOT = SPACES                           15960004
159700             WHEN SQLCODE < +0                                    15970004
159800             WHEN SQLCODE > +0                                    15980004
159900                 MOVE '8000-SELECT-TSHIPMT'                       15990004
160000                                   TO DP013-PARAGRAPH             16000004
160100                 MOVE 'SELECT A TSHIPMT ROW   '                   16010004
160200                                   TO DP013-MESSAGE-TEXT(1)       16020004
160300                 MOVE SQLCA        TO DP013-SQLCA                 16030004
160400                 MOVE 'TSHIPMT'    TO DP013-DB2-TABLE-NAME (1)    16040004
160500                 SET DP013-DB2-ABEND                              16050004
160600                     DP013-XCTL-DISPLAY-RESTART TO TRUE           16060004
160700                 PERFORM DP013-0000-PROCESS-ABEND                 16070004
160800         END-EVALUATE                                             16080004
160900     END-PERFORM.                                                 16090004
161000                                                                  16100004
161100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        16110004
161200         MOVE '8000-SELECT-TSHIPMT '                              16120004
161300                                   TO DP013-PARAGRAPH             16130004
161400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING '              16140004
161500                                   TO DP013-MESSAGE-TEXT (1)      16150004
161600         MOVE 'TO SELECT A TSHIPMT ROW'                           16160004
161700                                   TO DP013-MESSAGE-TEXT (2)      16170004
161800         MOVE SQLCA                TO DP013-SQLCA                 16180004
161900         MOVE 'TSHIPMT'            TO DP013-DB2-TABLE-NAME (1)    16190004
162000         SET DP013-DB2-ABEND                                      16200004
162100             DP013-XCTL-DISPLAY-RESTART                           16210004
162200                                   TO TRUE                        16220004
162300         PERFORM DP013-0000-PROCESS-ABEND                         16230004
162400     END-IF.                                                      16240004
162500     IF SQLCODE = +0                                              16250004
162600         MOVE SHIPMT-PRO-SCAC-ID   TO ASC-KEY-PRO-SCAC-ID         16260004
162700         MOVE SHIPMT-PRO-NBR       TO ASC-KEY-PRO-NBR             16270004
162800         MOVE SHIPMT-BOL-NBR       TO ASC-KEY-BOL-NBR             16280004
162900         MOVE SHIPMT-ORIG-SCAC-ID  TO ASC-KEY-ORIG-SCAC-ID        16290004
163000     END-IF.                                                      16300004
163100                                                                  16310004
163200 EJECT                                                            16320004
163300*----------------------------------------------------------------*16330004
163400* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *16340004
163500*----------------------------------------------------------------*16350004
163600                                                                  16360004
163700 9100-READ-SEL-QUEUE.                                             16370004
163800     EXEC CICS                                                    16380004
163900         READQ TS                                                 16390004
164000             QUEUE (ASC-SEL-QUEUE-NAME)                           16400004
164100             INTO  (RC013-DC-SELECT-RECORD)                       16410004
164200             ITEM  (ASC-SEL-ITEM)                                 16420004
164300             RESP  (PV-CICS-RESP)                                 16430004
164400     END-EXEC.                                                    16440004
164500                                                                  16450004
164600     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       16460004
164700         CONTINUE                                                 16470004
164800     ELSE                                                         16480004
164900         SET DP013-LOGIC-ABEND                                    16490004
165000             DP013-NO-ROLLBACK     TO TRUE                        16500004
165100         MOVE '9100-READ-SEL-QUEUE'                               16510004
165200                                   TO DP013-PARAGRAPH             16520004
165300         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   16530004
165400                                   TO DP013-MESSAGE-TEXT (1)      16540004
165500         PERFORM DP013-0000-PROCESS-ABEND                         16550004
165600     END-IF.                                                      16560004
165700*----------------------------------------------------------------*16570004
165800* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *16580004
165900*----------------------------------------------------------------*16590004
166000 9200-REWRITE-SEL-QUEUE.                                          16600004
166100     EXEC CICS                                                    16610004
166200          WRITEQ TS                                               16620004
166300              QUEUE  (ASC-SEL-QUEUE-NAME)                         16630004
166400              FROM   (RC013-DC-SELECT-RECORD)                     16640004
166500              ITEM   (ASC-SEL-ITEM)                               16650004
166600              RESP   (PV-CICS-RESP)                               16660004
166700              REWRITE                                             16670004
166800     END-EXEC.                                                    16680004
166900                                                                  16690004
167000     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   16700004
167100         SET DP013-CICS-ABEND                                     16710004
167200             DP013-NO-ROLLBACK     TO TRUE                        16720004
167300         MOVE '9200-REWRITE-SEL-QUEUE'                            16730004
167400                                   TO DP013-PARAGRAPH             16740004
167500         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   16750004
167600                                   TO DP013-MESSAGE-TEXT (1)      16760004
167700         PERFORM DP013-0000-PROCESS-ABEND                         16770004
167800     END-IF.                                                      16780004
167900                                                                  16790004
168000 EJECT                                                            16800004
168100*----------------------------------------------------------------*16810004
168200*    ABEND PROCESSOR MODULE                                      *16820004
168300*----------------------------------------------------------------*16830004
168400                                                                  16840004
168500     COPY DPPD013.                                                16850004
