000100*-----------------------*                                         00010003
000200 IDENTIFICATION DIVISION.                                         00020003
000300*-----------------------*                                         00030003
000400 PROGRAM-ID.    ETKCS321.                                         00040003
000500 AUTHOR.        TROY BIRK.                                        00050003
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060003
000700 DATE-WRITTEN.  JUNE 1994.                                        00070003
000800 DATE-COMPILED.                                                   00080003
000900                                                                  00090003
001000******************************************************************00100003
001100* PROGRAM NUMBER: ETKCS321       SYSTEM: ET     LANGUAGE: COBOL II00110003
001200*                                                                 00120003
001300* TRANID:  E321   MNEMONIC:  ETLINTXM AND ETLINTMM    MAP: ETKM32100130003
001400*                                                                 00140003
001500* PROGRAM NAME : EDI INTERCHANGE TRANSMISSION LIST (ETLINTXM)     00150003
001600*                EDI INTERCHANGE ERROR LIST  (ETLINTMM)           00160003
001700*                                                                 00170003
001800* ORIGINAL WORK REQUEST #: 2026                                   00180003
001900*                                                                 00190003
002000* PROGRAM OBJECTIVE:                                              00200003
002100*                                                                 00210003
002200*   TO LIST EDI INTERCHANGE TRANMSSIONS.                          00220003
002300*                                                                 00230003
002400* DATASETS USED:                                                  00240003
002500*  DSN                                 COPY USED  I/O  VSAM?  DB? 00250003
002600* --------------------------------    ----------- ---- -----  --- 00260003
002700*  TENTNME                             TENTNME     I     N    DB2 00270003
002800*  TTRNSET                             TTRNSET     I     N    DB2 00280003
002900*  TTRDPRT                             TTRDPRT     I     N    DB2 00290003
003000*  TINTTRN                             TINTTRN     I     N    DB2 00300003
003100*  TFGTRST                             TFGTRST     I     N    DB2 00310003
003200*  TINTNOT                             TINTNOT     I     N    DB2 00320003
003300*                                                                 00330003
003400* PROGRAM NARRATIVE:                                              00340003
003500*                                                                 00350003
003600*   THIS SCREEN CAN BE ACCESSED FROM 4 DIFFERENT PLACES. IT CAN   00360003
003700*   BE REACHED FROM THE ETMENU, THE INTERCHANGE TRANSMISSION      00370003
003800*   SELECTION (ETSINTXM), THE DOCUMENT TRANSMISSION SELECTION     00380003
003900*   (ETSDOCXM), AND THE DOCUMENTS NOT ACKNOWLEDGED LIST(ETLFAACK).00390003
004000*                                                                 00400003
004100*   THE CURSOR THAT WILL BE OPENED TO POPULATE THIS LIST DEPENDS  00410003
004200*   ON WHERE THE USER IS COMING FROM. THERE ARE 13 TOTAL CURSORS, 00420003
004300*   10 OF WHICH WILL BE USED WHEN THE USER IS COMING FROM         00430003
004400*   ETSINTXM - DEPENDING ON THE COMBINATION OF DATA ENTERED.      00440003
004500*   THERE IS THEN 1 CURSOR FOR EACH OF THE OTHER 3 WAYS TO        00450003
004600*   ACCESS THIS SCREEN.                                           00460003
004700*                                                                 00470003
004800*   IF THE USER ENTERS THIS SREEN FROM ETMENU, ONLY INTERCHANGE   00480003
004900*   TRANSMISSION ERRORS WILL BE LISTED. THEREFORE, THE TITLE IS   00490003
005000*   DIFFERENT IF COMING FROM THE MENU (EDI INTERCHANGE ERROR LIST 00500003
005100*   VS. EDI INTERCHANGE TRANSMISSION LIST). THERFORE, TWO         00510003
005200*   MNEMONICS ARE REQUIRED FOR THIS PROGRAM.                      00520003
005300*                                                                 00530003
005400* CONTROL CARD REQUIREMENTS: N/A                                  00540003
005500* JOBS PROGRAM IS FOUND IN:  N/A                                  00550003
005600* REPORTS PRODUCED:          N/A                                  00560003
005700*                                                                 00570003
005800***************************************************************** 00580003
005900* CHANGES:                                                        00590003
006000*   DATE 08/18/94                                                 00600003
006100*   ADDED THE LINE "WHERE TINTNOT.RES_IND = 'N'" TO THE WHERE     00610003
006200*   CLAUSE OF CURSOR_TWELVE  TO ONLY BRING BACK UNRESOLVED ERRORS.00620003
006300*   MADE BY: TROY BIRK____________   WR/IR #: 2026______________  00630003
006400*                                                                 00640003
006500*   DATE 12/01/94                                                 00650003
006600*   SHORTNED ERROR INTO ERR AND ADDED A TEST OR PROD INDICATOR    00660003
006700*   UNDER THE 'P/T'.  DAN ADDED THIS TO THE DATABASE.             00670003
006800*   MADE BY: STEVE FLUNKER________   WR/IR #: 3138______________  00680003
006801*                                                                 00680105
006810* 10/11/2021 GERMAN BANDA                    WR/IR #: CHG0262418* 00681005
006820*            - CHANGE CALL OF DPKUT100 TO                       * 00682005
006830*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 00683005
006840*              MAKING THE CALL DYNAMIC VS STATIC                * 00684005
006850*                                                               * 00685005
CICS  *  CHANGED 10/25/2022    BY BARB SCHULTZ    WR: CHG0277210        00685107
CICS  *                                                                 00685206
CICS  *  ADDED COPYBOOK DPWS930 AND MADE THE CICS ARCHITECTURE CALL     00685306
CICS  *  DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.      00685406
CICS  *---------------------------------------------------------------* 00685506
006860*---------------------------------------------------------------* 00686005
006900***************************************************************** 00690003
007000 EJECT                                                            00700003
007100 ENVIRONMENT DIVISION.                                            00710003
007200                                                                  00720003
007300 DATA DIVISION.                                                   00730003
007400                                                                  00740003
007500 WORKING-STORAGE SECTION.                                         00750003
007600                                                                  00760003
007700 01  PC-PROGRAM-CONSTANTS.                                        00770003
007800     05  PC-ITEM-NUMBER-LENGTH          PIC S9(04)  VALUE +5      00780003
007900                                                    COMP SYNC.    00790003
008000     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00800003
008100                                                    'ET321A  '.   00810003
008200     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00820003
008300                                                    'ETKM321 '.   00830003
008400     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00840003
008500                                                    'ETKCS321'.   00850003
008600     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00860003
008700     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00870003
008800     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +7      00880003
008900                                                    COMP SYNC.    00890003
009000     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00900003
009100                                                    COMP SYNC.    00910003
009200     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00920003
009300                                                    +1000000      00930003
009400                                                    COMP-3.       00940003
009500     05  PC-ADD                         PIC  X(03)  VALUE 'ADD'.  00950003
009600     05  PC-INQ                         PIC  X(03)  VALUE 'INQ'.  00960003
009700     05  PC-UPD                         PIC  X(03)  VALUE 'UPD'.  00970003
009800     05  PC-DEL                         PIC  X(03)  VALUE 'DEL'.  00980003
009900     05  PC-ERR                         PIC  X(03)  VALUE 'ERR'.  00990003
010000*                                                                 01000003
010100     05  PC-TSYMSG-NUMBERS.                                       01010003
010200         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01020003
010300         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01030003
010400         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01040003
010500         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01050003
010600         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01060003
010700         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01070003
010800         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01080003
010900         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01090003
011000         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01100003
011100         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01110003
011200         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01120003
011300         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01130003
011400         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01140003
011500         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  01150003
011600         10  PC-TSYMSG-00831            PIC  9(05)  VALUE 00831.  01160003
011700*                                                                 01170003
011800 01  PS-PROGRAM-SWITCHES.                                         01180003
011900     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01190003
012000         88  PS-NO-ERROR                            VALUE 'Y'.    01200003
012100         88  PS-ERROR                               VALUE 'N'.    01210003
012200     05  PS-START-ITEM-ERROR-SW         PIC  X(01)  VALUE 'Y'.    01220003
012300         88  PS-NO-START-ITEM-ERROR                 VALUE 'Y'.    01230003
012400         88  PS-START-ITEM-ERROR                    VALUE 'N'.    01240003
012500     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    01250003
012600         88  PS-DONE                                VALUE 'Y'.    01260003
012700         88  PS-NOT-DONE                            VALUE 'N'.    01270003
012800     05  PS-LIST-END-SW            PIC X       VALUE 'N'.         01280003
012900         88  PS-LIST-END                       VALUE 'Y'.         01290003
013000         88  PS-NO-LIST-END                    VALUE 'N'.         01300003
013100*                                                                 01310003
013200 01  PV-PROGRAM-VARIABLES.                                        01320003
013300     05  PV-SUB                         PIC S9(04)  VALUE +0      01330003
013400                                                    COMP SYNC.    01340003
013500     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      01350003
013600                                                    COMP SYNC.    01360003
013700     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      01370003
013800                                                    COMP-3.       01380003
013900     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      01390003
014000                                                    COMP-3.       01400003
014100     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      01410003
014200                                                    COMP-3.       01420003
014300     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      01430003
014400                                                    COMP-3.       01440003
014500     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      01450003
014600                                                    COMP-3.       01460003
014700     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      01470003
014800                                                    COMP-3.       01480003
014900     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      01490003
015000                                                    COMP-3.       01500003
015100     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      01510003
015200                                                    COMP SYNC.    01520003
015300     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01530003
015400                                                    COMP SYNC.    01540003
015500     05  PV-ITEM                        PIC S9(04)  VALUE +0      01550003
015600                                                    COMP SYNC.    01560003
015700     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      01570003
015800                                                    COMP SYNC.    01580003
015900     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      01590003
016000                                                    COMP SYNC.    01600003
016100     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      01610003
016200                                                    COMP SYNC.    01620003
016300     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      01630003
016400                                                    COMP SYNC.    01640003
016500     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      01650003
016600                                                    COMP SYNC.    01660003
016700     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01670003
016800                                                    COMP SYNC.    01680003
016900     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01690003
017000                                                    COMP SYNC.    01700003
017100     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      01710003
017200                                                    COMP SYNC.    01720003
017300     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      01730003
017400                                                    COMP SYNC.    01740003
017500     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      01750003
017600                                                    COMP SYNC.    01760003
017700     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      01770003
017800                                                    COMP SYNC.    01780003
017900     05  PV-SUM-ITM-EXTD-AMT            PIC S9(7)V99              01790003
018000                                                    COMP-3.       01800003
018100     05  PV-BEGIN-DT.                                             01810003
018200         10  PV-BEGIN-YYYY              PIC X(04)  VALUE SPACES.  01820003
018300         10  FILLER                     PIC X(01)  VALUE '-'.     01830003
018400         10  PV-BEGIN-MM                PIC X(02)  VALUE SPACES.  01840003
018500         10  FILLER                     PIC X(01)  VALUE '-'.     01850003
018600         10  PV-BEGIN-DD                PIC X(02)  VALUE SPACES.  01860003
018700     05  PV-BEGIN-DATE REDEFINES PV-BEGIN-DT PIC X(10).           01870003
018800     05  PV-END-DT.                                               01880003
018900         10  PV-END-YYYY                PIC X(04)  VALUE SPACES.  01890003
019000         10  FILLER                     PIC X(01)  VALUE '-'.     01900003
019100         10  PV-END-MM                  PIC X(02)  VALUE SPACES.  01910003
019200         10  FILLER                     PIC X(01)  VALUE '-'.     01920003
019300         10  PV-END-DD                  PIC X(02)  VALUE SPACES.  01930003
019400     05  PV-END-DATE REDEFINES PV-END-DT PIC X(10).               01940003
019500     05  PV-CONVERT-DATE.                                         01950003
019600         10  PV-CONVERT-MM              PIC X(02)  VALUE SPACES.  01960003
019700         10  PV-DASH1                   PIC X(01)  VALUE '-'.     01970003
019800         10  PV-CONVERT-DD              PIC X(02)  VALUE SPACES.  01980003
019900         10  PV-DASH2                   PIC X(01)  VALUE '-'.     01990003
020000         10  PV-CONVERT-YY              PIC X(02)  VALUE SPACES.  02000003
020100*                                                                 02010003
020200******************************************************************02020003
020300**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **02030003
020400**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **02040003
020500**  APPLICATION-SPECIFIC COMMAREA.                              **02050003
020600******************************************************************02060003
020700 01  LQW-LIST-QUEUE-WORK-AREA.                                    02070003
020800     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  02080003
020900     05  LQW-ITEM-ENTRIES               OCCURS 7 TIMES            02090003
021000                                        INDEXED BY LQW-IDX.       02100003
021100         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       02110003
021200         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               02120003
021300         10  LQW-SELECTED-SW            PIC  X(01).               02130003
021400             88  LQW-SELECT                         VALUE 'S'.    02140003
021500             88  LQW-DESELECT                       VALUE ' '.    02150003
021600                                                                  02160003
021700         10  LQW-ACTION              PIC  X(03).                  02170003
021800         10  LQW-TP-DKEY            PIC  S9(9) COMP.              02180003
021900         10  LQW-TP-DKEY-TMST       PIC  X(26).                   02190003
022000         10  LQW-ENT-ID              PIC S9(09)                   02200003
022100                                     COMP-3.                      02210003
022200         10  LQW-VEND-NAME           PIC X(20).                   02220003
022300         10  LQW-INCHG-CNTL-NBR      PIC S9(09)                   02230003
022400                                     COMP-3.                      02240003
022500         10  LQW-CRE-DTE             PIC X(10).                   02250003
022600         10  LQW-CRE-TME             PIC X(08).                   02260003
022700         10  LQW-MAILBOX-REC-DTE     PIC X(10).                   02270003
022800         10  LQW-MAILBOX-REC-TME     PIC X(08).                   02280003
022900         10  LQW-MAILBOX-PU-DTE      PIC X(10).                   02290003
023000         10  LQW-MAILBOX-PU-TME      PIC X(08).                   02300003
023100         10  LQW-FRCD-IND-QUEUE      PIC X(01).                   02310003
023200         10  LQW-PROD-TEST-IND-QUEUE PIC X(01).                   02320003
023300                                                                  02330003
023400     EJECT                                                        02340003
023500*---------------------------------------------------------------* 02350003
023600*  RECORD LAYOUT FOR THE SELECTION                                02360003
023700*  TEMP STORAGE QUEUE.                                          * 02370003
023800*---------------------------------------------------------------* 02380003
023900     COPY ETWS308.                                                02390003
024000     COPY ETWS301.                                                02400003
024100                                                                  02410003
024200     EJECT                                                        02420003
024300*---------------------------------------------------------------* 02430003
024400*    MAP LAYOUT                                                 * 02440003
024500*---------------------------------------------------------------* 02450003
024600                                                                  02460003
024700     COPY ETKM321.                                                02470003
024800*                                                                 02480003
024900 01  MR-OCCURS-LAYOUT                   REDEFINES  ET321AO.       02490003
025000     05  FILLER                         PIC X(42).                02500003
025100     05  MR-SCROLL-AREA                 OCCURS 7 TIMES.           02510003
025200         10  MR-SELECTL                 PIC S9(04) COMP.          02520003
025300         10  MR-SELECTA                 PIC  X(01).               02530003
025400         10  MR-SELECTC                 PIC  X(01).               02540003
025500         10  MR-SELECTH                 PIC  X(01).               02550003
025600         10  MR-SELECTI                 PIC  X(01).               02560003
025700                                                                  02570003
025800         10  MR-ACTIONL                 PIC S9(04) COMP.          02580003
025900         10  MR-ACTIONA                 PIC  X(01).               02590003
026000         10  MR-ACTIONC                 PIC  X(01).               02600003
026100         10  MR-ACTIONH                 PIC  X(01).               02610003
026200         10  MR-ACTION                  PIC  X(03).               02620003
026300                                                                  02630003
026400         10  MR-VENDOR-NAMEL            PIC S9(04) COMP.          02640003
026500         10  MR-VENDOR-NAMEA            PIC  X(01).               02650003
026600         10  MR-VENDOR-NAMEC            PIC  X(01).               02660003
026700         10  MR-VENDOR-NAMEH            PIC  X(01).               02670003
026800         10  MR-VENDOR-NAME             PIC  X(20).               02680003
026900                                                                  02690003
027000         10  MR-INT-CNTL-NUML           PIC S9(04) COMP.          02700003
027100         10  MR-INT-CNTL-NUMA           PIC  X(01).               02710003
027200         10  MR-INT-CNTL-NUMC           PIC  X(01).               02720003
027300         10  MR-INT-CNTL-NUMH           PIC  X(01).               02730003
027400         10  MR-INT-CNTL-NUM            PIC  X(09).               02740003
027500                                                                  02750003
027600         10  MR-CREATE-DATEL            PIC S9(04) COMP.          02760003
027700         10  MR-CREATE-DATEA            PIC  X(01).               02770003
027800         10  MR-CREATE-DATEC            PIC  X(01).               02780003
027900         10  MR-CREATE-DATEH            PIC  X(01).               02790003
028000         10  MR-CREATE-DATE             PIC  X(10).               02800003
028100                                                                  02810003
028200         10  MR-RECEIPT-DATEL           PIC S9(04) COMP.          02820003
028300         10  MR-RECEIPT-DATEA           PIC  X(01).               02830003
028400         10  MR-RECEIPT-DATEC           PIC  X(01).               02840003
028500         10  MR-RECEIPT-DATEH           PIC  X(01).               02850003
028600         10  MR-RECEIPT-DATE            PIC  X(10).               02860003
028700                                                                  02870003
028800         10  MR-PICKUP-DATEL            PIC S9(04) COMP.          02880003
028900         10  MR-PICKUP-DATEA            PIC  X(01).               02890003
029000         10  MR-PICKUP-DATEC            PIC  X(01).               02900003
029100         10  MR-PICKUP-DATEH            PIC  X(01).               02910003
029200         10  MR-PICKUP-DATE             PIC  X(10).               02920003
029300                                                                  02930003
029400         10  MR-FRCD-INDL               PIC S9(04) COMP.          02940003
029500         10  MR-FRCD-INDA               PIC  X(01).               02950003
029600         10  MR-FRCD-INDC               PIC  X(01).               02960003
029700         10  MR-FRCD-INDH               PIC  X(01).               02970003
029800         10  MR-FRCD-IND                PIC  X(01).               02980003
029900                                                                  02990003
030000         10  MR-PROD-TEST-INDL          PIC S9(04) COMP.          03000003
030100         10  MR-PROD-TEST-INDA          PIC  X(01).               03010003
030200         10  MR-PROD-TEST-INDC          PIC  X(01).               03020003
030300         10  MR-PROD-TEST-INDH          PIC  X(01).               03030003
030400         10  MR-PROD-TEST-IND           PIC  X(01).               03040003
030500                                                                  03050003
030600         10  MR-CREATE-TIMEL            PIC S9(04) COMP.          03060003
030700         10  MR-CREATE-TIMEA            PIC  X(01).               03070003
030800         10  MR-CREATE-TIMEC            PIC  X(01).               03080003
030900         10  MR-CREATE-TIMEH            PIC  X(01).               03090003
031000         10  MR-CREATE-TIME             PIC  X(05).               03100003
031100                                                                  03110003
031200         10  MR-RECEIPT-TIMEL           PIC S9(04) COMP.          03120003
031300         10  MR-RECEIPT-TIMEA           PIC  X(01).               03130003
031400         10  MR-RECEIPT-TIMEC           PIC  X(01).               03140003
031500         10  MR-RECEIPT-TIMEH           PIC  X(01).               03150003
031600         10  MR-RECEIPT-TIME            PIC  X(05).               03160003
031700                                                                  03170003
031800         10  MR-PICKUP-TIMEL            PIC S9(04) COMP.          03180003
031900         10  MR-PICKUP-TIMEA            PIC  X(01).               03190003
032000         10  MR-PICKUP-TIMEC            PIC  X(01).               03200003
032100         10  MR-PICKUP-TIMEH            PIC  X(01).               03210003
032200         10  MR-PICKUP-TIME             PIC  X(05).               03220003
032300                                                                  03230003
032400                                                                  03240003
032500     EJECT                                                        03250003
032600*---------------------------------------------------------------* 03260003
032700*    ATTRIBUTE SETTINGS COPYBOOK.                               * 03270003
032800*---------------------------------------------------------------* 03280003
032900                                                                  03290003
033000     COPY DPWS015.                                                03300003
033100                                                                  03310003
033200*---------------------------------------------------------------* 03320003
033300*    FUNCTION KEYS COPYBOOK.                                    * 03330003
033400*---------------------------------------------------------------* 03340003
033500                                                                  03350003
033600     COPY DPWS016.                                                03360003
033700                                                                  03370003
033800*---------------------------------------------------------------* 03380003
033900*    NUMERIC EDIT LAYOUT.                                       * 03390003
034000*---------------------------------------------------------------* 03400003
034100                                                                  03410003
034200     COPY DPWS010I.                                               03420003
034300 EJECT                                                            03430003
034400*---------------------------------------------------------------* 03440003
CICS  *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API           * 03450008
034600*---------------------------------------------------------------* 03460003
034700                                                                  03470003
034800     COPY DPWS030.                                                03480003
CICS       COPY DPWS930.                                                03481008
034900 EJECT                                                            03490003
035000*---------------------------------------------------------------* 03500003
035100*    STANDARD COMMAREA.                                         * 03510003
035200*---------------------------------------------------------------* 03520003
035300                                                                  03530003
035400     COPY DPWS020.                                                03540003
035500     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                03550003
035600                                                                  03560003
035700*---------------------------------------------------------------* 03570003
035800*  INTER-APPLICATION COMMAREA.                                    03580003
035900*---------------------------------------------------------------* 03590003
036000                                                                  03600003
036100         10  INTER-APPL-COMM-AREA       PIC X(200).               03610003
036200     COPY ETWS307.                                                03620003
036300*---------------------------------------------------------------* 03630003
036400*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 03640003
036500*---------------------------------------------------------------* 03650003
036600         10  ASC-SPECIFIC-COMMAREA.                               03660003
036700             15  ASC-FGTRST-TP-DKEY          PIC  S9(9) COMP.     03670003
036800             15  ASC-FGTRST-TP-DKEY-TMST     PIC X(26).           03680003
036900             15  ASC-COMBINATION             PIC X(01).           03690003
037000             15  ASC-FORMAT-IND              PIC X(01).           03700003
037100             15  ASC-ENT-ID                  PIC S9(09) COMP.     03710003
037200             15  ASC-VENDOR-NAME             PIC X(30).           03720003
037300             15  ASC-CONTROL-NUM             PIC S9(09)V COMP-3.  03730003
037400             15  ASC-DIRECTION               PIC X(01).           03740003
037500             15  ASC-ERROR-IND               PIC X(01).           03750003
037600             15  ASC-NUM-XMITS               PIC S9(09)V COMP-3.  03760003
037700             15  ASC-TRAN-SET                PIC X(03).           03770003
037800             15  ASC-BEGIN-DT.                                    03780003
037900                 20  ASC-BEGIN-DT-YYYY       PIC  X(04).          03790003
038000                 20  ASC-BEGIN-DT-MM         PIC  X(02).          03800003
038100                 20  ASC-BEGIN-DT-DD         PIC  X(02).          03810003
038200             15  ASC-END-DT.                                      03820003
038300                 20  ASC-END-DT-YYYY         PIC  X(04).          03830003
038400                 20  ASC-END-DT-MM           PIC  X(02).          03840003
038500                 20  ASC-END-DT-DD           PIC  X(02).          03850003
038600             15  ASC-DOC-DTL                 PIC X(30).           03860003
038700             15  ASC-DOC-DTL-LOW             PIC X(30).           03870003
038800             15  ASC-DOC-DTL-HIGH            PIC X(30).           03880003
038900             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                03890003
039000                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  03900003
039100                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   03910003
039200                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   03920003
039300                                                                  03930003
039400                 20  ASC-ITEM-ARRAY.                              03940003
039500                     25  ASC-ITEM-ENTRIES OCCURS 7 TIMES.         03950003
039600                         30  ASC-LIST-ITEM-NUMBER                 03960003
039700                                                     PIC S9(09)   03970003
039800                                                     COMP-3.      03980003
039900                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  03990003
040000                             88  ASC-VALID-SELECT    VALUE ' '    04000003
040100                                                           'S'    04010003
040200                                                           'B'    04020003
040300                                                           'E'.   04030003
040400                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   04040003
040500                             88  ASC-TEMP-SELECT     VALUE 'S'.   04050003
040600                             88  ASC-TEMP-BEGIN      VALUE 'B'.   04060003
040700                             88  ASC-TEMP-END        VALUE 'E'.   04070003
040800                         30  ASC-SELECTED-SW         PIC  X(01).  04080003
040900                             88  ASC-NO-SELECT       VALUE ' '.   04090003
041000                             88  ASC-SELECT          VALUE 'S'.   04100003
041100                             88  ASC-BEGIN           VALUE 'B'.   04110003
041200                             88  ASC-END             VALUE 'E'.   04120003
041300                         30  ASC-ACTION              PIC  X(03).  04130003
041400                         30  ASC-TP-DKEY        PIC  S9(9) COMP.  04140003
041500                         30  ASC-TP-DKEY-TMST   PIC  X(26).       04150003
041600                                                                  04160003
041700                         30  ASC-ENT-ID-QUEUE        PIC S9(09)   04170003
041800                                                     COMP-3.      04180003
041900                         30  ASC-VEND-NAME-QUEUE     PIC X(20).   04190003
042000                         30  ASC-INCHG-CNTL-NBR      PIC S9(09)   04200003
042100                                                     COMP-3.      04210003
042200                         30  ASC-CRE-DTE             PIC X(10).   04220003
042300                         30  ASC-CRE-TME             PIC X(08).   04230003
042400                         30  ASC-MAILBOX-REC-DTE     PIC X(10).   04240003
042500                         30  ASC-MAILBOX-REC-TME     PIC X(08).   04250003
042600                         30  ASC-MAILBOX-PU-DTE      PIC X(10).   04260003
042700                         30  ASC-MAILBOX-PU-TME      PIC X(08).   04270003
042800                         30  ASC-FRCD-IND-QUEUE      PIC X(01).   04280003
042900                         30  ASC-PROD-TEST-IND-QUEUE PIC X(01).   04290003
043000                                                                  04300003
043100             15  ASC-BLK-SUB                         PIC S9(04)   04310003
043200                                                          COMP    04320003
043300                                                          SYNC.   04330003
043400             15  ASC-ITEM-SUB                        PIC S9(04)   04340003
043500                                                          COMP    04350003
043600                                                          SYNC.   04360003
043700             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)   04370003
043800                                                          COMP-3. 04380003
043900             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   04390003
044000                                                          COMP-3. 04400003
044100             15  ASC-ITEMS-DISPLAYED                 PIC S9(03)   04410003
044200                                                          COMP-3. 04420003
044300             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   04430003
044400                                                          COMP-3. 04440003
044500             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)   04450003
044600                                                          COMP-3. 04460003
044700             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)   04470003
044800                                                          COMP    04480003
044900                                                          SYNC.   04490003
045000             15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   04500003
045100                                                          COMP-3. 04510003
045200             15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   04520003
045300                                                          COMP-3. 04530003
045400             15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  04540003
045500                 88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   04550003
045600                 88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   04560003
045700             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC  X(01).  04570003
045800                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   04580003
045900                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   04590003
046000             15  ASC-LIST-QUEUE-NAME.                             04600003
046100                 20  ASC-LIST-TERM-ID                PIC  X(04).  04610003
046200                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   04620003
046300                                                          COMP-3. 04630003
046400                 20  ASC-LIST-SEQ                    PIC  9(01).  04640003
046500             15  ASC-SEL-QUEUE-NAME.                              04650003
046600                 20  ASC-SEL-TERM-ID                 PIC  X(04).  04660003
046700                 20  ASC-SEL-TASK-NUMBER             PIC S9(05)   04670003
046800                                                          COMP-3. 04680003
046900                 20  ASC-SEL-SEQ                     PIC  9(01).  04690003
047000                                                                  04700003
047100             15  ASC-START-ITEM-REQUEST.                          04710003
047200                 20  ASC-START-ITEM-REQUEST-N        PIC  9(05).  04720003
047300             15  ASC-SEL-SUB                 PIC S9(04) COMP.     04730003
047400             15  ASC-SEL-ITEM                PIC S9(04) COMP.     04740003
047500             15  ASC-NUMBER-OF-TS-ITEMS      PIC S9(05) COMP-3.   04750003
047600             15  ASC-SEL-QUEUE2-NAME.                             04760003
047700                 20  FILLER                  PIC  X(04).          04770003
047800                 20  FILLER                  PIC S9(05) COMP-3.   04780003
047900                 20  FILLER                  PIC  9.              04790003
048000             15  FILLER                              PIC X(835).  04800003
048100     EJECT                                                        04810003
048200*---------------------------------------------------------------* 04820003
048300*    ABEND PROCESSING COPYBOOK.                                 * 04830003
048400*---------------------------------------------------------------* 04840003
048500                                                                  04850003
048600     COPY DPWS013.                                                04860003
048700                                                                  04870003
048800 EJECT                                                            04880003
048900*---------------------------------------------------------------* 04890003
049000*    DCLGEN FOR EDI TRANSACTION SET DB                            04900003
049100*---------------------------------------------------------------* 04910003
049200     EXEC SQL                                                     04920003
049300          INCLUDE TENTNME                                         04930003
049400     END-EXEC.                                                    04940003
049500                                                                  04950003
049600*---------------------------------------------------------------* 04960003
049700*    DCLGEN FOR EDI TRANSACTION SET DB                            04970003
049800*---------------------------------------------------------------* 04980003
049900     EXEC SQL                                                     04990003
050000          INCLUDE TTRNSET                                         05000003
050100     END-EXEC.                                                    05010003
050200*                                                                 05020003
050300*---------------------------------------------------------------* 05030003
050400*    DCLGEN FOR EDI TRADING PARTNERSHIP DB                        05040003
050500*---------------------------------------------------------------* 05050003
050600     EXEC SQL                                                     05060003
050700          INCLUDE TTRDPRT                                         05070003
050800     END-EXEC.                                                    05080003
050900*                                                                 05090003
051000*---------------------------------------------------------------* 05100003
051100*    DCLGEN FOR EDI INTERCHANGE TRANSMISSION DB                   05110003
051200*---------------------------------------------------------------* 05120003
051300     EXEC SQL                                                     05130003
051400          INCLUDE TINTTRN                                         05140003
051500     END-EXEC.                                                    05150003
051600*                                                                 05160003
051700*---------------------------------------------------------------* 05170003
051800*    DCLGEN FOR EDI FUNCTIONAL GROUP DB                           05180003
051900*---------------------------------------------------------------* 05190003
052000     EXEC SQL                                                     05200003
052100          INCLUDE TFGTRST                                         05210003
052200     END-EXEC.                                                    05220003
052300*                                                                 05230003
052400*---------------------------------------------------------------* 05240003
052500*    DCLGEN FOR EDI TINTNOT DB                                    05250003
052600*---------------------------------------------------------------* 05260003
052700     EXEC SQL                                                     05270003
052800          INCLUDE TINTNOT                                         05280003
052900     END-EXEC.                                                    05290003
053000*---------------------------------------------------------------* 05300003
053100*    DB2 AREA FOR COMMUNICATIONS                                * 05310003
053200*---------------------------------------------------------------* 05320003
053300     EXEC SQL                                                     05330003
053400          INCLUDE SQLCA                                           05340003
053500     END-EXEC.                                                    05350003
053600                                                                  05360003
053700*---------------------------------------------------------------* 05370003
053800*  CURSOR USED WHEN COMING FROM ETSINTXM                          05380003
053900*  IN THIS CASE, THE INTERCHANGE CONTROL NUMBER WAS ENTERED       05390003
054000*  AND THE ERROR INDICATOR WAS SET TO 'Y'                         05400003
054100*---------------------------------------------------------------* 05410003
054200     EXEC SQL                                                     05420003
054300         DECLARE  CURSOR_ONE   CURSOR FOR                         05430003
054400         SELECT   B.TP_DKEY,                                      05440003
054500                  B.TP_DKEY_TMST,                                 05450003
054600                  B.INCHG_CNTL_NBR,                               05460003
054700                  B.CRE_DTE,                                      05470003
054800                  B.CRE_TME,                                      05480003
054900                  B.MAILBOX_REC_DTE,                              05490003
055000                  B.MAILBOX_REC_TME,                              05500003
055100                  B.MAILBOX_PU_DTE,                               05510003
055200                  B.MAILBOX_PU_TME,                               05520003
055300                  B.ERR_IND,                                      05530003
055400                  B.PROD_TEST_IND,                                05540003
055500                  B.TRN_MANL_FRCD_IND                             05550003
055600         FROM     TTRDPRT A,                                      05560003
055700                  TINTTRN B                                       05570003
055800         WHERE  (A.ENT_ID = :ASC-ENT-ID)                      AND 05580003
055900                (A.TP_DKEY = B.TP_DKEY)                       AND 05590003
056000                (B.DIR_IND = :ASC-DIRECTION)                  AND 05600003
056100                (B.ERR_IND        = :ASC-ERROR-IND)     AND       05610003
056200                (B.INCHG_CNTL_NBR = :ASC-CONTROL-NUM)             05620003
056300         ORDER BY B.TP_DKEY_TMST DESC                             05630003
056400     END-EXEC.                                                    05640003
056500                                                                  05650003
056600*---------------------------------------------------------------* 05660003
056700*  CURSOR USED WHEN COMING FROM ETSINTXM                          05670003
056800*  IN THIS CASE, THE INTERCHANGE CONTROL NUMBER WAS ENTERED       05680003
056900*  AND THE ERROR INDICATOR WAS SET TO 'N'                         05690003
057000*---------------------------------------------------------------* 05700003
057100     EXEC SQL                                                     05710003
057200         DECLARE  CURSOR_TWO   CURSOR FOR                         05720003
057300         SELECT   B.TP_DKEY,                                      05730003
057400                  B.TP_DKEY_TMST,                                 05740003
057500                  B.INCHG_CNTL_NBR,                               05750003
057600                  B.CRE_DTE,                                      05760003
057700                  B.CRE_TME,                                      05770003
057800                  B.MAILBOX_REC_DTE,                              05780003
057900                  B.MAILBOX_REC_TME,                              05790003
058000                  B.MAILBOX_PU_DTE,                               05800003
058100                  B.MAILBOX_PU_TME,                               05810003
058200                  B.ERR_IND,                                      05820003
058300                  B.PROD_TEST_IND,                                05830003
058400                  B.TRN_MANL_FRCD_IND                             05840003
058500         FROM     TTRDPRT A,                                      05850003
058600                  TINTTRN B                                       05860003
058700         WHERE  (A.ENT_ID = :ASC-ENT-ID)                      AND 05870003
058800                (A.TP_DKEY = B.TP_DKEY)                       AND 05880003
058900                (B.DIR_IND = :ASC-DIRECTION)                  AND 05890003
059000                (B.INCHG_CNTL_NBR = :ASC-CONTROL-NUM)             05900003
059100         ORDER BY B.TP_DKEY_TMST DESC                             05910003
059200     END-EXEC.                                                    05920003
059300                                                                  05930003
059400*---------------------------------------------------------------* 05940003
059500*  CURSOR USED WHEN COMING FROM ETSINTXM                          05950003
059600*  IN THIS CASE, THE NUMBER OF TRANSMISSION WERE  ENTERED         05960003
059700*  AND THE ERROR INDICATOR WAS SET TO 'Y'                         05970003
059800*---------------------------------------------------------------* 05980003
059900     EXEC SQL                                                     05990003
060000         DECLARE  CURSOR_THREE CURSOR FOR                         06000003
060100         SELECT   B.TP_DKEY,                                      06010003
060200                  B.TP_DKEY_TMST,                                 06020003
060300                  B.INCHG_CNTL_NBR,                               06030003
060400                  B.CRE_DTE,                                      06040003
060500                  B.CRE_TME,                                      06050003
060600                  B.MAILBOX_REC_DTE,                              06060003
060700                  B.MAILBOX_REC_TME,                              06070003
060800                  B.MAILBOX_PU_DTE,                               06080003
060900                  B.MAILBOX_PU_TME,                               06090003
061000                  B.ERR_IND,                                      06100003
061100                  B.PROD_TEST_IND,                                06110003
061200                  B.TRN_MANL_FRCD_IND                             06120003
061300         FROM     TTRDPRT A,                                      06130003
061400                  TINTTRN B                                       06140003
061500         WHERE  (A.ENT_ID = :ASC-ENT-ID)                      AND 06150003
061600                (A.TP_DKEY = B.TP_DKEY)                       AND 06160003
061700                (B.ERR_IND        = :ASC-ERROR-IND)     AND       06170003
061800                (B.DIR_IND = :ASC-DIRECTION)                      06180003
061900         ORDER BY B.TP_DKEY_TMST DESC                             06190003
062000     END-EXEC.                                                    06200003
062100                                                                  06210003
062200                                                                  06220003
062300*---------------------------------------------------------------* 06230003
062400*  CURSOR USED WHEN COMING FROM ETSINTXM                          06240003
062500*  IN THIS CASE, THE NUMBER OF TRANSMISSION WERE ENTERED          06250003
062600*  AND THE ERROR INDICATOR WAS SET TO 'N'                         06260003
062700*---------------------------------------------------------------* 06270003
062800     EXEC SQL                                                     06280003
062900         DECLARE  CURSOR_FOUR  CURSOR FOR                         06290003
063000         SELECT   B.TP_DKEY,                                      06300003
063100                  B.TP_DKEY_TMST,                                 06310003
063200                  B.INCHG_CNTL_NBR,                               06320003
063300                  B.CRE_DTE,                                      06330003
063400                  B.CRE_TME,                                      06340003
063500                  B.MAILBOX_REC_DTE,                              06350003
063600                  B.MAILBOX_REC_TME,                              06360003
063700                  B.MAILBOX_PU_DTE,                               06370003
063800                  B.MAILBOX_PU_TME,                               06380003
063900                  B.ERR_IND,                                      06390003
064000                  B.PROD_TEST_IND,                                06400003
064100                  B.TRN_MANL_FRCD_IND                             06410003
064200         FROM     TTRDPRT A,                                      06420003
064300                  TINTTRN B                                       06430003
064400         WHERE  (A.ENT_ID = :ASC-ENT-ID)                      AND 06440003
064500                (A.TP_DKEY = B.TP_DKEY)                       AND 06450003
064600                (B.DIR_IND = :ASC-DIRECTION)                      06460003
064700         ORDER BY B.TP_DKEY_TMST DESC                             06470003
064800     END-EXEC.                                                    06480003
064900                                                                  06490003
065000*---------------------------------------------------------------* 06500003
065100*  CURSOR USED WHEN COMING FROM ETSINTXM                          06510003
065200*  IN THIS CASE, A TRAN SET AND # OF TRANSMISSION WERE ENTERED    06520003
065300*  AND THE ERROR INDICATOR WAS SET TO 'Y'                         06530003
065400*---------------------------------------------------------------* 06540003
065500     EXEC SQL                                                     06550003
065600         DECLARE  CURSOR_FIVE  CURSOR FOR                         06560003
065700         SELECT DISTINCT                                          06570003
065800                  B.TP_DKEY,                                      06580003
065900                  B.TP_DKEY_TMST,                                 06590003
066000                  B.INCHG_CNTL_NBR,                               06600003
066100                  B.CRE_DTE,                                      06610003
066200                  B.CRE_TME,                                      06620003
066300                  B.MAILBOX_REC_DTE,                              06630003
066400                  B.MAILBOX_REC_TME,                              06640003
066500                  B.MAILBOX_PU_DTE,                               06650003
066600                  B.MAILBOX_PU_TME,                               06660003
066700                  B.ERR_IND,                                      06670003
066800                  B.PROD_TEST_IND,                                06680003
066900                  B.TRN_MANL_FRCD_IND                             06690003
067000         FROM     TTRDPRT A,                                      06700003
067100                  TINTTRN B,                                      06710003
067200                  TFGTRST C                                       06720003
067300         WHERE  (A.ENT_ID = :ASC-ENT-ID)                      AND 06730003
067400                (A.TP_DKEY = B.TP_DKEY)                       AND 06740003
067500                (B.TP_DKEY = C.TP_DKEY)                       AND 06750003
067600                (B.TP_DKEY_TMST = C.TP_DKEY_TMST)             AND 06760003
067700                (C.TRN_SET_CDE  =   :ASC-TRAN-SET)            AND 06770003
067800                (B.ERR_IND        = :ASC-ERROR-IND)     AND       06780003
067900                (B.DIR_IND = :ASC-DIRECTION)                      06790003
068000         ORDER BY B.TP_DKEY_TMST DESC                             06800003
068100     END-EXEC.                                                    06810003
068200                                                                  06820003
068300*---------------------------------------------------------------* 06830003
068400*  CURSOR USED WHEN COMING FROM ETSINTXM                          06840003
068500*  IN THIS CASE, A TRAN SET AND # OF TRANSMISSION WERE ENTERED    06850003
068600*  AND THE ERROR INDICATOR WAS SET TO 'N'                         06860003
068700*---------------------------------------------------------------* 06870003
068800     EXEC SQL                                                     06880003
068900         DECLARE  CURSOR_SIX   CURSOR FOR                         06890003
069000         SELECT DISTINCT                                          06900003
069100                  B.TP_DKEY,                                      06910003
069200                  B.TP_DKEY_TMST,                                 06920003
069300                  B.INCHG_CNTL_NBR,                               06930003
069400                  B.CRE_DTE,                                      06940003
069500                  B.CRE_TME,                                      06950003
069600                  B.MAILBOX_REC_DTE,                              06960003
069700                  B.MAILBOX_REC_TME,                              06970003
069800                  B.MAILBOX_PU_DTE,                               06980003
069900                  B.MAILBOX_PU_TME,                               06990003
070000                  B.ERR_IND,                                      07000003
070100                  B.PROD_TEST_IND,                                07010003
070200                  B.TRN_MANL_FRCD_IND                             07020003
070300         FROM     TTRDPRT A,                                      07030003
070400                  TINTTRN B,                                      07040003
070500                  TFGTRST C                                       07050003
070600         WHERE  (A.ENT_ID = :ASC-ENT-ID)                      AND 07060003
070700                (A.TP_DKEY = B.TP_DKEY)                       AND 07070003
070800                (B.TP_DKEY = C.TP_DKEY)                       AND 07080003
070900                (B.TP_DKEY_TMST = C.TP_DKEY_TMST)             AND 07090003
071000                (C.TRN_SET_CDE  =   :ASC-TRAN-SET)            AND 07100003
071100                (B.DIR_IND = :ASC-DIRECTION)                      07110003
071200         ORDER BY B.TP_DKEY_TMST DESC                             07120003
071300     END-EXEC.                                                    07130003
071400                                                                  07140003
071500*---------------------------------------------------------------* 07150003
071600*  CURSOR USED WHEN COMING FROM ETSINTXM                          07160003
071700*  IN THIS CASE, A BEGIN DATE/END DATE AND TRAN SET WERE ENTERED  07170003
071800*  AND THE ERROR INDICATOR WAS SET TO 'Y'                         07180003
071900*---------------------------------------------------------------* 07190003
072000     EXEC SQL                                                     07200003
072100         DECLARE  CURSOR_SEVEN CURSOR FOR                         07210003
072200         SELECT DISTINCT                                          07220003
072300                  B.TP_DKEY,                                      07230003
072400                  B.TP_DKEY_TMST,                                 07240003
072500                  B.INCHG_CNTL_NBR,                               07250003
072600                  B.CRE_DTE,                                      07260003
072700                  B.CRE_TME,                                      07270003
072800                  B.MAILBOX_REC_DTE,                              07280003
072900                  B.MAILBOX_REC_TME,                              07290003
073000                  B.MAILBOX_PU_DTE,                               07300003
073100                  B.MAILBOX_PU_TME,                               07310003
073200                  B.ERR_IND,                                      07320003
073300                  B.PROD_TEST_IND,                                07330003
073400                  B.TRN_MANL_FRCD_IND                             07340003
073500         FROM     TTRDPRT A,                                      07350003
073600                  TINTTRN B,                                      07360003
073700                  TFGTRST C                                       07370003
073800         WHERE  (A.ENT_ID = :ASC-ENT-ID)                      AND 07380003
073900                (A.TP_DKEY = B.TP_DKEY)                       AND 07390003
074000                (B.TP_DKEY = C.TP_DKEY)                       AND 07400003
074100                (B.TP_DKEY_TMST = C.TP_DKEY_TMST)             AND 07410003
074200                (C.TRN_SET_CDE  =   :ASC-TRAN-SET)            AND 07420003
074300                (B.ERR_IND        = :ASC-ERROR-IND)     AND       07430003
074400                (B.CRE_DTE BETWEEN  :PV-BEGIN-DATE AND            07440003
074500                                    :PV-END-DATE)             AND 07450003
074600                (B.DIR_IND = :ASC-DIRECTION)                      07460003
074700         ORDER BY B.TP_DKEY_TMST DESC                             07470003
074800     END-EXEC.                                                    07480003
074900                                                                  07490003
075000*---------------------------------------------------------------* 07500003
075100*  CURSOR USED WHEN COMING FROM ETSINTXM                          07510003
075200*  IN THIS CASE, A BEGIN DATE/END DATE AND TRAN SET WERE ENTERED  07520003
075300*  AND THE ERROR INDICATOR WAS SET TO 'N'                         07530003
075400*---------------------------------------------------------------* 07540003
075500     EXEC SQL                                                     07550003
075600         DECLARE  CURSOR_EIGHT CURSOR FOR                         07560003
075700         SELECT DISTINCT                                          07570003
075800                  B.TP_DKEY,                                      07580003
075900                  B.TP_DKEY_TMST,                                 07590003
076000                  B.INCHG_CNTL_NBR,                               07600003
076100                  B.CRE_DTE,                                      07610003
076200                  B.CRE_TME,                                      07620003
076300                  B.MAILBOX_REC_DTE,                              07630003
076400                  B.MAILBOX_REC_TME,                              07640003
076500                  B.MAILBOX_PU_DTE,                               07650003
076600                  B.MAILBOX_PU_TME,                               07660003
076700                  B.ERR_IND,                                      07670003
076800                  B.PROD_TEST_IND,                                07680003
076900                  B.TRN_MANL_FRCD_IND                             07690003
077000         FROM     TTRDPRT A,                                      07700003
077100                  TINTTRN B,                                      07710003
077200                  TFGTRST C                                       07720003
077300         WHERE  (A.ENT_ID = :ASC-ENT-ID)                      AND 07730003
077400                (A.TP_DKEY = B.TP_DKEY)                       AND 07740003
077500                (B.TP_DKEY = C.TP_DKEY)                       AND 07750003
077600                (B.TP_DKEY_TMST = C.TP_DKEY_TMST)             AND 07760003
077700                (C.TRN_SET_CDE  =   :ASC-TRAN-SET)            AND 07770003
077800                (B.CRE_DTE BETWEEN  :PV-BEGIN-DATE AND            07780003
077900                                    :PV-END-DATE)             AND 07790003
078000                (B.DIR_IND = :ASC-DIRECTION)                      07800003
078100         ORDER BY B.TP_DKEY_TMST DESC                             07810003
078200     END-EXEC.                                                    07820003
078300                                                                  07830003
078400*---------------------------------------------------------------* 07840003
078500*  CURSOR USED WHEN COMING FROM ETSINTXM                          07850003
078600*  IN THIS CASE, A BEGIN DATE/END DATE WERE ENTERED               07860003
078700*  AND THE ERROR INDICATOR WAS SET TO 'Y'                         07870003
078800*---------------------------------------------------------------* 07880003
078900     EXEC SQL                                                     07890003
079000         DECLARE  CURSOR_NINE  CURSOR FOR                         07900003
079100         SELECT                                                   07910003
079200                  B.TP_DKEY,                                      07920003
079300                  B.TP_DKEY_TMST,                                 07930003
079400                  B.INCHG_CNTL_NBR,                               07940003
079500                  B.CRE_DTE,                                      07950003
079600                  B.CRE_TME,                                      07960003
079700                  B.MAILBOX_REC_DTE,                              07970003
079800                  B.MAILBOX_REC_TME,                              07980003
079900                  B.MAILBOX_PU_DTE,                               07990003
080000                  B.MAILBOX_PU_TME,                               08000003
080100                  B.ERR_IND,                                      08010003
080200                  B.PROD_TEST_IND,                                08020003
080300                  B.TRN_MANL_FRCD_IND                             08030003
080400         FROM     TTRDPRT A,                                      08040003
080500                  TINTTRN B                                       08050003
080600         WHERE  (A.ENT_ID = :ASC-ENT-ID)                      AND 08060003
080700                (A.TP_DKEY = B.TP_DKEY)                       AND 08070003
080800                (B.ERR_IND        = :ASC-ERROR-IND)     AND       08080003
080900                (B.CRE_DTE BETWEEN  :PV-BEGIN-DATE AND            08090003
081000                                    :PV-END-DATE)             AND 08100003
081100                (B.DIR_IND = :ASC-DIRECTION)                      08110003
081200         ORDER BY B.TP_DKEY_TMST DESC                             08120003
081300     END-EXEC.                                                    08130003
081400                                                                  08140003
081500*---------------------------------------------------------------* 08150003
081600*  CURSOR USED WHEN COMING FROM ETSINTXM                          08160003
081700*  IN THIS CASE, A BEGIN DATE/END DATE WERE ENTERED               08170003
081800*  AND THE ERROR INDICATOR WAS SET TO 'N'                         08180003
081900*---------------------------------------------------------------* 08190003
082000     EXEC SQL                                                     08200003
082100         DECLARE  CURSOR_TEN   CURSOR FOR                         08210003
082200         SELECT                                                   08220003
082300                  B.TP_DKEY,                                      08230003
082400                  B.TP_DKEY_TMST,                                 08240003
082500                  B.INCHG_CNTL_NBR,                               08250003
082600                  B.CRE_DTE,                                      08260003
082700                  B.CRE_TME,                                      08270003
082800                  B.MAILBOX_REC_DTE,                              08280003
082900                  B.MAILBOX_REC_TME,                              08290003
083000                  B.MAILBOX_PU_DTE,                               08300003
083100                  B.MAILBOX_PU_TME,                               08310003
083200                  B.ERR_IND,                                      08320003
083300                  B.PROD_TEST_IND,                                08330003
083400                  B.TRN_MANL_FRCD_IND                             08340003
083500         FROM     TTRDPRT A,                                      08350003
083600                  TINTTRN B                                       08360003
083700         WHERE  (A.ENT_ID = :ASC-ENT-ID)                      AND 08370003
083800                (A.TP_DKEY = B.TP_DKEY)                       AND 08380003
083900                (B.CRE_DTE BETWEEN  :PV-BEGIN-DATE AND            08390003
084000                                    :PV-END-DATE)             AND 08400003
084100                (B.DIR_IND = :ASC-DIRECTION)                      08410003
084200         ORDER BY B.TP_DKEY_TMST DESC                             08420003
084300     END-EXEC.                                                    08430003
084400                                                                  08440003
084500*---------------------------------------------------------------* 08450003
084600*  CURSOR USED WHEN COMING FROM ETSDOCXM                          08460003
084700*---------------------------------------------------------------* 08470003
084800     EXEC SQL                                                     08480003
084900         DECLARE  CURSOR_ELEVEN CURSOR FOR                        08490003
085000         SELECT DISTINCT                                          08500003
085100                  A.ENT_ID,                                       08510003
085200                  D.ENT_NAME_DESC,                                08520003
085300                  B.TP_DKEY,                                      08530003
085400                  B.TP_DKEY_TMST,                                 08540003
085500                  B.INCHG_CNTL_NBR,                               08550003
085600                  B.CRE_DTE,                                      08560003
085700                  B.CRE_TME,                                      08570003
085800                  B.MAILBOX_REC_DTE,                              08580003
085900                  B.MAILBOX_REC_TME,                              08590003
086000                  B.MAILBOX_PU_DTE,                               08600003
086100                  B.MAILBOX_PU_TME,                               08610003
086200                  B.ERR_IND,                                      08620003
086300                  B.PROD_TEST_IND,                                08630003
086400                  B.TRN_MANL_FRCD_IND                             08640003
086500         FROM     TTRDPRT A,                                      08650003
086600                  TINTTRN B,                                      08660003
086700                  TFGTRST C,                                      08670003
086800                  TENTNME D                                       08680003
086900         WHERE                                                    08690003
087000                (C.TRN_SET_CDE  =   :ASC-TRAN-SET)            AND 08700003
087100                (C.TRN_DTL_TXT  BETWEEN :ASC-DOC-DTL-LOW  AND     08710003
087200                                        :ASC-DOC-DTL-HIGH)    AND 08720003
087300                (B.DIR_IND = :ASC-DIRECTION)                  AND 08730003
087400                (B.TP_DKEY = C.TP_DKEY)                       AND 08740003
087500                (B.TP_DKEY_TMST = C.TP_DKEY_TMST)             AND 08750003
087600                (A.ENT_ID  = D.ENT_ID)                        AND 08760003
087700                (D.TYPE_CDE = '01')                           AND 08770003
087800                (A.TP_DKEY = B.TP_DKEY)                           08780003
087900         ORDER BY  B.TP_DKEY_TMST DESC                            08790003
088000     END-EXEC.                                                    08800003
088100                                                                  08810003
088200*---------------------------------------------------------------* 08820003
088300*  CURSOR USED WHEN COMING FROM ETMENU                            08830003
088400*---------------------------------------------------------------* 08840003
088500     EXEC SQL                                                     08850003
088600         DECLARE  CURSOR_TWELVE CURSOR FOR                        08860003
088700         SELECT                                                   08870003
088800                  A.ENT_ID,                                       08880003
088900                  D.ENT_NAME_DESC,                                08890003
089000                  B.TP_DKEY,                                      08900003
089100                  B.TP_DKEY_TMST,                                 08910003
089200                  B.INCHG_CNTL_NBR,                               08920003
089300                  B.CRE_DTE,                                      08930003
089400                  B.CRE_TME,                                      08940003
089500                  B.MAILBOX_REC_DTE,                              08950003
089600                  B.MAILBOX_REC_TME,                              08960003
089700                  B.MAILBOX_PU_DTE,                               08970003
089800                  B.MAILBOX_PU_TME,                               08980003
089900                  B.ERR_IND,                                      08990003
090000                  B.PROD_TEST_IND,                                09000003
090100                  B.TRN_MANL_FRCD_IND                             09010003
090200         FROM     TTRDPRT A,                                      09020003
090300                  TINTTRN B,                                      09030003
090400                  TINTNOT C,                                      09040003
090500                  TENTNME D                                       09050003
090600         WHERE                                                    09060003
090700                (A.TP_DKEY = B.TP_DKEY)                       AND 09070003
090800                (B.TP_DKEY = C.TP_DKEY)                       AND 09080003
090900                (B.TP_DKEY_TMST = C.TP_DKEY_TMST)             AND 09090003
091000                (A.ENT_ID  = D.ENT_ID)                        AND 09100003
091100                (D.TYPE_CDE = '01')                           AND 09110003
091200                (C.RES_IND = 'N')                             AND 09120003
091300                (B.DIR_IND = 'R')                             AND 09130003
091400                (B.ERR_IND        = 'Y')                          09140003
091500         ORDER BY  B.TP_DKEY_TMST DESC                            09150003
091600     END-EXEC.                                                    09160003
091700                                                                  09170003
091800*---------------------------------------------------------------* 09180003
091900*  CURSOR USED WHEN COMING FROM ETLFAACK                          09190003
092000*---------------------------------------------------------------* 09200003
092100     EXEC SQL                                                     09210003
092200         DECLARE  CURSOR_THIRTEEN CURSOR FOR                      09220003
092300         SELECT DISTINCT                                          09230003
092400                  A.ENT_ID,                                       09240003
092500                  D.ENT_NAME_DESC,                                09250003
092600                  B.TP_DKEY,                                      09260003
092700                  B.TP_DKEY_TMST,                                 09270003
092800                  B.INCHG_CNTL_NBR,                               09280003
092900                  B.CRE_DTE,                                      09290003
093000                  B.CRE_TME,                                      09300003
093100                  B.MAILBOX_REC_DTE,                              09310003
093200                  B.MAILBOX_REC_TME,                              09320003
093300                  B.MAILBOX_PU_DTE,                               09330003
093400                  B.MAILBOX_PU_TME,                               09340003
093500                  B.ERR_IND,                                      09350003
093600                  B.PROD_TEST_IND,                                09360003
093700                  B.TRN_MANL_FRCD_IND                             09370003
093800         FROM     TTRDPRT A,                                      09380003
093900                  TINTTRN B,                                      09390003
094000                  TFGTRST C,                                      09400003
094100                  TENTNME D                                       09410003
094200         WHERE                                                    09420003
094300                (C.TP_DKEY        = :ASC-FGTRST-TP-DKEY)      AND 09430003
094400                (C.TP_DKEY_TMST   = :ASC-FGTRST-TP-DKEY-TMST) AND 09440003
094500                (B.TP_DKEY = C.TP_DKEY)                       AND 09450003
094600                (B.TP_DKEY_TMST = C.TP_DKEY_TMST)             AND 09460003
094700                (A.ENT_ID  = D.ENT_ID)                        AND 09470003
094800                (D.TYPE_CDE = '01')                           AND 09480003
094900                (A.TP_DKEY = B.TP_DKEY)                           09490003
095000         ORDER BY  B.TP_DKEY_TMST DESC                            09500003
095100     END-EXEC.                                                    09510003
095200                                                                  09520003
095300 EJECT                                                            09530003
095400 LINKAGE SECTION.                                                 09540003
095500                                                                  09550003
095600 01  DFHCOMMAREA.                                                 09560003
095700     05  FILLER                         OCCURS  1 TO 4072 TIMES   09570003
095800                                        DEPENDING ON EIBCALEN.    09580003
095900         10  FILLER                     PIC X.                    09590003
096000                                                                  09600003
096100 EJECT                                                            09610003
096200 PROCEDURE DIVISION.                                              09620003
096300******************************************************************09630003
096400**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **09640003
096500**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **09650003
096600**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **09660003
096700******************************************************************09670003
096800 0000-MAIN-MODULE.                                                09680003
096900     INITIALIZE DP030-CICS-API-FIELDS.                            09690003
097000     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       09700003
097100     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          09710003
097200     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         09720003
097300     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       09730003
097400     MOVE LENGTH OF ET321AI        TO DP030-MAP-LENGTH (1).       09740003
097500     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     09750003
097600     PERFORM 0001-CALL-CICS-ARCH-API.                             09760003
097700*                                                                 09770003
097800     PERFORM 1000-CONTROL-PROCESSING                              09780003
097900*                                                                 09790003
098000     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     09800003
098100     PERFORM 0001-CALL-CICS-ARCH-API.                             09810003
098200                                                                  09820003
098300******************************************************************09830003
098400**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **09840003
098500**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **09850003
098600******************************************************************09860003
098700 0001-CALL-CICS-ARCH-API.                                         09870003
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      09880008
098900                                    DFHCOMMAREA                   09890008
099000                                    DP030-CICS-API-FIELDS         09900008
099100                                    DP020-STANDARD-COMMAREA       09910008
099200                                    ET321AI.                      09920008
099300*                                                                 09930003
099400     IF  DP030-RC-CALL-SUCCESSFUL                                 09940003
099500         CONTINUE                                                 09950003
099600     ELSE                                                         09960003
099700         SET DP013-NO-ROLLBACK                                    09970003
099800             DP013-XCTL-DISPLAY-RESTART                           09980003
099900             DP013-CICS-ABEND      TO TRUE                        09990003
100000         MOVE '0001-CALL-CICS-ARCH-API'                           10000003
100100                                   TO DP013-PARAGRAPH             10010003
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O10020008
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      10030008
100400         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      10040003
100500         PERFORM DP013-0000-PROCESS-ABEND                         10050003
100600     END-IF.                                                      10060003
100700*----------------------------------------------------------------*10070003
100800* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *10080003
100900* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *10090003
101000*                                                                *10100003
101100* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *10110003
101200*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *10120003
101300*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *10130003
101400*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *10140003
101500*----------------------------------------------------------------*10150003
101600                                                                  10160003
101700 1000-CONTROL-PROCESSING.                                         10170003
101800                                                                  10180003
101900     EVALUATE TRUE                                                10190003
102000         WHEN DP020-NEXT-ACT-INITIAL                              10200003
102100             INITIALIZE ASC-SPECIFIC-COMMAREA                     10210003
102200             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            10220003
102300                                      ASC-SEL-TERM-ID             10230003
102400             MOVE DP020-SRC-TASK-NUMBER                           10240003
102500                                   TO ASC-LIST-TASK-NUMBER        10250003
102600                                      ASC-SEL-TASK-NUMBER         10260003
102700             MOVE PC-LIST-QUEUE-SEQ TO ASC-LIST-SEQ               10270003
102800             MOVE PC-SEL-QUEUE-SEQ  TO ASC-SEL-SEQ                10280003
102900             PERFORM 1100-PROCESS-INTER-APPL-COMM                 10290003
103000             IF PS-NO-ERROR                                       10300003
103100                 PERFORM 4000-BUILD-INITIAL-PANEL                 10310003
103200             END-IF                                               10320003
103300                                                                  10330003
103400         WHEN DP020-NEXT-ACT-READ-MAP                             10340003
103500             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        10350003
103600                                   TO PV-TOP-ITEM                 10360003
103700             PERFORM 2000-PROCESS-PANEL                           10370003
103800                                                                  10380003
103900         WHEN DP020-NEXT-ACT-RETURN                               10390003
104000             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        10400003
104100                                   TO PV-TOP-ITEM                 10410003
104200             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    10420003
104300             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 10430003
104400             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   10440003
104500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10450003
104600                                                                  10460003
104700         WHEN OTHER                                               10470003
104800             SET DP013-LOGIC-ABEND TO TRUE                        10480003
104900             SET DP013-NO-ROLLBACK TO TRUE                        10490003
105000             MOVE '1000-CONTROL-PROCESSING'                       10500003
105100                                   TO DP013-PARAGRAPH             10510003
105200             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    10520003
105300                                   TO DP013-MESSAGE-TEXT(1)       10530003
105400             PERFORM DP013-0000-PROCESS-ABEND                     10540003
105500     END-EVALUATE.                                                10550003
105600                                                                  10560003
105700 EJECT                                                            10570003
105800*----------------------------------------------------------------*10580003
105900* DETERMINE WHERE THE USER WAS COMING FROM. IF COMING FROM        10590003
106000* ETSINTXM, DETERMINE WHICH COMBINATION OF FIELDS WERE ENTERED.  *10600003
106100*----------------------------------------------------------------*10610003
106200                                                                  10620003
106300 1100-PROCESS-INTER-APPL-COMM.                                    10630003
106400                                                                  10640003
106500     IF DP020-INT-APPL-FORMAT-IND = '2'                           10650003
106600*--------COMING FROM ETSINTXM-----------------                    10660003
106700         MOVE '2' TO ASC-FORMAT-IND                               10670003
106800                                                                  10680003
106900         MOVE ET307-ENT-ID  TO ASC-ENT-ID                         10690003
107000                               TRDPRT-ENT-ID                      10700003
107100                                                                  10710003
107200         MOVE ET307-VENDOR-NAME         TO ASC-VENDOR-NAME        10720003
107300         MOVE ET307-DIRECTION-IND       TO ASC-DIRECTION          10730003
107400                                                                  10740003
107500*--------OPTIONAL FIELDS ---------------------                    10750003
107600                                                                  10760003
107700         IF ET307-CONTROL-NUM-X NOT = SPACES                      10770003
107800             MOVE ET307-CONTROL-NUM         TO ASC-CONTROL-NUM    10780003
107900         END-IF                                                   10790003
108000         IF ET307-NUM-XMITS-X   NOT = SPACES                      10800003
108100             MOVE ET307-NUM-XMITS         TO ASC-NUM-XMITS        10810003
108200         ELSE                                                     10820003
108300             MOVE 999999999               TO ASC-NUM-XMITS        10830003
108400         END-IF                                                   10840003
108500         MOVE ET307-ERROR-IND           TO ASC-ERROR-IND          10850003
108600         MOVE ET307-BEGIN-DT            TO ASC-BEGIN-DT           10860003
108700         MOVE ET307-END-DT              TO ASC-END-DT             10870003
108800         IF ET307-TRAN-SET NOT = SPACES                           10880003
108900             PERFORM 1200-VALIDATE-TRAN-SET                       10890003
109000         END-IF                                                   10900003
109100                                                                  10910003
109200         IF ET307-CONTROL-NUM-X NOT = SPACES                      10920003
109300             MOVE '1' TO ASC-COMBINATION                          10930003
109400         ELSE                                                     10940003
109500             IF ET307-NUM-XMITS-X NOT  = SPACE                    10950003
109600                 IF ASC-TRAN-SET = SPACES                         10960003
109700                     MOVE '2' TO ASC-COMBINATION                  10970003
109800                 ELSE                                             10980003
109900                     MOVE '3' TO ASC-COMBINATION                  10990003
110000                 END-IF                                           11000003
110100             ELSE                                                 11010003
110200                 IF (ASC-BEGIN-DT NOT = SPACES)      AND          11020003
110300                    (ASC-END-DT NOT = SPACES)                     11030003
110400                     IF ASC-TRAN-SET = SPACES                     11040003
110500                         MOVE '5' TO ASC-COMBINATION              11050003
110600                     ELSE                                         11060003
110700                         MOVE '4' TO ASC-COMBINATION              11070003
110800                     END-IF                                       11080003
110900                 ELSE                                             11090003
111000                     MOVE '2' TO ASC-COMBINATION                  11100003
111100                 END-IF                                           11110003
111200             END-IF                                               11120003
111300         END-IF                                                   11130003
111400                                                                  11140003
111500     ELSE                                                         11150003
111600         MOVE 999999999               TO ASC-NUM-XMITS            11160003
111700         IF  DP020-INT-APPL-FORMAT-IND = '3'                      11170003
111800*--------COMING FROM ETSDOCXM-----------------                    11180003
111900                                                                  11190003
112000             MOVE '3' TO ASC-FORMAT-IND                           11200003
112100             MOVE ET307-DOC-DTL        TO ASC-DOC-DTL             11210003
112200                                          ASC-DOC-DTL-HIGH        11220003
112300                                          ASC-DOC-DTL-LOW         11230003
112400                                                                  11240003
112500             MOVE ET307-DIRECTION-IND  TO ASC-DIRECTION           11250003
112600                                                                  11260003
112700             INSPECT  ASC-DOC-DTL-LOW                             11270003
112800             REPLACING  ALL '*' BY LOW-VALUES                     11280003
112900                                                                  11290003
113000             INSPECT  ASC-DOC-DTL-HIGH                            11300003
113100             REPLACING  ALL '*' BY HIGH-VALUES                    11310003
113200                                                                  11320003
113300             PERFORM 1200-VALIDATE-TRAN-SET                       11330003
113400         ELSE                                                     11340003
113500             IF  DP020-INT-APPL-FORMAT-IND = '4'                  11350003
113600*--------COMING FROM ETLFAACK-----------------                    11360003
113700                 MOVE '4' TO ASC-FORMAT-IND                       11370003
113800                 MOVE ET307-NUMBER-OF-TS-ITEMS                    11380003
113900                          TO ASC-NUMBER-OF-TS-ITEMS               11390003
114000                 MOVE ET307-SEL-QUEUE-NAME                        11400003
114100                          TO ASC-SEL-QUEUE2-NAME                  11410003
114200                 MOVE ET308-MAX-ITEMS TO ASC-SEL-SUB              11420003
114300                 MOVE ZERO TO ASC-SEL-ITEM                        11430003
114400                 PERFORM 2180-GET-NEXT-ITEM                       11440003
114500             END-IF                                               11450003
114600         END-IF                                                   11460003
114700     END-IF.                                                      11470003
114800                                                                  11480003
114900                                                                  11490003
115000*----------------------------------------------------------------*11500003
115100* IF A TRANSACTION SET WAS PASSED TO THIS PROGRAM, VALIDATE IT.   11510003
115200*----------------------------------------------------------------*11520003
115300                                                                  11530003
115400 1200-VALIDATE-TRAN-SET.                                          11540003
115500                                                                  11550003
115600     MOVE ET307-TRAN-SET TO ASC-TRAN-SET.                         11560003
115700     EXEC SQL                                                     11570003
115800         SELECT TRAN_SET_CDE                                      11580003
115900         INTO  :TRNSET-TRAN-SET-CDE                               11590003
116000         FROM TTRNSET                                             11600003
116100         WHERE (TRAN_SET_CDE = :ASC-TRAN-SET)                     11610003
116200     END-EXEC                                                     11620003
116300                                                                  11630003
116400     EVALUATE TRUE                                                11640003
116500         WHEN SQLCODE = ZERO                                      11650003
116600             MOVE TRNSET-TRAN-SET-CDE TO ASC-TRAN-SET             11660003
116700         WHEN SQLCODE = +100                                      11670003
116800                                                                  11680003
116900             EXEC SQL                                             11690003
117000                 SELECT TRAN_SET_CDE                              11700003
117100                 INTO  :TRNSET-TRAN-SET-CDE                       11710003
117200                 FROM TTRNSET                                     11720003
117300                 WHERE (TRAN_SET_NME_ID = :ASC-TRAN-SET)          11730003
117400             END-EXEC                                             11740003
117500                                                                  11750003
117600             EVALUATE TRUE                                        11760003
117700                 WHEN SQLCODE = ZERO                              11770003
117800                     MOVE TRNSET-TRAN-SET-CDE TO ASC-TRAN-SET     11780003
117900                 WHEN SQLCODE = +100                              11790003
118000                     SET DP020-NEXT-ACT-APPL-ERROR TO TRUE        11800003
118100                     SET DP020-MSG-FATAL                          11810003
118200                         PS-ERROR          TO TRUE                11820003
118300*            ---- INVALID VALUE  ----                             11830003
118400                     MOVE PC-TSYMSG-00005  TO  DP020-MSG-NUMBER   11840003
118500                                                                  11850003
118600                 WHEN SQLWARN0 NOT = SPACES                       11860003
118700                 WHEN SQLCODE  NOT = ZERO                         11870003
118800                     MOVE '1200-VALIDATE-TRAN-SET'                11880003
118900                                       TO DP013-PARAGRAPH         11890003
119000                     MOVE 'READING TTRNSET TABLE'                 11900003
119100                                       TO DP013-MESSAGE-TEXT (1)  11910003
119200                     MOVE SQLCA        TO DP013-SQLCA             11920003
119300                     SET DP013-DB2-ABEND                          11930003
119400                         DP013-XCTL-DISPLAY-RESTART TO TRUE       11940003
119500                     PERFORM DP013-0000-PROCESS-ABEND             11950003
119600             END-EVALUATE                                         11960003
119700                                                                  11970003
119800         WHEN SQLWARN0 NOT = SPACES                               11980003
119900         WHEN SQLCODE  NOT = ZERO                                 11990003
120000             MOVE '1200-VALIDATE-TRAN-SET'                        12000003
120100                               TO DP013-PARAGRAPH                 12010003
120200             MOVE 'READING TTRNSET TABLE'                         12020003
120300                               TO DP013-MESSAGE-TEXT (1)          12030003
120400             MOVE SQLCA        TO DP013-SQLCA                     12040003
120500             SET DP013-DB2-ABEND                                  12050003
120600                 DP013-XCTL-DISPLAY-RESTART TO TRUE               12060003
120700             PERFORM DP013-0000-PROCESS-ABEND                     12070003
120800     END-EVALUATE.                                                12080003
120900                                                                  12090003
121000                                                                  12100003
121100                                                                  12110003
121200 EJECT                                                            12120003
121300*----------------------------------------------------------------*12130003
121400* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *12140003
121500* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *12150003
121600* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *12160003
121700* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *12170003
121800* FUNCTION KEYS CAN GET THIS FAR.                                *12180003
121900*----------------------------------------------------------------*12190003
122000                                                                  12200003
122100 2000-PROCESS-PANEL.                                              12210003
122200     EVALUATE TRUE                                                12220003
122300         WHEN DP020-SRC-AID = DP016-CLEAR                         12230003
122400             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    12240003
122500             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   12250003
122600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12260003
122700                                                                  12270003
122800         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    12280003
122900             PERFORM 2050-DELETE-LIST-QUEUE                       12290003
123000             PERFORM 4000-BUILD-INITIAL-PANEL                     12300003
123100                                                                  12310003
123200         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    12320003
123300             PERFORM 2140-DESELECT-ALL-ITEMS                      12330003
123400             PERFORM 3200-RESET-ATTRIBUTES                        12340003
123500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12350003
123600                                                                  12360003
123700         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  12370003
123800             PERFORM 2150-SELECT-ALL-ITEMS                        12380003
123900             PERFORM 3200-RESET-ATTRIBUTES                        12390003
124000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12400003
124100                                                                  12410003
124200         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             12420003
124300             PERFORM 2050-DELETE-LIST-QUEUE                       12430003
124400             IF ASC-FORMAT-IND = '4'                              12440003
124500                 PERFORM 2180-GET-NEXT-ITEM                       12450003
124600                 IF PS-LIST-END                                   12460003
124700                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         12470003
124800                     SET PS-NO-LIST-END TO TRUE                   12480003
124900                 ELSE                                             12490003
125000                     PERFORM 4000-BUILD-INITIAL-PANEL             12500003
125100                 END-IF                                           12510003
125200             ELSE                                                 12520003
125300                 MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER         12530003
125400                 SET DP020-MSG-INFORMATIONAL TO TRUE              12540003
125500             END-IF                                               12550003
125600                                                                  12560003
125700         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             12570003
125800             PERFORM 2050-DELETE-LIST-QUEUE                       12580003
125900             IF ASC-FORMAT-IND = '4'                              12590003
126000                 PERFORM 2190-GET-PREV-ITEM                       12600003
126100                 IF PS-LIST-END                                   12610003
126200                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         12620003
126300                     SET PS-NO-LIST-END TO TRUE                   12630003
126400                 ELSE                                             12640003
126500                     PERFORM 4000-BUILD-INITIAL-PANEL             12650003
126600                 END-IF                                           12660003
126700             ELSE                                                 12670003
126800                 MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER         12680003
126900                 SET DP020-MSG-INFORMATIONAL TO TRUE              12690003
127000             END-IF                                               12700003
127100                                                                  12710003
127200         WHEN OTHER                                               12720003
127300             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 12730003
127400             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   12740003
127500             IF  PS-NO-ERROR                                      12750003
127600                 SET DP030-CONTINUE-GO TO TRUE                    12760003
127700                 PERFORM 2100-CHECK-FUNCTION-KEY                  12770003
127800             ELSE                                                 12780003
127900                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             12790003
128000                 SET DP030-OVERRIDE-GO TO TRUE                    12800003
128100             END-IF                                               12810003
128200     END-EVALUATE.                                                12820003
128300 EJECT                                                            12830003
128400*----------------------------------------------------------------*12840003
128500*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *12850003
128600*----------------------------------------------------------------*12860003
128700 2050-DELETE-LIST-QUEUE.                                          12870003
128800                                                                  12880003
128900     EXEC CICS                                                    12890003
129000         DELETEQ TS                                               12900003
129100             QUEUE (ASC-LIST-QUEUE-NAME)                          12910003
129200             RESP  (PV-CICS-RESP)                                 12920003
129300     END-EXEC.                                                    12930003
129400                                                                  12940003
129500     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       12950003
129600        (PV-CICS-RESP = DFHRESP(QIDERR))                          12960003
129700         CONTINUE                                                 12970003
129800     ELSE                                                         12980003
129900         SET DP013-CICS-ABEND      TO TRUE                        12990003
130000         SET DP013-NO-ROLLBACK     TO TRUE                        13000003
130100                                                                  13010003
130200         MOVE '2050-DELETE-LIST-QUEUE'                            13020003
130300                                   TO DP013-PARAGRAPH             13030003
130400         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    13040003
130500                                   TO DP013-MESSAGE-TEXT (1)      13050003
130600         PERFORM DP013-0000-PROCESS-ABEND                         13060003
130700     END-IF.                                                      13070003
130800                                                                  13080003
130900     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  13090003
131000 EJECT                                                            13100003
131100*----------------------------------------------------------------*13110003
131200* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*13120003
131300* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *13130003
131400* CICS ARCHITECTURE API.                                         *13140003
131500*----------------------------------------------------------------*13150003
131600 2100-CHECK-FUNCTION-KEY.                                         13160003
131700     EVALUATE TRUE                                                13170003
131800         WHEN DP020-FK-LOCAL-GOTO(DP020-SRC-AID)                  13180003
131900             IF  ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              13190003
132000                 INITIALIZE ET307-INTER-APPL-COMMAREA             13200003
132100                 MOVE ASC-NUMBER-OF-SELECTED-ITEMS                13210003
132200                                TO ET307-NUMBER-OF-SELECTED-ITEMS 13220003
132300                 MOVE ASC-DIRECTION TO ET307-DIRECTION-IND        13230003
132400                 PERFORM 5000-PREPARE-SEL-QUEUE                   13240003
132500             ELSE                                                 13250003
132600                 SET DP030-OVERRIDE-GO                            13260003
132700                                   TO TRUE                        13270003
132800*                ---- A LIST ITEM MUST BE SELECTED ----           13280003
132900                 MOVE PC-TSYMSG-00057                             13290003
133000                                   TO DP020-MSG-NUMBER            13300003
133100                 SET DP020-MSG-WARNING                            13310003
133200                                   TO TRUE                        13320003
133300                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             13330003
133400             END-IF                                               13340003
133500                                                                  13350003
133600         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  13360003
133700             MOVE +1               TO PV-TOP-ITEM                 13370003
133800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13380003
133900                                                                  13390003
134000         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   13400003
134100             PERFORM 2110-BROWSE-BACKWARD                         13410003
134200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13420003
134300                                                                  13430003
134400         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   13440003
134500             PERFORM 2120-BROWSE-FORWARD                          13450003
134600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13460003
134700                                                                  13470003
134800         WHEN DP020-SRC-AID = DP016-ENTER                         13480003
134900             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   13490003
135000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 13500003
135100                                                                  13510003
135200         WHEN OTHER                                               13520003
135300             SET DP013-NO-ROLLBACK                                13530003
135400                 DP013-XCTL-DISPLAY-RESTART                       13540003
135500                 DP013-CICS-ABEND  TO TRUE                        13550003
135600             MOVE '2100-CHECK-FUNCTION-KEY'                       13560003
135700                                   TO DP013-PARAGRAPH             13570003
135800             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      13580003
135900                                   TO DP013-MESSAGE-TEXT (1)      13590003
136000             PERFORM DP013-0000-PROCESS-ABEND                     13600003
136100     END-EVALUATE.                                                13610003
136200                                                                  13620003
136300*----------------------------------------------------------------*13630003
136400*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *13640003
136500*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *13650003
136600*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *13660003
136700*    MESSAGE.                                                    *13670003
136800*----------------------------------------------------------------*13680003
136900                                                                  13690003
137000 2110-BROWSE-BACKWARD.                                            13700003
137100     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    13710003
137200         GIVING PV-TOP-ITEM.                                      13720003
137300*                                                                 13730003
137400     IF  ((PV-TOP-ITEM < +1)                                      13740003
137500       OR (PV-TOP-ITEM = +1))                                     13750003
137600         MOVE +1                   TO PV-TOP-ITEM                 13760003
137700*        -- TOP OF LIST --                                        13770003
137800         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            13780003
137900         SET DP020-MSG-INFORMATIONAL TO TRUE                      13790003
138000     END-IF.                                                      13800003
138100                                                                  13810003
138200 EJECT                                                            13820003
138300*----------------------------------------------------------------*13830003
138400*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *13840003
138500*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *13850003
138600*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *13860003
138700*----------------------------------------------------------------*13870003
138800                                                                  13880003
138900 2120-BROWSE-FORWARD.                                             13890003
139000                                                                  13900003
139100     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              13910003
139200         GIVING PV-TOP-ITEM.                                      13920003
139300     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   13930003
139400         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            13940003
139500                                   TO PV-TOP-ITEM                 13950003
139600*        -- BOTTOM OF LIST --                                     13960003
139700         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            13970003
139800         SET DP020-MSG-INFORMATIONAL                              13980003
139900                                   TO TRUE                        13990003
140000     ELSE                                                         14000003
140100         COMPUTE PV-BOTTOM-ITEM =                                 14010003
140200             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 14020003
140300         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            14030003
140400*            -- BOTTOM OF LIST --                                 14040003
140500             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            14050003
140600             SET DP020-MSG-INFORMATIONAL                          14060003
140700                                   TO TRUE                        14070003
140800         END-IF                                                   14080003
140900     END-IF.                                                      14090003
141000 EJECT                                                            14100003
141100*----------------------------------------------------------------*14110003
141200*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *14120003
141300*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *14130003
141400*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *14140003
141500*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *14150003
141600*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *14160003
141700*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *14170003
141800*----------------------------------------------------------------*14180003
141900                                                                  14190003
142000 2130-CHECK-FOR-JUMP-BROWSE.                                      14200003
142100     IF (ASC-START-ITEM-REQUEST = SPACE)                          14210003
142200         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            14220003
142300                                   TO PV-TOP-ITEM                 14230003
142400     ELSE                                                         14240003
142500         MOVE ASC-START-ITEM-REQUEST  TO DP010I-UNEDITED-FIELD    14250003
142600         MOVE PC-ITEM-NUMBER-LENGTH   TO DP010I-MAXIMUM-DIGITS    14260003
142700         MOVE +0                      TO DP010I-MAXIMUM-DECIMALS  14270003
142800         SET DP010I-NEGATIVE-NOT-ALLOWED                          14280003
142900                                   TO TRUE                        14290003
143010         CALL DP010I-NUMERIC-EDIT-ROUTINE                         14301004
143020                         USING DP010I-NUMERIC-EDIT-AREA           14302004
143100                                                                  14310003
143200         IF  NOT DP010I-ERROR-DETECTED                            14320003
143300             MOVE DP010I-NUMERIC-FIELD                            14330003
143400                                   TO  ASC-START-ITEM-REQUEST-N   14340003
143500             IF  ASC-START-ITEM-REQUEST-N > ZERO                  14350003
143600                 IF  ASC-START-ITEM-REQUEST-N >                   14360003
143700                                          ASC-NUMBER-OF-ITEMS-READ14370003
143800                     MOVE SPACE TO ASC-START-ITEM-REQUEST         14380003
143900                     COMPUTE PV-TOP-ITEM =                        14390003
144000                             ASC-NUMBER-OF-ITEMS-READ             14400003
144100                             - PC-ITEMS-PER-PANEL + 1             14410003
144200                     IF  PV-TOP-ITEM < +1                         14420003
144300                         MOVE +1   TO PV-TOP-ITEM                 14430003
144400*                        ---- BOTTOM OF LIST ----                 14440003
144500                         MOVE PC-TSYMSG-00070                     14450003
144600                                   TO DP020-MSG-NUMBER            14460003
144700                         SET DP020-MSG-INFORMATIONAL              14470003
144800                                   TO TRUE                        14480003
144900                     END-IF                                       14490003
145000                 ELSE                                             14500003
145100                     MOVE ASC-START-ITEM-REQUEST-N                14510003
145200                                   TO PV-TOP-ITEM                 14520003
145300                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      14530003
145400                     COMPUTE PV-BOTTOM-ITEM =                     14540003
145500                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     14550003
145600                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ14560003
145700*                        -- BOTTOM OF LIST --                     14570003
145800                         MOVE PC-TSYMSG-00070                     14580003
145900                                   TO DP020-MSG-NUMBER            14590003
146000                         SET DP020-MSG-INFORMATIONAL              14600003
146100                                   TO TRUE                        14610003
146200                     END-IF                                       14620003
146300                 END-IF                                           14630003
146400             ELSE                                                 14640003
146500*                --- VALUE OUT OF RANGE ----                      14650003
146600                 MOVE PC-TSYMSG-00101     TO DP020-MSG-NUMBER     14660003
146700                 MOVE -1                  TO ASTRTITL             14670003
146800                 SET DP030-SET-CURSOR-APPL-1                      14680003
146900                                          TO TRUE                 14690003
147000                 MOVE DP015-REVERSE       TO ASTRTITH             14700003
147100                 MOVE DP015-RED           TO ASTRTITC             14710003
147200                 MOVE DP015-UNP-NUM-BRT-OFF                       14720003
147300                                          TO ASTRTITA             14730003
147400                 SET DP020-MSG-FATAL      TO TRUE                 14740003
147500                 SET PS-START-ITEM-ERROR TO TRUE                  14750003
147600             END-IF                                               14760003
147700                                                                  14770003
147800         ELSE                                                     14780003
147900*            ---- MUST BE NUMERIC ----                            14790003
148000             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      14800003
148100             MOVE -1                     TO ASTRTITL              14810003
148200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  14820003
148300             MOVE DP015-REVERSE          TO ASTRTITH              14830003
148400             MOVE DP015-RED              TO ASTRTITC              14840003
148500             MOVE DP015-UNP-NUM-BRT-OFF  TO ASTRTITA              14850003
148600             SET DP020-MSG-FATAL         TO TRUE                  14860003
148700             SET PS-START-ITEM-ERROR     TO TRUE                  14870003
148800         END-IF                                                   14880003
148900     END-IF.                                                      14890003
149000 EJECT                                                            14900003
149100*----------------------------------------------------------------*14910003
149200*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *14920003
149300*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *14930003
149400*----------------------------------------------------------------*14940003
149500 2140-DESELECT-ALL-ITEMS.                                         14950003
149600     MOVE +1                       TO ASC-BLK-SUB.                14960003
149700                                                                  14970003
149800     PERFORM 2141-CLEAR-SELECTED-INDS                             14980003
149900         VARYING ASC-ITEM-SUB                                     14990003
150000         FROM 1 BY 1                                              15000003
150100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 15010003
150200                                                                  15020003
150300     ADD +1                        TO ASC-BLK-SUB.                15030003
150400                                                                  15040003
150500     PERFORM 2141-CLEAR-SELECTED-INDS                             15050003
150600         VARYING ASC-ITEM-SUB                                     15060003
150700         FROM 1 BY 1                                              15070003
150800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 15080003
150900                                                                  15090003
151000     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               15100003
151100                                   TO PV-LIST-ITEM-NUMBER.        15110003
151200                                                                  15120003
151300     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            15130003
151400         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    15140003
151500                                                                  15150003
151600     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     15160003
151700        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      15170003
151800         MOVE +1                   TO ASC-BLK-SUB                 15180003
151900                                                                  15190003
152000         PERFORM 5100-WRITE-TEMP-STORAGE                          15200003
152100                                                                  15210003
152200         MOVE +1                   TO PV-BLOCK-NUMBER             15220003
152300                                                                  15230003
152400         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         15240003
152500             PV-FIRST-BLOCK-IN-ARRAY - 1                          15250003
152600                                                                  15260003
152700         PERFORM                                                  15270003
152800             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       15280003
152900                                                                  15290003
153000             PERFORM 4410-READ-TEMP-STORAGE                       15300003
153100                                                                  15310003
153200             PERFORM 2141-CLEAR-SELECTED-INDS                     15320003
153300                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 15330003
153400                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          15340003
153500                                                                  15350003
153600             PERFORM 5100-WRITE-TEMP-STORAGE                      15360003
153700                                                                  15370003
153800             ADD +1                TO PV-BLOCK-NUMBER             15380003
153900                                                                  15390003
154000         END-PERFORM                                              15400003
154100                                                                  15410003
154200         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         15420003
154300             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     15430003
154400                                                                  15440003
154500         PERFORM                                                  15450003
154600             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       15460003
154700                   ASC-HIGHEST-BLOCK-WRITTEN                      15470003
154800                                                                  15480003
154900             MOVE PV-NEXT-BLOCK-IN-ARRAY                          15490003
155000                                   TO PV-BLOCK-NUMBER             15500003
155100                                                                  15510003
155200             PERFORM 4410-READ-TEMP-STORAGE                       15520003
155300                                                                  15530003
155400             PERFORM 2141-CLEAR-SELECTED-INDS                     15540003
155500                 VARYING ASC-ITEM-SUB                             15550003
155600                 FROM 1 BY 1                                      15560003
155700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          15570003
155800                                                                  15580003
155900             PERFORM 5100-WRITE-TEMP-STORAGE                      15590003
156000                                                                  15600003
156100             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      15610003
156200                                                                  15620003
156300         END-PERFORM                                              15630003
156400                                                                  15640003
156500         MOVE PV-FIRST-BLOCK-IN-ARRAY                             15650003
156600                                   TO PV-BLOCK-NUMBER             15660003
156700                                                                  15670003
156800         PERFORM 4410-READ-TEMP-STORAGE                           15680003
156900     END-IF.                                                      15690003
157000                                                                  15700003
157100                                                                  15710003
157200     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 15720003
157300     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.15730003
157400     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  15740003
157500                                                                  15750003
157600     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        15760003
157700                                                                  15770003
157800 EJECT                                                            15780003
157900*----------------------------------------------------------------*15790003
158000*    MARK EACH ITEM AS BEING NOT SELECTED.                       *15800003
158100*----------------------------------------------------------------*15810003
158200                                                                  15820003
158300 2141-CLEAR-SELECTED-INDS.                                        15830003
158400                                                                  15840003
158500     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           15850003
158600             NOT EQUAL ZERO                                       15860003
158700         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          15870003
158800             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          15880003
158900                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    15890003
159000                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  15900003
159100                                   TO TRUE                        15910003
159200         END-IF                                                   15920003
159300     END-IF.                                                      15930003
159400                                                                  15940003
159500 EJECT                                                            15950003
159600*----------------------------------------------------------------*15960003
159700*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *15970003
159800*  FOR ALL ITEMS.                                                *15980003
159900*----------------------------------------------------------------*15990003
160000                                                                  16000003
160100 2150-SELECT-ALL-ITEMS.                                           16010003
160200                                                                  16020003
160300     MOVE +1                       TO ASC-BLK-SUB.                16030003
160400                                                                  16040003
160500     PERFORM 2151-SET-SELECTED-INDS                               16050003
160600         VARYING ASC-ITEM-SUB                                     16060003
160700         FROM 1 BY 1                                              16070003
160800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 16080003
160900                                                                  16090003
161000     ADD +1                        TO ASC-BLK-SUB.                16100003
161100                                                                  16110003
161200     PERFORM 2151-SET-SELECTED-INDS                               16120003
161300         VARYING ASC-ITEM-SUB                                     16130003
161400         FROM 1 BY 1                                              16140003
161500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 16150003
161600                                                                  16160003
161700     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               16170003
161800                                   TO PV-LIST-ITEM-NUMBER.        16180003
161900                                                                  16190003
162000     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            16200003
162100         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    16210003
162200                                                                  16220003
162300     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     16230003
162400        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    16240003
162500         MOVE +1                   TO ASC-BLK-SUB                 16250003
162600                                                                  16260003
162700         PERFORM 5100-WRITE-TEMP-STORAGE                          16270003
162800                                                                  16280003
162900         MOVE +1                   TO PV-BLOCK-NUMBER             16290003
163000                                                                  16300003
163100         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         16310003
163200             PV-FIRST-BLOCK-IN-ARRAY - 1                          16320003
163300                                                                  16330003
163400         PERFORM                                                  16340003
163500             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       16350003
163600                                                                  16360003
163700             PERFORM 4410-READ-TEMP-STORAGE                       16370003
163800                                                                  16380003
163900             PERFORM 2151-SET-SELECTED-INDS                       16390003
164000                 VARYING ASC-ITEM-SUB                             16400003
164100                 FROM 1 BY 1                                      16410003
164200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          16420003
164300                                                                  16430003
164400             PERFORM 5100-WRITE-TEMP-STORAGE                      16440003
164500                                                                  16450003
164600             ADD +1                TO PV-BLOCK-NUMBER             16460003
164700                                                                  16470003
164800         END-PERFORM                                              16480003
164900                                                                  16490003
165000         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         16500003
165100             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     16510003
165200                                                                  16520003
165300         PERFORM                                                  16530003
165400             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       16540003
165500                   ASC-HIGHEST-BLOCK-WRITTEN                      16550003
165600                                                                  16560003
165700             MOVE PV-NEXT-BLOCK-IN-ARRAY                          16570003
165800                                   TO PV-BLOCK-NUMBER             16580003
165900                                                                  16590003
166000             PERFORM 4410-READ-TEMP-STORAGE                       16600003
166100                                                                  16610003
166200             PERFORM 2151-SET-SELECTED-INDS                       16620003
166300                 VARYING ASC-ITEM-SUB                             16630003
166400                 FROM 1 BY 1                                      16640003
166500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          16650003
166600                                                                  16660003
166700             PERFORM 5100-WRITE-TEMP-STORAGE                      16670003
166800                                                                  16680003
166900             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      16690003
167000                                                                  16700003
167100         END-PERFORM                                              16710003
167200                                                                  16720003
167300         MOVE PV-FIRST-BLOCK-IN-ARRAY                             16730003
167400                                   TO PV-BLOCK-NUMBER             16740003
167500                                                                  16750003
167600         PERFORM 4410-READ-TEMP-STORAGE                           16760003
167700     END-IF.                                                      16770003
167800                                                                  16780003
167900                                                                  16790003
168000     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             16800003
168100                       ASC-NUMBER-OF-SELECTED-ITEMS.              16810003
168200                                                                  16820003
168300     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        16830003
168400                                                                  16840003
168500 EJECT                                                            16850003
168600*----------------------------------------------------------------*16860003
168700*    MARK EACH ITEM AS BEING SELECTED.                           *16870003
168800*----------------------------------------------------------------*16880003
168900                                                                  16890003
169000 2151-SET-SELECTED-INDS.                                          16900003
169100                                                                  16910003
169200     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           16920003
169300             NOT EQUAL ZERO                                       16930003
169400         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             16940003
169500             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             16950003
169600                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        16960003
169700                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  16970003
169800                               TO  TRUE                           16980003
169900         END-IF                                                   16990003
170000     END-IF.                                                      17000003
170100                                                                  17010003
170200                                                                  17020003
170300******************************************************************17030003
170400** GET THE NEXT VENDOR FROM THE LIST QUEUE.                       17040003
170500******************************************************************17050003
170600 2180-GET-NEXT-ITEM.                                              17060003
170700     ADD +1                       TO ASC-SEL-SUB.                 17070003
170800     IF  ASC-SEL-SUB > ET308-MAX-ITEMS                            17080003
170900         ADD +1                   TO ASC-SEL-ITEM                 17090003
171000         MOVE +1                  TO ASC-SEL-SUB                  17100003
171100     END-IF.                                                      17110003
171200     IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                 17120003
171300         PERFORM 9100-READ-SEL-QUEUE                              17130003
171400         IF  ET308-ITEM (ASC-SEL-SUB) > ZERO                      17140003
171500             MOVE ET308-TP-DKEY (ASC-SEL-SUB)                     17150003
171600                                    TO ASC-FGTRST-TP-DKEY         17160003
171700             MOVE ET308-TP-DKEY-TMST  (ASC-SEL-SUB)               17170003
171800                                    TO ASC-FGTRST-TP-DKEY-TMST    17180003
171900                                                                  17190003
172000             SET ET308-INQ (ASC-SEL-SUB) TO TRUE                  17200003
172100             PERFORM 9200-REWRITE-SEL-QUEUE                       17210003
172200         ELSE                                                     17220003
172300             SUBTRACT +1 FROM ASC-SEL-SUB                         17230003
172400*            ---- BOTTOM OF LIST ----                             17240003
172500             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             17250003
172600             SET DP020-MSG-INFORMATIONAL TO TRUE                  17260003
172700             SET PS-LIST-END             TO TRUE                  17270003
172800         END-IF                                                   17280003
172900     ELSE                                                         17290003
173000         SUBTRACT +1 FROM ASC-SEL-ITEM                            17300003
173100         MOVE ET308-MAX-ITEMS     TO ASC-SEL-SUB                  17310003
173200*        ---- BOTTOM OF LIST ----                                 17320003
173300         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             17330003
173400         SET DP020-MSG-INFORMATIONAL TO TRUE                      17340003
173500         SET PS-LIST-END             TO TRUE                      17350003
173600     END-IF.                                                      17360003
173700                                                                  17370003
173800******************************************************************17380003
173900** GET THE PREVIOUS VENDOR FROM THE LIST QUEUE.                   17390003
174000******************************************************************17400003
174100 2190-GET-PREV-ITEM.                                              17410003
174200                                                                  17420003
174300     SUBTRACT +1 FROM ASC-SEL-SUB.                                17430003
174400     IF  ASC-SEL-SUB < +1                                         17440003
174500         SUBTRACT +1 FROM ASC-SEL-ITEM                            17450003
174600         MOVE ET308-MAX-ITEMS     TO ASC-SEL-SUB                  17460003
174700     END-IF.                                                      17470003
174800                                                                  17480003
174900     IF  ASC-SEL-ITEM > ZERO                                      17490003
175000         PERFORM 9100-READ-SEL-QUEUE                              17500003
175100             MOVE ET308-TP-DKEY (ASC-SEL-SUB)                     17510003
175200                                     TO ASC-FGTRST-TP-DKEY        17520003
175300             MOVE ET308-TP-DKEY-TMST  (ASC-SEL-SUB)               17530003
175400                                     TO ASC-FGTRST-TP-DKEY-TMST   17540003
175500     ELSE                                                         17550003
175600         MOVE +1                  TO ASC-SEL-ITEM                 17560003
175700                                     ASC-SEL-SUB                  17570003
175800*        ---- TOP OF LIST ----                                    17580003
175900         MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             17590003
176000         SET DP020-MSG-INFORMATIONAL TO TRUE                      17600003
176100         SET PS-LIST-END             TO TRUE                      17610003
176200     END-IF.                                                      17620003
176300                                                                  17630003
176400******************************************************************17640003
176500** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **17650003
176600** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **17660003
176700******************************************************************17670003
176800 2200-MOVE-SCREEN-TO-COMMAREA.                                    17680003
176900                                                                  17690003
177000     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             17700003
177100     MOVE +1                       TO PV-SUB.                     17710003
177200*                                                                 17720003
177300     PERFORM 3100-SET-SUBSCRIPTS.                                 17730003
177400     IF  ASTRTITL > ZERO                                          17740003
177500         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          17750003
177600     ELSE                                                         17760003
177700         IF ASTRTITF = DP015-ERASE-EOF                            17770003
177800             MOVE SPACE TO ASC-START-ITEM-REQUEST                 17780003
177900         END-IF.                                                  17790003
178000                                                                  17800003
178100     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          17810003
178200         VARYING PV-SUB                                           17820003
178300         FROM 1 BY 1                                              17830003
178400         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      17840003
178500******************************************************************17850003
178600** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**17860003
178700******************************************************************17870003
178800 2210-MOVE-LINES-TO-COMMAREA.                                     17880003
178900     IF  MR-SELECTL (PV-SUB) > ZERO                               17890003
179000         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             17900003
179100         MOVE MR-SELECTI (PV-SUB)                                 17910003
179200                                   TO ASC-TEMP-SELECTED-SW        17920003
179300                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      17930003
179400     ELSE                                                         17940003
179500         IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                17950003
179600                 SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     17960003
179700                 MOVE SPACE        TO ASC-TEMP-SELECTED-SW        17970003
179800                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      17980003
179900         END-IF                                                   17990003
180000     END-IF.                                                      18000003
180100     ADD +1                        TO ASC-ITEM-SUB.               18010003
180200     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        18020003
180300         ADD +1                    TO ASC-BLK-SUB                 18030003
180400         MOVE +1                   TO ASC-ITEM-SUB                18040003
180500     END-IF.                                                      18050003
180600******************************************************************18060003
180700** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **18070003
180800** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **18080003
180900******************************************************************18090003
181000 3000-EDIT-DATA-IN-COMMAREA.                                      18100003
181100     SET PS-NO-ERROR               TO TRUE.                       18110003
181200     PERFORM 3200-RESET-ATTRIBUTES.                               18120003
181300     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     18130003
181400**                                                                18140003
181500* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              18150003
181600* EDITTING IS DONE FROM THE BOTTOM UP.                            18160003
181700**                                                                18170003
181800     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       18180003
181900         ASC-ITEMS-DISPLAYED - 1.                                 18190003
182000     PERFORM 3100-SET-SUBSCRIPTS.                                 18200003
182100     PERFORM 3300-EDIT-SELECTIONS                                 18210003
182200         VARYING PV-SUB                                           18220003
182300         FROM PV-SUB BY -1                                        18230003
182400         UNTIL PV-SUB < +1                                        18240003
182500*                                                                 18250003
182600     IF  PS-NO-ERROR                                              18260003
182700         PERFORM 3400-CHECK-RANGE-SEQUENCE                        18270003
182800     END-IF.                                                      18280003
182900*                                                                 18290003
183000     IF  ((PS-NO-ERROR)                                           18300003
183100       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   18310003
183200       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    18320003
183300             PERFORM 3500-MARK-RANGE-AS-SELECTED                  18330003
183400     END-IF.                                                      18340003
183500 EJECT                                                            18350003
183600*----------------------------------------------------------------*18360003
183700*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *18370003
183800*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*18380003
183900*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *18390003
184000*                                                                *18400003
184100*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *18410003
184200*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *18420003
184300*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *18430003
184400*    US IN THE 2ND BLOCK OF THE ARRAY.                           *18440003
184500*----------------------------------------------------------------*18450003
184600                                                                  18460003
184700 3100-SET-SUBSCRIPTS.                                             18470003
184800                                                                  18480003
184900     COMPUTE ASC-ITEM-SUB =                                       18490003
185000         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        18500003
185100                                                                  18510003
185200     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         18520003
185300         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            18530003
185400                                                                  18540003
185500         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               18550003
185600     ELSE                                                         18560003
185700         MOVE +1                     TO ASC-BLK-SUB               18570003
185800     END-IF.                                                      18580003
185900******************************************************************18590003
186000** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **18600003
186100******************************************************************18610003
186200                                                                  18620003
186300 3200-RESET-ATTRIBUTES.                                           18630003
186400     MOVE DP015-UNP-NUM-NOR-OFF    TO ASTRTITA.                   18640003
186500     MOVE DP015-GREEN              TO ASTRTITC.                   18650003
186600     MOVE DP015-UNDERLINE          TO ASTRTITH.                   18660003
186700*                                                                 18670003
186800     PERFORM                                                      18680003
186900         VARYING PV-SUB                                           18690003
187000         FROM 1 BY 1                                              18700003
187100         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        18710003
187200         MOVE DP015-UNP-ALP-NOR-OFF                               18720003
187300                                   TO MR-SELECTA (PV-SUB)         18730003
187400         MOVE DP015-GREEN          TO MR-SELECTC (PV-SUB)         18740003
187500         MOVE DP015-UNDERLINE      TO MR-SELECTH (PV-SUB)         18750003
187600         MOVE DP015-BLUE           TO MR-ACTIONC (PV-SUB)         18760003
187700                                      MR-VENDOR-NAMEC (PV-SUB)    18770003
187800                                      MR-INT-CNTL-NUMC (PV-SUB)   18780003
187900                                      MR-CREATE-DATEC  (PV-SUB)   18790003
188000                                      MR-CREATE-TIMEC  (PV-SUB)   18800003
188100                                      MR-RECEIPT-DATEC (PV-SUB)   18810003
188200                                      MR-RECEIPT-TIMEC (PV-SUB)   18820003
188300                                      MR-PICKUP-DATEC (PV-SUB)    18830003
188400                                      MR-PICKUP-TIMEC (PV-SUB)    18840003
188500                                      MR-FRCD-INDC   (PV-SUB)     18850003
188600                                      MR-PROD-TEST-INDC (PV-SUB)  18860003
188700     END-PERFORM.                                                 18870003
188800******************************************************************18880003
188900** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **18890003
189000** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **18900003
189100** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **18910003
189200** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **18920003
189300******************************************************************18930003
189400 3300-EDIT-SELECTIONS.                                            18940003
189500     EVALUATE TRUE                                                18950003
189600         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     18960003
189700             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         18970003
189800                 CONTINUE                                         18980003
189900         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         18990003
190000             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        19000003
190100                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   19010003
190200                 MOVE ASC-TEMP-SELECTED-SW                        19020003
190300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  19030003
190400                                TO ASC-SELECTED-SW                19040003
190500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  19050003
190600             END-IF                                               19060003
190700         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     19070003
190800                 = SPACE                                          19080003
190900             EVALUATE TRUE                                        19090003
191000                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       19100003
191100                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS19110003
191200                     MOVE SPACE TO ASC-SELECTED-SW                19120003
191300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  19130003
191400                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        19140003
191500                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    19150003
191600                     MOVE SPACE TO ASC-SELECTED-SW                19160003
191700                                      (ASC-BLK-SUB ASC-ITEM-SUB)  19170003
191800                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          19180003
191900                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      19190003
192000                     MOVE SPACE TO ASC-SELECTED-SW                19200003
192100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  19210003
192200             END-EVALUATE                                         19220003
192300         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           19230003
192400             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            19240003
192500                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    19250003
192600             END-IF                                               19260003
192700             PERFORM 3310-EDIT-RANGE                              19270003
192800         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             19280003
192900             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            19290003
193000                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    19300003
193100             END-IF                                               19310003
193200             PERFORM 3310-EDIT-RANGE                              19320003
193300         WHEN OTHER                                               19330003
193400*            ---- INVALID VALUE ----                              19340003
193500             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           19350003
193600             SET DP020-MSG-FATAL    TO TRUE                       19360003
193700             MOVE -1                TO MR-SELECTL (PV-SUB)        19370003
193800             SET DP030-SET-CURSOR-APPL-1                          19380003
193900                                    TO TRUE                       19390003
194000             MOVE DP015-RED         TO MR-SELECTC (PV-SUB)        19400003
194100             MOVE DP015-REVERSE     TO MR-SELECTH (PV-SUB)        19410003
194200             SET PS-ERROR TO TRUE                                 19420003
194300             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            19430003
194400                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     19440003
194500                 MOVE SPACE         TO ASC-SELECTED-SW            19450003
194600                                        (ASC-BLK-SUB ASC-ITEM-SUB)19460003
194700             END-IF                                               19470003
194800     END-EVALUATE.                                                19480003
194900                                                                  19490003
195000     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 19500003
195100     SUBTRACT +1 FROM ASC-ITEM-SUB.                               19510003
195200     IF  ASC-ITEM-SUB < 1                                         19520003
195300         SUBTRACT +1 FROM ASC-BLK-SUB                             19530003
195400         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                19540003
195500     END-IF.                                                      19550003
195600******************************************************************19560003
195700** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **19570003
195800** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **19580003
195900** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**19590003
196000** THE ENDING.                                                  **19600003
196100******************************************************************19610003
196200 3310-EDIT-RANGE.                                                 19620003
196300     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                19630003
196400         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   19640003
196500             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)19650003
196600                                   TO ASC-SELECTED-SW             19660003
196700                                        (ASC-BLK-SUB ASC-ITEM-SUB)19670003
196800             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 19680003
196900         ELSE                                                     19690003
197000             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     19700003
197100                 CONTINUE                                         19710003
197200             ELSE                                                 19720003
197300*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        19730003
197400                 MOVE PC-TSYMSG-00054                             19740003
197500                                   TO DP020-MSG-NUMBER            19750003
197600                 SET DP020-MSG-FATAL                              19760003
197700                                   TO TRUE                        19770003
197800                 MOVE -1           TO MR-SELECTL (PV-SUB)         19780003
197900                 SET DP030-SET-CURSOR-APPL-1                      19790003
198000                                   TO TRUE                        19800003
198100                 MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         19810003
198200                 MOVE DP015-UNDERLINE                             19820003
198300                                   TO MR-SELECTH (PV-SUB)         19830003
198400                 SET PS-ERROR      TO TRUE                        19840003
198500             END-IF                                               19850003
198600         END-IF                                                   19860003
198700     ELSE                                                         19870003
198800         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     19880003
198900             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 19890003
199000                                   TO ASC-SELECTED-SW             19900003
199100                                     (ASC-BLK-SUB ASC-ITEM-SUB)   19910003
199200             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   19920003
199300         ELSE                                                     19930003
199400             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       19940003
199500                 CONTINUE                                         19950003
199600             ELSE                                                 19960003
199700*                -- ONLY ONE END-OF-RANGE ALLOWED --              19970003
199800                 MOVE PC-TSYMSG-00055                             19980003
199900                                   TO DP020-MSG-NUMBER            19990003
200000                 SET DP020-MSG-FATAL                              20000003
200100                                   TO TRUE                        20010003
200200                 MOVE -1           TO MR-SELECTL (PV-SUB)         20020003
200300                 SET DP030-SET-CURSOR-APPL-1                      20030003
200400                                   TO TRUE                        20040003
200500                 SET PS-ERROR      TO TRUE                        20050003
200600             END-IF                                               20060003
200700         END-IF                                                   20070003
200800     END-IF.                                                      20080003
200900*                                                                 20090003
201000******************************************************************20100003
201100** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **20110003
201200** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **20120003
201300******************************************************************20130003
201400 3400-CHECK-RANGE-SEQUENCE.                                       20140003
201500     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       20150003
201600       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      20160003
201700       AND  ASC-START-OF-SELECTED-RANGE >                         20170003
201800                                         ASC-END-OF-SELECTED-RANGE20180003
201900*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                20190003
202000         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 20200003
202100         SET DP020-MSG-FATAL TO TRUE                              20210003
202200         SET PS-ERROR TO TRUE                                     20220003
202300         PERFORM 3410-POSITION-AT-ERROR                           20230003
202400     ELSE                                                         20240003
202500         IF ASC-NUMBER-OF-ITEMS-READ > 0                          20250003
202600             MOVE -1 TO MR-SELECTL (1)                            20260003
202700         ELSE                                                     20270003
202800             MOVE -1 TO ASTRTITL                                  20280003
202900         END-IF                                                   20290003
203000     END-IF.                                                      20300003
203100     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       20310003
203200                                                                  20320003
203300                                                                  20330003
203400******************************************************************20340003
203500** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **20350003
203600** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **20360003
203700** SHOULD BE POSITIONED ON A RANGE ERROR.                       **20370003
203800******************************************************************20380003
203900 3410-POSITION-AT-ERROR.                                          20390003
204000     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 20400003
204100                    - PV-TOP-ITEM + 1.                            20410003
204200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      20420003
204300         CONTINUE                                                 20430003
204400     ELSE                                                         20440003
204500         MOVE -1                   TO MR-SELECTL (PV-SUB)         20450003
204600         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         20460003
204700         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         20470003
204800     END-IF.                                                      20480003
204900*                                                                 20490003
205000     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   20500003
205100                    - PV-TOP-ITEM + 1.                            20510003
205200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      20520003
205300         CONTINUE                                                 20530003
205400     ELSE                                                         20540003
205500         MOVE -1                   TO MR-SELECTL (PV-SUB)         20550003
205600         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         20560003
205700         MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         20570003
205800     END-IF.                                                      20580003
205900 EJECT                                                            20590003
206000*----------------------------------------------------------------*20600003
206100*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *20610003
206200*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *20620003
206300*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *20630003
206400*----------------------------------------------------------------*20640003
206500                                                                  20650003
206600 3500-MARK-RANGE-AS-SELECTED.                                     20660003
206700     MOVE +1                       TO  ASC-BLK-SUB.               20670003
206800     PERFORM 3510-MARK-SELECTED-INDS                              20680003
206900         VARYING ASC-ITEM-SUB                                     20690003
207000         FROM 1 BY 1                                              20700003
207100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 20710003
207200                                                                  20720003
207300     ADD +1                        TO ASC-BLK-SUB.                20730003
207400     PERFORM 3510-MARK-SELECTED-INDS                              20740003
207500         VARYING ASC-ITEM-SUB                                     20750003
207600         FROM 1 BY 1                                              20760003
207700         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 20770003
207800                                                                  20780003
207900     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               20790003
208000                                   TO  PV-LIST-ITEM-NUMBER.       20800003
208100     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            20810003
208200         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         20820003
208300               PC-ITEMS-PER-PANEL).                               20830003
208400                                                                  20840003
208500     MOVE ASC-START-OF-SELECTED-RANGE                             20850003
208600                                   TO PV-START-OF-SELECTED-RANGE. 20860003
208700     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            20870003
208800         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  20880003
208900               PC-ITEMS-PER-PANEL).                               20890003
209000                                                                  20900003
209100     MOVE ASC-END-OF-SELECTED-RANGE                               20910003
209200                                   TO  PV-END-OF-SELECTED-RANGE.  20920003
209300     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             20930003
209400         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    20940003
209500               PC-ITEMS-PER-PANEL).                               20950003
209600     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             20960003
209700         PV-FIRST-BLOCK-IN-ARRAY + 1.                             20970003
209800                                                                  20980003
209900     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    20990003
210000        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        21000003
210100         MOVE +1                   TO ASC-BLK-SUB                 21010003
210200         PERFORM 5100-WRITE-TEMP-STORAGE                          21020003
210300         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         21030003
210400             PV-FIRST-BLOCK-IN-ARRAY - 1                          21040003
210500                                                                  21050003
210600         PERFORM                                                  21060003
210700             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      21070003
210800                   PV-PREV-BLOCK-IN-ARRAY                         21080003
210900             MOVE PV-FIRST-BLOCK-IN-RANGE                         21090003
211000                                   TO PV-BLOCK-NUMBER             21100003
211100             PERFORM 4410-READ-TEMP-STORAGE                       21110003
211200             PERFORM 3510-MARK-SELECTED-INDS                      21120003
211300                 VARYING ASC-ITEM-SUB                             21130003
211400                 FROM 1 BY 1                                      21140003
211500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          21150003
211600             PERFORM 5100-WRITE-TEMP-STORAGE                      21160003
211700             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     21170003
211800         END-PERFORM                                              21180003
211900                                                                  21190003
212000         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         21200003
212100             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     21210003
212200         PERFORM                                                  21220003
212300             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       21230003
212400                   PV-LAST-BLOCK-IN-RANGE                         21240003
212500             MOVE PV-NEXT-BLOCK-IN-ARRAY                          21250003
212600                                   TO PV-BLOCK-NUMBER             21260003
212700             PERFORM 4410-READ-TEMP-STORAGE                       21270003
212800             PERFORM 3510-MARK-SELECTED-INDS                      21280003
212900                 VARYING ASC-ITEM-SUB                             21290003
213000                 FROM 1 BY 1                                      21300003
213100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          21310003
213200             PERFORM 5100-WRITE-TEMP-STORAGE                      21320003
213300             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      21330003
213400         END-PERFORM                                              21340003
213500                                                                  21350003
213600         MOVE PV-FIRST-BLOCK-IN-ARRAY                             21360003
213700                                   TO PV-BLOCK-NUMBER             21370003
213800         PERFORM 4410-READ-TEMP-STORAGE                           21380003
213900     END-IF.                                                      21390003
214000                                                                  21400003
214100     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 21410003
214200                                      ASC-END-OF-SELECTED-RANGE.  21420003
214300                                                                  21430003
214400 EJECT                                                            21440003
214500*----------------------------------------------------------------*21450003
214600* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *21460003
214700*----------------------------------------------------------------*21470003
214800                                                                  21480003
214900 3510-MARK-SELECTED-INDS.                                         21490003
215000                                                                  21500003
215100     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         21510003
215200                                ASC-ITEM-SUB) >                   21520003
215300         ASC-START-OF-SELECTED-RANGE)                             21530003
215400     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         21540003
215500                                ASC-ITEM-SUB) =                   21550003
215600         ASC-START-OF-SELECTED-RANGE)                             21560003
215700                                                                  21570003
215800         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     21580003
215900                                    ASC-ITEM-SUB) <               21590003
216000             ASC-END-OF-SELECTED-RANGE)                           21600003
216100         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     21610003
216200                                    ASC-ITEM-SUB) =               21620003
216300             ASC-END-OF-SELECTED-RANGE)                           21630003
216400                                                                  21640003
216500             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          21650003
216600                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   21660003
216700                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   21670003
216800                               TO TRUE                            21680003
216900                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              21690003
217000                               TO TRUE                            21700003
217100                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    21710003
217200             END-IF                                               21720003
217300         END-IF                                                   21730003
217400     END-IF.                                                      21740003
217500                                                                  21750003
217600 EJECT                                                            21760003
217700*----------------------------------------------------------------*21770003
217800*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *21780003
217900*    INITIALIZE ALL COUNTERS AND FLAGS.                          *21790003
218000*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *21800003
218100*    DISPLAY THE PANEL TO USER.                                  *21810003
218200*----------------------------------------------------------------*21820003
218300                                                                  21830003
218400 4000-BUILD-INITIAL-PANEL.                                        21840003
218500                                                                  21850003
218600     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            21860003
218700                                 ASC-BLOCK-ENTRIES (2).           21870003
218800     MOVE +1                 TO ASC-BLK-SUB.                      21880003
218900     SET ASC-ITEMS-LEFT-ON-DB TO TRUE.                            21890003
219000                                                                  21900003
219100     MOVE +0                 TO ASC-ITEM-SUB                      21910003
219200                                ASC-NUMBER-OF-ITEMS-READ          21920003
219300                                ASC-NUMBER-OF-SELECTED-ITEMS      21930003
219400                                ASC-HIGHEST-BLOCK-WRITTEN         21940003
219500                                ASC-START-OF-SELECTED-RANGE       21950003
219600                                ASC-END-OF-SELECTED-RANGE         21960003
219700                                ASC-ITEM-AT-TOP-OF-PANEL.         21970003
219800                                                                  21980003
219900                                                                  21990003
220000     MOVE ASC-BEGIN-DT-YYYY TO PV-BEGIN-YYYY                      22000003
220100     MOVE ASC-BEGIN-DT-MM   TO PV-BEGIN-MM                        22010003
220200     MOVE ASC-BEGIN-DT-DD   TO PV-BEGIN-DD                        22020003
220300     MOVE ASC-END-DT-YYYY   TO PV-END-YYYY                        22030003
220400     MOVE ASC-END-DT-MM     TO PV-END-MM                          22040003
220500     MOVE ASC-END-DT-DD     TO PV-END-DD                          22050003
220600                                                                  22060003
220700     PERFORM 4010-OPEN-CURSOR.                                    22070003
220800                                                                  22080003
220900     IF SQLCODE = ZERO                                            22090003
221000         PERFORM 4300-READ-ITEMS-FROM-DB                          22100003
221100                                                                  22110003
221200         PERFORM 4020-CLOSE-CURSOR                                22120003
221300                                                                  22130003
221400         MOVE +1                   TO  PV-TOP-ITEM                22140003
221500         IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                      22150003
221600             SET DP020-MSG-INFORMATIONAL TO TRUE                  22160003
221700*            ---- NO LIST ITEMS FOUND FOR CRITERIA ----           22170003
221800             MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER           22180003
221900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 22190003
222000         ELSE                                                     22200003
222100             MOVE -1               TO MR-SELECTL (1)              22210003
222200             SET DP030-SET-CURSOR-APPL-1                          22220003
222300                                   TO TRUE                        22230003
222400             PERFORM                                              22240003
222500                 VARYING PV-SUB                                   22250003
222600                 FROM 1 BY 1                                      22260003
222700                 UNTIL PV-SUB > PC-ITEMS-PER-PANEL                22270003
222800                 MOVE DP015-BLUE      TO MR-ACTIONC (PV-SUB)      22280003
222900                                      MR-VENDOR-NAMEC (PV-SUB)    22290003
223000                                      MR-INT-CNTL-NUMC (PV-SUB)   22300003
223100                                      MR-CREATE-DATEC  (PV-SUB)   22310003
223200                                      MR-CREATE-TIMEC  (PV-SUB)   22320003
223300                                      MR-RECEIPT-DATEC (PV-SUB)   22330003
223400                                      MR-RECEIPT-TIMEC (PV-SUB)   22340003
223500                                      MR-PICKUP-DATEC (PV-SUB)    22350003
223600                                      MR-PICKUP-TIMEC (PV-SUB)    22360003
223700                                      MR-FRCD-INDC   (PV-SUB)     22370003
223800                                      MR-PROD-TEST-INDC(PV-SUB)   22380003
223900             END-PERFORM                                          22390003
224000                                                                  22400003
224100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 22410003
224200         END-IF                                                   22420003
224300     ELSE                                                         22430003
224400         SET  DP020-NEXT-ACT-APPL-ERROR                           22440003
224500              DP020-MSG-WARNING         TO TRUE                   22450003
224600*        ---- WAIT 15 SECONDS, THEN RETRY ----                    22460003
224700         MOVE PC-TSYMSG-00551  TO  DP020-MSG-NUMBER               22470003
224800     END-IF.                                                      22480003
224900 EJECT                                                            22490003
225000*----------------------------------------------------------------*22500003
225100*   OPEN THE CURSOR.                                             *22510003
225200*   IN THIS PARTICULAR APPLICATION ONE OF 13 DIFFERENT CURSORS   *22520003
225300*   WILL BE OPENED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *22530003
225400*   USER.                                                        *22540003
225500*----------------------------------------------------------------*22550003
225600                                                                  22560003
225700 4010-OPEN-CURSOR.                                                22570003
225800                                                                  22580003
225900     IF ASC-FORMAT-IND = '2'                                      22590003
226000         EVALUATE TRUE                                            22600003
226100                                                                  22610003
226200             WHEN ASC-COMBINATION = '1'                           22620003
226300                 IF ASC-ERROR-IND = 'Y'                           22630003
226400                     MOVE 'CURSOR 1 '                             22640003
226500                                 TO DP013-MESSAGE-TEXT (2)        22650003
226600                     EXEC SQL                                     22660003
226700                          OPEN CURSOR_ONE                         22670003
226800                     END-EXEC                                     22680003
226900                  ELSE                                            22690003
227000                     MOVE 'CURSOR 2 '                             22700003
227100                                  TO DP013-MESSAGE-TEXT (2)       22710003
227200                     EXEC SQL                                     22720003
227300                          OPEN CURSOR_TWO                         22730003
227400                     END-EXEC                                     22740003
227500                  END-IF                                          22750003
227600                                                                  22760003
227700             WHEN ASC-COMBINATION = '2'                           22770003
227800                 IF ASC-ERROR-IND = 'Y'                           22780003
227900                     MOVE 'CURSOR 3 '                             22790003
228000                                  TO DP013-MESSAGE-TEXT (2)       22800003
228100                     EXEC SQL                                     22810003
228200                          OPEN CURSOR_THREE                       22820003
228300                     END-EXEC                                     22830003
228400                  ELSE                                            22840003
228500                     MOVE 'CURSOR 4 '                             22850003
228600                                  TO DP013-MESSAGE-TEXT (2)       22860003
228700                     EXEC SQL                                     22870003
228800                          OPEN CURSOR_FOUR                        22880003
228900                     END-EXEC                                     22890003
229000                  END-IF                                          22900003
229100                                                                  22910003
229200             WHEN ASC-COMBINATION = '3'                           22920003
229300                 IF ASC-ERROR-IND = 'Y'                           22930003
229400                     MOVE 'CURSOR 5 '                             22940003
229500                                  TO DP013-MESSAGE-TEXT (2)       22950003
229600                     EXEC SQL                                     22960003
229700                          OPEN CURSOR_FIVE                        22970003
229800                     END-EXEC                                     22980003
229900                  ELSE                                            22990003
230000                     MOVE 'CURSOR 6 '                             23000003
230100                                  TO DP013-MESSAGE-TEXT (2)       23010003
230200                     EXEC SQL                                     23020003
230300                          OPEN CURSOR_SIX                         23030003
230400                     END-EXEC                                     23040003
230500                  END-IF                                          23050003
230600                                                                  23060003
230700             WHEN ASC-COMBINATION = '4'                           23070003
230800                 IF ASC-ERROR-IND = 'Y'                           23080003
230900                     MOVE 'CURSOR 7 '                             23090003
231000                                  TO DP013-MESSAGE-TEXT (2)       23100003
231100                     EXEC SQL                                     23110003
231200                          OPEN CURSOR_SEVEN                       23120003
231300                     END-EXEC                                     23130003
231400                  ELSE                                            23140003
231500                     MOVE 'CURSOR 8 '                             23150003
231600                                  TO DP013-MESSAGE-TEXT (2)       23160003
231700                     EXEC SQL                                     23170003
231800                          OPEN CURSOR_EIGHT                       23180003
231900                     END-EXEC                                     23190003
232000                  END-IF                                          23200003
232100                                                                  23210003
232200             WHEN ASC-COMBINATION = '5'                           23220003
232300                 IF ASC-ERROR-IND = 'Y'                           23230003
232400                     MOVE 'CURSOR 9 '                             23240003
232500                                  TO DP013-MESSAGE-TEXT (2)       23250003
232600                     EXEC SQL                                     23260003
232700                          OPEN CURSOR_NINE                        23270003
232800                     END-EXEC                                     23280003
232900                  ELSE                                            23290003
233000                     MOVE 'CURSOR 10'                             23300003
233100                                  TO DP013-MESSAGE-TEXT (2)       23310003
233200                     EXEC SQL                                     23320003
233300                          OPEN CURSOR_TEN                         23330003
233400                     END-EXEC                                     23340003
233500                  END-IF                                          23350003
233600                                                                  23360003
233700             WHEN OTHER                                           23370003
233800                 MOVE '4010-OPEN-CURSOR'                          23380003
233900                                   TO DP013-PARAGRAPH             23390003
234000                 MOVE 'INVALID COMBINATION  '                     23400003
234100                                   TO DP013-MESSAGE-TEXT (1)      23410003
234200                 SET DP013-DB2-ABEND                              23420003
234300                     DP013-XCTL-DISPLAY-RESTART TO TRUE           23430003
234400                 PERFORM DP013-0000-PROCESS-ABEND                 23440003
234500                                                                  23450003
234600         END-EVALUATE                                             23460003
234700     ELSE                                                         23470003
234800          IF ASC-FORMAT-IND = '3'                                 23480003
234900              MOVE 'CURSOR 11'                                    23490003
235000                          TO DP013-MESSAGE-TEXT (2)               23500003
235100              EXEC SQL                                            23510003
235200                   OPEN CURSOR_ELEVEN                             23520003
235300              END-EXEC                                            23530003
235400          ELSE                                                    23540003
235500              IF ASC-FORMAT-IND = '4'                             23550003
235600                  MOVE 'CURSOR 13'                                23560003
235700                              TO DP013-MESSAGE-TEXT (2)           23570003
235800                  EXEC SQL                                        23580003
235900                       OPEN CURSOR_THIRTEEN                       23590003
236000                  END-EXEC                                        23600003
236100              ELSE                                                23610003
236200                  MOVE 'CURSOR 12'                                23620003
236300                              TO DP013-MESSAGE-TEXT (2)           23630003
236400                  EXEC SQL                                        23640003
236500                       OPEN CURSOR_TWELVE                         23650003
236600                  END-EXEC                                        23660003
236700              END-IF                                              23670003
236800          END-IF                                                  23680003
236900     END-IF.                                                      23690003
237000                                                                  23700003
237100     EVALUATE TRUE                                                23710003
237200         WHEN SQLCODE = ZERO                                      23720003
237300             CONTINUE                                             23730003
237400         WHEN SQLWARN0 NOT = SPACES                               23740003
237500         WHEN SQLCODE  NOT = ZERO                                 23750003
237600             MOVE '4010-OPEN-CURSOR'                              23760003
237700                               TO DP013-PARAGRAPH                 23770003
237800             MOVE 'OPEN CURSOR'                                   23780003
237900                               TO DP013-MESSAGE-TEXT (1)          23790003
238000             MOVE SQLCA        TO DP013-SQLCA                     23800003
238100             SET DP013-DB2-ABEND                                  23810003
238200                 DP013-XCTL-DISPLAY-RESTART TO TRUE               23820003
238300             PERFORM DP013-0000-PROCESS-ABEND                     23830003
238400     END-EVALUATE.                                                23840003
238500 EJECT                                                            23850003
238600*----------------------------------------------------------------*23860003
238700* CLOSE THE CURSOR.                                              *23870003
238800*   IN THIS PARTICULAR APPLICATION ONE OF 13 DIFFERENT CURSORS   *23880003
238900*   WILL BE CLOSED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *23890003
239000*   USER.                                                        *23900003
239100*----------------------------------------------------------------*23910003
239200                                                                  23920003
239300 4020-CLOSE-CURSOR.                                               23930003
239400*                                                                 23940003
239500     IF ASC-FORMAT-IND = '2'                                      23950003
239600         EVALUATE TRUE                                            23960003
239700                                                                  23970003
239800             WHEN ASC-COMBINATION = '1'                           23980003
239900                 IF ASC-ERROR-IND = 'Y'                           23990003
240000                     MOVE 'CURSOR 1 '                             24000003
240100                                   TO DP013-MESSAGE-TEXT (2)      24010003
240200                     EXEC SQL                                     24020003
240300                          CLOSE CURSOR_ONE                        24030003
240400                     END-EXEC                                     24040003
240500                  ELSE                                            24050003
240600                     MOVE 'CURSOR 2 '                             24060003
240700                                  TO DP013-MESSAGE-TEXT (2)       24070003
240800                     EXEC SQL                                     24080003
240900                          CLOSE CURSOR_TWO                        24090003
241000                     END-EXEC                                     24100003
241100                  END-IF                                          24110003
241200                                                                  24120003
241300             WHEN ASC-COMBINATION = '2'                           24130003
241400                 IF ASC-ERROR-IND = 'Y'                           24140003
241500                     MOVE 'CURSOR 3 '                             24150003
241600                                  TO DP013-MESSAGE-TEXT (2)       24160003
241700                     EXEC SQL                                     24170003
241800                          CLOSE CURSOR_THREE                      24180003
241900                     END-EXEC                                     24190003
242000                  ELSE                                            24200003
242100                     MOVE 'CURSOR 4 '                             24210003
242200                                  TO DP013-MESSAGE-TEXT (2)       24220003
242300                     EXEC SQL                                     24230003
242400                          CLOSE CURSOR_FOUR                       24240003
242500                     END-EXEC                                     24250003
242600                  END-IF                                          24260003
242700                                                                  24270003
242800             WHEN ASC-COMBINATION = '3'                           24280003
242900                 IF ASC-ERROR-IND = 'Y'                           24290003
243000                     MOVE 'CURSOR 5 '                             24300003
243100                                  TO DP013-MESSAGE-TEXT (2)       24310003
243200                     EXEC SQL                                     24320003
243300                          CLOSE CURSOR_FIVE                       24330003
243400                     END-EXEC                                     24340003
243500                  ELSE                                            24350003
243600                     MOVE 'CURSOR 6 '                             24360003
243700                                  TO DP013-MESSAGE-TEXT (2)       24370003
243800                     EXEC SQL                                     24380003
243900                          CLOSE CURSOR_SIX                        24390003
244000                     END-EXEC                                     24400003
244100                  END-IF                                          24410003
244200                                                                  24420003
244300             WHEN ASC-COMBINATION = '4'                           24430003
244400                 IF ASC-ERROR-IND = 'Y'                           24440003
244500                     MOVE 'CURSOR 7 '                             24450003
244600                                  TO DP013-MESSAGE-TEXT (2)       24460003
244700                     EXEC SQL                                     24470003
244800                          CLOSE CURSOR_SEVEN                      24480003
244900                     END-EXEC                                     24490003
245000                  ELSE                                            24500003
245100                     MOVE 'CURSOR 8 '                             24510003
245200                                  TO DP013-MESSAGE-TEXT (2)       24520003
245300                     EXEC SQL                                     24530003
245400                          CLOSE CURSOR_EIGHT                      24540003
245500                     END-EXEC                                     24550003
245600                  END-IF                                          24560003
245700                                                                  24570003
245800             WHEN ASC-COMBINATION = '5'                           24580003
245900                 IF ASC-ERROR-IND = 'Y'                           24590003
246000                     MOVE 'CURSOR 9 '                             24600003
246100                                  TO DP013-MESSAGE-TEXT (2)       24610003
246200                     EXEC SQL                                     24620003
246300                          CLOSE CURSOR_NINE                       24630003
246400                     END-EXEC                                     24640003
246500                  ELSE                                            24650003
246600                     MOVE 'CURSOR 10'                             24660003
246700                                  TO DP013-MESSAGE-TEXT (2)       24670003
246800                     EXEC SQL                                     24680003
246900                          CLOSE CURSOR_TEN                        24690003
247000                     END-EXEC                                     24700003
247100                  END-IF                                          24710003
247200                                                                  24720003
247300             WHEN OTHER                                           24730003
247400                 MOVE '4020-CLOSE-CURSOR'                         24740003
247500                                   TO DP013-PARAGRAPH             24750003
247600                 MOVE 'INVALID COMBINATION  '                     24760003
247700                                   TO DP013-MESSAGE-TEXT (1)      24770003
247800                 SET DP013-DB2-ABEND                              24780003
247900                     DP013-XCTL-DISPLAY-RESTART TO TRUE           24790003
248000                 PERFORM DP013-0000-PROCESS-ABEND                 24800003
248100                                                                  24810003
248200         END-EVALUATE                                             24820003
248300     ELSE                                                         24830003
248400         IF ASC-FORMAT-IND = '3'                                  24840003
248500             MOVE 'CURSOR 11'                                     24850003
248600                           TO DP013-MESSAGE-TEXT (2)              24860003
248700             EXEC SQL                                             24870003
248800                  CLOSE CURSOR_ELEVEN                             24880003
248900             END-EXEC                                             24890003
249000         ELSE                                                     24900003
249100             IF ASC-FORMAT-IND = '4'                              24910003
249200                 MOVE 'CURSOR 13'                                 24920003
249300                               TO DP013-MESSAGE-TEXT (2)          24930003
249400                 EXEC SQL                                         24940003
249500                      CLOSE CURSOR_THIRTEEN                       24950003
249600                 END-EXEC                                         24960003
249700             ELSE                                                 24970003
249800                 MOVE 'CURSOR 12'                                 24980003
249900                               TO DP013-MESSAGE-TEXT (2)          24990003
250000                 EXEC SQL                                         25000003
250100                      CLOSE CURSOR_TWELVE                         25010003
250200                 END-EXEC                                         25020003
250300             END-IF                                               25030003
250400         END-IF                                                   25040003
250500     END-IF.                                                      25050003
250600                                                                  25060003
250700     EVALUATE TRUE                                                25070003
250800         WHEN SQLCODE = ZERO                                      25080003
250900             CONTINUE                                             25090003
251000         WHEN SQLWARN0 NOT = SPACES                               25100003
251100         WHEN SQLCODE  NOT = ZERO                                 25110003
251200             MOVE '4020-CLOSE-CURSOR'                             25120003
251300                               TO DP013-PARAGRAPH                 25130003
251400             MOVE 'CLOSE CURSOR'                                  25140003
251500                               TO DP013-MESSAGE-TEXT (1)          25150003
251600             MOVE SQLCA        TO DP013-SQLCA                     25160003
251700             MOVE 'TINVPAR '   TO DP013-DB2-TABLE-NAME (1)        25170003
251800             SET DP013-DB2-ABEND                                  25180003
251900                 DP013-XCTL-DISPLAY-RESTART TO TRUE               25190003
252000             PERFORM DP013-0000-PROCESS-ABEND                     25200003
252100     END-EVALUATE.                                                25210003
252200 EJECT                                                            25220003
252300*----------------------------------------------------------------*25230003
252400*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *25240003
252500*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *25250003
252600*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *25260003
252700*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *25270003
252800*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *25280003
252900*                                                                *25290003
253000*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *25300003
253100*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *25310003
253200*    UPON INITIALIZATION.                                        *25320003
253300*----------------------------------------------------------------*25330003
253400                                                                  25340003
253500 4300-READ-ITEMS-FROM-DB.                                         25350003
253600                                                                  25360003
253700     PERFORM                                                      25370003
253800         VARYING PV-READ-COUNT                                    25380003
253900         FROM 1 BY 1                                              25390003
254000         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    25400003
254100            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         25410003
254200                                                                  25420003
254300         IF ASC-NUMBER-OF-ITEMS-READ < ASC-NUM-XMITS              25430003
254400             PERFORM 4310-FETCH                                   25440003
254500         ELSE                                                     25450003
254600             SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                  25460003
254700         END-IF                                                   25470003
254800                                                                  25480003
254900         IF  ASC-ITEMS-LEFT-ON-DB                                 25490003
255000             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                25500003
255100                 ADD +1            TO ASC-ITEM-SUB                25510003
255200             ELSE                                                 25520003
255300                 ADD +1            TO ASC-BLK-SUB                 25530003
255400                 MOVE +1           TO ASC-ITEM-SUB                25540003
255500                                                                  25550003
255600                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         25560003
255700                     MOVE +1       TO ASC-BLK-SUB                 25570003
255800                     SET ASC-BLOCK-MODIFIED (1) TO TRUE           25580003
255900                     PERFORM 5100-WRITE-TEMP-STORAGE              25590003
256000                     MOVE ASC-BLOCK-ENTRIES                       25600003
256100                                          (PC-MAX-BLOCKS-IN-ARRAY)25610003
256200                                 TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB)25620003
256300                     ADD +1        TO ASC-BLK-SUB                 25630003
256400                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   25640003
256500                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      25650003
256600                                                           TO TRUE25660003
256700                 END-IF                                           25670003
256800             END-IF                                               25680003
256900             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    25690003
257000             MOVE ASC-NUMBER-OF-ITEMS-READ                        25700003
257100                TO ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)25710003
257200*   -----------MOVE ITEMS FROM DB TO ASC COMMAREA ---------       25720003
257300            MOVE INTTRN-TP-DKEY  TO                               25730003
257400               ASC-TP-DKEY         (ASC-BLK-SUB ASC-ITEM-SUB)     25740003
257500            MOVE INTTRN-TP-DKEY-TMST  TO                          25750003
257600               ASC-TP-DKEY-TMST    (ASC-BLK-SUB ASC-ITEM-SUB)     25760003
257700             MOVE TRDPRT-ENT-ID      TO                           25770003
257800               ASC-ENT-ID-QUEUE    (ASC-BLK-SUB ASC-ITEM-SUB)     25780003
257900             MOVE ASC-VENDOR-NAME      TO                         25790003
258000               ASC-VEND-NAME-QUEUE (ASC-BLK-SUB ASC-ITEM-SUB)     25800003
258100             MOVE INTTRN-INCHG-CNTL-NBR  TO                       25810003
258200               ASC-INCHG-CNTL-NBR  (ASC-BLK-SUB ASC-ITEM-SUB)     25820003
258300             MOVE INTTRN-CRE-DTE            TO                    25830003
258400               ASC-CRE-DTE         (ASC-BLK-SUB ASC-ITEM-SUB)     25840003
258500             MOVE INTTRN-CRE-TME            TO                    25850003
258600               ASC-CRE-TME         (ASC-BLK-SUB ASC-ITEM-SUB)     25860003
258700             MOVE INTTRN-MAILBOX-REC-DTE    TO                    25870003
258800               ASC-MAILBOX-REC-DTE (ASC-BLK-SUB ASC-ITEM-SUB)     25880003
258900             MOVE INTTRN-MAILBOX-REC-TME    TO                    25890003
259000               ASC-MAILBOX-REC-TME (ASC-BLK-SUB ASC-ITEM-SUB)     25900003
259100             MOVE INTTRN-MAILBOX-PU-DTE     TO                    25910003
259200               ASC-MAILBOX-PU-DTE  (ASC-BLK-SUB ASC-ITEM-SUB)     25920003
259300             MOVE INTTRN-MAILBOX-PU-TME     TO                    25930003
259400               ASC-MAILBOX-PU-TME  (ASC-BLK-SUB ASC-ITEM-SUB)     25940003
259500             MOVE INTTRN-TRN-MANL-FRCD-IND  TO                    25950003
259600               ASC-FRCD-IND-QUEUE (ASC-BLK-SUB ASC-ITEM-SUB)      25960003
259700             MOVE INTTRN-PROD-TEST-IND      TO                    25970003
259800               ASC-PROD-TEST-IND-QUEUE (ASC-BLK-SUB ASC-ITEM-SUB) 25980003
259900*   -----------MOVE ITEMS FROM DB TO ASC COMMAREA ---------       25990003
260000         END-IF                                                   26000003
260100     END-PERFORM.                                                 26010003
260200                                                                  26020003
260300     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          26030003
260400         MOVE +1               TO ASC-BLK-SUB                     26040003
260500         PERFORM 5100-WRITE-TEMP-STORAGE                          26050003
260600         ADD +1                TO ASC-BLK-SUB                     26060003
260700         PERFORM 5100-WRITE-TEMP-STORAGE                          26070003
260800                                                                  26080003
260900         MOVE 1                TO ASC-BLK-SUB                     26090003
261000                                  PV-BLOCK-NUMBER                 26100003
261100         PERFORM 4410-READ-TEMP-STORAGE                           26110003
261200         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             26120003
261300             MOVE 2            TO ASC-BLK-SUB                     26130003
261400                                  PV-BLOCK-NUMBER                 26140003
261500             PERFORM 4410-READ-TEMP-STORAGE                       26150003
261600         END-IF                                                   26160003
261700     END-IF.                                                      26170003
261800 EJECT                                                            26180003
261900*----------------------------------------------------------------*26190003
262000*    FETCH THE CURSOR.                                            26200003
262100*----------------------------------------------------------------*26210003
262200                                                                  26220003
262300 4310-FETCH.                                                      26230003
262400                                                                  26240003
262500     IF ASC-FORMAT-IND = '2'                                      26250003
262600         EVALUATE TRUE                                            26260003
262700                                                                  26270003
262800             WHEN ASC-COMBINATION = '1'                           26280003
262900                 IF ASC-ERROR-IND = 'Y'                           26290003
263000                     MOVE 'CURSOR 1 '                             26300003
263100                                  TO DP013-MESSAGE-TEXT (2)       26310003
263200                     EXEC SQL                                     26320003
263300                          FETCH CURSOR_ONE                        26330003
263400                          INTO  :INTTRN-TP-DKEY                   26340003
263500                              , :INTTRN-TP-DKEY-TMST              26350003
263600                              , :INTTRN-INCHG-CNTL-NBR            26360003
263700                              , :INTTRN-CRE-DTE                   26370003
263800                              , :INTTRN-CRE-TME                   26380003
263900                              , :INTTRN-MAILBOX-REC-DTE           26390003
264000                              , :INTTRN-MAILBOX-REC-TME           26400003
264100                              , :INTTRN-MAILBOX-PU-DTE            26410003
264200                              , :INTTRN-MAILBOX-PU-TME            26420003
264300                              , :INTTRN-ERR-IND                   26430003
264400                              , :INTTRN-PROD-TEST-IND             26440003
264500                              , :INTTRN-TRN-MANL-FRCD-IND         26450003
264600                     END-EXEC                                     26460003
264700                                                                  26470003
264800                  ELSE                                            26480003
264900                     MOVE 'CURSOR 2 '                             26490003
265000                                  TO DP013-MESSAGE-TEXT (2)       26500003
265100                     EXEC SQL                                     26510003
265200                          FETCH CURSOR_TWO                        26520003
265300                          INTO  :INTTRN-TP-DKEY                   26530003
265400                              , :INTTRN-TP-DKEY-TMST              26540003
265500                              , :INTTRN-INCHG-CNTL-NBR            26550003
265600                              , :INTTRN-CRE-DTE                   26560003
265700                              , :INTTRN-CRE-TME                   26570003
265800                              , :INTTRN-MAILBOX-REC-DTE           26580003
265900                              , :INTTRN-MAILBOX-REC-TME           26590003
266000                              , :INTTRN-MAILBOX-PU-DTE            26600003
266100                              , :INTTRN-MAILBOX-PU-TME            26610003
266200                              , :INTTRN-ERR-IND                   26620003
266300                              , :INTTRN-PROD-TEST-IND             26630003
266400                              , :INTTRN-TRN-MANL-FRCD-IND         26640003
266500                     END-EXEC                                     26650003
266600                  END-IF                                          26660003
266700                                                                  26670003
266800             WHEN ASC-COMBINATION = '2'                           26680003
266900                 IF ASC-ERROR-IND = 'Y'                           26690003
267000                     MOVE 'CURSOR 3 '                             26700003
267100                                  TO DP013-MESSAGE-TEXT (2)       26710003
267200                     EXEC SQL                                     26720003
267300                          FETCH CURSOR_THREE                      26730003
267400                          INTO  :INTTRN-TP-DKEY                   26740003
267500                              , :INTTRN-TP-DKEY-TMST              26750003
267600                              , :INTTRN-INCHG-CNTL-NBR            26760003
267700                              , :INTTRN-CRE-DTE                   26770003
267800                              , :INTTRN-CRE-TME                   26780003
267900                              , :INTTRN-MAILBOX-REC-DTE           26790003
268000                              , :INTTRN-MAILBOX-REC-TME           26800003
268100                              , :INTTRN-MAILBOX-PU-DTE            26810003
268200                              , :INTTRN-MAILBOX-PU-TME            26820003
268300                              , :INTTRN-ERR-IND                   26830003
268400                              , :INTTRN-PROD-TEST-IND             26840003
268500                              , :INTTRN-TRN-MANL-FRCD-IND         26850003
268600                     END-EXEC                                     26860003
268700                  ELSE                                            26870003
268800                     MOVE 'CURSOR 4 '                             26880003
268900                                  TO DP013-MESSAGE-TEXT (2)       26890003
269000                     EXEC SQL                                     26900003
269100                          FETCH CURSOR_FOUR                       26910003
269200                          INTO  :INTTRN-TP-DKEY                   26920003
269300                              , :INTTRN-TP-DKEY-TMST              26930003
269400                              , :INTTRN-INCHG-CNTL-NBR            26940003
269500                              , :INTTRN-CRE-DTE                   26950003
269600                              , :INTTRN-CRE-TME                   26960003
269700                              , :INTTRN-MAILBOX-REC-DTE           26970003
269800                              , :INTTRN-MAILBOX-REC-TME           26980003
269900                              , :INTTRN-MAILBOX-PU-DTE            26990003
270000                              , :INTTRN-MAILBOX-PU-TME            27000003
270100                              , :INTTRN-ERR-IND                   27010003
270200                              , :INTTRN-PROD-TEST-IND             27020003
270300                              , :INTTRN-TRN-MANL-FRCD-IND         27030003
270400                     END-EXEC                                     27040003
270500                  END-IF                                          27050003
270600                                                                  27060003
270700             WHEN ASC-COMBINATION = '3'                           27070003
270800                 IF ASC-ERROR-IND = 'Y'                           27080003
270900                     MOVE 'CURSOR 5 '                             27090003
271000                                  TO DP013-MESSAGE-TEXT (2)       27100003
271100                     EXEC SQL                                     27110003
271200                          FETCH CURSOR_FIVE                       27120003
271300                          INTO  :INTTRN-TP-DKEY                   27130003
271400                              , :INTTRN-TP-DKEY-TMST              27140003
271500                              , :INTTRN-INCHG-CNTL-NBR            27150003
271600                              , :INTTRN-CRE-DTE                   27160003
271700                              , :INTTRN-CRE-TME                   27170003
271800                              , :INTTRN-MAILBOX-REC-DTE           27180003
271900                              , :INTTRN-MAILBOX-REC-TME           27190003
272000                              , :INTTRN-MAILBOX-PU-DTE            27200003
272100                              , :INTTRN-MAILBOX-PU-TME            27210003
272200                              , :INTTRN-ERR-IND                   27220003
272300                              , :INTTRN-PROD-TEST-IND             27230003
272400                              , :INTTRN-TRN-MANL-FRCD-IND         27240003
272500                     END-EXEC                                     27250003
272600                  ELSE                                            27260003
272700                     MOVE 'CURSOR 6 '                             27270003
272800                                  TO DP013-MESSAGE-TEXT (2)       27280003
272900                     EXEC SQL                                     27290003
273000                          FETCH CURSOR_SIX                        27300003
273100                          INTO  :INTTRN-TP-DKEY                   27310003
273200                              , :INTTRN-TP-DKEY-TMST              27320003
273300                              , :INTTRN-INCHG-CNTL-NBR            27330003
273400                              , :INTTRN-CRE-DTE                   27340003
273500                              , :INTTRN-CRE-TME                   27350003
273600                              , :INTTRN-MAILBOX-REC-DTE           27360003
273700                              , :INTTRN-MAILBOX-REC-TME           27370003
273800                              , :INTTRN-MAILBOX-PU-DTE            27380003
273900                              , :INTTRN-MAILBOX-PU-TME            27390003
274000                              , :INTTRN-ERR-IND                   27400003
274100                              , :INTTRN-PROD-TEST-IND             27410003
274200                              , :INTTRN-TRN-MANL-FRCD-IND         27420003
274300                     END-EXEC                                     27430003
274400                  END-IF                                          27440003
274500                                                                  27450003
274600             WHEN ASC-COMBINATION = '4'                           27460003
274700                 IF ASC-ERROR-IND = 'Y'                           27470003
274800                     MOVE 'CURSOR 7 '                             27480003
274900                                  TO DP013-MESSAGE-TEXT (2)       27490003
275000                     EXEC SQL                                     27500003
275100                          FETCH CURSOR_SEVEN                      27510003
275200                          INTO  :INTTRN-TP-DKEY                   27520003
275300                              , :INTTRN-TP-DKEY-TMST              27530003
275400                              , :INTTRN-INCHG-CNTL-NBR            27540003
275500                              , :INTTRN-CRE-DTE                   27550003
275600                              , :INTTRN-CRE-TME                   27560003
275700                              , :INTTRN-MAILBOX-REC-DTE           27570003
275800                              , :INTTRN-MAILBOX-REC-TME           27580003
275900                              , :INTTRN-MAILBOX-PU-DTE            27590003
276000                              , :INTTRN-MAILBOX-PU-TME            27600003
276100                              , :INTTRN-ERR-IND                   27610003
276200                              , :INTTRN-PROD-TEST-IND             27620003
276300                              , :INTTRN-TRN-MANL-FRCD-IND         27630003
276400                     END-EXEC                                     27640003
276500                  ELSE                                            27650003
276600                     MOVE 'CURSOR 8 '                             27660003
276700                                  TO DP013-MESSAGE-TEXT (2)       27670003
276800                     EXEC SQL                                     27680003
276900                          FETCH CURSOR_EIGHT                      27690003
277000                          INTO  :INTTRN-TP-DKEY                   27700003
277100                              , :INTTRN-TP-DKEY-TMST              27710003
277200                              , :INTTRN-INCHG-CNTL-NBR            27720003
277300                              , :INTTRN-CRE-DTE                   27730003
277400                              , :INTTRN-CRE-TME                   27740003
277500                              , :INTTRN-MAILBOX-REC-DTE           27750003
277600                              , :INTTRN-MAILBOX-REC-TME           27760003
277700                              , :INTTRN-MAILBOX-PU-DTE            27770003
277800                              , :INTTRN-MAILBOX-PU-TME            27780003
277900                              , :INTTRN-ERR-IND                   27790003
278000                              , :INTTRN-PROD-TEST-IND             27800003
278100                              , :INTTRN-TRN-MANL-FRCD-IND         27810003
278200                     END-EXEC                                     27820003
278300                  END-IF                                          27830003
278400                                                                  27840003
278500             WHEN ASC-COMBINATION = '5'                           27850003
278600                 IF ASC-ERROR-IND = 'Y'                           27860003
278700                     MOVE 'CURSOR 9 '                             27870003
278800                                  TO DP013-MESSAGE-TEXT (2)       27880003
278900                     EXEC SQL                                     27890003
279000                          FETCH CURSOR_NINE                       27900003
279100                          INTO :INTTRN-TP-DKEY                    27910003
279200                              , :INTTRN-TP-DKEY-TMST              27920003
279300                              , :INTTRN-INCHG-CNTL-NBR            27930003
279400                              , :INTTRN-CRE-DTE                   27940003
279500                              , :INTTRN-CRE-TME                   27950003
279600                              , :INTTRN-MAILBOX-REC-DTE           27960003
279700                              , :INTTRN-MAILBOX-REC-TME           27970003
279800                              , :INTTRN-MAILBOX-PU-DTE            27980003
279900                              , :INTTRN-MAILBOX-PU-TME            27990003
280000                              , :INTTRN-ERR-IND                   28000003
280100                              , :INTTRN-PROD-TEST-IND             28010003
280200                              , :INTTRN-TRN-MANL-FRCD-IND         28020003
280300                     END-EXEC                                     28030003
280400                  ELSE                                            28040003
280500                     MOVE 'CURSOR 10'                             28050003
280600                                  TO DP013-MESSAGE-TEXT (2)       28060003
280700                     EXEC SQL                                     28070003
280800                          FETCH CURSOR_TEN                        28080003
280900                          INTO  :INTTRN-TP-DKEY                   28090003
281000                              , :INTTRN-TP-DKEY-TMST              28100003
281100                              , :INTTRN-INCHG-CNTL-NBR            28110003
281200                              , :INTTRN-CRE-DTE                   28120003
281300                              , :INTTRN-CRE-TME                   28130003
281400                              , :INTTRN-MAILBOX-REC-DTE           28140003
281500                              , :INTTRN-MAILBOX-REC-TME           28150003
281600                              , :INTTRN-MAILBOX-PU-DTE            28160003
281700                              , :INTTRN-MAILBOX-PU-TME            28170003
281800                              , :INTTRN-ERR-IND                   28180003
281900                              , :INTTRN-PROD-TEST-IND             28190003
282000                              , :INTTRN-TRN-MANL-FRCD-IND         28200003
282100                     END-EXEC                                     28210003
282200                  END-IF                                          28220003
282300                                                                  28230003
282400             WHEN OTHER                                           28240003
282500                 MOVE '4010-OPEN-CURSOR'                          28250003
282600                                   TO DP013-PARAGRAPH             28260003
282700                 MOVE 'INVALID COMBINATION  '                     28270003
282800                                   TO DP013-MESSAGE-TEXT (1)      28280003
282900                 SET DP013-DB2-ABEND                              28290003
283000                     DP013-XCTL-DISPLAY-RESTART TO TRUE           28300003
283100                 PERFORM DP013-0000-PROCESS-ABEND                 28310003
283200                                                                  28320003
283300         END-EVALUATE                                             28330003
283400     ELSE                                                         28340003
283500         IF ASC-FORMAT-IND = '3'                                  28350003
283600             MOVE 'CURSOR 11'                                     28360003
283700                          TO DP013-MESSAGE-TEXT (2)               28370003
283800             EXEC SQL                                             28380003
283900                  FETCH CURSOR_ELEVEN                             28390003
284000                  INTO  :TRDPRT-ENT-ID                            28400003
284100                      , :ASC-VENDOR-NAME                          28410003
284200                      , :INTTRN-TP-DKEY                           28420003
284300                      , :INTTRN-TP-DKEY-TMST                      28430003
284400                      , :INTTRN-INCHG-CNTL-NBR                    28440003
284500                      , :INTTRN-CRE-DTE                           28450003
284600                      , :INTTRN-CRE-TME                           28460003
284700                      , :INTTRN-MAILBOX-REC-DTE                   28470003
284800                      , :INTTRN-MAILBOX-REC-TME                   28480003
284900                      , :INTTRN-MAILBOX-PU-DTE                    28490003
285000                      , :INTTRN-MAILBOX-PU-TME                    28500003
285100                      , :INTTRN-ERR-IND                           28510003
285200                      , :INTTRN-PROD-TEST-IND                     28520003
285300                      , :INTTRN-TRN-MANL-FRCD-IND                 28530003
285400             END-EXEC                                             28540003
285500         ELSE                                                     28550003
285600             IF ASC-FORMAT-IND = '4'                              28560003
285700                 MOVE 'CURSOR 13'                                 28570003
285800                              TO DP013-MESSAGE-TEXT (2)           28580003
285900                 EXEC SQL                                         28590003
286000                      FETCH CURSOR_THIRTEEN                       28600003
286100                      INTO  :TRDPRT-ENT-ID                        28610003
286200                          , :ASC-VENDOR-NAME                      28620003
286300                          , :INTTRN-TP-DKEY                       28630003
286400                          , :INTTRN-TP-DKEY-TMST                  28640003
286500                          , :INTTRN-INCHG-CNTL-NBR                28650003
286600                          , :INTTRN-CRE-DTE                       28660003
286700                          , :INTTRN-CRE-TME                       28670003
286800                          , :INTTRN-MAILBOX-REC-DTE               28680003
286900                          , :INTTRN-MAILBOX-REC-TME               28690003
287000                          , :INTTRN-MAILBOX-PU-DTE                28700003
287100                          , :INTTRN-MAILBOX-PU-TME                28710003
287200                          , :INTTRN-ERR-IND                       28720003
287300                          , :INTTRN-PROD-TEST-IND                 28730003
287400                          , :INTTRN-TRN-MANL-FRCD-IND             28740003
287500                 END-EXEC                                         28750003
287600             ELSE                                                 28760003
287700                 MOVE 'CURSOR 12'                                 28770003
287800                              TO DP013-MESSAGE-TEXT (2)           28780003
287900                 EXEC SQL                                         28790003
288000                      FETCH CURSOR_TWELVE                         28800003
288100                      INTO  :TRDPRT-ENT-ID                        28810003
288200                          , :ASC-VENDOR-NAME                      28820003
288300                          , :INTTRN-TP-DKEY                       28830003
288400                          , :INTTRN-TP-DKEY-TMST                  28840003
288500                          , :INTTRN-INCHG-CNTL-NBR                28850003
288600                          , :INTTRN-CRE-DTE                       28860003
288700                          , :INTTRN-CRE-TME                       28870003
288800                          , :INTTRN-MAILBOX-REC-DTE               28880003
288900                          , :INTTRN-MAILBOX-REC-TME               28890003
289000                          , :INTTRN-MAILBOX-PU-DTE                28900003
289100                          , :INTTRN-MAILBOX-PU-TME                28910003
289200                          , :INTTRN-ERR-IND                       28920003
289300                          , :INTTRN-PROD-TEST-IND                 28930003
289400                          , :INTTRN-TRN-MANL-FRCD-IND             28940003
289500                 END-EXEC                                         28950003
289600                                                                  28960003
289700             END-IF                                               28970003
289800         END-IF                                                   28980003
289900     END-IF.                                                      28990003
290000                                                                  29000003
290100     EVALUATE TRUE                                                29010003
290200         WHEN SQLCODE = ZERO                                      29020003
290300         WHEN SQLCODE = +100                                      29030003
290400             IF  SQLCODE EQUAL +100                               29040003
290500                 SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE              29050003
290600             END-IF                                               29060003
290700         WHEN SQLWARN0 NOT = SPACE                                29070003
290800         WHEN SQLCODE  NOT = ZERO                                 29080003
290900              MOVE '4310-FETCH-CURSOR'                            29090003
291000                               TO DP013-PARAGRAPH                 29100003
291100              MOVE 'FETCH CURSOR'                                 29110003
291200                               TO DP013-MESSAGE-TEXT (1)          29120003
291300              MOVE SQLCA       TO DP013-SQLCA                     29130003
291400              SET DP013-DB2-ABEND                                 29140003
291500                               TO TRUE                            29150003
291600              PERFORM DP013-0000-PROCESS-ABEND                    29160003
291700     END-EVALUATE.                                                29170003
291800                                                                  29180003
291900                                                                  29190003
292000                                                                  29200003
292100*----------------------------------------------------------------*29210003
292200* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *29220003
292300*----------------------------------------------------------------*29230003
292400                                                                  29240003
292500 4400-MOVE-COMMAREA-TO-SCREEN.                                    29250003
292600                                                                  29260003
292700     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             29270003
292800         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          29280003
292900         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          29290003
293000             MOVE +1    TO ASC-BLK-SUB                            29300003
293100             PERFORM 5100-WRITE-TEMP-STORAGE                      29310003
293200             ADD +1     TO ASC-BLK-SUB                            29320003
293300             PERFORM 5100-WRITE-TEMP-STORAGE                      29330003
293400             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             29340003
293500                 GIVING PV-BLOCK-NUMBER                           29350003
293600                 REMAINDER PV-REMAINDER                           29360003
293700             IF  PV-REMAINDER > ZERO                              29370003
293800                 ADD +1 TO PV-BLOCK-NUMBER                        29380003
293900             END-IF                                               29390003
294000             MOVE +1    TO ASC-BLK-SUB                            29400003
294100             PERFORM 4410-READ-TEMP-STORAGE                       29410003
294200             ADD +1     TO ASC-BLK-SUB                            29420003
294300                           PV-BLOCK-NUMBER                        29430003
294400             PERFORM 4410-READ-TEMP-STORAGE                       29440003
294500     END-IF.                                                      29450003
294600     MOVE +1            TO ASC-BLK-SUB.                           29460003
294700     COMPUTE ASC-ITEM-SUB =                                       29470003
294800         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              29480003
294900         + PC-ITEMS-PER-PANEL).                                   29490003
295000*                                                                 29500003
295100     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        29510003
295200         ADD +1         TO ASC-BLK-SUB                            29520003
295300         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            29530003
295400     END-IF.                                                      29540003
295500*                                                                 29550003
295600     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           29560003
295700         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                29570003
295800     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        29580003
295900     PERFORM 4420-FORMAT-LIST-LINES                               29590003
296000         VARYING PV-SUB                                           29600003
296100         FROM PC-ITEMS-PER-PANEL BY -1                            29610003
296200         UNTIL PV-SUB < +1.                                       29620003
296300*                                                                 29630003
296400     COMPUTE ASC-ITEMS-DISPLAYED =                                29640003
296500         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          29650003
296600     IF PS-NO-START-ITEM-ERROR                                    29660003
296700         MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL29670003
296800                                          ASTRTITO                29680003
296900         MOVE SPACE                    TO ASC-START-ITEM-REQUEST  29690003
297000     ELSE                                                         29700003
297100         MOVE ASC-START-ITEM-REQUEST   TO ASTRTITO                29710003
297200     END-IF.                                                      29720003
297300     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    29730003
297400     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    29740003
297500     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            29750003
297600                                   TO ASELITO.                    29760003
297700*                                                                 29770003
297800     IF  DP020-MSG-NUMBER-X = SPACE                               29780003
297900         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  29790003
298000*            --- MORE ITEMS TO DISPLAY ----                       29800003
298100             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            29810003
298200             SET DP020-MSG-INFORMATIONAL TO TRUE                  29820003
298300         END-IF                                                   29830003
298400     END-IF.                                                      29840003
298500*----------------------------------------------------------------*29850003
298600*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *29860003
298700*----------------------------------------------------------------*29870003
298800                                                                  29880003
298900 4410-READ-TEMP-STORAGE.                                          29890003
299000                                                                  29900003
299100     EXEC CICS                                                    29910003
299200         READQ TS                                                 29920003
299300             QUEUE (ASC-LIST-QUEUE-NAME)                          29930003
299400             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               29940003
299500             ITEM  (PV-BLOCK-NUMBER)                              29950003
299600             RESP  (PV-CICS-RESP)                                 29960003
299700     END-EXEC.                                                    29970003
299800                                                                  29980003
299900     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       29990003
300000       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     30000003
300100         CONTINUE                                                 30010003
300200     ELSE                                                         30020003
300300         SET DP013-CICS-ABEND     TO TRUE                         30030003
300400         SET DP013-NO-ROLLBACK    TO TRUE                         30040003
300500         MOVE '4410-READ-TEMP-STORAGE'                            30050003
300600                                  TO DP013-PARAGRAPH              30060003
300700         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      30070003
300800                                  TO DP013-MESSAGE-TEXT(1)        30080003
300900         PERFORM DP013-0000-PROCESS-ABEND                         30090003
301000     END-IF.                                                      30100003
301100                                                                  30110003
301200     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             30120003
301300*                                                                 30130003
301400     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         30140003
301500         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               30150003
301600     END-IF.                                                      30160003
301700 EJECT                                                            30170003
301800*----------------------------------------------------------------*30180003
301900*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *30190003
302000*----------------------------------------------------------------*30200003
302100                                                                  30210003
302200 4420-FORMAT-LIST-LINES.                                          30220003
302300     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      30230003
302400         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                30240003
302500         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           30250003
302600         MOVE SPACE              TO MR-SELECTI (PV-SUB)           30260003
302700                                    MR-ACTION  (PV-SUB)           30270003
302800*----------------------INITIALIZE MAP FIELDS                      30280003
302900                                    MR-VENDOR-NAME    (PV-SUB)    30290003
303000                                    MR-INT-CNTL-NUM   (PV-SUB)    30300003
303100                                    MR-CREATE-DATE    (PV-SUB)    30310003
303200                                    MR-RECEIPT-DATE   (PV-SUB)    30320003
303300                                    MR-PICKUP-DATE    (PV-SUB)    30330003
303400                                    MR-FRCD-IND      (PV-SUB)     30340003
303500                                    MR-PROD-TEST-IND  (PV-SUB)    30350003
303600                                    MR-CREATE-TIME    (PV-SUB)    30360003
303700                                    MR-RECEIPT-TIME   (PV-SUB)    30370003
303800                                    MR-PICKUP-TIME    (PV-SUB)    30380003
303900*----------------------END INITIALIZE                             30390003
304000     ELSE                                                         30400003
304100         IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      30410003
304200                                                   > SPACE        30420003
304300             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 30430003
304400                                 TO MR-SELECTI (PV-SUB)           30440003
304500         ELSE                                                     30450003
304600             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      30460003
304700                                 TO MR-SELECTI (PV-SUB)           30470003
304800         END-IF                                                   30480003
304900*                                                                 30490003
305000         IF  DP030-SET-CURSOR-TRAILER                             30500003
305100             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)30510003
305200                 > SPACE)                                         30520003
305300               OR (PV-SUB = 1))                                   30530003
305400                SET DP030-SET-CURSOR-APPL-1 TO TRUE               30540003
305500                MOVE -1          TO MR-SELECTL (PV-SUB)           30550003
305600             END-IF                                               30560003
305700         END-IF                                                   30570003
305800*                                                                 30580003
305900         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           30590003
306000*---------------MOVE COMMAREA TO THE SCEEN----------------------- 30600003
306100             MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)           30610003
306200                                 TO MR-ACTION (PV-SUB)            30620003
306300             MOVE ASC-VEND-NAME-QUEUE (ASC-BLK-SUB ASC-ITEM-SUB)  30630003
306400                                 TO MR-VENDOR-NAME    (PV-SUB)    30640003
306500             MOVE ASC-INCHG-CNTL-NBR  (ASC-BLK-SUB ASC-ITEM-SUB)  30650003
306600                                 TO MR-INT-CNTL-NUM   (PV-SUB)    30660003
306700             MOVE ASC-CRE-DTE         (ASC-BLK-SUB ASC-ITEM-SUB)  30670003
306800                                 TO MR-CREATE-DATE    (PV-SUB)    30680003
306900             MOVE ASC-CRE-TME         (ASC-BLK-SUB ASC-ITEM-SUB)  30690003
307000                                 TO MR-CREATE-TIME    (PV-SUB)    30700003
307100             MOVE ASC-MAILBOX-REC-DTE (ASC-BLK-SUB ASC-ITEM-SUB)  30710003
307200                                 TO MR-RECEIPT-DATE   (PV-SUB)    30720003
307300             MOVE ASC-MAILBOX-REC-TME (ASC-BLK-SUB ASC-ITEM-SUB)  30730003
307400                                 TO MR-RECEIPT-TIME   (PV-SUB)    30740003
307500*                                                                 30750003
307600* DO NOT DISPLAY IF DEFAULT VALUES FOR RECEIPT DATE/TIME          30760003
307700*                                                                 30770003
307800             IF  (MR-RECEIPT-TIME (PV-SUB) = '09.09') AND         30780003
307900                 (MR-RECEIPT-DATE (PV-SUB) = '9999-09-09')        30790003
308000                 MOVE '@'  TO MR-RECEIPT-DATEA   (PV-SUB)         30800003
308100                              MR-RECEIPT-TIMEA   (PV-SUB)         30810003
308200             ELSE                                                 30820003
308300                 MOVE '1'  TO MR-RECEIPT-DATEA   (PV-SUB)         30830003
308400                              MR-RECEIPT-TIMEA   (PV-SUB)         30840003
308500             END-IF                                               30850003
308600*                                                                 30860003
308700             MOVE ASC-MAILBOX-PU-DTE  (ASC-BLK-SUB ASC-ITEM-SUB)  30870003
308800                                 TO MR-PICKUP-DATE    (PV-SUB)    30880003
308900             MOVE ASC-MAILBOX-PU-TME  (ASC-BLK-SUB ASC-ITEM-SUB)  30890003
309000                                 TO MR-PICKUP-TIME    (PV-SUB)    30900003
309100*                                                                 30910003
309200* DO NOT DISPLAY IF DEFAULT VALUES FOR PICKUP DATE/TIME           30920003
309300*                                                                 30930003
309400             IF  (MR-PICKUP-TIME (PV-SUB) = '09.09') AND          30940003
309500                 (MR-PICKUP-DATE (PV-SUB) = '9999-09-09')         30950003
309600                 MOVE '@'  TO MR-PICKUP-DATEA   (PV-SUB)          30960003
309700                              MR-PICKUP-TIMEA   (PV-SUB)          30970003
309800             ELSE                                                 30980003
309900                 MOVE '1'  TO MR-PICKUP-DATEA   (PV-SUB)          30990003
310000                              MR-PICKUP-TIMEA   (PV-SUB)          31000003
310100             END-IF                                               31010003
310200*                                                                 31020003
310300           MOVE ASC-FRCD-IND-QUEUE (ASC-BLK-SUB ASC-ITEM-SUB)     31030003
310400                               TO MR-FRCD-IND      (PV-SUB)       31040003
310500           MOVE ASC-PROD-TEST-IND-QUEUE (ASC-BLK-SUB ASC-ITEM-SUB)31050003
310600                               TO MR-PROD-TEST-IND  (PV-SUB)      31060003
310700*---------------MOVE COMMAREA TO THE SCEEN----------------------- 31070003
310800         END-IF                                                   31080003
310900     END-IF.                                                      31090003
311000     SUBTRACT +1 FROM ASC-ITEM-SUB                                31100003
311100     IF  ASC-ITEM-SUB < + 1                                       31110003
311200         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  31120003
311300         MOVE +1                 TO ASC-BLK-SUB                   31130003
311400     END-IF.                                                      31140003
311500******************************************************************31150003
311600** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **31160003
311700** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **31170003
311800** ISSUE A WARNING.                                             **31180003
311900******************************************************************31190003
312000 4430-CHECK-FOR-BEGIN-AND-END.                                    31200003
312100     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       31210003
312200         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     31220003
312300*            -- NO END-OF-RANGE SPECFIED ---                      31230003
312400             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            31240003
312500             SET DP020-MSG-WARNING TO TRUE                        31250003
312600             PERFORM 4431-POSITION-AT-WARNING                     31260003
312700         END-IF                                                   31270003
312800     ELSE                                                         31280003
312900         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     31290003
313000*            -- NO BEGINNING-OF-RANGE SPECFIED ---                31300003
313100             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            31310003
313200             SET DP020-MSG-WARNING TO TRUE                        31320003
313300             PERFORM 4431-POSITION-AT-WARNING                     31330003
313400         END-IF                                                   31340003
313500     END-IF.                                                      31350003
313600******************************************************************31360003
313700** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **31370003
313800** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **31380003
313900** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **31390003
314000** POSITION THE CURSOR THERE.                                   **31400003
314100******************************************************************31410003
314200 4431-POSITION-AT-WARNING.                                        31420003
314300     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 31430003
314400                    - PV-TOP-ITEM + 1.                            31440003
314500     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      31450003
314600         CONTINUE                                                 31460003
314700     ELSE                                                         31470003
314800         SET DP030-SET-CURSOR-APPL-1                              31480003
314900                                   TO TRUE                        31490003
315000         MOVE -1                   TO MR-SELECTL (PV-SUB)         31500003
315100         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         31510003
315200         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         31520003
315300     END-IF.                                                      31530003
315400*                                                                 31540003
315500     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   31550003
315600                    - PV-TOP-ITEM + 1.                            31560003
315700     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      31570003
315800         CONTINUE                                                 31580003
315900     ELSE                                                         31590003
316000         SET DP030-SET-CURSOR-APPL-1                              31600003
316100                                   TO TRUE                        31610003
316200         MOVE -1                   TO MR-SELECTL (PV-SUB)         31620003
316300         MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         31630003
316400         MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         31640003
316500     END-IF.                                                      31650003
316600 EJECT                                                            31660003
316700*----------------------------------------------------------------*31670003
316800* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *31680003
316900* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *31690003
317000* FOR THE SELECTED ITEMS QUEUE.                                  *31700003
317100*                                                                *31710003
317200* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *31720003
317300* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *31730003
317400* THE ARRAY IS FULL.                                             *31740003
317500*----------------------------------------------------------------*31750003
317600                                                                  31760003
317700 5000-PREPARE-SEL-QUEUE.                                          31770003
317800                                                                  31780003
317900     MOVE +1                   TO  ASC-BLK-SUB.                   31790003
318000     PERFORM 5100-WRITE-TEMP-STORAGE.                             31800003
318100     ADD +1                    TO  ASC-BLK-SUB.                   31810003
318200     PERFORM 5100-WRITE-TEMP-STORAGE.                             31820003
318300                                                                  31830003
318400     MOVE ASC-SEL-QUEUE-NAME   TO  ET307-SEL-QUEUE-NAME.          31840003
318500     PERFORM 6010-DELETE-SEL-QUEUE.                               31850003
318600                                                                  31860003
318700     SET ASC-UPDATE-TSQ        TO  TRUE.                          31870003
318800                                                                  31880003
318900     SET ET308-IDX             TO  1.                             31890003
319000     MOVE ZERO                 TO ET307-NUMBER-OF-TS-ITEMS.       31900003
319100     INITIALIZE ET308-SELECTED-ITEM-ARRAY.                        31910003
319200                                                                  31920003
319300     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           31930003
319400             VARYING PV-ITEM                                      31940003
319500             FROM 1 BY 1                                          31950003
319600             UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN.           31960003
319700                                                                  31970003
319800     IF  ET308-IDX > 1                                            31980003
319900         PERFORM 5205-WRITE-SEL-QUEUE                             31990003
320000         ADD +1                TO ET307-NUMBER-OF-TS-ITEMS        32000003
320100     END-IF.                                                      32010003
320200 EJECT                                                            32020003
320300*----------------------------------------------------------------*32030003
320400*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *32040003
320500*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *32050003
320600*----------------------------------------------------------------*32060003
320700                                                                  32070003
320800 5100-WRITE-TEMP-STORAGE.                                         32080003
320900     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     32090003
321000                                   TO PV-LIST-ITEM-NUMBER.        32100003
321100     COMPUTE PV-BLOCK-NUMBER =                                    32110003
321200         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    32120003
321300                                                                  32130003
321400     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             32140003
321500     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             32150003
321600         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      32160003
321700             PERFORM 5105-REWRITE-ASC-LISTQ                       32170003
321800         END-IF                                                   32180003
321900     ELSE                                                         32190003
322000         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       32200003
322100         ASC-HIGHEST-BLOCK-WRITTEN + 1                            32210003
322200         PERFORM 5110-WRITE-ASC-LISTQ                             32220003
322300         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   32230003
322400     END-IF.                                                      32240003
322500                                                                  32250003
322600     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             32260003
322700******************************************************************32270003
322800** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **32280003
322900** SPECIFIC COMMAREA.                                           **32290003
323000******************************************************************32300003
323100 5105-REWRITE-ASC-LISTQ.                                          32310003
323200     EXEC CICS                                                    32320003
323300         WRITEQ TS                                                32330003
323400             QUEUE (ASC-LIST-QUEUE-NAME)                          32340003
323500             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               32350003
323600             ITEM  (PV-BLOCK-NUMBER)                              32360003
323700             REWRITE                                              32370003
323800             RESP  (PV-CICS-RESP)                                 32380003
323900     END-EXEC.                                                    32390003
324000                                                                  32400003
324100     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           32410003
324200         CONTINUE                                                 32420003
324300     ELSE                                                         32430003
324400         SET DP013-CICS-ABEND            TO TRUE                  32440003
324500         SET DP013-NO-ROLLBACK           TO TRUE                  32450003
324600         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       32460003
324700         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     32470003
324800                                         TO DP013-MESSAGE-TEXT(1) 32480003
324900         PERFORM DP013-0000-PROCESS-ABEND                         32490003
325000     END-IF.                                                      32500003
325100                                                                  32510003
325200******************************************************************32520003
325300** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **32530003
325400** SPECIFIC COMMAREA.                                           **32540003
325500******************************************************************32550003
325600 5110-WRITE-ASC-LISTQ.                                            32560003
325700     EXEC CICS                                                    32570003
325800         WRITEQ TS                                                32580003
325900             QUEUE (ASC-LIST-QUEUE-NAME)                          32590003
326000             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               32600003
326100             ITEM  (PV-BLOCK-NUMBER)                              32610003
326200             RESP  (PV-CICS-RESP)                                 32620003
326300     END-EXEC.                                                    32630003
326400     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      32640003
326500         SET DP013-CICS-ABEND      TO TRUE                        32650003
326600         SET DP013-NO-ROLLBACK     TO TRUE                        32660003
326700         MOVE '5110-WRITE-ASC-LISTQ'                              32670003
326800                                   TO DP013-PARAGRAPH             32680003
326900         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           32690003
327000                                   TO DP013-MESSAGE-TEXT(1)       32700003
327100         PERFORM DP013-0000-PROCESS-ABEND                         32710003
327200     END-IF.                                                      32720003
327300 EJECT                                                            32730003
327400*----------------------------------------------------------------*32740003
327500* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *32750003
327600* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *32760003
327700*----------------------------------------------------------------*32770003
327800                                                                  32780003
327900 5200-FILL-SEL-QUEUE-RECORD.                                      32790003
328000                                                                  32800003
328100     PERFORM 6112-READ-LIST-QUEUE.                                32810003
328200                                                                  32820003
328300     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       32830003
328400         PERFORM                                                  32840003
328500         VARYING LQW-IDX                                          32850003
328600         FROM 1 BY 1                                              32860003
328700         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            32870003
328800           OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO          32880003
328900                                                                  32890003
329000             IF  LQW-SELECT (LQW-IDX)                             32900003
329100                 MOVE LQW-LIST-ITEM-NUMBER (LQW-IDX)              32910003
329200                                   TO ET308-ITEM (ET308-IDX)      32920003
329300                                                                  32930003
329400                 MOVE LQW-INCHG-CNTL-NBR (LQW-IDX)                32940003
329500                       TO ET308-INT-CONTROL-NUMBER (ET308-IDX)    32950003
329600                 MOVE LQW-VEND-NAME   (LQW-IDX)                   32960003
329700                       TO ET308-VENDOR-NAME (ET308-IDX)           32970003
329800                 MOVE LQW-TP-DKEY       (LQW-IDX)                 32980003
329900                       TO ET308-TP-DKEY     (ET308-IDX)           32990003
330000                 MOVE LQW-TP-DKEY-TMST  (LQW-IDX)                 33000003
330100                       TO ET308-TP-DKEY-TMST (ET308-IDX)          33010003
330200                 MOVE SPACE        TO ET308-ACTION-SW (ET308-IDX) 33020003
330300                 SET ET308-IDX UP BY 1                            33030003
330400                 IF  ET308-IDX > ET308-MAX-ITEMS                  33040003
330500                     PERFORM 5205-WRITE-SEL-QUEUE                 33050003
330600                     ADD +1        TO ET307-NUMBER-OF-TS-ITEMS    33060003
330700                     INITIALIZE ET308-SELECTED-ITEM-ARRAY         33070003
330800                     SET ET308-IDX TO  1                          33080003
330900                 END-IF                                           33090003
331000             END-IF                                               33100003
331100         END-PERFORM                                              33110003
331200     END-IF.                                                      33120003
331300                                                                  33130003
331400*----------------------------------------------------------------*33140003
331500*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *33150003
331600*----------------------------------------------------------------*33160003
331700                                                                  33170003
331800 5205-WRITE-SEL-QUEUE.                                            33180003
331900                                                                  33190003
332000     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            33200003
332100                                   TO ET308-SELECTED-ITEMS.       33210003
332200                                                                  33220003
332300     EXEC CICS                                                    33230003
332400          WRITEQ TS                                               33240003
332500              QUEUE (ASC-SEL-QUEUE-NAME)                          33250003
332600              FROM  (ET308-SELECTED-VNDRS)                        33260003
332700              ITEM  (PV-SEL-QUEUE-ITEM)                           33270003
332800              RESP  (PV-CICS-RESP)                                33280003
332900     END-EXEC.                                                    33290003
333000                                                                  33300003
333100     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          33310003
333200         CONTINUE                                                 33320003
333300     ELSE                                                         33330003
333400         SET DP013-CICS-ABEND      TO TRUE                        33340003
333500         SET DP013-NO-ROLLBACK     TO TRUE                        33350003
333600         MOVE '5205-WRITE-SEL-QUEUE'                              33360003
333700                                   TO DP013-PARAGRAPH             33370003
333800         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          33380003
333900                                   TO DP013-MESSAGE-TEXT(1)       33390003
334000         PERFORM DP013-0000-PROCESS-ABEND                         33400003
334100     END-IF.                                                      33410003
334200 EJECT                                                            33420003
334300******************************************************************33430003
334400** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **33440003
334500** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **33450003
334600** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **33460003
334700** THE USER.                                                    **33470003
334800******************************************************************33480003
334900 6000-REFRESH-PANEL-FROM-TEMP.                                    33490003
335000     IF  ASC-UPDATE-TSQ                                           33500003
335100         SET ASC-NO-TSQ-UPDATE TO TRUE                            33510003
335200         MOVE ZERO                 TO PV-SAVE-ITEM                33520003
335300                                      PV-SEL-QUEUE-ITEM           33530003
335400         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        33540003
335500                                   TO PV-HOLD-SELECTED-ITEMS      33550003
335600         PERFORM 6100-UPDATE-TSQ                                  33560003
335700             UNTIL PV-ITEMS-PROCESSED >                           33570003
335800                                     PV-HOLD-SELECTED-ITEMS       33580003
335900         PERFORM 6010-DELETE-SEL-QUEUE                            33590003
336000         INITIALIZE ASC-BLOCK-ENTRIES (1)                         33600003
336100                    ASC-BLOCK-ENTRIES (2)                         33610003
336200                                                                  33620003
336300         DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL                 33630003
336400                GIVING PV-BLOCK-NUMBER                            33640003
336500                REMAINDER PV-REMAINDER                            33650003
336600         IF  PV-REMAINDER > ZERO                                  33660003
336700             ADD +1     TO PV-BLOCK-NUMBER                        33670003
336800         END-IF                                                   33680003
336900         MOVE +1        TO ASC-BLK-SUB                            33690003
337000         PERFORM 4410-READ-TEMP-STORAGE                           33700003
337100         ADD +1         TO ASC-BLK-SUB                            33710003
337200                           PV-BLOCK-NUMBER                        33720003
337300         PERFORM 4410-READ-TEMP-STORAGE                           33730003
337400                                                                  33740003
337500     END-IF.                                                      33750003
337600                                                                  33760003
337700*----------------------------------------------------------------*33770003
337800*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *33780003
337900*----------------------------------------------------------------*33790003
338000 6010-DELETE-SEL-QUEUE.                                           33800003
338100                                                                  33810003
338200     EXEC CICS                                                    33820003
338300         DELETEQ TS                                               33830003
338400             QUEUE (ASC-SEL-QUEUE-NAME)                           33840003
338500             RESP  (PV-CICS-RESP)                                 33850003
338600     END-EXEC.                                                    33860003
338700*                                                                 33870003
338800     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      33880003
338900        (PV-CICS-RESP = DFHRESP(QIDERR)))                         33890003
339000         CONTINUE                                                 33900003
339100     ELSE                                                         33910003
339200         SET DP013-CICS-ABEND TO TRUE                             33920003
339300         SET DP013-NO-ROLLBACK TO TRUE                            33930003
339400         MOVE '6010-DELETE-SEL-QUEUE'                             33940003
339500                        TO DP013-PARAGRAPH                        33950003
339600         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         33960003
339700                        TO DP013-MESSAGE-TEXT (1)                 33970003
339800         PERFORM DP013-0000-PROCESS-ABEND                         33980003
339900     END-IF.                                                      33990003
340000                                                                  34000003
340100*----------------------------------------------------------------*34010003
340200*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *34020003
340300*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *34030003
340400*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *34040003
340500*    THE TEMP QUEUE.                                             *34050003
340600*----------------------------------------------------------------*34060003
340700                                                                  34070003
340800 6100-UPDATE-TSQ.                                                 34080003
340900                                                                  34090003
341000     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             34100003
341100     PERFORM 6105-READ-SEL-QUEUE.                                 34110003
341200     PERFORM                                                      34120003
341300         VARYING ET308-IDX                                        34130003
341400         FROM 1 BY 1                                              34140003
341500         UNTIL ((PV-ITEMS-PROCESSED >                             34150003
341600                              PV-HOLD-SELECTED-ITEMS)             34160003
341700         OR (ET308-IDX GREATER THAN ET308-MAX-ITEMS))             34170003
341800         IF  ET308-ACTION-SW (ET308-IDX) > SPACE                  34180003
341900             PERFORM 6110-PROCESS-ITEMS                           34190003
342000         END-IF                                                   34200003
342100         ADD +1                TO PV-ITEMS-PROCESSED              34210003
342200     END-PERFORM.                                                 34220003
342300     PERFORM 6111-WRITE-LIST-QUEUE.                               34230003
342400*----------------------------------------------------------------*34240003
342500*    READ THE LIST QUEUE RECORD.                                 *34250003
342600*----------------------------------------------------------------*34260003
342700                                                                  34270003
342800 6105-READ-SEL-QUEUE.                                             34280003
342900                                                                  34290003
343000     EXEC CICS                                                    34300003
343100          READQ TS                                                34310003
343200              QUEUE (ASC-SEL-QUEUE-NAME)                          34320003
343300              INTO  (ET308-SELECTED-VNDRS)                        34330003
343400              ITEM  (PV-SEL-QUEUE-ITEM)                           34340003
343500              RESP  (PV-CICS-RESP)                                34350003
343600     END-EXEC.                                                    34360003
343700*                                                                 34370003
343800     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          34380003
343900         CONTINUE                                                 34390003
344000     ELSE                                                         34400003
344100         SET DP013-CICS-ABEND      TO  TRUE                       34410003
344200         SET DP013-NO-ROLLBACK     TO  TRUE                       34420003
344300         MOVE '6105-READ-SEL-QUEUE'                               34430003
344400                                   TO  DP013-PARAGRAPH            34440003
344500         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           34450003
344600                                   TO  DP013-MESSAGE-TEXT(1)      34460003
344700         PERFORM DP013-0000-PROCESS-ABEND                         34470003
344800     END-IF.                                                      34480003
344900 EJECT                                                            34490003
345000*----------------------------------------------------------------*34500003
345100*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*34510003
345200*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*34520003
345300*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *34530003
345400*----------------------------------------------------------------*34540003
345500                                                                  34550003
345600 6110-PROCESS-ITEMS.                                              34560003
345700                                                                  34570003
345800     COMPUTE PV-ITEM = 1 + ((ET308-ITEM (ET308-IDX) - 1)          34580003
345900                     / PC-ITEMS-PER-PANEL).                       34590003
346000                                                                  34600003
346100     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           34610003
346200         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          34620003
346300             PERFORM 6111-WRITE-LIST-QUEUE                        34630003
346400         END-IF                                                   34640003
346500         MOVE PV-ITEM          TO PV-SAVE-ITEM                    34650003
346600                                                                  34660003
346700         PERFORM 6112-READ-LIST-QUEUE                             34670003
346800         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               34680003
346900             CONTINUE                                             34690003
347000         END-IF                                                   34700003
347100     END-IF.                                                      34710003
347200                                                                  34720003
347300     COMPUTE PV-SUB = (ET308-ITEM (ET308-IDX)                     34730003
347400                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              34740003
347500     SET LQW-DESELECT (PV-SUB) TO    TRUE                         34750003
347600     MOVE LQW-SELECTED-SW (PV-SUB)                                34760003
347700                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  34770003
347800                                                                  34780003
347900     MOVE ET308-ACTION-SW (ET308-IDX)   TO LQW-ACTION (PV-SUB).   34790003
348000     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                34800003
348100                                                                  34810003
348200*----------------------------------------------------------------*34820003
348300*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *34830003
348400*----------------------------------------------------------------*34840003
348500                                                                  34850003
348600 6111-WRITE-LIST-QUEUE.                                           34860003
348700                                                                  34870003
348800     EXEC CICS                                                    34880003
348900         WRITEQ TS                                                34890003
349000             QUEUE (ASC-LIST-QUEUE-NAME)                          34900003
349100             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     34910003
349200             ITEM  (PV-SAVE-ITEM)                                 34920003
349300             REWRITE                                              34930003
349400             RESP  (PV-CICS-RESP)                                 34940003
349500     END-EXEC.                                                    34950003
349600*                                                                 34960003
349700     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          34970003
349800         CONTINUE                                                 34980003
349900     ELSE                                                         34990003
350000         SET DP013-CICS-ABEND  TO  TRUE                           35000003
350100         SET DP013-NO-ROLLBACK TO  TRUE                           35010003
350200         MOVE '6111-WRITE-LIST-QUEUE'                             35020003
350300                               TO  DP013-PARAGRAPH                35030003
350400         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  35040003
350500                               TO  DP013-MESSAGE-TEXT(1)          35050003
350600         PERFORM DP013-0000-PROCESS-ABEND                         35060003
350700     END-IF.                                                      35070003
350800                                                                  35080003
350900 EJECT                                                            35090003
351000*----------------------------------------------------------------*35100003
351100*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*35110003
351200*----------------------------------------------------------------*35120003
351300                                                                  35130003
351400 6112-READ-LIST-QUEUE.                                            35140003
351500                                                                  35150003
351600     EXEC CICS                                                    35160003
351700         READQ TS                                                 35170003
351800             QUEUE (ASC-LIST-QUEUE-NAME)                          35180003
351900             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     35190003
352000             ITEM  (PV-ITEM)                                      35200003
352100             RESP  (PV-CICS-RESP)                                 35210003
352200     END-EXEC.                                                    35220003
352300*                                                                 35230003
352400     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          35240003
352500         CONTINUE                                                 35250003
352600     ELSE                                                         35260003
352700         SET DP013-CICS-ABEND        TO TRUE                      35270003
352800         SET DP013-NO-ROLLBACK       TO TRUE                      35280003
352900         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           35290003
353000         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    35300003
353100                                     TO DP013-MESSAGE-TEXT(1)     35310003
353200         PERFORM DP013-0000-PROCESS-ABEND                         35320003
353300     END-IF.                                                      35330003
353400                                                                  35340003
353500******************************************************************35350003
353600* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *35360003
353700******************************************************************35370003
353800                                                                  35380003
353900 9100-READ-SEL-QUEUE.                                             35390003
354000     EXEC CICS                                                    35400003
354100         READQ TS                                                 35410003
354200             QUEUE (ASC-SEL-QUEUE2-NAME)                          35420003
354300             INTO  (ET308-SELECTED-VNDRS)                         35430003
354400             ITEM  (ASC-SEL-ITEM)                                 35440003
354500             RESP  (PV-CICS-RESP)                                 35450003
354600     END-EXEC.                                                    35460003
354700                                                                  35470003
354800     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       35480003
354900         CONTINUE                                                 35490003
355000     ELSE                                                         35500003
355100         SET DP013-LOGIC-ABEND                                    35510003
355200             DP013-NO-ROLLBACK     TO TRUE                        35520003
355300         MOVE '9100-READ-SEL-QUEUE'                               35530003
355400                                   TO DP013-PARAGRAPH             35540003
355500         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   35550003
355600                                   TO DP013-MESSAGE-TEXT (1)      35560003
355700         PERFORM DP013-0000-PROCESS-ABEND                         35570003
355800     END-IF.                                                      35580003
355900*                                                                 35590003
356000******************************************************************35600003
356100* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *35610003
356200******************************************************************35620003
356300 9200-REWRITE-SEL-QUEUE.                                          35630003
356400     EXEC CICS                                                    35640003
356500          WRITEQ TS                                               35650003
356600              QUEUE  (ASC-SEL-QUEUE2-NAME)                        35660003
356700              FROM   (ET308-SELECTED-VNDRS)                       35670003
356800              ITEM   (ASC-SEL-ITEM)                               35680003
356900              RESP   (PV-CICS-RESP)                               35690003
357000              REWRITE                                             35700003
357100     END-EXEC.                                                    35710003
357200                                                                  35720003
357300     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   35730003
357400         SET DP013-CICS-ABEND                                     35740003
357500             DP013-NO-ROLLBACK     TO TRUE                        35750003
357600         MOVE '9200-REWRITE-SEL-QUEUE'                            35760003
357700                                   TO DP013-PARAGRAPH             35770003
357800         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   35780003
357900                                   TO DP013-MESSAGE-TEXT (1)      35790003
358000         PERFORM DP013-0000-PROCESS-ABEND                         35800003
358100     END-IF.                                                      35810003
358200 EJECT                                                            35820003
358300*----------------------------------------------------------------*35830003
358400*    ABEND PROCESSOR MODULE                                      *35840003
358500*----------------------------------------------------------------*35850003
358600                                                                  35860003
358700     COPY DPPD013.                                                35870003
