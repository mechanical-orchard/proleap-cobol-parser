      ******************************************************************        
      *  THIS WORKING-STORAGE COPYBOOK IS NEEDED FOR MLPD501 COPY CODE.         
      *                                                                         
      *  HOW TO USE THIS WITH MLPD501                                           
      *      - PASS IN ENT-ID.  IF THE ENT-ID CONTAINS VALID NUMERIC            
      *        NON-ZERO, THIS PROCESS WILL RETURN THAT VALUE.                   
      *      - SET THE APPROPRIATE PV-LOOKUP-TYPE INDICATOR, USE THE            
      *        SWITCH (88 LEVEL) SKU, UPCNBR, UPCID, ITM, OR INHOUSE.           
      *        IF NOTHING IS SET HERE, IT WILL SEARCH UNTIL IT FINDS            
      *        SKU, UPC-NBR, UPC-ID, ITM-NBR, OR DEPT/INHOUSE THAT              
      *        THE PROCESS CAN USE.                                             
      *      - FILL IN THE VALUE FOR SKU, UPC-NBR, ETC DEPENDING ON             
      *        THE SETTING OF THE SWITCH.                                       
      *        INHOUSE NUMBER LOOKUP REQUIRES DEPT AND INHOUSE NBR.             
      *        ALL OTHER LOOKUP REQUIRES EFFECTIVE DATE AND ITEM                
      *        LEVEL INFORMATION SUCH AS SKU, ITM-NBR, UPC-NBR, ETC.            
      *      - IDEALLY, YOU SHOULD KNOW WHAT ITEM LEVEL INFORMATION             
      *        YOU HAVE AND SET THE PV-LOOKUP-TYPE AS APPROPRIATE.              
      *      - IF THE LOOKUP AT THE SPECIFIED LEVEL OR THE FIRST                
      *        ASSUMPTION LEVEL FAIL, THIS PROCESS WILL TRY FOR                 
      *        INHOUSE LOOKUP, IF VALID DATA IS AVAILABLE FOR LOOKUP.           
      *                                                                         
      *      - ENTRY PROCEDURE: ML501-LOOKUP-VENDOR                             
      *                                                                         
      *     NOTE: SEE MLPD501 ON HOW EACH OPTION WILL BEHAVE.                   
      *           THE INPUT FIELDS WILL BE SET TO SPACE AFTER EACH              
      *           CALL TO THE ROUTINE, EXCEPT FOR LOOKUP-TYPE                   
      *           AND EFF-DTE                                                   
      *           THIS COPYBOOK ALSO CONTAINS DCLGEN FOR DB2 TABLES.            
      *                                                                         
      ******************************************************************        
                                                                                
       01  ML501-PV-PROGRAM-VARIABLE.                                           
           05  ML501-PV-INPUT-AREA.                                             
               10  ML501-PV-LOOKUP-TYPE-IN PIC X(08)       VALUE SPACES.        
                   88  ML501-PV-NO-LOOKUP-TYPE             VALUE SPACES.        
                   88  ML501-PV-SKU-LOOKUP                 VALUE 'SKU'.         
                   88  ML501-PV-UPC-NBR-LOOKUP             VALUE                
                       'UPCNBR'.                                                
                   88  ML501-PV-UPC-ID-LOOKUP              VALUE                
                       'UPCID'.                                                 
                   88  ML501-PV-ITM-NBR-LOOKUP             VALUE 'ITM'.         
                   88  ML501-PV-INHOUSE-LOOKUP             VALUE                
                       'INHOUSE'.                                               
               10  ML501-PV-EFF-DTE-IN     PIC X(10)       VALUE SPACES.        
               10  ML501-PV-ENT-ID-IN      PIC X(09)       VALUE SPACES.        
               10  ML501-PV-ENT-ID-IN-9 REDEFINES ML501-PV-ENT-ID-IN            
                                           PIC 9(09).                           
               10  ML501-PV-INHOUSE-NBR-IN PIC X(03)       VALUE SPACES.        
               10  ML501-PV-INHOUSE-NBR-IN-9 REDEFINES                          
                   ML501-PV-INHOUSE-NBR-IN PIC 9(03).                           
               10  ML501-PV-DEPT-IN        PIC X(04)       VALUE SPACES.        
               10  ML501-PV-DEPT-IN-9 REDEFINES ML501-PV-DEPT-IN                
                                           PIC 9(04).                           
               10  FILLER REDEFINES ML501-PV-DEPT-IN.                           
                   15  FILLER              PIC X(01).                           
                   15  ML501-PV-DEPT-IN-3X PIC X(03).                           
                   15  ML501-PV-DEPT-IN-3X-9 REDEFINES                          
                       ML501-PV-DEPT-IN-3X PIC 9(03).                           
               10  ML501-PV-SKU-IN         PIC X(08)       VALUE SPACES.        
               10  ML501-PV-SKU-IN-9 REDEFINES ML501-PV-SKU-IN                  
                                           PIC 9(08).                           
               10  FILLER REDEFINES ML501-PV-SKU-IN.                            
                   15  FILLER              PIC X(05).                           
                   15  FILLER              PIC X(03).                           
                       88  ML501-PV-DUMMY-SKU              VALUES ARE           
                           '000' '999'.                                         
               10  ML501-PV-UPC-NBR-IN     PIC X(15)       VALUE SPACES.        
               10  ML501-PV-UPC-NBR-IN-9 REDEFINES ML501-PV-UPC-NBR-IN          
                                           PIC 9(15).                           
               10  ML501-PV-UPC-ID-IN      PIC X(09)       VALUE SPACES.        
               10  ML501-PV-UPC-ID-IN-9 REDEFINES ML501-PV-UPC-ID-IN            
                                           PIC 9(09).                           
               10  ML501-PV-ITM-NBR-IN     PIC X(15)       VALUE SPACES.        
               10  ML501-PV-ITM-NBR-IN-9 REDEFINES ML501-PV-ITM-NBR-IN          
                                           PIC 9(15).                           
           05  ML501-PV-OUTPUT-AREA.                                            
               10  ML501-PV-ENT-ID-OUT     PIC S9(09)      VALUE ZEROES         
                               COMP.                                            
26006              88  ML501-PV-ENT-NOT-FOUND              VALUE +5161.         
               10  ML501-PV-RETURN-STATUS-AREA.                                 
                   15  ML501-PV-RETURN-CDE PIC S9(04)      VALUE ZEROES         
                               COMP.                                            
                       88  ML501-PV-FOUND                  VALUES ARE           
                           ZEROES, +04.                                         
                       88  ML501-PV-FOUND-AS-REQUESTED     VALUE ZEROES.        
                       88  ML501-PV-FOUND-WITH-ASSUMPTION  VALUE +04.           
                       88  ML501-PV-NOT-FOUND              VALUE +08.           
                       88  ML501-PV-SQL-ERROR              VALUE +16.           
                   15  ML501-PV-RETURN-RSN PIC X(40)       VALUE SPACES.        
                       88  ML501-PV-ENT-ID-GIVEN           VALUE                
                           'RETURN ENT-ID GIVEN IN THE REQUEST      '.          
                       88  ML501-PV-FAIL-ASSUMPTION-RULE   VALUE                
                           'CANNOT DETERMINE ASSUMPTION RULE        '.          
                       88  ML501-PV-TRY-SKU-LOOKUP         VALUE                
                           'TRY TO LOOKUP USING SKU                 '.          
                       88  ML501-PV-TRY-UPC-NBR-LOOKUP     VALUE                
                           'TRY TO LOOKUP USING UPC-NBR             '.          
                       88  ML501-PV-TRY-UPC-ID-LOOKUP      VALUE                
                           'TRY TO LOOKUP USING UPC-ID              '.          
                       88  ML501-PV-TRY-ITM-NBR-LOOKUP     VALUE                
                           'TRY TO LOOKUP USING ITM-NBR             '.          
                       88  ML501-PV-TRY-INHOUSE-LOOKUP     VALUE                
                           'TRY TO LOOKUP USING IN-HOUSE NUMBER     '.          
           05  ML501-PV-WORK-AREA.                                              
               10  ML501-PV-WORK-SKU       PIC S9(08)V     VALUE ZEROES         
                               COMP-3.                                          
               10  ML501-PV-WORK-UPC-NBR   PIC S9(15)V     VALUE ZEROES         
                               COMP-3.                                          
               10  ML501-PV-WORK-UPC-ID    PIC S9(09)      VALUE ZEROES         
                               COMP.                                            
               10  ML501-PV-WORK-ITM-NBR   PIC S9(15)V     VALUE ZEROES         
                               COMP-3.                                          
               10  ML501-PV-WORK-INHOUSE   PIC S9(03)V     VALUE ZEROES         
                               COMP-3.                                          
               10  ML501-PV-WORK-DEPT      PIC X(04)       VALUE SPACES.        
               10  ML501-PV-WORK-DEPT-9 REDEFINES ML501-PV-WORK-DEPT            
                                           PIC 9(04).                           
               10  FILLER REDEFINES ML501-PV-WORK-DEPT.                         
                   15  FILLER              PIC X(01).                           
                   15  ML501-PV-WORK-DEPT-3X                                    
                                           PIC X(03).                           
                   15  ML501-PV-WORK-DEPT-3X-9 REDEFINES                        
                       ML501-PV-WORK-DEPT-3X                                    
                                           PIC 9(03).                           
                                                                                
      ******************************************************************        
      *  SKU CROSS REFERENCE LOOKUP TABLE                                       
      ******************************************************************        
           EXEC SQL                                                             
               INCLUDE TSKXREF                                                  
           END-EXEC.                                                            
                                                                                
      ******************************************************************        
      *  VENDOR DEPT TABLE                                                      
      ******************************************************************        
           EXEC SQL                                                             
               INCLUDE TVNDDPT                                                  
           END-EXEC.                                                            
                                                                                
      ******************************************************************        
      *  VENDOR STYLE TABLE                                                     
      ******************************************************************        
           EXEC SQL                                                             
               INCLUDE TVNDSTL                                                  
           END-EXEC.                                                            
                                                                                
      ******************************************************************        
      *  UPC TABLE                                                              
      ******************************************************************        
           EXEC SQL                                                             
               INCLUDE TUPC                                                     
           END-EXEC.                                                            
                                                                                
