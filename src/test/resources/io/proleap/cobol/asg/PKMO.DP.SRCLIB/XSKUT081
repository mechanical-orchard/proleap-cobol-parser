000100***************************************************************** 00030003
000200 IDENTIFICATION DIVISION.                                         00040003
000300***************************************************************** 00050003
000400                                                                  00060003
000500 PROGRAM-ID.             XSKUT081.                                00070003
000600 AUTHOR.                 NANCY MARTIN.                            00080003
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00090003
000800 DATE-WRITTEN            NOV 2004.                                00100003
000900 DATE-COMPILED.                                                   00110003
001000                                                                  00120003
001100***************************************************************** 00130003
001200*                                                                 00140003
001300*  THIS PROGRAM IS RESPONSIBLE FOR DROPPING PRICE CHANGE DATA     00150003
      *  FROM SOR EXTRACT FILE WHEN THE DATE IS BEFORE CONTROL DATE OR  00160003
      *  IF THERE IS NO ASSOCIATED STORE GROUP PRCHG FOR THE MDSE REC.  00170003
002800*  DROPS ALL RECORDS THAT ARE EXPIRED FROM AN XS DOMAIN POINT OF  00180003
002800*  VIEW. ALL OF THIS IS DONE TO FACILITATE INTEGRITY CHECKING.    00190003
002800*                                                                 00210003
002900*   INPUT: INP00 - TODAY'S DATE (ESP JOB SCHEDULED DATE)          00220003
003200*          INP01 - FILE OF STR GP PRCHG DATA, EXTRACTED BY NEW    00240003
003300*                  PERM, THE SYSTEM OF RECORD. THIS FILE HAS      00250003
003400*                  THE EFFECTIVE DATE FOR COMPARE PURPOSES.       00260003
003500*          INP02 - FILE OF PRCHG MDSE DETAIL DATA, EXTRACTED      00270003
003600*                  BY NEW PERM, THE SYSTEM OF RECORD.             00280003
002800*                                                                 00300003
002900*  OUTPUT: OUT01 - CONTAINS FILE OF PRCHG STR GP DATA, OMITTING   00310003
003000*                  WHEN EFF DATE IS NOT > = CONTROL CARD DATE.    00320003
003900*                                                                 00340003
002900*          OUT02 - CONTAINS FILE OF PRCHG MDSE DETAIL DATA,       00350003
003000*                  OMITTING RECORDS WITH AN EXPIRED EFFECTIVE     00360003
003900*                  DATE (BASED ON CONTROL CARD) ON ASSOCIATED     00370003
003900*                  STR GP PRCHG -- OR IF STR GP PRCHG NOT FOUND.  00380003
003900*                                                                 00390003
004000***************************************************************** 00400003
004100* HISTORY LOG:                                                    00410003
004200***************************************************************** 00411003
004300* DATE:        NOVEMBER 1, 2004                                   00412003
004400* WR/IR#:      WR27634                                            00413003
004500* PROGRAMMER:  NANCY MARTIN                                       00414003
004600* DESCRIPTION: THIS PROGRAM CLONED FROM XSKUT063.                 00415003
004700*                                                                 00416003
004200***************************************************************** 00420003
004300* DATE:                                                           00430003
004400* WR/IR#:                                                         00440003
004500* PROGRAMMER:                                                     00450003
004600* DESCRIPTION:                                                    00460003
004700*                                                                 00470003
004800***************************************************************** 00480003
004900 ENVIRONMENT DIVISION.                                            00490003
005000***************************************************************** 00500003
005100                                                                  00510003
005200 CONFIGURATION SECTION.                                           00520003
005300                                                                  00530003
005400 SOURCE-COMPUTER.        IBM-3090.                                00540003
005500 OBJECT-COMPUTER.        IBM-3090.                                00550003
005600                                                                  00560003
005700 INPUT-OUTPUT SECTION.                                            00570003
005800                                                                  00580003
005900 FILE-CONTROL.                                                    00590003
006000                                                                  00600003
004700     SELECT CONTROL-CARD-DATE                                     00610003
004800         ASSIGN TO INP00.                                         00620003
004600                                                                  00630003
006700     SELECT PRCHG-GP-EXTR-FILE                                    00670003
006800         ASSIGN TO INP01.                                         00680003
006900                                                                  00690003
007000     SELECT PRCHG-MDSE-EXTR-FILE                                  00700003
007100         ASSIGN TO INP02.                                         00710003
007200                                                                  00720003
007300     SELECT PRCHG-GP-FUTURE-FILE                                  00730003
007400         ASSIGN TO OUT01.                                         00740003
007200                                                                  00750003
007300     SELECT PRCHG-MDSE-FUTURE-FILE                                00760003
007400         ASSIGN TO OUT02.                                         00770003
007500                                                                  00780003
007600******************************************************************00790003
007700 DATA DIVISION.                                                   00800003
007800******************************************************************00810003
007900                                                                  00820003
008000 FILE SECTION.                                                    00830003
008100                                                                  00840003
005700 FD  CONTROL-CARD-DATE                                            00850003
005800     RECORDING MODE F                                             00860003
005900     BLOCK CONTAINS 0 RECORDS                                     00870003
006000     LABEL RECORDS ARE OMITTED                                    00880003
006100     DATA RECORD IS CONTROL-DATE-RECORD.                          00890003
006200 01  CONTROL-DATE-RECORD                PIC X(080).               00900003
005500                                                                  00910003
009600 FD  PRCHG-GP-EXTR-FILE                                           00990003
009700     RECORDING MODE IS F                                          01000003
009800     BLOCK CONTAINS 0  RECORDS.                                   01010003
010000 01  PRCHG-GP-EXTR-RECORD             PIC  X(200).                01030003
010100                                                                  01040003
010200 FD  PRCHG-MDSE-EXTR-FILE                                         01050003
010300     RECORDING MODE IS F                                          01060003
010400     BLOCK CONTAINS 0  RECORDS.                                   01070003
010600 01  PRCHG-MDSE-EXTR-RECORD           PIC  X(200).                01090003
010700                                                                  01100003
010800 FD  PRCHG-GP-FUTURE-FILE                                         01110003
010900     RECORDING MODE IS F                                          01120003
011000     BLOCK CONTAINS 0  RECORDS.                                   01130003
011200 01  PRCHG-GP-FUTURE-RECORD           PIC  X(200).                01150003
010700                                                                  01160003
010800 FD  PRCHG-MDSE-FUTURE-FILE                                       01170003
010900     RECORDING MODE IS F                                          01180003
011000     BLOCK CONTAINS 0  RECORDS.                                   01190003
011200 01  PRCHG-MDSE-FUTURE-RECORD         PIC  X(200).                01210003
011300                                                                  01220003
011400******************************************************************01230003
011500 WORKING-STORAGE SECTION.                                         01240003
011600******************************************************************01250003
011700                                                                  01260003
013900 01  AC-ABEND-CODE                    PIC S9(04) VALUE ZERO       01270003
014000                                                 COMP SYNC.       01280003
014100     88  AC-CONTROL-CARD-ERROR                   VALUE +4003.     01290003
014300     88  AC-CALENDAR-ROUTINE-ERROR               VALUE +4019.     01300003
014400                                                                  01310003
014500 01  PS-PROGRAM-SWITCHES.                                         01320003
014600     05  PS-EOF-CC-SW                 PIC  X(01) VALUE 'N'.       01330003
014700         88  END-OF-CC                           VALUE 'Y'.       01340003
015000     05  PS-EOF-HEADER-INPUT-FILE-SW  PIC  X(01) VALUE 'Y'.       01350003
015100         88  MORE-HEADER-INPUT                   VALUE 'Y'.       01360003
015100         88  END-OF-HEADER-INPUT                 VALUE 'N'.       01370003
015200     05  PS-EOF-DETAIL-INPUT-FILE-SW PIC   X(01) VALUE 'Y'.       01380003
015300         88  MORE-DETAIL-INPUT                   VALUE 'Y'.       01390003
015300         88  END-OF-DETAIL-INPUT                 VALUE 'N'.       01400003
015400     05  DETAIL-FOUND-SW              PIC  X(01) VALUE 'N'.       01410003
015500         88  DETAIL-FOUND                        VALUE 'Y'.       01420003
015600         88  NO-DETAIL-FOUND                     VALUE 'N'.       01430003
015700                                                                  01440003
015800 01  PC-CONSTANTS.                                                01450003
016100     05  PC-PROGRAM-NAME              PIC  X(08)                  01460003
016200                                      VALUE 'XSKUT081'.           01470003
016300                                                                  01490003
016400 01  PV-MISC-FIELDS.                                              01500003
016500     05  PV-PARAGRAPH-NAME            PIC  X(30) VALUE SPACE.     01510003
           05  PV-HEADER-READ-CNT           PIC  9(10) VALUE ZEROS.     01520003
           05  PV-DETAIL-READ-CNT           PIC  9(10) VALUE ZEROS.     01530003
           05  PV-DROP-HDR-CNT              PIC  9(10) VALUE ZEROS.     01540003
           05  PV-DROP-DTL-CNT              PIC  9(10) VALUE ZEROS.     01550003
           05  PV-KEEP-HDR-CNT              PIC  9(10) VALUE ZEROS.     01560003
           05  PV-KEEP-DTL-CNT              PIC  9(10) VALUE ZEROS.     01570003
           05  PV-UNMATCH-DTL-CNT           PIC  9(10) VALUE ZEROS.     01580003
016800     05  PV-OPERATION-MSG-1           PIC  X(40) VALUE SPACE.     01590003
016900     05  PV-OPERATION-MSG-2           PIC  X(40) VALUE SPACE.     01600003
           05  PV-WORK-DATE                 PIC  X(08) VALUE SPACES.    01610003
           05  PV-WORK-DATE-X REDEFINES PV-WORK-DATE.                   01620003
               10 PV-WORK-DATE-CC          PIC  X(02).                  01630003
               10 PV-WORK-DATE-YY          PIC  X(02).                  01640003
               10 PV-WORK-DATE-MM          PIC  X(02).                  01650003
               10 PV-WORK-DATE-DD          PIC  X(02).                  01660003
012200                                                                  01770003
012300*--------------------------------------------------------------*  01780003
012400* XSWS113 CONTROL CARD LAYOUT - TODAYS (JOB SCHEDULED) DATE       01790003
012500*--------------------------------------------------------------*  01800003
012600     COPY XSWS113.                                                01810003
012200                                                                  01820003
018600******************************************************************01880003
018700*  COPYBOOK FOR STR GP PRCHG EXTRACT RECORD                       01890003
018800******************************************************************01900003
018900                                                                  01910003
019000     COPY PERD104.                                                01920003
018500                                                                  01930003
018600******************************************************************01940003
018700*  COPYBOOK FOR PRCHG MDSE DETAIL EXTRACT RECORD                  01950003
018800******************************************************************01960003
018900                                                                  01970003
019000     COPY PERD105.                                                01980003
013200                                                                  01990003
013300*--------------------------------------------------------------*  02000003
013400* DATE ROUTINE COPY MEMBERS                                       02010003
013500*--------------------------------------------------------------*  02020003
013600     COPY DPWS500.                                                02030003
009168                                                                  02040003
021700***************************************************************** 02050003
021800 PROCEDURE DIVISION.                                              02060003
021900***************************************************************** 02070003
022000                                                                  02080003
022100******************************************************************02090003
022200 0000-MAINLINE-PARAGRAPH.                                         02100003
022300******************************************************************02110003
022400                                                                  02120003
022500     PERFORM 1000-INITIALIZE.                                     02130003
022600                                                                  02140003
022700     PERFORM 2000-PROCESS-PRCHG                                   02150003
022800       UNTIL END-OF-HEADER-INPUT.                                 02160003
                                                                        02170003
           PERFORM 2100-UNMATCH-DETAIL                                  02180003
029000        UNTIL END-OF-DETAIL-INPUT.                                02190003
                                                                        02200003
023500     PERFORM 9000-DISPLAY-STATISTICS                              02210003
                                                                        02220003
           PERFORM 9050-CLOSE-FILES.                                    02230003
                                                                        02240003
023200     STOP RUN.                                                    02250003
023300                                                                  02260003
023400******************************************************************02270003
023500 1000-INITIALIZE.                                                 02280003
023600*     OPEN AND READS INPUT FILES AND PROCESS CONTROL CARDS.       02290003
023700******************************************************************02300003
023800                                                                  02310003
           DISPLAY '*********************************************'.     02320003
           DISPLAY 'START OF PROGRAM NAME: ' PC-PROGRAM-NAME.           02330003
           DISPLAY '*********************************************'.     02340003
025800     MOVE '1000-INITIALIZE'        TO PV-PARAGRAPH-NAME.          02350003
                                                                        02360003
025400     OPEN INPUT CONTROL-CARD-DATE,                                02370003
024100                PRCHG-GP-EXTR-FILE                                02390003
024200                PRCHG-MDSE-EXTR-FILE                              02400003
024300         OUTPUT PRCHG-GP-FUTURE-FILE                              02410003
024300                PRCHG-MDSE-FUTURE-FILE.                           02420003
026100                                                                  02430003
026200     PERFORM 1030-READ-CONTROL-DATE.                              02440003
                                                                        02460003
           MOVE CC-XSCC113-TODAY-CC TO PV-WORK-DATE-CC.                 02510003
           MOVE CC-XSCC113-TODAY-YY TO PV-WORK-DATE-YY.                 02520003
           MOVE CC-XSCC113-TODAY-MM TO PV-WORK-DATE-MM.                 02530003
           MOVE CC-XSCC113-TODAY-DD TO PV-WORK-DATE-DD.                 02540003
           DISPLAY '** CONTROL CARD DATE - ',                           02540103
                    CC-XSCC113-TODAY-DATE,                              02540203
                   '** COMPARE TO PE DATE - ',                          02540303
                    PV-WORK-DATE, '**'.                                 02541003
                                                                        02550003
025400     CLOSE  CONTROL-CARD-DATE.                                    02620003
                                                                        02640003
           PERFORM 8000-READ-PRCHG-GP.                                  02650003
           PERFORM 8100-READ-MDSE.                                      02660003
026700                                                                  02670003
026900*--------------------------------------------------------------*  02680003
027000* 1030-READ-CONTROL-DATE.                                         02690003
027100*     READ CONTROL CARD XSCC113. THIS CONTROL CARD CONTAINS       02700003
027200*     TODAY'S DATE IN DB2 DATE FORMAT.                            02710003
027300*--------------------------------------------------------------*  02720003
027400 1030-READ-CONTROL-DATE.                                          02730003
027500                                                                  02740003
027600     READ CONTROL-CARD-DATE INTO CC-XSCC113-CONTROL-CARD          02750003
027800       AT END                                                     02760003
027900          SET END-OF-CC TO TRUE.                                  02770003
028000                                                                  02780003
028100     IF END-OF-CC                                                 02790003
             MOVE '1030-READ-CONTROL-DATE' TO PV-PARAGRAPH-NAME         02800003
             MOVE 'XSCC113 CC MISSING'     TO PV-OPERATION-MSG-1        02810003
028800       MOVE +4002 TO AC-ABEND-CODE                                02820003
028900       PERFORM 9999-ABEND                                         02830003
029000     ELSE                                                         02840003
029400       DISPLAY ' '                                                02850003
029100       DISPLAY '** TODAYS DATE CONTROL CARD, XSCC113: **'         02860003
029300       DISPLAY CC-XSCC113-CONTROL-CARD                            02870003
029700                                                                  02880003
029800     END-IF.                                                      02890003
029900                                                                  02900003
030000*1030-EXIT.                                                       02910003
                                                                        02920008
027800******************************************************************03590003
027900 2000-PROCESS-PRCHG.                                              03600003
028000******************************************************************03610003
                                                                        03620003
           SET NO-DETAIL-FOUND TO TRUE.                                 03630003
                                                                        03640003
NEMDEL*    DISPLAY '2000- KEYS 105 PRCHG-ID = ', PE105-PRCHG-ID         03641011
NEMDEL*            ' AND 104 =',  PE104-PRCHG-ID                        03641111
NEMDEL*    DISPLAY '           105 STR GP   = ',                        03641211
NEMDEL*            PE105-STR-GP-TYP-CDE,                                03642011
NEMDEL*            '       AND 104 =', PE104-STR-GP-TYP-CDE             03642111
NEMDEL*    DISPLAY '           105 GP ID    = ',                        03642211
NEMDEL*            PE105-STR-GP-ID,                                     03643011
NEMDEL*            '       AND 104 =', PE104-STR-GP-ID                  03644011
NEMDEL*    DISPLAY '           105 HEIR LVL = ',                        03645011
NEMDEL*            PE105-MDSE-HIER-CDE,                                 03646011
NEMDEL*            '       AND 104 EFF DT  =', PE104-PRCHG-EFF-DTE      03647011
                                                                        03648010
           IF (PE105-PRCHG-ID < PE104-PRCHG-ID)                         03649010
             OR (PE105-PRCHG-ID = PE104-PRCHG-ID                        03650010
               AND PE105-STR-GP-TYP-CDE < PE104-STR-GP-TYP-CDE)         03660010
             OR (PE105-PRCHG-ID = PE104-PRCHG-ID                        03670010
               AND PE105-STR-GP-TYP-CDE = PE104-STR-GP-TYP-CDE          03671010
               AND PE105-STR-GP-ID < PE104-STR-GP-ID)                   03672010
              PERFORM 2100-UNMATCH-DETAIL                               03673010
028900          UNTIL (PE105-PRCHG-ID > PE104-PRCHG-ID)                 03674010
                   OR  DETAIL-FOUND                                     03675010
029000             OR END-OF-DETAIL-INPUT                               03676010
           END-IF.                                                      03677010
                                                                        03680003
           IF PE104-PRCHG-ID = PE105-PRCHG-ID                           03690003
            AND PE105-STR-GP-TYP-CDE = PE104-STR-GP-TYP-CDE             03691007
            AND PE105-STR-GP-ID = PE104-STR-GP-ID                       03692007
              PERFORM 2200-PROCESS-DETAIL                               03700003
                UNTIL (PE105-PRCHG-ID > PE104-PRCHG-ID)                 03711005
                   OR (PE105-PRCHG-ID = PE104-PRCHG-ID                  03712005
                    AND PE105-STR-GP-TYP-CDE > PE104-STR-GP-TYP-CDE)    03713007
                   OR (PE105-PRCHG-ID = PE104-PRCHG-ID                  03714005
                    AND PE105-STR-GP-TYP-CDE = PE104-STR-GP-TYP-CDE     03715005
                    AND PE105-STR-GP-ID > PE104-STR-GP-ID)              03716007
                   OR END-OF-DETAIL-INPUT                               03720003
           END-IF.                                                      03820003
                                                                        03830003
           IF PE104-PRCHG-EFF-DTE < PV-WORK-DATE                        03831010
              ADD +1 TO PV-DROP-HDR-CNT                                 03833010
           ELSE                                                         03834010
              ADD +1 TO PV-KEEP-HDR-CNT                                 03835010
              PERFORM 8200-WRITE-PRCHG-GP                               03837010
           END-IF.                                                      03838010
           PERFORM 8000-READ-PRCHG-GP.                                  03840003
                                                                        03850003
029400******************************************************************03860003
029500 2100-UNMATCH-DETAIL.                                             03870003
029600******************************************************************03880003
                                                                        03890003
           ADD +1  TO PV-DROP-DTL-CNT                                   03910011
           ADD +1  TO PV-UNMATCH-DTL-CNT                                03930011
                                                                        03980003
           PERFORM 8100-READ-MDSE.                                      03990003
           IF PE105-PRCHG-ID >  PE104-PRCHG-ID                          03992009
             OR (PE105-PRCHG-ID = PE104-PRCHG-ID                        03992109
               AND PE105-STR-GP-TYP-CDE >  PE104-STR-GP-TYP-CDE)        03993009
             OR  (PE105-PRCHG-ID = PE104-PRCHG-ID                       03994009
               AND PE105-STR-GP-TYP-CDE = PE104-STR-GP-TYP-CDE          03995009
               AND PE105-STR-GP-ID >= PE104-STR-GP-ID)                  03996009
              SET DETAIL-FOUND TO TRUE                                  03997009
           END-IF.                                                      03998009
                                                                        04000003
029400******************************************************************04010003
029500 2200-PROCESS-DETAIL.                                             04020003
029600******************************************************************04030003
                                                                        04040003
           IF PE104-PRCHG-EFF-DTE < PV-WORK-DATE                        04051003
              ADD +1  TO PV-DROP-DTL-CNT                                04060003
           ELSE                                                         04070003
              ADD +1  TO PV-KEEP-DTL-CNT                                04080003
              PERFORM 8300-WRITE-PRCHG-MDSE                             04110003
           END-IF.                                                      04120003
                                                                        04130003
           PERFORM 8100-READ-MDSE.                                      04140003
                                                                        04150003
050000******************************************************************04170003
050100* 8000-READ-PRCHG-GP                                              04180003
050200******************************************************************04190003
050300 8000-READ-PRCHG-GP.                                              04200003
                                                                        04210003
025800     MOVE '8000-READ-PRCHG-GP'     TO PV-PARAGRAPH-NAME.          04220003
                                                                        04230003
029800     READ PRCHG-GP-EXTR-FILE INTO                                 04240003
029800          PE104-RECORD                                            04250003
029900        AT END                                                    04260003
030000           SET END-OF-HEADER-INPUT TO TRUE.                       04270003
                                                                        04280003
           IF MORE-HEADER-INPUT                                         04290003
              ADD +1  TO PV-HEADER-READ-CNT                             04300003
           END-IF.                                                      04310003
031700                                                                  04320003
050000******************************************************************04330003
050100* 8100-READ-MDSE.                                                 04340003
050200******************************************************************04350003
050300 8100-READ-MDSE.                                                  04360003
                                                                        04370003
025800     MOVE '8100-READ-MDSE'       TO PV-PARAGRAPH-NAME.            04380003
                                                                        04390003
029800     READ PRCHG-MDSE-EXTR-FILE INTO                               04400003
029800          PE105-RECORD                                            04410003
029900        AT END                                                    04420003
030000           SET END-OF-DETAIL-INPUT TO TRUE.                       04430003
                                                                        04440003
           IF MORE-DETAIL-INPUT                                         04450003
              ADD +1  TO PV-DETAIL-READ-CNT                             04460003
           END-IF.                                                      04470003
036000                                                                  04480003
048600******************************************************************04490003
048700 8200-WRITE-PRCHG-GP.                                             04500003
048800*     WRITE STR GP PRCHG EXTRACT RECORD TO THE FUTURE FILE.       04510003
048900******************************************************************04520003
                                                                        04530003
025800     MOVE '8200-WRITE-PRCHG-GP' TO PV-PARAGRAPH-NAME.             04540003
049000                                                                  04550003
049300     WRITE PRCHG-GP-FUTURE-RECORD                                 04560003
049400        FROM PE104-RECORD.                                        04570003
049500                                                                  04580003
048600******************************************************************04590003
048700 8300-WRITE-PRCHG-MDSE.                                           04600003
048800*     WRITE PRCHG MDSE DETAIL EXTRACT RECORD TO THE FUTURE FILE.  04610003
048900******************************************************************04620003
                                                                        04630003
           MOVE '8300-WRITE-PRCHG-MDSE' TO PV-PARAGRAPH-NAME.           04640003
                                                                        04650008
049300     WRITE PRCHG-MDSE-FUTURE-RECORD                               04660003
049400        FROM PE105-RECORD.                                        04670003
049500                                                                  04680003
      ****************************************************************  04690003
      *DISPLAY PROGRAM STATISTICS FOR THIS RUN                          04700003
      ****************************************************************  04710003
       9000-DISPLAY-STATISTICS.                                         04720003
                                                                        04730003
           MOVE '9000-DISPLAY-STATISTICS' TO PV-PARAGRAPH-NAME.         04740003
                                                                        04750003
           DISPLAY '*********************************************'.     04760003
           DISPLAY 'END OF PROGRAM NAME: ' PC-PROGRAM-NAME.             04770003
           DISPLAY '*********************************************'.     04780003
           DISPLAY 'STR GP RECORDS READ:       ' PV-HEADER-READ-CNT.    04790006
           DISPLAY '   STR GP RECORDS WRITTEN:    ' PV-KEEP-HDR-CNT.    04800006
           DISPLAY '   STR GP RECORDS DROPPED:    ' PV-DROP-HDR-CNT.    04810006
           DISPLAY '                       '.                           04820003
           DISPLAY '  MDSE RECORDS READ:       ' PV-DETAIL-READ-CNT.    04830006
           DISPLAY '     MDSE RECORDS WRITTEN:    ' PV-KEEP-DTL-CNT.    04840006
           DISPLAY '     MDSE RECORDS DROPPED:    ' PV-DROP-DTL-CNT.    04850006
           DISPLAY '                       '.                           04860003
           DISPLAY 'UNMATCHED DETAIL RECS:     ' PV-UNMATCH-DTL-CNT.    04870003
                                                                        04880003
036100****************************************************************  04890003
036200*CLOSES FILES (EXCEPT CONTROL CARD FILE)                          04900003
036300****************************************************************  04910003
       9050-CLOSE-FILES.                                                04920003
                                                                        04930003
           MOVE '9050-CLOSE-FILES' TO PV-PARAGRAPH-NAME.                04940003
036500                                                                  04950003
025300     CLOSE PRCHG-GP-EXTR-FILE                                     04960003
025300           PRCHG-MDSE-EXTR-FILE                                   04970003
025300           PRCHG-GP-FUTURE-FILE                                   04980003
025300           PRCHG-MDSE-FUTURE-FILE.                                04990003
039500                                                                  05000003
039600******************************************************************05010003
039700* 9999-ABEND                                                      05020003
039800*     ABEND PROGRAM WHEN A NON-DB2 ERROR OCCURS.                  05030003
039900******************************************************************05040003
040000 9999-ABEND.                                                      05050003
040100     DISPLAY '** ABEND           **'.                             05060003
040200     DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.          05070003
040300     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        05080003
040400     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       05090003
040500     DISPLAY '**                 ** = ' PV-OPERATION-MSG-2.       05100003
040600     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         05110003
