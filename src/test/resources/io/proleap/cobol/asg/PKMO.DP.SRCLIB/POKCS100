000100*-----------------------*                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    POKCS100.                                         00040000
000500 AUTHOR.        DAVE COLOMBO - COMPUWARE.                         00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  06-08-99.                                         00070000
000800 DATE-COMPILED.                                                   00080000
000900                                                                  00090000
001000***************************************************************** 00100000
001100*----------------------------------------------------------------*00110000
001200*    W100 - PURCHASE ORDER SET MAINTENANCE                       *00120000
001300*                                                                *00130000
001400*    THIS PROGRAM ALLOWS THE USER TO ADD, UPDATE OR DELETE       *00140000
001500*    PURCHASE ORDER SETS.                                        *00150000
001600*----------------------------------------------------------------*00160000
CICS  *  CHANGED 11/16/2022    BY BARB SCHULTZ    WR: CHG0278485       *00161099
CICS  *                                                                *00162099
CICS  *  ADDED COPYBOOK DPWS930 AND MADE THE CICS ARCHITECTURE CALL    *00163099
CICS  *  DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.     *00164099
001600*----------------------------------------------------------------*00164199
0323RM*  CHANGED 03/21/2023    BY BOB MCASEY      WR: CHG0286952        00164299
0323RM*                                                                *00164399
0323RM*  REMOVE LOGIC RELATED TO POG INFO.                             *00164499
001600*----------------------------------------------------------------*00164699
001700 ENVIRONMENT DIVISION.                                            00170000
001800 DATA DIVISION.                                                   00180000
001900 WORKING-STORAGE SECTION.                                         00190000
002000                                                                  00200000
002100 01  DK-DB2-KEYS.                                                 00210000
002200     05  DK-YEAR                        PIC X(04)   VALUE SPACES. 00220000
002300     05  DK-SHORT-NME                   PIC X(05)   VALUE SPACES. 00230000
002400     05  DK-YEAR-POG                    PIC X(04)   VALUE SPACES. 00240099
002500     05  DK-SHORT-NME-POG               PIC X(05)   VALUE SPACES. 00250000
002600     05  DK-TYP-CDE                     PIC X(03)   VALUE SPACES. 00260000
002700                                                                  00270000
002800 01  PC-PROGRAM-CONSTANTS.                                        00280000
002900     05  PC-CURRENT-PROGRAM-NAME  PIC  X(08)  VALUE  'POKCS100'.  00290000
003000     05  PC-CURRENT-MAP-NAME      PIC  X(08)  VALUE  'PO100A  '.  00300000
003100     05  PC-CURRENT-MAPSET-NAME   PIC  X(08)  VALUE  'POKM100 '.  00310000
003200     05  PC-APPL-MAP              PIC S9(04)  VALUE  +1           00320000
003300                                              COMP.               00330000
003400     05  PC-MAX-RETRIES           PIC S9(04)  VALUE  +3           00340000
003500                                              COMP.               00350000
003600                                                                  00360000
003700     05  PC-DEFAULT-DATE          PIC X(10)   VALUE '9999-09-09'. 00370000
003800     05  PC-INTER-APPL-CODES.                                     00380000
003900         10  PC-INTER-APPL-ADD        PIC  X(01)  VALUE ' '.      00390000
004000         10  PC-INTER-APPL-LIST-UPD   PIC  X(01)  VALUE '1'.      00400000
004100         10  PC-INTER-APPL-LIST-DEL   PIC  X(01)  VALUE '2'.      00410000
004200                                                                  00420000
004300     05  PC-TSYMSG-NUMBERS.                                       00430000
004400         10  PC-TSYMSG-00004      PIC  9(05)  VALUE  00004.       00440000
004500         10  PC-TSYMSG-00005      PIC  9(05)  VALUE  00005.       00450000
004600         10  PC-TSYMSG-00007      PIC  9(05)  VALUE  00007.       00460000
004700         10  PC-TSYMSG-00008      PIC  9(05)  VALUE  00008.       00470000
004800         10  PC-TSYMSG-00009      PIC  9(05)  VALUE  00009.       00480000
004900         10  PC-TSYMSG-00045      PIC  9(05)  VALUE  00045.       00490000
005000         10  PC-TSYMSG-00057      PIC  9(05)  VALUE  00057.       00500000
005100         10  PC-TSYMSG-00059      PIC  9(05)  VALUE  00059.       00510000
005200         10  PC-TSYMSG-00069      PIC  9(05)  VALUE  00069.       00520000
005300         10  PC-TSYMSG-00070      PIC  9(05)  VALUE  00070.       00530000
005400         10  PC-TSYMSG-00101      PIC  9(05)  VALUE  00101.       00540000
005500         10  PC-TSYMSG-00148      PIC  9(05)  VALUE  00148.       00550000
005600         10  PC-TSYMSG-00150      PIC  9(05)  VALUE  00150.       00560000
005700         10  PC-TSYMSG-00151      PIC  9(05)  VALUE  00151.       00570000
005800         10  PC-TSYMSG-00342      PIC  9(05)  VALUE  00342.       00580000
005900         10  PC-TSYMSG-00349      PIC  9(05)  VALUE  00349.       00590000
006000         10  PC-TSYMSG-00551      PIC  9(05)  VALUE  00551.       00600000
006100         10  PC-TSYMSG-01271      PIC  9(05)  VALUE  01271.       00610000
006200         10  PC-TSYMSG-01277      PIC  9(05)  VALUE  01277.       00620000
006300         10  PC-TSYMSG-01591      PIC  9(05)  VALUE  01591.       00630000
006400         10  PC-TSYMSG-02041      PIC  9(05)  VALUE  02041.       00640000
006500         10  PC-TSYMSG-02042      PIC  9(05)  VALUE  02042.       00650000
006600         10  PC-TSYMSG-02983      PIC  9(05)  VALUE  02983.       00660000
006700         10  PC-TSYMSG-02984      PIC  9(05)  VALUE  02984.       00670000
006800         10  PC-TSYMSG-02985      PIC  9(05)  VALUE  02985.       00680000
006900         10  PC-TSYMSG-02986      PIC  9(05)  VALUE  02986.       00690000
007000         10  PC-TSYMSG-02987      PIC  9(05)  VALUE  02987.       00700000
007100         10  PC-TSYMSG-02988      PIC  9(05)  VALUE  02988.       00710000
007200         10  PC-TSYMSG-02989      PIC  9(05)  VALUE  02989.       00720000
007300         10  PC-TSYMSG-02990      PIC  9(05)  VALUE  02990.       00730000
007410*START PRB0050426                                                 00741000
007420         10  PC-TSYMSG-03760      PIC  9(05)  VALUE  03760.       00742000
007430*END PRB0050426                                                   00743000
007440         10  PC-TSYMSG-99901      PIC 9(05)   VALUE  99901.       00744000
007500                                                                  00750000
007600 01  PS-PROGRAM-SWITCHES.                                         00760000
007700     05  PS-ERROR-SW              PIC  X(01)  VALUE  'N'.         00770000
007800         88  PS-ERROR                         VALUE  'Y'.         00780000
007900         88  PS-NO-ERROR                      VALUE  'N'.         00790000
008000     05  PS-LIST-SW               PIC  X(01)  VALUE  'N'.         00800000
008100         88  PS-LIST-END                      VALUE  'Y'.         00810000
008200         88  PS-LIST-NOT-END                  VALUE  'N'.         00820000
008300     05  PS-POG-DATA-CHECK-SW     PIC  X(01)  VALUE  'N'.         00830000
008400         88  PS-POG-DATA-EXISTS               VALUE  'Y'.         00840000
008500         88  PS-NO-POG-DATA-EXISTS            VALUE  'N'.         00850000
008600     05  PS-POG-REF-DATA-CHECK-SW     PIC  X(01)  VALUE  'N'.     00860000
008700         88  PS-POG-REF-DATA-EXISTS               VALUE  'Y'.     00870000
008800         88  PS-NO-POG-REF-DATA-EXISTS            VALUE  'N'.     00880000
008900     05  PS-POG-DATA-ON-SEASET-SW PIC  X(01)  VALUE  'N'.         00890000
009000         88  PS-POG-DATA-ON-SEASET            VALUE  'Y'.         00900000
009100         88  PS-NO-POG-DATA-ON-SEASET         VALUE  'N'.         00910000
009200     05  PS-SET-YEAR-ENTERED-SW   PIC  X(01)  VALUE  'N'.         00920000
009300         88  PS-SET-YEAR-ENTERED              VALUE  'Y'.         00930000
009400         88  PS-NO-SET-YEAR-ENTERED           VALUE  'N'.         00940000
009401*** INC1295768 START                                              00940199
009410     05  PS-STR-RELS-DTE-CRSD-SW  PIC  X(01)  VALUE  'N'.         00941099
009420         88  PS-STR-RELS-DTE-CRSD             VALUE  'Y'.         00942099
009430         88  PS-NOT-STR-RELS-DTE-CRSD         VALUE  'N'.         00943099
009440*** INC1295768 END                                                00944099
009500                                                                  00950000
009600 01  PV-PROGRAM-VARIABLES.                                        00960000
009700     05  PV-STUP-BEG-DTE          PIC X(10)   VALUE SPACES.       00970000
009800     05  PV-STUP-END-DTE          PIC X(10)   VALUE SPACES.       00980000
009900     05  PV-RLSE-BEG-DTE          PIC X(10)   VALUE SPACES.       00990000
010000     05  PV-RLSE-END-DTE          PIC X(10)   VALUE SPACES.       01000000
010100     05  PV-STAT-CDE              PIC X(01)   VALUE SPACES.       01010000
010200     05  PV-ALPHA-FIELD           PIC X(04)   VALUE SPACES.       01020000
010300     05  PV-SEASET-YR             PIC X(04).                      01030000
010400     05  PV-SEASET-SHRT-NM        PIC X(05).                      01040000
010500     05  PV-DB2-COUNT             PIC S9(04)  VALUE +0            01050000
010600                                              COMP SYNC.          01060000
010700     05  PV-CICS-RESPONSE         PIC S9(04)  VALUE +0            01070000
010800                                              COMP SYNC.          01080000
010900     05  PV-RETRY-COUNTER         PIC S9(04)  VALUE +0            01090000
011000                                              COMP SYNC.          01100000
011002*** INC1295768 START                                              01100299
011003     05  PV-CURR-DATE             PIC X(10)   VALUE SPACES.       01100399
011005*** INC1295768 END                                                01100599
011010*START PRB0050426                                                 01101000
011100     05  PV-CURR-YEAR              PIC X(04).                     01110000
011110     05  PV-CURR-YEAR-NUM          REDEFINES PV-CURR-YEAR         01111000
011120                                   PIC 9(04).                     01112000
011300*END PRB0050426                                                   01130000
011400     05  PV-SET-NME-YR-MESSAGE-TEXT.                              01140000
011500         10  PV-SEASET-YR-MSG      PIC X(04).                     01150000
011600         10  FILLER                PIC X(01)    VALUE SPACES.     01160000
011700         10  PV-SEASET-SHRT-NM-MSG PIC X(05).                     01170000
011800*                                                                 01180000
011900     05  PV-DB-DATE-10.                                           01190000
012000         10  PV-DB-DATE-CC         PIC X(02).                     01200000
012100         10  PV-DB-DATE.                                          01210000
012200             15  PV-DB-DATE-YY     PIC X(02).                     01220000
012300             15  FILLER            PIC X(01)    VALUE '-'.        01230000
012400             15  PV-DB-DATE-MM     PIC X(02).                     01240000
012500             15  FILLER            PIC X(01)    VALUE '-'.        01250000
012600             15  PV-DB-DATE-DD     PIC X(02).                     01260000
012700     05  PV-SLASH-DATE.                                           01270000
012800         10  PV-SL-DATE.                                          01280000
012900             15  PV-SL-DATE-MM     PIC X(02).                     01290000
013000             15  FILLER            PIC X(01)    VALUE '/'.        01300000
013100             15  PV-SL-DATE-DD     PIC X(02).                     01310000
013200             15  FILLER            PIC X(01)    VALUE '/'.        01320000
013300             15  PV-SL-DATE-YY     PIC X(02).                     01330000
013400         10  PV-SL-DATE-CC         PIC X(02).                     01340000
013500     05  PV-FIXTURE-ID-OPTION      PIC  X(01)  VALUE SPACE.       01350000
013600         88 PV-VALID-FIXTURE-ID-OPTION         VALUE 'Y' 'N'.     01360000
013700                                                                  01370000
013800 01  TABLES.                                                      01380000
013900     05  PT-LONG-NAME.                                            01390000
014000         10  PT-LONG-NAME-CH OCCURS 25 TIMES                      01400000
014100                             INDEXED BY PT-IDX PIC X.             01410000
014200     EJECT                                                        01420000
014300**--------------------------------------------------------------**01430000
014400** THE LAYOUT FOR THE TEMPORARY STORAGE QUEUE CONTAINING        **01440000
014500** SELECTED LIST ITEMS TO BE PROCESSED BY THIS PROGRAM.         **01450000
014600**--------------------------------------------------------------**01460000
014700     COPY POWS077.                                                01470000
014800 EJECT                                                            01480000
014900                                                                  01490000
015000*----------------------------------------------------------------*01500000
015100*    MAP LAYOUT                                                  *01510000
015200*----------------------------------------------------------------*01520000
015300                                                                  01530000
015400     COPY POKM100.                                                01540000
015500 01  MR-OCCURS-LAYOUT                   REDEFINES  PO100AO.       01550000
015600     05  FILLER                         PIC X(12).                01560000
015700                                                                  01570000
015800     05  MR-SHRTNML                     PIC S9(04) COMP.          01580000
015900     05  MR-SHRTNMA                     PIC X(01).                01590000
016000     05  MR-SHRTNMC                     PIC X(01).                01600000
016100     05  MR-SHRTNMH                     PIC X(01).                01610000
016200     05  MR-SHRTNM                      PIC X(04).                01620000
016300                                                                  01630000
016400     05  MR-YEARL                       PIC S9(04) COMP.          01640000
016500     05  MR-YEARA                       PIC X(01).                01650000
016600     05  MR-YEARC                       PIC X(01).                01660000
016700     05  MR-YEARH                       PIC X(01).                01670000
016800     05  MR-YEAR                        PIC X(04).                01680000
016900                                                                  01690000
017000     05  MR-TYP-CDEL                    PIC S9(04) COMP.          01700000
017100     05  MR-TYP-CDEA                    PIC X(01).                01710000
017200     05  MR-TYP-CDEC                    PIC X(01).                01720000
017300     05  MR-TYP-CDEH                    PIC X(01).                01730000
017400     05  MR-TYP-CDE                     PIC X(03).                01740000
017500                                                                  01750000
017600     05  MR-TYP-DSCL                    PIC S9(04) COMP.          01760000
017700     05  MR-TYP-DSCA                    PIC X(01).                01770000
017800     05  MR-TYP-DSCC                    PIC X(01).                01780000
017900     05  MR-TYP-DSCH                    PIC X(01).                01790000
018000     05  MR-TYP-DSC                     PIC X(25).                01800000
018100                                                                  01810000
018200     05  MR-LONG-NMEL                   PIC S9(04) COMP.          01820000
018300     05  MR-LONG-NMEA                   PIC X(01).                01830000
018400     05  MR-LONG-NMEC                   PIC X(01).                01840000
018500     05  MR-LONG-NMEH                   PIC X(01).                01850000
018600     05  MR-LONG-NME                    PIC X(25).                01860000
018700                                                                  01870000
018800     05  MR-STUP-BEG-DTEL               PIC S9(04) COMP.          01880000
018900     05  MR-STUP-BEG-DTEA               PIC X(01).                01890000
019000     05  MR-STUP-BEG-DTEC               PIC X(01).                01900000
019100     05  MR-STUP-BEG-DTEH               PIC X(01).                01910000
019200     05  MR-STUP-BEG-DTE                PIC X(10).                01920000
019300                                                                  01930000
019400     05  MR-STUP-END-DTEL               PIC S9(04) COMP.          01940000
019500     05  MR-STUP-END-DTEA               PIC X(01).                01950000
019600     05  MR-STUP-END-DTEC               PIC X(01).                01960000
019700     05  MR-STUP-END-DTEH               PIC X(01).                01970000
019800     05  MR-STUP-END-DTE                PIC X(10).                01980000
019900                                                                  01990000
020000     05  MR-RLSE-BEG-DTEL               PIC S9(04) COMP.          02000000
020100     05  MR-RLSE-BEG-DTEA               PIC X(01).                02010000
020200     05  MR-RLSE-BEG-DTEC               PIC X(01).                02020000
020300     05  MR-RLSE-BEG-DTEH               PIC X(01).                02030000
020400     05  MR-RLSE-BEG-DTE                PIC X(10).                02040000
020500                                                                  02050000
020600     05  MR-RLSE-END-DTEL               PIC S9(04) COMP.          02060000
020700     05  MR-RLSE-END-DTEA               PIC X(01).                02070000
020800     05  MR-RLSE-END-DTEC               PIC X(01).                02080000
020900     05  MR-RLSE-END-DTEH               PIC X(01).                02090000
021000     05  MR-RLSE-END-DTE                PIC X(10).                02100000
021100                                                                  02110000
021200                                                                  02120000
021300 EJECT                                                            02130000
021400*----------------------------------------------------------------*02140000
021500*    ATTRIBUTE SETTINGS COPYBOOK.                                *02150000
021600*----------------------------------------------------------------*02160000
021700                                                                  02170000
021800     COPY DPWS015.                                                02180000
021900                                                                  02190000
022000*----------------------------------------------------------------*02200000
022100*    FUNCTION KEYS COPYBOOK                                      *02210000
022200*----------------------------------------------------------------*02220000
022300                                                                  02230000
022400     COPY DPWS016.                                                02240000
022500                                                                  02250000
022600 EJECT                                                            02260000
022700**--------------------------------------------------------------**02270000
022800** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **02280000
022900** SUB-ROUTINE (DPKUT100).                                      **02290000
023000**--------------------------------------------------------------**02300000
023100     COPY DPWS010I.                                               02310000
023200 EJECT                                                            02320000
023300**--------------------------------------------------------------**02330000
023400** COPYBOOK FOR CALENDAR ROUTINE                                **02340000
023500**--------------------------------------------------------------**02350000
023600     COPY DPWS500.                                                02360000
023700 EJECT                                                            02370000
023800**--------------------------------------------------------------**02380000
CICS  *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          **02390099
024100**--------------------------------------------------------------**02410000
024200     COPY DPWS030.                                                02420000
CICS       COPY DPWS930.                                                02421099
024300 EJECT                                                            02430000
024400**--------------------------------------------------------------**02440000
024500*    STANDARD COMMAREA.                                           02450000
024600**--------------------------------------------------------------**02460000
024700                                                                  02470000
024800     COPY DPWS020.                                                02480000
024900     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02490000
025000                                                                  02500000
025100***************************************************************** 02510000
025200*    INTER-APPLICATION COMMAREA.                                  02520000
025300***************************************************************** 02530000
025400         10  INTER-APPL-COMM-AREA PIC X(200).                     02540000
025500                                                                  02550000
025600     COPY POWS078.                                                02560000
025700                                                                  02570000
025800***************************************************************** 02580000
025900*    SPECIFIC COMMMAREA FOR POKCS100.                             02590000
026000***************************************************************** 02600000
026100         10  ASC-SPECIFIC-COMMAREA.                               02610000
026200             15  ASC-INT-APPL-FORMAT-IND   PIC  X(01).            02620000
026300                 88  ASC-ADD-IND                       VALUE 'A'. 02630000
026400                 88  ASC-UPD-IND                       VALUE 'U'. 02640000
026500                 88  ASC-DEL-IND                       VALUE 'D'. 02650000
026600             15  ASC-USE-SELECTION-QUEUE-IND                      02660000
026700                                           PIC  X(01).            02670000
026800                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 02680000
026900             15  ASC-SEL-QUEUE-NAME        PIC  X(08).            02690000
027000             15  ASC-NUMBER-OF-TS-ITEMS    PIC S9(05)  COMP-3.    02700000
027100             15  ASC-NUMBER-OF-SELECTED-ITEMS                     02710000
027200                                           PIC S9(09)  COMP-3.    02720000
027300             15  ASC-SEL-SUB               PIC S9(04)  COMP.      02730000
027400             15  ASC-SEL-ITEM              PIC S9(04)  COMP.      02740000
027500             15  ASC-KEY-FIELDS.                                  02750000
027600                 20  ASC-KEY-YEAR          PIC X(04).             02760000
027700                 20  ASC-KEY-YEAR-NUM REDEFINES ASC-KEY-YEAR      02770000
027800                                           PIC 9(04).             02780000
027900                 20  ASC-KEY-SHORT-NME     PIC X(05).             02790000
028000             15  ASC-SCREEN-FIELDS.                               02800000
028100                 20  ASC-TYP-CDE           PIC X(03).             02810000
028200                 20  ASC-LONG-NME          PIC X(25).             02820000
028300                 20  ASC-TYP-DESC          PIC X(25).             02830000
028400                 20  ASC-STUP-BEG-DTE      PIC X(08).             02840000
028500                 20  ASC-STUP-BEG-DTE-ISO  PIC X(10).             02850000
028600                 20  ASC-STUP-END-DTE      PIC X(08).             02860000
028700                 20  ASC-STUP-END-DTE-ISO  PIC X(10).             02870000
028800                 20  ASC-RLSE-BEG-DTE      PIC X(08).             02880000
028900                 20  ASC-RLSE-BEG-DTE-ISO  PIC X(10).             02890000
029000                 20  ASC-RLSE-END-DTE      PIC X(08).             02900000
029100                 20  ASC-RLSE-END-DTE-ISO  PIC X(10).             02910000
029200                 20  ASC-FIXTURE-ID-USE    PIC X(01).             02920000
029700                 20  ASC-PO-RCPT-RPTG-IND  PIC X(01).             02970000
029800             15  ASC-HOLD-TYP-DESC         PIC X(25).             02980000
029900             15  ASC-CONFIRM-SWITCH        PIC X.                 02990000
030000                 88  ASC-CONFIRM-DEL       VALUE 'D'.             03000000
030100                 88  ASC-CONFIRM-DESC      VALUE 'S'.             03010000
030200                 88  ASC-NOT-CONFIRM       VALUE 'N'.             03020000
030300         10  FILLER                        PIC  X(180).           03030000
030400     EJECT                                                        03040000
030500*----------------------------------------------------------------*03050000
030600*    ABEND PROCESSING COPYBOOK.                                  *03060000
030700*----------------------------------------------------------------*03070000
030800                                                                  03080000
030900     COPY DPWS013.                                                03090000
031000                                                                  03100000
031300*----------------------------------------------------------------*03130000
031400*    DB2 AREA FOR TSEASET COPYBOOK                               *03140000
031500*----------------------------------------------------------------*03150000
031600                                                                  03160000
031700     EXEC SQL                                                     03170000
031800          INCLUDE TSEASET                                         03180000
031900     END-EXEC.                                                    03190000
032000                                                                  03200000
032100*----------------------------------------------------------------*03210000
032200*    DB2 AREA FOR TSSTYCD COPYBOOK                               *03220000
032300*----------------------------------------------------------------*03230000
032400                                                                  03240000
032500     EXEC SQL                                                     03250000
032600          INCLUDE TSSTYCD                                         03260000
032700     END-EXEC.                                                    03270000
032800                                                                  03280000
032900 EJECT                                                            03290000
033700                                                                  03370000
033900*----------------------------------------------------------------*03390000
034000*    DB2 AREA FOR COMMUNICATIONS                                 *03400000
034100*----------------------------------------------------------------*03410000
034200                                                                  03420000
034300     EXEC SQL                                                     03430000
034400          INCLUDE SQLCA                                           03440000
034500     END-EXEC.                                                    03450000
034600                                                                  03460000
034700 EJECT                                                            03470000
034800 LINKAGE SECTION.                                                 03480000
034900                                                                  03490000
035000 01  DFHCOMMAREA.                                                 03500000
035100     05  FILLER                         OCCURS  1 TO 4072 TIMES   03510000
035200                                        DEPENDING ON EIBCALEN.    03520000
035300         10  FILLER                     PIC X.                    03530000
035400                                                                  03540000
035500                                                                  03550000
035600 PROCEDURE DIVISION.                                              03560000
035700***************************************************************** 03570000
035800** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 03580000
035900** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 03590000
036000** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 03600000
036100**                                                             ** 03610000
036200** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 03620000
036300** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 03630000
036400***************************************************************** 03640000
036500 0000-MAIN-MODULE.                                                03650000
036600     INITIALIZE DP030-CICS-API-FIELDS.                            03660000
036700     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       03670000
036800     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          03680000
036900     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         03690000
037000     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       03700000
037100     MOVE LENGTH OF PO100AI        TO DP030-MAP-LENGTH (1).       03710000
037200     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     03720000
037300     PERFORM 0001-CALL-CICS-ARCH-API.                             03730000
037400                                                                  03740000
037500     PERFORM 1000-CONTROL-PROCESSING                              03750000
037600                                                                  03760000
037700     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     03770000
037800     PERFORM 0001-CALL-CICS-ARCH-API.                             03780000
037900                                                                  03790000
038000 0001-CALL-CICS-ARCH-API.                                         03800000
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      03810099
038200                                    DFHCOMMAREA                   03820099
038300                                    DP030-CICS-API-FIELDS         03830099
038400                                    DP020-STANDARD-COMMAREA       03840099
038500                                    PO100AI.                      03850099
038600                                                                  03860000
038700     IF  DP030-RC-CALL-SUCCESSFUL                                 03870000
038800         CONTINUE                                                 03880000
038900     ELSE                                                         03890000
039000         SET DP013-NO-ROLLBACK                                    03900000
039100             DP013-XCTL-DISPLAY-RESTART                           03910000
039200             DP013-CICS-ABEND      TO TRUE                        03920000
039300         MOVE '0001-CALL-CICS-ARCH-API'                           03930099
039400                                   TO DP013-PARAGRAPH             03940000
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O03950099
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      03960099
039700         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      03970000
039800         PERFORM DP013-0000-PROCESS-ABEND                         03980000
039900     END-IF.                                                      03990000
040000 EJECT                                                            04000000
040100*----------------------------------------------------------------*04010000
040200*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *04020000
040300*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *04030000
040400*----------------------------------------------------------------*04040000
040500                                                                  04050000
040600 1000-CONTROL-PROCESSING.                                         04060000
040700                                                                  04070000
040800     EVALUATE TRUE                                                04080000
040900         WHEN DP020-NEXT-ACT-INITIAL                              04090000
041000              PERFORM 1100-FIND-OBJECT-KEYS                       04100000
041100              IF ASC-UPD-IND  OR  ASC-DEL-IND                     04110000
041200                  PERFORM 4000-BUILD-INITIAL-PANEL                04120000
041300                  PERFORM 3200-RESET-ATTRIBUTES                   04130000
041400              ELSE                                                04140000
041500* THIS IS AN ADD BUILD EMPTY SCREEN                               04150000
041600                  CONTINUE                                        04160000
041700              END-IF                                              04170000
041800                                                                  04180000
041900         WHEN DP020-NEXT-ACT-READ-MAP                             04190000
042000             PERFORM 2000-PROCESS-PANEL                           04200000
042100                                                                  04210000
042200         WHEN DP020-NEXT-ACT-RETURN                               04220000
042300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 04230000
042400             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   04240000
042500                                                                  04250000
042600         WHEN OTHER                                               04260000
042700             SET DP013-LOGIC-ABEND TO TRUE                        04270000
042800             SET DP013-NO-ROLLBACK TO TRUE                        04280000
042900             MOVE '1000-CONTROL-PROCESSING'                       04290000
043000                                   TO DP013-PARAGRAPH             04300000
043100             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   04310000
043200                                   TO DP013-MESSAGE-TEXT(1)       04320000
043300             MOVE DP020-NEXT-APPL-ACTIVITY                        04330000
043400                                   TO DP013-MESSAGE-TEXT(2)       04340000
043500             PERFORM DP013-0000-PROCESS-ABEND                     04350000
043600     END-EVALUATE.                                                04360000
043700******************************************************************04370000
043800** DETERMINE THE KEY OF THE OBJECT TO BE UPDATED BASED ON THE   **04380000
043900** INTER-APPLICATION FORMAT CODE.                               **04390000
044000******************************************************************04400000
044100 1100-FIND-OBJECT-KEYS.                                           04410000
044200                                                                  04420000
044300     INITIALIZE ASC-SPECIFIC-COMMAREA.                            04430000
044400     MOVE DP020-INT-APPL-FORMAT-IND TO ASC-INT-APPL-FORMAT-IND.   04440000
044500                                                                  04450000
044600                                                                  04460000
044700     EVALUATE DP020-INT-APPL-FORMAT-IND                           04470000
044800                                                                  04480000
044900         WHEN PC-INTER-APPL-LIST-UPD                              04490000
045000*            UPDATE                                               04500000
045100             SET ASC-UPD-IND   TO TRUE                            04510000
045200             SET ASC-USE-SELECTION-QUEUE TO TRUE                  04520000
045300             MOVE PO078-NUMBER-OF-SELECTED-ITEMS                  04530000
045400                                   TO ASC-NUMBER-OF-SELECTED-ITEMS04540000
045500             MOVE PO078-NUMBER-OF-TS-ITEMS                        04550000
045600                                   TO ASC-NUMBER-OF-TS-ITEMS      04560000
045700             MOVE PO078-SEL-QUEUE-NAME                            04570000
045800                                   TO ASC-SEL-QUEUE-NAME          04580000
045900             PERFORM 1120-PREPARE-LIST-ENTRY                      04590000
046000             MOVE -1               TO ASETTYPL                    04600000
046100             SET DP030-SET-CURSOR-APPL-1                          04610000
046200                                   TO TRUE                        04620000
046300                                                                  04630000
046400         WHEN PC-INTER-APPL-LIST-DEL                              04640000
046500*            DELETE                                               04650000
046600             SET ASC-DEL-IND       TO TRUE                        04660000
046700             SET ASC-USE-SELECTION-QUEUE TO TRUE                  04670000
046800             MOVE PO078-NUMBER-OF-SELECTED-ITEMS                  04680000
046900                                   TO ASC-NUMBER-OF-SELECTED-ITEMS04690000
047000             MOVE PO078-NUMBER-OF-TS-ITEMS                        04700000
047100                                   TO ASC-NUMBER-OF-TS-ITEMS      04710000
047200             MOVE PO078-SEL-QUEUE-NAME                            04720000
047300                                   TO ASC-SEL-QUEUE-NAME          04730000
047400             PERFORM 1120-PREPARE-LIST-ENTRY                      04740000
047500                                                                  04750000
047600         WHEN PC-INTER-APPL-ADD                                   04760000
047700*            ADD                                                  04770000
047800             SET ASC-ADD-IND       TO TRUE                        04780000
047900             MOVE 'N'              TO ASC-FIXTURE-ID-USE          04790000
048000             MOVE -1               TO ASHRTNML                    04800000
048100             SET DP030-SET-CURSOR-APPL-1                          04810000
048200                                   TO TRUE                        04820000
048300                                                                  04830000
048400         WHEN OTHER                                               04840000
048500             MOVE PC-TSYMSG-00148  TO DP020-MSG-NUMBER            04850000
048600             SET DP020-MSG-FATAL                                  04860000
048700                 DP020-NEXT-ACT-APPL-ERROR                        04870000
048800                                   TO TRUE                        04880000
048900     END-EVALUATE.                                                04890000
049000                                                                  04900000
049100*----------------------------------------------------------------*04910000
049200* ENTRY IS FROM A LIST.  GET THE PO SET KEY INFO FROM THE TEMP   *04920000
049300* STORAGE QUEUE PASSED FROM THE LIST.                            *04930000
049400*----------------------------------------------------------------*04940000
049500 1120-PREPARE-LIST-ENTRY.                                         04950000
049600                                                                  04960000
049700     MOVE PO077-MAX-ITEMS          TO ASC-SEL-SUB.                04970000
049800     MOVE ZERO                     TO ASC-SEL-ITEM.               04980000
049900     PERFORM 2110-GET-NEXT-SET.                                   04990000
050000                                                                  05000000
050100*----------------------------------------------------------------*05010000
050200* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *05020000
050300* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *05030000
050400* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *05040000
050500* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *05050000
050600* FUNCTION KEYS CAN GET THIS FAR.                                *05060000
050700*----------------------------------------------------------------*05070000
050800                                                                  05080000
050900 2000-PROCESS-PANEL.                                              05090000
051000                                                                  05100000
051100         IF ASC-CONFIRM-DEL  OR  ASC-CONFIRM-DESC                 05110000
051200             IF DP020-FK-CONFIRM(DP020-SRC-AID)                   05120000
051300                 CONTINUE                                         05130000
051400             ELSE                                                 05140000
051500                 IF ASC-CONFIRM-DESC                              05150000
051600*                    USER DID NOT CONFIRM CHANGE                  05160000
051700*                    REPLACE SCREEN DESC WITH TABLE DESC          05170000
051800                     MOVE ASC-HOLD-TYP-DESC    TO ASC-TYP-DESC    05180000
051900                 END-IF                                           05190000
052000                 SET ASC-NOT-CONFIRM TO TRUE                      05200000
052100             END-IF                                               05210000
052200         END-IF.                                                  05220000
052300                                                                  05230000
052400                                                                  05240000
052500     EVALUATE TRUE                                                05250000
052600                                                                  05260000
052700         WHEN DP020-SRC-AID = DP016-CLEAR                         05270000
052800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 05280000
052900             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   05290000
053000                                                                  05300000
053100         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     05310000
053200             INITIALIZE ASC-SCREEN-FIELDS                         05320000
053300             IF ASC-ADD-IND                                       05330000
053400                 INITIALIZE ASC-KEY-FIELDS                        05340000
053500                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             05350000
053600                 MOVE -1                TO ASHRTNML               05360000
053700                 SET DP030-SET-CURSOR-APPL-1                      05370000
053800                                        TO TRUE                   05380000
053900             ELSE                                                 05390000
054000                 MOVE ASC-KEY-SHORT-NME TO DK-SHORT-NME           05400000
054100                 MOVE ASC-KEY-YEAR      TO DK-YEAR                05410000
054200                 PERFORM 4000-BUILD-INITIAL-PANEL                 05420000
054300                 PERFORM 3200-RESET-ATTRIBUTES                    05430000
054400                 IF ASC-UPD-IND                                   05440000
054500                     MOVE -1           TO ASETTYPL                05450000
054600                     SET DP030-SET-CURSOR-APPL-1                  05460000
054700                                       TO TRUE                    05470000
054800                 END-IF                                           05480000
054900             END-IF                                               05490000
055000                                                                  05500000
055100         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             05510000
055200             IF ASC-USE-SELECTION-QUEUE                           05520000
055300                 PERFORM 2110-GET-NEXT-SET                        05530000
055400                 IF PS-LIST-END                                   05540000
055500                     SET PS-LIST-NOT-END  TO TRUE                 05550000
055600                 ELSE                                             05560000
055700                     PERFORM 4000-BUILD-INITIAL-PANEL             05570000
055800                     PERFORM 3200-RESET-ATTRIBUTES                05580000
055900                     IF ASC-UPD-IND                               05590000
056000                         MOVE -1       TO ASETTYPL                05600000
056100                         SET DP030-SET-CURSOR-APPL-1              05610000
056200                                       TO TRUE                    05620000
056300                     END-IF                                       05630000
056400                 END-IF                                           05640000
056500             ELSE                                                 05650000
056600*            --- BOTTOM OF LIST ---                               05660000
056700                 MOVE PC-TSYMSG-00070                             05670000
056800                              TO DP020-MSG-NUMBER                 05680000
056900                 SET DP020-MSG-INFORMATIONAL                      05690000
057000                     PS-LIST-END  TO TRUE                         05700000
057100             END-IF                                               05710000
057200                                                                  05720000
057300         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             05730000
057400             IF ASC-USE-SELECTION-QUEUE                           05740000
057500                 PERFORM 2120-GET-PREV-SET                        05750000
057600                 IF PS-LIST-END                                   05760000
057700                     SET PS-LIST-NOT-END  TO TRUE                 05770000
057800                 ELSE                                             05780000
057900                     PERFORM 4000-BUILD-INITIAL-PANEL             05790000
058000                     PERFORM 3200-RESET-ATTRIBUTES                05800000
058100                     IF ASC-UPD-IND                               05810000
058200                         MOVE -1       TO ASETTYPL                05820000
058300                         SET DP030-SET-CURSOR-APPL-1              05830000
058400                                       TO TRUE                    05840000
058500                     END-IF                                       05850000
058600                 END-IF                                           05860000
058700             ELSE                                                 05870000
058800*                --- TOP OF LIST ---                              05880000
058900                 MOVE PC-TSYMSG-00069                             05890000
059000                                   TO DP020-MSG-NUMBER            05900000
059100                 SET DP020-MSG-INFORMATIONAL                      05910000
059200                     PS-LIST-END   TO TRUE                        05920000
059300             END-IF                                               05930000
059400                                                                  05940000
059500         WHEN DP020-SRC-AID = DP016-PF16                          05950099
059600*        DELETE (REQUIRES CONFIRMATION)                           05960000
059700*            PERFORM 3015-EDIT-DEL-FIELDS                         05970099
059800             IF PS-NO-ERROR                                       05980000
059900                PERFORM 7200-VERIFY-SET-TO-DELETE                 05990000
060000             END-IF                                               06000000
060100         WHEN DP020-FK-CONFIRM(DP020-SRC-AID)                     06010000
060200*        CONFIRM DELETE                                           06020000
060300             IF ASC-CONFIRM-DEL                                   06030000
060400                 SET ASC-NOT-CONFIRM   TO TRUE                    06040000
060500                 PERFORM 7000-DELETE-PO-SET                       06050000
060600                 SET PO078-W099-REFRESH TO TRUE                   06060000
060700                 IF ASC-USE-SELECTION-QUEUE                       06070000
060800                     PERFORM 5250-DELETE-SELECTION-QUEUE          06080000
060900                 END-IF                                           06090000
061000                 INITIALIZE ASC-KEY-FIELDS                        06100000
061100                 INITIALIZE ASC-SCREEN-FIELDS                     06110000
061200                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             06120000
061300             ELSE                                                 06130000
061400*        CONFIRM TYPE CODE DESCRIPTION CHANGE                     06140000
061500                 IF ASC-CONFIRM-DESC                              06150000
061600                     SET ASC-NOT-CONFIRM   TO TRUE                06160000
061700                     PERFORM 8100-UPDATE-PO-SET-DESC              06170000
061800                 ELSE                                             06180000
061900                     SET PS-ERROR         TO TRUE                 06190000
062000                     SET DP020-MSG-FATAL  TO TRUE                 06200000
062100                     MOVE PC-TSYMSG-00045 TO DP020-MSG-NUMBER     06210000
062200                 END-IF                                           06220000
062300             END-IF                                               06230000
062400                                                                  06240000
062500         WHEN OTHER                                               06250000
062600             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 06260000
062700             IF PS-NO-ERROR                                       06270000
062800                 PERFORM 3000-EDIT-DATA-IN-COMMAREA               06280000
062900                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             06290000
063000                 IF PS-NO-ERROR                                   06300000
063100                     SET DP030-CONTINUE-GO                        06310000
063200                                       TO TRUE                    06320000
063300                     PERFORM 2100-CHECK-FUNCTION-KEY              06330000
063400                 ELSE                                             06340000
063500                     SET DP030-OVERRIDE-GO                        06350000
063600                                       TO TRUE                    06360000
063700                 END-IF                                           06370000
063800             ELSE                                                 06380000
063900                 SET DP030-OVERRIDE-GO TO TRUE                    06390000
064000             END-IF                                               06400000
064100                                                                  06410000
064200     END-EVALUATE.                                                06420000
064300                                                                  06430000
064400*----------------------------------------------------------------*06440000
064500* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED       *06450000
064600* FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED   *06460000
064700* FROM THE CICS ARCHITECTURE API.                                *06470000
064800*----------------------------------------------------------------*06480000
064900                                                                  06490000
065000 2100-CHECK-FUNCTION-KEY.                                         06500000
065100                                                                  06510000
065200     EVALUATE TRUE                                                06520000
065300         WHEN DP020-SRC-AID = DP016-ENTER                         06530000
065400             CONTINUE                                             06540000
065500                                                                  06550000
065600         WHEN DP020-SRC-AID = DP016-PF13                          06560000
065700*        ADD                                                      06570000
065701*** INC1287544 START                                              06570199
065730             PERFORM 2130-VALIDATE-SET-YEAR                       06573099
065740*** INC1287544 END                                                06574099
065800             IF PS-NO-ERROR                                       06580000
065900                 IF ASC-ADD-IND                                   06590000
066000                     PERFORM 6000-ADD-PO-SET                      06600000
066100                     IF PS-NO-ERROR                               06610000
066200                         IF ASC-TYP-CDE > SPACES                  06620000
066300                             PERFORM 8000-PROCESS-TYPE-DESC       06630000
066400                         END-IF                                   06640000
066500                     SET PO078-W099-REFRESH TO TRUE               06650000
066600                     END-IF                                       06660000
066700                 ELSE                                             06670000
066800                     SET PS-ERROR         TO TRUE                 06680000
066900                     SET DP020-MSG-FATAL  TO TRUE                 06690000
067000                     MOVE PC-TSYMSG-00150 TO DP020-MSG-NUMBER     06700000
067100                 END-IF                                           06710000
067200             END-IF                                               06720000
067300                                                                  06730000
067400         WHEN DP020-SRC-AID = DP016-PF15                          06740000
067500*        UPDATE                                                   06750000
067600             IF PS-NO-ERROR                                       06760000
067700                 PERFORM 5000-CHANGE-PO-SET                       06770000
067800                 IF PS-NO-ERROR                                   06780000
067900                     IF ASC-TYP-CDE > SPACES                      06790000
068000                         PERFORM 8000-PROCESS-TYPE-DESC           06800000
068100                     END-IF                                       06810000
068200                     IF ASC-USE-SELECTION-QUEUE                   06820000
068300                         PERFORM 5200-UPDATE-SELECTION-QUEUE      06830000
068400                     END-IF                                       06840000
068500                 END-IF                                           06850000
068600             END-IF                                               06860000
068700                                                                  06870000
068800                                                                  06880000
068900         WHEN OTHER                                               06890000
069000             SET DP013-NO-ROLLBACK                                06900000
069100                 DP013-XCTL-DISPLAY-RESTART                       06910000
069200                 DP013-CICS-ABEND  TO TRUE                        06920000
069300             MOVE '2000-PROCESS-PANEL'                            06930000
069400                                   TO DP013-PARAGRAPH             06940000
069500             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      06950000
069600                                   TO DP013-MESSAGE-TEXT (1)      06960000
069700             PERFORM DP013-0000-PROCESS-ABEND                     06970000
069800                                                                  06980000
069900     END-EVALUATE.                                                06990000
070000                                                                  07000000
070100*                                                                 07010000
070200***************************************************************** 07020000
070300*                                                                 07030000
070400 2110-GET-NEXT-SET.                                               07040000
070500                                                                  07050000
070600     ADD +1                        TO ASC-SEL-SUB.                07060000
070700     IF  ASC-SEL-SUB > PO077-MAX-ITEMS                            07070000
070800         ADD +1                    TO ASC-SEL-ITEM                07080000
070900         MOVE +1                   TO ASC-SEL-SUB                 07090000
071000     END-IF.                                                      07100000
071100     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                07110000
071200         PERFORM 9100-READ-SEL-QUEUE                              07120000
071300         IF  PO077-ITEM (ASC-SEL-SUB) > ZERO                      07130000
071400             MOVE PO077-SHORT-NME(ASC-SEL-SUB)                    07140000
071500                                   TO ASC-KEY-SHORT-NME           07150000
071600                                      DK-SHORT-NME                07160000
071700             MOVE PO077-YEAR(ASC-SEL-SUB)                         07170000
071800                                   TO ASC-KEY-YEAR                07180000
071900                                      DK-YEAR                     07190000
072000             SET PO077-INQ (ASC-SEL-SUB)                          07200000
072100                                   TO TRUE                        07210000
072200             PERFORM 9200-REWRITE-LIST-QUEUE                      07220000
072300         ELSE                                                     07230000
072400             SUBTRACT +1 FROM ASC-SEL-SUB                         07240000
072500*            --- BOTTOM OF LIST ---                               07250000
072600             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            07260000
072700             SET DP020-MSG-INFORMATIONAL                          07270000
072800                                   TO TRUE                        07280000
072900         SET PS-LIST-END           TO TRUE                        07290000
073000         END-IF                                                   07300000
073100     ELSE                                                         07310000
073200         SUBTRACT +1 FROM ASC-SEL-ITEM                            07320000
073300         MOVE PO077-MAX-ITEMS      TO ASC-SEL-SUB                 07330000
073400         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            07340000
073500         SET DP020-MSG-INFORMATIONAL                              07350000
073600                                   TO TRUE                        07360000
073700         SET PS-LIST-END           TO TRUE                        07370000
073800     END-IF.                                                      07380000
073900******************************************************************07390000
074000** GET THE (KEY) OF THE PREVIOUS SELECTED                       **07400000
074100** OBJECT FROM THE SELECTED-ITEMS TEMP. STORAGE QUEUE.          **07410000
074200******************************************************************07420000
074300 2120-GET-PREV-SET.                                               07430000
074400                                                                  07440000
074500     SUBTRACT +1 FROM ASC-SEL-SUB.                                07450000
074600     IF  ASC-SEL-SUB < +1                                         07460000
074700         SUBTRACT +1 FROM ASC-SEL-ITEM                            07470000
074800         MOVE PO077-MAX-ITEMS      TO ASC-SEL-SUB                 07480000
074900     END-IF.                                                      07490000
075000*                                                                 07500000
075100     IF  ASC-SEL-ITEM > ZERO                                      07510000
075200         PERFORM 9100-READ-SEL-QUEUE                              07520000
075300             MOVE PO077-SHORT-NME(ASC-SEL-SUB)                    07530000
075400                                   TO ASC-KEY-SHORT-NME           07540000
075500                                      DK-SHORT-NME                07550000
075600             MOVE PO077-YEAR(ASC-SEL-SUB)                         07560000
075700                                   TO ASC-KEY-YEAR                07570000
075800                                      DK-YEAR                     07580000
075900     ELSE                                                         07590000
076000         MOVE +1                   TO ASC-SEL-ITEM                07600000
076100                                      ASC-SEL-SUB                 07610000
076200*        --- TOP OF LIST ---                                      07620000
076300         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            07630000
076400         SET DP020-MSG-INFORMATIONAL                              07640000
076500                                   TO TRUE                        07650000
076600         SET PS-LIST-END           TO TRUE                        07660000
076700     END-IF.                                                      07670000
076710*                                                                 07671099
076711*** INC1287544 START                                              07671199
076712******************************************************************07671299
076713* VALIDATES THE SET YEAR                                          07671399
076714******************************************************************07671499
076720 2130-VALIDATE-SET-YEAR.                                          07672099
076732                                                                  07673299
076733         EXEC SQL                                                 07673399
076734             SET :PV-CURR-YEAR = YEAR(CURRENT DATE)               07673499
076735         END-EXEC.                                                07673599
076736                                                                  07673699
076737     IF ASC-KEY-YEAR < PV-CURR-YEAR                               07673799
076738*      ---ERROR - SET CODE YEAR CANNOT BE FOR A PRIOR YEAR---     07673899
076739         SET PS-ERROR              TO TRUE                        07673999
076740         SET DP020-MSG-FATAL       TO TRUE                        07674099
076741         MOVE PC-TSYMSG-03760      TO DP020-MSG-NUMBER            07674199
076742         MOVE DP015-UNP-ALP-BRT-OFF                               07674299
076743                                   TO AYEARA                      07674399
076744         MOVE DP015-RED            TO AYEARC                      07674499
076745         MOVE DP015-REVERSE        TO AYEARH                      07674599
076746         MOVE -1                   TO AYEARL                      07674699
076747         SET DP030-SET-CURSOR-APPL-1                              07674799
076748                                   TO TRUE                        07674899
076749     END-IF.                                                      07674999
076750                                                                  07675099
076751*** INC1287544 END                                                07675199
076760                                                                  07676099
076800 EJECT                                                            07680000
076900*----------------------------------------------------------------*07690000
077000* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS   *07700000
077100* IN THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN   *07710000
077200* THE APPLICATION-SPECIFIC COMMAERA, NOT ON THE SCREEN.          *07720000
077300*----------------------------------------------------------------*07730000
077400                                                                  07740000
077500 2200-MOVE-SCREEN-TO-COMMAREA.                                    07750000
077600                                                                  07760000
077700     IF ASC-ADD-IND                                               07770000
077800         IF ASHRTNML > ZERO                                       07780000
077900             MOVE ASHRTNMI             TO ASC-KEY-SHORT-NME       07790000
078000         ELSE                                                     07800000
078100             IF ASHRTNMF = DP015-ERASE-EOF                        07810000
078200                 MOVE SPACES           TO ASC-KEY-SHORT-NME       07820000
078300             END-IF                                               07830000
078400         END-IF                                                   07840000
078500                                                                  07850000
078600         IF AYEARL > ZERO                                         07860000
078700             MOVE AYEARI               TO ASC-KEY-YEAR            07870000
078800         ELSE                                                     07880000
078900             IF AYEARF = DP015-ERASE-EOF                          07890000
079000                 MOVE SPACES           TO ASC-KEY-YEAR            07900000
079100             END-IF                                               07910000
079200         END-IF                                                   07920000
079300                                                                  07930000
079400         IF ALONGNML > ZERO                                       07940000
079500             MOVE ALONGNMI             TO ASC-LONG-NME            07950000
079600         ELSE                                                     07960000
079700             IF ALONGNMF = DP015-ERASE-EOF                        07970000
079800                 MOVE SPACES           TO ASC-LONG-NME            07980000
079900             END-IF                                               07990000
080000         END-IF                                                   08000000
080100     END-IF.                                                      08010000
080200                                                                  08020000
080300     IF  ASETTYPL > ZERO                                          08030000
080400         MOVE ASETTYPI             TO ASC-TYP-CDE                 08040000
080500     ELSE                                                         08050000
080600         IF ASETTYPF  = DP015-ERASE-EOF                           08060000
080700             MOVE SPACE            TO ASC-TYP-CDE                 08070000
080800         END-IF                                                   08080000
080900     END-IF.                                                      08090000
081000                                                                  08100000
081100     IF  ATYPDSCL > ZERO                                          08110000
081200         MOVE ATYPDSCI             TO ASC-TYP-DESC                08120000
081300     ELSE                                                         08130000
081400         IF ATYPDSCF  = DP015-ERASE-EOF                           08140000
081500             MOVE SPACE            TO ASC-TYP-DESC                08150000
081600         END-IF                                                   08160000
081700     END-IF.                                                      08170000
081800                                                                  08180000
081900     IF  ASBEGDTL > ZERO                                          08190000
082000         MOVE ASBEGDTI             TO ASC-STUP-BEG-DTE            08200000
082100     ELSE                                                         08210000
082200         IF ASBEGDTF  = DP015-ERASE-EOF                           08220000
082300             MOVE SPACE            TO ASC-STUP-BEG-DTE            08230000
082400         END-IF                                                   08240000
082500     END-IF.                                                      08250000
082600                                                                  08260000
082700     IF  ASENDDTL > ZERO                                          08270000
082800         MOVE ASENDDTI             TO ASC-STUP-END-DTE            08280000
082900     ELSE                                                         08290000
083000         IF ASENDDTF  = DP015-ERASE-EOF                           08300000
083100             MOVE SPACE            TO ASC-STUP-END-DTE            08310000
083200         END-IF                                                   08320000
083300     END-IF.                                                      08330000
083400                                                                  08340000
083500     IF  ARBEGDTL > ZERO                                          08350000
083600         MOVE ARBEGDTI             TO ASC-RLSE-BEG-DTE            08360000
083700     ELSE                                                         08370000
083800         IF ARBEGDTF  = DP015-ERASE-EOF                           08380000
083900             MOVE SPACE            TO ASC-RLSE-BEG-DTE            08390000
084000         END-IF                                                   08400000
084100     END-IF.                                                      08410000
084200                                                                  08420000
084300     IF  ARENDDTL > ZERO                                          08430000
084400         MOVE ARENDDTI             TO ASC-RLSE-END-DTE            08440000
084500     ELSE                                                         08450000
084600         IF ARENDDTF  = DP015-ERASE-EOF                           08460000
084700             MOVE SPACE            TO ASC-RLSE-END-DTE            08470000
084800         END-IF                                                   08480000
084900     END-IF.                                                      08490000
087500                                                                  08750000
087600     IF  ARPTINDL > ZERO                                          08760000
087700         MOVE ARPTINDI             TO ASC-PO-RCPT-RPTG-IND        08770000
087800     ELSE                                                         08780000
087900         IF ARPTINDF  = DP015-ERASE-EOF                           08790000
088000             MOVE SPACE            TO ASC-PO-RCPT-RPTG-IND        08800000
088100         END-IF                                                   08810000
088200     END-IF.                                                      08820000
088300                                                                  08830000
088400 EJECT                                                            08840000
088500                                                                  08850000
088600*----------------------------------------------------------------*08860000
088700* PERFORM EDITS ON EACH FIELD ENTERED BY THE USER.  IF AN ERROR  *08870000
088800* IS FOUND, THE CURSOR IS POSITIONED AT THAT FIELD AND AN        *08880000
088900* APPROPRIATE ERROR MESSAGE IS DISPLAYED.                        *08890000
089000*----------------------------------------------------------------*08900000
089100                                                                  08910000
089200 3000-EDIT-DATA-IN-COMMAREA.                                      08920000
089300                                                                  08930000
089400     PERFORM 3200-RESET-ATTRIBUTES.                               08940000
089500                                                                  08950000
089600     IF ASC-RLSE-END-DTE > SPACES                                 08960000
089700         INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56           08970000
089800         SET DPG51-FISCAL-JAN-DEC-F2                              08980000
089900             DPG51-DO-NOT-INCR-DECR-DATE                          08990000
090000                                        TO TRUE                   09000000
090100         MOVE ZEROES                    TO TALLY                  09010000
090200         INSPECT ASC-RLSE-END-DTE                                 09020000
090300                 TALLYING TALLY FOR ALL '/'                       09030000
090400         IF TALLY > 1                                             09040000
090500*                'MM/DD/YY'                                       09050000
090600             SET DPG52-LK-DTE-GREG-CC-FMT                         09060000
090700                                       TO TRUE                    09070000
090800             IF ASC-RLSE-END-DTE(7:2) > 80                        09080000
090900                 MOVE '19'              TO PV-RLSE-END-DTE(7:2)   09090000
091000             ELSE                                                 09100000
091100                 MOVE '20'              TO PV-RLSE-END-DTE(7:2)   09110000
091200             END-IF                                               09120000
091300             MOVE ASC-RLSE-END-DTE(1:6) TO PV-RLSE-END-DTE(1:6)   09130000
091400             MOVE ASC-RLSE-END-DTE(7:2) TO PV-RLSE-END-DTE(9:2)   09140000
091500         ELSE                                                     09150000
091600             IF ASC-RLSE-END-DTE(7:2) <= SPACES                   09160000
091700*               'MMDDYY  '                                        09170000
091800                 SET DPG52-LK-DTE-GREG-CC                         09180000
091900                                        TO TRUE                   09190000
092000                 IF ASC-RLSE-END-DTE(5:2) > 80                    09200000
092100                     MOVE '19'          TO PV-RLSE-END-DTE(5:2)   09210000
092200                 ELSE                                             09220000
092300                     MOVE '20'          TO PV-RLSE-END-DTE(5:2)   09230000
092400                 END-IF                                           09240000
092500                 MOVE ASC-RLSE-END-DTE(1:2)                       09250000
092600                                        TO PV-RLSE-END-DTE(1:2)   09260000
092700                 MOVE ASC-RLSE-END-DTE(3:2)                       09270000
092800                                        TO PV-RLSE-END-DTE(3:2)   09280000
092900                 MOVE ASC-RLSE-END-DTE(5:2)                       09290000
093000                                        TO PV-RLSE-END-DTE(7:2)   09300000
093100                 MOVE SPACES            TO PV-RLSE-END-DTE(9:2)   09310000
093200             ELSE                                                 09320000
093300*                'MMDDCCYY'                                       09330000
093400                 SET DPG52-LK-DTE-GREG-CC                         09340000
093500                                        TO TRUE                   09350000
093600                 MOVE ASC-RLSE-END-DTE(1:8)                       09360000
093700                                        TO PV-RLSE-END-DTE(1:8)   09370000
093800                 MOVE SPACES            TO PV-RLSE-END-DTE(9:2)   09380000
093900             END-IF                                               09390000
094000         END-IF                                                   09400000
094100         MOVE PV-RLSE-END-DTE           TO DPG52-LK-DATE-INPUT    09410000
094200         CALL DP500-KOHLS-CALENDAR-ROUTINE USING                  09420000
094300              DPG51 DPG52 DPG53 DPG54 DPG55 DPG56                 09430000
094400         IF (DPG54-WARNING-ERROR                                  09440000
094500         OR  DPG54-SEVERE-ERROR)                                  09450000
094600*        ---- INVALID DATE ----                                   09460000
094700             SET PS-ERROR               TO TRUE                   09470000
094800             SET DP020-MSG-FATAL        TO TRUE                   09480000
094900             MOVE PC-TSYMSG-00009       TO DP020-MSG-NUMBER       09490000
095000             MOVE DP015-UNP-ALP-BRT-OFF TO ARENDDTA               09500000
095100             MOVE DP015-RED             TO ARENDDTC               09510000
095200             MOVE DP015-REVERSE         TO ARENDDTH               09520000
095300             MOVE -1                    TO ARENDDTL               09530000
095400             SET DP030-SET-CURSOR-APPL-1                          09540000
095500                                        TO TRUE                   09550000
095600         ELSE                                                     09560000
095700             MOVE DPG55-GREG-DATE-FMT   TO ASC-RLSE-END-DTE       09570000
095800             MOVE DPG55-DB2-ISO-DATE-FMT                          09580000
095900                                        TO ASC-RLSE-END-DTE-ISO   09590000
096000         END-IF                                                   09600000
096010*** INC1295768 START                                              09601099
096018         EXEC SQL                                                 09601899
096019             SET :PV-CURR-DATE = DATE(CURRENT TIMESTAMP)          09601999
096020         END-EXEC                                                 09602099
096021                                                                  09602199
096022         IF PV-CURR-DATE > ASC-RLSE-END-DTE-ISO                   09602299
096023             SET PS-STR-RELS-DTE-CRSD   TO TRUE                   09602399
096024         END-IF                                                   09602499
096025                                                                  09602599
096030*** INC1295768 END                                                09603099
096100     END-IF.                                                      09610000
096200                                                                  09620000
096300     IF ASC-RLSE-BEG-DTE > SPACES                                 09630000
096400         INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56           09640000
096500         SET DPG51-FISCAL-JAN-DEC-F2                              09650000
096600             DPG51-DO-NOT-INCR-DECR-DATE                          09660000
096700                                        TO TRUE                   09670000
096800         MOVE ZEROES                    TO TALLY                  09680000
096900         INSPECT ASC-RLSE-BEG-DTE                                 09690000
097000                 TALLYING TALLY FOR ALL '/'                       09700000
097100         IF TALLY > 1                                             09710000
097200*                'MM/DD/YY'                                       09720000
097300             SET DPG52-LK-DTE-GREG-CC-FMT                         09730000
097400                                       TO TRUE                    09740000
097500             IF ASC-RLSE-BEG-DTE(7:2) > 80                        09750000
097600                 MOVE '19'              TO PV-RLSE-BEG-DTE(7:2)   09760000
097700             ELSE                                                 09770000
097800                 MOVE '20'              TO PV-RLSE-BEG-DTE(7:2)   09780000
097900             END-IF                                               09790000
098000             MOVE ASC-RLSE-BEG-DTE(1:6) TO PV-RLSE-BEG-DTE(1:6)   09800000
098100             MOVE ASC-RLSE-BEG-DTE(7:2) TO PV-RLSE-BEG-DTE(9:2)   09810000
098200         ELSE                                                     09820000
098300             IF ASC-RLSE-BEG-DTE(7:2) <= SPACES                   09830000
098400*               'MMDDYY  '                                        09840000
098500                 SET DPG52-LK-DTE-GREG-CC                         09850000
098600                                        TO TRUE                   09860000
098700                 IF ASC-RLSE-BEG-DTE(5:2) > 80                    09870000
098800                     MOVE '19'          TO PV-RLSE-BEG-DTE(5:2)   09880000
098900                 ELSE                                             09890000
099000                     MOVE '20'          TO PV-RLSE-BEG-DTE(5:2)   09900000
099100                 END-IF                                           09910000
099200                 MOVE ASC-RLSE-BEG-DTE(1:2)                       09920000
099300                                        TO PV-RLSE-BEG-DTE(1:2)   09930000
099400                 MOVE ASC-RLSE-BEG-DTE(3:2)                       09940000
099500                                        TO PV-RLSE-BEG-DTE(3:2)   09950000
099600                 MOVE ASC-RLSE-BEG-DTE(5:2)                       09960000
099700                                        TO PV-RLSE-BEG-DTE(7:2)   09970000
099800                 MOVE SPACES            TO PV-RLSE-BEG-DTE(9:2)   09980000
099900             ELSE                                                 09990000
100000*                'MMDDCCYY'                                       10000000
100100                 SET DPG52-LK-DTE-GREG-CC                         10010000
100200                                        TO TRUE                   10020000
100300                 MOVE ASC-RLSE-BEG-DTE(1:8)                       10030000
100400                                        TO PV-RLSE-BEG-DTE(1:8)   10040000
100500                 MOVE SPACES            TO PV-RLSE-BEG-DTE(9:2)   10050000
100600             END-IF                                               10060000
100700         END-IF                                                   10070000
100800         MOVE PV-RLSE-BEG-DTE           TO DPG52-LK-DATE-INPUT    10080000
100900         CALL DP500-KOHLS-CALENDAR-ROUTINE USING                  10090000
101000              DPG51 DPG52 DPG53 DPG54 DPG55 DPG56                 10100000
101100         IF (DPG54-WARNING-ERROR                                  10110000
101200         OR  DPG54-SEVERE-ERROR)                                  10120000
101300*        ---- INVALID DATE ----                                   10130000
101400             SET PS-ERROR               TO TRUE                   10140000
101500             SET DP020-MSG-FATAL        TO TRUE                   10150000
101600             MOVE PC-TSYMSG-00009       TO DP020-MSG-NUMBER       10160000
101700             MOVE DP015-UNP-ALP-BRT-OFF TO ARBEGDTA               10170000
101800             MOVE DP015-RED             TO ARBEGDTC               10180000
101900             MOVE DP015-REVERSE         TO ARBEGDTH               10190000
102000             MOVE -1                    TO ARBEGDTL               10200000
102100             SET DP030-SET-CURSOR-APPL-1                          10210000
102200                                        TO TRUE                   10220000
102300         ELSE                                                     10230000
102400             MOVE DPG55-GREG-DATE-FMT   TO ASC-RLSE-BEG-DTE       10240000
102500             MOVE DPG55-DB2-ISO-DATE-FMT                          10250000
102600                                        TO ASC-RLSE-BEG-DTE-ISO   10260000
102700         END-IF                                                   10270000
102800     END-IF.                                                      10280000
102900                                                                  10290000
103000     IF ASC-STUP-END-DTE > SPACES                                 10300000
103100         INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56           10310000
103200         SET DPG51-FISCAL-JAN-DEC-F2                              10320000
103300             DPG51-DO-NOT-INCR-DECR-DATE                          10330000
103400                                        TO TRUE                   10340000
103500         MOVE ZEROES                    TO TALLY                  10350000
103600         INSPECT ASC-STUP-END-DTE                                 10360000
103700                 TALLYING TALLY FOR ALL '/'                       10370000
103800         IF TALLY > 1                                             10380000
103900*                'MM/DD/YY'                                       10390000
104000             SET DPG52-LK-DTE-GREG-CC-FMT                         10400000
104100                                       TO TRUE                    10410000
104200             IF ASC-STUP-END-DTE(7:2) > 80                        10420000
104300                 MOVE '19'              TO PV-STUP-END-DTE(7:2)   10430000
104400             ELSE                                                 10440000
104500                 MOVE '20'              TO PV-STUP-END-DTE(7:2)   10450000
104600             END-IF                                               10460000
104700             MOVE ASC-STUP-END-DTE(1:6) TO PV-STUP-END-DTE(1:6)   10470000
104800             MOVE ASC-STUP-END-DTE(7:2) TO PV-STUP-END-DTE(9:2)   10480000
104900         ELSE                                                     10490000
105000             IF ASC-STUP-END-DTE(7:2) <= SPACES                   10500000
105100*               'MMDDYY  '                                        10510000
105200                 SET DPG52-LK-DTE-GREG-CC                         10520000
105300                                        TO TRUE                   10530000
105400                 IF ASC-STUP-END-DTE(5:2) > 80                    10540000
105500                     MOVE '19'          TO PV-STUP-END-DTE(5:2)   10550000
105600                 ELSE                                             10560000
105700                     MOVE '20'          TO PV-STUP-END-DTE(5:2)   10570000
105800                 END-IF                                           10580000
105900                 MOVE ASC-STUP-END-DTE(1:2)                       10590000
106000                                        TO PV-STUP-END-DTE(1:2)   10600000
106100                 MOVE ASC-STUP-END-DTE(3:2)                       10610000
106200                                        TO PV-STUP-END-DTE(3:2)   10620000
106300                 MOVE ASC-STUP-END-DTE(5:2)                       10630000
106400                                        TO PV-STUP-END-DTE(7:2)   10640000
106500                 MOVE SPACES            TO PV-STUP-END-DTE(9:2)   10650000
106600             ELSE                                                 10660000
106700*                'MMDDCCYY'                                       10670000
106800                 SET DPG52-LK-DTE-GREG-CC                         10680000
106900                                        TO TRUE                   10690000
107000                 MOVE ASC-STUP-END-DTE(1:8)                       10700000
107100                                        TO PV-STUP-END-DTE(1:8)   10710000
107200                 MOVE SPACES            TO PV-STUP-END-DTE(9:2)   10720000
107300             END-IF                                               10730000
107400         END-IF                                                   10740000
107500         MOVE PV-STUP-END-DTE           TO DPG52-LK-DATE-INPUT    10750000
107600         CALL DP500-KOHLS-CALENDAR-ROUTINE USING                  10760000
107700              DPG51 DPG52 DPG53 DPG54 DPG55 DPG56                 10770000
107800         IF (DPG54-WARNING-ERROR                                  10780000
107900         OR  DPG54-SEVERE-ERROR)                                  10790000
108000*        ---- INVALID DATE ----                                   10800000
108100             SET PS-ERROR               TO TRUE                   10810000
108200             SET DP020-MSG-FATAL        TO TRUE                   10820000
108300             MOVE PC-TSYMSG-00009       TO DP020-MSG-NUMBER       10830000
108400             MOVE DP015-UNP-ALP-BRT-OFF TO ASENDDTA               10840000
108500             MOVE DP015-RED             TO ASENDDTC               10850000
108600             MOVE DP015-REVERSE         TO ASENDDTH               10860000
108700             MOVE -1                    TO ASENDDTL               10870000
108800             SET DP030-SET-CURSOR-APPL-1                          10880000
108900                                        TO TRUE                   10890000
109000         ELSE                                                     10900000
109100             MOVE DPG55-GREG-DATE-FMT   TO ASC-STUP-END-DTE       10910000
109200             MOVE DPG55-DB2-ISO-DATE-FMT                          10920000
109300                                        TO ASC-STUP-END-DTE-ISO   10930000
109400         END-IF                                                   10940000
109500     END-IF.                                                      10950000
109600                                                                  10960000
109700                                                                  10970000
109800     IF ASC-STUP-BEG-DTE > SPACES                                 10980000
109900         INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56           10990000
110000         SET DPG51-FISCAL-JAN-DEC-F2                              11000000
110100             DPG51-DO-NOT-INCR-DECR-DATE                          11010000
110200                                        TO TRUE                   11020000
110300         MOVE ZEROES                    TO TALLY                  11030000
110400         INSPECT ASC-STUP-BEG-DTE                                 11040000
110500                 TALLYING TALLY FOR ALL '/'                       11050000
110600         IF TALLY > 1                                             11060000
110700*                'MM/DD/YY'                                       11070000
110800             SET DPG52-LK-DTE-GREG-CC-FMT                         11080000
110900                                       TO TRUE                    11090000
111000             IF ASC-STUP-BEG-DTE(7:2) > 80                        11100000
111100                 MOVE '19'              TO PV-STUP-BEG-DTE(7:2)   11110000
111200             ELSE                                                 11120000
111300                 MOVE '20'              TO PV-STUP-BEG-DTE(7:2)   11130000
111400             END-IF                                               11140000
111500             MOVE ASC-STUP-BEG-DTE(1:6) TO PV-STUP-BEG-DTE(1:6)   11150000
111600             MOVE ASC-STUP-BEG-DTE(7:2) TO PV-STUP-BEG-DTE(9:2)   11160000
111700         ELSE                                                     11170000
111800             IF ASC-STUP-BEG-DTE(7:2) <= SPACES                   11180000
111900*               'MMDDYY  '                                        11190000
112000                 SET DPG52-LK-DTE-GREG-CC                         11200000
112100                                        TO TRUE                   11210000
112200                 IF ASC-STUP-BEG-DTE(5:2) > 80                    11220000
112300                     MOVE '19'          TO PV-STUP-BEG-DTE(5:2)   11230000
112400                 ELSE                                             11240000
112500                     MOVE '20'          TO PV-STUP-BEG-DTE(5:2)   11250000
112600                 END-IF                                           11260000
112700                 MOVE ASC-STUP-BEG-DTE(1:2)                       11270000
112800                                        TO PV-STUP-BEG-DTE(1:2)   11280000
112900                 MOVE ASC-STUP-BEG-DTE(3:2)                       11290000
113000                                        TO PV-STUP-BEG-DTE(3:2)   11300000
113100                 MOVE ASC-STUP-BEG-DTE(5:2)                       11310000
113200                                        TO PV-STUP-BEG-DTE(7:2)   11320000
113300                 MOVE SPACES            TO PV-STUP-BEG-DTE(9:2)   11330000
113400             ELSE                                                 11340000
113500*                'MMDDCCYY'                                       11350000
113600                 SET DPG52-LK-DTE-GREG-CC                         11360000
113700                                        TO TRUE                   11370000
113800                 MOVE ASC-STUP-BEG-DTE(1:8)                       11380000
113900                                        TO PV-STUP-BEG-DTE(1:8)   11390000
114000                 MOVE SPACES            TO PV-STUP-BEG-DTE(9:2)   11400000
114100             END-IF                                               11410000
114200         END-IF                                                   11420000
114300         MOVE PV-STUP-BEG-DTE           TO DPG52-LK-DATE-INPUT    11430000
114400         CALL DP500-KOHLS-CALENDAR-ROUTINE USING                  11440000
114500              DPG51 DPG52 DPG53 DPG54 DPG55 DPG56                 11450000
114600         IF (DPG54-WARNING-ERROR                                  11460000
114700         OR  DPG54-SEVERE-ERROR)                                  11470000
114800*        ---- INVALID DATE ----                                   11480000
114900             SET PS-ERROR               TO TRUE                   11490000
115000             SET DP020-MSG-FATAL        TO TRUE                   11500000
115100             MOVE PC-TSYMSG-00009       TO DP020-MSG-NUMBER       11510000
115200             MOVE DP015-UNP-ALP-BRT-OFF TO ASBEGDTA               11520000
115300             MOVE DP015-RED             TO ASBEGDTC               11530000
115400             MOVE DP015-REVERSE         TO ASBEGDTH               11540000
115500             MOVE -1                    TO ASBEGDTL               11550000
115600             SET DP030-SET-CURSOR-APPL-1                          11560000
115700                                        TO TRUE                   11570000
115800         ELSE                                                     11580000
115900             MOVE DPG55-GREG-DATE-FMT   TO ASC-STUP-BEG-DTE       11590000
116000             MOVE DPG55-DB2-ISO-DATE-FMT                          11600000
116100                                        TO ASC-STUP-BEG-DTE-ISO   11610000
116200         END-IF                                                   11620000
116300     END-IF.                                                      11630000
119200     IF ASC-PO-RCPT-RPTG-IND  = 'Y' OR 'N'                        11920000
119300         CONTINUE                                                 11930000
119400     ELSE                                                         11940000
119500         SET PS-ERROR              TO TRUE                        11950000
119600         SET DP020-MSG-FATAL       TO TRUE                        11960000
119700         MOVE PC-TSYMSG-00349      TO DP020-MSG-NUMBER            11970000
119800         MOVE DP015-UNP-ALP-BRT-OFF                               11980000
119900                                   TO ARPTINDA                    11990000
120000         MOVE DP015-RED            TO ARPTINDC                    12000000
120100         MOVE DP015-REVERSE        TO ARPTINDH                    12010000
120200         MOVE -1                   TO ARPTINDL                    12020000
120300         SET DP030-SET-CURSOR-APPL-1                              12030000
120400                                   TO TRUE                        12040000
120500     END-IF.                                                      12050000
120600                                                                  12060000
120700     IF ASC-ADD-IND                                               12070000
120800         IF ASC-LONG-NME > SPACES                                 12080000
120900*            CONTINUE                                             12090000
121000             MOVE ASC-LONG-NME TO PT-LONG-NAME                    12100000
121100             SET PT-IDX                TO 1                       12110000
121200             SEARCH PT-LONG-NAME-CH                               12120000
121300               WHEN PT-LONG-NAME-CH (PT-IDX) NOT = SPACE          12130000
121400                AND PT-LONG-NAME-CH (PT-IDX) NOT = '/'            12140000
121500                AND PT-LONG-NAME-CH (PT-IDX) NOT = '-'            12150000
121600                AND PT-LONG-NAME-CH (PT-IDX) NOT NUMERIC          12160000
121700                AND PT-LONG-NAME-CH (PT-IDX) NOT ALPHABETIC       12170000
121800                SET PS-ERROR           TO TRUE                    12180000
121900                SET DP020-MSG-FATAL    TO TRUE                    12190000
122000                MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER        12200000
122100                MOVE DP015-UNP-ALP-BRT-OFF                        12210000
122200                                       TO ALONGNMA                12220000
122300                MOVE DP015-RED         TO ALONGNMC                12230000
122400                MOVE DP015-REVERSE     TO ALONGNMH                12240000
122500                MOVE -1                TO ALONGNML                12250000
122600                SET DP030-SET-CURSOR-APPL-1                       12260000
122700                                       TO TRUE                    12270000
122800         ELSE                                                     12280000
122900             SET PS-ERROR              TO TRUE                    12290000
123000             SET DP020-MSG-FATAL       TO TRUE                    12300000
123100             MOVE PC-TSYMSG-00007      TO DP020-MSG-NUMBER        12310000
123200             MOVE DP015-UNP-ALP-BRT-OFF                           12320000
123300                                       TO ALONGNMA                12330000
123400             MOVE DP015-RED            TO ALONGNMC                12340000
123500             MOVE DP015-REVERSE        TO ALONGNMH                12350000
123600             MOVE -1                   TO ALONGNML                12360000
123700             SET DP030-SET-CURSOR-APPL-1                          12370000
123800                                       TO TRUE                    12380000
123900         END-IF                                                   12390000
124000                                                                  12400000
124100         IF ASC-KEY-YEAR > SPACES                                 12410000
124200             INITIALIZE PV-ALPHA-FIELD                            12420000
124300                        DP010I-NUMERIC-EDIT-AREA                  12430000
124400             MOVE ASC-KEY-YEAR        TO PV-ALPHA-FIELD           12440000
124500             INSPECT PV-ALPHA-FIELD REPLACING ALL SPACES BY ZEROES12450000
124600             MOVE PV-ALPHA-FIELD TO DP010I-UNEDITED-FIELD         12460000
124700             MOVE 4              TO DP010I-MAXIMUM-DIGITS         12470000
124800             MOVE 0              TO DP010I-MAXIMUM-DECIMALS       12480000
124900             SET  DP010I-NEGATIVE-NOT-ALLOWED  TO TRUE            12490000
125000             CALL DP010I-NUMERIC-EDIT-ROUTINE                     12500000
125100                  USING DP010I-NUMERIC-EDIT-AREA                  12510000
125200             IF DP010I-ERROR-DETECTED                             12520000
125300             AND (DP010I-NUMERIC-FIELD NOT =  ZERO)               12530000
125400                 SET PS-ERROR              TO TRUE                12540000
125500                 SET DP020-MSG-FATAL       TO TRUE                12550000
125600                 MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER    12560000
125700                 MOVE DP015-UNP-NUM-BRT-OFF                       12570000
125800                                           TO AYEARA              12580000
125900                 MOVE DP015-RED            TO AYEARC              12590000
126000                 MOVE DP015-REVERSE        TO AYEARH              12600000
126100                 MOVE -1                   TO AYEARL              12610000
126200                 SET DP030-SET-CURSOR-APPL-1                      12620000
126300                                           TO TRUE                12630000
126400             ELSE                                                 12640000
126500                 IF DP010I-NUMERIC-FIELD > ZERO                   12650000
126600                     MOVE DP010I-NUMERIC-FIELD TO ASC-KEY-YEAR-NUM12660000
126700                 ELSE                                             12670000
126800                     SET PS-ERROR             TO TRUE             12680000
126900                     SET DP020-MSG-FATAL      TO TRUE             12690000
127000                     MOVE PC-TSYMSG-00342     TO DP020-MSG-NUMBER 12700000
127100                     MOVE DP015-UNP-NUM-BRT-OFF                   12710000
127200                                              TO AYEARA           12720000
127300                     MOVE DP015-RED           TO AYEARC           12730000
127400                     MOVE DP015-REVERSE       TO AYEARH           12740000
127500                     MOVE -1                  TO AYEARL           12750000
127600                     SET DP030-SET-CURSOR-APPL-1                  12760000
127700                                              TO TRUE             12770000
127800                 END-IF                                           12780000
127900             END-IF                                               12790000
128000         ELSE                                                     12800000
128100             SET PS-ERROR              TO TRUE                    12810000
128200             SET DP020-MSG-FATAL       TO TRUE                    12820000
128300             MOVE PC-TSYMSG-00007      TO DP020-MSG-NUMBER        12830000
128400             MOVE DP015-UNP-NUM-BRT-OFF                           12840000
128500                                       TO AYEARA                  12850000
128600             MOVE DP015-RED            TO AYEARC                  12860000
128700             MOVE DP015-REVERSE        TO AYEARH                  12870000
128800             MOVE -1                   TO AYEARL                  12880000
128900             SET DP030-SET-CURSOR-APPL-1                          12890000
129000                                       TO TRUE                    12900000
129100         END-IF                                                   12910000
129200                                                                  12920000
129300         IF ASC-KEY-SHORT-NME > SPACES                            12930000
129400             CONTINUE                                             12940000
129500         ELSE                                                     12950000
129600             SET PS-ERROR              TO TRUE                    12960000
129700             SET DP020-MSG-FATAL       TO TRUE                    12970000
129800             MOVE PC-TSYMSG-00007      TO DP020-MSG-NUMBER        12980000
129900             MOVE DP015-UNP-ALP-BRT-OFF                           12990000
130000                                       TO ASHRTNMA                13000000
130100             MOVE DP015-RED            TO ASHRTNMC                13010000
130200             MOVE DP015-REVERSE        TO ASHRTNMH                13020000
130300             MOVE -1                   TO ASHRTNML                13030000
130400             SET DP030-SET-CURSOR-APPL-1                          13040000
130500                                       TO TRUE                    13050000
130600         END-IF                                                   13060000
130700     END-IF.                                                      13070000
178500*----------------------------------------------------------------*17850000
178600* MOVE THE DEFAULT ATTRIBUTE VALUES TO THE ENTERABLE FIELDS ON   *17860000
178700* MAP.                                                           *17870000
178800*----------------------------------------------------------------*17880000
178900 3200-RESET-ATTRIBUTES.                                           17890000
179000                                                                  17900000
179100     IF ASC-ADD-IND                                               17910000
179200*        KEY FIELDS ARE OPEN DURING ADD                           17920000
179300         MOVE DP015-UNP-ALP-NOR-OFF TO ASHRTNMA                   17930000
179400                                       ALONGNMA                   17940000
179500         MOVE DP015-UNP-NUM-NOR-OFF TO AYEARA                     17950000
179600         MOVE DP015-GREEN           TO ASHRTNMC                   17960000
179700                                       AYEARC                     17970000
179800                                       ALONGNMC                   17980000
179900         MOVE DP015-UNDERLINE       TO ASHRTNMH                   17990000
180000                                       AYEARH                     18000000
180100                                       ALONGNMH                   18010000
180200     ELSE                                                         18020000
180300*        KEY FIELDS ARE PROTECTED WHEN NOT AN ADD                 18030000
180400         MOVE DP015-PRO-NOR-OFF     TO ASHRTNMA                   18040000
180500                                       AYEARA                     18050000
180600                                       ALONGNMA                   18060000
180800         MOVE DP015-BLUE            TO ASHRTNMC                   18080000
180900                                       AYEARC                     18090000
181000                                       ALONGNMC                   18100000
181200         MOVE DP015-HL-OFF          TO ASHRTNMH                   18120000
181300                                       AYEARH                     18130000
181400                                       ALONGNMH                   18140000
181600     END-IF.                                                      18160000
181700                                                                  18170000
181800     IF ASC-DEL-IND                                               18180000
181900*        ALL FIELDS ARE PROTECTED DURING DELETE                   18190000
182000         MOVE DP015-PRO-NOR-OFF     TO ASETTYPA                   18200000
182100                                       ATYPDSCA                   18210000
182200                                       ASBEGDTA                   18220000
182300                                       ASENDDTA                   18230000
182400                                       ARBEGDTA                   18240000
182500                                       ARENDDTA                   18250000
182900                                       ARPTINDA                   18290000
183000         MOVE DP015-BLUE            TO ASETTYPC                   18300000
183100                                       ATYPDSCC                   18310000
183200                                       ASBEGDTC                   18320000
183300                                       ASENDDTC                   18330000
183400                                       ARBEGDTC                   18340000
183500                                       ARENDDTC                   18350000
183900                                       ARPTINDC                   18390000
184000         MOVE DP015-HL-OFF          TO ASETTYPH                   18400000
184100                                       ATYPDSCH                   18410000
184200                                       ASBEGDTH                   18420000
184300                                       ASENDDTH                   18430000
184400                                       ARBEGDTH                   18440000
184500                                       ARENDDTH                   18450000
184900                                       ARPTINDH                   18490000
185000     ELSE                                                         18500000
185100         MOVE DP015-UNP-ALP-NOR-OFF TO ASETTYPA                   18510000
185200                                       ATYPDSCA                   18520000
185300                                       ASBEGDTA                   18530000
185400                                       ASENDDTA                   18540000
185500                                       ARBEGDTA                   18550000
185600                                       ARENDDTA                   18560000
185900                                       ARPTINDA                   18590000
186000         MOVE DP015-GREEN           TO ASETTYPC                   18600000
186100                                       ATYPDSCC                   18610000
186200                                       ASBEGDTC                   18620000
186300                                       ASENDDTC                   18630000
186400                                       ARBEGDTC                   18640000
186500                                       ARENDDTC                   18650000
186800                                       ARPTINDC                   18680000
186900         MOVE DP015-UNDERLINE       TO ASETTYPH                   18690000
187000                                       ATYPDSCH                   18700000
187100                                       ASBEGDTH                   18710000
187200                                       ASENDDTH                   18720000
187300                                       ARBEGDTH                   18730000
187400                                       ARENDDTH                   18740000
187700                                       ARPTINDH                   18770000
187800     END-IF.                                                      18780000
187900                                                                  18790000
188000                                                                  18800000
188100*----------------------------------------------------------------*18810000
188200*    VALIDATE THE QUEUE WAS PASSED AND DISPLAY FOR THE FIRST     *18820000
188300*    ENTRY.                                                      *18830000
188400*----------------------------------------------------------------*18840000
188500 4000-BUILD-INITIAL-PANEL.                                        18850000
188600                                                                  18860000
188700     PERFORM 4100-GET-PO-SET.                                     18870000
188800                                                                  18880000
188900     IF  SQLCODE = +100                                           18890000
189000         INITIALIZE ASC-SCREEN-FIELDS                             18900000
189100         MOVE PC-TSYMSG-00148        TO DP020-MSG-NUMBER          18910000
189200         SET DP020-MSG-INFORMATIONAL TO TRUE                      18920000
189300     ELSE                                                         18930000
189400         PERFORM 4200-GET-TYPE-CODE-DESC                          18940000
189500     END-IF.                                                      18950000
189600                                                                  18960000
189700     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        18970000
189800                                                                  18980000
189900*----------------------------------------------------------------*18990000
190000* SELECT A ROW FROM THE DB2 TSEASET TABLE.                       *19000000
190100*----------------------------------------------------------------*19010000
190200 4100-GET-PO-SET.                                                 19020000
190300                                                                  19030000
190400     PERFORM                                                      19040000
190500         WITH TEST AFTER                                          19050000
190600         VARYING PV-RETRY-COUNTER                                 19060000
190700         FROM 1 BY 1                                              19070000
190800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               19080000
190900                   OR (SQLCODE = ZERO)                            19090000
191000                   OR (SQLCODE = +100))                           19100000
191100                                                                  19110000
191200         EXEC SQL                                                 19120000
191300           SELECT A.SEASET_TYP_CDE                                19130000
191400                 ,A.SEASET_NM                                     19140000
191500                 ,A.STR_STUP_BEG_DTE                              19150000
191600                 ,A.STR_STUP_END_DTE                              19160000
191700                 ,A.STR_RLSE_BEG_DTE                              19170000
191800                 ,A.STR_RLSE_END_DTE                              19180000
192200                 ,A.PO_RCPT_RPTG_IND                              19220000
192300             INTO  :SEASET-SEASET-TYP-CDE                         19230000
192400                  ,:SEASET-SEASET-NM                              19240000
192500                  ,:SEASET-STR-STUP-BEG-DTE                       19250000
192600                  ,:SEASET-STR-STUP-END-DTE                       19260000
192700                  ,:SEASET-STR-RLSE-BEG-DTE                       19270000
192800                  ,:SEASET-STR-RLSE-END-DTE                       19280000
193200                  ,:SEASET-PO-RCPT-RPTG-IND                       19320000
193300             FROM   TSEASET A                                     19330000
193400             WHERE A.SEASET_YR       = :DK-YEAR                   19340000
193500              AND  A.SEASET_SHRT_NM  = :DK-SHORT-NME              19350000
193600              AND  A.SEASET_STAT_CDE = 'A'                        19360000
193700         END-EXEC                                                 19370000
193800                                                                  19380000
193900         EVALUATE TRUE                                            19390000
194000             WHEN SQLCODE = ZERO                                  19400000
194100               MOVE SEASET-SEASET-TYP-CDE   TO ASC-TYP-CDE        19410000
194200               MOVE SEASET-SEASET-NM        TO ASC-LONG-NME       19420000
194300               IF SEASET-STR-STUP-BEG-DTE = PC-DEFAULT-DATE       19430000
194400                   MOVE SPACES              TO ASC-STUP-BEG-DTE   19440000
194500               ELSE                                               19450000
194600                   MOVE SEASET-STR-STUP-BEG-DTE                   19460000
194700                                            TO PV-DB-DATE-10      19470000
194800                   MOVE PV-DB-DATE-CC       TO PV-SL-DATE-CC      19480000
194900                   MOVE PV-DB-DATE-YY       TO PV-SL-DATE-YY      19490000
195000                   MOVE PV-DB-DATE-MM       TO PV-SL-DATE-MM      19500000
195100                   MOVE PV-DB-DATE-DD       TO PV-SL-DATE-DD      19510000
195200                   MOVE PV-SLASH-DATE       TO ASC-STUP-BEG-DTE   19520000
195300               END-IF                                             19530000
195400               IF SEASET-STR-STUP-END-DTE = PC-DEFAULT-DATE       19540000
195500                   MOVE SPACES              TO ASC-STUP-END-DTE   19550000
195600               ELSE                                               19560000
195700                   MOVE SEASET-STR-STUP-END-DTE                   19570000
195800                                            TO PV-DB-DATE-10      19580000
195900                   MOVE PV-DB-DATE-CC       TO PV-SL-DATE-CC      19590000
196000                   MOVE PV-DB-DATE-YY       TO PV-SL-DATE-YY      19600000
196100                   MOVE PV-DB-DATE-MM       TO PV-SL-DATE-MM      19610000
196200                   MOVE PV-DB-DATE-DD       TO PV-SL-DATE-DD      19620000
196300                   MOVE PV-SLASH-DATE       TO ASC-STUP-END-DTE   19630000
196400               END-IF                                             19640000
196500               IF SEASET-STR-RLSE-BEG-DTE = PC-DEFAULT-DATE       19650000
196600                   MOVE SPACES              TO ASC-RLSE-BEG-DTE   19660000
196700               ELSE                                               19670000
196800                   MOVE SEASET-STR-RLSE-BEG-DTE                   19680000
196900                                            TO PV-DB-DATE-10      19690000
197000                   MOVE PV-DB-DATE-CC       TO PV-SL-DATE-CC      19700000
197100                   MOVE PV-DB-DATE-YY       TO PV-SL-DATE-YY      19710000
197200                   MOVE PV-DB-DATE-MM       TO PV-SL-DATE-MM      19720000
197300                   MOVE PV-DB-DATE-DD       TO PV-SL-DATE-DD      19730000
197400                   MOVE PV-SLASH-DATE       TO ASC-RLSE-BEG-DTE   19740000
197500               END-IF                                             19750000
197600               IF SEASET-STR-RLSE-END-DTE = PC-DEFAULT-DATE       19760000
197700                   MOVE SPACES              TO ASC-RLSE-END-DTE   19770000
197800               ELSE                                               19780000
197900                   MOVE SEASET-STR-RLSE-END-DTE                   19790000
198000                                            TO PV-DB-DATE-10      19800000
198100                   MOVE PV-DB-DATE-CC       TO PV-SL-DATE-CC      19810000
198200                   MOVE PV-DB-DATE-YY       TO PV-SL-DATE-YY      19820000
198300                   MOVE PV-DB-DATE-MM       TO PV-SL-DATE-MM      19830000
198400                   MOVE PV-DB-DATE-DD       TO PV-SL-DATE-DD      19840000
198500                   MOVE PV-SLASH-DATE       TO ASC-RLSE-END-DTE   19850000
198600               END-IF                                             19860000
198700                                                                  19870000
199200               MOVE SEASET-PO-RCPT-RPTG-IND                       19920000
199300                                          TO ASC-PO-RCPT-RPTG-IND 19930000
199400                                                                  19940000
199500             WHEN SQLCODE = +100                                  19950000
199600             WHEN SQLCODE = -904                                  19960000
199700             WHEN SQLCODE = -913                                  19970000
199800                 CONTINUE                                         19980000
199900             WHEN SQLWARN0 NOT = SPACES                           19990000
200000             WHEN SQLCODE < ZERO                                  20000000
200100             WHEN SQLCODE > ZERO                                  20010000
200200                 MOVE '4100-GET-PO-SET'                           20020000
200300                                   TO DP013-PARAGRAPH             20030000
200400                 MOVE 'SELECT PO-SET INFO  '                      20040000
200500                                   TO DP013-MESSAGE-TEXT (1)      20050000
200600                 MOVE SQLCA        TO DP013-SQLCA                 20060000
200700                 MOVE 'TSEASET'    TO DP013-DB2-TABLE-NAME (1)    20070000
200800                 SET DP013-DB2-ABEND                              20080000
200900                     DP013-XCTL-DISPLAY-RESTART                   20090000
201000                                   TO TRUE                        20100000
201100                 PERFORM DP013-0000-PROCESS-ABEND                 20110000
201200         END-EVALUATE                                             20120000
201300     END-PERFORM.                                                 20130000
201400                                                                  20140000
201500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        20150000
201600         MOVE '4100-GET-PO-SET'    TO DP013-PARAGRAPH             20160000
201700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     20170000
201800                                   TO DP013-MESSAGE-TEXT (1)      20180000
201900         MOVE 'PO SET INFO  '      TO DP013-MESSAGE-TEXT (2)      20190000
202000         MOVE SQLCA                TO DP013-SQLCA                 20200000
202100         MOVE 'TSEASET'            TO DP013-DB2-TABLE-NAME (1)    20210000
202200         SET DP013-DB2-ABEND                                      20220000
202300             DP013-XCTL-DISPLAY-RESTART                           20230000
202400                                   TO TRUE                        20240000
202500         PERFORM DP013-0000-PROCESS-ABEND                         20250000
202600     END-IF.                                                      20260000
202700                                                                  20270000
202800 EJECT                                                            20280000
202900*----------------------------------------------------------------*20290000
203000* SELECT THE TYPE CODE DESC FROM TSSTYCD.                        *20300000
203100*----------------------------------------------------------------*20310000
203200 4200-GET-TYPE-CODE-DESC.                                         20320000
203300                                                                  20330000
203400     MOVE ASC-TYP-CDE         TO DK-TYP-CDE.                      20340000
203500                                                                  20350000
203600     PERFORM                                                      20360000
203700         WITH TEST AFTER                                          20370000
203800         VARYING PV-RETRY-COUNTER                                 20380000
203900         FROM 1 BY 1                                              20390000
204000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               20400000
204100                   OR (SQLCODE = ZERO)                            20410000
204200                   OR (SQLCODE = +100))                           20420000
204300                                                                  20430000
204400         EXEC SQL                                                 20440000
204500           SELECT B.SEASET_TYP_DESC                               20450000
204600             INTO  :SSTYCD-SEASET-TYP-DESC                        20460000
204700             FROM   TSSTYCD B                                     20470000
204800             WHERE B.SEASET_TYP_CDE  = :DK-TYP-CDE                20480000
204900         END-EXEC                                                 20490000
205000                                                                  20500000
205100         EVALUATE TRUE                                            20510000
205200             WHEN SQLCODE = ZERO                                  20520000
205300                 MOVE SSTYCD-SEASET-TYP-DESC  TO ASC-TYP-DESC     20530000
205400             WHEN SQLCODE = +100                                  20540000
205500                 MOVE SPACES                  TO ASC-TYP-DESC     20550000
205600                                                                  20560000
205700             WHEN SQLCODE = -904                                  20570000
205800             WHEN SQLCODE = -913                                  20580000
205900                 CONTINUE                                         20590000
206000             WHEN SQLWARN0 NOT = SPACES                           20600000
206100             WHEN SQLCODE < ZERO                                  20610000
206200             WHEN SQLCODE > ZERO                                  20620000
206300                 MOVE '4200-GET-TYPE-CODE-DESC'                   20630000
206400                                   TO DP013-PARAGRAPH             20640000
206500                 MOVE 'SELECT PO-SET TYPE DESC'                   20650000
206600                                   TO DP013-MESSAGE-TEXT (1)      20660000
206700                 MOVE SQLCA        TO DP013-SQLCA                 20670000
206800                 MOVE 'TSSTYCD'    TO DP013-DB2-TABLE-NAME (1)    20680000
206900                 SET DP013-DB2-ABEND                              20690000
207000                     DP013-XCTL-DISPLAY-RESTART                   20700000
207100                                   TO TRUE                        20710000
207200                 PERFORM DP013-0000-PROCESS-ABEND                 20720000
207300         END-EVALUATE                                             20730000
207400     END-PERFORM.                                                 20740000
207500                                                                  20750000
207600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        20760000
207700         MOVE '4200-GET-TYPE-CODE-DESC'                           20770000
207800                                   TO DP013-PARAGRAPH             20780000
207900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     20790000
208000                                   TO DP013-MESSAGE-TEXT (1)      20800000
208100         MOVE 'PO SET TYPE CODE DESC'                             20810000
208200                                   TO DP013-MESSAGE-TEXT (2)      20820000
208300         MOVE SQLCA                TO DP013-SQLCA                 20830000
208400         MOVE 'TSSTYCD'            TO DP013-DB2-TABLE-NAME (1)    20840000
208500         SET DP013-DB2-ABEND                                      20850000
208600             DP013-XCTL-DISPLAY-RESTART                           20860000
208700                                   TO TRUE                        20870000
208800         PERFORM DP013-0000-PROCESS-ABEND                         20880000
208900     END-IF.                                                      20890000
209000                                                                  20900000
209100 EJECT                                                            20910000
209200*----------------------------------------------------------------*20920000
209300*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *20930000
209400*----------------------------------------------------------------*20940000
209500 4400-MOVE-COMMAREA-TO-SCREEN.                                    20950000
209600                                                                  20960000
209700     MOVE ASC-KEY-SHORT-NME        TO ASHRTNMO.                   20970000
209800     MOVE ASC-KEY-YEAR             TO AYEARO.                     20980000
209900     MOVE ASC-TYP-CDE              TO ASETTYPO.                   20990000
210000     MOVE ASC-TYP-DESC             TO ATYPDSCO.                   21000000
210100     MOVE ASC-LONG-NME             TO ALONGNMO.                   21010000
210200     MOVE ASC-STUP-BEG-DTE         TO ASBEGDTO.                   21020000
210300     MOVE ASC-STUP-END-DTE         TO ASENDDTO.                   21030000
210400     MOVE ASC-RLSE-BEG-DTE         TO ARBEGDTO.                   21040000
210500     MOVE ASC-RLSE-END-DTE         TO ARENDDTO.                   21050000
210900     MOVE ASC-PO-RCPT-RPTG-IND     TO ARPTINDO.                   21090000
211000                                                                  21100000
211100     EJECT                                                        21110000
211200                                                                  21120000
211300*----------------------------------------------------------------*21130000
211400* APPLY THE CHANGES TO THE MESSAGE TO THE DB2 TABLE.             *21140000
211500*----------------------------------------------------------------*21150000
211600 5000-CHANGE-PO-SET.                                              21160000
211700                                                                  21170000
211800     MOVE ASC-TYP-CDE                TO SEASET-SEASET-TYP-CDE.    21180000
211900                                                                  21190000
212000     IF ASC-STUP-BEG-DTE > SPACES                                 21200000
212100         MOVE ASC-STUP-BEG-DTE-ISO   TO SEASET-STR-STUP-BEG-DTE   21210000
212200     ELSE                                                         21220000
212300         MOVE PC-DEFAULT-DATE        TO SEASET-STR-STUP-BEG-DTE   21230000
212400     END-IF.                                                      21240000
212500     IF ASC-STUP-END-DTE > SPACES                                 21250000
212600         MOVE ASC-STUP-END-DTE-ISO   TO SEASET-STR-STUP-END-DTE   21260000
212700     ELSE                                                         21270000
212800         MOVE PC-DEFAULT-DATE        TO SEASET-STR-STUP-END-DTE   21280000
212900     END-IF.                                                      21290000
213000                                                                  21300000
213100     IF ASC-RLSE-BEG-DTE > SPACES                                 21310000
213200         MOVE ASC-RLSE-BEG-DTE-ISO   TO SEASET-STR-RLSE-BEG-DTE   21320000
213300     ELSE                                                         21330000
213400         MOVE PC-DEFAULT-DATE        TO SEASET-STR-RLSE-BEG-DTE   21340000
213500     END-IF.                                                      21350000
213600     IF ASC-RLSE-END-DTE > SPACES                                 21360000
213700         MOVE ASC-RLSE-END-DTE-ISO   TO SEASET-STR-RLSE-END-DTE   21370000
213800     ELSE                                                         21380000
213900         MOVE PC-DEFAULT-DATE        TO SEASET-STR-RLSE-END-DTE   21390000
214000     END-IF.                                                      21400000
214100                                                                  21410000
214200     MOVE DP020-USERID               TO SEASET-LAST-UPD-BY-USR-ID.21420000
215100     MOVE ASC-PO-RCPT-RPTG-IND        TO SEASET-PO-RCPT-RPTG-IND. 21510000
215200                                                                  21520000
215300     PERFORM 5100-UPDATE-PO-SET.                                  21530000
215400                                                                  21540000
215500     IF SQLCODE = +0                                              21550000
215600         SET DP020-MSG-INFORMATIONAL TO TRUE                      21560000
215700         MOVE PC-TSYMSG-00059        TO DP020-MSG-NUMBER          21570000
215800         SET DP030-SET-CURSOR-TRAILER                             21580000
215900                                     TO TRUE                      21590000
216000     END-IF.                                                      21600000
216100                                                                  21610000
216200                                                                  21620000
216300 EJECT                                                            21630000
216400*----------------------------------------------------------------*21640000
216500* UPDATE THE PO SET                                              *21650000
216600*----------------------------------------------------------------*21660000
216700 5100-UPDATE-PO-SET.                                              21670000
216800                                                                  21680000
216900     MOVE ASC-KEY-SHORT-NME             TO DK-SHORT-NME.          21690000
217000     MOVE ASC-KEY-YEAR                  TO DK-YEAR.               21700000
217100                                                                  21710000
217200     PERFORM                                                      21720000
217300         WITH TEST AFTER                                          21730000
217400         VARYING PV-RETRY-COUNTER                                 21740000
217500         FROM 1 BY 1                                              21750000
217600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               21760000
217700                   OR (SQLCODE = ZERO))                           21770000
217800         EXEC SQL                                                 21780000
217900             UPDATE TSEASET                                       21790000
218000             SET SEASET_TYP_CDE      = :SEASET-SEASET-TYP-CDE,    21800000
218100                 STR_STUP_BEG_DTE    = :SEASET-STR-STUP-BEG-DTE,  21810000
218200                 STR_STUP_END_DTE    = :SEASET-STR-STUP-END-DTE,  21820000
218300                 STR_RLSE_BEG_DTE    = :SEASET-STR-RLSE-BEG-DTE,  21830000
218400                 STR_RLSE_END_DTE    = :SEASET-STR-RLSE-END-DTE,  21840000
218500                 LAST_UPD_BY_USR_ID  = :SEASET-LAST-UPD-BY-USR-ID,21850000
218600                 LAST_UPD_TMST       = CURRENT TIMESTAMP,         21860000
219000                 PO_RCPT_RPTG_IND    = :SEASET-PO-RCPT-RPTG-IND   21900000
219100             WHERE SEASET_YR      = :DK-YEAR                      21910000
219200               AND SEASET_SHRT_NM = :DK-SHORT-NME                 21920000
219300         END-EXEC                                                 21930000
219400                                                                  21940000
219500         EVALUATE TRUE                                            21950000
219600             WHEN SQLCODE = ZERO                                  21960000
219700             WHEN SQLCODE = -904                                  21970000
219800             WHEN SQLCODE = -913                                  21980000
219900                 CONTINUE                                         21990000
220000             WHEN SQLWARN0 NOT = SPACES                           22000000
220100             WHEN SQLCODE < ZERO                                  22010000
220200             WHEN SQLCODE > ZERO                                  22020000
220300                 MOVE '5100-UPDATE-PO-SET'                        22030000
220400                                   TO DP013-PARAGRAPH             22040000
220500                 MOVE 'UPDATE A ROW ON THE PO SET TABLE'          22050000
220600                                   TO DP013-MESSAGE-TEXT(1)       22060000
220700                 MOVE SQLCA        TO DP013-SQLCA                 22070000
220800                 MOVE 'TSEASET'    TO DP013-DB2-TABLE-NAME (1)    22080000
220900                 SET DP013-DB2-ABEND                              22090000
221000                     DP013-XCTL-DISPLAY-RESTART TO TRUE           22100000
221100                 PERFORM DP013-0000-PROCESS-ABEND                 22110000
221200         END-EVALUATE                                             22120000
221300     END-PERFORM.                                                 22130000
221400                                                                  22140000
221500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        22150000
221600         MOVE '5100-UPDATE-PO-SET'                                22160000
221700                                   TO DP013-PARAGRAPH             22170000
221800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING UPDATE'        22180000
221900                                   TO DP013-MESSAGE-TEXT (1)      22190000
222000         MOVE SQLCA                TO DP013-SQLCA                 22200000
222100         MOVE 'TSEASET'            TO DP013-DB2-TABLE-NAME (1)    22210000
222200         SET DP013-DB2-ABEND                                      22220000
222300             DP013-XCTL-DISPLAY-RESTART                           22230000
222400                                   TO TRUE                        22240000
222500         PERFORM DP013-0000-PROCESS-ABEND                         22250000
222600     END-IF.                                                      22260000
222700 EJECT                                                            22270000
222800                                                                  22280000
222900*----------------------------------------------------------------*22290000
223000* RECORD IN THE SELECTION TEMP STORAGE QUEUE THE FACT THAT THIS  *22300000
223100* OBJECT WAS UDPATED.                                            *22310000
223200*----------------------------------------------------------------*22320000
223300 5200-UPDATE-SELECTION-QUEUE.                                     22330000
223400     PERFORM 9100-READ-SEL-QUEUE.                                 22340000
223500     SET PO077-UPD (ASC-SEL-SUB) TO TRUE.                         22350000
223600     PERFORM 9200-REWRITE-LIST-QUEUE.                             22360000
223700 EJECT                                                            22370000
223800                                                                  22380000
223900*----------------------------------------------------------------*22390000
224000* RECORD IN THE SELECTION TEMP STORAGE QUEUE THE FACT THAT THIS  *22400000
224100* OBJECT WAS DELETED.                                            *22410000
224200*----------------------------------------------------------------*22420000
224300 5250-DELETE-SELECTION-QUEUE.                                     22430000
224400                                                                  22440000
224500     PERFORM 9100-READ-SEL-QUEUE.                                 22450000
224600     SET PO077-DEL (ASC-SEL-SUB) TO TRUE.                         22460000
224700     PERFORM 9200-REWRITE-LIST-QUEUE.                             22470000
224800 EJECT                                                            22480000
224900                                                                  22490000
225000*----------------------------------------------------------------*22500000
225100* ADD NEW PO SET                                                 *22510000
225200*----------------------------------------------------------------*22520000
225300 6000-ADD-PO-SET.                                                 22530000
225400                                                                  22540000
225500     MOVE ASC-KEY-SHORT-NME          TO SEASET-SEASET-SHRT-NM.    22550000
225600     MOVE ASC-KEY-YEAR               TO SEASET-SEASET-YR.         22560000
225700     MOVE ASC-TYP-CDE                TO SEASET-SEASET-TYP-CDE.    22570000
225800     MOVE ASC-LONG-NME               TO SEASET-SEASET-NM.         22580000
225900                                                                  22590000
226000     IF ASC-STUP-BEG-DTE > SPACES                                 22600000
226100         MOVE ASC-STUP-BEG-DTE-ISO   TO SEASET-STR-STUP-BEG-DTE   22610000
226200     ELSE                                                         22620000
226300         MOVE PC-DEFAULT-DATE        TO SEASET-STR-STUP-BEG-DTE   22630000
226400     END-IF.                                                      22640000
226500     IF ASC-STUP-END-DTE > SPACES                                 22650000
226600         MOVE ASC-STUP-END-DTE-ISO   TO SEASET-STR-STUP-END-DTE   22660000
226700     ELSE                                                         22670000
226800         MOVE PC-DEFAULT-DATE        TO SEASET-STR-STUP-END-DTE   22680000
226900     END-IF.                                                      22690000
227000                                                                  22700000
227100     IF ASC-RLSE-BEG-DTE > SPACES                                 22710000
227200         MOVE ASC-RLSE-BEG-DTE-ISO   TO SEASET-STR-RLSE-BEG-DTE   22720000
227300     ELSE                                                         22730000
227400         MOVE PC-DEFAULT-DATE        TO SEASET-STR-RLSE-BEG-DTE   22740000
227500     END-IF.                                                      22750000
227600     IF ASC-RLSE-END-DTE > SPACES                                 22760000
227700         MOVE ASC-RLSE-END-DTE-ISO   TO SEASET-STR-RLSE-END-DTE   22770000
227800     ELSE                                                         22780000
227900         MOVE PC-DEFAULT-DATE        TO SEASET-STR-RLSE-END-DTE   22790000
228000     END-IF.                                                      22800000
228100                                                                  22810000
228200     MOVE DP020-USERID               TO SEASET-LAST-UPD-BY-USR-ID.22820000
228300                                                                  22830000
228400                                                                  22840000
229300                                                                  22930000
229400     MOVE ASC-PO-RCPT-RPTG-IND        TO SEASET-PO-RCPT-RPTG-IND. 22940000
229500                                                                  22950000
229600     PERFORM 6100-INSERT-PO-SET.                                  22960000
229700                                                                  22970000
229800     IF SQLCODE = +0                                              22980000
229900         SET DP020-MSG-INFORMATIONAL  TO TRUE                     22990000
230000         MOVE PC-TSYMSG-01271         TO DP020-MSG-NUMBER         23000000
230100         SET DP030-SET-CURSOR-TRAILER TO TRUE                     23010000
230200     ELSE                                                         23020000
230300         IF SQLCODE = -803                                        23030000
230400             PERFORM 6200-GET-PO-SET-STATUS                       23040000
230500             IF PV-STAT-CDE = 'I'                                 23050000
230600                 PERFORM 6300-REACTIVE-PO-SET                     23060000
230700                 SET DP020-MSG-INFORMATIONAL  TO TRUE             23070000
230800                 MOVE PC-TSYMSG-01271         TO DP020-MSG-NUMBER 23080000
230900                 SET DP030-SET-CURSOR-TRAILER TO TRUE             23090000
231000             ELSE                                                 23100000
231100                 SET PS-ERROR            TO TRUE                  23110000
231200                 SET DP020-MSG-FATAL     TO TRUE                  23120000
231300                 MOVE PC-TSYMSG-01591    TO DP020-MSG-NUMBER      23130000
231400                 MOVE DP015-UNP-ALP-BRT-OFF                       23140000
231500                                         TO ASHRTNMA              23150000
231600                 MOVE DP015-RED          TO ASHRTNMC              23160000
231700                                            AYEARC                23170000
231800                 MOVE DP015-REVERSE      TO ASHRTNMH              23180000
231900                                            AYEARH                23190000
232000                 MOVE -1                 TO ASHRTNML              23200000
232100                 SET DP030-SET-CURSOR-APPL-1                      23210000
232200                                         TO TRUE                  23220000
232300             END-IF                                               23230000
232400         END-IF                                                   23240000
232500     END-IF.                                                      23250000
232600                                                                  23260000
232700 EJECT                                                            23270000
232800                                                                  23280000
232900*----------------------------------------------------------------*23290000
233000* INSERT NEW PO SET                                              *23300000
233100*----------------------------------------------------------------*23310000
233200 6100-INSERT-PO-SET.                                              23320000
233300                                                                  23330000
233400     PERFORM                                                      23340000
233500         WITH TEST AFTER                                          23350000
233600         VARYING PV-RETRY-COUNTER                                 23360000
233700         FROM 1 BY 1                                              23370000
233800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               23380000
233900             OR (SQLCODE = +0)                                    23390000
234000             OR (SQLCODE = -803))                                 23400000
234100                                                                  23410000
234200                                                                  23420000
234300         EXEC SQL                                                 23430000
234400              INSERT INTO TSEASET                                 23440000
234500                     ( SEASET_YR                                  23450000
234600                      ,SEASET_SHRT_NM                             23460000
234700                      ,SEASET_TYP_CDE                             23470000
234800                      ,SEASET_NM                                  23480000
234900                      ,SEASET_STAT_CDE                            23490000
235000                      ,STR_STUP_BEG_DTE                           23500000
235100                      ,STR_STUP_END_DTE                           23510000
235200                      ,STR_RLSE_BEG_DTE                           23520000
235300                      ,STR_RLSE_END_DTE                           23530000
235400                      ,LAST_UPD_BY_USR_ID                         23540000
235500                      ,LAST_UPD_TMST                              23550000
235900                      ,PO_RCPT_RPTG_IND)                          23590000
236000              VALUES ( :SEASET-SEASET-YR                          23600000
236100                      ,:SEASET-SEASET-SHRT-NM                     23610000
236200                      ,:SEASET-SEASET-TYP-CDE                     23620000
236300                      ,:SEASET-SEASET-NM                          23630000
236400                      ,'A'                                        23640000
236500                      ,:SEASET-STR-STUP-BEG-DTE                   23650000
236600                      ,:SEASET-STR-STUP-END-DTE                   23660000
236700                      ,:SEASET-STR-RLSE-BEG-DTE                   23670000
236800                      ,:SEASET-STR-RLSE-END-DTE                   23680000
236900                      ,:SEASET-LAST-UPD-BY-USR-ID                 23690000
237000                      ,CURRENT TIMESTAMP                          23700000
237400                      ,:SEASET-PO-RCPT-RPTG-IND)                  23740000
237500         END-EXEC                                                 23750000
237600                                                                  23760000
237700         EVALUATE TRUE                                            23770000
237800             WHEN SQLCODE = +0                                    23780000
237900             WHEN SQLCODE = -803                                  23790000
238000             WHEN SQLCODE = -904                                  23800000
238100             WHEN SQLCODE = -913                                  23810000
238200                  CONTINUE                                        23820000
238300                                                                  23830000
238400             WHEN SQLWARN0 NOT = SPACES                           23840000
238500             WHEN SQLCODE < +0                                    23850000
238600             WHEN SQLCODE > +0                                    23860000
238700                  MOVE '6100-INSERT-PO-SET'                       23870000
238800                                      TO DP013-PARAGRAPH          23880000
238900                  MOVE 'UNSUCCESSFUL INSERT FOR TSEASET'          23890000
239000                                      TO DP013-MESSAGE-TEXT (1)   23900000
239100                  MOVE SQLCA          TO DP013-SQLCA              23910000
239200                  MOVE 'TSEASET '     TO DP013-DB2-TABLE-NAME (1) 23920000
239300                  SET DP013-DB2-ABEND                             23930000
239400                      DP013-XCTL-DISPLAY-RESTART                  23940000
239500                                      TO TRUE                     23950000
239600                  PERFORM DP013-0000-PROCESS-ABEND                23960000
239700         END-EVALUATE                                             23970000
239800     END-PERFORM.                                                 23980000
239900                                                                  23990000
240000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        24000000
240100         MOVE '6100-INSERT-PO-SET'    TO DP013-PARAGRAPH          24010000
240200         MOVE 'MAX RETRIES EXCEEDED FOR INSERT ON TSEASET'        24020000
240300                                      TO DP013-MESSAGE-TEXT (1)   24030000
240400         MOVE SQLCA                   TO DP013-SQLCA              24040000
240500         MOVE 'TSEASET '              TO DP013-DB2-TABLE-NAME (1) 24050000
240600         SET DP013-DB2-ABEND                                      24060000
240700             DP013-XCTL-DISPLAY-RESTART                           24070000
240800                                      TO TRUE                     24080000
240900         PERFORM DP013-0000-PROCESS-ABEND                         24090000
241000     END-IF.                                                      24100000
241100 EJECT                                                            24110000
241200                                                                  24120000
241300*----------------------------------------------------------------*24130000
241400* SELECT PO SET STATUS CODE.                                     *24140000
241500*----------------------------------------------------------------*24150000
241600 6200-GET-PO-SET-STATUS.                                          24160000
241700                                                                  24170000
241800     PERFORM                                                      24180000
241900         WITH TEST AFTER                                          24190000
242000         VARYING PV-RETRY-COUNTER                                 24200000
242100         FROM 1 BY 1                                              24210000
242200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               24220000
242300                   OR (SQLCODE = ZERO))                           24230000
242400                                                                  24240000
242500         EXEC SQL                                                 24250000
242600           SELECT A.SEASET_STAT_CDE                               24260000
242700             INTO  :PV-STAT-CDE                                   24270000
242800             FROM   TSEASET A                                     24280000
242900             WHERE A.SEASET_YR       = :SEASET-SEASET-YR          24290000
243000              AND  A.SEASET_SHRT_NM  = :SEASET-SEASET-SHRT-NM     24300000
243100         END-EXEC                                                 24310000
243200                                                                  24320000
243300         EVALUATE TRUE                                            24330000
243400             WHEN SQLCODE = ZERO                                  24340000
243500                 CONTINUE                                         24350000
243600             WHEN SQLCODE = -904                                  24360000
243700             WHEN SQLCODE = -913                                  24370000
243800                 CONTINUE                                         24380000
243900             WHEN SQLWARN0 NOT = SPACES                           24390000
244000             WHEN SQLCODE < ZERO                                  24400000
244100             WHEN SQLCODE > ZERO                                  24410000
244200                 MOVE '6200-GET-PO-SET-STATUS'                    24420000
244300                                   TO DP013-PARAGRAPH             24430000
244400                 MOVE 'SELECT PO-SET STATUS'                      24440000
244500                                   TO DP013-MESSAGE-TEXT (1)      24450000
244600                 MOVE SQLCA        TO DP013-SQLCA                 24460000
244700                 MOVE 'TSEASET'    TO DP013-DB2-TABLE-NAME (1)    24470000
244800                 SET DP013-DB2-ABEND                              24480000
244900                     DP013-XCTL-DISPLAY-RESTART                   24490000
245000                                   TO TRUE                        24500000
245100                 PERFORM DP013-0000-PROCESS-ABEND                 24510000
245200         END-EVALUATE                                             24520000
245300     END-PERFORM.                                                 24530000
245400                                                                  24540000
245500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        24550000
245600         MOVE '6200-GET-PO-SET-STATUS'                            24560000
245700                                   TO DP013-PARAGRAPH             24570000
245800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     24580000
245900                                   TO DP013-MESSAGE-TEXT (1)      24590000
246000         MOVE 'PO SET STATUS'      TO DP013-MESSAGE-TEXT (2)      24600000
246100         MOVE SQLCA                TO DP013-SQLCA                 24610000
246200         MOVE 'TSEASET'            TO DP013-DB2-TABLE-NAME (1)    24620000
246300         SET DP013-DB2-ABEND                                      24630000
246400             DP013-XCTL-DISPLAY-RESTART                           24640000
246500                                   TO TRUE                        24650000
246600         PERFORM DP013-0000-PROCESS-ABEND                         24660000
246700     END-IF.                                                      24670000
246800                                                                  24680000
246900 EJECT                                                            24690000
247000*----------------------------------------------------------------*24700000
247100* REACTIVATE TO PO SET                                           *24710000
247200*----------------------------------------------------------------*24720000
247300 6300-REACTIVE-PO-SET.                                            24730000
247400                                                                  24740000
247500     PERFORM                                                      24750000
247600         WITH TEST AFTER                                          24760000
247700         VARYING PV-RETRY-COUNTER                                 24770000
247800         FROM 1 BY 1                                              24780000
247900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               24790000
248000                   OR (SQLCODE = ZERO))                           24800000
248100         EXEC SQL                                                 24810000
248200             UPDATE TSEASET                                       24820000
248300             SET SEASET_TYP_CDE      = :SEASET-SEASET-TYP-CDE,    24830000
248400                 SEASET_NM           = :SEASET-SEASET-NM,         24840000
248500                 SEASET_STAT_CDE     = 'A',                       24850000
248600                 STR_STUP_BEG_DTE    = :SEASET-STR-STUP-BEG-DTE,  24860000
248700                 STR_STUP_END_DTE    = :SEASET-STR-STUP-END-DTE,  24870000
248800                 STR_RLSE_BEG_DTE    = :SEASET-STR-RLSE-BEG-DTE,  24880000
248900                 STR_RLSE_END_DTE    = :SEASET-STR-RLSE-END-DTE,  24890000
249000                 LAST_UPD_BY_USR_ID  = :SEASET-LAST-UPD-BY-USR-ID,24900000
249100                 LAST_UPD_TMST       = CURRENT TIMESTAMP          24910000
249200             WHERE SEASET_YR         = :SEASET-SEASET-YR          24920000
249300               AND SEASET_SHRT_NM    = :SEASET-SEASET-SHRT-NM     24930000
249400         END-EXEC                                                 24940000
249500                                                                  24950000
249600         EVALUATE TRUE                                            24960000
249700             WHEN SQLCODE = ZERO                                  24970000
249800             WHEN SQLCODE = -904                                  24980000
249900             WHEN SQLCODE = -913                                  24990000
250000                 CONTINUE                                         25000000
250100             WHEN SQLWARN0 NOT = SPACES                           25010000
250200             WHEN SQLCODE < ZERO                                  25020000
250300             WHEN SQLCODE > ZERO                                  25030000
250400                 MOVE '6300-REACTIVE-PO-SET'                      25040000
250500                                   TO DP013-PARAGRAPH             25050000
250600                 MOVE 'UPDATE A ROW ON THE PO SET TABLE'          25060000
250700                                   TO DP013-MESSAGE-TEXT(1)       25070000
250800                 MOVE SQLCA        TO DP013-SQLCA                 25080000
250900                 MOVE 'TSEASET'    TO DP013-DB2-TABLE-NAME (1)    25090000
251000                 SET DP013-DB2-ABEND                              25100000
251100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           25110000
251200                 PERFORM DP013-0000-PROCESS-ABEND                 25120000
251300         END-EVALUATE                                             25130000
251400     END-PERFORM.                                                 25140000
251500                                                                  25150000
251600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        25160000
251700         MOVE '6300-REACTIVE-PO-SET'                              25170000
251800                                   TO DP013-PARAGRAPH             25180000
251900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING UPDATE'        25190000
252000                                   TO DP013-MESSAGE-TEXT (1)      25200000
252100         MOVE SQLCA                TO DP013-SQLCA                 25210000
252200         MOVE 'TSEASET'            TO DP013-DB2-TABLE-NAME (1)    25220000
252300         SET DP013-DB2-ABEND                                      25230000
252400             DP013-XCTL-DISPLAY-RESTART                           25240000
252500                                   TO TRUE                        25250000
252600         PERFORM DP013-0000-PROCESS-ABEND                         25260000
252700     END-IF.                                                      25270000
252800 EJECT                                                            25280000
252900                                                                  25290000
253000*----------------------------------------------------------------*25300000
253100* UPDATE THE PS SET TO AN INACTIVE STATUS                        *25310000
253200*----------------------------------------------------------------*25320000
253300 7000-DELETE-PO-SET.                                              25330000
253400                                                                  25340000
253500     MOVE ASC-KEY-SHORT-NME          TO DK-SHORT-NME.             25350000
253600     MOVE ASC-KEY-YEAR               TO DK-YEAR.                  25360000
253700     MOVE DP020-USERID               TO SEASET-LAST-UPD-BY-USR-ID.25370000
253800     MOVE SPACES                     TO SEASET-POG-SEASET-YR      25380000
253900                                        SEASET-POG-SEASET-SHRT-NM.25390000
254000     MOVE 'N'                        TO SEASET-POG-SEASET-IND.    25400000
254100                                                                  25410000
254200     PERFORM 7100-INACTIVATE-PO-SET.                              25420000
254300                                                                  25430000
254400     IF SQLCODE = +0                                              25440000
254500         SET DP020-MSG-INFORMATIONAL TO TRUE                      25450000
254600         MOVE PC-TSYMSG-01277        TO DP020-MSG-NUMBER          25460000
254700         SET DP030-SET-CURSOR-TRAILER                             25470000
254800                                     TO TRUE                      25480000
254900     END-IF.                                                      25490000
255000                                                                  25500000
255100                                                                  25510000
255200*----------------------------------------------------------------*25520000
255300* UPDATE THE STATUS CODE OF THE PO SET TO INACTIVE               *25530000
255400*----------------------------------------------------------------*25540000
255500 7100-INACTIVATE-PO-SET.                                          25550000
255600                                                                  25560000
255700     PERFORM                                                      25570000
255800         WITH TEST AFTER                                          25580000
255900         VARYING PV-RETRY-COUNTER                                 25590000
256000         FROM 1 BY 1                                              25600000
256100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               25610000
256200                   OR (SQLCODE = ZERO))                           25620000
256300         EXEC SQL                                                 25630000
256400             UPDATE TSEASET                                       25640000
256500             SET SEASET_STAT_CDE     = 'I'                        25650000
256600               , LAST_UPD_BY_USR_ID  = :SEASET-LAST-UPD-BY-USR-ID 25660000
256700               , LAST_UPD_TMST       =  CURRENT TIMESTAMP         25670000
256800             WHERE SEASET_YR         = :DK-YEAR                   25680000
256900              AND  SEASET_SHRT_NM    = :DK-SHORT-NME              25690000
257000              AND  SEASET_STAT_CDE   = 'A'                        25700000
257100         END-EXEC                                                 25710000
257200                                                                  25720000
257300         EVALUATE TRUE                                            25730000
257400             WHEN SQLCODE = ZERO                                  25740000
257500             WHEN SQLCODE = -904                                  25750000
257600             WHEN SQLCODE = -913                                  25760000
257700                 CONTINUE                                         25770000
257800             WHEN SQLWARN0 NOT = SPACES                           25780000
257900             WHEN SQLCODE < ZERO                                  25790000
258000             WHEN SQLCODE > ZERO                                  25800000
258100                 MOVE '7100-DELETE-PO-SET'                        25810000
258200                                   TO DP013-PARAGRAPH             25820000
258300                 MOVE 'UPDATE A ROW ON THE PO SET TABLE'          25830000
258400                                   TO DP013-MESSAGE-TEXT(1)       25840000
258500                 MOVE SQLCA        TO DP013-SQLCA                 25850000
258600                 MOVE 'TSEASET'    TO DP013-DB2-TABLE-NAME (1)    25860000
258700                 SET DP013-DB2-ABEND                              25870000
258800                     DP013-XCTL-DISPLAY-RESTART TO TRUE           25880000
258900                 PERFORM DP013-0000-PROCESS-ABEND                 25890000
259000         END-EVALUATE                                             25900000
259100     END-PERFORM.                                                 25910000
259200                                                                  25920000
259300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        25930000
259400         MOVE '7100-DELETE-PO-SET' TO DP013-PARAGRAPH             25940000
259500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING UPDATE '       25950000
259600                                   TO DP013-MESSAGE-TEXT (1)      25960000
259700         MOVE SQLCA                TO DP013-SQLCA                 25970000
259800         MOVE 'TSEASET'            TO DP013-DB2-TABLE-NAME (1)    25980000
259900         SET DP013-DB2-ABEND                                      25990000
260000             DP013-XCTL-DISPLAY-RESTART                           26000000
260100                                   TO TRUE                        26010000
260200         PERFORM DP013-0000-PROCESS-ABEND                         26020000
260300     END-IF.                                                      26030000
260400 EJECT                                                            26040000
260500                                                                  26050000
260600*----------------------------------------------------------------*26060000
260700* VERIFY THE SET TO BE DELETED EXISTS.  IF IT DOES GIVE          *26070000
260800* CONFIRMATION MESSAGE.                                          *26080000
260900*----------------------------------------------------------------*26090000
261000 7200-VERIFY-SET-TO-DELETE.                                       26100000
261100                                                                  26110000
261200     PERFORM 7300-COUNT-SET.                                      26120000
261300                                                                  26130000
261400     IF PV-DB2-COUNT > 0                                          26140000
261500         SET ASC-CONFIRM-DEL   TO TRUE                            26150000
261600         MOVE PC-TSYMSG-00004  TO DP020-MSG-NUMBER                26160000
261700         SET DP020-MSG-WARNING TO TRUE                            26170000
261800     ELSE                                                         26180000
261900         MOVE PC-TSYMSG-00148  TO DP020-MSG-NUMBER                26190000
262000         SET DP020-MSG-INFORMATIONAL TO TRUE                      26200000
262100     END-IF.                                                      26210000
262200                                                                  26220000
262300                                                                  26230000
262400 EJECT                                                            26240000
262500                                                                  26250000
262600*----------------------------------------------------------------*26260000
262700* SELECT COUNT OF EXISTING PO SETS.                              *26270000
262800*----------------------------------------------------------------*26280000
262900 7300-COUNT-SET.                                                  26290000
263000                                                                  26300000
263100     MOVE ZERO                       TO PV-DB2-COUNT.             26310000
263200     MOVE ASC-KEY-SHORT-NME          TO DK-SHORT-NME.             26320000
263300     MOVE ASC-KEY-YEAR               TO DK-YEAR.                  26330000
263400                                                                  26340000
263500     PERFORM                                                      26350000
263600         WITH TEST AFTER                                          26360000
263700         VARYING PV-RETRY-COUNTER                                 26370000
263800         FROM 1 BY 1                                              26380000
263900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               26390000
264000                   OR (SQLCODE = ZERO))                           26400000
264100                                                                  26410000
264200         EXEC SQL                                                 26420000
264300           SELECT   COUNT(*)                                      26430000
264400             INTO  :PV-DB2-COUNT                                  26440000
264500             FROM   TSEASET A                                     26450000
264600             WHERE A.SEASET_YR       = :DK-YEAR                   26460000
264700              AND  A.SEASET_SHRT_NM  = :DK-SHORT-NME              26470000
264800              AND  A.SEASET_STAT_CDE = 'A'                        26480000
264900         END-EXEC                                                 26490000
265000                                                                  26500000
265100         EVALUATE TRUE                                            26510000
265200             WHEN SQLCODE = ZERO                                  26520000
265300             WHEN SQLCODE = +100                                  26530000
265400             WHEN SQLCODE = -904                                  26540000
265500             WHEN SQLCODE = -913                                  26550000
265600                 CONTINUE                                         26560000
265700             WHEN SQLWARN0 NOT = SPACES                           26570000
265800             WHEN SQLCODE < ZERO                                  26580000
265900             WHEN SQLCODE > ZERO                                  26590000
266000                 MOVE '7300-COUNT-SET'                            26600000
266100                                   TO DP013-PARAGRAPH             26610000
266200                 MOVE 'SELECT COUNT OF SETS'                      26620000
266300                                   TO DP013-MESSAGE-TEXT (1)      26630000
266400                 MOVE SQLCA        TO DP013-SQLCA                 26640000
266500                 MOVE 'TSEASET'    TO DP013-DB2-TABLE-NAME (1)    26650000
266600                 SET DP013-DB2-ABEND                              26660000
266700                     DP013-XCTL-DISPLAY-RESTART                   26670000
266800                                   TO TRUE                        26680000
266900                 PERFORM DP013-0000-PROCESS-ABEND                 26690000
267000         END-EVALUATE                                             26700000
267100     END-PERFORM.                                                 26710000
267200                                                                  26720000
267300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        26730000
267400         MOVE '7300-COUNT-SET'     TO DP013-PARAGRAPH             26740000
267500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     26750000
267600                                   TO DP013-MESSAGE-TEXT (1)      26760000
267700         MOVE 'COUNT OF SETS'      TO DP013-MESSAGE-TEXT (2)      26770000
267800         MOVE SQLCA                TO DP013-SQLCA                 26780000
267900         MOVE 'TSEASET'            TO DP013-DB2-TABLE-NAME (1)    26790000
268000         SET DP013-DB2-ABEND                                      26800000
268100             DP013-XCTL-DISPLAY-RESTART                           26810000
268200                                   TO TRUE                        26820000
268300         PERFORM DP013-0000-PROCESS-ABEND                         26830000
268400     END-IF.                                                      26840000
268500                                                                  26850000
268600 EJECT                                                            26860000
268700*----------------------------------------------------------------*26870000
268800* PROCESS THE SET TYPE CODE DESCRIPTION                          *26880000
268900*----------------------------------------------------------------*26890000
269000 8000-PROCESS-TYPE-DESC.                                          26900000
269100                                                                  26910000
269200     MOVE ASC-TYP-CDE                TO DK-TYP-CDE.               26920000
269300     PERFORM 8200-GET-PO-SET-TYPE-DESC.                           26930000
269400                                                                  26940000
269500* AFTER AN INSERT THE SSTYPCD DESC AND THE ASC DESC SHOULD MATCH  26950000
269600* AND FALL THROUGH THIS LOGIC. THIS WILL HAPPEN WHEN A NOT FOUND  26960000
269700* IS RETURNED FROM PARA 8200-.                                    26970000
269800     IF SSTYCD-SEASET-TYP-DESC = SPACES                           26980000
269900         PERFORM 8100-UPDATE-PO-SET-DESC                          26990000
270000     ELSE                                                         27000000
270100         IF SSTYCD-SEASET-TYP-DESC = ASC-TYP-DESC                 27010000
270200             NEXT SENTENCE                                        27020000
270300         ELSE                                                     27030000
270400         IF ASC-TYP-DESC = SPACES                                 27040000
270500             MOVE SSTYCD-SEASET-TYP-DESC  TO ASC-TYP-DESC         27050000
270600                                             ATYPDSCO             27060000
270700         ELSE                                                     27070000
270800             SET ASC-CONFIRM-DESC         TO TRUE                 27080000
270900             MOVE SSTYCD-SEASET-TYP-DESC  TO ASC-HOLD-TYP-DESC    27090000
271000             MOVE ZEROS                   TO DP020-MSG-NUMBER     27100000
271100             SET DP020-MSG-WARNING        TO TRUE                 27110000
271200             IF ASC-ADD-IND                                       27120000
271300                 MOVE PC-TSYMSG-02041     TO DP020-MSG-NUMBER     27130000
271400             ELSE                                                 27140000
271500                 MOVE PC-TSYMSG-02042     TO DP020-MSG-NUMBER     27150000
271600             END-IF                                               27160000
271700         END-IF                                                   27170000
271800     END-IF.                                                      27180000
271900                                                                  27190000
272000 EJECT                                                            27200000
272100                                                                  27210000
272200*----------------------------------------------------------------*27220000
272300* UPDATE THE PO SET DESC.                                        *27230000
272400*----------------------------------------------------------------*27240000
272500 8100-UPDATE-PO-SET-DESC.                                         27250000
272600                                                                  27260000
272700     MOVE ASC-TYP-CDE                TO DK-TYP-CDE.               27270000
272800     MOVE ASC-TYP-DESC               TO SSTYCD-SEASET-TYP-DESC.   27280000
272900                                                                  27290000
273000     PERFORM                                                      27300000
273100         WITH TEST AFTER                                          27310000
273200         VARYING PV-RETRY-COUNTER                                 27320000
273300         FROM 1 BY 1                                              27330000
273400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               27340000
273500                   OR (SQLCODE = ZERO))                           27350000
273600         EXEC SQL                                                 27360000
273700             UPDATE TSSTYCD                                       27370000
273800             SET SEASET_TYP_DESC     = :SSTYCD-SEASET-TYP-DESC    27380000
273900             WHERE SEASET_TYP_CDE    = :DK-TYP-CDE                27390000
274000         END-EXEC                                                 27400000
274100                                                                  27410000
274200         EVALUATE TRUE                                            27420000
274300             WHEN SQLCODE = ZERO                                  27430000
274400                 SET DP020-MSG-INFORMATIONAL TO TRUE              27440000
274500                 MOVE PC-TSYMSG-00059        TO DP020-MSG-NUMBER  27450000
274600                 SET DP030-SET-CURSOR-TRAILER                     27460000
274700                                             TO TRUE              27470000
274800                                                                  27480000
274900             WHEN SQLCODE = -904                                  27490000
275000             WHEN SQLCODE = -913                                  27500000
275100                 CONTINUE                                         27510000
275200             WHEN SQLWARN0 NOT = SPACES                           27520000
275300             WHEN SQLCODE < ZERO                                  27530000
275400             WHEN SQLCODE > ZERO                                  27540000
275500                 MOVE '8100-UPDATE-PO-SET-DESC '                  27550000
275600                                   TO DP013-PARAGRAPH             27560000
275700                 MOVE 'UPDATE A ROW ON THE PO SET TYP CODE TABLE' 27570000
275800                                   TO DP013-MESSAGE-TEXT(1)       27580000
275900                 MOVE SQLCA        TO DP013-SQLCA                 27590000
276000                 MOVE 'TSSTYCD'    TO DP013-DB2-TABLE-NAME (1)    27600000
276100                 SET DP013-DB2-ABEND                              27610000
276200                     DP013-XCTL-DISPLAY-RESTART TO TRUE           27620000
276300                 PERFORM DP013-0000-PROCESS-ABEND                 27630000
276400         END-EVALUATE                                             27640000
276500     END-PERFORM.                                                 27650000
276600                                                                  27660000
276700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        27670000
276800         MOVE '8100-UPDATE-PO-SET-DESC '                          27680000
276900                                   TO DP013-PARAGRAPH             27690000
277000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO UPDATE'     27700000
277100                                   TO DP013-MESSAGE-TEXT (1)      27710000
277200         MOVE SQLCA                TO DP013-SQLCA                 27720000
277300         MOVE 'TSSTYCD'            TO DP013-DB2-TABLE-NAME (1)    27730000
277400         SET DP013-DB2-ABEND                                      27740000
277500             DP013-XCTL-DISPLAY-RESTART                           27750000
277600                                   TO TRUE                        27760000
277700         PERFORM DP013-0000-PROCESS-ABEND                         27770000
277800     END-IF.                                                      27780000
277900 EJECT                                                            27790000
278000                                                                  27800000
278100                                                                  27810000
278200*----------------------------------------------------------------*27820000
278300* SELECT PO SET TYPE DESCRIPTION                                 *27830000
278400*----------------------------------------------------------------*27840000
278500 8200-GET-PO-SET-TYPE-DESC.                                       27850000
278600                                                                  27860000
278700     PERFORM                                                      27870000
278800         WITH TEST AFTER                                          27880000
278900         VARYING PV-RETRY-COUNTER                                 27890000
279000         FROM 1 BY 1                                              27900000
279100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               27910000
279200                   OR (SQLCODE = ZERO)                            27920000
279300                   OR (SQLCODE = +100))                           27930000
279400                                                                  27940000
279500         EXEC SQL                                                 27950000
279600           SELECT B.SEASET_TYP_DESC                               27960000
279700             INTO  :SSTYCD-SEASET-TYP-DESC                        27970000
279800             FROM   TSSTYCD B                                     27980000
279900             WHERE B.SEASET_TYP_CDE  = :DK-TYP-CDE                27990000
280000         END-EXEC                                                 28000000
280100                                                                  28010000
280200         EVALUATE TRUE                                            28020000
280300             WHEN SQLCODE = ZERO                                  28030000
280400                 CONTINUE                                         28040000
280500             WHEN SQLCODE = +100                                  28050000
280600                 PERFORM 8300-INSERT-TYPE-CODE-DESC               28060000
280700                                                                  28070000
280800             WHEN SQLCODE = -904                                  28080000
280900             WHEN SQLCODE = -913                                  28090000
281000                 CONTINUE                                         28100000
281100             WHEN SQLWARN0 NOT = SPACES                           28110000
281200             WHEN SQLCODE < ZERO                                  28120000
281300             WHEN SQLCODE > ZERO                                  28130000
281400                 MOVE '8200-GET-PO-SET-TYPE-DESC'                 28140000
281500                                   TO DP013-PARAGRAPH             28150000
281600                 MOVE 'SELECT PO-SET TYPE DESC'                   28160000
281700                                   TO DP013-MESSAGE-TEXT (1)      28170000
281800                 MOVE SQLCA        TO DP013-SQLCA                 28180000
281900                 MOVE 'TSSTYCD'    TO DP013-DB2-TABLE-NAME (1)    28190000
282000                 SET DP013-DB2-ABEND                              28200000
282100                     DP013-XCTL-DISPLAY-RESTART                   28210000
282200                                   TO TRUE                        28220000
282300                 PERFORM DP013-0000-PROCESS-ABEND                 28230000
282400         END-EVALUATE                                             28240000
282500     END-PERFORM.                                                 28250000
282600                                                                  28260000
282700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        28270000
282800         MOVE '8200-GET-PO-SET-TYPE-DESC'                         28280000
282900                                   TO DP013-PARAGRAPH             28290000
283000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     28300000
283100                                   TO DP013-MESSAGE-TEXT (1)      28310000
283200         MOVE 'PO SET TYPCDE DESC' TO DP013-MESSAGE-TEXT (2)      28320000
283300         MOVE SQLCA                TO DP013-SQLCA                 28330000
283400         MOVE 'TSSTYCD'            TO DP013-DB2-TABLE-NAME (1)    28340000
283500         SET DP013-DB2-ABEND                                      28350000
283600             DP013-XCTL-DISPLAY-RESTART                           28360000
283700                                   TO TRUE                        28370000
283800         PERFORM DP013-0000-PROCESS-ABEND                         28380000
283900     END-IF.                                                      28390000
284000                                                                  28400000
284100 EJECT                                                            28410000
284200*----------------------------------------------------------------*28420000
284300* INSERT THE TYPE CODE DESC                                      *28430000
284400*----------------------------------------------------------------*28440000
284500 8300-INSERT-TYPE-CODE-DESC.                                      28450000
284600                                                                  28460000
284700     MOVE ASC-TYP-CDE              TO SSTYCD-SEASET-TYP-CDE.      28470000
284800     MOVE ASC-TYP-DESC             TO SSTYCD-SEASET-TYP-DESC.     28480000
284900                                                                  28490000
285000     PERFORM                                                      28500000
285100         WITH TEST AFTER                                          28510000
285200         VARYING PV-RETRY-COUNTER                                 28520000
285300         FROM 1 BY 1                                              28530000
285400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               28540000
285500             OR (SQLCODE = +0))                                   28550000
285600                                                                  28560000
285700                                                                  28570000
285800         EXEC SQL                                                 28580000
285900              INSERT INTO TSSTYCD                                 28590000
286000                     ( SEASET_TYP_CDE                             28600000
286100                      ,SEASET_TYP_DESC                            28610000
286200                      ,SEASET_STAT_CDE)                           28620000
286300              VALUES ( :SSTYCD-SEASET-TYP-CDE                     28630000
286400                      ,:SSTYCD-SEASET-TYP-DESC                    28640000
286500                      ,'A')                                       28650000
286600         END-EXEC                                                 28660000
286700                                                                  28670000
286800         EVALUATE TRUE                                            28680000
286900             WHEN SQLCODE = +0                                    28690000
287000             WHEN SQLCODE = -904                                  28700000
287100             WHEN SQLCODE = -913                                  28710000
287200                  CONTINUE                                        28720000
287300                                                                  28730000
287400             WHEN SQLWARN0 NOT = SPACES                           28740000
287500             WHEN SQLCODE < +0                                    28750000
287600             WHEN SQLCODE > +0                                    28760000
287700                  MOVE '8300-INSERT-TYPE-CODE-DESC'               28770000
287800                                      TO DP013-PARAGRAPH          28780000
287900                  MOVE 'UNSUCCESSFUL INSERT FOR TSSTYCD'          28790000
288000                                      TO DP013-MESSAGE-TEXT (1)   28800000
288100                  MOVE SQLCA          TO DP013-SQLCA              28810000
288200                  MOVE 'TSSTYCD '     TO DP013-DB2-TABLE-NAME (1) 28820000
288300                  SET DP013-DB2-ABEND                             28830000
288400                      DP013-XCTL-DISPLAY-RESTART                  28840000
288500                                      TO TRUE                     28850000
288600                  PERFORM DP013-0000-PROCESS-ABEND                28860000
288700         END-EVALUATE                                             28870000
288800     END-PERFORM.                                                 28880000
288900                                                                  28890000
289000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        28900000
289100         MOVE '8300-INSERT-TYPE-CODE-DESC'                        28910000
289200                                      TO DP013-PARAGRAPH          28920000
289300         MOVE 'MAX RETRIES EXCEEDED FOR INSERT ON TSSTYCD'        28930000
289400                                      TO DP013-MESSAGE-TEXT (1)   28940000
289500         MOVE SQLCA                   TO DP013-SQLCA              28950000
289600         MOVE 'TSSTYCD '              TO DP013-DB2-TABLE-NAME (1) 28960000
289700         SET DP013-DB2-ABEND                                      28970000
289800             DP013-XCTL-DISPLAY-RESTART                           28980000
289900                                      TO TRUE                     28990000
290000         PERFORM DP013-0000-PROCESS-ABEND                         29000000
290100     END-IF.                                                      29010000
290200 EJECT                                                            29020000
298400*----------------------------------------------------------------*29840000
298500* SELECT POG DATA EXTR                                           *29850000
298600*----------------------------------------------------------------*29860000
298700 8500-CHECK-FOR-POG-REF-DATA.                                     29870000
298800                                                                  29880000
298900         MOVE ASC-KEY-SHORT-NME TO DK-SHORT-NME                   29890000
299000         MOVE ASC-KEY-YEAR      TO DK-YEAR                        29900000
299100                                                                  29910000
299200         EXEC SQL                                                 29920000
299300           SELECT  SEASET_YR                                      29930000
299400                 , SEASET_SHRT_NM                                 29940000
299500             INTO  :PV-SEASET-YR                                  29950000
299600                ,  :PV-SEASET-SHRT-NM                             29960000
299700             FROM  TSEASET                                        29970000
299800             WHERE POG_SEASET_YR       =  :DK-YEAR                29980000
299900              AND  POG_SEASET_SHRT_NM  =  :DK-SHORT-NME           29990000
300000              AND  POG_SEASET_IND      =  'N'                     30000000
300100              AND  SEASET_STAT_CDE     =  'A'                     30010000
300200         END-EXEC                                                 30020000
300300                                                                  30030000
300400         EVALUATE TRUE                                            30040000
300500             WHEN SQLCODE = ZERO                                  30050000
300600             WHEN SQLCODE = -811                                  30060000
300700                 MOVE PV-SEASET-YR      TO  PV-SEASET-YR-MSG      30070000
300800                 MOVE PV-SEASET-SHRT-NM TO  PV-SEASET-SHRT-NM-MSG 30080000
300900                 SET PS-POG-REF-DATA-EXISTS TO TRUE               30090000
301000             WHEN SQLCODE = +100                                  30100000
301100                  SET PS-NO-POG-REF-DATA-EXISTS TO TRUE           30110000
301200             WHEN SQLWARN0 NOT = SPACES                           30120000
301300             WHEN SQLCODE < ZERO                                  30130000
301400             WHEN SQLCODE > ZERO                                  30140000
301500                 MOVE '8500-CHECK-FOR-POG-REF-DATA'               30150000
301600                                   TO DP013-PARAGRAPH             30160000
301700                 MOVE 'CHECK FOR POG DATA  '                      30170000
301800                                   TO DP013-MESSAGE-TEXT (1)      30180000
301900                 MOVE SQLCA        TO DP013-SQLCA                 30190000
302000                 MOVE 'TSEASET '                                  30200000
302100                                       TO DP013-DB2-TABLE-NAME (1)30210000
302200                 SET DP013-DB2-ABEND                              30220000
302300                     DP013-XCTL-DISPLAY-RESTART                   30230000
302400                                   TO TRUE                        30240000
302500                 PERFORM DP013-0000-PROCESS-ABEND                 30250000
302600         END-EVALUATE.                                            30260000
302700                                                                  30270000
302800                                                                  30280000
302900 EJECT                                                            30290000
303000*----------------------------------------------------------------*30300000
303100* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *30310000
303200*----------------------------------------------------------------*30320000
303300 9100-READ-SEL-QUEUE.                                             30330000
303400                                                                  30340000
303500     EXEC CICS                                                    30350000
303600         READQ TS                                                 30360000
303700             QUEUE (ASC-SEL-QUEUE-NAME)                           30370000
303800             INTO  (PO077-SET-SEL-REC)                            30380000
303900             ITEM  (ASC-SEL-ITEM)                                 30390000
304000             RESP  (PV-CICS-RESPONSE)                             30400000
304100     END-EXEC.                                                    30410000
304200                                                                  30420000
304300     IF  PV-CICS-RESPONSE EQUAL DFHRESP(NORMAL)                   30430000
304400         CONTINUE                                                 30440000
304500     ELSE                                                         30450000
304600        IF  PV-CICS-RESPONSE EQUAL DFHRESP(QIDERR)                30460000
304700            MOVE PC-TSYMSG-00057 TO DP020-MSG-NUMBER              30470000
304800            SET DP020-MSG-WARNING TO TRUE                         30480000
304900            SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                 30490000
305000        ELSE                                                      30500000
305100         SET DP013-LOGIC-ABEND                                    30510000
305200             DP013-NO-ROLLBACK     TO TRUE                        30520000
305300         MOVE '9100-READ-SEL-QUEUE'                               30530000
305400                                   TO DP013-PARAGRAPH             30540000
305500         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   30550000
305600                                   TO DP013-MESSAGE-TEXT (1)      30560000
305700         PERFORM DP013-0000-PROCESS-ABEND                         30570000
305800        END-IF                                                    30580000
305900     END-IF.                                                      30590000
306000*----------------------------------------------------------------*30600000
306100* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *30610000
306200*----------------------------------------------------------------*30620000
306300 9200-REWRITE-LIST-QUEUE.                                         30630000
306400     EXEC CICS                                                    30640000
306500          WRITEQ TS                                               30650000
306600              QUEUE  (ASC-SEL-QUEUE-NAME)                         30660000
306700              FROM (PO077-SET-SEL-REC)                            30670000
306800              ITEM   (ASC-SEL-ITEM)                               30680000
306900              RESP   (PV-CICS-RESPONSE)                           30690000
307000              REWRITE                                             30700000
307100     END-EXEC.                                                    30710000
307200                                                                  30720000
307300     IF  PV-CICS-RESPONSE NOT EQUAL DFHRESP(NORMAL)               30730000
307400         SET DP013-CICS-ABEND                                     30740000
307500             DP013-NO-ROLLBACK     TO TRUE                        30750000
307600         MOVE '9200-REWRITE-LIST-QUEUE'                           30760000
307700                                   TO DP013-PARAGRAPH             30770000
307800         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   30780000
307900                                   TO DP013-MESSAGE-TEXT (1)      30790000
308000         PERFORM DP013-0000-PROCESS-ABEND                         30800000
308100     END-IF.                                                      30810000
308200 EJECT                                                            30820000
308300                                                                  30830000
308400*----------------------------------------------------------------*30840000
308500 9900-SOFT-ABORT.                                                 30850000
308600                                                                  30860000
308700     SET PS-ERROR                TO  TRUE.                        30870000
308800     SET DP020-MSG-FATAL         TO  TRUE.                        30880000
308900     MOVE PC-TSYMSG-00551        TO  DP020-MSG-NUMBER.            30890000
309000 EJECT                                                            30900000
309100*----------------------------------------------------------------*30910000
309200*    ABEND PROCESSOR MODULE                                      *30920000
309300*----------------------------------------------------------------*30930000
309400                                                                  30940000
309500     COPY DPPD013.                                                30950000
