000010*-----------------------*                                         00001098
000020 IDENTIFICATION DIVISION.                                         00002098
000030*-----------------------*                                         00003098
000040 PROGRAM-ID.             SUKRP066.                                00004098
000050 AUTHOR.                 PRAVEEN K.                               00005098
000060 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00006098
000070 DATE-WRITTEN.           11-25-2013.                              00007098
000080*----------------------------------------------------------------*00008098
000090*  THIS PROGRAM CREATES HAZARDOUS MATERIAL SUMMARY REPORT FOR A  *00009098
000100*  TRIP, WHEN IT GETS SHIPPED OUT OF THE DC.                     *00010098
000200*----------------------------------------------------------------*00020098
000300*                                                                 00030098
000400 ENVIRONMENT DIVISION.                                            00040098
000500 INPUT-OUTPUT SECTION.                                            00050098
000600                                                                  00060098
000700 FILE-CONTROL.                                                    00070098
000800                                                                  00080098
000900     SELECT REPORT-FILE-1     ASSIGN TO RPT01.                    00090098
001000                                                                  00100098
001100 DATA DIVISION.                                                   00110098
001200                                                                  00120098
001300 FILE SECTION.                                                    00130098
001400 FD  REPORT-FILE-1                                                00140098
001500     RECORDING MODE IS F                                          00150098
001600     BLOCK CONTAINS 0 RECORDS                                     00160098
001700     LABEL RECORDS ARE OMITTED.                                   00170098
001800 01  REPORT-RECORD-1                  PIC  X(132).                00180098
001900                                                                  00190098
002000                                                                  00200098
002100 WORKING-STORAGE SECTION.                                         00210098
002200                                                                  00220098
002300 01  CC-CONTROL-CARD-PARAMETERS.                                  00230098
002310     05  CC-USER-ID                   PIC X(07)      VALUE SPACES.00231099
002320     05  FILLER                       PIC X(01)      VALUE SPACES.00232099
002400     05  CC-OTBND-TRIP-ID             PIC X(09)      VALUE SPACES.00240098
002500     05  FILLER                       PIC X(01)      VALUE SPACE. 00250098
002600     05  CC-OPER-UNIT-ID              PIC X(04)      VALUE SPACES.00260098
002700     05  FILLER                       PIC X(01)      VALUE SPACE. 00270098
002800     05  CC-TO-STORE-NBR              PIC X(04)      VALUE SPACES.00280098
002900     05  FILLER                       PIC X(01)      VALUE SPACE. 00290098
003000     05  CC-CURR-TRIP-STAT-CD         PIC X(02)      VALUE SPACES.00300098
003100     05  FILLER                       PIC X(01)      VALUE SPACE. 00310098
003200     05  CC-CURR-STAT-DATE            PIC X(10)      VALUE SPACES.00320098
003400     05  CC-TRAILER-ID                PIC X(12)      VALUE SPACES.00340098
003600     05  CC-LOW-SYS-TRLG-CDE          PIC X(03)      VALUE SPACES.00360098
003610     05  CC-SCAC                      PIC X(04)      VALUE SPACES.00361099
003620     05  CC-TRLR-SL-NBR               PIC 9(09)      VALUE ZEROES.00362099
003630     05  CC-PRINTER-ID                PIC X(08)      VALUE SPACES.00363099
003800     05  CC-PRTR-CNTL-IND             PIC X(01)      VALUE SPACES.00380098
003900     05  CC-TRACK-NBR                 PIC 9(01)      VALUE ZEROES.00390098
004000     05  FILLER                       PIC X(01)      VALUE SPACE. 00400099
004100                                                                  00410098
004200                                                                  00420098
004300 01  PS-PROGRAM-SWITCH.                                           00430098
004400     05  PS-HAZ-CUR-EOF-SW             PIC  X(01)    VALUE 'N'.   00440098
004500         88  PS-HAZCUR-EOF                           VALUE 'Y'.   00450098
004600         88  PS-HAZCUR-NOT-EOF                       VALUE 'N'.   00460098
004700     05  PS-HAZ-PRCSS                  PIC  X(01)    VALUE 'N'.   00470098
004800         88  PS-HAZ-PRCSS-YES                        VALUE 'Y'.   00480098
004900         88  PS-HAZ-PRCSS-NO                         VALUE 'N'.   00490098
005000                                                                  00500098
005100 01  CD-CPU-DATE.                                                 00510098
005200     03  CD-YEAR                       PIC  9(04)    VALUE ZERO.  00520098
005300     03  CD-MONTH                      PIC  9(02)    VALUE ZERO.  00530098
005400     03  CD-DAY                        PIC  9(02)    VALUE ZERO.  00540098
005500                                                                  00550098
005600 01  CT-CPU-TIME.                                                 00560098
005700     03  CT-HOUR                       PIC  9(02)    VALUE ZERO.  00570098
005800     03  CT-MINUTE                     PIC  9(02)    VALUE ZERO.  00580098
005900     03  FILLER                        PIC  9(04)    VALUE ZERO.  00590098
006000                                                                  00600098
006100 01  PV-PROG-VAR-ABEND-FIELDS.                                    00610098
006200     05  PV-RECORD-COUNT              PIC  9(9)  VALUE ZERO.      00620098
006300                                                                  00630098
006400     05  PV-SQLCODE                   PIC  9(9)  VALUE ZERO.      00640098
006500     05  PV-ABEND-CODE                PIC S9(4)  VALUE +0         00650098
006600                                                 COMP SYNC.       00660098
006700     05  PV-ABEND-PROGRAM             PIC  X(8)  VALUE 'SUKRP066'.00670098
006800     05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.    00680098
006900     05  PV-ABEND-OPERATION           PIC  X(50) VALUE SPACES.    00690098
007000     05  PV-ABEND-STRUCTURE-1         PIC  X(8)  VALUE SPACES.    00700098
007100     05  PV-ABEND-STRUCTURE-2         PIC  X(8)  VALUE SPACES.    00710098
007200     05  PV-ABEND-STRUCTURE-3         PIC  X(8)  VALUE SPACES.    00720098
007300     05  PV-DB2-OPERATION-MSG-1       PIC  X(79) VALUE SPACES.    00730098
007400     05  PV-DB2-OPERATION-MSG-2       PIC  X(79) VALUE SPACES.    00740098
007500     05  PV-DB2-OPERATION-MSG-3       PIC  X(79) VALUE SPACES.    00750098
007600     05  PV-DB2-OPERATION-MSG-4       PIC  X(79) VALUE SPACES.    00760098
007700     05  PV-PARAGRAPH-NAME            PIC  X(50) VALUE SPACES.    00770098
007800     05  PV-ERROR-MESSAGE-1           PIC  X(60) VALUE SPACES.    00780098
007900     05  PV-ERROR-MESSAGE-2           PIC  X(60) VALUE SPACES.    00790098
008000     05  PV-SUBCL-NLLIND              PIC S9(04) VALUE ZEROS      00800098
008100                                                 COMP SYNC.       00810098
008200     05  PV-UNVRSL-NLLIND             PIC S9(04) VALUE ZEROS      00820098
008300                                                 COMP SYNC.       00830098
008400     05  PV-SHPG-NLLIND               PIC S9(04) VALUE ZEROS      00840098
008500                                                 COMP SYNC.       00850098
008600     05  PV-DIV-NLLIND                PIC S9(04) VALUE ZEROS      00860098
008700                                                 COMP SYNC.       00870098
008800     05  PV-PKGN-NLLIND               PIC S9(04) VALUE ZEROS      00880098
008900                                                 COMP SYNC.       00890098
009000     05  PV-SKUWGT-NLLIND             PIC S9(04) VALUE ZEROS      00900098
009100                                                 COMP SYNC.       00910098
009200     05  PV-SKUOM-NLLIND              PIC S9(04) VALUE ZEROS      00920098
009300                                                 COMP SYNC.       00930098
009400     05  PV-CART-NLLIND               PIC S9(04) VALUE ZEROS      00940098
009500                                                 COMP SYNC.       00950098
009600     05  PV-SYS-TRLGIND               PIC S9(04) VALUE ZEROS      00960098
009700                                                 COMP SYNC.       00970098
009800                                                                  00980098
009900 01  PC-PROGRAM-CONSTANTS.                                        00990098
010000                                                                  01000098
010100     05  PC-CURRENT-PROGRAM-NAME      PIC  X(08)    VALUE         01010098
010200                                          'SUKRP066'.             01020098
010300     05  PC-1                         PIC 9(01)     VALUE 1.      01030098
010400     05  PC-LINE-LIMIT                PIC S9(04)    VALUE +60     01040098
010500                                                    COMP SYNC.    01050098
010600     05  PC-COMMA                     PIC X         VALUE ','.    01060098
010700 01  DK-DB2-KEYS.                                                 01070098
010800     05  DK-HAZDS-IND                 PIC X(01)  VALUE 'Y'.       01080098
010900     05  DK-OTBND-TRIP-ID             PIC S9(09) VALUE ZERO       01090098
011000                                                  COMP.           01100098
011100     05  DK-OPER-UNT-ID               PIC X(04)  VALUE SPACES.    01110098
011200                                                                  01120098
011300 01  PV-PROGRAM-VARIABLES.                                        01130098
011400     05  PV-LINE-COUNT                PIC S9(04)    VALUE +0      01140098
011500                                                    COMP SYNC.    01150098
011600     05  PV-PAGE-COUNT          PIC S9(04)  VALUE +0 COMP SYNC.   01160099
011700     05  PV-TIMESTAMP           PIC X(26).                        01170098
011800     05  PV-ORGN-OPER-UNT-ID    PIC S9(4)    COMP.                01180098
011900     05  PV-DEST-OPER-UNT-ID    PIC S9(4)    COMP.                01190098
012000     05  PV-OTBND-STAT-TMST     PIC X(10).                        01200098
012100     05  PV-TRAILER-ID          PIC X(12)     VALUE SPACES.       01210098
012200     05  PV-ACCOUNT-NBR         PIC X(06)     VALUE SPACES.       01220098
012300     05  PV-EMERGNCY-NBR        PIC X(15)     VALUE SPACES.       01230098
012400     05  PV-TRIP-STAT-CDE       PIC X(02)     VALUE SPACES.       01240098
012500     05  PV-HAZ-SKU-NBR         PIC S9(8)V    COMP-3 VALUE ZEROES.01250098
012600     05  PV-DOT49-SUBCL-NBR     PIC X(50)     VALUE SPACES.       01260098
012700     05  PV-UNVRSL-NBR-ID       PIC X(24)     VALUE SPACES.       01270098
012800     05  PV-PRPR-SHPG-NM        PIC X(256)    VALUE SPACES.       01280098
012900     05  PV-DOT49-DIV-NBR       PIC X(50)     VALUE SPACES.       01290098
013000     05  PV-PKNGGRPSVRTY-VAL    PIC X(24)     VALUE SPACES.       01300098
013100     05  PV-SKU-WGT             PIC S9(7)V9(1) COMP-3.            01310098
013200     05  PV-SKU-UOM             PIC X(4)      VALUE SPACES.       01320098
013300     05  PV-PREV-SKU-NBR        PIC S9(8)V    COMP-3 VALUE -1.    01330098
013400     05  PV-CURR-SKU-NBR        PIC S9(8)V    COMP-3 VALUE ZEROES.01340098
013500     05  PV-SKU-UNT-QTY         PIC S9(9)     COMP.               01350098
013600     05  PV-SYS-TRLG-CDE        PIC X(3)      VALUE SPACES.       01360098
013700     05  PV-CART-CNT            PIC S9(9)     COMP.               01370098
013800     05  PV-LOW-SYS-TRLG-CDE    PIC X(3)      VALUE SPACES.       01380098
013900     05  PV-HAZDS-IND           PIC X         VALUE SPACES.       01390098
014000     05  PV-OTBND-TRIP-ID       PIC X(09)     VALUE SPACES.       01400098
014010     05  PV-TRLR-SRL-NBR        PIC 9(09)     VALUE ZEROES.       01401099
014020     05  PV-TRLR-SCAC-CODE      PIC X(04)     VALUE SPACES.       01402099
014100                                                                  01410098
014200** REPORT STRUCTURE BEGINS HERE                                ***01420098
014300                                                                  01430098
014400 01  HL1-HEADING-LINE-1.                                          01440098
014500     05  FILLER                      PIC  X(51)    VALUE SPACES.  01450098
014600     05  FILLER                      PIC  X(30)    VALUE          01460098
014700     'HAZARDOUS MATERIAL INFORMATION'.                            01470098
014800     05  FILLER                      PIC  X(51)    VALUE SPACES.  01480098
014900                                                                  01490098
014910 01  HL2-HEADING-LINE-TRLR-SRL.                                   01491099
014920     05  FILLER                      PIC  X(02)    VALUE SPACES.  01492099
014930     05  FILLER                      PIC  X(21)    VALUE          01493099
014940         'TRAILER SERIAL NBR.: '.                                 01494099
014950     05  HL2-TRLR-SRL-NBR            PIC  X(09)    VALUE SPACES.  01495099
014960     05  FILLER                      PIC  X(100)   VALUE SPACES.  01496099
014970 01  HL2-HEADING-LINE-SCAC-ID.                                    01497099
014980     05  FILLER                      PIC  X(02)    VALUE SPACES.  01498099
014990     05  FILLER                      PIC  X(21)    VALUE          01499099
014991         'SCAC / TRAILER ID..: '.                                 01499199
014992     05  HL2-TRLR-SCAC-CODE          PIC  X(04)    VALUE SPACES.  01499299
014993     05  FILLER                      PIC  X(01)    VALUE SPACES.  01499399
014994     05  FILLER                      PIC  X(01)    VALUE '/'.     01499499
014995     05  FILLER                      PIC  X(01)    VALUE SPACES.  01499599
014996     05  HL2-TRLT-ID                 PIC  X(12)    VALUE SPACES.  01499699
014998     05  FILLER                      PIC  X(90)    VALUE SPACES.  01499899
015000 01  HL2-HEADING-LINE-2.                                          01500098
015100     05  FILLER                      PIC  X(02)    VALUE SPACES.  01510098
015200     05  FILLER                      PIC  X(21)    VALUE          01520098
015300         'OUTBOUND TRIP ID...: '.                                 01530098
015400     05  HL2-OTBND-TRIP-ID           PIC  X(09)    VALUE SPACES.  01540098
015500     05  FILLER                      PIC  X(100)   VALUE SPACES.  01550099
016000                                                                  01600098
016010 01  HL2-HEADING-LINE-TRIP-DATE.                                  01601099
016020     05  FILLER                      PIC  X(02)    VALUE SPACES.  01602099
016070     05  FILLER                      PIC  X(21)    VALUE          01607099
016080         'TRIP STATUS DATE...: '.                                 01608099
016090     05  HL2-TRIP-STAT-DATE          PIC  X(10)    VALUE SPACES.  01609099
016091     05  FILLER                      PIC  X(99)    VALUE SPACES.  01609199
016700                                                                  01670098
016800 01  HL2-HEADING-LINE-4.                                          01680098
016900     05  FILLER                      PIC  X(02)    VALUE SPACES.  01690098
017000     05  FILLER                      PIC  X(21)    VALUE          01700098
017100         'TRIP STATUS........: '.                                 01710098
017200     05  HL2-TRIP-STATUS             PIC  X(20)    VALUE SPACES.  01720098
017300     05  FILLER                      PIC  X(89)    VALUE SPACES.  01730098
017400                                                                  01740098
017500 01  HL2-HEADING-LINE-5.                                          01750098
017600     05  FILLER                      PIC  X(02)    VALUE SPACES.  01760098
017700     05  FILLER                      PIC  X(21)    VALUE          01770098
017800         'FROM DC NUMBER.....: '.                                 01780099
017900     05  HL2-FROM-DC-NBR             PIC  9(04)    VALUE ZEROES.  01790098
018000     05  FILLER                      PIC  X(63)    VALUE SPACES.  01800098
018100     05  FILLER                      PIC  X(19)    VALUE          01810098
018200         'TO STORE NUMBER  : '.                                   01820098
018300     05  HL2-TO-STORE-NBR            PIC  X(04)    VALUE SPACES.  01830098
018400     05  FILLER                      PIC  X(20)    VALUE SPACES.  01840098
018500                                                                  01850098
018600 01  HL2-HEADING-LINE-6.                                          01860098
018700     05  FILLER                      PIC  X(02)    VALUE SPACES.  01870098
018800     05  FILLER                      PIC  X(21)    VALUE          01880098
018900         'ACCOUNT NUMBER.....: '.                                 01890098
019000     05  HL2-ACCT-NBR                PIC  X(06)    VALUE ZEROES.  01900099
019100     05  FILLER                      PIC  X(61)    VALUE SPACES.  01910098
019200     05  FILLER                      PIC  X(19)    VALUE          01920098
019300         'EMERGENCY NUMBER : '.                                   01930098
019400     05  HL2-EMEGNCY-NBR             PIC  X(15)    VALUE SPACES.  01940098
019500     05  FILLER                      PIC  X(08)    VALUE SPACES.  01950098
019600                                                                  01960098
019700 01  HL2-HEADING-LINE-7.                                          01970098
019800     05  FILLER                      PIC  X(18)    VALUE          01980098
019900         'MATERIAL DETAILS'.                                      01990098
020000     05  FILLER                      PIC  X(110)   VALUE SPACES.  02000098
020100                                                                  02010098
020200 01  SD-SHPRS-DCLRN.                                              02020098
020300     05  FILLER                      PIC  X(21)    VALUE          02030098
020400         'SHIPPER''S DECLARATION'.                                02040098
020500     05  FILLER                      PIC  X(107)   VALUE SPACES.  02050098
020600 01  CD-CARRS-DCLRN.                                              02060098
020700     05  FILLER                      PIC  X(21)    VALUE          02070098
020800         'CARRIER''S DECLARATION'.                                02080099
020900     05  FILLER                      PIC  X(111)   VALUE SPACES.  02090098
021000                                                                  02100098
021100 01  DL-DETAIL-LINE-LBL.                                          02110098
021200     05  FILLER                      PIC  X(04)    VALUE '    '.  02120098
021300     05  FILLER                      PIC  X(05)    VALUE          02130099
021400         'UNITS'.                                                 02140099
021410     05  FILLER                      PIC  X(02)    VALUE '  '.    02141099
021500     05  FILLER                      PIC  X(06)    VALUE          02150099
021600         'TYPE  '.                                                02160099
021610     05  FILLER                      PIC  X(02)    VALUE '  '.    02161099
021700     05  FILLER                      PIC  X(02)    VALUE          02170099
021800         'HM'.                                                    02180099
021810     05  FILLER                      PIC  X(02)    VALUE '  '.    02181099
021900     05  FILLER                      PIC  X(95)    VALUE          02190099
022000         'DESCRIPTION'.                                           02200099
022100     05  FILLER                      PIC  X(14)    VALUE          02210099
022200         '   WEIGHT     '.                                        02220099
022300 01  DL-DETAIL-LINE-DASH.                                         02230099
022400     05  FILLER                      PIC  X(04)    VALUE '    '.  02240099
022410     05  FILLER                      PIC  X(05)    VALUE          02241099
022420         '-----'.                                                 02242099
022430     05  FILLER                      PIC  X(02)    VALUE '  '.    02243099
022440     05  FILLER                      PIC  X(06)    VALUE          02244099
022450         '----  '.                                                02245099
022460     05  FILLER                      PIC  X(02)    VALUE '  '.    02246099
022470     05  FILLER                      PIC  X(02)    VALUE          02247099
022480         '--'.                                                    02248099
022490     05  FILLER                      PIC  X(02)    VALUE '  '.    02249099
022491     05  FILLER                      PIC  X(95)    VALUE          02249199
022492         '-----------'.                                           02249299
022493     05  FILLER                      PIC  X(14)    VALUE          02249399
022494         '   ------     '.                                        02249499
022500 01  DL-DETAIL-LINE.                                              02250098
022600     05  FILLER                      PIC  X(04)    VALUE '    '.  02260098
022700     05  DL-HAZ-CARTON-COUNT         PIC  ZZZZ9    VALUE SPACES.  02270098
022800     05  FILLER                      PIC  X(02)    VALUE SPACES.  02280099
022900     05  DL-PKG-TYPE                 PIC  X(06)    VALUE SPACES.  02290098
023000     05  FILLER                      PIC  X(02)    VALUE SPACES.  02300099
023100     05  DL-HAZ-IND                  PIC  X(01)    VALUE SPACES.  02310098
023200     05  FILLER                      PIC  X(03)    VALUE SPACES.  02320099
023300     05  DL-HAZ-SKU-DESC             PIC  X(91)    VALUE SPACES.  02330099
023400     05  FILLER                      PIC  X(01)    VALUE SPACES.  02340098
023500     05  DL-HAZ-SKU-WGT              PIC  ZZZZZZZZZ9.9 VALUE      02350098
023600                                                         ZEROES.  02360098
023700     05  FILLER                      PIC  X(01)    VALUE SPACES.  02370098
023800     05  DL-HAZ-SKU-UOM              PIC  X(04)    VALUE SPACES.  02380098
023900 01  FL2-FOOTER-LINE-1.                                           02390098
024000     05  FILLER                      PIC  X(02)    VALUE SPACES.  02400098
024100     05  FL2-SHIP-DECL-1             PIC  X(130)   VALUE SPACES.  02410098
024200 01  FL2-FOOTER-LINE-2.                                           02420098
024300     05  FILLER                      PIC  X(02)    VALUE SPACES.  02430098
024400     05  FL2-SHIP-DECL-2             PIC  X(130)   VALUE SPACES.  02440098
024500 01  FL2-FOOTER-LINE-3.                                           02450098
024600     05  FILLER                      PIC  X(02)    VALUE SPACES.  02460098
024601     05  FL2-SHIP-DECL-3             PIC  X(130)   VALUE SPACES.  02460198
024602 01  FL2-FOOTER-LINE-4.                                           02460200
024603     05  FILLER                      PIC  X(02)    VALUE SPACES.  02460398
024604     05  FL2-CARS-DECL-1             PIC  X(130)   VALUE SPACES.  02460498
024605 01  FL2-FOOTER-LINE-5.                                           02460500
024606     05  FILLER                      PIC  X(02)    VALUE SPACES.  02460698
024607     05  FL2-CARS-DECL-2             PIC  X(130)   VALUE SPACES.  02460798
024608 01  FL2-FOOTER-LINE-6.                                           02460800
024609     05  FILLER                      PIC  X(02)    VALUE SPACES.  02460998
024610     05  FL2-CARS-DECL-3             PIC  X(130)   VALUE SPACES.  02461098
024611                                                                  02461198
024612 01  FL2-FOOTER-LINE-7.                                           02461299
024613     05  FILLER                      PIC  X(05)    VALUE SPACES.  02461398
024614     05  FL2-SHPRS-SIGN              PIC  X(102)   VALUE SPACES.  02461499
024615     05  FILLER                      PIC  X(25)    VALUE SPACES.  02461599
024641                                                                  02464198
024642 01  FL2-FOOTER-LINE-8.                                           02464299
024643     05  FILLER                      PIC  X(05)    VALUE SPACES.  02464398
024644     05  FL2-CARRS-SIGN              PIC  X(102)   VALUE SPACES.  02464499
024645     05  FILLER                      PIC  X(25)    VALUE SPACES.  02464599
024662 01  END-OF-REPORT.                                               02466200
024663     05  FILLER                      PIC  X(50)    VALUE SPACES.  02466399
024664     05  FILLER                      PIC  X(30)    VALUE          02466498
024665         '     *** END OF REPORT ***    '.                        02466598
024666     05  FILLER                      PIC  X(31)    VALUE SPACES.  02466698
024667                                                                  02466798
024668** REPORT STRUCTURE ENDS HERE                                  ***02466898
024669                                                                  02466998
024670 01  BLANK-LINE.                                                  02467000
024680     05  FILLER                      PIC  X(132)   VALUE SPACES.  02468000
024690                                                                  02469098
024700*-----------------------------------------------------------------02470098
024800* COPYBOOK WITH PRINTEK/CODE V PRINTER CODES                      02480098
024900*-----------------------------------------------------------------02490098
025000     COPY DSWS004.                                                02500098
025100                                                                  02510098
025200* ---------------------------------------------------------------*02520098
025300*  STANDARD REPORT HEADER FOR A 132 COLUMN REPORT.                02530098
025400*---------------------------------------------------------------* 02540098
025500     COPY DPWS132.                                                02550098
025600                                                                  02560098
025700*---------------------------------------------------------------* 02570098
025800*  COPYBOOK FOR DB2 ERROR MESSAGE BUILDING                      * 02580098
025900*---------------------------------------------------------------* 02590098
026000     COPY DPWS004.                                                02600098
026100                                                                  02610098
026200*---------------------------------------------------------------* 02620098
026300*    TSUOBTR - OUTBOUND TRAILER TRIP                            * 02630098
026400*---------------------------------------------------------------* 02640098
026500     EXEC SQL                                                     02650098
026600          INCLUDE TSUOBTR                                         02660098
026700     END-EXEC.                                                    02670098
026800*---------------------------------------------------------------* 02680098
026900*    TCNTRID - CN - TRAILER DEFINITION                            02690098
027000*---------------------------------------------------------------* 02700098
027100     EXEC SQL                                                     02710098
027200          INCLUDE TCNTRID                                         02720098
027300     END-EXEC.                                                    02730098
027400*---------------------------------------------------------------* 02740098
027500*  XLT_HAZDS_MTRL_SKU                                          *  02750098
027600*---------------------------------------------------------------* 02760098
027700     EXEC SQL                                                     02770098
027800          INCLUDE XLT00042                                        02780098
027900     END-EXEC.                                                    02790098
028000                                                                  02800098
028100*---------------------------------------------------------------* 02810098
028200*    SUT_TRIP_SUM -  SU - TRIP SUMMARY                          * 02820098
028300*---------------------------------------------------------------* 02830098
028400     EXEC SQL                                                     02840098
028500          INCLUDE SUT00007                                        02850098
028600     END-EXEC.                                                    02860098
028700*---------------------------------------------------------------* 02870098
028800*  SUT_TRIP_DTL_SUM -  SU DOMAIN - TRIP DETAIL SUMMARY          * 02880098
028900*---------------------------------------------------------------* 02890098
029000     EXEC SQL                                                     02900098
029100          INCLUDE SUT00095                                        02910098
029200     END-EXEC.                                                    02920098
029300*---------------------------------------------------------------* 02930098
029400*    TSUOBTS - OUTBOUND TRAILER TRIP STATUS                     * 02940098
029500*---------------------------------------------------------------* 02950098
029600     EXEC SQL                                                     02960098
029700          INCLUDE TSUOBTS                                         02970098
029800     END-EXEC.                                                    02980098
029900*---------------------------------------------------------------* 02990098
030000*  WST_INTGRTN_TYP                                                03000098
030100*---------------------------------------------------------------* 03010098
030200     EXEC SQL                                                     03020098
030300          INCLUDE WST00008                                        03030098
030400     END-EXEC.                                                    03040098
030500                                                                  03050098
030600*---------------------------------------------------------------* 03060098
030700* WST_ATTR_DEFN                                                   03070098
030800*---------------------------------------------------------------* 03080098
030900     EXEC SQL                                                     03090098
031000          INCLUDE WST00009                                        03100098
031100     END-EXEC.                                                    03110098
031200                                                                  03120098
031300*---------------------------------------------------------------* 03130098
031400* WST_ATTR_ELEM                                                   03140098
031500*---------------------------------------------------------------* 03150098
031600     EXEC SQL                                                     03160098
031700          INCLUDE WST00010                                        03170098
031800     END-EXEC.                                                    03180098
031900*---------------------------------------------------------------* 03190098
032000*    DB2 AREA FOR COMMUNICATIONS                                * 03200098
032100*---------------------------------------------------------------* 03210098
032200     EXEC SQL                                                     03220098
032300          INCLUDE SQLCA                                           03230098
032400     END-EXEC.                                                    03240098
032500*---------------------------------------------------------------* 03250098
032600*    CURSOR TO FETCH HAZ SKU IN THE TRIP                        * 03260098
032700*---------------------------------------------------------------* 03270098
032800     EXEC SQL                                                     03280098
032900      DECLARE TRIP-HAZ-INFO CURSOR FOR                            03290098
033000        SELECT                                                    03300098
033100              MAX(T.SYS_TRLG_CDE)                                 03310098
033200            , T.SKU_NBR                                           03320098
033300            , T.HAZDS_IND                                         03330098
033400            , T.UNVRSL_NBR_ID                                     03340098
033500            , T.PRPR_SHPG_NM                                      03350098
033600            , T.DOT49_DIV_NBR                                     03360098
033700            , T.DOT49_SUBCL_NBR                                   03370098
033800            , T.PKNGGRPSVRTY_VAL                                  03380098
033900            , T.WT_UOM                                            03390098
034000            , COUNT(T.SHIPT_UNT_ID)                               03400098
034100            , SUM(T.SKU_WEIGHT)                                   03410098
034200        FROM                                                      03420098
034300             (SELECT                                              03430098
034400                  SHIPT_UNT_ID                                    03440098
034500                , B.SKU_NBR                                       03450098
034600                , C.SYS_TRLG_CDE                                  03460098
034700                , C.WT_QTY                                        03470098
034800                , B.UNT_QTY                                       03480098
034900                , (C.WT_QTY * B.UNT_QTY) AS SKU_WEIGHT            03490098
035000                , C.HAZDS_IND                                     03500098
035100                , C.HAZDS_LVL_CDE                                 03510098
035200                , C.LAST_UPD_TMST                                 03520098
035300                , C.LAST_UPD_USR_ID                               03530098
035400                , C.UNVRSL_NBR_ID                                 03540098
035500                , C.DOT49_DIV_NBR                                 03550098
035600                , C.DOT49_SUBCL_NBR                               03560098
035700                , C.PKNGGRPSVRTY_VAL                              03570098
035800                , C.PRPR_SHPG_NM                                  03580098
035900                , C.DOT49_TECH_NM1                                03590098
036000                , C.DOT49_TECH_NM2                                03600098
036100                , C.WT_UOM                                        03610098
036200             FROM                                                 03620098
036300                  SUT_TRIP_SUM A                                  03630098
036400                , SUT_TRIP_DTL_SUM B                              03640098
036500                , XLT_HAZDS_MTRL_SKU C                            03650098
036600             WHERE                                                03660098
036700                  A.OTBND_TRIP_ID  IN  (:DK-OTBND-TRIP-ID)        03670098
036800              AND A.CRE_TMST  IN                                  03680098
036900              (SELECT  MAX(D.CRE_TMST)                            03690098
037000               FROM    SUT_TRIP_SUM D                             03700098
037100               WHERE   D.OTBND_TRIP_ID     =  A.OTBND_TRIP_ID)    03710098
037200                       AND A.TRIP_OCRNC_ID =  B.TRIP_OCRNC_ID     03720098
037300                       AND B.SKU_NBR       =  C.SKU_NBR           03730098
037400                       AND C.HAZDS_IND     =  'Y'                 03740098
037500              ) AS T                                              03750098
037600        GROUP BY                                                  03760098
037700                T.SYS_TRLG_CDE                                    03770098
037800              , T.SKU_NBR , T.HAZDS_IND                           03780098
037900              , T.UNVRSL_NBR_ID                                   03790098
038000              , T.PRPR_SHPG_NM                                    03800098
038100              , T.DOT49_DIV_NBR                                   03810098
038200              , T.DOT49_SUBCL_NBR                                 03820098
038300              , T.PKNGGRPSVRTY_VAL                                03830098
038400              , T.WT_UOM                                          03840098
038600        ORDER BY                                                  03860098
038700                T.SYS_TRLG_CDE DESC                               03870098
038800              , T.SKU_NBR                                         03880098
038900        WITH UR                                                   03890098
039000     END-EXEC.                                                    03900098
039100                                                                  03910098
039200***************************************************************** 03920098
039300 PROCEDURE DIVISION.                                              03930098
039400*---------------------------------------------------------------* 03940098
039500*  THIS PARAGRAPH DRIVES THE PROGRAM.                           * 03950098
039600*---------------------------------------------------------------* 03960098
039700                                                                  03970098
039800     ACCEPT CC-CONTROL-CARD-PARAMETERS FROM SYSIN                 03980098
039900                                                                  03990098
040000     MOVE CC-OTBND-TRIP-ID     TO PV-OTBND-TRIP-ID                04000098
040100                                  DK-OTBND-TRIP-ID.               04010098
040200     MOVE CC-OPER-UNIT-ID      TO DK-OPER-UNT-ID                  04020098
040300                                  PV-ORGN-OPER-UNT-ID.            04030098
040400     MOVE CC-TO-STORE-NBR      TO PV-DEST-OPER-UNT-ID.            04040098
040500     MOVE CC-CURR-TRIP-STAT-CD TO PV-TRIP-STAT-CDE.               04050098
040600     MOVE CC-CURR-STAT-DATE    TO PV-OTBND-STAT-TMST.             04060098
040700     MOVE CC-TRAILER-ID        TO PV-TRAILER-ID.                  04070098
040800     MOVE CC-LOW-SYS-TRLG-CDE  TO PV-LOW-SYS-TRLG-CDE.            04080098
040801     MOVE CC-TRLR-SL-NBR       TO PV-TRLR-SRL-NBR.                04080199
040802     MOVE CC-SCAC              TO PV-TRLR-SCAC-CODE.              04080299
040803                                                                  04080399
040804     PERFORM 9100-PROGRAM-DISPLAY.                                04080499
040900                                                                  04090099
041000     PERFORM 1000-INITIALIZE.                                     04100098
041100*---------------------------------------------------------------* 04110098
041200*  FETCHES AND BUILDS THE REPORT HEADER                         * 04120098
041300*---------------------------------------------------------------* 04130098
041400     PERFORM 1100-FETCH-RPTHDR                                    04140098
041500     PERFORM 1120-RPTHDR-BLD                                      04150098
041600*---------------------------------------------------------------  04160098
041700*  PREAPRES THE HAZMAT SUMMARY DETAILS                            04170098
041800*---------------------------------------------------------------  04180098
041900     PERFORM 2000-BLD-HAZ-SUMMARY                                 04190098
042000*---------------------------------------------------------------  04200098
042100*  FETCHES AND PRINTS THE REPORT FOOTER DETAILS                   04210098
042200*---------------------------------------------------------------  04220098
042300     PERFORM 3000-BLD-WRT-RPTFTR                                  04230098
042400                                                                  04240098
042500     PERFORM 9000-END-PROCESS.                                    04250098
042600                                                                  04260098
042700     GOBACK.                                                      04270098
042800                                                                  04280098
042900 1000-INITIALIZE.                                                 04290098
043000*---------------------------------------------------------------* 04300098
043100*  PROGRAM INITIALIZATION                                       * 04310098
043200*    -- ACCEPT DATE AND TIME FROM THE SYSTEM AND INITIALIZE     * 04320098
043300*       THE REPORT HEADINGS.                                    * 04330098
043400*---------------------------------------------------------------* 04340098
043500     EXEC SQL                                                     04350098
043600         SET :PV-TIMESTAMP = CURRENT TIMESTAMP                    04360098
043700     END-EXEC                                                     04370098
043800                                                                  04380098
043900     OPEN OUTPUT REPORT-FILE-1                                    04390098
044000                                                                  04400098
044100     ACCEPT CD-CPU-DATE FROM DATE YYYYMMDD.                       04410098
044200     ACCEPT CT-CPU-TIME FROM TIME.                                04420098
044300                                                                  04430098
044400     MOVE CD-YEAR            TO DP132-RUN-YEAR.                   04440098
044500     MOVE CD-MONTH           TO DP132-RUN-MONTH.                  04450098
044600     MOVE CD-DAY             TO DP132-RUN-DAY.                    04460098
044700                                                                  04470098
044800     MOVE CT-HOUR            TO DP132-RUN-HOUR.                   04480098
044900     MOVE CT-MINUTE          TO DP132-RUN-MINUTE.                 04490098
045000     MOVE PC-CURRENT-PROGRAM-NAME TO DP132-PROGRAM-NAME.          04500098
045100     MOVE PC-1                 TO DP132-REPORT-NUMBER.            04510098
045110     ADD +1                    TO PV-PAGE-COUNT.                  04511099
045120     MOVE PV-PAGE-COUNT        TO DP132-PAGE-NUMBER.              04512099
045200     WRITE REPORT-RECORD-1                                        04520098
045300          FROM DP132-STANDRD-HEADER-132-COLS.                     04530098
045400                                                                  04540098
045500 1100-FETCH-RPTHDR.                                               04550098
045600*---------------------------------------------------------------* 04560098
045700*       FETCH THE REPORT HEADER DETAILS                         * 04570098
045800*---------------------------------------------------------------* 04580098
045900       EXEC SQL                                                   04590098
046000         SELECT                                                   04600098
046100                  D.ATTR_ELEM_TXT                                 04610098
046200              ,   E.ATTR_ELEM_TXT                                 04620098
046300              ,   CONCAT(F.ATTR_ELEM_TXT,G.ATTR_ELEM_TXT)         04630098
046400              ,   CONCAT(H.ATTR_ELEM_TXT,I.ATTR_ELEM_TXT)         04640098
046500              ,   CONCAT(J.ATTR_ELEM_TXT,K.ATTR_ELEM_TXT)         04650098
046510              ,   CONCAT(L.ATTR_ELEM_TXT,M.ATTR_ELEM_TXT)         04651099
046600              ,   CONCAT(N.ATTR_ELEM_TXT,O.ATTR_ELEM_TXT)         04660098
046700              ,   CONCAT(P.ATTR_ELEM_TXT,Q.ATTR_ELEM_TXT)         04670098
046800              ,   CONCAT(R.ATTR_ELEM_TXT,S.ATTR_ELEM_TXT)         04680098
046810              ,   CONCAT(T.ATTR_ELEM_TXT,U.ATTR_ELEM_TXT)         04681099
046900           INTO                                                   04690098
047000                 :PV-EMERGNCY-NBR                                 04700098
047100              ,  :PV-ACCOUNT-NBR                                  04710098
047200              ,  :FL2-SHIP-DECL-1                                 04720098
047300              ,  :FL2-SHIP-DECL-2                                 04730098
047400              ,  :FL2-SHIP-DECL-3                                 04740098
047410              ,  :FL2-SHPRS-SIGN                                  04741099
047500              ,  :FL2-CARS-DECL-1                                 04750098
047600              ,  :FL2-CARS-DECL-2                                 04760098
047700              ,  :FL2-CARS-DECL-3                                 04770098
047710              ,  :FL2-CARRS-SIGN                                  04771099
047800           FROM                                                   04780098
047900                 WST_INTGRTN_TYP  A                               04790098
048000              ,  WST_ATTR_DEFN    B                               04800098
048100              ,  WST_ATTR_ELEM    C                               04810098
048200              ,  WST_ATTR_ELEM    D                               04820098
048300              ,  WST_ATTR_ELEM    E                               04830098
048400              ,  WST_ATTR_ELEM    F                               04840098
048500              ,  WST_ATTR_ELEM    G                               04850098
048600              ,  WST_ATTR_ELEM    H                               04860098
048700              ,  WST_ATTR_ELEM    I                               04870098
048800              ,  WST_ATTR_ELEM    J                               04880098
048900              ,  WST_ATTR_ELEM    K                               04890098
049000              ,  WST_ATTR_ELEM    L                               04900098
049100              ,  WST_ATTR_ELEM    M                               04910098
049200              ,  WST_ATTR_ELEM    N                               04920098
049300              ,  WST_ATTR_ELEM    O                               04930098
049400              ,  WST_ATTR_ELEM    P                               04940098
049500              ,  WST_ATTR_ELEM    Q                               04950098
049600              ,  WST_ATTR_ELEM    R                               04960098
049700              ,  WST_ATTR_ELEM    S                               04970098
049800              ,  WST_ATTR_ELEM    T                               04980098
049900              ,  WST_ATTR_ELEM    U                               04990098
050000           WHERE                                                  05000098
050100                 A.INTGRTN_TYP_CDE   = 'HZRPTCONST'               05010098
050200             AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE          05020098
050300             AND B.ATTR_DEFN_SEQ_NBR = 1                          05030098
050400             AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE          05040098
050500             AND C.ATTR_DEFN_SEQ_NBR = 1                          05050098
050600             AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE          05060098
050700             AND D.ATTR_DEFN_SEQ_NBR = 2                          05070098
050800             AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE          05080098
050900             AND E.ATTR_DEFN_SEQ_NBR = 3                          05090098
051000             AND B.INTGRTN_TYP_CDE   = F.INTGRTN_TYP_CDE          05100098
051100             AND F.ATTR_DEFN_SEQ_NBR = 4                          05110098
051200             AND B.INTGRTN_TYP_CDE   = G.INTGRTN_TYP_CDE          05120098
051300             AND G.ATTR_DEFN_SEQ_NBR = 5                          05130098
051400             AND B.INTGRTN_TYP_CDE   = H.INTGRTN_TYP_CDE          05140098
051500             AND H.ATTR_DEFN_SEQ_NBR = 6                          05150098
051600             AND B.INTGRTN_TYP_CDE   = I.INTGRTN_TYP_CDE          05160098
051700             AND I.ATTR_DEFN_SEQ_NBR = 7                          05170098
051800             AND B.INTGRTN_TYP_CDE   = J.INTGRTN_TYP_CDE          05180098
051900             AND J.ATTR_DEFN_SEQ_NBR = 8                          05190098
052000             AND B.INTGRTN_TYP_CDE   = K.INTGRTN_TYP_CDE          05200098
052100             AND K.ATTR_DEFN_SEQ_NBR = 9                          05210098
052200             AND B.INTGRTN_TYP_CDE   = L.INTGRTN_TYP_CDE          05220098
052300             AND L.ATTR_DEFN_SEQ_NBR = 10                         05230098
052400             AND B.INTGRTN_TYP_CDE   = M.INTGRTN_TYP_CDE          05240098
052500             AND M.ATTR_DEFN_SEQ_NBR = 11                         05250098
052600             AND B.INTGRTN_TYP_CDE   = N.INTGRTN_TYP_CDE          05260098
052700             AND N.ATTR_DEFN_SEQ_NBR = 12                         05270098
052800             AND B.INTGRTN_TYP_CDE   = O.INTGRTN_TYP_CDE          05280098
052900             AND O.ATTR_DEFN_SEQ_NBR = 13                         05290098
053000             AND B.INTGRTN_TYP_CDE   = P.INTGRTN_TYP_CDE          05300098
053100             AND P.ATTR_DEFN_SEQ_NBR = 14                         05310098
053200             AND B.INTGRTN_TYP_CDE   = Q.INTGRTN_TYP_CDE          05320098
053300             AND Q.ATTR_DEFN_SEQ_NBR = 15                         05330098
053400             AND B.INTGRTN_TYP_CDE   = R.INTGRTN_TYP_CDE          05340098
053500             AND R.ATTR_DEFN_SEQ_NBR = 16                         05350098
053600             AND B.INTGRTN_TYP_CDE   = S.INTGRTN_TYP_CDE          05360098
053700             AND S.ATTR_DEFN_SEQ_NBR = 17                         05370098
053800             AND B.INTGRTN_TYP_CDE   = T.INTGRTN_TYP_CDE          05380098
053900             AND T.ATTR_DEFN_SEQ_NBR = 18                         05390098
054000             AND B.INTGRTN_TYP_CDE   = U.INTGRTN_TYP_CDE          05400098
054100             AND U.ATTR_DEFN_SEQ_NBR = 19                         05410098
054200             AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR        05420098
054300             AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR        05430098
054400             AND C.ATTR_ELEM_SEQ_NBR = F.ATTR_ELEM_SEQ_NBR        05440098
054500             AND C.ATTR_ELEM_SEQ_NBR = G.ATTR_ELEM_SEQ_NBR        05450098
054600             AND C.ATTR_ELEM_SEQ_NBR = H.ATTR_ELEM_SEQ_NBR        05460098
054700             AND C.ATTR_ELEM_SEQ_NBR = I.ATTR_ELEM_SEQ_NBR        05470098
054800             AND C.ATTR_ELEM_SEQ_NBR = J.ATTR_ELEM_SEQ_NBR        05480098
054900             AND C.ATTR_ELEM_SEQ_NBR = K.ATTR_ELEM_SEQ_NBR        05490098
055000             AND C.ATTR_ELEM_SEQ_NBR = L.ATTR_ELEM_SEQ_NBR        05500098
055100             AND C.ATTR_ELEM_SEQ_NBR = M.ATTR_ELEM_SEQ_NBR        05510098
055200             AND C.ATTR_ELEM_SEQ_NBR = N.ATTR_ELEM_SEQ_NBR        05520098
055300             AND C.ATTR_ELEM_SEQ_NBR = O.ATTR_ELEM_SEQ_NBR        05530098
055400             AND C.ATTR_ELEM_SEQ_NBR = P.ATTR_ELEM_SEQ_NBR        05540098
055500             AND C.ATTR_ELEM_SEQ_NBR = Q.ATTR_ELEM_SEQ_NBR        05550098
055600             AND C.ATTR_ELEM_SEQ_NBR = R.ATTR_ELEM_SEQ_NBR        05560098
055700             AND C.ATTR_ELEM_SEQ_NBR = S.ATTR_ELEM_SEQ_NBR        05570098
055800             AND C.ATTR_ELEM_SEQ_NBR = T.ATTR_ELEM_SEQ_NBR        05580098
055900             AND C.ATTR_ELEM_SEQ_NBR = U.ATTR_ELEM_SEQ_NBR        05590098
056000             AND C.ATTR_ELEM_NBR     = :DK-OPER-UNT-ID            05600098
056100           WITH UR                                                05610098
056200       END-EXEC.                                                  05620098
056300       EVALUATE TRUE                                              05630098
056400            WHEN SQLCODE = ZERO                                   05640098
056500                  CONTINUE                                        05650098
056600            WHEN SQLCODE = +100                                   05660098
056700                MOVE SPACES TO PV-ACCOUNT-NBR                     05670098
056800                MOVE SPACES TO PV-EMERGNCY-NBR                    05680098
056900                MOVE SPACES TO FL2-SHIP-DECL-1                    05690098
057000                               FL2-SHIP-DECL-2                    05700098
057100                               FL2-SHIP-DECL-3                    05710098
057200                               FL2-CARS-DECL-1                    05720098
057300                               FL2-CARS-DECL-2                    05730098
057400                               FL2-CARS-DECL-3                    05740098
057500            WHEN SQLCODE = -904                                   05750098
057600            WHEN SQLCODE = -911                                   05760098
057700            WHEN SQLCODE = -913                                   05770098
057800                MOVE SQLCODE      TO  PV-SQLCODE                  05780098
057900                MOVE '1100-FETCH-RPTHDR'                          05790098
058000                                      TO  PV-ABEND-PARAGRAPH      05800098
058100                MOVE 'SELECT'         TO  PV-ABEND-OPERATION      05810098
058200                MOVE 'ACCOUNT NUMBER' TO  PV-DB2-OPERATION-MSG-1  05820098
058300                MOVE 'EMERGENCY NUMBER'                           05830098
058400                                      TO  PV-DB2-OPERATION-MSG-2  05840098
058500                MOVE 'SHIPPERS DECL'  TO  PV-DB2-OPERATION-MSG-3  05850098
058600                MOVE 'HAZSUMRY'       TO  PV-ABEND-STRUCTURE-1    05860098
058700                PERFORM 9900-DB2-ABEND                            05870098
058800        END-EVALUATE.                                             05880098
058900                                                                  05890098
059000 1120-RPTHDR-BLD.                                                 05900098
059100*---------------------------------------------------------------* 05910098
059200*  INITIALIZE REPORT HEADINGS                                   * 05920098
059300*---------------------------------------------------------------* 05930098
059310     MOVE PV-TRLR-SCAC-CODE      TO HL2-TRLR-SCAC-CODE.           05931099
059320     MOVE PV-TRLR-SRL-NBR        TO HL2-TRLR-SRL-NBR.             05932099
059400     MOVE PV-OTBND-TRIP-ID       TO HL2-OTBND-TRIP-ID.            05940098
059500     MOVE PV-OTBND-STAT-TMST     TO HL2-TRIP-STAT-DATE.           05950098
059600     MOVE PV-TRAILER-ID          TO HL2-TRLT-ID.                  05960098
059700     MOVE PV-ORGN-OPER-UNT-ID    TO HL2-FROM-DC-NBR.              05970098
059800     MOVE PV-DEST-OPER-UNT-ID    TO HL2-TO-STORE-NBR.             05980098
059900     MOVE PV-ACCOUNT-NBR         TO HL2-ACCT-NBR.                 05990098
060000     MOVE PV-EMERGNCY-NBR        TO HL2-EMEGNCY-NBR.              06000098
060100                                                                  06010098
060200     EVALUATE PV-TRIP-STAT-CDE                                    06020098
060300         WHEN 'DO'                                                06030098
060400              MOVE 'OPENED AT DC' TO HL2-TRIP-STATUS              06040098
060500         WHEN 'DC'                                                06050098
060600              MOVE 'CLOSED AT DC' TO HL2-TRIP-STATUS              06060098
060700         WHEN 'DS'                                                06070098
060800              MOVE 'SHIPPED FROM DC' TO HL2-TRIP-STATUS           06080098
060900         WHEN 'SO'                                                06090098
061000              MOVE 'OPENED AT STORE' TO HL2-TRIP-STATUS           06100098
061100         WHEN 'DO'                                                06110098
061200              MOVE 'UNLOADED AT DC' TO HL2-TRIP-STATUS            06120098
061300     END-EVALUATE.                                                06130098
061400                                                                  06140098
061500     PERFORM 1140-WRITE-RPT-HEADING.                              06150098
061600                                                                  06160098
061700*---------------------------------------------------------------* 06170098
061800*  WRITES THE REPORT HEADER                                       06180098
061900*---------------------------------------------------------------* 06190098
062000 1140-WRITE-RPT-HEADING.                                          06200098
062100                                                                  06210098
062200         IF CC-PRTR-CNTL-IND = 'P'                                06220098
062300             MOVE CC-TRACK-NBR           TO DS004-PLC-LF-FORM-NBR 06230098
062400             MOVE DS004-PES-8LPI         TO DS004-PLC-LF-LPI      06240098
062500                                                                  06250098
062600             WRITE REPORT-RECORD-1                                06260098
062700                 FROM DS004-PLC-LOAD-FORM                         06270098
062800             AFTER ADVANCING 1 LINE                               06280098
062900         END-IF                                                   06290098
062910         WRITE REPORT-RECORD-1                                    06291099
062920           FROM BLANK-LINE.                                       06292099
063000         WRITE REPORT-RECORD-1                                    06300098
063100           FROM HL1-HEADING-LINE-1.                               06310098
063110         WRITE REPORT-RECORD-1                                    06311099
063120           FROM BLANK-LINE.                                       06312099
063200         WRITE REPORT-RECORD-1                                    06320098
063300           FROM HL2-HEADING-LINE-TRLR-SRL.                        06330099
063301         WRITE REPORT-RECORD-1                                    06330199
063302           FROM HL2-HEADING-LINE-SCAC-ID.                         06330299
063310         WRITE REPORT-RECORD-1                                    06331099
063320           FROM HL2-HEADING-LINE-2.                               06332099
063600         WRITE REPORT-RECORD-1                                    06360098
063700           FROM HL2-HEADING-LINE-4.                               06370098
063701         WRITE REPORT-RECORD-1                                    06370199
063702           FROM HL2-HEADING-LINE-TRIP-DATE.                       06370299
063710         WRITE REPORT-RECORD-1                                    06371099
063720           FROM BLANK-LINE.                                       06372099
063730         WRITE REPORT-RECORD-1                                    06373099
063740           FROM BLANK-LINE.                                       06374099
063800         WRITE REPORT-RECORD-1                                    06380098
063900           FROM HL2-HEADING-LINE-5.                               06390098
063910         WRITE REPORT-RECORD-1                                    06391099
063920           FROM BLANK-LINE.                                       06392099
064000         WRITE REPORT-RECORD-1                                    06400098
064100           FROM HL2-HEADING-LINE-6.                               06410098
064200         WRITE REPORT-RECORD-1                                    06420098
064300           FROM BLANK-LINE.                                       06430098
064400         WRITE REPORT-RECORD-1                                    06440098
064500           FROM BLANK-LINE.                                       06450098
064510         WRITE REPORT-RECORD-1                                    06451099
064520           FROM BLANK-LINE.                                       06452099
064530         WRITE REPORT-RECORD-1                                    06453099
064540           FROM BLANK-LINE.                                       06454099
064600         WRITE REPORT-RECORD-1                                    06460098
064700           FROM HL2-HEADING-LINE-7.                               06470098
064800         WRITE REPORT-RECORD-1                                    06480098
064900           FROM BLANK-LINE.                                       06490098
065000         WRITE REPORT-RECORD-1                                    06500098
065100           FROM DL-DETAIL-LINE-LBL.                               06510098
065110         WRITE REPORT-RECORD-1                                    06511099
065120           FROM DL-DETAIL-LINE-DASH.                              06512099
065200                                                                  06520098
065300         ADD +24 TO PV-LINE-COUNT.                                06530099
065400                                                                  06540098
065500*---------------------------------------------------------------* 06550098
065600*  BUILDS THE HAZMAT SUMMARY DETAILS                              06560098
065700*---------------------------------------------------------------* 06570098
065800 2000-BLD-HAZ-SUMMARY.                                            06580098
065900         PERFORM 2010-OPEN-HAZ-CURSOR.                            06590098
066000         PERFORM 2080-CLOSE-HAZ-CURSOR.                           06600098
066100                                                                  06610098
066200 2010-OPEN-HAZ-CURSOR.                                            06620098
066300                                                                  06630098
066400       EXEC SQL                                                   06640098
066500            OPEN TRIP-HAZ-INFO                                    06650098
066600       END-EXEC.                                                  06660098
066700                                                                  06670098
066800       EVALUATE TRUE                                              06680098
066900            WHEN SQLCODE = ZERO                                   06690098
067000                 PERFORM 2020-FETCH-HAZ-CURSOR                    06700098
067100                              UNTIL PS-HAZCUR-EOF                 06710098
067200            WHEN SQLCODE = +100                                   06720098
067300                 CONTINUE                                         06730098
067400            WHEN SQLCODE = -904                                   06740098
067500            WHEN SQLCODE = -911                                   06750098
067600            WHEN SQLCODE = -913                                   06760098
067700                MOVE SQLCODE      TO  PV-SQLCODE                  06770098
067800                MOVE '2010-OPEN-HAZ-CURSOR'                       06780098
067900                                      TO  PV-ABEND-PARAGRAPH      06790098
068000                MOVE 'OPEN'           TO  PV-ABEND-OPERATION      06800098
068100                MOVE 'TRIP-HAZ-INFO'  TO  PV-DB2-OPERATION-MSG-1  06810098
068200                MOVE 'SUT_TRIP_SUM SUT-TRIP_DTL_SUM'              06820098
068300                                      TO  PV-DB2-OPERATION-MSG-2  06830098
068400                MOVE 'HAZSUMRY'       TO  PV-ABEND-STRUCTURE-1    06840098
068500                PERFORM 9900-DB2-ABEND                            06850098
068600        END-EVALUATE.                                             06860098
068700                                                                  06870098
068800 2020-FETCH-HAZ-CURSOR.                                           06880098
068900*---------------------------------------------------------------* 06890098
069000*  FETCHES THE HAZ SUMMARY DATA AND PREPARES THE REPORT         * 06900098
069100*---------------------------------------------------------------* 06910098
069200       EXEC SQL                                                   06920098
069300          FETCH TRIP-HAZ-INFO                                     06930098
069400          INTO :PV-SYS-TRLG-CDE     :PV-SYS-TRLGIND               06940098
069500             , :PV-HAZ-SKU-NBR                                    06950098
069600             , :PV-HAZDS-IND                                      06960098
069700             , :PV-UNVRSL-NBR-ID    :PV-UNVRSL-NLLIND             06970098
069800             , :PV-PRPR-SHPG-NM     :PV-SHPG-NLLIND               06980098
069900             , :PV-DOT49-DIV-NBR    :PV-DIV-NLLIND                06990098
070000             , :PV-DOT49-SUBCL-NBR  :PV-SUBCL-NLLIND              07000098
070100             , :PV-PKNGGRPSVRTY-VAL :PV-PKGN-NLLIND               07010098
070200             , :PV-SKU-UOM          :PV-SKUOM-NLLIND              07020098
070300             , :PV-CART-CNT         :PV-CART-NLLIND               07030098
070400             , :PV-SKU-WGT          :PV-SKUWGT-NLLIND             07040098
070500       END-EXEC.                                                  07050098
070600       EVALUATE TRUE                                              07060098
070700            WHEN SQLCODE = ZERO                                   07070098
070800                  IF PV-SYS-TRLGIND  = -1                         07080098
070900                     MOVE SPACES TO PV-SYS-TRLG-CDE               07090098
071000                  END-IF                                          07100098
071100                  IF PV-SUBCL-NLLIND = -1                         07110098
071200                     MOVE SPACES TO PV-DOT49-SUBCL-NBR            07120098
071300                  END-IF                                          07130098
071400                  IF PV-UNVRSL-NLLIND = -1                        07140098
071500                     MOVE SPACES TO PV-UNVRSL-NBR-ID              07150098
071600                  END-IF                                          07160098
071700                  IF PV-SHPG-NLLIND   = -1                        07170098
071800                     MOVE SPACES TO PV-PRPR-SHPG-NM               07180098
071900                  END-IF                                          07190098
072000                  IF PV-DIV-NLLIND = -1                           07200098
072100                     MOVE SPACES TO PV-DOT49-DIV-NBR              07210098
072200                  END-IF                                          07220098
072300                  IF PV-PKGN-NLLIND = -1                          07230098
072400                     MOVE SPACES TO PV-PKNGGRPSVRTY-VAL           07240098
072500                  END-IF                                          07250098
072600                  IF PV-SKUWGT-NLLIND = -1                        07260098
072700                     MOVE ZEROES TO PV-SKU-WGT                    07270098
072800                  END-IF                                          07280098
072900                  IF PV-SKUOM-NLLIND = -1                         07290098
073000                     MOVE SPACES TO PV-SKU-UOM                    07300098
073100                  END-IF                                          07310098
073200                  IF PV-CART-NLLIND  = -1                         07320098
073300                     MOVE ZEROES TO PV-CART-NLLIND                07330098
073400                  END-IF                                          07340098
073500                  PERFORM 2030-PREPARE-HAZ-DTL-REC                07350098
073600            WHEN SQLCODE = +100                                   07360098
073700                SET PS-HAZCUR-EOF TO TRUE                         07370098
073800            WHEN SQLCODE = -904                                   07380098
073900            WHEN SQLCODE = -911                                   07390098
074000            WHEN SQLCODE = -913                                   07400098
074100                MOVE SQLCODE      TO  PV-SQLCODE                  07410098
074200                MOVE '2030-FETCH-HAZ-CURSOR'                      07420098
074300                                      TO  PV-ABEND-PARAGRAPH      07430098
074400                MOVE 'FETCH'          TO  PV-ABEND-OPERATION      07440098
074500                MOVE 'TRIP-HAZ-INFO'  TO  PV-DB2-OPERATION-MSG-1  07450098
074600                MOVE 'SUT_TRIP_SUM SUT-TRIP_DTL_SUM'              07460098
074700                                      TO  PV-DB2-OPERATION-MSG-2  07470098
074800                MOVE 'HAZSUMRY'       TO  PV-ABEND-STRUCTURE-1    07480098
074900                PERFORM 9900-DB2-ABEND                            07490098
075000        END-EVALUATE.                                             07500098
075100                                                                  07510098
075101 2030-PREPARE-HAZ-DTL-REC.                                        07510198
075102*---------------------------------------------------------------* 07510200
075103*  DETAIL HAZMAT SUMMARY RECORD PREPARATION                     * 07510300
075104*---------------------------------------------------------------* 07510400
075105       IF PV-SYS-TRLG-CDE  >= PV-LOW-SYS-TRLG-CDE                 07510598
075106          AND PV-HAZDS-IND = 'Y'                                  07510698
075107          PERFORM 2070-WRITE-HAZ-DTL-REC                          07510798
075108       END-IF.                                                    07510898
075109*---------------------------------------------------------------* 07510900
075110*  WRITES THE DETAILED HAZ SUMMARY REPORT DETAILS                 07511000
075120*---------------------------------------------------------------* 07512000
075130 2070-WRITE-HAZ-DTL-REC.                                          07513098
075140       INITIALIZE DL-DETAIL-LINE                                  07514098
075150       IF PV-LINE-COUNT > PC-LINE-LIMIT                           07515098
075160          COMPUTE PV-PAGE-COUNT = PV-PAGE-COUNT  + 1              07516098
075170          MOVE PV-PAGE-COUNT  TO DP132-PAGE-NUMBER                07517098
075180          WRITE REPORT-RECORD-1                                   07518098
075190                FROM DP132-STANDRD-HEADER-132-COLS                07519098
075200          MOVE 0 TO PV-LINE-COUNT                                 07520098
075300       END-IF                                                     07530098
075400                                                                  07540098
075500     MOVE 'CARTON'              TO DL-PKG-TYPE                    07550098
075600     MOVE 'X'                   TO DL-HAZ-IND                     07560098
075700     MOVE PV-CART-CNT           TO DL-HAZ-CARTON-COUNT            07570098
075800     MOVE PV-SKU-WGT            TO DL-HAZ-SKU-WGT                 07580098
075900     MOVE PV-SKU-UOM            TO DL-HAZ-SKU-UOM                 07590098
076000                                                                  07600098
076100     STRING PV-UNVRSL-NBR-ID        DELIMITED BY SPACE            07610098
076200            PC-COMMA                DELIMITED BY SIZE             07620098
076300            PV-PRPR-SHPG-NM         DELIMITED BY '   '            07630098
076400            PC-COMMA                DELIMITED BY SIZE             07640098
076500            PV-DOT49-DIV-NBR        DELIMITED BY SPACE            07650098
076600            PC-COMMA                DELIMITED BY SIZE             07660098
076700            PV-DOT49-SUBCL-NBR      DELIMITED BY SPACE            07670098
076800            PC-COMMA                DELIMITED BY SIZE             07680098
076900            PV-PKNGGRPSVRTY-VAL     DELIMITED BY SPACE            07690098
077000            INTO DL-HAZ-SKU-DESC                                  07700098
077100     WRITE REPORT-RECORD-1                                        07710098
077200           FROM DL-DETAIL-LINE                                    07720098
077300     COMPUTE PV-LINE-COUNT  = PV-LINE-COUNT + 1.                  07730098
077400                                                                  07740098
077401 2080-CLOSE-HAZ-CURSOR.                                           07740198
077402*---------------------------------------------------------------* 07740200
077403*  CURSOR CLOSE TRIP-HAZ-INFO                                   * 07740300
077404*---------------------------------------------------------------* 07740400
077405       EXEC SQL                                                   07740598
077406            CLOSE TRIP-HAZ-INFO                                   07740698
077407       END-EXEC.                                                  07740798
077408                                                                  07740898
077409*---------------------------------------------------------------* 07740900
077410*  BUILDS THE HAZ SUMMARY REPORT FOOTER                         * 07741000
077420*---------------------------------------------------------------* 07742000
077430 3000-BLD-WRT-RPTFTR.                                             07743098
077440       IF PV-LINE-COUNT > PC-LINE-LIMIT                           07744098
077450          COMPUTE PV-PAGE-COUNT = PV-PAGE-COUNT  + 1              07745098
077460          MOVE PV-PAGE-COUNT  TO DP132-PAGE-NUMBER                07746098
077470          WRITE REPORT-RECORD-1                                   07747098
077480                FROM DP132-STANDRD-HEADER-132-COLS                07748098
077490       END-IF.                                                    07749098
077500         WRITE REPORT-RECORD-1                                    07750098
077600           FROM BLANK-LINE.                                       07760098
077700         WRITE REPORT-RECORD-1                                    07770098
077800           FROM BLANK-LINE.                                       07780098
077900         WRITE REPORT-RECORD-1                                    07790098
078000           FROM BLANK-LINE.                                       07800098
078100         WRITE REPORT-RECORD-1                                    07810098
078200           FROM SD-SHPRS-DCLRN.                                   07820099
078300         WRITE REPORT-RECORD-1                                    07830099
078400           FROM FL2-FOOTER-LINE-1.                                07840098
078500         WRITE REPORT-RECORD-1                                    07850098
078600           FROM FL2-FOOTER-LINE-2.                                07860098
078700         WRITE REPORT-RECORD-1                                    07870098
078800           FROM FL2-FOOTER-LINE-3.                                07880098
078900         WRITE REPORT-RECORD-1                                    07890098
079000           FROM BLANK-LINE.                                       07900098
079100         WRITE REPORT-RECORD-1                                    07910098
079200           FROM FL2-FOOTER-LINE-7.                                07920099
079300         WRITE REPORT-RECORD-1                                    07930098
079400           FROM BLANK-LINE.                                       07940098
079500         WRITE REPORT-RECORD-1                                    07950098
079600           FROM BLANK-LINE.                                       07960098
079700         WRITE REPORT-RECORD-1                                    07970098
079800           FROM BLANK-LINE.                                       07980098
079900         WRITE REPORT-RECORD-1                                    07990098
080000           FROM CD-CARRS-DCLRN.                                   08000098
080100         WRITE REPORT-RECORD-1                                    08010098
080200           FROM FL2-FOOTER-LINE-4.                                08020098
080300         WRITE REPORT-RECORD-1                                    08030098
080400           FROM FL2-FOOTER-LINE-5.                                08040098
080500         WRITE REPORT-RECORD-1                                    08050098
080600           FROM FL2-FOOTER-LINE-6.                                08060098
080700         WRITE REPORT-RECORD-1                                    08070098
080800           FROM BLANK-LINE.                                       08080098
080900         WRITE REPORT-RECORD-1                                    08090098
081000           FROM FL2-FOOTER-LINE-8.                                08100099
081100         WRITE REPORT-RECORD-1                                    08110098
081200           FROM BLANK-LINE.                                       08120098
081300         WRITE REPORT-RECORD-1                                    08130098
081400           FROM BLANK-LINE.                                       08140098
081500                                                                  08150098
081600 9000-END-PROCESS.                                                08160098
081700*---------------------------------------------------------------* 08170098
081800*  CLOSE FILES.                                                   08180098
081900*---------------------------------------------------------------* 08190098
082000         WRITE REPORT-RECORD-1                                    08200098
082100              FROM END-OF-REPORT                                  08210098
082200         CLOSE  REPORT-FILE-1.                                    08220099
082210 9100-PROGRAM-DISPLAY.                                            08221099
082220*---------------------------------------------------------------* 08222099
082230*  PROGRAM OUTPUT DISPLAY                                         08223099
082240*---------------------------------------------------------------* 08224099
082250                                                                  08225099
082260     DISPLAY 'PROGRAM DISPLAY'.                                   08226099
082280     DISPLAY '*** USER-ID              = ' CC-USER-ID.            08228099
082281     DISPLAY '*** OPER-UNIT-ID         = ' PV-ORGN-OPER-UNT-ID.   08228199
082282     DISPLAY '*** TRIP-ID              = ' PV-OTBND-TRIP-ID.      08228299
082290     DISPLAY '*** TRAILER ID           = ' PV-TRAILER-ID.         08229099
082291     DISPLAY '*** SCAC                 = ' PV-TRLR-SCAC-CODE.     08229199
082292     DISPLAY '*** TRAILER SERIAL NBR   = ' PV-TRLR-SRL-NBR.       08229299
082293     DISPLAY '*** PRINTER ID           = ' CC-PRINTER-ID.         08229399
082294                                                                  08229499
082300 9900-DB2-ABEND.                                                  08230098
082400*---------------------------------------------------------------* 08240098
082500*  DB2-ABEND-PROCESSING                                           08250098
082600*---------------------------------------------------------------* 08260098
082700                                                                  08270098
082800     DISPLAY '*** DB2 ERROR '.                                    08280098
082900     DISPLAY '*** SQLCODE   = ' PV-SQLCODE.                       08290098
083000     DISPLAY '*** PROGRAM   = ' PV-ABEND-PROGRAM.                 08300098
083100     DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               08310098
083200     DISPLAY '*** OPERATION = ' PV-ABEND-OPERATION.               08320098
083300     DISPLAY '*** MESSAGE   = ' PV-DB2-OPERATION-MSG-1.           08330098
083400     DISPLAY '***           = ' PV-DB2-OPERATION-MSG-2.           08340098
083500     DISPLAY '***           = ' PV-DB2-OPERATION-MSG-3.           08350098
083600     DISPLAY '*** TABLE 1   = ' PV-ABEND-STRUCTURE-1.             08360098
083700                                                                  08370098
083800     COPY DPPD004.                                                08380098
083900                                                                  08390098
084000     MOVE +4013                  TO PV-ABEND-CODE.                08400098
084100     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         08410098
084200                                                                  08420098
084300****************************************************************  08430098
